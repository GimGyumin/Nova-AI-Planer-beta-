(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();const iR="modulepreload",sR=function(t){return"/Nova-AI-Planer-beta-/"+t},Ty={},xs=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(n.map(l=>{if(l=sR(l),l in Ty)return;Ty[l]=!0;const u=l.endsWith(".css"),f=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${f}`))return;const m=document.createElement("link");if(m.rel=u?"stylesheet":iR,u||(m.as="script"),m.crossOrigin="",m.href=l,a&&m.setAttribute("nonce",a),document.head.appendChild(m),u)return new Promise((g,v)=>{m.addEventListener("load",g),m.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return i.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return e().catch(s)})};function oR(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var ew={exports:{}},Dh={},tw={exports:{}},De={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Lu=Symbol.for("react.element"),aR=Symbol.for("react.portal"),lR=Symbol.for("react.fragment"),uR=Symbol.for("react.strict_mode"),cR=Symbol.for("react.profiler"),dR=Symbol.for("react.provider"),hR=Symbol.for("react.context"),fR=Symbol.for("react.forward_ref"),pR=Symbol.for("react.suspense"),mR=Symbol.for("react.memo"),gR=Symbol.for("react.lazy"),Ey=Symbol.iterator;function _R(t){return t===null||typeof t!="object"?null:(t=Ey&&t[Ey]||t["@@iterator"],typeof t=="function"?t:null)}var nw={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},rw=Object.assign,iw={};function Fa(t,e,n){this.props=t,this.context=e,this.refs=iw,this.updater=n||nw}Fa.prototype.isReactComponent={};Fa.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Fa.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function sw(){}sw.prototype=Fa.prototype;function hg(t,e,n){this.props=t,this.context=e,this.refs=iw,this.updater=n||nw}var fg=hg.prototype=new sw;fg.constructor=hg;rw(fg,Fa.prototype);fg.isPureReactComponent=!0;var Iy=Array.isArray,ow=Object.prototype.hasOwnProperty,pg={current:null},aw={key:!0,ref:!0,__self:!0,__source:!0};function lw(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)ow.call(e,r)&&!aw.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];i.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:Lu,type:t,key:s,ref:o,props:i,_owner:pg.current}}function yR(t,e){return{$$typeof:Lu,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function mg(t){return typeof t=="object"&&t!==null&&t.$$typeof===Lu}function vR(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var wy=/\/+/g;function Of(t,e){return typeof t=="object"&&t!==null&&t.key!=null?vR(""+t.key):e.toString(36)}function id(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Lu:case aR:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+Of(o,0):r,Iy(i)?(n="",t!=null&&(n=t.replace(wy,"$&/")+"/"),id(i,e,n,"",function(u){return u})):i!=null&&(mg(i)&&(i=yR(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(wy,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",Iy(t))for(var a=0;a<t.length;a++){s=t[a];var l=r+Of(s,a);o+=id(s,e,n,l,i)}else if(l=_R(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=r+Of(s,a++),o+=id(s,e,n,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Dc(t,e,n){if(t==null)return t;var r=[],i=0;return id(t,r,"","",function(s){return e.call(n,s,i++)}),r}function TR(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var cn={current:null},sd={transition:null},ER={ReactCurrentDispatcher:cn,ReactCurrentBatchConfig:sd,ReactCurrentOwner:pg};function uw(){throw Error("act(...) is not supported in production builds of React.")}De.Children={map:Dc,forEach:function(t,e,n){Dc(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Dc(t,function(){e++}),e},toArray:function(t){return Dc(t,function(e){return e})||[]},only:function(t){if(!mg(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};De.Component=Fa;De.Fragment=lR;De.Profiler=cR;De.PureComponent=hg;De.StrictMode=uR;De.Suspense=pR;De.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ER;De.act=uw;De.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=rw({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=pg.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)ow.call(e,l)&&!aw.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];r.children=a}return{$$typeof:Lu,type:t.type,key:i,ref:s,props:r,_owner:o}};De.createContext=function(t){return t={$$typeof:hR,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:dR,_context:t},t.Consumer=t};De.createElement=lw;De.createFactory=function(t){var e=lw.bind(null,t);return e.type=t,e};De.createRef=function(){return{current:null}};De.forwardRef=function(t){return{$$typeof:fR,render:t}};De.isValidElement=mg;De.lazy=function(t){return{$$typeof:gR,_payload:{_status:-1,_result:t},_init:TR}};De.memo=function(t,e){return{$$typeof:mR,type:t,compare:e===void 0?null:e}};De.startTransition=function(t){var e=sd.transition;sd.transition={};try{t()}finally{sd.transition=e}};De.unstable_act=uw;De.useCallback=function(t,e){return cn.current.useCallback(t,e)};De.useContext=function(t){return cn.current.useContext(t)};De.useDebugValue=function(){};De.useDeferredValue=function(t){return cn.current.useDeferredValue(t)};De.useEffect=function(t,e){return cn.current.useEffect(t,e)};De.useId=function(){return cn.current.useId()};De.useImperativeHandle=function(t,e,n){return cn.current.useImperativeHandle(t,e,n)};De.useInsertionEffect=function(t,e){return cn.current.useInsertionEffect(t,e)};De.useLayoutEffect=function(t,e){return cn.current.useLayoutEffect(t,e)};De.useMemo=function(t,e){return cn.current.useMemo(t,e)};De.useReducer=function(t,e,n){return cn.current.useReducer(t,e,n)};De.useRef=function(t){return cn.current.useRef(t)};De.useState=function(t){return cn.current.useState(t)};De.useSyncExternalStore=function(t,e,n){return cn.current.useSyncExternalStore(t,e,n)};De.useTransition=function(){return cn.current.useTransition()};De.version="18.3.1";tw.exports=De;var z=tw.exports;const cw=oR(z);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var IR=z,wR=Symbol.for("react.element"),SR=Symbol.for("react.fragment"),CR=Object.prototype.hasOwnProperty,AR=IR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,xR={key:!0,ref:!0,__self:!0,__source:!0};function dw(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)CR.call(e,r)&&!xR.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:wR,type:t,key:s,ref:o,props:i,_owner:AR.current}}Dh.Fragment=SR;Dh.jsx=dw;Dh.jsxs=dw;ew.exports=Dh;var p=ew.exports,Ap={},hw={exports:{}},bn={},fw={exports:{}},pw={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(te,ce){var ve=te.length;te.push(ce);e:for(;0<ve;){var Ie=ve-1>>>1,Re=te[Ie];if(0<i(Re,ce))te[Ie]=ce,te[ve]=Re,ve=Ie;else break e}}function n(te){return te.length===0?null:te[0]}function r(te){if(te.length===0)return null;var ce=te[0],ve=te.pop();if(ve!==ce){te[0]=ve;e:for(var Ie=0,Re=te.length,$e=Re>>>1;Ie<$e;){var Ke=2*(Ie+1)-1,Vt=te[Ke],ut=Ke+1,_e=te[ut];if(0>i(Vt,ve))ut<Re&&0>i(_e,Vt)?(te[Ie]=_e,te[ut]=ve,Ie=ut):(te[Ie]=Vt,te[Ke]=ve,Ie=Ke);else if(ut<Re&&0>i(_e,ve))te[Ie]=_e,te[ut]=ve,Ie=ut;else break e}}return ce}function i(te,ce){var ve=te.sortIndex-ce.sortIndex;return ve!==0?ve:te.id-ce.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],u=[],f=1,m=null,g=3,v=!1,T=!1,P=!1,D=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,I=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function R(te){for(var ce=n(u);ce!==null;){if(ce.callback===null)r(u);else if(ce.startTime<=te)r(u),ce.sortIndex=ce.expirationTime,e(l,ce);else break;ce=n(u)}}function V(te){if(P=!1,R(te),!T)if(n(l)!==null)T=!0,je(U);else{var ce=n(u);ce!==null&&Ee(V,ce.startTime-te)}}function U(te,ce){T=!1,P&&(P=!1,S(w),w=-1),v=!0;var ve=g;try{for(R(ce),m=n(l);m!==null&&(!(m.expirationTime>ce)||te&&!M());){var Ie=m.callback;if(typeof Ie=="function"){m.callback=null,g=m.priorityLevel;var Re=Ie(m.expirationTime<=ce);ce=t.unstable_now(),typeof Re=="function"?m.callback=Re:m===n(l)&&r(l),R(ce)}else r(l);m=n(l)}if(m!==null)var $e=!0;else{var Ke=n(u);Ke!==null&&Ee(V,Ke.startTime-ce),$e=!1}return $e}finally{m=null,g=ve,v=!1}}var B=!1,E=null,w=-1,C=5,k=-1;function M(){return!(t.unstable_now()-k<C)}function L(){if(E!==null){var te=t.unstable_now();k=te;var ce=!0;try{ce=E(!0,te)}finally{ce?N():(B=!1,E=null)}}else B=!1}var N;if(typeof I=="function")N=function(){I(L)};else if(typeof MessageChannel<"u"){var Ne=new MessageChannel,Fe=Ne.port2;Ne.port1.onmessage=L,N=function(){Fe.postMessage(null)}}else N=function(){D(L,0)};function je(te){E=te,B||(B=!0,N())}function Ee(te,ce){w=D(function(){te(t.unstable_now())},ce)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(te){te.callback=null},t.unstable_continueExecution=function(){T||v||(T=!0,je(U))},t.unstable_forceFrameRate=function(te){0>te||125<te?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<te?Math.floor(1e3/te):5},t.unstable_getCurrentPriorityLevel=function(){return g},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(te){switch(g){case 1:case 2:case 3:var ce=3;break;default:ce=g}var ve=g;g=ce;try{return te()}finally{g=ve}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(te,ce){switch(te){case 1:case 2:case 3:case 4:case 5:break;default:te=3}var ve=g;g=te;try{return ce()}finally{g=ve}},t.unstable_scheduleCallback=function(te,ce,ve){var Ie=t.unstable_now();switch(typeof ve=="object"&&ve!==null?(ve=ve.delay,ve=typeof ve=="number"&&0<ve?Ie+ve:Ie):ve=Ie,te){case 1:var Re=-1;break;case 2:Re=250;break;case 5:Re=1073741823;break;case 4:Re=1e4;break;default:Re=5e3}return Re=ve+Re,te={id:f++,callback:ce,priorityLevel:te,startTime:ve,expirationTime:Re,sortIndex:-1},ve>Ie?(te.sortIndex=ve,e(u,te),n(l)===null&&te===n(u)&&(P?(S(w),w=-1):P=!0,Ee(V,ve-Ie))):(te.sortIndex=Re,e(l,te),T||v||(T=!0,je(U))),te},t.unstable_shouldYield=M,t.unstable_wrapCallback=function(te){var ce=g;return function(){var ve=g;g=ce;try{return te.apply(this,arguments)}finally{g=ve}}}})(pw);fw.exports=pw;var RR=fw.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var PR=z,Nn=RR;function ee(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var mw=new Set,su={};function ho(t,e){pa(t,e),pa(t+"Capture",e)}function pa(t,e){for(su[t]=e,t=0;t<e.length;t++)mw.add(e[t])}var jr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),xp=Object.prototype.hasOwnProperty,kR=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Sy={},Cy={};function NR(t){return xp.call(Cy,t)?!0:xp.call(Sy,t)?!1:kR.test(t)?Cy[t]=!0:(Sy[t]=!0,!1)}function DR(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function bR(t,e,n,r){if(e===null||typeof e>"u"||DR(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function dn(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Wt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Wt[t]=new dn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Wt[e]=new dn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Wt[t]=new dn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Wt[t]=new dn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Wt[t]=new dn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Wt[t]=new dn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Wt[t]=new dn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Wt[t]=new dn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Wt[t]=new dn(t,5,!1,t.toLowerCase(),null,!1,!1)});var gg=/[\-:]([a-z])/g;function _g(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(gg,_g);Wt[e]=new dn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(gg,_g);Wt[e]=new dn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(gg,_g);Wt[e]=new dn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Wt[t]=new dn(t,1,!1,t.toLowerCase(),null,!1,!1)});Wt.xlinkHref=new dn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Wt[t]=new dn(t,1,!1,t.toLowerCase(),null,!0,!0)});function yg(t,e,n,r){var i=Wt.hasOwnProperty(e)?Wt[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(bR(e,n,i,r)&&(n=null),r||i===null?NR(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var ti=PR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,bc=Symbol.for("react.element"),Go=Symbol.for("react.portal"),qo=Symbol.for("react.fragment"),vg=Symbol.for("react.strict_mode"),Rp=Symbol.for("react.profiler"),gw=Symbol.for("react.provider"),_w=Symbol.for("react.context"),Tg=Symbol.for("react.forward_ref"),Pp=Symbol.for("react.suspense"),kp=Symbol.for("react.suspense_list"),Eg=Symbol.for("react.memo"),Ii=Symbol.for("react.lazy"),yw=Symbol.for("react.offscreen"),Ay=Symbol.iterator;function fl(t){return t===null||typeof t!="object"?null:(t=Ay&&t[Ay]||t["@@iterator"],typeof t=="function"?t:null)}var mt=Object.assign,Bf;function xl(t){if(Bf===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Bf=e&&e[1]||""}return`
`+Bf+t}var Gf=!1;function qf(t,e){if(!t||Gf)return"";Gf=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{Gf=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?xl(t):""}function MR(t){switch(t.tag){case 5:return xl(t.type);case 16:return xl("Lazy");case 13:return xl("Suspense");case 19:return xl("SuspenseList");case 0:case 2:case 15:return t=qf(t.type,!1),t;case 11:return t=qf(t.type.render,!1),t;case 1:return t=qf(t.type,!0),t;default:return""}}function Np(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case qo:return"Fragment";case Go:return"Portal";case Rp:return"Profiler";case vg:return"StrictMode";case Pp:return"Suspense";case kp:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case _w:return(t.displayName||"Context")+".Consumer";case gw:return(t._context.displayName||"Context")+".Provider";case Tg:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Eg:return e=t.displayName||null,e!==null?e:Np(t.type)||"Memo";case Ii:e=t._payload,t=t._init;try{return Np(t(e))}catch{}}return null}function VR(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Np(e);case 8:return e===vg?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ki(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function vw(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function LR(t){var e=vw(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Mc(t){t._valueTracker||(t._valueTracker=LR(t))}function Tw(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=vw(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function bd(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Dp(t,e){var n=e.checked;return mt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function xy(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Ki(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Ew(t,e){e=e.checked,e!=null&&yg(t,"checked",e,!1)}function bp(t,e){Ew(t,e);var n=Ki(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Mp(t,e.type,n):e.hasOwnProperty("defaultValue")&&Mp(t,e.type,Ki(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Ry(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Mp(t,e,n){(e!=="number"||bd(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Rl=Array.isArray;function ta(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Ki(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Vp(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ee(91));return mt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Py(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(ee(92));if(Rl(n)){if(1<n.length)throw Error(ee(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Ki(n)}}function Iw(t,e){var n=Ki(e.value),r=Ki(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function ky(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function ww(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Lp(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?ww(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Vc,Sw=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Vc=Vc||document.createElement("div"),Vc.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Vc.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function ou(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Fl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},FR=["Webkit","ms","Moz","O"];Object.keys(Fl).forEach(function(t){FR.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Fl[e]=Fl[t]})});function Cw(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Fl.hasOwnProperty(t)&&Fl[t]?(""+e).trim():e+"px"}function Aw(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=Cw(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var UR=mt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Fp(t,e){if(e){if(UR[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ee(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ee(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ee(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ee(62))}}function Up(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Op=null;function Ig(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Bp=null,na=null,ra=null;function Ny(t){if(t=Ou(t)){if(typeof Bp!="function")throw Error(ee(280));var e=t.stateNode;e&&(e=Fh(e),Bp(t.stateNode,t.type,e))}}function xw(t){na?ra?ra.push(t):ra=[t]:na=t}function Rw(){if(na){var t=na,e=ra;if(ra=na=null,Ny(t),e)for(t=0;t<e.length;t++)Ny(e[t])}}function Pw(t,e){return t(e)}function kw(){}var zf=!1;function Nw(t,e,n){if(zf)return t(e,n);zf=!0;try{return Pw(t,e,n)}finally{zf=!1,(na!==null||ra!==null)&&(kw(),Rw())}}function au(t,e){var n=t.stateNode;if(n===null)return null;var r=Fh(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(ee(231,e,typeof n));return n}var Gp=!1;if(jr)try{var pl={};Object.defineProperty(pl,"passive",{get:function(){Gp=!0}}),window.addEventListener("test",pl,pl),window.removeEventListener("test",pl,pl)}catch{Gp=!1}function OR(t,e,n,r,i,s,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(f){this.onError(f)}}var Ul=!1,Md=null,Vd=!1,qp=null,BR={onError:function(t){Ul=!0,Md=t}};function GR(t,e,n,r,i,s,o,a,l){Ul=!1,Md=null,OR.apply(BR,arguments)}function qR(t,e,n,r,i,s,o,a,l){if(GR.apply(this,arguments),Ul){if(Ul){var u=Md;Ul=!1,Md=null}else throw Error(ee(198));Vd||(Vd=!0,qp=u)}}function fo(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Dw(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Dy(t){if(fo(t)!==t)throw Error(ee(188))}function zR(t){var e=t.alternate;if(!e){if(e=fo(t),e===null)throw Error(ee(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return Dy(i),t;if(s===r)return Dy(i),e;s=s.sibling}throw Error(ee(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(ee(189))}}if(n.alternate!==r)throw Error(ee(190))}if(n.tag!==3)throw Error(ee(188));return n.stateNode.current===n?t:e}function bw(t){return t=zR(t),t!==null?Mw(t):null}function Mw(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Mw(t);if(e!==null)return e;t=t.sibling}return null}var Vw=Nn.unstable_scheduleCallback,by=Nn.unstable_cancelCallback,$R=Nn.unstable_shouldYield,HR=Nn.unstable_requestPaint,Tt=Nn.unstable_now,WR=Nn.unstable_getCurrentPriorityLevel,wg=Nn.unstable_ImmediatePriority,Lw=Nn.unstable_UserBlockingPriority,Ld=Nn.unstable_NormalPriority,jR=Nn.unstable_LowPriority,Fw=Nn.unstable_IdlePriority,bh=null,Ir=null;function KR(t){if(Ir&&typeof Ir.onCommitFiberRoot=="function")try{Ir.onCommitFiberRoot(bh,t,void 0,(t.current.flags&128)===128)}catch{}}var rr=Math.clz32?Math.clz32:YR,JR=Math.log,QR=Math.LN2;function YR(t){return t>>>=0,t===0?32:31-(JR(t)/QR|0)|0}var Lc=64,Fc=4194304;function Pl(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Fd(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=Pl(a):(s&=o,s!==0&&(r=Pl(s)))}else o=n&~i,o!==0?r=Pl(o):s!==0&&(r=Pl(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-rr(e),i=1<<n,r|=t[n],e&=~i;return r}function XR(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ZR(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-rr(s),a=1<<o,l=i[o];l===-1?(!(a&n)||a&r)&&(i[o]=XR(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function zp(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Uw(){var t=Lc;return Lc<<=1,!(Lc&4194240)&&(Lc=64),t}function $f(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Fu(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-rr(e),t[e]=n}function eP(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-rr(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function Sg(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-rr(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var Qe=0;function Ow(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Bw,Cg,Gw,qw,zw,$p=!1,Uc=[],bi=null,Mi=null,Vi=null,lu=new Map,uu=new Map,Si=[],tP="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function My(t,e){switch(t){case"focusin":case"focusout":bi=null;break;case"dragenter":case"dragleave":Mi=null;break;case"mouseover":case"mouseout":Vi=null;break;case"pointerover":case"pointerout":lu.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":uu.delete(e.pointerId)}}function ml(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Ou(e),e!==null&&Cg(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function nP(t,e,n,r,i){switch(e){case"focusin":return bi=ml(bi,t,e,n,r,i),!0;case"dragenter":return Mi=ml(Mi,t,e,n,r,i),!0;case"mouseover":return Vi=ml(Vi,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return lu.set(s,ml(lu.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,uu.set(s,ml(uu.get(s)||null,t,e,n,r,i)),!0}return!1}function $w(t){var e=Os(t.target);if(e!==null){var n=fo(e);if(n!==null){if(e=n.tag,e===13){if(e=Dw(n),e!==null){t.blockedOn=e,zw(t.priority,function(){Gw(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function od(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Hp(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Op=r,n.target.dispatchEvent(r),Op=null}else return e=Ou(n),e!==null&&Cg(e),t.blockedOn=n,!1;e.shift()}return!0}function Vy(t,e,n){od(t)&&n.delete(e)}function rP(){$p=!1,bi!==null&&od(bi)&&(bi=null),Mi!==null&&od(Mi)&&(Mi=null),Vi!==null&&od(Vi)&&(Vi=null),lu.forEach(Vy),uu.forEach(Vy)}function gl(t,e){t.blockedOn===e&&(t.blockedOn=null,$p||($p=!0,Nn.unstable_scheduleCallback(Nn.unstable_NormalPriority,rP)))}function cu(t){function e(i){return gl(i,t)}if(0<Uc.length){gl(Uc[0],t);for(var n=1;n<Uc.length;n++){var r=Uc[n];r.blockedOn===t&&(r.blockedOn=null)}}for(bi!==null&&gl(bi,t),Mi!==null&&gl(Mi,t),Vi!==null&&gl(Vi,t),lu.forEach(e),uu.forEach(e),n=0;n<Si.length;n++)r=Si[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Si.length&&(n=Si[0],n.blockedOn===null);)$w(n),n.blockedOn===null&&Si.shift()}var ia=ti.ReactCurrentBatchConfig,Ud=!0;function iP(t,e,n,r){var i=Qe,s=ia.transition;ia.transition=null;try{Qe=1,Ag(t,e,n,r)}finally{Qe=i,ia.transition=s}}function sP(t,e,n,r){var i=Qe,s=ia.transition;ia.transition=null;try{Qe=4,Ag(t,e,n,r)}finally{Qe=i,ia.transition=s}}function Ag(t,e,n,r){if(Ud){var i=Hp(t,e,n,r);if(i===null)ep(t,e,r,Od,n),My(t,r);else if(nP(i,t,e,n,r))r.stopPropagation();else if(My(t,r),e&4&&-1<tP.indexOf(t)){for(;i!==null;){var s=Ou(i);if(s!==null&&Bw(s),s=Hp(t,e,n,r),s===null&&ep(t,e,r,Od,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else ep(t,e,r,null,n)}}var Od=null;function Hp(t,e,n,r){if(Od=null,t=Ig(r),t=Os(t),t!==null)if(e=fo(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Dw(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Od=t,null}function Hw(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(WR()){case wg:return 1;case Lw:return 4;case Ld:case jR:return 16;case Fw:return 536870912;default:return 16}default:return 16}}var ki=null,xg=null,ad=null;function Ww(){if(ad)return ad;var t,e=xg,n=e.length,r,i="value"in ki?ki.value:ki.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return ad=i.slice(t,1<r?1-r:void 0)}function ld(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Oc(){return!0}function Ly(){return!1}function Mn(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Oc:Ly,this.isPropagationStopped=Ly,this}return mt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Oc)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Oc)},persist:function(){},isPersistent:Oc}),e}var Ua={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Rg=Mn(Ua),Uu=mt({},Ua,{view:0,detail:0}),oP=Mn(Uu),Hf,Wf,_l,Mh=mt({},Uu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Pg,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==_l&&(_l&&t.type==="mousemove"?(Hf=t.screenX-_l.screenX,Wf=t.screenY-_l.screenY):Wf=Hf=0,_l=t),Hf)},movementY:function(t){return"movementY"in t?t.movementY:Wf}}),Fy=Mn(Mh),aP=mt({},Mh,{dataTransfer:0}),lP=Mn(aP),uP=mt({},Uu,{relatedTarget:0}),jf=Mn(uP),cP=mt({},Ua,{animationName:0,elapsedTime:0,pseudoElement:0}),dP=Mn(cP),hP=mt({},Ua,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),fP=Mn(hP),pP=mt({},Ua,{data:0}),Uy=Mn(pP),mP={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},gP={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_P={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function yP(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=_P[t])?!!e[t]:!1}function Pg(){return yP}var vP=mt({},Uu,{key:function(t){if(t.key){var e=mP[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=ld(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?gP[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Pg,charCode:function(t){return t.type==="keypress"?ld(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?ld(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),TP=Mn(vP),EP=mt({},Mh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Oy=Mn(EP),IP=mt({},Uu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Pg}),wP=Mn(IP),SP=mt({},Ua,{propertyName:0,elapsedTime:0,pseudoElement:0}),CP=Mn(SP),AP=mt({},Mh,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),xP=Mn(AP),RP=[9,13,27,32],kg=jr&&"CompositionEvent"in window,Ol=null;jr&&"documentMode"in document&&(Ol=document.documentMode);var PP=jr&&"TextEvent"in window&&!Ol,jw=jr&&(!kg||Ol&&8<Ol&&11>=Ol),By=" ",Gy=!1;function Kw(t,e){switch(t){case"keyup":return RP.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Jw(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var zo=!1;function kP(t,e){switch(t){case"compositionend":return Jw(e);case"keypress":return e.which!==32?null:(Gy=!0,By);case"textInput":return t=e.data,t===By&&Gy?null:t;default:return null}}function NP(t,e){if(zo)return t==="compositionend"||!kg&&Kw(t,e)?(t=Ww(),ad=xg=ki=null,zo=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return jw&&e.locale!=="ko"?null:e.data;default:return null}}var DP={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qy(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!DP[t.type]:e==="textarea"}function Qw(t,e,n,r){xw(r),e=Bd(e,"onChange"),0<e.length&&(n=new Rg("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Bl=null,du=null;function bP(t){aS(t,0)}function Vh(t){var e=Wo(t);if(Tw(e))return t}function MP(t,e){if(t==="change")return e}var Yw=!1;if(jr){var Kf;if(jr){var Jf="oninput"in document;if(!Jf){var zy=document.createElement("div");zy.setAttribute("oninput","return;"),Jf=typeof zy.oninput=="function"}Kf=Jf}else Kf=!1;Yw=Kf&&(!document.documentMode||9<document.documentMode)}function $y(){Bl&&(Bl.detachEvent("onpropertychange",Xw),du=Bl=null)}function Xw(t){if(t.propertyName==="value"&&Vh(du)){var e=[];Qw(e,du,t,Ig(t)),Nw(bP,e)}}function VP(t,e,n){t==="focusin"?($y(),Bl=e,du=n,Bl.attachEvent("onpropertychange",Xw)):t==="focusout"&&$y()}function LP(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Vh(du)}function FP(t,e){if(t==="click")return Vh(e)}function UP(t,e){if(t==="input"||t==="change")return Vh(e)}function OP(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var lr=typeof Object.is=="function"?Object.is:OP;function hu(t,e){if(lr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!xp.call(e,i)||!lr(t[i],e[i]))return!1}return!0}function Hy(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Wy(t,e){var n=Hy(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Hy(n)}}function Zw(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Zw(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function eS(){for(var t=window,e=bd();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=bd(t.document)}return e}function Ng(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function BP(t){var e=eS(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Zw(n.ownerDocument.documentElement,n)){if(r!==null&&Ng(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=Wy(n,s);var o=Wy(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var GP=jr&&"documentMode"in document&&11>=document.documentMode,$o=null,Wp=null,Gl=null,jp=!1;function jy(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;jp||$o==null||$o!==bd(r)||(r=$o,"selectionStart"in r&&Ng(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Gl&&hu(Gl,r)||(Gl=r,r=Bd(Wp,"onSelect"),0<r.length&&(e=new Rg("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=$o)))}function Bc(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Ho={animationend:Bc("Animation","AnimationEnd"),animationiteration:Bc("Animation","AnimationIteration"),animationstart:Bc("Animation","AnimationStart"),transitionend:Bc("Transition","TransitionEnd")},Qf={},tS={};jr&&(tS=document.createElement("div").style,"AnimationEvent"in window||(delete Ho.animationend.animation,delete Ho.animationiteration.animation,delete Ho.animationstart.animation),"TransitionEvent"in window||delete Ho.transitionend.transition);function Lh(t){if(Qf[t])return Qf[t];if(!Ho[t])return t;var e=Ho[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in tS)return Qf[t]=e[n];return t}var nS=Lh("animationend"),rS=Lh("animationiteration"),iS=Lh("animationstart"),sS=Lh("transitionend"),oS=new Map,Ky="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function rs(t,e){oS.set(t,e),ho(e,[t])}for(var Yf=0;Yf<Ky.length;Yf++){var Xf=Ky[Yf],qP=Xf.toLowerCase(),zP=Xf[0].toUpperCase()+Xf.slice(1);rs(qP,"on"+zP)}rs(nS,"onAnimationEnd");rs(rS,"onAnimationIteration");rs(iS,"onAnimationStart");rs("dblclick","onDoubleClick");rs("focusin","onFocus");rs("focusout","onBlur");rs(sS,"onTransitionEnd");pa("onMouseEnter",["mouseout","mouseover"]);pa("onMouseLeave",["mouseout","mouseover"]);pa("onPointerEnter",["pointerout","pointerover"]);pa("onPointerLeave",["pointerout","pointerover"]);ho("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ho("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ho("onBeforeInput",["compositionend","keypress","textInput","paste"]);ho("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ho("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ho("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var kl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),$P=new Set("cancel close invalid load scroll toggle".split(" ").concat(kl));function Jy(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,qR(r,e,void 0,t),t.currentTarget=null}function aS(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;Jy(i,a,u),s=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;Jy(i,a,u),s=l}}}if(Vd)throw t=qp,Vd=!1,qp=null,t}function et(t,e){var n=e[Xp];n===void 0&&(n=e[Xp]=new Set);var r=t+"__bubble";n.has(r)||(lS(e,t,2,!1),n.add(r))}function Zf(t,e,n){var r=0;e&&(r|=4),lS(n,t,r,e)}var Gc="_reactListening"+Math.random().toString(36).slice(2);function fu(t){if(!t[Gc]){t[Gc]=!0,mw.forEach(function(n){n!=="selectionchange"&&($P.has(n)||Zf(n,!1,t),Zf(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Gc]||(e[Gc]=!0,Zf("selectionchange",!1,e))}}function lS(t,e,n,r){switch(Hw(e)){case 1:var i=iP;break;case 4:i=sP;break;default:i=Ag}n=i.bind(null,e,n,t),i=void 0,!Gp||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function ep(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=Os(a),o===null)return;if(l=o.tag,l===5||l===6){r=s=o;continue e}a=a.parentNode}}r=r.return}Nw(function(){var u=s,f=Ig(n),m=[];e:{var g=oS.get(t);if(g!==void 0){var v=Rg,T=t;switch(t){case"keypress":if(ld(n)===0)break e;case"keydown":case"keyup":v=TP;break;case"focusin":T="focus",v=jf;break;case"focusout":T="blur",v=jf;break;case"beforeblur":case"afterblur":v=jf;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":v=Fy;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":v=lP;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":v=wP;break;case nS:case rS:case iS:v=dP;break;case sS:v=CP;break;case"scroll":v=oP;break;case"wheel":v=xP;break;case"copy":case"cut":case"paste":v=fP;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":v=Oy}var P=(e&4)!==0,D=!P&&t==="scroll",S=P?g!==null?g+"Capture":null:g;P=[];for(var I=u,R;I!==null;){R=I;var V=R.stateNode;if(R.tag===5&&V!==null&&(R=V,S!==null&&(V=au(I,S),V!=null&&P.push(pu(I,V,R)))),D)break;I=I.return}0<P.length&&(g=new v(g,T,null,n,f),m.push({event:g,listeners:P}))}}if(!(e&7)){e:{if(g=t==="mouseover"||t==="pointerover",v=t==="mouseout"||t==="pointerout",g&&n!==Op&&(T=n.relatedTarget||n.fromElement)&&(Os(T)||T[Kr]))break e;if((v||g)&&(g=f.window===f?f:(g=f.ownerDocument)?g.defaultView||g.parentWindow:window,v?(T=n.relatedTarget||n.toElement,v=u,T=T?Os(T):null,T!==null&&(D=fo(T),T!==D||T.tag!==5&&T.tag!==6)&&(T=null)):(v=null,T=u),v!==T)){if(P=Fy,V="onMouseLeave",S="onMouseEnter",I="mouse",(t==="pointerout"||t==="pointerover")&&(P=Oy,V="onPointerLeave",S="onPointerEnter",I="pointer"),D=v==null?g:Wo(v),R=T==null?g:Wo(T),g=new P(V,I+"leave",v,n,f),g.target=D,g.relatedTarget=R,V=null,Os(f)===u&&(P=new P(S,I+"enter",T,n,f),P.target=R,P.relatedTarget=D,V=P),D=V,v&&T)t:{for(P=v,S=T,I=0,R=P;R;R=Po(R))I++;for(R=0,V=S;V;V=Po(V))R++;for(;0<I-R;)P=Po(P),I--;for(;0<R-I;)S=Po(S),R--;for(;I--;){if(P===S||S!==null&&P===S.alternate)break t;P=Po(P),S=Po(S)}P=null}else P=null;v!==null&&Qy(m,g,v,P,!1),T!==null&&D!==null&&Qy(m,D,T,P,!0)}}e:{if(g=u?Wo(u):window,v=g.nodeName&&g.nodeName.toLowerCase(),v==="select"||v==="input"&&g.type==="file")var U=MP;else if(qy(g))if(Yw)U=UP;else{U=LP;var B=VP}else(v=g.nodeName)&&v.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(U=FP);if(U&&(U=U(t,u))){Qw(m,U,n,f);break e}B&&B(t,g,u),t==="focusout"&&(B=g._wrapperState)&&B.controlled&&g.type==="number"&&Mp(g,"number",g.value)}switch(B=u?Wo(u):window,t){case"focusin":(qy(B)||B.contentEditable==="true")&&($o=B,Wp=u,Gl=null);break;case"focusout":Gl=Wp=$o=null;break;case"mousedown":jp=!0;break;case"contextmenu":case"mouseup":case"dragend":jp=!1,jy(m,n,f);break;case"selectionchange":if(GP)break;case"keydown":case"keyup":jy(m,n,f)}var E;if(kg)e:{switch(t){case"compositionstart":var w="onCompositionStart";break e;case"compositionend":w="onCompositionEnd";break e;case"compositionupdate":w="onCompositionUpdate";break e}w=void 0}else zo?Kw(t,n)&&(w="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(w="onCompositionStart");w&&(jw&&n.locale!=="ko"&&(zo||w!=="onCompositionStart"?w==="onCompositionEnd"&&zo&&(E=Ww()):(ki=f,xg="value"in ki?ki.value:ki.textContent,zo=!0)),B=Bd(u,w),0<B.length&&(w=new Uy(w,t,null,n,f),m.push({event:w,listeners:B}),E?w.data=E:(E=Jw(n),E!==null&&(w.data=E)))),(E=PP?kP(t,n):NP(t,n))&&(u=Bd(u,"onBeforeInput"),0<u.length&&(f=new Uy("onBeforeInput","beforeinput",null,n,f),m.push({event:f,listeners:u}),f.data=E))}aS(m,e)})}function pu(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Bd(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=au(t,n),s!=null&&r.unshift(pu(t,s,i)),s=au(t,e),s!=null&&r.push(pu(t,s,i))),t=t.return}return r}function Po(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Qy(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,u=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&u!==null&&(a=u,i?(l=au(n,s),l!=null&&o.unshift(pu(n,l,a))):i||(l=au(n,s),l!=null&&o.push(pu(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var HP=/\r\n?/g,WP=/\u0000|\uFFFD/g;function Yy(t){return(typeof t=="string"?t:""+t).replace(HP,`
`).replace(WP,"")}function qc(t,e,n){if(e=Yy(e),Yy(t)!==e&&n)throw Error(ee(425))}function Gd(){}var Kp=null,Jp=null;function Qp(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Yp=typeof setTimeout=="function"?setTimeout:void 0,jP=typeof clearTimeout=="function"?clearTimeout:void 0,Xy=typeof Promise=="function"?Promise:void 0,KP=typeof queueMicrotask=="function"?queueMicrotask:typeof Xy<"u"?function(t){return Xy.resolve(null).then(t).catch(JP)}:Yp;function JP(t){setTimeout(function(){throw t})}function tp(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),cu(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);cu(e)}function Li(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Zy(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Oa=Math.random().toString(36).slice(2),vr="__reactFiber$"+Oa,mu="__reactProps$"+Oa,Kr="__reactContainer$"+Oa,Xp="__reactEvents$"+Oa,QP="__reactListeners$"+Oa,YP="__reactHandles$"+Oa;function Os(t){var e=t[vr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Kr]||n[vr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Zy(t);t!==null;){if(n=t[vr])return n;t=Zy(t)}return e}t=n,n=t.parentNode}return null}function Ou(t){return t=t[vr]||t[Kr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Wo(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ee(33))}function Fh(t){return t[mu]||null}var Zp=[],jo=-1;function is(t){return{current:t}}function nt(t){0>jo||(t.current=Zp[jo],Zp[jo]=null,jo--)}function Ze(t,e){jo++,Zp[jo]=t.current,t.current=e}var Ji={},tn=is(Ji),gn=is(!1),Ys=Ji;function ma(t,e){var n=t.type.contextTypes;if(!n)return Ji;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function _n(t){return t=t.childContextTypes,t!=null}function qd(){nt(gn),nt(tn)}function ev(t,e,n){if(tn.current!==Ji)throw Error(ee(168));Ze(tn,e),Ze(gn,n)}function uS(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(ee(108,VR(t)||"Unknown",i));return mt({},n,r)}function zd(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ji,Ys=tn.current,Ze(tn,t),Ze(gn,gn.current),!0}function tv(t,e,n){var r=t.stateNode;if(!r)throw Error(ee(169));n?(t=uS(t,e,Ys),r.__reactInternalMemoizedMergedChildContext=t,nt(gn),nt(tn),Ze(tn,t)):nt(gn),Ze(gn,n)}var Ur=null,Uh=!1,np=!1;function cS(t){Ur===null?Ur=[t]:Ur.push(t)}function XP(t){Uh=!0,cS(t)}function ss(){if(!np&&Ur!==null){np=!0;var t=0,e=Qe;try{var n=Ur;for(Qe=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Ur=null,Uh=!1}catch(i){throw Ur!==null&&(Ur=Ur.slice(t+1)),Vw(wg,ss),i}finally{Qe=e,np=!1}}return null}var Ko=[],Jo=0,$d=null,Hd=0,On=[],Bn=0,Xs=null,Br=1,Gr="";function ks(t,e){Ko[Jo++]=Hd,Ko[Jo++]=$d,$d=t,Hd=e}function dS(t,e,n){On[Bn++]=Br,On[Bn++]=Gr,On[Bn++]=Xs,Xs=t;var r=Br;t=Gr;var i=32-rr(r)-1;r&=~(1<<i),n+=1;var s=32-rr(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Br=1<<32-rr(e)+i|n<<i|r,Gr=s+t}else Br=1<<s|n<<i|r,Gr=t}function Dg(t){t.return!==null&&(ks(t,1),dS(t,1,0))}function bg(t){for(;t===$d;)$d=Ko[--Jo],Ko[Jo]=null,Hd=Ko[--Jo],Ko[Jo]=null;for(;t===Xs;)Xs=On[--Bn],On[Bn]=null,Gr=On[--Bn],On[Bn]=null,Br=On[--Bn],On[Bn]=null}var kn=null,Rn=null,ot=!1,er=null;function hS(t,e){var n=Gn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function nv(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,kn=t,Rn=Li(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,kn=t,Rn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Xs!==null?{id:Br,overflow:Gr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Gn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,kn=t,Rn=null,!0):!1;default:return!1}}function em(t){return(t.mode&1)!==0&&(t.flags&128)===0}function tm(t){if(ot){var e=Rn;if(e){var n=e;if(!nv(t,e)){if(em(t))throw Error(ee(418));e=Li(n.nextSibling);var r=kn;e&&nv(t,e)?hS(r,n):(t.flags=t.flags&-4097|2,ot=!1,kn=t)}}else{if(em(t))throw Error(ee(418));t.flags=t.flags&-4097|2,ot=!1,kn=t}}}function rv(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;kn=t}function zc(t){if(t!==kn)return!1;if(!ot)return rv(t),ot=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Qp(t.type,t.memoizedProps)),e&&(e=Rn)){if(em(t))throw fS(),Error(ee(418));for(;e;)hS(t,e),e=Li(e.nextSibling)}if(rv(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ee(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Rn=Li(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Rn=null}}else Rn=kn?Li(t.stateNode.nextSibling):null;return!0}function fS(){for(var t=Rn;t;)t=Li(t.nextSibling)}function ga(){Rn=kn=null,ot=!1}function Mg(t){er===null?er=[t]:er.push(t)}var ZP=ti.ReactCurrentBatchConfig;function yl(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ee(309));var r=n.stateNode}if(!r)throw Error(ee(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(ee(284));if(!n._owner)throw Error(ee(290,t))}return t}function $c(t,e){throw t=Object.prototype.toString.call(e),Error(ee(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function iv(t){var e=t._init;return e(t._payload)}function pS(t){function e(S,I){if(t){var R=S.deletions;R===null?(S.deletions=[I],S.flags|=16):R.push(I)}}function n(S,I){if(!t)return null;for(;I!==null;)e(S,I),I=I.sibling;return null}function r(S,I){for(S=new Map;I!==null;)I.key!==null?S.set(I.key,I):S.set(I.index,I),I=I.sibling;return S}function i(S,I){return S=Bi(S,I),S.index=0,S.sibling=null,S}function s(S,I,R){return S.index=R,t?(R=S.alternate,R!==null?(R=R.index,R<I?(S.flags|=2,I):R):(S.flags|=2,I)):(S.flags|=1048576,I)}function o(S){return t&&S.alternate===null&&(S.flags|=2),S}function a(S,I,R,V){return I===null||I.tag!==6?(I=up(R,S.mode,V),I.return=S,I):(I=i(I,R),I.return=S,I)}function l(S,I,R,V){var U=R.type;return U===qo?f(S,I,R.props.children,V,R.key):I!==null&&(I.elementType===U||typeof U=="object"&&U!==null&&U.$$typeof===Ii&&iv(U)===I.type)?(V=i(I,R.props),V.ref=yl(S,I,R),V.return=S,V):(V=md(R.type,R.key,R.props,null,S.mode,V),V.ref=yl(S,I,R),V.return=S,V)}function u(S,I,R,V){return I===null||I.tag!==4||I.stateNode.containerInfo!==R.containerInfo||I.stateNode.implementation!==R.implementation?(I=cp(R,S.mode,V),I.return=S,I):(I=i(I,R.children||[]),I.return=S,I)}function f(S,I,R,V,U){return I===null||I.tag!==7?(I=Hs(R,S.mode,V,U),I.return=S,I):(I=i(I,R),I.return=S,I)}function m(S,I,R){if(typeof I=="string"&&I!==""||typeof I=="number")return I=up(""+I,S.mode,R),I.return=S,I;if(typeof I=="object"&&I!==null){switch(I.$$typeof){case bc:return R=md(I.type,I.key,I.props,null,S.mode,R),R.ref=yl(S,null,I),R.return=S,R;case Go:return I=cp(I,S.mode,R),I.return=S,I;case Ii:var V=I._init;return m(S,V(I._payload),R)}if(Rl(I)||fl(I))return I=Hs(I,S.mode,R,null),I.return=S,I;$c(S,I)}return null}function g(S,I,R,V){var U=I!==null?I.key:null;if(typeof R=="string"&&R!==""||typeof R=="number")return U!==null?null:a(S,I,""+R,V);if(typeof R=="object"&&R!==null){switch(R.$$typeof){case bc:return R.key===U?l(S,I,R,V):null;case Go:return R.key===U?u(S,I,R,V):null;case Ii:return U=R._init,g(S,I,U(R._payload),V)}if(Rl(R)||fl(R))return U!==null?null:f(S,I,R,V,null);$c(S,R)}return null}function v(S,I,R,V,U){if(typeof V=="string"&&V!==""||typeof V=="number")return S=S.get(R)||null,a(I,S,""+V,U);if(typeof V=="object"&&V!==null){switch(V.$$typeof){case bc:return S=S.get(V.key===null?R:V.key)||null,l(I,S,V,U);case Go:return S=S.get(V.key===null?R:V.key)||null,u(I,S,V,U);case Ii:var B=V._init;return v(S,I,R,B(V._payload),U)}if(Rl(V)||fl(V))return S=S.get(R)||null,f(I,S,V,U,null);$c(I,V)}return null}function T(S,I,R,V){for(var U=null,B=null,E=I,w=I=0,C=null;E!==null&&w<R.length;w++){E.index>w?(C=E,E=null):C=E.sibling;var k=g(S,E,R[w],V);if(k===null){E===null&&(E=C);break}t&&E&&k.alternate===null&&e(S,E),I=s(k,I,w),B===null?U=k:B.sibling=k,B=k,E=C}if(w===R.length)return n(S,E),ot&&ks(S,w),U;if(E===null){for(;w<R.length;w++)E=m(S,R[w],V),E!==null&&(I=s(E,I,w),B===null?U=E:B.sibling=E,B=E);return ot&&ks(S,w),U}for(E=r(S,E);w<R.length;w++)C=v(E,S,w,R[w],V),C!==null&&(t&&C.alternate!==null&&E.delete(C.key===null?w:C.key),I=s(C,I,w),B===null?U=C:B.sibling=C,B=C);return t&&E.forEach(function(M){return e(S,M)}),ot&&ks(S,w),U}function P(S,I,R,V){var U=fl(R);if(typeof U!="function")throw Error(ee(150));if(R=U.call(R),R==null)throw Error(ee(151));for(var B=U=null,E=I,w=I=0,C=null,k=R.next();E!==null&&!k.done;w++,k=R.next()){E.index>w?(C=E,E=null):C=E.sibling;var M=g(S,E,k.value,V);if(M===null){E===null&&(E=C);break}t&&E&&M.alternate===null&&e(S,E),I=s(M,I,w),B===null?U=M:B.sibling=M,B=M,E=C}if(k.done)return n(S,E),ot&&ks(S,w),U;if(E===null){for(;!k.done;w++,k=R.next())k=m(S,k.value,V),k!==null&&(I=s(k,I,w),B===null?U=k:B.sibling=k,B=k);return ot&&ks(S,w),U}for(E=r(S,E);!k.done;w++,k=R.next())k=v(E,S,w,k.value,V),k!==null&&(t&&k.alternate!==null&&E.delete(k.key===null?w:k.key),I=s(k,I,w),B===null?U=k:B.sibling=k,B=k);return t&&E.forEach(function(L){return e(S,L)}),ot&&ks(S,w),U}function D(S,I,R,V){if(typeof R=="object"&&R!==null&&R.type===qo&&R.key===null&&(R=R.props.children),typeof R=="object"&&R!==null){switch(R.$$typeof){case bc:e:{for(var U=R.key,B=I;B!==null;){if(B.key===U){if(U=R.type,U===qo){if(B.tag===7){n(S,B.sibling),I=i(B,R.props.children),I.return=S,S=I;break e}}else if(B.elementType===U||typeof U=="object"&&U!==null&&U.$$typeof===Ii&&iv(U)===B.type){n(S,B.sibling),I=i(B,R.props),I.ref=yl(S,B,R),I.return=S,S=I;break e}n(S,B);break}else e(S,B);B=B.sibling}R.type===qo?(I=Hs(R.props.children,S.mode,V,R.key),I.return=S,S=I):(V=md(R.type,R.key,R.props,null,S.mode,V),V.ref=yl(S,I,R),V.return=S,S=V)}return o(S);case Go:e:{for(B=R.key;I!==null;){if(I.key===B)if(I.tag===4&&I.stateNode.containerInfo===R.containerInfo&&I.stateNode.implementation===R.implementation){n(S,I.sibling),I=i(I,R.children||[]),I.return=S,S=I;break e}else{n(S,I);break}else e(S,I);I=I.sibling}I=cp(R,S.mode,V),I.return=S,S=I}return o(S);case Ii:return B=R._init,D(S,I,B(R._payload),V)}if(Rl(R))return T(S,I,R,V);if(fl(R))return P(S,I,R,V);$c(S,R)}return typeof R=="string"&&R!==""||typeof R=="number"?(R=""+R,I!==null&&I.tag===6?(n(S,I.sibling),I=i(I,R),I.return=S,S=I):(n(S,I),I=up(R,S.mode,V),I.return=S,S=I),o(S)):n(S,I)}return D}var _a=pS(!0),mS=pS(!1),Wd=is(null),jd=null,Qo=null,Vg=null;function Lg(){Vg=Qo=jd=null}function Fg(t){var e=Wd.current;nt(Wd),t._currentValue=e}function nm(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function sa(t,e){jd=t,Vg=Qo=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(pn=!0),t.firstContext=null)}function jn(t){var e=t._currentValue;if(Vg!==t)if(t={context:t,memoizedValue:e,next:null},Qo===null){if(jd===null)throw Error(ee(308));Qo=t,jd.dependencies={lanes:0,firstContext:t}}else Qo=Qo.next=t;return e}var Bs=null;function Ug(t){Bs===null?Bs=[t]:Bs.push(t)}function gS(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,Ug(e)):(n.next=i.next,i.next=n),e.interleaved=n,Jr(t,r)}function Jr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var wi=!1;function Og(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function _S(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Hr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Fi(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Be&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Jr(t,n)}return i=r.interleaved,i===null?(e.next=e,Ug(r)):(e.next=i.next,i.next=e),r.interleaved=e,Jr(t,n)}function ud(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Sg(t,n)}}function sv(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Kd(t,e,n,r){var i=t.updateQueue;wi=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?s=u:o.next=u,o=l;var f=t.alternate;f!==null&&(f=f.updateQueue,a=f.lastBaseUpdate,a!==o&&(a===null?f.firstBaseUpdate=u:a.next=u,f.lastBaseUpdate=l))}if(s!==null){var m=i.baseState;o=0,f=u=l=null,a=s;do{var g=a.lane,v=a.eventTime;if((r&g)===g){f!==null&&(f=f.next={eventTime:v,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var T=t,P=a;switch(g=e,v=n,P.tag){case 1:if(T=P.payload,typeof T=="function"){m=T.call(v,m,g);break e}m=T;break e;case 3:T.flags=T.flags&-65537|128;case 0:if(T=P.payload,g=typeof T=="function"?T.call(v,m,g):T,g==null)break e;m=mt({},m,g);break e;case 2:wi=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,g=i.effects,g===null?i.effects=[a]:g.push(a))}else v={eventTime:v,lane:g,tag:a.tag,payload:a.payload,callback:a.callback,next:null},f===null?(u=f=v,l=m):f=f.next=v,o|=g;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;g=a,a=g.next,g.next=null,i.lastBaseUpdate=g,i.shared.pending=null}}while(!0);if(f===null&&(l=m),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=f,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);eo|=o,t.lanes=o,t.memoizedState=m}}function ov(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(ee(191,i));i.call(r)}}}var Bu={},wr=is(Bu),gu=is(Bu),_u=is(Bu);function Gs(t){if(t===Bu)throw Error(ee(174));return t}function Bg(t,e){switch(Ze(_u,e),Ze(gu,t),Ze(wr,Bu),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Lp(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Lp(e,t)}nt(wr),Ze(wr,e)}function ya(){nt(wr),nt(gu),nt(_u)}function yS(t){Gs(_u.current);var e=Gs(wr.current),n=Lp(e,t.type);e!==n&&(Ze(gu,t),Ze(wr,n))}function Gg(t){gu.current===t&&(nt(wr),nt(gu))}var ht=is(0);function Jd(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var rp=[];function qg(){for(var t=0;t<rp.length;t++)rp[t]._workInProgressVersionPrimary=null;rp.length=0}var cd=ti.ReactCurrentDispatcher,ip=ti.ReactCurrentBatchConfig,Zs=0,pt=null,kt=null,Ot=null,Qd=!1,ql=!1,yu=0,ek=0;function jt(){throw Error(ee(321))}function zg(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!lr(t[n],e[n]))return!1;return!0}function $g(t,e,n,r,i,s){if(Zs=s,pt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,cd.current=t===null||t.memoizedState===null?ik:sk,t=n(r,i),ql){s=0;do{if(ql=!1,yu=0,25<=s)throw Error(ee(301));s+=1,Ot=kt=null,e.updateQueue=null,cd.current=ok,t=n(r,i)}while(ql)}if(cd.current=Yd,e=kt!==null&&kt.next!==null,Zs=0,Ot=kt=pt=null,Qd=!1,e)throw Error(ee(300));return t}function Hg(){var t=yu!==0;return yu=0,t}function _r(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ot===null?pt.memoizedState=Ot=t:Ot=Ot.next=t,Ot}function Kn(){if(kt===null){var t=pt.alternate;t=t!==null?t.memoizedState:null}else t=kt.next;var e=Ot===null?pt.memoizedState:Ot.next;if(e!==null)Ot=e,kt=t;else{if(t===null)throw Error(ee(310));kt=t,t={memoizedState:kt.memoizedState,baseState:kt.baseState,baseQueue:kt.baseQueue,queue:kt.queue,next:null},Ot===null?pt.memoizedState=Ot=t:Ot=Ot.next=t}return Ot}function vu(t,e){return typeof e=="function"?e(t):e}function sp(t){var e=Kn(),n=e.queue;if(n===null)throw Error(ee(311));n.lastRenderedReducer=t;var r=kt,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,l=null,u=s;do{var f=u.lane;if((Zs&f)===f)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var m={lane:f,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=m,o=r):l=l.next=m,pt.lanes|=f,eo|=f}u=u.next}while(u!==null&&u!==s);l===null?o=r:l.next=a,lr(r,e.memoizedState)||(pn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,pt.lanes|=s,eo|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function op(t){var e=Kn(),n=e.queue;if(n===null)throw Error(ee(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);lr(s,e.memoizedState)||(pn=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function vS(){}function TS(t,e){var n=pt,r=Kn(),i=e(),s=!lr(r.memoizedState,i);if(s&&(r.memoizedState=i,pn=!0),r=r.queue,Wg(wS.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||Ot!==null&&Ot.memoizedState.tag&1){if(n.flags|=2048,Tu(9,IS.bind(null,n,r,i,e),void 0,null),Bt===null)throw Error(ee(349));Zs&30||ES(n,e,i)}return i}function ES(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=pt.updateQueue,e===null?(e={lastEffect:null,stores:null},pt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function IS(t,e,n,r){e.value=n,e.getSnapshot=r,SS(e)&&CS(t)}function wS(t,e,n){return n(function(){SS(e)&&CS(t)})}function SS(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!lr(t,n)}catch{return!0}}function CS(t){var e=Jr(t,1);e!==null&&ir(e,t,1,-1)}function av(t){var e=_r();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:vu,lastRenderedState:t},e.queue=t,t=t.dispatch=rk.bind(null,pt,t),[e.memoizedState,t]}function Tu(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=pt.updateQueue,e===null?(e={lastEffect:null,stores:null},pt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function AS(){return Kn().memoizedState}function dd(t,e,n,r){var i=_r();pt.flags|=t,i.memoizedState=Tu(1|e,n,void 0,r===void 0?null:r)}function Oh(t,e,n,r){var i=Kn();r=r===void 0?null:r;var s=void 0;if(kt!==null){var o=kt.memoizedState;if(s=o.destroy,r!==null&&zg(r,o.deps)){i.memoizedState=Tu(e,n,s,r);return}}pt.flags|=t,i.memoizedState=Tu(1|e,n,s,r)}function lv(t,e){return dd(8390656,8,t,e)}function Wg(t,e){return Oh(2048,8,t,e)}function xS(t,e){return Oh(4,2,t,e)}function RS(t,e){return Oh(4,4,t,e)}function PS(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function kS(t,e,n){return n=n!=null?n.concat([t]):null,Oh(4,4,PS.bind(null,e,t),n)}function jg(){}function NS(t,e){var n=Kn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&zg(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function DS(t,e){var n=Kn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&zg(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function bS(t,e,n){return Zs&21?(lr(n,e)||(n=Uw(),pt.lanes|=n,eo|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,pn=!0),t.memoizedState=n)}function tk(t,e){var n=Qe;Qe=n!==0&&4>n?n:4,t(!0);var r=ip.transition;ip.transition={};try{t(!1),e()}finally{Qe=n,ip.transition=r}}function MS(){return Kn().memoizedState}function nk(t,e,n){var r=Oi(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},VS(t))LS(e,n);else if(n=gS(t,e,n,r),n!==null){var i=an();ir(n,t,r,i),FS(n,e,r)}}function rk(t,e,n){var r=Oi(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(VS(t))LS(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,lr(a,o)){var l=e.interleaved;l===null?(i.next=i,Ug(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=gS(t,e,i,r),n!==null&&(i=an(),ir(n,t,r,i),FS(n,e,r))}}function VS(t){var e=t.alternate;return t===pt||e!==null&&e===pt}function LS(t,e){ql=Qd=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function FS(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Sg(t,n)}}var Yd={readContext:jn,useCallback:jt,useContext:jt,useEffect:jt,useImperativeHandle:jt,useInsertionEffect:jt,useLayoutEffect:jt,useMemo:jt,useReducer:jt,useRef:jt,useState:jt,useDebugValue:jt,useDeferredValue:jt,useTransition:jt,useMutableSource:jt,useSyncExternalStore:jt,useId:jt,unstable_isNewReconciler:!1},ik={readContext:jn,useCallback:function(t,e){return _r().memoizedState=[t,e===void 0?null:e],t},useContext:jn,useEffect:lv,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,dd(4194308,4,PS.bind(null,e,t),n)},useLayoutEffect:function(t,e){return dd(4194308,4,t,e)},useInsertionEffect:function(t,e){return dd(4,2,t,e)},useMemo:function(t,e){var n=_r();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=_r();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=nk.bind(null,pt,t),[r.memoizedState,t]},useRef:function(t){var e=_r();return t={current:t},e.memoizedState=t},useState:av,useDebugValue:jg,useDeferredValue:function(t){return _r().memoizedState=t},useTransition:function(){var t=av(!1),e=t[0];return t=tk.bind(null,t[1]),_r().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=pt,i=_r();if(ot){if(n===void 0)throw Error(ee(407));n=n()}else{if(n=e(),Bt===null)throw Error(ee(349));Zs&30||ES(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,lv(wS.bind(null,r,s,t),[t]),r.flags|=2048,Tu(9,IS.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=_r(),e=Bt.identifierPrefix;if(ot){var n=Gr,r=Br;n=(r&~(1<<32-rr(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=yu++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=ek++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},sk={readContext:jn,useCallback:NS,useContext:jn,useEffect:Wg,useImperativeHandle:kS,useInsertionEffect:xS,useLayoutEffect:RS,useMemo:DS,useReducer:sp,useRef:AS,useState:function(){return sp(vu)},useDebugValue:jg,useDeferredValue:function(t){var e=Kn();return bS(e,kt.memoizedState,t)},useTransition:function(){var t=sp(vu)[0],e=Kn().memoizedState;return[t,e]},useMutableSource:vS,useSyncExternalStore:TS,useId:MS,unstable_isNewReconciler:!1},ok={readContext:jn,useCallback:NS,useContext:jn,useEffect:Wg,useImperativeHandle:kS,useInsertionEffect:xS,useLayoutEffect:RS,useMemo:DS,useReducer:op,useRef:AS,useState:function(){return op(vu)},useDebugValue:jg,useDeferredValue:function(t){var e=Kn();return kt===null?e.memoizedState=t:bS(e,kt.memoizedState,t)},useTransition:function(){var t=op(vu)[0],e=Kn().memoizedState;return[t,e]},useMutableSource:vS,useSyncExternalStore:TS,useId:MS,unstable_isNewReconciler:!1};function Yn(t,e){if(t&&t.defaultProps){e=mt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function rm(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:mt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Bh={isMounted:function(t){return(t=t._reactInternals)?fo(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=an(),i=Oi(t),s=Hr(r,i);s.payload=e,n!=null&&(s.callback=n),e=Fi(t,s,i),e!==null&&(ir(e,t,i,r),ud(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=an(),i=Oi(t),s=Hr(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=Fi(t,s,i),e!==null&&(ir(e,t,i,r),ud(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=an(),r=Oi(t),i=Hr(n,r);i.tag=2,e!=null&&(i.callback=e),e=Fi(t,i,r),e!==null&&(ir(e,t,r,n),ud(e,t,r))}};function uv(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!hu(n,r)||!hu(i,s):!0}function US(t,e,n){var r=!1,i=Ji,s=e.contextType;return typeof s=="object"&&s!==null?s=jn(s):(i=_n(e)?Ys:tn.current,r=e.contextTypes,s=(r=r!=null)?ma(t,i):Ji),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Bh,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function cv(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Bh.enqueueReplaceState(e,e.state,null)}function im(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},Og(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=jn(s):(s=_n(e)?Ys:tn.current,i.context=ma(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(rm(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Bh.enqueueReplaceState(i,i.state,null),Kd(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function va(t,e){try{var n="",r=e;do n+=MR(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function ap(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function sm(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var ak=typeof WeakMap=="function"?WeakMap:Map;function OS(t,e,n){n=Hr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Zd||(Zd=!0,mm=r),sm(t,e)},n}function BS(t,e,n){n=Hr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){sm(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){sm(t,e),typeof r!="function"&&(Ui===null?Ui=new Set([this]):Ui.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function dv(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new ak;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=Ek.bind(null,t,e,n),e.then(t,t))}function hv(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function fv(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Hr(-1,1),e.tag=2,Fi(n,e,1))),n.lanes|=1),t)}var lk=ti.ReactCurrentOwner,pn=!1;function rn(t,e,n,r){e.child=t===null?mS(e,null,n,r):_a(e,t.child,n,r)}function pv(t,e,n,r,i){n=n.render;var s=e.ref;return sa(e,i),r=$g(t,e,n,r,s,i),n=Hg(),t!==null&&!pn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Qr(t,e,i)):(ot&&n&&Dg(e),e.flags|=1,rn(t,e,r,i),e.child)}function mv(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!t_(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,GS(t,e,s,r,i)):(t=md(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:hu,n(o,r)&&t.ref===e.ref)return Qr(t,e,i)}return e.flags|=1,t=Bi(s,r),t.ref=e.ref,t.return=e,e.child=t}function GS(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(hu(s,r)&&t.ref===e.ref)if(pn=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(pn=!0);else return e.lanes=t.lanes,Qr(t,e,i)}return om(t,e,n,r,i)}function qS(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ze(Xo,Cn),Cn|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ze(Xo,Cn),Cn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,Ze(Xo,Cn),Cn|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,Ze(Xo,Cn),Cn|=r;return rn(t,e,i,n),e.child}function zS(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function om(t,e,n,r,i){var s=_n(n)?Ys:tn.current;return s=ma(e,s),sa(e,i),n=$g(t,e,n,r,s,i),r=Hg(),t!==null&&!pn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Qr(t,e,i)):(ot&&r&&Dg(e),e.flags|=1,rn(t,e,n,i),e.child)}function gv(t,e,n,r,i){if(_n(n)){var s=!0;zd(e)}else s=!1;if(sa(e,i),e.stateNode===null)hd(t,e),US(e,n,r),im(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=jn(u):(u=_n(n)?Ys:tn.current,u=ma(e,u));var f=n.getDerivedStateFromProps,m=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function";m||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==u)&&cv(e,o,r,u),wi=!1;var g=e.memoizedState;o.state=g,Kd(e,r,o,i),l=e.memoizedState,a!==r||g!==l||gn.current||wi?(typeof f=="function"&&(rm(e,n,f,r),l=e.memoizedState),(a=wi||uv(e,n,a,r,g,l,u))?(m||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=u,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,_S(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:Yn(e.type,a),o.props=u,m=e.pendingProps,g=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=jn(l):(l=_n(n)?Ys:tn.current,l=ma(e,l));var v=n.getDerivedStateFromProps;(f=typeof v=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==m||g!==l)&&cv(e,o,r,l),wi=!1,g=e.memoizedState,o.state=g,Kd(e,r,o,i);var T=e.memoizedState;a!==m||g!==T||gn.current||wi?(typeof v=="function"&&(rm(e,n,v,r),T=e.memoizedState),(u=wi||uv(e,n,u,r,g,T,l)||!1)?(f||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,T,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,T,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=T),o.props=r,o.state=T,o.context=l,r=u):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),r=!1)}return am(t,e,n,r,s,i)}function am(t,e,n,r,i,s){zS(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&tv(e,n,!1),Qr(t,e,s);r=e.stateNode,lk.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=_a(e,t.child,null,s),e.child=_a(e,null,a,s)):rn(t,e,a,s),e.memoizedState=r.state,i&&tv(e,n,!0),e.child}function $S(t){var e=t.stateNode;e.pendingContext?ev(t,e.pendingContext,e.pendingContext!==e.context):e.context&&ev(t,e.context,!1),Bg(t,e.containerInfo)}function _v(t,e,n,r,i){return ga(),Mg(i),e.flags|=256,rn(t,e,n,r),e.child}var lm={dehydrated:null,treeContext:null,retryLane:0};function um(t){return{baseLanes:t,cachePool:null,transitions:null}}function HS(t,e,n){var r=e.pendingProps,i=ht.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Ze(ht,i&1),t===null)return tm(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=zh(o,r,0,null),t=Hs(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=um(n),e.memoizedState=lm,t):Kg(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return uk(t,e,o,r,a,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Bi(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=Bi(a,s):(s=Hs(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?um(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=lm,r}return s=t.child,t=s.sibling,r=Bi(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Kg(t,e){return e=zh({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Hc(t,e,n,r){return r!==null&&Mg(r),_a(e,t.child,null,n),t=Kg(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function uk(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=ap(Error(ee(422))),Hc(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=zh({mode:"visible",children:r.children},i,0,null),s=Hs(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&_a(e,t.child,null,o),e.child.memoizedState=um(o),e.memoizedState=lm,s);if(!(e.mode&1))return Hc(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(ee(419)),r=ap(s,r,void 0),Hc(t,e,o,r)}if(a=(o&t.childLanes)!==0,pn||a){if(r=Bt,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Jr(t,i),ir(r,t,i,-1))}return e_(),r=ap(Error(ee(421))),Hc(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=Ik.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Rn=Li(i.nextSibling),kn=e,ot=!0,er=null,t!==null&&(On[Bn++]=Br,On[Bn++]=Gr,On[Bn++]=Xs,Br=t.id,Gr=t.overflow,Xs=e),e=Kg(e,r.children),e.flags|=4096,e)}function yv(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),nm(t.return,e,n)}function lp(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function WS(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(rn(t,e,r.children,n),r=ht.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&yv(t,n,e);else if(t.tag===19)yv(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Ze(ht,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&Jd(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),lp(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Jd(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}lp(e,!0,n,null,s);break;case"together":lp(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function hd(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Qr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),eo|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ee(153));if(e.child!==null){for(t=e.child,n=Bi(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Bi(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function ck(t,e,n){switch(e.tag){case 3:$S(e),ga();break;case 5:yS(e);break;case 1:_n(e.type)&&zd(e);break;case 4:Bg(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Ze(Wd,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Ze(ht,ht.current&1),e.flags|=128,null):n&e.child.childLanes?HS(t,e,n):(Ze(ht,ht.current&1),t=Qr(t,e,n),t!==null?t.sibling:null);Ze(ht,ht.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return WS(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ze(ht,ht.current),r)break;return null;case 22:case 23:return e.lanes=0,qS(t,e,n)}return Qr(t,e,n)}var jS,cm,KS,JS;jS=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};cm=function(){};KS=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Gs(wr.current);var s=null;switch(n){case"input":i=Dp(t,i),r=Dp(t,r),s=[];break;case"select":i=mt({},i,{value:void 0}),r=mt({},r,{value:void 0}),s=[];break;case"textarea":i=Vp(t,i),r=Vp(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Gd)}Fp(n,r);var o;n=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var a=i[u];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(su.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var l=r[u];if(a=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(su.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&et("scroll",t),s||a===l||(s=[])):(s=s||[]).push(u,l))}n&&(s=s||[]).push("style",n);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};JS=function(t,e,n,r){n!==r&&(e.flags|=4)};function vl(t,e){if(!ot)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Kt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function dk(t,e,n){var r=e.pendingProps;switch(bg(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Kt(e),null;case 1:return _n(e.type)&&qd(),Kt(e),null;case 3:return r=e.stateNode,ya(),nt(gn),nt(tn),qg(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(zc(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,er!==null&&(ym(er),er=null))),cm(t,e),Kt(e),null;case 5:Gg(e);var i=Gs(_u.current);if(n=e.type,t!==null&&e.stateNode!=null)KS(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(ee(166));return Kt(e),null}if(t=Gs(wr.current),zc(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[vr]=e,r[mu]=s,t=(e.mode&1)!==0,n){case"dialog":et("cancel",r),et("close",r);break;case"iframe":case"object":case"embed":et("load",r);break;case"video":case"audio":for(i=0;i<kl.length;i++)et(kl[i],r);break;case"source":et("error",r);break;case"img":case"image":case"link":et("error",r),et("load",r);break;case"details":et("toggle",r);break;case"input":xy(r,s),et("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},et("invalid",r);break;case"textarea":Py(r,s),et("invalid",r)}Fp(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&qc(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&qc(r.textContent,a,t),i=["children",""+a]):su.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&et("scroll",r)}switch(n){case"input":Mc(r),Ry(r,s,!0);break;case"textarea":Mc(r),ky(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=Gd)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=ww(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[vr]=e,t[mu]=r,jS(t,e,!1,!1),e.stateNode=t;e:{switch(o=Up(n,r),n){case"dialog":et("cancel",t),et("close",t),i=r;break;case"iframe":case"object":case"embed":et("load",t),i=r;break;case"video":case"audio":for(i=0;i<kl.length;i++)et(kl[i],t);i=r;break;case"source":et("error",t),i=r;break;case"img":case"image":case"link":et("error",t),et("load",t),i=r;break;case"details":et("toggle",t),i=r;break;case"input":xy(t,r),i=Dp(t,r),et("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=mt({},r,{value:void 0}),et("invalid",t);break;case"textarea":Py(t,r),i=Vp(t,r),et("invalid",t);break;default:i=r}Fp(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?Aw(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Sw(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&ou(t,l):typeof l=="number"&&ou(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(su.hasOwnProperty(s)?l!=null&&s==="onScroll"&&et("scroll",t):l!=null&&yg(t,s,l,o))}switch(n){case"input":Mc(t),Ry(t,r,!1);break;case"textarea":Mc(t),ky(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Ki(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?ta(t,!!r.multiple,s,!1):r.defaultValue!=null&&ta(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Gd)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Kt(e),null;case 6:if(t&&e.stateNode!=null)JS(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(ee(166));if(n=Gs(_u.current),Gs(wr.current),zc(e)){if(r=e.stateNode,n=e.memoizedProps,r[vr]=e,(s=r.nodeValue!==n)&&(t=kn,t!==null))switch(t.tag){case 3:qc(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&qc(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[vr]=e,e.stateNode=r}return Kt(e),null;case 13:if(nt(ht),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ot&&Rn!==null&&e.mode&1&&!(e.flags&128))fS(),ga(),e.flags|=98560,s=!1;else if(s=zc(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(ee(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ee(317));s[vr]=e}else ga(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Kt(e),s=!1}else er!==null&&(ym(er),er=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||ht.current&1?Nt===0&&(Nt=3):e_())),e.updateQueue!==null&&(e.flags|=4),Kt(e),null);case 4:return ya(),cm(t,e),t===null&&fu(e.stateNode.containerInfo),Kt(e),null;case 10:return Fg(e.type._context),Kt(e),null;case 17:return _n(e.type)&&qd(),Kt(e),null;case 19:if(nt(ht),s=e.memoizedState,s===null)return Kt(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)vl(s,!1);else{if(Nt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Jd(t),o!==null){for(e.flags|=128,vl(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Ze(ht,ht.current&1|2),e.child}t=t.sibling}s.tail!==null&&Tt()>Ta&&(e.flags|=128,r=!0,vl(s,!1),e.lanes=4194304)}else{if(!r)if(t=Jd(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),vl(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!ot)return Kt(e),null}else 2*Tt()-s.renderingStartTime>Ta&&n!==1073741824&&(e.flags|=128,r=!0,vl(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Tt(),e.sibling=null,n=ht.current,Ze(ht,r?n&1|2:n&1),e):(Kt(e),null);case 22:case 23:return Zg(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Cn&1073741824&&(Kt(e),e.subtreeFlags&6&&(e.flags|=8192)):Kt(e),null;case 24:return null;case 25:return null}throw Error(ee(156,e.tag))}function hk(t,e){switch(bg(e),e.tag){case 1:return _n(e.type)&&qd(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return ya(),nt(gn),nt(tn),qg(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Gg(e),null;case 13:if(nt(ht),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ee(340));ga()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return nt(ht),null;case 4:return ya(),null;case 10:return Fg(e.type._context),null;case 22:case 23:return Zg(),null;case 24:return null;default:return null}}var Wc=!1,Yt=!1,fk=typeof WeakSet=="function"?WeakSet:Set,ue=null;function Yo(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){_t(t,e,r)}else n.current=null}function dm(t,e,n){try{n()}catch(r){_t(t,e,r)}}var vv=!1;function pk(t,e){if(Kp=Ud,t=eS(),Ng(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,u=0,f=0,m=t,g=null;t:for(;;){for(var v;m!==n||i!==0&&m.nodeType!==3||(a=o+i),m!==s||r!==0&&m.nodeType!==3||(l=o+r),m.nodeType===3&&(o+=m.nodeValue.length),(v=m.firstChild)!==null;)g=m,m=v;for(;;){if(m===t)break t;if(g===n&&++u===i&&(a=o),g===s&&++f===r&&(l=o),(v=m.nextSibling)!==null)break;m=g,g=m.parentNode}m=v}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(Jp={focusedElem:t,selectionRange:n},Ud=!1,ue=e;ue!==null;)if(e=ue,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ue=t;else for(;ue!==null;){e=ue;try{var T=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(T!==null){var P=T.memoizedProps,D=T.memoizedState,S=e.stateNode,I=S.getSnapshotBeforeUpdate(e.elementType===e.type?P:Yn(e.type,P),D);S.__reactInternalSnapshotBeforeUpdate=I}break;case 3:var R=e.stateNode.containerInfo;R.nodeType===1?R.textContent="":R.nodeType===9&&R.documentElement&&R.removeChild(R.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ee(163))}}catch(V){_t(e,e.return,V)}if(t=e.sibling,t!==null){t.return=e.return,ue=t;break}ue=e.return}return T=vv,vv=!1,T}function zl(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&dm(e,n,s)}i=i.next}while(i!==r)}}function Gh(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function hm(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function QS(t){var e=t.alternate;e!==null&&(t.alternate=null,QS(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[vr],delete e[mu],delete e[Xp],delete e[QP],delete e[YP])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function YS(t){return t.tag===5||t.tag===3||t.tag===4}function Tv(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||YS(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function fm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Gd));else if(r!==4&&(t=t.child,t!==null))for(fm(t,e,n),t=t.sibling;t!==null;)fm(t,e,n),t=t.sibling}function pm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(pm(t,e,n),t=t.sibling;t!==null;)pm(t,e,n),t=t.sibling}var qt=null,Xn=!1;function mi(t,e,n){for(n=n.child;n!==null;)XS(t,e,n),n=n.sibling}function XS(t,e,n){if(Ir&&typeof Ir.onCommitFiberUnmount=="function")try{Ir.onCommitFiberUnmount(bh,n)}catch{}switch(n.tag){case 5:Yt||Yo(n,e);case 6:var r=qt,i=Xn;qt=null,mi(t,e,n),qt=r,Xn=i,qt!==null&&(Xn?(t=qt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):qt.removeChild(n.stateNode));break;case 18:qt!==null&&(Xn?(t=qt,n=n.stateNode,t.nodeType===8?tp(t.parentNode,n):t.nodeType===1&&tp(t,n),cu(t)):tp(qt,n.stateNode));break;case 4:r=qt,i=Xn,qt=n.stateNode.containerInfo,Xn=!0,mi(t,e,n),qt=r,Xn=i;break;case 0:case 11:case 14:case 15:if(!Yt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&dm(n,e,o),i=i.next}while(i!==r)}mi(t,e,n);break;case 1:if(!Yt&&(Yo(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){_t(n,e,a)}mi(t,e,n);break;case 21:mi(t,e,n);break;case 22:n.mode&1?(Yt=(r=Yt)||n.memoizedState!==null,mi(t,e,n),Yt=r):mi(t,e,n);break;default:mi(t,e,n)}}function Ev(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new fk),e.forEach(function(r){var i=wk.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Qn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:qt=a.stateNode,Xn=!1;break e;case 3:qt=a.stateNode.containerInfo,Xn=!0;break e;case 4:qt=a.stateNode.containerInfo,Xn=!0;break e}a=a.return}if(qt===null)throw Error(ee(160));XS(s,o,i),qt=null,Xn=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){_t(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)ZS(e,t),e=e.sibling}function ZS(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Qn(e,t),gr(t),r&4){try{zl(3,t,t.return),Gh(3,t)}catch(P){_t(t,t.return,P)}try{zl(5,t,t.return)}catch(P){_t(t,t.return,P)}}break;case 1:Qn(e,t),gr(t),r&512&&n!==null&&Yo(n,n.return);break;case 5:if(Qn(e,t),gr(t),r&512&&n!==null&&Yo(n,n.return),t.flags&32){var i=t.stateNode;try{ou(i,"")}catch(P){_t(t,t.return,P)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&Ew(i,s),Up(a,o);var u=Up(a,s);for(o=0;o<l.length;o+=2){var f=l[o],m=l[o+1];f==="style"?Aw(i,m):f==="dangerouslySetInnerHTML"?Sw(i,m):f==="children"?ou(i,m):yg(i,f,m,u)}switch(a){case"input":bp(i,s);break;case"textarea":Iw(i,s);break;case"select":var g=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var v=s.value;v!=null?ta(i,!!s.multiple,v,!1):g!==!!s.multiple&&(s.defaultValue!=null?ta(i,!!s.multiple,s.defaultValue,!0):ta(i,!!s.multiple,s.multiple?[]:"",!1))}i[mu]=s}catch(P){_t(t,t.return,P)}}break;case 6:if(Qn(e,t),gr(t),r&4){if(t.stateNode===null)throw Error(ee(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(P){_t(t,t.return,P)}}break;case 3:if(Qn(e,t),gr(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{cu(e.containerInfo)}catch(P){_t(t,t.return,P)}break;case 4:Qn(e,t),gr(t);break;case 13:Qn(e,t),gr(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Yg=Tt())),r&4&&Ev(t);break;case 22:if(f=n!==null&&n.memoizedState!==null,t.mode&1?(Yt=(u=Yt)||f,Qn(e,t),Yt=u):Qn(e,t),gr(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!f&&t.mode&1)for(ue=t,f=t.child;f!==null;){for(m=ue=f;ue!==null;){switch(g=ue,v=g.child,g.tag){case 0:case 11:case 14:case 15:zl(4,g,g.return);break;case 1:Yo(g,g.return);var T=g.stateNode;if(typeof T.componentWillUnmount=="function"){r=g,n=g.return;try{e=r,T.props=e.memoizedProps,T.state=e.memoizedState,T.componentWillUnmount()}catch(P){_t(r,n,P)}}break;case 5:Yo(g,g.return);break;case 22:if(g.memoizedState!==null){wv(m);continue}}v!==null?(v.return=g,ue=v):wv(m)}f=f.sibling}e:for(f=null,m=t;;){if(m.tag===5){if(f===null){f=m;try{i=m.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=m.stateNode,l=m.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=Cw("display",o))}catch(P){_t(t,t.return,P)}}}else if(m.tag===6){if(f===null)try{m.stateNode.nodeValue=u?"":m.memoizedProps}catch(P){_t(t,t.return,P)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===t)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===t)break e;for(;m.sibling===null;){if(m.return===null||m.return===t)break e;f===m&&(f=null),m=m.return}f===m&&(f=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:Qn(e,t),gr(t),r&4&&Ev(t);break;case 21:break;default:Qn(e,t),gr(t)}}function gr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(YS(n)){var r=n;break e}n=n.return}throw Error(ee(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(ou(i,""),r.flags&=-33);var s=Tv(t);pm(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=Tv(t);fm(t,a,o);break;default:throw Error(ee(161))}}catch(l){_t(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function mk(t,e,n){ue=t,eC(t)}function eC(t,e,n){for(var r=(t.mode&1)!==0;ue!==null;){var i=ue,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||Wc;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||Yt;a=Wc;var u=Yt;if(Wc=o,(Yt=l)&&!u)for(ue=i;ue!==null;)o=ue,l=o.child,o.tag===22&&o.memoizedState!==null?Sv(i):l!==null?(l.return=o,ue=l):Sv(i);for(;s!==null;)ue=s,eC(s),s=s.sibling;ue=i,Wc=a,Yt=u}Iv(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,ue=s):Iv(t)}}function Iv(t){for(;ue!==null;){var e=ue;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Yt||Gh(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Yt)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Yn(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&ov(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}ov(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var f=u.memoizedState;if(f!==null){var m=f.dehydrated;m!==null&&cu(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ee(163))}Yt||e.flags&512&&hm(e)}catch(g){_t(e,e.return,g)}}if(e===t){ue=null;break}if(n=e.sibling,n!==null){n.return=e.return,ue=n;break}ue=e.return}}function wv(t){for(;ue!==null;){var e=ue;if(e===t){ue=null;break}var n=e.sibling;if(n!==null){n.return=e.return,ue=n;break}ue=e.return}}function Sv(t){for(;ue!==null;){var e=ue;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Gh(4,e)}catch(l){_t(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){_t(e,i,l)}}var s=e.return;try{hm(e)}catch(l){_t(e,s,l)}break;case 5:var o=e.return;try{hm(e)}catch(l){_t(e,o,l)}}}catch(l){_t(e,e.return,l)}if(e===t){ue=null;break}var a=e.sibling;if(a!==null){a.return=e.return,ue=a;break}ue=e.return}}var gk=Math.ceil,Xd=ti.ReactCurrentDispatcher,Jg=ti.ReactCurrentOwner,$n=ti.ReactCurrentBatchConfig,Be=0,Bt=null,At=null,Ht=0,Cn=0,Xo=is(0),Nt=0,Eu=null,eo=0,qh=0,Qg=0,$l=null,fn=null,Yg=0,Ta=1/0,Fr=null,Zd=!1,mm=null,Ui=null,jc=!1,Ni=null,eh=0,Hl=0,gm=null,fd=-1,pd=0;function an(){return Be&6?Tt():fd!==-1?fd:fd=Tt()}function Oi(t){return t.mode&1?Be&2&&Ht!==0?Ht&-Ht:ZP.transition!==null?(pd===0&&(pd=Uw()),pd):(t=Qe,t!==0||(t=window.event,t=t===void 0?16:Hw(t.type)),t):1}function ir(t,e,n,r){if(50<Hl)throw Hl=0,gm=null,Error(ee(185));Fu(t,n,r),(!(Be&2)||t!==Bt)&&(t===Bt&&(!(Be&2)&&(qh|=n),Nt===4&&Ci(t,Ht)),yn(t,r),n===1&&Be===0&&!(e.mode&1)&&(Ta=Tt()+500,Uh&&ss()))}function yn(t,e){var n=t.callbackNode;ZR(t,e);var r=Fd(t,t===Bt?Ht:0);if(r===0)n!==null&&by(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&by(n),e===1)t.tag===0?XP(Cv.bind(null,t)):cS(Cv.bind(null,t)),KP(function(){!(Be&6)&&ss()}),n=null;else{switch(Ow(r)){case 1:n=wg;break;case 4:n=Lw;break;case 16:n=Ld;break;case 536870912:n=Fw;break;default:n=Ld}n=lC(n,tC.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function tC(t,e){if(fd=-1,pd=0,Be&6)throw Error(ee(327));var n=t.callbackNode;if(oa()&&t.callbackNode!==n)return null;var r=Fd(t,t===Bt?Ht:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=th(t,r);else{e=r;var i=Be;Be|=2;var s=rC();(Bt!==t||Ht!==e)&&(Fr=null,Ta=Tt()+500,$s(t,e));do try{vk();break}catch(a){nC(t,a)}while(!0);Lg(),Xd.current=s,Be=i,At!==null?e=0:(Bt=null,Ht=0,e=Nt)}if(e!==0){if(e===2&&(i=zp(t),i!==0&&(r=i,e=_m(t,i))),e===1)throw n=Eu,$s(t,0),Ci(t,r),yn(t,Tt()),n;if(e===6)Ci(t,r);else{if(i=t.current.alternate,!(r&30)&&!_k(i)&&(e=th(t,r),e===2&&(s=zp(t),s!==0&&(r=s,e=_m(t,s))),e===1))throw n=Eu,$s(t,0),Ci(t,r),yn(t,Tt()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(ee(345));case 2:Ns(t,fn,Fr);break;case 3:if(Ci(t,r),(r&130023424)===r&&(e=Yg+500-Tt(),10<e)){if(Fd(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){an(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Yp(Ns.bind(null,t,fn,Fr),e);break}Ns(t,fn,Fr);break;case 4:if(Ci(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-rr(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=Tt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*gk(r/1960))-r,10<r){t.timeoutHandle=Yp(Ns.bind(null,t,fn,Fr),r);break}Ns(t,fn,Fr);break;case 5:Ns(t,fn,Fr);break;default:throw Error(ee(329))}}}return yn(t,Tt()),t.callbackNode===n?tC.bind(null,t):null}function _m(t,e){var n=$l;return t.current.memoizedState.isDehydrated&&($s(t,e).flags|=256),t=th(t,e),t!==2&&(e=fn,fn=n,e!==null&&ym(e)),t}function ym(t){fn===null?fn=t:fn.push.apply(fn,t)}function _k(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!lr(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Ci(t,e){for(e&=~Qg,e&=~qh,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-rr(e),r=1<<n;t[n]=-1,e&=~r}}function Cv(t){if(Be&6)throw Error(ee(327));oa();var e=Fd(t,0);if(!(e&1))return yn(t,Tt()),null;var n=th(t,e);if(t.tag!==0&&n===2){var r=zp(t);r!==0&&(e=r,n=_m(t,r))}if(n===1)throw n=Eu,$s(t,0),Ci(t,e),yn(t,Tt()),n;if(n===6)throw Error(ee(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ns(t,fn,Fr),yn(t,Tt()),null}function Xg(t,e){var n=Be;Be|=1;try{return t(e)}finally{Be=n,Be===0&&(Ta=Tt()+500,Uh&&ss())}}function to(t){Ni!==null&&Ni.tag===0&&!(Be&6)&&oa();var e=Be;Be|=1;var n=$n.transition,r=Qe;try{if($n.transition=null,Qe=1,t)return t()}finally{Qe=r,$n.transition=n,Be=e,!(Be&6)&&ss()}}function Zg(){Cn=Xo.current,nt(Xo)}function $s(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,jP(n)),At!==null)for(n=At.return;n!==null;){var r=n;switch(bg(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&qd();break;case 3:ya(),nt(gn),nt(tn),qg();break;case 5:Gg(r);break;case 4:ya();break;case 13:nt(ht);break;case 19:nt(ht);break;case 10:Fg(r.type._context);break;case 22:case 23:Zg()}n=n.return}if(Bt=t,At=t=Bi(t.current,null),Ht=Cn=e,Nt=0,Eu=null,Qg=qh=eo=0,fn=$l=null,Bs!==null){for(e=0;e<Bs.length;e++)if(n=Bs[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}Bs=null}return t}function nC(t,e){do{var n=At;try{if(Lg(),cd.current=Yd,Qd){for(var r=pt.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Qd=!1}if(Zs=0,Ot=kt=pt=null,ql=!1,yu=0,Jg.current=null,n===null||n.return===null){Nt=1,Eu=e,At=null;break}e:{var s=t,o=n.return,a=n,l=e;if(e=Ht,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,f=a,m=f.tag;if(!(f.mode&1)&&(m===0||m===11||m===15)){var g=f.alternate;g?(f.updateQueue=g.updateQueue,f.memoizedState=g.memoizedState,f.lanes=g.lanes):(f.updateQueue=null,f.memoizedState=null)}var v=hv(o);if(v!==null){v.flags&=-257,fv(v,o,a,s,e),v.mode&1&&dv(s,u,e),e=v,l=u;var T=e.updateQueue;if(T===null){var P=new Set;P.add(l),e.updateQueue=P}else T.add(l);break e}else{if(!(e&1)){dv(s,u,e),e_();break e}l=Error(ee(426))}}else if(ot&&a.mode&1){var D=hv(o);if(D!==null){!(D.flags&65536)&&(D.flags|=256),fv(D,o,a,s,e),Mg(va(l,a));break e}}s=l=va(l,a),Nt!==4&&(Nt=2),$l===null?$l=[s]:$l.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var S=OS(s,l,e);sv(s,S);break e;case 1:a=l;var I=s.type,R=s.stateNode;if(!(s.flags&128)&&(typeof I.getDerivedStateFromError=="function"||R!==null&&typeof R.componentDidCatch=="function"&&(Ui===null||!Ui.has(R)))){s.flags|=65536,e&=-e,s.lanes|=e;var V=BS(s,a,e);sv(s,V);break e}}s=s.return}while(s!==null)}sC(n)}catch(U){e=U,At===n&&n!==null&&(At=n=n.return);continue}break}while(!0)}function rC(){var t=Xd.current;return Xd.current=Yd,t===null?Yd:t}function e_(){(Nt===0||Nt===3||Nt===2)&&(Nt=4),Bt===null||!(eo&268435455)&&!(qh&268435455)||Ci(Bt,Ht)}function th(t,e){var n=Be;Be|=2;var r=rC();(Bt!==t||Ht!==e)&&(Fr=null,$s(t,e));do try{yk();break}catch(i){nC(t,i)}while(!0);if(Lg(),Be=n,Xd.current=r,At!==null)throw Error(ee(261));return Bt=null,Ht=0,Nt}function yk(){for(;At!==null;)iC(At)}function vk(){for(;At!==null&&!$R();)iC(At)}function iC(t){var e=aC(t.alternate,t,Cn);t.memoizedProps=t.pendingProps,e===null?sC(t):At=e,Jg.current=null}function sC(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=hk(n,e),n!==null){n.flags&=32767,At=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Nt=6,At=null;return}}else if(n=dk(n,e,Cn),n!==null){At=n;return}if(e=e.sibling,e!==null){At=e;return}At=e=t}while(e!==null);Nt===0&&(Nt=5)}function Ns(t,e,n){var r=Qe,i=$n.transition;try{$n.transition=null,Qe=1,Tk(t,e,n,r)}finally{$n.transition=i,Qe=r}return null}function Tk(t,e,n,r){do oa();while(Ni!==null);if(Be&6)throw Error(ee(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(ee(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(eP(t,s),t===Bt&&(At=Bt=null,Ht=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||jc||(jc=!0,lC(Ld,function(){return oa(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=$n.transition,$n.transition=null;var o=Qe;Qe=1;var a=Be;Be|=4,Jg.current=null,pk(t,n),ZS(n,t),BP(Jp),Ud=!!Kp,Jp=Kp=null,t.current=n,mk(n),HR(),Be=a,Qe=o,$n.transition=s}else t.current=n;if(jc&&(jc=!1,Ni=t,eh=i),s=t.pendingLanes,s===0&&(Ui=null),KR(n.stateNode),yn(t,Tt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Zd)throw Zd=!1,t=mm,mm=null,t;return eh&1&&t.tag!==0&&oa(),s=t.pendingLanes,s&1?t===gm?Hl++:(Hl=0,gm=t):Hl=0,ss(),null}function oa(){if(Ni!==null){var t=Ow(eh),e=$n.transition,n=Qe;try{if($n.transition=null,Qe=16>t?16:t,Ni===null)var r=!1;else{if(t=Ni,Ni=null,eh=0,Be&6)throw Error(ee(331));var i=Be;for(Be|=4,ue=t.current;ue!==null;){var s=ue,o=s.child;if(ue.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(ue=u;ue!==null;){var f=ue;switch(f.tag){case 0:case 11:case 15:zl(8,f,s)}var m=f.child;if(m!==null)m.return=f,ue=m;else for(;ue!==null;){f=ue;var g=f.sibling,v=f.return;if(QS(f),f===u){ue=null;break}if(g!==null){g.return=v,ue=g;break}ue=v}}}var T=s.alternate;if(T!==null){var P=T.child;if(P!==null){T.child=null;do{var D=P.sibling;P.sibling=null,P=D}while(P!==null)}}ue=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,ue=o;else e:for(;ue!==null;){if(s=ue,s.flags&2048)switch(s.tag){case 0:case 11:case 15:zl(9,s,s.return)}var S=s.sibling;if(S!==null){S.return=s.return,ue=S;break e}ue=s.return}}var I=t.current;for(ue=I;ue!==null;){o=ue;var R=o.child;if(o.subtreeFlags&2064&&R!==null)R.return=o,ue=R;else e:for(o=I;ue!==null;){if(a=ue,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Gh(9,a)}}catch(U){_t(a,a.return,U)}if(a===o){ue=null;break e}var V=a.sibling;if(V!==null){V.return=a.return,ue=V;break e}ue=a.return}}if(Be=i,ss(),Ir&&typeof Ir.onPostCommitFiberRoot=="function")try{Ir.onPostCommitFiberRoot(bh,t)}catch{}r=!0}return r}finally{Qe=n,$n.transition=e}}return!1}function Av(t,e,n){e=va(n,e),e=OS(t,e,1),t=Fi(t,e,1),e=an(),t!==null&&(Fu(t,1,e),yn(t,e))}function _t(t,e,n){if(t.tag===3)Av(t,t,n);else for(;e!==null;){if(e.tag===3){Av(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ui===null||!Ui.has(r))){t=va(n,t),t=BS(e,t,1),e=Fi(e,t,1),t=an(),e!==null&&(Fu(e,1,t),yn(e,t));break}}e=e.return}}function Ek(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=an(),t.pingedLanes|=t.suspendedLanes&n,Bt===t&&(Ht&n)===n&&(Nt===4||Nt===3&&(Ht&130023424)===Ht&&500>Tt()-Yg?$s(t,0):Qg|=n),yn(t,e)}function oC(t,e){e===0&&(t.mode&1?(e=Fc,Fc<<=1,!(Fc&130023424)&&(Fc=4194304)):e=1);var n=an();t=Jr(t,e),t!==null&&(Fu(t,e,n),yn(t,n))}function Ik(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),oC(t,n)}function wk(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(ee(314))}r!==null&&r.delete(e),oC(t,n)}var aC;aC=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||gn.current)pn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return pn=!1,ck(t,e,n);pn=!!(t.flags&131072)}else pn=!1,ot&&e.flags&1048576&&dS(e,Hd,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;hd(t,e),t=e.pendingProps;var i=ma(e,tn.current);sa(e,n),i=$g(null,e,r,t,i,n);var s=Hg();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,_n(r)?(s=!0,zd(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Og(e),i.updater=Bh,e.stateNode=i,i._reactInternals=e,im(e,r,t,n),e=am(null,e,r,!0,s,n)):(e.tag=0,ot&&s&&Dg(e),rn(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(hd(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=Ck(r),t=Yn(r,t),i){case 0:e=om(null,e,r,t,n);break e;case 1:e=gv(null,e,r,t,n);break e;case 11:e=pv(null,e,r,t,n);break e;case 14:e=mv(null,e,r,Yn(r.type,t),n);break e}throw Error(ee(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Yn(r,i),om(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Yn(r,i),gv(t,e,r,i,n);case 3:e:{if($S(e),t===null)throw Error(ee(387));r=e.pendingProps,s=e.memoizedState,i=s.element,_S(t,e),Kd(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=va(Error(ee(423)),e),e=_v(t,e,r,n,i);break e}else if(r!==i){i=va(Error(ee(424)),e),e=_v(t,e,r,n,i);break e}else for(Rn=Li(e.stateNode.containerInfo.firstChild),kn=e,ot=!0,er=null,n=mS(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(ga(),r===i){e=Qr(t,e,n);break e}rn(t,e,r,n)}e=e.child}return e;case 5:return yS(e),t===null&&tm(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,Qp(r,i)?o=null:s!==null&&Qp(r,s)&&(e.flags|=32),zS(t,e),rn(t,e,o,n),e.child;case 6:return t===null&&tm(e),null;case 13:return HS(t,e,n);case 4:return Bg(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=_a(e,null,r,n):rn(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Yn(r,i),pv(t,e,r,i,n);case 7:return rn(t,e,e.pendingProps,n),e.child;case 8:return rn(t,e,e.pendingProps.children,n),e.child;case 12:return rn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,Ze(Wd,r._currentValue),r._currentValue=o,s!==null)if(lr(s.value,o)){if(s.children===i.children&&!gn.current){e=Qr(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=Hr(-1,n&-n),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var f=u.pending;f===null?l.next=l:(l.next=f.next,f.next=l),u.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),nm(s.return,n,e),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(ee(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),nm(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}rn(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,sa(e,n),i=jn(i),r=r(i),e.flags|=1,rn(t,e,r,n),e.child;case 14:return r=e.type,i=Yn(r,e.pendingProps),i=Yn(r.type,i),mv(t,e,r,i,n);case 15:return GS(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Yn(r,i),hd(t,e),e.tag=1,_n(r)?(t=!0,zd(e)):t=!1,sa(e,n),US(e,r,i),im(e,r,i,n),am(null,e,r,!0,t,n);case 19:return WS(t,e,n);case 22:return qS(t,e,n)}throw Error(ee(156,e.tag))};function lC(t,e){return Vw(t,e)}function Sk(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Gn(t,e,n,r){return new Sk(t,e,n,r)}function t_(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Ck(t){if(typeof t=="function")return t_(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Tg)return 11;if(t===Eg)return 14}return 2}function Bi(t,e){var n=t.alternate;return n===null?(n=Gn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function md(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")t_(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case qo:return Hs(n.children,i,s,e);case vg:o=8,i|=8;break;case Rp:return t=Gn(12,n,e,i|2),t.elementType=Rp,t.lanes=s,t;case Pp:return t=Gn(13,n,e,i),t.elementType=Pp,t.lanes=s,t;case kp:return t=Gn(19,n,e,i),t.elementType=kp,t.lanes=s,t;case yw:return zh(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case gw:o=10;break e;case _w:o=9;break e;case Tg:o=11;break e;case Eg:o=14;break e;case Ii:o=16,r=null;break e}throw Error(ee(130,t==null?t:typeof t,""))}return e=Gn(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function Hs(t,e,n,r){return t=Gn(7,t,r,e),t.lanes=n,t}function zh(t,e,n,r){return t=Gn(22,t,r,e),t.elementType=yw,t.lanes=n,t.stateNode={isHidden:!1},t}function up(t,e,n){return t=Gn(6,t,null,e),t.lanes=n,t}function cp(t,e,n){return e=Gn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Ak(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=$f(0),this.expirationTimes=$f(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=$f(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function n_(t,e,n,r,i,s,o,a,l){return t=new Ak(t,e,n,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Gn(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Og(s),t}function xk(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Go,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function uC(t){if(!t)return Ji;t=t._reactInternals;e:{if(fo(t)!==t||t.tag!==1)throw Error(ee(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(_n(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ee(171))}if(t.tag===1){var n=t.type;if(_n(n))return uS(t,n,e)}return e}function cC(t,e,n,r,i,s,o,a,l){return t=n_(n,r,!0,t,i,s,o,a,l),t.context=uC(null),n=t.current,r=an(),i=Oi(n),s=Hr(r,i),s.callback=e??null,Fi(n,s,i),t.current.lanes=i,Fu(t,i,r),yn(t,r),t}function $h(t,e,n,r){var i=e.current,s=an(),o=Oi(i);return n=uC(n),e.context===null?e.context=n:e.pendingContext=n,e=Hr(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Fi(i,e,o),t!==null&&(ir(t,i,o,s),ud(t,i,o)),o}function nh(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function xv(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function r_(t,e){xv(t,e),(t=t.alternate)&&xv(t,e)}function Rk(){return null}var dC=typeof reportError=="function"?reportError:function(t){console.error(t)};function i_(t){this._internalRoot=t}Hh.prototype.render=i_.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ee(409));$h(t,e,null,null)};Hh.prototype.unmount=i_.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;to(function(){$h(null,t,null,null)}),e[Kr]=null}};function Hh(t){this._internalRoot=t}Hh.prototype.unstable_scheduleHydration=function(t){if(t){var e=qw();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Si.length&&e!==0&&e<Si[n].priority;n++);Si.splice(n,0,t),n===0&&$w(t)}};function s_(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Wh(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Rv(){}function Pk(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var u=nh(o);s.call(u)}}var o=cC(e,r,t,0,null,!1,!1,"",Rv);return t._reactRootContainer=o,t[Kr]=o.current,fu(t.nodeType===8?t.parentNode:t),to(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var u=nh(l);a.call(u)}}var l=n_(t,0,!1,null,null,!1,!1,"",Rv);return t._reactRootContainer=l,t[Kr]=l.current,fu(t.nodeType===8?t.parentNode:t),to(function(){$h(e,l,n,r)}),l}function jh(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=nh(o);a.call(l)}}$h(e,o,t,i)}else o=Pk(n,e,t,i,r);return nh(o)}Bw=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Pl(e.pendingLanes);n!==0&&(Sg(e,n|1),yn(e,Tt()),!(Be&6)&&(Ta=Tt()+500,ss()))}break;case 13:to(function(){var r=Jr(t,1);if(r!==null){var i=an();ir(r,t,1,i)}}),r_(t,1)}};Cg=function(t){if(t.tag===13){var e=Jr(t,134217728);if(e!==null){var n=an();ir(e,t,134217728,n)}r_(t,134217728)}};Gw=function(t){if(t.tag===13){var e=Oi(t),n=Jr(t,e);if(n!==null){var r=an();ir(n,t,e,r)}r_(t,e)}};qw=function(){return Qe};zw=function(t,e){var n=Qe;try{return Qe=t,e()}finally{Qe=n}};Bp=function(t,e,n){switch(e){case"input":if(bp(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=Fh(r);if(!i)throw Error(ee(90));Tw(r),bp(r,i)}}}break;case"textarea":Iw(t,n);break;case"select":e=n.value,e!=null&&ta(t,!!n.multiple,e,!1)}};Pw=Xg;kw=to;var kk={usingClientEntryPoint:!1,Events:[Ou,Wo,Fh,xw,Rw,Xg]},Tl={findFiberByHostInstance:Os,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Nk={bundleType:Tl.bundleType,version:Tl.version,rendererPackageName:Tl.rendererPackageName,rendererConfig:Tl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ti.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=bw(t),t===null?null:t.stateNode},findFiberByHostInstance:Tl.findFiberByHostInstance||Rk,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Kc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Kc.isDisabled&&Kc.supportsFiber)try{bh=Kc.inject(Nk),Ir=Kc}catch{}}bn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=kk;bn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!s_(e))throw Error(ee(200));return xk(t,e,null,n)};bn.createRoot=function(t,e){if(!s_(t))throw Error(ee(299));var n=!1,r="",i=dC;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=n_(t,1,!1,null,null,n,!1,r,i),t[Kr]=e.current,fu(t.nodeType===8?t.parentNode:t),new i_(e)};bn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ee(188)):(t=Object.keys(t).join(","),Error(ee(268,t)));return t=bw(e),t=t===null?null:t.stateNode,t};bn.flushSync=function(t){return to(t)};bn.hydrate=function(t,e,n){if(!Wh(e))throw Error(ee(200));return jh(null,t,e,!0,n)};bn.hydrateRoot=function(t,e,n){if(!s_(t))throw Error(ee(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=dC;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=cC(e,null,t,1,n??null,i,!1,s,o),t[Kr]=e.current,fu(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new Hh(e)};bn.render=function(t,e,n){if(!Wh(e))throw Error(ee(200));return jh(null,t,e,!1,n)};bn.unmountComponentAtNode=function(t){if(!Wh(t))throw Error(ee(40));return t._reactRootContainer?(to(function(){jh(null,null,t,!1,function(){t._reactRootContainer=null,t[Kr]=null})}),!0):!1};bn.unstable_batchedUpdates=Xg;bn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Wh(n))throw Error(ee(200));if(t==null||t._reactInternals===void 0)throw Error(ee(38));return jh(t,e,n,!1,r)};bn.version="18.3.1-next-f1338f8080-20240426";function hC(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(hC)}catch(t){console.error(t)}}hC(),hw.exports=bn;var Dk=hw.exports,Pv=Dk;Ap.createRoot=Pv.createRoot,Ap.hydrateRoot=Pv.hydrateRoot;/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let bk,Mk;function Vk(){return{geminiUrl:bk,vertexUrl:Mk}}function Lk(t,e,n,r){var i,s;if(!(t!=null&&t.baseUrl)){const o=Vk();return e?(i=o.vertexUrl)!==null&&i!==void 0?i:n:(s=o.geminiUrl)!==null&&s!==void 0?s:r}return t.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class po{}function he(t,e){const n=/\{([^}]+)\}/g;return t.replace(n,(r,i)=>{if(Object.prototype.hasOwnProperty.call(e,i)){const s=e[i];return s!=null?String(s):""}else throw new Error(`Key '${i}' not found in valueMap.`)})}function h(t,e,n){for(let s=0;s<e.length-1;s++){const o=e[s];if(o.endsWith("[]")){const a=o.slice(0,-2);if(!(a in t))if(Array.isArray(n))t[a]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${o}`);if(Array.isArray(t[a])){const l=t[a];if(Array.isArray(n))for(let u=0;u<l.length;u++){const f=l[u];h(f,e.slice(s+1),n[u])}else for(const u of l)h(u,e.slice(s+1),n)}return}else if(o.endsWith("[0]")){const a=o.slice(0,-3);a in t||(t[a]=[{}]);const l=t[a];h(l[0],e.slice(s+1),n);return}(!t[o]||typeof t[o]!="object")&&(t[o]={}),t=t[o]}const r=e[e.length-1],i=t[r];if(i!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===i)return;if(typeof i=="object"&&typeof n=="object"&&i!==null&&n!==null)Object.assign(i,n);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else r==="_self"&&typeof n=="object"&&n!==null&&!Array.isArray(n)?Object.assign(t,n):t[r]=n}function c(t,e,n=void 0){try{if(e.length===1&&e[0]==="_self")return t;for(let r=0;r<e.length;r++){if(typeof t!="object"||t===null)return n;const i=e[r];if(i.endsWith("[]")){const s=i.slice(0,-2);if(s in t){const o=t[s];return Array.isArray(o)?o.map(a=>c(a,e.slice(r+1),n)):n}else return n}else t=t[i]}return t}catch(r){if(r instanceof TypeError)return n;throw r}}function Fk(t,e){for(const[n,r]of Object.entries(e)){const i=n.split("."),s=r.split("."),o=new Set;let a=-1;for(let l=0;l<i.length;l++)if(i[l]==="*"){a=l;break}if(a!==-1&&s.length>a)for(let l=a;l<s.length;l++){const u=s[l];u!=="*"&&!u.endsWith("[]")&&!u.endsWith("[0]")&&o.add(u)}vm(t,i,s,0,o)}}function vm(t,e,n,r,i){if(r>=e.length||typeof t!="object"||t===null)return;const s=e[r];if(s.endsWith("[]")){const o=s.slice(0,-2),a=t;if(o in a&&Array.isArray(a[o]))for(const l of a[o])vm(l,e,n,r+1,i)}else if(s==="*"){if(typeof t=="object"&&t!==null&&!Array.isArray(t)){const o=t,a=Object.keys(o).filter(u=>!u.startsWith("_")&&!i.has(u)),l={};for(const u of a)l[u]=o[u];for(const[u,f]of Object.entries(l)){const m=[];for(const g of n.slice(r))g==="*"?m.push(u):m.push(g);h(o,m,f)}for(const u of a)delete o[u]}}else{const o=t;s in o&&vm(o[s],e,n,r+1,i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function o_(t){if(typeof t!="string")throw new Error("fromImageBytes must be a string");return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Uk(t){const e={},n=c(t,["operationName"]);n!=null&&h(e,["operationName"],n);const r=c(t,["resourceName"]);return r!=null&&h(e,["_url","resourceName"],r),e}function Ok(t){const e={},n=c(t,["name"]);n!=null&&h(e,["name"],n);const r=c(t,["metadata"]);r!=null&&h(e,["metadata"],r);const i=c(t,["done"]);i!=null&&h(e,["done"],i);const s=c(t,["error"]);s!=null&&h(e,["error"],s);const o=c(t,["response","generateVideoResponse"]);return o!=null&&h(e,["response"],Gk(o)),e}function Bk(t){const e={},n=c(t,["name"]);n!=null&&h(e,["name"],n);const r=c(t,["metadata"]);r!=null&&h(e,["metadata"],r);const i=c(t,["done"]);i!=null&&h(e,["done"],i);const s=c(t,["error"]);s!=null&&h(e,["error"],s);const o=c(t,["response"]);return o!=null&&h(e,["response"],qk(o)),e}function Gk(t){const e={},n=c(t,["generatedSamples"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>zk(o))),h(e,["generatedVideos"],s)}const r=c(t,["raiMediaFilteredCount"]);r!=null&&h(e,["raiMediaFilteredCount"],r);const i=c(t,["raiMediaFilteredReasons"]);return i!=null&&h(e,["raiMediaFilteredReasons"],i),e}function qk(t){const e={},n=c(t,["videos"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>$k(o))),h(e,["generatedVideos"],s)}const r=c(t,["raiMediaFilteredCount"]);r!=null&&h(e,["raiMediaFilteredCount"],r);const i=c(t,["raiMediaFilteredReasons"]);return i!=null&&h(e,["raiMediaFilteredReasons"],i),e}function zk(t){const e={},n=c(t,["video"]);return n!=null&&h(e,["video"],jk(n)),e}function $k(t){const e={},n=c(t,["_self"]);return n!=null&&h(e,["video"],Kk(n)),e}function Hk(t){const e={},n=c(t,["operationName"]);return n!=null&&h(e,["_url","operationName"],n),e}function Wk(t){const e={},n=c(t,["operationName"]);return n!=null&&h(e,["_url","operationName"],n),e}function jk(t){const e={},n=c(t,["uri"]);n!=null&&h(e,["uri"],n);const r=c(t,["encodedVideo"]);r!=null&&h(e,["videoBytes"],o_(r));const i=c(t,["encoding"]);return i!=null&&h(e,["mimeType"],i),e}function Kk(t){const e={},n=c(t,["gcsUri"]);n!=null&&h(e,["uri"],n);const r=c(t,["bytesBase64Encoded"]);r!=null&&h(e,["videoBytes"],o_(r));const i=c(t,["mimeType"]);return i!=null&&h(e,["mimeType"],i),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var kv;(function(t){t.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",t.OUTCOME_OK="OUTCOME_OK",t.OUTCOME_FAILED="OUTCOME_FAILED",t.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(kv||(kv={}));var Nv;(function(t){t.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",t.PYTHON="PYTHON"})(Nv||(Nv={}));var Dv;(function(t){t.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",t.SILENT="SILENT",t.WHEN_IDLE="WHEN_IDLE",t.INTERRUPT="INTERRUPT"})(Dv||(Dv={}));var qn;(function(t){t.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",t.STRING="STRING",t.NUMBER="NUMBER",t.INTEGER="INTEGER",t.BOOLEAN="BOOLEAN",t.ARRAY="ARRAY",t.OBJECT="OBJECT",t.NULL="NULL"})(qn||(qn={}));var bv;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(bv||(bv={}));var Mv;(function(t){t.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",t.NO_AUTH="NO_AUTH",t.API_KEY_AUTH="API_KEY_AUTH",t.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",t.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",t.OAUTH="OAUTH",t.OIDC_AUTH="OIDC_AUTH"})(Mv||(Mv={}));var Vv;(function(t){t.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",t.SIMPLE_SEARCH="SIMPLE_SEARCH",t.ELASTIC_SEARCH="ELASTIC_SEARCH"})(Vv||(Vv={}));var Lv;(function(t){t.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",t.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",t.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",t.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",t.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",t.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",t.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",t.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",t.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(Lv||(Lv={}));var Fv;(function(t){t.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",t.SEVERITY="SEVERITY",t.PROBABILITY="PROBABILITY"})(Fv||(Fv={}));var Uv;(function(t){t.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE",t.OFF="OFF"})(Uv||(Uv={}));var Ov;(function(t){t.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.LANGUAGE="LANGUAGE",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.SPII="SPII",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.IMAGE_SAFETY="IMAGE_SAFETY",t.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",t.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",t.NO_IMAGE="NO_IMAGE"})(Ov||(Ov={}));var Bv;(function(t){t.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",t.NEGLIGIBLE="NEGLIGIBLE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH"})(Bv||(Bv={}));var Gv;(function(t){t.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",t.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",t.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",t.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",t.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(Gv||(Gv={}));var qv;(function(t){t.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",t.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",t.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",t.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",t.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(qv||(qv={}));var zv;(function(t){t.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",t.SAFETY="SAFETY",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.IMAGE_SAFETY="IMAGE_SAFETY",t.MODEL_ARMOR="MODEL_ARMOR",t.JAILBREAK="JAILBREAK"})(zv||(zv={}));var $v;(function(t){t.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",t.ON_DEMAND="ON_DEMAND",t.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})($v||($v={}));var rh;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.AUDIO="AUDIO"})(rh||(rh={}));var Hv;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(Hv||(Hv={}));var Wv;(function(t){t.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",t.TUNING_MODE_FULL="TUNING_MODE_FULL",t.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(Wv||(Wv={}));var jv;(function(t){t.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",t.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",t.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",t.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",t.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",t.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",t.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(jv||(jv={}));var Tm;(function(t){t.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",t.JOB_STATE_QUEUED="JOB_STATE_QUEUED",t.JOB_STATE_PENDING="JOB_STATE_PENDING",t.JOB_STATE_RUNNING="JOB_STATE_RUNNING",t.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",t.JOB_STATE_FAILED="JOB_STATE_FAILED",t.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",t.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",t.JOB_STATE_PAUSED="JOB_STATE_PAUSED",t.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",t.JOB_STATE_UPDATING="JOB_STATE_UPDATING",t.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Tm||(Tm={}));var Kv;(function(t){t.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",t.TUNING_TASK_I2V="TUNING_TASK_I2V",t.TUNING_TASK_T2V="TUNING_TASK_T2V"})(Kv||(Kv={}));var Jv;(function(t){t.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",t.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",t.BALANCED="BALANCED",t.PRIORITIZE_COST="PRIORITIZE_COST"})(Jv||(Jv={}));var Qv;(function(t){t.UNSPECIFIED="UNSPECIFIED",t.BLOCKING="BLOCKING",t.NON_BLOCKING="NON_BLOCKING"})(Qv||(Qv={}));var Yv;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(Yv||(Yv={}));var Xv;(function(t){t.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",t.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(Xv||(Xv={}));var Zv;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.AUTO="AUTO",t.ANY="ANY",t.NONE="NONE",t.VALIDATED="VALIDATED"})(Zv||(Zv={}));var eT;(function(t){t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE"})(eT||(eT={}));var tT;(function(t){t.DONT_ALLOW="DONT_ALLOW",t.ALLOW_ADULT="ALLOW_ADULT",t.ALLOW_ALL="ALLOW_ALL"})(tT||(tT={}));var nT;(function(t){t.auto="auto",t.en="en",t.ja="ja",t.ko="ko",t.hi="hi",t.zh="zh",t.pt="pt",t.es="es"})(nT||(nT={}));var rT;(function(t){t.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",t.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",t.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",t.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",t.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(rT||(rT={}));var iT;(function(t){t.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",t.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",t.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",t.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(iT||(iT={}));var sT;(function(t){t.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",t.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",t.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",t.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(sT||(sT={}));var oT;(function(t){t.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",t.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",t.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",t.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",t.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",t.EDIT_MODE_STYLE="EDIT_MODE_STYLE",t.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",t.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(oT||(oT={}));var aT;(function(t){t.FOREGROUND="FOREGROUND",t.BACKGROUND="BACKGROUND",t.PROMPT="PROMPT",t.SEMANTIC="SEMANTIC",t.INTERACTIVE="INTERACTIVE"})(aT||(aT={}));var lT;(function(t){t.ASSET="ASSET",t.STYLE="STYLE"})(lT||(lT={}));var uT;(function(t){t.INSERT="INSERT",t.REMOVE="REMOVE",t.REMOVE_STATIC="REMOVE_STATIC",t.OUTPAINT="OUTPAINT"})(uT||(uT={}));var cT;(function(t){t.OPTIMIZED="OPTIMIZED",t.LOSSLESS="LOSSLESS"})(cT||(cT={}));var dT;(function(t){t.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",t.PREFERENCE_TUNING="PREFERENCE_TUNING"})(dT||(dT={}));var hT;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.PROCESSING="PROCESSING",t.ACTIVE="ACTIVE",t.FAILED="FAILED"})(hT||(hT={}));var fT;(function(t){t.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",t.UPLOADED="UPLOADED",t.GENERATED="GENERATED"})(fT||(fT={}));var pT;(function(t){t.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.RESPONSE_REJECTED="RESPONSE_REJECTED",t.NEED_MORE_INPUT="NEED_MORE_INPUT"})(pT||(pT={}));var mT;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.VIDEO="VIDEO",t.AUDIO="AUDIO",t.DOCUMENT="DOCUMENT"})(mT||(mT={}));var gT;(function(t){t.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",t.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",t.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(gT||(gT={}));var _T;(function(t){t.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",t.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",t.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(_T||(_T={}));var yT;(function(t){t.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",t.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",t.NO_INTERRUPTION="NO_INTERRUPTION"})(yT||(yT={}));var vT;(function(t){t.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",t.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",t.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(vT||(vT={}));var TT;(function(t){t.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",t.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",t.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",t.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",t.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",t.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",t.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",t.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",t.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",t.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",t.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",t.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",t.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(TT||(TT={}));var ET;(function(t){t.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",t.QUALITY="QUALITY",t.DIVERSITY="DIVERSITY",t.VOCALIZATION="VOCALIZATION"})(ET||(ET={}));var Zo;(function(t){t.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",t.PLAY="PLAY",t.PAUSE="PAUSE",t.STOP="STOP",t.RESET_CONTEXT="RESET_CONTEXT"})(Zo||(Zo={}));class Em{constructor(e){const n={};for(const r of e.headers.entries())n[r[0]]=r[1];this.headers=n,this.responseInternal=e}json(){return this.responseInternal.json()}}class El{get text(){var e,n,r,i,s,o,a,l;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let u="",f=!1;const m=[];for(const g of(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)!==null&&l!==void 0?l:[]){for(const[v,T]of Object.entries(g))v!=="text"&&v!=="thought"&&(T!==null||T!==void 0)&&m.push(v);if(typeof g.text=="string"){if(typeof g.thought=="boolean"&&g.thought)continue;f=!0,u+=g.text}}return m.length>0&&console.warn(`there are non-text parts ${m} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),f?u:void 0}get data(){var e,n,r,i,s,o,a,l;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let u="";const f=[];for(const m of(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)!==null&&l!==void 0?l:[]){for(const[g,v]of Object.entries(m))g!=="inlineData"&&(v!==null||v!==void 0)&&f.push(g);m.inlineData&&typeof m.inlineData.data=="string"&&(u+=atob(m.inlineData.data))}return f.length>0&&console.warn(`there are non-data parts ${f} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),u.length>0?btoa(u):void 0}get functionCalls(){var e,n,r,i,s,o,a,l;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const u=(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(f=>f.functionCall).map(f=>f.functionCall).filter(f=>f!==void 0);if((u==null?void 0:u.length)!==0)return u}get executableCode(){var e,n,r,i,s,o,a,l,u;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const f=(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(m=>m.executableCode).map(m=>m.executableCode).filter(m=>m!==void 0);if((f==null?void 0:f.length)!==0)return(u=f==null?void 0:f[0])===null||u===void 0?void 0:u.code}get codeExecutionResult(){var e,n,r,i,s,o,a,l,u;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const f=(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(m=>m.codeExecutionResult).map(m=>m.codeExecutionResult).filter(m=>m!==void 0);if((f==null?void 0:f.length)!==0)return(u=f==null?void 0:f[0])===null||u===void 0?void 0:u.output}}class IT{}class wT{}class Jk{}class Qk{}class Yk{}class Xk{}class ST{}class CT{}class AT{}class Zk{}class ih{_fromAPIResponse({apiResponse:e,isVertexAI:n}){const r=new ih;let i;const s=e;return n?i=Bk(s):i=Ok(s),Object.assign(r,i),r}}class xT{}class RT{}class PT{}class eN{}class tN{}class nN{}class kT{}class rN{get text(){var e,n,r;let i="",s=!1;const o=[];for(const a of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[l,u]of Object.entries(a))l!=="text"&&l!=="thought"&&u!==null&&o.push(l);if(typeof a.text=="string"){if(typeof a.thought=="boolean"&&a.thought)continue;s=!0,i+=a.text}}return o.length>0&&console.warn(`there are non-text parts ${o} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),s?i:void 0}get data(){var e,n,r;let i="";const s=[];for(const o of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[a,l]of Object.entries(o))a!=="inlineData"&&l!==null&&s.push(a);o.inlineData&&typeof o.inlineData.data=="string"&&(i+=atob(o.inlineData.data))}return s.length>0&&console.warn(`there are non-data parts ${s} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),i.length>0?btoa(i):void 0}}class iN{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function qe(t,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(t.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const n=e.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function fC(t,e){const n=qe(t,e);return n?n.startsWith("publishers/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}`:n.startsWith("models/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/publishers/google/${n}`:n:""}function pC(t){return Array.isArray(t)?t.map(e=>sh(e)):[sh(t)]}function sh(t){if(typeof t=="object"&&t!==null)return t;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof t}`)}function mC(t){const e=sh(t);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function gC(t){const e=sh(t);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function NT(t){if(t==null)throw new Error("PartUnion is required");if(typeof t=="object")return t;if(typeof t=="string")return{text:t};throw new Error(`Unsupported part type: ${typeof t}`)}function _C(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("PartListUnion is required");return Array.isArray(t)?t.map(e=>NT(e)):[NT(t)]}function Im(t){return t!=null&&typeof t=="object"&&"parts"in t&&Array.isArray(t.parts)}function DT(t){return t!=null&&typeof t=="object"&&"functionCall"in t}function bT(t){return t!=null&&typeof t=="object"&&"functionResponse"in t}function Zt(t){if(t==null)throw new Error("ContentUnion is required");return Im(t)?t:{role:"user",parts:_C(t)}}function a_(t,e){if(!e)return[];if(t.isVertexAI()&&Array.isArray(e))return e.flatMap(n=>{const r=Zt(n);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(t.isVertexAI()){const n=Zt(e);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(e)?e.map(n=>Zt(n)):[Zt(e)]}function Hn(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("contents are required");if(!Array.isArray(t)){if(DT(t)||bT(t))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Zt(t)]}const e=[],n=[],r=Im(t[0]);for(const i of t){const s=Im(i);if(s!=r)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(s)e.push(i);else{if(DT(i)||bT(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(i)}}return r||e.push({role:"user",parts:_C(n)}),e}function sN(t,e){t.includes("null")&&(e.nullable=!0);const n=t.filter(r=>r!=="null");if(n.length===1)e.type=Object.values(qn).includes(n[0].toUpperCase())?n[0].toUpperCase():qn.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const r of n)e.anyOf.push({type:Object.values(qn).includes(r.toUpperCase())?r.toUpperCase():qn.TYPE_UNSPECIFIED})}}function aa(t){const e={},n=["items"],r=["anyOf"],i=["properties"];if(t.type&&t.anyOf)throw new Error("type and anyOf cannot be both populated.");const s=t.anyOf;s!=null&&s.length==2&&(s[0].type==="null"?(e.nullable=!0,t=s[1]):s[1].type==="null"&&(e.nullable=!0,t=s[0])),t.type instanceof Array&&sN(t.type,e);for(const[o,a]of Object.entries(t))if(a!=null)if(o=="type"){if(a==="null")throw new Error("type: null can not be the only possible type for the field.");if(a instanceof Array)continue;e.type=Object.values(qn).includes(a.toUpperCase())?a.toUpperCase():qn.TYPE_UNSPECIFIED}else if(n.includes(o))e[o]=aa(a);else if(r.includes(o)){const l=[];for(const u of a){if(u.type=="null"){e.nullable=!0;continue}l.push(aa(u))}e[o]=l}else if(i.includes(o)){const l={};for(const[u,f]of Object.entries(a))l[u]=aa(f);e[o]=l}else{if(o==="additionalProperties")continue;e[o]=a}return e}function l_(t){return aa(t)}function u_(t){if(typeof t=="object")return t;if(typeof t=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:t}}};throw new Error(`Unsupported speechConfig type: ${typeof t}`)}function c_(t){if("multiSpeakerVoiceConfig"in t)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return t}function Ba(t){if(t.functionDeclarations)for(const e of t.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=aa(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=aa(e.response));return t}function Ga(t){if(t==null)throw new Error("tools is required");if(!Array.isArray(t))throw new Error("tools is required and must be an array of Tools");const e=[];for(const n of t)e.push(n);return e}function oN(t,e,n,r=1){const i=!e.startsWith(`${n}/`)&&e.split("/").length===r;return t.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${t.getProject()}/${e}`:e.startsWith(`${n}/`)?`projects/${t.getProject()}/locations/${t.getLocation()}/${e}`:i?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}/${e}`:e:i?`${n}/${e}`:e}function ni(t,e){if(typeof e!="string")throw new Error("name must be a string");return oN(t,e,"cachedContents")}function yC(t){switch(t){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return t}}function os(t){return o_(t)}function aN(t){return t!=null&&typeof t=="object"&&"name"in t}function lN(t){return t!=null&&typeof t=="object"&&"video"in t}function uN(t){return t!=null&&typeof t=="object"&&"uri"in t}function vC(t){var e;let n;if(aN(t)&&(n=t.name),!(uN(t)&&(n=t.uri,n===void 0))&&!(lN(t)&&(n=(e=t.video)===null||e===void 0?void 0:e.uri,n===void 0))){if(typeof t=="string"&&(n=t),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const i=n.split("files/")[1].match(/[a-z0-9]+/);if(i===null)throw new Error(`Could not extract file name from URI ${n}`);n=i[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function TC(t,e){let n;return t.isVertexAI()?n=e?"publishers/google/models":"models":n=e?"models":"tunedModels",n}function EC(t){for(const e of["models","tunedModels","publisherModels"])if(cN(t,e))return t[e];return[]}function cN(t,e){return t!==null&&typeof t=="object"&&e in t}function dN(t,e={}){const n=t,r={name:n.name,description:n.description,parametersJsonSchema:n.inputSchema};return n.outputSchema&&(r.responseJsonSchema=n.outputSchema),e.behavior&&(r.behavior=e.behavior),{functionDeclarations:[r]}}function hN(t,e={}){const n=[],r=new Set;for(const i of t){const s=i.name;if(r.has(s))throw new Error(`Duplicate function name ${s} found in MCP tools. Please ensure function names are unique.`);r.add(s);const o=dN(i,e);o.functionDeclarations&&n.push(...o.functionDeclarations)}return{functionDeclarations:n}}function IC(t,e){let n;if(typeof e=="string")if(t.isVertexAI())if(e.startsWith("gs://"))n={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))n={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))n={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(t.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");n={inlinedRequests:e}}else n=e;const r=[n.gcsUri,n.bigqueryUri].filter(Boolean).length,i=[n.inlinedRequests,n.fileName].filter(Boolean).length;if(t.isVertexAI()){if(i>0||r!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(r>0||i!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return n}function fN(t){if(typeof t!="string")return t;const e=t;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function wC(t){if(typeof t!="object"||t===null)return{};const e=t,n=e.inlinedResponses;if(typeof n!="object"||n===null)return t;const i=n.inlinedResponses;if(!Array.isArray(i)||i.length===0)return t;let s=!1;for(const o of i){if(typeof o!="object"||o===null)continue;const l=o.response;if(typeof l!="object"||l===null)continue;if(l.embedding!==void 0){s=!0;break}}return s&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),t}function qa(t,e){const n=e;if(!t.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error(`Invalid batch job name: ${n}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error(`Invalid batch job name: ${n}.`)}function SC(t){const e=t;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function pN(t){const e={},n=c(t,["responsesFile"]);n!=null&&h(e,["fileName"],n);const r=c(t,["inlinedResponses","inlinedResponses"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>HN(o))),h(e,["inlinedResponses"],s)}const i=c(t,["inlinedEmbedContentResponses","inlinedResponses"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),h(e,["inlinedEmbedContentResponses"],s)}return e}function mN(t){const e={},n=c(t,["predictionsFormat"]);n!=null&&h(e,["format"],n);const r=c(t,["gcsDestination","outputUriPrefix"]);r!=null&&h(e,["gcsUri"],r);const i=c(t,["bigqueryDestination","outputUri"]);return i!=null&&h(e,["bigqueryUri"],i),e}function gN(t){const e={},n=c(t,["format"]);n!=null&&h(e,["predictionsFormat"],n);const r=c(t,["gcsUri"]);r!=null&&h(e,["gcsDestination","outputUriPrefix"],r);const i=c(t,["bigqueryUri"]);if(i!=null&&h(e,["bigqueryDestination","outputUri"],i),c(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(c(t,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(c(t,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function gd(t){const e={},n=c(t,["name"]);n!=null&&h(e,["name"],n);const r=c(t,["metadata","displayName"]);r!=null&&h(e,["displayName"],r);const i=c(t,["metadata","state"]);i!=null&&h(e,["state"],SC(i));const s=c(t,["metadata","createTime"]);s!=null&&h(e,["createTime"],s);const o=c(t,["metadata","endTime"]);o!=null&&h(e,["endTime"],o);const a=c(t,["metadata","updateTime"]);a!=null&&h(e,["updateTime"],a);const l=c(t,["metadata","model"]);l!=null&&h(e,["model"],l);const u=c(t,["metadata","output"]);return u!=null&&h(e,["dest"],pN(wC(u))),e}function wm(t){const e={},n=c(t,["name"]);n!=null&&h(e,["name"],n);const r=c(t,["displayName"]);r!=null&&h(e,["displayName"],r);const i=c(t,["state"]);i!=null&&h(e,["state"],SC(i));const s=c(t,["error"]);s!=null&&h(e,["error"],s);const o=c(t,["createTime"]);o!=null&&h(e,["createTime"],o);const a=c(t,["startTime"]);a!=null&&h(e,["startTime"],a);const l=c(t,["endTime"]);l!=null&&h(e,["endTime"],l);const u=c(t,["updateTime"]);u!=null&&h(e,["updateTime"],u);const f=c(t,["model"]);f!=null&&h(e,["model"],f);const m=c(t,["inputConfig"]);m!=null&&h(e,["src"],_N(m));const g=c(t,["outputConfig"]);return g!=null&&h(e,["dest"],mN(wC(g))),e}function _N(t){const e={},n=c(t,["instancesFormat"]);n!=null&&h(e,["format"],n);const r=c(t,["gcsSource","uris"]);r!=null&&h(e,["gcsUri"],r);const i=c(t,["bigquerySource","inputUri"]);return i!=null&&h(e,["bigqueryUri"],i),e}function yN(t,e){const n={};if(c(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(c(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(c(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const r=c(e,["fileName"]);r!=null&&h(n,["fileName"],r);const i=c(e,["inlinedRequests"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>$N(t,o))),h(n,["requests","requests"],s)}return n}function vN(t){const e={},n=c(t,["format"]);n!=null&&h(e,["instancesFormat"],n);const r=c(t,["gcsUri"]);r!=null&&h(e,["gcsSource","uris"],r);const i=c(t,["bigqueryUri"]);if(i!=null&&h(e,["bigquerySource","inputUri"],i),c(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(c(t,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function TN(t){const e={},n=c(t,["data"]);if(n!=null&&h(e,["data"],n),c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function EN(t,e){const n={},r=c(e,["name"]);return r!=null&&h(n,["_url","name"],qa(t,r)),n}function IN(t,e){const n={},r=c(e,["name"]);return r!=null&&h(n,["_url","name"],qa(t,r)),n}function wN(t){const e={},n=c(t,["content"]);n!=null&&h(e,["content"],n);const r=c(t,["citationMetadata"]);r!=null&&h(e,["citationMetadata"],SN(r));const i=c(t,["tokenCount"]);i!=null&&h(e,["tokenCount"],i);const s=c(t,["finishReason"]);s!=null&&h(e,["finishReason"],s);const o=c(t,["avgLogprobs"]);o!=null&&h(e,["avgLogprobs"],o);const a=c(t,["groundingMetadata"]);a!=null&&h(e,["groundingMetadata"],a);const l=c(t,["index"]);l!=null&&h(e,["index"],l);const u=c(t,["logprobsResult"]);u!=null&&h(e,["logprobsResult"],u);const f=c(t,["safetyRatings"]);if(f!=null){let g=f;Array.isArray(g)&&(g=g.map(v=>v)),h(e,["safetyRatings"],g)}const m=c(t,["urlContextMetadata"]);return m!=null&&h(e,["urlContextMetadata"],m),e}function SN(t){const e={},n=c(t,["citationSources"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>i)),h(e,["citations"],r)}return e}function CC(t){const e={},n=c(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>XN(s))),h(e,["parts"],i)}const r=c(t,["role"]);return r!=null&&h(e,["role"],r),e}function CN(t,e){const n={},r=c(t,["displayName"]);if(e!==void 0&&r!=null&&h(e,["batch","displayName"],r),c(t,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return n}function AN(t,e){const n={},r=c(t,["displayName"]);e!==void 0&&r!=null&&h(e,["displayName"],r);const i=c(t,["dest"]);return e!==void 0&&i!=null&&h(e,["outputConfig"],gN(fN(i))),n}function MT(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=c(e,["src"]);i!=null&&h(n,["batch","inputConfig"],yN(t,IC(t,i)));const s=c(e,["config"]);return s!=null&&CN(s,n),n}function xN(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["model"],qe(t,r));const i=c(e,["src"]);i!=null&&h(n,["inputConfig"],vN(IC(t,i)));const s=c(e,["config"]);return s!=null&&AN(s,n),n}function RN(t,e){const n={},r=c(t,["displayName"]);return e!==void 0&&r!=null&&h(e,["batch","displayName"],r),n}function PN(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=c(e,["src"]);i!=null&&h(n,["batch","inputConfig"],LN(t,i));const s=c(e,["config"]);return s!=null&&RN(s,n),n}function kN(t,e){const n={},r=c(e,["name"]);return r!=null&&h(n,["_url","name"],qa(t,r)),n}function NN(t,e){const n={},r=c(e,["name"]);return r!=null&&h(n,["_url","name"],qa(t,r)),n}function DN(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["name"]);r!=null&&h(e,["name"],r);const i=c(t,["done"]);i!=null&&h(e,["done"],i);const s=c(t,["error"]);return s!=null&&h(e,["error"],s),e}function bN(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["name"]);r!=null&&h(e,["name"],r);const i=c(t,["done"]);i!=null&&h(e,["done"],i);const s=c(t,["error"]);return s!=null&&h(e,["error"],s),e}function MN(t,e){const n={},r=c(e,["contents"]);if(r!=null){let s=a_(t,r);Array.isArray(s)&&(s=s.map(o=>o)),h(n,["requests[]","request","content"],s)}const i=c(e,["config"]);return i!=null&&(h(n,["_self"],VN(i,n)),Fk(n,{"requests[].*":"requests[].request.*"})),n}function VN(t,e){const n={},r=c(t,["taskType"]);e!==void 0&&r!=null&&h(e,["requests[]","taskType"],r);const i=c(t,["title"]);e!==void 0&&i!=null&&h(e,["requests[]","title"],i);const s=c(t,["outputDimensionality"]);if(e!==void 0&&s!=null&&h(e,["requests[]","outputDimensionality"],s),c(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(c(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function LN(t,e){const n={},r=c(e,["fileName"]);r!=null&&h(n,["file_name"],r);const i=c(e,["inlinedRequests"]);return i!=null&&h(n,["requests"],MN(t,i)),n}function FN(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["fileUri"]);n!=null&&h(e,["fileUri"],n);const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function UN(t,e,n){const r={},i=c(e,["systemInstruction"]);n!==void 0&&i!=null&&h(n,["systemInstruction"],CC(Zt(i)));const s=c(e,["temperature"]);s!=null&&h(r,["temperature"],s);const o=c(e,["topP"]);o!=null&&h(r,["topP"],o);const a=c(e,["topK"]);a!=null&&h(r,["topK"],a);const l=c(e,["candidateCount"]);l!=null&&h(r,["candidateCount"],l);const u=c(e,["maxOutputTokens"]);u!=null&&h(r,["maxOutputTokens"],u);const f=c(e,["stopSequences"]);f!=null&&h(r,["stopSequences"],f);const m=c(e,["responseLogprobs"]);m!=null&&h(r,["responseLogprobs"],m);const g=c(e,["logprobs"]);g!=null&&h(r,["logprobs"],g);const v=c(e,["presencePenalty"]);v!=null&&h(r,["presencePenalty"],v);const T=c(e,["frequencyPenalty"]);T!=null&&h(r,["frequencyPenalty"],T);const P=c(e,["seed"]);P!=null&&h(r,["seed"],P);const D=c(e,["responseMimeType"]);D!=null&&h(r,["responseMimeType"],D);const S=c(e,["responseSchema"]);S!=null&&h(r,["responseSchema"],l_(S));const I=c(e,["responseJsonSchema"]);if(I!=null&&h(r,["responseJsonSchema"],I),c(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(c(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const R=c(e,["safetySettings"]);if(n!==void 0&&R!=null){let L=R;Array.isArray(L)&&(L=L.map(N=>ZN(N))),h(n,["safetySettings"],L)}const V=c(e,["tools"]);if(n!==void 0&&V!=null){let L=Ga(V);Array.isArray(L)&&(L=L.map(N=>e1(Ba(N)))),h(n,["tools"],L)}const U=c(e,["toolConfig"]);if(n!==void 0&&U!=null&&h(n,["toolConfig"],U),c(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const B=c(e,["cachedContent"]);n!==void 0&&B!=null&&h(n,["cachedContent"],ni(t,B));const E=c(e,["responseModalities"]);E!=null&&h(r,["responseModalities"],E);const w=c(e,["mediaResolution"]);w!=null&&h(r,["mediaResolution"],w);const C=c(e,["speechConfig"]);if(C!=null&&h(r,["speechConfig"],u_(C)),c(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const k=c(e,["thinkingConfig"]);k!=null&&h(r,["thinkingConfig"],k);const M=c(e,["imageConfig"]);return M!=null&&h(r,["imageConfig"],M),r}function ON(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["candidates"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(u=>wN(u))),h(e,["candidates"],l)}const i=c(t,["modelVersion"]);i!=null&&h(e,["modelVersion"],i);const s=c(t,["promptFeedback"]);s!=null&&h(e,["promptFeedback"],s);const o=c(t,["responseId"]);o!=null&&h(e,["responseId"],o);const a=c(t,["usageMetadata"]);return a!=null&&h(e,["usageMetadata"],a),e}function BN(t,e){const n={},r=c(e,["name"]);return r!=null&&h(n,["_url","name"],qa(t,r)),n}function GN(t,e){const n={},r=c(e,["name"]);return r!=null&&h(n,["_url","name"],qa(t,r)),n}function qN(t){const e={};if(c(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=c(t,["enableWidget"]);return n!=null&&h(e,["enableWidget"],n),e}function zN(t){const e={};if(c(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");const n=c(t,["timeRangeFilter"]);return n!=null&&h(e,["timeRangeFilter"],n),e}function $N(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["request","model"],qe(t,r));const i=c(e,["contents"]);if(i!=null){let a=Hn(i);Array.isArray(a)&&(a=a.map(l=>CC(l))),h(n,["request","contents"],a)}const s=c(e,["metadata"]);s!=null&&h(n,["metadata"],s);const o=c(e,["config"]);return o!=null&&h(n,["request","generationConfig"],UN(t,o,c(n,["request"],{}))),n}function HN(t){const e={},n=c(t,["response"]);n!=null&&h(e,["response"],ON(n));const r=c(t,["error"]);return r!=null&&h(e,["error"],r),e}function WN(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&h(e,["_query","pageSize"],r);const i=c(t,["pageToken"]);if(e!==void 0&&i!=null&&h(e,["_query","pageToken"],i),c(t,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return n}function jN(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&h(e,["_query","pageSize"],r);const i=c(t,["pageToken"]);e!==void 0&&i!=null&&h(e,["_query","pageToken"],i);const s=c(t,["filter"]);return e!==void 0&&s!=null&&h(e,["_query","filter"],s),n}function KN(t){const e={},n=c(t,["config"]);return n!=null&&WN(n,e),e}function JN(t){const e={},n=c(t,["config"]);return n!=null&&jN(n,e),e}function QN(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=c(t,["operations"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>gd(o))),h(e,["batchJobs"],s)}return e}function YN(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=c(t,["batchPredictionJobs"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>wm(o))),h(e,["batchJobs"],s)}return e}function XN(t){const e={},n=c(t,["functionCall"]);n!=null&&h(e,["functionCall"],n);const r=c(t,["codeExecutionResult"]);r!=null&&h(e,["codeExecutionResult"],r);const i=c(t,["executableCode"]);i!=null&&h(e,["executableCode"],i);const s=c(t,["fileData"]);s!=null&&h(e,["fileData"],FN(s));const o=c(t,["functionResponse"]);o!=null&&h(e,["functionResponse"],o);const a=c(t,["inlineData"]);a!=null&&h(e,["inlineData"],TN(a));const l=c(t,["text"]);l!=null&&h(e,["text"],l);const u=c(t,["thought"]);u!=null&&h(e,["thought"],u);const f=c(t,["thoughtSignature"]);f!=null&&h(e,["thoughtSignature"],f);const m=c(t,["videoMetadata"]);return m!=null&&h(e,["videoMetadata"],m),e}function ZN(t){const e={},n=c(t,["category"]);if(n!=null&&h(e,["category"],n),c(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=c(t,["threshold"]);return r!=null&&h(e,["threshold"],r),e}function e1(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(f=>f)),h(e,["functionDeclarations"],u)}if(c(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=c(t,["googleSearchRetrieval"]);r!=null&&h(e,["googleSearchRetrieval"],r);const i=c(t,["googleMaps"]);i!=null&&h(e,["googleMaps"],qN(i));const s=c(t,["computerUse"]);s!=null&&h(e,["computerUse"],s);const o=c(t,["codeExecution"]);if(o!=null&&h(e,["codeExecution"],o),c(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=c(t,["googleSearch"]);a!=null&&h(e,["googleSearch"],zN(a));const l=c(t,["urlContext"]);return l!=null&&h(e,["urlContext"],l),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var no;(function(t){t.PAGED_ITEM_BATCH_JOBS="batchJobs",t.PAGED_ITEM_MODELS="models",t.PAGED_ITEM_TUNING_JOBS="tuningJobs",t.PAGED_ITEM_FILES="files",t.PAGED_ITEM_CACHED_CONTENTS="cachedContents",t.PAGED_ITEM_RAG_STORES="ragStores",t.PAGED_ITEM_DOCUMENTS="documents"})(no||(no={}));class Gu{constructor(e,n,r,i){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(e,r,i)}init(e,n,r){var i,s;this.nameInternal=e,this.pageInternal=n[this.nameInternal]||[],this.sdkHttpResponseInternal=n==null?void 0:n.sdkHttpResponse,this.idxInternal=0;let o={config:{}};!r||Object.keys(r).length===0?o={config:{}}:typeof r=="object"?o=Object.assign({},r):o=r,o.config&&(o.config.pageToken=n.nextPageToken),this.paramsInternal=o,this.pageInternalSize=(s=(i=o.config)===null||i===void 0?void 0:i.pageSize)!==null&&s!==void 0?s:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class t1 extends po{constructor(e){super(),this.apiClient=e,this.create=async n=>(this.apiClient.isVertexAI()&&(n.config=this.formatDestination(n.src,n.config)),this.createInternal(n)),this.createEmbeddings=async n=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(n)},this.list=async(n={})=>new Gu(no.PAGED_ITEM_BATCH_JOBS,r=>this.listInternal(r),await this.listInternal(n),n)}createInlinedGenerateContentRequest(e){const n=MT(this.apiClient,e),r=n._url,i=he("{model}:batchGenerateContent",r),a=n.batch.inputConfig.requests,l=a.requests,u=[];for(const f of l){const m=Object.assign({},f);if(m.systemInstruction){const g=m.systemInstruction;delete m.systemInstruction;const v=m.request;v.systemInstruction=g,m.request=v}u.push(m)}return a.requests=u,delete n.config,delete n._url,delete n._query,{path:i,body:n}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,n){const r=n?Object.assign({},n):{},i=Date.now().toString();if(r.displayName||(r.displayName=`genaiBatchJob_${i}`),r.dest===void 0){const s=this.getGcsUri(e),o=this.getBigqueryUri(e);if(s)s.endsWith(".jsonl")?r.dest=`${s.slice(0,-6)}/dest`:r.dest=`${s}_dest_${i}`;else if(o)r.dest=`${o}_dest_${i}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return r}async createInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=xN(this.apiClient,e);return a=he("batchPredictionJobs",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>wm(f))}else{const u=MT(this.apiClient,e);return a=he("{model}:batchGenerateContent",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>gd(f))}}async createEmbeddingsInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=PN(this.apiClient,e);return s=he("{model}:asyncBatchEmbedContent",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>gd(l))}}async get(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=GN(this.apiClient,e);return a=he("batchPredictionJobs/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>wm(f))}else{const u=BN(this.apiClient,e);return a=he("batches/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>gd(f))}}async cancel(e){var n,r,i,s;let o="",a={};if(this.apiClient.isVertexAI()){const l=IN(this.apiClient,e);o=he("batchPredictionJobs/{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}else{const l=EN(this.apiClient,e);o=he("batches/{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal})}}async listInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=JN(e);return a=he("batchPredictionJobs",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=YN(f),g=new kT;return Object.assign(g,m),g})}else{const u=KN(e);return a=he("batches",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=QN(f),g=new kT;return Object.assign(g,m),g})}}async delete(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=NN(this.apiClient,e);return a=he("batchPredictionJobs/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>bN(f))}else{const u=kN(this.apiClient,e);return a=he("batches/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>DN(f))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function n1(t){const e={},n=c(t,["data"]);if(n!=null&&h(e,["data"],n),c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function VT(t){const e={},n=c(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>w1(s))),h(e,["parts"],i)}const r=c(t,["role"]);return r!=null&&h(e,["role"],r),e}function r1(t,e){const n={},r=c(t,["ttl"]);e!==void 0&&r!=null&&h(e,["ttl"],r);const i=c(t,["expireTime"]);e!==void 0&&i!=null&&h(e,["expireTime"],i);const s=c(t,["displayName"]);e!==void 0&&s!=null&&h(e,["displayName"],s);const o=c(t,["contents"]);if(e!==void 0&&o!=null){let f=Hn(o);Array.isArray(f)&&(f=f.map(m=>VT(m))),h(e,["contents"],f)}const a=c(t,["systemInstruction"]);e!==void 0&&a!=null&&h(e,["systemInstruction"],VT(Zt(a)));const l=c(t,["tools"]);if(e!==void 0&&l!=null){let f=l;Array.isArray(f)&&(f=f.map(m=>S1(m))),h(e,["tools"],f)}const u=c(t,["toolConfig"]);if(e!==void 0&&u!=null&&h(e,["toolConfig"],u),c(t,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function i1(t,e){const n={},r=c(t,["ttl"]);e!==void 0&&r!=null&&h(e,["ttl"],r);const i=c(t,["expireTime"]);e!==void 0&&i!=null&&h(e,["expireTime"],i);const s=c(t,["displayName"]);e!==void 0&&s!=null&&h(e,["displayName"],s);const o=c(t,["contents"]);if(e!==void 0&&o!=null){let m=Hn(o);Array.isArray(m)&&(m=m.map(g=>g)),h(e,["contents"],m)}const a=c(t,["systemInstruction"]);e!==void 0&&a!=null&&h(e,["systemInstruction"],Zt(a));const l=c(t,["tools"]);if(e!==void 0&&l!=null){let m=l;Array.isArray(m)&&(m=m.map(g=>C1(g))),h(e,["tools"],m)}const u=c(t,["toolConfig"]);e!==void 0&&u!=null&&h(e,["toolConfig"],u);const f=c(t,["kmsKeyName"]);return e!==void 0&&f!=null&&h(e,["encryption_spec","kmsKeyName"],f),n}function s1(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["model"],fC(t,r));const i=c(e,["config"]);return i!=null&&r1(i,n),n}function o1(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["model"],fC(t,r));const i=c(e,["config"]);return i!=null&&i1(i,n),n}function a1(t,e){const n={},r=c(e,["name"]);return r!=null&&h(n,["_url","name"],ni(t,r)),n}function l1(t,e){const n={},r=c(e,["name"]);return r!=null&&h(n,["_url","name"],ni(t,r)),n}function u1(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&h(e,["sdkHttpResponse"],n),e}function c1(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&h(e,["sdkHttpResponse"],n),e}function d1(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["fileUri"]);n!=null&&h(e,["fileUri"],n);const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function h1(t){const e={};if(c(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=c(t,["description"]);n!=null&&h(e,["description"],n);const r=c(t,["name"]);r!=null&&h(e,["name"],r);const i=c(t,["parameters"]);i!=null&&h(e,["parameters"],i);const s=c(t,["parametersJsonSchema"]);s!=null&&h(e,["parametersJsonSchema"],s);const o=c(t,["response"]);o!=null&&h(e,["response"],o);const a=c(t,["responseJsonSchema"]);return a!=null&&h(e,["responseJsonSchema"],a),e}function f1(t,e){const n={},r=c(e,["name"]);return r!=null&&h(n,["_url","name"],ni(t,r)),n}function p1(t,e){const n={},r=c(e,["name"]);return r!=null&&h(n,["_url","name"],ni(t,r)),n}function m1(t){const e={};if(c(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=c(t,["enableWidget"]);return n!=null&&h(e,["enableWidget"],n),e}function g1(t){const e={};if(c(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");const n=c(t,["timeRangeFilter"]);return n!=null&&h(e,["timeRangeFilter"],n),e}function _1(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&h(e,["_query","pageSize"],r);const i=c(t,["pageToken"]);return e!==void 0&&i!=null&&h(e,["_query","pageToken"],i),n}function y1(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&h(e,["_query","pageSize"],r);const i=c(t,["pageToken"]);return e!==void 0&&i!=null&&h(e,["_query","pageToken"],i),n}function v1(t){const e={},n=c(t,["config"]);return n!=null&&_1(n,e),e}function T1(t){const e={},n=c(t,["config"]);return n!=null&&y1(n,e),e}function E1(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=c(t,["cachedContents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),h(e,["cachedContents"],s)}return e}function I1(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=c(t,["cachedContents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),h(e,["cachedContents"],s)}return e}function w1(t){const e={},n=c(t,["functionCall"]);n!=null&&h(e,["functionCall"],n);const r=c(t,["codeExecutionResult"]);r!=null&&h(e,["codeExecutionResult"],r);const i=c(t,["executableCode"]);i!=null&&h(e,["executableCode"],i);const s=c(t,["fileData"]);s!=null&&h(e,["fileData"],d1(s));const o=c(t,["functionResponse"]);o!=null&&h(e,["functionResponse"],o);const a=c(t,["inlineData"]);a!=null&&h(e,["inlineData"],n1(a));const l=c(t,["text"]);l!=null&&h(e,["text"],l);const u=c(t,["thought"]);u!=null&&h(e,["thought"],u);const f=c(t,["thoughtSignature"]);f!=null&&h(e,["thoughtSignature"],f);const m=c(t,["videoMetadata"]);return m!=null&&h(e,["videoMetadata"],m),e}function S1(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(f=>f)),h(e,["functionDeclarations"],u)}if(c(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=c(t,["googleSearchRetrieval"]);r!=null&&h(e,["googleSearchRetrieval"],r);const i=c(t,["googleMaps"]);i!=null&&h(e,["googleMaps"],m1(i));const s=c(t,["computerUse"]);s!=null&&h(e,["computerUse"],s);const o=c(t,["codeExecution"]);if(o!=null&&h(e,["codeExecution"],o),c(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=c(t,["googleSearch"]);a!=null&&h(e,["googleSearch"],g1(a));const l=c(t,["urlContext"]);return l!=null&&h(e,["urlContext"],l),e}function C1(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let m=n;Array.isArray(m)&&(m=m.map(g=>h1(g))),h(e,["functionDeclarations"],m)}const r=c(t,["retrieval"]);r!=null&&h(e,["retrieval"],r);const i=c(t,["googleSearchRetrieval"]);i!=null&&h(e,["googleSearchRetrieval"],i);const s=c(t,["googleMaps"]);s!=null&&h(e,["googleMaps"],s);const o=c(t,["computerUse"]);o!=null&&h(e,["computerUse"],o);const a=c(t,["codeExecution"]);a!=null&&h(e,["codeExecution"],a);const l=c(t,["enterpriseWebSearch"]);l!=null&&h(e,["enterpriseWebSearch"],l);const u=c(t,["googleSearch"]);u!=null&&h(e,["googleSearch"],u);const f=c(t,["urlContext"]);return f!=null&&h(e,["urlContext"],f),e}function A1(t,e){const n={},r=c(t,["ttl"]);e!==void 0&&r!=null&&h(e,["ttl"],r);const i=c(t,["expireTime"]);return e!==void 0&&i!=null&&h(e,["expireTime"],i),n}function x1(t,e){const n={},r=c(t,["ttl"]);e!==void 0&&r!=null&&h(e,["ttl"],r);const i=c(t,["expireTime"]);return e!==void 0&&i!=null&&h(e,["expireTime"],i),n}function R1(t,e){const n={},r=c(e,["name"]);r!=null&&h(n,["_url","name"],ni(t,r));const i=c(e,["config"]);return i!=null&&A1(i,n),n}function P1(t,e){const n={},r=c(e,["name"]);r!=null&&h(n,["_url","name"],ni(t,r));const i=c(e,["config"]);return i!=null&&x1(i,n),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class k1 extends po{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new Gu(no.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(n),n)}async create(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=o1(this.apiClient,e);return a=he("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>f)}else{const u=s1(this.apiClient,e);return a=he("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>f)}}async get(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=p1(this.apiClient,e);return a=he("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>f)}else{const u=f1(this.apiClient,e);return a=he("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>f)}}async delete(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=l1(this.apiClient,e);return a=he("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=c1(f),g=new RT;return Object.assign(g,m),g})}else{const u=a1(this.apiClient,e);return a=he("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=u1(f),g=new RT;return Object.assign(g,m),g})}}async update(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=P1(this.apiClient,e);return a=he("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>f)}else{const u=R1(this.apiClient,e);return a=he("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>f)}}async listInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=T1(e);return a=he("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=I1(f),g=new PT;return Object.assign(g,m),g})}else{const u=v1(e);return a=he("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=E1(f),g=new PT;return Object.assign(g,m),g})}}}function LT(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function tt(t){return this instanceof tt?(this.v=t,this):new tt(t)}function la(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),i,s=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(v){return function(T){return Promise.resolve(T).then(v,m)}}function a(v,T){r[v]&&(i[v]=function(P){return new Promise(function(D,S){s.push([v,P,D,S])>1||l(v,P)})},T&&(i[v]=T(i[v])))}function l(v,T){try{u(r[v](T))}catch(P){g(s[0][3],P)}}function u(v){v.value instanceof tt?Promise.resolve(v.value.v).then(f,m):g(s[0][2],v)}function f(v){l("next",v)}function m(v){l("throw",v)}function g(v,T){v(T),s.shift(),s.length&&l(s[0][0],s[0][1])}}function Wl(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof LT=="function"?LT(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(s){n[s]=t[s]&&function(o){return new Promise(function(a,l){o=t[s](o),i(a,l,o.done,o.value)})}}function i(s,o,a,l){Promise.resolve(l).then(function(u){s({value:u,done:a})},o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function N1(t){var e;if(t.candidates==null||t.candidates.length===0)return!1;const n=(e=t.candidates[0])===null||e===void 0?void 0:e.content;return n===void 0?!1:AC(n)}function AC(t){if(t.parts===void 0||t.parts.length===0)return!1;for(const e of t.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function D1(t){if(t.length!==0){for(const e of t)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function FT(t){if(t===void 0||t.length===0)return[];const e=[],n=t.length;let r=0;for(;r<n;)if(t[r].role==="user")e.push(t[r]),r++;else{const i=[];let s=!0;for(;r<n&&t[r].role==="model";)i.push(t[r]),s&&!AC(t[r])&&(s=!1),r++;s?e.push(...i):e.pop()}return e}class b1{constructor(e,n){this.modelsModule=e,this.apiClient=n}create(e){return new M1(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class M1{constructor(e,n,r,i={},s=[]){this.apiClient=e,this.modelsModule=n,this.model=r,this.config=i,this.history=s,this.sendPromise=Promise.resolve(),D1(s)}async sendMessage(e){var n;await this.sendPromise;const r=Zt(e.message),i=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var s,o,a;const l=await i,u=(o=(s=l.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content,f=l.automaticFunctionCallingHistory,m=this.getHistory(!0).length;let g=[];f!=null&&(g=(a=f.slice(m))!==null&&a!==void 0?a:[]);const v=u?[u]:[];this.recordHistory(r,v,g)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),i}async sendMessageStream(e){var n;await this.sendPromise;const r=Zt(e.message),i=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});this.sendPromise=i.then(()=>{}).catch(()=>{});const s=await i;return this.processStreamResponse(s,r)}getHistory(e=!1){const n=e?FT(this.history):this.history;return structuredClone(n)}processStreamResponse(e,n){var r,i;return la(this,arguments,function*(){var o,a,l,u;const f=[];try{for(var m=!0,g=Wl(e),v;v=yield tt(g.next()),o=v.done,!o;m=!0){u=v.value,m=!1;const T=u;if(N1(T)){const P=(i=(r=T.candidates)===null||r===void 0?void 0:r[0])===null||i===void 0?void 0:i.content;P!==void 0&&f.push(P)}yield yield tt(T)}}catch(T){a={error:T}}finally{try{!m&&!o&&(l=g.return)&&(yield tt(l.call(g)))}finally{if(a)throw a.error}}this.recordHistory(n,f)})}recordHistory(e,n,r){let i=[];n.length>0&&n.every(s=>s.role!==void 0)?i=n:i.push({role:"model",parts:[]}),r&&r.length>0?this.history.push(...FT(r)):this.history.push(e),this.history.push(...i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Kh extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,Kh.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function V1(t){const e={},n=c(t,["file"]);return n!=null&&h(e,["file"],n),e}function L1(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&h(e,["sdkHttpResponse"],n),e}function F1(t){const e={},n=c(t,["name"]);return n!=null&&h(e,["_url","file"],vC(n)),e}function U1(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&h(e,["sdkHttpResponse"],n),e}function O1(t){const e={},n=c(t,["name"]);return n!=null&&h(e,["_url","file"],vC(n)),e}function B1(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&h(e,["_query","pageSize"],r);const i=c(t,["pageToken"]);return e!==void 0&&i!=null&&h(e,["_query","pageToken"],i),n}function G1(t){const e={},n=c(t,["config"]);return n!=null&&B1(n,e),e}function q1(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=c(t,["files"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),h(e,["files"],s)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class z1 extends po{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new Gu(no.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(n),n)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(n=>n)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=G1(e);return s=he("files",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>{const u=q1(l),f=new eN;return Object.assign(f,u),f})}}async createInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=V1(e);return s=he("upload/v1beta/files",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=L1(l),f=new tN;return Object.assign(f,u),f})}}async get(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=O1(e);return s=he("files/{file}",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>l)}}async delete(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=F1(e);return s=he("files/{file}",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>{const u=U1(l),f=new nN;return Object.assign(f,u),f})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function _d(t){const e={},n=c(t,["data"]);if(n!=null&&h(e,["data"],n),c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function $1(t){const e={},n=c(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>sD(s))),h(e,["parts"],i)}const r=c(t,["role"]);return r!=null&&h(e,["role"],r),e}function H1(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["fileUri"]);n!=null&&h(e,["fileUri"],n);const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function W1(t){const e={};if(c(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=c(t,["description"]);n!=null&&h(e,["description"],n);const r=c(t,["name"]);r!=null&&h(e,["name"],r);const i=c(t,["parameters"]);i!=null&&h(e,["parameters"],i);const s=c(t,["parametersJsonSchema"]);s!=null&&h(e,["parametersJsonSchema"],s);const o=c(t,["response"]);o!=null&&h(e,["response"],o);const a=c(t,["responseJsonSchema"]);return a!=null&&h(e,["responseJsonSchema"],a),e}function j1(t){const e={},n=c(t,["modelSelectionConfig"]);n!=null&&h(e,["modelConfig"],n);const r=c(t,["audioTimestamp"]);r!=null&&h(e,["audioTimestamp"],r);const i=c(t,["candidateCount"]);i!=null&&h(e,["candidateCount"],i);const s=c(t,["enableAffectiveDialog"]);s!=null&&h(e,["enableAffectiveDialog"],s);const o=c(t,["frequencyPenalty"]);o!=null&&h(e,["frequencyPenalty"],o);const a=c(t,["logprobs"]);a!=null&&h(e,["logprobs"],a);const l=c(t,["maxOutputTokens"]);l!=null&&h(e,["maxOutputTokens"],l);const u=c(t,["mediaResolution"]);u!=null&&h(e,["mediaResolution"],u);const f=c(t,["presencePenalty"]);f!=null&&h(e,["presencePenalty"],f);const m=c(t,["responseJsonSchema"]);m!=null&&h(e,["responseJsonSchema"],m);const g=c(t,["responseLogprobs"]);g!=null&&h(e,["responseLogprobs"],g);const v=c(t,["responseMimeType"]);v!=null&&h(e,["responseMimeType"],v);const T=c(t,["responseModalities"]);T!=null&&h(e,["responseModalities"],T);const P=c(t,["responseSchema"]);P!=null&&h(e,["responseSchema"],P);const D=c(t,["routingConfig"]);D!=null&&h(e,["routingConfig"],D);const S=c(t,["seed"]);S!=null&&h(e,["seed"],S);const I=c(t,["speechConfig"]);I!=null&&h(e,["speechConfig"],xC(I));const R=c(t,["stopSequences"]);R!=null&&h(e,["stopSequences"],R);const V=c(t,["temperature"]);V!=null&&h(e,["temperature"],V);const U=c(t,["thinkingConfig"]);U!=null&&h(e,["thinkingConfig"],U);const B=c(t,["topK"]);B!=null&&h(e,["topK"],B);const E=c(t,["topP"]);if(E!=null&&h(e,["topP"],E),c(t,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function K1(t){const e={};if(c(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=c(t,["enableWidget"]);return n!=null&&h(e,["enableWidget"],n),e}function J1(t){const e={};if(c(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");const n=c(t,["timeRangeFilter"]);return n!=null&&h(e,["timeRangeFilter"],n),e}function Q1(t,e){const n={},r=c(t,["generationConfig"]);e!==void 0&&r!=null&&h(e,["setup","generationConfig"],r);const i=c(t,["responseModalities"]);e!==void 0&&i!=null&&h(e,["setup","generationConfig","responseModalities"],i);const s=c(t,["temperature"]);e!==void 0&&s!=null&&h(e,["setup","generationConfig","temperature"],s);const o=c(t,["topP"]);e!==void 0&&o!=null&&h(e,["setup","generationConfig","topP"],o);const a=c(t,["topK"]);e!==void 0&&a!=null&&h(e,["setup","generationConfig","topK"],a);const l=c(t,["maxOutputTokens"]);e!==void 0&&l!=null&&h(e,["setup","generationConfig","maxOutputTokens"],l);const u=c(t,["mediaResolution"]);e!==void 0&&u!=null&&h(e,["setup","generationConfig","mediaResolution"],u);const f=c(t,["seed"]);e!==void 0&&f!=null&&h(e,["setup","generationConfig","seed"],f);const m=c(t,["speechConfig"]);e!==void 0&&m!=null&&h(e,["setup","generationConfig","speechConfig"],c_(m));const g=c(t,["thinkingConfig"]);e!==void 0&&g!=null&&h(e,["setup","generationConfig","thinkingConfig"],g);const v=c(t,["enableAffectiveDialog"]);e!==void 0&&v!=null&&h(e,["setup","generationConfig","enableAffectiveDialog"],v);const T=c(t,["systemInstruction"]);e!==void 0&&T!=null&&h(e,["setup","systemInstruction"],$1(Zt(T)));const P=c(t,["tools"]);if(e!==void 0&&P!=null){let B=Ga(P);Array.isArray(B)&&(B=B.map(E=>aD(Ba(E)))),h(e,["setup","tools"],B)}const D=c(t,["sessionResumption"]);e!==void 0&&D!=null&&h(e,["setup","sessionResumption"],oD(D));const S=c(t,["inputAudioTranscription"]);e!==void 0&&S!=null&&h(e,["setup","inputAudioTranscription"],S);const I=c(t,["outputAudioTranscription"]);e!==void 0&&I!=null&&h(e,["setup","outputAudioTranscription"],I);const R=c(t,["realtimeInputConfig"]);e!==void 0&&R!=null&&h(e,["setup","realtimeInputConfig"],R);const V=c(t,["contextWindowCompression"]);e!==void 0&&V!=null&&h(e,["setup","contextWindowCompression"],V);const U=c(t,["proactivity"]);return e!==void 0&&U!=null&&h(e,["setup","proactivity"],U),n}function Y1(t,e){const n={},r=c(t,["generationConfig"]);e!==void 0&&r!=null&&h(e,["setup","generationConfig"],j1(r));const i=c(t,["responseModalities"]);e!==void 0&&i!=null&&h(e,["setup","generationConfig","responseModalities"],i);const s=c(t,["temperature"]);e!==void 0&&s!=null&&h(e,["setup","generationConfig","temperature"],s);const o=c(t,["topP"]);e!==void 0&&o!=null&&h(e,["setup","generationConfig","topP"],o);const a=c(t,["topK"]);e!==void 0&&a!=null&&h(e,["setup","generationConfig","topK"],a);const l=c(t,["maxOutputTokens"]);e!==void 0&&l!=null&&h(e,["setup","generationConfig","maxOutputTokens"],l);const u=c(t,["mediaResolution"]);e!==void 0&&u!=null&&h(e,["setup","generationConfig","mediaResolution"],u);const f=c(t,["seed"]);e!==void 0&&f!=null&&h(e,["setup","generationConfig","seed"],f);const m=c(t,["speechConfig"]);e!==void 0&&m!=null&&h(e,["setup","generationConfig","speechConfig"],xC(c_(m)));const g=c(t,["thinkingConfig"]);e!==void 0&&g!=null&&h(e,["setup","generationConfig","thinkingConfig"],g);const v=c(t,["enableAffectiveDialog"]);e!==void 0&&v!=null&&h(e,["setup","generationConfig","enableAffectiveDialog"],v);const T=c(t,["systemInstruction"]);e!==void 0&&T!=null&&h(e,["setup","systemInstruction"],Zt(T));const P=c(t,["tools"]);if(e!==void 0&&P!=null){let B=Ga(P);Array.isArray(B)&&(B=B.map(E=>lD(Ba(E)))),h(e,["setup","tools"],B)}const D=c(t,["sessionResumption"]);e!==void 0&&D!=null&&h(e,["setup","sessionResumption"],D);const S=c(t,["inputAudioTranscription"]);e!==void 0&&S!=null&&h(e,["setup","inputAudioTranscription"],S);const I=c(t,["outputAudioTranscription"]);e!==void 0&&I!=null&&h(e,["setup","outputAudioTranscription"],I);const R=c(t,["realtimeInputConfig"]);e!==void 0&&R!=null&&h(e,["setup","realtimeInputConfig"],R);const V=c(t,["contextWindowCompression"]);e!==void 0&&V!=null&&h(e,["setup","contextWindowCompression"],V);const U=c(t,["proactivity"]);return e!==void 0&&U!=null&&h(e,["setup","proactivity"],U),n}function X1(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["setup","model"],qe(t,r));const i=c(e,["config"]);return i!=null&&h(n,["config"],Q1(i,n)),n}function Z1(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["setup","model"],qe(t,r));const i=c(e,["config"]);return i!=null&&h(n,["config"],Y1(i,n)),n}function eD(t){const e={},n=c(t,["musicGenerationConfig"]);return n!=null&&h(e,["musicGenerationConfig"],n),e}function tD(t){const e={},n=c(t,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>i)),h(e,["weightedPrompts"],r)}return e}function nD(t){const e={},n=c(t,["media"]);if(n!=null){let u=pC(n);Array.isArray(u)&&(u=u.map(f=>_d(f))),h(e,["mediaChunks"],u)}const r=c(t,["audio"]);r!=null&&h(e,["audio"],_d(gC(r)));const i=c(t,["audioStreamEnd"]);i!=null&&h(e,["audioStreamEnd"],i);const s=c(t,["video"]);s!=null&&h(e,["video"],_d(mC(s)));const o=c(t,["text"]);o!=null&&h(e,["text"],o);const a=c(t,["activityStart"]);a!=null&&h(e,["activityStart"],a);const l=c(t,["activityEnd"]);return l!=null&&h(e,["activityEnd"],l),e}function rD(t){const e={},n=c(t,["media"]);if(n!=null){let u=pC(n);Array.isArray(u)&&(u=u.map(f=>f)),h(e,["mediaChunks"],u)}const r=c(t,["audio"]);r!=null&&h(e,["audio"],gC(r));const i=c(t,["audioStreamEnd"]);i!=null&&h(e,["audioStreamEnd"],i);const s=c(t,["video"]);s!=null&&h(e,["video"],mC(s));const o=c(t,["text"]);o!=null&&h(e,["text"],o);const a=c(t,["activityStart"]);a!=null&&h(e,["activityStart"],a);const l=c(t,["activityEnd"]);return l!=null&&h(e,["activityEnd"],l),e}function iD(t){const e={},n=c(t,["setupComplete"]);n!=null&&h(e,["setupComplete"],n);const r=c(t,["serverContent"]);r!=null&&h(e,["serverContent"],r);const i=c(t,["toolCall"]);i!=null&&h(e,["toolCall"],i);const s=c(t,["toolCallCancellation"]);s!=null&&h(e,["toolCallCancellation"],s);const o=c(t,["usageMetadata"]);o!=null&&h(e,["usageMetadata"],uD(o));const a=c(t,["goAway"]);a!=null&&h(e,["goAway"],a);const l=c(t,["sessionResumptionUpdate"]);return l!=null&&h(e,["sessionResumptionUpdate"],l),e}function sD(t){const e={},n=c(t,["functionCall"]);n!=null&&h(e,["functionCall"],n);const r=c(t,["codeExecutionResult"]);r!=null&&h(e,["codeExecutionResult"],r);const i=c(t,["executableCode"]);i!=null&&h(e,["executableCode"],i);const s=c(t,["fileData"]);s!=null&&h(e,["fileData"],H1(s));const o=c(t,["functionResponse"]);o!=null&&h(e,["functionResponse"],o);const a=c(t,["inlineData"]);a!=null&&h(e,["inlineData"],_d(a));const l=c(t,["text"]);l!=null&&h(e,["text"],l);const u=c(t,["thought"]);u!=null&&h(e,["thought"],u);const f=c(t,["thoughtSignature"]);f!=null&&h(e,["thoughtSignature"],f);const m=c(t,["videoMetadata"]);return m!=null&&h(e,["videoMetadata"],m),e}function oD(t){const e={},n=c(t,["handle"]);if(n!=null&&h(e,["handle"],n),c(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function xC(t){const e={},n=c(t,["languageCode"]);n!=null&&h(e,["languageCode"],n);const r=c(t,["voiceConfig"]);if(r!=null&&h(e,["voiceConfig"],r),c(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return e}function aD(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(f=>f)),h(e,["functionDeclarations"],u)}if(c(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=c(t,["googleSearchRetrieval"]);r!=null&&h(e,["googleSearchRetrieval"],r);const i=c(t,["googleMaps"]);i!=null&&h(e,["googleMaps"],K1(i));const s=c(t,["computerUse"]);s!=null&&h(e,["computerUse"],s);const o=c(t,["codeExecution"]);if(o!=null&&h(e,["codeExecution"],o),c(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=c(t,["googleSearch"]);a!=null&&h(e,["googleSearch"],J1(a));const l=c(t,["urlContext"]);return l!=null&&h(e,["urlContext"],l),e}function lD(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let m=n;Array.isArray(m)&&(m=m.map(g=>W1(g))),h(e,["functionDeclarations"],m)}const r=c(t,["retrieval"]);r!=null&&h(e,["retrieval"],r);const i=c(t,["googleSearchRetrieval"]);i!=null&&h(e,["googleSearchRetrieval"],i);const s=c(t,["googleMaps"]);s!=null&&h(e,["googleMaps"],s);const o=c(t,["computerUse"]);o!=null&&h(e,["computerUse"],o);const a=c(t,["codeExecution"]);a!=null&&h(e,["codeExecution"],a);const l=c(t,["enterpriseWebSearch"]);l!=null&&h(e,["enterpriseWebSearch"],l);const u=c(t,["googleSearch"]);u!=null&&h(e,["googleSearch"],u);const f=c(t,["urlContext"]);return f!=null&&h(e,["urlContext"],f),e}function uD(t){const e={},n=c(t,["promptTokenCount"]);n!=null&&h(e,["promptTokenCount"],n);const r=c(t,["cachedContentTokenCount"]);r!=null&&h(e,["cachedContentTokenCount"],r);const i=c(t,["candidatesTokenCount"]);i!=null&&h(e,["responseTokenCount"],i);const s=c(t,["toolUsePromptTokenCount"]);s!=null&&h(e,["toolUsePromptTokenCount"],s);const o=c(t,["thoughtsTokenCount"]);o!=null&&h(e,["thoughtsTokenCount"],o);const a=c(t,["totalTokenCount"]);a!=null&&h(e,["totalTokenCount"],a);const l=c(t,["promptTokensDetails"]);if(l!=null){let v=l;Array.isArray(v)&&(v=v.map(T=>T)),h(e,["promptTokensDetails"],v)}const u=c(t,["cacheTokensDetails"]);if(u!=null){let v=u;Array.isArray(v)&&(v=v.map(T=>T)),h(e,["cacheTokensDetails"],v)}const f=c(t,["candidatesTokensDetails"]);if(f!=null){let v=f;Array.isArray(v)&&(v=v.map(T=>T)),h(e,["responseTokensDetails"],v)}const m=c(t,["toolUsePromptTokensDetails"]);if(m!=null){let v=m;Array.isArray(v)&&(v=v.map(T=>T)),h(e,["toolUsePromptTokensDetails"],v)}const g=c(t,["trafficType"]);return g!=null&&h(e,["trafficType"],g),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function cD(t){const e={},n=c(t,["data"]);if(n!=null&&h(e,["data"],n),c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function dD(t){const e={},n=c(t,["content"]);n!=null&&h(e,["content"],n);const r=c(t,["citationMetadata"]);r!=null&&h(e,["citationMetadata"],hD(r));const i=c(t,["tokenCount"]);i!=null&&h(e,["tokenCount"],i);const s=c(t,["finishReason"]);s!=null&&h(e,["finishReason"],s);const o=c(t,["avgLogprobs"]);o!=null&&h(e,["avgLogprobs"],o);const a=c(t,["groundingMetadata"]);a!=null&&h(e,["groundingMetadata"],a);const l=c(t,["index"]);l!=null&&h(e,["index"],l);const u=c(t,["logprobsResult"]);u!=null&&h(e,["logprobsResult"],u);const f=c(t,["safetyRatings"]);if(f!=null){let g=f;Array.isArray(g)&&(g=g.map(v=>v)),h(e,["safetyRatings"],g)}const m=c(t,["urlContextMetadata"]);return m!=null&&h(e,["urlContextMetadata"],m),e}function hD(t){const e={},n=c(t,["citationSources"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>i)),h(e,["citations"],r)}return e}function fD(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=c(e,["contents"]);if(i!=null){let s=Hn(i);Array.isArray(s)&&(s=s.map(o=>o)),h(n,["contents"],s)}return n}function pD(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["tokensInfo"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>s)),h(e,["tokensInfo"],i)}return e}function mD(t){const e={},n=c(t,["values"]);n!=null&&h(e,["values"],n);const r=c(t,["statistics"]);return r!=null&&h(e,["statistics"],gD(r)),e}function gD(t){const e={},n=c(t,["truncated"]);n!=null&&h(e,["truncated"],n);const r=c(t,["token_count"]);return r!=null&&h(e,["tokenCount"],r),e}function Jh(t){const e={},n=c(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>Eb(s))),h(e,["parts"],i)}const r=c(t,["role"]);return r!=null&&h(e,["role"],r),e}function _D(t){const e={},n=c(t,["controlType"]);n!=null&&h(e,["controlType"],n);const r=c(t,["enableControlImageComputation"]);return r!=null&&h(e,["computeControl"],r),e}function yD(t){const e={};if(c(t,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(c(t,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(c(t,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function vD(t,e){const n={},r=c(t,["systemInstruction"]);e!==void 0&&r!=null&&h(e,["systemInstruction"],Zt(r));const i=c(t,["tools"]);if(e!==void 0&&i!=null){let o=i;Array.isArray(o)&&(o=o.map(a=>DC(a))),h(e,["tools"],o)}const s=c(t,["generationConfig"]);return e!==void 0&&s!=null&&h(e,["generationConfig"],lb(s)),n}function TD(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=c(e,["contents"]);if(i!=null){let o=Hn(i);Array.isArray(o)&&(o=o.map(a=>Jh(a))),h(n,["contents"],o)}const s=c(e,["config"]);return s!=null&&yD(s),n}function ED(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=c(e,["contents"]);if(i!=null){let o=Hn(i);Array.isArray(o)&&(o=o.map(a=>a)),h(n,["contents"],o)}const s=c(e,["config"]);return s!=null&&vD(s,n),n}function ID(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["totalTokens"]);r!=null&&h(e,["totalTokens"],r);const i=c(t,["cachedContentTokenCount"]);return i!=null&&h(e,["cachedContentTokenCount"],i),e}function wD(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["totalTokens"]);return r!=null&&h(e,["totalTokens"],r),e}function SD(t,e){const n={},r=c(e,["model"]);return r!=null&&h(n,["_url","name"],qe(t,r)),n}function CD(t,e){const n={},r=c(e,["model"]);return r!=null&&h(n,["_url","name"],qe(t,r)),n}function AD(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&h(e,["sdkHttpResponse"],n),e}function xD(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&h(e,["sdkHttpResponse"],n),e}function RD(t,e){const n={},r=c(t,["outputGcsUri"]);e!==void 0&&r!=null&&h(e,["parameters","storageUri"],r);const i=c(t,["negativePrompt"]);e!==void 0&&i!=null&&h(e,["parameters","negativePrompt"],i);const s=c(t,["numberOfImages"]);e!==void 0&&s!=null&&h(e,["parameters","sampleCount"],s);const o=c(t,["aspectRatio"]);e!==void 0&&o!=null&&h(e,["parameters","aspectRatio"],o);const a=c(t,["guidanceScale"]);e!==void 0&&a!=null&&h(e,["parameters","guidanceScale"],a);const l=c(t,["seed"]);e!==void 0&&l!=null&&h(e,["parameters","seed"],l);const u=c(t,["safetyFilterLevel"]);e!==void 0&&u!=null&&h(e,["parameters","safetySetting"],u);const f=c(t,["personGeneration"]);e!==void 0&&f!=null&&h(e,["parameters","personGeneration"],f);const m=c(t,["includeSafetyAttributes"]);e!==void 0&&m!=null&&h(e,["parameters","includeSafetyAttributes"],m);const g=c(t,["includeRaiReason"]);e!==void 0&&g!=null&&h(e,["parameters","includeRaiReason"],g);const v=c(t,["language"]);e!==void 0&&v!=null&&h(e,["parameters","language"],v);const T=c(t,["outputMimeType"]);e!==void 0&&T!=null&&h(e,["parameters","outputOptions","mimeType"],T);const P=c(t,["outputCompressionQuality"]);e!==void 0&&P!=null&&h(e,["parameters","outputOptions","compressionQuality"],P);const D=c(t,["addWatermark"]);e!==void 0&&D!=null&&h(e,["parameters","addWatermark"],D);const S=c(t,["labels"]);e!==void 0&&S!=null&&h(e,["labels"],S);const I=c(t,["editMode"]);e!==void 0&&I!=null&&h(e,["parameters","editMode"],I);const R=c(t,["baseSteps"]);return e!==void 0&&R!=null&&h(e,["parameters","editConfig","baseSteps"],R),n}function PD(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=c(e,["prompt"]);i!=null&&h(n,["instances[0]","prompt"],i);const s=c(e,["referenceImages"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>xb(l))),h(n,["instances[0]","referenceImages"],a)}const o=c(e,["config"]);return o!=null&&RD(o,n),n}function kD(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>Qh(s))),h(e,["generatedImages"],i)}return e}function ND(t,e){const n={},r=c(t,["taskType"]);e!==void 0&&r!=null&&h(e,["requests[]","taskType"],r);const i=c(t,["title"]);e!==void 0&&i!=null&&h(e,["requests[]","title"],i);const s=c(t,["outputDimensionality"]);if(e!==void 0&&s!=null&&h(e,["requests[]","outputDimensionality"],s),c(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(c(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function DD(t,e){const n={},r=c(t,["taskType"]);e!==void 0&&r!=null&&h(e,["instances[]","task_type"],r);const i=c(t,["title"]);e!==void 0&&i!=null&&h(e,["instances[]","title"],i);const s=c(t,["outputDimensionality"]);e!==void 0&&s!=null&&h(e,["parameters","outputDimensionality"],s);const o=c(t,["mimeType"]);e!==void 0&&o!=null&&h(e,["instances[]","mimeType"],o);const a=c(t,["autoTruncate"]);return e!==void 0&&a!=null&&h(e,["parameters","autoTruncate"],a),n}function bD(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=c(e,["contents"]);if(i!=null){let a=a_(t,i);Array.isArray(a)&&(a=a.map(l=>l)),h(n,["requests[]","content"],a)}const s=c(e,["config"]);s!=null&&ND(s,n);const o=c(e,["model"]);return o!==void 0&&h(n,["requests[]","model"],qe(t,o)),n}function MD(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=c(e,["contents"]);if(i!=null){let o=a_(t,i);Array.isArray(o)&&(o=o.map(a=>a)),h(n,["instances[]","content"],o)}const s=c(e,["config"]);return s!=null&&DD(s,n),n}function VD(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["embeddings"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>o)),h(e,["embeddings"],s)}const i=c(t,["metadata"]);return i!=null&&h(e,["metadata"],i),e}function LD(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["predictions[]","embeddings"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>mD(o))),h(e,["embeddings"],s)}const i=c(t,["metadata"]);return i!=null&&h(e,["metadata"],i),e}function FD(t){const e={},n=c(t,["endpoint"]);n!=null&&h(e,["name"],n);const r=c(t,["deployedModelId"]);return r!=null&&h(e,["deployedModelId"],r),e}function UD(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["fileUri"]);n!=null&&h(e,["fileUri"],n);const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function OD(t){const e={};if(c(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=c(t,["description"]);n!=null&&h(e,["description"],n);const r=c(t,["name"]);r!=null&&h(e,["name"],r);const i=c(t,["parameters"]);i!=null&&h(e,["parameters"],i);const s=c(t,["parametersJsonSchema"]);s!=null&&h(e,["parametersJsonSchema"],s);const o=c(t,["response"]);o!=null&&h(e,["response"],o);const a=c(t,["responseJsonSchema"]);return a!=null&&h(e,["responseJsonSchema"],a),e}function BD(t,e,n){const r={},i=c(e,["systemInstruction"]);n!==void 0&&i!=null&&h(n,["systemInstruction"],Jh(Zt(i)));const s=c(e,["temperature"]);s!=null&&h(r,["temperature"],s);const o=c(e,["topP"]);o!=null&&h(r,["topP"],o);const a=c(e,["topK"]);a!=null&&h(r,["topK"],a);const l=c(e,["candidateCount"]);l!=null&&h(r,["candidateCount"],l);const u=c(e,["maxOutputTokens"]);u!=null&&h(r,["maxOutputTokens"],u);const f=c(e,["stopSequences"]);f!=null&&h(r,["stopSequences"],f);const m=c(e,["responseLogprobs"]);m!=null&&h(r,["responseLogprobs"],m);const g=c(e,["logprobs"]);g!=null&&h(r,["logprobs"],g);const v=c(e,["presencePenalty"]);v!=null&&h(r,["presencePenalty"],v);const T=c(e,["frequencyPenalty"]);T!=null&&h(r,["frequencyPenalty"],T);const P=c(e,["seed"]);P!=null&&h(r,["seed"],P);const D=c(e,["responseMimeType"]);D!=null&&h(r,["responseMimeType"],D);const S=c(e,["responseSchema"]);S!=null&&h(r,["responseSchema"],l_(S));const I=c(e,["responseJsonSchema"]);if(I!=null&&h(r,["responseJsonSchema"],I),c(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(c(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const R=c(e,["safetySettings"]);if(n!==void 0&&R!=null){let L=R;Array.isArray(L)&&(L=L.map(N=>Rb(N))),h(n,["safetySettings"],L)}const V=c(e,["tools"]);if(n!==void 0&&V!=null){let L=Ga(V);Array.isArray(L)&&(L=L.map(N=>Mb(Ba(N)))),h(n,["tools"],L)}const U=c(e,["toolConfig"]);if(n!==void 0&&U!=null&&h(n,["toolConfig"],U),c(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const B=c(e,["cachedContent"]);n!==void 0&&B!=null&&h(n,["cachedContent"],ni(t,B));const E=c(e,["responseModalities"]);E!=null&&h(r,["responseModalities"],E);const w=c(e,["mediaResolution"]);w!=null&&h(r,["mediaResolution"],w);const C=c(e,["speechConfig"]);if(C!=null&&h(r,["speechConfig"],u_(C)),c(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const k=c(e,["thinkingConfig"]);k!=null&&h(r,["thinkingConfig"],k);const M=c(e,["imageConfig"]);return M!=null&&h(r,["imageConfig"],M),r}function GD(t,e,n){const r={},i=c(e,["systemInstruction"]);n!==void 0&&i!=null&&h(n,["systemInstruction"],Zt(i));const s=c(e,["temperature"]);s!=null&&h(r,["temperature"],s);const o=c(e,["topP"]);o!=null&&h(r,["topP"],o);const a=c(e,["topK"]);a!=null&&h(r,["topK"],a);const l=c(e,["candidateCount"]);l!=null&&h(r,["candidateCount"],l);const u=c(e,["maxOutputTokens"]);u!=null&&h(r,["maxOutputTokens"],u);const f=c(e,["stopSequences"]);f!=null&&h(r,["stopSequences"],f);const m=c(e,["responseLogprobs"]);m!=null&&h(r,["responseLogprobs"],m);const g=c(e,["logprobs"]);g!=null&&h(r,["logprobs"],g);const v=c(e,["presencePenalty"]);v!=null&&h(r,["presencePenalty"],v);const T=c(e,["frequencyPenalty"]);T!=null&&h(r,["frequencyPenalty"],T);const P=c(e,["seed"]);P!=null&&h(r,["seed"],P);const D=c(e,["responseMimeType"]);D!=null&&h(r,["responseMimeType"],D);const S=c(e,["responseSchema"]);S!=null&&h(r,["responseSchema"],l_(S));const I=c(e,["responseJsonSchema"]);I!=null&&h(r,["responseJsonSchema"],I);const R=c(e,["routingConfig"]);R!=null&&h(r,["routingConfig"],R);const V=c(e,["modelSelectionConfig"]);V!=null&&h(r,["modelConfig"],V);const U=c(e,["safetySettings"]);if(n!==void 0&&U!=null){let je=U;Array.isArray(je)&&(je=je.map(Ee=>Ee)),h(n,["safetySettings"],je)}const B=c(e,["tools"]);if(n!==void 0&&B!=null){let je=Ga(B);Array.isArray(je)&&(je=je.map(Ee=>DC(Ba(Ee)))),h(n,["tools"],je)}const E=c(e,["toolConfig"]);n!==void 0&&E!=null&&h(n,["toolConfig"],E);const w=c(e,["labels"]);n!==void 0&&w!=null&&h(n,["labels"],w);const C=c(e,["cachedContent"]);n!==void 0&&C!=null&&h(n,["cachedContent"],ni(t,C));const k=c(e,["responseModalities"]);k!=null&&h(r,["responseModalities"],k);const M=c(e,["mediaResolution"]);M!=null&&h(r,["mediaResolution"],M);const L=c(e,["speechConfig"]);L!=null&&h(r,["speechConfig"],NC(u_(L)));const N=c(e,["audioTimestamp"]);N!=null&&h(r,["audioTimestamp"],N);const Ne=c(e,["thinkingConfig"]);Ne!=null&&h(r,["thinkingConfig"],Ne);const Fe=c(e,["imageConfig"]);return Fe!=null&&h(r,["imageConfig"],Fe),r}function UT(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=c(e,["contents"]);if(i!=null){let o=Hn(i);Array.isArray(o)&&(o=o.map(a=>Jh(a))),h(n,["contents"],o)}const s=c(e,["config"]);return s!=null&&h(n,["generationConfig"],BD(t,s,n)),n}function OT(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=c(e,["contents"]);if(i!=null){let o=Hn(i);Array.isArray(o)&&(o=o.map(a=>a)),h(n,["contents"],o)}const s=c(e,["config"]);return s!=null&&h(n,["generationConfig"],GD(t,s,n)),n}function BT(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["candidates"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(u=>dD(u))),h(e,["candidates"],l)}const i=c(t,["modelVersion"]);i!=null&&h(e,["modelVersion"],i);const s=c(t,["promptFeedback"]);s!=null&&h(e,["promptFeedback"],s);const o=c(t,["responseId"]);o!=null&&h(e,["responseId"],o);const a=c(t,["usageMetadata"]);return a!=null&&h(e,["usageMetadata"],a),e}function GT(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["candidates"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(f=>f)),h(e,["candidates"],u)}const i=c(t,["createTime"]);i!=null&&h(e,["createTime"],i);const s=c(t,["modelVersion"]);s!=null&&h(e,["modelVersion"],s);const o=c(t,["promptFeedback"]);o!=null&&h(e,["promptFeedback"],o);const a=c(t,["responseId"]);a!=null&&h(e,["responseId"],a);const l=c(t,["usageMetadata"]);return l!=null&&h(e,["usageMetadata"],l),e}function qD(t,e){const n={};if(c(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(c(t,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const r=c(t,["numberOfImages"]);e!==void 0&&r!=null&&h(e,["parameters","sampleCount"],r);const i=c(t,["aspectRatio"]);e!==void 0&&i!=null&&h(e,["parameters","aspectRatio"],i);const s=c(t,["guidanceScale"]);if(e!==void 0&&s!=null&&h(e,["parameters","guidanceScale"],s),c(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=c(t,["safetyFilterLevel"]);e!==void 0&&o!=null&&h(e,["parameters","safetySetting"],o);const a=c(t,["personGeneration"]);e!==void 0&&a!=null&&h(e,["parameters","personGeneration"],a);const l=c(t,["includeSafetyAttributes"]);e!==void 0&&l!=null&&h(e,["parameters","includeSafetyAttributes"],l);const u=c(t,["includeRaiReason"]);e!==void 0&&u!=null&&h(e,["parameters","includeRaiReason"],u);const f=c(t,["language"]);e!==void 0&&f!=null&&h(e,["parameters","language"],f);const m=c(t,["outputMimeType"]);e!==void 0&&m!=null&&h(e,["parameters","outputOptions","mimeType"],m);const g=c(t,["outputCompressionQuality"]);if(e!==void 0&&g!=null&&h(e,["parameters","outputOptions","compressionQuality"],g),c(t,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(c(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const v=c(t,["imageSize"]);if(e!==void 0&&v!=null&&h(e,["parameters","sampleImageSize"],v),c(t,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function zD(t,e){const n={},r=c(t,["outputGcsUri"]);e!==void 0&&r!=null&&h(e,["parameters","storageUri"],r);const i=c(t,["negativePrompt"]);e!==void 0&&i!=null&&h(e,["parameters","negativePrompt"],i);const s=c(t,["numberOfImages"]);e!==void 0&&s!=null&&h(e,["parameters","sampleCount"],s);const o=c(t,["aspectRatio"]);e!==void 0&&o!=null&&h(e,["parameters","aspectRatio"],o);const a=c(t,["guidanceScale"]);e!==void 0&&a!=null&&h(e,["parameters","guidanceScale"],a);const l=c(t,["seed"]);e!==void 0&&l!=null&&h(e,["parameters","seed"],l);const u=c(t,["safetyFilterLevel"]);e!==void 0&&u!=null&&h(e,["parameters","safetySetting"],u);const f=c(t,["personGeneration"]);e!==void 0&&f!=null&&h(e,["parameters","personGeneration"],f);const m=c(t,["includeSafetyAttributes"]);e!==void 0&&m!=null&&h(e,["parameters","includeSafetyAttributes"],m);const g=c(t,["includeRaiReason"]);e!==void 0&&g!=null&&h(e,["parameters","includeRaiReason"],g);const v=c(t,["language"]);e!==void 0&&v!=null&&h(e,["parameters","language"],v);const T=c(t,["outputMimeType"]);e!==void 0&&T!=null&&h(e,["parameters","outputOptions","mimeType"],T);const P=c(t,["outputCompressionQuality"]);e!==void 0&&P!=null&&h(e,["parameters","outputOptions","compressionQuality"],P);const D=c(t,["addWatermark"]);e!==void 0&&D!=null&&h(e,["parameters","addWatermark"],D);const S=c(t,["labels"]);e!==void 0&&S!=null&&h(e,["labels"],S);const I=c(t,["imageSize"]);e!==void 0&&I!=null&&h(e,["parameters","sampleImageSize"],I);const R=c(t,["enhancePrompt"]);return e!==void 0&&R!=null&&h(e,["parameters","enhancePrompt"],R),n}function $D(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=c(e,["prompt"]);i!=null&&h(n,["instances[0]","prompt"],i);const s=c(e,["config"]);return s!=null&&qD(s,n),n}function HD(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=c(e,["prompt"]);i!=null&&h(n,["instances[0]","prompt"],i);const s=c(e,["config"]);return s!=null&&zD(s,n),n}function WD(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>ib(o))),h(e,["generatedImages"],s)}const i=c(t,["positivePromptSafetyAttributes"]);return i!=null&&h(e,["positivePromptSafetyAttributes"],PC(i)),e}function jD(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>Qh(o))),h(e,["generatedImages"],s)}const i=c(t,["positivePromptSafetyAttributes"]);return i!=null&&h(e,["positivePromptSafetyAttributes"],kC(i)),e}function KD(t,e){const n={},r=c(t,["numberOfVideos"]);if(e!==void 0&&r!=null&&h(e,["parameters","sampleCount"],r),c(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(c(t,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const i=c(t,["durationSeconds"]);if(e!==void 0&&i!=null&&h(e,["parameters","durationSeconds"],i),c(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const s=c(t,["aspectRatio"]);e!==void 0&&s!=null&&h(e,["parameters","aspectRatio"],s);const o=c(t,["resolution"]);e!==void 0&&o!=null&&h(e,["parameters","resolution"],o);const a=c(t,["personGeneration"]);if(e!==void 0&&a!=null&&h(e,["parameters","personGeneration"],a),c(t,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const l=c(t,["negativePrompt"]);e!==void 0&&l!=null&&h(e,["parameters","negativePrompt"],l);const u=c(t,["enhancePrompt"]);if(e!==void 0&&u!=null&&h(e,["parameters","enhancePrompt"],u),c(t,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const f=c(t,["lastFrame"]);e!==void 0&&f!=null&&h(e,["instances[0]","lastFrame"],Yh(f));const m=c(t,["referenceImages"]);if(e!==void 0&&m!=null){let g=m;Array.isArray(g)&&(g=g.map(v=>jb(v))),h(e,["instances[0]","referenceImages"],g)}if(c(t,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(c(t,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return n}function JD(t,e){const n={},r=c(t,["numberOfVideos"]);e!==void 0&&r!=null&&h(e,["parameters","sampleCount"],r);const i=c(t,["outputGcsUri"]);e!==void 0&&i!=null&&h(e,["parameters","storageUri"],i);const s=c(t,["fps"]);e!==void 0&&s!=null&&h(e,["parameters","fps"],s);const o=c(t,["durationSeconds"]);e!==void 0&&o!=null&&h(e,["parameters","durationSeconds"],o);const a=c(t,["seed"]);e!==void 0&&a!=null&&h(e,["parameters","seed"],a);const l=c(t,["aspectRatio"]);e!==void 0&&l!=null&&h(e,["parameters","aspectRatio"],l);const u=c(t,["resolution"]);e!==void 0&&u!=null&&h(e,["parameters","resolution"],u);const f=c(t,["personGeneration"]);e!==void 0&&f!=null&&h(e,["parameters","personGeneration"],f);const m=c(t,["pubsubTopic"]);e!==void 0&&m!=null&&h(e,["parameters","pubsubTopic"],m);const g=c(t,["negativePrompt"]);e!==void 0&&g!=null&&h(e,["parameters","negativePrompt"],g);const v=c(t,["enhancePrompt"]);e!==void 0&&v!=null&&h(e,["parameters","enhancePrompt"],v);const T=c(t,["generateAudio"]);e!==void 0&&T!=null&&h(e,["parameters","generateAudio"],T);const P=c(t,["lastFrame"]);e!==void 0&&P!=null&&h(e,["instances[0]","lastFrame"],ur(P));const D=c(t,["referenceImages"]);if(e!==void 0&&D!=null){let R=D;Array.isArray(R)&&(R=R.map(V=>Kb(V))),h(e,["instances[0]","referenceImages"],R)}const S=c(t,["mask"]);e!==void 0&&S!=null&&h(e,["instances[0]","mask"],Wb(S));const I=c(t,["compressionQuality"]);return e!==void 0&&I!=null&&h(e,["parameters","compressionQuality"],I),n}function QD(t){const e={},n=c(t,["name"]);n!=null&&h(e,["name"],n);const r=c(t,["metadata"]);r!=null&&h(e,["metadata"],r);const i=c(t,["done"]);i!=null&&h(e,["done"],i);const s=c(t,["error"]);s!=null&&h(e,["error"],s);const o=c(t,["response","generateVideoResponse"]);return o!=null&&h(e,["response"],eb(o)),e}function YD(t){const e={},n=c(t,["name"]);n!=null&&h(e,["name"],n);const r=c(t,["metadata"]);r!=null&&h(e,["metadata"],r);const i=c(t,["done"]);i!=null&&h(e,["done"],i);const s=c(t,["error"]);s!=null&&h(e,["error"],s);const o=c(t,["response"]);return o!=null&&h(e,["response"],tb(o)),e}function XD(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=c(e,["prompt"]);i!=null&&h(n,["instances[0]","prompt"],i);const s=c(e,["image"]);s!=null&&h(n,["instances[0]","image"],Yh(s));const o=c(e,["video"]);o!=null&&h(n,["instances[0]","video"],bC(o));const a=c(e,["source"]);a!=null&&nb(a,n);const l=c(e,["config"]);return l!=null&&KD(l,n),n}function ZD(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=c(e,["prompt"]);i!=null&&h(n,["instances[0]","prompt"],i);const s=c(e,["image"]);s!=null&&h(n,["instances[0]","image"],ur(s));const o=c(e,["video"]);o!=null&&h(n,["instances[0]","video"],MC(o));const a=c(e,["source"]);a!=null&&rb(a,n);const l=c(e,["config"]);return l!=null&&JD(l,n),n}function eb(t){const e={},n=c(t,["generatedSamples"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>ob(o))),h(e,["generatedVideos"],s)}const r=c(t,["raiMediaFilteredCount"]);r!=null&&h(e,["raiMediaFilteredCount"],r);const i=c(t,["raiMediaFilteredReasons"]);return i!=null&&h(e,["raiMediaFilteredReasons"],i),e}function tb(t){const e={},n=c(t,["videos"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>ab(o))),h(e,["generatedVideos"],s)}const r=c(t,["raiMediaFilteredCount"]);r!=null&&h(e,["raiMediaFilteredCount"],r);const i=c(t,["raiMediaFilteredReasons"]);return i!=null&&h(e,["raiMediaFilteredReasons"],i),e}function nb(t,e){const n={},r=c(t,["prompt"]);e!==void 0&&r!=null&&h(e,["instances[0]","prompt"],r);const i=c(t,["image"]);e!==void 0&&i!=null&&h(e,["instances[0]","image"],Yh(i));const s=c(t,["video"]);return e!==void 0&&s!=null&&h(e,["instances[0]","video"],bC(s)),n}function rb(t,e){const n={},r=c(t,["prompt"]);e!==void 0&&r!=null&&h(e,["instances[0]","prompt"],r);const i=c(t,["image"]);e!==void 0&&i!=null&&h(e,["instances[0]","image"],ur(i));const s=c(t,["video"]);return e!==void 0&&s!=null&&h(e,["instances[0]","video"],MC(s)),n}function ib(t){const e={},n=c(t,["_self"]);n!=null&&h(e,["image"],fb(n));const r=c(t,["raiFilteredReason"]);r!=null&&h(e,["raiFilteredReason"],r);const i=c(t,["_self"]);return i!=null&&h(e,["safetyAttributes"],PC(i)),e}function Qh(t){const e={},n=c(t,["_self"]);n!=null&&h(e,["image"],RC(n));const r=c(t,["raiFilteredReason"]);r!=null&&h(e,["raiFilteredReason"],r);const i=c(t,["_self"]);i!=null&&h(e,["safetyAttributes"],kC(i));const s=c(t,["prompt"]);return s!=null&&h(e,["enhancedPrompt"],s),e}function sb(t){const e={},n=c(t,["_self"]);n!=null&&h(e,["mask"],RC(n));const r=c(t,["labels"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>s)),h(e,["labels"],i)}return e}function ob(t){const e={},n=c(t,["video"]);return n!=null&&h(e,["video"],$b(n)),e}function ab(t){const e={},n=c(t,["_self"]);return n!=null&&h(e,["video"],Hb(n)),e}function lb(t){const e={},n=c(t,["modelSelectionConfig"]);n!=null&&h(e,["modelConfig"],n);const r=c(t,["audioTimestamp"]);r!=null&&h(e,["audioTimestamp"],r);const i=c(t,["candidateCount"]);i!=null&&h(e,["candidateCount"],i);const s=c(t,["enableAffectiveDialog"]);s!=null&&h(e,["enableAffectiveDialog"],s);const o=c(t,["frequencyPenalty"]);o!=null&&h(e,["frequencyPenalty"],o);const a=c(t,["logprobs"]);a!=null&&h(e,["logprobs"],a);const l=c(t,["maxOutputTokens"]);l!=null&&h(e,["maxOutputTokens"],l);const u=c(t,["mediaResolution"]);u!=null&&h(e,["mediaResolution"],u);const f=c(t,["presencePenalty"]);f!=null&&h(e,["presencePenalty"],f);const m=c(t,["responseJsonSchema"]);m!=null&&h(e,["responseJsonSchema"],m);const g=c(t,["responseLogprobs"]);g!=null&&h(e,["responseLogprobs"],g);const v=c(t,["responseMimeType"]);v!=null&&h(e,["responseMimeType"],v);const T=c(t,["responseModalities"]);T!=null&&h(e,["responseModalities"],T);const P=c(t,["responseSchema"]);P!=null&&h(e,["responseSchema"],P);const D=c(t,["routingConfig"]);D!=null&&h(e,["routingConfig"],D);const S=c(t,["seed"]);S!=null&&h(e,["seed"],S);const I=c(t,["speechConfig"]);I!=null&&h(e,["speechConfig"],NC(I));const R=c(t,["stopSequences"]);R!=null&&h(e,["stopSequences"],R);const V=c(t,["temperature"]);V!=null&&h(e,["temperature"],V);const U=c(t,["thinkingConfig"]);U!=null&&h(e,["thinkingConfig"],U);const B=c(t,["topK"]);B!=null&&h(e,["topK"],B);const E=c(t,["topP"]);if(E!=null&&h(e,["topP"],E),c(t,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function ub(t,e){const n={},r=c(e,["model"]);return r!=null&&h(n,["_url","name"],qe(t,r)),n}function cb(t,e){const n={},r=c(e,["model"]);return r!=null&&h(n,["_url","name"],qe(t,r)),n}function db(t){const e={};if(c(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=c(t,["enableWidget"]);return n!=null&&h(e,["enableWidget"],n),e}function hb(t){const e={};if(c(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");const n=c(t,["timeRangeFilter"]);return n!=null&&h(e,["timeRangeFilter"],n),e}function fb(t){const e={},n=c(t,["bytesBase64Encoded"]);n!=null&&h(e,["imageBytes"],os(n));const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function RC(t){const e={},n=c(t,["gcsUri"]);n!=null&&h(e,["gcsUri"],n);const r=c(t,["bytesBase64Encoded"]);r!=null&&h(e,["imageBytes"],os(r));const i=c(t,["mimeType"]);return i!=null&&h(e,["mimeType"],i),e}function Yh(t){const e={};if(c(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=c(t,["imageBytes"]);n!=null&&h(e,["bytesBase64Encoded"],os(n));const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function ur(t){const e={},n=c(t,["gcsUri"]);n!=null&&h(e,["gcsUri"],n);const r=c(t,["imageBytes"]);r!=null&&h(e,["bytesBase64Encoded"],os(r));const i=c(t,["mimeType"]);return i!=null&&h(e,["mimeType"],i),e}function pb(t,e,n){const r={},i=c(e,["pageSize"]);n!==void 0&&i!=null&&h(n,["_query","pageSize"],i);const s=c(e,["pageToken"]);n!==void 0&&s!=null&&h(n,["_query","pageToken"],s);const o=c(e,["filter"]);n!==void 0&&o!=null&&h(n,["_query","filter"],o);const a=c(e,["queryBase"]);return n!==void 0&&a!=null&&h(n,["_url","models_url"],TC(t,a)),r}function mb(t,e,n){const r={},i=c(e,["pageSize"]);n!==void 0&&i!=null&&h(n,["_query","pageSize"],i);const s=c(e,["pageToken"]);n!==void 0&&s!=null&&h(n,["_query","pageToken"],s);const o=c(e,["filter"]);n!==void 0&&o!=null&&h(n,["_query","filter"],o);const a=c(e,["queryBase"]);return n!==void 0&&a!=null&&h(n,["_url","models_url"],TC(t,a)),r}function gb(t,e){const n={},r=c(e,["config"]);return r!=null&&pb(t,r,n),n}function _b(t,e){const n={},r=c(e,["config"]);return r!=null&&mb(t,r,n),n}function yb(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=c(t,["_self"]);if(i!=null){let s=EC(i);Array.isArray(s)&&(s=s.map(o=>Sm(o))),h(e,["models"],s)}return e}function vb(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=c(t,["_self"]);if(i!=null){let s=EC(i);Array.isArray(s)&&(s=s.map(o=>Cm(o))),h(e,["models"],s)}return e}function Tb(t){const e={},n=c(t,["maskMode"]);n!=null&&h(e,["maskMode"],n);const r=c(t,["segmentationClasses"]);r!=null&&h(e,["maskClasses"],r);const i=c(t,["maskDilation"]);return i!=null&&h(e,["dilation"],i),e}function Sm(t){const e={},n=c(t,["name"]);n!=null&&h(e,["name"],n);const r=c(t,["displayName"]);r!=null&&h(e,["displayName"],r);const i=c(t,["description"]);i!=null&&h(e,["description"],i);const s=c(t,["version"]);s!=null&&h(e,["version"],s);const o=c(t,["_self"]);o!=null&&h(e,["tunedModelInfo"],Vb(o));const a=c(t,["inputTokenLimit"]);a!=null&&h(e,["inputTokenLimit"],a);const l=c(t,["outputTokenLimit"]);l!=null&&h(e,["outputTokenLimit"],l);const u=c(t,["supportedGenerationMethods"]);return u!=null&&h(e,["supportedActions"],u),e}function Cm(t){const e={},n=c(t,["name"]);n!=null&&h(e,["name"],n);const r=c(t,["displayName"]);r!=null&&h(e,["displayName"],r);const i=c(t,["description"]);i!=null&&h(e,["description"],i);const s=c(t,["versionId"]);s!=null&&h(e,["version"],s);const o=c(t,["deployedModels"]);if(o!=null){let m=o;Array.isArray(m)&&(m=m.map(g=>FD(g))),h(e,["endpoints"],m)}const a=c(t,["labels"]);a!=null&&h(e,["labels"],a);const l=c(t,["_self"]);l!=null&&h(e,["tunedModelInfo"],Lb(l));const u=c(t,["defaultCheckpointId"]);u!=null&&h(e,["defaultCheckpointId"],u);const f=c(t,["checkpoints"]);if(f!=null){let m=f;Array.isArray(m)&&(m=m.map(g=>g)),h(e,["checkpoints"],m)}return e}function Eb(t){const e={},n=c(t,["functionCall"]);n!=null&&h(e,["functionCall"],n);const r=c(t,["codeExecutionResult"]);r!=null&&h(e,["codeExecutionResult"],r);const i=c(t,["executableCode"]);i!=null&&h(e,["executableCode"],i);const s=c(t,["fileData"]);s!=null&&h(e,["fileData"],UD(s));const o=c(t,["functionResponse"]);o!=null&&h(e,["functionResponse"],o);const a=c(t,["inlineData"]);a!=null&&h(e,["inlineData"],cD(a));const l=c(t,["text"]);l!=null&&h(e,["text"],l);const u=c(t,["thought"]);u!=null&&h(e,["thought"],u);const f=c(t,["thoughtSignature"]);f!=null&&h(e,["thoughtSignature"],f);const m=c(t,["videoMetadata"]);return m!=null&&h(e,["videoMetadata"],m),e}function Ib(t){const e={},n=c(t,["productImage"]);return n!=null&&h(e,["image"],ur(n)),e}function wb(t,e){const n={},r=c(t,["numberOfImages"]);e!==void 0&&r!=null&&h(e,["parameters","sampleCount"],r);const i=c(t,["baseSteps"]);e!==void 0&&i!=null&&h(e,["parameters","editConfig","baseSteps"],i);const s=c(t,["outputGcsUri"]);e!==void 0&&s!=null&&h(e,["parameters","storageUri"],s);const o=c(t,["seed"]);e!==void 0&&o!=null&&h(e,["parameters","seed"],o);const a=c(t,["safetyFilterLevel"]);e!==void 0&&a!=null&&h(e,["parameters","safetySetting"],a);const l=c(t,["personGeneration"]);e!==void 0&&l!=null&&h(e,["parameters","personGeneration"],l);const u=c(t,["addWatermark"]);e!==void 0&&u!=null&&h(e,["parameters","addWatermark"],u);const f=c(t,["outputMimeType"]);e!==void 0&&f!=null&&h(e,["parameters","outputOptions","mimeType"],f);const m=c(t,["outputCompressionQuality"]);e!==void 0&&m!=null&&h(e,["parameters","outputOptions","compressionQuality"],m);const g=c(t,["enhancePrompt"]);e!==void 0&&g!=null&&h(e,["parameters","enhancePrompt"],g);const v=c(t,["labels"]);return e!==void 0&&v!=null&&h(e,["labels"],v),n}function Sb(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=c(e,["source"]);i!=null&&Ab(i,n);const s=c(e,["config"]);return s!=null&&wb(s,n),n}function Cb(t){const e={},n=c(t,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>Qh(i))),h(e,["generatedImages"],r)}return e}function Ab(t,e){const n={},r=c(t,["prompt"]);e!==void 0&&r!=null&&h(e,["instances[0]","prompt"],r);const i=c(t,["personImage"]);e!==void 0&&i!=null&&h(e,["instances[0]","personImage","image"],ur(i));const s=c(t,["productImages"]);if(e!==void 0&&s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>Ib(a))),h(e,["instances[0]","productImages"],o)}return n}function xb(t){const e={},n=c(t,["referenceImage"]);n!=null&&h(e,["referenceImage"],ur(n));const r=c(t,["referenceId"]);r!=null&&h(e,["referenceId"],r);const i=c(t,["referenceType"]);i!=null&&h(e,["referenceType"],i);const s=c(t,["maskImageConfig"]);s!=null&&h(e,["maskImageConfig"],Tb(s));const o=c(t,["controlImageConfig"]);o!=null&&h(e,["controlImageConfig"],_D(o));const a=c(t,["styleImageConfig"]);a!=null&&h(e,["styleImageConfig"],a);const l=c(t,["subjectImageConfig"]);return l!=null&&h(e,["subjectImageConfig"],l),e}function PC(t){const e={},n=c(t,["safetyAttributes","categories"]);n!=null&&h(e,["categories"],n);const r=c(t,["safetyAttributes","scores"]);r!=null&&h(e,["scores"],r);const i=c(t,["contentType"]);return i!=null&&h(e,["contentType"],i),e}function kC(t){const e={},n=c(t,["safetyAttributes","categories"]);n!=null&&h(e,["categories"],n);const r=c(t,["safetyAttributes","scores"]);r!=null&&h(e,["scores"],r);const i=c(t,["contentType"]);return i!=null&&h(e,["contentType"],i),e}function Rb(t){const e={},n=c(t,["category"]);if(n!=null&&h(e,["category"],n),c(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=c(t,["threshold"]);return r!=null&&h(e,["threshold"],r),e}function Pb(t){const e={},n=c(t,["image"]);return n!=null&&h(e,["image"],ur(n)),e}function kb(t,e){const n={},r=c(t,["mode"]);e!==void 0&&r!=null&&h(e,["parameters","mode"],r);const i=c(t,["maxPredictions"]);e!==void 0&&i!=null&&h(e,["parameters","maxPredictions"],i);const s=c(t,["confidenceThreshold"]);e!==void 0&&s!=null&&h(e,["parameters","confidenceThreshold"],s);const o=c(t,["maskDilation"]);e!==void 0&&o!=null&&h(e,["parameters","maskDilation"],o);const a=c(t,["binaryColorThreshold"]);e!==void 0&&a!=null&&h(e,["parameters","binaryColorThreshold"],a);const l=c(t,["labels"]);return e!==void 0&&l!=null&&h(e,["labels"],l),n}function Nb(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=c(e,["source"]);i!=null&&bb(i,n);const s=c(e,["config"]);return s!=null&&kb(s,n),n}function Db(t){const e={},n=c(t,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>sb(i))),h(e,["generatedMasks"],r)}return e}function bb(t,e){const n={},r=c(t,["prompt"]);e!==void 0&&r!=null&&h(e,["instances[0]","prompt"],r);const i=c(t,["image"]);e!==void 0&&i!=null&&h(e,["instances[0]","image"],ur(i));const s=c(t,["scribbleImage"]);return e!==void 0&&s!=null&&h(e,["instances[0]","scribble"],Pb(s)),n}function NC(t){const e={},n=c(t,["languageCode"]);n!=null&&h(e,["languageCode"],n);const r=c(t,["voiceConfig"]);if(r!=null&&h(e,["voiceConfig"],r),c(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return e}function Mb(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(f=>f)),h(e,["functionDeclarations"],u)}if(c(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=c(t,["googleSearchRetrieval"]);r!=null&&h(e,["googleSearchRetrieval"],r);const i=c(t,["googleMaps"]);i!=null&&h(e,["googleMaps"],db(i));const s=c(t,["computerUse"]);s!=null&&h(e,["computerUse"],s);const o=c(t,["codeExecution"]);if(o!=null&&h(e,["codeExecution"],o),c(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=c(t,["googleSearch"]);a!=null&&h(e,["googleSearch"],hb(a));const l=c(t,["urlContext"]);return l!=null&&h(e,["urlContext"],l),e}function DC(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let m=n;Array.isArray(m)&&(m=m.map(g=>OD(g))),h(e,["functionDeclarations"],m)}const r=c(t,["retrieval"]);r!=null&&h(e,["retrieval"],r);const i=c(t,["googleSearchRetrieval"]);i!=null&&h(e,["googleSearchRetrieval"],i);const s=c(t,["googleMaps"]);s!=null&&h(e,["googleMaps"],s);const o=c(t,["computerUse"]);o!=null&&h(e,["computerUse"],o);const a=c(t,["codeExecution"]);a!=null&&h(e,["codeExecution"],a);const l=c(t,["enterpriseWebSearch"]);l!=null&&h(e,["enterpriseWebSearch"],l);const u=c(t,["googleSearch"]);u!=null&&h(e,["googleSearch"],u);const f=c(t,["urlContext"]);return f!=null&&h(e,["urlContext"],f),e}function Vb(t){const e={},n=c(t,["baseModel"]);n!=null&&h(e,["baseModel"],n);const r=c(t,["createTime"]);r!=null&&h(e,["createTime"],r);const i=c(t,["updateTime"]);return i!=null&&h(e,["updateTime"],i),e}function Lb(t){const e={},n=c(t,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&h(e,["baseModel"],n);const r=c(t,["createTime"]);r!=null&&h(e,["createTime"],r);const i=c(t,["updateTime"]);return i!=null&&h(e,["updateTime"],i),e}function Fb(t,e){const n={},r=c(t,["displayName"]);e!==void 0&&r!=null&&h(e,["displayName"],r);const i=c(t,["description"]);e!==void 0&&i!=null&&h(e,["description"],i);const s=c(t,["defaultCheckpointId"]);return e!==void 0&&s!=null&&h(e,["defaultCheckpointId"],s),n}function Ub(t,e){const n={},r=c(t,["displayName"]);e!==void 0&&r!=null&&h(e,["displayName"],r);const i=c(t,["description"]);e!==void 0&&i!=null&&h(e,["description"],i);const s=c(t,["defaultCheckpointId"]);return e!==void 0&&s!=null&&h(e,["defaultCheckpointId"],s),n}function Ob(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","name"],qe(t,r));const i=c(e,["config"]);return i!=null&&Fb(i,n),n}function Bb(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=c(e,["config"]);return i!=null&&Ub(i,n),n}function Gb(t,e){const n={},r=c(t,["outputGcsUri"]);e!==void 0&&r!=null&&h(e,["parameters","storageUri"],r);const i=c(t,["safetyFilterLevel"]);e!==void 0&&i!=null&&h(e,["parameters","safetySetting"],i);const s=c(t,["personGeneration"]);e!==void 0&&s!=null&&h(e,["parameters","personGeneration"],s);const o=c(t,["includeRaiReason"]);e!==void 0&&o!=null&&h(e,["parameters","includeRaiReason"],o);const a=c(t,["outputMimeType"]);e!==void 0&&a!=null&&h(e,["parameters","outputOptions","mimeType"],a);const l=c(t,["outputCompressionQuality"]);e!==void 0&&l!=null&&h(e,["parameters","outputOptions","compressionQuality"],l);const u=c(t,["enhanceInputImage"]);e!==void 0&&u!=null&&h(e,["parameters","upscaleConfig","enhanceInputImage"],u);const f=c(t,["imagePreservationFactor"]);e!==void 0&&f!=null&&h(e,["parameters","upscaleConfig","imagePreservationFactor"],f);const m=c(t,["labels"]);e!==void 0&&m!=null&&h(e,["labels"],m);const g=c(t,["numberOfImages"]);e!==void 0&&g!=null&&h(e,["parameters","sampleCount"],g);const v=c(t,["mode"]);return e!==void 0&&v!=null&&h(e,["parameters","mode"],v),n}function qb(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=c(e,["image"]);i!=null&&h(n,["instances[0]","image"],ur(i));const s=c(e,["upscaleFactor"]);s!=null&&h(n,["parameters","upscaleConfig","upscaleFactor"],s);const o=c(e,["config"]);return o!=null&&Gb(o,n),n}function zb(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>Qh(s))),h(e,["generatedImages"],i)}return e}function $b(t){const e={},n=c(t,["uri"]);n!=null&&h(e,["uri"],n);const r=c(t,["encodedVideo"]);r!=null&&h(e,["videoBytes"],os(r));const i=c(t,["encoding"]);return i!=null&&h(e,["mimeType"],i),e}function Hb(t){const e={},n=c(t,["gcsUri"]);n!=null&&h(e,["uri"],n);const r=c(t,["bytesBase64Encoded"]);r!=null&&h(e,["videoBytes"],os(r));const i=c(t,["mimeType"]);return i!=null&&h(e,["mimeType"],i),e}function Wb(t){const e={},n=c(t,["image"]);n!=null&&h(e,["_self"],ur(n));const r=c(t,["maskMode"]);return r!=null&&h(e,["maskMode"],r),e}function jb(t){const e={},n=c(t,["image"]);n!=null&&h(e,["image"],Yh(n));const r=c(t,["referenceType"]);return r!=null&&h(e,["referenceType"],r),e}function Kb(t){const e={},n=c(t,["image"]);n!=null&&h(e,["image"],ur(n));const r=c(t,["referenceType"]);return r!=null&&h(e,["referenceType"],r),e}function bC(t){const e={},n=c(t,["uri"]);n!=null&&h(e,["uri"],n);const r=c(t,["videoBytes"]);r!=null&&h(e,["encodedVideo"],os(r));const i=c(t,["mimeType"]);return i!=null&&h(e,["encoding"],i),e}function MC(t){const e={},n=c(t,["uri"]);n!=null&&h(e,["gcsUri"],n);const r=c(t,["videoBytes"]);r!=null&&h(e,["bytesBase64Encoded"],os(r));const i=c(t,["mimeType"]);return i!=null&&h(e,["mimeType"],i),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Jb="Content-Type",Qb="X-Server-Timeout",Yb="User-Agent",Am="x-goog-api-client",Xb="1.28.0",Zb=`google-genai-sdk/${Xb}`,eM="v1beta1",tM="v1beta",qT=/^\s*data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class nM{constructor(e){var n,r;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const i={};this.clientOptions.vertexai?(i.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:eM,i.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(i.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:tM,i.baseUrl="https://generativelanguage.googleapis.com/"),i.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=i,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(i,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&r.push(e.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),n=new URL(e);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,n,r){const i=[this.getRequestUrlInternal(n)];return r&&i.push(this.getBaseResourcePath()),e!==""&&i.push(e),new URL(`${i.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,n,r);if(e.queryParams)for(const[o,a]of Object.entries(e.queryParams))i.searchParams.append(o,String(a));let s={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else s.body=e.body;return s=await this.includeExtraHttpOptionsToRequestInit(s,n,i.toString(),e.abortSignal),this.unaryApiCall(i,s,e.httpMethod)}patchHttpOptions(e,n){const r=JSON.parse(JSON.stringify(e));for(const[i,s]of Object.entries(n))typeof s=="object"?r[i]=Object.assign(Object.assign({},r[i]),s):s!==void 0&&(r[i]=s);return r}async requestStream(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,n,r);(!i.searchParams.has("alt")||i.searchParams.get("alt")!=="sse")&&i.searchParams.set("alt","sse");let s={};return s.body=e.body,s=await this.includeExtraHttpOptionsToRequestInit(s,n,i.toString(),e.abortSignal),this.streamApiCall(i,s,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,n,r,i){if(n&&n.timeout||i){const s=new AbortController,o=s.signal;if(n.timeout&&(n==null?void 0:n.timeout)>0){const a=setTimeout(()=>s.abort(),n.timeout);a&&typeof a.unref=="function"&&a.unref()}i&&i.addEventListener("abort",()=>{s.abort()}),e.signal=o}return n&&n.extraBody!==null&&rM(e,n.extraBody),e.headers=await this.getHeadersInternal(n,r),e}async unaryApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async i=>(await zT(i),new Em(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}async streamApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async i=>(await zT(i),this.processStreamResponse(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}processStreamResponse(e){var n;return la(this,arguments,function*(){const i=(n=e==null?void 0:e.body)===null||n===void 0?void 0:n.getReader(),s=new TextDecoder("utf-8");if(!i)throw new Error("Response body is empty");try{let o="";for(;;){const{done:a,value:l}=yield tt(i.read());if(a){if(o.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const u=s.decode(l,{stream:!0});try{const m=JSON.parse(u);if("error"in m){const g=JSON.parse(JSON.stringify(m.error)),v=g.status,T=g.code,P=`got status: ${v}. ${JSON.stringify(m)}`;if(T>=400&&T<600)throw new Kh({message:P,status:T})}}catch(m){if(m.name==="ApiError")throw m}o+=u;let f=o.match(qT);for(;f;){const m=f[1];try{const g=new Response(m,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield tt(new Em(g)),o=o.slice(f[0].length),f=o.match(qT)}catch(g){throw new Error(`exception parsing stream chunk ${m}. ${g}`)}}}}finally{i.releaseLock()}})}async apiCall(e,n){return fetch(e,n).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const e={},n=Zb+" "+this.clientOptions.userAgentExtra;return e[Yb]=n,e[Am]=n,e[Jb]="application/json",e}async getHeadersInternal(e,n){const r=new Headers;if(e&&e.headers){for(const[i,s]of Object.entries(e.headers))r.append(i,s);e.timeout&&e.timeout>0&&r.append(Qb,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(r,n),r}async uploadFile(e,n){var r,i;const s={};n!=null&&(s.mimeType=n.mimeType,s.name=n.name,s.displayName=n.displayName),s.name&&!s.name.startsWith("files/")&&(s.name=`files/${s.name}`);const o=this.clientOptions.uploader,a=await o.stat(e);s.sizeBytes=String(a.size);const l=(r=n==null?void 0:n.mimeType)!==null&&r!==void 0?r:a.type;if(l===void 0||l==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");s.mimeType=l;let u="";typeof e=="string"&&(u=e.replace(/[/\\]+$/,""),u=(i=u.split(/[/\\]/).pop())!==null&&i!==void 0?i:"");const f=await this.fetchUploadUrl(s,u,n);return o.upload(e,f,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,n,r){var i;let s={};r!=null&&r.httpOptions?s=r.httpOptions:s={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`},n?{"X-Goog-Upload-File-Name":n}:{})};const o={file:e},a=await this.request({path:he("upload/v1beta/files",o._url),body:JSON.stringify(o),httpMethod:"POST",httpOptions:s});if(!a||!(a!=null&&a.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const l=(i=a==null?void 0:a.headers)===null||i===void 0?void 0:i["x-goog-upload-url"];if(l===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return l}}async function zT(t){var e;if(t===void 0)throw new Error("response is undefined");if(!t.ok){const n=t.status;let r;!((e=t.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?r=await t.json():r={error:{message:await t.text(),code:t.status,status:t.statusText}};const i=JSON.stringify(r);throw n>=400&&n<600?new Kh({message:i,status:n}):new Error(i)}}function rM(t,e){if(!e||Object.keys(e).length===0)return;if(t.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let n={};if(typeof t.body=="string"&&t.body.length>0)try{const s=JSON.parse(t.body);if(typeof s=="object"&&s!==null&&!Array.isArray(s))n=s;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function r(s,o){const a=Object.assign({},s);for(const l in o)if(Object.prototype.hasOwnProperty.call(o,l)){const u=o[l],f=a[l];u&&typeof u=="object"&&!Array.isArray(u)&&f&&typeof f=="object"&&!Array.isArray(f)?a[l]=r(f,u):(f&&u&&typeof f!=typeof u&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${l}". Original type: ${typeof f}, New type: ${typeof u}. Overwriting.`),a[l]=u)}return a}const i=r(n,e);t.body=JSON.stringify(i)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const iM="mcp_used/unknown";let sM=!1;function VC(t){for(const e of t)if(oM(e)||typeof e=="object"&&"inputSchema"in e)return!0;return sM}function LC(t){var e;const n=(e=t[Am])!==null&&e!==void 0?e:"";t[Am]=(n+` ${iM}`).trimStart()}function oM(t){return t!==null&&typeof t=="object"&&t instanceof d_}function aM(t,e=100){return la(this,arguments,function*(){let r,i=0;for(;i<e;){const s=yield tt(t.listTools({cursor:r}));for(const o of s.tools)yield yield tt(o),i++;if(!s.nextCursor)break;r=s.nextCursor}})}class d_{constructor(e=[],n){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=n}static create(e,n){return new d_(e,n)}async initialize(){var e,n,r,i;if(this.mcpTools.length>0)return;const s={},o=[];for(const f of this.mcpClients)try{for(var a=!0,l=(n=void 0,Wl(aM(f))),u;u=await l.next(),e=u.done,!e;a=!0){i=u.value,a=!1;const m=i;o.push(m);const g=m.name;if(s[g])throw new Error(`Duplicate function name ${g} found in MCP tools. Please ensure function names are unique.`);s[g]=f}}catch(m){n={error:m}}finally{try{!a&&!e&&(r=l.return)&&await r.call(l)}finally{if(n)throw n.error}}this.mcpTools=o,this.functionNameToMcpClient=s}async tool(){return await this.initialize(),hN(this.mcpTools,this.config)}async callTool(e){await this.initialize();const n=[];for(const r of e)if(r.name in this.functionNameToMcpClient){const i=this.functionNameToMcpClient[r.name];let s;this.config.timeout&&(s={timeout:this.config.timeout});const o=await i.callTool({name:r.name,arguments:r.args},void 0,s);n.push({functionResponse:{name:r.name,response:o.isError?{error:o}:o}})}return n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function lM(t,e,n){const r=new iN;let i;n.data instanceof Blob?i=JSON.parse(await n.data.text()):i=JSON.parse(n.data),Object.assign(r,i),e(r)}class uM{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r}async connect(e){var n,r;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const i=this.apiClient.getWebsocketBaseUrl(),s=this.apiClient.getApiVersion(),o=hM(this.apiClient.getDefaultHeaders()),a=this.apiClient.getApiKey(),l=`${i}/ws/google.ai.generativelanguage.${s}.GenerativeService.BidiGenerateMusic?key=${a}`;let u=()=>{};const f=new Promise(R=>{u=R}),m=e.callbacks,g=function(){u({})},v=this.apiClient,T={onopen:g,onmessage:R=>{lM(v,m.onmessage,R)},onerror:(n=m==null?void 0:m.onerror)!==null&&n!==void 0?n:function(R){},onclose:(r=m==null?void 0:m.onclose)!==null&&r!==void 0?r:function(R){}},P=this.webSocketFactory.create(l,dM(o),T);P.connect(),await f;const I={setup:{model:qe(this.apiClient,e.model)}};return P.send(JSON.stringify(I)),new cM(P,this.apiClient)}}class cM{constructor(e,n){this.conn=e,this.apiClient=n}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const n=tD(e);this.conn.send(JSON.stringify({clientContent:n}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const n=eD(e);this.conn.send(JSON.stringify(n))}sendPlaybackControl(e){const n={playbackControl:e};this.conn.send(JSON.stringify(n))}play(){this.sendPlaybackControl(Zo.PLAY)}pause(){this.sendPlaybackControl(Zo.PAUSE)}stop(){this.sendPlaybackControl(Zo.STOP)}resetContext(){this.sendPlaybackControl(Zo.RESET_CONTEXT)}close(){this.conn.close()}}function dM(t){const e={};return t.forEach((n,r)=>{e[r]=n}),e}function hM(t){const e=new Headers;for(const[n,r]of Object.entries(t))e.append(n,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const fM="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function pM(t,e,n){const r=new rN;let i;n.data instanceof Blob?i=await n.data.text():n.data instanceof ArrayBuffer?i=new TextDecoder().decode(n.data):i=n.data;const s=JSON.parse(i);if(t.isVertexAI()){const o=iD(s);Object.assign(r,o)}else Object.assign(r,s);e(r)}class mM{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r,this.music=new uM(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var n,r,i,s,o,a;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const l=this.apiClient.getWebsocketBaseUrl(),u=this.apiClient.getApiVersion();let f;const m=this.apiClient.getHeaders();e.config&&e.config.tools&&VC(e.config.tools)&&LC(m);const g=vM(m);if(this.apiClient.isVertexAI())f=`${l}/ws/google.cloud.aiplatform.${u}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(g,f);else{const C=this.apiClient.getApiKey();let k="BidiGenerateContent",M="key";C!=null&&C.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),u!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),k="BidiGenerateContentConstrained",M="access_token"),f=`${l}/ws/google.ai.generativelanguage.${u}.GenerativeService.${k}?${M}=${C}`}let v=()=>{};const T=new Promise(C=>{v=C}),P=e.callbacks,D=function(){var C;(C=P==null?void 0:P.onopen)===null||C===void 0||C.call(P),v({})},S=this.apiClient,I={onopen:D,onmessage:C=>{pM(S,P.onmessage,C)},onerror:(n=P==null?void 0:P.onerror)!==null&&n!==void 0?n:function(C){},onclose:(r=P==null?void 0:P.onclose)!==null&&r!==void 0?r:function(C){}},R=this.webSocketFactory.create(f,yM(g),I);R.connect(),await T;let V=qe(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&V.startsWith("publishers/")){const C=this.apiClient.getProject(),k=this.apiClient.getLocation();V=`projects/${C}/locations/${k}/`+V}let U={};this.apiClient.isVertexAI()&&((i=e.config)===null||i===void 0?void 0:i.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[rh.AUDIO]}:e.config.responseModalities=[rh.AUDIO]),!((s=e.config)===null||s===void 0)&&s.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const B=(a=(o=e.config)===null||o===void 0?void 0:o.tools)!==null&&a!==void 0?a:[],E=[];for(const C of B)if(this.isCallableTool(C)){const k=C;E.push(await k.tool())}else E.push(C);E.length>0&&(e.config.tools=E);const w={model:V,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?U=Z1(this.apiClient,w):U=X1(this.apiClient,w),delete U.config,R.send(JSON.stringify(U)),new _M(R,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const gM={turnComplete:!0};class _M{constructor(e,n){this.conn=e,this.apiClient=n}tLiveClientContent(e,n){if(n.turns!==null&&n.turns!==void 0){let r=[];try{r=Hn(n.turns),e.isVertexAI()||(r=r.map(i=>Jh(i)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:r,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(e,n){let r=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?r=n.functionResponses:r=[n.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const s of r){if(typeof s!="object"||s===null||!("name"in s)||!("response"in s))throw new Error(`Could not parse function response, type '${typeof s}'.`);if(!e.isVertexAI()&&!("id"in s))throw new Error(fM)}return{toolResponse:{functionResponses:r}}}sendClientContent(e){e=Object.assign(Object.assign({},gM),e);const n=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(n))}sendRealtimeInput(e){let n={};this.apiClient.isVertexAI()?n={realtimeInput:rD(e)}:n={realtimeInput:nD(e)},this.conn.send(JSON.stringify(n))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function yM(t){const e={};return t.forEach((n,r)=>{e[r]=n}),e}function vM(t){const e=new Headers;for(const[n,r]of Object.entries(t))e.append(n,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const $T=10;function HT(t){var e,n,r;if(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let i=!1;for(const o of(n=t==null?void 0:t.tools)!==null&&n!==void 0?n:[])if(ua(o)){i=!0;break}if(!i)return!0;const s=(r=t==null?void 0:t.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls;return s&&(s<0||!Number.isInteger(s))||s==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",s),!0):!1}function ua(t){return"callTool"in t&&typeof t.callTool=="function"}function TM(t){var e,n,r;return(r=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(i=>ua(i)))!==null&&r!==void 0?r:!1}function EM(t){var e,n,r;return(r=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(i=>!ua(i)))!==null&&r!==void 0?r:!1}function WT(t){var e;return!(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class IM extends po{constructor(e){super(),this.apiClient=e,this.generateContent=async n=>{var r,i,s,o,a;const l=await this.processParamsMaybeAddMcpUsage(n);if(this.maybeMoveToResponseJsonSchem(n),!TM(n)||HT(n.config))return await this.generateContentInternal(l);if(EM(n))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");let u,f;const m=Hn(l.contents),g=(s=(i=(r=l.config)===null||r===void 0?void 0:r.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&s!==void 0?s:$T;let v=0;for(;v<g&&(u=await this.generateContentInternal(l),!(!u.functionCalls||u.functionCalls.length===0));){const T=u.candidates[0].content,P=[];for(const D of(a=(o=n.config)===null||o===void 0?void 0:o.tools)!==null&&a!==void 0?a:[])if(ua(D)){const I=await D.callTool(u.functionCalls);P.push(...I)}v++,f={role:"user",parts:P},l.contents=Hn(l.contents),l.contents.push(T),l.contents.push(f),WT(l.config)&&(m.push(T),m.push(f))}return WT(l.config)&&(u.automaticFunctionCallingHistory=m),u},this.generateContentStream=async n=>{if(this.maybeMoveToResponseJsonSchem(n),HT(n.config)){const r=await this.processParamsMaybeAddMcpUsage(n);return await this.generateContentStreamInternal(r)}else return await this.processAfcStream(n)},this.generateImages=async n=>await this.generateImagesInternal(n).then(r=>{var i;let s;const o=[];if(r!=null&&r.generatedImages)for(const l of r.generatedImages)l&&(l!=null&&l.safetyAttributes)&&((i=l==null?void 0:l.safetyAttributes)===null||i===void 0?void 0:i.contentType)==="Positive Prompt"?s=l==null?void 0:l.safetyAttributes:o.push(l);let a;return s?a={generatedImages:o,positivePromptSafetyAttributes:s,sdkHttpResponse:r.sdkHttpResponse}:a={generatedImages:o,sdkHttpResponse:r.sdkHttpResponse},a}),this.list=async n=>{var r;const o={config:Object.assign(Object.assign({},{queryBase:!0}),n==null?void 0:n.config)};if(this.apiClient.isVertexAI()&&!o.config.queryBase){if(!((r=o.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");o.config.filter="labels.tune-type:*"}return new Gu(no.PAGED_ITEM_MODELS,a=>this.listInternal(a),await this.listInternal(o),o)},this.editImage=async n=>{const r={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(r.referenceImages=n.referenceImages.map(i=>i.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async n=>{let r={numberOfImages:1,mode:"upscale"};n.config&&(r=Object.assign(Object.assign({},r),n.config));const i={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:r};return await this.upscaleImageInternal(i)},this.generateVideos=async n=>{var r,i,s,o,a,l;if((n.prompt||n.image||n.video)&&n.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((r=n.video)===null||r===void 0)&&r.uri&&(!((i=n.video)===null||i===void 0)&&i.videoBytes)?n.video={uri:n.video.uri,mimeType:n.video.mimeType}:!((o=(s=n.source)===null||s===void 0?void 0:s.video)===null||o===void 0)&&o.uri&&(!((l=(a=n.source)===null||a===void 0?void 0:a.video)===null||l===void 0)&&l.videoBytes)&&(n.source.video={uri:n.source.video.uri,mimeType:n.source.video.mimeType})),await this.generateVideosInternal(n)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var n,r,i;const s=(n=e.config)===null||n===void 0?void 0:n.tools;if(!s)return e;const o=await Promise.all(s.map(async l=>ua(l)?await l.tool():l)),a={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:o})};if(a.config.tools=o,e.config&&e.config.tools&&VC(e.config.tools)){const l=(i=(r=e.config.httpOptions)===null||r===void 0?void 0:r.headers)!==null&&i!==void 0?i:{};let u=Object.assign({},l);Object.keys(u).length===0&&(u=this.apiClient.getDefaultHeaders()),LC(u),a.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:u})}return a}async initAfcToolsMap(e){var n,r,i;const s=new Map;for(const o of(r=(n=e.config)===null||n===void 0?void 0:n.tools)!==null&&r!==void 0?r:[])if(ua(o)){const a=o,l=await a.tool();for(const u of(i=l.functionDeclarations)!==null&&i!==void 0?i:[]){if(!u.name)throw new Error("Function declaration name is required.");if(s.has(u.name))throw new Error(`Duplicate tool declaration name: ${u.name}`);s.set(u.name,a)}}return s}async processAfcStream(e){var n,r,i;const s=(i=(r=(n=e.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&i!==void 0?i:$T;let o=!1,a=0;const l=await this.initAfcToolsMap(e);return function(u,f,m){var g,v;return la(this,arguments,function*(){for(var T,P,D,S;a<s;){o&&(a++,o=!1);const U=yield tt(u.processParamsMaybeAddMcpUsage(m)),B=yield tt(u.generateContentStreamInternal(U)),E=[],w=[];try{for(var I=!0,R=(P=void 0,Wl(B)),V;V=yield tt(R.next()),T=V.done,!T;I=!0){S=V.value,I=!1;const C=S;if(yield yield tt(C),C.candidates&&(!((g=C.candidates[0])===null||g===void 0)&&g.content)){w.push(C.candidates[0].content);for(const k of(v=C.candidates[0].content.parts)!==null&&v!==void 0?v:[])if(a<s&&k.functionCall){if(!k.functionCall.name)throw new Error("Function call name was not returned by the model.");if(f.has(k.functionCall.name)){const M=yield tt(f.get(k.functionCall.name).callTool([k.functionCall]));E.push(...M)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${f.keys()}, mising tool: ${k.functionCall.name}`)}}}}catch(C){P={error:C}}finally{try{!I&&!T&&(D=R.return)&&(yield tt(D.call(R)))}finally{if(P)throw P.error}}if(E.length>0){o=!0;const C=new El;C.candidates=[{content:{role:"user",parts:E}}],yield yield tt(C);const k=[];k.push(...w),k.push({role:"user",parts:E});const M=Hn(m.contents).concat(k);m.contents=M}else break}})}(this,l,e)}async generateContentInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=OT(this.apiClient,e);return a=he("{model}:generateContent",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=GT(f),g=new El;return Object.assign(g,m),g})}else{const u=UT(this.apiClient,e);return a=he("{model}:generateContent",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=BT(f),g=new El;return Object.assign(g,m),g})}}async generateContentStreamInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=OT(this.apiClient,e);return a=he("{model}:streamGenerateContent?alt=sse",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.requestStream({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}),o.then(function(m){return la(this,arguments,function*(){var g,v,T,P;try{for(var D=!0,S=Wl(m),I;I=yield tt(S.next()),g=I.done,!g;D=!0){P=I.value,D=!1;const R=P,V=GT(yield tt(R.json()));V.sdkHttpResponse={headers:R.headers};const U=new El;Object.assign(U,V),yield yield tt(U)}}catch(R){v={error:R}}finally{try{!D&&!g&&(T=S.return)&&(yield tt(T.call(S)))}finally{if(v)throw v.error}}})})}else{const u=UT(this.apiClient,e);return a=he("{model}:streamGenerateContent?alt=sse",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.requestStream({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}),o.then(function(m){return la(this,arguments,function*(){var g,v,T,P;try{for(var D=!0,S=Wl(m),I;I=yield tt(S.next()),g=I.done,!g;D=!0){P=I.value,D=!1;const R=P,V=BT(yield tt(R.json()));V.sdkHttpResponse={headers:R.headers};const U=new El;Object.assign(U,V),yield yield tt(U)}}catch(R){v={error:R}}finally{try{!D&&!g&&(T=S.return)&&(yield tt(T.call(S)))}finally{if(v)throw v.error}}})})}}async embedContent(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=MD(this.apiClient,e);return a=he("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=LD(f),g=new IT;return Object.assign(g,m),g})}else{const u=bD(this.apiClient,e);return a=he("{model}:batchEmbedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=VD(f),g=new IT;return Object.assign(g,m),g})}}async generateImagesInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=HD(this.apiClient,e);return a=he("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=jD(f),g=new wT;return Object.assign(g,m),g})}else{const u=$D(this.apiClient,e);return a=he("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=WD(f),g=new wT;return Object.assign(g,m),g})}}async editImageInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=PD(this.apiClient,e);return s=he("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>{const u=kD(l),f=new Jk;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=qb(this.apiClient,e);return s=he("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>{const u=zb(l),f=new Qk;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=Sb(this.apiClient,e);return s=he("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=Cb(l),f=new Yk;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=Nb(this.apiClient,e);return s=he("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=Db(l),f=new Xk;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=cb(this.apiClient,e);return a=he("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>Cm(f))}else{const u=ub(this.apiClient,e);return a=he("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>Sm(f))}}async listInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=_b(this.apiClient,e);return a=he("{models_url}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=vb(f),g=new ST;return Object.assign(g,m),g})}else{const u=gb(this.apiClient,e);return a=he("{models_url}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=yb(f),g=new ST;return Object.assign(g,m),g})}}async update(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=Bb(this.apiClient,e);return a=he("{model}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>Cm(f))}else{const u=Ob(this.apiClient,e);return a=he("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>Sm(f))}}async delete(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=CD(this.apiClient,e);return a=he("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=xD(f),g=new CT;return Object.assign(g,m),g})}else{const u=SD(this.apiClient,e);return a=he("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=AD(f),g=new CT;return Object.assign(g,m),g})}}async countTokens(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=ED(this.apiClient,e);return a=he("{model}:countTokens",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=wD(f),g=new AT;return Object.assign(g,m),g})}else{const u=TD(this.apiClient,e);return a=he("{model}:countTokens",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=ID(f),g=new AT;return Object.assign(g,m),g})}}async computeTokens(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=fD(this.apiClient,e);return s=he("{model}:computeTokens",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>{const u=pD(l),f=new Zk;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=ZD(this.apiClient,e);return a=he("{model}:predictLongRunning",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>{const m=YD(f),g=new ih;return Object.assign(g,m),g})}else{const u=XD(this.apiClient,e);return a=he("{model}:predictLongRunning",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>{const m=QD(f),g=new ih;return Object.assign(g,m),g})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class wM extends po{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const n=e.operation,r=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=n.name.split("/operations/")[0];let s;r&&"httpOptions"in r&&(s=r.httpOptions);const o=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:i,config:{httpOptions:s}});return n._fromAPIResponse({apiResponse:o,isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:i,isVertexAI:!1})}}async get(e){const n=e.operation,r=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=n.name.split("/operations/")[0];let s;r&&"httpOptions"in r&&(s=r.httpOptions);const o=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:i,config:{httpOptions:s}});return n._fromAPIResponse({apiResponse:o,isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:i,isVertexAI:!1})}}async getVideosOperationInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=Wk(e);return a=he("{operationName}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o}else{const u=Hk(e);return a=he("{operationName}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o}}async fetchPredictVideosOperationInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=Uk(e);return s=he("{resourceName}:fetchPredictOperation",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function SM(t){const e={},n=c(t,["data"]);if(n!=null&&h(e,["data"],n),c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function CM(t){const e={},n=c(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>bM(s))),h(e,["parts"],i)}const r=c(t,["role"]);return r!=null&&h(e,["role"],r),e}function AM(t,e,n){const r={},i=c(e,["expireTime"]);n!==void 0&&i!=null&&h(n,["expireTime"],i);const s=c(e,["newSessionExpireTime"]);n!==void 0&&s!=null&&h(n,["newSessionExpireTime"],s);const o=c(e,["uses"]);n!==void 0&&o!=null&&h(n,["uses"],o);const a=c(e,["liveConnectConstraints"]);n!==void 0&&a!=null&&h(n,["bidiGenerateContentSetup"],DM(t,a));const l=c(e,["lockAdditionalFields"]);return n!==void 0&&l!=null&&h(n,["fieldMask"],l),r}function xM(t,e){const n={},r=c(e,["config"]);return r!=null&&h(n,["config"],AM(t,r,n)),n}function RM(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["fileUri"]);n!=null&&h(e,["fileUri"],n);const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function PM(t){const e={};if(c(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=c(t,["enableWidget"]);return n!=null&&h(e,["enableWidget"],n),e}function kM(t){const e={};if(c(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");const n=c(t,["timeRangeFilter"]);return n!=null&&h(e,["timeRangeFilter"],n),e}function NM(t,e){const n={},r=c(t,["generationConfig"]);e!==void 0&&r!=null&&h(e,["setup","generationConfig"],r);const i=c(t,["responseModalities"]);e!==void 0&&i!=null&&h(e,["setup","generationConfig","responseModalities"],i);const s=c(t,["temperature"]);e!==void 0&&s!=null&&h(e,["setup","generationConfig","temperature"],s);const o=c(t,["topP"]);e!==void 0&&o!=null&&h(e,["setup","generationConfig","topP"],o);const a=c(t,["topK"]);e!==void 0&&a!=null&&h(e,["setup","generationConfig","topK"],a);const l=c(t,["maxOutputTokens"]);e!==void 0&&l!=null&&h(e,["setup","generationConfig","maxOutputTokens"],l);const u=c(t,["mediaResolution"]);e!==void 0&&u!=null&&h(e,["setup","generationConfig","mediaResolution"],u);const f=c(t,["seed"]);e!==void 0&&f!=null&&h(e,["setup","generationConfig","seed"],f);const m=c(t,["speechConfig"]);e!==void 0&&m!=null&&h(e,["setup","generationConfig","speechConfig"],c_(m));const g=c(t,["thinkingConfig"]);e!==void 0&&g!=null&&h(e,["setup","generationConfig","thinkingConfig"],g);const v=c(t,["enableAffectiveDialog"]);e!==void 0&&v!=null&&h(e,["setup","generationConfig","enableAffectiveDialog"],v);const T=c(t,["systemInstruction"]);e!==void 0&&T!=null&&h(e,["setup","systemInstruction"],CM(Zt(T)));const P=c(t,["tools"]);if(e!==void 0&&P!=null){let B=Ga(P);Array.isArray(B)&&(B=B.map(E=>VM(Ba(E)))),h(e,["setup","tools"],B)}const D=c(t,["sessionResumption"]);e!==void 0&&D!=null&&h(e,["setup","sessionResumption"],MM(D));const S=c(t,["inputAudioTranscription"]);e!==void 0&&S!=null&&h(e,["setup","inputAudioTranscription"],S);const I=c(t,["outputAudioTranscription"]);e!==void 0&&I!=null&&h(e,["setup","outputAudioTranscription"],I);const R=c(t,["realtimeInputConfig"]);e!==void 0&&R!=null&&h(e,["setup","realtimeInputConfig"],R);const V=c(t,["contextWindowCompression"]);e!==void 0&&V!=null&&h(e,["setup","contextWindowCompression"],V);const U=c(t,["proactivity"]);return e!==void 0&&U!=null&&h(e,["setup","proactivity"],U),n}function DM(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["setup","model"],qe(t,r));const i=c(e,["config"]);return i!=null&&h(n,["config"],NM(i,n)),n}function bM(t){const e={},n=c(t,["functionCall"]);n!=null&&h(e,["functionCall"],n);const r=c(t,["codeExecutionResult"]);r!=null&&h(e,["codeExecutionResult"],r);const i=c(t,["executableCode"]);i!=null&&h(e,["executableCode"],i);const s=c(t,["fileData"]);s!=null&&h(e,["fileData"],RM(s));const o=c(t,["functionResponse"]);o!=null&&h(e,["functionResponse"],o);const a=c(t,["inlineData"]);a!=null&&h(e,["inlineData"],SM(a));const l=c(t,["text"]);l!=null&&h(e,["text"],l);const u=c(t,["thought"]);u!=null&&h(e,["thought"],u);const f=c(t,["thoughtSignature"]);f!=null&&h(e,["thoughtSignature"],f);const m=c(t,["videoMetadata"]);return m!=null&&h(e,["videoMetadata"],m),e}function MM(t){const e={},n=c(t,["handle"]);if(n!=null&&h(e,["handle"],n),c(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function VM(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(f=>f)),h(e,["functionDeclarations"],u)}if(c(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=c(t,["googleSearchRetrieval"]);r!=null&&h(e,["googleSearchRetrieval"],r);const i=c(t,["googleMaps"]);i!=null&&h(e,["googleMaps"],PM(i));const s=c(t,["computerUse"]);s!=null&&h(e,["computerUse"],s);const o=c(t,["codeExecution"]);if(o!=null&&h(e,["codeExecution"],o),c(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=c(t,["googleSearch"]);a!=null&&h(e,["googleSearch"],kM(a));const l=c(t,["urlContext"]);return l!=null&&h(e,["urlContext"],l),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function LM(t){const e=[];for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const r=t[n];if(typeof r=="object"&&r!=null&&Object.keys(r).length>0){const i=Object.keys(r).map(s=>`${n}.${s}`);e.push(...i)}else e.push(n)}return e.join(",")}function FM(t,e){let n=null;const r=t.bidiGenerateContentSetup;if(typeof r=="object"&&r!==null&&"setup"in r){const s=r.setup;typeof s=="object"&&s!==null?(t.bidiGenerateContentSetup=s,n=s):delete t.bidiGenerateContentSetup}else r!==void 0&&delete t.bidiGenerateContentSetup;const i=t.fieldMask;if(n){const s=LM(n);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)s?t.fieldMask=s:delete t.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&i!==null&&Array.isArray(i)&&i.length>0){const o=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let a=[];i.length>0&&(a=i.map(u=>o.includes(u)?`generationConfig.${u}`:u));const l=[];s&&l.push(s),a.length>0&&l.push(...a),l.length>0?t.fieldMask=l.join(","):delete t.fieldMask}else delete t.fieldMask}else i!==null&&Array.isArray(i)&&i.length>0?t.fieldMask=i.join(","):delete t.fieldMask;return t}class UM extends po{constructor(e){super(),this.apiClient=e}async create(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const a=xM(this.apiClient,e);s=he("auth_tokens",a._url),o=a._query,delete a.config,delete a._url,delete a._query;const l=FM(a,e.config);return i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>u)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function OM(t,e){const n={},r=c(t,["name"]);return r!=null&&h(n,["_url","name"],r),n}function BM(t,e){const n={},r=c(t,["name"]);return r!=null&&h(n,["_url","name"],r),n}function GM(t,e,n){const r={};if(c(t,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const i=c(t,["tunedModelDisplayName"]);if(e!==void 0&&i!=null&&h(e,["displayName"],i),c(t,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const s=c(t,["epochCount"]);e!==void 0&&s!=null&&h(e,["tuningTask","hyperparameters","epochCount"],s);const o=c(t,["learningRateMultiplier"]);if(o!=null&&h(r,["tuningTask","hyperparameters","learningRateMultiplier"],o),c(t,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(c(t,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(c(t,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const a=c(t,["batchSize"]);e!==void 0&&a!=null&&h(e,["tuningTask","hyperparameters","batchSize"],a);const l=c(t,["learningRate"]);if(e!==void 0&&l!=null&&h(e,["tuningTask","hyperparameters","learningRate"],l),c(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(c(t,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return r}function qM(t,e,n){const r={};let i=c(n,["config","method"]);if(i===void 0&&(i="SUPERVISED_FINE_TUNING"),i==="SUPERVISED_FINE_TUNING"){const v=c(t,["validationDataset"]);e!==void 0&&v!=null&&h(e,["supervisedTuningSpec"],jT(v))}else if(i==="PREFERENCE_TUNING"){const v=c(t,["validationDataset"]);e!==void 0&&v!=null&&h(e,["preferenceOptimizationSpec"],jT(v))}const s=c(t,["tunedModelDisplayName"]);e!==void 0&&s!=null&&h(e,["tunedModelDisplayName"],s);const o=c(t,["description"]);e!==void 0&&o!=null&&h(e,["description"],o);let a=c(n,["config","method"]);if(a===void 0&&(a="SUPERVISED_FINE_TUNING"),a==="SUPERVISED_FINE_TUNING"){const v=c(t,["epochCount"]);e!==void 0&&v!=null&&h(e,["supervisedTuningSpec","hyperParameters","epochCount"],v)}else if(a==="PREFERENCE_TUNING"){const v=c(t,["epochCount"]);e!==void 0&&v!=null&&h(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],v)}let l=c(n,["config","method"]);if(l===void 0&&(l="SUPERVISED_FINE_TUNING"),l==="SUPERVISED_FINE_TUNING"){const v=c(t,["learningRateMultiplier"]);e!==void 0&&v!=null&&h(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],v)}else if(l==="PREFERENCE_TUNING"){const v=c(t,["learningRateMultiplier"]);e!==void 0&&v!=null&&h(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],v)}let u=c(n,["config","method"]);if(u===void 0&&(u="SUPERVISED_FINE_TUNING"),u==="SUPERVISED_FINE_TUNING"){const v=c(t,["exportLastCheckpointOnly"]);e!==void 0&&v!=null&&h(e,["supervisedTuningSpec","exportLastCheckpointOnly"],v)}else if(u==="PREFERENCE_TUNING"){const v=c(t,["exportLastCheckpointOnly"]);e!==void 0&&v!=null&&h(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],v)}let f=c(n,["config","method"]);if(f===void 0&&(f="SUPERVISED_FINE_TUNING"),f==="SUPERVISED_FINE_TUNING"){const v=c(t,["adapterSize"]);e!==void 0&&v!=null&&h(e,["supervisedTuningSpec","hyperParameters","adapterSize"],v)}else if(f==="PREFERENCE_TUNING"){const v=c(t,["adapterSize"]);e!==void 0&&v!=null&&h(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],v)}if(c(t,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(c(t,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const m=c(t,["labels"]);e!==void 0&&m!=null&&h(e,["labels"],m);const g=c(t,["beta"]);return e!==void 0&&g!=null&&h(e,["preferenceOptimizationSpec","hyperParameters","beta"],g),r}function zM(t,e){const n={},r=c(t,["baseModel"]);r!=null&&h(n,["baseModel"],r);const i=c(t,["preTunedModel"]);i!=null&&h(n,["preTunedModel"],i);const s=c(t,["trainingDataset"]);s!=null&&e2(s);const o=c(t,["config"]);return o!=null&&GM(o,n),n}function $M(t,e){const n={},r=c(t,["baseModel"]);r!=null&&h(n,["baseModel"],r);const i=c(t,["preTunedModel"]);i!=null&&h(n,["preTunedModel"],i);const s=c(t,["trainingDataset"]);s!=null&&t2(s,n,e);const o=c(t,["config"]);return o!=null&&qM(o,n,e),n}function HM(t,e){const n={},r=c(t,["name"]);return r!=null&&h(n,["_url","name"],r),n}function WM(t,e){const n={},r=c(t,["name"]);return r!=null&&h(n,["_url","name"],r),n}function jM(t,e,n){const r={},i=c(t,["pageSize"]);e!==void 0&&i!=null&&h(e,["_query","pageSize"],i);const s=c(t,["pageToken"]);e!==void 0&&s!=null&&h(e,["_query","pageToken"],s);const o=c(t,["filter"]);return e!==void 0&&o!=null&&h(e,["_query","filter"],o),r}function KM(t,e,n){const r={},i=c(t,["pageSize"]);e!==void 0&&i!=null&&h(e,["_query","pageSize"],i);const s=c(t,["pageToken"]);e!==void 0&&s!=null&&h(e,["_query","pageToken"],s);const o=c(t,["filter"]);return e!==void 0&&o!=null&&h(e,["_query","filter"],o),r}function JM(t,e){const n={},r=c(t,["config"]);return r!=null&&jM(r,n),n}function QM(t,e){const n={},r=c(t,["config"]);return r!=null&&KM(r,n),n}function YM(t,e){const n={},r=c(t,["sdkHttpResponse"]);r!=null&&h(n,["sdkHttpResponse"],r);const i=c(t,["nextPageToken"]);i!=null&&h(n,["nextPageToken"],i);const s=c(t,["tunedModels"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>FC(a))),h(n,["tuningJobs"],o)}return n}function XM(t,e){const n={},r=c(t,["sdkHttpResponse"]);r!=null&&h(n,["sdkHttpResponse"],r);const i=c(t,["nextPageToken"]);i!=null&&h(n,["nextPageToken"],i);const s=c(t,["tuningJobs"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>xm(a))),h(n,["tuningJobs"],o)}return n}function ZM(t,e){const n={},r=c(t,["name"]);r!=null&&h(n,["model"],r);const i=c(t,["name"]);return i!=null&&h(n,["endpoint"],i),n}function e2(t,e){const n={};if(c(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(c(t,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const r=c(t,["examples"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>s)),h(n,["examples","examples"],i)}return n}function t2(t,e,n){const r={};let i=c(n,["config","method"]);if(i===void 0&&(i="SUPERVISED_FINE_TUNING"),i==="SUPERVISED_FINE_TUNING"){const o=c(t,["gcsUri"]);e!==void 0&&o!=null&&h(e,["supervisedTuningSpec","trainingDatasetUri"],o)}else if(i==="PREFERENCE_TUNING"){const o=c(t,["gcsUri"]);e!==void 0&&o!=null&&h(e,["preferenceOptimizationSpec","trainingDatasetUri"],o)}let s=c(n,["config","method"]);if(s===void 0&&(s="SUPERVISED_FINE_TUNING"),s==="SUPERVISED_FINE_TUNING"){const o=c(t,["vertexDatasetResource"]);e!==void 0&&o!=null&&h(e,["supervisedTuningSpec","trainingDatasetUri"],o)}else if(s==="PREFERENCE_TUNING"){const o=c(t,["vertexDatasetResource"]);e!==void 0&&o!=null&&h(e,["preferenceOptimizationSpec","trainingDatasetUri"],o)}if(c(t,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return r}function FC(t,e){const n={},r=c(t,["sdkHttpResponse"]);r!=null&&h(n,["sdkHttpResponse"],r);const i=c(t,["name"]);i!=null&&h(n,["name"],i);const s=c(t,["state"]);s!=null&&h(n,["state"],yC(s));const o=c(t,["createTime"]);o!=null&&h(n,["createTime"],o);const a=c(t,["tuningTask","startTime"]);a!=null&&h(n,["startTime"],a);const l=c(t,["tuningTask","completeTime"]);l!=null&&h(n,["endTime"],l);const u=c(t,["updateTime"]);u!=null&&h(n,["updateTime"],u);const f=c(t,["description"]);f!=null&&h(n,["description"],f);const m=c(t,["baseModel"]);m!=null&&h(n,["baseModel"],m);const g=c(t,["_self"]);return g!=null&&h(n,["tunedModel"],ZM(g)),n}function xm(t,e){const n={},r=c(t,["sdkHttpResponse"]);r!=null&&h(n,["sdkHttpResponse"],r);const i=c(t,["name"]);i!=null&&h(n,["name"],i);const s=c(t,["state"]);s!=null&&h(n,["state"],yC(s));const o=c(t,["createTime"]);o!=null&&h(n,["createTime"],o);const a=c(t,["startTime"]);a!=null&&h(n,["startTime"],a);const l=c(t,["endTime"]);l!=null&&h(n,["endTime"],l);const u=c(t,["updateTime"]);u!=null&&h(n,["updateTime"],u);const f=c(t,["error"]);f!=null&&h(n,["error"],f);const m=c(t,["description"]);m!=null&&h(n,["description"],m);const g=c(t,["baseModel"]);g!=null&&h(n,["baseModel"],g);const v=c(t,["tunedModel"]);v!=null&&h(n,["tunedModel"],v);const T=c(t,["preTunedModel"]);T!=null&&h(n,["preTunedModel"],T);const P=c(t,["supervisedTuningSpec"]);P!=null&&h(n,["supervisedTuningSpec"],P);const D=c(t,["preferenceOptimizationSpec"]);D!=null&&h(n,["preferenceOptimizationSpec"],D);const S=c(t,["tuningDataStats"]);S!=null&&h(n,["tuningDataStats"],S);const I=c(t,["encryptionSpec"]);I!=null&&h(n,["encryptionSpec"],I);const R=c(t,["partnerModelTuningSpec"]);R!=null&&h(n,["partnerModelTuningSpec"],R);const V=c(t,["customBaseModel"]);V!=null&&h(n,["customBaseModel"],V);const U=c(t,["experiment"]);U!=null&&h(n,["experiment"],U);const B=c(t,["labels"]);B!=null&&h(n,["labels"],B);const E=c(t,["outputUri"]);E!=null&&h(n,["outputUri"],E);const w=c(t,["pipelineJob"]);w!=null&&h(n,["pipelineJob"],w);const C=c(t,["serviceAccount"]);C!=null&&h(n,["serviceAccount"],C);const k=c(t,["tunedModelDisplayName"]);k!=null&&h(n,["tunedModelDisplayName"],k);const M=c(t,["veoTuningSpec"]);return M!=null&&h(n,["veoTuningSpec"],M),n}function n2(t,e){const n={},r=c(t,["sdkHttpResponse"]);r!=null&&h(n,["sdkHttpResponse"],r);const i=c(t,["name"]);i!=null&&h(n,["name"],i);const s=c(t,["metadata"]);s!=null&&h(n,["metadata"],s);const o=c(t,["done"]);o!=null&&h(n,["done"],o);const a=c(t,["error"]);return a!=null&&h(n,["error"],a),n}function jT(t,e){const n={},r=c(t,["gcsUri"]);r!=null&&h(n,["validationDatasetUri"],r);const i=c(t,["vertexDatasetResource"]);return i!=null&&h(n,["validationDatasetUri"],i),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class r2 extends po{constructor(e){super(),this.apiClient=e,this.get=async n=>await this.getInternal(n),this.list=async(n={})=>new Gu(no.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(n),n),this.tune=async n=>{var r;if(this.apiClient.isVertexAI())if(n.baseModel.startsWith("projects/")){const i={tunedModelName:n.baseModel};!((r=n.config)===null||r===void 0)&&r.preTunedModelCheckpointId&&(i.checkpointId=n.config.preTunedModelCheckpointId);const s=Object.assign(Object.assign({},n),{preTunedModel:i});return s.baseModel=void 0,await this.tuneInternal(s)}else{const i=Object.assign({},n);return await this.tuneInternal(i)}else{const i=Object.assign({},n),s=await this.tuneMldevInternal(i);let o="";return s.metadata!==void 0&&s.metadata.tunedModel!==void 0?o=s.metadata.tunedModel:s.name!==void 0&&s.name.includes("/operations/")&&(o=s.name.split("/operations/")[0]),{name:o,state:Tm.JOB_STATE_QUEUED}}}}async getInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=WM(e);return a=he("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>xm(f))}else{const u=HM(e);return a=he("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>FC(f))}}async listInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=QM(e);return a=he("tuningJobs",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=XM(f),g=new xT;return Object.assign(g,m),g})}else{const u=JM(e);return a=he("tunedModels",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=YM(f),g=new xT;return Object.assign(g,m),g})}}async cancel(e){var n,r,i,s;let o="",a={};if(this.apiClient.isVertexAI()){const l=BM(e);o=he("{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}else{const l=OM(e);o=he("{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal})}}async tuneInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=$M(e,e);return s=he("tuningJobs",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>xm(l))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=zM(e);return s=he("tunedModels",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>n2(l))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class i2{async download(e,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const s2=1024*1024*8,o2=3,a2=1e3,l2=2,dp="x-goog-upload-status";async function u2(t,e,n){var r,i,s;let o=0,a=0,l=new Em(new Response),u="upload";for(o=t.size;a<o;){const m=Math.min(s2,o-a),g=t.slice(a,a+m);a+m>=o&&(u+=", finalize");let v=0,T=a2;for(;v<o2&&(l=await n.request({path:"",body:g,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":u,"X-Goog-Upload-Offset":String(a),"Content-Length":String(m)}}}),!(!((r=l==null?void 0:l.headers)===null||r===void 0)&&r[dp]));)v++,await d2(T),T=T*l2;if(a+=m,((i=l==null?void 0:l.headers)===null||i===void 0?void 0:i[dp])!=="active")break;if(o<=a)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const f=await(l==null?void 0:l.json());if(((s=l==null?void 0:l.headers)===null||s===void 0?void 0:s[dp])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return f.file}async function c2(t){return{size:t.size,type:t.type}}function d2(t){return new Promise(e=>setTimeout(e,t))}class h2{async upload(e,n,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await u2(e,n,r)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await c2(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class f2{create(e,n,r){return new p2(e,n,r)}}class p2{constructor(e,n,r){this.url=e,this.headers=n,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const KT="x-goog-api-key";class m2{constructor(e){this.apiKey=e}async addAuthHeaders(e,n){if(e.get(KT)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(KT,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const g2="gl-node/";class _2{constructor(e){var n;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=e.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=e.apiKey;const r=Lk(e.httpOptions,e.vertexai,void 0,void 0);r&&(e.httpOptions?e.httpOptions.baseUrl=r:e.httpOptions={baseUrl:r}),this.apiVersion=e.apiVersion;const i=new m2(this.apiKey);this.apiClient=new nM({auth:i,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:g2+"web",uploader:new h2,downloader:new i2}),this.models=new IM(this.apiClient),this.live=new mM(this.apiClient,i,new f2),this.batches=new t1(this.apiClient),this.chats=new b1(this.models,this.apiClient),this.caches=new k1(this.apiClient),this.files=new z1(this.apiClient),this.operations=new wM(this.apiClient),this.authTokens=new UM(this.apiClient),this.tunings=new r2(this.apiClient)}}const y2=()=>{};var JT={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UC=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},v2=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],o=t[n++],a=t[n++],l=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},OC={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],o=i+1<t.length,a=o?t[i+1]:0,l=i+2<t.length,u=l?t[i+2]:0,f=s>>2,m=(s&3)<<4|a>>4;let g=(a&15)<<2|u>>6,v=u&63;l||(v=64,o||(g=64)),r.push(n[f],n[m],n[g],n[v])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(UC(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):v2(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0;++i;const u=i<t.length?n[t.charAt(i)]:64;++i;const m=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||a==null||u==null||m==null)throw new T2;const g=s<<2|a>>4;if(r.push(g),u!==64){const v=a<<4&240|u>>2;if(r.push(v),m!==64){const T=u<<6&192|m;r.push(T)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class T2 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const E2=function(t){const e=UC(t);return OC.encodeByteArray(e,!0)},oh=function(t){return E2(t).replace(/\./g,"")},BC=function(t){try{return OC.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GC(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I2=()=>GC().__FIREBASE_DEFAULTS__,w2=()=>{if(typeof process>"u"||typeof JT>"u")return;const t=JT.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},S2=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&BC(t[1]);return e&&JSON.parse(e)},Xh=()=>{try{return y2()||I2()||w2()||S2()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},qC=t=>{var e,n;return(n=(e=Xh())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},C2=t=>{const e=qC(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},zC=()=>{var t;return(t=Xh())==null?void 0:t.config},$C=t=>{var e;return(e=Xh())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A2{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function za(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function HC(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x2(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...t};return[oh(JSON.stringify(n)),oh(JSON.stringify(o)),""].join(".")}const jl={};function R2(){const t={prod:[],emulator:[]};for(const e of Object.keys(jl))jl[e]?t.emulator.push(e):t.prod.push(e);return t}function P2(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let QT=!1;function WC(t,e){if(typeof window>"u"||typeof document>"u"||!za(window.location.host)||jl[t]===e||jl[t]||QT)return;jl[t]=e;function n(g){return`__firebase__banner__${g}`}const r="__firebase__banner",s=R2().prod.length>0;function o(){const g=document.getElementById(r);g&&g.remove()}function a(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function l(g,v){g.setAttribute("width","24"),g.setAttribute("id",v),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function u(){const g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{QT=!0,o()},g}function f(g,v){g.setAttribute("id",v),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function m(){const g=P2(r),v=n("text"),T=document.getElementById(v)||document.createElement("span"),P=n("learnmore"),D=document.getElementById(P)||document.createElement("a"),S=n("preprendIcon"),I=document.getElementById(S)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){const R=g.element;a(R),f(D,P);const V=u();l(I,S),R.append(I,T,D,V),document.body.appendChild(R)}s?(T.innerText="Preview backend disconnected.",I.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(I.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,T.innerText="Preview backend running in this workspace."),T.setAttribute("id",v)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",m):m()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function k2(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Dt())}function jC(){var e;const t=(e=Xh())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function N2(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function D2(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function b2(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function M2(){const t=Dt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function KC(){return!jC()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function JC(){return!jC()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function QC(){try{return typeof indexedDB=="object"}catch{return!1}}function V2(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)==null?void 0:s.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L2="FirebaseError";class ri extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=L2,Object.setPrototypeOf(this,ri.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,qu.prototype.create)}}class qu{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?F2(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new ri(i,a,r)}}function F2(t,e){return t.replace(U2,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const U2=/\{\$([^}]+)}/g;function O2(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function ro(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],o=e[i];if(YT(s)&&YT(o)){if(!ro(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function YT(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zu(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function B2(t,e){const n=new G2(t,e);return n.subscribe.bind(n)}class G2{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");q2(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=hp),i.error===void 0&&(i.error=hp),i.complete===void 0&&(i.complete=hp);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function q2(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function hp(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bt(t){return t&&t._delegate?t._delegate:t}class io{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ds="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z2{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new A2;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(H2(e))try{this.getOrInitializeService({instanceIdentifier:Ds})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Ds){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ds){return this.instances.has(e)}getOptions(e=Ds){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:$2(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Ds){return this.component?this.component.multipleInstances?e:Ds:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function $2(t){return t===Ds?void 0:t}function H2(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W2{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new z2(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ve;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ve||(Ve={}));const j2={debug:Ve.DEBUG,verbose:Ve.VERBOSE,info:Ve.INFO,warn:Ve.WARN,error:Ve.ERROR,silent:Ve.SILENT},K2=Ve.INFO,J2={[Ve.DEBUG]:"log",[Ve.VERBOSE]:"log",[Ve.INFO]:"info",[Ve.WARN]:"warn",[Ve.ERROR]:"error"},Q2=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=J2[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class h_{constructor(e){this.name=e,this._logLevel=K2,this._logHandler=Q2,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ve))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?j2[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ve.DEBUG,...e),this._logHandler(this,Ve.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ve.VERBOSE,...e),this._logHandler(this,Ve.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ve.INFO,...e),this._logHandler(this,Ve.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ve.WARN,...e),this._logHandler(this,Ve.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ve.ERROR,...e),this._logHandler(this,Ve.ERROR,...e)}}const Y2=(t,e)=>e.some(n=>t instanceof n);let XT,ZT;function X2(){return XT||(XT=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Z2(){return ZT||(ZT=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const YC=new WeakMap,Rm=new WeakMap,XC=new WeakMap,fp=new WeakMap,f_=new WeakMap;function eV(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(Gi(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&YC.set(n,t)}).catch(()=>{}),f_.set(e,t),e}function tV(t){if(Rm.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});Rm.set(t,e)}let Pm={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Rm.get(t);if(e==="objectStoreNames")return t.objectStoreNames||XC.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Gi(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function nV(t){Pm=t(Pm)}function rV(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(pp(this),e,...n);return XC.set(r,e.sort?e.sort():[e]),Gi(r)}:Z2().includes(t)?function(...e){return t.apply(pp(this),e),Gi(YC.get(this))}:function(...e){return Gi(t.apply(pp(this),e))}}function iV(t){return typeof t=="function"?rV(t):(t instanceof IDBTransaction&&tV(t),Y2(t,X2())?new Proxy(t,Pm):t)}function Gi(t){if(t instanceof IDBRequest)return eV(t);if(fp.has(t))return fp.get(t);const e=iV(t);return e!==t&&(fp.set(t,e),f_.set(e,t)),e}const pp=t=>f_.get(t);function sV(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),a=Gi(o);return r&&o.addEventListener("upgradeneeded",l=>{r(Gi(o.result),l.oldVersion,l.newVersion,Gi(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}const oV=["get","getKey","getAll","getAllKeys","count"],aV=["put","add","delete","clear"],mp=new Map;function eE(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(mp.get(e))return mp.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=aV.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||oV.includes(n)))return;const s=async function(o,...a){const l=this.transaction(o,i?"readwrite":"readonly");let u=l.store;return r&&(u=u.index(a.shift())),(await Promise.all([u[n](...a),i&&l.done]))[0]};return mp.set(e,s),s}nV(t=>({...t,get:(e,n,r)=>eE(e,n)||t.get(e,n,r),has:(e,n)=>!!eE(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lV{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(uV(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function uV(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const km="@firebase/app",tE="0.14.5";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yr=new h_("@firebase/app"),cV="@firebase/app-compat",dV="@firebase/analytics-compat",hV="@firebase/analytics",fV="@firebase/app-check-compat",pV="@firebase/app-check",mV="@firebase/auth",gV="@firebase/auth-compat",_V="@firebase/database",yV="@firebase/data-connect",vV="@firebase/database-compat",TV="@firebase/functions",EV="@firebase/functions-compat",IV="@firebase/installations",wV="@firebase/installations-compat",SV="@firebase/messaging",CV="@firebase/messaging-compat",AV="@firebase/performance",xV="@firebase/performance-compat",RV="@firebase/remote-config",PV="@firebase/remote-config-compat",kV="@firebase/storage",NV="@firebase/storage-compat",DV="@firebase/firestore",bV="@firebase/ai",MV="@firebase/firestore-compat",VV="firebase",LV="12.5.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nm="[DEFAULT]",FV={[km]:"fire-core",[cV]:"fire-core-compat",[hV]:"fire-analytics",[dV]:"fire-analytics-compat",[pV]:"fire-app-check",[fV]:"fire-app-check-compat",[mV]:"fire-auth",[gV]:"fire-auth-compat",[_V]:"fire-rtdb",[yV]:"fire-data-connect",[vV]:"fire-rtdb-compat",[TV]:"fire-fn",[EV]:"fire-fn-compat",[IV]:"fire-iid",[wV]:"fire-iid-compat",[SV]:"fire-fcm",[CV]:"fire-fcm-compat",[AV]:"fire-perf",[xV]:"fire-perf-compat",[RV]:"fire-rc",[PV]:"fire-rc-compat",[kV]:"fire-gcs",[NV]:"fire-gcs-compat",[DV]:"fire-fst",[MV]:"fire-fst-compat",[bV]:"fire-vertex","fire-js":"fire-js",[VV]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ah=new Map,UV=new Map,Dm=new Map;function nE(t,e){try{t.container.addComponent(e)}catch(n){Yr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Ea(t){const e=t.name;if(Dm.has(e))return Yr.debug(`There were multiple attempts to register component ${e}.`),!1;Dm.set(e,t);for(const n of ah.values())nE(n,t);for(const n of UV.values())nE(n,t);return!0}function p_(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function tr(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OV={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},qi=new qu("app","Firebase",OV);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BV{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new io("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw qi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $a=LV;function ZC(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:Nm,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw qi.create("bad-app-name",{appName:String(i)});if(n||(n=zC()),!n)throw qi.create("no-options");const s=ah.get(i);if(s){if(ro(n,s.options)&&ro(r,s.config))return s;throw qi.create("duplicate-app",{appName:i})}const o=new W2(i);for(const l of Dm.values())o.addComponent(l);const a=new BV(n,r,o);return ah.set(i,a),a}function e0(t=Nm){const e=ah.get(t);if(!e&&t===Nm&&zC())return ZC();if(!e)throw qi.create("no-app",{appName:t});return e}function zi(t,e,n){let r=FV[t]??t;n&&(r+=`-${n}`);const i=r.match(/\s|\//),s=e.match(/\s|\//);if(i||s){const o=[`Unable to register library "${r}" with version "${e}":`];i&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Yr.warn(o.join(" "));return}Ea(new io(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GV="firebase-heartbeat-database",qV=1,Iu="firebase-heartbeat-store";let gp=null;function t0(){return gp||(gp=sV(GV,qV,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Iu)}catch(n){console.warn(n)}}}}).catch(t=>{throw qi.create("idb-open",{originalErrorMessage:t.message})})),gp}async function zV(t){try{const n=(await t0()).transaction(Iu),r=await n.objectStore(Iu).get(n0(t));return await n.done,r}catch(e){if(e instanceof ri)Yr.warn(e.message);else{const n=qi.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Yr.warn(n.message)}}}async function rE(t,e){try{const r=(await t0()).transaction(Iu,"readwrite");await r.objectStore(Iu).put(e,n0(t)),await r.done}catch(n){if(n instanceof ri)Yr.warn(n.message);else{const r=qi.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Yr.warn(r.message)}}}function n0(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $V=1024,HV=30;class WV{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new KV(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=iE();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>HV){const o=JV(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Yr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=iE(),{heartbeatsToSend:r,unsentEntries:i}=jV(this._heartbeatsCache.heartbeats),s=oh(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return Yr.warn(n),""}}}function iE(){return new Date().toISOString().substring(0,10)}function jV(t,e=$V){const n=[];let r=t.slice();for(const i of t){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),sE(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),sE(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class KV{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return QC()?V2().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await zV(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return rE(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return rE(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function sE(t){return oh(JSON.stringify({version:2,heartbeats:t})).length}function JV(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QV(t){Ea(new io("platform-logger",e=>new lV(e),"PRIVATE")),Ea(new io("heartbeat",e=>new WV(e),"PRIVATE")),zi(km,tE,t),zi(km,tE,"esm2020"),zi("fire-js","")}QV("");var YV="firebase",XV="12.5.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */zi(YV,XV,"app");function r0(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const ZV=r0,i0=new qu("auth","Firebase",r0());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lh=new h_("@firebase/auth");function eL(t,...e){lh.logLevel<=Ve.WARN&&lh.warn(`Auth (${$a}): ${t}`,...e)}function yd(t,...e){lh.logLevel<=Ve.ERROR&&lh.error(`Auth (${$a}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ar(t,...e){throw g_(t,...e)}function sr(t,...e){return g_(t,...e)}function m_(t,e,n){const r={...ZV(),[e]:n};return new qu("auth","Firebase",r).create(e,{appName:t.name})}function Ws(t){return m_(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function tL(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&Ar(t,"argument-error"),m_(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function g_(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return i0.create(t,...e)}function we(t,e,...n){if(!t)throw g_(e,...n)}function qr(t){const e="INTERNAL ASSERTION FAILED: "+t;throw yd(e),new Error(e)}function Xr(t,e){t||qr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bm(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function nL(){return oE()==="http:"||oE()==="https:"}function oE(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rL(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(nL()||D2()||"connection"in navigator)?navigator.onLine:!0}function iL(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $u{constructor(e,n){this.shortDelay=e,this.longDelay=n,Xr(n>e,"Short delay should be less than long delay!"),this.isMobile=k2()||b2()}get(){return rL()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __(t,e){Xr(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s0{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;qr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;qr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;qr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sL={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oL=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],aL=new $u(3e4,6e4);function y_(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function Ha(t,e,n,r,i={}){return o0(t,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const a=zu({key:t.config.apiKey,...o}).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const u={method:e,headers:l,...s};return N2()||(u.referrerPolicy="no-referrer"),t.emulatorConfig&&za(t.emulatorConfig.host)&&(u.credentials="include"),s0.fetch()(await a0(t,t.config.apiHost,n,a),u)})}async function o0(t,e,n){t._canInitEmulator=!1;const r={...sL,...e};try{const i=new uL(t),s=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw Jc(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[l,u]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Jc(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw Jc(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw Jc(t,"user-disabled",o);const f=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw m_(t,f,u);Ar(t,f)}}catch(i){if(i instanceof ri)throw i;Ar(t,"network-request-failed",{message:String(i)})}}async function lL(t,e,n,r,i={}){const s=await Ha(t,e,n,r,i);return"mfaPendingCredential"in s&&Ar(t,"multi-factor-auth-required",{_serverResponse:s}),s}async function a0(t,e,n,r){const i=`${e}${n}?${r}`,s=t,o=s.config.emulator?__(t.config,i):`${t.config.apiScheme}://${i}`;return oL.includes(n)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}class uL{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(sr(this.auth,"network-request-failed")),aL.get())})}}function Jc(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=sr(t,e,r);return i.customData._tokenResponse=n,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cL(t,e){return Ha(t,"POST","/v1/accounts:delete",e)}async function uh(t,e){return Ha(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kl(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function dL(t,e=!1){const n=bt(t),r=await n.getIdToken(e),i=v_(r);we(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:Kl(_p(i.auth_time)),issuedAtTime:Kl(_p(i.iat)),expirationTime:Kl(_p(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function _p(t){return Number(t)*1e3}function v_(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return yd("JWT malformed, contained fewer than 3 sections"),null;try{const i=BC(n);return i?JSON.parse(i):(yd("Failed to decode base64 JWT payload"),null)}catch(i){return yd("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function aE(t){const e=v_(t);return we(e,"internal-error"),we(typeof e.exp<"u","internal-error"),we(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wu(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof ri&&hL(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function hL({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fL{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mm{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Kl(this.lastLoginAt),this.creationTime=Kl(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ch(t){var m;const e=t.auth,n=await t.getIdToken(),r=await wu(t,uh(e,{idToken:n}));we(r==null?void 0:r.users.length,e,"internal-error");const i=r.users[0];t._notifyReloadListener(i);const s=(m=i.providerUserInfo)!=null&&m.length?l0(i.providerUserInfo):[],o=mL(t.providerData,s),a=t.isAnonymous,l=!(t.email&&i.passwordHash)&&!(o!=null&&o.length),u=a?l:!1,f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new Mm(i.createdAt,i.lastLoginAt),isAnonymous:u};Object.assign(t,f)}async function pL(t){const e=bt(t);await ch(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function mL(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function l0(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gL(t,e){const n=await o0(t,{},async()=>{const r=zu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,o=await a0(t,i,"/v1/token",`key=${s}`),a=await t._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:a,body:r};return t.emulatorConfig&&za(t.emulatorConfig.host)&&(l.credentials="include"),s0.fetch()(o,l)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function _L(t,e){return Ha(t,"POST","/v2/accounts:revokeToken",y_(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ca{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){we(e.idToken,"internal-error"),we(typeof e.idToken<"u","internal-error"),we(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):aE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){we(e.length!==0,"internal-error");const n=aE(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(we(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:s}=await gL(e,n);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:s}=n,o=new ca;return r&&(we(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(we(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(we(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ca,this.toJSON())}_performRefresh(){return qr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gi(t,e){we(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class nr{constructor({uid:e,auth:n,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new fL(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Mm(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await wu(this,this.stsTokenManager.getToken(this.auth,e));return we(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return dL(this,e)}reload(){return pL(this)}_assign(e){this!==e&&(we(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new nr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){we(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await ch(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(tr(this.auth.app))return Promise.reject(Ws(this.auth));const e=await this.getIdToken();return await wu(this,cL(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,i=n.email??void 0,s=n.phoneNumber??void 0,o=n.photoURL??void 0,a=n.tenantId??void 0,l=n._redirectEventId??void 0,u=n.createdAt??void 0,f=n.lastLoginAt??void 0,{uid:m,emailVerified:g,isAnonymous:v,providerData:T,stsTokenManager:P}=n;we(m&&P,e,"internal-error");const D=ca.fromJSON(this.name,P);we(typeof m=="string",e,"internal-error"),gi(r,e.name),gi(i,e.name),we(typeof g=="boolean",e,"internal-error"),we(typeof v=="boolean",e,"internal-error"),gi(s,e.name),gi(o,e.name),gi(a,e.name),gi(l,e.name),gi(u,e.name),gi(f,e.name);const S=new nr({uid:m,auth:e,email:i,emailVerified:g,displayName:r,isAnonymous:v,photoURL:o,phoneNumber:s,tenantId:a,stsTokenManager:D,createdAt:u,lastLoginAt:f});return T&&Array.isArray(T)&&(S.providerData=T.map(I=>({...I}))),l&&(S._redirectEventId=l),S}static async _fromIdTokenResponse(e,n,r=!1){const i=new ca;i.updateFromServerResponse(n);const s=new nr({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await ch(s),s}static async _fromGetAccountInfoResponse(e,n,r){const i=n.users[0];we(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?l0(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),a=new ca;a.updateFromIdToken(r);const l=new nr({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Mm(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(l,u),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lE=new Map;function zr(t){Xr(t instanceof Function,"Expected a class definition");let e=lE.get(t);return e?(Xr(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,lE.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u0{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}u0.type="NONE";const uE=u0;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vd(t,e,n){return`firebase:${t}:${e}:${n}`}class da{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=vd(this.userKey,i.apiKey,s),this.fullPersistenceKey=vd("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await uh(this.auth,{idToken:e}).catch(()=>{});return n?nr._fromGetAccountInfoResponse(this.auth,n,e):null}return nr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new da(zr(uE),e,r);const i=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let s=i[0]||zr(uE);const o=vd(r,e.config.apiKey,e.name);let a=null;for(const u of n)try{const f=await u._get(o);if(f){let m;if(typeof f=="string"){const g=await uh(e,{idToken:f}).catch(()=>{});if(!g)break;m=await nr._fromGetAccountInfoResponse(e,g,f)}else m=nr._fromJSON(e,f);u!==s&&(a=m),s=u;break}}catch{}const l=i.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new da(s,e,r):(s=l[0],a&&await s._set(o,a.toJSON()),await Promise.all(n.map(async u=>{if(u!==s)try{await u._remove(o)}catch{}})),new da(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cE(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(f0(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(c0(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(m0(e))return"Blackberry";if(g0(e))return"Webos";if(d0(e))return"Safari";if((e.includes("chrome/")||h0(e))&&!e.includes("edge/"))return"Chrome";if(p0(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function c0(t=Dt()){return/firefox\//i.test(t)}function d0(t=Dt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function h0(t=Dt()){return/crios\//i.test(t)}function f0(t=Dt()){return/iemobile/i.test(t)}function p0(t=Dt()){return/android/i.test(t)}function m0(t=Dt()){return/blackberry/i.test(t)}function g0(t=Dt()){return/webos/i.test(t)}function T_(t=Dt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function yL(t=Dt()){var e;return T_(t)&&!!((e=window.navigator)!=null&&e.standalone)}function vL(){return M2()&&document.documentMode===10}function _0(t=Dt()){return T_(t)||p0(t)||g0(t)||m0(t)||/windows phone/i.test(t)||f0(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y0(t,e=[]){let n;switch(t){case"Browser":n=cE(Dt());break;case"Worker":n=`${cE(Dt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${$a}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TL{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=s=>new Promise((o,a)=>{try{const l=e(s);o(l)}catch(l){a(l)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function EL(t,e={}){return Ha(t,"GET","/v2/passwordPolicy",y_(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IL=6;class wL{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??IL,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SL{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new dE(this),this.idTokenSubscription=new dE(this),this.beforeStateQueue=new TL(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=i0,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=zr(n)),this._initializationPromise=this.queue(async()=>{var r,i,s;if(!this._deleted&&(this.persistenceManager=await da.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((i=this._popupRedirectResolver)!=null&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)==null?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await uh(this,{idToken:e}),r=await nr._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var s;if(tr(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(s=this.redirectUser)==null?void 0:s._redirectEventId,a=r==null?void 0:r._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(r=l.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return we(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await ch(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=iL()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(tr(this.app))return Promise.reject(Ws(this));const n=e?bt(e):null;return n&&we(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&we(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return tr(this.app)?Promise.reject(Ws(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return tr(this.app)?Promise.reject(Ws(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(zr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await EL(this),n=new wL(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new qu("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await _L(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&zr(e)||this._popupRedirectResolver;we(n,this,"argument-error"),this.redirectPersistenceManager=await da.create(this,[zr(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(we(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,r,i);return()=>{o=!0,l()}}else{const l=e.addObserver(n);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return we(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=y0(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var i;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((i=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:i.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if(tr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&eL(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Zh(t){return bt(t)}class dE{constructor(e){this.auth=e,this.observer=null,this.addObserver=B2(n=>this.observer=n)}get next(){return we(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let E_={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function CL(t){E_=t}function AL(t){return E_.loadJS(t)}function xL(){return E_.gapiScript}function RL(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PL(t,e){const n=p_(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),s=n.getOptions();if(ro(s,e??{}))return i;Ar(i,"already-initialized")}return n.initialize({options:e})}function kL(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(zr);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function NL(t,e,n){const r=Zh(t);we(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,s=v0(e),{host:o,port:a}=DL(e),l=a===null?"":`:${a}`,u={url:`${s}//${o}${l}/`},f=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){we(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),we(ro(u,r.config.emulator)&&ro(f,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=u,r.emulatorConfig=f,r.settings.appVerificationDisabledForTesting=!0,za(o)?(HC(`${s}//${o}${l}`),WC("Auth",!0)):bL()}function v0(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function DL(t){const e=v0(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:hE(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:hE(o)}}}function hE(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function bL(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T0{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return qr("not implemented")}_getIdTokenResponse(e){return qr("not implemented")}_linkToIdToken(e,n){return qr("not implemented")}_getReauthenticationResolver(e){return qr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ha(t,e){return lL(t,"POST","/v1/accounts:signInWithIdp",y_(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ML="http://localhost";class so extends T0{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new so(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Ar("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...s}=n;if(!r||!i)return null;const o=new so(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return ha(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,ha(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,ha(e,n)}buildRequest(){const e={requestUri:ML,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=zu(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I_{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hu extends I_{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ai extends Hu{constructor(){super("facebook.com")}static credential(e){return so._fromParams({providerId:Ai.PROVIDER_ID,signInMethod:Ai.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ai.credentialFromTaggedObject(e)}static credentialFromError(e){return Ai.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ai.credential(e.oauthAccessToken)}catch{return null}}}Ai.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ai.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Or extends Hu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return so._fromParams({providerId:Or.PROVIDER_ID,signInMethod:Or.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Or.credentialFromTaggedObject(e)}static credentialFromError(e){return Or.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Or.credential(n,r)}catch{return null}}}Or.GOOGLE_SIGN_IN_METHOD="google.com";Or.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xi extends Hu{constructor(){super("github.com")}static credential(e){return so._fromParams({providerId:xi.PROVIDER_ID,signInMethod:xi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return xi.credentialFromTaggedObject(e)}static credentialFromError(e){return xi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return xi.credential(e.oauthAccessToken)}catch{return null}}}xi.GITHUB_SIGN_IN_METHOD="github.com";xi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ri extends Hu{constructor(){super("twitter.com")}static credential(e,n){return so._fromParams({providerId:Ri.PROVIDER_ID,signInMethod:Ri.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Ri.credentialFromTaggedObject(e)}static credentialFromError(e){return Ri.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Ri.credential(n,r)}catch{return null}}}Ri.TWITTER_SIGN_IN_METHOD="twitter.com";Ri.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ia{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const s=await nr._fromIdTokenResponse(e,r,i),o=fE(r);return new Ia({user:s,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=fE(r);return new Ia({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function fE(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dh extends ri{constructor(e,n,r,i){super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,dh.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new dh(e,n,r,i)}}function E0(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?dh._fromErrorAndOperation(t,s,e,r):s})}async function VL(t,e,n=!1){const r=await wu(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Ia._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LL(t,e,n=!1){const{auth:r}=t;if(tr(r.app))return Promise.reject(Ws(r));const i="reauthenticate";try{const s=await wu(t,E0(r,i,e,t),n);we(s.idToken,r,"internal-error");const o=v_(s.idToken);we(o,r,"internal-error");const{sub:a}=o;return we(t.uid===a,r,"user-mismatch"),Ia._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&Ar(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function FL(t,e,n=!1){if(tr(t.app))return Promise.reject(Ws(t));const r="signIn",i=await E0(t,r,e),s=await Ia._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(s.user),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UL(t,e){return bt(t).setPersistence(e)}function OL(t,e,n,r){return bt(t).onIdTokenChanged(e,n,r)}function BL(t,e,n){return bt(t).beforeAuthStateChanged(e,n)}function GL(t,e,n,r){return bt(t).onAuthStateChanged(e,n,r)}function pE(t){return bt(t).signOut()}const hh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I0{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(hh,"1"),this.storage.removeItem(hh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qL=1e3,zL=10;class w0 extends I0{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=_0(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;n?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);vL()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,zL):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},qL)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}w0.type="LOCAL";const S0=w0;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C0 extends I0{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}C0.type="SESSION";const A0=C0;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $L(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ef{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new ef(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:s}=n.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const a=Array.from(o).map(async u=>u(n.origin,s)),l=await $L(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}ef.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w_(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HL{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,l)=>{const u=w_("",20);i.port1.start();const f=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(m){const g=m;if(g.data.eventId===u)switch(g.data.status){case"ack":clearTimeout(f),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(g.data.response);break;default:clearTimeout(f),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sr(){return window}function WL(t){Sr().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x0(){return typeof Sr().WorkerGlobalScope<"u"&&typeof Sr().importScripts=="function"}async function jL(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function KL(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function JL(){return x0()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R0="firebaseLocalStorageDb",QL=1,fh="firebaseLocalStorage",P0="fbase_key";class Wu{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function tf(t,e){return t.transaction([fh],e?"readwrite":"readonly").objectStore(fh)}function YL(){const t=indexedDB.deleteDatabase(R0);return new Wu(t).toPromise()}function Vm(){const t=indexedDB.open(R0,QL);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(fh,{keyPath:P0})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(fh)?e(r):(r.close(),await YL(),e(await Vm()))})})}async function mE(t,e,n){const r=tf(t,!0).put({[P0]:e,value:n});return new Wu(r).toPromise()}async function XL(t,e){const n=tf(t,!1).get(e),r=await new Wu(n).toPromise();return r===void 0?null:r.value}function gE(t,e){const n=tf(t,!0).delete(e);return new Wu(n).toPromise()}const ZL=800,eF=3;class k0{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Vm(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>eF)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return x0()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ef._getInstance(JL()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await jL(),!this.activeServiceWorker)return;this.sender=new HL(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||KL()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Vm();return await mE(e,hh,"1"),await gE(e,hh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>mE(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>XL(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>gE(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=tf(i,!1).getAll();return new Wu(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),ZL)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}k0.type="LOCAL";const tF=k0;new $u(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N0(t,e){return e?zr(e):(we(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S_ extends T0{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ha(e,this._buildIdpRequest())}_linkToIdToken(e,n){return ha(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return ha(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function nF(t){return FL(t.auth,new S_(t),t.bypassAuthState)}function rF(t){const{auth:e,user:n}=t;return we(n,e,"internal-error"),LL(n,new S_(t),t.bypassAuthState)}async function iF(t){const{auth:e,user:n}=t;return we(n,e,"internal-error"),VL(n,new S_(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D0{constructor(e,n,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return nF;case"linkViaPopup":case"linkViaRedirect":return iF;case"reauthViaPopup":case"reauthViaRedirect":return rF;default:Ar(this.auth,"internal-error")}}resolve(e){Xr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Xr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sF=new $u(2e3,1e4);async function oF(t,e,n){if(tr(t.app))return Promise.reject(sr(t,"operation-not-supported-in-this-environment"));const r=Zh(t);tL(t,e,I_);const i=N0(r,n);return new qs(r,"signInViaPopup",e,i).executeNotNull()}class qs extends D0{constructor(e,n,r,i,s){super(e,n,i,s),this.provider=r,this.authWindow=null,this.pollId=null,qs.currentPopupAction&&qs.currentPopupAction.cancel(),qs.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return we(e,this.auth,"internal-error"),e}async onExecution(){Xr(this.filter.length===1,"Popup operations only handle one event");const e=w_();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(sr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(sr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,qs.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(sr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,sF.get())};e()}}qs.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aF="pendingRedirect",Td=new Map;class lF extends D0{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Td.get(this.auth._key());if(!e){try{const r=await uF(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Td.set(this.auth._key(),e)}return this.bypassAuthState||Td.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function uF(t,e){const n=hF(e),r=dF(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}function cF(t,e){Td.set(t._key(),e)}function dF(t){return zr(t._redirectPersistence)}function hF(t){return vd(aF,t.config.apiKey,t.name)}async function fF(t,e,n=!1){if(tr(t.app))return Promise.reject(Ws(t));const r=Zh(t),i=N0(r,e),o=await new lF(r,i,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pF=10*60*1e3;class mF{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!gF(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!b0(e)){const i=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(sr(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=pF&&this.cachedEventUids.clear(),this.cachedEventUids.has(_E(e))}saveEventToCache(e){this.cachedEventUids.add(_E(e)),this.lastProcessedEventTime=Date.now()}}function _E(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function b0({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function gF(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return b0(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _F(t,e={}){return Ha(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yF=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,vF=/^https?/;async function TF(t){if(t.config.emulator)return;const{authorizedDomains:e}=await _F(t);for(const n of e)try{if(EF(n))return}catch{}Ar(t,"unauthorized-domain")}function EF(t){const e=bm(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!vF.test(n))return!1;if(yF.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IF=new $u(3e4,6e4);function yE(){const t=Sr().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function wF(t){return new Promise((e,n)=>{var i,s,o;function r(){yE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{yE(),n(sr(t,"network-request-failed"))},timeout:IF.get()})}if((s=(i=Sr().gapi)==null?void 0:i.iframes)!=null&&s.Iframe)e(gapi.iframes.getContext());else if((o=Sr().gapi)!=null&&o.load)r();else{const a=RL("iframefcb");return Sr()[a]=()=>{gapi.load?r():n(sr(t,"network-request-failed"))},AL(`${xL()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw Ed=null,e})}let Ed=null;function SF(t){return Ed=Ed||wF(t),Ed}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CF=new $u(5e3,15e3),AF="__/auth/iframe",xF="emulator/auth/iframe",RF={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},PF=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function kF(t){const e=t.config;we(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?__(e,xF):`https://${t.config.authDomain}/${AF}`,r={apiKey:e.apiKey,appName:t.name,v:$a},i=PF.get(t.config.apiHost);i&&(r.eid=i);const s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${zu(r).slice(1)}`}async function NF(t){const e=await SF(t),n=Sr().gapi;return we(n,t,"internal-error"),e.open({where:document.body,url:kF(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:RF,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=sr(t,"network-request-failed"),a=Sr().setTimeout(()=>{s(o)},CF.get());function l(){Sr().clearTimeout(a),i(r)}r.ping(l).then(l,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DF={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},bF=500,MF=600,VF="_blank",LF="http://localhost";class vE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function FF(t,e,n,r=bF,i=MF){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l={...DF,width:r.toString(),height:i.toString(),top:s,left:o},u=Dt().toLowerCase();n&&(a=h0(u)?VF:n),c0(u)&&(e=e||LF,l.scrollbars="yes");const f=Object.entries(l).reduce((g,[v,T])=>`${g}${v}=${T},`,"");if(yL(u)&&a!=="_self")return UF(e||"",a),new vE(null);const m=window.open(e||"",a,f);we(m,t,"popup-blocked");try{m.focus()}catch{}return new vE(m)}function UF(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OF="__/auth/handler",BF="emulator/auth/handler",GF=encodeURIComponent("fac");async function TE(t,e,n,r,i,s){we(t.config.authDomain,t,"auth-domain-config-required"),we(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:$a,eventId:i};if(e instanceof I_){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",O2(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,m]of Object.entries({}))o[f]=m}if(e instanceof Hu){const f=e.getScopes().filter(m=>m!=="");f.length>0&&(o.scopes=f.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const f of Object.keys(a))a[f]===void 0&&delete a[f];const l=await t._getAppCheckToken(),u=l?`#${GF}=${encodeURIComponent(l)}`:"";return`${qF(t)}?${zu(a).slice(1)}${u}`}function qF({config:t}){return t.emulator?__(t,BF):`https://${t.authDomain}/${OF}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yp="webStorageSupport";class zF{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=A0,this._completeRedirectFn=fF,this._overrideRedirectResult=cF}async _openPopup(e,n,r,i){var o;Xr((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const s=await TE(e,n,r,bm(),i);return FF(e,s,w_())}async _openRedirect(e,n,r,i){await this._originValidation(e);const s=await TE(e,n,r,bm(),i);return WL(s),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:s}=this.eventManagers[n];return i?Promise.resolve(i):(Xr(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await NF(e),r=new mF(e);return n.register("authEvent",i=>(we(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(yp,{type:yp},i=>{var o;const s=(o=i==null?void 0:i[0])==null?void 0:o[yp];s!==void 0&&n(!!s),Ar(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=TF(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return _0()||d0()||T_()}}const $F=zF;var EE="@firebase/auth",IE="1.11.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HF{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){we(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WF(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function jF(t){Ea(new io("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;we(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:y0(t)},u=new SL(r,i,s,l);return kL(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Ea(new io("auth-internal",e=>{const n=Zh(e.getProvider("auth").getImmediate());return(r=>new HF(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),zi(EE,IE,WF(t)),zi(EE,IE,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KF=5*60,JF=$C("authIdTokenMaxAge")||KF;let wE=null;const QF=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>JF)return;const i=n==null?void 0:n.token;wE!==i&&(wE=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function YF(t=e0()){const e=p_(t,"auth");if(e.isInitialized())return e.getImmediate();const n=PL(t,{popupRedirectResolver:$F,persistence:[tF,S0,A0]}),r=$C("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const o=QF(s.toString());BL(n,o,()=>o(n.currentUser)),OL(n,a=>o(a))}}const i=qC("auth");return i&&NL(n,`http://${i}`),n}function XF(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}CL({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const s=sr("internal-error");s.customData=i,n(s)},r.type="text/javascript",r.charset="UTF-8",XF().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});jF("Browser");var SE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var $i,M0;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(E,w){function C(){}C.prototype=w.prototype,E.F=w.prototype,E.prototype=new C,E.prototype.constructor=E,E.D=function(k,M,L){for(var N=Array(arguments.length-2),Ne=2;Ne<arguments.length;Ne++)N[Ne-2]=arguments[Ne];return w.prototype[M].apply(k,N)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(E,w,C){C||(C=0);const k=Array(16);if(typeof w=="string")for(var M=0;M<16;++M)k[M]=w.charCodeAt(C++)|w.charCodeAt(C++)<<8|w.charCodeAt(C++)<<16|w.charCodeAt(C++)<<24;else for(M=0;M<16;++M)k[M]=w[C++]|w[C++]<<8|w[C++]<<16|w[C++]<<24;w=E.g[0],C=E.g[1],M=E.g[2];let L=E.g[3],N;N=w+(L^C&(M^L))+k[0]+3614090360&4294967295,w=C+(N<<7&4294967295|N>>>25),N=L+(M^w&(C^M))+k[1]+3905402710&4294967295,L=w+(N<<12&4294967295|N>>>20),N=M+(C^L&(w^C))+k[2]+606105819&4294967295,M=L+(N<<17&4294967295|N>>>15),N=C+(w^M&(L^w))+k[3]+3250441966&4294967295,C=M+(N<<22&4294967295|N>>>10),N=w+(L^C&(M^L))+k[4]+4118548399&4294967295,w=C+(N<<7&4294967295|N>>>25),N=L+(M^w&(C^M))+k[5]+1200080426&4294967295,L=w+(N<<12&4294967295|N>>>20),N=M+(C^L&(w^C))+k[6]+2821735955&4294967295,M=L+(N<<17&4294967295|N>>>15),N=C+(w^M&(L^w))+k[7]+4249261313&4294967295,C=M+(N<<22&4294967295|N>>>10),N=w+(L^C&(M^L))+k[8]+1770035416&4294967295,w=C+(N<<7&4294967295|N>>>25),N=L+(M^w&(C^M))+k[9]+2336552879&4294967295,L=w+(N<<12&4294967295|N>>>20),N=M+(C^L&(w^C))+k[10]+4294925233&4294967295,M=L+(N<<17&4294967295|N>>>15),N=C+(w^M&(L^w))+k[11]+2304563134&4294967295,C=M+(N<<22&4294967295|N>>>10),N=w+(L^C&(M^L))+k[12]+1804603682&4294967295,w=C+(N<<7&4294967295|N>>>25),N=L+(M^w&(C^M))+k[13]+4254626195&4294967295,L=w+(N<<12&4294967295|N>>>20),N=M+(C^L&(w^C))+k[14]+2792965006&4294967295,M=L+(N<<17&4294967295|N>>>15),N=C+(w^M&(L^w))+k[15]+1236535329&4294967295,C=M+(N<<22&4294967295|N>>>10),N=w+(M^L&(C^M))+k[1]+4129170786&4294967295,w=C+(N<<5&4294967295|N>>>27),N=L+(C^M&(w^C))+k[6]+3225465664&4294967295,L=w+(N<<9&4294967295|N>>>23),N=M+(w^C&(L^w))+k[11]+643717713&4294967295,M=L+(N<<14&4294967295|N>>>18),N=C+(L^w&(M^L))+k[0]+3921069994&4294967295,C=M+(N<<20&4294967295|N>>>12),N=w+(M^L&(C^M))+k[5]+3593408605&4294967295,w=C+(N<<5&4294967295|N>>>27),N=L+(C^M&(w^C))+k[10]+38016083&4294967295,L=w+(N<<9&4294967295|N>>>23),N=M+(w^C&(L^w))+k[15]+3634488961&4294967295,M=L+(N<<14&4294967295|N>>>18),N=C+(L^w&(M^L))+k[4]+3889429448&4294967295,C=M+(N<<20&4294967295|N>>>12),N=w+(M^L&(C^M))+k[9]+568446438&4294967295,w=C+(N<<5&4294967295|N>>>27),N=L+(C^M&(w^C))+k[14]+3275163606&4294967295,L=w+(N<<9&4294967295|N>>>23),N=M+(w^C&(L^w))+k[3]+4107603335&4294967295,M=L+(N<<14&4294967295|N>>>18),N=C+(L^w&(M^L))+k[8]+1163531501&4294967295,C=M+(N<<20&4294967295|N>>>12),N=w+(M^L&(C^M))+k[13]+2850285829&4294967295,w=C+(N<<5&4294967295|N>>>27),N=L+(C^M&(w^C))+k[2]+4243563512&4294967295,L=w+(N<<9&4294967295|N>>>23),N=M+(w^C&(L^w))+k[7]+1735328473&4294967295,M=L+(N<<14&4294967295|N>>>18),N=C+(L^w&(M^L))+k[12]+2368359562&4294967295,C=M+(N<<20&4294967295|N>>>12),N=w+(C^M^L)+k[5]+4294588738&4294967295,w=C+(N<<4&4294967295|N>>>28),N=L+(w^C^M)+k[8]+2272392833&4294967295,L=w+(N<<11&4294967295|N>>>21),N=M+(L^w^C)+k[11]+1839030562&4294967295,M=L+(N<<16&4294967295|N>>>16),N=C+(M^L^w)+k[14]+4259657740&4294967295,C=M+(N<<23&4294967295|N>>>9),N=w+(C^M^L)+k[1]+2763975236&4294967295,w=C+(N<<4&4294967295|N>>>28),N=L+(w^C^M)+k[4]+1272893353&4294967295,L=w+(N<<11&4294967295|N>>>21),N=M+(L^w^C)+k[7]+4139469664&4294967295,M=L+(N<<16&4294967295|N>>>16),N=C+(M^L^w)+k[10]+3200236656&4294967295,C=M+(N<<23&4294967295|N>>>9),N=w+(C^M^L)+k[13]+681279174&4294967295,w=C+(N<<4&4294967295|N>>>28),N=L+(w^C^M)+k[0]+3936430074&4294967295,L=w+(N<<11&4294967295|N>>>21),N=M+(L^w^C)+k[3]+3572445317&4294967295,M=L+(N<<16&4294967295|N>>>16),N=C+(M^L^w)+k[6]+76029189&4294967295,C=M+(N<<23&4294967295|N>>>9),N=w+(C^M^L)+k[9]+3654602809&4294967295,w=C+(N<<4&4294967295|N>>>28),N=L+(w^C^M)+k[12]+3873151461&4294967295,L=w+(N<<11&4294967295|N>>>21),N=M+(L^w^C)+k[15]+530742520&4294967295,M=L+(N<<16&4294967295|N>>>16),N=C+(M^L^w)+k[2]+3299628645&4294967295,C=M+(N<<23&4294967295|N>>>9),N=w+(M^(C|~L))+k[0]+4096336452&4294967295,w=C+(N<<6&4294967295|N>>>26),N=L+(C^(w|~M))+k[7]+1126891415&4294967295,L=w+(N<<10&4294967295|N>>>22),N=M+(w^(L|~C))+k[14]+2878612391&4294967295,M=L+(N<<15&4294967295|N>>>17),N=C+(L^(M|~w))+k[5]+4237533241&4294967295,C=M+(N<<21&4294967295|N>>>11),N=w+(M^(C|~L))+k[12]+1700485571&4294967295,w=C+(N<<6&4294967295|N>>>26),N=L+(C^(w|~M))+k[3]+2399980690&4294967295,L=w+(N<<10&4294967295|N>>>22),N=M+(w^(L|~C))+k[10]+4293915773&4294967295,M=L+(N<<15&4294967295|N>>>17),N=C+(L^(M|~w))+k[1]+2240044497&4294967295,C=M+(N<<21&4294967295|N>>>11),N=w+(M^(C|~L))+k[8]+1873313359&4294967295,w=C+(N<<6&4294967295|N>>>26),N=L+(C^(w|~M))+k[15]+4264355552&4294967295,L=w+(N<<10&4294967295|N>>>22),N=M+(w^(L|~C))+k[6]+2734768916&4294967295,M=L+(N<<15&4294967295|N>>>17),N=C+(L^(M|~w))+k[13]+1309151649&4294967295,C=M+(N<<21&4294967295|N>>>11),N=w+(M^(C|~L))+k[4]+4149444226&4294967295,w=C+(N<<6&4294967295|N>>>26),N=L+(C^(w|~M))+k[11]+3174756917&4294967295,L=w+(N<<10&4294967295|N>>>22),N=M+(w^(L|~C))+k[2]+718787259&4294967295,M=L+(N<<15&4294967295|N>>>17),N=C+(L^(M|~w))+k[9]+3951481745&4294967295,E.g[0]=E.g[0]+w&4294967295,E.g[1]=E.g[1]+(M+(N<<21&4294967295|N>>>11))&4294967295,E.g[2]=E.g[2]+M&4294967295,E.g[3]=E.g[3]+L&4294967295}r.prototype.v=function(E,w){w===void 0&&(w=E.length);const C=w-this.blockSize,k=this.C;let M=this.h,L=0;for(;L<w;){if(M==0)for(;L<=C;)i(this,E,L),L+=this.blockSize;if(typeof E=="string"){for(;L<w;)if(k[M++]=E.charCodeAt(L++),M==this.blockSize){i(this,k),M=0;break}}else for(;L<w;)if(k[M++]=E[L++],M==this.blockSize){i(this,k),M=0;break}}this.h=M,this.o+=w},r.prototype.A=function(){var E=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);E[0]=128;for(var w=1;w<E.length-8;++w)E[w]=0;w=this.o*8;for(var C=E.length-8;C<E.length;++C)E[C]=w&255,w/=256;for(this.v(E),E=Array(16),w=0,C=0;C<4;++C)for(let k=0;k<32;k+=8)E[w++]=this.g[C]>>>k&255;return E};function s(E,w){var C=a;return Object.prototype.hasOwnProperty.call(C,E)?C[E]:C[E]=w(E)}function o(E,w){this.h=w;const C=[];let k=!0;for(let M=E.length-1;M>=0;M--){const L=E[M]|0;k&&L==w||(C[M]=L,k=!1)}this.g=C}var a={};function l(E){return-128<=E&&E<128?s(E,function(w){return new o([w|0],w<0?-1:0)}):new o([E|0],E<0?-1:0)}function u(E){if(isNaN(E)||!isFinite(E))return m;if(E<0)return D(u(-E));const w=[];let C=1;for(let k=0;E>=C;k++)w[k]=E/C|0,C*=4294967296;return new o(w,0)}function f(E,w){if(E.length==0)throw Error("number format error: empty string");if(w=w||10,w<2||36<w)throw Error("radix out of range: "+w);if(E.charAt(0)=="-")return D(f(E.substring(1),w));if(E.indexOf("-")>=0)throw Error('number format error: interior "-" character');const C=u(Math.pow(w,8));let k=m;for(let L=0;L<E.length;L+=8){var M=Math.min(8,E.length-L);const N=parseInt(E.substring(L,L+M),w);M<8?(M=u(Math.pow(w,M)),k=k.j(M).add(u(N))):(k=k.j(C),k=k.add(u(N)))}return k}var m=l(0),g=l(1),v=l(16777216);t=o.prototype,t.m=function(){if(P(this))return-D(this).m();let E=0,w=1;for(let C=0;C<this.g.length;C++){const k=this.i(C);E+=(k>=0?k:4294967296+k)*w,w*=4294967296}return E},t.toString=function(E){if(E=E||10,E<2||36<E)throw Error("radix out of range: "+E);if(T(this))return"0";if(P(this))return"-"+D(this).toString(E);const w=u(Math.pow(E,6));var C=this;let k="";for(;;){const M=V(C,w).g;C=S(C,M.j(w));let L=((C.g.length>0?C.g[0]:C.h)>>>0).toString(E);if(C=M,T(C))return L+k;for(;L.length<6;)L="0"+L;k=L+k}},t.i=function(E){return E<0?0:E<this.g.length?this.g[E]:this.h};function T(E){if(E.h!=0)return!1;for(let w=0;w<E.g.length;w++)if(E.g[w]!=0)return!1;return!0}function P(E){return E.h==-1}t.l=function(E){return E=S(this,E),P(E)?-1:T(E)?0:1};function D(E){const w=E.g.length,C=[];for(let k=0;k<w;k++)C[k]=~E.g[k];return new o(C,~E.h).add(g)}t.abs=function(){return P(this)?D(this):this},t.add=function(E){const w=Math.max(this.g.length,E.g.length),C=[];let k=0;for(let M=0;M<=w;M++){let L=k+(this.i(M)&65535)+(E.i(M)&65535),N=(L>>>16)+(this.i(M)>>>16)+(E.i(M)>>>16);k=N>>>16,L&=65535,N&=65535,C[M]=N<<16|L}return new o(C,C[C.length-1]&-2147483648?-1:0)};function S(E,w){return E.add(D(w))}t.j=function(E){if(T(this)||T(E))return m;if(P(this))return P(E)?D(this).j(D(E)):D(D(this).j(E));if(P(E))return D(this.j(D(E)));if(this.l(v)<0&&E.l(v)<0)return u(this.m()*E.m());const w=this.g.length+E.g.length,C=[];for(var k=0;k<2*w;k++)C[k]=0;for(k=0;k<this.g.length;k++)for(let M=0;M<E.g.length;M++){const L=this.i(k)>>>16,N=this.i(k)&65535,Ne=E.i(M)>>>16,Fe=E.i(M)&65535;C[2*k+2*M]+=N*Fe,I(C,2*k+2*M),C[2*k+2*M+1]+=L*Fe,I(C,2*k+2*M+1),C[2*k+2*M+1]+=N*Ne,I(C,2*k+2*M+1),C[2*k+2*M+2]+=L*Ne,I(C,2*k+2*M+2)}for(E=0;E<w;E++)C[E]=C[2*E+1]<<16|C[2*E];for(E=w;E<2*w;E++)C[E]=0;return new o(C,0)};function I(E,w){for(;(E[w]&65535)!=E[w];)E[w+1]+=E[w]>>>16,E[w]&=65535,w++}function R(E,w){this.g=E,this.h=w}function V(E,w){if(T(w))throw Error("division by zero");if(T(E))return new R(m,m);if(P(E))return w=V(D(E),w),new R(D(w.g),D(w.h));if(P(w))return w=V(E,D(w)),new R(D(w.g),w.h);if(E.g.length>30){if(P(E)||P(w))throw Error("slowDivide_ only works with positive integers.");for(var C=g,k=w;k.l(E)<=0;)C=U(C),k=U(k);var M=B(C,1),L=B(k,1);for(k=B(k,2),C=B(C,2);!T(k);){var N=L.add(k);N.l(E)<=0&&(M=M.add(C),L=N),k=B(k,1),C=B(C,1)}return w=S(E,M.j(w)),new R(M,w)}for(M=m;E.l(w)>=0;){for(C=Math.max(1,Math.floor(E.m()/w.m())),k=Math.ceil(Math.log(C)/Math.LN2),k=k<=48?1:Math.pow(2,k-48),L=u(C),N=L.j(w);P(N)||N.l(E)>0;)C-=k,L=u(C),N=L.j(w);T(L)&&(L=g),M=M.add(L),E=S(E,N)}return new R(M,E)}t.B=function(E){return V(this,E).h},t.and=function(E){const w=Math.max(this.g.length,E.g.length),C=[];for(let k=0;k<w;k++)C[k]=this.i(k)&E.i(k);return new o(C,this.h&E.h)},t.or=function(E){const w=Math.max(this.g.length,E.g.length),C=[];for(let k=0;k<w;k++)C[k]=this.i(k)|E.i(k);return new o(C,this.h|E.h)},t.xor=function(E){const w=Math.max(this.g.length,E.g.length),C=[];for(let k=0;k<w;k++)C[k]=this.i(k)^E.i(k);return new o(C,this.h^E.h)};function U(E){const w=E.g.length+1,C=[];for(let k=0;k<w;k++)C[k]=E.i(k)<<1|E.i(k-1)>>>31;return new o(C,E.h)}function B(E,w){const C=w>>5;w%=32;const k=E.g.length-C,M=[];for(let L=0;L<k;L++)M[L]=w>0?E.i(L+C)>>>w|E.i(L+C+1)<<32-w:E.i(L+C);return new o(M,E.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,M0=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=f,$i=o}).apply(typeof SE<"u"?SE:typeof self<"u"?self:typeof window<"u"?window:{});var Qc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var V0,Nl,L0,Id,Lm,F0,U0,O0;(function(){var t,e=Object.defineProperty;function n(d){d=[typeof globalThis=="object"&&globalThis,d,typeof window=="object"&&window,typeof self=="object"&&self,typeof Qc=="object"&&Qc];for(var _=0;_<d.length;++_){var y=d[_];if(y&&y.Math==Math)return y}throw Error("Cannot find global object")}var r=n(this);function i(d,_){if(_)e:{var y=r;d=d.split(".");for(var x=0;x<d.length-1;x++){var q=d[x];if(!(q in y))break e;y=y[q]}d=d[d.length-1],x=y[d],_=_(x),_!=x&&_!=null&&e(y,d,{configurable:!0,writable:!0,value:_})}}i("Symbol.dispose",function(d){return d||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(d){return d||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(d){return d||function(_){var y=[],x;for(x in _)Object.prototype.hasOwnProperty.call(_,x)&&y.push([x,_[x]]);return y}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var s=s||{},o=this||self;function a(d){var _=typeof d;return _=="object"&&d!=null||_=="function"}function l(d,_,y){return d.call.apply(d.bind,arguments)}function u(d,_,y){return u=l,u.apply(null,arguments)}function f(d,_){var y=Array.prototype.slice.call(arguments,1);return function(){var x=y.slice();return x.push.apply(x,arguments),d.apply(this,x)}}function m(d,_){function y(){}y.prototype=_.prototype,d.Z=_.prototype,d.prototype=new y,d.prototype.constructor=d,d.Ob=function(x,q,$){for(var ie=Array(arguments.length-2),Pe=2;Pe<arguments.length;Pe++)ie[Pe-2]=arguments[Pe];return _.prototype[q].apply(x,ie)}}var g=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?d=>d&&AsyncContext.Snapshot.wrap(d):d=>d;function v(d){const _=d.length;if(_>0){const y=Array(_);for(let x=0;x<_;x++)y[x]=d[x];return y}return[]}function T(d,_){for(let x=1;x<arguments.length;x++){const q=arguments[x];var y=typeof q;if(y=y!="object"?y:q?Array.isArray(q)?"array":y:"null",y=="array"||y=="object"&&typeof q.length=="number"){y=d.length||0;const $=q.length||0;d.length=y+$;for(let ie=0;ie<$;ie++)d[y+ie]=q[ie]}else d.push(q)}}class P{constructor(_,y){this.i=_,this.j=y,this.h=0,this.g=null}get(){let _;return this.h>0?(this.h--,_=this.g,this.g=_.next,_.next=null):_=this.i(),_}}function D(d){o.setTimeout(()=>{throw d},0)}function S(){var d=E;let _=null;return d.g&&(_=d.g,d.g=d.g.next,d.g||(d.h=null),_.next=null),_}class I{constructor(){this.h=this.g=null}add(_,y){const x=R.get();x.set(_,y),this.h?this.h.next=x:this.g=x,this.h=x}}var R=new P(()=>new V,d=>d.reset());class V{constructor(){this.next=this.g=this.h=null}set(_,y){this.h=_,this.g=y,this.next=null}reset(){this.next=this.g=this.h=null}}let U,B=!1,E=new I,w=()=>{const d=Promise.resolve(void 0);U=()=>{d.then(C)}};function C(){for(var d;d=S();){try{d.h.call(d.g)}catch(y){D(y)}var _=R;_.j(d),_.h<100&&(_.h++,d.next=_.g,_.g=d)}B=!1}function k(){this.u=this.u,this.C=this.C}k.prototype.u=!1,k.prototype.dispose=function(){this.u||(this.u=!0,this.N())},k.prototype[Symbol.dispose]=function(){this.dispose()},k.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function M(d,_){this.type=d,this.g=this.target=_,this.defaultPrevented=!1}M.prototype.h=function(){this.defaultPrevented=!0};var L=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var d=!1,_=Object.defineProperty({},"passive",{get:function(){d=!0}});try{const y=()=>{};o.addEventListener("test",y,_),o.removeEventListener("test",y,_)}catch{}return d}();function N(d){return/^[\s\xa0]*$/.test(d)}function Ne(d,_){M.call(this,d?d.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,d&&this.init(d,_)}m(Ne,M),Ne.prototype.init=function(d,_){const y=this.type=d.type,x=d.changedTouches&&d.changedTouches.length?d.changedTouches[0]:null;this.target=d.target||d.srcElement,this.g=_,_=d.relatedTarget,_||(y=="mouseover"?_=d.fromElement:y=="mouseout"&&(_=d.toElement)),this.relatedTarget=_,x?(this.clientX=x.clientX!==void 0?x.clientX:x.pageX,this.clientY=x.clientY!==void 0?x.clientY:x.pageY,this.screenX=x.screenX||0,this.screenY=x.screenY||0):(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0),this.button=d.button,this.key=d.key||"",this.ctrlKey=d.ctrlKey,this.altKey=d.altKey,this.shiftKey=d.shiftKey,this.metaKey=d.metaKey,this.pointerId=d.pointerId||0,this.pointerType=d.pointerType,this.state=d.state,this.i=d,d.defaultPrevented&&Ne.Z.h.call(this)},Ne.prototype.h=function(){Ne.Z.h.call(this);const d=this.i;d.preventDefault?d.preventDefault():d.returnValue=!1};var Fe="closure_listenable_"+(Math.random()*1e6|0),je=0;function Ee(d,_,y,x,q){this.listener=d,this.proxy=null,this.src=_,this.type=y,this.capture=!!x,this.ha=q,this.key=++je,this.da=this.fa=!1}function te(d){d.da=!0,d.listener=null,d.proxy=null,d.src=null,d.ha=null}function ce(d,_,y){for(const x in d)_.call(y,d[x],x,d)}function ve(d,_){for(const y in d)_.call(void 0,d[y],y,d)}function Ie(d){const _={};for(const y in d)_[y]=d[y];return _}const Re="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function $e(d,_){let y,x;for(let q=1;q<arguments.length;q++){x=arguments[q];for(y in x)d[y]=x[y];for(let $=0;$<Re.length;$++)y=Re[$],Object.prototype.hasOwnProperty.call(x,y)&&(d[y]=x[y])}}function Ke(d){this.src=d,this.g={},this.h=0}Ke.prototype.add=function(d,_,y,x,q){const $=d.toString();d=this.g[$],d||(d=this.g[$]=[],this.h++);const ie=ut(d,_,x,q);return ie>-1?(_=d[ie],y||(_.fa=!1)):(_=new Ee(_,this.src,$,!!x,q),_.fa=y,d.push(_)),_};function Vt(d,_){const y=_.type;if(y in d.g){var x=d.g[y],q=Array.prototype.indexOf.call(x,_,void 0),$;($=q>=0)&&Array.prototype.splice.call(x,q,1),$&&(te(_),d.g[y].length==0&&(delete d.g[y],d.h--))}}function ut(d,_,y,x){for(let q=0;q<d.length;++q){const $=d[q];if(!$.da&&$.listener==_&&$.capture==!!y&&$.ha==x)return q}return-1}var _e="closure_lm_"+(Math.random()*1e6|0),nn={};function vn(d,_,y,x,q){if(Array.isArray(_)){for(let $=0;$<_.length;$++)vn(d,_[$],y,x,q);return null}return y=ct(y),d&&d[Fe]?d.J(_,y,a(x)?!!x.capture:!1,q):Vn(d,_,y,!1,x,q)}function Vn(d,_,y,x,q,$){if(!_)throw Error("Invalid event type");const ie=a(q)?!!q.capture:!!q;let Pe=It(d);if(Pe||(d[_e]=Pe=new Ke(d)),y=Pe.add(_,y,x,ie,$),y.proxy)return y;if(x=cr(),y.proxy=x,x.src=d,x.listener=y,d.addEventListener)L||(q=ie),q===void 0&&(q=!1),d.addEventListener(_.toString(),x,q);else if(d.attachEvent)d.attachEvent(Pr(_.toString()),x);else if(d.addListener&&d.removeListener)d.addListener(x);else throw Error("addEventListener and attachEvent are unavailable.");return y}function cr(){function d(y){return _.call(d.src,d.listener,y)}const _=be;return d}function dr(d,_,y,x,q){if(Array.isArray(_))for(var $=0;$<_.length;$++)dr(d,_[$],y,x,q);else x=a(x)?!!x.capture:!!x,y=ct(y),d&&d[Fe]?(d=d.i,$=String(_).toString(),$ in d.g&&(_=d.g[$],y=ut(_,y,x,q),y>-1&&(te(_[y]),Array.prototype.splice.call(_,y,1),_.length==0&&(delete d.g[$],d.h--)))):d&&(d=It(d))&&(_=d.g[_.toString()],d=-1,_&&(d=ut(_,y,x,q)),(y=d>-1?_[d]:null)&&hn(y))}function hn(d){if(typeof d!="number"&&d&&!d.da){var _=d.src;if(_&&_[Fe])Vt(_.i,d);else{var y=d.type,x=d.proxy;_.removeEventListener?_.removeEventListener(y,x,d.capture):_.detachEvent?_.detachEvent(Pr(y),x):_.addListener&&_.removeListener&&_.removeListener(x),(y=It(_))?(Vt(y,d),y.h==0&&(y.src=null,_[_e]=null)):te(d)}}}function Pr(d){return d in nn?nn[d]:nn[d]="on"+d}function be(d,_){if(d.da)d=!0;else{_=new Ne(_,this);const y=d.listener,x=d.ha||d.src;d.fa&&hn(d),d=y.call(x,_)}return d}function It(d){return d=d[_e],d instanceof Ke?d:null}var Ge="__closure_events_fn_"+(Math.random()*1e9>>>0);function ct(d){return typeof d=="function"?d:(d[Ge]||(d[Ge]=function(_){return d.handleEvent(_)}),d[Ge])}function ae(){k.call(this),this.i=new Ke(this),this.M=this,this.G=null}m(ae,k),ae.prototype[Fe]=!0,ae.prototype.removeEventListener=function(d,_,y,x){dr(this,d,_,y,x)};function Lt(d,_){var y,x=d.G;if(x)for(y=[];x;x=x.G)y.push(x);if(d=d.M,x=_.type||_,typeof _=="string")_=new M(_,d);else if(_ instanceof M)_.target=_.target||d;else{var q=_;_=new M(x,d),$e(_,q)}q=!0;let $,ie;if(y)for(ie=y.length-1;ie>=0;ie--)$=_.g=y[ie],q=oi($,x,!0,_)&&q;if($=_.g=d,q=oi($,x,!0,_)&&q,q=oi($,x,!1,_)&&q,y)for(ie=0;ie<y.length;ie++)$=_.g=y[ie],q=oi($,x,!1,_)&&q}ae.prototype.N=function(){if(ae.Z.N.call(this),this.i){var d=this.i;for(const _ in d.g){const y=d.g[_];for(let x=0;x<y.length;x++)te(y[x]);delete d.g[_],d.h--}}this.G=null},ae.prototype.J=function(d,_,y,x){return this.i.add(String(d),_,!1,y,x)},ae.prototype.K=function(d,_,y,x){return this.i.add(String(d),_,!0,y,x)};function oi(d,_,y,x){if(_=d.i.g[String(_)],!_)return!0;_=_.concat();let q=!0;for(let $=0;$<_.length;++$){const ie=_[$];if(ie&&!ie.da&&ie.capture==y){const Pe=ie.listener,Rt=ie.ha||ie.src;ie.fa&&Vt(d.i,ie),q=Pe.call(Rt,x)!==!1&&q}}return q&&!x.defaultPrevented}function cs(d,_){if(typeof d!="function")if(d&&typeof d.handleEvent=="function")d=u(d.handleEvent,d);else throw Error("Invalid listener argument");return Number(_)>2147483647?-1:o.setTimeout(d,_||0)}function ds(d){d.g=cs(()=>{d.g=null,d.i&&(d.i=!1,ds(d))},d.l);const _=d.h;d.h=null,d.m.apply(null,_)}class yo extends k{constructor(_,y){super(),this.m=_,this.l=y,this.h=null,this.i=!1,this.g=null}j(_){this.h=arguments,this.g?this.i=!0:ds(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function xe(d){k.call(this),this.h=d,this.g={}}m(xe,k);var lc=[];function kr(d){ce(d.g,function(_,y){this.g.hasOwnProperty(y)&&hn(_)},d),d.g={}}xe.prototype.N=function(){xe.Z.N.call(this),kr(this)},xe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var hs=o.JSON.stringify,Qa=o.JSON.parse,uc=class{stringify(d){return o.JSON.stringify(d,void 0)}parse(d){return o.JSON.parse(d,void 0)}};function Ya(){}function cc(){}var fs={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Xa(){M.call(this,"d")}m(Xa,M);function ps(){M.call(this,"c")}m(ps,M);var Tn={},ms=null;function vo(){return ms=ms||new ae}Tn.Ia="serverreachability";function Za(d){M.call(this,Tn.Ia,d)}m(Za,M);function Ln(d){const _=vo();Lt(_,new Za(_))}Tn.STAT_EVENT="statevent";function gs(d,_){M.call(this,Tn.STAT_EVENT,d),this.stat=_}m(gs,M);function vt(d){const _=vo();Lt(_,new gs(_,d))}Tn.Ja="timingevent";function dc(d,_){M.call(this,Tn.Ja,d),this.size=_}m(dc,M);function hr(d,_){if(typeof d!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){d()},_)}function _s(){this.g=!0}_s.prototype.ua=function(){this.g=!1};function Q(d,_,y,x,q,$){d.info(function(){if(d.g)if($){var ie="",Pe=$.split("&");for(let Xe=0;Xe<Pe.length;Xe++){var Rt=Pe[Xe].split("=");if(Rt.length>1){const Ft=Rt[0];Rt=Rt[1];const mr=Ft.split("_");ie=mr.length>=2&&mr[1]=="type"?ie+(Ft+"="+Rt+"&"):ie+(Ft+"=redacted&")}}}else ie=null;else ie=$;return"XMLHTTP REQ ("+x+") [attempt "+q+"]: "+_+`
`+y+`
`+ie})}function el(d,_,y,x,q,$,ie){d.info(function(){return"XMLHTTP RESP ("+x+") [ attempt "+q+"]: "+_+`
`+y+`
`+$+" "+ie})}function ys(d,_,y,x){d.info(function(){return"XMLHTTP TEXT ("+_+"): "+_y(d,y)+(x?" "+x:"")})}function gy(d,_){d.info(function(){return"TIMEOUT: "+_})}_s.prototype.info=function(){};function _y(d,_){if(!d.g)return _;if(!_)return null;try{const $=JSON.parse(_);if($){for(d=0;d<$.length;d++)if(Array.isArray($[d])){var y=$[d];if(!(y.length<2)){var x=y[1];if(Array.isArray(x)&&!(x.length<1)){var q=x[0];if(q!="noop"&&q!="stop"&&q!="close")for(let ie=1;ie<x.length;ie++)x[ie]=""}}}}return hs($)}catch{return _}}var tl={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},hc={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},To;function nl(){}m(nl,Ya),nl.prototype.g=function(){return new XMLHttpRequest},To=new nl;function Nr(d){return encodeURIComponent(String(d))}function rl(d){var _=1;d=d.split(":");const y=[];for(;_>0&&d.length;)y.push(d.shift()),_--;return d.length&&y.push(d.join(":")),y}function wt(d,_,y,x){this.j=d,this.i=_,this.l=y,this.S=x||1,this.V=new xe(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new fc}function fc(){this.i=null,this.g="",this.h=!1}var il={},vs={};function sl(d,_,y){d.M=1,d.A=Mr(Fn(_)),d.u=y,d.R=!0,Af(d,null)}function Af(d,_){d.F=Date.now(),ai(d),d.B=Fn(d.A);var y=d.B,x=d.S;Array.isArray(x)||(x=[String(x)]),Cc(y.i,"t",x),d.C=0,y=d.j.L,d.h=new fc,d.g=Cs(d.j,y?_:null,!d.u),d.P>0&&(d.O=new yo(u(d.Y,d,d.g),d.P)),_=d.V,y=d.g,x=d.ba;var q="readystatechange";Array.isArray(q)||(q&&(lc[0]=q.toString()),q=lc);for(let $=0;$<q.length;$++){const ie=vn(y,q[$],x||_.handleEvent,!1,_.h||_);if(!ie)break;_.g[ie.key]=ie}_=d.J?Ie(d.J):{},d.u?(d.v||(d.v="POST"),_["Content-Type"]="application/x-www-form-urlencoded",d.g.ea(d.B,d.v,d.u,_)):(d.v="GET",d.g.ea(d.B,d.v,null,_)),Ln(),Q(d.i,d.v,d.B,d.l,d.S,d.u)}wt.prototype.ba=function(d){d=d.target;const _=this.O;_&&O(d)==3?_.j():this.Y(d)},wt.prototype.Y=function(d){try{if(d==this.g)e:{const Pe=O(this.g),Rt=this.g.ya(),Xe=this.g.ca();if(!(Pe<3)&&(Pe!=3||this.g&&(this.h.h||this.g.la()||H(this.g)))){this.K||Pe!=4||Rt==7||(Rt==8||Xe<=0?Ln(3):Ln(2)),Ts(this);var _=this.g.ca();this.X=_;var y=xf(this);if(this.o=_==200,el(this.i,this.v,this.B,this.l,this.S,Pe,_),this.o){if(this.U&&!this.L){t:{if(this.g){var x,q=this.g;if((x=q.g?q.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!N(x)){var $=x;break t}}$=null}if(d=$)ys(this.i,this.l,d,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Io(this,d);else{this.o=!1,this.m=3,vt(12),li(this),Eo(this);break e}}if(this.R){d=!0;let Ft;for(;!this.K&&this.C<y.length;)if(Ft=pc(this,y),Ft==vs){Pe==4&&(this.m=4,vt(14),d=!1),ys(this.i,this.l,null,"[Incomplete Response]");break}else if(Ft==il){this.m=4,vt(15),ys(this.i,this.l,y,"[Invalid Chunk]"),d=!1;break}else ys(this.i,this.l,Ft,null),Io(this,Ft);if(Rf(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Pe!=4||y.length!=0||this.h.h||(this.m=1,vt(16),d=!1),this.o=this.o&&d,!d)ys(this.i,this.l,y,"[Invalid Chunked Response]"),li(this),Eo(this);else if(y.length>0&&!this.W){this.W=!0;var ie=this.j;ie.g==this&&ie.aa&&!ie.P&&(ie.j.info("Great, no buffering proxy detected. Bytes received: "+y.length),Vr(ie),ie.P=!0,vt(11))}}else ys(this.i,this.l,y,null),Io(this,y);Pe==4&&li(this),this.o&&!this.K&&(Pe==4?Un(this.j,this):(this.o=!1,ai(this)))}else Y(this.g),_==400&&y.indexOf("Unknown SID")>0?(this.m=3,vt(12)):(this.m=0,vt(13)),li(this),Eo(this)}}}catch{}finally{}};function xf(d){if(!Rf(d))return d.g.la();const _=H(d.g);if(_==="")return"";let y="";const x=_.length,q=O(d.g)==4;if(!d.h.i){if(typeof TextDecoder>"u")return li(d),Eo(d),"";d.h.i=new o.TextDecoder}for(let $=0;$<x;$++)d.h.h=!0,y+=d.h.i.decode(_[$],{stream:!(q&&$==x-1)});return _.length=0,d.h.g+=y,d.C=0,d.h.g}function Rf(d){return d.g?d.v=="GET"&&d.M!=2&&d.j.Aa:!1}function pc(d,_){var y=d.C,x=_.indexOf(`
`,y);return x==-1?vs:(y=Number(_.substring(y,x)),isNaN(y)?il:(x+=1,x+y>_.length?vs:(_=_.slice(x,x+y),d.C=x+y,_)))}wt.prototype.cancel=function(){this.K=!0,li(this)};function ai(d){d.T=Date.now()+d.H,mc(d,d.H)}function mc(d,_){if(d.D!=null)throw Error("WatchDog timer not null");d.D=hr(u(d.aa,d),_)}function Ts(d){d.D&&(o.clearTimeout(d.D),d.D=null)}wt.prototype.aa=function(){this.D=null;const d=Date.now();d-this.T>=0?(gy(this.i,this.B),this.M!=2&&(Ln(),vt(17)),li(this),this.m=2,Eo(this)):mc(this,this.T-d)};function Eo(d){d.j.I==0||d.K||Un(d.j,d)}function li(d){Ts(d);var _=d.O;_&&typeof _.dispose=="function"&&_.dispose(),d.O=null,kr(d.V),d.g&&(_=d.g,d.g=null,_.abort(),_.dispose())}function Io(d,_){try{var y=d.j;if(y.I!=0&&(y.g==d||ol(y.h,d))){if(!d.L&&ol(y.h,d)&&y.I==3){try{var x=y.Ba.g.parse(_)}catch{x=null}if(Array.isArray(x)&&x.length==3){var q=x;if(q[0]==0){e:if(!y.v){if(y.g)if(y.g.F+3e3<d.F)wn(y),ne(y);else break e;In(y),vt(18)}}else y.xa=q[1],0<y.xa-y.K&&q[2]<37500&&y.F&&y.A==0&&!y.C&&(y.C=hr(u(y.Va,y),6e3));wo(y.h)<=1&&y.ta&&(y.ta=void 0)}else St(y,11)}else if((d.L||y.g==d)&&wn(y),!N(_))for(q=y.Ba.g.parse(_),_=0;_<q.length;_++){let Xe=q[_];const Ft=Xe[0];if(!(Ft<=y.K))if(y.K=Ft,Xe=Xe[1],y.I==2)if(Xe[0]=="c"){y.M=Xe[1],y.ba=Xe[2];const mr=Xe[3];mr!=null&&(y.ka=mr,y.j.info("VER="+y.ka));const As=Xe[4];As!=null&&(y.za=As,y.j.info("SVER="+y.za));const fi=Xe[5];fi!=null&&typeof fi=="number"&&fi>0&&(x=1.5*fi,y.O=x,y.j.info("backChannelRequestTimeoutMs_="+x)),x=y;const pi=d.g;if(pi){const Nc=pi.g?pi.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Nc){var $=x.h;$.g||Nc.indexOf("spdy")==-1&&Nc.indexOf("quic")==-1&&Nc.indexOf("h2")==-1||($.j=$.l,$.g=new Set,$.h&&(al($,$.h),$.h=null))}if(x.G){const Uf=pi.g?pi.g.getResponseHeader("X-HTTP-Session-Id"):null;Uf&&(x.wa=Uf,He(x.J,x.G,Uf))}}y.I=3,y.l&&y.l.ra(),y.aa&&(y.T=Date.now()-d.F,y.j.info("Handshake RTT: "+y.T+"ms")),x=y;var ie=d;if(x.na=hl(x,x.L?x.ba:null,x.W),ie.L){ui(x.h,ie);var Pe=ie,Rt=x.O;Rt&&(Pe.H=Rt),Pe.D&&(Ts(Pe),ai(Pe)),x.g=ie}else dt(x);y.i.length>0&&pe(y)}else Xe[0]!="stop"&&Xe[0]!="close"||St(y,7);else y.I==3&&(Xe[0]=="stop"||Xe[0]=="close"?Xe[0]=="stop"?St(y,7):W(y):Xe[0]!="noop"&&y.l&&y.l.qa(Xe),y.A=0)}}Ln(4)}catch{}}var gc=class{constructor(d,_){this.g=d,this.map=_}};function _c(d){this.l=d||10,o.PerformanceNavigationTiming?(d=o.performance.getEntriesByType("navigation"),d=d.length>0&&(d[0].nextHopProtocol=="hq"||d[0].nextHopProtocol=="h2")):d=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=d?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function yc(d){return d.h?!0:d.g?d.g.size>=d.j:!1}function wo(d){return d.h?1:d.g?d.g.size:0}function ol(d,_){return d.h?d.h==_:d.g?d.g.has(_):!1}function al(d,_){d.g?d.g.add(_):d.h=_}function ui(d,_){d.h&&d.h==_?d.h=null:d.g&&d.g.has(_)&&d.g.delete(_)}_c.prototype.cancel=function(){if(this.i=So(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const d of this.g.values())d.cancel();this.g.clear()}};function So(d){if(d.h!=null)return d.i.concat(d.h.G);if(d.g!=null&&d.g.size!==0){let _=d.i;for(const y of d.g.values())_=_.concat(y.G);return _}return v(d.i)}var vc=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function se(d,_){if(d){d=d.split("&");for(let y=0;y<d.length;y++){const x=d[y].indexOf("=");let q,$=null;x>=0?(q=d[y].substring(0,x),$=d[y].substring(x+1)):q=d[y],_(q,$?decodeURIComponent($.replace(/\+/g," ")):"")}}}function En(d){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let _;d instanceof En?(this.l=d.l,Dr(this,d.j),this.o=d.o,this.g=d.g,Es(this,d.u),this.h=d.h,br(this,Ac(d.i)),this.m=d.m):d&&(_=String(d).match(vc))?(this.l=!1,Dr(this,_[1]||"",!0),this.o=Is(_[2]||""),this.g=Is(_[3]||"",!0),Es(this,_[4]),this.h=Is(_[5]||"",!0),br(this,_[6]||"",!0),this.m=Is(_[7]||"")):(this.l=!1,this.i=new ci(null,this.l))}En.prototype.toString=function(){const d=[];var _=this.j;_&&d.push(ws(_,Ec,!0),":");var y=this.g;return(y||_=="file")&&(d.push("//"),(_=this.o)&&d.push(ws(_,Ec,!0),"@"),d.push(Nr(y).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y=this.u,y!=null&&d.push(":",String(y))),(y=this.h)&&(this.g&&y.charAt(0)!="/"&&d.push("/"),d.push(ws(y,y.charAt(0)=="/"?ll:Pf,!0))),(y=this.i.toString())&&d.push("?",y),(y=this.m)&&d.push("#",ws(y,Nf)),d.join("")},En.prototype.resolve=function(d){const _=Fn(this);let y=!!d.j;y?Dr(_,d.j):y=!!d.o,y?_.o=d.o:y=!!d.g,y?_.g=d.g:y=d.u!=null;var x=d.h;if(y)Es(_,d.u);else if(y=!!d.h){if(x.charAt(0)!="/")if(this.g&&!this.h)x="/"+x;else{var q=_.h.lastIndexOf("/");q!=-1&&(x=_.h.slice(0,q+1)+x)}if(q=x,q==".."||q==".")x="";else if(q.indexOf("./")!=-1||q.indexOf("/.")!=-1){x=q.lastIndexOf("/",0)==0,q=q.split("/");const $=[];for(let ie=0;ie<q.length;){const Pe=q[ie++];Pe=="."?x&&ie==q.length&&$.push(""):Pe==".."?(($.length>1||$.length==1&&$[0]!="")&&$.pop(),x&&ie==q.length&&$.push("")):($.push(Pe),x=!0)}x=$.join("/")}else x=q}return y?_.h=x:y=d.i.toString()!=="",y?br(_,Ac(d.i)):y=!!d.m,y&&(_.m=d.m),_};function Fn(d){return new En(d)}function Dr(d,_,y){d.j=y?Is(_,!0):_,d.j&&(d.j=d.j.replace(/:$/,""))}function Es(d,_){if(_){if(_=Number(_),isNaN(_)||_<0)throw Error("Bad port number "+_);d.u=_}else d.u=null}function br(d,_,y){_ instanceof ci?(d.i=_,Df(d.i,d.l)):(y||(_=ws(_,kf)),d.i=new ci(_,d.l))}function He(d,_,y){d.i.set(_,y)}function Mr(d){return He(d,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),d}function Is(d,_){return d?_?decodeURI(d.replace(/%25/g,"%2525")):decodeURIComponent(d):""}function ws(d,_,y){return typeof d=="string"?(d=encodeURI(d).replace(_,Tc),y&&(d=d.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d):null}function Tc(d){return d=d.charCodeAt(0),"%"+(d>>4&15).toString(16)+(d&15).toString(16)}var Ec=/[#\/\?@]/g,Pf=/[#\?:]/g,ll=/[#\?]/g,kf=/[#\?@]/g,Nf=/#/g;function ci(d,_){this.h=this.g=null,this.i=d||null,this.j=!!_}function fr(d){d.g||(d.g=new Map,d.h=0,d.i&&se(d.i,function(_,y){d.add(decodeURIComponent(_.replace(/\+/g," ")),y)}))}t=ci.prototype,t.add=function(d,_){fr(this),this.i=null,d=di(this,d);let y=this.g.get(d);return y||this.g.set(d,y=[]),y.push(_),this.h+=1,this};function Ic(d,_){fr(d),_=di(d,_),d.g.has(_)&&(d.i=null,d.h-=d.g.get(_).length,d.g.delete(_))}function wc(d,_){return fr(d),_=di(d,_),d.g.has(_)}t.forEach=function(d,_){fr(this),this.g.forEach(function(y,x){y.forEach(function(q){d.call(_,q,x,this)},this)},this)};function Sc(d,_){fr(d);let y=[];if(typeof _=="string")wc(d,_)&&(y=y.concat(d.g.get(di(d,_))));else for(d=Array.from(d.g.values()),_=0;_<d.length;_++)y=y.concat(d[_]);return y}t.set=function(d,_){return fr(this),this.i=null,d=di(this,d),wc(this,d)&&(this.h-=this.g.get(d).length),this.g.set(d,[_]),this.h+=1,this},t.get=function(d,_){return d?(d=Sc(this,d),d.length>0?String(d[0]):_):_};function Cc(d,_,y){Ic(d,_),y.length>0&&(d.i=null,d.g.set(di(d,_),v(y)),d.h+=y.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const d=[],_=Array.from(this.g.keys());for(let x=0;x<_.length;x++){var y=_[x];const q=Nr(y);y=Sc(this,y);for(let $=0;$<y.length;$++){let ie=q;y[$]!==""&&(ie+="="+Nr(y[$])),d.push(ie)}}return this.i=d.join("&")};function Ac(d){const _=new ci;return _.i=d.i,d.g&&(_.g=new Map(d.g),_.h=d.h),_}function di(d,_){return _=String(_),d.j&&(_=_.toLowerCase()),_}function Df(d,_){_&&!d.j&&(fr(d),d.i=null,d.g.forEach(function(y,x){const q=x.toLowerCase();x!=q&&(Ic(this,x),Cc(this,q,y))},d)),d.j=_}function bf(d,_){const y=new _s;if(o.Image){const x=new Image;x.onload=f(pr,y,"TestLoadImage: loaded",!0,_,x),x.onerror=f(pr,y,"TestLoadImage: error",!1,_,x),x.onabort=f(pr,y,"TestLoadImage: abort",!1,_,x),x.ontimeout=f(pr,y,"TestLoadImage: timeout",!1,_,x),o.setTimeout(function(){x.ontimeout&&x.ontimeout()},1e4),x.src=d}else _(!1)}function Mf(d,_){const y=new _s,x=new AbortController,q=setTimeout(()=>{x.abort(),pr(y,"TestPingServer: timeout",!1,_)},1e4);fetch(d,{signal:x.signal}).then($=>{clearTimeout(q),$.ok?pr(y,"TestPingServer: ok",!0,_):pr(y,"TestPingServer: server error",!1,_)}).catch(()=>{clearTimeout(q),pr(y,"TestPingServer: error",!1,_)})}function pr(d,_,y,x,q){try{q&&(q.onload=null,q.onerror=null,q.onabort=null,q.ontimeout=null),x(y)}catch{}}function Vf(){this.g=new uc}function ul(d){this.i=d.Sb||null,this.h=d.ab||!1}m(ul,Ya),ul.prototype.g=function(){return new Co(this.i,this.h)};function Co(d,_){ae.call(this),this.H=d,this.o=_,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}m(Co,ae),t=Co.prototype,t.open=function(d,_){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=d,this.D=_,this.readyState=1,Ss(this)},t.send=function(d){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const _={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};d&&(_.body=d),(this.H||o).fetch(new Request(this.D,_)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,hi(this)),this.readyState=0},t.Pa=function(d){if(this.g&&(this.l=d,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=d.headers,this.readyState=2,Ss(this)),this.g&&(this.readyState=3,Ss(this),this.g)))if(this.responseType==="arraybuffer")d.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in d){if(this.j=d.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;xc(this)}else d.text().then(this.Oa.bind(this),this.ga.bind(this))};function xc(d){d.j.read().then(d.Ma.bind(d)).catch(d.ga.bind(d))}t.Ma=function(d){if(this.g){if(this.o&&d.value)this.response.push(d.value);else if(!this.o){var _=d.value?d.value:new Uint8Array(0);(_=this.B.decode(_,{stream:!d.done}))&&(this.response=this.responseText+=_)}d.done?hi(this):Ss(this),this.readyState==3&&xc(this)}},t.Oa=function(d){this.g&&(this.response=this.responseText=d,hi(this))},t.Na=function(d){this.g&&(this.response=d,hi(this))},t.ga=function(){this.g&&hi(this)};function hi(d){d.readyState=4,d.l=null,d.j=null,d.B=null,Ss(d)}t.setRequestHeader=function(d,_){this.A.append(d,_)},t.getResponseHeader=function(d){return this.h&&this.h.get(d.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const d=[],_=this.h.entries();for(var y=_.next();!y.done;)y=y.value,d.push(y[0]+": "+y[1]),y=_.next();return d.join(`\r
`)};function Ss(d){d.onreadystatechange&&d.onreadystatechange.call(d)}Object.defineProperty(Co.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(d){this.m=d?"include":"same-origin"}});function Rc(d){let _="";return ce(d,function(y,x){_+=x,_+=":",_+=y,_+=`\r
`}),_}function cl(d,_,y){e:{for(x in y){var x=!1;break e}x=!0}x||(y=Rc(y),typeof d=="string"?y!=null&&Nr(y):He(d,_,y))}function rt(d){ae.call(this),this.headers=new Map,this.L=d||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}m(rt,ae);var Lf=/^https?$/i,Ff=["POST","PUT"];t=rt.prototype,t.Fa=function(d){this.H=d},t.ea=function(d,_,y,x){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+d);_=_?_.toUpperCase():"GET",this.D=d,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():To.g(),this.g.onreadystatechange=g(u(this.Ca,this));try{this.B=!0,this.g.open(_,String(d),!0),this.B=!1}catch($){Ao(this,$);return}if(d=y||"",y=new Map(this.headers),x)if(Object.getPrototypeOf(x)===Object.prototype)for(var q in x)y.set(q,x[q]);else if(typeof x.keys=="function"&&typeof x.get=="function")for(const $ of x.keys())y.set($,x.get($));else throw Error("Unknown input type for opt_headers: "+String(x));x=Array.from(y.keys()).find($=>$.toLowerCase()=="content-type"),q=o.FormData&&d instanceof o.FormData,!(Array.prototype.indexOf.call(Ff,_,void 0)>=0)||x||q||y.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[$,ie]of y)this.g.setRequestHeader($,ie);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(d),this.v=!1}catch($){Ao(this,$)}};function Ao(d,_){d.h=!1,d.g&&(d.j=!0,d.g.abort(),d.j=!1),d.l=_,d.o=5,A(d),F(d)}function A(d){d.A||(d.A=!0,Lt(d,"complete"),Lt(d,"error"))}t.abort=function(d){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=d||7,Lt(this,"complete"),Lt(this,"abort"),F(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),F(this,!0)),rt.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?b(this):this.Xa())},t.Xa=function(){b(this)};function b(d){if(d.h&&typeof s<"u"){if(d.v&&O(d)==4)setTimeout(d.Ca.bind(d),0);else if(Lt(d,"readystatechange"),O(d)==4){d.h=!1;try{const $=d.ca();e:switch($){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var _=!0;break e;default:_=!1}var y;if(!(y=_)){var x;if(x=$===0){let ie=String(d.D).match(vc)[1]||null;!ie&&o.self&&o.self.location&&(ie=o.self.location.protocol.slice(0,-1)),x=!Lf.test(ie?ie.toLowerCase():"")}y=x}if(y)Lt(d,"complete"),Lt(d,"success");else{d.o=6;try{var q=O(d)>2?d.g.statusText:""}catch{q=""}d.l=q+" ["+d.ca()+"]",A(d)}}finally{F(d)}}}}function F(d,_){if(d.g){d.m&&(clearTimeout(d.m),d.m=null);const y=d.g;d.g=null,_||Lt(d,"ready");try{y.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function O(d){return d.g?d.g.readyState:0}t.ca=function(){try{return O(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(d){if(this.g){var _=this.g.responseText;return d&&_.indexOf(d)==0&&(_=_.substring(d.length)),Qa(_)}};function H(d){try{if(!d.g)return null;if("response"in d.g)return d.g.response;switch(d.F){case"":case"text":return d.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in d.g)return d.g.mozResponseArrayBuffer}return null}catch{return null}}function Y(d){const _={};d=(d.g&&O(d)>=2&&d.g.getAllResponseHeaders()||"").split(`\r
`);for(let x=0;x<d.length;x++){if(N(d[x]))continue;var y=rl(d[x]);const q=y[0];if(y=y[1],typeof y!="string")continue;y=y.trim();const $=_[q]||[];_[q]=$,$.push(y)}ve(_,function(x){return x.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function K(d,_,y){return y&&y.internalChannelParams&&y.internalChannelParams[d]||_}function X(d){this.za=0,this.i=[],this.j=new _s,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=K("failFast",!1,d),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=K("baseRetryDelayMs",5e3,d),this.Za=K("retryDelaySeedMs",1e4,d),this.Ta=K("forwardChannelMaxRetries",2,d),this.va=K("forwardChannelRequestTimeoutMs",2e4,d),this.ma=d&&d.xmlHttpFactory||void 0,this.Ua=d&&d.Rb||void 0,this.Aa=d&&d.useFetchStreams||!1,this.O=void 0,this.L=d&&d.supportsCrossDomainXhr||!1,this.M="",this.h=new _c(d&&d.concurrentRequestLimit),this.Ba=new Vf,this.S=d&&d.fastHandshake||!1,this.R=d&&d.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=d&&d.Pb||!1,d&&d.ua&&this.j.ua(),d&&d.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&d&&d.detectBufferingProxy||!1,this.ia=void 0,d&&d.longPollingTimeout&&d.longPollingTimeout>0&&(this.ia=d.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=X.prototype,t.ka=8,t.I=1,t.connect=function(d,_,y,x){vt(0),this.W=d,this.H=_||{},y&&x!==void 0&&(this.H.OSID=y,this.H.OAID=x),this.F=this.X,this.J=hl(this,null,this.W),pe(this)};function W(d){if(j(d),d.I==3){var _=d.V++,y=Fn(d.J);if(He(y,"SID",d.M),He(y,"RID",_),He(y,"TYPE","terminate"),de(d,y),_=new wt(d,d.j,_),_.M=2,_.A=Mr(Fn(y)),y=!1,o.navigator&&o.navigator.sendBeacon)try{y=o.navigator.sendBeacon(_.A.toString(),"")}catch{}!y&&o.Image&&(new Image().src=_.A,y=!0),y||(_.g=Cs(_.j,null),_.g.ea(_.A)),_.F=Date.now(),ai(_)}dl(d)}function ne(d){d.g&&(Vr(d),d.g.cancel(),d.g=null)}function j(d){ne(d),d.v&&(o.clearTimeout(d.v),d.v=null),wn(d),d.h.cancel(),d.m&&(typeof d.m=="number"&&o.clearTimeout(d.m),d.m=null)}function pe(d){if(!yc(d.h)&&!d.m){d.m=!0;var _=d.Ea;U||w(),B||(U(),B=!0),E.add(_,d),d.D=0}}function me(d,_){return wo(d.h)>=d.h.j-(d.m?1:0)?!1:d.m?(d.i=_.G.concat(d.i),!0):d.I==1||d.I==2||d.D>=(d.Sa?0:d.Ta)?!1:(d.m=hr(u(d.Ea,d,_),Jn(d,d.D)),d.D++,!0)}t.Ea=function(d){if(this.m)if(this.m=null,this.I==1){if(!d){this.V=Math.floor(Math.random()*1e5),d=this.V++;const q=new wt(this,this.j,d);let $=this.o;if(this.U&&($?($=Ie($),$e($,this.U)):$=this.U),this.u!==null||this.R||(q.J=$,$=null),this.S)e:{for(var _=0,y=0;y<this.i.length;y++){t:{var x=this.i[y];if("__data__"in x.map&&(x=x.map.__data__,typeof x=="string")){x=x.length;break t}x=void 0}if(x===void 0)break;if(_+=x,_>4096){_=y;break e}if(_===4096||y===this.i.length-1){_=y+1;break e}}_=1e3}else _=1e3;_=Me(this,q,_),y=Fn(this.J),He(y,"RID",d),He(y,"CVER",22),this.G&&He(y,"X-HTTP-Session-Id",this.G),de(this,y),$&&(this.R?_="headers="+Nr(Rc($))+"&"+_:this.u&&cl(y,this.u,$)),al(this.h,q),this.Ra&&He(y,"TYPE","init"),this.S?(He(y,"$req",_),He(y,"SID","null"),q.U=!0,sl(q,y,null)):sl(q,y,_),this.I=2}}else this.I==3&&(d?le(this,d):this.i.length==0||yc(this.h)||le(this))};function le(d,_){var y;_?y=_.l:y=d.V++;const x=Fn(d.J);He(x,"SID",d.M),He(x,"RID",y),He(x,"AID",d.K),de(d,x),d.u&&d.o&&cl(x,d.u,d.o),y=new wt(d,d.j,y,d.D+1),d.u===null&&(y.J=d.o),_&&(d.i=_.G.concat(d.i)),_=Me(d,y,1e3),y.H=Math.round(d.va*.5)+Math.round(d.va*.5*Math.random()),al(d.h,y),sl(y,x,_)}function de(d,_){d.H&&ce(d.H,function(y,x){He(_,x,y)}),d.l&&ce({},function(y,x){He(_,x,y)})}function Me(d,_,y){y=Math.min(d.i.length,y);const x=d.l?u(d.l.Ka,d.l,d):null;e:{var q=d.i;let Pe=-1;for(;;){const Rt=["count="+y];Pe==-1?y>0?(Pe=q[0].g,Rt.push("ofs="+Pe)):Pe=0:Rt.push("ofs="+Pe);let Xe=!0;for(let Ft=0;Ft<y;Ft++){var $=q[Ft].g;const mr=q[Ft].map;if($-=Pe,$<0)Pe=Math.max(0,q[Ft].g-100),Xe=!1;else try{$="req"+$+"_"||"";try{var ie=mr instanceof Map?mr:Object.entries(mr);for(const[As,fi]of ie){let pi=fi;a(fi)&&(pi=hs(fi)),Rt.push($+As+"="+encodeURIComponent(pi))}}catch(As){throw Rt.push($+"type="+encodeURIComponent("_badmap")),As}}catch{x&&x(mr)}}if(Xe){ie=Rt.join("&");break e}}ie=void 0}return d=d.i.splice(0,y),_.G=d,ie}function dt(d){if(!d.g&&!d.v){d.Y=1;var _=d.Da;U||w(),B||(U(),B=!0),E.add(_,d),d.A=0}}function In(d){return d.g||d.v||d.A>=3?!1:(d.Y++,d.v=hr(u(d.Da,d),Jn(d,d.A)),d.A++,!0)}t.Da=function(){if(this.v=null,xo(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var d=4*this.T;this.j.info("BP detection timer enabled: "+d),this.B=hr(u(this.Wa,this),d)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,vt(10),ne(this),xo(this))};function Vr(d){d.B!=null&&(o.clearTimeout(d.B),d.B=null)}function xo(d){d.g=new wt(d,d.j,"rpc",d.Y),d.u===null&&(d.g.J=d.o),d.g.P=0;var _=Fn(d.na);He(_,"RID","rpc"),He(_,"SID",d.M),He(_,"AID",d.K),He(_,"CI",d.F?"0":"1"),!d.F&&d.ia&&He(_,"TO",d.ia),He(_,"TYPE","xmlhttp"),de(d,_),d.u&&d.o&&cl(_,d.u,d.o),d.O&&(d.g.H=d.O);var y=d.g;d=d.ba,y.M=1,y.A=Mr(Fn(_)),y.u=null,y.R=!0,Af(y,d)}t.Va=function(){this.C!=null&&(this.C=null,ne(this),In(this),vt(19))};function wn(d){d.C!=null&&(o.clearTimeout(d.C),d.C=null)}function Un(d,_){var y=null;if(d.g==_){wn(d),Vr(d),d.g=null;var x=2}else if(ol(d.h,_))y=_.G,ui(d.h,_),x=1;else return;if(d.I!=0){if(_.o)if(x==1){y=_.u?_.u.length:0,_=Date.now()-_.F;var q=d.D;x=vo(),Lt(x,new dc(x,y)),pe(d)}else dt(d);else if(q=_.m,q==3||q==0&&_.X>0||!(x==1&&me(d,_)||x==2&&In(d)))switch(y&&y.length>0&&(_=d.h,_.i=_.i.concat(y)),q){case 1:St(d,5);break;case 4:St(d,10);break;case 3:St(d,6);break;default:St(d,2)}}}function Jn(d,_){let y=d.Qa+Math.floor(Math.random()*d.Za);return d.isActive()||(y*=2),y*_}function St(d,_){if(d.j.info("Error code "+_),_==2){var y=u(d.bb,d),x=d.Ua;const q=!x;x=new En(x||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||Dr(x,"https"),Mr(x),q?bf(x.toString(),y):Mf(x.toString(),y)}else vt(2);d.I=0,d.l&&d.l.pa(_),dl(d),j(d)}t.bb=function(d){d?(this.j.info("Successfully pinged google.com"),vt(2)):(this.j.info("Failed to ping google.com"),vt(1))};function dl(d){if(d.I=0,d.ja=[],d.l){const _=So(d.h);(_.length!=0||d.i.length!=0)&&(T(d.ja,_),T(d.ja,d.i),d.h.i.length=0,v(d.i),d.i.length=0),d.l.oa()}}function hl(d,_,y){var x=y instanceof En?Fn(y):new En(y);if(x.g!="")_&&(x.g=_+"."+x.g),Es(x,x.u);else{var q=o.location;x=q.protocol,_=_?_+"."+q.hostname:q.hostname,q=+q.port;const $=new En(null);x&&Dr($,x),_&&($.g=_),q&&Es($,q),y&&($.h=y),x=$}return y=d.G,_=d.wa,y&&_&&He(x,y,_),He(x,"VER",d.ka),de(d,x),x}function Cs(d,_,y){if(_&&!d.L)throw Error("Can't create secondary domain capable XhrIo object.");return _=d.Aa&&!d.ma?new rt(new ul({ab:y})):new rt(d.ma),_.Fa(d.L),_}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Pc(){}t=Pc.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function kc(){}kc.prototype.g=function(d,_){return new Sn(d,_)};function Sn(d,_){ae.call(this),this.g=new X(_),this.l=d,this.h=_&&_.messageUrlParams||null,d=_&&_.messageHeaders||null,_&&_.clientProtocolHeaderRequired&&(d?d["X-Client-Protocol"]="webchannel":d={"X-Client-Protocol":"webchannel"}),this.g.o=d,d=_&&_.initMessageHeaders||null,_&&_.messageContentType&&(d?d["X-WebChannel-Content-Type"]=_.messageContentType:d={"X-WebChannel-Content-Type":_.messageContentType}),_&&_.sa&&(d?d["X-WebChannel-Client-Profile"]=_.sa:d={"X-WebChannel-Client-Profile":_.sa}),this.g.U=d,(d=_&&_.Qb)&&!N(d)&&(this.g.u=d),this.A=_&&_.supportsCrossDomainXhr||!1,this.v=_&&_.sendRawJson||!1,(_=_&&_.httpSessionIdParam)&&!N(_)&&(this.g.G=_,d=this.h,d!==null&&_ in d&&(d=this.h,_ in d&&delete d[_])),this.j=new Ro(this)}m(Sn,ae),Sn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Sn.prototype.close=function(){W(this.g)},Sn.prototype.o=function(d){var _=this.g;if(typeof d=="string"){var y={};y.__data__=d,d=y}else this.v&&(y={},y.__data__=hs(d),d=y);_.i.push(new gc(_.Ya++,d)),_.I==3&&pe(_)},Sn.prototype.N=function(){this.g.l=null,delete this.j,W(this.g),delete this.g,Sn.Z.N.call(this)};function yy(d){Xa.call(this),d.__headers__&&(this.headers=d.__headers__,this.statusCode=d.__status__,delete d.__headers__,delete d.__status__);var _=d.__sm__;if(_){e:{for(const y in _){d=y;break e}d=void 0}(this.i=d)&&(d=this.i,_=_!==null&&d in _?_[d]:void 0),this.data=_}else this.data=d}m(yy,Xa);function vy(){ps.call(this),this.status=1}m(vy,ps);function Ro(d){this.g=d}m(Ro,Pc),Ro.prototype.ra=function(){Lt(this.g,"a")},Ro.prototype.qa=function(d){Lt(this.g,new yy(d))},Ro.prototype.pa=function(d){Lt(this.g,new vy)},Ro.prototype.oa=function(){Lt(this.g,"b")},kc.prototype.createWebChannel=kc.prototype.g,Sn.prototype.send=Sn.prototype.o,Sn.prototype.open=Sn.prototype.m,Sn.prototype.close=Sn.prototype.close,O0=function(){return new kc},U0=function(){return vo()},F0=Tn,Lm={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},tl.NO_ERROR=0,tl.TIMEOUT=8,tl.HTTP_ERROR=6,Id=tl,hc.COMPLETE="complete",L0=hc,cc.EventType=fs,fs.OPEN="a",fs.CLOSE="b",fs.ERROR="c",fs.MESSAGE="d",ae.prototype.listen=ae.prototype.J,Nl=cc,rt.prototype.listenOnce=rt.prototype.K,rt.prototype.getLastError=rt.prototype.Ha,rt.prototype.getLastErrorCode=rt.prototype.ya,rt.prototype.getStatus=rt.prototype.ca,rt.prototype.getResponseJson=rt.prototype.La,rt.prototype.getResponseText=rt.prototype.la,rt.prototype.send=rt.prototype.ea,rt.prototype.setWithCredentials=rt.prototype.Fa,V0=rt}).apply(typeof Qc<"u"?Qc:typeof self<"u"?self:typeof window<"u"?window:{});const CE="@firebase/firestore",AE="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}zt.UNAUTHENTICATED=new zt(null),zt.GOOGLE_CREDENTIALS=new zt("google-credentials-uid"),zt.FIRST_PARTY=new zt("first-party-uid"),zt.MOCK_USER=new zt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Wa="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qi=new h_("@firebase/firestore");function Lo(){return Qi.logLevel}function B0(t){Qi.setLogLevel(t)}function Z(t,...e){if(Qi.logLevel<=Ve.DEBUG){const n=e.map(C_);Qi.debug(`Firestore (${Wa}): ${t}`,...n)}}function sn(t,...e){if(Qi.logLevel<=Ve.ERROR){const n=e.map(C_);Qi.error(`Firestore (${Wa}): ${t}`,...n)}}function Yi(t,...e){if(Qi.logLevel<=Ve.WARN){const n=e.map(C_);Qi.warn(`Firestore (${Wa}): ${t}`,...n)}}function C_(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fe(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,G0(t,r,n)}function G0(t,e,n){let r=`FIRESTORE (${Wa}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw sn(r),new Error(r)}function ye(t,e,n,r){let i="Unexpected state";typeof n=="string"?i=n:r=n,t||G0(e,i,r)}function Ae(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class re extends ri{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cr{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q0{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class z0{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(zt.UNAUTHENTICATED))}shutdown(){}}class ZF{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class eU{constructor(e){this.t=e,this.currentUser=zt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){ye(this.o===void 0,42304);let r=this.i;const i=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let s=new Cr;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Cr,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},a=l=>{Z("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(Z("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Cr)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(Z("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ye(typeof r.accessToken=="string",31837,{l:r}),new q0(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ye(e===null||typeof e=="string",2055,{h:e}),new zt(e)}}class tU{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=zt.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class nU{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new tU(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(zt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class xE{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class rU{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,tr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){ye(this.o===void 0,3512);const r=s=>{s.error!=null&&Z("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,Z("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{Z("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):Z("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new xE(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(ye(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new xE(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iU(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nf{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=iU(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%62))}return r}}function Ce(t,e){return t<e?-1:t>e?1:0}function Fm(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const i=t.charAt(r),s=e.charAt(r);if(i!==s)return vp(i)===vp(s)?Ce(i,s):vp(i)?1:-1}return Ce(t.length,e.length)}const sU=55296,oU=57343;function vp(t){const e=t.charCodeAt(0);return e>=sU&&e<=oU}function wa(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function $0(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RE="__name__";class yr{constructor(e,n,r){n===void 0?n=0:n>e.length&&fe(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&fe(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return yr.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof yr?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=yr.compareSegments(e.get(i),n.get(i));if(s!==0)return s}return Ce(e.length,n.length)}static compareSegments(e,n){const r=yr.isNumericId(e),i=yr.isNumericId(n);return r&&!i?-1:!r&&i?1:r&&i?yr.extractNumericId(e).compare(yr.extractNumericId(n)):Fm(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return $i.fromString(e.substring(4,e.length-2))}}class ze extends yr{construct(e,n,r){return new ze(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new re(J.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new ze(n)}static emptyPath(){return new ze([])}}const aU=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class at extends yr{construct(e,n,r){return new at(e,n,r)}static isValidIdentifier(e){return aU.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),at.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===RE}static keyField(){return new at([RE])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new re(J.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new re(J.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new re(J.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new re(J.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new at(n)}static emptyPath(){return new at([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oe{constructor(e){this.path=e}static fromPath(e){return new oe(ze.fromString(e))}static fromName(e){return new oe(ze.fromString(e).popFirst(5))}static empty(){return new oe(ze.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ze.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return ze.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new oe(new ze(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H0(t,e,n){if(!n)throw new re(J.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function W0(t,e,n,r){if(e===!0&&r===!0)throw new re(J.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function PE(t){if(!oe.isDocumentKey(t))throw new re(J.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function kE(t){if(oe.isDocumentKey(t))throw new re(J.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function j0(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function rf(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":fe(12329,{type:typeof t})}function ln(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new re(J.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=rf(t);throw new re(J.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xt(t,e){const n={typeString:t};return e&&(n.value=e),n}function ju(t,e){if(!j0(t))throw new re(J.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(i&&typeof o!==i){n=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&o!==s.value){n=`Expected '${r}' field to equal '${s.value}'`;break}}if(n)throw new re(J.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NE=-62135596800,DE=1e6;class We{static now(){return We.fromMillis(Date.now())}static fromDate(e){return We.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*DE);return new We(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new re(J.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new re(J.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<NE)throw new re(J.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new re(J.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/DE}_compareTo(e){return this.seconds===e.seconds?Ce(this.nanoseconds,e.nanoseconds):Ce(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:We._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(ju(e,We._jsonSchema))return new We(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-NE;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}We._jsonSchemaVersion="firestore/timestamp/1.0",We._jsonSchema={type:xt("string",We._jsonSchemaVersion),seconds:xt("number"),nanoseconds:xt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Te{static fromTimestamp(e){return new Te(e)}static min(){return new Te(new We(0,0))}static max(){return new Te(new We(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Su=-1;class ph{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}}function Um(t){return t.fields.find(e=>e.kind===2)}function bs(t){return t.fields.filter(e=>e.kind!==2)}ph.UNKNOWN_ID=-1;class wd{constructor(e,n){this.fieldPath=e,this.kind=n}}class Cu{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new Cu(0,Dn.min())}}function lU(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=Te.fromTimestamp(r===1e9?new We(n+1,0):new We(n,r));return new Dn(i,oe.empty(),e)}function K0(t){return new Dn(t.readTime,t.key,Su)}class Dn{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Dn(Te.min(),oe.empty(),Su)}static max(){return new Dn(Te.max(),oe.empty(),Su)}}function A_(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=oe.comparator(t.documentKey,e.documentKey),n!==0?n:Ce(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J0="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Q0{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mo(t){if(t.code!==J.FAILED_PRECONDITION||t.message!==J0)throw t;Z("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&fe(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new G((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof G?n:G.resolve(n)}catch(n){return G.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):G.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):G.reject(n)}static resolve(e){return new G((n,r)=>{n(e)})}static reject(e){return new G((n,r)=>{r(e)})}static waitFor(e){return new G((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},l=>r(l))}),o=!0,s===i&&n()})}static or(e){let n=G.resolve(!1);for(const r of e)n=n.next(i=>i?G.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new G((r,i)=>{const s=e.length,o=new Array(s);let a=0;for(let l=0;l<s;l++){const u=l;n(e[u]).next(f=>{o[u]=f,++a,a===s&&r(o)},f=>i(f))}})}static doWhile(e,n){return new G((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const An="SimpleDb";class sf{static open(e,n,r,i){try{return new sf(n,e.transaction(i,r))}catch(s){throw new Jl(n,s)}}constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.S=new Cr,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{n.error?this.S.reject(new Jl(e,n.error)):this.S.resolve()},this.transaction.onerror=r=>{const i=x_(r.target.error);this.S.reject(new Jl(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(Z(An,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new cU(n)}}class Hi{static delete(e){return Z(An,"Removing database:",e),Vs(GC().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!QC())return!1;if(Hi.F())return!0;const e=Dt(),n=Hi.M(e),r=0<n&&n<10,i=Y0(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)==null?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)==="YES"}static O(e,n){return e.store(n)}static M(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,n,r){this.name=e,this.version=n,this.N=r,this.B=null,Hi.M(Dt())===12.2&&sn("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(Z(An,"Opening database:",this.name),this.db=await new Promise((n,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const o=s.target.result;n(o)},i.onblocked=()=>{r(new Jl(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const o=s.target.error;o.name==="VersionError"?r(new re(J.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new re(J.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Jl(e,o))},i.onupgradeneeded=s=>{Z(An,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.N.k(o,i.transaction,s.oldVersion,this.version).next(()=>{Z(An,"Database upgrade to version "+this.version+" complete")})}})),this.q&&(this.db.onversionchange=n=>this.q(n)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,i){const s=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const a=sf.open(this.db,e,s?"readonly":"readwrite",r),l=i(a).next(u=>(a.C(),u)).catch(u=>(a.abort(u),G.reject(u))).toPromise();return l.catch(()=>{}),await a.D,l}catch(a){const l=a,u=l.name!=="FirebaseError"&&o<3;if(Z(An,"Transaction failed with error:",l.message,"Retrying:",u),this.close(),!u)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function Y0(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class uU{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return Vs(this.U.delete())}}class Jl extends re{constructor(e,n){super(J.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function as(t){return t.name==="IndexedDbTransactionError"}class cU{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(Z(An,"PUT",this.store.name,e,n),r=this.store.put(n,e)):(Z(An,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Vs(r)}add(e){return Z(An,"ADD",this.store.name,e,e),Vs(this.store.add(e))}get(e){return Vs(this.store.get(e)).next(n=>(n===void 0&&(n=null),Z(An,"GET",this.store.name,e,n),n))}delete(e){return Z(An,"DELETE",this.store.name,e),Vs(this.store.delete(e))}count(){return Z(An,"COUNT",this.store.name),Vs(this.store.count())}J(e,n){const r=this.options(e,n),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const s=i.getAll(r.range);return new G((o,a)=>{s.onerror=l=>{a(l.target.error)},s.onsuccess=l=>{o(l.target.result)}})}{const s=this.cursor(r),o=[];return this.H(s,(a,l)=>{o.push(l)}).next(()=>o)}}Y(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new G((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}Z(e,n){Z(An,"DELETE ALL",this.store.name);const r=this.options(e,n);r.X=!1;const i=this.cursor(r);return this.H(i,(s,o,a)=>a.delete())}ee(e,n){let r;n?r=e:(r={},n=e);const i=this.cursor(r);return this.H(i,n)}te(e){const n=this.cursor({});return new G((r,i)=>{n.onerror=s=>{const o=x_(s.target.error);i(o)},n.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}H(e,n){const r=[];return new G((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void i();const l=new uU(a),u=n(a.primaryKey,a.value,l);if(u instanceof G){const f=u.catch(m=>(l.done(),G.reject(m)));r.push(f)}l.isDone?i():l.G===null?a.continue():a.continue(l.G)}}).next(()=>G.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function Vs(t){return new G((e,n)=>{t.onsuccess=r=>{const i=r.target.result;e(i)},t.onerror=r=>{const i=x_(r.target.error);n(i)}})}let bE=!1;function x_(t){const e=Hi.M(Dt());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new re("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return bE||(bE=!0,setTimeout(()=>{throw r},0)),r}}return t}const Ql="IndexBackfiller";class dU{constructor(e,n){this.asyncQueue=e,this.ne=n,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){Z(Ql,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const n=await this.ne.ie();Z(Ql,`Documents written: ${n}`)}catch(n){as(n)?Z(Ql,"Ignoring IndexedDB error during index backfill: ",n):await mo(n)}await this.re(6e4)})}}class hU{constructor(e,n){this.localStore=e,this.persistence=n}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.se(n,e))}se(e,n){const r=new Set;let i=n,s=!0;return G.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return Z(Ql,`Processing collection: ${o}`),this.oe(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>n-i)}oe(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this._e(i,s)).next(a=>(Z(Ql,`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}_e(e,n){let r=e;return n.changes.forEach((i,s)=>{const o=K0(s);A_(o,r)>0&&(r=o)}),new Dn(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zn{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}zn.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const js=-1;function of(t){return t==null}function Au(t){return t===0&&1/t==-1/0}function fU(t){return typeof t=="number"&&Number.isInteger(t)&&!Au(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mh="";function en(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=ME(e)),e=pU(t.get(n),e);return ME(e)}function pU(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const s=t.charAt(i);switch(s){case"\0":n+="";break;case mh:n+="";break;default:n+=s}}return n}function ME(t){return t+mh+""}function Tr(t){const e=t.length;if(ye(e>=2,64408,{path:t}),e===2)return ye(t.charAt(0)===mh&&t.charAt(1)==="",56145,{path:t}),ze.emptyPath();const n=e-2,r=[];let i="";for(let s=0;s<e;){const o=t.indexOf(mh,s);switch((o<0||o>n)&&fe(50515,{path:t}),t.charAt(o+1)){case"":const a=t.substring(s,o);let l;i.length===0?l=a:(i+=a,l=i,i=""),r.push(l);break;case"":i+=t.substring(s,o),i+="\0";break;case"":i+=t.substring(s,o+1);break;default:fe(61167,{path:t})}s=o+2}return new ze(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ms="remoteDocuments",Ku="owner",ko="owner",xu="mutationQueues",mU="userId",Zn="mutations",VE="batchId",zs="userMutationsIndex",LE=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sd(t,e){return[t,en(e)]}function X0(t,e,n){return[t,en(e),n]}const gU={},Sa="documentMutations",gh="remoteDocumentsV14",_U=["prefixPath","collectionGroup","readTime","documentId"],Cd="documentKeyIndex",yU=["prefixPath","collectionGroup","documentId"],Z0="collectionGroupIndex",vU=["collectionGroup","readTime","prefixPath","documentId"],Ru="remoteDocumentGlobal",Om="remoteDocumentGlobalKey",Ca="targets",eA="queryTargetsIndex",TU=["canonicalId","targetId"],Aa="targetDocuments",EU=["targetId","path"],R_="documentTargetsIndex",IU=["path","targetId"],_h="targetGlobalKey",Ks="targetGlobal",Pu="collectionParents",wU=["collectionId","parent"],xa="clientMetadata",SU="clientId",af="bundles",CU="bundleId",lf="namedQueries",AU="name",P_="indexConfiguration",xU="indexId",Bm="collectionGroupIndex",RU="collectionGroup",Yl="indexState",PU=["indexId","uid"],tA="sequenceNumberIndex",kU=["uid","sequenceNumber"],Xl="indexEntries",NU=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],nA="documentKeyIndex",DU=["indexId","uid","orderedDocumentKey"],uf="documentOverlays",bU=["userId","collectionPath","documentId"],Gm="collectionPathOverlayIndex",MU=["userId","collectionPath","largestBatchId"],rA="collectionGroupOverlayIndex",VU=["userId","collectionGroup","largestBatchId"],k_="globals",LU="name",iA=[xu,Zn,Sa,Ms,Ca,Ku,Ks,Aa,xa,Ru,Pu,af,lf],FU=[...iA,uf],sA=[xu,Zn,Sa,gh,Ca,Ku,Ks,Aa,xa,Ru,Pu,af,lf,uf],oA=sA,N_=[...oA,P_,Yl,Xl],UU=N_,aA=[...N_,k_],OU=aA;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qm extends Q0{constructor(e,n){super(),this.le=e,this.currentSequenceNumber=n}}function Mt(t,e){const n=Ae(t);return Hi.O(n.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FE(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ls(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function lA(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lt{constructor(e,n){this.comparator=e,this.root=n||$t.EMPTY}insert(e,n){return new lt(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,$t.BLACK,null,null))}remove(e){return new lt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,$t.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Yc(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Yc(this.root,e,this.comparator,!1)}getReverseIterator(){return new Yc(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Yc(this.root,e,this.comparator,!0)}}class Yc{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class $t{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??$t.RED,this.left=i??$t.EMPTY,this.right=s??$t.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new $t(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return $t.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return $t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,$t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,$t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw fe(43730,{key:this.key,value:this.value});if(this.right.isRed())throw fe(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw fe(27949);return e+(this.isRed()?0:1)}}$t.EMPTY=null,$t.RED=!0,$t.BLACK=!1;$t.EMPTY=new class{constructor(){this.size=0}get key(){throw fe(57766)}get value(){throw fe(16141)}get color(){throw fe(16727)}get left(){throw fe(29726)}get right(){throw fe(36894)}copy(e,n,r,i,s){return this}insert(e,n,r){return new $t(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ye{constructor(e){this.comparator=e,this.data=new lt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new UE(this.data.getIterator())}getIteratorFrom(e){return new UE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Ye)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Ye(this.comparator);return n.data=e,n}}class UE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function No(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mn{constructor(e){this.fields=e,e.sort(at.comparator)}static empty(){return new mn([])}unionWith(e){let n=new Ye(at.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new mn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return wa(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uA extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Et{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new uA("Invalid base64 string: "+s):s}}(e);return new Et(n)}static fromUint8Array(e){const n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new Et(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ce(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Et.EMPTY_BYTE_STRING=new Et("");const BU=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Zr(t){if(ye(!!t,39018),typeof t=="string"){let e=0;const n=BU.exec(t);if(ye(!!n,46558,{timestamp:t}),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:st(t.seconds),nanos:st(t.nanos)}}function st(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function ei(t){return typeof t=="string"?Et.fromBase64String(t):Et.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cA="server_timestamp",dA="__type__",hA="__previous_value__",fA="__local_write_time__";function D_(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[dA])==null?void 0:r.stringValue)===cA}function cf(t){const e=t.mapValue.fields[hA];return D_(e)?cf(e):e}function ku(t){const e=Zr(t.mapValue.fields[fA].timestampValue);return new We(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GU{constructor(e,n,r,i,s,o,a,l,u,f){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=u,this.isUsingEmulator=f}}const yh="(default)";class Xi{constructor(e,n){this.projectId=e,this.database=n||yh}static empty(){return new Xi("","")}get isDefaultDatabase(){return this.database===yh}isEqual(e){return e instanceof Xi&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b_="__type__",pA="__max__",Di={mapValue:{fields:{__type__:{stringValue:pA}}}},M_="__vector__",Ra="value",Ad={nullValue:"NULL_VALUE"};function Zi(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?D_(t)?4:mA(t)?9007199254740991:df(t)?10:11:fe(28295,{value:t})}function xr(t,e){if(t===e)return!0;const n=Zi(t);if(n!==Zi(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return ku(t).isEqual(ku(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=Zr(i.timestampValue),a=Zr(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return ei(i.bytesValue).isEqual(ei(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return st(i.geoPointValue.latitude)===st(s.geoPointValue.latitude)&&st(i.geoPointValue.longitude)===st(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return st(i.integerValue)===st(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=st(i.doubleValue),a=st(s.doubleValue);return o===a?Au(o)===Au(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return wa(t.arrayValue.values||[],e.arrayValue.values||[],xr);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(FE(o)!==FE(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!xr(o[l],a[l])))return!1;return!0}(t,e);default:return fe(52216,{left:t})}}function Nu(t,e){return(t.values||[]).find(n=>xr(n,e))!==void 0}function es(t,e){if(t===e)return 0;const n=Zi(t),r=Zi(e);if(n!==r)return Ce(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Ce(t.booleanValue,e.booleanValue);case 2:return function(s,o){const a=st(s.integerValue||s.doubleValue),l=st(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(t,e);case 3:return OE(t.timestampValue,e.timestampValue);case 4:return OE(ku(t),ku(e));case 5:return Fm(t.stringValue,e.stringValue);case 6:return function(s,o){const a=ei(s),l=ei(o);return a.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),l=o.split("/");for(let u=0;u<a.length&&u<l.length;u++){const f=Ce(a[u],l[u]);if(f!==0)return f}return Ce(a.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){const a=Ce(st(s.latitude),st(o.latitude));return a!==0?a:Ce(st(s.longitude),st(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return BE(t.arrayValue,e.arrayValue);case 10:return function(s,o){var g,v,T,P;const a=s.fields||{},l=o.fields||{},u=(g=a[Ra])==null?void 0:g.arrayValue,f=(v=l[Ra])==null?void 0:v.arrayValue,m=Ce(((T=u==null?void 0:u.values)==null?void 0:T.length)||0,((P=f==null?void 0:f.values)==null?void 0:P.length)||0);return m!==0?m:BE(u,f)}(t.mapValue,e.mapValue);case 11:return function(s,o){if(s===Di.mapValue&&o===Di.mapValue)return 0;if(s===Di.mapValue)return 1;if(o===Di.mapValue)return-1;const a=s.fields||{},l=Object.keys(a),u=o.fields||{},f=Object.keys(u);l.sort(),f.sort();for(let m=0;m<l.length&&m<f.length;++m){const g=Fm(l[m],f[m]);if(g!==0)return g;const v=es(a[l[m]],u[f[m]]);if(v!==0)return v}return Ce(l.length,f.length)}(t.mapValue,e.mapValue);default:throw fe(23264,{he:n})}}function OE(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Ce(t,e);const n=Zr(t),r=Zr(e),i=Ce(n.seconds,r.seconds);return i!==0?i:Ce(n.nanos,r.nanos)}function BE(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const s=es(n[i],r[i]);if(s)return s}return Ce(n.length,r.length)}function Pa(t){return zm(t)}function zm(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Zr(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return ei(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return oe.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=zm(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${zm(n.fields[o])}`;return i+"}"}(t.mapValue):fe(61005,{value:t})}function xd(t){switch(Zi(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=cf(t);return e?16+xd(e):16;case 5:return 2*t.stringValue.length;case 6:return ei(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,s)=>i+xd(s),0)}(t.arrayValue);case 10:case 11:return function(r){let i=0;return ls(r.fields,(s,o)=>{i+=s.length+xd(o)}),i}(t.mapValue);default:throw fe(13486,{value:t})}}function Du(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function $m(t){return!!t&&"integerValue"in t}function bu(t){return!!t&&"arrayValue"in t}function GE(t){return!!t&&"nullValue"in t}function qE(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Rd(t){return!!t&&"mapValue"in t}function df(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[b_])==null?void 0:r.stringValue)===M_}function Zl(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return ls(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Zl(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Zl(t.arrayValue.values[n]);return e}return{...t}}function mA(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===pA}const gA={mapValue:{fields:{[b_]:{stringValue:M_},[Ra]:{arrayValue:{}}}}};function qU(t){return"nullValue"in t?Ad:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?Du(Xi.empty(),oe.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?df(t)?gA:{mapValue:{}}:fe(35942,{value:t})}function zU(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?Du(Xi.empty(),oe.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?gA:"mapValue"in t?df(t)?{mapValue:{}}:Di:fe(61959,{value:t})}function zE(t,e){const n=es(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function $E(t,e){const n=es(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xt{constructor(e){this.value=e}static empty(){return new Xt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Rd(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Zl(n)}setAll(e){let n=at.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=Zl(o):i.push(a.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());Rd(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return xr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];Rd(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){ls(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new Xt(Zl(this.value))}}function _A(t){const e=[];return ls(t.fields,(n,r)=>{const i=new at([n]);if(Rd(r)){const s=_A(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new mn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yt{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new yt(e,0,Te.min(),Te.min(),Te.min(),Xt.empty(),0)}static newFoundDocument(e,n,r,i){return new yt(e,1,n,Te.min(),r,i,0)}static newNoDocument(e,n){return new yt(e,2,n,Te.min(),Te.min(),Xt.empty(),0)}static newUnknownDocument(e,n){return new yt(e,3,n,Te.min(),Te.min(),Xt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Te.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Xt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Xt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Te.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof yt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new yt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ka{constructor(e,n){this.position=e,this.inclusive=n}}function HE(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(s.field.isKeyField()?r=oe.comparator(oe.fromName(o.referenceValue),n.key):r=es(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function WE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!xr(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vh{constructor(e,n="asc"){this.field=e,this.dir=n}}function $U(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yA{}class Le extends yA{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new HU(e,n,r):n==="array-contains"?new KU(e,r):n==="in"?new SA(e,r):n==="not-in"?new JU(e,r):n==="array-contains-any"?new QU(e,r):new Le(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new WU(e,r):new jU(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(es(n,this.value)):n!==null&&Zi(this.value)===Zi(n)&&this.matchesComparison(es(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return fe(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Je extends yA{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new Je(e,n)}matches(e){return Na(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Na(t){return t.op==="and"}function Hm(t){return t.op==="or"}function V_(t){return vA(t)&&Na(t)}function vA(t){for(const e of t.filters)if(e instanceof Je)return!1;return!0}function Wm(t){if(t instanceof Le)return t.field.canonicalString()+t.op.toString()+Pa(t.value);if(V_(t))return t.filters.map(e=>Wm(e)).join(",");{const e=t.filters.map(n=>Wm(n)).join(",");return`${t.op}(${e})`}}function TA(t,e){return t instanceof Le?function(r,i){return i instanceof Le&&r.op===i.op&&r.field.isEqual(i.field)&&xr(r.value,i.value)}(t,e):t instanceof Je?function(r,i){return i instanceof Je&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&TA(o,i.filters[a]),!0):!1}(t,e):void fe(19439)}function EA(t,e){const n=t.filters.concat(e);return Je.create(n,t.op)}function IA(t){return t instanceof Le?function(n){return`${n.field.canonicalString()} ${n.op} ${Pa(n.value)}`}(t):t instanceof Je?function(n){return n.op.toString()+" {"+n.getFilters().map(IA).join(" ,")+"}"}(t):"Filter"}class HU extends Le{constructor(e,n,r){super(e,n,r),this.key=oe.fromName(r.referenceValue)}matches(e){const n=oe.comparator(e.key,this.key);return this.matchesComparison(n)}}class WU extends Le{constructor(e,n){super(e,"in",n),this.keys=wA("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class jU extends Le{constructor(e,n){super(e,"not-in",n),this.keys=wA("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function wA(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(r=>oe.fromName(r.referenceValue))}class KU extends Le{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return bu(n)&&Nu(n.arrayValue,this.value)}}class SA extends Le{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Nu(this.value.arrayValue,n)}}class JU extends Le{constructor(e,n){super(e,"not-in",n)}matches(e){if(Nu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Nu(this.value.arrayValue,n)}}class QU extends Le{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!bu(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Nu(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YU{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.Te=null}}function jm(t,e=null,n=[],r=[],i=null,s=null,o=null){return new YU(t,e,n,r,i,s,o)}function oo(t){const e=Ae(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Wm(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),of(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Pa(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Pa(r)).join(",")),e.Te=n}return e.Te}function Ju(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!$U(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!TA(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!WE(t.startAt,e.startAt)&&WE(t.endAt,e.endAt)}function Th(t){return oe.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function Eh(t,e){return t.filters.filter(n=>n instanceof Le&&n.field.isEqual(e))}function jE(t,e,n){let r=Ad,i=!0;for(const s of Eh(t,e)){let o=Ad,a=!0;switch(s.op){case"<":case"<=":o=qU(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=Ad}zE({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];zE({value:r,inclusive:i},{value:o,inclusive:n.inclusive})<0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}function KE(t,e,n){let r=Di,i=!0;for(const s of Eh(t,e)){let o=Di,a=!0;switch(s.op){case">=":case">":o=zU(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=Di}$E({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];$E({value:r,inclusive:i},{value:o,inclusive:n.inclusive})>0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qu{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function XU(t,e,n,r,i,s,o,a){return new Qu(t,e,n,r,i,s,o,a)}function Yu(t){return new Qu(t)}function JE(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function CA(t){return t.collectionGroup!==null}function eu(t){const e=Ae(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Ye(at.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(u=>{u.isInequality()&&(a=a.add(u.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new vh(s,r))}),n.has(at.keyField().canonicalString())||e.Ie.push(new vh(at.keyField(),r))}return e.Ie}function Wn(t){const e=Ae(t);return e.Ee||(e.Ee=ZU(e,eu(t))),e.Ee}function ZU(t,e){if(t.limitType==="F")return jm(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new vh(i.field,s)});const n=t.endAt?new ka(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new ka(t.startAt.position,t.startAt.inclusive):null;return jm(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Km(t,e){const n=t.filters.concat([e]);return new Qu(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Jm(t,e,n){return new Qu(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function hf(t,e){return Ju(Wn(t),Wn(e))&&t.limitType===e.limitType}function AA(t){return`${oo(Wn(t))}|lt:${t.limitType}`}function Fo(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>IA(i)).join(", ")}]`),of(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>Pa(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>Pa(i)).join(",")),`Target(${r})`}(Wn(t))}; limitType=${t.limitType})`}function Xu(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):oe.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of eu(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,a,l){const u=HE(o,a,l);return o.inclusive?u<=0:u<0}(r.startAt,eu(r),i)||r.endAt&&!function(o,a,l){const u=HE(o,a,l);return o.inclusive?u>=0:u>0}(r.endAt,eu(r),i))}(t,e)}function e4(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function xA(t){return(e,n)=>{let r=!1;for(const i of eu(t)){const s=t4(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function t4(t,e,n){const r=t.field.isKeyField()?oe.comparator(e.key,n.key):function(s,o,a){const l=o.data.field(s),u=a.data.field(s);return l!==null&&u!==null?es(l,u):fe(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return fe(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ii{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){ls(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return lA(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n4=new lt(oe.comparator);function Pn(){return n4}const RA=new lt(oe.comparator);function Dl(...t){let e=RA;for(const n of t)e=e.insert(n.key,n);return e}function PA(t){let e=RA;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Er(){return tu()}function kA(){return tu()}function tu(){return new ii(t=>t.toString(),(t,e)=>t.isEqual(e))}const r4=new lt(oe.comparator),i4=new Ye(oe.comparator);function ke(...t){let e=i4;for(const n of t)e=e.add(n);return e}const s4=new Ye(Ce);function o4(){return s4}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L_(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Au(e)?"-0":e}}function NA(t){return{integerValue:""+t}}function a4(t,e){return fU(e)?NA(e):L_(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ff{constructor(){this._=void 0}}function l4(t,e,n){return t instanceof Da?function(i,s){const o={fields:{[dA]:{stringValue:cA},[fA]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&D_(s)&&(s=cf(s)),s&&(o.fields[hA]=s),{mapValue:o}}(n,e):t instanceof ba?bA(t,e):t instanceof Ma?MA(t,e):function(i,s){const o=DA(i,s),a=QE(o)+QE(i.Ae);return $m(o)&&$m(i.Ae)?NA(a):L_(i.serializer,a)}(t,e)}function u4(t,e,n){return t instanceof ba?bA(t,e):t instanceof Ma?MA(t,e):n}function DA(t,e){return t instanceof Mu?function(r){return $m(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class Da extends ff{}class ba extends ff{constructor(e){super(),this.elements=e}}function bA(t,e){const n=VA(e);for(const r of t.elements)n.some(i=>xr(i,r))||n.push(r);return{arrayValue:{values:n}}}class Ma extends ff{constructor(e){super(),this.elements=e}}function MA(t,e){let n=VA(e);for(const r of t.elements)n=n.filter(i=>!xr(i,r));return{arrayValue:{values:n}}}class Mu extends ff{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function QE(t){return st(t.integerValue||t.doubleValue)}function VA(t){return bu(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LA{constructor(e,n){this.field=e,this.transform=n}}function c4(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof ba&&i instanceof ba||r instanceof Ma&&i instanceof Ma?wa(r.elements,i.elements,xr):r instanceof Mu&&i instanceof Mu?xr(r.Ae,i.Ae):r instanceof Da&&i instanceof Da}(t.transform,e.transform)}class d4{constructor(e,n){this.version=e,this.transformResults=n}}class on{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new on}static exists(e){return new on(void 0,e)}static updateTime(e){return new on(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Pd(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class pf{}function FA(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new mf(t.key,on.none()):new ja(t.key,t.data,on.none());{const n=t.data,r=Xt.empty();let i=new Ye(at.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new si(t.key,r,new mn(i.toArray()),on.none())}}function h4(t,e,n){t instanceof ja?function(i,s,o){const a=i.value.clone(),l=XE(i.fieldTransforms,s,o.transformResults);a.setAll(l),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof si?function(i,s,o){if(!Pd(i.precondition,s))return void s.convertToUnknownDocument(o.version);const a=XE(i.fieldTransforms,s,o.transformResults),l=s.data;l.setAll(UA(i)),l.setAll(a),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function nu(t,e,n,r){return t instanceof ja?function(s,o,a,l){if(!Pd(s.precondition,o))return a;const u=s.value.clone(),f=ZE(s.fieldTransforms,l,o);return u.setAll(f),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,n,r):t instanceof si?function(s,o,a,l){if(!Pd(s.precondition,o))return a;const u=ZE(s.fieldTransforms,l,o),f=o.data;return f.setAll(UA(s)),f.setAll(u),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(m=>m.field))}(t,e,n,r):function(s,o,a){return Pd(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function f4(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=DA(r.transform,i||null);s!=null&&(n===null&&(n=Xt.empty()),n.set(r.field,s))}return n||null}function YE(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&wa(r,i,(s,o)=>c4(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class ja extends pf{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class si extends pf{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function UA(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function XE(t,e,n){const r=new Map;ye(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,u4(o,a,n[i]))}return r}function ZE(t,e,n){const r=new Map;for(const i of t){const s=i.transform,o=n.data.field(i.field);r.set(i.field,l4(s,o,e))}return r}class mf extends pf{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class OA extends pf{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F_{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&h4(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=nu(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=nu(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=kA();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;const l=FA(o,a);l!==null&&r.set(i.key,l),o.isValidDocument()||o.convertToNoDocument(Te.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),ke())}isEqual(e){return this.batchId===e.batchId&&wa(this.mutations,e.mutations,(n,r)=>YE(n,r))&&wa(this.baseMutations,e.baseMutations,(n,r)=>YE(n,r))}}class U_{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){ye(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=function(){return r4}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new U_(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O_{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p4{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ct,Oe;function m4(t){switch(t){case J.OK:return fe(64938);case J.CANCELLED:case J.UNKNOWN:case J.DEADLINE_EXCEEDED:case J.RESOURCE_EXHAUSTED:case J.INTERNAL:case J.UNAVAILABLE:case J.UNAUTHENTICATED:return!1;case J.INVALID_ARGUMENT:case J.NOT_FOUND:case J.ALREADY_EXISTS:case J.PERMISSION_DENIED:case J.FAILED_PRECONDITION:case J.ABORTED:case J.OUT_OF_RANGE:case J.UNIMPLEMENTED:case J.DATA_LOSS:return!0;default:return fe(15467,{code:t})}}function BA(t){if(t===void 0)return sn("GRPC error has no .code"),J.UNKNOWN;switch(t){case Ct.OK:return J.OK;case Ct.CANCELLED:return J.CANCELLED;case Ct.UNKNOWN:return J.UNKNOWN;case Ct.DEADLINE_EXCEEDED:return J.DEADLINE_EXCEEDED;case Ct.RESOURCE_EXHAUSTED:return J.RESOURCE_EXHAUSTED;case Ct.INTERNAL:return J.INTERNAL;case Ct.UNAVAILABLE:return J.UNAVAILABLE;case Ct.UNAUTHENTICATED:return J.UNAUTHENTICATED;case Ct.INVALID_ARGUMENT:return J.INVALID_ARGUMENT;case Ct.NOT_FOUND:return J.NOT_FOUND;case Ct.ALREADY_EXISTS:return J.ALREADY_EXISTS;case Ct.PERMISSION_DENIED:return J.PERMISSION_DENIED;case Ct.FAILED_PRECONDITION:return J.FAILED_PRECONDITION;case Ct.ABORTED:return J.ABORTED;case Ct.OUT_OF_RANGE:return J.OUT_OF_RANGE;case Ct.UNIMPLEMENTED:return J.UNIMPLEMENTED;case Ct.DATA_LOSS:return J.DATA_LOSS;default:return fe(39323,{code:t})}}(Oe=Ct||(Ct={}))[Oe.OK=0]="OK",Oe[Oe.CANCELLED=1]="CANCELLED",Oe[Oe.UNKNOWN=2]="UNKNOWN",Oe[Oe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Oe[Oe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Oe[Oe.NOT_FOUND=5]="NOT_FOUND",Oe[Oe.ALREADY_EXISTS=6]="ALREADY_EXISTS",Oe[Oe.PERMISSION_DENIED=7]="PERMISSION_DENIED",Oe[Oe.UNAUTHENTICATED=16]="UNAUTHENTICATED",Oe[Oe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Oe[Oe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Oe[Oe.ABORTED=10]="ABORTED",Oe[Oe.OUT_OF_RANGE=11]="OUT_OF_RANGE",Oe[Oe.UNIMPLEMENTED=12]="UNIMPLEMENTED",Oe[Oe.INTERNAL=13]="INTERNAL",Oe[Oe.UNAVAILABLE=14]="UNAVAILABLE",Oe[Oe.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g4(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _4=new $i([4294967295,4294967295],0);function eI(t){const e=g4().encode(t),n=new M0;return n.update(e),new Uint8Array(n.digest())}function tI(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new $i([n,r],0),new $i([i,s],0)]}class B_{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new bl(`Invalid padding: ${n}`);if(r<0)throw new bl(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new bl(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new bl(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=$i.fromNumber(this.ge)}ye(e,n,r){let i=e.add(n.multiply($i.fromNumber(r)));return i.compare(_4)===1&&(i=new $i([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=eI(e),[r,i]=tI(n);for(let s=0;s<this.hashCount;s++){const o=this.ye(r,i,s);if(!this.we(o))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new B_(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.ge===0)return;const n=eI(e),[r,i]=tI(n);for(let s=0;s<this.hashCount;s++){const o=this.ye(r,i,s);this.Se(o)}}Se(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class bl extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gf{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,Zu.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new gf(Te.min(),i,new lt(Ce),Pn(),ke())}}class Zu{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Zu(r,n,ke(),ke(),ke())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kd{constructor(e,n,r,i){this.be=e,this.removedTargetIds=n,this.key=r,this.De=i}}class GA{constructor(e,n){this.targetId=e,this.Ce=n}}class qA{constructor(e,n,r=Et.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class nI{constructor(){this.ve=0,this.Fe=rI(),this.Me=Et.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=ke(),n=ke(),r=ke();return this.Fe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:fe(38017,{changeType:s})}}),new Zu(this.Me,this.xe,e,n,r)}qe(){this.Oe=!1,this.Fe=rI()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,ye(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class y4{constructor(e){this.Ge=e,this.ze=new Map,this.je=Pn(),this.Je=Xc(),this.He=Xc(),this.Ye=new lt(Ce)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:fe(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((r,i)=>{this.rt(i)&&n(i)})}st(e){const n=e.targetId,r=e.Ce.count,i=this.ot(n);if(i){const s=i.target;if(Th(s))if(r===0){const o=new oe(s.path);this.et(n,o,yt.newNoDocument(o,Te.min()))}else ye(r===1,20013,{expectedCount:r});else{const o=this._t(n);if(o!==r){const a=this.ut(e),l=a?this.ct(a,e,o):1;if(l!==0){this.it(n);const u=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,u)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let o,a;try{o=ei(r).toUint8Array()}catch(l){if(l instanceof uA)return Yi("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new B_(o,i,s)}catch(l){return Yi(l instanceof bl?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.ge===0?null:a}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.et(n,s,null),i++)}),i}Tt(e){const n=new Map;this.ze.forEach((s,o)=>{const a=this.ot(o);if(a){if(s.current&&Th(a.target)){const l=new oe(a.target.path);this.It(l).has(o)||this.Et(o,l)||this.et(o,l,yt.newNoDocument(l,e))}s.Be&&(n.set(o,s.ke()),s.qe())}});let r=ke();this.He.forEach((s,o)=>{let a=!0;o.forEachWhile(l=>{const u=this.ot(l);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.je.forEach((s,o)=>o.setReadTime(e));const i=new gf(e,n,this.Ye,this.je,r);return this.je=Pn(),this.Je=Xc(),this.He=Xc(),this.Ye=new lt(Ce),i}Xe(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,r),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,n)?i.Qe(n,1):i.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new nI,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new Ye(Ce),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new Ye(Ce),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||Z("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new nI),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function Xc(){return new lt(oe.comparator)}function rI(){return new lt(oe.comparator)}const v4={asc:"ASCENDING",desc:"DESCENDING"},T4={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},E4={and:"AND",or:"OR"};class I4{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Qm(t,e){return t.useProto3Json||of(e)?e:{value:e}}function Va(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function zA(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function w4(t,e){return Va(t,e.toTimestamp())}function un(t){return ye(!!t,49232),Te.fromTimestamp(function(n){const r=Zr(n);return new We(r.seconds,r.nanos)}(t))}function G_(t,e){return Ym(t,e).canonicalString()}function Ym(t,e){const n=function(i){return new ze(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function $A(t){const e=ze.fromString(t);return ye(ZA(e),10190,{key:e.toString()}),e}function Ih(t,e){return G_(t.databaseId,e.path)}function Js(t,e){const n=$A(e);if(n.get(1)!==t.databaseId.projectId)throw new re(J.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new re(J.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new oe(jA(n))}function HA(t,e){return G_(t.databaseId,e)}function WA(t){const e=$A(t);return e.length===4?ze.emptyPath():jA(e)}function Xm(t){return new ze(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function jA(t){return ye(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function iI(t,e,n){return{name:Ih(t,e),fields:n.value.mapValue.fields}}function S4(t,e,n){const r=Js(t,e.name),i=un(e.updateTime),s=e.createTime?un(e.createTime):Te.min(),o=new Xt({mapValue:{fields:e.fields}}),a=yt.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function C4(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:fe(39313,{state:u})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(u,f){return u.useProto3Json?(ye(f===void 0||typeof f=="string",58123),Et.fromBase64String(f||"")):(ye(f===void 0||f instanceof Buffer||f instanceof Uint8Array,16193),Et.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(u){const f=u.code===void 0?J.UNKNOWN:BA(u.code);return new re(f,u.message||"")}(o);n=new qA(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Js(t,r.document.name),s=un(r.document.updateTime),o=r.document.createTime?un(r.document.createTime):Te.min(),a=new Xt({mapValue:{fields:r.document.fields}}),l=yt.newFoundDocument(i,s,o,a),u=r.targetIds||[],f=r.removedTargetIds||[];n=new kd(u,f,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Js(t,r.document),s=r.readTime?un(r.readTime):Te.min(),o=yt.newNoDocument(i,s),a=r.removedTargetIds||[];n=new kd([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Js(t,r.document),s=r.removedTargetIds||[];n=new kd([],s,i,null)}else{if(!("filter"in e))return fe(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new p4(i,s),a=r.targetId;n=new GA(a,o)}}return n}function wh(t,e){let n;if(e instanceof ja)n={update:iI(t,e.key,e.value)};else if(e instanceof mf)n={delete:Ih(t,e.key)};else if(e instanceof si)n={update:iI(t,e.key,e.data),updateMask:N4(e.fieldMask)};else{if(!(e instanceof OA))return fe(16599,{Vt:e.type});n={verify:Ih(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const a=o.transform;if(a instanceof Da)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof ba)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Ma)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Mu)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw fe(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:w4(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:fe(27497)}(t,e.precondition)),n}function Zm(t,e){const n=e.currentDocument?function(s){return s.updateTime!==void 0?on.updateTime(un(s.updateTime)):s.exists!==void 0?on.exists(s.exists):on.none()}(e.currentDocument):on.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let l=null;if("setToServerValue"in a)ye(a.setToServerValue==="REQUEST_TIME",16630,{proto:a}),l=new Da;else if("appendMissingElements"in a){const f=a.appendMissingElements.values||[];l=new ba(f)}else if("removeAllFromArray"in a){const f=a.removeAllFromArray.values||[];l=new Ma(f)}else"increment"in a?l=new Mu(o,a.increment):fe(16584,{proto:a});const u=at.fromServerFormat(a.fieldPath);return new LA(u,l)}(t,i)):[];if(e.update){e.update.name;const i=Js(t,e.update.name),s=new Xt({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(l){const u=l.fieldPaths||[];return new mn(u.map(f=>at.fromServerFormat(f)))}(e.updateMask);return new si(i,s,o,n,r)}return new ja(i,s,n,r)}if(e.delete){const i=Js(t,e.delete);return new mf(i,n)}if(e.verify){const i=Js(t,e.verify);return new OA(i,n)}return fe(1463,{proto:e})}function A4(t,e){return t&&t.length>0?(ye(e!==void 0,14353),t.map(n=>function(i,s){let o=i.updateTime?un(i.updateTime):un(s);return o.isEqual(Te.min())&&(o=un(s)),new d4(o,i.transformResults||[])}(n,e))):[]}function KA(t,e){return{documents:[HA(t,e.path)]}}function JA(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=HA(t,i);const s=function(u){if(u.length!==0)return XA(Je.create(u,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const o=function(u){if(u.length!==0)return u.map(f=>function(g){return{field:Uo(g.field),direction:R4(g.dir)}}(f))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=Qm(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{ft:n,parent:i}}function QA(t){let e=WA(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){ye(r===1,65062);const f=n.from[0];f.allDescendants?i=f.collectionId:e=e.child(f.collectionId)}let s=[];n.where&&(s=function(m){const g=YA(m);return g instanceof Je&&V_(g)?g.getFilters():[g]}(n.where));let o=[];n.orderBy&&(o=function(m){return m.map(g=>function(T){return new vh(Oo(T.field),function(D){switch(D){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(T.direction))}(g))}(n.orderBy));let a=null;n.limit&&(a=function(m){let g;return g=typeof m=="object"?m.value:m,of(g)?null:g}(n.limit));let l=null;n.startAt&&(l=function(m){const g=!!m.before,v=m.values||[];return new ka(v,g)}(n.startAt));let u=null;return n.endAt&&(u=function(m){const g=!m.before,v=m.values||[];return new ka(v,g)}(n.endAt)),XU(e,i,o,s,a,"F",l,u)}function x4(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return fe(28987,{purpose:i})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function YA(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Oo(n.unaryFilter.field);return Le.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Oo(n.unaryFilter.field);return Le.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Oo(n.unaryFilter.field);return Le.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Oo(n.unaryFilter.field);return Le.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return fe(61313);default:return fe(60726)}}(t):t.fieldFilter!==void 0?function(n){return Le.create(Oo(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return fe(58110);default:return fe(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Je.create(n.compositeFilter.filters.map(r=>YA(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return fe(1026)}}(n.compositeFilter.op))}(t):fe(30097,{filter:t})}function R4(t){return v4[t]}function P4(t){return T4[t]}function k4(t){return E4[t]}function Uo(t){return{fieldPath:t.canonicalString()}}function Oo(t){return at.fromServerFormat(t.fieldPath)}function XA(t){return t instanceof Le?function(n){if(n.op==="=="){if(qE(n.value))return{unaryFilter:{field:Uo(n.field),op:"IS_NAN"}};if(GE(n.value))return{unaryFilter:{field:Uo(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(qE(n.value))return{unaryFilter:{field:Uo(n.field),op:"IS_NOT_NAN"}};if(GE(n.value))return{unaryFilter:{field:Uo(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Uo(n.field),op:P4(n.op),value:n.value}}}(t):t instanceof Je?function(n){const r=n.getFilters().map(i=>XA(i));return r.length===1?r[0]:{compositeFilter:{op:k4(n.op),filters:r}}}(t):fe(54877,{filter:t})}function N4(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function ZA(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $r{constructor(e,n,r,i,s=Te.min(),o=Te.min(),a=Et.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new $r(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new $r(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new $r(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new $r(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ex{constructor(e){this.yt=e}}function D4(t,e){let n;if(e.document)n=S4(t.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=oe.fromSegments(e.noDocument.path),i=lo(e.noDocument.readTime);n=yt.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return fe(56709);{const r=oe.fromSegments(e.unknownDocument.path),i=lo(e.unknownDocument.version);n=yt.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){const s=new We(i[0],i[1]);return Te.fromTimestamp(s)}(e.readTime)),n}function sI(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Sh(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:Ih(s,o.key),fields:o.data.value.mapValue.fields,updateTime:Va(s,o.version.toTimestamp()),createTime:Va(s,o.createTime.toTimestamp())}}(t.yt,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:ao(e.version)};else{if(!e.isUnknownDocument())return fe(57904,{document:e});r.unknownDocument={path:n.path.toArray(),version:ao(e.version)}}return r}function Sh(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function ao(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function lo(t){const e=new We(t.seconds,t.nanoseconds);return Te.fromTimestamp(e)}function Ls(t,e){const n=(e.baseMutations||[]).map(s=>Zm(t.yt,s));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map(s=>Zm(t.yt,s)),i=We.fromMillis(e.localWriteTimeMs);return new F_(e.batchId,i,n,r)}function Ml(t){const e=lo(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?lo(t.lastLimboFreeSnapshotVersion):Te.min();let r;return r=function(s){return s.documents!==void 0}(t.query)?function(s){const o=s.documents.length;return ye(o===1,1966,{count:o}),Wn(Yu(WA(s.documents[0])))}(t.query):function(s){return Wn(QA(s))}(t.query),new $r(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,Et.fromBase64String(t.resumeToken))}function tx(t,e){const n=ao(e.snapshotVersion),r=ao(e.lastLimboFreeSnapshotVersion);let i;i=Th(e.target)?KA(t.yt,e.target):JA(t.yt,e.target).ft;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:oo(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function nx(t){const e=QA({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Jm(e,e.limit,"L"):e}function Tp(t,e){return new O_(e.largestBatchId,Zm(t.yt,e.overlayMutation))}function oI(t,e){const n=e.path.lastSegment();return[t,en(e.path.popLast()),n]}function aI(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:ao(r.readTime),documentKey:en(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b4{getBundleMetadata(e,n){return lI(e).get(n).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:lo(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,n){return lI(e).put(function(i){return{bundleId:i.id,createTime:ao(un(i.createTime)),version:i.version}}(n))}getNamedQuery(e,n){return uI(e).get(n).next(r=>{if(r)return function(s){return{name:s.name,query:nx(s.bundledQuery),readTime:lo(s.readTime)}}(r)})}saveNamedQuery(e,n){return uI(e).put(function(i){return{name:i.name,readTime:ao(un(i.readTime)),bundledQuery:i.bundledQuery}}(n))}}function lI(t){return Mt(t,af)}function uI(t){return Mt(t,lf)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _f{constructor(e,n){this.serializer=e,this.userId=n}static wt(e,n){const r=n.uid||"";return new _f(e,r)}getOverlay(e,n){return Il(e).get(oI(this.userId,n)).next(r=>r?Tp(this.serializer,r):null)}getOverlays(e,n){const r=Er();return G.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){const i=[];return r.forEach((s,o)=>{const a=new O_(n,o);i.push(this.St(e,a))}),G.waitFor(i)}removeOverlaysForBatchId(e,n,r){const i=new Set;n.forEach(o=>i.add(en(o.getCollectionPath())));const s=[];return i.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(Il(e).Z(Gm,a))}),G.waitFor(s)}getOverlaysForCollection(e,n,r){const i=Er(),s=en(n),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Il(e).J(Gm,o).next(a=>{for(const l of a){const u=Tp(this.serializer,l);i.set(u.getKey(),u)}return i})}getOverlaysForCollectionGroup(e,n,r,i){const s=Er();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return Il(e).ee({index:rA,range:a},(l,u,f)=>{const m=Tp(this.serializer,u);s.size()<i||m.largestBatchId===o?(s.set(m.getKey(),m),o=m.largestBatchId):f.done()}).next(()=>s)}St(e,n){return Il(e).put(function(i,s,o){const[a,l,u]=oI(s,o.mutation.key);return{userId:s,collectionPath:l,documentId:u,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:wh(i.yt,o.mutation)}}(this.serializer,this.userId,n))}}function Il(t){return Mt(t,uf)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M4{bt(e){return Mt(e,k_)}getSessionToken(e){return this.bt(e).get("sessionToken").next(n=>{const r=n==null?void 0:n.value;return r?Et.fromUint8Array(r):Et.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.bt(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fs{constructor(){}Dt(e,n){this.Ct(e,n),n.vt()}Ct(e,n){if("nullValue"in e)this.Ft(n,5);else if("booleanValue"in e)this.Ft(n,10),n.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(n,15),n.Mt(st(e.integerValue));else if("doubleValue"in e){const r=st(e.doubleValue);isNaN(r)?this.Ft(n,13):(this.Ft(n,15),Au(r)?n.Mt(0):n.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(n,20),typeof r=="string"&&(r=Zr(r)),n.xt(`${r.seconds||""}`),n.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,n),this.Nt(n);else if("bytesValue"in e)this.Ft(n,30),n.Bt(ei(e.bytesValue)),this.Nt(n);else if("referenceValue"in e)this.Lt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(n,45),n.Mt(r.latitude||0),n.Mt(r.longitude||0)}else"mapValue"in e?mA(e)?this.Ft(n,Number.MAX_SAFE_INTEGER):df(e)?this.kt(e.mapValue,n):(this.qt(e.mapValue,n),this.Nt(n)):"arrayValue"in e?(this.Qt(e.arrayValue,n),this.Nt(n)):fe(19022,{$t:e})}Ot(e,n){this.Ft(n,25),this.Ut(e,n)}Ut(e,n){n.xt(e)}qt(e,n){const r=e.fields||{};this.Ft(n,55);for(const i of Object.keys(r))this.Ot(i,n),this.Ct(r[i],n)}kt(e,n){var o,a;const r=e.fields||{};this.Ft(n,53);const i=Ra,s=((a=(o=r[i].arrayValue)==null?void 0:o.values)==null?void 0:a.length)||0;this.Ft(n,15),n.Mt(st(s)),this.Ot(i,n),this.Ct(r[i],n)}Qt(e,n){const r=e.values||[];this.Ft(n,50);for(const i of r)this.Ct(i,n)}Lt(e,n){this.Ft(n,37),oe.fromName(e).path.forEach(r=>{this.Ft(n,60),this.Ut(r,n)})}Ft(e,n){e.Mt(n)}Nt(e){e.Mt(2)}}Fs.Kt=new Fs;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Do=255;function V4(t){if(t===0)return 8;let e=0;return t>>4||(e+=4,t<<=4),t>>6||(e+=2,t<<=2),t>>7||(e+=1),e}function cI(t){const e=64-function(r){let i=0;for(let s=0;s<8;++s){const o=V4(255&r[s]);if(i+=o,o!==8)break}return i}(t);return Math.ceil(e/8)}class L4{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Gt(r.value),r=n.next();this.zt()}jt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Jt(r.value),r=n.next();this.Ht()}Yt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const i=n.codePointAt(0);this.Gt(240|i>>>18),this.Gt(128|63&i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i)}}this.zt()}Zt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const i=n.codePointAt(0);this.Jt(240|i>>>18),this.Jt(128|63&i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i)}}this.Ht()}Xt(e){const n=this.en(e),r=cI(n);this.tn(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}nn(e){const n=this.en(e),r=cI(n);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}rn(){this.sn(Do),this.sn(255)}_n(){this.an(Do),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const n=function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=!!(128&n[0]);n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Gt(e){const n=255&e;n===0?(this.sn(0),this.sn(255)):n===Do?(this.sn(Do),this.sn(0)):this.sn(n)}Jt(e){const n=255&e;n===0?(this.an(0),this.an(255)):n===Do?(this.an(Do),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class F4{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class U4{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class wl{constructor(){this.cn=new L4,this.ln=new F4(this.cn),this.hn=new U4(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Us{constructor(e,n,r,i){this.Tn=e,this.In=n,this.En=r,this.dn=i}An(){const e=this.dn.length,n=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.dn,0),n!==e?r.set([0],this.dn.length):++r[r.length-1],new Us(this.Tn,this.In,this.En,r)}Rn(e,n,r){return{indexId:this.Tn,uid:e,arrayValue:Nd(this.En),directionalValue:Nd(this.dn),orderedDocumentKey:Nd(n),documentKey:r.path.toArray()}}Vn(e,n,r){const i=this.Rn(e,n,r);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}}function _i(t,e){let n=t.Tn-e.Tn;return n!==0?n:(n=dI(t.En,e.En),n!==0?n:(n=dI(t.dn,e.dn),n!==0?n:oe.comparator(t.In,e.In)))}function dI(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}function Nd(t){return JC()?function(n){let r="";for(let i=0;i<n.length;i++)r+=String.fromCharCode(n[i]);return r}(t):t}function hI(t){return typeof t!="string"?t:function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(t)}class fI{constructor(e){this.mn=new Ye((n,r)=>at.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const n of e.filters){const r=n;r.isInequality()?this.mn=this.mn.add(r):this.gn.push(r)}}get pn(){return this.mn.size>1}yn(e){if(ye(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const n=Um(e);if(n!==void 0&&!this.wn(n))return!1;const r=bs(e);let i=new Set,s=0,o=0;for(;s<r.length&&this.wn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.mn.size>0){const a=this.mn.getIterator().getNext();if(!i.has(a.field.canonicalString())){const l=r[s];if(!this.Sn(a,l)||!this.bn(this.fn[o++],l))return!1}++s}for(;s<r.length;++s){const a=r[s];if(o>=this.fn.length||!this.bn(this.fn[o++],a))return!1}return!0}Dn(){if(this.pn)return null;let e=new Ye(at.comparator);const n=[];for(const r of this.gn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new wd(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new wd(r.field,0))}for(const r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new wd(r.field,r.dir==="asc"?0:1)));return new ph(ph.UNKNOWN_ID,this.collectionId,n,Cu.empty())}wn(e){for(const n of this.gn)if(this.Sn(n,e))return!0;return!1}Sn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}bn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rx(t){var n,r;if(ye(t instanceof Le||t instanceof Je,20012),t instanceof Le){if(t instanceof SA){const i=((r=(n=t.value.arrayValue)==null?void 0:n.values)==null?void 0:r.map(s=>Le.create(t.field,"==",s)))||[];return Je.create(i,"or")}return t}const e=t.filters.map(i=>rx(i));return Je.create(e,t.op)}function O4(t){if(t.getFilters().length===0)return[];const e=ng(rx(t));return ye(ix(e),7391),eg(e)||tg(e)?[e]:e.getFilters()}function eg(t){return t instanceof Le}function tg(t){return t instanceof Je&&V_(t)}function ix(t){return eg(t)||tg(t)||function(n){if(n instanceof Je&&Hm(n)){for(const r of n.getFilters())if(!eg(r)&&!tg(r))return!1;return!0}return!1}(t)}function ng(t){if(ye(t instanceof Le||t instanceof Je,34018),t instanceof Le)return t;if(t.filters.length===1)return ng(t.filters[0]);const e=t.filters.map(r=>ng(r));let n=Je.create(e,t.op);return n=Ch(n),ix(n)?n:(ye(n instanceof Je,64498),ye(Na(n),40251),ye(n.filters.length>1,57927),n.filters.reduce((r,i)=>q_(r,i)))}function q_(t,e){let n;return ye(t instanceof Le||t instanceof Je,38388),ye(e instanceof Le||e instanceof Je,25473),n=t instanceof Le?e instanceof Le?function(i,s){return Je.create([i,s],"and")}(t,e):pI(t,e):e instanceof Le?pI(e,t):function(i,s){if(ye(i.filters.length>0&&s.filters.length>0,48005),Na(i)&&Na(s))return EA(i,s.getFilters());const o=Hm(i)?i:s,a=Hm(i)?s:i,l=o.filters.map(u=>q_(u,a));return Je.create(l,"or")}(t,e),Ch(n)}function pI(t,e){if(Na(e))return EA(e,t.getFilters());{const n=e.filters.map(r=>q_(t,r));return Je.create(n,"or")}}function Ch(t){if(ye(t instanceof Le||t instanceof Je,11850),t instanceof Le)return t;const e=t.getFilters();if(e.length===1)return Ch(e[0]);if(vA(t))return t;const n=e.map(i=>Ch(i)),r=[];return n.forEach(i=>{i instanceof Le?r.push(i):i instanceof Je&&(i.op===t.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:Je.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B4{constructor(){this.Cn=new z_}addToCollectionParentIndex(e,n){return this.Cn.add(n),G.resolve()}getCollectionParents(e,n){return G.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return G.resolve()}deleteFieldIndex(e,n){return G.resolve()}deleteAllFieldIndexes(e){return G.resolve()}createTargetIndexes(e,n){return G.resolve()}getDocumentsMatchingTarget(e,n){return G.resolve(null)}getIndexType(e,n){return G.resolve(0)}getFieldIndexes(e,n){return G.resolve([])}getNextCollectionGroupToUpdate(e){return G.resolve(null)}getMinOffset(e,n){return G.resolve(Dn.min())}getMinOffsetFromCollectionGroup(e,n){return G.resolve(Dn.min())}updateCollectionGroup(e,n,r){return G.resolve()}updateIndexEntries(e,n){return G.resolve()}}class z_{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Ye(ze.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Ye(ze.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mI="IndexedDbIndexManager",Zc=new Uint8Array(0);class G4{constructor(e,n){this.databaseId=n,this.vn=new z_,this.Fn=new ii(r=>oo(r),(r,i)=>Ju(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.vn.has(n)){const r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this.vn.add(n)});const s={collectionId:r,parent:en(i)};return gI(e).put(s)}return G.resolve()}getCollectionParents(e,n){const r=[],i=IDBKeyRange.bound([n,""],[$0(n),""],!1,!0);return gI(e).J(i).next(s=>{for(const o of s){if(o.collectionId!==n)break;r.push(Tr(o.parent))}return r})}addFieldIndex(e,n){const r=Sl(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(l=>[l.fieldPath.canonicalString(),l.kind])}}(n);delete i.indexId;const s=r.add(i);if(n.indexState){const o=Mo(e);return s.next(a=>{o.put(aI(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){const r=Sl(e),i=Mo(e),s=bo(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=Sl(e),r=bo(e),i=Mo(e);return n.Z().next(()=>r.Z()).next(()=>i.Z())}createTargetIndexes(e,n){return G.forEach(this.Mn(n),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){const s=new fI(r).Dn();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,n){const r=bo(e);let i=!0;const s=new Map;return G.forEach(this.Mn(n),o=>this.xn(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=ke();const a=[];return G.forEach(s,(l,u)=>{Z(mI,`Using index ${function(R){return`id=${R.indexId}|cg=${R.collectionGroup}|f=${R.fields.map(V=>`${V.fieldPath}:${V.kind}`).join(",")}`}(l)} to execute ${oo(n)}`);const f=function(R,V){const U=Um(V);if(U===void 0)return null;for(const B of Eh(R,U.fieldPath))switch(B.op){case"array-contains-any":return B.value.arrayValue.values||[];case"array-contains":return[B.value]}return null}(u,l),m=function(R,V){const U=new Map;for(const B of bs(V))for(const E of Eh(R,B.fieldPath))switch(E.op){case"==":case"in":U.set(B.fieldPath.canonicalString(),E.value);break;case"not-in":case"!=":return U.set(B.fieldPath.canonicalString(),E.value),Array.from(U.values())}return null}(u,l),g=function(R,V){const U=[];let B=!0;for(const E of bs(V)){const w=E.kind===0?jE(R,E.fieldPath,R.startAt):KE(R,E.fieldPath,R.startAt);U.push(w.value),B&&(B=w.inclusive)}return new ka(U,B)}(u,l),v=function(R,V){const U=[];let B=!0;for(const E of bs(V)){const w=E.kind===0?KE(R,E.fieldPath,R.endAt):jE(R,E.fieldPath,R.endAt);U.push(w.value),B&&(B=w.inclusive)}return new ka(U,B)}(u,l),T=this.On(l,u,g),P=this.On(l,u,v),D=this.Nn(l,u,m),S=this.Bn(l.indexId,f,T,g.inclusive,P,v.inclusive,D);return G.forEach(S,I=>r.Y(I,n.limit).next(R=>{R.forEach(V=>{const U=oe.fromSegments(V.documentKey);o.has(U)||(o=o.add(U),a.push(U))})}))}).next(()=>a)}return G.resolve(null)})}Mn(e){let n=this.Fn.get(e);return n||(e.filters.length===0?n=[e]:n=O4(Je.create(e.filters,"and")).map(r=>jm(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.Fn.set(e,n),n)}Bn(e,n,r,i,s,o,a){const l=(n!=null?n.length:1)*Math.max(r.length,s.length),u=l/(n!=null?n.length:1),f=[];for(let m=0;m<l;++m){const g=n?this.Ln(n[m/u]):Zc,v=this.kn(e,g,r[m%u],i),T=this.qn(e,g,s[m%u],o),P=a.map(D=>this.kn(e,g,D,!0));f.push(...this.createRange(v,T,P))}return f}kn(e,n,r,i){const s=new Us(e,oe.empty(),n,r);return i?s:s.An()}qn(e,n,r,i){const s=new Us(e,oe.empty(),n,r);return i?s.An():s}xn(e,n){const r=new fI(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(const a of s)r.yn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2;const i=this.Mn(n);return G.forEach(i,s=>this.xn(e,s).next(o=>{o?r!==0&&o.fields.length<function(l){let u=new Ye(at.comparator),f=!1;for(const m of l.filters)for(const g of m.getFlattenedFilters())g.field.isKeyField()||(g.op==="array-contains"||g.op==="array-contains-any"?f=!0:u=u.add(g.field));for(const m of l.orderBy)m.field.isKeyField()||(u=u.add(m.field));return u.size+(f?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&i.length>1&&r===2?1:r)}Qn(e,n){const r=new wl;for(const i of bs(e)){const s=n.data.field(i.fieldPath);if(s==null)return null;const o=r.Pn(i.kind);Fs.Kt.Dt(s,o)}return r.un()}Ln(e){const n=new wl;return Fs.Kt.Dt(e,n.Pn(0)),n.un()}$n(e,n){const r=new wl;return Fs.Kt.Dt(Du(this.databaseId,n),r.Pn(function(s){const o=bs(s);return o.length===0?0:o[o.length-1].kind}(e))),r.un()}Nn(e,n,r){if(r===null)return[];let i=[];i.push(new wl);let s=0;for(const o of bs(e)){const a=r[s++];for(const l of i)if(this.Un(n,o.fieldPath)&&bu(a))i=this.Kn(i,o,a);else{const u=l.Pn(o.kind);Fs.Kt.Dt(a,u)}}return this.Wn(i)}On(e,n,r){return this.Nn(e,n,r.position)}Wn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].un();return n}Kn(e,n,r){const i=[...e],s=[];for(const o of r.arrayValue.values||[])for(const a of i){const l=new wl;l.seed(a.un()),Fs.Kt.Dt(o,l.Pn(n.kind)),s.push(l)}return s}Un(e,n){return!!e.filters.find(r=>r instanceof Le&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=Sl(e),i=Mo(e);return(n?r.J(Bm,IDBKeyRange.bound(n,n)):r.J()).next(s=>{const o=[];return G.forEach(s,a=>i.get([a.indexId,this.uid]).next(l=>{o.push(function(f,m){const g=m?new Cu(m.sequenceNumber,new Dn(lo(m.readTime),new oe(Tr(m.documentKey)),m.largestBatchId)):Cu.empty(),v=f.fields.map(([T,P])=>new wd(at.fromServerFormat(T),P));return new ph(f.indexId,f.collectionGroup,v,g)}(a,l))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:Ce(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const i=Sl(e),s=Mo(e);return this.Gn(e).next(o=>i.J(Bm,IDBKeyRange.bound(n,n)).next(a=>G.forEach(a,l=>s.put(aI(l.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){const r=new Map;return G.forEach(n,(i,s)=>{const o=r.get(i.collectionGroup);return(o?G.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),G.forEach(a,l=>this.zn(e,i,l).next(u=>{const f=this.jn(s,l);return u.isEqual(f)?G.resolve():this.Jn(e,s,l,u,f)}))))})}Hn(e,n,r,i){return bo(e).put(i.Rn(this.uid,this.$n(r,n.key),n.key))}Yn(e,n,r,i){return bo(e).delete(i.Vn(this.uid,this.$n(r,n.key),n.key))}zn(e,n,r){const i=bo(e);let s=new Ye(_i);return i.ee({index:nA,range:IDBKeyRange.only([r.indexId,this.uid,Nd(this.$n(r,n))])},(o,a)=>{s=s.add(new Us(r.indexId,n,hI(a.arrayValue),hI(a.directionalValue)))}).next(()=>s)}jn(e,n){let r=new Ye(_i);const i=this.Qn(n,e);if(i==null)return r;const s=Um(n);if(s!=null){const o=e.data.field(s.fieldPath);if(bu(o))for(const a of o.arrayValue.values||[])r=r.add(new Us(n.indexId,e.key,this.Ln(a),i))}else r=r.add(new Us(n.indexId,e.key,Zc,i));return r}Jn(e,n,r,i,s){Z(mI,"Updating index entries for document '%s'",n.key);const o=[];return function(l,u,f,m,g){const v=l.getIterator(),T=u.getIterator();let P=No(v),D=No(T);for(;P||D;){let S=!1,I=!1;if(P&&D){const R=f(P,D);R<0?I=!0:R>0&&(S=!0)}else P!=null?I=!0:S=!0;S?(m(D),D=No(T)):I?(g(P),P=No(v)):(P=No(v),D=No(T))}}(i,s,_i,a=>{o.push(this.Hn(e,n,r,a))},a=>{o.push(this.Yn(e,n,r,a))}),G.waitFor(o)}Gn(e){let n=1;return Mo(e).ee({index:tA,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>_i(o,a)).filter((o,a,l)=>!a||_i(o,l[a-1])!==0);const i=[];i.push(e);for(const o of r){const a=_i(o,e),l=_i(o,n);if(a===0)i[0]=e.An();else if(a>0&&l<0)i.push(o),i.push(o.An());else if(l>0)break}i.push(n);const s=[];for(let o=0;o<i.length;o+=2){if(this.Zn(i[o],i[o+1]))return[];const a=i[o].Vn(this.uid,Zc,oe.empty()),l=i[o+1].Vn(this.uid,Zc,oe.empty());s.push(IDBKeyRange.bound(a,l))}return s}Zn(e,n){return _i(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(_I)}getMinOffset(e,n){return G.mapArray(this.Mn(n),r=>this.xn(e,r).next(i=>i||fe(44426))).next(_I)}}function gI(t){return Mt(t,Pu)}function bo(t){return Mt(t,Xl)}function Sl(t){return Mt(t,P_)}function Mo(t){return Mt(t,Yl)}function _I(t){ye(t.length!==0,28825);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const i=t[r].indexState.offset;A_(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new Dn(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yI={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},sx=41943040;class Qt{static withCacheSize(e){return new Qt(e,Qt.DEFAULT_COLLECTION_PERCENTILE,Qt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ox(t,e,n){const r=t.store(Zn),i=t.store(Sa),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const l=r.ee({range:o},(f,m,g)=>(a++,g.delete()));s.push(l.next(()=>{ye(a===1,47070,{batchId:n.batchId})}));const u=[];for(const f of n.mutations){const m=X0(e,f.key.path,n.batchId);s.push(i.delete(m)),u.push(f.key)}return G.waitFor(s).next(()=>u)}function Ah(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw fe(14731);e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Qt.DEFAULT_COLLECTION_PERCENTILE=10,Qt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Qt.DEFAULT=new Qt(sx,Qt.DEFAULT_COLLECTION_PERCENTILE,Qt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Qt.DISABLED=new Qt(-1,0,0);class yf{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Xn={}}static wt(e,n,r,i){ye(e.uid!=="",64387);const s=e.isAuthenticated()?e.uid:"";return new yf(s,n,r,i)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return yi(e).ee({index:zs,range:r},(i,s,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,i){const s=Bo(e),o=yi(e);return o.add({}).next(a=>{ye(typeof a=="number",49019);const l=new F_(a,n,r,i),u=function(v,T,P){const D=P.baseMutations.map(I=>wh(v.yt,I)),S=P.mutations.map(I=>wh(v.yt,I));return{userId:T,batchId:P.batchId,localWriteTimeMs:P.localWriteTime.toMillis(),baseMutations:D,mutations:S}}(this.serializer,this.userId,l),f=[];let m=new Ye((g,v)=>Ce(g.canonicalString(),v.canonicalString()));for(const g of i){const v=X0(this.userId,g.key.path,a);m=m.add(g.key.path.popLast()),f.push(o.put(u)),f.push(s.put(v,gU))}return m.forEach(g=>{f.push(this.indexManager.addToCollectionParentIndex(e,g))}),e.addOnCommittedListener(()=>{this.Xn[a]=l.keys()}),G.waitFor(f).next(()=>l)})}lookupMutationBatch(e,n){return yi(e).get(n).next(r=>r?(ye(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:n}),Ls(this.serializer,r)):null)}er(e,n){return this.Xn[n]?G.resolve(this.Xn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const i=r.keys();return this.Xn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return yi(e).ee({index:zs,range:i},(o,a,l)=>{a.userId===this.userId&&(ye(a.batchId>=r,47524,{tr:r}),s=Ls(this.serializer,a)),l.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=js;return yi(e).ee({index:zs,range:n,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,js],[this.userId,Number.POSITIVE_INFINITY]);return yi(e).J(zs,n).next(r=>r.map(i=>Ls(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=Sd(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return Bo(e).ee({range:i},(o,a,l)=>{const[u,f,m]=o,g=Tr(f);if(u===this.userId&&n.path.isEqual(g))return yi(e).get(m).next(v=>{if(!v)throw fe(61480,{nr:o,batchId:m});ye(v.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:v.userId,batchId:m}),s.push(Ls(this.serializer,v))});l.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ye(Ce);const i=[];return n.forEach(s=>{const o=Sd(this.userId,s.path),a=IDBKeyRange.lowerBound(o),l=Bo(e).ee({range:a},(u,f,m)=>{const[g,v,T]=u,P=Tr(v);g===this.userId&&s.path.isEqual(P)?r=r.add(T):m.done()});i.push(l)}),G.waitFor(i).next(()=>this.rr(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1,s=Sd(this.userId,r),o=IDBKeyRange.lowerBound(s);let a=new Ye(Ce);return Bo(e).ee({range:o},(l,u,f)=>{const[m,g,v]=l,T=Tr(g);m===this.userId&&r.isPrefixOf(T)?T.length===i&&(a=a.add(v)):f.done()}).next(()=>this.rr(e,a))}rr(e,n){const r=[],i=[];return n.forEach(s=>{i.push(yi(e).get(s).next(o=>{if(o===null)throw fe(35274,{batchId:s});ye(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:s}),r.push(Ls(this.serializer,o))}))}),G.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return ox(e.le,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.ir(n.batchId)}),G.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return G.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return Bo(e).ee({range:r},(s,o,a)=>{if(s[0]===this.userId){const l=Tr(s[1]);i.push(l)}else a.done()}).next(()=>{ye(i.length===0,56720,{sr:i.map(s=>s.canonicalString())})})})}containsKey(e,n){return ax(e,this.userId,n)}_r(e){return lx(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:js,lastStreamToken:""})}}function ax(t,e,n){const r=Sd(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return Bo(t).ee({range:s,X:!0},(a,l,u)=>{const[f,m,g]=a;f===e&&m===i&&(o=!0),u.done()}).next(()=>o)}function yi(t){return Mt(t,Zn)}function Bo(t){return Mt(t,Sa)}function lx(t){return Mt(t,xu)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uo{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new uo(0)}static cr(){return new uo(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q4{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.lr(e).next(n=>{const r=new uo(n.highestTargetId);return n.highestTargetId=r.next(),this.hr(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.lr(e).next(n=>Te.fromTimestamp(new We(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.lr(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.lr(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.hr(e,i)))}addTargetData(e,n){return this.Pr(e,n).next(()=>this.lr(e).next(r=>(r.targetCount+=1,this.Tr(n,r),this.hr(e,r))))}updateTargetData(e,n){return this.Pr(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>Vo(e).delete(n.targetId)).next(()=>this.lr(e)).next(r=>(ye(r.targetCount>0,8065),r.targetCount-=1,this.hr(e,r)))}removeTargets(e,n,r){let i=0;const s=[];return Vo(e).ee((o,a)=>{const l=Ml(a);l.sequenceNumber<=n&&r.get(l.targetId)===null&&(i++,s.push(this.removeTargetData(e,l)))}).next(()=>G.waitFor(s)).next(()=>i)}forEachTarget(e,n){return Vo(e).ee((r,i)=>{const s=Ml(i);n(s)})}lr(e){return vI(e).get(_h).next(n=>(ye(n!==null,2888),n))}hr(e,n){return vI(e).put(_h,n)}Pr(e,n){return Vo(e).put(tx(this.serializer,n))}Tr(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next(n=>n.targetCount)}getTargetData(e,n){const r=oo(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return Vo(e).ee({range:i,index:eA},(o,a,l)=>{const u=Ml(a);Ju(n,u.target)&&(s=u,l.done())}).next(()=>s)}addMatchingKeys(e,n,r){const i=[],s=Pi(e);return n.forEach(o=>{const a=en(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),G.waitFor(i)}removeMatchingKeys(e,n,r){const i=Pi(e);return G.forEach(n,s=>{const o=en(s.path);return G.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){const r=Pi(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),i=Pi(e);let s=ke();return i.ee({range:r,X:!0},(o,a,l)=>{const u=Tr(o[1]),f=new oe(u);s=s.add(f)}).next(()=>s)}containsKey(e,n){const r=en(n.path),i=IDBKeyRange.bound([r],[$0(r)],!1,!0);let s=0;return Pi(e).ee({index:R_,X:!0,range:i},([o,a],l,u)=>{o!==0&&(s++,u.done())}).next(()=>s>0)}At(e,n){return Vo(e).get(n).next(r=>r?Ml(r):null)}}function Vo(t){return Mt(t,Ca)}function vI(t){return Mt(t,Ks)}function Pi(t){return Mt(t,Aa)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TI="LruGarbageCollector",z4=1048576;function EI([t,e],[n,r]){const i=Ce(t,n);return i===0?Ce(e,r):i}class $4{constructor(e){this.Ir=e,this.buffer=new Ye(EI),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();EI(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class ux{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Z(TI,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){as(n)?Z(TI,"Ignoring IndexedDB error during garbage collection: ",n):await mo(n)}await this.Vr(3e5)})}}class H4{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return G.resolve(zn.ce);const r=new $4(n);return this.mr.forEachTarget(e,i=>r.Ar(i.sequenceNumber)).next(()=>this.mr.pr(e,i=>r.Ar(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.mr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(Z("LruGarbageCollector","Garbage collection skipped; disabled"),G.resolve(yI)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(Z("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),yI):this.yr(e,n))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let r,i,s,o,a,l,u;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(m=>(m>this.params.maximumSequenceNumbersToCollect?(Z("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),i=this.params.maximumSequenceNumbersToCollect):i=m,o=Date.now(),this.nthSequenceNumber(e,i))).next(m=>(r=m,a=Date.now(),this.removeTargets(e,r,n))).next(m=>(s=m,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(m=>(u=Date.now(),Lo()<=Ve.DEBUG&&Z("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-f}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(l-a)+`ms
	Removed ${m} documents in `+(u-l)+`ms
Total Duration: ${u-f}ms`),G.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:m})))}}function cx(t,e){return new H4(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W4{constructor(e,n){this.db=e,this.garbageCollector=cx(this,n)}gr(e){const n=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}pr(e,n){return this.Sr(e,(r,i)=>n(i))}addReference(e,n,r){return ed(e,r)}removeReference(e,n,r){return ed(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return ed(e,n)}br(e,n){return function(i,s){let o=!1;return lx(i).te(a=>ax(i,a,s).next(l=>(l&&(o=!0),G.resolve(!l)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Sr(e,(o,a)=>{if(a<=n){const l=this.br(e,o).next(u=>{if(!u)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,Te.min()),Pi(e).delete(function(m){return[0,en(m.path)]}(o))))});i.push(l)}}).next(()=>G.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return ed(e,n)}Sr(e,n){const r=Pi(e);let i,s=zn.ce;return r.ee({index:R_},([o,a],{path:l,sequenceNumber:u})=>{o===0?(s!==zn.ce&&n(new oe(Tr(i)),s),s=u,i=l):s=zn.ce}).next(()=>{s!==zn.ce&&n(new oe(Tr(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function ed(t,e){return Pi(t).put(function(r,i){return{targetId:0,path:en(r.path),sequenceNumber:i}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dx{constructor(){this.changes=new ii(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,yt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?G.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j4{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return Rs(e).put(r)}removeEntry(e,n,r){return Rs(e).delete(function(s,o){const a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Sh(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.Dr(e,r)))}getEntry(e,n){let r=yt.newInvalidDocument(n);return Rs(e).ee({index:Cd,range:IDBKeyRange.only(Cl(n))},(i,s)=>{r=this.Cr(n,s)}).next(()=>r)}vr(e,n){let r={size:0,document:yt.newInvalidDocument(n)};return Rs(e).ee({index:Cd,range:IDBKeyRange.only(Cl(n))},(i,s)=>{r={document:this.Cr(n,s),size:Ah(s)}}).next(()=>r)}getEntries(e,n){let r=Pn();return this.Fr(e,n,(i,s)=>{const o=this.Cr(i,s);r=r.insert(i,o)}).next(()=>r)}Mr(e,n){let r=Pn(),i=new lt(oe.comparator);return this.Fr(e,n,(s,o)=>{const a=this.Cr(s,o);r=r.insert(s,a),i=i.insert(s,Ah(o))}).next(()=>({documents:r,Or:i}))}Fr(e,n,r){if(n.isEmpty())return G.resolve();let i=new Ye(SI);n.forEach(l=>i=i.add(l));const s=IDBKeyRange.bound(Cl(i.first()),Cl(i.last())),o=i.getIterator();let a=o.getNext();return Rs(e).ee({index:Cd,range:s},(l,u,f)=>{const m=oe.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;a&&SI(a,m)<0;)r(a,null),a=o.getNext();a&&a.isEqual(m)&&(r(a,u),a=o.hasNext()?o.getNext():null),a?f.j(Cl(a)):f.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,s){const o=n.path,a=[o.popLast().toArray(),o.lastSegment(),Sh(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Rs(e).J(IDBKeyRange.bound(a,l,!0)).next(u=>{s==null||s.incrementDocumentReadCount(u.length);let f=Pn();for(const m of u){const g=this.Cr(oe.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);g.isFoundDocument()&&(Xu(n,g)||i.has(g.key))&&(f=f.insert(g.key,g))}return f})}getAllFromCollectionGroup(e,n,r,i){let s=Pn();const o=wI(n,r),a=wI(n,Dn.max());return Rs(e).ee({index:Z0,range:IDBKeyRange.bound(o,a,!0)},(l,u,f)=>{const m=this.Cr(oe.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);s=s.insert(m.key,m),s.size===i&&f.done()}).next(()=>s)}newChangeBuffer(e){return new K4(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return II(e).get(Om).next(n=>(ye(!!n,20021),n))}Dr(e,n){return II(e).put(Om,n)}Cr(e,n){if(n){const r=D4(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(Te.min())))return r}return yt.newInvalidDocument(e)}}function hx(t){return new j4(t)}class K4 extends dx{constructor(e,n){super(),this.Nr=e,this.trackRemovals=n,this.Br=new ii(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const n=[];let r=0,i=new Ye((s,o)=>Ce(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const a=this.Br.get(s);if(n.push(this.Nr.removeEntry(e,s,a.readTime)),o.isValidDocument()){const l=sI(this.Nr.serializer,o);i=i.add(s.path.popLast());const u=Ah(l);r+=u-a.size,n.push(this.Nr.addEntry(e,s,l))}else if(r-=a.size,this.trackRemovals){const l=sI(this.Nr.serializer,o.convertToNoDocument(Te.min()));n.push(this.Nr.addEntry(e,s,l))}}),i.forEach(s=>{n.push(this.Nr.indexManager.addToCollectionParentIndex(e,s))}),n.push(this.Nr.updateMetadata(e,r)),G.waitFor(n)}getFromCache(e,n){return this.Nr.vr(e,n).next(r=>(this.Br.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.Nr.Mr(e,n).next(({documents:r,Or:i})=>(i.forEach((s,o)=>{this.Br.set(s,{size:o,readTime:r.get(s).readTime})}),r))}}function II(t){return Mt(t,Ru)}function Rs(t){return Mt(t,gh)}function Cl(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function wI(t,e){const n=e.documentKey.path.toArray();return[t,Sh(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function SI(t,e){const n=t.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=Ce(n[s],r[s]),i)return i;return i=Ce(n.length,r.length),i||(i=Ce(n[n.length-2],r[r.length-2]),i||Ce(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J4{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fx{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&nu(r.mutation,i,mn.empty(),We.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,ke()).next(()=>r))}getLocalViewOfDocuments(e,n,r=ke()){const i=Er();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=Dl();return s.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=Er();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,ke()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=Pn();const o=tu(),a=function(){return tu()}();return n.forEach((l,u)=>{const f=r.get(u.key);i.has(u.key)&&(f===void 0||f.mutation instanceof si)?s=s.insert(u.key,u):f!==void 0?(o.set(u.key,f.mutation.getFieldMask()),nu(f.mutation,u,f.mutation.getFieldMask(),We.now())):o.set(u.key,mn.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((u,f)=>o.set(u,f)),n.forEach((u,f)=>a.set(u,new J4(f,o.get(u)??null))),a))}recalculateAndSaveOverlays(e,n){const r=tu();let i=new lt((o,a)=>o-a),s=ke();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const u=n.get(l);if(u===null)return;let f=r.get(l)||mn.empty();f=a.applyToLocalView(u,f),r.set(l,f);const m=(i.get(a.batchId)||ke()).add(l);i=i.insert(a.batchId,m)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),u=l.key,f=l.value,m=kA();f.forEach(g=>{if(!s.has(g)){const v=FA(n.get(g),r.get(g));v!==null&&m.set(g,v),s=s.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,m))}return G.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return oe.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):CA(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):G.resolve(Er());let a=Su,l=s;return o.next(u=>G.forEach(u,(f,m)=>(a<m.largestBatchId&&(a=m.largestBatchId),s.get(f)?G.resolve():this.remoteDocumentCache.getEntry(e,f).next(g=>{l=l.insert(f,g)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,l,u,ke())).next(f=>({batchId:a,changes:PA(f)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new oe(n)).next(r=>{let i=Dl();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let o=Dl();return this.indexManager.getCollectionParents(e,s).next(a=>G.forEach(a,l=>{const u=function(m,g){return new Qu(g,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(n,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,r,i).next(f=>{f.forEach((m,g)=>{o=o.insert(m,g)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((l,u)=>{const f=u.getKey();o.get(f)===null&&(o=o.insert(f,yt.newInvalidDocument(f)))});let a=Dl();return o.forEach((l,u)=>{const f=s.get(l);f!==void 0&&nu(f.mutation,u,mn.empty(),We.now()),Xu(n,u)&&(a=a.insert(l,u))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q4{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return G.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:un(i.createTime)}}(n)),G.resolve()}getNamedQuery(e,n){return G.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,function(i){return{name:i.name,query:nx(i.bundledQuery),readTime:un(i.readTime)}}(n)),G.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y4{constructor(){this.overlays=new lt(oe.comparator),this.qr=new Map}getOverlay(e,n){return G.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Er();return G.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.St(e,n,s)}),G.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.qr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.qr.delete(r)),G.resolve()}getOverlaysForCollection(e,n,r){const i=Er(),s=n.length+1,o=new oe(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,u=l.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return G.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new lt((u,f)=>u-f);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let f=s.get(u.largestBatchId);f===null&&(f=Er(),s=s.insert(u.largestBatchId,f)),f.set(u.getKey(),u)}}const a=Er(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((u,f)=>a.set(u,f)),!(a.size()>=i)););return G.resolve(a)}St(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new O_(n,r));let s=this.qr.get(n);s===void 0&&(s=ke(),this.qr.set(n,s)),this.qr.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X4{constructor(){this.sessionToken=Et.EMPTY_BYTE_STRING}getSessionToken(e){return G.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,G.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $_{constructor(){this.Qr=new Ye(Ut.$r),this.Ur=new Ye(Ut.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const r=new Ut(e,n);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Gr(new Ut(e,n))}zr(e,n){e.forEach(r=>this.removeReference(r,n))}jr(e){const n=new oe(new ze([])),r=new Ut(n,e),i=new Ut(n,e+1),s=[];return this.Ur.forEachInRange([r,i],o=>{this.Gr(o),s.push(o.key)}),s}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new oe(new ze([])),r=new Ut(n,e),i=new Ut(n,e+1);let s=ke();return this.Ur.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const n=new Ut(e,0),r=this.Qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Ut{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return oe.comparator(e.key,n.key)||Ce(e.Yr,n.Yr)}static Kr(e,n){return Ce(e.Yr,n.Yr)||oe.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z4{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new Ye(Ut.$r)}checkEmpty(e){return G.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new F_(s,n,r,i);this.mutationQueue.push(o);for(const a of i)this.Zr=this.Zr.add(new Ut(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return G.resolve(o)}lookupMutationBatch(e,n){return G.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.ei(r),s=i<0?0:i;return G.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return G.resolve(this.mutationQueue.length===0?js:this.tr-1)}getAllMutationBatches(e){return G.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Ut(n,0),i=new Ut(n,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([r,i],o=>{const a=this.Xr(o.Yr);s.push(a)}),G.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ye(Ce);return n.forEach(i=>{const s=new Ut(i,0),o=new Ut(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,o],a=>{r=r.add(a.Yr)})}),G.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;oe.isDocumentKey(s)||(s=s.child(""));const o=new Ut(new oe(s),0);let a=new Ye(Ce);return this.Zr.forEachWhile(l=>{const u=l.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(a=a.add(l.Yr)),!0)},o),G.resolve(this.ti(a))}ti(e){const n=[];return e.forEach(r=>{const i=this.Xr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){ye(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return G.forEach(n.mutations,i=>{const s=new Ut(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,n){const r=new Ut(n,0),i=this.Zr.firstAfterOrEqual(r);return G.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,G.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eO{constructor(e){this.ri=e,this.docs=function(){return new lt(oe.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.ri(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return G.resolve(r?r.document.mutableCopy():yt.newInvalidDocument(n))}getEntries(e,n){let r=Pn();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():yt.newInvalidDocument(i))}),G.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=Pn();const o=n.path,a=new oe(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:u,value:{document:f}}=l.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||A_(K0(f),r)<=0||(i.has(f.key)||Xu(n,f))&&(s=s.insert(f.key,f.mutableCopy()))}return G.resolve(s)}getAllFromCollectionGroup(e,n,r,i){fe(9500)}ii(e,n){return G.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new tO(this)}getSize(e){return G.resolve(this.size)}}class tO extends dx{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)}),G.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nO{constructor(e){this.persistence=e,this.si=new ii(n=>oo(n),Ju),this.lastRemoteSnapshotVersion=Te.min(),this.highestTargetId=0,this.oi=0,this._i=new $_,this.targetCount=0,this.ai=uo.ur()}forEachTarget(e,n){return this.si.forEach((r,i)=>n(i)),G.resolve()}getLastRemoteSnapshotVersion(e){return G.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return G.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),G.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.oi&&(this.oi=n),G.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new uo(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,G.resolve()}updateTargetData(e,n){return this.Pr(n),G.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,G.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.si.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.si.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),G.waitFor(s).next(()=>i)}getTargetCount(e){return G.resolve(this.targetCount)}getTargetData(e,n){const r=this.si.get(n)||null;return G.resolve(r)}addMatchingKeys(e,n,r){return this._i.Wr(n,r),G.resolve()}removeMatchingKeys(e,n,r){this._i.zr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),G.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),G.resolve()}getMatchingKeysForTargetId(e,n){const r=this._i.Hr(n);return G.resolve(r)}containsKey(e,n){return G.resolve(this._i.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H_{constructor(e,n){this.ui={},this.overlays={},this.ci=new zn(0),this.li=!1,this.li=!0,this.hi=new X4,this.referenceDelegate=e(this),this.Pi=new nO(this),this.indexManager=new B4,this.remoteDocumentCache=function(i){return new eO(i)}(r=>this.referenceDelegate.Ti(r)),this.serializer=new ex(n),this.Ii=new Q4(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new Y4,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ui[e.toKey()];return r||(r=new Z4(n,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,r){Z("MemoryPersistence","Starting transaction:",e);const i=new rO(this.ci.next());return this.referenceDelegate.Ei(),r(i).next(s=>this.referenceDelegate.di(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ai(e,n){return G.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,n)))}}class rO extends Q0{constructor(e){super(),this.currentSequenceNumber=e}}class vf{constructor(e){this.persistence=e,this.Ri=new $_,this.Vi=null}static mi(e){return new vf(e)}get fi(){if(this.Vi)return this.Vi;throw fe(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.fi.delete(r.toString()),G.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.fi.add(r.toString()),G.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),G.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach(i=>this.fi.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.fi.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return G.forEach(this.fi,r=>{const i=oe.fromPath(r);return this.gi(e,i).next(s=>{s||n.removeEntry(i,Te.min())})}).next(()=>(this.Vi=null,n.apply(e)))}updateLimboDocument(e,n){return this.gi(e,n).next(r=>{r?this.fi.delete(n.toString()):this.fi.add(n.toString())})}Ti(e){return 0}gi(e,n){return G.or([()=>G.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class xh{constructor(e,n){this.persistence=e,this.pi=new ii(r=>en(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=cx(this,n)}static mi(e,n){return new xh(e,n)}Ei(){}di(e){return G.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}pr(e,n){return G.forEach(this.pi,(r,i)=>this.br(e,r,i).next(s=>s?G.resolve():n(i)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ii(e,o=>this.br(e,o,n).next(a=>{a||(r++,s.removeEntry(o,Te.min()))})).next(()=>s.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),G.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),G.resolve()}removeReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),G.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),G.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=xd(e.data.value)),n}br(e,n,r){return G.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const i=this.pi.get(n);return G.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iO{constructor(e){this.serializer=e}k(e,n,r,i){const s=new sf("createOrUpgrade",n);r<1&&i>=1&&(function(l){l.createObjectStore(Ku)}(e),function(l){l.createObjectStore(xu,{keyPath:mU}),l.createObjectStore(Zn,{keyPath:VE,autoIncrement:!0}).createIndex(zs,LE,{unique:!0}),l.createObjectStore(Sa)}(e),CI(e),function(l){l.createObjectStore(Ms)}(e));let o=G.resolve();return r<3&&i>=3&&(r!==0&&(function(l){l.deleteObjectStore(Aa),l.deleteObjectStore(Ca),l.deleteObjectStore(Ks)}(e),CI(e)),o=o.next(()=>function(l){const u=l.store(Ks),f={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Te.min().toTimestamp(),targetCount:0};return u.put(_h,f)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(l,u){return u.store(Zn).J().next(m=>{l.deleteObjectStore(Zn),l.createObjectStore(Zn,{keyPath:VE,autoIncrement:!0}).createIndex(zs,LE,{unique:!0});const g=u.store(Zn),v=m.map(T=>g.put(T));return G.waitFor(v)})}(e,s))),o=o.next(()=>{(function(l){l.createObjectStore(xa,{keyPath:SU})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.yi(s))),r<6&&i>=6&&(o=o.next(()=>(function(l){l.createObjectStore(Ru)}(e),this.wi(s)))),r<7&&i>=7&&(o=o.next(()=>this.Si(s))),r<8&&i>=8&&(o=o.next(()=>this.bi(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.Di(s))),r<11&&i>=11&&(o=o.next(()=>{(function(l){l.createObjectStore(af,{keyPath:CU})})(e),function(l){l.createObjectStore(lf,{keyPath:AU})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(l){const u=l.createObjectStore(uf,{keyPath:bU});u.createIndex(Gm,MU,{unique:!1}),u.createIndex(rA,VU,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(l){const u=l.createObjectStore(gh,{keyPath:_U});u.createIndex(Cd,yU),u.createIndex(Z0,vU)}(e)).next(()=>this.Ci(e,s)).next(()=>e.deleteObjectStore(Ms))),r<14&&i>=14&&(o=o.next(()=>this.Fi(e,s))),r<15&&i>=15&&(o=o.next(()=>function(l){l.createObjectStore(P_,{keyPath:xU,autoIncrement:!0}).createIndex(Bm,RU,{unique:!1}),l.createObjectStore(Yl,{keyPath:PU}).createIndex(tA,kU,{unique:!1}),l.createObjectStore(Xl,{keyPath:NU}).createIndex(nA,DU,{unique:!1})}(e))),r<16&&i>=16&&(o=o.next(()=>{n.objectStore(Yl).clear()}).next(()=>{n.objectStore(Xl).clear()})),r<17&&i>=17&&(o=o.next(()=>{(function(l){l.createObjectStore(k_,{keyPath:LU})})(e)})),r<18&&i>=18&&JC()&&(o=o.next(()=>{n.objectStore(Yl).clear()}).next(()=>{n.objectStore(Xl).clear()})),o}wi(e){let n=0;return e.store(Ms).ee((r,i)=>{n+=Ah(i)}).next(()=>{const r={byteSize:n};return e.store(Ru).put(Om,r)})}yi(e){const n=e.store(xu),r=e.store(Zn);return n.J().next(i=>G.forEach(i,s=>{const o=IDBKeyRange.bound([s.userId,js],[s.userId,s.lastAcknowledgedBatchId]);return r.J(zs,o).next(a=>G.forEach(a,l=>{ye(l.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:l.batchId});const u=Ls(this.serializer,l);return ox(e,s.userId,u).next(()=>{})}))}))}Si(e){const n=e.store(Aa),r=e.store(Ms);return e.store(Ks).get(_h).next(i=>{const s=[];return r.ee((o,a)=>{const l=new ze(o),u=function(m){return[0,en(m)]}(l);s.push(n.get(u).next(f=>f?G.resolve():(m=>n.put({targetId:0,path:en(m),sequenceNumber:i.highestListenSequenceNumber}))(l)))}).next(()=>G.waitFor(s))})}bi(e,n){e.createObjectStore(Pu,{keyPath:wU});const r=n.store(Pu),i=new z_,s=o=>{if(i.add(o)){const a=o.lastSegment(),l=o.popLast();return r.put({collectionId:a,parent:en(l)})}};return n.store(Ms).ee({X:!0},(o,a)=>{const l=new ze(o);return s(l.popLast())}).next(()=>n.store(Sa).ee({X:!0},([o,a,l],u)=>{const f=Tr(a);return s(f.popLast())}))}Di(e){const n=e.store(Ca);return n.ee((r,i)=>{const s=Ml(i),o=tx(this.serializer,s);return n.put(o)})}Ci(e,n){const r=n.store(Ms),i=[];return r.ee((s,o)=>{const a=n.store(gh),l=function(m){return m.document?new oe(ze.fromString(m.document.name).popFirst(5)):m.noDocument?oe.fromSegments(m.noDocument.path):m.unknownDocument?oe.fromSegments(m.unknownDocument.path):fe(36783)}(o).path.toArray(),u={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(u))}).next(()=>G.waitFor(i))}Fi(e,n){const r=n.store(Zn),i=hx(this.serializer),s=new H_(vf.mi,this.serializer.yt);return r.J().next(o=>{const a=new Map;return o.forEach(l=>{let u=a.get(l.userId)??ke();Ls(this.serializer,l).keys().forEach(f=>u=u.add(f)),a.set(l.userId,u)}),G.forEach(a,(l,u)=>{const f=new zt(u),m=_f.wt(this.serializer,f),g=s.getIndexManager(f),v=yf.wt(f,this.serializer,g,s.referenceDelegate);return new fx(i,v,m,g).recalculateAndSaveOverlaysForDocumentKeys(new qm(n,zn.ce),l).next()})})}}function CI(t){t.createObjectStore(Aa,{keyPath:EU}).createIndex(R_,IU,{unique:!0}),t.createObjectStore(Ca,{keyPath:"targetId"}).createIndex(eA,TU,{unique:!0}),t.createObjectStore(Ks)}const vi="IndexedDbPersistence",Ep=18e5,Ip=5e3,wp="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",sO="main";class W_{constructor(e,n,r,i,s,o,a,l,u,f,m=18){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Mi=s,this.window=o,this.document=a,this.xi=u,this.Oi=f,this.Ni=m,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=g=>Promise.resolve(),!W_.v())throw new re(J.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new W4(this,i),this.$i=n+sO,this.serializer=new ex(l),this.Ui=new Hi(this.$i,this.Ni,new iO(this.serializer)),this.hi=new M4,this.Pi=new q4(this.referenceDelegate,this.serializer),this.remoteDocumentCache=hx(this.serializer),this.Ii=new b4,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,f===!1&&sn(vi,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new re(J.FAILED_PRECONDITION,wp);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Pi.getHighestSequenceNumber(e))}).then(e=>{this.ci=new zn(e,this.xi)}).then(()=>{this.li=!0}).catch(e=>(this.Ui&&this.Ui.close(),Promise.reject(e)))}Ji(e){return this.Qi=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget(async()=>{this.started&&await this.Wi()}))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>td(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Hi(e).next(n=>{n||(this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)))})}).next(()=>this.Yi(e)).next(n=>this.isPrimary&&!n?this.Zi(e).next(()=>!1):!!n&&this.Xi(e).next(()=>!0))).catch(e=>{if(as(e))return Z(vi,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Z(vi,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable(()=>this.Qi(e)),this.isPrimary=e})}Hi(e){return Al(e).get(ko).next(n=>G.resolve(this.es(n)))}ts(e){return td(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,Ep)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=Mt(n,xa);return r.J().next(i=>{const s=this.ss(i,Ep),o=i.filter(a=>s.indexOf(a)===-1);return G.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Ki)for(const n of e)this.Ki.removeItem(this._s(n.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Wi().then(()=>this.ns()).then(()=>this.ji()))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?G.resolve(!0):Al(e).get(ko).next(n=>{if(n!==null&&this.rs(n.leaseTimestampMs,Ip)&&!this.us(n.ownerId)){if(this.es(n)&&this.networkEnabled)return!0;if(!this.es(n)){if(!n.allowTabSynchronization)throw new re(J.FAILED_PRECONDITION,wp);return!1}}return!(!this.networkEnabled||!this.inForeground)||td(e).J().next(r=>this.ss(r,Ip).find(i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&Z(vi,`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[Ku,xa],e=>{const n=new qm(e,zn.ce);return this.Zi(n).next(()=>this.ts(n))}),this.Ui.close(),this.Ps()}ss(e,n){return e.filter(r=>this.rs(r.updateTimeMs,n)&&!this.us(r.clientId))}Ts(){return this.runTransaction("getActiveClients","readonly",e=>td(e).J().next(n=>this.ss(n,Ep).map(r=>r.clientId)))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,n){return yf.wt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new G4(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return _f.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,n,r){Z(vi,"Starting transaction:",e);const i=n==="readonly"?"readonly":"readwrite",s=function(l){return l===18?OU:l===17?aA:l===16?UU:l===15?N_:l===14?oA:l===13?sA:l===12?FU:l===11?iA:void fe(60245)}(this.Ni);let o;return this.Ui.runTransaction(e,i,s,a=>(o=new qm(a,this.ci?this.ci.next():zn.ce),n==="readwrite-primary"?this.Hi(o).next(l=>!!l||this.Yi(o)).next(l=>{if(!l)throw sn(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)),new re(J.FAILED_PRECONDITION,J0);return r(o)}).next(l=>this.Xi(o).next(()=>l)):this.Is(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Is(e){return Al(e).get(ko).next(n=>{if(n!==null&&this.rs(n.leaseTimestampMs,Ip)&&!this.us(n.ownerId)&&!this.es(n)&&!(this.Oi||this.allowTabSynchronization&&n.allowTabSynchronization))throw new re(J.FAILED_PRECONDITION,wp)})}Xi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Al(e).put(ko,n)}static v(){return Hi.v()}Zi(e){const n=Al(e);return n.get(ko).next(r=>this.es(r)?(Z(vi,"Releasing primary lease."),n.delete(ko)):G.resolve())}rs(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(sn(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi()))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){var e;typeof((e=this.window)==null?void 0:e.addEventListener)=="function"&&(this.Bi=()=>{this.cs();const n=/(?:Version|Mobile)\/1[456]/;KC()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){var n;try{const r=((n=this.Ki)==null?void 0:n.getItem(this._s(e)))!==null;return Z(vi,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return sn(vi,"Failed to get zombied client id.",r),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){sn("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Al(t){return Mt(t,Ku)}function td(t){return Mt(t,xa)}function oO(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j_{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.Es=r,this.ds=i}static As(e,n){let r=ke(),i=ke();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new j_(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aO{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class px{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return KC()?8:Y0(Dt())>0?6:4}()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.ys(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ws(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new aO;return this.Ss(e,n,o).next(a=>{if(s.result=a,this.Vs)return this.bs(e,n,o,a.size)})}).next(()=>s.result)}bs(e,n,r,i){return r.documentReadCount<this.fs?(Lo()<=Ve.DEBUG&&Z("QueryEngine","SDK will not create cache indexes for query:",Fo(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),G.resolve()):(Lo()<=Ve.DEBUG&&Z("QueryEngine","Query:",Fo(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?(Lo()<=Ve.DEBUG&&Z("QueryEngine","The SDK decides to create cache indexes for query:",Fo(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Wn(n))):G.resolve())}ys(e,n){if(JE(n))return G.resolve(null);let r=Wn(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=Jm(n,null,"F"),r=Wn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=ke(...s);return this.ps.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const u=this.Ds(n,a);return this.Cs(n,u,o,l.readTime)?this.ys(e,Jm(n,null,"F")):this.vs(e,u,n,l)}))})))}ws(e,n,r,i){return JE(n)||i.isEqual(Te.min())?G.resolve(null):this.ps.getDocuments(e,r).next(s=>{const o=this.Ds(n,s);return this.Cs(n,o,r,i)?G.resolve(null):(Lo()<=Ve.DEBUG&&Z("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Fo(n)),this.vs(e,o,n,lU(i,Su)).next(a=>a))})}Ds(e,n){let r=new Ye(xA(e));return n.forEach((i,s)=>{Xu(e,s)&&(r=r.add(s))}),r}Cs(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ss(e,n,r){return Lo()<=Ve.DEBUG&&Z("QueryEngine","Using full collection scan to execute query:",Fo(n)),this.ps.getDocumentsMatchingQuery(e,n,Dn.min(),r)}vs(e,n,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K_="LocalStore",lO=3e8;class uO{constructor(e,n,r,i){this.persistence=e,this.Fs=n,this.serializer=i,this.Ms=new lt(Ce),this.xs=new ii(s=>oo(s),Ju),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new fx(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ms))}}function mx(t,e,n,r){return new uO(t,e,n,r)}async function gx(t,e){const n=Ae(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.Bs(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],a=[];let l=ke();for(const u of i){o.push(u.batchId);for(const f of u.mutations)l=l.add(f.key)}for(const u of s){a.push(u.batchId);for(const f of u.mutations)l=l.add(f.key)}return n.localDocuments.getDocuments(r,l).next(u=>({Ls:u,removedBatchIds:o,addedBatchIds:a}))})})}function cO(t,e){const n=Ae(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.Ns.newChangeBuffer({trackRemovals:!0});return function(a,l,u,f){const m=u.batch,g=m.keys();let v=G.resolve();return g.forEach(T=>{v=v.next(()=>f.getEntry(l,T)).next(P=>{const D=u.docVersions.get(T);ye(D!==null,48541),P.version.compareTo(D)<0&&(m.applyToRemoteDocument(P,u),P.isValidDocument()&&(P.setReadTime(u.commitVersion),f.addEntry(P)))})}),v.next(()=>a.mutationQueue.removeMutationBatch(l,m))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=ke();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(l=l.add(a.batch.mutations[u].key));return l}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function _x(t){const e=Ae(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Pi.getLastRemoteSnapshotVersion(n))}function dO(t,e){const n=Ae(t),r=e.snapshotVersion;let i=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.Ns.newChangeBuffer({trackRemovals:!0});i=n.Ms;const a=[];e.targetChanges.forEach((f,m)=>{const g=i.get(m);if(!g)return;a.push(n.Pi.removeMatchingKeys(s,f.removedDocuments,m).next(()=>n.Pi.addMatchingKeys(s,f.addedDocuments,m)));let v=g.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(m)!==null?v=v.withResumeToken(Et.EMPTY_BYTE_STRING,Te.min()).withLastLimboFreeSnapshotVersion(Te.min()):f.resumeToken.approximateByteSize()>0&&(v=v.withResumeToken(f.resumeToken,r)),i=i.insert(m,v),function(P,D,S){return P.resumeToken.approximateByteSize()===0||D.snapshotVersion.toMicroseconds()-P.snapshotVersion.toMicroseconds()>=lO?!0:S.addedDocuments.size+S.modifiedDocuments.size+S.removedDocuments.size>0}(g,v,f)&&a.push(n.Pi.updateTargetData(s,v))});let l=Pn(),u=ke();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,f))}),a.push(hO(s,o,e.documentUpdates).next(f=>{l=f.ks,u=f.qs})),!r.isEqual(Te.min())){const f=n.Pi.getLastRemoteSnapshotVersion(s).next(m=>n.Pi.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(f)}return G.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,l,u)).next(()=>l)}).then(s=>(n.Ms=i,s))}function hO(t,e,n){let r=ke(),i=ke();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=Pn();return n.forEach((a,l)=>{const u=s.get(a);l.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(a)),l.isNoDocument()&&l.version.isEqual(Te.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):Z(K_,"Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",l.version)}),{ks:o,qs:i}})}function fO(t,e){const n=Ae(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=js),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function pO(t,e){const n=Ae(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Pi.getTargetData(r,e).next(s=>s?(i=s,G.resolve(i)):n.Pi.allocateTargetId(r).next(o=>(i=new $r(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Pi.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.Ms.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(r.targetId,r),n.xs.set(e,r.targetId)),r})}async function rg(t,e,n){const r=Ae(t),i=r.Ms.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!as(o))throw o;Z(K_,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(i.target)}function AI(t,e,n){const r=Ae(t);let i=Te.min(),s=ke();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,u,f){const m=Ae(l),g=m.xs.get(f);return g!==void 0?G.resolve(m.Ms.get(g)):m.Pi.getTargetData(u,f)}(r,o,Wn(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,a.targetId).next(l=>{s=l})}).next(()=>r.Fs.getDocumentsMatchingQuery(o,e,n?i:Te.min(),n?s:ke())).next(a=>(mO(r,e4(e),a),{documents:a,Qs:s})))}function mO(t,e,n){let r=t.Os.get(e)||Te.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.Os.set(e,r)}class xI{constructor(){this.activeTargetIds=o4()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class yx{constructor(){this.Mo=new xI,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,r){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new xI,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gO{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RI="ConnectivityMonitor";class PI{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Z(RI,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Z(RI,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nd=null;function ig(){return nd===null?nd=function(){return 268435456+Math.round(2147483648*Math.random())}():nd++,"0x"+nd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sp="RestConnection",_O={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class yO{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===yh?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,n,r,i,s){const o=ig(),a=this.zo(e,n.toUriEncodedString());Z(Sp,`Sending RPC '${e}' ${o}:`,a,r);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,i,s);const{host:u}=new URL(a),f=za(u);return this.Jo(e,a,l,r,f).then(m=>(Z(Sp,`Received RPC '${e}' ${o}: `,m),m),m=>{throw Yi(Sp,`RPC '${e}' ${o} failed with error: `,m,"url: ",a,"request:",r),m})}Ho(e,n,r,i,s,o){return this.Go(e,n,r,i,s)}jo(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Wa}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((i,s)=>e[s]=i),r&&r.headers.forEach((i,s)=>e[s]=i)}zo(e,n){const r=_O[e];return`${this.Uo}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vO{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jt="WebChannelConnection";class TO extends yO{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,i,s){const o=ig();return new Promise((a,l)=>{const u=new V0;u.setWithCredentials(!0),u.listenOnce(L0.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case Id.NO_ERROR:const m=u.getResponseJson();Z(Jt,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(m)),a(m);break;case Id.TIMEOUT:Z(Jt,`RPC '${e}' ${o} timed out`),l(new re(J.DEADLINE_EXCEEDED,"Request time out"));break;case Id.HTTP_ERROR:const g=u.getStatus();if(Z(Jt,`RPC '${e}' ${o} failed with status:`,g,"response text:",u.getResponseText()),g>0){let v=u.getResponseJson();Array.isArray(v)&&(v=v[0]);const T=v==null?void 0:v.error;if(T&&T.status&&T.message){const P=function(S){const I=S.toLowerCase().replace(/_/g,"-");return Object.values(J).indexOf(I)>=0?I:J.UNKNOWN}(T.status);l(new re(P,T.message))}else l(new re(J.UNKNOWN,"Server responded with status "+u.getStatus()))}else l(new re(J.UNAVAILABLE,"Connection failed."));break;default:fe(9055,{l_:e,streamId:o,h_:u.getLastErrorCode(),P_:u.getLastError()})}}finally{Z(Jt,`RPC '${e}' ${o} completed.`)}});const f=JSON.stringify(i);Z(Jt,`RPC '${e}' ${o} sending request:`,i),u.send(n,"POST",f,r,15)})}T_(e,n,r){const i=ig(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=O0(),a=U0(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(l.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,n,r),l.encodeInitMessageHeaders=!0;const f=s.join("");Z(Jt,`Creating RPC '${e}' stream ${i}: ${f}`,l);const m=o.createWebChannel(f,l);this.I_(m);let g=!1,v=!1;const T=new vO({Yo:D=>{v?Z(Jt,`Not sending because RPC '${e}' stream ${i} is closed:`,D):(g||(Z(Jt,`Opening RPC '${e}' stream ${i} transport.`),m.open(),g=!0),Z(Jt,`RPC '${e}' stream ${i} sending:`,D),m.send(D))},Zo:()=>m.close()}),P=(D,S,I)=>{D.listen(S,R=>{try{I(R)}catch(V){setTimeout(()=>{throw V},0)}})};return P(m,Nl.EventType.OPEN,()=>{v||(Z(Jt,`RPC '${e}' stream ${i} transport opened.`),T.o_())}),P(m,Nl.EventType.CLOSE,()=>{v||(v=!0,Z(Jt,`RPC '${e}' stream ${i} transport closed`),T.a_(),this.E_(m))}),P(m,Nl.EventType.ERROR,D=>{v||(v=!0,Yi(Jt,`RPC '${e}' stream ${i} transport errored. Name:`,D.name,"Message:",D.message),T.a_(new re(J.UNAVAILABLE,"The operation could not be completed")))}),P(m,Nl.EventType.MESSAGE,D=>{var S;if(!v){const I=D.data[0];ye(!!I,16349);const R=I,V=(R==null?void 0:R.error)||((S=R[0])==null?void 0:S.error);if(V){Z(Jt,`RPC '${e}' stream ${i} received error:`,V);const U=V.status;let B=function(C){const k=Ct[C];if(k!==void 0)return BA(k)}(U),E=V.message;B===void 0&&(B=J.INTERNAL,E="Unknown error status: "+U+" with message "+V.message),v=!0,T.a_(new re(B,E)),m.close()}else Z(Jt,`RPC '${e}' stream ${i} received:`,I),T.u_(I)}}),P(a,F0.STAT_EVENT,D=>{D.stat===Lm.PROXY?Z(Jt,`RPC '${e}' stream ${i} detected buffering proxy`):D.stat===Lm.NOPROXY&&Z(Jt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{T.__()},0),T}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(n=>n===e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EO(){return typeof window<"u"?window:null}function Dd(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tf(t){return new I4(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vx{constructor(e,n,r=1e3,i=1.5,s=6e4){this.Mi=e,this.timerId=n,this.d_=r,this.A_=i,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,n-r);i>0&&Z("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kI="PersistentStream";class Tx{constructor(e,n,r,i,s,o,a,l){this.Mi=e,this.S_=r,this.b_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new vx(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===J.RESOURCE_EXHAUSTED?(sn(n.toString()),sn("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===J.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.D_===n&&this.G_(r,i)},r=>{e(()=>{const i=new re(J.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)})})}G_(e,n){const r=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(i=>{r(()=>this.z_(i))}),this.stream.onMessage(i=>{r(()=>++this.F_==1?this.J_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return Z(kI,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget(()=>this.D_===e?n():(Z(kI,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class IO extends Tx{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=C4(this.serializer,e),r=function(s){if(!("targetChange"in s))return Te.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?Te.min():o.readTime?un(o.readTime):Te.min()}(e);return this.listener.H_(n,r)}Y_(e){const n={};n.database=Xm(this.serializer),n.addTarget=function(s,o){let a;const l=o.target;if(a=Th(l)?{documents:KA(s,l)}:{query:JA(s,l).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=zA(s,o.resumeToken);const u=Qm(s,o.expectedCount);u!==null&&(a.expectedCount=u)}else if(o.snapshotVersion.compareTo(Te.min())>0){a.readTime=Va(s,o.snapshotVersion.toTimestamp());const u=Qm(s,o.expectedCount);u!==null&&(a.expectedCount=u)}return a}(this.serializer,e);const r=x4(this.serializer,e);r&&(n.labels=r),this.q_(n)}Z_(e){const n={};n.database=Xm(this.serializer),n.removeTarget=e,this.q_(n)}}class wO extends Tx{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return ye(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,ye(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){ye(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=A4(e.writeResults,e.commitTime),r=un(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=Xm(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>wh(this.serializer,r))};this.q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SO{}class CO extends SO{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new re(J.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Go(e,Ym(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===J.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new re(J.UNKNOWN,s.toString())})}Ho(e,n,r,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Ho(e,Ym(n,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===J.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new re(J.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class AO{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(sn(n),this.aa=!1):Z("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const co="RemoteStore";class xO{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo(o=>{r.enqueueAndForget(async()=>{go(this)&&(Z(co,"Restarting streams for network reachability change."),await async function(l){const u=Ae(l);u.Ea.add(4),await ec(u),u.Ra.set("Unknown"),u.Ea.delete(4),await Ef(u)}(this))})}),this.Ra=new AO(r,i)}}async function Ef(t){if(go(t))for(const e of t.da)await e(!0)}async function ec(t){for(const e of t.da)await e(!1)}function Ex(t,e){const n=Ae(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),X_(n)?Y_(n):Ka(n).O_()&&Q_(n,e))}function J_(t,e){const n=Ae(t),r=Ka(n);n.Ia.delete(e),r.O_()&&Ix(n,e),n.Ia.size===0&&(r.O_()?r.L_():go(n)&&n.Ra.set("Unknown"))}function Q_(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Te.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Ka(t).Y_(e)}function Ix(t,e){t.Va.Ue(e),Ka(t).Z_(e)}function Y_(t){t.Va=new y4({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),Ka(t).start(),t.Ra.ua()}function X_(t){return go(t)&&!Ka(t).x_()&&t.Ia.size>0}function go(t){return Ae(t).Ea.size===0}function wx(t){t.Va=void 0}async function RO(t){t.Ra.set("Online")}async function PO(t){t.Ia.forEach((e,n)=>{Q_(t,e)})}async function kO(t,e){wx(t),X_(t)?(t.Ra.ha(e),Y_(t)):t.Ra.set("Unknown")}async function NO(t,e,n){if(t.Ra.set("Online"),e instanceof qA&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const a of s.targetIds)i.Ia.has(a)&&(await i.remoteSyncer.rejectListen(a,o),i.Ia.delete(a),i.Va.removeTarget(a))}(t,e)}catch(r){Z(co,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Rh(t,r)}else if(e instanceof kd?t.Va.Ze(e):e instanceof GA?t.Va.st(e):t.Va.tt(e),!n.isEqual(Te.min()))try{const r=await _x(t.localStore);n.compareTo(r)>=0&&await function(s,o){const a=s.Va.Tt(o);return a.targetChanges.forEach((l,u)=>{if(l.resumeToken.approximateByteSize()>0){const f=s.Ia.get(u);f&&s.Ia.set(u,f.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,u)=>{const f=s.Ia.get(l);if(!f)return;s.Ia.set(l,f.withResumeToken(Et.EMPTY_BYTE_STRING,f.snapshotVersion)),Ix(s,l);const m=new $r(f.target,l,u,f.sequenceNumber);Q_(s,m)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){Z(co,"Failed to raise snapshot:",r),await Rh(t,r)}}async function Rh(t,e,n){if(!as(e))throw e;t.Ea.add(1),await ec(t),t.Ra.set("Offline"),n||(n=()=>_x(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Z(co,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await Ef(t)})}function Sx(t,e){return e().catch(n=>Rh(t,n,e))}async function tc(t){const e=Ae(t),n=ts(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:js;for(;DO(e);)try{const i=await fO(e.localStore,r);if(i===null){e.Ta.length===0&&n.L_();break}r=i.batchId,bO(e,i)}catch(i){await Rh(e,i)}Cx(e)&&Ax(e)}function DO(t){return go(t)&&t.Ta.length<10}function bO(t,e){t.Ta.push(e);const n=ts(t);n.O_()&&n.X_&&n.ea(e.mutations)}function Cx(t){return go(t)&&!ts(t).x_()&&t.Ta.length>0}function Ax(t){ts(t).start()}async function MO(t){ts(t).ra()}async function VO(t){const e=ts(t);for(const n of t.Ta)e.ea(n.mutations)}async function LO(t,e,n){const r=t.Ta.shift(),i=U_.from(r,e,n);await Sx(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await tc(t)}async function FO(t,e){e&&ts(t).X_&&await async function(r,i){if(function(o){return m4(o)&&o!==J.ABORTED}(i.code)){const s=r.Ta.shift();ts(r).B_(),await Sx(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await tc(r)}}(t,e),Cx(t)&&Ax(t)}async function NI(t,e){const n=Ae(t);n.asyncQueue.verifyOperationInProgress(),Z(co,"RemoteStore received new credentials");const r=go(n);n.Ea.add(3),await ec(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await Ef(n)}async function UO(t,e){const n=Ae(t);e?(n.Ea.delete(2),await Ef(n)):e||(n.Ea.add(2),await ec(n),n.Ra.set("Unknown"))}function Ka(t){return t.ma||(t.ma=function(n,r,i){const s=Ae(n);return s.sa(),new IO(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Xo:RO.bind(null,t),t_:PO.bind(null,t),r_:kO.bind(null,t),H_:NO.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),X_(t)?Y_(t):t.Ra.set("Unknown")):(await t.ma.stop(),wx(t))})),t.ma}function ts(t){return t.fa||(t.fa=function(n,r,i){const s=Ae(n);return s.sa(),new wO(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:MO.bind(null,t),r_:FO.bind(null,t),ta:VO.bind(null,t),na:LO.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await tc(t)):(await t.fa.stop(),t.Ta.length>0&&(Z(co,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z_{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Cr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const o=Date.now()+r,a=new Z_(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new re(J.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function ey(t,e){if(sn("AsyncQueue",`${e}: ${t}`),as(t))return new re(J.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fa{static emptySet(e){return new fa(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||oe.comparator(n.key,r.key):(n,r)=>oe.comparator(n.key,r.key),this.keyedMap=Dl(),this.sortedSet=new lt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof fa)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new fa;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DI{constructor(){this.ga=new lt(oe.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):fe(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,r)=>{e.push(r)}),e}}class La{constructor(e,n,r,i,s,o,a,l,u){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,n,r,i,s){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new La(e,n,fa.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&hf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OO{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class BO{constructor(){this.queries=bI(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const i=Ae(n),s=i.queries;i.queries=bI(),s.forEach((o,a)=>{for(const l of a.Sa)l.onError(r)})})(this,new re(J.ABORTED,"Firestore shutting down"))}}function bI(){return new ii(t=>AA(t),hf)}async function ty(t,e){const n=Ae(t);let r=3;const i=e.query;let s=n.queries.get(i);s?!s.ba()&&e.Da()&&(r=2):(s=new OO,r=e.Da()?0:1);try{switch(r){case 0:s.wa=await n.onListen(i,!0);break;case 1:s.wa=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(o){const a=ey(o,`Initialization of query '${Fo(e.query)}' failed`);return void e.onError(a)}n.queries.set(i,s),s.Sa.push(e),e.va(n.onlineState),s.wa&&e.Fa(s.wa)&&ry(n)}async function ny(t,e){const n=Ae(t),r=e.query;let i=3;const s=n.queries.get(r);if(s){const o=s.Sa.indexOf(e);o>=0&&(s.Sa.splice(o,1),s.Sa.length===0?i=e.Da()?0:1:!s.ba()&&e.Da()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function GO(t,e){const n=Ae(t);let r=!1;for(const i of e){const s=i.query,o=n.queries.get(s);if(o){for(const a of o.Sa)a.Fa(i)&&(r=!0);o.wa=i}}r&&ry(n)}function qO(t,e,n){const r=Ae(t),i=r.queries.get(e);if(i)for(const s of i.Sa)s.onError(n);r.queries.delete(e)}function ry(t){t.Ca.forEach(e=>{e.next()})}var sg,MI;(MI=sg||(sg={})).Ma="default",MI.Cache="cache";class iy{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new La(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=La.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==sg.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xx{constructor(e){this.key=e}}class Rx{constructor(e){this.key=e}}class zO{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=ke(),this.mutatedKeys=ke(),this.eu=xA(e),this.tu=new fa(this.eu)}get nu(){return this.Ya}ru(e,n){const r=n?n.iu:new DI,i=n?n.tu:this.tu;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((f,m)=>{const g=i.get(f),v=Xu(this.query,m)?m:null,T=!!g&&this.mutatedKeys.has(g.key),P=!!v&&(v.hasLocalMutations||this.mutatedKeys.has(v.key)&&v.hasCommittedMutations);let D=!1;g&&v?g.data.isEqual(v.data)?T!==P&&(r.track({type:3,doc:v}),D=!0):this.su(g,v)||(r.track({type:2,doc:v}),D=!0,(l&&this.eu(v,l)>0||u&&this.eu(v,u)<0)&&(a=!0)):!g&&v?(r.track({type:0,doc:v}),D=!0):g&&!v&&(r.track({type:1,doc:g}),D=!0,(l||u)&&(a=!0)),D&&(v?(o=o.add(v),s=P?s.add(f):s.delete(f)):(o=o.delete(f),s=s.delete(f)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const f=this.query.limitType==="F"?o.last():o.first();o=o.delete(f.key),s=s.delete(f.key),r.track({type:1,doc:f})}return{tu:o,iu:r,Cs:a,mutatedKeys:s}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((f,m)=>function(v,T){const P=D=>{switch(D){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return fe(20277,{Rt:D})}};return P(v)-P(T)}(f.type,m.type)||this.eu(f.doc,m.doc)),this.ou(r),i=i??!1;const a=n&&!i?this._u():[],l=this.Xa.size===0&&this.current&&!i?1:0,u=l!==this.Za;return this.Za=l,o.length!==0||u?{snapshot:new La(this.query,e.tu,s,o,e.mutatedKeys,l===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new DI,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Ya=this.Ya.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ya=this.Ya.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=ke(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))});const n=[];return e.forEach(r=>{this.Xa.has(r)||n.push(new Rx(r))}),this.Xa.forEach(r=>{e.has(r)||n.push(new xx(r))}),n}cu(e){this.Ya=e.Qs,this.Xa=ke();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return La.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const sy="SyncEngine";class $O{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class HO{constructor(e){this.key=e,this.hu=!1}}class WO{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new ii(a=>AA(a),hf),this.Iu=new Map,this.Eu=new Set,this.du=new lt(oe.comparator),this.Au=new Map,this.Ru=new $_,this.Vu={},this.mu=new Map,this.fu=uo.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function jO(t,e,n=!0){const r=Mx(t);let i;const s=r.Tu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await Px(r,e,n,!0),i}async function KO(t,e){const n=Mx(t);await Px(n,e,!0,!1)}async function Px(t,e,n,r){const i=await pO(t.localStore,Wn(e)),s=i.targetId,o=t.sharedClientState.addLocalQueryTarget(s,n);let a;return r&&(a=await JO(t,e,s,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&Ex(t.remoteStore,i),a}async function JO(t,e,n,r,i){t.pu=(m,g,v)=>async function(P,D,S,I){let R=D.view.ru(S);R.Cs&&(R=await AI(P.localStore,D.query,!1).then(({documents:E})=>D.view.ru(E,R)));const V=I&&I.targetChanges.get(D.targetId),U=I&&I.targetMismatches.get(D.targetId)!=null,B=D.view.applyChanges(R,P.isPrimaryClient,V,U);return LI(P,D.targetId,B.au),B.snapshot}(t,m,g,v);const s=await AI(t.localStore,e,!0),o=new zO(e,s.Qs),a=o.ru(s.documents),l=Zu.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),u=o.applyChanges(a,t.isPrimaryClient,l);LI(t,n,u.au);const f=new $O(e,n,o);return t.Tu.set(e,f),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),u.snapshot}async function QO(t,e,n){const r=Ae(t),i=r.Tu.get(e),s=r.Iu.get(i.targetId);if(s.length>1)return r.Iu.set(i.targetId,s.filter(o=>!hf(o,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await rg(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&J_(r.remoteStore,i.targetId),og(r,i.targetId)}).catch(mo)):(og(r,i.targetId),await rg(r.localStore,i.targetId,!0))}async function YO(t,e){const n=Ae(t),r=n.Tu.get(e),i=n.Iu.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),J_(n.remoteStore,r.targetId))}async function XO(t,e,n){const r=Vx(t);try{const i=await function(o,a){const l=Ae(o),u=We.now(),f=a.reduce((v,T)=>v.add(T.key),ke());let m,g;return l.persistence.runTransaction("Locally write mutations","readwrite",v=>{let T=Pn(),P=ke();return l.Ns.getEntries(v,f).next(D=>{T=D,T.forEach((S,I)=>{I.isValidDocument()||(P=P.add(S))})}).next(()=>l.localDocuments.getOverlayedDocuments(v,T)).next(D=>{m=D;const S=[];for(const I of a){const R=f4(I,m.get(I.key).overlayedDocument);R!=null&&S.push(new si(I.key,R,_A(R.value.mapValue),on.exists(!0)))}return l.mutationQueue.addMutationBatch(v,u,S,a)}).next(D=>{g=D;const S=D.applyToLocalDocumentSet(m,P);return l.documentOverlayCache.saveOverlays(v,D.batchId,S)})}).then(()=>({batchId:g.batchId,changes:PA(m)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,l){let u=o.Vu[o.currentUser.toKey()];u||(u=new lt(Ce)),u=u.insert(a,l),o.Vu[o.currentUser.toKey()]=u}(r,i.batchId,n),await nc(r,i.changes),await tc(r.remoteStore)}catch(i){const s=ey(i,"Failed to persist write");n.reject(s)}}async function kx(t,e){const n=Ae(t);try{const r=await dO(n.localStore,e);e.targetChanges.forEach((i,s)=>{const o=n.Au.get(s);o&&(ye(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.hu=!0:i.modifiedDocuments.size>0?ye(o.hu,14607):i.removedDocuments.size>0&&(ye(o.hu,42227),o.hu=!1))}),await nc(n,r,e)}catch(r){await mo(r)}}function VI(t,e,n){const r=Ae(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Tu.forEach((s,o)=>{const a=o.view.va(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){const l=Ae(o);l.onlineState=a;let u=!1;l.queries.forEach((f,m)=>{for(const g of m.Sa)g.va(a)&&(u=!0)}),u&&ry(l)}(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function ZO(t,e,n){const r=Ae(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Au.get(e),s=i&&i.key;if(s){let o=new lt(oe.comparator);o=o.insert(s,yt.newNoDocument(s,Te.min()));const a=ke().add(s),l=new gf(Te.min(),new Map,new lt(Ce),o,a);await kx(r,l),r.du=r.du.remove(s),r.Au.delete(e),oy(r)}else await rg(r.localStore,e,!1).then(()=>og(r,e,n)).catch(mo)}async function e3(t,e){const n=Ae(t),r=e.batch.batchId;try{const i=await cO(n.localStore,e);Dx(n,r,null),Nx(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await nc(n,i)}catch(i){await mo(i)}}async function t3(t,e,n){const r=Ae(t);try{const i=await function(o,a){const l=Ae(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let f;return l.mutationQueue.lookupMutationBatch(u,a).next(m=>(ye(m!==null,37113),f=m.keys(),l.mutationQueue.removeMutationBatch(u,m))).next(()=>l.mutationQueue.performConsistencyCheck(u)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(u,f,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,f)).next(()=>l.localDocuments.getDocuments(u,f))})}(r.localStore,e);Dx(r,e,n),Nx(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await nc(r,i)}catch(i){await mo(i)}}function Nx(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function Dx(t,e,n){const r=Ae(t);let i=r.Vu[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Vu[r.currentUser.toKey()]=i}}function og(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(r=>{t.Ru.containsKey(r)||bx(t,r)})}function bx(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(J_(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),oy(t))}function LI(t,e,n){for(const r of n)r instanceof xx?(t.Ru.addReference(r.key,e),n3(t,r)):r instanceof Rx?(Z(sy,"Document no longer in limbo: "+r.key),t.Ru.removeReference(r.key,e),t.Ru.containsKey(r.key)||bx(t,r.key)):fe(19791,{wu:r})}function n3(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Eu.has(r)||(Z(sy,"New document in limbo: "+n),t.Eu.add(r),oy(t))}function oy(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new oe(ze.fromString(e)),r=t.fu.next();t.Au.set(r,new HO(n)),t.du=t.du.insert(n,r),Ex(t.remoteStore,new $r(Wn(Yu(n.path)),r,"TargetPurposeLimboResolution",zn.ce))}}async function nc(t,e,n){const r=Ae(t),i=[],s=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((a,l)=>{o.push(r.pu(l,e,n).then(u=>{var f;if((u||n)&&r.isPrimaryClient){const m=u?!u.fromCache:(f=n==null?void 0:n.targetChanges.get(l.targetId))==null?void 0:f.current;r.sharedClientState.updateQueryState(l.targetId,m?"current":"not-current")}if(u){i.push(u);const m=j_.As(l.targetId,u);s.push(m)}}))}),await Promise.all(o),r.Pu.H_(i),await async function(l,u){const f=Ae(l);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>G.forEach(u,g=>G.forEach(g.Es,v=>f.persistence.referenceDelegate.addReference(m,g.targetId,v)).next(()=>G.forEach(g.ds,v=>f.persistence.referenceDelegate.removeReference(m,g.targetId,v)))))}catch(m){if(!as(m))throw m;Z(K_,"Failed to update sequence numbers: "+m)}for(const m of u){const g=m.targetId;if(!m.fromCache){const v=f.Ms.get(g),T=v.snapshotVersion,P=v.withLastLimboFreeSnapshotVersion(T);f.Ms=f.Ms.insert(g,P)}}}(r.localStore,s))}async function r3(t,e){const n=Ae(t);if(!n.currentUser.isEqual(e)){Z(sy,"User change. New user:",e.toKey());const r=await gx(n.localStore,e);n.currentUser=e,function(s,o){s.mu.forEach(a=>{a.forEach(l=>{l.reject(new re(J.CANCELLED,o))})}),s.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await nc(n,r.Ls)}}function i3(t,e){const n=Ae(t),r=n.Au.get(e);if(r&&r.hu)return ke().add(r.key);{let i=ke();const s=n.Iu.get(e);if(!s)return i;for(const o of s){const a=n.Tu.get(o);i=i.unionWith(a.view.nu)}return i}}function Mx(t){const e=Ae(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=kx.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=i3.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=ZO.bind(null,e),e.Pu.H_=GO.bind(null,e.eventManager),e.Pu.yu=qO.bind(null,e.eventManager),e}function Vx(t){const e=Ae(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=e3.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=t3.bind(null,e),e}class Vu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Tf(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return mx(this.persistence,new px,e.initialUser,this.serializer)}Cu(e){return new H_(vf.mi,this.serializer)}Du(e){return new yx}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Vu.provider={build:()=>new Vu};class s3 extends Vu{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){ye(this.persistence.referenceDelegate instanceof xh,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new ux(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?Qt.withCacheSize(this.cacheSizeBytes):Qt.DEFAULT;return new H_(r=>xh.mi(r,n),this.serializer)}}class o3 extends Vu{constructor(e,n,r){super(),this.xu=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await Vx(this.xu.syncEngine),await tc(this.xu.remoteStore),await this.persistence.Ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}vu(e){return mx(this.persistence,new px,e.initialUser,this.serializer)}Fu(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new ux(r,e.asyncQueue,n)}Mu(e,n){const r=new hU(n,this.persistence);return new dU(e.asyncQueue,r)}Cu(e){const n=oO(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Qt.withCacheSize(this.cacheSizeBytes):Qt.DEFAULT;return new W_(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,EO(),Dd(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new yx}}class Ph{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>VI(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=r3.bind(null,this.syncEngine),await UO(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new BO}()}createDatastore(e){const n=Tf(e.databaseInfo.databaseId),r=function(s){return new TO(s)}(e.databaseInfo);return function(s,o,a,l){return new CO(s,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,a){return new xO(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>VI(this.syncEngine,n,0),function(){return PI.v()?new PI:new gO}())}createSyncEngine(e,n){return function(i,s,o,a,l,u,f){const m=new WO(i,s,o,a,l,u);return f&&(m.gu=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(i){const s=Ae(i);Z(co,"RemoteStore shutting down."),s.Ea.add(5),await ec(s),s.Aa.shutdown(),s.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}Ph.provider={build:()=>new Ph};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ay{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):sn("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ns="FirestoreClient";class a3{constructor(e,n,r,i,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=zt.UNAUTHENTICATED,this.clientId=nf.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{Z(ns,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(Z(ns,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Cr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=ey(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Cp(t,e){t.asyncQueue.verifyOperationInProgress(),Z(ns,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await gx(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function FI(t,e){t.asyncQueue.verifyOperationInProgress();const n=await l3(t);Z(ns,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>NI(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>NI(e.remoteStore,i)),t._onlineComponents=e}async function l3(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Z(ns,"Using user provided OfflineComponentProvider");try{await Cp(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(i){return i.name==="FirebaseError"?i.code===J.FAILED_PRECONDITION||i.code===J.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;Yi("Error using user provided cache. Falling back to memory cache: "+n),await Cp(t,new Vu)}}else Z(ns,"Using default OfflineComponentProvider"),await Cp(t,new s3(void 0));return t._offlineComponents}async function Lx(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Z(ns,"Using user provided OnlineComponentProvider"),await FI(t,t._uninitializedComponentsProvider._online)):(Z(ns,"Using default OnlineComponentProvider"),await FI(t,new Ph))),t._onlineComponents}function u3(t){return Lx(t).then(e=>e.syncEngine)}async function kh(t){const e=await Lx(t),n=e.eventManager;return n.onListen=jO.bind(null,e.syncEngine),n.onUnlisten=QO.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=KO.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=YO.bind(null,e.syncEngine),n}function c3(t,e,n={}){const r=new Cr;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,u){const f=new ay({next:g=>{f.Nu(),o.enqueueAndForget(()=>ny(s,m));const v=g.docs.has(a);!v&&g.fromCache?u.reject(new re(J.UNAVAILABLE,"Failed to get document because the client is offline.")):v&&g.fromCache&&l&&l.source==="server"?u.reject(new re(J.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(g)},error:g=>u.reject(g)}),m=new iy(Yu(a.path),f,{includeMetadataChanges:!0,qa:!0});return ty(s,m)}(await kh(t),t.asyncQueue,e,n,r)),r.promise}function d3(t,e,n={}){const r=new Cr;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,u){const f=new ay({next:g=>{f.Nu(),o.enqueueAndForget(()=>ny(s,m)),g.fromCache&&l.source==="server"?u.reject(new re(J.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(g)},error:g=>u.reject(g)}),m=new iy(a,f,{includeMetadataChanges:!0,qa:!0});return ty(s,m)}(await kh(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fx(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UI=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ux="firestore.googleapis.com",OI=!0;class BI{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new re(J.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Ux,this.ssl=OI}else this.host=e.host,this.ssl=e.ssl??OI;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=sx;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<z4)throw new re(J.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}W0("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Fx(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new re(J.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new re(J.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new re(J.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class If{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new BI({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new re(J.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new re(J.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new BI(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new z0;switch(r.type){case"firstParty":return new nU(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new re(J.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=UI.get(n);r&&(Z("ComponentProvider","Removing Datastore"),UI.delete(n),r.terminate())}(this),Promise.resolve()}}function Ox(t,e,n,r={}){var u;t=ln(t,If);const i=za(e),s=t._getSettings(),o={...s,emulatorOptions:t._getEmulatorOptions()},a=`${e}:${n}`;i&&(HC(`https://${a}`),WC("Firestore",!0)),s.host!==Ux&&s.host!==a&&Yi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...s,host:a,ssl:i,emulatorOptions:r};if(!ro(l,o)&&(t._setSettings(l),r.mockUserToken)){let f,m;if(typeof r.mockUserToken=="string")f=r.mockUserToken,m=zt.MOCK_USER;else{f=x2(r.mockUserToken,(u=t._app)==null?void 0:u.options.projectId);const g=r.mockUserToken.sub||r.mockUserToken.user_id;if(!g)throw new re(J.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");m=new zt(g)}t._authCredentials=new ZF(new q0(f,m))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class us{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new us(this.firestore,e,this._query)}}class ft{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Wr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ft(this.firestore,e,this._key)}toJSON(){return{type:ft._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(ju(n,ft._jsonSchema))return new ft(e,r||null,new oe(ze.fromString(n.referencePath)))}}ft._jsonSchemaVersion="firestore/documentReference/1.0",ft._jsonSchema={type:xt("string",ft._jsonSchemaVersion),referencePath:xt("string")};class Wr extends us{constructor(e,n,r){super(e,n,Yu(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ft(this.firestore,null,new oe(e))}withConverter(e){return new Wr(this.firestore,e,this._path)}}function it(t,e,...n){if(t=bt(t),H0("collection","path",e),t instanceof If){const r=ze.fromString(e,...n);return kE(r),new Wr(t,null,r)}{if(!(t instanceof ft||t instanceof Wr))throw new re(J.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ze.fromString(e,...n));return kE(r),new Wr(t.firestore,null,r)}}function Ue(t,e,...n){if(t=bt(t),arguments.length===1&&(e=nf.newId()),H0("doc","path",e),t instanceof If){const r=ze.fromString(e,...n);return PE(r),new ft(t,null,new oe(r))}{if(!(t instanceof ft||t instanceof Wr))throw new re(J.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ze.fromString(e,...n));return PE(r),new ft(t.firestore,t instanceof Wr?t.converter:null,new oe(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GI="AsyncQueue";class qI{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new vx(this,"async_queue_retry"),this._c=()=>{const r=Dd();r&&Z(GI,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=Dd();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=Dd();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new Cr;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!as(e))throw e;Z(GI,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,sn("INTERNAL UNHANDLED ERROR: ",zI(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const i=Z_.createAndSchedule(this,e,n,r,s=>this.hc(s));return this.tc.push(i),i}uc(){this.nc&&fe(47125,{Pc:zI(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function zI(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $I(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const i=n;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}class Rr extends If{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new qI,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new qI(e),this._firestoreClient=void 0,await e}}}function Bx(t,e){const n=typeof t=="object"?t:e0(),r=typeof t=="string"?t:yh,i=p_(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=C2("firestore");s&&Ox(i,...s)}return i}function rc(t){if(t._terminated)throw new re(J.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||Gx(t),t._firestoreClient}function Gx(t){var r,i,s;const e=t._freezeSettings(),n=function(a,l,u,f){return new GU(a,l,u,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,Fx(f.experimentalLongPollingOptions),f.useFetchStreams,f.isUsingEmulator)}(t._databaseId,((r=t._app)==null?void 0:r.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(i=e.localCache)!=null&&i._offlineComponentProvider&&((s=e.localCache)!=null&&s._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new a3(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(t._componentsProvider))}function qx(t,e){Yi("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings();return h3(t,Ph.provider,{build:r=>new o3(r,n.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}function h3(t,e,n){if((t=ln(t,Rr))._firestoreClient||t._terminated)throw new re(J.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new re(J.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:n},Gx(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new xn(Et.fromBase64String(e))}catch(n){throw new re(J.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new xn(Et.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:xn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(ju(e,xn._jsonSchema))return xn.fromBase64String(e.bytes)}}xn._jsonSchemaVersion="firestore/bytes/1.0",xn._jsonSchema={type:xt("string",xn._jsonSchemaVersion),bytes:xt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ic{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new re(J.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new at(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sc{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class or{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new re(J.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new re(J.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Ce(this._lat,e._lat)||Ce(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:or._jsonSchemaVersion}}static fromJSON(e){if(ju(e,or._jsonSchema))return new or(e.latitude,e.longitude)}}or._jsonSchemaVersion="firestore/geoPoint/1.0",or._jsonSchema={type:xt("string",or._jsonSchemaVersion),latitude:xt("number"),longitude:xt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ar{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}toJSON(){return{type:ar._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(ju(e,ar._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new ar(e.vectorValues);throw new re(J.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ar._jsonSchemaVersion="firestore/vectorValue/1.0",ar._jsonSchema={type:xt("string",ar._jsonSchemaVersion),vectorValues:xt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f3=/^__.*__$/;class p3{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new si(e,this.data,this.fieldMask,n,this.fieldTransforms):new ja(e,this.data,n,this.fieldTransforms)}}class zx{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new si(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function $x(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw fe(40011,{Ac:t})}}class ly{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new ly({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var i;const n=(i=this.path)==null?void 0:i.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){var i;const n=(i=this.path)==null?void 0:i.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Nh(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if($x(this.Ac)&&f3.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class m3{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Tf(e)}Cc(e,n,r,i=!1){return new ly({Ac:e,methodName:n,Dc:r,path:at.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function uy(t){const e=t._freezeSettings(),n=Tf(t._databaseId);return new m3(t._databaseId,!!e.ignoreUndefinedProperties,n)}function g3(t,e,n,r,i,s={}){const o=t.Cc(s.merge||s.mergeFields?2:0,e,n,i);dy("Data must be an object, but it was:",o,r);const a=Hx(r,o);let l,u;if(s.merge)l=new mn(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const f=[];for(const m of s.mergeFields){const g=ag(e,m,n);if(!o.contains(g))throw new re(J.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);jx(f,g)||f.push(g)}l=new mn(f),u=o.fieldTransforms.filter(m=>l.covers(m.field))}else l=null,u=o.fieldTransforms;return new p3(new Xt(a),l,u)}class wf extends sc{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof wf}}class cy extends sc{_toFieldTransform(e){return new LA(e.path,new Da)}isEqual(e){return e instanceof cy}}function _3(t,e,n,r){const i=t.Cc(1,e,n);dy("Data must be an object, but it was:",i,r);const s=[],o=Xt.empty();ls(r,(l,u)=>{const f=hy(e,l,n);u=bt(u);const m=i.yc(f);if(u instanceof wf)s.push(f);else{const g=oc(u,m);g!=null&&(s.push(f),o.set(f,g))}});const a=new mn(s);return new zx(o,a,i.fieldTransforms)}function y3(t,e,n,r,i,s){const o=t.Cc(1,e,n),a=[ag(e,r,n)],l=[i];if(s.length%2!=0)throw new re(J.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<s.length;g+=2)a.push(ag(e,s[g])),l.push(s[g+1]);const u=[],f=Xt.empty();for(let g=a.length-1;g>=0;--g)if(!jx(u,a[g])){const v=a[g];let T=l[g];T=bt(T);const P=o.yc(v);if(T instanceof wf)u.push(v);else{const D=oc(T,P);D!=null&&(u.push(v),f.set(v,D))}}const m=new mn(u);return new zx(f,m,o.fieldTransforms)}function v3(t,e,n,r=!1){return oc(n,t.Cc(r?4:3,e))}function oc(t,e){if(Wx(t=bt(t)))return dy("Unsupported field value:",e,t),Hx(t,e);if(t instanceof sc)return function(r,i){if(!$x(i.Ac))throw i.Sc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const a of r){let l=oc(a,i.wc(o));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=bt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return a4(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=We.fromDate(r);return{timestampValue:Va(i.serializer,s)}}if(r instanceof We){const s=new We(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Va(i.serializer,s)}}if(r instanceof or)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof xn)return{bytesValue:zA(i.serializer,r._byteString)};if(r instanceof ft){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:G_(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof ar)return function(o,a){return{mapValue:{fields:{[b_]:{stringValue:M_},[Ra]:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw a.Sc("VectorValues must only contain numeric values.");return L_(a.serializer,u)})}}}}}}(r,i);throw i.Sc(`Unsupported field value: ${rf(r)}`)}(t,e)}function Hx(t,e){const n={};return lA(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ls(t,(r,i)=>{const s=oc(i,e.mc(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function Wx(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof We||t instanceof or||t instanceof xn||t instanceof ft||t instanceof sc||t instanceof ar)}function dy(t,e,n){if(!Wx(n)||!j0(n)){const r=rf(n);throw r==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+r)}}function ag(t,e,n){if((e=bt(e))instanceof ic)return e._internalPath;if(typeof e=="string")return hy(t,e);throw Nh("Field path arguments must be of type string or ",t,!1,void 0,n)}const T3=new RegExp("[~\\*/\\[\\]]");function hy(t,e,n){if(e.search(T3)>=0)throw Nh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new ic(...e.split("."))._internalPath}catch{throw Nh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Nh(t,e,n,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new re(J.INVALID_ARGUMENT,a+t+l)}function jx(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kx{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new ft(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new E3(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(fy("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class E3 extends Kx{data(){return super.data()}}function fy(t,e){return typeof e=="string"?hy(t,e):e instanceof ic?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jx(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new re(J.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class py{}class Qx extends py{}function Vl(t,e,...n){let r=[];e instanceof py&&r.push(e),r=r.concat(n),function(s){const o=s.filter(l=>l instanceof Sf).length,a=s.filter(l=>l instanceof ac).length;if(o>1||o>0&&a>0)throw new re(J.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class ac extends Qx{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new ac(e,n,r)}_apply(e){const n=this._parse(e);return Yx(e._query,n),new us(e.firestore,e.converter,Km(e._query,n))}_parse(e){const n=uy(e.firestore);return function(s,o,a,l,u,f,m){let g;if(u.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new re(J.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){WI(m,f);const T=[];for(const P of m)T.push(HI(l,s,P));g={arrayValue:{values:T}}}else g=HI(l,s,m)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||WI(m,f),g=v3(a,o,m,f==="in"||f==="not-in");return Le.create(u,f,g)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Ll(t,e,n){const r=e,i=fy("where",t);return ac._create(i,r,n)}class Sf extends py{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Sf(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Je.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i;const a=s.getFlattenedFilters();for(const l of a)Yx(o,l),o=Km(o,l)}(e._query,n),new us(e.firestore,e.converter,Km(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function HI(t,e,n){if(typeof(n=bt(n))=="string"){if(n==="")throw new re(J.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!CA(e)&&n.indexOf("/")!==-1)throw new re(J.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(ze.fromString(n));if(!oe.isDocumentKey(r))throw new re(J.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Du(t,new oe(r))}if(n instanceof ft)return Du(t,n._key);throw new re(J.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${rf(n)}.`)}function WI(t,e){if(!Array.isArray(t)||t.length===0)throw new re(J.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Yx(t,e){const n=function(i,s){for(const o of i)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new re(J.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new re(J.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class Xx{convertValue(e,n="none"){switch(Zi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return st(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(ei(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw fe(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return ls(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertVectorValue(e){var r,i,s;const n=(s=(i=(r=e.fields)==null?void 0:r[Ra].arrayValue)==null?void 0:i.values)==null?void 0:s.map(o=>st(o.doubleValue));return new ar(n)}convertGeoPoint(e){return new or(st(e.latitude),st(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=cf(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(ku(e));default:return null}}convertTimestamp(e){const n=Zr(e);return new We(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=ze.fromString(e);ye(ZA(r),9688,{name:e});const i=new Xi(r.get(1),r.get(3)),s=new oe(r.popFirst(5));return i.isEqual(n)||sn(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I3(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class ea{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Wi extends Kx{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new ru(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(fy("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new re(J.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Wi._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}Wi._jsonSchemaVersion="firestore/documentSnapshot/1.0",Wi._jsonSchema={type:xt("string",Wi._jsonSchemaVersion),bundleSource:xt("string","DocumentSnapshot"),bundleName:xt("string"),bundle:xt("string")};class ru extends Wi{data(e={}){return super.data(e)}}class ji{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new ea(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new ru(this._firestore,this._userDataWriter,r.key,r,new ea(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new re(J.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{const l=new ru(i._firestore,i._userDataWriter,a.doc.key,a.doc,new ea(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{const l=new ru(i._firestore,i._userDataWriter,a.doc.key,a.doc,new ea(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let u=-1,f=-1;return a.type!==0&&(u=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),f=o.indexOf(a.doc.key)),{type:w3(a.type),doc:l,oldIndex:u,newIndex:f}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new re(J.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=ji._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=nf.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],i=[];return this.docs.forEach(s=>{s._document!==null&&(n.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function w3(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return fe(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lg(t){t=ln(t,ft);const e=ln(t.firestore,Rr);return c3(rc(e),t._key).then(n=>Zx(e,t,n))}ji._jsonSchemaVersion="firestore/querySnapshot/1.0",ji._jsonSchema={type:xt("string",ji._jsonSchemaVersion),bundleSource:xt("string","QuerySnapshot"),bundleName:xt("string"),bundle:xt("string")};class my extends Xx{constructor(e){super(),this.firestore=e}convertBytes(e){return new xn(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new ft(this.firestore,null,n)}}function Ti(t){t=ln(t,us);const e=ln(t.firestore,Rr),n=rc(e),r=new my(e);return Jx(t._query),d3(n,t._query).then(i=>new ji(e,r,t,i))}function gt(t,e,n){t=ln(t,ft);const r=ln(t.firestore,Rr),i=I3(t.converter,e,n);return Cf(r,[g3(uy(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,on.none())])}function ug(t,e,n,...r){t=ln(t,ft);const i=ln(t.firestore,Rr),s=uy(i);let o;return o=typeof(e=bt(e))=="string"||e instanceof ic?y3(s,"updateDoc",t._key,e,n,r):_3(s,"updateDoc",t._key,e),Cf(i,[o.toMutation(t._key,on.exists(!0))])}function Gt(t){return Cf(ln(t.firestore,Rr),[new mf(t._key,on.none())])}function Lr(t,...e){var l,u,f;t=bt(t);let n={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||$I(e[r])||(n=e[r++]);const i={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if($I(e[r])){const m=e[r];e[r]=(l=m.next)==null?void 0:l.bind(m),e[r+1]=(u=m.error)==null?void 0:u.bind(m),e[r+2]=(f=m.complete)==null?void 0:f.bind(m)}let s,o,a;if(t instanceof ft)o=ln(t.firestore,Rr),a=Yu(t._key.path),s={next:m=>{e[r]&&e[r](Zx(o,t,m))},error:e[r+1],complete:e[r+2]};else{const m=ln(t,us);o=ln(m.firestore,Rr),a=m._query;const g=new my(o);s={next:v=>{e[r]&&e[r](new ji(o,g,m,v))},error:e[r+1],complete:e[r+2]},Jx(t._query)}return function(g,v,T,P){const D=new ay(P),S=new iy(v,D,T);return g.asyncQueue.enqueueAndForget(async()=>ty(await kh(g),S)),()=>{D.Nu(),g.asyncQueue.enqueueAndForget(async()=>ny(await kh(g),S))}}(rc(o),a,i,s)}function Cf(t,e){return function(r,i){const s=new Cr;return r.asyncQueue.enqueueAndForget(async()=>XO(await u3(r),i,s)),s.promise}(rc(t),e)}function Zx(t,e,n){const r=n.docs.get(e._key),i=new my(t);return new Wi(t,i,e._key,r,new ea(n.hasPendingWrites,n.fromCache),e.converter)}function S3(){return new cy("serverTimestamp")}(function(e,n=!0){(function(i){Wa=i})($a),Ea(new io("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),a=new Rr(new eU(r.getProvider("auth-internal")),new rU(o,r.getProvider("app-check-internal")),function(u,f){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new re(J.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Xi(u.options.projectId,f)}(o,i),o);return s={useFetchStreams:n,...s},a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),zi(CE,AE,e),zi(CE,AE,"esm2020")})();const Ps=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:Xx,Bytes:xn,CollectionReference:Wr,DocumentReference:ft,DocumentSnapshot:Wi,FieldPath:ic,FieldValue:sc,Firestore:Rr,FirestoreError:re,GeoPoint:or,Query:us,QueryCompositeFilterConstraint:Sf,QueryConstraint:Qx,QueryDocumentSnapshot:ru,QueryFieldFilterConstraint:ac,QuerySnapshot:ji,SnapshotMetadata:ea,Timestamp:We,VectorValue:ar,_AutoId:nf,_ByteString:Et,_DatabaseId:Xi,_DocumentKey:oe,_EmptyAuthCredentialsProvider:z0,_FieldPath:at,_cast:ln,_logWarn:Yi,_validateIsNotUsedTogether:W0,collection:it,connectFirestoreEmulator:Ox,deleteDoc:Gt,doc:Ue,enableIndexedDbPersistence:qx,ensureFirestoreConfigured:rc,executeWrite:Cf,getDoc:lg,getDocs:Ti,getFirestore:Bx,onSnapshot:Lr,query:Vl,serverTimestamp:S3,setDoc:gt,setLogLevel:B0,updateDoc:ug,where:Ll},Symbol.toStringTag,{value:"Module"}));B0("error");const C3={apiKey:"AIzaSyC1zhlBnbOxP_PCaHU6L-UsDOBRTjGgpfk",authDomain:"my-apss-da774.firebaseapp.com",projectId:"my-apss-da774",storageBucket:"my-apss-da774.firebasestorage.app",messagingSenderId:"528434940137",appId:"1:528434940137:web:56be66185a46f390b60878",measurementId:"G-WPGZGF4ZBG"},eR=ZC(C3),Ei=YF(eR);UL(Ei,S0).catch(t=>console.error("Persistence error:",t));const Qs=new Or;Qs.addScope("profile");Qs.addScope("email");Qs.setCustomParameters({prompt:"select_account",access_type:"offline"});if(typeof window<"u"){const t=navigator.userAgent.toLowerCase();t.includes("safari")&&!t.includes("chrome")&&!t.includes("firefox")&&Qs.setCustomParameters({prompt:"consent"})}const ge=Bx(eR);qx(ge).catch(t=>{t.code==="failed-precondition"?console.warn("Firestore: Multiple tabs open, persistence disabled"):t.code==="unimplemented"&&console.warn("Firestore: Browser does not support persistence")});const rd=()=>{const e=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Mobile|Tablet/i.test(navigator.userAgent),n=navigator.maxTouchPoints&&navigator.maxTouchPoints>2,r=window.innerWidth<=768;return console.log("Mobile detection:",{isUserAgentMobile:e,isTouchDevice:n,isSmallScreen:r,userAgent:navigator.userAgent}),e||n&&r},jI=()=>window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0,Pt=t=>{if(t==null)return;if(typeof t!="object")return t;if(Array.isArray(t)){const r=t.filter(i=>i!==void 0).map(i=>Pt(i)).filter(i=>i!==void 0);return r.length>0?r:void 0}if(t===null)return;let e;try{e=Object.entries(t)}catch(r){console.error(" Object.entries :",r,t);return}const n={};for(const[r,i]of e){if(i===void 0||typeof i=="string"&&i.trim()===""){console.warn(`  : ${r} = ${i}`);continue}if(typeof i=="object"&&i!==null){const s=Pt(i);s!==void 0?n[r]=s:console.warn(`  / : ${r}`)}else n[r]=i}return Object.keys(n).length>0?n:void 0},KI=()=>window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",tR=async()=>"Notification"in window?Notification.permission==="granted"?!0:Notification.permission!=="denied"?await Notification.requestPermission()==="granted":!1:(console.log("This browser does not support notifications"),!1),nR=async()=>{try{if(!("serviceWorker"in navigator)||!("PushManager"in window))return console.log("Push notifications not supported"),!1;const e=await(await navigator.serviceWorker.ready).pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:A3("BOEd9nQKXBj8LJXNM6LJt6Nua5MJMhF8cCQvMNJ-2NWoWsM0cGgNqDG3kNm-QMYbdMDYAXaJ55MFP_fPHqH7SFA")});return await x3(e),!0}catch(t){return console.error("Failed to subscribe to push notifications:",t),!1}},A3=t=>{const e="=".repeat((4-t.length%4)%4),n=(t+e).replace(/\-/g,"+").replace(/_/g,"/"),r=window.atob(n),i=new Uint8Array(r.length);for(let s=0;s<r.length;++s)i[s]=r.charCodeAt(s);return i},x3=async t=>{try{(await fetch("/api/subscribe",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({subscription:t.toJSON(),endpoint:t.endpoint})})).ok||console.error("Failed to send subscription to server")}catch(e){console.error("Error sending subscription to server:",e)}},R3=({onClose:t})=>{const[e,n]=z.useState(null),[r,i]=z.useState(!1),[s,o]=z.useState(!1);z.useEffect(()=>{const l=/iPad|iPhone|iPod/.test(navigator.userAgent),f=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Mobile|Tablet/i.test(navigator.userAgent);i(l),o(f);const m=g=>{g.preventDefault(),n(g)};return window.addEventListener("beforeinstallprompt",m),()=>{window.removeEventListener("beforeinstallprompt",m)}},[]);const a=async()=>{if(e){e.prompt();const{outcome:l}=await e.userChoice;l==="accepted"&&(n(null),t())}};return s?p.jsx("div",{className:"pwa-fullscreen-prompt",children:p.jsxs("div",{className:"pwa-fullscreen-content",children:[p.jsxs("div",{className:"pwa-fullscreen-header",children:[p.jsx("div",{className:"w-20 h-20 bg-indigo-600 rounded-lg mx-auto mb-6 flex items-center justify-center",children:p.jsx("span",{className:"text-white text-4xl font-bold",children:"N"})}),p.jsx("h2",{className:"text-3xl font-bold text-white mb-3",children:"Nova  "}),p.jsx("p",{className:"text-lg text-gray-200 mb-4",children:"     "})]}),p.jsx("div",{className:"pwa-fullscreen-body",children:r?p.jsxs("div",{children:[p.jsx("div",{className:"pwa-instruction-box mb-6",children:p.jsx("p",{className:"text-white font-semibold mb-4",children:" iOS  :"})}),p.jsxs("ol",{className:"pwa-instruction-steps",children:[p.jsxs("li",{className:"pwa-instruction-step",children:[p.jsx("div",{className:"step-number",children:"1"}),p.jsxs("div",{className:"step-content",children:[p.jsx("p",{className:"font-semibold",children:"   "}),p.jsx("p",{className:"text-sm",children:"    () "})]})]}),p.jsxs("li",{className:"pwa-instruction-step",children:[p.jsx("div",{className:"step-number",children:"2"}),p.jsxs("div",{className:"step-content",children:[p.jsx("p",{className:"font-semibold",children:"   "}),p.jsx("p",{className:"text-sm",children:'   "  " '})]})]}),p.jsxs("li",{className:"pwa-instruction-step",children:[p.jsx("div",{className:"step-number",children:"3"}),p.jsxs("div",{className:"step-content",children:[p.jsx("p",{className:"font-semibold",children:"  "}),p.jsx("p",{className:"text-sm",children:'  ""    '})]})]})]})]}):p.jsxs("div",{children:[p.jsx("div",{className:"pwa-instruction-box mb-6",children:p.jsx("p",{className:"text-white font-semibold mb-4",children:" Android  :"})}),p.jsxs("ol",{className:"pwa-instruction-steps",children:[p.jsxs("li",{className:"pwa-instruction-step",children:[p.jsx("div",{className:"step-number",children:"1"}),p.jsxs("div",{className:"step-content",children:[p.jsx("p",{className:"font-semibold",children:"  "}),p.jsx("p",{className:"text-sm",children:"    ()    "})]})]}),p.jsxs("li",{className:"pwa-instruction-step",children:[p.jsx("div",{className:"step-number",children:"2"}),p.jsxs("div",{className:"step-content",children:[p.jsx("p",{className:"font-semibold",children:"  "}),p.jsx("p",{className:"text-sm",children:'"  "  " "  '})]})]}),p.jsxs("li",{className:"pwa-instruction-step",children:[p.jsx("div",{className:"step-number",children:"3"}),p.jsxs("div",{className:"step-content",children:[p.jsx("p",{className:"font-semibold",children:" "}),p.jsx("p",{className:"text-sm",children:'  ""   '})]})]})]}),e&&p.jsx("button",{onClick:a,className:"pwa-install-button mt-6",children:" "})]})}),p.jsx("div",{className:"pwa-fullscreen-footer",children:p.jsx("p",{className:"text-gray-300 text-sm mb-4",children:"       "})})]})}):p.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:p.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-sm w-full",children:[p.jsxs("div",{className:"text-center mb-4",children:[p.jsx("div",{className:"w-16 h-16 bg-indigo-600 rounded-lg mx-auto mb-4 flex items-center justify-center",children:p.jsx("span",{className:"text-white text-2xl font-bold",children:"N"})}),p.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:" "}),p.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-sm",children:"Nova Beta      ."})]}),r?p.jsxs("div",{className:"mb-4",children:[p.jsx("div",{className:"bg-blue-50 dark:bg-blue-900 p-3 rounded-lg mb-3",children:p.jsx("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:"iOS  :"})}),p.jsxs("ol",{className:"text-sm text-gray-600 dark:text-gray-300 space-y-2",children:[p.jsxs("li",{className:"flex items-center",children:[p.jsx("span",{className:"w-6 h-6 bg-indigo-600 text-white rounded-full flex items-center justify-center text-xs mr-2",children:"1"}),"   () "]}),p.jsxs("li",{className:"flex items-center",children:[p.jsx("span",{className:"w-6 h-6 bg-indigo-600 text-white rounded-full flex items-center justify-center text-xs mr-2",children:"2"}),'"  " ']}),p.jsxs("li",{className:"flex items-center",children:[p.jsx("span",{className:"w-6 h-6 bg-indigo-600 text-white rounded-full flex items-center justify-center text-xs mr-2",children:"3"}),'""  ']})]})]}):p.jsx("div",{className:"mb-4",children:e?p.jsx("button",{onClick:a,className:"w-full bg-indigo-600 text-white py-2 px-4 rounded-lg hover:bg-indigo-700 transition-colors",children:" "}):p.jsx("div",{className:"bg-gray-50 dark:bg-gray-700 p-3 rounded-lg",children:p.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:'  "  "  " " .'})})}),p.jsxs("div",{className:"flex space-x-2",children:[p.jsx("button",{onClick:t,className:"flex-1 bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-gray-200 py-2 px-4 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-500 transition-colors",children:""}),p.jsx("button",{onClick:()=>{localStorage.setItem("pwa-prompt-dismissed","true"),t()},className:"flex-1 bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-gray-200 py-2 px-4 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-500 transition-colors",children:"  "})]})]})})},P3=({todos:t,onEditTodo:e,t:n})=>{var o,a,l,u;const r=z.useMemo(()=>{const f={};return t.forEach(m=>{m.wish&&!f.wish&&(f.wish=m),m.outcome&&!f.outcome&&(f.outcome=m),m.obstacle&&!f.obstacle&&(f.obstacle=m),m.plan&&!f.plan&&(f.plan=m)}),f},[t]);if(!(r.wish||r.outcome||r.obstacle||r.plan))return null;const s=(f,m,g)=>p.jsxs("div",{className:"woop-card",onClick:()=>g&&e(g),children:[p.jsxs("div",{className:"woop-card-label",children:[" ",f]}),p.jsx("div",{className:"woop-card-content",children:m?m.length>150?`${m.substring(0,150)}...`:m:p.jsx("span",{className:"woop-card-empty",children:""})}),g&&p.jsx("div",{className:"woop-card-actions",children:p.jsx("button",{className:"woop-card-btn",onClick:v=>{v.stopPropagation(),e(g)},children:""})})]});return p.jsxs("div",{className:"woop-section",children:[p.jsx("div",{className:"woop-title",children:" WOOP  (Wish, Outcome, Obstacle, Plan)"}),p.jsxs("div",{className:"woop-cards-container",children:[s("Wish ()",(o=r.wish)==null?void 0:o.wish,r.wish),s("Outcome ()",(a=r.outcome)==null?void 0:a.outcome,r.outcome),s("Obstacle ()",(l=r.obstacle)==null?void 0:l.obstacle,r.obstacle),s("Plan ()",(u=r.plan)==null?void 0:u.plan,r.plan)]})]})},k3={ko:{language_selection_title:"",error_wish_required:" .",error_outcome_required:" .",error_obstacle_required:" .",error_plan_required:"If-Then  .",error_deadline_required:" .",error_day_required:"   .",my_goals_title:" ",all_goals_label:" ",sort_label_manual:"",sort_label_deadline:"",sort_label_newest:"",sort_label_alphabetical:"",sort_label_ai:" ",ai_sorting_button:" ...",add_new_goal_button_label:"  ",filter_all:" ",filter_active:"",filter_completed:"",filter_category:"",category_all:" ",category_school:"",category_work:"",category_personal:"",category_other:"",category_label:" ",empty_message_all:"+   ",empty_message_active:"  .",empty_message_completed:"   .",empty_encouragement_1:"    .",empty_encouragement_2:"    .",empty_encouragement_3:"    .",empty_encouragement_4:"     .",delete_button:"",edit_button_aria:"",info_button_aria:"",filter_title:"",sort_title:"",filter_sort_button_aria:"  ",calendar_view_button_aria:" ",list_view_button_aria:" ",more_options_button_aria:"",select_button_label:"",cancel_selection_button_label:"",delete_selected_button_label:"{count} ",select_all_button_label:"",delete_selected_confirm_title:" ",delete_selected_confirm_message:" {count}   .     .",days_left:"{count} ",d_day:"",days_overdue:"{count} ",month_names:["1","2","3","4","5","6","7","8","9","10","11","12"],day_names_short:["","","","","","",""],day_names_long:["","","","","","",""],calendar_header_month_format:"{year} {month}",calendar_view_day3:"3",calendar_view_week:"",calendar_view_month:"",settings_title:"",sort_alert_title:" ",sort_alert_message:"  <br/>2   .",ai_sort_error_title:" ",ai_sort_error_message:"   .   .",confirm_button:"",new_goal_modal_title:" ",edit_goal_modal_title:" ",wish_label:"",outcome_label:" ",obstacle_label:"",plan_label:"If-Then ",deadline_label:"",cancel_button:"",add_button:"",save_button:"",goal_details_modal_title:"  ",ai_coach_suggestion:"",ai_analyzing:" ...",close_button:"",ai_sort_reason_modal_title:"AI  ",ai_sort_criteria:"AI  ",delete_account_final_confirm_title:"    ",delete_account_final_confirm_message:"    ,     .",delete_all_data_button:"    ",settings_done_button:"",settings_section_data:" ",settings_section_account:"Nova Beta ",settings_sync_data:" ",settings_load_data:"",settings_logout:"",settings_export_data:" ",settings_import_data:" ",import_confirm_title:" ",import_confirm_message:"    .     .",import_success_toast:"  .",import_error_alert_title:" ",import_error_alert_message:"        .   .",settings_section_general:"",settings_section_info:"",settings_section_help:"",settings_theme_mode:" ",theme_mode_light:" ",theme_mode_light_desc:"   ",theme_mode_dark:" ",theme_mode_dark_desc:"   ",theme_mode_system:"",theme_mode_system_desc:"   .",settings_dark_mode:" ",settings_language:"",settings_api_key:"Gemini AI ",settings_api_key_placeholder:"Gemini API  ",settings_offline_mode:" ",settings_offline_mode_desc:"AI     ",settings_notifications:"",settings_notifications_desc:"PWA  ",notification_settings_title:"  ?",reminder_add_title:" ",reminder_step_title:"{step}/5 ",reminder_step1_title:" ",reminder_step1_desc:"  ",reminder_step2_title:"  &  ",reminder_step2_desc:"    ()",reminder_step2_date_toggle:" ",reminder_step2_time_toggle:" ",reminder_step3_title:"  ",reminder_step3_desc:"    ",reminder_step3_enable_recurring:" ",reminder_step4_title:" ",reminder_step4_desc:"   ()",reminder_step5_title:" ",reminder_step5_desc:"   ",reminder_next_button:"",reminder_back_button:"",reminder_submit_button:"",reminder_form_title:"",reminder_form_date:"",reminder_form_time:"",reminder_form_recurring:"",reminder_form_description:"",reminder_form_enabled:"",recurring_type_none:" ",recurring_type_daily:"",recurring_type_weekly:"",recurring_type_monthly:"",notification_deadline:"  ",notification_deadline_desc:"    .",notification_suggestion:" ",notification_suggestion_desc:"   .",notification_achievement:"  ",notification_achievement_desc:"   .",notification_reminder:" ",notification_reminder_desc:"   .",reminder_time_settings_title:"  ",reminder_start_time:" ",reminder_end_time:" ",language_name:" ()",language_modal_title:"",settings_section_background:"",settings_bg_default:"",settings_bg_default_dark:"",settings_bg_pink:"",settings_bg_cherry_noir:" ",settings_bg_blue:"",settings_bg_deep_ocean:"",settings_bg_green:"",settings_bg_forest_green:" ",settings_bg_purple:"",settings_bg_royal_purple:" ",settings_version:"",test_long_alert:"  ",test_long_alert_desc:"    ",folder_manage_title:" ",folder_manage_info:" ",folder_manage_collaborators:"",folder_manage_settings:"",folder_name_edit:"  ",folder_invite_new:"  ",folder_invite_email:" ",folder_invite_role:"",folder_role_owner:"",folder_role_editor:"",folder_role_viewer:"",folder_invite_button:"",folder_leave:" ",folder_delete:" ",folder_share_link:" ",folder_share_link_desc:"      ",folder_copy_link:" ",folder_leave_confirm:" ?",folder_delete_confirm:" ?   .",settings_developer:"",developer_name:"Kim Kyumin",settings_copyright:"",copyright_notice:" 2025 Kim Kyumin. All Rights Reserved.",build_number:" ",settings_data_header:" ",settings_data_header_desc:"   ,  .",settings_background_header:"",settings_background_header_desc:"      .",data_importing:" ...",data_exporting:" ...",data_deleting:" ...",url_import_title:"URL  ",url_import_message:"URL     ?",url_import_confirm:"",url_import_success:"URL   !",url_import_error:"URL   .",settings_share_link_header:" ",settings_generate_link:"  ",settings_copy_link:"",link_copied_toast:"  .",short_url_created:"  URL !",share_link_created:"   !",short_url_failed:"  URL     .",no_data_to_share:"  .",usage_guide_tab:"",usage_guide_title:" ",usage_basic_title:" ",usage_basic_desc:`1.   "   "  .
2. , , ,   .
3.    .
4. ""    .`,usage_ai_title:"Gemini AI  ",usage_ai_desc:`    ""  Gemini AI   .
   " "     .
 Gemini AI       .

 Gemini AI    API   .`,usage_ai_setup_title:"Gemini AI ",usage_ai_setup_desc:`1.  >  "Gemini AI "  .
2. Google Gemini API  .
3. API     Google   :
   https://ai.google.dev/gemini-api/docs/api-key
4.    Gemini AI  .`,usage_share_title:" ",usage_share_desc:`1.  >  "  "  .
2.     .
3. " "   .
4.    .`,usage_theme_title:" ",usage_theme_desc:`1.  >     .
2.     .
3. , , , ,     .
4.    .`,usage_calendar_title:"  ",usage_calendar_desc:`1.     .
2. 3//    .
3.      .
4.      .`,usage_offline_title:"  ",usage_offline_desc:`1.  >  " "  .
2. API    , ,  .
3. AI         .
4.    .`,goal_assistant_title:" ",goal_assistant_mode_woop:"WOOP",goal_assistant_mode_automation:" ",automation_title:"  ",automation_base_name_label:" ",automation_base_name_placeholder:":   ",automation_total_units_label:" ",automation_total_units_placeholder:": 30",automation_units_per_day_label:" ",automation_period_label:"",automation_start_date_label:"",automation_end_date_label:"",automation_generate_button:"{count} ",automation_error_all_fields:"   .",automation_error_start_after_end:"   .",automation_error_short_period:"  . (1 )",next_button:"",back_button:"",wish_tip:"  ,    .",wish_example:": 3  5kg ,   A+ ",outcome_tip:"          .",outcome_example:":     ,   ",obstacle_tip:"      (,  ) ?",obstacle_example:":       ,    ",plan_tip:"' ~, ~'       .",plan_example:":      ,    10 .",recurrence_label:"",recurrence_tip:"     ?      .",recurrence_example:":  ,,  ",recurrence_option_daily:" ",deadline_tip:"    .     .",deadline_option_no_deadline:" ",day_names_short_picker:["","","","","","",""],settings_delete_account:"  ",delete_account_header:" ",delete_account_header_desc:"    ,     .",version_update_title:" ",version_update_1_title:"Firebase  ",version_update_1_desc:"Google        .   Google     .",version_update_2_title:"  ",version_update_2_desc:", ,           .",version_update_3_title:" ",version_update_3_desc:"     ,      .",version_update_4_title:"  UI",version_update_4_desc:", ,           ."},en:{language_selection_title:"Language",error_wish_required:"Please enter your wish.",error_outcome_required:"Please enter the outcome.",error_obstacle_required:"Please enter the obstacle.",error_plan_required:"Please enter your If-Then plan.",error_deadline_required:"Please select a deadline.",error_day_required:"Please select at least one day.",my_goals_title:"My Goals",all_goals_label:" ",sort_label_manual:"Manual",sort_label_deadline:"Deadline",sort_label_newest:"Newest",sort_label_alphabetical:"Alphabetical",sort_label_ai:"Priority Order",ai_sorting_button:"Sorting...",add_new_goal_button_label:"Add New Goal",filter_all:" ",filter_active:"In Progress",filter_completed:"Completed",filter_category:"Category",category_all:"All Categories",category_school:"School",category_work:"Work",category_personal:"Personal",category_other:"Other",category_label:"Select Category",empty_message_all:"Add a goal with the + button",empty_message_active:"No goals in progress.",empty_message_completed:"No completed goals yet.",empty_encouragement_1:"Take the first step toward something amazing.",empty_encouragement_2:"Small changes lead to big achievements.",empty_encouragement_3:"What you do today shapes tomorrow.",empty_encouragement_4:"Your goals are waiting to become reality.",delete_button:"Delete",edit_button_aria:"Edit Goal",info_button_aria:"Details",filter_title:"Filter",sort_title:"Sort",filter_sort_button_aria:"Filter and Sort",calendar_view_button_aria:"Calendar View",list_view_button_aria:"List View",more_options_button_aria:"More",select_button_label:"Select",cancel_selection_button_label:"Cancel",delete_selected_button_label:"Delete {count}",select_all_button_label:"Select All",delete_selected_confirm_title:"Delete Goals",delete_selected_confirm_message:"The {count} selected goals will be permanently deleted.",days_left:"{count} days left",d_day:"D-DAY",days_overdue:"{count} days overdue",month_names:["January","February","March","April","May","June","July","August","September","October","November","December"],day_names_short:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],day_names_long:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],calendar_header_month_format:"{month} {year}",calendar_view_day3:"3-Day",calendar_view_week:"Week",calendar_view_month:"Month",settings_title:"Settings",sort_alert_title:"Unable to Sort",sort_alert_message:"Add at least two goals to use priority order.",ai_sort_error_title:"Unable to Sort",ai_sort_error_message:"Cannot connect to server. Please try again later.",confirm_button:"OK",new_goal_modal_title:"New Goal",edit_goal_modal_title:"Edit Goal",wish_label:"Wish",outcome_label:"Outcome",obstacle_label:"Obstacle",plan_label:"If-Then Plan",deadline_label:"Deadline",cancel_button:"Cancel",add_button:"Add",save_button:"Save",goal_details_modal_title:"Goal Details",ai_coach_suggestion:"View Summary",ai_analyzing:"Analyzing...",close_button:"Close",ai_sort_reason_modal_title:"Sort Reason",ai_sort_criteria:" Sort Criteria",delete_account_final_confirm_title:"Delete All Data",delete_account_final_confirm_message:"All your goals and data will be permanently deleted. This action cannot be undone.",delete_all_data_button:"Delete All Data",settings_done_button:"Done",settings_section_data:"Data Management",settings_export_data:"Export",settings_import_data:"Import",import_confirm_title:"Import Data",import_confirm_message:"This will replace your current goals with new data. This action cannot be undone.",import_success_toast:"Data imported successfully.",import_error_alert_title:"Import Failed",import_error_alert_message:"There was an error reading the file, or the file format is incorrect.",settings_section_general:"General",settings_section_info:"Information",settings_section_help:"How to Use",settings_theme_mode:"Theme Mode",theme_mode_light:"Light Mode",theme_mode_light_desc:"Use bright theme",theme_mode_dark:"Dark Mode",theme_mode_dark_desc:"Use dark theme",theme_mode_system:"Follow System Settings",theme_mode_system_desc:"Automatically adjust to device settings",settings_dark_mode:"Dark Mode",settings_language:"Language",settings_api_key:"Gemini AI Setup",settings_api_key_placeholder:"Enter Gemini API key",settings_offline_mode:"Offline Mode",settings_offline_mode_desc:"Use basic features without AI",settings_notifications:"Notifications",settings_notifications_desc:"PWA notification settings",notification_settings_title:"What notifications would you like?",notification_deadline:"Deadline Alerts",notification_deadline_desc:"Get notified when deadlines are approaching.",notification_suggestion:"Today's Suggestions",notification_suggestion_desc:"Get suggestions on what to do today.",notification_achievement:"Achievement Celebration",notification_achievement_desc:"Celebrate when you achieve a goal.",notification_reminder:"General Reminder",notification_reminder_desc:"Get reminded at scheduled times.",reminder_time_settings_title:"Reminder Time Settings",reminder_start_time:"Start Time",reminder_end_time:"End Time",reminder_add_title:"Add Reminder",reminder_step_title:"Step {step}/5",reminder_step1_title:" Title",reminder_step1_desc:"Enter the reminder title",reminder_step2_title:" Date &  Time",reminder_step2_desc:"Set the reminder date and time (optional)",reminder_step2_date_toggle:"Set Date",reminder_step2_time_toggle:"Set Time",reminder_step3_title:" Recurring",reminder_step3_desc:"Choose recurrence settings",reminder_step3_enable_recurring:"Enable Recurring",reminder_step4_title:" Description",reminder_step4_desc:"Add optional description",reminder_step5_title:" Enable",reminder_step5_desc:"Choose whether to enable reminder",reminder_next_button:"Next",reminder_back_button:"Back",reminder_submit_button:"Add",reminder_form_title:"Title",reminder_form_date:"Date",reminder_form_time:"Time",reminder_form_recurring:"Recurring",reminder_form_description:"Description",reminder_form_enabled:"Enabled",recurring_type_none:"No Recurrence",recurring_type_daily:"Daily",recurring_type_weekly:"Weekly",recurring_type_monthly:"Monthly",language_name:"English (US)",language_modal_title:"Language",settings_section_background:"Appearance",settings_share_link_header:"Share via Link",settings_generate_link:"Generate Share Link",settings_bg_default:"Light",settings_bg_default_dark:"Dark",settings_bg_pink:"Pink",settings_bg_cherry_noir:"Cherry Noir",settings_bg_blue:"Blue",settings_bg_deep_ocean:"Ocean",settings_bg_green:"Green",settings_bg_forest_green:"Forest",settings_bg_purple:"Purple",settings_bg_royal_purple:"Royal Purple",settings_section_account:"Nova Beta Account",settings_sync_data:"Sync Data",settings_load_data:"Load Data",settings_logout:"Sign Out",settings_delete_account:"Delete All Data",delete_account_header:"Delete Data",delete_account_header_desc:"This action is irreversible and will permanently delete all your goals and data.",data_deleting:"Deleting...",settings_version:"Version",test_long_alert:"Test Long Alert",test_long_alert_desc:"Test alert popup with long content",settings_developer:"Developer",developer_name:"GimGyuMin",settings_copyright:"Copyright",copyright_notice:" 2025 GimGyuMin. All Rights Reserved.",build_number:"Build Number",settings_data_header:"Data Management",settings_data_header_desc:"Export or import your goal data.",settings_background_header:"Background",settings_background_header_desc:"Change the app's background style to express your personality.",data_importing:"Importing...",data_exporting:"Exporting..."}},Se={add:p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),p.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),check:p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:p.jsx("polyline",{points:"20 6 9 17 4 12"})}),info:p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("circle",{cx:"12",cy:"12",r:"10"}),p.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),p.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),delete:p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("polyline",{points:"3 6 5 6 21 6"}),p.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}),p.jsx("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),p.jsx("line",{x1:"14",y1:"11",x2:"14",y2:"17"})]}),edit:p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),p.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),close:p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),p.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}),back:p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:p.jsx("polyline",{points:"15 18 9 12 15 6"})}),forward:p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:p.jsx("polyline",{points:"9 18 15 12 9 6"})}),calendar:p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),p.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),p.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),p.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),list:p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("line",{x1:"8",y1:"6",x2:"21",y2:"6"}),p.jsx("line",{x1:"8",y1:"12",x2:"21",y2:"12"}),p.jsx("line",{x1:"8",y1:"18",x2:"21",y2:"18"}),p.jsx("line",{x1:"3",y1:"6",x2:"3.01",y2:"6"}),p.jsx("line",{x1:"3",y1:"12",x2:"3.01",y2:"12"}),p.jsx("line",{x1:"3",y1:"18",x2:"3.01",y2:"18"})]}),settings:p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("circle",{cx:"12",cy:"12",r:"3"}),p.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]}),filter:p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:p.jsx("polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"})}),ai:p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("path",{d:"M12 3L14.34 8.66L20 11L14.34 13.34L12 19L9.66 13.34L4 11L9.66 8.66L12 3Z"}),p.jsx("path",{d:"M5 21L7 16"}),p.jsx("path",{d:"M19 21L17 16"})]}),flame:p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:p.jsx("path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"})}),data:p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83"}),p.jsx("path",{d:"M22 12A10 10 0 0 0 12 2v10z"})]}),background:p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),p.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),p.jsx("polyline",{points:"21 15 16 10 5 21"})]}),exclamation:p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 15c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1zm1-4h-2V7h2v6z"})})},iu=(t,e)=>{const n=new Date(t),r=new Date(e);return n.getFullYear()===r.getFullYear()&&n.getMonth()===r.getMonth()&&n.getDate()===r.getDate()},N3=(t,e)=>{if(!t)return null;const n=new Date;n.setHours(0,0,0,0);const r=new Date(t);r.setHours(0,0,0,0);const i=r.getTime()-n.getTime(),s=Math.ceil(i/(1e3*60*60*24));return s===0?e("d_day"):s>0?e("days_left").replace("{count}",String(s)):e("days_overdue").replace("{count}",String(Math.abs(s)))},JI=(t,e=1)=>{const n=new Date(t),r=n.getDay(),i=(r<e?7:0)+r-e;return n.setDate(n.getDate()-i),n.setHours(0,0,0,0),n},cg=t=>{try{const e=new TextEncoder().encode(t),n=Array.from(e).map(r=>String.fromCharCode(r)).join("");return btoa(n)}catch(e){return console.error("UTF-8 to Base64 encoding failed:",e),""}},QI=t=>{try{const e=atob(t),n=new Uint8Array(e.length);for(let r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return new TextDecoder().decode(n)}catch(e){return console.error("Base64 to UTF-8 decoding failed:",e),""}},YI=t=>{try{const n=JSON.stringify(t).replace(/\s+/g," ").trim();return cg(n)}catch(e){return console.error("Data compression failed:",e),cg(JSON.stringify(t))}},rR=async t=>{if(t.length<1500)return t;const e=[{name:"is.gd",createUrl:async n=>{const r=await fetch(`https://is.gd/create.php?format=simple&url=${encodeURIComponent(n)}`);if(!r.ok)throw new Error("is.gd API failed");const i=await r.text();if(i.includes("Error")||!i.startsWith("http"))throw new Error("Invalid response from is.gd");return i.trim()}},{name:"tinyurl",createUrl:async n=>new Promise((r,i)=>{const s=`tinyurl_${Date.now()}`,o=document.createElement("script"),a=setTimeout(()=>{l(),i(new Error("TinyURL timeout"))},5e3),l=()=>{clearTimeout(a),o.parentNode&&document.head.removeChild(o),delete window[s]};window[s]=u=>{l(),u&&typeof u=="string"&&!u.includes("Error")&&u.startsWith("http")?r(u.trim()):i(new Error("Invalid TinyURL response"))},o.onerror=()=>{l(),i(new Error("TinyURL script load failed"))},o.src=`https://tinyurl.com/api-create.php?url=${encodeURIComponent(n)}&callback=${s}`,document.head.appendChild(o)})},{name:"v.gd",createUrl:async n=>{const r=await fetch(`https://v.gd/create.php?format=simple&url=${encodeURIComponent(n)}`);if(!r.ok)throw new Error("v.gd API failed");const i=await r.text();if(i.includes("Error")||!i.startsWith("http"))throw new Error("Invalid response from v.gd");return i.trim()}}];for(const n of e)try{console.log(`Trying ${n.name} for URL shortening...`);const r=await n.createUrl(t);return console.log(` ${n.name} success:`,r),r}catch(r){console.warn(` ${n.name} failed:`,r);continue}return console.warn("All URL shortening services failed, using original URL"),t},dg=[{id:"default",lightThemeClass:"bg-solid-default",darkThemeClass:"bg-solid-default",lightNameKey:"settings_bg_default",darkNameKey:"settings_bg_default_dark"},{id:"pink",lightThemeClass:"bg-solid-pink",darkThemeClass:"bg-solid-pink",lightNameKey:"settings_bg_pink",darkNameKey:"settings_bg_cherry_noir"},{id:"blue",lightThemeClass:"bg-solid-blue",darkThemeClass:"bg-solid-blue",lightNameKey:"settings_bg_blue",darkNameKey:"settings_bg_deep_ocean"},{id:"green",lightThemeClass:"bg-solid-green",darkThemeClass:"bg-solid-green",lightNameKey:"settings_bg_green",darkNameKey:"settings_bg_forest_green"},{id:"purple",lightThemeClass:"bg-solid-purple",darkThemeClass:"bg-solid-purple",lightNameKey:"settings_bg_purple",darkNameKey:"settings_bg_royal_purple"}],D3=()=>{const[t,e]=z.useState("ko"),[n,r]=z.useState([]),[i,s]=z.useState([]),[o,a]=z.useState(null),[l,u]=z.useState("all"),[f,m]=z.useState("all"),[g,v]=z.useState("manual"),[T,P]=z.useState(["school","work","personal","other"]),[D,S]=z.useState(()=>KI()==="dark"),[I,R]=z.useState("system"),[V,U]=z.useState("default"),[B,E]=z.useState([]),[w,C]=z.useState({}),[k,M]=z.useState([]),[L,N]=z.useState(!1),[Ne,Fe]=z.useState(!1),[je,Ee]=z.useState(null),[te,ce]=z.useState(!1),[ve,Ie]=z.useState(null),[Re,$e]=z.useState(""),[Ke,Vt]=z.useState(""),[ut,_e]=z.useState("editor"),[nn,vn]=z.useState(!1),[Vn,cr]=z.useState(null),[dr,hn]=z.useState(!1),[Pr,be]=z.useState(!1),[It,Ge]=z.useState(!1),[ct,ae]=z.useState(null),[Lt,oi]=z.useState(!1),[cs,ds]=z.useState(new Set),[yo,xe]=z.useState(""),[lc,kr]=z.useState("idle"),[hs,Qa]=z.useState(!1),[uc,Ya]=z.useState(!1),[cc,fs]=z.useState(""),[Xa,ps]=z.useState(!1),[Tn,ms]=z.useState(void 0),[vo,Za]=z.useState(!1),[Ln,gs]=z.useState(""),[vt,dc]=z.useState(!1),[hr,_s]=z.useState(!0),[Q,el]=z.useState(null),[ys,gy]=z.useState(""),[_y,tl]=z.useState(!1),[hc,To]=z.useState(!1),[nl,Nr]=z.useState(!1),[rl,wt]=z.useState(!1),[fc,il]=z.useState(!1),[vs,sl]=z.useState(!0),[Af,xf]=z.useState(0),[Rf,pc]=z.useState("activity-based"),[ai,mc]=z.useState(null),[Ts,Eo]=z.useState(3e3),[li,Io]=z.useState(!1),[gc,_c]=z.useState(!1);z.useEffect(()=>{let A=null,b=null,F=null;const O=GL(Ei,async H=>{if(el(H),sl(!1),H){console.log("    - Firebase   "),await So(H),console.log("      ...");let Y=null,K=null;const X=Ue(ge,"users",H.uid,"data","todos");A=Lr(X,ne=>{Y&&clearTimeout(Y),Y=setTimeout(()=>{if(ne.exists()){const pe=ne.data().todos||[];r(me=>{const le=me.filter(dt=>dt.isSharedTodo===!0),de=pe.map(dt=>({...dt,isSharedTodo:!1}));return JSON.stringify(me.filter(dt=>!dt.isSharedTodo))!==JSON.stringify(de)?(console.log("     :",de.length,"  :",le.length),[...de,...le]):me})}},2e3)});const W=it(ge,"users",H.uid,"folders");b=Lr(W,async ne=>{K&&clearTimeout(K),K=setTimeout(async()=>{const j=[];ne.forEach(me=>{const le=me.data(),de={id:me.id,name:le.name||"  ",color:le.color||"#007AFF",...le,collaborators:le.collaborators||[],ownerId:le.ownerId||H.uid};j.push(de)});const pe=j.filter(me=>me.isShared&&me.ownerId&&me.ownerId!==H.uid);if(pe.length>0){console.log("     :",pe.map(le=>({id:le.id,name:le.name,ownerId:le.ownerId}))),F&&F();const me=[];for(const le of pe)if(le.ownerId)try{const de=Ue(ge,"users",le.ownerId,"folders",le.id),Me=Lr(de,wn=>{if(wn.exists()){const Un=wn.data();console.log("     :",{folderId:le.id,name:Un.name,color:Un.color}),s(Jn=>Jn.map(St=>St.id===le.id?{...St,name:Un.name||St.name||" ",color:Un.color||St.color,updatedAt:Un.updatedAt||St.updatedAt}:St))}},wn=>{console.error("     :",wn)});me.push(Me);const dt=it(ge,"users",le.ownerId,"todos"),In=Vl(dt,Ll("folderId","==",le.id));let Vr=null;const xo=Lr(In,wn=>{Vr&&clearTimeout(Vr),Vr=setTimeout(()=>{const Un=[];wn.forEach(Jn=>{const St=Jn.data();Un.push({id:parseInt(Jn.id),...St,isSharedTodo:!0})}),console.log("     :",{folderId:le.id,count:Un.length}),r(Jn=>{const St=Jn.filter(Cs=>!(Cs.folderId===le.id&&Cs.isSharedTodo===!0)),dl=Un.filter(Cs=>!St.some(Pc=>Pc.id===Cs.id)),hl=[...St,...dl];return console.log("   :",{:Jn.length,:Jn.length-St.length,:dl.length,:hl.length}),hl})},1500)},wn=>{console.warn("     :",{folderId:le.id,error:wn.code})});me.push(xo)}catch(de){console.warn("     :",{folderId:le.id,error:de})}F=()=>{me.forEach(le=>le())}}s(me=>JSON.stringify(me)!==JSON.stringify(j)?(console.log("    :",j.map(de=>({id:de.id,name:de.name}))),j):me)},3e3)})}else console.log("    -  "),A&&(A(),A=null),b&&(b(),b=null),F&&(F(),F=null),r([]),s([]),e("ko"),R("system"),U("default"),gs(""),P(["school","work","personal","other"])});return()=>{O(),A&&A(),b&&b(),F&&F()}},[]);const yc=z.useCallback(()=>{console.log(" Firebase  ..."),console.log("Firebase Auth:",Ei),console.log("Firebase DB:",ge),console.log("Google Provider:",Qs),console.log("  :"),console.log("- VITE_FIREBASE_API_KEY:"," "),console.log("- VITE_FIREBASE_AUTH_DOMAIN:"," "),console.log("- VITE_FIREBASE_PROJECT_ID:"," "),console.log(" :"),console.log("- User Agent:",navigator.userAgent),console.log("-  :",navigator.cookieEnabled),console.log("-   :",typeof Storage<"u"),console.log(" :",navigator.onLine?" ":" ")},[]),wo=z.useCallback(async()=>{To(!0);try{console.log(" Google  ..."),console.log("Auth :",Ei),console.log("Google Provider :",Qs);const A=window.open("","_blank","width=1,height=1");if(!A||A.closed||typeof A.closed>"u")throw new Error(" .    .");A.close(),console.log(" signInWithPopup  ...");const b=await oF(Ei,Qs);console.log("  :",b.user.email),el(b.user),xe(" Google  !"),setTimeout(async()=>{var F;try{console.log("    ...");const{doc:O,getDoc:H}=await xs(async()=>{const{doc:ne,getDoc:j}=await Promise.resolve().then(()=>Ps);return{doc:ne,getDoc:j}},void 0),Y=O(ge,"users",b.user.uid,"data","todos"),K=await H(Y);if(K.exists()){const ne=K.data();r(ne.todos||[]),console.log("    :",((F=ne.todos)==null?void 0:F.length)||0)}else console.log("   -    "),r([]);const X=O(ge,"users",b.user.uid,"data","settings"),W=await H(X);if(W.exists()){const ne=W.data();ne.language&&e(ne.language),ne.themeMode&&R(ne.themeMode),ne.isDarkMode!==void 0&&S(ne.isDarkMode),ne.backgroundTheme&&U(ne.backgroundTheme),ne.apiKey&&gs(ne.apiKey)}xe("  !  ")}catch(O){console.error("  :",O),xe("     ")}To(!1),setTimeout(()=>xe(""),3e3)},500),setTimeout(()=>xe(""),3e3)}catch(A){console.error(" Google  :",A),console.error(" :",A.code),console.error(" :",A.message);let b="   .";switch(A.code){case"auth/popup-closed-by-user":b=" .";break;case"auth/popup-blocked":b=" .    .";break;case"auth/cancelled-popup-request":b="    .";break;case"auth/network-request-failed":b="  .";break;case"auth/too-many-requests":b="   .    .";break;case"auth/user-disabled":b=" .";break;case"auth/operation-not-allowed":b="Google   .  .";break;default:b=` : ${A.message}`}A.code!=="auth/popup-closed-by-user"&&ae({title:" ",message:b,confirmText:"",onConfirm:()=>ae(null)}),To(!1)}},[]),ol=(A,b)=>{if(A===null)return;const F=i.map(O=>O.id===A?{...O,collaborators:b}:O);s(F),Tn&&Tn.id===A&&ms({...Tn,collaborators:b}),xe("   "),setTimeout(()=>xe(""),3e3)},al=z.useCallback(async()=>{Nr(!0);try{if(Q){xe("   ...");const A=n.filter(ne=>ne!=null),{doc:b,setDoc:F,serverTimestamp:O}=await xs(async()=>{const{doc:ne,setDoc:j,serverTimestamp:pe}=await Promise.resolve().then(()=>Ps);return{doc:ne,setDoc:j,serverTimestamp:pe}},void 0),H=A.map(ne=>Pt(ne)).filter(ne=>ne!==void 0),Y=b(ge,"users",Q.uid,"data","todos"),K={todos:H,lastSyncTime:O(),totalGoals:H.length,syncedAt:new Date().toISOString()},X=Pt(K);X?(await F(Y,X),console.log(" Todos Firestore  :",{count:H.length})):console.error(" Todos   ");const W=b(ge,"users",Q.uid,"data","settings");await F(W,{language:t,themeMode:I,isDarkMode:D,backgroundTheme:V,updatedAt:O()})}await pE(Ei),el(null),r([]),e("ko"),U("default"),R("system"),S(KI()==="dark"),Ee(null),hn(!1),Fe(!1),xe("  "),setTimeout(()=>xe(""),3e3),Nr(!1)}catch(A){console.error(" :",A),ae({title:" ",message:"   .",confirmText:"",onConfirm:()=>ae(null)}),Nr(!1)}},[Q,n,t,I,D,V]),ui=z.useCallback(async()=>{if(!Q){ae({title:" ",message:" ",confirmText:"",onConfirm:()=>ae(null)});return}wt(!0);try{const A=n.filter(j=>j!=null),{doc:b,setDoc:F,serverTimestamp:O}=await xs(async()=>{const{doc:j,setDoc:pe,serverTimestamp:me}=await Promise.resolve().then(()=>Ps);return{doc:j,setDoc:pe,serverTimestamp:me}},void 0),H=A.map(j=>Pt(j)).filter(j=>j!==void 0),Y=b(ge,"users",Q.uid,"data","todos"),K={todos:H,lastSyncTime:O(),totalGoals:H.length,syncedAt:new Date().toISOString()},X=Pt(K);if(X)await F(Y,X),console.log("  Todos Firestore  :",{count:H.length});else throw new Error("Todos   ");const W=b(ge,"users",Q.uid,"data","settings"),ne={language:t,themeMode:I,isDarkMode:D,backgroundTheme:V,apiKey:Ln,userCategories:T,updatedAt:O()};await F(W,ne);for(const j of i)try{const pe=b(ge,"users",Q.uid,"folders",j.id),me={...j,ownerId:j.ownerId||Q.uid,collaborators:j.collaborators||[],updatedAt:O()};await F(pe,me),console.log(`  ${j.id}  `)}catch(pe){console.error(`  ${j.id}  :`,pe)}wt(!1)}catch(A){console.error(" :",A),ae({title:" ",message:A.message||"    .",confirmText:"",onConfirm:()=>ae(null)}),wt(!1)}},[Q,n,t,I,D,V,Ln]),So=z.useCallback(async A=>{var b;try{const{doc:F,getDoc:O,collection:H,getDocs:Y}=await xs(async()=>{const{doc:j,getDoc:pe,collection:me,getDocs:le}=await Promise.resolve().then(()=>Ps);return{doc:j,getDoc:pe,collection:me,getDocs:le}},void 0),K=F(ge,"users",A.uid,"data","todos"),X=await O(K);if(X.exists()){const pe=X.data().todos||[];r(me=>{const le=new Set(me.map(dt=>dt.id)),de=pe.filter(dt=>!le.has(dt.id)),Me=[...me,...de];return console.log("   :",{:me.length,:pe.length,:de.length,:Me.length}),Me})}const W=F(ge,"users",A.uid,"data","settings"),ne=await O(W);if(ne.exists()){const j=ne.data();j.language&&e(j.language),j.themeMode&&R(j.themeMode),j.isDarkMode!==void 0&&S(j.isDarkMode),j.backgroundTheme&&U(j.backgroundTheme),j.apiKey&&gs(j.apiKey),j.userCategories&&P(j.userCategories)}try{const j=H(ge,"users",A.uid,"folders"),pe=await Y(j),me=[];pe.forEach(le=>{const de=le.data(),Me={id:le.id,...de,collaborators:de.collaborators||[],ownerId:de.ownerId||A.uid};me.push(Me)}),s(le=>{const de=new Set(le.map(In=>In.id)),Me=me.filter(In=>!de.has(In.id)),dt=[...le,...Me];return console.log("   :",{:le.length,:me.length,:Me.length,:dt.length}),dt}),console.log("   :",{count:me.length})}catch(j){console.warn("   ,   :",j)}console.log("    :",{todos:X.exists()&&((b=X.data().todos)==null?void 0:b.length)||0,folders:"",settings:ne.exists()?"":""})}catch(F){console.error("    :",F)}},[]),vc=z.useCallback(async()=>{if(!Q){ae({title:" ",message:" ",confirmText:"",onConfirm:()=>ae(null)});return}il(!0);try{await So(Q),xe("    !")}catch(A){console.error(" :",A),ae({title:" ",message:A.message||"    .",confirmText:"",onConfirm:()=>ae(null)})}finally{il(!1)}},[Q,So]),se=z.useCallback(A=>k3[t][A]||A,[t]),En=z.useCallback(A=>{const b=A||Ln;if(vt||!b)return null;try{return new _2({apiKey:b})}catch(F){return console.error("Failed to create AI instance:",F),null}},[Ln,vt]),Fn=z.useCallback(A=>{R(A)},[]),Dr=z.useMemo(()=>[se("empty_encouragement_1"),se("empty_encouragement_2"),se("empty_encouragement_3"),se("empty_encouragement_4")],[se]),Es=z.useMemo(()=>Dr[Math.floor(Math.random()*Dr.length)],[Dr]);z.useEffect(()=>{console.log("     - localStorage   ")},[]),z.useEffect(()=>{(()=>{s(b=>{const F=b.filter(O=>{if(!O.collaborators||O.collaborators.length===0)return!0;const H=O.collaborators.find(Y=>Y.role==="owner");return!H||!H.userId||H.userId.startsWith("owner_")?(console.warn("    :",O.name,H==null?void 0:H.userId),!1):!0});return F.length!==b.length&&console.log("     :",{:b.length-F.length,:F.length}),F})})()},[]),z.useEffect(()=>{if(vs)return;const A=async()=>{const b=new URLSearchParams(window.location.search),F=b.get("data"),O=b.get("folder_share");if(O){try{const H=QI(O),Y=JSON.parse(H);if(Y.type==="folder_share"&&Y.folderId){if(Y.password){const X=sessionStorage.getItem(`folder_${Y.folderId}_password`);if(!X||X!==Y.password){ae({title:" ",message:"    .  .",confirmText:"",cancelText:"",onConfirm:()=>{const W=prompt("  :");W===Y.password?(sessionStorage.setItem(`folder_${Y.folderId}_password`,W),ae(null),A()):W!==null&&ae({title:" ",message:"  .",confirmText:"",onConfirm:()=>{window.history.replaceState({},document.title,window.location.pathname)}})},onCancel:()=>{window.history.replaceState({},document.title,window.location.pathname)}});return}}if(i.some(X=>X.id===Y.folderId))window.history.replaceState({},document.title,window.location.pathname);else{if(Y.ownerId&&!Q&&!vs){ae({title:" ",message:"        .  .",confirmText:"",cancelText:"",onConfirm:async()=>{try{await wo()}catch(j){console.error("  :",j)}},onCancel:()=>{window.history.replaceState({},document.title,window.location.pathname)}});return}const X=Y.ownerId||null;if(!X){console.error("     :",Y),ae({title:"   ",message:`    .
     .`,confirmText:"",onConfirm:()=>{ae(null),window.history.replaceState({},document.title,window.location.pathname)}});return}const W={id:Y.folderId,name:Y.folderName,color:Y.folderColor||"#007AFF",ownerId:X,collaborators:[{userId:X,email:Y.sharedBy||"",role:"owner",addedAt:Y.sharedAt}],createdAt:Y.sharedAt,updatedAt:Y.sharedAt,isShared:!0};let ne=W;if(X&&Q)try{console.log("   :",{ownerUserId:X,googleUserUid:Q.uid});const j=it(ge,"users",X,"folders"),pe=Ue(j,Y.folderId),me=await lg(pe);if(console.log("   :",{exists:me.exists()}),me.exists()){let le=me.data().collaborators||[];console.log("   :",le);const de=le.some(Me=>Me.userId===Q.uid);if(console.log("  :",{isCollaborator:de}),de)console.log("  ");else{const Me={userId:Q.uid,email:Q.email||"",role:"editor",addedAt:new Date().toISOString()};le=[...le,Me],console.log("   :",le);const dt=Pt(le);dt?(await gt(pe,{collaborators:dt,updatedAt:new Date().toISOString()},{merge:!0}),console.log("  Firestore  :",Me)):console.warn("     ")}ne={...W,collaborators:le}}else console.warn("   :",Y.folderId)}catch(j){console.error("   / :",j)}else console.warn("    :",{ownerUserId:X,hasGoogleUser:!!Q});if(s([...i,ne]),Q)try{const{doc:j,setDoc:pe}=await xs(async()=>{const{doc:le,setDoc:de}=await Promise.resolve().then(()=>Ps);return{doc:le,setDoc:de}},void 0),me=j(ge,"users",Q.uid,"folders",ne.id);await pe(me,{name:ne.name,color:ne.color,ownerId:ne.ownerId,createdAt:ne.createdAt,updatedAt:ne.updatedAt,isShared:ne.isShared,collaborators:ne.collaborators||[],collaborationSettings:ne.collaborationSettings||{enabled:!0,showPresence:!0,showEditingState:!0,enableConflictDetection:!0,allowGuestView:!1,requireApproval:!1}}),console.log("   Firebase  :",ne.id)}catch(j){console.error("   Firebase  :",j)}a(ne.id),ae({title:"  ",message:`"${Y.folderName}"  .    .`,confirmText:"",onConfirm:()=>{window.history.replaceState({},document.title,window.location.pathname)}})}}}catch(H){console.error("    :",H),window.history.replaceState({},document.title,window.location.pathname)}return}if(F)try{const H=QI(F),Y=JSON.parse(H);if(Array.isArray(Y)&&(Y.length===0||"wish"in Y[0]&&"id"in Y[0]))ae({title:se("url_import_title"),message:se("url_import_message"),confirmText:se("url_import_confirm"),cancelText:se("cancel_button"),onConfirm:()=>{r(Y),xe(se("url_import_success")),window.history.replaceState({},document.title,window.location.pathname)},onCancel:()=>{window.history.replaceState({},document.title,window.location.pathname)}});else throw new Error("Invalid data format")}catch(H){console.error("Failed to parse data from URL",H),ae({title:se("import_error_alert_title"),message:se("url_import_error")}),window.history.replaceState({},document.title,window.location.pathname)}};A()},[se,i,Q,wo,vs]),z.useEffect(()=>{if(!o||!Q)return;const A=i.find(W=>W.id===o);if(!A||!A.collaborators||A.collaborators.length===0)return;const b=A.collaborators.find(W=>W.role==="owner");if(!b)return;const F=b.userId;if(!F||F.startsWith("owner_")){console.warn(" Invalid owner UID:",b);return}const O=[],H=Ue(ge,"users",F,"folders",o),Y=Lr(H,W=>{if(W.exists()){const ne=W.data();ne.collaborators&&s(j=>j.map(pe=>pe.id===o?{...pe,collaborators:ne.collaborators}:pe))}},W=>{console.warn("      (    ):",W.code)});O.push(Y);const K=it(ge,"users",F,"todos");console.log(" Syncing todos from owner:",{ownerUid:F,currentFolderId:o});const X=Lr(K,W=>{const ne=[];W.forEach(j=>{const pe=j.data();pe.folderId===o&&ne.push({id:parseInt(j.id),...pe})}),console.log(" Owner todos received:",{count:ne.length,ownerTodos:ne}),r(j=>{const pe=j.filter(Me=>Me.folderId!==o),me=j.filter(Me=>Me.folderId===o),le=[],de=new Set;return ne.forEach(Me=>{le.push(Me),de.add(Me.id)}),me.forEach(Me=>{de.has(Me.id)||le.push(Me)}),[...pe,...le]})},W=>{console.error("   :",W),W.code==="permission-denied"?(console.warn("      -   "),xe("    -    ")):W.code==="not-found"?(console.warn("     -    "),xe("     ")):(console.warn("     "),xe("   -   "))});return O.push(X),()=>{O.forEach(W=>W())}},[o,Q]),z.useEffect(()=>{var W,ne;if(!o||!Q)return;const A=i.find(j=>j.id===o),b=((W=A==null?void 0:A.collaborationSettings)==null?void 0:W.enabled)||(A==null?void 0:A.isShared)||!1,F=((ne=A==null?void 0:A.collaborationSettings)==null?void 0:ne.showPresence)??!0;if(!b||!F){E([]);return}console.log("     :",{folderId:o,showPresence:F});const O=it(ge,"folderPresence",o,"users"),H=Ue(O,Q.uid);(async()=>{try{await gt(H,{userId:Q.uid,displayName:Q.displayName||"Anonymous",photoURL:Q.photoURL||null,isOnline:!0,lastSeen:new Date,currentFolder:o},{merge:!0}),console.log("    :",Q.displayName)}catch(j){console.warn("presence set failed",j)}})();const K=setInterval(()=>{gt(H,{lastSeen:new Date,isOnline:!0},{merge:!0}).catch(()=>{})},3e4),X=Lr(O,j=>{const me=j.docs.map(le=>{const de=le.data();return{userId:de.userId||le.id,displayName:de.displayName||"Anonymous",photoURL:de.photoURL||void 0,isOnline:!!de.isOnline,lastSeen:de.lastSeen?de.lastSeen.toDate?de.lastSeen.toDate():new Date(de.lastSeen):new Date,currentFolder:de.currentFolder}}).filter(le=>!!le.userId&&le.isOnline);E(me),console.log("   :",me.map(le=>le.displayName))},j=>console.warn("presence listen failed",j));return()=>{clearInterval(K),gt(H,{isOnline:!1,lastSeen:new Date},{merge:!0}).catch(()=>{}),X()}},[o,Q,i]),z.useCallback(async A=>{var H,Y;if(!o||!Q)return;const b=i.find(K=>K.id===o),F=((H=b==null?void 0:b.collaborationSettings)==null?void 0:H.showEditingState)??!0;if(!(!((Y=b==null?void 0:b.collaborationSettings)!=null&&Y.enabled||b!=null&&b.isShared)||!F))try{const K=Ue(ge,"folderEditing",`${o}_${A}`);await gt(K,{todoId:A,userId:Q.uid,userName:Q.displayName||"Anonymous",startTime:new Date,folderId:o}),console.log("  :",{todoId:A,user:Q.displayName})}catch(K){console.warn("start editing failed",K)}},[o,Q,i]),z.useCallback(async A=>{var H,Y;if(!o||!Q)return;const b=i.find(K=>K.id===o),F=((H=b==null?void 0:b.collaborationSettings)==null?void 0:H.showEditingState)??!0;if(!(!((Y=b==null?void 0:b.collaborationSettings)!=null&&Y.enabled||b!=null&&b.isShared)||!F))try{const K=Ue(ge,"folderEditing",`${o}_${A}`);await Gt(K),console.log("  :",{todoId:A,user:Q.displayName})}catch(K){console.warn("stop editing failed",K)}},[o,Q,i]),z.useEffect(()=>{var Y,K;if(!o)return;const A=i.find(X=>X.id===o),b=((Y=A==null?void 0:A.collaborationSettings)==null?void 0:Y.showEditingState)??!0;if(!(((K=A==null?void 0:A.collaborationSettings)==null?void 0:K.enabled)||(A==null?void 0:A.isShared)||!1)||!b){C({});return}console.log("    :",{folderId:o});const O=Vl(it(ge,"folderEditing"),Ll("folderId","==",o)),H=Lr(O,X=>{const W={};X.docs.forEach(ne=>{const j=ne.data();j&&j.todoId&&(W[j.todoId]={todoId:j.todoId,userId:j.userId,userName:j.userName,startTime:j.startTime?j.startTime.toDate?j.startTime.toDate():new Date(j.startTime):new Date,folderId:j.folderId})}),C(W),console.log("   :",Object.keys(W).length+" ")},X=>console.warn("editing states listen failed",X));return()=>H()},[o,i]),z.useCallback(async A=>{var b,F;try{const O=A.ownerId||(Q==null?void 0:Q.uid);if(!O)throw new Error("No owner UID");const H=i.find(ne=>ne.id===o),Y=((b=H==null?void 0:H.collaborationSettings)==null?void 0:b.enableConflictDetection)??!0,K=((F=H==null?void 0:H.collaborationSettings)==null?void 0:F.enabled)||(H==null?void 0:H.isShared)||!1,X=Ue(ge,"users",O,"todos",A.id.toString());if(K&&Y){const ne=await lg(X),j=ne.exists()?ne.data():null,pe=(j==null?void 0:j.version)||0,me=A.version||0;if(j&&pe>me&&(M(de=>[...de,{todoId:A.id,conflictType:"version_mismatch",localVersion:A,serverVersion:j,lastModifiedBy:j.lastModifiedBy||"unknown",lastModifiedAt:j.lastModified?j.lastModified.toDate?j.lastModified.toDate():new Date(j.lastModified):new Date}]),console.warn("  :",{todoId:A.id,localVersion:me,serverVersion:pe,lastModifiedBy:j.lastModifiedBy}),!window.confirm("    . ? (  )")))return!1}const W=Pt({...A,version:(A.version||0)+1,lastModified:new Date,lastModifiedBy:(Q==null?void 0:Q.uid)||"unknown"});return W&&(await gt(X,W),console.log(" Todo  :",{todoId:A.id,version:W.version})),!0}catch(O){return console.error("attemptSaveTodo failed",O),!1}},[Q,o,i]),z.useEffect(()=>{const A=window.matchMedia("(prefers-color-scheme: dark)"),b=F=>{I==="system"&&S(F.matches)};return S(I==="system"?A.matches:I==="dark"),A.addEventListener("change",b),()=>A.removeEventListener("change",b)},[I]),z.useEffect(()=>{const A=()=>{console.log("  "),xe("   "),setTimeout(()=>xe(""),3e3)},b=()=>{console.log("   "),xe("   -   "),setTimeout(()=>xe(""),5e3)};return navigator.onLine||console.log("   "),window.addEventListener("online",A),window.addEventListener("offline",b),()=>{window.removeEventListener("online",A),window.removeEventListener("offline",b)}},[]),z.useEffect(()=>{const A=localStorage.getItem("pwa-prompt-dismissed"),b=rd(),F=jI();console.log("PWA Check:",{isMobileDevice:b,isInStandalone:F,isDismissed:A,userAgent:navigator.userAgent}),b&&!F&&!A&&(console.log("Showing PWA prompt immediately"),Za(!0))},[]),z.useEffect(()=>{"serviceWorker"in navigator&&navigator.serviceWorker.register("/Nova-AI-Planer/sw.js").then(A=>{console.log("SW registered: ",A);const b=jI(),F=rd();b&&F&&setTimeout(()=>{tR().then(O=>{O&&nR()})},2e3)}).catch(A=>{console.log("SW registration failed: ",A)})},[]),z.useEffect(()=>{},[I,D]);const br=z.useRef(null);z.useEffect(()=>{if(!(!hr||!Q))return br.current&&clearTimeout(br.current),br.current=setTimeout(()=>{ui()},5e3),()=>{br.current&&clearTimeout(br.current)}},[n,i,t,I,D,V,Ln,T,hr,Q]),z.useEffect(()=>{const A=dg.find(F=>F.id===V)||dg[0],b=D?A.darkThemeClass:A.lightThemeClass;document.body.className="",D&&document.body.classList.add("dark-mode"),b&&document.body.classList.add(b)},[V,D]),z.useEffect(()=>{if(yo){const A=setTimeout(()=>xe(""),3e3);return()=>clearTimeout(A)}},[yo]);const He=z.useMemo(()=>{let A=[...n];return o===null?A=A.filter(b=>{if(b.isSharedTodo===!0)return!1;const F=i.find(O=>O.id===b.folderId);return F?F.isShared!==!0:!0}):o==="all"?A=A:A=A.filter(b=>b.folderId===o),g==="deadline"?A.sort((b,F)=>!b.deadline&&!F.deadline?0:b.deadline?F.deadline?new Date(b.deadline).getTime()-new Date(F.deadline).getTime():-1:1):g==="newest"?A.sort((b,F)=>F.id-b.id):g==="alphabetical"&&A.sort((b,F)=>b.wish.localeCompare(F.wish)),l==="active"&&(A=A.filter(b=>!b.completed)),l==="completed"&&(A=A.filter(b=>b.completed)),f!=="all"&&(A=A.filter(b=>(b.category||"other")===f)),A},[n,l,g,f,o]),Mr=z.useCallback(()=>{const A=Date.now();xf(A),ai&&clearTimeout(ai);const b=setTimeout(async()=>{if(console.log("    -    (  "+Ts/1e3+")"),!gc&&Q)try{console.log("   : activity-based "),await ui()}catch(F){console.error("   :",F)}},Ts);mc(b)},[ai,Ts,gc,Q]);z.useEffect(()=>{const A=i.find(F=>F.id===o),b=(A==null?void 0:A.isShared)&&(A==null?void 0:A.ownerId)&&(A==null?void 0:A.ownerId)!==(Q==null?void 0:Q.uid);_c(b||!1),b?(pc("realtime"),Io(!0),console.log("     ( )")):(pc("activity-based"),Io(!1),console.log("     ( )"))},[o,i,Q==null?void 0:Q.uid]);const Is=async A=>{Mr();const b={...A,id:Date.now(),completed:!1,lastCompletedDate:null,streak:0,folderId:o==="all"||o===null?void 0:o};if(Q)try{const F=i.find(X=>X.id===o),O=(F==null?void 0:F.ownerId)||Q.uid,H=it(ge,"users",O,"todos"),Y=Ue(H,b.id.toString()),K=Pt(b);K?(await gt(Y,K),console.log("  Firestore :",{targetOwnerUid:O,newTodo:K})):console.warn("     ")}catch(F){console.error("  Firestore  :",F)}r(F=>[b,...F]),Fe(!1)},ws=async A=>{const b=A.map((F,O)=>({...F,id:Date.now()+O,completed:!1,lastCompletedDate:null,streak:0,folderId:o||void 0})).reverse();if(Q)try{const F=i.find(H=>H.id===o),O=(F==null?void 0:F.ownerId)||Q.uid;for(const H of b){const Y=it(ge,"users",O,"todos"),K=Ue(Y,H.id.toString()),X=Pt(H);X?await gt(K,X):console.warn("     :",H.id)}console.log("   Firestore :",{targetOwnerUid:O,count:b.length})}catch(F){console.error("   Firestore  :",F)}r(F=>[...b,...F]),Fe(!1)},Tc=async A=>{if(Mr(),Q)try{const b=i.find(K=>K.id===A.folderId),F=(b==null?void 0:b.ownerId)||Q.uid,O=it(ge,"users",F,"todos"),H=Ue(O,A.id.toString()),Y=Pt(A);Y?(await gt(H,Y),console.log("   Firestore :",{targetOwnerUid:F,updatedTodo:Y})):console.warn("     ")}catch(b){console.error("   Firestore  :",b)}r(n.map(b=>b.id===A.id?A:b)),Ee(null)},Ec=async A=>{Mr();const b=n.find(O=>O.id===A),F=n.filter(O=>O.id!==A);if(r(F),Q&&b)try{const O=i.find(X=>X.id===b.folderId),H=(O==null?void 0:O.ownerId)||Q.uid,Y=it(ge,"users",H,"todos"),K=Ue(Y,A.toString());await Gt(K),console.log("   Firestore :",{targetOwnerUid:H,id:A});try{const X=Ue(ge,"users",H,"data","todos");await gt(X,{todos:F,lastUpdated:new Date().toISOString()},{merge:!0}),console.log("     -  ")}catch(X){console.warn("    :",X)}hr&&setTimeout(()=>{ui()},1e3)}catch(O){console.error("  Firestore  :",O),b&&r(H=>[...H,b])}},Pf=async A=>{var F;if(!A.trim()){ae({title:"Error",message:"Folder name cannot be empty."});return}const b={id:Date.now().toString(),name:A,ownerId:((F=Ei.currentUser)==null?void 0:F.uid)||"unknown",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),color:"#3b82f6",collaborationSettings:{enabled:!1,showPresence:!0,showEditingState:!0,enableConflictDetection:!0,allowGuestView:!1,requireApproval:!0},isShared:!1};if(s([...i,b]),Q)try{const{doc:O,setDoc:H}=await xs(async()=>{const{doc:K,setDoc:X}=await Promise.resolve().then(()=>Ps);return{doc:K,setDoc:X}},void 0),Y=O(ge,"users",Q.uid,"folders",b.id);await H(Y,{name:b.name,color:b.color,ownerId:b.ownerId,createdAt:b.createdAt,updatedAt:b.updatedAt,isShared:b.isShared,collaborators:[],collaborationSettings:b.collaborationSettings}),console.log("  Firebase  :",b.id)}catch(O){console.error("  Firebase  :",O)}return console.log("   :",{name:A,collaborationEnabled:!1}),b},ll=z.useCallback(async(A,b)=>{try{if(s(F=>F.map(O=>{if(O.id===A){const H={...O.collaborationSettings,...b};return console.log("   :",{folderId:A,settings:H}),{...O,collaborationSettings:H,updatedAt:new Date().toISOString()}}return O})),Q){const F=Ue(ge,"users",Q.uid,"folders",A);await ug(F,{collaborationSettings:{...b},updatedAt:new Date().toISOString()})}}catch(F){console.error("   :",F)}},[Q]),kf=z.useCallback(async(A,b)=>{await ll(A,{enabled:b}),b?(s(F=>F.map(O=>O.id===A?{...O,isShared:!0}:O)),console.log("   :",A)):(E([]),C({}),console.log("   :",A))},[ll]);z.useCallback(()=>{if(!o)return null;const A=i.find(b=>b.id===o);return(A==null?void 0:A.collaborationSettings)||null},[o,i]);const Nf=(A,b)=>{if(!b.trim()){ae({title:"Error",message:"Folder name cannot be empty."});return}s(i.map(F=>F.id===A?{...F,name:b,updatedAt:new Date().toISOString()}:F))},ci=async A=>{const b=i.find(O=>O.id===A);if(!b)return;const F=n.filter(O=>O.folderId===A);if(Q&&F.length>0)try{for(const O of F){const H={...O};delete H.folderId;const Y=b.ownerId||Q.uid,K=it(ge,"users",Y,"todos"),X=Ue(K,O.id.toString()),W=Pt(H);W?(await gt(X,W),console.log(`  ${O.id} Firebase   `)):console.warn(`  ${O.id}   `)}console.log("     Firebase  :",{count:F.length})}catch(O){console.error("      :",O)}if(Q)try{const O=Ue(ge,"users",Q.uid,"folders",A);await Gt(O),console.log("  Firebase  :",A)}catch(O){console.error("  Firebase  :",O)}r(n.map(O=>{if(O.folderId===A){const H={...O};return delete H.folderId,H}return O})),s(i.filter(O=>O.id!==A)),o===A&&a(null)},fr=async A=>{if(!Re.trim()||!Q){$e("");return}try{const b={...A,name:Re.trim(),updatedAt:new Date().toISOString()},F=Ue(ge,"users",Q.uid,"folders",A.id),O=Pt(b);if(O)await gt(F,O),console.log("    Firestore  ");else throw new Error("   ");s(i.map(H=>H.id===A.id?b:H)),$e(""),console.log("    :",Re.trim())}catch(b){console.error("    :",b),$e("")}},Ic=async A=>{var b;if(!(!Ke.trim()||!Q||nn)){vn(!0);try{if(((b=A.sharedWith)==null?void 0:b.some(X=>X.email===Ke.trim()))||A.ownerEmail===Ke.trim()){alert("  ."),vn(!1);return}const O={email:Ke.trim(),userId:"",role:ut,addedAt:new Date().toISOString()},H={...A,sharedWith:[...A.sharedWith||[],O],updatedAt:new Date().toISOString()},Y=Ue(ge,"users",Q.uid,"folders",A.id),K=Pt(H);if(K)await gt(Y,K),console.log("   Firestore  ");else throw new Error("   ");s(i.map(X=>X.id===A.id?{...H,sharedWith:Array.isArray(H.sharedWith)?H.sharedWith.filter(W=>W&&typeof W.role=="string"&&["owner","editor","viewer"].includes(W.role)).map(W=>({...W,role:W.role})):[]}:X)),Vt(""),console.log("   :",O)}catch(F){console.error("   :",F)}finally{vn(!1)}}},wc=async(A,b,F)=>{var O;if(Q)try{const H={...A,sharedWith:(O=A.sharedWith)==null?void 0:O.map(X=>X.userId===b?{...X,role:F}:X),updatedAt:new Date().toISOString()},Y=Ue(ge,"users",Q.uid,"folders",A.id),K=Pt(H);if(K)await gt(Y,K);else throw new Error("   ");s(i.map(X=>X.id===A.id?{...H,sharedWith:Array.isArray(H.sharedWith)?H.sharedWith.filter(W=>W&&typeof W.role=="string"&&["owner","editor","viewer"].includes(W.role)).map(W=>({...W,role:W.role})):[]}:X)),console.log("    :",{userId:b,newRole:F})}catch(H){console.error("    :",H)}},Sc=async(A,b)=>{var F;if(Q&&confirm("  ?"))try{const O={...A,sharedWith:(F=A.sharedWith)==null?void 0:F.filter(K=>K.userId!==b),updatedAt:new Date().toISOString()},H=Ue(ge,"users",Q.uid,"folders",A.id),Y=Pt(O);if(Y)await gt(H,Y);else throw new Error("   ");s(i.map(K=>K.id===A.id?O:K)),console.log("   :",b)}catch(O){console.error("   :",O)}},Cc=A=>{const b=`${window.location.origin}${window.location.pathname}?invite=${A.id}`;navigator.clipboard.writeText(b).then(()=>{alert("  !")}).catch(()=>{alert("  .")})},Ac=A=>{confirm(se("folder_leave_confirm"))&&di(A)},di=async A=>{var b;if(Q)try{const F={...A,sharedWith:(b=A.sharedWith)==null?void 0:b.filter(Y=>Y.userId!==Q.uid),updatedAt:new Date().toISOString()},O=Ue(ge,"users",A.ownerId,"folders",A.id),H=Pt(F);if(H)await gt(O,H);else throw new Error("   ");s(i.filter(Y=>Y.id!==A.id)),o===A.id&&a(null),ce(!1),console.log("   ")}catch(F){console.error("   :",F)}},Df=A=>{confirm(se("folder_delete_confirm"))&&(ci(A.id),ce(!1))},bf=A=>{if(a(A),A&&Q){const b=i.find(F=>F.id===A);b!=null&&b.ownerId&&(async()=>{try{console.log(" Firestore   :",{folderId:A,ownerUid:b.ownerId});const F=it(ge,"users",b.ownerId,"todos"),O=Vl(F,Ll("folderId","==",A)),H=await Ti(O),Y=[];H.forEach(K=>{Y.push({id:parseInt(K.id),...K.data()})}),console.log("    :",{count:Y.length,todos:Y}),r(K=>{const X=K.filter(pe=>pe.folderId!==A),W=new Set(X.map(pe=>pe.id)),ne=Y.filter(pe=>!W.has(pe.id)),j=[...X,...ne];return console.log("   :",{:X.length,:ne.length,:j.length,:Y.length-ne.length}),j})}catch(F){console.error("    :",F)}})()}},Mf=async()=>{if(!o||!Q){xe("   ");return}wt(!0);try{console.log("    ...",o);const{doc:A,getDoc:b,collection:F,query:O,where:H,getDocs:Y}=await xs(async()=>{const{doc:de,getDoc:Me,collection:dt,query:In,where:Vr,getDocs:xo}=await Promise.resolve().then(()=>Ps);return{doc:de,getDoc:Me,collection:dt,query:In,where:Vr,getDocs:xo}},void 0);let K=i.find(de=>de.id===o);if(!K||!K.collaborators||K.collaborators.length===0){console.log("    , Firebase ...");const de=A(ge,"users",Q.uid,"folders",o),Me=await b(de);if(Me.exists())K={id:o,...Me.data()},console.log("   :",K);else{console.log("    ..."),ae({title:"    ",message:`   .
    .`,confirmText:"",onConfirm:()=>ae(null)}),wt(!1);return}}if(!K||!K.collaborators||K.collaborators.length===0){ae({title:"   ",message:`   .
   .`,confirmText:"",onConfirm:()=>ae(null)}),wt(!1);return}const X=K.collaborators.find(de=>de.role==="owner");if(!X||!X.userId){ae({title:"   ",message:`   .
  .`,confirmText:"",onConfirm:()=>ae(null)}),wt(!1);return}if(X.userId.startsWith("owner_")){console.warn("   ID :",X.userId),ae({title:"   ",message:`    .
     .`,confirmText:"",onConfirm:()=>ae(null)}),wt(!1);return}console.log("   :",{folderId:o,ownerUid:X.userId});const W=n.filter(de=>de.folderId===o);console.log("    :",W.length);const ne=F(ge,"users",X.userId,"todos"),j=O(ne,H("folderId","==",o)),pe=await Y(j),me=[];pe.forEach(de=>{me.push({id:parseInt(de.id),...de.data()})}),console.log("   :",me.length),W.length===me.length?(console.log("     "),xe(`    (${me.length}  -   )`)):(console.log("     :",{local:W.length,server:me.length}),r(de=>[...de.filter(In=>In.folderId!==o),...me]),xe(`   (${me.length}  - ${Math.abs(me.length-W.length)}  )`)),console.log("   :",o&&Q?"":"")}catch(A){console.error("  :",A),A instanceof Error?A.message.includes("permission-denied")?xe("  :    "):A.message.includes("not-found")?xe("  :    "):xe("  : "+A.message):xe("  :    ")}finally{wt(!1)}},pr=async()=>{wt(!0);try{console.log("   ..."),await ui(),xe("   "),console.log("   ")}catch(A){console.error("   :",A),xe("  ")}finally{wt(!1)}},Vf=async(A,b)=>{const F=n.find(K=>K.id===A);if(!F)return;const O=i.find(K=>K.id===b),H=(O==null?void 0:O.isShared)===!0,Y={...F,folderId:b||void 0,isSharedTodo:H};if(Q)try{const K=i.find(pe=>pe.id===(b||F.folderId)),X=(K==null?void 0:K.ownerId)||Q.uid,W=it(ge,"users",X,"todos"),ne=Ue(W,A.toString()),j=Pt(Y);j?(await gt(ne,j),console.log("    Firestore :",{targetOwnerUid:X,goalId:A,folderId:b,isSharedTodo:Y.isSharedTodo})):console.warn("     ")}catch(K){console.error("    Firestore  :",K)}r(n.map(K=>K.id===A?Y:K)),xe("   "),setTimeout(()=>xe(""),3e3)},ul=async A=>{Mr();const b=new Date().toISOString(),F=(()=>{const O=n.find(K=>K.id===A);if(!O)return null;const H=!O.completed;let Y=O.streak;return O.isRecurring&&(H?(!O.lastCompletedDate||!iu(b,O.lastCompletedDate))&&(Y=(O.streak||0)+1):O.lastCompletedDate&&iu(b,O.lastCompletedDate)&&(Y=Math.max(0,(O.streak||1)-1))),{...O,completed:H,lastCompletedDate:H?b:O.lastCompletedDate,streak:Y}})();if(F){if(Q)try{const O=i.find(W=>W.id===F.folderId),H=(O==null?void 0:O.ownerId)||Q.uid,Y=it(ge,"users",H,"todos"),K=Ue(Y,A.toString()),X=Pt(F);X?(await gt(K,X),console.log("    Firestore :",{targetOwnerUid:H,id:A,completed:F.completed})):console.warn("     ")}catch(O){console.error("    Firestore  :",O)}r(n.map(O=>O.id===A?F:O))}},Co=async A=>{if(A==="ai"){if(n.length<2){ae({title:se("sort_alert_title"),message:se("sort_alert_message")});return}be(!0);try{const b=En();if(!b){xe(vt?"  AI    .":"AI    API  ."),be(!1),v("manual");return}const F=`Here is a list of goals with their details (wish, outcome, obstacle, plan, deadline). Prioritize them based on urgency (closer deadline), importance (based on outcome), and feasibility (based on plan). Return a JSON object with "sorted_ids" array and "reasoning" string explaining your prioritization logic. Goals: ${JSON.stringify(n.map(({id:j,wish:pe,outcome:me,obstacle:le,plan:de,deadline:Me})=>({id:j,wish:pe,outcome:me,obstacle:le,plan:de,deadline:Me})))}`,O=await b.models.generateContent({model:"gemini-2.5-flash",contents:F,config:{responseMimeType:"application/json",responseSchema:{type:qn.OBJECT,properties:{sorted_ids:{type:qn.ARRAY,items:{type:qn.NUMBER}},reasoning:{type:qn.STRING}}}}}),H=JSON.parse(O.text),Y=H.sorted_ids.map(Number),K=new Map(n.map(j=>[Number(j.id),j])),X=Y.map(j=>K.get(j)).filter(Boolean),W=n.filter(j=>!Y.includes(Number(j.id))),ne=[...X,...W].map(j=>({...j,id:Number(j.id)}));r(ne),v("manual"),fs(H.reasoning||""),ps(!0)}catch(b){console.error("AI sort failed:",b),ae({title:se("ai_sort_error_title"),message:se("ai_sort_error_message")})}finally{be(!1)}}else v(A)},xc=A=>{const b=new Set(cs);b.has(A)?b.delete(A):b.add(A),ds(b)},hi=()=>{oi(!1),ds(new Set)},Ss=()=>{const A=new Set(He.map(b=>b.id));ds(A)},Rc=()=>{const A=cs.size;ae({title:se("delete_selected_confirm_title"),message:se("delete_selected_confirm_message").replace("{count}",String(A)),isDestructive:!0,confirmText:se("delete_selected_button_label").replace("{count}",String(A)),cancelText:se("cancel_button"),onConfirm:()=>{r(n.filter(b=>!cs.has(b.id))),hi()}})},cl=()=>{kr("exporting");const A=JSON.stringify(n,null,2),b="data:application/json;charset=utf-8,"+encodeURIComponent(A),F="nova_goals.json",O=document.createElement("a");O.setAttribute("href",b),O.setAttribute("download",F),O.click(),setTimeout(()=>{kr("idle"),hn(!1)},1500)},rt=A=>{var O;const b=(O=A.target.files)==null?void 0:O[0];if(!b)return;const F=new FileReader;F.onload=H=>{var Y;try{const K=(Y=H.target)==null?void 0:Y.result;if(typeof K!="string")throw new Error("File content is not a string");const X=JSON.parse(K);if(Array.isArray(X)&&X.every(W=>"wish"in W&&"id"in W))ae({title:se("import_confirm_title"),message:se("import_confirm_message"),confirmText:se("settings_import_data"),cancelText:se("cancel_button"),onConfirm:()=>{kr("importing"),setTimeout(()=>{r(X),xe(se("import_success_toast")),kr("idle"),hn(!1)},1500)}});else throw new Error("Invalid file format")}catch{ae({title:se("import_error_alert_title"),message:se("import_error_alert_message")})}},F.onerror=()=>ae({title:se("import_error_alert_title"),message:se("import_error_alert_message")}),F.readAsText(b),A.target.value=""},Lf=()=>{ae({title:"   ",message:`   ?

    :

   
 Firebase  
  
   
   `,confirmText:"",cancelText:"",isDestructive:!0,onConfirm:()=>{ae(null),Ff()},onCancel:()=>{ae(null)}})},Ff=async()=>{console.log(" performDeleteAllData  "),kr("deleting");try{if(Q){console.log("  :",{uid:Q.uid,email:Q.email}),console.log(" Firebase   ...");try{const W=Ue(ge,"users",Q.uid,"data","todos");await Gt(W),console.log("  todos   ")}catch(W){console.warn("  todos   :",W)}try{const W=Ue(ge,"users",Q.uid,"data","settings");await Gt(W),console.log("  settings   ")}catch(W){console.warn("  settings   :",W)}const A=it(ge,"users",Q.uid,"todos"),b=await Ti(A);console.log("  todos :",b.size);const F=b.docs.map(W=>Gt(W.ref));await Promise.all(F),console.log("  todos  :",b.size,"");const O=it(ge,"users",Q.uid,"folders"),H=await Ti(O);console.log("  folders :",H.size);const Y=H.docs.map(W=>Gt(W.ref));await Promise.all(Y),console.log(" folders  :",H.size,"");const K=it(ge,"sharedFolders"),X=await Ti(K);for(const W of X.docs){const ne=W.data();if(ne.collaborators&&Array.isArray(ne.collaborators)){const j=ne.collaborators.filter(pe=>pe.userId!==Q.uid);j.length!==ne.collaborators.length&&(await ug(W.ref,{collaborators:j}),console.log("     :",W.id))}}try{for(const W of i)if(W.id){const ne=Ue(ge,"folderPresence",W.id,"users",Q.uid);await Gt(ne)}console.log(" presence   ")}catch(W){console.warn(" presence     :",W)}try{const W=Vl(it(ge,"folderEditing"),Ll("userId","==",Q.uid)),j=(await Ti(W)).docs.map(pe=>Gt(pe.ref));await Promise.all(j),console.log(" editing states  ")}catch(W){console.warn(" editing states    :",W)}try{const W=Ue(ge,"users",Q.uid);await Gt(W),console.log("     ")}catch(W){console.warn("     :",W)}try{const W=it(ge,"notifications",Q.uid,"items"),j=(await Ti(W)).docs.map(me=>Gt(me.ref));await Promise.all(j);const pe=Ue(ge,"notifications",Q.uid);await Gt(pe),console.log("    ")}catch(W){console.warn("      :",W)}try{const W=it(ge,"userActivity",Q.uid,"logs"),j=(await Ti(W)).docs.map(me=>Gt(me.ref));await Promise.all(j);const pe=Ue(ge,"userActivity",Q.uid);await Gt(pe),console.log("     ")}catch(W){console.warn("       :",W)}try{const W=Ue(ge,"userMetadata",Q.uid);await Gt(W),console.log("    ")}catch(W){console.warn("      :",W)}try{const W=Ue(ge,"userSessions",Q.uid);await Gt(W),console.log("     ")}catch(W){console.warn("       :",W)}console.log("      -    ")}if(console.log("    ..."),r([]),s([]),E([]),C({}),M([]),a(null),ds(new Set),oi(!1),u("all"),m("all"),console.log("   ..."),e("ko"),S(!0),U("default"),v("manual"),P(["school","work","personal","other"]),console.log(" localStorage  ..."),localStorage.clear(),console.log(" localStorage   "),Q){console.log(" Firebase  ...");try{await pE(Ei),console.log("  ")}catch(A){console.warn("   :",A)}}console.log("    "),xe("    . ."),setTimeout(()=>{console.log("    ..."),window.location.reload()},1500)}catch(A){console.error("    :",A);let b="  ",F="    .";A instanceof Error&&(A.message.includes("permission-denied")||A.message.includes("insufficient permissions")?(b="  ",F=`  .

   .
(Firebase      )`):A.message.includes("network-request-failed")?(b="  ",F="    ."):A.message.includes("unauthenticated")?(b="  ",F=` .
 .`):F=`    .

 : `+A.message),ae({title:b,message:F,confirmText:"",onConfirm:()=>ae(null)})}finally{kr("idle"),hn(!1)}},Ao=Ne||!!je||!!Vn||dr||!!ct||hs||uc;return z.useEffect(()=>{if(rd()&&Ao)return document.body.classList.add("modal-open"),()=>{document.body.classList.remove("modal-open")};document.body.classList.remove("modal-open")},[Ao]),p.jsxs("div",{className:`main-page-layout ${It?"calendar-view-active":""}`,children:[p.jsxs("div",{className:`page-content ${Ao?"modal-open":""}`,children:[p.jsx(b3,{folders:i,currentFolderId:o,onSetCurrentFolder:bf,onCreateFolder:Pf,onRenameFolder:Nf,onDeleteFolder:ci,onSetCollaboratingFolder:ms,todos:n,t:se,onManageFolder:A=>{Ie(A),ce(!0)},currentUserId:Q==null?void 0:Q.uid}),p.jsxs("div",{className:"container",children:[p.jsx(M3,{t:se,isSelectionMode:Lt,selectedCount:cs.size,totalVisibleCount:He.length,onCancelSelection:hi,onDeleteSelected:Rc,onSelectAll:Ss,isViewModeCalendar:It,onToggleViewMode:()=>Ge(!It),isAiSorting:Pr,sortType:g,onSort:Co,filter:l,onFilter:u,categoryFilter:f,onCategoryFilter:m,userCategories:T,onAddCategory:A=>P([...T,A]),onRemoveCategory:A=>P(T.filter(b=>b!==A)),onSetSelectionMode:()=>oi(!0),onOpenSettings:()=>hn(!0),onAddGoal:()=>Fe(!0),currentFolderId:o,folders:i,onSyncSharedFolder:Mf,isSyncing:rl,isSyncingData:rl,onManualSync:pr,activeUsers:B,editingStates:w,onToggleCollaboration:kf,onUpdateCollaborationSettings:ll}),It?p.jsx(z3,{todos:n,t:se,onGoalClick:cr,language:t}):p.jsxs(p.Fragment,{children:[p.jsx(P3,{todos:He,onEditTodo:Ee,t:se}),p.jsx(V3,{todos:He,onToggleComplete:ul,onDelete:Ec,onEdit:Ee,onInfo:cr,t:se,filter:l,randomEncouragement:Es,isSelectionMode:Lt,selectedTodoIds:cs,onSelectTodo:xc,folders:i,onMoveToFolder:Vf})]})]}),rd()&&!It&&p.jsx("button",{onClick:()=>Fe(!0),className:"mobile-fab-button","aria-label":se("add_new_goal_button_label"),title:se("add_new_goal_button_label"),children:Se.add})]}),Ne&&p.jsx(XI,{onClose:()=>Fe(!1),onAddTodo:Is,onAddMultipleTodos:ws,t:se,language:t,createAI:En,userCategories:T}),je&&p.jsx(XI,{onClose:()=>Ee(null),onEditTodo:Tc,existingTodo:je,t:se,language:t,createAI:En}),Vn&&p.jsx(O3,{todo:Vn,onClose:()=>cr(null),t:se,createAI:En,onOpenCollaboration:A=>{const b=i.find(F=>F.id===A.folderId)||(A.folderId===null||A.folderId===void 0?null:void 0);b!==void 0&&ms(b||null)},userCategories:T,onUpdateGoal:Tc}),Tn!==void 0&&p.jsx(B3,{folder:Tn,onClose:()=>ms(void 0),t:se,googleUser:Q,onUpdateCollaborators:ol,setAlertConfig:ae}),dr&&p.jsx(G3,{onClose:()=>hn(!1),isDarkMode:D,onToggleDarkMode:()=>S(!D),themeMode:I,onThemeChange:Fn,backgroundTheme:V,onSetBackgroundTheme:U,onExportData:cl,onImportData:rt,setAlertConfig:ae,onDeleteAllData:Lf,dataActionStatus:lc,language:t,onSetLanguage:e,t:se,todos:n,setToastMessage:xe,onOpenVersionInfo:()=>Qa(!0),onOpenUsageGuide:()=>Ya(!0),apiKey:Ln,onSetApiKey:gs,isOfflineMode:vt,onToggleOfflineMode:()=>dc(!vt),googleUser:Q,onGoogleLogin:wo,onGoogleLogout:al,onSyncDataToFirebase:ui,onLoadDataFromFirebase:vc,isGoogleLoggingIn:hc,isGoogleLoggingOut:nl,isSyncingData:rl,isLoadingData:fc,isAutoSyncEnabled:hr,setIsAutoSyncEnabled:_s,onDiagnoseFirebase:yc}),hs&&p.jsx(ZI,{onClose:()=>Qa(!1),t:se}),uc&&p.jsx(q3,{onClose:()=>Ya(!1),t:se}),Xa&&p.jsx(_o,{onClose:()=>ps(!1),isClosing:!1,className:"ai-sort-reason-modal",children:p.jsxs("div",{style:{padding:"24px"},children:[p.jsx("h2",{style:{marginBottom:"16px",fontSize:"1.3rem",fontWeight:600},children:se("ai_sort_reason_modal_title")}),p.jsx("div",{style:{marginBottom:"24px",padding:"16px",backgroundColor:"var(--card-bg-color)",borderRadius:"8px",border:"1px solid var(--border-color)",lineHeight:"1.6",color:"var(--text-secondary-color)"},children:cc}),p.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:p.jsx("button",{onClick:()=>ps(!1),className:"primary",children:se("close_button")})})]})}),hs&&p.jsx(ZI,{onClose:()=>Qa(!1),t:se}),ct&&p.jsx($3,{title:ct.title,message:ct.message,onConfirm:()=>{var A;(A=ct.onConfirm)==null||A.call(ct),ae(null)},onCancel:ct.onCancel?()=>{var A;(A=ct.onCancel)==null||A.call(ct),ae(null)}:void 0,confirmText:ct.confirmText,cancelText:ct.cancelText,isDestructive:ct.isDestructive,t:se}),yo&&p.jsx("div",{className:"toast-notification",children:yo}),vo&&p.jsx(R3,{onClose:()=>Za(!1)}),te&&ve&&p.jsx("div",{className:"modal-backdrop",onClick:()=>ce(!1),children:p.jsxs("div",{className:"modal-content large-modal",onClick:A=>A.stopPropagation(),children:[p.jsxs("div",{className:"modal-header",children:[p.jsx("h3",{children:se("folder_manage_title")}),p.jsx("button",{onClick:()=>ce(!1),children:""})]}),p.jsx("div",{className:"modal-body",children:(()=>{var O,H,Y;const A=i.find(K=>K.id===ve);if(!A)return null;const b=A.ownerId===(Q==null?void 0:Q.uid),F=b?"owner":((H=(O=A.sharedWith)==null?void 0:O.find(K=>K.userId===(Q==null?void 0:Q.uid)))==null?void 0:H.role)||"viewer";return p.jsxs("div",{className:"folder-manage-content",children:[p.jsxs("div",{className:"folder-info-section",children:[p.jsx("h4",{children:se("folder_manage_info")}),p.jsxs("div",{className:"folder-info-item",children:[p.jsxs("label",{children:[se("folder_name"),":"]}),Re?p.jsxs("div",{className:"inline-edit",children:[p.jsx("input",{type:"text",value:Re,onChange:K=>$e(K.target.value),onKeyPress:K=>{K.key==="Enter"&&fr(A)}}),p.jsx("button",{onClick:()=>fr(A),children:""}),p.jsx("button",{onClick:()=>$e(""),children:""})]}):p.jsxs("div",{className:"folder-name-display",children:[p.jsx("span",{children:A.name}),b&&p.jsx("button",{className:"edit-btn",onClick:()=>$e(A.name),children:""})]})]}),p.jsxs("div",{className:"folder-info-item",children:[p.jsxs("label",{children:[se("folder_owner"),":"]}),p.jsx("span",{children:A.ownerEmail||A.ownerId})]}),p.jsxs("div",{className:"folder-info-item",children:[p.jsxs("label",{children:[se("role"),":"]}),p.jsx("span",{children:se(F==="owner"?"folder_role_owner":F==="editor"?"folder_role_editor":"folder_role_viewer")})]}),p.jsxs("div",{className:"folder-info-item",children:[p.jsxs("label",{children:[se("created_date"),":"]}),p.jsx("span",{children:new Date(A.createdAt).toLocaleDateString()})]})]}),p.jsxs("div",{className:"collaborators-section",children:[p.jsx("h4",{children:se("folder_manage_collaborators")}),p.jsxs("div",{className:"collaborator-list",children:[p.jsx("div",{className:"collaborator-item owner",children:p.jsxs("div",{className:"collaborator-info",children:[p.jsx("span",{className:"email",children:A.ownerEmail||A.ownerId}),p.jsx("span",{className:"role owner-role",children:se("folder_role_owner")})]})}),((Y=A.sharedWith)==null?void 0:Y.map((K,X)=>p.jsxs("div",{className:"collaborator-item",children:[p.jsxs("div",{className:"collaborator-info",children:[p.jsx("span",{className:"email",children:K.email||K.userId}),p.jsx("span",{className:`role ${K.role}`,children:K.role==="editor"?se("folder_role_editor"):se("folder_role_viewer")})]}),b&&p.jsxs("div",{className:"collaborator-actions",children:[p.jsxs("select",{value:K.role,onChange:W=>wc(A,K.userId,W.target.value),children:[p.jsx("option",{value:"editor",children:se("folder_role_editor")}),p.jsx("option",{value:"viewer",children:se("folder_role_viewer")})]}),p.jsx("button",{className:"remove-btn",onClick:()=>Sc(A,K.userId),children:""})]})]},X)))||[]]}),(b||F==="editor")&&p.jsxs("div",{className:"invite-section",children:[p.jsx("h5",{children:se("folder_invite_new")}),p.jsxs("div",{className:"invite-form",children:[p.jsx("input",{type:"email",placeholder:se("folder_invite_email"),value:Ke,onChange:K=>Vt(K.target.value)}),p.jsxs("select",{value:ut,onChange:K=>_e(K.target.value),children:[p.jsx("option",{value:"editor",children:se("folder_role_editor")}),p.jsx("option",{value:"viewer",children:se("folder_role_viewer")})]}),p.jsx("button",{onClick:()=>Ic(A),disabled:!Ke||nn,children:nn?" ...":se("folder_invite_button")})]})]})]}),p.jsxs("div",{className:"folder-settings-section",children:[p.jsx("h4",{children:se("folder_manage_settings")}),p.jsxs("div",{className:"share-link-section",children:[p.jsx("label",{children:se("folder_share_link")}),p.jsx("p",{className:"share-link-desc",children:se("folder_share_link_desc")}),p.jsxs("div",{className:"share-link-input",children:[p.jsx("input",{type:"text",readOnly:!0,value:`${window.location.origin}${window.location.pathname}?invite=${A.id}`}),p.jsx("button",{onClick:()=>Cc(A),children:se("folder_copy_link")})]})]}),p.jsxs("div",{className:"folder-actions",children:[!b&&p.jsx("button",{className:"leave-folder-btn",onClick:()=>Ac(A),children:se("folder_leave")}),b&&p.jsx("button",{className:"delete-folder-btn",onClick:()=>Df(A),children:se("folder_delete")})]})]})]})})()})]})})]})},b3=({folders:t,currentFolderId:e,onSetCurrentFolder:n,onCreateFolder:r,onRenameFolder:i,onDeleteFolder:s,onSetCollaboratingFolder:o,todos:a,t:l,onManageFolder:u,currentUserId:f})=>{var B;const[m,g]=z.useState(!1),[v,T]=z.useState(""),[P,D]=z.useState(null),[S,I]=z.useState(""),[R,V]=z.useState(null),U=()=>{v.trim()&&(r(v),T(""),g(!1))};return p.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid var(--border-color)",overflowX:"auto",display:"flex",gap:"8px",alignItems:"center",backgroundColor:"var(--card-bg-color)"},children:[p.jsxs("button",{onClick:()=>n(null),style:{padding:"6px 12px",borderRadius:"8px",border:"none",backgroundColor:e===null?"var(--primary-color)":"transparent",color:e===null?"white":"var(--text-color)",cursor:"pointer",fontSize:"0.9rem",fontWeight:500,whiteSpace:"nowrap",transition:"all 0.2s",minWidth:"80px",textAlign:"center"},children:[" ",l("all_goals_label")||"All"]}),p.jsx("button",{onClick:()=>n("all"),style:{padding:"6px 12px",borderRadius:"8px",border:"none",backgroundColor:e==="all"?"#ff6b6b":"transparent",color:e==="all"?"white":"var(--text-color)",cursor:"pointer",fontSize:"0.9rem",fontWeight:500,whiteSpace:"nowrap",transition:"all 0.2s",minWidth:"80px",textAlign:"center"},children:" "}),t.length>0&&t.filter(E=>e===null?!E.isShared||E.isShared&&E.ownerId===f:!0).map(E=>{const w=a.filter(C=>C.folderId===E.id).length;return p.jsxs("div",{style:{position:"relative",display:"inline-flex",alignItems:"center",gap:"2px"},children:[p.jsxs("button",{onClick:()=>n(E.id),style:{padding:"6px 12px",borderRadius:"8px",border:"none",backgroundColor:e===E.id?E.color||"var(--primary-color)":`${E.color}20`||"transparent",color:e===E.id?"white":"var(--text-color)",cursor:"pointer",fontSize:"0.9rem",fontWeight:500,whiteSpace:"nowrap",transition:"all 0.2s",position:"relative"},title:E.isShared?" ":" ",children:[E.isShared?"":""," ",E.name," (",w,")"]}),e===E.id&&p.jsxs("div",{style:{display:"flex",gap:"2px"},children:[p.jsx("button",{onClick:()=>o(E),style:{width:"24px",height:"24px",padding:"0",borderRadius:"4px",border:"none",backgroundColor:"var(--primary-color)",color:"white",cursor:"pointer",fontSize:"0.8rem",lineHeight:"1",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s"},title:" ",children:""}),p.jsx("button",{onClick:()=>u(E.id),style:{width:"24px",height:"24px",padding:"0",borderRadius:"4px",border:"none",backgroundColor:"var(--button-bg-color)",color:"var(--text-color)",cursor:"pointer",fontSize:"0.8rem",lineHeight:"1",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s"},title:" ",children:""}),p.jsx("button",{onClick:()=>{D(E.id),I(E.name)},style:{width:"24px",height:"24px",padding:"0",borderRadius:"4px",border:"none",backgroundColor:"var(--button-bg-color)",color:"var(--text-color)",cursor:"pointer",fontSize:"0.8rem",lineHeight:"1",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s"},title:"  ",children:""}),p.jsx("button",{onClick:()=>{V(E.id)},style:{width:"24px",height:"24px",padding:"0",borderRadius:"4px",border:"none",backgroundColor:"var(--danger-color)",color:"white",cursor:"pointer",fontSize:"0.8rem",lineHeight:"1",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s"},title:" ",children:""})]})]},E.id)}),m?p.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[p.jsx("input",{type:"text",value:v,onChange:E=>T(E.target.value),onKeyPress:E=>{E.key==="Enter"&&U(),E.key==="Escape"&&(g(!1),T(""))},placeholder:" ...",autoFocus:!0,style:{padding:"6px 12px",borderRadius:"8px",border:"2px solid var(--primary-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontSize:"0.9rem",outline:"none",width:"120px"}}),p.jsx("button",{onClick:U,style:{padding:"4px 12px",borderRadius:"8px",border:"none",backgroundColor:"var(--primary-color)",color:"white",cursor:"pointer",fontSize:"0.85rem",fontWeight:600,transition:"all 0.2s"},children:""}),p.jsx("button",{onClick:()=>{g(!1),T("")},style:{padding:"4px 12px",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"transparent",color:"var(--text-color)",cursor:"pointer",fontSize:"0.85rem",transition:"all 0.2s"},children:""})]}):p.jsx("button",{onClick:()=>g(!0),style:{padding:"6px 12px",borderRadius:"8px",border:"2px solid var(--primary-color)",backgroundColor:"transparent",color:"var(--primary-color)",cursor:"pointer",fontSize:"0.9rem",fontWeight:500,whiteSpace:"nowrap",transition:"all 0.2s",display:"flex",alignItems:"center",gap:"4px"},children:" "}),R&&p.jsx("div",{className:"modal-backdrop alert-backdrop",children:p.jsxs("div",{className:"modal-content alert-modal",children:[p.jsxs("div",{className:"alert-content",children:[p.jsx("h2",{children:" "}),p.jsxs("p",{style:{fontSize:"0.9rem"},children:['"',(B=t.find(E=>E.id===R))==null?void 0:B.name,'"  ?',p.jsx("br",{}),'   " " .']})]}),p.jsxs("div",{className:"modal-buttons",children:[p.jsx("button",{onClick:()=>V(null),className:"secondary",children:""}),p.jsx("button",{onClick:()=>{s(R),V(null)},className:"destructive",children:""})]})]})}),P&&p.jsx("div",{className:"modal-backdrop alert-backdrop",children:p.jsxs("div",{className:"modal-content alert-modal",children:[p.jsxs("div",{className:"alert-content",children:[p.jsx("h2",{children:"  "}),p.jsx("p",{style:{fontSize:"0.9rem",marginBottom:"16px"},children:"   "}),p.jsx("input",{type:"text",value:S,onChange:E=>I(E.target.value),onKeyPress:E=>{E.key==="Enter"&&S.trim()&&(i(P,S),D(null),I(""))},placeholder:" ...",autoFocus:!0,style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontSize:"0.95rem",outline:"none",boxSizing:"border-box"}})]}),p.jsxs("div",{className:"modal-buttons",children:[p.jsx("button",{onClick:()=>{D(null),I("")},className:"secondary",children:""}),p.jsx("button",{onClick:()=>{S.trim()&&(i(P,S),D(null),I(""))},className:"primary",children:""})]})]})})]})},M3=({t,isSelectionMode:e,selectedCount:n,totalVisibleCount:r,onCancelSelection:i,onDeleteSelected:s,onSelectAll:o,isViewModeCalendar:a,onToggleViewMode:l,isAiSorting:u,sortType:f,onSort:m,filter:g,onFilter:v,categoryFilter:T,onCategoryFilter:P,userCategories:D,onAddCategory:S,onRemoveCategory:I,onSetSelectionMode:R,onOpenSettings:V,onAddGoal:U,currentFolderId:B,folders:E,onSyncSharedFolder:w,isSyncing:C,isSyncingData:k,onManualSync:M,activeUsers:L,editingStates:N,onToggleCollaboration:Ne,onUpdateCollaborationSettings:Fe})=>{var Vt,ut;const[je,Ee]=z.useState(!1),[te,ce]=z.useState(!1),ve=B?E.find(_e=>_e.id===B):null,Ie=ve==null?void 0:ve.collaborationSettings,Re=(Ie==null?void 0:Ie.enabled)||(ve==null?void 0:ve.isShared)||!1;z.useEffect(()=>{const _e=()=>{Ee(!1),ce(!1)};return document.addEventListener("click",_e),document.addEventListener("touchstart",_e),()=>{document.removeEventListener("click",_e),document.removeEventListener("touchstart",_e)}},[]);const $e=_e=>{_e.stopPropagation(),Ee(nn=>!nn)},Ke=_e=>{_e.stopPropagation()};return p.jsxs("header",{children:[p.jsx("div",{className:"header-left",children:e&&p.jsx("button",{onClick:i,className:"header-action-button",children:t("cancel_selection_button_label")})}),p.jsxs("div",{className:"header-title-group",children:[p.jsx("h1",{children:t("my_goals_title")}),!e&&p.jsxs("div",{className:"header-inline-actions",children:[p.jsx("button",{onClick:l,className:"header-icon-button","aria-label":t(a?"list_view_button_aria":"calendar_view_button_aria"),children:a?Se.list:Se.calendar}),p.jsxs("div",{className:"filter-sort-container",children:[p.jsx("button",{onClick:$e,onTouchStart:$e,className:"header-icon-button","aria-label":t("filter_sort_button_aria"),children:u?p.jsx("div",{className:"spinner"}):Se.filter}),je&&p.jsxs("div",{className:"profile-popover filter-sort-popover",onClick:Ke,onTouchStart:Ke,children:[p.jsx("div",{className:"popover-section",children:p.jsx("button",{onClick:()=>{R(),Ee(!1)},className:"popover-action-button",children:p.jsx("span",{children:t("select_button_label")})})}),p.jsxs("div",{className:"popover-section",children:[p.jsx("h4",{children:t("filter_title")}),p.jsxs("button",{onClick:()=>{v("all")},className:`popover-action-button ${g==="all"?"active":""}`,children:[p.jsx("span",{children:t("filter_all")}),g==="all"&&Se.check]}),p.jsxs("button",{onClick:()=>{v("active")},className:`popover-action-button ${g==="active"?"active":""}`,children:[p.jsx("span",{children:t("filter_active")}),g==="active"&&Se.check]}),p.jsxs("button",{onClick:()=>{v("completed")},className:`popover-action-button ${g==="completed"?"active":""}`,children:[p.jsx("span",{children:t("filter_completed")}),g==="completed"&&Se.check]})]}),p.jsxs("div",{className:"popover-section",children:[p.jsxs("h4",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[p.jsx("span",{children:t("filter_category")}),p.jsx("button",{onClick:()=>{const _e=prompt("  : (New category name:)");_e&&_e.trim()&&!D.includes(_e.trim())&&S(_e.trim())},style:{background:"none",border:"none",color:"var(--primary-color)",cursor:"pointer",fontSize:"1.2rem",padding:"0"},children:"+"})]}),p.jsxs("button",{onClick:()=>{P("all")},className:`popover-action-button ${T==="all"?"active":""}`,children:[p.jsx("span",{children:t("category_all")}),T==="all"&&Se.check]}),D.map(_e=>p.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[p.jsxs("button",{onClick:()=>{P(_e)},className:`popover-action-button ${T===_e?"active":""}`,style:{flex:1,justifyContent:"space-between"},children:[p.jsx("span",{children:_e}),T===_e&&Se.check]}),!["school","work","personal","other"].includes(_e)&&p.jsx("button",{onClick:()=>I(_e),style:{background:"rgba(255, 59, 48, 0.1)",border:"none",color:"var(--danger-color)",borderRadius:"4px",padding:"4px 8px",cursor:"pointer",fontSize:"0.8rem"},children:""})]},_e))]}),p.jsxs("div",{className:"popover-section",children:[p.jsx("h4",{children:t("sort_title")}),p.jsxs("button",{onClick:()=>{m("manual")},className:`popover-action-button ${f==="manual"?"active":""}`,children:[p.jsx("span",{children:t("sort_label_manual")}),f==="manual"&&Se.check]}),p.jsxs("button",{onClick:()=>{m("deadline")},className:`popover-action-button ${f==="deadline"?"active":""}`,children:[p.jsx("span",{children:t("sort_label_deadline")}),f==="deadline"&&Se.check]}),p.jsxs("button",{onClick:()=>{m("newest")},className:`popover-action-button ${f==="newest"?"active":""}`,children:[p.jsx("span",{children:t("sort_label_newest")}),f==="newest"&&Se.check]}),p.jsxs("button",{onClick:()=>{m("alphabetical")},className:`popover-action-button ${f==="alphabetical"?"active":""}`,children:[p.jsx("span",{children:t("sort_label_alphabetical")}),f==="alphabetical"&&Se.check]}),p.jsxs("button",{onClick:()=>{m("ai")},className:"popover-action-button with-icon",children:[p.jsx("span",{className:"popover-button-icon",children:Se.ai}),p.jsx("span",{children:t(u?"ai_sorting_button":"sort_label_ai")})]}),p.jsx("button",{onClick:()=>{m("ai"),Ee(!1)},className:"popover-action-button",style:{backgroundColor:"rgba(88, 86, 214, 0.1)",marginTop:"8px",color:"var(--icon-color-indigo)"},children:p.jsx("span",{children:"   "})})]})]})]}),B&&((Vt=E.find(_e=>_e.id===B))==null?void 0:Vt.isShared)&&p.jsxs("div",{className:"collaboration-settings",children:[p.jsx("button",{onClick:()=>ce(!te),className:`main-action-button ${Re?"collaboration-active":""}`,"aria-label":" ",title:" ",style:{borderRadius:"999px",padding:"8px 16px",fontWeight:500},children:Re?"":""}),te&&B&&p.jsx("div",{className:"profile-popover collaboration-popover",style:{right:"60px",top:"50px"},children:p.jsxs("div",{className:"popover-section",children:[p.jsx("h4",{style:{marginBottom:"12px"},children:" "}),p.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[p.jsx("span",{children:" "}),p.jsx("button",{onClick:()=>Ne(B,!Re),style:{background:Re?"var(--primary-color)":"#ccc",border:"none",borderRadius:"12px",width:"44px",height:"24px",position:"relative",cursor:"pointer",transition:"background 0.2s"},children:p.jsx("div",{style:{background:"white",borderRadius:"50%",width:"20px",height:"20px",position:"absolute",top:"2px",left:Re?"22px":"2px",transition:"left 0.2s"}})})]}),Re&&L.length>0&&p.jsxs("div",{style:{marginBottom:"16px"},children:[p.jsxs("h5",{style:{marginBottom:"8px",fontSize:"0.9rem"},children:["  (",L.length,")"]}),p.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:L.map(_e=>p.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",background:"rgba(var(--primary-color-rgb), 0.1)",padding:"4px 8px",borderRadius:"12px",fontSize:"0.8rem"},children:[_e.photoURL&&p.jsx("img",{src:_e.photoURL,alt:"",style:{width:"16px",height:"16px",borderRadius:"50%"}}),p.jsx("span",{children:_e.displayName}),p.jsx("div",{style:{width:"6px",height:"6px",background:_e.isOnline?"#34C759":"#ccc",borderRadius:"50%"}})]},_e.userId))})]}),Re&&p.jsx(p.Fragment,{children:p.jsxs("div",{style:{borderTop:"1px solid #eee",paddingTop:"16px"},children:[p.jsx("h5",{style:{marginBottom:"8px",fontSize:"0.9rem"},children:" "}),p.jsxs("label",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px",cursor:"pointer"},children:[p.jsx("span",{style:{fontSize:"0.8rem"},children:" "}),p.jsx("input",{type:"checkbox",checked:(Ie==null?void 0:Ie.showPresence)??!0,onChange:_e=>Fe(B,{showPresence:_e.target.checked})})]}),p.jsxs("label",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px",cursor:"pointer"},children:[p.jsx("span",{style:{fontSize:"0.8rem"},children:"  "}),p.jsx("input",{type:"checkbox",checked:(Ie==null?void 0:Ie.showEditingState)??!0,onChange:_e=>Fe(B,{showEditingState:_e.target.checked})})]}),p.jsxs("label",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px",cursor:"pointer"},children:[p.jsx("span",{style:{fontSize:"0.8rem"},children:" "}),p.jsx("input",{type:"checkbox",checked:(Ie==null?void 0:Ie.enableConflictDetection)??!0,onChange:_e=>Fe(B,{enableConflictDetection:_e.target.checked})})]})]})})]})})]}),B&&((ut=E.find(_e=>_e.id===B))==null?void 0:ut.isShared)&&p.jsx("button",{onClick:w,disabled:C,className:"main-action-button","aria-label":"",title:C?" ...":`   
    `,style:{borderRadius:"999px",padding:"8px 16px",fontWeight:500,marginLeft:8},children:C?p.jsx("div",{className:"spinner",style:{width:"20px",height:"20px"}}):""}),p.jsx("button",{className:"sync-status-indicator clickable",onClick:()=>{var _e;k||(B&&((_e=E.find(nn=>nn.id===B))!=null&&_e.isShared)?w():M())},disabled:k,title:k?" ...":"  ",children:k?p.jsx("span",{style:{fontSize:"12px"},children:""}):p.jsx("span",{style:{fontSize:"12px"},children:""})}),p.jsx("button",{onClick:V,className:"header-icon-button","aria-label":t("settings_title"),children:Se.settings})]})]}),p.jsx("div",{className:"header-right",children:e?p.jsxs(p.Fragment,{children:[n===0?p.jsx("button",{onClick:o,className:"header-action-button",children:t("select_all_button_label")}):n===r?p.jsx("button",{onClick:i,className:"header-action-button",children:t("cancel_selection_button_label")}):p.jsxs(p.Fragment,{children:[p.jsx("button",{onClick:o,className:"header-action-button",children:t("select_all_button_label")}),p.jsx("button",{onClick:i,className:"header-action-button",children:t("cancel_selection_button_label")})]}),n>0&&p.jsx("button",{onClick:s,className:"header-action-button destructive",children:t("delete_selected_button_label").replace("{count}",String(n))})]}):p.jsx(p.Fragment,{children:p.jsx("button",{onClick:U,className:"header-icon-button header-add-button-desktop","aria-label":t("add_new_goal_button_label"),children:Se.add})})})]})},V3=({todos:t,onToggleComplete:e,onDelete:n,onEdit:r,onInfo:i,t:s,filter:o,randomEncouragement:a,isSelectionMode:l,selectedTodoIds:u,onSelectTodo:f,folders:m,onMoveToFolder:g})=>{if(t.length===0){const v=`empty_message_${o}`;return p.jsx("div",{className:"empty-message",children:p.jsx("p",{children:s(v)})})}return p.jsx("ul",{children:t.map(v=>p.jsx(L3,{todo:v,onToggleComplete:e,onDelete:n,onEdit:r,onInfo:i,t:s,isSelectionMode:l,isSelected:u.has(v.id),onSelect:f,folders:m,onMoveToFolder:g},v.id))})},L3=cw.memo(({todo:t,onToggleComplete:e,onDelete:n,onEdit:r,onInfo:i,t:s,isSelectionMode:o,isSelected:a,onSelect:l,folders:u,onMoveToFolder:f})=>{var T;const m=()=>{o&&l(t.id)},g={school:"",work:"",personal:"",other:""},v=P=>P?{school:s("category_school"),work:s("category_work"),personal:s("category_personal"),other:s("category_other")}[P]||P:"";return p.jsx("li",{className:`${t.completed?"completed":""} ${o?"selection-mode":""} ${a?"selected":""}`,onClick:m,children:p.jsxs("div",{className:"swipeable-content",children:[p.jsxs("label",{className:"checkbox-container",onClick:P=>P.stopPropagation(),children:[p.jsx("input",{type:"checkbox",checked:t.completed,onChange:()=>e(t.id)}),p.jsx("span",{className:"checkmark"})]}),p.jsxs("div",{className:"todo-text-with-streak",children:[p.jsx("span",{className:"todo-text",children:t.wish}),t.isRecurring&&t.streak>0&&p.jsxs("div",{className:"streak-indicator",children:[Se.flame,p.jsx("span",{children:t.streak})]})]}),p.jsxs("div",{className:"todo-actions-and-meta",children:[p.jsxs("div",{className:"todo-meta-badges",children:[t.category&&p.jsxs("span",{style:{backgroundColor:"rgba(88, 86, 214, 0.1)",color:"var(--icon-color-indigo)",padding:"4px 8px",borderRadius:"4px",fontSize:"0.8rem",marginRight:"4px",display:"inline-flex",alignItems:"center",gap:"4px",whiteSpace:"nowrap"},children:[g[t.category]||""," ",v(t.category)]}),t.deadline&&p.jsx("span",{className:"todo-deadline",children:N3(t.deadline,s)}),t.collaborators&&t.collaborators.length>0&&p.jsxs("span",{style:{backgroundColor:"rgba(52, 199, 89, 0.1)",color:"var(--success-color)",padding:"4px 8px",borderRadius:"4px",fontSize:"0.85rem",marginLeft:"4px",display:"inline-flex",alignItems:"center",gap:"4px"},children:[" ",t.collaborators.length]}),t.folderId&&p.jsxs("span",{style:{backgroundColor:"rgba(100, 150, 200, 0.15)",color:"var(--primary-color)",padding:"4px 8px",borderRadius:"4px",fontSize:"0.8rem",marginLeft:"4px",display:"inline-flex",alignItems:"center",gap:"4px",whiteSpace:"nowrap"},children:[" ",((T=u.find(P=>P.id===t.folderId))==null?void 0:T.name)||"Unknown"]})]}),p.jsxs("div",{className:"todo-buttons",children:[p.jsxs("select",{onClick:P=>P.stopPropagation(),onChange:P=>{f(t.id,P.target.value==="root"?null:P.target.value)},defaultValue:t.folderId||"root",style:{padding:"4px 8px",borderRadius:"4px",border:"1px solid var(--border-color)",backgroundColor:"var(--card-bg-color)",color:"var(--text-color)",cursor:"pointer",fontSize:"0.85rem",fontFamily:"inherit"},title:" ",children:[p.jsx("option",{value:"root",children:"  "}),u.map(P=>p.jsx("option",{value:P.id,children:P.name},P.id))]}),p.jsx("button",{onClick:P=>{P.stopPropagation(),r(t)},className:"info-button edit-button","aria-label":s("edit_button_aria"),children:Se.edit}),p.jsx("button",{onClick:P=>{P.stopPropagation(),n(t.id)},className:"delete-button","aria-label":s("delete_button"),children:Se.delete}),p.jsx("button",{onClick:P=>{P.stopPropagation(),i(t)},className:"info-button","aria-label":s("info_button_aria"),children:Se.info})]})]})]})})}),_o=({onClose:t,children:e,className:n="",isClosing:r,size:i="large"})=>{const s={small:"modal-content-small",medium:"modal-content-medium",large:"modal-content-large"}[i];return p.jsx("div",{className:`modal-backdrop ${r?"is-closing":""}`,onClick:t,children:p.jsx("div",{className:`modal-content ${s} ${n} ${r?"is-closing":""}`,onClick:o=>o.stopPropagation(),children:e})})},Ja=t=>{const[e,n]=z.useState(!1);return[e,()=>{n(!0),setTimeout(t,500)}]},F3=({step:t,t:e,createAI:n,...r})=>{const{wish:i,setWish:s,outcome:o,setOutcome:a,obstacle:l,setObstacle:u,plan:f,setPlan:m,isRecurring:g,setIsRecurring:v,recurringDays:T,setRecurringDays:P,deadline:D,setDeadline:S,noDeadline:I,setNoDeadline:R,category:V,setCategory:U,userCategories:B,errors:E,language:w}=r,[C,k]=z.useState(!1),[M,L]=z.useState(""),[N,Ne]=z.useState(""),Fe=async(je,Ee)=>{if(Ee){k(!0),L(""),Ne("");try{const te=n();if(!te){Ne("AI    API  ."),k(!1);return}const ce=`Provide concise, actionable feedback on this part of a WOOP goal: ${je} - "${Ee}". The feedback should be helpful and encouraging, in ${w==="ko"?"Korean":"English"}. Keep it to 1-2 sentences.`,ve=await te.models.generateContent({model:"gemini-2.5-flash",contents:ce});L(ve.text)}catch(te){console.error("AI Feedback Error:",te),Ne("Failed to get AI feedback.")}finally{k(!1)}}};switch(t){case 1:return p.jsxs("div",{children:[p.jsx("h3",{children:e("wish_label")}),p.jsxs("div",{className:"step-guidance",children:[p.jsx("p",{className:"tip",children:e("wish_tip")}),p.jsx("p",{className:"example",children:e("wish_example")})]}),p.jsx("textarea",{value:i,onChange:Ee=>{s(Ee.target.value),L(""),Ne("")},placeholder:e("wish_label"),className:E.wish?"input-error":"",rows:3}),E.wish&&p.jsxs("p",{className:"field-error-message",children:[Se.exclamation," ",e("error_wish_required")]}),p.jsxs("div",{className:"ai-feedback-section",children:[p.jsxs("button",{onClick:()=>Fe("Wish",i),disabled:!i.trim()||C,className:"ai-feedback-button",children:[C?p.jsx("div",{className:"spinner-small"}):"",p.jsx("span",{children:e(C?"ai_analyzing":"ai_coach_suggestion")})]}),M&&p.jsx("div",{className:"ai-feedback-bubble",children:M}),N&&p.jsx("div",{className:"ai-feedback-bubble error",children:N})]})]});case 2:return p.jsxs("div",{children:[p.jsx("h3",{children:e("outcome_label")}),p.jsxs("div",{className:"step-guidance",children:[p.jsx("p",{className:"tip",children:e("outcome_tip")}),p.jsx("p",{className:"example",children:e("outcome_example")})]}),p.jsx("textarea",{value:o,onChange:Ee=>{a(Ee.target.value),L(""),Ne("")},placeholder:e("outcome_label"),className:E.outcome?"input-error":"",rows:3}),E.outcome&&p.jsxs("p",{className:"field-error-message",children:[Se.exclamation," ",e("error_outcome_required")]}),p.jsxs("div",{className:"ai-feedback-section",children:[p.jsxs("button",{onClick:()=>Fe("Outcome",o),disabled:!o.trim()||C,className:"ai-feedback-button",children:[C?p.jsx("div",{className:"spinner-small"}):"",p.jsx("span",{children:e(C?"ai_analyzing":"ai_coach_suggestion")})]}),M&&p.jsx("div",{className:"ai-feedback-bubble",children:M}),N&&p.jsx("div",{className:"ai-feedback-bubble error",children:N})]})]});case 3:return p.jsxs("div",{children:[p.jsx("h3",{children:e("obstacle_label")}),p.jsxs("div",{className:"step-guidance",children:[p.jsx("p",{className:"tip",children:e("obstacle_tip")}),p.jsx("p",{className:"example",children:e("obstacle_example")})]}),p.jsx("textarea",{value:l,onChange:Ee=>{u(Ee.target.value),L(""),Ne("")},placeholder:e("obstacle_label"),className:E.obstacle?"input-error":"",rows:3}),E.obstacle&&p.jsxs("p",{className:"field-error-message",children:[Se.exclamation," ",e("error_obstacle_required")]}),p.jsxs("div",{className:"ai-feedback-section",children:[p.jsxs("button",{onClick:()=>Fe("Obstacle",l),disabled:!l.trim()||C,className:"ai-feedback-button",children:[C?p.jsx("div",{className:"spinner-small"}):"",p.jsx("span",{children:e(C?"ai_analyzing":"ai_coach_suggestion")})]}),M&&p.jsx("div",{className:"ai-feedback-bubble",children:M}),N&&p.jsx("div",{className:"ai-feedback-bubble error",children:N})]})]});case 4:return p.jsxs("div",{children:[p.jsx("h3",{children:e("plan_label")}),p.jsxs("div",{className:"step-guidance",children:[p.jsx("p",{className:"tip",children:e("plan_tip")}),p.jsx("p",{className:"example",children:e("plan_example")})]}),p.jsx("textarea",{value:f,onChange:Ee=>{m(Ee.target.value),L(""),Ne("")},placeholder:e("plan_label"),className:E.plan?"input-error":"",rows:3}),E.plan&&p.jsxs("p",{className:"field-error-message",children:[Se.exclamation," ",e("error_plan_required")]}),p.jsxs("div",{className:"ai-feedback-section",children:[p.jsxs("button",{onClick:()=>Fe("Plan",f),disabled:!f.trim()||C,className:"ai-feedback-button",children:[C?p.jsx("div",{className:"spinner-small"}):"",p.jsx("span",{children:e(C?"ai_analyzing":"ai_coach_suggestion")})]}),M&&p.jsx("div",{className:"ai-feedback-bubble",children:M}),N&&p.jsx("div",{className:"ai-feedback-bubble error",children:N})]})]});case 5:const je=Ee=>{const te=[...T],ce=te.indexOf(Ee);ce>-1?te.splice(ce,1):te.push(Ee),P(te)};return p.jsxs("div",{children:[p.jsxs("h3",{children:[e("recurrence_label")," & ",e("deadline_label")," & ",e("category_label")]}),p.jsxs("div",{className:"step-guidance",children:[p.jsx("p",{className:"tip",children:e("recurrence_tip")}),p.jsx("p",{className:"example",children:e("recurrence_example")})]}),p.jsxs("label",{className:"settings-item standalone-toggle",children:[p.jsx("span",{style:{fontWeight:500},children:e("recurrence_option_daily")}),p.jsxs("label",{className:"theme-toggle-switch",children:[p.jsx("input",{type:"checkbox",checked:g,onChange:Ee=>v(Ee.target.checked)}),p.jsx("span",{className:"slider round"})]})]}),g&&p.jsx("div",{className:"day-picker",children:e("day_names_short_picker").map((Ee,te)=>p.jsx("button",{onClick:()=>je(te),className:`day-button ${T.includes(te)?"selected":""}`,children:Ee},te))}),E.recurringDays&&p.jsxs("p",{className:"field-error-message",children:[Se.exclamation," ",e("error_day_required")]}),p.jsx("hr",{}),p.jsx("div",{className:"step-guidance",style:{marginTop:"16px"},children:p.jsx("p",{className:"tip",children:e("deadline_tip")})}),p.jsxs("label",{className:"settings-item standalone-toggle",children:[p.jsx("span",{style:{fontWeight:500},children:e("deadline_option_no_deadline")}),p.jsxs("label",{className:"theme-toggle-switch",children:[p.jsx("input",{type:"checkbox",checked:I,onChange:Ee=>R(Ee.target.checked)}),p.jsx("span",{className:"slider round"})]})]}),!I&&p.jsx("input",{type:"date",value:D,onChange:Ee=>S(Ee.target.value),className:E.deadline?"input-error":"",style:{marginTop:"12px"}}),E.deadline&&p.jsxs("p",{className:"field-error-message",children:[Se.exclamation," ",e("error_deadline_required")]}),p.jsx("hr",{}),p.jsx("div",{className:"step-guidance",style:{marginTop:"16px"},children:p.jsx("p",{className:"tip",children:e("category_label")})}),p.jsx("div",{style:{display:"grid",gridTemplateColumns:B&&B.length>2?"repeat(2, 1fr)":"repeat(1, 1fr)",gap:"8px",marginTop:"12px"},children:B&&B.map(Ee=>p.jsx("button",{onClick:()=>U(Ee),className:`category-button ${V===Ee?"active":""}`,children:Ee},Ee))})]});default:return null}},U3=({onGenerate:t,t:e,onCancel:n})=>{const[r,i]=z.useState(""),[s,o]=z.useState(""),[a,l]=z.useState(""),[u,f]=z.useState(""),[m,g]=z.useState(""),{endDate:v,generatedCount:T}=z.useMemo(()=>{const D=parseInt(s,10),S=parseInt(a,10);if(!u||!D||D<=0||!S||S<=0)return{endDate:"",generatedCount:0};const I=Math.ceil(D/S),R=new Date(u),V=new Date(R);return V.setDate(R.getDate()+I-1),{endDate:V.toISOString().split("T")[0],generatedCount:I}},[s,a,u]),P=()=>{const D=parseInt(s,10),S=parseInt(a,10);if(!r.trim()||!u||!D||D<=0||!S||S<=0){g(e("automation_error_all_fields"));return}const I=[],R=Math.ceil(D/S),V=new Date(u);for(let U=0;U<R;U++){const B=new Date(V);B.setDate(V.getDate()+U);const E=U*S+1,w=Math.min((U+1)*S,D),C=`${r.trim()} ${E}`+(w>E?` - ${w}`:"");I.push({wish:C,outcome:"",obstacle:"",plan:"",isRecurring:!1,recurringDays:[],deadline:B.toISOString().split("T")[0],category:"personal"})}g(""),t(I)};return p.jsxs("div",{className:"automation-form-container",children:[p.jsx("h3",{children:e("automation_title")}),p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:e("automation_base_name_label")}),p.jsx("input",{type:"text",value:r,onChange:D=>i(D.target.value),placeholder:e("automation_base_name_placeholder")})]}),p.jsxs("div",{className:"automation-form-grid",children:[p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:e("automation_total_units_label")}),p.jsx("input",{type:"number",value:s,onChange:D=>o(D.target.value),placeholder:e("automation_total_units_placeholder")})]}),p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:e("automation_units_per_day_label")}),p.jsx("input",{type:"number",value:a,onChange:D=>l(D.target.value),placeholder:": 5"})]})]}),p.jsxs("div",{className:"automation-form-grid",children:[p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:e("automation_start_date_label")}),p.jsx("input",{type:"date",value:u,onChange:D=>f(D.target.value)})]}),p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:e("automation_end_date_label")}),p.jsx("input",{type:"date",value:v,readOnly:!0})]})]}),m&&p.jsxs("p",{className:"field-error-message",style:{justifyContent:"center"},children:[Se.exclamation," ",m]}),p.jsxs("div",{className:"goal-assistant-nav",children:[p.jsx("button",{onClick:n,className:"secondary",children:e("cancel_button")}),p.jsx("button",{onClick:P,className:"primary",disabled:T===0,children:T>0?`${T} `:e("automation_generate_button").replace("{count}",String(T))})]})]})},XI=({onClose:t,onAddTodo:e,onAddMultipleTodos:n,onEditTodo:r,existingTodo:i,t:s,language:o,createAI:a,userCategories:l=["personal"]})=>{const[u,f]=Ja(t),[m,g]=z.useState("woop"),[v,T]=z.useState(1),[P,D]=z.useState("forward"),[S,I]=z.useState((i==null?void 0:i.wish)||""),[R,V]=z.useState((i==null?void 0:i.outcome)||""),[U,B]=z.useState((i==null?void 0:i.obstacle)||""),[E,w]=z.useState((i==null?void 0:i.plan)||""),[C,k]=z.useState((i==null?void 0:i.isRecurring)||!1),[M,L]=z.useState((i==null?void 0:i.recurringDays)||[]),[N,Ne]=z.useState((i==null?void 0:i.deadline)||""),[Fe,je]=z.useState(!(i!=null&&i.deadline)),[Ee,te]=z.useState((i==null?void 0:i.category)||"personal"),[ce,ve]=z.useState({}),[Ie,Re]=z.useState(""),[$e,Ke]=z.useState(""),[Vt,ut]=z.useState(""),[_e,nn]=z.useState("personal"),vn=5,Vn=be=>{const It={};return be===1&&!S.trim()&&(It.wish=!0),be===2&&!R.trim()&&(It.outcome=!0),be===3&&!U.trim()&&(It.obstacle=!0),be===4&&!E.trim()&&(It.plan=!0),be===5&&(!Fe&&!N&&(It.deadline=!0),C&&M.length===0&&(It.recurringDays=!0)),ve(It),Object.keys(It).length===0},cr=()=>{Vn(v)&&(v<vn?(D("forward"),T(be=>be+1)):hn())},dr=()=>{v>1&&(D("backward"),T(be=>be-1))},hn=()=>{if(!Vn(5))return;const be={wish:S,outcome:R,obstacle:U,plan:E,isRecurring:C,recurringDays:M,deadline:Fe?"":N,category:Ee};i&&r?r({...i,...be}):e&&e(be)},Pr=()=>{Ie.trim()&&(e&&e({wish:Ie.trim(),outcome:Ie.trim(),obstacle:"",plan:"",isRecurring:!1,recurringDays:[],deadline:$e,category:_e}),Re(""),Ke(""),ut(""),nn("personal"),f())};return p.jsxs(_o,{onClose:f,isClosing:u,className:"goal-assistant-modal",children:[p.jsxs("div",{className:"goal-assistant-header",children:[p.jsx("div",{className:"goal-assistant-header-left",children:v>1&&m==="woop"&&p.jsx("button",{onClick:dr,className:"settings-back-button",children:Se.back})}),p.jsx("h2",{children:m==="woop"?" ":m==="quick"?" ":m==="automation"?" ":s("goal_assistant_title")}),p.jsx("div",{className:"goal-assistant-header-right",style:{width:"40px"}})]}),!i&&p.jsx("div",{className:"modal-mode-switcher-container",children:p.jsxs("div",{className:"modal-mode-switcher",children:[p.jsx("button",{onClick:()=>g("woop"),className:m==="woop"?"active":"",children:s("goal_assistant_mode_woop")}),p.jsx("button",{onClick:()=>g("quick"),className:m==="quick"?"active":"",children:" "}),p.jsx("button",{onClick:()=>g("automation"),className:m==="automation"?"active":"",children:s("goal_assistant_mode_automation")})]})}),p.jsx("div",{className:"goal-assistant-body",children:m==="woop"?p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"progress-bar-container",children:p.jsx("div",{className:"progress-bar",style:{width:`${v/vn*100}%`}})}),p.jsx("div",{className:`goal-assistant-step-content-animator ${P}`,children:p.jsx(F3,{step:v,t:s,createAI:a,wish:S,setWish:I,outcome:R,setOutcome:V,obstacle:U,setObstacle:B,plan:E,setPlan:w,isRecurring:C,setIsRecurring:k,recurringDays:M,setRecurringDays:L,deadline:N,setDeadline:Ne,noDeadline:Fe,setNoDeadline:je,category:Ee,setCategory:te,userCategories:l,errors:ce,language:o})},v),p.jsxs("div",{className:"goal-assistant-nav",children:[v>1?p.jsx("button",{onClick:dr,className:"secondary",children:s("back_button")}):p.jsx("button",{onClick:f,className:"secondary",children:s("cancel_button")}),p.jsx("button",{onClick:cr,className:"primary",children:s(v===vn?i?"save_button":"add_button":"next_button")})]})]}):m==="quick"?p.jsxs(p.Fragment,{children:[p.jsxs("div",{style:{padding:"24px 16px",flex:1,overflowY:"auto"},children:[p.jsxs("div",{style:{marginBottom:"20px"},children:[p.jsx("h3",{style:{fontSize:"1rem",fontWeight:"600",marginBottom:"12px"},children:" "}),p.jsx("div",{className:"step-guidance",children:p.jsx("p",{className:"tip",children:"  "})}),p.jsx("textarea",{value:Ie,onChange:be=>Re(be.target.value),placeholder:":  ",rows:2,style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontSize:"14px",fontFamily:"inherit",resize:"none",marginTop:"12px"},onKeyPress:be=>{be.key==="Enter"&&be.ctrlKey&&Pr()}})]}),p.jsx("hr",{}),p.jsxs("div",{style:{marginBottom:"20px"},children:[p.jsx("div",{className:"step-guidance",style:{marginTop:"16px"},children:p.jsx("p",{className:"tip",children:"  ()"})}),p.jsxs("label",{className:"settings-item standalone-toggle",style:{marginTop:"12px"},children:[p.jsx("span",{style:{fontWeight:"500"},children:" "}),p.jsxs("label",{className:"theme-toggle-switch",children:[p.jsx("input",{type:"checkbox",checked:!!$e,onChange:be=>Ke(be.target.checked?new Date().toISOString().split("T")[0]:"")}),p.jsx("span",{className:"slider round"})]})]}),$e&&p.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",marginTop:"12px"},children:[p.jsxs("div",{children:[p.jsx("label",{style:{fontSize:"12px",opacity:.7,display:"block",marginBottom:"4px"},children:""}),p.jsx("input",{type:"date",value:$e,onChange:be=>Ke(be.target.value),style:{width:"100%",padding:"10px",borderRadius:"6px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontSize:"13px"}})]}),p.jsxs("div",{children:[p.jsx("label",{style:{fontSize:"12px",opacity:.7,display:"block",marginBottom:"4px"},children:" ()"}),p.jsx("input",{type:"time",value:Vt,onChange:be=>ut(be.target.value),style:{width:"100%",padding:"10px",borderRadius:"6px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontSize:"13px"}})]})]})]}),p.jsx("hr",{}),p.jsxs("div",{style:{marginBottom:"24px"},children:[p.jsx("div",{className:"step-guidance",style:{marginTop:"16px"},children:p.jsx("p",{className:"tip",children:s("category_label")})}),p.jsx("div",{style:{display:"grid",gridTemplateColumns:l&&l.length>2?"repeat(2, 1fr)":"repeat(1, 1fr)",gap:"8px",marginTop:"12px"},children:l&&l.map(be=>p.jsx("button",{onClick:()=>nn(be),className:`category-button ${_e===be?"active":""}`,children:be},be))})]})]}),p.jsxs("div",{className:"goal-assistant-nav",children:[p.jsx("button",{onClick:f,className:"secondary",children:s("cancel_button")}),p.jsx("button",{onClick:Pr,className:"primary",disabled:!Ie.trim(),children:s("add_button")})]})]}):n&&p.jsx(U3,{onGenerate:n,t:s,onCancel:f})})]})},O3=({todo:t,onClose:e,t:n,createAI:r,onOpenCollaboration:i,userCategories:s,onUpdateGoal:o})=>{const[a,l]=Ja(e),[u,f]=z.useState(""),[m,g]=z.useState(!1),[v,T]=z.useState(!1),P=async()=>{g(!0),f(""),T(!1);try{const D=r();if(!D){f("AI    API  ."),g(!1);return}const S=`Based on the WOOP method, provide a concise and encouraging suggestion for the following goal: Wish: "${t.wish}", Best Outcome: "${t.outcome}", Obstacle: "${t.obstacle}", Plan: "${t.plan}". Focus on strengthening the plan or reframing the obstacle.`,I=await D.models.generateContent({model:"gemini-2.5-flash",contents:S});f(I.text)}catch(D){console.error(D),T(!0)}finally{g(!1)}};return p.jsxs(_o,{onClose:l,isClosing:a,className:"info-modal",children:[p.jsxs("div",{className:"info-modal-content",children:[p.jsx("h2",{children:n("goal_details_modal_title")}),p.jsxs("div",{className:"info-section",children:[p.jsx("h4",{children:n("wish_label")}),p.jsx("p",{children:t.wish})]}),p.jsxs("div",{className:"info-section",children:[p.jsx("h4",{children:n("outcome_label")}),p.jsx("p",{children:t.outcome})]}),p.jsxs("div",{className:"info-section",children:[p.jsx("h4",{children:n("obstacle_label")}),p.jsx("p",{children:t.obstacle})]}),p.jsxs("div",{className:"info-section",children:[p.jsx("h4",{children:n("plan_label")}),p.jsx("p",{children:t.plan})]}),s&&s.length>0&&o&&p.jsxs("div",{className:"info-section",style:{borderTop:"1px solid var(--border-color)",paddingTop:"16px",marginTop:"16px"},children:[p.jsx("h4",{style:{marginBottom:"12px"},children:n("category_label")}),p.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:s.map(D=>p.jsx("button",{onClick:()=>{o({...t,category:D}),l()},className:`category-button ${t.category===D?"active":""}`,style:{padding:"8px 16px",borderRadius:"20px",border:t.category===D?"2px solid var(--primary-color)":"2px solid var(--border-color)",backgroundColor:t.category===D?"var(--primary-color)":"transparent",color:t.category===D?"white":"var(--text-color)",cursor:"pointer",fontSize:"14px",fontWeight:t.category===D?"600":"500",transition:"all 0.25s ease",whiteSpace:"nowrap",display:"inline-block",boxShadow:t.category===D?"0 2px 8px rgba(88, 86, 214, 0.2)":"none"},children:D},D))})]}),p.jsxs("div",{className:"ai-analysis-section",children:[p.jsx("h4",{children:n("ai_coach_suggestion")}),m?p.jsx("p",{children:n("ai_analyzing")}):u?p.jsx("p",{children:u}):v?p.jsx("p",{className:"ai-error",children:n("ai_sort_error_message")}):p.jsx("button",{onClick:P,className:"feedback-button",children:n("ai_coach_suggestion")})]})]}),p.jsxs("div",{className:"modal-buttons",children:[i&&p.jsx("button",{onClick:()=>{i(t),l()},className:"secondary",children:" "}),p.jsx("button",{onClick:l,className:"primary",children:n("close_button")})]})]})},B3=({folder:t,onClose:e,t:n,googleUser:r,onUpdateCollaborators:i,setAlertConfig:s})=>{const[o,a]=Ja(e),[l,u]=z.useState(""),[f,m]=z.useState(!1),[g,v]=z.useState(""),[T,P]=z.useState(!1),D=async()=>{if(!(!t||!r)){m(!0);try{if(!g||g.trim().length===0){s({title:"  ",message:"      .",confirmText:"",onConfirm:()=>{}}),m(!1);return}const V={type:"folder_share",folderId:t.id,folderName:t.name,folderColor:t.color,goals:[],sharedBy:r==null?void 0:r.email,ownerId:r==null?void 0:r.uid,sharedAt:new Date().toISOString(),password:g},U=it(ge,"users",r.uid,"folders"),B=Ue(U,t.id),E=t.collaborators||[];await gt(B,{collaborators:E,shareInfo:{password:g,createdAt:new Date().toISOString()},updatedAt:new Date().toISOString()},{merge:!0});const w=cg(JSON.stringify(V)),C=`${window.location.origin}${window.location.pathname}?folder_share=${encodeURIComponent(w)}`,k=await rR(C);u(k),s({title:"   ",message:" .  !",confirmText:"",onConfirm:()=>{navigator.clipboard.writeText(k)}})}catch(V){console.error("   :",V),s({title:" ",message:"   .  .",confirmText:"",onConfirm:()=>{}})}finally{m(!1)}}},S=()=>{l&&navigator.clipboard.writeText(l).then(()=>{s({title:" ",message:"  .",confirmText:"",onConfirm:()=>{}})})},I=async V=>{if(!(!t||!r))try{const U=it(ge,"users",r.uid,"folders"),B=Ue(U,t.id),E=(t.collaborators||[]).filter(w=>w.userId!==V);await gt(B,{collaborators:E,updatedAt:new Date().toISOString()},{merge:!0}),i(t.id,E),s({title:" ",message:" .",confirmText:"",onConfirm:()=>{}})}catch(U){console.error("  :",U),s({title:" ",message:"  .",confirmText:"",onConfirm:()=>{}})}},R=async(V,U)=>{if(!(!t||!r))try{const B=it(ge,"users",r.uid,"folders"),E=Ue(B,t.id),w=(t.collaborators||[]).map(C=>C.userId===V?{...C,role:U}:C);await gt(E,{collaborators:w,updatedAt:new Date().toISOString()},{merge:!0}),i(t.id,w),s({title:"  ",message:`  ${U==="editor"?"":""} .`,confirmText:"",onConfirm:()=>{}})}catch(B){console.error("  :",B)}};return t?p.jsxs(_o,{onClose:a,isClosing:o,className:"goal-assistant-modal",children:[p.jsxs("div",{className:"goal-assistant-header",children:[p.jsx("div",{className:"goal-assistant-header-left"}),p.jsxs("h2",{children:[t.name,"  "]}),p.jsx("div",{className:"goal-assistant-header-right",children:p.jsx("button",{onClick:a,className:"close-button",children:Se.close})})]}),p.jsx("div",{className:"goal-assistant-body",children:p.jsxs("div",{style:{padding:"24px 16px"},children:[p.jsxs("div",{style:{marginBottom:"20px"},children:[p.jsx("h3",{style:{fontSize:"1rem",fontWeight:"600",marginBottom:"12px"},children:" "}),t.collaborators&&t.collaborators.length>0?p.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:t.collaborators.map(V=>p.jsxs("div",{className:"settings-item",style:{padding:"12px",backgroundColor:"var(--card-bg-color)",borderRadius:"8px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[p.jsxs("div",{style:{flex:1},children:[p.jsx("div",{style:{fontWeight:"500",fontSize:"0.95rem"},children:V.email}),V.role==="owner"?p.jsx("div",{style:{fontSize:"0.85rem",color:"var(--text-secondary-color)",marginTop:"2px"},children:""}):p.jsxs("select",{value:V.role,onChange:U=>R(V.userId,U.target.value),style:{fontSize:"0.85rem",padding:"4px 8px",marginTop:"4px",borderRadius:"4px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",cursor:"pointer"},children:[p.jsx("option",{value:"editor",children:""}),p.jsx("option",{value:"viewer",children:""})]})]}),V.role!=="owner"&&p.jsx("button",{onClick:()=>I(V.userId),style:{padding:"4px 12px",backgroundColor:"var(--danger-color)",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"0.8rem",marginLeft:"12px",whiteSpace:"nowrap"},children:""})]},V.userId))}):p.jsx("div",{className:"step-guidance",children:p.jsx("p",{className:"tip",children:" .    ."})})]}),p.jsx("hr",{style:{margin:"20px 0",border:"none",borderTop:"1px solid var(--border-color)"}}),p.jsxs("div",{style:{marginBottom:"20px"},children:[p.jsx("h3",{style:{fontSize:"1rem",fontWeight:"600",marginBottom:"12px"},children:"   "}),p.jsx("div",{className:"step-guidance",children:p.jsx("p",{className:"tip",children:"    ,      ."})}),l?p.jsxs("div",{style:{marginTop:"16px",display:"flex",flexDirection:"column",gap:"12px"},children:[p.jsx("div",{style:{padding:"12px",backgroundColor:"var(--card-bg-color)",borderRadius:"8px",border:"1px solid var(--border-color)"},children:p.jsx("input",{type:"text",readOnly:!0,value:l,onClick:V=>V.target.select(),style:{width:"100%",padding:"10px",border:"1px solid var(--border-color)",borderRadius:"6px",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontSize:"0.85rem",boxSizing:"border-box",fontFamily:"monospace"}})}),p.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[p.jsx("button",{onClick:S,className:"primary",children:" "}),p.jsx("button",{onClick:()=>{u(""),v(""),P(!1)},className:"secondary",children:" "})]})]}):p.jsxs("div",{style:{marginTop:"16px",display:"flex",flexDirection:"column",gap:"12px"},children:[p.jsxs("label",{className:"settings-item standalone-toggle",children:[p.jsx("span",{style:{fontWeight:"500"},children:"  "}),p.jsxs("label",{className:"theme-toggle-switch",children:[p.jsx("input",{type:"checkbox",checked:T,onChange:V=>{P(V.target.checked),V.target.checked||v("")}}),p.jsx("span",{className:"slider round"})]})]}),T&&p.jsx("input",{type:"password",placeholder:" ",value:g,onChange:V=>v(V.target.value),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontFamily:"inherit",fontSize:"14px",boxSizing:"border-box"}}),p.jsx("button",{onClick:D,disabled:f||!g.trim(),className:"primary",style:{width:"100%",padding:"14px 0",backgroundColor:"var(--primary-color)",color:"white",border:"none",borderRadius:"24px",boxShadow:"0 2px 8px rgba(88,86,214,0.08)",fontWeight:700,fontSize:"16px",letterSpacing:"0.01em",cursor:f||!g.trim()?"not-allowed":"pointer",opacity:f||!g.trim()?.6:1,transition:"all 0.2s"},children:f?"  ...":"  "})]})]})]})}),p.jsxs("div",{className:"goal-assistant-nav",children:[p.jsx("div",{}),p.jsx("button",{onClick:a,className:"primary",children:""})]})]}):null},G3=({onClose:t,isDarkMode:e,onToggleDarkMode:n,themeMode:r,onThemeChange:i,backgroundTheme:s,onSetBackgroundTheme:o,onExportData:a,onImportData:l,setAlertConfig:u,onDeleteAllData:f,dataActionStatus:m,language:g,onSetLanguage:v,t:T,todos:P,setToastMessage:D,onOpenVersionInfo:S,onOpenUsageGuide:I,apiKey:R,onSetApiKey:V,isOfflineMode:U,onToggleOfflineMode:B,googleUser:E,onGoogleLogin:w,onGoogleLogout:C,onSyncDataToFirebase:k,onLoadDataFromFirebase:M,isGoogleLoggingIn:L=!1,isGoogleLoggingOut:N=!1,isSyncingData:Ne=!1,isLoadingData:Fe=!1,isAutoSyncEnabled:je,setIsAutoSyncEnabled:Ee,onDiagnoseFirebase:te})=>{const[ce,ve]=Ja(t),[Ie,Re]=z.useState("appearance"),[$e,Ke]=z.useState(""),[Vt,ut]=z.useState(!1),[_e,nn]=z.useState("medium"),[vn,Vn]=z.useState(null),cr=z.useRef(null),dr=[{id:"appearance",label:T("settings_section_background"),icon:Se.background},{id:"notifications",label:T("settings_notifications"),icon:Se.settings},{id:"general",label:T("settings_section_general"),icon:Se.settings},{id:"data",label:T("settings_section_data"),icon:Se.data}],hn=()=>u({title:T("delete_account_header"),message:T("delete_account_header_desc"),isDestructive:!0,confirmText:T("delete_all_data_button"),cancelText:T("cancel_button"),onConfirm:f,onCancel:()=>{}}),Pr=async()=>{if(!P||P.length===0){Vn(T("no_data_to_share"));return}ut(!0);try{const Ge=YI(P),ct=`${window.location.origin}${window.location.pathname}?data=${encodeURIComponent(Ge)}`,ae=await rR(ct);Ke(ae),ae!==ct&&ae.length<ct.length?D(T("short_url_created")):D(T("share_link_created"))}catch(Ge){console.error("Failed to create share link",Ge);const ct=YI(P),ae=`${window.location.origin}${window.location.pathname}?data=${encodeURIComponent(ct)}`;Ke(ae),D(T("short_url_failed"))}finally{ut(!1)}},be=()=>{$e&&navigator.clipboard.writeText($e).then(()=>{D(T("link_copied_toast"))})},It=()=>{switch(Ie){case"appearance":return p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"settings-section-header",children:T("settings_theme_mode")}),p.jsxs("div",{className:"settings-section-body",children:[p.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>i("light"),children:[p.jsxs("div",{children:[p.jsx("span",{children:T("theme_mode_light")}),p.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:T("theme_mode_light_desc")})]}),r==="light"&&Se.check]}),p.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>i("dark"),children:[p.jsxs("div",{children:[p.jsx("span",{children:T("theme_mode_dark")}),p.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:T("theme_mode_dark_desc")})]}),r==="dark"&&Se.check]}),p.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>i("system"),children:[p.jsxs("div",{children:[p.jsx("span",{children:T("theme_mode_system")}),p.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:T("theme_mode_system_desc")})]}),r==="system"&&Se.check]})]}),p.jsx("div",{className:"settings-section-header",children:T("settings_background_header")}),p.jsx("div",{className:"settings-section-body",children:dg.map(Ge=>p.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>o(Ge.id),children:[p.jsx("span",{children:T(e?Ge.darkNameKey:Ge.lightNameKey)}),s===Ge.id&&Se.check]},Ge.id))})]});case"notifications":return p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"settings-section-header",children:T("notification_settings_title")}),p.jsxs("div",{className:"settings-section-body",children:[p.jsxs("label",{className:"settings-item",children:[p.jsxs("div",{children:[p.jsx("span",{children:T("notification_deadline")}),p.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:T("notification_deadline_desc")})]}),p.jsxs("div",{className:"theme-toggle-switch",children:[p.jsx("input",{type:"checkbox",defaultChecked:!0,onChange:()=>{}}),p.jsx("span",{className:"slider round"})]})]}),p.jsxs("label",{className:"settings-item",children:[p.jsxs("div",{children:[p.jsx("span",{children:T("notification_suggestion")}),p.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:"   ."})]}),p.jsxs("div",{className:"theme-toggle-switch",children:[p.jsx("input",{type:"checkbox",defaultChecked:!0,onChange:()=>{}}),p.jsx("span",{className:"slider round"})]})]})]}),p.jsx("div",{className:"settings-section-header",children:" "}),p.jsxs("div",{className:"settings-section-body",children:[p.jsx("button",{className:"settings-item action-item",onClick:async()=>{await tR()?(D("  ."),await nR()):D("  .")},children:p.jsx("span",{className:"action-text",children:"  "})}),p.jsxs("div",{style:{fontSize:"12px",opacity:.7,padding:"12px",marginTop:"8px"},children:[" : ",Notification.permission==="granted"?" ":Notification.permission==="denied"?" ":"? "]})]})]});case"general":return p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"settings-section-header",children:T("settings_language")}),p.jsxs("div",{className:"settings-section-body",children:[p.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>v("ko"),children:[p.jsx("span",{children:""}),g==="ko"&&Se.check]}),p.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>v("en"),children:[p.jsx("span",{children:"English"}),g==="en"&&Se.check]})]}),p.jsx("div",{className:"settings-section-header",children:T("settings_api_key")}),p.jsxs("div",{className:"settings-section-body",children:[p.jsx("div",{className:"settings-item",children:p.jsx("input",{type:"password",placeholder:T("settings_api_key_placeholder"),value:R,onChange:Ge=>V(Ge.target.value),style:{width:"100%",padding:"8px",border:"1px solid var(--border-color)",borderRadius:"4px",backgroundColor:"var(--input-bg)"}})}),p.jsxs("label",{className:"settings-item",children:[p.jsxs("div",{children:[p.jsx("span",{children:T("settings_offline_mode")}),p.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:T("settings_offline_mode_desc")})]}),p.jsxs("div",{className:"theme-toggle-switch",children:[p.jsx("input",{type:"checkbox",checked:U,onChange:B}),p.jsx("span",{className:"slider round"})]})]})]}),p.jsx("div",{className:"settings-section-header",children:T("settings_section_info")}),p.jsxs("div",{className:"settings-section-body",children:[p.jsxs("div",{className:"settings-item nav-indicator",onClick:S,children:[p.jsx("span",{children:T("settings_version")}),p.jsxs("div",{className:"settings-item-value-with-icon",children:[p.jsx("span",{children:"1.5"}),Se.forward]})]}),p.jsxs("div",{className:"settings-item nav-indicator",onClick:I,children:[p.jsx("span",{children:T("usage_guide_title")}),p.jsx("div",{className:"settings-item-value-with-icon",children:Se.forward})]}),p.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>{Vn(`    .

     ,          .

   ,
   .

              .

         ,       .`)},children:[p.jsx("span",{children:T("test_long_alert")}),p.jsxs("div",{className:"settings-item-value-with-icon",children:[p.jsx("span",{children:T("test_long_alert_desc")}),Se.forward]})]}),p.jsxs("div",{className:"settings-item",children:[p.jsx("span",{children:T("settings_developer")}),p.jsx("span",{className:"settings-item-value",children:T("developer_name")})]}),p.jsxs("div",{className:"settings-item",children:[p.jsx("span",{children:T("settings_copyright")}),p.jsx("span",{className:"settings-item-value",children:T("copyright_notice")})]})]})]});case"data":return p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"settings-section-header",children:""}),p.jsx("div",{className:"settings-section-body",children:E?p.jsxs("div",{children:[p.jsxs("div",{className:"settings-item",children:[p.jsxs("div",{children:[p.jsx("span",{children:"Google "}),p.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:E.email}),p.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:E.displayName})]}),p.jsx("span",{style:{color:"var(--success-color, #4CAF50)"},children:""})]}),p.jsx("button",{className:"settings-item action-item",onClick:C,disabled:N,style:{opacity:N?.6:1},children:p.jsx("span",{className:"action-text",children:N?"  ...":""})})]}):p.jsxs("div",{children:[p.jsx("div",{style:{display:"flex",justifyContent:"center",padding:"12px 0"},children:p.jsxs("button",{onClick:w,disabled:L,style:{backgroundColor:L?"#E0E0E0":"white",border:"1px solid #D3D3D3",borderRadius:"24px",padding:"8px 20px",fontSize:"14px",fontWeight:"500",cursor:L?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"8px",color:L?"#999999":"#1F2937",transition:"all 0.2s",opacity:L?.6:1},children:[p.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",children:[p.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),p.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),p.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),p.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),L?" ...":"Google "]})}),p.jsx("div",{style:{display:"flex",justifyContent:"center",padding:"8px 0"},children:p.jsx("button",{onClick:te,style:{backgroundColor:"transparent",border:"1px solid #D3D3D3",borderRadius:"16px",padding:"4px 12px",fontSize:"12px",color:"#666",cursor:"pointer"},children:"   "})})]})}),E&&p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"settings-section-header",children:" "}),p.jsxs("div",{className:"settings-section-body",children:[p.jsx("button",{className:"settings-item action-item",onClick:k,disabled:Ne,children:p.jsx("span",{className:"action-text",children:Ne?"...":" "})}),p.jsx("button",{className:"settings-item action-item",onClick:M,disabled:Fe,children:p.jsx("span",{className:"action-text",children:Fe?"...":" "})}),p.jsxs("label",{className:"settings-item",children:[p.jsxs("div",{children:[p.jsx("span",{children:" "}),p.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:"    "})]}),p.jsxs("div",{className:"theme-toggle-switch",children:[p.jsx("input",{type:"checkbox",checked:je,onChange:Ge=>Ee(Ge.target.checked)}),p.jsx("span",{className:"slider round"})]})]})]})]}),p.jsx("div",{className:"settings-section-header",children:T("settings_data_header")}),p.jsxs("div",{className:"settings-section-body",children:[p.jsx("div",{style:{fontSize:"12px",opacity:.7,marginBottom:"12px",padding:"8px",backgroundColor:"var(--bg-color-secondary)",borderRadius:"8px"},children:T("settings_data_header_desc")}),p.jsx("button",{className:"settings-item action-item",onClick:a,disabled:m!=="idle",children:p.jsx("span",{className:"action-text",children:T(m==="exporting"?"data_exporting":"settings_export_data")})}),p.jsxs("button",{className:"settings-item action-item",onClick:()=>{var Ge;return(Ge=cr.current)==null?void 0:Ge.click()},disabled:m!=="idle",children:[p.jsx("span",{className:"action-text",children:T(m==="importing"?"data_importing":"settings_import_data")}),p.jsx("input",{type:"file",ref:cr,onChange:l,accept:".json",style:{display:"none"}})]})]}),P.length>0&&p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"settings-section-header",children:T("settings_share_link_header")}),p.jsxs("div",{className:"settings-section-body",children:[!$e&&p.jsx("button",{className:"settings-item action-item",onClick:Pr,disabled:Vt,children:p.jsx("span",{className:"action-text",children:Vt?" URL  ...":T("settings_generate_link")})}),$e&&p.jsxs("div",{className:"share-link-container",children:[p.jsxs("div",{style:{marginBottom:"8px",fontSize:"12px",opacity:.7},children:[$e.length<100?" URL":" "," (",$e.length,")"]}),p.jsx("input",{type:"text",readOnly:!0,value:$e,onClick:Ge=>Ge.target.select()}),p.jsx("button",{onClick:be,children:T("settings_copy_link")})]})]})]}),p.jsx("div",{className:"settings-section-header",children:T("settings_section_info")}),p.jsxs("div",{className:"settings-section-body",children:[p.jsxs("div",{className:"settings-item nav-indicator",onClick:S,children:[p.jsx("span",{children:T("settings_version")}),p.jsxs("div",{className:"settings-item-value-with-icon",children:[p.jsx("span",{children:"1.5"}),Se.forward]})]}),p.jsxs("div",{className:"settings-item nav-indicator",onClick:I,children:[p.jsx("span",{children:T("usage_guide_title")}),p.jsx("div",{className:"settings-item-value-with-icon",children:Se.forward})]}),p.jsxs("div",{className:"settings-item",children:[p.jsx("span",{children:T("settings_developer")}),p.jsx("span",{className:"settings-item-value",children:T("developer_name")})]}),p.jsxs("div",{className:"settings-item",children:[p.jsx("span",{children:T("settings_copyright")}),p.jsx("span",{className:"settings-item-value",children:T("copyright_notice")})]})]}),p.jsx("div",{className:"settings-section-header",children:T("settings_delete_account")}),p.jsx("div",{className:"settings-section-body",children:p.jsx("button",{className:"settings-item action-item",onClick:hn,disabled:m!=="idle",children:p.jsx("span",{className:"action-text destructive",children:T(m==="deleting"?"data_deleting":"settings_delete_account")})})})]});default:return null}};return p.jsxs(_o,{onClose:ve,isClosing:ce,className:"settings-modal",size:_e,children:[p.jsxs("div",{className:"settings-modal-header",children:[p.jsx("div",{style:{width:"40px"}}),p.jsx("h2",{children:T("settings_title")}),p.jsx("div",{className:"settings-modal-header-right",style:{width:"40px"}})]}),p.jsxs("div",{className:"settings-modal-body",children:[p.jsx("div",{className:"settings-tabs",children:dr.map(Ge=>p.jsxs("button",{className:`settings-tab-button ${Ie===Ge.id?"active":""}`,onClick:()=>Re(Ge.id),"aria-label":Ge.label,children:[p.jsx("div",{className:"settings-tab-icon",children:Ge.icon}),p.jsx("span",{children:Ge.label})]},Ge.id))}),p.jsx("div",{className:"settings-tab-content-container",children:p.jsx("div",{className:"settings-tab-content",children:It()},Ie)}),p.jsxs("div",{className:"goal-assistant-nav",style:{padding:"16px 24px",borderTop:"1px solid var(--border-color)"},children:[p.jsx("div",{style:{width:"1px"}}),p.jsx("button",{onClick:ve,className:"primary",style:{minWidth:"120px"},children:T("settings_done_button")})]})]}),vn&&p.jsx("div",{className:"modal-backdrop alert-backdrop",children:p.jsxs("div",{className:"modal-content alert-modal",children:[p.jsxs("div",{className:"alert-content",children:[p.jsx("h2",{children:""}),p.jsx("p",{children:vn})]}),p.jsx("div",{className:"modal-buttons",children:p.jsx("button",{onClick:()=>Vn(null),className:"primary",children:""})})]})})]})},ZI=({onClose:t,t:e})=>{const[n,r]=Ja(t),i="2.0.0 (25.10.24)",s=[{icon:"",title:" ",desc:"Step-by-step  . , (), (),  , ,  "},{icon:"",title:" / ",desc:" ,        "},{icon:"",title:"WOOP  ",desc:"5  (Wish  Outcome  Obstacle  Plan  /)   "},{icon:"",title:"AI  ",desc:"Gemini API     AI   "},{icon:"",title:"Google ",desc:"Google OAuth      "},{icon:"",title:"Firebase  ",desc:", ,     Firebase Firestore  "},{icon:"",title:"  ",desc:"       "},{icon:"",title:"  & ",desc:"//     8   "},{icon:"",title:"PWA & ",desc:" PWA   ,  ,   "},{icon:"",title:" ",desc:"3//      "},{icon:"",title:" /",desc:"JSON       "},{icon:"",title:" ",desc:",     "}];return p.jsxs(_o,{onClose:r,isClosing:n,className:"version-info-modal",children:[p.jsxs("div",{className:"version-info-header",children:[p.jsx("h2",{children:" Nova AI Planner v2.0 Beta"}),p.jsxs("p",{children:[e("build_number"),": ",i]})]}),p.jsx("div",{className:"version-info-body",children:s.map((o,a)=>p.jsxs("div",{className:"changelog-item",children:[p.jsx("div",{className:"changelog-icon",style:{"--icon-bg":"var(--primary-color)"},children:o.icon}),p.jsxs("div",{className:"changelog-text",children:[p.jsx("h3",{children:o.title}),p.jsx("p",{children:o.desc})]})]},a))}),p.jsx("div",{className:"modal-buttons",children:p.jsx("button",{onClick:r,className:"primary",children:e("settings_done_button")})})]})},q3=({onClose:t,t:e})=>{const[n,r]=Ja(t),i=o=>{const a=/(https?:\/\/[^\s]+)/g;return o.split(a).map((u,f)=>a.test(u)?p.jsx("a",{href:u,target:"_blank",rel:"noopener noreferrer",className:"guide-link",children:u},f):u)},s=[{titleKey:"usage_basic_title",descKey:"usage_basic_desc"},{titleKey:"usage_ai_setup_title",descKey:"usage_ai_setup_desc"},{titleKey:"usage_ai_use_title",descKey:"usage_ai_use_desc"},{titleKey:"usage_share_title",descKey:"usage_share_desc"},{titleKey:"usage_theme_title",descKey:"usage_theme_desc"},{titleKey:"usage_calendar_title",descKey:"usage_calendar_desc"},{titleKey:"usage_offline_title",descKey:"usage_offline_desc"}];return p.jsxs(_o,{onClose:r,isClosing:n,className:"usage-guide-modal",children:[p.jsx("div",{className:"version-info-header",children:p.jsx("h2",{children:e("usage_guide_title")})}),p.jsx("div",{className:"version-info-body",children:s.map((o,a)=>p.jsxs("div",{className:"usage-guide-item",children:[p.jsx("h3",{children:e(o.titleKey)}),p.jsx("p",{children:o.titleKey==="usage_ai_setup_title"?i(e(o.descKey)):e(o.descKey)})]},a))}),p.jsx("div",{className:"modal-buttons",children:p.jsx("button",{onClick:r,className:"primary",children:e("settings_done_button")})})]})},z3=({todos:t,t:e,onGoalClick:n,language:r})=>{const[i,s]=z.useState(new Date),[o,a]=z.useState("week"),l=g=>{const v=new Date(i);o==="month"?v.setMonth(v.getMonth()+g):o==="week"?v.setDate(v.getDate()+g*7):v.setDate(v.getDate()+g*3),s(v)},u=z.useMemo(()=>{const g=[];let v,T;if(o==="month"){const P=new Date(i.getFullYear(),i.getMonth(),1);v=JI(P,r==="ko"?1:0),T=42}else o==="week"?(v=JI(i,r==="ko"?1:0),T=7):(v=new Date(i),v.setDate(v.getDate()-1),T=3);for(let P=0;P<T;P++){const D=new Date(v);D.setDate(D.getDate()+P),g.push(D)}return g},[i,o,r]),f=z.useMemo(()=>{if(o==="month"){const g=i.getFullYear(),v=e("month_names")[i.getMonth()],T=e("calendar_header_month_format");return T&&typeof T=="string"&&T!=="calendar_header_month_format"?T.replace("{year}",String(g)).replace("{month}",v):`${v} ${g}`}return`${i.getFullYear()}.${i.getMonth()+1}`},[i,o,e]),m=z.useMemo(()=>{const g=e("day_names_short");if(r==="ko"&&Array.isArray(g)){const[v,...T]=g;return[...T,v]}return g},[r,e]);return p.jsxs("div",{className:"calendar-view-container",children:[p.jsxs("div",{className:"calendar-header",children:[p.jsx("button",{onClick:()=>l(-1),children:Se.back}),p.jsx("h2",{children:f}),p.jsx("button",{onClick:()=>l(1),children:Se.forward})]}),p.jsxs("div",{className:"calendar-view-mode-selector",children:[p.jsx("button",{onClick:()=>a("day3"),className:o==="day3"?"active":"",children:e("calendar_view_day3")}),p.jsx("button",{onClick:()=>a("week"),className:o==="week"?"active":"",children:e("calendar_view_week")}),p.jsx("button",{onClick:()=>a("month"),className:`calendar-view-button-month ${o==="month"?"active":""}`,children:e("calendar_view_month")})]}),(o==="week"||o==="month")&&p.jsx("div",{className:"calendar-days-of-week",children:Array.isArray(m)&&m.map(g=>p.jsx("div",{children:g},g))}),p.jsx("div",{className:`calendar-grid view-mode-${o}`,children:u.map(g=>{const T=iu(g,new Date),P=g.getMonth()===i.getMonth(),D=t.filter(S=>{if(S.isRecurring){const I=(g.getDay()+6)%7;return S.recurringDays.includes(I)}return S.deadline&&iu(g,S.deadline)});return p.jsxs("div",{className:`calendar-day ${!P&&o==="month"?"not-current-month":""} ${T?"is-today":""}`,"data-day-name":e("day_names_long")[g.getDay()],children:[p.jsx("div",{className:"day-header",children:p.jsx("span",{className:"day-number",children:g.getDate()})}),p.jsx("div",{className:"calendar-goals",children:D.map(S=>p.jsx("div",{className:`calendar-goal-item ${S.completed&&S.lastCompletedDate&&iu(g,S.lastCompletedDate)?"completed":""}`,onClick:()=>n(S),children:S.wish},S.id))})]},g.toISOString())})})]})},$3=({title:t,message:e,onConfirm:n,onCancel:r,confirmText:i,cancelText:s,isDestructive:o,t:a})=>{const l=typeof r=="function";return p.jsx("div",{className:"modal-backdrop alert-backdrop",children:p.jsxs("div",{className:"modal-content alert-modal",children:[p.jsxs("div",{className:"alert-content",children:[p.jsx("h2",{children:t}),p.jsx("p",{dangerouslySetInnerHTML:{__html:e}})]}),p.jsxs("div",{className:"modal-buttons",children:[l&&p.jsx("button",{onClick:r,className:"secondary",children:s||a("cancel_button")}),p.jsx("button",{onClick:n,className:o?"destructive":"primary",children:i||a("confirm_button")})]})]})})},H3=Ap.createRoot(document.getElementById("root"));H3.render(p.jsx(cw.StrictMode,{children:p.jsx(D3,{})}));
