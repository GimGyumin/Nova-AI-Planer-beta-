(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();const iR="modulepreload",sR=function(t){return"/Nova-AI-Planer-beta-/"+t},Ty={},Nr=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(n.map(l=>{if(l=sR(l),l in Ty)return;Ty[l]=!0;const u=l.endsWith(".css"),f=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${f}`))return;const m=document.createElement("link");if(m.rel=u?"stylesheet":iR,u||(m.as="script"),m.crossOrigin="",m.href=l,a&&m.setAttribute("nonce",a),document.head.appendChild(m),u)return new Promise((g,v)=>{m.addEventListener("load",g),m.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return i.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return e().catch(s)})};function oR(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Zw={exports:{}},Ih={},eI={exports:{}},be={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pu=Symbol.for("react.element"),aR=Symbol.for("react.portal"),lR=Symbol.for("react.fragment"),uR=Symbol.for("react.strict_mode"),cR=Symbol.for("react.profiler"),dR=Symbol.for("react.provider"),hR=Symbol.for("react.context"),fR=Symbol.for("react.forward_ref"),pR=Symbol.for("react.suspense"),mR=Symbol.for("react.memo"),gR=Symbol.for("react.lazy"),Ey=Symbol.iterator;function _R(t){return t===null||typeof t!="object"?null:(t=Ey&&t[Ey]||t["@@iterator"],typeof t=="function"?t:null)}var tI={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},nI=Object.assign,rI={};function Aa(t,e,n){this.props=t,this.context=e,this.refs=rI,this.updater=n||tI}Aa.prototype.isReactComponent={};Aa.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Aa.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function iI(){}iI.prototype=Aa.prototype;function ng(t,e,n){this.props=t,this.context=e,this.refs=rI,this.updater=n||tI}var rg=ng.prototype=new iI;rg.constructor=ng;nI(rg,Aa.prototype);rg.isPureReactComponent=!0;var wy=Array.isArray,sI=Object.prototype.hasOwnProperty,ig={current:null},oI={key:!0,ref:!0,__self:!0,__source:!0};function aI(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)sI.call(e,r)&&!oI.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];i.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:Pu,type:t,key:s,ref:o,props:i,_owner:ig.current}}function yR(t,e){return{$$typeof:Pu,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function sg(t){return typeof t=="object"&&t!==null&&t.$$typeof===Pu}function vR(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Iy=/\/+/g;function kf(t,e){return typeof t=="object"&&t!==null&&t.key!=null?vR(""+t.key):e.toString(36)}function Kc(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Pu:case aR:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+kf(o,0):r,wy(i)?(n="",t!=null&&(n=t.replace(Iy,"$&/")+"/"),Kc(i,e,n,"",function(u){return u})):i!=null&&(sg(i)&&(i=yR(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(Iy,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",wy(t))for(var a=0;a<t.length;a++){s=t[a];var l=r+kf(s,a);o+=Kc(s,e,n,l,i)}else if(l=_R(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=r+kf(s,a++),o+=Kc(s,e,n,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function wc(t,e,n){if(t==null)return t;var r=[],i=0;return Kc(t,r,"","",function(s){return e.call(n,s,i++)}),r}function TR(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var ln={current:null},jc={transition:null},ER={ReactCurrentDispatcher:ln,ReactCurrentBatchConfig:jc,ReactCurrentOwner:ig};function lI(){throw Error("act(...) is not supported in production builds of React.")}be.Children={map:wc,forEach:function(t,e,n){wc(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return wc(t,function(){e++}),e},toArray:function(t){return wc(t,function(e){return e})||[]},only:function(t){if(!sg(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};be.Component=Aa;be.Fragment=lR;be.Profiler=cR;be.PureComponent=ng;be.StrictMode=uR;be.Suspense=pR;be.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ER;be.act=lI;be.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=nI({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=ig.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)sI.call(e,l)&&!oI.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];r.children=a}return{$$typeof:Pu,type:t.type,key:i,ref:s,props:r,_owner:o}};be.createContext=function(t){return t={$$typeof:hR,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:dR,_context:t},t.Consumer=t};be.createElement=aI;be.createFactory=function(t){var e=aI.bind(null,t);return e.type=t,e};be.createRef=function(){return{current:null}};be.forwardRef=function(t){return{$$typeof:fR,render:t}};be.isValidElement=sg;be.lazy=function(t){return{$$typeof:gR,_payload:{_status:-1,_result:t},_init:TR}};be.memo=function(t,e){return{$$typeof:mR,type:t,compare:e===void 0?null:e}};be.startTransition=function(t){var e=jc.transition;jc.transition={};try{t()}finally{jc.transition=e}};be.unstable_act=lI;be.useCallback=function(t,e){return ln.current.useCallback(t,e)};be.useContext=function(t){return ln.current.useContext(t)};be.useDebugValue=function(){};be.useDeferredValue=function(t){return ln.current.useDeferredValue(t)};be.useEffect=function(t,e){return ln.current.useEffect(t,e)};be.useId=function(){return ln.current.useId()};be.useImperativeHandle=function(t,e,n){return ln.current.useImperativeHandle(t,e,n)};be.useInsertionEffect=function(t,e){return ln.current.useInsertionEffect(t,e)};be.useLayoutEffect=function(t,e){return ln.current.useLayoutEffect(t,e)};be.useMemo=function(t,e){return ln.current.useMemo(t,e)};be.useReducer=function(t,e,n){return ln.current.useReducer(t,e,n)};be.useRef=function(t){return ln.current.useRef(t)};be.useState=function(t){return ln.current.useState(t)};be.useSyncExternalStore=function(t,e,n){return ln.current.useSyncExternalStore(t,e,n)};be.useTransition=function(){return ln.current.useTransition()};be.version="18.3.1";eI.exports=be;var z=eI.exports;const uI=oR(z);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wR=z,IR=Symbol.for("react.element"),SR=Symbol.for("react.fragment"),CR=Object.prototype.hasOwnProperty,AR=wR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,xR={key:!0,ref:!0,__self:!0,__source:!0};function cI(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)CR.call(e,r)&&!xR.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:IR,type:t,key:s,ref:o,props:i,_owner:AR.current}}Ih.Fragment=SR;Ih.jsx=cI;Ih.jsxs=cI;Zw.exports=Ih;var p=Zw.exports;const RR=()=>{};var Sy={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dI=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},PR=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],o=t[n++],a=t[n++],l=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},hI={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],o=i+1<t.length,a=o?t[i+1]:0,l=i+2<t.length,u=l?t[i+2]:0,f=s>>2,m=(s&3)<<4|a>>4;let g=(a&15)<<2|u>>6,v=u&63;l||(v=64,o||(g=64)),r.push(n[f],n[m],n[g],n[v])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(dI(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):PR(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0;++i;const u=i<t.length?n[t.charAt(i)]:64;++i;const m=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||a==null||u==null||m==null)throw new kR;const g=s<<2|a>>4;if(r.push(g),u!==64){const v=a<<4&240|u>>2;if(r.push(v),m!==64){const T=u<<6&192|m;r.push(T)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class kR extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const NR=function(t){const e=dI(t);return hI.encodeByteArray(e,!0)},Sd=function(t){return NR(t).replace(/\./g,"")},fI=function(t){try{return hI.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pI(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DR=()=>pI().__FIREBASE_DEFAULTS__,bR=()=>{if(typeof process>"u"||typeof Sy>"u")return;const t=Sy.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},MR=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&fI(t[1]);return e&&JSON.parse(e)},Sh=()=>{try{return RR()||DR()||bR()||MR()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},mI=t=>{var e,n;return(n=(e=Sh())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},VR=t=>{const e=mI(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},gI=()=>{var t;return(t=Sh())==null?void 0:t.config},_I=t=>{var e;return(e=Sh())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LR{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xa(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function yI(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FR(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...t};return[Sd(JSON.stringify(n)),Sd(JSON.stringify(o)),""].join(".")}const Pl={};function UR(){const t={prod:[],emulator:[]};for(const e of Object.keys(Pl))Pl[e]?t.emulator.push(e):t.prod.push(e);return t}function OR(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let Cy=!1;function vI(t,e){if(typeof window>"u"||typeof document>"u"||!xa(window.location.host)||Pl[t]===e||Pl[t]||Cy)return;Pl[t]=e;function n(g){return`__firebase__banner__${g}`}const r="__firebase__banner",s=UR().prod.length>0;function o(){const g=document.getElementById(r);g&&g.remove()}function a(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function l(g,v){g.setAttribute("width","24"),g.setAttribute("id",v),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function u(){const g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{Cy=!0,o()},g}function f(g,v){g.setAttribute("id",v),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function m(){const g=OR(r),v=n("text"),T=document.getElementById(v)||document.createElement("span"),x=n("learnmore"),D=document.getElementById(x)||document.createElement("a"),C=n("preprendIcon"),w=document.getElementById(C)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){const P=g.element;a(P),f(D,x);const V=u();l(w,C),P.append(w,T,D,V),document.body.appendChild(P)}s?(T.innerText="Preview backend disconnected.",w.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(w.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,T.innerText="Preview backend running in this workspace."),T.setAttribute("id",v)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",m):m()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function BR(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Nt())}function TI(){var e;const t=(e=Sh())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function qR(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function GR(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function $R(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function zR(){const t=Nt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function EI(){return!TI()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function wI(){return!TI()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function II(){try{return typeof indexedDB=="object"}catch{return!1}}function HR(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)==null?void 0:s.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WR="FirebaseError";class Qr extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=WR,Object.setPrototypeOf(this,Qr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ku.prototype.create)}}class ku{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?KR(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new Qr(i,a,r)}}function KR(t,e){return t.replace(jR,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const jR=/\{\$([^}]+)}/g;function JR(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Gs(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],o=e[i];if(Ay(s)&&Ay(o)){if(!Gs(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function Ay(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nu(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function QR(t,e){const n=new YR(t,e);return n.subscribe.bind(n)}class YR{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");XR(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=Nf),i.error===void 0&&(i.error=Nf),i.complete===void 0&&(i.complete=Nf);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function XR(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Nf(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dt(t){return t&&t._delegate?t._delegate:t}class $s{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Es="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZR{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new LR;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(tP(e))try{this.getOrInitializeService({instanceIdentifier:Es})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Es){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Es){return this.instances.has(e)}getOptions(e=Es){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:eP(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Es){return this.component?this.component.multipleInstances?e:Es:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function eP(t){return t===Es?void 0:t}function tP(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nP{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new ZR(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ve;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ve||(Ve={}));const rP={debug:Ve.DEBUG,verbose:Ve.VERBOSE,info:Ve.INFO,warn:Ve.WARN,error:Ve.ERROR,silent:Ve.SILENT},iP=Ve.INFO,sP={[Ve.DEBUG]:"log",[Ve.VERBOSE]:"log",[Ve.INFO]:"info",[Ve.WARN]:"warn",[Ve.ERROR]:"error"},oP=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=sP[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class og{constructor(e){this.name=e,this._logLevel=iP,this._logHandler=oP,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ve))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?rP[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ve.DEBUG,...e),this._logHandler(this,Ve.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ve.VERBOSE,...e),this._logHandler(this,Ve.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ve.INFO,...e),this._logHandler(this,Ve.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ve.WARN,...e),this._logHandler(this,Ve.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ve.ERROR,...e),this._logHandler(this,Ve.ERROR,...e)}}const aP=(t,e)=>e.some(n=>t instanceof n);let xy,Ry;function lP(){return xy||(xy=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function uP(){return Ry||(Ry=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const SI=new WeakMap,_p=new WeakMap,CI=new WeakMap,Df=new WeakMap,ag=new WeakMap;function cP(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(Ai(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&SI.set(n,t)}).catch(()=>{}),ag.set(e,t),e}function dP(t){if(_p.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});_p.set(t,e)}let yp={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return _p.get(t);if(e==="objectStoreNames")return t.objectStoreNames||CI.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Ai(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function hP(t){yp=t(yp)}function fP(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(bf(this),e,...n);return CI.set(r,e.sort?e.sort():[e]),Ai(r)}:uP().includes(t)?function(...e){return t.apply(bf(this),e),Ai(SI.get(this))}:function(...e){return Ai(t.apply(bf(this),e))}}function pP(t){return typeof t=="function"?fP(t):(t instanceof IDBTransaction&&dP(t),aP(t,lP())?new Proxy(t,yp):t)}function Ai(t){if(t instanceof IDBRequest)return cP(t);if(Df.has(t))return Df.get(t);const e=pP(t);return e!==t&&(Df.set(t,e),ag.set(e,t)),e}const bf=t=>ag.get(t);function mP(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),a=Ai(o);return r&&o.addEventListener("upgradeneeded",l=>{r(Ai(o.result),l.oldVersion,l.newVersion,Ai(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}const gP=["get","getKey","getAll","getAllKeys","count"],_P=["put","add","delete","clear"],Mf=new Map;function Py(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Mf.get(e))return Mf.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=_P.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||gP.includes(n)))return;const s=async function(o,...a){const l=this.transaction(o,i?"readwrite":"readonly");let u=l.store;return r&&(u=u.index(a.shift())),(await Promise.all([u[n](...a),i&&l.done]))[0]};return Mf.set(e,s),s}hP(t=>({...t,get:(e,n,r)=>Py(e,n)||t.get(e,n,r),has:(e,n)=>!!Py(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yP{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(vP(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function vP(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const vp="@firebase/app",ky="0.14.4";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gr=new og("@firebase/app"),TP="@firebase/app-compat",EP="@firebase/analytics-compat",wP="@firebase/analytics",IP="@firebase/app-check-compat",SP="@firebase/app-check",CP="@firebase/auth",AP="@firebase/auth-compat",xP="@firebase/database",RP="@firebase/data-connect",PP="@firebase/database-compat",kP="@firebase/functions",NP="@firebase/functions-compat",DP="@firebase/installations",bP="@firebase/installations-compat",MP="@firebase/messaging",VP="@firebase/messaging-compat",LP="@firebase/performance",FP="@firebase/performance-compat",UP="@firebase/remote-config",OP="@firebase/remote-config-compat",BP="@firebase/storage",qP="@firebase/storage-compat",GP="@firebase/firestore",$P="@firebase/ai",zP="@firebase/firestore-compat",HP="firebase",WP="12.4.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tp="[DEFAULT]",KP={[vp]:"fire-core",[TP]:"fire-core-compat",[wP]:"fire-analytics",[EP]:"fire-analytics-compat",[SP]:"fire-app-check",[IP]:"fire-app-check-compat",[CP]:"fire-auth",[AP]:"fire-auth-compat",[xP]:"fire-rtdb",[RP]:"fire-data-connect",[PP]:"fire-rtdb-compat",[kP]:"fire-fn",[NP]:"fire-fn-compat",[DP]:"fire-iid",[bP]:"fire-iid-compat",[MP]:"fire-fcm",[VP]:"fire-fcm-compat",[LP]:"fire-perf",[FP]:"fire-perf-compat",[UP]:"fire-rc",[OP]:"fire-rc-compat",[BP]:"fire-gcs",[qP]:"fire-gcs-compat",[GP]:"fire-fst",[zP]:"fire-fst-compat",[$P]:"fire-vertex","fire-js":"fire-js",[HP]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cd=new Map,jP=new Map,Ep=new Map;function Ny(t,e){try{t.container.addComponent(e)}catch(n){Gr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function ra(t){const e=t.name;if(Ep.has(e))return Gr.debug(`There were multiple attempts to register component ${e}.`),!1;Ep.set(e,t);for(const n of Cd.values())Ny(n,t);for(const n of jP.values())Ny(n,t);return!0}function lg(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Xn(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JP={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},xi=new ku("app","Firebase",JP);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QP{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new $s("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw xi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ra=WP;function AI(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:Tp,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw xi.create("bad-app-name",{appName:String(i)});if(n||(n=gI()),!n)throw xi.create("no-options");const s=Cd.get(i);if(s){if(Gs(n,s.options)&&Gs(r,s.config))return s;throw xi.create("duplicate-app",{appName:i})}const o=new nP(i);for(const l of Ep.values())o.addComponent(l);const a=new QP(n,r,o);return Cd.set(i,a),a}function xI(t=Tp){const e=Cd.get(t);if(!e&&t===Tp&&gI())return AI();if(!e)throw xi.create("no-app",{appName:t});return e}function Ri(t,e,n){let r=KP[t]??t;n&&(r+=`-${n}`);const i=r.match(/\s|\//),s=e.match(/\s|\//);if(i||s){const o=[`Unable to register library "${r}" with version "${e}":`];i&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Gr.warn(o.join(" "));return}ra(new $s(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YP="firebase-heartbeat-database",XP=1,Yl="firebase-heartbeat-store";let Vf=null;function RI(){return Vf||(Vf=mP(YP,XP,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Yl)}catch(n){console.warn(n)}}}}).catch(t=>{throw xi.create("idb-open",{originalErrorMessage:t.message})})),Vf}async function ZP(t){try{const n=(await RI()).transaction(Yl),r=await n.objectStore(Yl).get(PI(t));return await n.done,r}catch(e){if(e instanceof Qr)Gr.warn(e.message);else{const n=xi.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Gr.warn(n.message)}}}async function Dy(t,e){try{const r=(await RI()).transaction(Yl,"readwrite");await r.objectStore(Yl).put(e,PI(t)),await r.done}catch(n){if(n instanceof Qr)Gr.warn(n.message);else{const r=xi.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Gr.warn(r.message)}}}function PI(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ek=1024,tk=30;class nk{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new ik(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=by();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>tk){const o=sk(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Gr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=by(),{heartbeatsToSend:r,unsentEntries:i}=rk(this._heartbeatsCache.heartbeats),s=Sd(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return Gr.warn(n),""}}}function by(){return new Date().toISOString().substring(0,10)}function rk(t,e=ek){const n=[];let r=t.slice();for(const i of t){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),My(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),My(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class ik{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return II()?HR().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await ZP(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Dy(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Dy(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function My(t){return Sd(JSON.stringify({version:2,heartbeats:t})).length}function sk(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ok(t){ra(new $s("platform-logger",e=>new yP(e),"PRIVATE")),ra(new $s("heartbeat",e=>new nk(e),"PRIVATE")),Ri(vp,ky,t),Ri(vp,ky,"esm2020"),Ri("fire-js","")}ok("");var ak="firebase",lk="12.4.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ri(ak,lk,"app");function kI(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const uk=kI,NI=new ku("auth","Firebase",kI());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ad=new og("@firebase/auth");function ck(t,...e){Ad.logLevel<=Ve.WARN&&Ad.warn(`Auth (${Ra}): ${t}`,...e)}function Jc(t,...e){Ad.logLevel<=Ve.ERROR&&Ad.error(`Auth (${Ra}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wr(t,...e){throw cg(t,...e)}function er(t,...e){return cg(t,...e)}function ug(t,e,n){const r={...uk(),[e]:n};return new ku("auth","Firebase",r).create(e,{appName:t.name})}function Vs(t){return ug(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function dk(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&wr(t,"argument-error"),ug(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function cg(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return NI.create(t,...e)}function Se(t,e,...n){if(!t)throw cg(e,...n)}function Vr(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Jc(e),new Error(e)}function $r(t,e){t||Vr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wp(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function hk(){return Vy()==="http:"||Vy()==="https:"}function Vy(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fk(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(hk()||GR()||"connection"in navigator)?navigator.onLine:!0}function pk(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Du{constructor(e,n){this.shortDelay=e,this.longDelay=n,$r(n>e,"Short delay should be less than long delay!"),this.isMobile=BR()||$R()}get(){return fk()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dg(t,e){$r(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DI{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Vr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Vr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Vr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mk={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gk=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],_k=new Du(3e4,6e4);function hg(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function Pa(t,e,n,r,i={}){return bI(t,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const a=Nu({key:t.config.apiKey,...o}).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const u={method:e,headers:l,...s};return qR()||(u.referrerPolicy="no-referrer"),t.emulatorConfig&&xa(t.emulatorConfig.host)&&(u.credentials="include"),DI.fetch()(await MI(t,t.config.apiHost,n,a),u)})}async function bI(t,e,n){t._canInitEmulator=!1;const r={...mk,...e};try{const i=new vk(t),s=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw Ic(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[l,u]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ic(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw Ic(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw Ic(t,"user-disabled",o);const f=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw ug(t,f,u);wr(t,f)}}catch(i){if(i instanceof Qr)throw i;wr(t,"network-request-failed",{message:String(i)})}}async function yk(t,e,n,r,i={}){const s=await Pa(t,e,n,r,i);return"mfaPendingCredential"in s&&wr(t,"multi-factor-auth-required",{_serverResponse:s}),s}async function MI(t,e,n,r){const i=`${e}${n}?${r}`,s=t,o=s.config.emulator?dg(t.config,i):`${t.config.apiScheme}://${i}`;return gk.includes(n)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}class vk{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(er(this.auth,"network-request-failed")),_k.get())})}}function Ic(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=er(t,e,r);return i.customData._tokenResponse=n,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Tk(t,e){return Pa(t,"POST","/v1/accounts:delete",e)}async function xd(t,e){return Pa(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kl(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Ek(t,e=!1){const n=Dt(t),r=await n.getIdToken(e),i=fg(r);Se(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:kl(Lf(i.auth_time)),issuedAtTime:kl(Lf(i.iat)),expirationTime:kl(Lf(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function Lf(t){return Number(t)*1e3}function fg(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Jc("JWT malformed, contained fewer than 3 sections"),null;try{const i=fI(n);return i?JSON.parse(i):(Jc("Failed to decode base64 JWT payload"),null)}catch(i){return Jc("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function Ly(t){const e=fg(t);return Se(e,"internal-error"),Se(typeof e.exp<"u","internal-error"),Se(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Xl(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Qr&&wk(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function wk({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ik{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ip{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=kl(this.lastLoginAt),this.creationTime=kl(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Rd(t){var m;const e=t.auth,n=await t.getIdToken(),r=await Xl(t,xd(e,{idToken:n}));Se(r==null?void 0:r.users.length,e,"internal-error");const i=r.users[0];t._notifyReloadListener(i);const s=(m=i.providerUserInfo)!=null&&m.length?VI(i.providerUserInfo):[],o=Ck(t.providerData,s),a=t.isAnonymous,l=!(t.email&&i.passwordHash)&&!(o!=null&&o.length),u=a?l:!1,f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new Ip(i.createdAt,i.lastLoginAt),isAnonymous:u};Object.assign(t,f)}async function Sk(t){const e=Dt(t);await Rd(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Ck(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function VI(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ak(t,e){const n=await bI(t,{},async()=>{const r=Nu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,o=await MI(t,i,"/v1/token",`key=${s}`),a=await t._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:a,body:r};return t.emulatorConfig&&xa(t.emulatorConfig.host)&&(l.credentials="include"),DI.fetch()(o,l)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function xk(t,e){return Pa(t,"POST","/v2/accounts:revokeToken",hg(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Se(e.idToken,"internal-error"),Se(typeof e.idToken<"u","internal-error"),Se(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Ly(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Se(e.length!==0,"internal-error");const n=Ly(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Se(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:s}=await Ak(e,n);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:s}=n,o=new zo;return r&&(Se(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(Se(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(Se(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new zo,this.toJSON())}_performRefresh(){return Vr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ui(t,e){Se(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Zn{constructor({uid:e,auth:n,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new Ik(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Ip(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await Xl(this,this.stsTokenManager.getToken(this.auth,e));return Se(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return Ek(this,e)}reload(){return Sk(this)}_assign(e){this!==e&&(Se(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Zn({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){Se(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Rd(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Xn(this.auth.app))return Promise.reject(Vs(this.auth));const e=await this.getIdToken();return await Xl(this,Tk(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,i=n.email??void 0,s=n.phoneNumber??void 0,o=n.photoURL??void 0,a=n.tenantId??void 0,l=n._redirectEventId??void 0,u=n.createdAt??void 0,f=n.lastLoginAt??void 0,{uid:m,emailVerified:g,isAnonymous:v,providerData:T,stsTokenManager:x}=n;Se(m&&x,e,"internal-error");const D=zo.fromJSON(this.name,x);Se(typeof m=="string",e,"internal-error"),ui(r,e.name),ui(i,e.name),Se(typeof g=="boolean",e,"internal-error"),Se(typeof v=="boolean",e,"internal-error"),ui(s,e.name),ui(o,e.name),ui(a,e.name),ui(l,e.name),ui(u,e.name),ui(f,e.name);const C=new Zn({uid:m,auth:e,email:i,emailVerified:g,displayName:r,isAnonymous:v,photoURL:o,phoneNumber:s,tenantId:a,stsTokenManager:D,createdAt:u,lastLoginAt:f});return T&&Array.isArray(T)&&(C.providerData=T.map(w=>({...w}))),l&&(C._redirectEventId=l),C}static async _fromIdTokenResponse(e,n,r=!1){const i=new zo;i.updateFromServerResponse(n);const s=new Zn({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await Rd(s),s}static async _fromGetAccountInfoResponse(e,n,r){const i=n.users[0];Se(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?VI(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),a=new zo;a.updateFromIdToken(r);const l=new Zn({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Ip(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(l,u),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fy=new Map;function Lr(t){$r(t instanceof Function,"Expected a class definition");let e=Fy.get(t);return e?($r(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Fy.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LI{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}LI.type="NONE";const Uy=LI;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qc(t,e,n){return`firebase:${t}:${e}:${n}`}class Ho{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=Qc(this.userKey,i.apiKey,s),this.fullPersistenceKey=Qc("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await xd(this.auth,{idToken:e}).catch(()=>{});return n?Zn._fromGetAccountInfoResponse(this.auth,n,e):null}return Zn._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Ho(Lr(Uy),e,r);const i=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let s=i[0]||Lr(Uy);const o=Qc(r,e.config.apiKey,e.name);let a=null;for(const u of n)try{const f=await u._get(o);if(f){let m;if(typeof f=="string"){const g=await xd(e,{idToken:f}).catch(()=>{});if(!g)break;m=await Zn._fromGetAccountInfoResponse(e,g,f)}else m=Zn._fromJSON(e,f);u!==s&&(a=m),s=u;break}}catch{}const l=i.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new Ho(s,e,r):(s=l[0],a&&await s._set(o,a.toJSON()),await Promise.all(n.map(async u=>{if(u!==s)try{await u._remove(o)}catch{}})),new Ho(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oy(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(BI(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(FI(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(GI(e))return"Blackberry";if($I(e))return"Webos";if(UI(e))return"Safari";if((e.includes("chrome/")||OI(e))&&!e.includes("edge/"))return"Chrome";if(qI(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function FI(t=Nt()){return/firefox\//i.test(t)}function UI(t=Nt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function OI(t=Nt()){return/crios\//i.test(t)}function BI(t=Nt()){return/iemobile/i.test(t)}function qI(t=Nt()){return/android/i.test(t)}function GI(t=Nt()){return/blackberry/i.test(t)}function $I(t=Nt()){return/webos/i.test(t)}function pg(t=Nt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function Rk(t=Nt()){var e;return pg(t)&&!!((e=window.navigator)!=null&&e.standalone)}function Pk(){return zR()&&document.documentMode===10}function zI(t=Nt()){return pg(t)||qI(t)||$I(t)||GI(t)||/windows phone/i.test(t)||BI(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HI(t,e=[]){let n;switch(t){case"Browser":n=Oy(Nt());break;case"Worker":n=`${Oy(Nt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Ra}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kk{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=s=>new Promise((o,a)=>{try{const l=e(s);o(l)}catch(l){a(l)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Nk(t,e={}){return Pa(t,"GET","/v2/passwordPolicy",hg(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dk=6;class bk{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??Dk,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mk{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new By(this),this.idTokenSubscription=new By(this),this.beforeStateQueue=new kk(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=NI,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Lr(n)),this._initializationPromise=this.queue(async()=>{var r,i,s;if(!this._deleted&&(this.persistenceManager=await Ho.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((i=this._popupRedirectResolver)!=null&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)==null?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await xd(this,{idToken:e}),r=await Zn._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var s;if(Xn(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(s=this.redirectUser)==null?void 0:s._redirectEventId,a=r==null?void 0:r._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(r=l.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Se(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Rd(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=pk()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Xn(this.app))return Promise.reject(Vs(this));const n=e?Dt(e):null;return n&&Se(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Se(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Xn(this.app)?Promise.reject(Vs(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Xn(this.app)?Promise.reject(Vs(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Lr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Nk(this),n=new bk(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new ku("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await xk(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Lr(e)||this._popupRedirectResolver;Se(n,this,"argument-error"),this.redirectPersistenceManager=await Ho.create(this,[Lr(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(Se(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,r,i);return()=>{o=!0,l()}}else{const l=e.addObserver(n);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Se(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=HI(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var i;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((i=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:i.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if(Xn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&ck(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Ch(t){return Dt(t)}class By{constructor(e){this.auth=e,this.observer=null,this.addObserver=QR(n=>this.observer=n)}get next(){return Se(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let mg={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Vk(t){mg=t}function Lk(t){return mg.loadJS(t)}function Fk(){return mg.gapiScript}function Uk(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ok(t,e){const n=lg(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),s=n.getOptions();if(Gs(s,e??{}))return i;wr(i,"already-initialized")}return n.initialize({options:e})}function Bk(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Lr);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function qk(t,e,n){const r=Ch(t);Se(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,s=WI(e),{host:o,port:a}=Gk(e),l=a===null?"":`:${a}`,u={url:`${s}//${o}${l}/`},f=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){Se(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),Se(Gs(u,r.config.emulator)&&Gs(f,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=u,r.emulatorConfig=f,r.settings.appVerificationDisabledForTesting=!0,xa(o)?(yI(`${s}//${o}${l}`),vI("Auth",!0)):$k()}function WI(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function Gk(t){const e=WI(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:qy(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:qy(o)}}}function qy(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function $k(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KI{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Vr("not implemented")}_getIdTokenResponse(e){return Vr("not implemented")}_linkToIdToken(e,n){return Vr("not implemented")}_getReauthenticationResolver(e){return Vr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Wo(t,e){return yk(t,"POST","/v1/accounts:signInWithIdp",hg(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zk="http://localhost";class zs extends KI{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new zs(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):wr("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...s}=n;if(!r||!i)return null;const o=new zs(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Wo(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Wo(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Wo(e,n)}buildRequest(){const e={requestUri:zk,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Nu(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gg{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bu extends gg{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _i extends bu{constructor(){super("facebook.com")}static credential(e){return zs._fromParams({providerId:_i.PROVIDER_ID,signInMethod:_i.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return _i.credentialFromTaggedObject(e)}static credentialFromError(e){return _i.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return _i.credential(e.oauthAccessToken)}catch{return null}}}_i.FACEBOOK_SIGN_IN_METHOD="facebook.com";_i.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mr extends bu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return zs._fromParams({providerId:Mr.PROVIDER_ID,signInMethod:Mr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Mr.credentialFromTaggedObject(e)}static credentialFromError(e){return Mr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Mr.credential(n,r)}catch{return null}}}Mr.GOOGLE_SIGN_IN_METHOD="google.com";Mr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yi extends bu{constructor(){super("github.com")}static credential(e){return zs._fromParams({providerId:yi.PROVIDER_ID,signInMethod:yi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return yi.credentialFromTaggedObject(e)}static credentialFromError(e){return yi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return yi.credential(e.oauthAccessToken)}catch{return null}}}yi.GITHUB_SIGN_IN_METHOD="github.com";yi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vi extends bu{constructor(){super("twitter.com")}static credential(e,n){return zs._fromParams({providerId:vi.PROVIDER_ID,signInMethod:vi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return vi.credentialFromTaggedObject(e)}static credentialFromError(e){return vi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return vi.credential(n,r)}catch{return null}}}vi.TWITTER_SIGN_IN_METHOD="twitter.com";vi.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ia{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const s=await Zn._fromIdTokenResponse(e,r,i),o=Gy(r);return new ia({user:s,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=Gy(r);return new ia({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function Gy(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pd extends Qr{constructor(e,n,r,i){super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,Pd.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new Pd(e,n,r,i)}}function jI(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Pd._fromErrorAndOperation(t,s,e,r):s})}async function Hk(t,e,n=!1){const r=await Xl(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return ia._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Wk(t,e,n=!1){const{auth:r}=t;if(Xn(r.app))return Promise.reject(Vs(r));const i="reauthenticate";try{const s=await Xl(t,jI(r,i,e,t),n);Se(s.idToken,r,"internal-error");const o=fg(s.idToken);Se(o,r,"internal-error");const{sub:a}=o;return Se(t.uid===a,r,"user-mismatch"),ia._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&wr(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Kk(t,e,n=!1){if(Xn(t.app))return Promise.reject(Vs(t));const r="signIn",i=await jI(t,r,e),s=await ia._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(s.user),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jk(t,e){return Dt(t).setPersistence(e)}function Jk(t,e,n,r){return Dt(t).onIdTokenChanged(e,n,r)}function Qk(t,e,n){return Dt(t).beforeAuthStateChanged(e,n)}function Yk(t,e,n,r){return Dt(t).onAuthStateChanged(e,n,r)}function Xk(t){return Dt(t).signOut()}const kd="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JI{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(kd,"1"),this.storage.removeItem(kd),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zk=1e3,e1=10;class QI extends JI{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=zI(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;n?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);Pk()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,e1):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},Zk)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}QI.type="LOCAL";const YI=QI;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XI extends JI{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}XI.type="SESSION";const ZI=XI;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t1(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ah{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new Ah(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:s}=n.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const a=Array.from(o).map(async u=>u(n.origin,s)),l=await t1(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Ah.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _g(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n1{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,l)=>{const u=_g("",20);i.port1.start();const f=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(m){const g=m;if(g.data.eventId===u)switch(g.data.status){case"ack":clearTimeout(f),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(g.data.response);break;default:clearTimeout(f),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yr(){return window}function r1(t){yr().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eS(){return typeof yr().WorkerGlobalScope<"u"&&typeof yr().importScripts=="function"}async function i1(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function s1(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function o1(){return eS()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tS="firebaseLocalStorageDb",a1=1,Nd="firebaseLocalStorage",nS="fbase_key";class Mu{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function xh(t,e){return t.transaction([Nd],e?"readwrite":"readonly").objectStore(Nd)}function l1(){const t=indexedDB.deleteDatabase(tS);return new Mu(t).toPromise()}function Sp(){const t=indexedDB.open(tS,a1);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Nd,{keyPath:nS})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Nd)?e(r):(r.close(),await l1(),e(await Sp()))})})}async function $y(t,e,n){const r=xh(t,!0).put({[nS]:e,value:n});return new Mu(r).toPromise()}async function u1(t,e){const n=xh(t,!1).get(e),r=await new Mu(n).toPromise();return r===void 0?null:r.value}function zy(t,e){const n=xh(t,!0).delete(e);return new Mu(n).toPromise()}const c1=800,d1=3;class rS{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Sp(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>d1)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return eS()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Ah._getInstance(o1()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await i1(),!this.activeServiceWorker)return;this.sender=new n1(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||s1()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Sp();return await $y(e,kd,"1"),await zy(e,kd),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>$y(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>u1(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>zy(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=xh(i,!1).getAll();return new Mu(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),c1)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}rS.type="LOCAL";const h1=rS;new Du(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iS(t,e){return e?Lr(e):(Se(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yg extends KI{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Wo(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Wo(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Wo(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function f1(t){return Kk(t.auth,new yg(t),t.bypassAuthState)}function p1(t){const{auth:e,user:n}=t;return Se(n,e,"internal-error"),Wk(n,new yg(t),t.bypassAuthState)}async function m1(t){const{auth:e,user:n}=t;return Se(n,e,"internal-error"),Hk(n,new yg(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sS{constructor(e,n,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return f1;case"linkViaPopup":case"linkViaRedirect":return m1;case"reauthViaPopup":case"reauthViaRedirect":return p1;default:wr(this.auth,"internal-error")}}resolve(e){$r(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){$r(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g1=new Du(2e3,1e4);async function _1(t,e,n){if(Xn(t.app))return Promise.reject(er(t,"operation-not-supported-in-this-environment"));const r=Ch(t);dk(t,e,gg);const i=iS(r,n);return new ks(r,"signInViaPopup",e,i).executeNotNull()}class ks extends sS{constructor(e,n,r,i,s){super(e,n,i,s),this.provider=r,this.authWindow=null,this.pollId=null,ks.currentPopupAction&&ks.currentPopupAction.cancel(),ks.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Se(e,this.auth,"internal-error"),e}async onExecution(){$r(this.filter.length===1,"Popup operations only handle one event");const e=_g();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(er(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(er(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ks.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(er(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,g1.get())};e()}}ks.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y1="pendingRedirect",Yc=new Map;class v1 extends sS{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Yc.get(this.auth._key());if(!e){try{const r=await T1(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Yc.set(this.auth._key(),e)}return this.bypassAuthState||Yc.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function T1(t,e){const n=I1(e),r=w1(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}function E1(t,e){Yc.set(t._key(),e)}function w1(t){return Lr(t._redirectPersistence)}function I1(t){return Qc(y1,t.config.apiKey,t.name)}async function S1(t,e,n=!1){if(Xn(t.app))return Promise.reject(Vs(t));const r=Ch(t),i=iS(r,e),o=await new v1(r,i,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C1=10*60*1e3;class A1{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!x1(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!oS(e)){const i=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(er(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=C1&&this.cachedEventUids.clear(),this.cachedEventUids.has(Hy(e))}saveEventToCache(e){this.cachedEventUids.add(Hy(e)),this.lastProcessedEventTime=Date.now()}}function Hy(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function oS({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function x1(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return oS(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function R1(t,e={}){return Pa(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P1=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,k1=/^https?/;async function N1(t){if(t.config.emulator)return;const{authorizedDomains:e}=await R1(t);for(const n of e)try{if(D1(n))return}catch{}wr(t,"unauthorized-domain")}function D1(t){const e=wp(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!k1.test(n))return!1;if(P1.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b1=new Du(3e4,6e4);function Wy(){const t=yr().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function M1(t){return new Promise((e,n)=>{var i,s,o;function r(){Wy(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Wy(),n(er(t,"network-request-failed"))},timeout:b1.get()})}if((s=(i=yr().gapi)==null?void 0:i.iframes)!=null&&s.Iframe)e(gapi.iframes.getContext());else if((o=yr().gapi)!=null&&o.load)r();else{const a=Uk("iframefcb");return yr()[a]=()=>{gapi.load?r():n(er(t,"network-request-failed"))},Lk(`${Fk()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw Xc=null,e})}let Xc=null;function V1(t){return Xc=Xc||M1(t),Xc}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L1=new Du(5e3,15e3),F1="__/auth/iframe",U1="emulator/auth/iframe",O1={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},B1=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function q1(t){const e=t.config;Se(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?dg(e,U1):`https://${t.config.authDomain}/${F1}`,r={apiKey:e.apiKey,appName:t.name,v:Ra},i=B1.get(t.config.apiHost);i&&(r.eid=i);const s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${Nu(r).slice(1)}`}async function G1(t){const e=await V1(t),n=yr().gapi;return Se(n,t,"internal-error"),e.open({where:document.body,url:q1(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:O1,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=er(t,"network-request-failed"),a=yr().setTimeout(()=>{s(o)},L1.get());function l(){yr().clearTimeout(a),i(r)}r.ping(l).then(l,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $1={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},z1=500,H1=600,W1="_blank",K1="http://localhost";class Ky{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function j1(t,e,n,r=z1,i=H1){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l={...$1,width:r.toString(),height:i.toString(),top:s,left:o},u=Nt().toLowerCase();n&&(a=OI(u)?W1:n),FI(u)&&(e=e||K1,l.scrollbars="yes");const f=Object.entries(l).reduce((g,[v,T])=>`${g}${v}=${T},`,"");if(Rk(u)&&a!=="_self")return J1(e||"",a),new Ky(null);const m=window.open(e||"",a,f);Se(m,t,"popup-blocked");try{m.focus()}catch{}return new Ky(m)}function J1(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q1="__/auth/handler",Y1="emulator/auth/handler",X1=encodeURIComponent("fac");async function jy(t,e,n,r,i,s){Se(t.config.authDomain,t,"auth-domain-config-required"),Se(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Ra,eventId:i};if(e instanceof gg){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",JR(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,m]of Object.entries({}))o[f]=m}if(e instanceof bu){const f=e.getScopes().filter(m=>m!=="");f.length>0&&(o.scopes=f.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const f of Object.keys(a))a[f]===void 0&&delete a[f];const l=await t._getAppCheckToken(),u=l?`#${X1}=${encodeURIComponent(l)}`:"";return`${Z1(t)}?${Nu(a).slice(1)}${u}`}function Z1({config:t}){return t.emulator?dg(t,Y1):`https://${t.authDomain}/${Q1}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ff="webStorageSupport";class eN{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=ZI,this._completeRedirectFn=S1,this._overrideRedirectResult=E1}async _openPopup(e,n,r,i){var o;$r((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const s=await jy(e,n,r,wp(),i);return j1(e,s,_g())}async _openRedirect(e,n,r,i){await this._originValidation(e);const s=await jy(e,n,r,wp(),i);return r1(s),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:s}=this.eventManagers[n];return i?Promise.resolve(i):($r(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await G1(e),r=new A1(e);return n.register("authEvent",i=>(Se(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Ff,{type:Ff},i=>{var o;const s=(o=i==null?void 0:i[0])==null?void 0:o[Ff];s!==void 0&&n(!!s),wr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=N1(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return zI()||UI()||pg()}}const tN=eN;var Jy="@firebase/auth",Qy="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nN{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Se(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rN(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function iN(t){ra(new $s("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;Se(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:HI(t)},u=new Mk(r,i,s,l);return Bk(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),ra(new $s("auth-internal",e=>{const n=Ch(e.getProvider("auth").getImmediate());return(r=>new nN(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ri(Jy,Qy,rN(t)),Ri(Jy,Qy,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sN=5*60,oN=_I("authIdTokenMaxAge")||sN;let Yy=null;const aN=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>oN)return;const i=n==null?void 0:n.token;Yy!==i&&(Yy=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function lN(t=xI()){const e=lg(t,"auth");if(e.isInitialized())return e.getImmediate();const n=Ok(t,{popupRedirectResolver:tN,persistence:[h1,YI,ZI]}),r=_I("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const o=aN(s.toString());Qk(n,o,()=>o(n.currentUser)),Jk(n,a=>o(a))}}const i=mI("auth");return i&&qk(n,`http://${i}`),n}function uN(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}Vk({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const s=er("internal-error");s.customData=i,n(s)},r.type="text/javascript",r.charset="UTF-8",uN().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});iN("Browser");var Xy=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Pi,aS;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(E,I){function A(){}A.prototype=I.prototype,E.F=I.prototype,E.prototype=new A,E.prototype.constructor=E,E.D=function(k,b,L){for(var N=Array(arguments.length-2),De=2;De<arguments.length;De++)N[De-2]=arguments[De];return I.prototype[b].apply(k,N)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(E,I,A){A||(A=0);const k=Array(16);if(typeof I=="string")for(var b=0;b<16;++b)k[b]=I.charCodeAt(A++)|I.charCodeAt(A++)<<8|I.charCodeAt(A++)<<16|I.charCodeAt(A++)<<24;else for(b=0;b<16;++b)k[b]=I[A++]|I[A++]<<8|I[A++]<<16|I[A++]<<24;I=E.g[0],A=E.g[1],b=E.g[2];let L=E.g[3],N;N=I+(L^A&(b^L))+k[0]+3614090360&4294967295,I=A+(N<<7&4294967295|N>>>25),N=L+(b^I&(A^b))+k[1]+3905402710&4294967295,L=I+(N<<12&4294967295|N>>>20),N=b+(A^L&(I^A))+k[2]+606105819&4294967295,b=L+(N<<17&4294967295|N>>>15),N=A+(I^b&(L^I))+k[3]+3250441966&4294967295,A=b+(N<<22&4294967295|N>>>10),N=I+(L^A&(b^L))+k[4]+4118548399&4294967295,I=A+(N<<7&4294967295|N>>>25),N=L+(b^I&(A^b))+k[5]+1200080426&4294967295,L=I+(N<<12&4294967295|N>>>20),N=b+(A^L&(I^A))+k[6]+2821735955&4294967295,b=L+(N<<17&4294967295|N>>>15),N=A+(I^b&(L^I))+k[7]+4249261313&4294967295,A=b+(N<<22&4294967295|N>>>10),N=I+(L^A&(b^L))+k[8]+1770035416&4294967295,I=A+(N<<7&4294967295|N>>>25),N=L+(b^I&(A^b))+k[9]+2336552879&4294967295,L=I+(N<<12&4294967295|N>>>20),N=b+(A^L&(I^A))+k[10]+4294925233&4294967295,b=L+(N<<17&4294967295|N>>>15),N=A+(I^b&(L^I))+k[11]+2304563134&4294967295,A=b+(N<<22&4294967295|N>>>10),N=I+(L^A&(b^L))+k[12]+1804603682&4294967295,I=A+(N<<7&4294967295|N>>>25),N=L+(b^I&(A^b))+k[13]+4254626195&4294967295,L=I+(N<<12&4294967295|N>>>20),N=b+(A^L&(I^A))+k[14]+2792965006&4294967295,b=L+(N<<17&4294967295|N>>>15),N=A+(I^b&(L^I))+k[15]+1236535329&4294967295,A=b+(N<<22&4294967295|N>>>10),N=I+(b^L&(A^b))+k[1]+4129170786&4294967295,I=A+(N<<5&4294967295|N>>>27),N=L+(A^b&(I^A))+k[6]+3225465664&4294967295,L=I+(N<<9&4294967295|N>>>23),N=b+(I^A&(L^I))+k[11]+643717713&4294967295,b=L+(N<<14&4294967295|N>>>18),N=A+(L^I&(b^L))+k[0]+3921069994&4294967295,A=b+(N<<20&4294967295|N>>>12),N=I+(b^L&(A^b))+k[5]+3593408605&4294967295,I=A+(N<<5&4294967295|N>>>27),N=L+(A^b&(I^A))+k[10]+38016083&4294967295,L=I+(N<<9&4294967295|N>>>23),N=b+(I^A&(L^I))+k[15]+3634488961&4294967295,b=L+(N<<14&4294967295|N>>>18),N=A+(L^I&(b^L))+k[4]+3889429448&4294967295,A=b+(N<<20&4294967295|N>>>12),N=I+(b^L&(A^b))+k[9]+568446438&4294967295,I=A+(N<<5&4294967295|N>>>27),N=L+(A^b&(I^A))+k[14]+3275163606&4294967295,L=I+(N<<9&4294967295|N>>>23),N=b+(I^A&(L^I))+k[3]+4107603335&4294967295,b=L+(N<<14&4294967295|N>>>18),N=A+(L^I&(b^L))+k[8]+1163531501&4294967295,A=b+(N<<20&4294967295|N>>>12),N=I+(b^L&(A^b))+k[13]+2850285829&4294967295,I=A+(N<<5&4294967295|N>>>27),N=L+(A^b&(I^A))+k[2]+4243563512&4294967295,L=I+(N<<9&4294967295|N>>>23),N=b+(I^A&(L^I))+k[7]+1735328473&4294967295,b=L+(N<<14&4294967295|N>>>18),N=A+(L^I&(b^L))+k[12]+2368359562&4294967295,A=b+(N<<20&4294967295|N>>>12),N=I+(A^b^L)+k[5]+4294588738&4294967295,I=A+(N<<4&4294967295|N>>>28),N=L+(I^A^b)+k[8]+2272392833&4294967295,L=I+(N<<11&4294967295|N>>>21),N=b+(L^I^A)+k[11]+1839030562&4294967295,b=L+(N<<16&4294967295|N>>>16),N=A+(b^L^I)+k[14]+4259657740&4294967295,A=b+(N<<23&4294967295|N>>>9),N=I+(A^b^L)+k[1]+2763975236&4294967295,I=A+(N<<4&4294967295|N>>>28),N=L+(I^A^b)+k[4]+1272893353&4294967295,L=I+(N<<11&4294967295|N>>>21),N=b+(L^I^A)+k[7]+4139469664&4294967295,b=L+(N<<16&4294967295|N>>>16),N=A+(b^L^I)+k[10]+3200236656&4294967295,A=b+(N<<23&4294967295|N>>>9),N=I+(A^b^L)+k[13]+681279174&4294967295,I=A+(N<<4&4294967295|N>>>28),N=L+(I^A^b)+k[0]+3936430074&4294967295,L=I+(N<<11&4294967295|N>>>21),N=b+(L^I^A)+k[3]+3572445317&4294967295,b=L+(N<<16&4294967295|N>>>16),N=A+(b^L^I)+k[6]+76029189&4294967295,A=b+(N<<23&4294967295|N>>>9),N=I+(A^b^L)+k[9]+3654602809&4294967295,I=A+(N<<4&4294967295|N>>>28),N=L+(I^A^b)+k[12]+3873151461&4294967295,L=I+(N<<11&4294967295|N>>>21),N=b+(L^I^A)+k[15]+530742520&4294967295,b=L+(N<<16&4294967295|N>>>16),N=A+(b^L^I)+k[2]+3299628645&4294967295,A=b+(N<<23&4294967295|N>>>9),N=I+(b^(A|~L))+k[0]+4096336452&4294967295,I=A+(N<<6&4294967295|N>>>26),N=L+(A^(I|~b))+k[7]+1126891415&4294967295,L=I+(N<<10&4294967295|N>>>22),N=b+(I^(L|~A))+k[14]+2878612391&4294967295,b=L+(N<<15&4294967295|N>>>17),N=A+(L^(b|~I))+k[5]+4237533241&4294967295,A=b+(N<<21&4294967295|N>>>11),N=I+(b^(A|~L))+k[12]+1700485571&4294967295,I=A+(N<<6&4294967295|N>>>26),N=L+(A^(I|~b))+k[3]+2399980690&4294967295,L=I+(N<<10&4294967295|N>>>22),N=b+(I^(L|~A))+k[10]+4293915773&4294967295,b=L+(N<<15&4294967295|N>>>17),N=A+(L^(b|~I))+k[1]+2240044497&4294967295,A=b+(N<<21&4294967295|N>>>11),N=I+(b^(A|~L))+k[8]+1873313359&4294967295,I=A+(N<<6&4294967295|N>>>26),N=L+(A^(I|~b))+k[15]+4264355552&4294967295,L=I+(N<<10&4294967295|N>>>22),N=b+(I^(L|~A))+k[6]+2734768916&4294967295,b=L+(N<<15&4294967295|N>>>17),N=A+(L^(b|~I))+k[13]+1309151649&4294967295,A=b+(N<<21&4294967295|N>>>11),N=I+(b^(A|~L))+k[4]+4149444226&4294967295,I=A+(N<<6&4294967295|N>>>26),N=L+(A^(I|~b))+k[11]+3174756917&4294967295,L=I+(N<<10&4294967295|N>>>22),N=b+(I^(L|~A))+k[2]+718787259&4294967295,b=L+(N<<15&4294967295|N>>>17),N=A+(L^(b|~I))+k[9]+3951481745&4294967295,E.g[0]=E.g[0]+I&4294967295,E.g[1]=E.g[1]+(b+(N<<21&4294967295|N>>>11))&4294967295,E.g[2]=E.g[2]+b&4294967295,E.g[3]=E.g[3]+L&4294967295}r.prototype.v=function(E,I){I===void 0&&(I=E.length);const A=I-this.blockSize,k=this.C;let b=this.h,L=0;for(;L<I;){if(b==0)for(;L<=A;)i(this,E,L),L+=this.blockSize;if(typeof E=="string"){for(;L<I;)if(k[b++]=E.charCodeAt(L++),b==this.blockSize){i(this,k),b=0;break}}else for(;L<I;)if(k[b++]=E[L++],b==this.blockSize){i(this,k),b=0;break}}this.h=b,this.o+=I},r.prototype.A=function(){var E=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);E[0]=128;for(var I=1;I<E.length-8;++I)E[I]=0;I=this.o*8;for(var A=E.length-8;A<E.length;++A)E[A]=I&255,I/=256;for(this.v(E),E=Array(16),I=0,A=0;A<4;++A)for(let k=0;k<32;k+=8)E[I++]=this.g[A]>>>k&255;return E};function s(E,I){var A=a;return Object.prototype.hasOwnProperty.call(A,E)?A[E]:A[E]=I(E)}function o(E,I){this.h=I;const A=[];let k=!0;for(let b=E.length-1;b>=0;b--){const L=E[b]|0;k&&L==I||(A[b]=L,k=!1)}this.g=A}var a={};function l(E){return-128<=E&&E<128?s(E,function(I){return new o([I|0],I<0?-1:0)}):new o([E|0],E<0?-1:0)}function u(E){if(isNaN(E)||!isFinite(E))return m;if(E<0)return D(u(-E));const I=[];let A=1;for(let k=0;E>=A;k++)I[k]=E/A|0,A*=4294967296;return new o(I,0)}function f(E,I){if(E.length==0)throw Error("number format error: empty string");if(I=I||10,I<2||36<I)throw Error("radix out of range: "+I);if(E.charAt(0)=="-")return D(f(E.substring(1),I));if(E.indexOf("-")>=0)throw Error('number format error: interior "-" character');const A=u(Math.pow(I,8));let k=m;for(let L=0;L<E.length;L+=8){var b=Math.min(8,E.length-L);const N=parseInt(E.substring(L,L+b),I);b<8?(b=u(Math.pow(I,b)),k=k.j(b).add(u(N))):(k=k.j(A),k=k.add(u(N)))}return k}var m=l(0),g=l(1),v=l(16777216);t=o.prototype,t.m=function(){if(x(this))return-D(this).m();let E=0,I=1;for(let A=0;A<this.g.length;A++){const k=this.i(A);E+=(k>=0?k:4294967296+k)*I,I*=4294967296}return E},t.toString=function(E){if(E=E||10,E<2||36<E)throw Error("radix out of range: "+E);if(T(this))return"0";if(x(this))return"-"+D(this).toString(E);const I=u(Math.pow(E,6));var A=this;let k="";for(;;){const b=V(A,I).g;A=C(A,b.j(I));let L=((A.g.length>0?A.g[0]:A.h)>>>0).toString(E);if(A=b,T(A))return L+k;for(;L.length<6;)L="0"+L;k=L+k}},t.i=function(E){return E<0?0:E<this.g.length?this.g[E]:this.h};function T(E){if(E.h!=0)return!1;for(let I=0;I<E.g.length;I++)if(E.g[I]!=0)return!1;return!0}function x(E){return E.h==-1}t.l=function(E){return E=C(this,E),x(E)?-1:T(E)?0:1};function D(E){const I=E.g.length,A=[];for(let k=0;k<I;k++)A[k]=~E.g[k];return new o(A,~E.h).add(g)}t.abs=function(){return x(this)?D(this):this},t.add=function(E){const I=Math.max(this.g.length,E.g.length),A=[];let k=0;for(let b=0;b<=I;b++){let L=k+(this.i(b)&65535)+(E.i(b)&65535),N=(L>>>16)+(this.i(b)>>>16)+(E.i(b)>>>16);k=N>>>16,L&=65535,N&=65535,A[b]=N<<16|L}return new o(A,A[A.length-1]&-2147483648?-1:0)};function C(E,I){return E.add(D(I))}t.j=function(E){if(T(this)||T(E))return m;if(x(this))return x(E)?D(this).j(D(E)):D(D(this).j(E));if(x(E))return D(this.j(D(E)));if(this.l(v)<0&&E.l(v)<0)return u(this.m()*E.m());const I=this.g.length+E.g.length,A=[];for(var k=0;k<2*I;k++)A[k]=0;for(k=0;k<this.g.length;k++)for(let b=0;b<E.g.length;b++){const L=this.i(k)>>>16,N=this.i(k)&65535,De=E.i(b)>>>16,Fe=E.i(b)&65535;A[2*k+2*b]+=N*Fe,w(A,2*k+2*b),A[2*k+2*b+1]+=L*Fe,w(A,2*k+2*b+1),A[2*k+2*b+1]+=N*De,w(A,2*k+2*b+1),A[2*k+2*b+2]+=L*De,w(A,2*k+2*b+2)}for(E=0;E<I;E++)A[E]=A[2*E+1]<<16|A[2*E];for(E=I;E<2*I;E++)A[E]=0;return new o(A,0)};function w(E,I){for(;(E[I]&65535)!=E[I];)E[I+1]+=E[I]>>>16,E[I]&=65535,I++}function P(E,I){this.g=E,this.h=I}function V(E,I){if(T(I))throw Error("division by zero");if(T(E))return new P(m,m);if(x(E))return I=V(D(E),I),new P(D(I.g),D(I.h));if(x(I))return I=V(E,D(I)),new P(D(I.g),I.h);if(E.g.length>30){if(x(E)||x(I))throw Error("slowDivide_ only works with positive integers.");for(var A=g,k=I;k.l(E)<=0;)A=O(A),k=O(k);var b=B(A,1),L=B(k,1);for(k=B(k,2),A=B(A,2);!T(k);){var N=L.add(k);N.l(E)<=0&&(b=b.add(A),L=N),k=B(k,1),A=B(A,1)}return I=C(E,b.j(I)),new P(b,I)}for(b=m;E.l(I)>=0;){for(A=Math.max(1,Math.floor(E.m()/I.m())),k=Math.ceil(Math.log(A)/Math.LN2),k=k<=48?1:Math.pow(2,k-48),L=u(A),N=L.j(I);x(N)||N.l(E)>0;)A-=k,L=u(A),N=L.j(I);T(L)&&(L=g),b=b.add(L),E=C(E,N)}return new P(b,E)}t.B=function(E){return V(this,E).h},t.and=function(E){const I=Math.max(this.g.length,E.g.length),A=[];for(let k=0;k<I;k++)A[k]=this.i(k)&E.i(k);return new o(A,this.h&E.h)},t.or=function(E){const I=Math.max(this.g.length,E.g.length),A=[];for(let k=0;k<I;k++)A[k]=this.i(k)|E.i(k);return new o(A,this.h|E.h)},t.xor=function(E){const I=Math.max(this.g.length,E.g.length),A=[];for(let k=0;k<I;k++)A[k]=this.i(k)^E.i(k);return new o(A,this.h^E.h)};function O(E){const I=E.g.length+1,A=[];for(let k=0;k<I;k++)A[k]=E.i(k)<<1|E.i(k-1)>>>31;return new o(A,E.h)}function B(E,I){const A=I>>5;I%=32;const k=E.g.length-A,b=[];for(let L=0;L<k;L++)b[L]=I>0?E.i(L+A)>>>I|E.i(L+A+1)<<32-I:E.i(L+A);return new o(b,E.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,aS=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=f,Pi=o}).apply(typeof Xy<"u"?Xy:typeof self<"u"?self:typeof window<"u"?window:{});var Sc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var lS,Tl,uS,Zc,Cp,cS,dS,hS;(function(){var t,e=Object.defineProperty;function n(d){d=[typeof globalThis=="object"&&globalThis,d,typeof window=="object"&&window,typeof self=="object"&&self,typeof Sc=="object"&&Sc];for(var _=0;_<d.length;++_){var y=d[_];if(y&&y.Math==Math)return y}throw Error("Cannot find global object")}var r=n(this);function i(d,_){if(_)e:{var y=r;d=d.split(".");for(var R=0;R<d.length-1;R++){var $=d[R];if(!($ in y))break e;y=y[$]}d=d[d.length-1],R=y[d],_=_(R),_!=R&&_!=null&&e(y,d,{configurable:!0,writable:!0,value:_})}}i("Symbol.dispose",function(d){return d||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(d){return d||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(d){return d||function(_){var y=[],R;for(R in _)Object.prototype.hasOwnProperty.call(_,R)&&y.push([R,_[R]]);return y}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var s=s||{},o=this||self;function a(d){var _=typeof d;return _=="object"&&d!=null||_=="function"}function l(d,_,y){return d.call.apply(d.bind,arguments)}function u(d,_,y){return u=l,u.apply(null,arguments)}function f(d,_){var y=Array.prototype.slice.call(arguments,1);return function(){var R=y.slice();return R.push.apply(R,arguments),d.apply(this,R)}}function m(d,_){function y(){}y.prototype=_.prototype,d.Z=_.prototype,d.prototype=new y,d.prototype.constructor=d,d.Ob=function(R,$,H){for(var ie=Array(arguments.length-2),ke=2;ke<arguments.length;ke++)ie[ke-2]=arguments[ke];return _.prototype[$].apply(R,ie)}}var g=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?d=>d&&AsyncContext.Snapshot.wrap(d):d=>d;function v(d){const _=d.length;if(_>0){const y=Array(_);for(let R=0;R<_;R++)y[R]=d[R];return y}return[]}function T(d,_){for(let R=1;R<arguments.length;R++){const $=arguments[R];var y=typeof $;if(y=y!="object"?y:$?Array.isArray($)?"array":y:"null",y=="array"||y=="object"&&typeof $.length=="number"){y=d.length||0;const H=$.length||0;d.length=y+H;for(let ie=0;ie<H;ie++)d[y+ie]=$[ie]}else d.push($)}}class x{constructor(_,y){this.i=_,this.j=y,this.h=0,this.g=null}get(){let _;return this.h>0?(this.h--,_=this.g,this.g=_.next,_.next=null):_=this.i(),_}}function D(d){o.setTimeout(()=>{throw d},0)}function C(){var d=E;let _=null;return d.g&&(_=d.g,d.g=d.g.next,d.g||(d.h=null),_.next=null),_}class w{constructor(){this.h=this.g=null}add(_,y){const R=P.get();R.set(_,y),this.h?this.h.next=R:this.g=R,this.h=R}}var P=new x(()=>new V,d=>d.reset());class V{constructor(){this.next=this.g=this.h=null}set(_,y){this.h=_,this.g=y,this.next=null}reset(){this.next=this.g=this.h=null}}let O,B=!1,E=new w,I=()=>{const d=Promise.resolve(void 0);O=()=>{d.then(A)}};function A(){for(var d;d=C();){try{d.h.call(d.g)}catch(y){D(y)}var _=P;_.j(d),_.h<100&&(_.h++,d.next=_.g,_.g=d)}B=!1}function k(){this.u=this.u,this.C=this.C}k.prototype.u=!1,k.prototype.dispose=function(){this.u||(this.u=!0,this.N())},k.prototype[Symbol.dispose]=function(){this.dispose()},k.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function b(d,_){this.type=d,this.g=this.target=_,this.defaultPrevented=!1}b.prototype.h=function(){this.defaultPrevented=!0};var L=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var d=!1,_=Object.defineProperty({},"passive",{get:function(){d=!0}});try{const y=()=>{};o.addEventListener("test",y,_),o.removeEventListener("test",y,_)}catch{}return d}();function N(d){return/^[\s\xa0]*$/.test(d)}function De(d,_){b.call(this,d?d.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,d&&this.init(d,_)}m(De,b),De.prototype.init=function(d,_){const y=this.type=d.type,R=d.changedTouches&&d.changedTouches.length?d.changedTouches[0]:null;this.target=d.target||d.srcElement,this.g=_,_=d.relatedTarget,_||(y=="mouseover"?_=d.fromElement:y=="mouseout"&&(_=d.toElement)),this.relatedTarget=_,R?(this.clientX=R.clientX!==void 0?R.clientX:R.pageX,this.clientY=R.clientY!==void 0?R.clientY:R.pageY,this.screenX=R.screenX||0,this.screenY=R.screenY||0):(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0),this.button=d.button,this.key=d.key||"",this.ctrlKey=d.ctrlKey,this.altKey=d.altKey,this.shiftKey=d.shiftKey,this.metaKey=d.metaKey,this.pointerId=d.pointerId||0,this.pointerType=d.pointerType,this.state=d.state,this.i=d,d.defaultPrevented&&De.Z.h.call(this)},De.prototype.h=function(){De.Z.h.call(this);const d=this.i;d.preventDefault?d.preventDefault():d.returnValue=!1};var Fe="closure_listenable_"+(Math.random()*1e6|0),Ke=0;function Te(d,_,y,R,$){this.listener=d,this.proxy=null,this.src=_,this.type=y,this.capture=!!R,this.ha=$,this.key=++Ke,this.da=this.fa=!1}function te(d){d.da=!0,d.listener=null,d.proxy=null,d.src=null,d.ha=null}function ce(d,_,y){for(const R in d)_.call(y,d[R],R,d)}function me(d,_){for(const y in d)_.call(void 0,d[y],y,d)}function Ee(d){const _={};for(const y in d)_[y]=d[y];return _}const Pe="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ze(d,_){let y,R;for(let $=1;$<arguments.length;$++){R=arguments[$];for(y in R)d[y]=R[y];for(let H=0;H<Pe.length;H++)y=Pe[H],Object.prototype.hasOwnProperty.call(R,y)&&(d[y]=R[y])}}function je(d){this.src=d,this.g={},this.h=0}je.prototype.add=function(d,_,y,R,$){const H=d.toString();d=this.g[H],d||(d=this.g[H]=[],this.h++);const ie=ut(d,_,R,$);return ie>-1?(_=d[ie],y||(_.fa=!1)):(_=new Te(_,this.src,H,!!R,$),_.fa=y,d.push(_)),_};function Mt(d,_){const y=_.type;if(y in d.g){var R=d.g[y],$=Array.prototype.indexOf.call(R,_,void 0),H;(H=$>=0)&&Array.prototype.splice.call(R,$,1),H&&(te(_),d.g[y].length==0&&(delete d.g[y],d.h--))}}function ut(d,_,y,R){for(let $=0;$<d.length;++$){const H=d[$];if(!H.da&&H.listener==_&&H.capture==!!y&&H.ha==R)return $}return-1}var fe="closure_lm_"+(Math.random()*1e6|0),en={};function _n(d,_,y,R,$){if(Array.isArray(_)){for(let H=0;H<_.length;H++)_n(d,_[H],y,R,$);return null}return y=ct(y),d&&d[Fe]?d.J(_,y,a(R)?!!R.capture:!1,$):Nn(d,_,y,!1,R,$)}function Nn(d,_,y,R,$,H){if(!_)throw Error("Invalid event type");const ie=a($)?!!$.capture:!!$;let ke=Ct(d);if(ke||(d[fe]=ke=new je(d)),y=ke.add(_,y,R,ie,H),y.proxy)return y;if(R=ar(),y.proxy=R,R.src=d,R.listener=y,d.addEventListener)L||($=ie),$===void 0&&($=!1),d.addEventListener(_.toString(),R,$);else if(d.attachEvent)d.attachEvent(Cr(_.toString()),R);else if(d.addListener&&d.removeListener)d.addListener(R);else throw Error("addEventListener and attachEvent are unavailable.");return y}function ar(){function d(y){return _.call(d.src,d.listener,y)}const _=Me;return d}function lr(d,_,y,R,$){if(Array.isArray(_))for(var H=0;H<_.length;H++)lr(d,_[H],y,R,$);else R=a(R)?!!R.capture:!!R,y=ct(y),d&&d[Fe]?(d=d.i,H=String(_).toString(),H in d.g&&(_=d.g[H],y=ut(_,y,R,$),y>-1&&(te(_[y]),Array.prototype.splice.call(_,y,1),_.length==0&&(delete d.g[H],d.h--)))):d&&(d=Ct(d))&&(_=d.g[_.toString()],d=-1,_&&(d=ut(_,y,R,$)),(y=d>-1?_[d]:null)&&cn(y))}function cn(d){if(typeof d!="number"&&d&&!d.da){var _=d.src;if(_&&_[Fe])Mt(_.i,d);else{var y=d.type,R=d.proxy;_.removeEventListener?_.removeEventListener(y,R,d.capture):_.detachEvent?_.detachEvent(Cr(y),R):_.addListener&&_.removeListener&&_.removeListener(R),(y=Ct(_))?(Mt(y,d),y.h==0&&(y.src=null,_[fe]=null)):te(d)}}}function Cr(d){return d in en?en[d]:en[d]="on"+d}function Me(d,_){if(d.da)d=!0;else{_=new De(_,this);const y=d.listener,R=d.ha||d.src;d.fa&&cn(d),d=y.call(R,_)}return d}function Ct(d){return d=d[fe],d instanceof je?d:null}var qe="__closure_events_fn_"+(Math.random()*1e9>>>0);function ct(d){return typeof d=="function"?d:(d[qe]||(d[qe]=function(_){return d.handleEvent(_)}),d[qe])}function ae(){k.call(this),this.i=new je(this),this.M=this,this.G=null}m(ae,k),ae.prototype[Fe]=!0,ae.prototype.removeEventListener=function(d,_,y,R){lr(this,d,_,y,R)};function Vt(d,_){var y,R=d.G;if(R)for(y=[];R;R=R.G)y.push(R);if(d=d.M,R=_.type||_,typeof _=="string")_=new b(_,d);else if(_ instanceof b)_.target=_.target||d;else{var $=_;_=new b(R,d),ze(_,$)}$=!0;let H,ie;if(y)for(ie=y.length-1;ie>=0;ie--)H=_.g=y[ie],$=ti(H,R,!0,_)&&$;if(H=_.g=d,$=ti(H,R,!0,_)&&$,$=ti(H,R,!1,_)&&$,y)for(ie=0;ie<y.length;ie++)H=_.g=y[ie],$=ti(H,R,!1,_)&&$}ae.prototype.N=function(){if(ae.Z.N.call(this),this.i){var d=this.i;for(const _ in d.g){const y=d.g[_];for(let R=0;R<y.length;R++)te(y[R]);delete d.g[_],d.h--}}this.G=null},ae.prototype.J=function(d,_,y,R){return this.i.add(String(d),_,!1,y,R)},ae.prototype.K=function(d,_,y,R){return this.i.add(String(d),_,!0,y,R)};function ti(d,_,y,R){if(_=d.i.g[String(_)],!_)return!0;_=_.concat();let $=!0;for(let H=0;H<_.length;++H){const ie=_[H];if(ie&&!ie.da&&ie.capture==y){const ke=ie.listener,At=ie.ha||ie.src;ie.fa&&Mt(d.i,ie),$=ke.call(At,R)!==!1&&$}}return $&&!R.defaultPrevented}function rs(d,_){if(typeof d!="function")if(d&&typeof d.handleEvent=="function")d=u(d.handleEvent,d);else throw Error("Invalid listener argument");return Number(_)>2147483647?-1:o.setTimeout(d,_||0)}function is(d){d.g=rs(()=>{d.g=null,d.i&&(d.i=!1,is(d))},d.l);const _=d.h;d.h=null,d.m.apply(null,_)}class lo extends k{constructor(_,y){super(),this.m=_,this.l=y,this.h=null,this.i=!1,this.g=null}j(_){this.h=arguments,this.g?this.i=!0:is(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function xe(d){k.call(this),this.h=d,this.g={}}m(xe,k);var tc=[];function Ar(d){ce(d.g,function(_,y){this.g.hasOwnProperty(y)&&cn(_)},d),d.g={}}xe.prototype.N=function(){xe.Z.N.call(this),Ar(this)},xe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ss=o.JSON.stringify,Oa=o.JSON.parse,nc=class{stringify(d){return o.JSON.stringify(d,void 0)}parse(d){return o.JSON.parse(d,void 0)}};function Ba(){}function rc(){}var os={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function qa(){b.call(this,"d")}m(qa,b);function as(){b.call(this,"c")}m(as,b);var yn={},ls=null;function uo(){return ls=ls||new ae}yn.Ia="serverreachability";function Ga(d){b.call(this,yn.Ia,d)}m(Ga,b);function Dn(d){const _=uo();Vt(_,new Ga(_))}yn.STAT_EVENT="statevent";function us(d,_){b.call(this,yn.STAT_EVENT,d),this.stat=_}m(us,b);function _t(d){const _=uo();Vt(_,new us(_,d))}yn.Ja="timingevent";function ic(d,_){b.call(this,yn.Ja,d),this.size=_}m(ic,b);function ur(d,_){if(typeof d!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){d()},_)}function cs(){this.g=!0}cs.prototype.ua=function(){this.g=!1};function J(d,_,y,R,$,H){d.info(function(){if(d.g)if(H){var ie="",ke=H.split("&");for(let Ze=0;Ze<ke.length;Ze++){var At=ke[Ze].split("=");if(At.length>1){const Lt=At[0];At=At[1];const dr=Lt.split("_");ie=dr.length>=2&&dr[1]=="type"?ie+(Lt+"="+At+"&"):ie+(Lt+"=redacted&")}}}else ie=null;else ie=H;return"XMLHTTP REQ ("+R+") [attempt "+$+"]: "+_+`
`+y+`
`+ie})}function $a(d,_,y,R,$,H,ie){d.info(function(){return"XMLHTTP RESP ("+R+") [ attempt "+$+"]: "+_+`
`+y+`
`+H+" "+ie})}function ds(d,_,y,R){d.info(function(){return"XMLHTTP TEXT ("+_+"): "+ay(d,y)+(R?" "+R:"")})}function oy(d,_){d.info(function(){return"TIMEOUT: "+_})}cs.prototype.info=function(){};function ay(d,_){if(!d.g)return _;if(!_)return null;try{const H=JSON.parse(_);if(H){for(d=0;d<H.length;d++)if(Array.isArray(H[d])){var y=H[d];if(!(y.length<2)){var R=y[1];if(Array.isArray(R)&&!(R.length<1)){var $=R[0];if($!="noop"&&$!="stop"&&$!="close")for(let ie=1;ie<R.length;ie++)R[ie]=""}}}}return ss(H)}catch{return _}}var za={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},sc={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},co;function Ha(){}m(Ha,Ba),Ha.prototype.g=function(){return new XMLHttpRequest},co=new Ha;function xr(d){return encodeURIComponent(String(d))}function Wa(d){var _=1;d=d.split(":");const y=[];for(;_>0&&d.length;)y.push(d.shift()),_--;return d.length&&y.push(d.join(":")),y}function Et(d,_,y,R){this.j=d,this.i=_,this.l=y,this.S=R||1,this.V=new xe(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new oc}function oc(){this.i=null,this.g="",this.h=!1}var Ka={},hs={};function ho(d,_,y){d.M=1,d.A=mo(Mn(_)),d.u=y,d.R=!0,ac(d,null)}function ac(d,_){d.F=Date.now(),Rr(d),d.B=Mn(d.A);var y=d.B,R=d.S;Array.isArray(R)||(R=[String(R)]),mc(y.i,"t",R),d.C=0,y=d.j.L,d.h=new oc,d.g=gy(d.j,y?_:null,!d.u),d.P>0&&(d.O=new lo(u(d.Y,d,d.g),d.P)),_=d.V,y=d.g,R=d.ba;var $="readystatechange";Array.isArray($)||($&&(tc[0]=$.toString()),$=tc);for(let H=0;H<$.length;H++){const ie=_n(y,$[H],R||_.handleEvent,!1,_.h||_);if(!ie)break;_.g[ie.key]=ie}_=d.J?Ee(d.J):{},d.u?(d.v||(d.v="POST"),_["Content-Type"]="application/x-www-form-urlencoded",d.g.ea(d.B,d.v,d.u,_)):(d.v="GET",d.g.ea(d.B,d.v,null,_)),Dn(),J(d.i,d.v,d.B,d.l,d.S,d.u)}Et.prototype.ba=function(d){d=d.target;const _=this.O;_&&Ue(d)==3?_.j():this.Y(d)},Et.prototype.Y=function(d){try{if(d==this.g)e:{const ke=Ue(this.g),At=this.g.ya(),Ze=this.g.ca();if(!(ke<3)&&(ke!=3||this.g&&(this.h.h||this.g.la()||it(this.g)))){this.K||ke!=4||At==7||(At==8||Ze<=0?Dn(3):Dn(2)),Ja(this);var _=this.g.ca();this.X=_;var y=ja(this);if(this.o=_==200,$a(this.i,this.v,this.B,this.l,this.S,ke,_),this.o){if(this.U&&!this.L){t:{if(this.g){var R,$=this.g;if((R=$.g?$.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!N(R)){var H=R;break t}}H=null}if(d=H)ds(this.i,this.l,d,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Qa(this,d);else{this.o=!1,this.m=3,_t(12),bn(this),se(this);break e}}if(this.R){d=!0;let Lt;for(;!this.K&&this.C<y.length;)if(Lt=yf(this,y),Lt==hs){ke==4&&(this.m=4,_t(14),d=!1),ds(this.i,this.l,null,"[Incomplete Response]");break}else if(Lt==Ka){this.m=4,_t(15),ds(this.i,this.l,y,"[Invalid Chunk]"),d=!1;break}else ds(this.i,this.l,Lt,null),Qa(this,Lt);if(lc(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ke!=4||y.length!=0||this.h.h||(this.m=1,_t(16),d=!1),this.o=this.o&&d,!d)ds(this.i,this.l,y,"[Invalid Chunked Response]"),bn(this),se(this);else if(y.length>0&&!this.W){this.W=!0;var ie=this.j;ie.g==this&&ie.aa&&!ie.P&&(ie.j.info("Great, no buffering proxy detected. Bytes received: "+y.length),Rf(ie),ie.P=!0,_t(11))}}else ds(this.i,this.l,y,null),Qa(this,y);ke==4&&bn(this),this.o&&!this.K&&(ke==4?hy(this.j,this):(this.o=!1,Rr(this)))}else Wn(this.g),_==400&&y.indexOf("Unknown SID")>0?(this.m=3,_t(12)):(this.m=0,_t(13)),bn(this),se(this)}}}catch{}finally{}};function ja(d){if(!lc(d))return d.g.la();const _=it(d.g);if(_==="")return"";let y="";const R=_.length,$=Ue(d.g)==4;if(!d.h.i){if(typeof TextDecoder>"u")return bn(d),se(d),"";d.h.i=new o.TextDecoder}for(let H=0;H<R;H++)d.h.h=!0,y+=d.h.i.decode(_[H],{stream:!($&&H==R-1)});return _.length=0,d.h.g+=y,d.C=0,d.h.g}function lc(d){return d.g?d.v=="GET"&&d.M!=2&&d.j.Aa:!1}function yf(d,_){var y=d.C,R=_.indexOf(`
`,y);return R==-1?hs:(y=Number(_.substring(y,R)),isNaN(y)?Ka:(R+=1,R+y>_.length?hs:(_=_.slice(R,R+y),d.C=R+y,_)))}Et.prototype.cancel=function(){this.K=!0,bn(this)};function Rr(d){d.T=Date.now()+d.H,fo(d,d.H)}function fo(d,_){if(d.D!=null)throw Error("WatchDog timer not null");d.D=ur(u(d.aa,d),_)}function Ja(d){d.D&&(o.clearTimeout(d.D),d.D=null)}Et.prototype.aa=function(){this.D=null;const d=Date.now();d-this.T>=0?(oy(this.i,this.B),this.M!=2&&(Dn(),_t(17)),bn(this),this.m=2,se(this)):fo(this,this.T-d)};function se(d){d.j.I==0||d.K||hy(d.j,d)}function bn(d){Ja(d);var _=d.O;_&&typeof _.dispose=="function"&&_.dispose(),d.O=null,Ar(d.V),d.g&&(_=d.g,d.g=null,_.abort(),_.dispose())}function Qa(d,_){try{var y=d.j;if(y.I!=0&&(y.g==d||Xa(y.h,d))){if(!d.L&&Xa(y.h,d)&&y.I==3){try{var R=y.Ba.g.parse(_)}catch{R=null}if(Array.isArray(R)&&R.length==3){var $=R;if($[0]==0){e:if(!y.v){if(y.g)if(y.g.F+3e3<d.F)vc(y),il(y);else break e;xf(y),_t(18)}}else y.xa=$[1],0<y.xa-y.K&&$[2]<37500&&y.F&&y.A==0&&!y.C&&(y.C=ur(u(y.Va,y),6e3));po(y.h)<=1&&y.ta&&(y.ta=void 0)}else _s(y,11)}else if((d.L||y.g==d)&&vc(y),!N(_))for($=y.Ba.g.parse(_),_=0;_<$.length;_++){let Ze=$[_];const Lt=Ze[0];if(!(Lt<=y.K))if(y.K=Lt,Ze=Ze[1],y.I==2)if(Ze[0]=="c"){y.M=Ze[1],y.ba=Ze[2];const dr=Ze[3];dr!=null&&(y.ka=dr,y.j.info("VER="+y.ka));const ys=Ze[4];ys!=null&&(y.za=ys,y.j.info("SVER="+y.za));const ai=Ze[5];ai!=null&&typeof ai=="number"&&ai>0&&(R=1.5*ai,y.O=R,y.j.info("backChannelRequestTimeoutMs_="+R)),R=y;const li=d.g;if(li){const Ec=li.g?li.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ec){var H=R.h;H.g||Ec.indexOf("spdy")==-1&&Ec.indexOf("quic")==-1&&Ec.indexOf("h2")==-1||(H.j=H.l,H.g=new Set,H.h&&(Za(H,H.h),H.h=null))}if(R.G){const Pf=li.g?li.g.getResponseHeader("X-HTTP-Session-Id"):null;Pf&&(R.wa=Pf,Xe(R.J,R.G,Pf))}}y.I=3,y.l&&y.l.ra(),y.aa&&(y.T=Date.now()-d.F,y.j.info("Handshake RTT: "+y.T+"ms")),R=y;var ie=d;if(R.na=my(R,R.L?R.ba:null,R.W),ie.L){el(R.h,ie);var ke=ie,At=R.O;At&&(ke.H=At),ke.D&&(Ja(ke),Rr(ke)),R.g=ie}else cy(R);y.i.length>0&&oi(y)}else Ze[0]!="stop"&&Ze[0]!="close"||_s(y,7);else y.I==3&&(Ze[0]=="stop"||Ze[0]=="close"?Ze[0]=="stop"?_s(y,7):gs(y):Ze[0]!="noop"&&y.l&&y.l.qa(Ze),y.A=0)}}Dn(4)}catch{}}var Ya=class{constructor(d,_){this.g=d,this.map=_}};function uc(d){this.l=d||10,o.PerformanceNavigationTiming?(d=o.performance.getEntriesByType("navigation"),d=d.length>0&&(d[0].nextHopProtocol=="hq"||d[0].nextHopProtocol=="h2")):d=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=d?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function ni(d){return d.h?!0:d.g?d.g.size>=d.j:!1}function po(d){return d.h?1:d.g?d.g.size:0}function Xa(d,_){return d.h?d.h==_:d.g?d.g.has(_):!1}function Za(d,_){d.g?d.g.add(_):d.h=_}function el(d,_){d.h&&d.h==_?d.h=null:d.g&&d.g.has(_)&&d.g.delete(_)}uc.prototype.cancel=function(){if(this.i=cc(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const d of this.g.values())d.cancel();this.g.clear()}};function cc(d){if(d.h!=null)return d.i.concat(d.h.G);if(d.g!=null&&d.g.size!==0){let _=d.i;for(const y of d.g.values())_=_.concat(y.G);return _}return v(d.i)}var dc=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function tl(d,_){if(d){d=d.split("&");for(let y=0;y<d.length;y++){const R=d[y].indexOf("=");let $,H=null;R>=0?($=d[y].substring(0,R),H=d[y].substring(R+1)):$=d[y],_($,H?decodeURIComponent(H.replace(/\+/g," ")):"")}}}function cr(d){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let _;d instanceof cr?(this.l=d.l,ri(this,d.j),this.o=d.o,this.g=d.g,ii(this,d.u),this.h=d.h,nl(this,gc(d.i)),this.m=d.m):d&&(_=String(d).match(dc))?(this.l=!1,ri(this,_[1]||"",!0),this.o=fs(_[2]||""),this.g=fs(_[3]||"",!0),ii(this,_[4]),this.h=fs(_[5]||"",!0),nl(this,_[6]||"",!0),this.m=fs(_[7]||"")):(this.l=!1,this.i=new ms(null,this.l))}cr.prototype.toString=function(){const d=[];var _=this.j;_&&d.push(ps(_,hc,!0),":");var y=this.g;return(y||_=="file")&&(d.push("//"),(_=this.o)&&d.push(ps(_,hc,!0),"@"),d.push(xr(y).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y=this.u,y!=null&&d.push(":",String(y))),(y=this.h)&&(this.g&&y.charAt(0)!="/"&&d.push("/"),d.push(ps(y,y.charAt(0)=="/"?Ef:Tf,!0))),(y=this.i.toString())&&d.push("?",y),(y=this.m)&&d.push("#",ps(y,If)),d.join("")},cr.prototype.resolve=function(d){const _=Mn(this);let y=!!d.j;y?ri(_,d.j):y=!!d.o,y?_.o=d.o:y=!!d.g,y?_.g=d.g:y=d.u!=null;var R=d.h;if(y)ii(_,d.u);else if(y=!!d.h){if(R.charAt(0)!="/")if(this.g&&!this.h)R="/"+R;else{var $=_.h.lastIndexOf("/");$!=-1&&(R=_.h.slice(0,$+1)+R)}if($=R,$==".."||$==".")R="";else if($.indexOf("./")!=-1||$.indexOf("/.")!=-1){R=$.lastIndexOf("/",0)==0,$=$.split("/");const H=[];for(let ie=0;ie<$.length;){const ke=$[ie++];ke=="."?R&&ie==$.length&&H.push(""):ke==".."?((H.length>1||H.length==1&&H[0]!="")&&H.pop(),R&&ie==$.length&&H.push("")):(H.push(ke),R=!0)}R=H.join("/")}else R=$}return y?_.h=R:y=d.i.toString()!=="",y?nl(_,gc(d.i)):y=!!d.m,y&&(_.m=d.m),_};function Mn(d){return new cr(d)}function ri(d,_,y){d.j=y?fs(_,!0):_,d.j&&(d.j=d.j.replace(/:$/,""))}function ii(d,_){if(_){if(_=Number(_),isNaN(_)||_<0)throw Error("Bad port number "+_);d.u=_}else d.u=null}function nl(d,_,y){_ instanceof ms?(d.i=_,Sf(d.i,d.l)):(y||(_=ps(_,wf)),d.i=new ms(_,d.l))}function Xe(d,_,y){d.i.set(_,y)}function mo(d){return Xe(d,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),d}function fs(d,_){return d?_?decodeURI(d.replace(/%25/g,"%2525")):decodeURIComponent(d):""}function ps(d,_,y){return typeof d=="string"?(d=encodeURI(d).replace(_,vf),y&&(d=d.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d):null}function vf(d){return d=d.charCodeAt(0),"%"+(d>>4&15).toString(16)+(d&15).toString(16)}var hc=/[#\/\?@]/g,Tf=/[#\?:]/g,Ef=/[#\?]/g,wf=/[#\?@]/g,If=/#/g;function ms(d,_){this.h=this.g=null,this.i=d||null,this.j=!!_}function Pr(d){d.g||(d.g=new Map,d.h=0,d.i&&tl(d.i,function(_,y){d.add(decodeURIComponent(_.replace(/\+/g," ")),y)}))}t=ms.prototype,t.add=function(d,_){Pr(this),this.i=null,d=si(this,d);let y=this.g.get(d);return y||this.g.set(d,y=[]),y.push(_),this.h+=1,this};function fc(d,_){Pr(d),_=si(d,_),d.g.has(_)&&(d.i=null,d.h-=d.g.get(_).length,d.g.delete(_))}function rl(d,_){return Pr(d),_=si(d,_),d.g.has(_)}t.forEach=function(d,_){Pr(this),this.g.forEach(function(y,R){y.forEach(function($){d.call(_,$,R,this)},this)},this)};function pc(d,_){Pr(d);let y=[];if(typeof _=="string")rl(d,_)&&(y=y.concat(d.g.get(si(d,_))));else for(d=Array.from(d.g.values()),_=0;_<d.length;_++)y=y.concat(d[_]);return y}t.set=function(d,_){return Pr(this),this.i=null,d=si(this,d),rl(this,d)&&(this.h-=this.g.get(d).length),this.g.set(d,[_]),this.h+=1,this},t.get=function(d,_){return d?(d=pc(this,d),d.length>0?String(d[0]):_):_};function mc(d,_,y){fc(d,_),y.length>0&&(d.i=null,d.g.set(si(d,_),v(y)),d.h+=y.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const d=[],_=Array.from(this.g.keys());for(let R=0;R<_.length;R++){var y=_[R];const $=xr(y);y=pc(this,y);for(let H=0;H<y.length;H++){let ie=$;y[H]!==""&&(ie+="="+xr(y[H])),d.push(ie)}}return this.i=d.join("&")};function gc(d){const _=new ms;return _.i=d.i,d.g&&(_.g=new Map(d.g),_.h=d.h),_}function si(d,_){return _=String(_),d.j&&(_=_.toLowerCase()),_}function Sf(d,_){_&&!d.j&&(Pr(d),d.i=null,d.g.forEach(function(y,R){const $=R.toLowerCase();R!=$&&(fc(this,R),mc(this,$,y))},d)),d.j=_}function Cf(d,_){const y=new cs;if(o.Image){const R=new Image;R.onload=f(S,y,"TestLoadImage: loaded",!0,_,R),R.onerror=f(S,y,"TestLoadImage: error",!1,_,R),R.onabort=f(S,y,"TestLoadImage: abort",!1,_,R),R.ontimeout=f(S,y,"TestLoadImage: timeout",!1,_,R),o.setTimeout(function(){R.ontimeout&&R.ontimeout()},1e4),R.src=d}else _(!1)}function Af(d,_){const y=new cs,R=new AbortController,$=setTimeout(()=>{R.abort(),S(y,"TestPingServer: timeout",!1,_)},1e4);fetch(d,{signal:R.signal}).then(H=>{clearTimeout($),H.ok?S(y,"TestPingServer: ok",!0,_):S(y,"TestPingServer: server error",!1,_)}).catch(()=>{clearTimeout($),S(y,"TestPingServer: error",!1,_)})}function S(d,_,y,R,$){try{$&&($.onload=null,$.onerror=null,$.onabort=null,$.ontimeout=null),R(y)}catch{}}function M(){this.g=new nc}function U(d){this.i=d.Sb||null,this.h=d.ab||!1}m(U,Ba),U.prototype.g=function(){return new q(this.i,this.h)};function q(d,_){ae.call(this),this.H=d,this.o=_,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}m(q,ae),t=q.prototype,t.open=function(d,_){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=d,this.D=_,this.readyState=1,W(this)},t.send=function(d){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const _={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};d&&(_.body=d),(this.H||o).fetch(new Request(this.D,_)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,K(this)),this.readyState=0},t.Pa=function(d){if(this.g&&(this.l=d,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=d.headers,this.readyState=2,W(this)),this.g&&(this.readyState=3,W(this),this.g)))if(this.responseType==="arraybuffer")d.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in d){if(this.j=d.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;F(this)}else d.text().then(this.Oa.bind(this),this.ga.bind(this))};function F(d){d.j.read().then(d.Ma.bind(d)).catch(d.ga.bind(d))}t.Ma=function(d){if(this.g){if(this.o&&d.value)this.response.push(d.value);else if(!this.o){var _=d.value?d.value:new Uint8Array(0);(_=this.B.decode(_,{stream:!d.done}))&&(this.response=this.responseText+=_)}d.done?K(this):W(this),this.readyState==3&&F(this)}},t.Oa=function(d){this.g&&(this.response=this.responseText=d,K(this))},t.Na=function(d){this.g&&(this.response=d,K(this))},t.ga=function(){this.g&&K(this)};function K(d){d.readyState=4,d.l=null,d.j=null,d.B=null,W(d)}t.setRequestHeader=function(d,_){this.A.append(d,_)},t.getResponseHeader=function(d){return this.h&&this.h.get(d.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const d=[],_=this.h.entries();for(var y=_.next();!y.done;)y=y.value,d.push(y[0]+": "+y[1]),y=_.next();return d.join(`\r
`)};function W(d){d.onreadystatechange&&d.onreadystatechange.call(d)}Object.defineProperty(q.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(d){this.m=d?"include":"same-origin"}});function Y(d){let _="";return ce(d,function(y,R){_+=R,_+=":",_+=y,_+=`\r
`}),_}function ne(d,_,y){e:{for(R in y){var R=!1;break e}R=!0}R||(y=Y(y),typeof d=="string"?y!=null&&xr(y):Xe(d,_,y))}function X(d){ae.call(this),this.headers=new Map,this.L=d||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}m(X,ae);var Q=/^https?$/i,le=["POST","PUT"];t=X.prototype,t.Fa=function(d){this.H=d},t.ea=function(d,_,y,R){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+d);_=_?_.toUpperCase():"GET",this.D=d,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():co.g(),this.g.onreadystatechange=g(u(this.Ca,this));try{this.B=!0,this.g.open(_,String(d),!0),this.B=!1}catch(H){we(this,H);return}if(d=y||"",y=new Map(this.headers),R)if(Object.getPrototypeOf(R)===Object.prototype)for(var $ in R)y.set($,R[$]);else if(typeof R.keys=="function"&&typeof R.get=="function")for(const H of R.keys())y.set(H,R.get(H));else throw Error("Unknown input type for opt_headers: "+String(R));R=Array.from(y.keys()).find(H=>H.toLowerCase()=="content-type"),$=o.FormData&&d instanceof o.FormData,!(Array.prototype.indexOf.call(le,_,void 0)>=0)||R||$||y.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[H,ie]of y)this.g.setRequestHeader(H,ie);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(d),this.v=!1}catch(H){we(this,H)}};function we(d,_){d.h=!1,d.g&&(d.j=!0,d.g.abort(),d.j=!1),d.l=_,d.o=5,ge(d),Re(d)}function ge(d){d.A||(d.A=!0,Vt(d,"complete"),Vt(d,"error"))}t.abort=function(d){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=d||7,Vt(this,"complete"),Vt(this,"abort"),Re(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Re(this,!0)),X.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?_e(this):this.Xa())},t.Xa=function(){_e(this)};function _e(d){if(d.h&&typeof s<"u"){if(d.v&&Ue(d)==4)setTimeout(d.Ca.bind(d),0);else if(Vt(d,"readystatechange"),Ue(d)==4){d.h=!1;try{const H=d.ca();e:switch(H){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var _=!0;break e;default:_=!1}var y;if(!(y=_)){var R;if(R=H===0){let ie=String(d.D).match(dc)[1]||null;!ie&&o.self&&o.self.location&&(ie=o.self.location.protocol.slice(0,-1)),R=!Q.test(ie?ie.toLowerCase():"")}y=R}if(y)Vt(d,"complete"),Vt(d,"success");else{d.o=6;try{var $=Ue(d)>2?d.g.statusText:""}catch{$=""}d.l=$+" ["+d.ca()+"]",ge(d)}}finally{Re(d)}}}}function Re(d,_){if(d.g){d.m&&(clearTimeout(d.m),d.m=null);const y=d.g;d.g=null,_||Vt(d,"ready");try{y.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function Ue(d){return d.g?d.g.readyState:0}t.ca=function(){try{return Ue(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(d){if(this.g){var _=this.g.responseText;return d&&_.indexOf(d)==0&&(_=_.substring(d.length)),Oa(_)}};function it(d){try{if(!d.g)return null;if("response"in d.g)return d.g.response;switch(d.F){case"":case"text":return d.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in d.g)return d.g.mozResponseArrayBuffer}return null}catch{return null}}function Wn(d){const _={};d=(d.g&&Ue(d)>=2&&d.g.getAllResponseHeaders()||"").split(`\r
`);for(let R=0;R<d.length;R++){if(N(d[R]))continue;var y=Wa(d[R]);const $=y[0];if(y=y[1],typeof y!="string")continue;y=y.trim();const H=_[$]||[];_[$]=H,H.push(y)}me(_,function(R){return R.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Vn(d,_,y){return y&&y.internalChannelParams&&y.internalChannelParams[d]||_}function _c(d){this.za=0,this.i=[],this.j=new cs,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Vn("failFast",!1,d),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Vn("baseRetryDelayMs",5e3,d),this.Za=Vn("retryDelaySeedMs",1e4,d),this.Ta=Vn("forwardChannelMaxRetries",2,d),this.va=Vn("forwardChannelRequestTimeoutMs",2e4,d),this.ma=d&&d.xmlHttpFactory||void 0,this.Ua=d&&d.Rb||void 0,this.Aa=d&&d.useFetchStreams||!1,this.O=void 0,this.L=d&&d.supportsCrossDomainXhr||!1,this.M="",this.h=new uc(d&&d.concurrentRequestLimit),this.Ba=new M,this.S=d&&d.fastHandshake||!1,this.R=d&&d.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=d&&d.Pb||!1,d&&d.ua&&this.j.ua(),d&&d.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&d&&d.detectBufferingProxy||!1,this.ia=void 0,d&&d.longPollingTimeout&&d.longPollingTimeout>0&&(this.ia=d.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=_c.prototype,t.ka=8,t.I=1,t.connect=function(d,_,y,R){_t(0),this.W=d,this.H=_||{},y&&R!==void 0&&(this.H.OSID=y,this.H.OAID=R),this.F=this.X,this.J=my(this,null,this.W),oi(this)};function gs(d){if(kr(d),d.I==3){var _=d.V++,y=Mn(d.J);if(Xe(y,"SID",d.M),Xe(y,"RID",_),Xe(y,"TYPE","terminate"),sl(d,y),_=new Et(d,d.j,_),_.M=2,_.A=mo(Mn(y)),y=!1,o.navigator&&o.navigator.sendBeacon)try{y=o.navigator.sendBeacon(_.A.toString(),"")}catch{}!y&&o.Image&&(new Image().src=_.A,y=!0),y||(_.g=gy(_.j,null),_.g.ea(_.A)),_.F=Date.now(),Rr(_)}py(d)}function il(d){d.g&&(Rf(d),d.g.cancel(),d.g=null)}function kr(d){il(d),d.v&&(o.clearTimeout(d.v),d.v=null),vc(d),d.h.cancel(),d.m&&(typeof d.m=="number"&&o.clearTimeout(d.m),d.m=null)}function oi(d){if(!ni(d.h)&&!d.m){d.m=!0;var _=d.Ea;O||I(),B||(O(),B=!0),E.add(_,d),d.D=0}}function yc(d,_){return po(d.h)>=d.h.j-(d.m?1:0)?!1:d.m?(d.i=_.G.concat(d.i),!0):d.I==1||d.I==2||d.D>=(d.Sa?0:d.Ta)?!1:(d.m=ur(u(d.Ea,d,_),fy(d,d.D)),d.D++,!0)}t.Ea=function(d){if(this.m)if(this.m=null,this.I==1){if(!d){this.V=Math.floor(Math.random()*1e5),d=this.V++;const $=new Et(this,this.j,d);let H=this.o;if(this.U&&(H?(H=Ee(H),ze(H,this.U)):H=this.U),this.u!==null||this.R||($.J=H,H=null),this.S)e:{for(var _=0,y=0;y<this.i.length;y++){t:{var R=this.i[y];if("__data__"in R.map&&(R=R.map.__data__,typeof R=="string")){R=R.length;break t}R=void 0}if(R===void 0)break;if(_+=R,_>4096){_=y;break e}if(_===4096||y===this.i.length-1){_=y+1;break e}}_=1e3}else _=1e3;_=uy(this,$,_),y=Mn(this.J),Xe(y,"RID",d),Xe(y,"CVER",22),this.G&&Xe(y,"X-HTTP-Session-Id",this.G),sl(this,y),H&&(this.R?_="headers="+xr(Y(H))+"&"+_:this.u&&ne(y,this.u,H)),Za(this.h,$),this.Ra&&Xe(y,"TYPE","init"),this.S?(Xe(y,"$req",_),Xe(y,"SID","null"),$.U=!0,ho($,y,null)):ho($,y,_),this.I=2}}else this.I==3&&(d?ly(this,d):this.i.length==0||ni(this.h)||ly(this))};function ly(d,_){var y;_?y=_.l:y=d.V++;const R=Mn(d.J);Xe(R,"SID",d.M),Xe(R,"RID",y),Xe(R,"AID",d.K),sl(d,R),d.u&&d.o&&ne(R,d.u,d.o),y=new Et(d,d.j,y,d.D+1),d.u===null&&(y.J=d.o),_&&(d.i=_.G.concat(d.i)),_=uy(d,y,1e3),y.H=Math.round(d.va*.5)+Math.round(d.va*.5*Math.random()),Za(d.h,y),ho(y,R,_)}function sl(d,_){d.H&&ce(d.H,function(y,R){Xe(_,R,y)}),d.l&&ce({},function(y,R){Xe(_,R,y)})}function uy(d,_,y){y=Math.min(d.i.length,y);const R=d.l?u(d.l.Ka,d.l,d):null;e:{var $=d.i;let ke=-1;for(;;){const At=["count="+y];ke==-1?y>0?(ke=$[0].g,At.push("ofs="+ke)):ke=0:At.push("ofs="+ke);let Ze=!0;for(let Lt=0;Lt<y;Lt++){var H=$[Lt].g;const dr=$[Lt].map;if(H-=ke,H<0)ke=Math.max(0,$[Lt].g-100),Ze=!1;else try{H="req"+H+"_"||"";try{var ie=dr instanceof Map?dr:Object.entries(dr);for(const[ys,ai]of ie){let li=ai;a(ai)&&(li=ss(ai)),At.push(H+ys+"="+encodeURIComponent(li))}}catch(ys){throw At.push(H+"type="+encodeURIComponent("_badmap")),ys}}catch{R&&R(dr)}}if(Ze){ie=At.join("&");break e}}ie=void 0}return d=d.i.splice(0,y),_.G=d,ie}function cy(d){if(!d.g&&!d.v){d.Y=1;var _=d.Da;O||I(),B||(O(),B=!0),E.add(_,d),d.A=0}}function xf(d){return d.g||d.v||d.A>=3?!1:(d.Y++,d.v=ur(u(d.Da,d),fy(d,d.A)),d.A++,!0)}t.Da=function(){if(this.v=null,dy(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var d=4*this.T;this.j.info("BP detection timer enabled: "+d),this.B=ur(u(this.Wa,this),d)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,_t(10),il(this),dy(this))};function Rf(d){d.B!=null&&(o.clearTimeout(d.B),d.B=null)}function dy(d){d.g=new Et(d,d.j,"rpc",d.Y),d.u===null&&(d.g.J=d.o),d.g.P=0;var _=Mn(d.na);Xe(_,"RID","rpc"),Xe(_,"SID",d.M),Xe(_,"AID",d.K),Xe(_,"CI",d.F?"0":"1"),!d.F&&d.ia&&Xe(_,"TO",d.ia),Xe(_,"TYPE","xmlhttp"),sl(d,_),d.u&&d.o&&ne(_,d.u,d.o),d.O&&(d.g.H=d.O);var y=d.g;d=d.ba,y.M=1,y.A=mo(Mn(_)),y.u=null,y.R=!0,ac(y,d)}t.Va=function(){this.C!=null&&(this.C=null,il(this),xf(this),_t(19))};function vc(d){d.C!=null&&(o.clearTimeout(d.C),d.C=null)}function hy(d,_){var y=null;if(d.g==_){vc(d),Rf(d),d.g=null;var R=2}else if(Xa(d.h,_))y=_.G,el(d.h,_),R=1;else return;if(d.I!=0){if(_.o)if(R==1){y=_.u?_.u.length:0,_=Date.now()-_.F;var $=d.D;R=uo(),Vt(R,new ic(R,y)),oi(d)}else cy(d);else if($=_.m,$==3||$==0&&_.X>0||!(R==1&&yc(d,_)||R==2&&xf(d)))switch(y&&y.length>0&&(_=d.h,_.i=_.i.concat(y)),$){case 1:_s(d,5);break;case 4:_s(d,10);break;case 3:_s(d,6);break;default:_s(d,2)}}}function fy(d,_){let y=d.Qa+Math.floor(Math.random()*d.Za);return d.isActive()||(y*=2),y*_}function _s(d,_){if(d.j.info("Error code "+_),_==2){var y=u(d.bb,d),R=d.Ua;const $=!R;R=new cr(R||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||ri(R,"https"),mo(R),$?Cf(R.toString(),y):Af(R.toString(),y)}else _t(2);d.I=0,d.l&&d.l.pa(_),py(d),kr(d)}t.bb=function(d){d?(this.j.info("Successfully pinged google.com"),_t(2)):(this.j.info("Failed to ping google.com"),_t(1))};function py(d){if(d.I=0,d.ja=[],d.l){const _=cc(d.h);(_.length!=0||d.i.length!=0)&&(T(d.ja,_),T(d.ja,d.i),d.h.i.length=0,v(d.i),d.i.length=0),d.l.oa()}}function my(d,_,y){var R=y instanceof cr?Mn(y):new cr(y);if(R.g!="")_&&(R.g=_+"."+R.g),ii(R,R.u);else{var $=o.location;R=$.protocol,_=_?_+"."+$.hostname:$.hostname,$=+$.port;const H=new cr(null);R&&ri(H,R),_&&(H.g=_),$&&ii(H,$),y&&(H.h=y),R=H}return y=d.G,_=d.wa,y&&_&&Xe(R,y,_),Xe(R,"VER",d.ka),sl(d,R),R}function gy(d,_,y){if(_&&!d.L)throw Error("Can't create secondary domain capable XhrIo object.");return _=d.Aa&&!d.ma?new X(new U({ab:y})):new X(d.ma),_.Fa(d.L),_}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function _y(){}t=_y.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function Tc(){}Tc.prototype.g=function(d,_){return new vn(d,_)};function vn(d,_){ae.call(this),this.g=new _c(_),this.l=d,this.h=_&&_.messageUrlParams||null,d=_&&_.messageHeaders||null,_&&_.clientProtocolHeaderRequired&&(d?d["X-Client-Protocol"]="webchannel":d={"X-Client-Protocol":"webchannel"}),this.g.o=d,d=_&&_.initMessageHeaders||null,_&&_.messageContentType&&(d?d["X-WebChannel-Content-Type"]=_.messageContentType:d={"X-WebChannel-Content-Type":_.messageContentType}),_&&_.sa&&(d?d["X-WebChannel-Client-Profile"]=_.sa:d={"X-WebChannel-Client-Profile":_.sa}),this.g.U=d,(d=_&&_.Qb)&&!N(d)&&(this.g.u=d),this.A=_&&_.supportsCrossDomainXhr||!1,this.v=_&&_.sendRawJson||!1,(_=_&&_.httpSessionIdParam)&&!N(_)&&(this.g.G=_,d=this.h,d!==null&&_ in d&&(d=this.h,_ in d&&delete d[_])),this.j=new go(this)}m(vn,ae),vn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},vn.prototype.close=function(){gs(this.g)},vn.prototype.o=function(d){var _=this.g;if(typeof d=="string"){var y={};y.__data__=d,d=y}else this.v&&(y={},y.__data__=ss(d),d=y);_.i.push(new Ya(_.Ya++,d)),_.I==3&&oi(_)},vn.prototype.N=function(){this.g.l=null,delete this.j,gs(this.g),delete this.g,vn.Z.N.call(this)};function yy(d){qa.call(this),d.__headers__&&(this.headers=d.__headers__,this.statusCode=d.__status__,delete d.__headers__,delete d.__status__);var _=d.__sm__;if(_){e:{for(const y in _){d=y;break e}d=void 0}(this.i=d)&&(d=this.i,_=_!==null&&d in _?_[d]:void 0),this.data=_}else this.data=d}m(yy,qa);function vy(){as.call(this),this.status=1}m(vy,as);function go(d){this.g=d}m(go,_y),go.prototype.ra=function(){Vt(this.g,"a")},go.prototype.qa=function(d){Vt(this.g,new yy(d))},go.prototype.pa=function(d){Vt(this.g,new vy)},go.prototype.oa=function(){Vt(this.g,"b")},Tc.prototype.createWebChannel=Tc.prototype.g,vn.prototype.send=vn.prototype.o,vn.prototype.open=vn.prototype.m,vn.prototype.close=vn.prototype.close,hS=function(){return new Tc},dS=function(){return uo()},cS=yn,Cp={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},za.NO_ERROR=0,za.TIMEOUT=8,za.HTTP_ERROR=6,Zc=za,sc.COMPLETE="complete",uS=sc,rc.EventType=os,os.OPEN="a",os.CLOSE="b",os.ERROR="c",os.MESSAGE="d",ae.prototype.listen=ae.prototype.J,Tl=rc,X.prototype.listenOnce=X.prototype.K,X.prototype.getLastError=X.prototype.Ha,X.prototype.getLastErrorCode=X.prototype.ya,X.prototype.getStatus=X.prototype.ca,X.prototype.getResponseJson=X.prototype.La,X.prototype.getResponseText=X.prototype.la,X.prototype.send=X.prototype.ea,X.prototype.setWithCredentials=X.prototype.Fa,lS=X}).apply(typeof Sc<"u"?Sc:typeof self<"u"?self:typeof window<"u"?window:{});const Zy="@firebase/firestore",ev="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}qt.UNAUTHENTICATED=new qt(null),qt.GOOGLE_CREDENTIALS=new qt("google-credentials-uid"),qt.FIRST_PARTY=new qt("first-party-uid"),qt.MOCK_USER=new qt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ka="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qi=new og("@firebase/firestore");function So(){return qi.logLevel}function fS(t){qi.setLogLevel(t)}function Z(t,...e){if(qi.logLevel<=Ve.DEBUG){const n=e.map(vg);qi.debug(`Firestore (${ka}): ${t}`,...n)}}function nn(t,...e){if(qi.logLevel<=Ve.ERROR){const n=e.map(vg);qi.error(`Firestore (${ka}): ${t}`,...n)}}function Gi(t,...e){if(qi.logLevel<=Ve.WARN){const n=e.map(vg);qi.warn(`Firestore (${ka}): ${t}`,...n)}}function vg(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function he(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,pS(t,r,n)}function pS(t,e,n){let r=`FIRESTORE (${ka}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw nn(r),new Error(r)}function pe(t,e,n,r){let i="Unexpected state";typeof n=="string"?i=n:r=n,t||pS(e,i,r)}function Ae(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class re extends Qr{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vr{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mS{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class gS{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(qt.UNAUTHENTICATED))}shutdown(){}}class cN{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class dN{constructor(e){this.t=e,this.currentUser=qt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){pe(this.o===void 0,42304);let r=this.i;const i=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let s=new vr;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new vr,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},a=l=>{Z("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(Z("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new vr)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(Z("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(pe(typeof r.accessToken=="string",31837,{l:r}),new mS(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return pe(e===null||typeof e=="string",2055,{h:e}),new qt(e)}}class hN{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=qt.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class fN{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new hN(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(qt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class tv{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class pN{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Xn(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){pe(this.o===void 0,3512);const r=s=>{s.error!=null&&Z("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,Z("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{Z("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):Z("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new tv(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(pe(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new tv(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mN(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rh{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=mN(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%62))}return r}}function Ce(t,e){return t<e?-1:t>e?1:0}function Ap(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const i=t.charAt(r),s=e.charAt(r);if(i!==s)return Uf(i)===Uf(s)?Ce(i,s):Uf(i)?1:-1}return Ce(t.length,e.length)}const gN=55296,_N=57343;function Uf(t){const e=t.charCodeAt(0);return e>=gN&&e<=_N}function sa(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function _S(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nv="__name__";class pr{constructor(e,n,r){n===void 0?n=0:n>e.length&&he(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&he(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return pr.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof pr?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=pr.compareSegments(e.get(i),n.get(i));if(s!==0)return s}return Ce(e.length,n.length)}static compareSegments(e,n){const r=pr.isNumericId(e),i=pr.isNumericId(n);return r&&!i?-1:!r&&i?1:r&&i?pr.extractNumericId(e).compare(pr.extractNumericId(n)):Ap(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Pi.fromString(e.substring(4,e.length-2))}}class $e extends pr{construct(e,n,r){return new $e(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new re(j.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new $e(n)}static emptyPath(){return new $e([])}}const yN=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class at extends pr{construct(e,n,r){return new at(e,n,r)}static isValidIdentifier(e){return yN.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),at.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===nv}static keyField(){return new at([nv])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new re(j.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new re(j.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new re(j.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new re(j.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new at(n)}static emptyPath(){return new at([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oe{constructor(e){this.path=e}static fromPath(e){return new oe($e.fromString(e))}static fromName(e){return new oe($e.fromString(e).popFirst(5))}static empty(){return new oe($e.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&$e.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return $e.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new oe(new $e(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yS(t,e,n){if(!n)throw new re(j.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function vS(t,e,n,r){if(e===!0&&r===!0)throw new re(j.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function rv(t){if(!oe.isDocumentKey(t))throw new re(j.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function iv(t){if(oe.isDocumentKey(t))throw new re(j.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function TS(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Ph(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":he(12329,{type:typeof t})}function sn(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new re(j.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Ph(t);throw new re(j.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function St(t,e){const n={typeString:t};return e&&(n.value=e),n}function Vu(t,e){if(!TS(t))throw new re(j.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(i&&typeof o!==i){n=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&o!==s.value){n=`Expected '${r}' field to equal '${s.value}'`;break}}if(n)throw new re(j.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sv=-62135596800,ov=1e6;class We{static now(){return We.fromMillis(Date.now())}static fromDate(e){return We.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*ov);return new We(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new re(j.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new re(j.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<sv)throw new re(j.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new re(j.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/ov}_compareTo(e){return this.seconds===e.seconds?Ce(this.nanoseconds,e.nanoseconds):Ce(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:We._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Vu(e,We._jsonSchema))return new We(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-sv;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}We._jsonSchemaVersion="firestore/timestamp/1.0",We._jsonSchema={type:St("string",We._jsonSchemaVersion),seconds:St("number"),nanoseconds:St("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ye{static fromTimestamp(e){return new ye(e)}static min(){return new ye(new We(0,0))}static max(){return new ye(new We(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zl=-1;class Dd{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}}function xp(t){return t.fields.find(e=>e.kind===2)}function ws(t){return t.fields.filter(e=>e.kind!==2)}Dd.UNKNOWN_ID=-1;class ed{constructor(e,n){this.fieldPath=e,this.kind=n}}class eu{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new eu(0,xn.min())}}function vN(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=ye.fromTimestamp(r===1e9?new We(n+1,0):new We(n,r));return new xn(i,oe.empty(),e)}function ES(t){return new xn(t.readTime,t.key,Zl)}class xn{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new xn(ye.min(),oe.empty(),Zl)}static max(){return new xn(ye.max(),oe.empty(),Zl)}}function Tg(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=oe.comparator(t.documentKey,e.documentKey),n!==0?n:Ce(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wS="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class IS{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function no(t){if(t.code!==j.FAILED_PRECONDITION||t.message!==wS)throw t;Z("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&he(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new G((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof G?n:G.resolve(n)}catch(n){return G.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):G.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):G.reject(n)}static resolve(e){return new G((n,r)=>{n(e)})}static reject(e){return new G((n,r)=>{r(e)})}static waitFor(e){return new G((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},l=>r(l))}),o=!0,s===i&&n()})}static or(e){let n=G.resolve(!1);for(const r of e)n=n.next(i=>i?G.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new G((r,i)=>{const s=e.length,o=new Array(s);let a=0;for(let l=0;l<s;l++){const u=l;n(e[u]).next(f=>{o[u]=f,++a,a===s&&r(o)},f=>i(f))}})}static doWhile(e,n){return new G((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wn="SimpleDb";class kh{static open(e,n,r,i){try{return new kh(n,e.transaction(i,r))}catch(s){throw new Nl(n,s)}}constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.S=new vr,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{n.error?this.S.reject(new Nl(e,n.error)):this.S.resolve()},this.transaction.onerror=r=>{const i=Eg(r.target.error);this.S.reject(new Nl(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(Z(wn,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new EN(n)}}class ki{static delete(e){return Z(wn,"Removing database:",e),As(pI().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!II())return!1;if(ki.F())return!0;const e=Nt(),n=ki.M(e),r=0<n&&n<10,i=SS(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)==null?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)==="YES"}static O(e,n){return e.store(n)}static M(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,n,r){this.name=e,this.version=n,this.N=r,this.B=null,ki.M(Nt())===12.2&&nn("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(Z(wn,"Opening database:",this.name),this.db=await new Promise((n,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const o=s.target.result;n(o)},i.onblocked=()=>{r(new Nl(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const o=s.target.error;o.name==="VersionError"?r(new re(j.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new re(j.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Nl(e,o))},i.onupgradeneeded=s=>{Z(wn,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.N.k(o,i.transaction,s.oldVersion,this.version).next(()=>{Z(wn,"Database upgrade to version "+this.version+" complete")})}})),this.q&&(this.db.onversionchange=n=>this.q(n)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,i){const s=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const a=kh.open(this.db,e,s?"readonly":"readwrite",r),l=i(a).next(u=>(a.C(),u)).catch(u=>(a.abort(u),G.reject(u))).toPromise();return l.catch(()=>{}),await a.D,l}catch(a){const l=a,u=l.name!=="FirebaseError"&&o<3;if(Z(wn,"Transaction failed with error:",l.message,"Retrying:",u),this.close(),!u)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function SS(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class TN{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return As(this.U.delete())}}class Nl extends re{constructor(e,n){super(j.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function Qi(t){return t.name==="IndexedDbTransactionError"}class EN{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(Z(wn,"PUT",this.store.name,e,n),r=this.store.put(n,e)):(Z(wn,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),As(r)}add(e){return Z(wn,"ADD",this.store.name,e,e),As(this.store.add(e))}get(e){return As(this.store.get(e)).next(n=>(n===void 0&&(n=null),Z(wn,"GET",this.store.name,e,n),n))}delete(e){return Z(wn,"DELETE",this.store.name,e),As(this.store.delete(e))}count(){return Z(wn,"COUNT",this.store.name),As(this.store.count())}J(e,n){const r=this.options(e,n),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const s=i.getAll(r.range);return new G((o,a)=>{s.onerror=l=>{a(l.target.error)},s.onsuccess=l=>{o(l.target.result)}})}{const s=this.cursor(r),o=[];return this.H(s,(a,l)=>{o.push(l)}).next(()=>o)}}Y(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new G((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}Z(e,n){Z(wn,"DELETE ALL",this.store.name);const r=this.options(e,n);r.X=!1;const i=this.cursor(r);return this.H(i,(s,o,a)=>a.delete())}ee(e,n){let r;n?r=e:(r={},n=e);const i=this.cursor(r);return this.H(i,n)}te(e){const n=this.cursor({});return new G((r,i)=>{n.onerror=s=>{const o=Eg(s.target.error);i(o)},n.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}H(e,n){const r=[];return new G((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void i();const l=new TN(a),u=n(a.primaryKey,a.value,l);if(u instanceof G){const f=u.catch(m=>(l.done(),G.reject(m)));r.push(f)}l.isDone?i():l.G===null?a.continue():a.continue(l.G)}}).next(()=>G.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function As(t){return new G((e,n)=>{t.onsuccess=r=>{const i=r.target.result;e(i)},t.onerror=r=>{const i=Eg(r.target.error);n(i)}})}let av=!1;function Eg(t){const e=ki.M(Nt());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new re("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return av||(av=!0,setTimeout(()=>{throw r},0)),r}}return t}const Dl="IndexBackfiller";class wN{constructor(e,n){this.asyncQueue=e,this.ne=n,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){Z(Dl,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const n=await this.ne.ie();Z(Dl,`Documents written: ${n}`)}catch(n){Qi(n)?Z(Dl,"Ignoring IndexedDB error during index backfill: ",n):await no(n)}await this.re(6e4)})}}class IN{constructor(e,n){this.localStore=e,this.persistence=n}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.se(n,e))}se(e,n){const r=new Set;let i=n,s=!0;return G.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return Z(Dl,`Processing collection: ${o}`),this.oe(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>n-i)}oe(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this._e(i,s)).next(a=>(Z(Dl,`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}_e(e,n){let r=e;return n.changes.forEach((i,s)=>{const o=ES(s);Tg(o,r)>0&&(r=o)}),new xn(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Un{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Un.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ls=-1;function Nh(t){return t==null}function tu(t){return t===0&&1/t==-1/0}function SN(t){return typeof t=="number"&&Number.isInteger(t)&&!tu(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bd="";function Xt(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=lv(e)),e=CN(t.get(n),e);return lv(e)}function CN(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const s=t.charAt(i);switch(s){case"\0":n+="";break;case bd:n+="";break;default:n+=s}}return n}function lv(t){return t+bd+""}function gr(t){const e=t.length;if(pe(e>=2,64408,{path:t}),e===2)return pe(t.charAt(0)===bd&&t.charAt(1)==="",56145,{path:t}),$e.emptyPath();const n=e-2,r=[];let i="";for(let s=0;s<e;){const o=t.indexOf(bd,s);switch((o<0||o>n)&&he(50515,{path:t}),t.charAt(o+1)){case"":const a=t.substring(s,o);let l;i.length===0?l=a:(i+=a,l=i,i=""),r.push(l);break;case"":i+=t.substring(s,o),i+="\0";break;case"":i+=t.substring(s,o+1);break;default:he(61167,{path:t})}s=o+2}return new $e(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Is="remoteDocuments",Lu="owner",_o="owner",nu="mutationQueues",AN="userId",Jn="mutations",uv="batchId",Ns="userMutationsIndex",cv=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function td(t,e){return[t,Xt(e)]}function CS(t,e,n){return[t,Xt(e),n]}const xN={},oa="documentMutations",Md="remoteDocumentsV14",RN=["prefixPath","collectionGroup","readTime","documentId"],nd="documentKeyIndex",PN=["prefixPath","collectionGroup","documentId"],AS="collectionGroupIndex",kN=["collectionGroup","readTime","prefixPath","documentId"],ru="remoteDocumentGlobal",Rp="remoteDocumentGlobalKey",aa="targets",xS="queryTargetsIndex",NN=["canonicalId","targetId"],la="targetDocuments",DN=["targetId","path"],wg="documentTargetsIndex",bN=["path","targetId"],Vd="targetGlobalKey",Fs="targetGlobal",iu="collectionParents",MN=["collectionId","parent"],ua="clientMetadata",VN="clientId",Dh="bundles",LN="bundleId",bh="namedQueries",FN="name",Ig="indexConfiguration",UN="indexId",Pp="collectionGroupIndex",ON="collectionGroup",bl="indexState",BN=["indexId","uid"],RS="sequenceNumberIndex",qN=["uid","sequenceNumber"],Ml="indexEntries",GN=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],PS="documentKeyIndex",$N=["indexId","uid","orderedDocumentKey"],Mh="documentOverlays",zN=["userId","collectionPath","documentId"],kp="collectionPathOverlayIndex",HN=["userId","collectionPath","largestBatchId"],kS="collectionGroupOverlayIndex",WN=["userId","collectionGroup","largestBatchId"],Sg="globals",KN="name",NS=[nu,Jn,oa,Is,aa,Lu,Fs,la,ua,ru,iu,Dh,bh],jN=[...NS,Mh],DS=[nu,Jn,oa,Md,aa,Lu,Fs,la,ua,ru,iu,Dh,bh,Mh],bS=DS,Cg=[...bS,Ig,bl,Ml],JN=Cg,MS=[...Cg,Sg],QN=MS;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Np extends IS{constructor(e,n){super(),this.le=e,this.currentSequenceNumber=n}}function bt(t,e){const n=Ae(t);return ki.O(n.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dv(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Yi(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function VS(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lt{constructor(e,n){this.comparator=e,this.root=n||Gt.EMPTY}insert(e,n){return new lt(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Gt.BLACK,null,null))}remove(e){return new lt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Gt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Cc(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Cc(this.root,e,this.comparator,!1)}getReverseIterator(){return new Cc(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Cc(this.root,e,this.comparator,!0)}}class Cc{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Gt{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??Gt.RED,this.left=i??Gt.EMPTY,this.right=s??Gt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new Gt(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Gt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return Gt.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Gt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Gt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw he(43730,{key:this.key,value:this.value});if(this.right.isRed())throw he(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw he(27949);return e+(this.isRed()?0:1)}}Gt.EMPTY=null,Gt.RED=!0,Gt.BLACK=!1;Gt.EMPTY=new class{constructor(){this.size=0}get key(){throw he(57766)}get value(){throw he(16141)}get color(){throw he(16727)}get left(){throw he(29726)}get right(){throw he(36894)}copy(e,n,r,i,s){return this}insert(e,n,r){return new Gt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qe{constructor(e){this.comparator=e,this.data=new lt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new hv(this.data.getIterator())}getIteratorFrom(e){return new hv(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Qe)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Qe(this.comparator);return n.data=e,n}}class hv{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function yo(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hn{constructor(e){this.fields=e,e.sort(at.comparator)}static empty(){return new hn([])}unionWith(e){let n=new Qe(at.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new hn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return sa(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LS extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new LS("Invalid base64 string: "+s):s}}(e);return new Tt(n)}static fromUint8Array(e){const n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new Tt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ce(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Tt.EMPTY_BYTE_STRING=new Tt("");const YN=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function zr(t){if(pe(!!t,39018),typeof t=="string"){let e=0;const n=YN.exec(t);if(pe(!!n,46558,{timestamp:t}),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:st(t.seconds),nanos:st(t.nanos)}}function st(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Hr(t){return typeof t=="string"?Tt.fromBase64String(t):Tt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FS="server_timestamp",US="__type__",OS="__previous_value__",BS="__local_write_time__";function Ag(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[US])==null?void 0:r.stringValue)===FS}function Vh(t){const e=t.mapValue.fields[OS];return Ag(e)?Vh(e):e}function su(t){const e=zr(t.mapValue.fields[BS].timestampValue);return new We(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XN{constructor(e,n,r,i,s,o,a,l,u,f){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=u,this.isUsingEmulator=f}}const Ld="(default)";class $i{constructor(e,n){this.projectId=e,this.database=n||Ld}static empty(){return new $i("","")}get isDefaultDatabase(){return this.database===Ld}isEqual(e){return e instanceof $i&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xg="__type__",qS="__max__",Ii={mapValue:{fields:{__type__:{stringValue:qS}}}},Rg="__vector__",ca="value",rd={nullValue:"NULL_VALUE"};function zi(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Ag(t)?4:GS(t)?9007199254740991:Lh(t)?10:11:he(28295,{value:t})}function Ir(t,e){if(t===e)return!0;const n=zi(t);if(n!==zi(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return su(t).isEqual(su(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=zr(i.timestampValue),a=zr(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return Hr(i.bytesValue).isEqual(Hr(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return st(i.geoPointValue.latitude)===st(s.geoPointValue.latitude)&&st(i.geoPointValue.longitude)===st(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return st(i.integerValue)===st(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=st(i.doubleValue),a=st(s.doubleValue);return o===a?tu(o)===tu(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return sa(t.arrayValue.values||[],e.arrayValue.values||[],Ir);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(dv(o)!==dv(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!Ir(o[l],a[l])))return!1;return!0}(t,e);default:return he(52216,{left:t})}}function ou(t,e){return(t.values||[]).find(n=>Ir(n,e))!==void 0}function Hi(t,e){if(t===e)return 0;const n=zi(t),r=zi(e);if(n!==r)return Ce(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Ce(t.booleanValue,e.booleanValue);case 2:return function(s,o){const a=st(s.integerValue||s.doubleValue),l=st(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(t,e);case 3:return fv(t.timestampValue,e.timestampValue);case 4:return fv(su(t),su(e));case 5:return Ap(t.stringValue,e.stringValue);case 6:return function(s,o){const a=Hr(s),l=Hr(o);return a.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),l=o.split("/");for(let u=0;u<a.length&&u<l.length;u++){const f=Ce(a[u],l[u]);if(f!==0)return f}return Ce(a.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){const a=Ce(st(s.latitude),st(o.latitude));return a!==0?a:Ce(st(s.longitude),st(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return pv(t.arrayValue,e.arrayValue);case 10:return function(s,o){var g,v,T,x;const a=s.fields||{},l=o.fields||{},u=(g=a[ca])==null?void 0:g.arrayValue,f=(v=l[ca])==null?void 0:v.arrayValue,m=Ce(((T=u==null?void 0:u.values)==null?void 0:T.length)||0,((x=f==null?void 0:f.values)==null?void 0:x.length)||0);return m!==0?m:pv(u,f)}(t.mapValue,e.mapValue);case 11:return function(s,o){if(s===Ii.mapValue&&o===Ii.mapValue)return 0;if(s===Ii.mapValue)return 1;if(o===Ii.mapValue)return-1;const a=s.fields||{},l=Object.keys(a),u=o.fields||{},f=Object.keys(u);l.sort(),f.sort();for(let m=0;m<l.length&&m<f.length;++m){const g=Ap(l[m],f[m]);if(g!==0)return g;const v=Hi(a[l[m]],u[f[m]]);if(v!==0)return v}return Ce(l.length,f.length)}(t.mapValue,e.mapValue);default:throw he(23264,{he:n})}}function fv(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Ce(t,e);const n=zr(t),r=zr(e),i=Ce(n.seconds,r.seconds);return i!==0?i:Ce(n.nanos,r.nanos)}function pv(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const s=Hi(n[i],r[i]);if(s)return s}return Ce(n.length,r.length)}function da(t){return Dp(t)}function Dp(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=zr(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Hr(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return oe.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=Dp(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${Dp(n.fields[o])}`;return i+"}"}(t.mapValue):he(61005,{value:t})}function id(t){switch(zi(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Vh(t);return e?16+id(e):16;case 5:return 2*t.stringValue.length;case 6:return Hr(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,s)=>i+id(s),0)}(t.arrayValue);case 10:case 11:return function(r){let i=0;return Yi(r.fields,(s,o)=>{i+=s.length+id(o)}),i}(t.mapValue);default:throw he(13486,{value:t})}}function au(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function bp(t){return!!t&&"integerValue"in t}function lu(t){return!!t&&"arrayValue"in t}function mv(t){return!!t&&"nullValue"in t}function gv(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function sd(t){return!!t&&"mapValue"in t}function Lh(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[xg])==null?void 0:r.stringValue)===Rg}function Vl(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return Yi(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Vl(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Vl(t.arrayValue.values[n]);return e}return{...t}}function GS(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===qS}const $S={mapValue:{fields:{[xg]:{stringValue:Rg},[ca]:{arrayValue:{}}}}};function ZN(t){return"nullValue"in t?rd:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?au($i.empty(),oe.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?Lh(t)?$S:{mapValue:{}}:he(35942,{value:t})}function eD(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?au($i.empty(),oe.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?$S:"mapValue"in t?Lh(t)?{mapValue:{}}:Ii:he(61959,{value:t})}function _v(t,e){const n=Hi(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function yv(t,e){const n=Hi(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qt{constructor(e){this.value=e}static empty(){return new Qt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!sd(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Vl(n)}setAll(e){let n=at.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=Vl(o):i.push(a.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());sd(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Ir(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];sd(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){Yi(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new Qt(Vl(this.value))}}function zS(t){const e=[];return Yi(t.fields,(n,r)=>{const i=new at([n]);if(sd(r)){const s=zS(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new hn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gt{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new gt(e,0,ye.min(),ye.min(),ye.min(),Qt.empty(),0)}static newFoundDocument(e,n,r,i){return new gt(e,1,n,ye.min(),r,i,0)}static newNoDocument(e,n){return new gt(e,2,n,ye.min(),ye.min(),Qt.empty(),0)}static newUnknownDocument(e,n){return new gt(e,3,n,ye.min(),ye.min(),Qt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(ye.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Qt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Qt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ye.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof gt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new gt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ha{constructor(e,n){this.position=e,this.inclusive=n}}function vv(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(s.field.isKeyField()?r=oe.comparator(oe.fromName(o.referenceValue),n.key):r=Hi(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function Tv(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Ir(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fd{constructor(e,n="asc"){this.field=e,this.dir=n}}function tD(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HS{}class Le extends HS{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new nD(e,n,r):n==="array-contains"?new sD(e,r):n==="in"?new YS(e,r):n==="not-in"?new oD(e,r):n==="array-contains-any"?new aD(e,r):new Le(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new rD(e,r):new iD(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Hi(n,this.value)):n!==null&&zi(this.value)===zi(n)&&this.matchesComparison(Hi(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return he(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Je extends HS{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new Je(e,n)}matches(e){return fa(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function fa(t){return t.op==="and"}function Mp(t){return t.op==="or"}function Pg(t){return WS(t)&&fa(t)}function WS(t){for(const e of t.filters)if(e instanceof Je)return!1;return!0}function Vp(t){if(t instanceof Le)return t.field.canonicalString()+t.op.toString()+da(t.value);if(Pg(t))return t.filters.map(e=>Vp(e)).join(",");{const e=t.filters.map(n=>Vp(n)).join(",");return`${t.op}(${e})`}}function KS(t,e){return t instanceof Le?function(r,i){return i instanceof Le&&r.op===i.op&&r.field.isEqual(i.field)&&Ir(r.value,i.value)}(t,e):t instanceof Je?function(r,i){return i instanceof Je&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&KS(o,i.filters[a]),!0):!1}(t,e):void he(19439)}function jS(t,e){const n=t.filters.concat(e);return Je.create(n,t.op)}function JS(t){return t instanceof Le?function(n){return`${n.field.canonicalString()} ${n.op} ${da(n.value)}`}(t):t instanceof Je?function(n){return n.op.toString()+" {"+n.getFilters().map(JS).join(" ,")+"}"}(t):"Filter"}class nD extends Le{constructor(e,n,r){super(e,n,r),this.key=oe.fromName(r.referenceValue)}matches(e){const n=oe.comparator(e.key,this.key);return this.matchesComparison(n)}}class rD extends Le{constructor(e,n){super(e,"in",n),this.keys=QS("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class iD extends Le{constructor(e,n){super(e,"not-in",n),this.keys=QS("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function QS(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(r=>oe.fromName(r.referenceValue))}class sD extends Le{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return lu(n)&&ou(n.arrayValue,this.value)}}class YS extends Le{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&ou(this.value.arrayValue,n)}}class oD extends Le{constructor(e,n){super(e,"not-in",n)}matches(e){if(ou(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!ou(this.value.arrayValue,n)}}class aD extends Le{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!lu(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>ou(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lD{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.Te=null}}function Lp(t,e=null,n=[],r=[],i=null,s=null,o=null){return new lD(t,e,n,r,i,s,o)}function Hs(t){const e=Ae(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Vp(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Nh(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>da(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>da(r)).join(",")),e.Te=n}return e.Te}function Fu(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!tD(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!KS(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Tv(t.startAt,e.startAt)&&Tv(t.endAt,e.endAt)}function Ud(t){return oe.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function Od(t,e){return t.filters.filter(n=>n instanceof Le&&n.field.isEqual(e))}function Ev(t,e,n){let r=rd,i=!0;for(const s of Od(t,e)){let o=rd,a=!0;switch(s.op){case"<":case"<=":o=ZN(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=rd}_v({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];_v({value:r,inclusive:i},{value:o,inclusive:n.inclusive})<0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}function wv(t,e,n){let r=Ii,i=!0;for(const s of Od(t,e)){let o=Ii,a=!0;switch(s.op){case">=":case">":o=eD(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=Ii}yv({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];yv({value:r,inclusive:i},{value:o,inclusive:n.inclusive})>0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uu{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function uD(t,e,n,r,i,s,o,a){return new Uu(t,e,n,r,i,s,o,a)}function Ou(t){return new Uu(t)}function Iv(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function XS(t){return t.collectionGroup!==null}function Ll(t){const e=Ae(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Qe(at.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(u=>{u.isInequality()&&(a=a.add(u.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new Fd(s,r))}),n.has(at.keyField().canonicalString())||e.Ie.push(new Fd(at.keyField(),r))}return e.Ie}function qn(t){const e=Ae(t);return e.Ee||(e.Ee=cD(e,Ll(t))),e.Ee}function cD(t,e){if(t.limitType==="F")return Lp(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new Fd(i.field,s)});const n=t.endAt?new ha(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new ha(t.startAt.position,t.startAt.inclusive):null;return Lp(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Fp(t,e){const n=t.filters.concat([e]);return new Uu(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Up(t,e,n){return new Uu(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Fh(t,e){return Fu(qn(t),qn(e))&&t.limitType===e.limitType}function ZS(t){return`${Hs(qn(t))}|lt:${t.limitType}`}function Co(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>JS(i)).join(", ")}]`),Nh(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>da(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>da(i)).join(",")),`Target(${r})`}(qn(t))}; limitType=${t.limitType})`}function Bu(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):oe.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of Ll(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,a,l){const u=vv(o,a,l);return o.inclusive?u<=0:u<0}(r.startAt,Ll(r),i)||r.endAt&&!function(o,a,l){const u=vv(o,a,l);return o.inclusive?u>=0:u>0}(r.endAt,Ll(r),i))}(t,e)}function dD(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function eC(t){return(e,n)=>{let r=!1;for(const i of Ll(t)){const s=hD(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function hD(t,e,n){const r=t.field.isKeyField()?oe.comparator(e.key,n.key):function(s,o,a){const l=o.data.field(s),u=a.data.field(s);return l!==null&&u!==null?Hi(l,u):he(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return he(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yr{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Yi(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return VS(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fD=new lt(oe.comparator);function Sn(){return fD}const tC=new lt(oe.comparator);function El(...t){let e=tC;for(const n of t)e=e.insert(n.key,n);return e}function nC(t){let e=tC;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function _r(){return Fl()}function rC(){return Fl()}function Fl(){return new Yr(t=>t.toString(),(t,e)=>t.isEqual(e))}const pD=new lt(oe.comparator),mD=new Qe(oe.comparator);function Ne(...t){let e=mD;for(const n of t)e=e.add(n);return e}const gD=new Qe(Ce);function _D(){return gD}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kg(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:tu(e)?"-0":e}}function iC(t){return{integerValue:""+t}}function yD(t,e){return SN(e)?iC(e):kg(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uh{constructor(){this._=void 0}}function vD(t,e,n){return t instanceof pa?function(i,s){const o={fields:{[US]:{stringValue:FS},[BS]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Ag(s)&&(s=Vh(s)),s&&(o.fields[OS]=s),{mapValue:o}}(n,e):t instanceof ma?oC(t,e):t instanceof ga?aC(t,e):function(i,s){const o=sC(i,s),a=Sv(o)+Sv(i.Ae);return bp(o)&&bp(i.Ae)?iC(a):kg(i.serializer,a)}(t,e)}function TD(t,e,n){return t instanceof ma?oC(t,e):t instanceof ga?aC(t,e):n}function sC(t,e){return t instanceof uu?function(r){return bp(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class pa extends Uh{}class ma extends Uh{constructor(e){super(),this.elements=e}}function oC(t,e){const n=lC(e);for(const r of t.elements)n.some(i=>Ir(i,r))||n.push(r);return{arrayValue:{values:n}}}class ga extends Uh{constructor(e){super(),this.elements=e}}function aC(t,e){let n=lC(e);for(const r of t.elements)n=n.filter(i=>!Ir(i,r));return{arrayValue:{values:n}}}class uu extends Uh{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function Sv(t){return st(t.integerValue||t.doubleValue)}function lC(t){return lu(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uC{constructor(e,n){this.field=e,this.transform=n}}function ED(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof ma&&i instanceof ma||r instanceof ga&&i instanceof ga?sa(r.elements,i.elements,Ir):r instanceof uu&&i instanceof uu?Ir(r.Ae,i.Ae):r instanceof pa&&i instanceof pa}(t.transform,e.transform)}class wD{constructor(e,n){this.version=e,this.transformResults=n}}class rn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new rn}static exists(e){return new rn(void 0,e)}static updateTime(e){return new rn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function od(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Oh{}function cC(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Bh(t.key,rn.none()):new Na(t.key,t.data,rn.none());{const n=t.data,r=Qt.empty();let i=new Qe(at.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new Xr(t.key,r,new hn(i.toArray()),rn.none())}}function ID(t,e,n){t instanceof Na?function(i,s,o){const a=i.value.clone(),l=Av(i.fieldTransforms,s,o.transformResults);a.setAll(l),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof Xr?function(i,s,o){if(!od(i.precondition,s))return void s.convertToUnknownDocument(o.version);const a=Av(i.fieldTransforms,s,o.transformResults),l=s.data;l.setAll(dC(i)),l.setAll(a),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Ul(t,e,n,r){return t instanceof Na?function(s,o,a,l){if(!od(s.precondition,o))return a;const u=s.value.clone(),f=xv(s.fieldTransforms,l,o);return u.setAll(f),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,n,r):t instanceof Xr?function(s,o,a,l){if(!od(s.precondition,o))return a;const u=xv(s.fieldTransforms,l,o),f=o.data;return f.setAll(dC(s)),f.setAll(u),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(m=>m.field))}(t,e,n,r):function(s,o,a){return od(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function SD(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=sC(r.transform,i||null);s!=null&&(n===null&&(n=Qt.empty()),n.set(r.field,s))}return n||null}function Cv(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&sa(r,i,(s,o)=>ED(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Na extends Oh{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Xr extends Oh{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function dC(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function Av(t,e,n){const r=new Map;pe(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,TD(o,a,n[i]))}return r}function xv(t,e,n){const r=new Map;for(const i of t){const s=i.transform,o=n.data.field(i.field);r.set(i.field,vD(s,o,e))}return r}class Bh extends Oh{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class hC extends Oh{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ng{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&ID(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Ul(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Ul(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=rC();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;const l=cC(o,a);l!==null&&r.set(i.key,l),o.isValidDocument()||o.convertToNoDocument(ye.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Ne())}isEqual(e){return this.batchId===e.batchId&&sa(this.mutations,e.mutations,(n,r)=>Cv(n,r))&&sa(this.baseMutations,e.baseMutations,(n,r)=>Cv(n,r))}}class Dg{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){pe(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=function(){return pD}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new Dg(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bg{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CD{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var wt,Oe;function AD(t){switch(t){case j.OK:return he(64938);case j.CANCELLED:case j.UNKNOWN:case j.DEADLINE_EXCEEDED:case j.RESOURCE_EXHAUSTED:case j.INTERNAL:case j.UNAVAILABLE:case j.UNAUTHENTICATED:return!1;case j.INVALID_ARGUMENT:case j.NOT_FOUND:case j.ALREADY_EXISTS:case j.PERMISSION_DENIED:case j.FAILED_PRECONDITION:case j.ABORTED:case j.OUT_OF_RANGE:case j.UNIMPLEMENTED:case j.DATA_LOSS:return!0;default:return he(15467,{code:t})}}function fC(t){if(t===void 0)return nn("GRPC error has no .code"),j.UNKNOWN;switch(t){case wt.OK:return j.OK;case wt.CANCELLED:return j.CANCELLED;case wt.UNKNOWN:return j.UNKNOWN;case wt.DEADLINE_EXCEEDED:return j.DEADLINE_EXCEEDED;case wt.RESOURCE_EXHAUSTED:return j.RESOURCE_EXHAUSTED;case wt.INTERNAL:return j.INTERNAL;case wt.UNAVAILABLE:return j.UNAVAILABLE;case wt.UNAUTHENTICATED:return j.UNAUTHENTICATED;case wt.INVALID_ARGUMENT:return j.INVALID_ARGUMENT;case wt.NOT_FOUND:return j.NOT_FOUND;case wt.ALREADY_EXISTS:return j.ALREADY_EXISTS;case wt.PERMISSION_DENIED:return j.PERMISSION_DENIED;case wt.FAILED_PRECONDITION:return j.FAILED_PRECONDITION;case wt.ABORTED:return j.ABORTED;case wt.OUT_OF_RANGE:return j.OUT_OF_RANGE;case wt.UNIMPLEMENTED:return j.UNIMPLEMENTED;case wt.DATA_LOSS:return j.DATA_LOSS;default:return he(39323,{code:t})}}(Oe=wt||(wt={}))[Oe.OK=0]="OK",Oe[Oe.CANCELLED=1]="CANCELLED",Oe[Oe.UNKNOWN=2]="UNKNOWN",Oe[Oe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Oe[Oe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Oe[Oe.NOT_FOUND=5]="NOT_FOUND",Oe[Oe.ALREADY_EXISTS=6]="ALREADY_EXISTS",Oe[Oe.PERMISSION_DENIED=7]="PERMISSION_DENIED",Oe[Oe.UNAUTHENTICATED=16]="UNAUTHENTICATED",Oe[Oe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Oe[Oe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Oe[Oe.ABORTED=10]="ABORTED",Oe[Oe.OUT_OF_RANGE=11]="OUT_OF_RANGE",Oe[Oe.UNIMPLEMENTED=12]="UNIMPLEMENTED",Oe[Oe.INTERNAL=13]="INTERNAL",Oe[Oe.UNAVAILABLE=14]="UNAVAILABLE",Oe[Oe.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xD(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RD=new Pi([4294967295,4294967295],0);function Rv(t){const e=xD().encode(t),n=new aS;return n.update(e),new Uint8Array(n.digest())}function Pv(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Pi([n,r],0),new Pi([i,s],0)]}class Mg{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new wl(`Invalid padding: ${n}`);if(r<0)throw new wl(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new wl(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new wl(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=Pi.fromNumber(this.ge)}ye(e,n,r){let i=e.add(n.multiply(Pi.fromNumber(r)));return i.compare(RD)===1&&(i=new Pi([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=Rv(e),[r,i]=Pv(n);for(let s=0;s<this.hashCount;s++){const o=this.ye(r,i,s);if(!this.we(o))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new Mg(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.ge===0)return;const n=Rv(e),[r,i]=Pv(n);for(let s=0;s<this.hashCount;s++){const o=this.ye(r,i,s);this.Se(o)}}Se(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class wl extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qh{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,qu.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new qh(ye.min(),i,new lt(Ce),Sn(),Ne())}}class qu{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new qu(r,n,Ne(),Ne(),Ne())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ad{constructor(e,n,r,i){this.be=e,this.removedTargetIds=n,this.key=r,this.De=i}}class pC{constructor(e,n){this.targetId=e,this.Ce=n}}class mC{constructor(e,n,r=Tt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class kv{constructor(){this.ve=0,this.Fe=Nv(),this.Me=Tt.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Ne(),n=Ne(),r=Ne();return this.Fe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:he(38017,{changeType:s})}}),new qu(this.Me,this.xe,e,n,r)}qe(){this.Oe=!1,this.Fe=Nv()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,pe(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class PD{constructor(e){this.Ge=e,this.ze=new Map,this.je=Sn(),this.Je=Ac(),this.He=Ac(),this.Ye=new lt(Ce)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:he(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((r,i)=>{this.rt(i)&&n(i)})}st(e){const n=e.targetId,r=e.Ce.count,i=this.ot(n);if(i){const s=i.target;if(Ud(s))if(r===0){const o=new oe(s.path);this.et(n,o,gt.newNoDocument(o,ye.min()))}else pe(r===1,20013,{expectedCount:r});else{const o=this._t(n);if(o!==r){const a=this.ut(e),l=a?this.ct(a,e,o):1;if(l!==0){this.it(n);const u=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,u)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let o,a;try{o=Hr(r).toUint8Array()}catch(l){if(l instanceof LS)return Gi("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new Mg(o,i,s)}catch(l){return Gi(l instanceof wl?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.ge===0?null:a}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.et(n,s,null),i++)}),i}Tt(e){const n=new Map;this.ze.forEach((s,o)=>{const a=this.ot(o);if(a){if(s.current&&Ud(a.target)){const l=new oe(a.target.path);this.It(l).has(o)||this.Et(o,l)||this.et(o,l,gt.newNoDocument(l,e))}s.Be&&(n.set(o,s.ke()),s.qe())}});let r=Ne();this.He.forEach((s,o)=>{let a=!0;o.forEachWhile(l=>{const u=this.ot(l);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.je.forEach((s,o)=>o.setReadTime(e));const i=new qh(e,n,this.Ye,this.je,r);return this.je=Sn(),this.Je=Ac(),this.He=Ac(),this.Ye=new lt(Ce),i}Xe(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,r),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,n)?i.Qe(n,1):i.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new kv,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new Qe(Ce),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new Qe(Ce),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||Z("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new kv),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function Ac(){return new lt(oe.comparator)}function Nv(){return new lt(oe.comparator)}const kD={asc:"ASCENDING",desc:"DESCENDING"},ND={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},DD={and:"AND",or:"OR"};class bD{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Op(t,e){return t.useProto3Json||Nh(e)?e:{value:e}}function _a(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function gC(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function MD(t,e){return _a(t,e.toTimestamp())}function on(t){return pe(!!t,49232),ye.fromTimestamp(function(n){const r=zr(n);return new We(r.seconds,r.nanos)}(t))}function Vg(t,e){return Bp(t,e).canonicalString()}function Bp(t,e){const n=function(i){return new $e(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function _C(t){const e=$e.fromString(t);return pe(AC(e),10190,{key:e.toString()}),e}function Bd(t,e){return Vg(t.databaseId,e.path)}function Us(t,e){const n=_C(e);if(n.get(1)!==t.databaseId.projectId)throw new re(j.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new re(j.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new oe(TC(n))}function yC(t,e){return Vg(t.databaseId,e)}function vC(t){const e=_C(t);return e.length===4?$e.emptyPath():TC(e)}function qp(t){return new $e(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function TC(t){return pe(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function Dv(t,e,n){return{name:Bd(t,e),fields:n.value.mapValue.fields}}function VD(t,e,n){const r=Us(t,e.name),i=on(e.updateTime),s=e.createTime?on(e.createTime):ye.min(),o=new Qt({mapValue:{fields:e.fields}}),a=gt.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function LD(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:he(39313,{state:u})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(u,f){return u.useProto3Json?(pe(f===void 0||typeof f=="string",58123),Tt.fromBase64String(f||"")):(pe(f===void 0||f instanceof Buffer||f instanceof Uint8Array,16193),Tt.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(u){const f=u.code===void 0?j.UNKNOWN:fC(u.code);return new re(f,u.message||"")}(o);n=new mC(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Us(t,r.document.name),s=on(r.document.updateTime),o=r.document.createTime?on(r.document.createTime):ye.min(),a=new Qt({mapValue:{fields:r.document.fields}}),l=gt.newFoundDocument(i,s,o,a),u=r.targetIds||[],f=r.removedTargetIds||[];n=new ad(u,f,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Us(t,r.document),s=r.readTime?on(r.readTime):ye.min(),o=gt.newNoDocument(i,s),a=r.removedTargetIds||[];n=new ad([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Us(t,r.document),s=r.removedTargetIds||[];n=new ad([],s,i,null)}else{if(!("filter"in e))return he(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new CD(i,s),a=r.targetId;n=new pC(a,o)}}return n}function qd(t,e){let n;if(e instanceof Na)n={update:Dv(t,e.key,e.value)};else if(e instanceof Bh)n={delete:Bd(t,e.key)};else if(e instanceof Xr)n={update:Dv(t,e.key,e.data),updateMask:GD(e.fieldMask)};else{if(!(e instanceof hC))return he(16599,{Vt:e.type});n={verify:Bd(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const a=o.transform;if(a instanceof pa)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof ma)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof ga)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof uu)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw he(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:MD(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:he(27497)}(t,e.precondition)),n}function Gp(t,e){const n=e.currentDocument?function(s){return s.updateTime!==void 0?rn.updateTime(on(s.updateTime)):s.exists!==void 0?rn.exists(s.exists):rn.none()}(e.currentDocument):rn.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let l=null;if("setToServerValue"in a)pe(a.setToServerValue==="REQUEST_TIME",16630,{proto:a}),l=new pa;else if("appendMissingElements"in a){const f=a.appendMissingElements.values||[];l=new ma(f)}else if("removeAllFromArray"in a){const f=a.removeAllFromArray.values||[];l=new ga(f)}else"increment"in a?l=new uu(o,a.increment):he(16584,{proto:a});const u=at.fromServerFormat(a.fieldPath);return new uC(u,l)}(t,i)):[];if(e.update){e.update.name;const i=Us(t,e.update.name),s=new Qt({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(l){const u=l.fieldPaths||[];return new hn(u.map(f=>at.fromServerFormat(f)))}(e.updateMask);return new Xr(i,s,o,n,r)}return new Na(i,s,n,r)}if(e.delete){const i=Us(t,e.delete);return new Bh(i,n)}if(e.verify){const i=Us(t,e.verify);return new hC(i,n)}return he(1463,{proto:e})}function FD(t,e){return t&&t.length>0?(pe(e!==void 0,14353),t.map(n=>function(i,s){let o=i.updateTime?on(i.updateTime):on(s);return o.isEqual(ye.min())&&(o=on(s)),new wD(o,i.transformResults||[])}(n,e))):[]}function EC(t,e){return{documents:[yC(t,e.path)]}}function wC(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=yC(t,i);const s=function(u){if(u.length!==0)return CC(Je.create(u,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const o=function(u){if(u.length!==0)return u.map(f=>function(g){return{field:Ao(g.field),direction:OD(g.dir)}}(f))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=Op(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{ft:n,parent:i}}function IC(t){let e=vC(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){pe(r===1,65062);const f=n.from[0];f.allDescendants?i=f.collectionId:e=e.child(f.collectionId)}let s=[];n.where&&(s=function(m){const g=SC(m);return g instanceof Je&&Pg(g)?g.getFilters():[g]}(n.where));let o=[];n.orderBy&&(o=function(m){return m.map(g=>function(T){return new Fd(xo(T.field),function(D){switch(D){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(T.direction))}(g))}(n.orderBy));let a=null;n.limit&&(a=function(m){let g;return g=typeof m=="object"?m.value:m,Nh(g)?null:g}(n.limit));let l=null;n.startAt&&(l=function(m){const g=!!m.before,v=m.values||[];return new ha(v,g)}(n.startAt));let u=null;return n.endAt&&(u=function(m){const g=!m.before,v=m.values||[];return new ha(v,g)}(n.endAt)),uD(e,i,o,s,a,"F",l,u)}function UD(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return he(28987,{purpose:i})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function SC(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=xo(n.unaryFilter.field);return Le.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=xo(n.unaryFilter.field);return Le.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=xo(n.unaryFilter.field);return Le.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=xo(n.unaryFilter.field);return Le.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return he(61313);default:return he(60726)}}(t):t.fieldFilter!==void 0?function(n){return Le.create(xo(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return he(58110);default:return he(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Je.create(n.compositeFilter.filters.map(r=>SC(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return he(1026)}}(n.compositeFilter.op))}(t):he(30097,{filter:t})}function OD(t){return kD[t]}function BD(t){return ND[t]}function qD(t){return DD[t]}function Ao(t){return{fieldPath:t.canonicalString()}}function xo(t){return at.fromServerFormat(t.fieldPath)}function CC(t){return t instanceof Le?function(n){if(n.op==="=="){if(gv(n.value))return{unaryFilter:{field:Ao(n.field),op:"IS_NAN"}};if(mv(n.value))return{unaryFilter:{field:Ao(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(gv(n.value))return{unaryFilter:{field:Ao(n.field),op:"IS_NOT_NAN"}};if(mv(n.value))return{unaryFilter:{field:Ao(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ao(n.field),op:BD(n.op),value:n.value}}}(t):t instanceof Je?function(n){const r=n.getFilters().map(i=>CC(i));return r.length===1?r[0]:{compositeFilter:{op:qD(n.op),filters:r}}}(t):he(54877,{filter:t})}function GD(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function AC(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fr{constructor(e,n,r,i,s=ye.min(),o=ye.min(),a=Tt.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new Fr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Fr(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Fr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Fr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xC{constructor(e){this.yt=e}}function $D(t,e){let n;if(e.document)n=VD(t.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=oe.fromSegments(e.noDocument.path),i=Ks(e.noDocument.readTime);n=gt.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return he(56709);{const r=oe.fromSegments(e.unknownDocument.path),i=Ks(e.unknownDocument.version);n=gt.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){const s=new We(i[0],i[1]);return ye.fromTimestamp(s)}(e.readTime)),n}function bv(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Gd(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:Bd(s,o.key),fields:o.data.value.mapValue.fields,updateTime:_a(s,o.version.toTimestamp()),createTime:_a(s,o.createTime.toTimestamp())}}(t.yt,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:Ws(e.version)};else{if(!e.isUnknownDocument())return he(57904,{document:e});r.unknownDocument={path:n.path.toArray(),version:Ws(e.version)}}return r}function Gd(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Ws(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Ks(t){const e=new We(t.seconds,t.nanoseconds);return ye.fromTimestamp(e)}function xs(t,e){const n=(e.baseMutations||[]).map(s=>Gp(t.yt,s));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map(s=>Gp(t.yt,s)),i=We.fromMillis(e.localWriteTimeMs);return new Ng(e.batchId,i,n,r)}function Il(t){const e=Ks(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?Ks(t.lastLimboFreeSnapshotVersion):ye.min();let r;return r=function(s){return s.documents!==void 0}(t.query)?function(s){const o=s.documents.length;return pe(o===1,1966,{count:o}),qn(Ou(vC(s.documents[0])))}(t.query):function(s){return qn(IC(s))}(t.query),new Fr(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,Tt.fromBase64String(t.resumeToken))}function RC(t,e){const n=Ws(e.snapshotVersion),r=Ws(e.lastLimboFreeSnapshotVersion);let i;i=Ud(e.target)?EC(t.yt,e.target):wC(t.yt,e.target).ft;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Hs(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function PC(t){const e=IC({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Up(e,e.limit,"L"):e}function Of(t,e){return new bg(e.largestBatchId,Gp(t.yt,e.overlayMutation))}function Mv(t,e){const n=e.path.lastSegment();return[t,Xt(e.path.popLast()),n]}function Vv(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:Ws(r.readTime),documentKey:Xt(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zD{getBundleMetadata(e,n){return Lv(e).get(n).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:Ks(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,n){return Lv(e).put(function(i){return{bundleId:i.id,createTime:Ws(on(i.createTime)),version:i.version}}(n))}getNamedQuery(e,n){return Fv(e).get(n).next(r=>{if(r)return function(s){return{name:s.name,query:PC(s.bundledQuery),readTime:Ks(s.readTime)}}(r)})}saveNamedQuery(e,n){return Fv(e).put(function(i){return{name:i.name,readTime:Ws(on(i.readTime)),bundledQuery:i.bundledQuery}}(n))}}function Lv(t){return bt(t,Dh)}function Fv(t){return bt(t,bh)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gh{constructor(e,n){this.serializer=e,this.userId=n}static wt(e,n){const r=n.uid||"";return new Gh(e,r)}getOverlay(e,n){return ol(e).get(Mv(this.userId,n)).next(r=>r?Of(this.serializer,r):null)}getOverlays(e,n){const r=_r();return G.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){const i=[];return r.forEach((s,o)=>{const a=new bg(n,o);i.push(this.St(e,a))}),G.waitFor(i)}removeOverlaysForBatchId(e,n,r){const i=new Set;n.forEach(o=>i.add(Xt(o.getCollectionPath())));const s=[];return i.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(ol(e).Z(kp,a))}),G.waitFor(s)}getOverlaysForCollection(e,n,r){const i=_r(),s=Xt(n),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return ol(e).J(kp,o).next(a=>{for(const l of a){const u=Of(this.serializer,l);i.set(u.getKey(),u)}return i})}getOverlaysForCollectionGroup(e,n,r,i){const s=_r();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return ol(e).ee({index:kS,range:a},(l,u,f)=>{const m=Of(this.serializer,u);s.size()<i||m.largestBatchId===o?(s.set(m.getKey(),m),o=m.largestBatchId):f.done()}).next(()=>s)}St(e,n){return ol(e).put(function(i,s,o){const[a,l,u]=Mv(s,o.mutation.key);return{userId:s,collectionPath:l,documentId:u,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:qd(i.yt,o.mutation)}}(this.serializer,this.userId,n))}}function ol(t){return bt(t,Mh)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HD{bt(e){return bt(e,Sg)}getSessionToken(e){return this.bt(e).get("sessionToken").next(n=>{const r=n==null?void 0:n.value;return r?Tt.fromUint8Array(r):Tt.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.bt(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rs{constructor(){}Dt(e,n){this.Ct(e,n),n.vt()}Ct(e,n){if("nullValue"in e)this.Ft(n,5);else if("booleanValue"in e)this.Ft(n,10),n.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(n,15),n.Mt(st(e.integerValue));else if("doubleValue"in e){const r=st(e.doubleValue);isNaN(r)?this.Ft(n,13):(this.Ft(n,15),tu(r)?n.Mt(0):n.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(n,20),typeof r=="string"&&(r=zr(r)),n.xt(`${r.seconds||""}`),n.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,n),this.Nt(n);else if("bytesValue"in e)this.Ft(n,30),n.Bt(Hr(e.bytesValue)),this.Nt(n);else if("referenceValue"in e)this.Lt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(n,45),n.Mt(r.latitude||0),n.Mt(r.longitude||0)}else"mapValue"in e?GS(e)?this.Ft(n,Number.MAX_SAFE_INTEGER):Lh(e)?this.kt(e.mapValue,n):(this.qt(e.mapValue,n),this.Nt(n)):"arrayValue"in e?(this.Qt(e.arrayValue,n),this.Nt(n)):he(19022,{$t:e})}Ot(e,n){this.Ft(n,25),this.Ut(e,n)}Ut(e,n){n.xt(e)}qt(e,n){const r=e.fields||{};this.Ft(n,55);for(const i of Object.keys(r))this.Ot(i,n),this.Ct(r[i],n)}kt(e,n){var o,a;const r=e.fields||{};this.Ft(n,53);const i=ca,s=((a=(o=r[i].arrayValue)==null?void 0:o.values)==null?void 0:a.length)||0;this.Ft(n,15),n.Mt(st(s)),this.Ot(i,n),this.Ct(r[i],n)}Qt(e,n){const r=e.values||[];this.Ft(n,50);for(const i of r)this.Ct(i,n)}Lt(e,n){this.Ft(n,37),oe.fromName(e).path.forEach(r=>{this.Ft(n,60),this.Ut(r,n)})}Ft(e,n){e.Mt(n)}Nt(e){e.Mt(2)}}Rs.Kt=new Rs;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vo=255;function WD(t){if(t===0)return 8;let e=0;return t>>4||(e+=4,t<<=4),t>>6||(e+=2,t<<=2),t>>7||(e+=1),e}function Uv(t){const e=64-function(r){let i=0;for(let s=0;s<8;++s){const o=WD(255&r[s]);if(i+=o,o!==8)break}return i}(t);return Math.ceil(e/8)}class KD{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Gt(r.value),r=n.next();this.zt()}jt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Jt(r.value),r=n.next();this.Ht()}Yt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const i=n.codePointAt(0);this.Gt(240|i>>>18),this.Gt(128|63&i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i)}}this.zt()}Zt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const i=n.codePointAt(0);this.Jt(240|i>>>18),this.Jt(128|63&i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i)}}this.Ht()}Xt(e){const n=this.en(e),r=Uv(n);this.tn(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}nn(e){const n=this.en(e),r=Uv(n);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}rn(){this.sn(vo),this.sn(255)}_n(){this.an(vo),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const n=function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=!!(128&n[0]);n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Gt(e){const n=255&e;n===0?(this.sn(0),this.sn(255)):n===vo?(this.sn(vo),this.sn(0)):this.sn(n)}Jt(e){const n=255&e;n===0?(this.an(0),this.an(255)):n===vo?(this.an(vo),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class jD{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class JD{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class al{constructor(){this.cn=new KD,this.ln=new jD(this.cn),this.hn=new JD(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ps{constructor(e,n,r,i){this.Tn=e,this.In=n,this.En=r,this.dn=i}An(){const e=this.dn.length,n=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.dn,0),n!==e?r.set([0],this.dn.length):++r[r.length-1],new Ps(this.Tn,this.In,this.En,r)}Rn(e,n,r){return{indexId:this.Tn,uid:e,arrayValue:ld(this.En),directionalValue:ld(this.dn),orderedDocumentKey:ld(n),documentKey:r.path.toArray()}}Vn(e,n,r){const i=this.Rn(e,n,r);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}}function ci(t,e){let n=t.Tn-e.Tn;return n!==0?n:(n=Ov(t.En,e.En),n!==0?n:(n=Ov(t.dn,e.dn),n!==0?n:oe.comparator(t.In,e.In)))}function Ov(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}function ld(t){return wI()?function(n){let r="";for(let i=0;i<n.length;i++)r+=String.fromCharCode(n[i]);return r}(t):t}function Bv(t){return typeof t!="string"?t:function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(t)}class qv{constructor(e){this.mn=new Qe((n,r)=>at.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const n of e.filters){const r=n;r.isInequality()?this.mn=this.mn.add(r):this.gn.push(r)}}get pn(){return this.mn.size>1}yn(e){if(pe(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const n=xp(e);if(n!==void 0&&!this.wn(n))return!1;const r=ws(e);let i=new Set,s=0,o=0;for(;s<r.length&&this.wn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.mn.size>0){const a=this.mn.getIterator().getNext();if(!i.has(a.field.canonicalString())){const l=r[s];if(!this.Sn(a,l)||!this.bn(this.fn[o++],l))return!1}++s}for(;s<r.length;++s){const a=r[s];if(o>=this.fn.length||!this.bn(this.fn[o++],a))return!1}return!0}Dn(){if(this.pn)return null;let e=new Qe(at.comparator);const n=[];for(const r of this.gn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new ed(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new ed(r.field,0))}for(const r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new ed(r.field,r.dir==="asc"?0:1)));return new Dd(Dd.UNKNOWN_ID,this.collectionId,n,eu.empty())}wn(e){for(const n of this.gn)if(this.Sn(n,e))return!0;return!1}Sn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}bn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kC(t){var n,r;if(pe(t instanceof Le||t instanceof Je,20012),t instanceof Le){if(t instanceof YS){const i=((r=(n=t.value.arrayValue)==null?void 0:n.values)==null?void 0:r.map(s=>Le.create(t.field,"==",s)))||[];return Je.create(i,"or")}return t}const e=t.filters.map(i=>kC(i));return Je.create(e,t.op)}function QD(t){if(t.getFilters().length===0)return[];const e=Hp(kC(t));return pe(NC(e),7391),$p(e)||zp(e)?[e]:e.getFilters()}function $p(t){return t instanceof Le}function zp(t){return t instanceof Je&&Pg(t)}function NC(t){return $p(t)||zp(t)||function(n){if(n instanceof Je&&Mp(n)){for(const r of n.getFilters())if(!$p(r)&&!zp(r))return!1;return!0}return!1}(t)}function Hp(t){if(pe(t instanceof Le||t instanceof Je,34018),t instanceof Le)return t;if(t.filters.length===1)return Hp(t.filters[0]);const e=t.filters.map(r=>Hp(r));let n=Je.create(e,t.op);return n=$d(n),NC(n)?n:(pe(n instanceof Je,64498),pe(fa(n),40251),pe(n.filters.length>1,57927),n.filters.reduce((r,i)=>Lg(r,i)))}function Lg(t,e){let n;return pe(t instanceof Le||t instanceof Je,38388),pe(e instanceof Le||e instanceof Je,25473),n=t instanceof Le?e instanceof Le?function(i,s){return Je.create([i,s],"and")}(t,e):Gv(t,e):e instanceof Le?Gv(e,t):function(i,s){if(pe(i.filters.length>0&&s.filters.length>0,48005),fa(i)&&fa(s))return jS(i,s.getFilters());const o=Mp(i)?i:s,a=Mp(i)?s:i,l=o.filters.map(u=>Lg(u,a));return Je.create(l,"or")}(t,e),$d(n)}function Gv(t,e){if(fa(e))return jS(e,t.getFilters());{const n=e.filters.map(r=>Lg(t,r));return Je.create(n,"or")}}function $d(t){if(pe(t instanceof Le||t instanceof Je,11850),t instanceof Le)return t;const e=t.getFilters();if(e.length===1)return $d(e[0]);if(WS(t))return t;const n=e.map(i=>$d(i)),r=[];return n.forEach(i=>{i instanceof Le?r.push(i):i instanceof Je&&(i.op===t.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:Je.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YD{constructor(){this.Cn=new Fg}addToCollectionParentIndex(e,n){return this.Cn.add(n),G.resolve()}getCollectionParents(e,n){return G.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return G.resolve()}deleteFieldIndex(e,n){return G.resolve()}deleteAllFieldIndexes(e){return G.resolve()}createTargetIndexes(e,n){return G.resolve()}getDocumentsMatchingTarget(e,n){return G.resolve(null)}getIndexType(e,n){return G.resolve(0)}getFieldIndexes(e,n){return G.resolve([])}getNextCollectionGroupToUpdate(e){return G.resolve(null)}getMinOffset(e,n){return G.resolve(xn.min())}getMinOffsetFromCollectionGroup(e,n){return G.resolve(xn.min())}updateCollectionGroup(e,n,r){return G.resolve()}updateIndexEntries(e,n){return G.resolve()}}class Fg{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Qe($e.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Qe($e.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $v="IndexedDbIndexManager",xc=new Uint8Array(0);class XD{constructor(e,n){this.databaseId=n,this.vn=new Fg,this.Fn=new Yr(r=>Hs(r),(r,i)=>Fu(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.vn.has(n)){const r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this.vn.add(n)});const s={collectionId:r,parent:Xt(i)};return zv(e).put(s)}return G.resolve()}getCollectionParents(e,n){const r=[],i=IDBKeyRange.bound([n,""],[_S(n),""],!1,!0);return zv(e).J(i).next(s=>{for(const o of s){if(o.collectionId!==n)break;r.push(gr(o.parent))}return r})}addFieldIndex(e,n){const r=ll(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(l=>[l.fieldPath.canonicalString(),l.kind])}}(n);delete i.indexId;const s=r.add(i);if(n.indexState){const o=Eo(e);return s.next(a=>{o.put(Vv(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){const r=ll(e),i=Eo(e),s=To(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=ll(e),r=To(e),i=Eo(e);return n.Z().next(()=>r.Z()).next(()=>i.Z())}createTargetIndexes(e,n){return G.forEach(this.Mn(n),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){const s=new qv(r).Dn();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,n){const r=To(e);let i=!0;const s=new Map;return G.forEach(this.Mn(n),o=>this.xn(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=Ne();const a=[];return G.forEach(s,(l,u)=>{Z($v,`Using index ${function(P){return`id=${P.indexId}|cg=${P.collectionGroup}|f=${P.fields.map(V=>`${V.fieldPath}:${V.kind}`).join(",")}`}(l)} to execute ${Hs(n)}`);const f=function(P,V){const O=xp(V);if(O===void 0)return null;for(const B of Od(P,O.fieldPath))switch(B.op){case"array-contains-any":return B.value.arrayValue.values||[];case"array-contains":return[B.value]}return null}(u,l),m=function(P,V){const O=new Map;for(const B of ws(V))for(const E of Od(P,B.fieldPath))switch(E.op){case"==":case"in":O.set(B.fieldPath.canonicalString(),E.value);break;case"not-in":case"!=":return O.set(B.fieldPath.canonicalString(),E.value),Array.from(O.values())}return null}(u,l),g=function(P,V){const O=[];let B=!0;for(const E of ws(V)){const I=E.kind===0?Ev(P,E.fieldPath,P.startAt):wv(P,E.fieldPath,P.startAt);O.push(I.value),B&&(B=I.inclusive)}return new ha(O,B)}(u,l),v=function(P,V){const O=[];let B=!0;for(const E of ws(V)){const I=E.kind===0?wv(P,E.fieldPath,P.endAt):Ev(P,E.fieldPath,P.endAt);O.push(I.value),B&&(B=I.inclusive)}return new ha(O,B)}(u,l),T=this.On(l,u,g),x=this.On(l,u,v),D=this.Nn(l,u,m),C=this.Bn(l.indexId,f,T,g.inclusive,x,v.inclusive,D);return G.forEach(C,w=>r.Y(w,n.limit).next(P=>{P.forEach(V=>{const O=oe.fromSegments(V.documentKey);o.has(O)||(o=o.add(O),a.push(O))})}))}).next(()=>a)}return G.resolve(null)})}Mn(e){let n=this.Fn.get(e);return n||(e.filters.length===0?n=[e]:n=QD(Je.create(e.filters,"and")).map(r=>Lp(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.Fn.set(e,n),n)}Bn(e,n,r,i,s,o,a){const l=(n!=null?n.length:1)*Math.max(r.length,s.length),u=l/(n!=null?n.length:1),f=[];for(let m=0;m<l;++m){const g=n?this.Ln(n[m/u]):xc,v=this.kn(e,g,r[m%u],i),T=this.qn(e,g,s[m%u],o),x=a.map(D=>this.kn(e,g,D,!0));f.push(...this.createRange(v,T,x))}return f}kn(e,n,r,i){const s=new Ps(e,oe.empty(),n,r);return i?s:s.An()}qn(e,n,r,i){const s=new Ps(e,oe.empty(),n,r);return i?s.An():s}xn(e,n){const r=new qv(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(const a of s)r.yn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2;const i=this.Mn(n);return G.forEach(i,s=>this.xn(e,s).next(o=>{o?r!==0&&o.fields.length<function(l){let u=new Qe(at.comparator),f=!1;for(const m of l.filters)for(const g of m.getFlattenedFilters())g.field.isKeyField()||(g.op==="array-contains"||g.op==="array-contains-any"?f=!0:u=u.add(g.field));for(const m of l.orderBy)m.field.isKeyField()||(u=u.add(m.field));return u.size+(f?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&i.length>1&&r===2?1:r)}Qn(e,n){const r=new al;for(const i of ws(e)){const s=n.data.field(i.fieldPath);if(s==null)return null;const o=r.Pn(i.kind);Rs.Kt.Dt(s,o)}return r.un()}Ln(e){const n=new al;return Rs.Kt.Dt(e,n.Pn(0)),n.un()}$n(e,n){const r=new al;return Rs.Kt.Dt(au(this.databaseId,n),r.Pn(function(s){const o=ws(s);return o.length===0?0:o[o.length-1].kind}(e))),r.un()}Nn(e,n,r){if(r===null)return[];let i=[];i.push(new al);let s=0;for(const o of ws(e)){const a=r[s++];for(const l of i)if(this.Un(n,o.fieldPath)&&lu(a))i=this.Kn(i,o,a);else{const u=l.Pn(o.kind);Rs.Kt.Dt(a,u)}}return this.Wn(i)}On(e,n,r){return this.Nn(e,n,r.position)}Wn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].un();return n}Kn(e,n,r){const i=[...e],s=[];for(const o of r.arrayValue.values||[])for(const a of i){const l=new al;l.seed(a.un()),Rs.Kt.Dt(o,l.Pn(n.kind)),s.push(l)}return s}Un(e,n){return!!e.filters.find(r=>r instanceof Le&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=ll(e),i=Eo(e);return(n?r.J(Pp,IDBKeyRange.bound(n,n)):r.J()).next(s=>{const o=[];return G.forEach(s,a=>i.get([a.indexId,this.uid]).next(l=>{o.push(function(f,m){const g=m?new eu(m.sequenceNumber,new xn(Ks(m.readTime),new oe(gr(m.documentKey)),m.largestBatchId)):eu.empty(),v=f.fields.map(([T,x])=>new ed(at.fromServerFormat(T),x));return new Dd(f.indexId,f.collectionGroup,v,g)}(a,l))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:Ce(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const i=ll(e),s=Eo(e);return this.Gn(e).next(o=>i.J(Pp,IDBKeyRange.bound(n,n)).next(a=>G.forEach(a,l=>s.put(Vv(l.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){const r=new Map;return G.forEach(n,(i,s)=>{const o=r.get(i.collectionGroup);return(o?G.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),G.forEach(a,l=>this.zn(e,i,l).next(u=>{const f=this.jn(s,l);return u.isEqual(f)?G.resolve():this.Jn(e,s,l,u,f)}))))})}Hn(e,n,r,i){return To(e).put(i.Rn(this.uid,this.$n(r,n.key),n.key))}Yn(e,n,r,i){return To(e).delete(i.Vn(this.uid,this.$n(r,n.key),n.key))}zn(e,n,r){const i=To(e);let s=new Qe(ci);return i.ee({index:PS,range:IDBKeyRange.only([r.indexId,this.uid,ld(this.$n(r,n))])},(o,a)=>{s=s.add(new Ps(r.indexId,n,Bv(a.arrayValue),Bv(a.directionalValue)))}).next(()=>s)}jn(e,n){let r=new Qe(ci);const i=this.Qn(n,e);if(i==null)return r;const s=xp(n);if(s!=null){const o=e.data.field(s.fieldPath);if(lu(o))for(const a of o.arrayValue.values||[])r=r.add(new Ps(n.indexId,e.key,this.Ln(a),i))}else r=r.add(new Ps(n.indexId,e.key,xc,i));return r}Jn(e,n,r,i,s){Z($v,"Updating index entries for document '%s'",n.key);const o=[];return function(l,u,f,m,g){const v=l.getIterator(),T=u.getIterator();let x=yo(v),D=yo(T);for(;x||D;){let C=!1,w=!1;if(x&&D){const P=f(x,D);P<0?w=!0:P>0&&(C=!0)}else x!=null?w=!0:C=!0;C?(m(D),D=yo(T)):w?(g(x),x=yo(v)):(x=yo(v),D=yo(T))}}(i,s,ci,a=>{o.push(this.Hn(e,n,r,a))},a=>{o.push(this.Yn(e,n,r,a))}),G.waitFor(o)}Gn(e){let n=1;return Eo(e).ee({index:RS,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>ci(o,a)).filter((o,a,l)=>!a||ci(o,l[a-1])!==0);const i=[];i.push(e);for(const o of r){const a=ci(o,e),l=ci(o,n);if(a===0)i[0]=e.An();else if(a>0&&l<0)i.push(o),i.push(o.An());else if(l>0)break}i.push(n);const s=[];for(let o=0;o<i.length;o+=2){if(this.Zn(i[o],i[o+1]))return[];const a=i[o].Vn(this.uid,xc,oe.empty()),l=i[o+1].Vn(this.uid,xc,oe.empty());s.push(IDBKeyRange.bound(a,l))}return s}Zn(e,n){return ci(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(Hv)}getMinOffset(e,n){return G.mapArray(this.Mn(n),r=>this.xn(e,r).next(i=>i||he(44426))).next(Hv)}}function zv(t){return bt(t,iu)}function To(t){return bt(t,Ml)}function ll(t){return bt(t,Ig)}function Eo(t){return bt(t,bl)}function Hv(t){pe(t.length!==0,28825);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const i=t[r].indexState.offset;Tg(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new xn(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wv={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},DC=41943040;class jt{static withCacheSize(e){return new jt(e,jt.DEFAULT_COLLECTION_PERCENTILE,jt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bC(t,e,n){const r=t.store(Jn),i=t.store(oa),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const l=r.ee({range:o},(f,m,g)=>(a++,g.delete()));s.push(l.next(()=>{pe(a===1,47070,{batchId:n.batchId})}));const u=[];for(const f of n.mutations){const m=CS(e,f.key.path,n.batchId);s.push(i.delete(m)),u.push(f.key)}return G.waitFor(s).next(()=>u)}function zd(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw he(14731);e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */jt.DEFAULT_COLLECTION_PERCENTILE=10,jt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,jt.DEFAULT=new jt(DC,jt.DEFAULT_COLLECTION_PERCENTILE,jt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),jt.DISABLED=new jt(-1,0,0);class $h{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Xn={}}static wt(e,n,r,i){pe(e.uid!=="",64387);const s=e.isAuthenticated()?e.uid:"";return new $h(s,n,r,i)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return di(e).ee({index:Ns,range:r},(i,s,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,i){const s=Ro(e),o=di(e);return o.add({}).next(a=>{pe(typeof a=="number",49019);const l=new Ng(a,n,r,i),u=function(v,T,x){const D=x.baseMutations.map(w=>qd(v.yt,w)),C=x.mutations.map(w=>qd(v.yt,w));return{userId:T,batchId:x.batchId,localWriteTimeMs:x.localWriteTime.toMillis(),baseMutations:D,mutations:C}}(this.serializer,this.userId,l),f=[];let m=new Qe((g,v)=>Ce(g.canonicalString(),v.canonicalString()));for(const g of i){const v=CS(this.userId,g.key.path,a);m=m.add(g.key.path.popLast()),f.push(o.put(u)),f.push(s.put(v,xN))}return m.forEach(g=>{f.push(this.indexManager.addToCollectionParentIndex(e,g))}),e.addOnCommittedListener(()=>{this.Xn[a]=l.keys()}),G.waitFor(f).next(()=>l)})}lookupMutationBatch(e,n){return di(e).get(n).next(r=>r?(pe(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:n}),xs(this.serializer,r)):null)}er(e,n){return this.Xn[n]?G.resolve(this.Xn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const i=r.keys();return this.Xn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return di(e).ee({index:Ns,range:i},(o,a,l)=>{a.userId===this.userId&&(pe(a.batchId>=r,47524,{tr:r}),s=xs(this.serializer,a)),l.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=Ls;return di(e).ee({index:Ns,range:n,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,Ls],[this.userId,Number.POSITIVE_INFINITY]);return di(e).J(Ns,n).next(r=>r.map(i=>xs(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=td(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return Ro(e).ee({range:i},(o,a,l)=>{const[u,f,m]=o,g=gr(f);if(u===this.userId&&n.path.isEqual(g))return di(e).get(m).next(v=>{if(!v)throw he(61480,{nr:o,batchId:m});pe(v.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:v.userId,batchId:m}),s.push(xs(this.serializer,v))});l.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Qe(Ce);const i=[];return n.forEach(s=>{const o=td(this.userId,s.path),a=IDBKeyRange.lowerBound(o),l=Ro(e).ee({range:a},(u,f,m)=>{const[g,v,T]=u,x=gr(v);g===this.userId&&s.path.isEqual(x)?r=r.add(T):m.done()});i.push(l)}),G.waitFor(i).next(()=>this.rr(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1,s=td(this.userId,r),o=IDBKeyRange.lowerBound(s);let a=new Qe(Ce);return Ro(e).ee({range:o},(l,u,f)=>{const[m,g,v]=l,T=gr(g);m===this.userId&&r.isPrefixOf(T)?T.length===i&&(a=a.add(v)):f.done()}).next(()=>this.rr(e,a))}rr(e,n){const r=[],i=[];return n.forEach(s=>{i.push(di(e).get(s).next(o=>{if(o===null)throw he(35274,{batchId:s});pe(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:s}),r.push(xs(this.serializer,o))}))}),G.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return bC(e.le,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.ir(n.batchId)}),G.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return G.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return Ro(e).ee({range:r},(s,o,a)=>{if(s[0]===this.userId){const l=gr(s[1]);i.push(l)}else a.done()}).next(()=>{pe(i.length===0,56720,{sr:i.map(s=>s.canonicalString())})})})}containsKey(e,n){return MC(e,this.userId,n)}_r(e){return VC(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:Ls,lastStreamToken:""})}}function MC(t,e,n){const r=td(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return Ro(t).ee({range:s,X:!0},(a,l,u)=>{const[f,m,g]=a;f===e&&m===i&&(o=!0),u.done()}).next(()=>o)}function di(t){return bt(t,Jn)}function Ro(t){return bt(t,oa)}function VC(t){return bt(t,nu)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class js{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new js(0)}static cr(){return new js(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZD{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.lr(e).next(n=>{const r=new js(n.highestTargetId);return n.highestTargetId=r.next(),this.hr(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.lr(e).next(n=>ye.fromTimestamp(new We(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.lr(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.lr(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.hr(e,i)))}addTargetData(e,n){return this.Pr(e,n).next(()=>this.lr(e).next(r=>(r.targetCount+=1,this.Tr(n,r),this.hr(e,r))))}updateTargetData(e,n){return this.Pr(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>wo(e).delete(n.targetId)).next(()=>this.lr(e)).next(r=>(pe(r.targetCount>0,8065),r.targetCount-=1,this.hr(e,r)))}removeTargets(e,n,r){let i=0;const s=[];return wo(e).ee((o,a)=>{const l=Il(a);l.sequenceNumber<=n&&r.get(l.targetId)===null&&(i++,s.push(this.removeTargetData(e,l)))}).next(()=>G.waitFor(s)).next(()=>i)}forEachTarget(e,n){return wo(e).ee((r,i)=>{const s=Il(i);n(s)})}lr(e){return Kv(e).get(Vd).next(n=>(pe(n!==null,2888),n))}hr(e,n){return Kv(e).put(Vd,n)}Pr(e,n){return wo(e).put(RC(this.serializer,n))}Tr(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next(n=>n.targetCount)}getTargetData(e,n){const r=Hs(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return wo(e).ee({range:i,index:xS},(o,a,l)=>{const u=Il(a);Fu(n,u.target)&&(s=u,l.done())}).next(()=>s)}addMatchingKeys(e,n,r){const i=[],s=Ti(e);return n.forEach(o=>{const a=Xt(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),G.waitFor(i)}removeMatchingKeys(e,n,r){const i=Ti(e);return G.forEach(n,s=>{const o=Xt(s.path);return G.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){const r=Ti(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),i=Ti(e);let s=Ne();return i.ee({range:r,X:!0},(o,a,l)=>{const u=gr(o[1]),f=new oe(u);s=s.add(f)}).next(()=>s)}containsKey(e,n){const r=Xt(n.path),i=IDBKeyRange.bound([r],[_S(r)],!1,!0);let s=0;return Ti(e).ee({index:wg,X:!0,range:i},([o,a],l,u)=>{o!==0&&(s++,u.done())}).next(()=>s>0)}At(e,n){return wo(e).get(n).next(r=>r?Il(r):null)}}function wo(t){return bt(t,aa)}function Kv(t){return bt(t,Fs)}function Ti(t){return bt(t,la)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jv="LruGarbageCollector",eb=1048576;function Jv([t,e],[n,r]){const i=Ce(t,n);return i===0?Ce(e,r):i}class tb{constructor(e){this.Ir=e,this.buffer=new Qe(Jv),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();Jv(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class LC{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Z(jv,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Qi(n)?Z(jv,"Ignoring IndexedDB error during garbage collection: ",n):await no(n)}await this.Vr(3e5)})}}class nb{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return G.resolve(Un.ce);const r=new tb(n);return this.mr.forEachTarget(e,i=>r.Ar(i.sequenceNumber)).next(()=>this.mr.pr(e,i=>r.Ar(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.mr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(Z("LruGarbageCollector","Garbage collection skipped; disabled"),G.resolve(Wv)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(Z("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Wv):this.yr(e,n))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let r,i,s,o,a,l,u;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(m=>(m>this.params.maximumSequenceNumbersToCollect?(Z("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),i=this.params.maximumSequenceNumbersToCollect):i=m,o=Date.now(),this.nthSequenceNumber(e,i))).next(m=>(r=m,a=Date.now(),this.removeTargets(e,r,n))).next(m=>(s=m,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(m=>(u=Date.now(),So()<=Ve.DEBUG&&Z("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-f}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(l-a)+`ms
	Removed ${m} documents in `+(u-l)+`ms
Total Duration: ${u-f}ms`),G.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:m})))}}function FC(t,e){return new nb(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rb{constructor(e,n){this.db=e,this.garbageCollector=FC(this,n)}gr(e){const n=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}pr(e,n){return this.Sr(e,(r,i)=>n(i))}addReference(e,n,r){return Rc(e,r)}removeReference(e,n,r){return Rc(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return Rc(e,n)}br(e,n){return function(i,s){let o=!1;return VC(i).te(a=>MC(i,a,s).next(l=>(l&&(o=!0),G.resolve(!l)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Sr(e,(o,a)=>{if(a<=n){const l=this.br(e,o).next(u=>{if(!u)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,ye.min()),Ti(e).delete(function(m){return[0,Xt(m.path)]}(o))))});i.push(l)}}).next(()=>G.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return Rc(e,n)}Sr(e,n){const r=Ti(e);let i,s=Un.ce;return r.ee({index:wg},([o,a],{path:l,sequenceNumber:u})=>{o===0?(s!==Un.ce&&n(new oe(gr(i)),s),s=u,i=l):s=Un.ce}).next(()=>{s!==Un.ce&&n(new oe(gr(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Rc(t,e){return Ti(t).put(function(r,i){return{targetId:0,path:Xt(r.path),sequenceNumber:i}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UC{constructor(){this.changes=new Yr(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,gt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?G.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ib{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return vs(e).put(r)}removeEntry(e,n,r){return vs(e).delete(function(s,o){const a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Gd(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.Dr(e,r)))}getEntry(e,n){let r=gt.newInvalidDocument(n);return vs(e).ee({index:nd,range:IDBKeyRange.only(ul(n))},(i,s)=>{r=this.Cr(n,s)}).next(()=>r)}vr(e,n){let r={size:0,document:gt.newInvalidDocument(n)};return vs(e).ee({index:nd,range:IDBKeyRange.only(ul(n))},(i,s)=>{r={document:this.Cr(n,s),size:zd(s)}}).next(()=>r)}getEntries(e,n){let r=Sn();return this.Fr(e,n,(i,s)=>{const o=this.Cr(i,s);r=r.insert(i,o)}).next(()=>r)}Mr(e,n){let r=Sn(),i=new lt(oe.comparator);return this.Fr(e,n,(s,o)=>{const a=this.Cr(s,o);r=r.insert(s,a),i=i.insert(s,zd(o))}).next(()=>({documents:r,Or:i}))}Fr(e,n,r){if(n.isEmpty())return G.resolve();let i=new Qe(Xv);n.forEach(l=>i=i.add(l));const s=IDBKeyRange.bound(ul(i.first()),ul(i.last())),o=i.getIterator();let a=o.getNext();return vs(e).ee({index:nd,range:s},(l,u,f)=>{const m=oe.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;a&&Xv(a,m)<0;)r(a,null),a=o.getNext();a&&a.isEqual(m)&&(r(a,u),a=o.hasNext()?o.getNext():null),a?f.j(ul(a)):f.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,s){const o=n.path,a=[o.popLast().toArray(),o.lastSegment(),Gd(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return vs(e).J(IDBKeyRange.bound(a,l,!0)).next(u=>{s==null||s.incrementDocumentReadCount(u.length);let f=Sn();for(const m of u){const g=this.Cr(oe.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);g.isFoundDocument()&&(Bu(n,g)||i.has(g.key))&&(f=f.insert(g.key,g))}return f})}getAllFromCollectionGroup(e,n,r,i){let s=Sn();const o=Yv(n,r),a=Yv(n,xn.max());return vs(e).ee({index:AS,range:IDBKeyRange.bound(o,a,!0)},(l,u,f)=>{const m=this.Cr(oe.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);s=s.insert(m.key,m),s.size===i&&f.done()}).next(()=>s)}newChangeBuffer(e){return new sb(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return Qv(e).get(Rp).next(n=>(pe(!!n,20021),n))}Dr(e,n){return Qv(e).put(Rp,n)}Cr(e,n){if(n){const r=$D(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(ye.min())))return r}return gt.newInvalidDocument(e)}}function OC(t){return new ib(t)}class sb extends UC{constructor(e,n){super(),this.Nr=e,this.trackRemovals=n,this.Br=new Yr(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const n=[];let r=0,i=new Qe((s,o)=>Ce(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const a=this.Br.get(s);if(n.push(this.Nr.removeEntry(e,s,a.readTime)),o.isValidDocument()){const l=bv(this.Nr.serializer,o);i=i.add(s.path.popLast());const u=zd(l);r+=u-a.size,n.push(this.Nr.addEntry(e,s,l))}else if(r-=a.size,this.trackRemovals){const l=bv(this.Nr.serializer,o.convertToNoDocument(ye.min()));n.push(this.Nr.addEntry(e,s,l))}}),i.forEach(s=>{n.push(this.Nr.indexManager.addToCollectionParentIndex(e,s))}),n.push(this.Nr.updateMetadata(e,r)),G.waitFor(n)}getFromCache(e,n){return this.Nr.vr(e,n).next(r=>(this.Br.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.Nr.Mr(e,n).next(({documents:r,Or:i})=>(i.forEach((s,o)=>{this.Br.set(s,{size:o,readTime:r.get(s).readTime})}),r))}}function Qv(t){return bt(t,ru)}function vs(t){return bt(t,Md)}function ul(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function Yv(t,e){const n=e.documentKey.path.toArray();return[t,Gd(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function Xv(t,e){const n=t.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=Ce(n[s],r[s]),i)return i;return i=Ce(n.length,r.length),i||(i=Ce(n[n.length-2],r[r.length-2]),i||Ce(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ob{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BC{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&Ul(r.mutation,i,hn.empty(),We.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Ne()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Ne()){const i=_r();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=El();return s.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=_r();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Ne()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=Sn();const o=Fl(),a=function(){return Fl()}();return n.forEach((l,u)=>{const f=r.get(u.key);i.has(u.key)&&(f===void 0||f.mutation instanceof Xr)?s=s.insert(u.key,u):f!==void 0?(o.set(u.key,f.mutation.getFieldMask()),Ul(f.mutation,u,f.mutation.getFieldMask(),We.now())):o.set(u.key,hn.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((u,f)=>o.set(u,f)),n.forEach((u,f)=>a.set(u,new ob(f,o.get(u)??null))),a))}recalculateAndSaveOverlays(e,n){const r=Fl();let i=new lt((o,a)=>o-a),s=Ne();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const u=n.get(l);if(u===null)return;let f=r.get(l)||hn.empty();f=a.applyToLocalView(u,f),r.set(l,f);const m=(i.get(a.batchId)||Ne()).add(l);i=i.insert(a.batchId,m)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),u=l.key,f=l.value,m=rC();f.forEach(g=>{if(!s.has(g)){const v=cC(n.get(g),r.get(g));v!==null&&m.set(g,v),s=s.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,m))}return G.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return oe.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):XS(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):G.resolve(_r());let a=Zl,l=s;return o.next(u=>G.forEach(u,(f,m)=>(a<m.largestBatchId&&(a=m.largestBatchId),s.get(f)?G.resolve():this.remoteDocumentCache.getEntry(e,f).next(g=>{l=l.insert(f,g)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,l,u,Ne())).next(f=>({batchId:a,changes:nC(f)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new oe(n)).next(r=>{let i=El();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let o=El();return this.indexManager.getCollectionParents(e,s).next(a=>G.forEach(a,l=>{const u=function(m,g){return new Uu(g,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(n,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,r,i).next(f=>{f.forEach((m,g)=>{o=o.insert(m,g)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((l,u)=>{const f=u.getKey();o.get(f)===null&&(o=o.insert(f,gt.newInvalidDocument(f)))});let a=El();return o.forEach((l,u)=>{const f=s.get(l);f!==void 0&&Ul(f.mutation,u,hn.empty(),We.now()),Bu(n,u)&&(a=a.insert(l,u))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ab{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return G.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:on(i.createTime)}}(n)),G.resolve()}getNamedQuery(e,n){return G.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,function(i){return{name:i.name,query:PC(i.bundledQuery),readTime:on(i.readTime)}}(n)),G.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lb{constructor(){this.overlays=new lt(oe.comparator),this.qr=new Map}getOverlay(e,n){return G.resolve(this.overlays.get(n))}getOverlays(e,n){const r=_r();return G.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.St(e,n,s)}),G.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.qr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.qr.delete(r)),G.resolve()}getOverlaysForCollection(e,n,r){const i=_r(),s=n.length+1,o=new oe(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,u=l.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return G.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new lt((u,f)=>u-f);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let f=s.get(u.largestBatchId);f===null&&(f=_r(),s=s.insert(u.largestBatchId,f)),f.set(u.getKey(),u)}}const a=_r(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((u,f)=>a.set(u,f)),!(a.size()>=i)););return G.resolve(a)}St(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new bg(n,r));let s=this.qr.get(n);s===void 0&&(s=Ne(),this.qr.set(n,s)),this.qr.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ub{constructor(){this.sessionToken=Tt.EMPTY_BYTE_STRING}getSessionToken(e){return G.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,G.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ug{constructor(){this.Qr=new Qe(Ft.$r),this.Ur=new Qe(Ft.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const r=new Ft(e,n);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Gr(new Ft(e,n))}zr(e,n){e.forEach(r=>this.removeReference(r,n))}jr(e){const n=new oe(new $e([])),r=new Ft(n,e),i=new Ft(n,e+1),s=[];return this.Ur.forEachInRange([r,i],o=>{this.Gr(o),s.push(o.key)}),s}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new oe(new $e([])),r=new Ft(n,e),i=new Ft(n,e+1);let s=Ne();return this.Ur.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const n=new Ft(e,0),r=this.Qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Ft{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return oe.comparator(e.key,n.key)||Ce(e.Yr,n.Yr)}static Kr(e,n){return Ce(e.Yr,n.Yr)||oe.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cb{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new Qe(Ft.$r)}checkEmpty(e){return G.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Ng(s,n,r,i);this.mutationQueue.push(o);for(const a of i)this.Zr=this.Zr.add(new Ft(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return G.resolve(o)}lookupMutationBatch(e,n){return G.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.ei(r),s=i<0?0:i;return G.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return G.resolve(this.mutationQueue.length===0?Ls:this.tr-1)}getAllMutationBatches(e){return G.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Ft(n,0),i=new Ft(n,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([r,i],o=>{const a=this.Xr(o.Yr);s.push(a)}),G.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Qe(Ce);return n.forEach(i=>{const s=new Ft(i,0),o=new Ft(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,o],a=>{r=r.add(a.Yr)})}),G.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;oe.isDocumentKey(s)||(s=s.child(""));const o=new Ft(new oe(s),0);let a=new Qe(Ce);return this.Zr.forEachWhile(l=>{const u=l.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(a=a.add(l.Yr)),!0)},o),G.resolve(this.ti(a))}ti(e){const n=[];return e.forEach(r=>{const i=this.Xr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){pe(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return G.forEach(n.mutations,i=>{const s=new Ft(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,n){const r=new Ft(n,0),i=this.Zr.firstAfterOrEqual(r);return G.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,G.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class db{constructor(e){this.ri=e,this.docs=function(){return new lt(oe.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.ri(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return G.resolve(r?r.document.mutableCopy():gt.newInvalidDocument(n))}getEntries(e,n){let r=Sn();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():gt.newInvalidDocument(i))}),G.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=Sn();const o=n.path,a=new oe(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:u,value:{document:f}}=l.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||Tg(ES(f),r)<=0||(i.has(f.key)||Bu(n,f))&&(s=s.insert(f.key,f.mutableCopy()))}return G.resolve(s)}getAllFromCollectionGroup(e,n,r,i){he(9500)}ii(e,n){return G.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new hb(this)}getSize(e){return G.resolve(this.size)}}class hb extends UC{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)}),G.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fb{constructor(e){this.persistence=e,this.si=new Yr(n=>Hs(n),Fu),this.lastRemoteSnapshotVersion=ye.min(),this.highestTargetId=0,this.oi=0,this._i=new Ug,this.targetCount=0,this.ai=js.ur()}forEachTarget(e,n){return this.si.forEach((r,i)=>n(i)),G.resolve()}getLastRemoteSnapshotVersion(e){return G.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return G.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),G.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.oi&&(this.oi=n),G.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new js(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,G.resolve()}updateTargetData(e,n){return this.Pr(n),G.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,G.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.si.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.si.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),G.waitFor(s).next(()=>i)}getTargetCount(e){return G.resolve(this.targetCount)}getTargetData(e,n){const r=this.si.get(n)||null;return G.resolve(r)}addMatchingKeys(e,n,r){return this._i.Wr(n,r),G.resolve()}removeMatchingKeys(e,n,r){this._i.zr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),G.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),G.resolve()}getMatchingKeysForTargetId(e,n){const r=this._i.Hr(n);return G.resolve(r)}containsKey(e,n){return G.resolve(this._i.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Og{constructor(e,n){this.ui={},this.overlays={},this.ci=new Un(0),this.li=!1,this.li=!0,this.hi=new ub,this.referenceDelegate=e(this),this.Pi=new fb(this),this.indexManager=new YD,this.remoteDocumentCache=function(i){return new db(i)}(r=>this.referenceDelegate.Ti(r)),this.serializer=new xC(n),this.Ii=new ab(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new lb,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ui[e.toKey()];return r||(r=new cb(n,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,r){Z("MemoryPersistence","Starting transaction:",e);const i=new pb(this.ci.next());return this.referenceDelegate.Ei(),r(i).next(s=>this.referenceDelegate.di(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ai(e,n){return G.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,n)))}}class pb extends IS{constructor(e){super(),this.currentSequenceNumber=e}}class zh{constructor(e){this.persistence=e,this.Ri=new Ug,this.Vi=null}static mi(e){return new zh(e)}get fi(){if(this.Vi)return this.Vi;throw he(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.fi.delete(r.toString()),G.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.fi.add(r.toString()),G.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),G.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach(i=>this.fi.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.fi.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return G.forEach(this.fi,r=>{const i=oe.fromPath(r);return this.gi(e,i).next(s=>{s||n.removeEntry(i,ye.min())})}).next(()=>(this.Vi=null,n.apply(e)))}updateLimboDocument(e,n){return this.gi(e,n).next(r=>{r?this.fi.delete(n.toString()):this.fi.add(n.toString())})}Ti(e){return 0}gi(e,n){return G.or([()=>G.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class Hd{constructor(e,n){this.persistence=e,this.pi=new Yr(r=>Xt(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=FC(this,n)}static mi(e,n){return new Hd(e,n)}Ei(){}di(e){return G.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}pr(e,n){return G.forEach(this.pi,(r,i)=>this.br(e,r,i).next(s=>s?G.resolve():n(i)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ii(e,o=>this.br(e,o,n).next(a=>{a||(r++,s.removeEntry(o,ye.min()))})).next(()=>s.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),G.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),G.resolve()}removeReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),G.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),G.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=id(e.data.value)),n}br(e,n,r){return G.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const i=this.pi.get(n);return G.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mb{constructor(e){this.serializer=e}k(e,n,r,i){const s=new kh("createOrUpgrade",n);r<1&&i>=1&&(function(l){l.createObjectStore(Lu)}(e),function(l){l.createObjectStore(nu,{keyPath:AN}),l.createObjectStore(Jn,{keyPath:uv,autoIncrement:!0}).createIndex(Ns,cv,{unique:!0}),l.createObjectStore(oa)}(e),Zv(e),function(l){l.createObjectStore(Is)}(e));let o=G.resolve();return r<3&&i>=3&&(r!==0&&(function(l){l.deleteObjectStore(la),l.deleteObjectStore(aa),l.deleteObjectStore(Fs)}(e),Zv(e)),o=o.next(()=>function(l){const u=l.store(Fs),f={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:ye.min().toTimestamp(),targetCount:0};return u.put(Vd,f)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(l,u){return u.store(Jn).J().next(m=>{l.deleteObjectStore(Jn),l.createObjectStore(Jn,{keyPath:uv,autoIncrement:!0}).createIndex(Ns,cv,{unique:!0});const g=u.store(Jn),v=m.map(T=>g.put(T));return G.waitFor(v)})}(e,s))),o=o.next(()=>{(function(l){l.createObjectStore(ua,{keyPath:VN})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.yi(s))),r<6&&i>=6&&(o=o.next(()=>(function(l){l.createObjectStore(ru)}(e),this.wi(s)))),r<7&&i>=7&&(o=o.next(()=>this.Si(s))),r<8&&i>=8&&(o=o.next(()=>this.bi(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.Di(s))),r<11&&i>=11&&(o=o.next(()=>{(function(l){l.createObjectStore(Dh,{keyPath:LN})})(e),function(l){l.createObjectStore(bh,{keyPath:FN})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(l){const u=l.createObjectStore(Mh,{keyPath:zN});u.createIndex(kp,HN,{unique:!1}),u.createIndex(kS,WN,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(l){const u=l.createObjectStore(Md,{keyPath:RN});u.createIndex(nd,PN),u.createIndex(AS,kN)}(e)).next(()=>this.Ci(e,s)).next(()=>e.deleteObjectStore(Is))),r<14&&i>=14&&(o=o.next(()=>this.Fi(e,s))),r<15&&i>=15&&(o=o.next(()=>function(l){l.createObjectStore(Ig,{keyPath:UN,autoIncrement:!0}).createIndex(Pp,ON,{unique:!1}),l.createObjectStore(bl,{keyPath:BN}).createIndex(RS,qN,{unique:!1}),l.createObjectStore(Ml,{keyPath:GN}).createIndex(PS,$N,{unique:!1})}(e))),r<16&&i>=16&&(o=o.next(()=>{n.objectStore(bl).clear()}).next(()=>{n.objectStore(Ml).clear()})),r<17&&i>=17&&(o=o.next(()=>{(function(l){l.createObjectStore(Sg,{keyPath:KN})})(e)})),r<18&&i>=18&&wI()&&(o=o.next(()=>{n.objectStore(bl).clear()}).next(()=>{n.objectStore(Ml).clear()})),o}wi(e){let n=0;return e.store(Is).ee((r,i)=>{n+=zd(i)}).next(()=>{const r={byteSize:n};return e.store(ru).put(Rp,r)})}yi(e){const n=e.store(nu),r=e.store(Jn);return n.J().next(i=>G.forEach(i,s=>{const o=IDBKeyRange.bound([s.userId,Ls],[s.userId,s.lastAcknowledgedBatchId]);return r.J(Ns,o).next(a=>G.forEach(a,l=>{pe(l.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:l.batchId});const u=xs(this.serializer,l);return bC(e,s.userId,u).next(()=>{})}))}))}Si(e){const n=e.store(la),r=e.store(Is);return e.store(Fs).get(Vd).next(i=>{const s=[];return r.ee((o,a)=>{const l=new $e(o),u=function(m){return[0,Xt(m)]}(l);s.push(n.get(u).next(f=>f?G.resolve():(m=>n.put({targetId:0,path:Xt(m),sequenceNumber:i.highestListenSequenceNumber}))(l)))}).next(()=>G.waitFor(s))})}bi(e,n){e.createObjectStore(iu,{keyPath:MN});const r=n.store(iu),i=new Fg,s=o=>{if(i.add(o)){const a=o.lastSegment(),l=o.popLast();return r.put({collectionId:a,parent:Xt(l)})}};return n.store(Is).ee({X:!0},(o,a)=>{const l=new $e(o);return s(l.popLast())}).next(()=>n.store(oa).ee({X:!0},([o,a,l],u)=>{const f=gr(a);return s(f.popLast())}))}Di(e){const n=e.store(aa);return n.ee((r,i)=>{const s=Il(i),o=RC(this.serializer,s);return n.put(o)})}Ci(e,n){const r=n.store(Is),i=[];return r.ee((s,o)=>{const a=n.store(Md),l=function(m){return m.document?new oe($e.fromString(m.document.name).popFirst(5)):m.noDocument?oe.fromSegments(m.noDocument.path):m.unknownDocument?oe.fromSegments(m.unknownDocument.path):he(36783)}(o).path.toArray(),u={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(u))}).next(()=>G.waitFor(i))}Fi(e,n){const r=n.store(Jn),i=OC(this.serializer),s=new Og(zh.mi,this.serializer.yt);return r.J().next(o=>{const a=new Map;return o.forEach(l=>{let u=a.get(l.userId)??Ne();xs(this.serializer,l).keys().forEach(f=>u=u.add(f)),a.set(l.userId,u)}),G.forEach(a,(l,u)=>{const f=new qt(u),m=Gh.wt(this.serializer,f),g=s.getIndexManager(f),v=$h.wt(f,this.serializer,g,s.referenceDelegate);return new BC(i,v,m,g).recalculateAndSaveOverlaysForDocumentKeys(new Np(n,Un.ce),l).next()})})}}function Zv(t){t.createObjectStore(la,{keyPath:DN}).createIndex(wg,bN,{unique:!0}),t.createObjectStore(aa,{keyPath:"targetId"}).createIndex(xS,NN,{unique:!0}),t.createObjectStore(Fs)}const hi="IndexedDbPersistence",Bf=18e5,qf=5e3,Gf="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",gb="main";class Bg{constructor(e,n,r,i,s,o,a,l,u,f,m=18){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Mi=s,this.window=o,this.document=a,this.xi=u,this.Oi=f,this.Ni=m,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=g=>Promise.resolve(),!Bg.v())throw new re(j.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new rb(this,i),this.$i=n+gb,this.serializer=new xC(l),this.Ui=new ki(this.$i,this.Ni,new mb(this.serializer)),this.hi=new HD,this.Pi=new ZD(this.referenceDelegate,this.serializer),this.remoteDocumentCache=OC(this.serializer),this.Ii=new zD,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,f===!1&&nn(hi,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new re(j.FAILED_PRECONDITION,Gf);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Pi.getHighestSequenceNumber(e))}).then(e=>{this.ci=new Un(e,this.xi)}).then(()=>{this.li=!0}).catch(e=>(this.Ui&&this.Ui.close(),Promise.reject(e)))}Ji(e){return this.Qi=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget(async()=>{this.started&&await this.Wi()}))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Pc(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Hi(e).next(n=>{n||(this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)))})}).next(()=>this.Yi(e)).next(n=>this.isPrimary&&!n?this.Zi(e).next(()=>!1):!!n&&this.Xi(e).next(()=>!0))).catch(e=>{if(Qi(e))return Z(hi,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Z(hi,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable(()=>this.Qi(e)),this.isPrimary=e})}Hi(e){return cl(e).get(_o).next(n=>G.resolve(this.es(n)))}ts(e){return Pc(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,Bf)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=bt(n,ua);return r.J().next(i=>{const s=this.ss(i,Bf),o=i.filter(a=>s.indexOf(a)===-1);return G.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Ki)for(const n of e)this.Ki.removeItem(this._s(n.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Wi().then(()=>this.ns()).then(()=>this.ji()))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?G.resolve(!0):cl(e).get(_o).next(n=>{if(n!==null&&this.rs(n.leaseTimestampMs,qf)&&!this.us(n.ownerId)){if(this.es(n)&&this.networkEnabled)return!0;if(!this.es(n)){if(!n.allowTabSynchronization)throw new re(j.FAILED_PRECONDITION,Gf);return!1}}return!(!this.networkEnabled||!this.inForeground)||Pc(e).J().next(r=>this.ss(r,qf).find(i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&Z(hi,`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[Lu,ua],e=>{const n=new Np(e,Un.ce);return this.Zi(n).next(()=>this.ts(n))}),this.Ui.close(),this.Ps()}ss(e,n){return e.filter(r=>this.rs(r.updateTimeMs,n)&&!this.us(r.clientId))}Ts(){return this.runTransaction("getActiveClients","readonly",e=>Pc(e).J().next(n=>this.ss(n,Bf).map(r=>r.clientId)))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,n){return $h.wt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new XD(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return Gh.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,n,r){Z(hi,"Starting transaction:",e);const i=n==="readonly"?"readonly":"readwrite",s=function(l){return l===18?QN:l===17?MS:l===16?JN:l===15?Cg:l===14?bS:l===13?DS:l===12?jN:l===11?NS:void he(60245)}(this.Ni);let o;return this.Ui.runTransaction(e,i,s,a=>(o=new Np(a,this.ci?this.ci.next():Un.ce),n==="readwrite-primary"?this.Hi(o).next(l=>!!l||this.Yi(o)).next(l=>{if(!l)throw nn(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)),new re(j.FAILED_PRECONDITION,wS);return r(o)}).next(l=>this.Xi(o).next(()=>l)):this.Is(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Is(e){return cl(e).get(_o).next(n=>{if(n!==null&&this.rs(n.leaseTimestampMs,qf)&&!this.us(n.ownerId)&&!this.es(n)&&!(this.Oi||this.allowTabSynchronization&&n.allowTabSynchronization))throw new re(j.FAILED_PRECONDITION,Gf)})}Xi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return cl(e).put(_o,n)}static v(){return ki.v()}Zi(e){const n=cl(e);return n.get(_o).next(r=>this.es(r)?(Z(hi,"Releasing primary lease."),n.delete(_o)):G.resolve())}rs(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(nn(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi()))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){var e;typeof((e=this.window)==null?void 0:e.addEventListener)=="function"&&(this.Bi=()=>{this.cs();const n=/(?:Version|Mobile)\/1[456]/;EI()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){var n;try{const r=((n=this.Ki)==null?void 0:n.getItem(this._s(e)))!==null;return Z(hi,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return nn(hi,"Failed to get zombied client id.",r),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){nn("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function cl(t){return bt(t,Lu)}function Pc(t){return bt(t,ua)}function _b(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qg{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.Es=r,this.ds=i}static As(e,n){let r=Ne(),i=Ne();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new qg(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yb{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qC{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return EI()?8:SS(Nt())>0?6:4}()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.ys(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ws(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new yb;return this.Ss(e,n,o).next(a=>{if(s.result=a,this.Vs)return this.bs(e,n,o,a.size)})}).next(()=>s.result)}bs(e,n,r,i){return r.documentReadCount<this.fs?(So()<=Ve.DEBUG&&Z("QueryEngine","SDK will not create cache indexes for query:",Co(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),G.resolve()):(So()<=Ve.DEBUG&&Z("QueryEngine","Query:",Co(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?(So()<=Ve.DEBUG&&Z("QueryEngine","The SDK decides to create cache indexes for query:",Co(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,qn(n))):G.resolve())}ys(e,n){if(Iv(n))return G.resolve(null);let r=qn(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=Up(n,null,"F"),r=qn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=Ne(...s);return this.ps.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const u=this.Ds(n,a);return this.Cs(n,u,o,l.readTime)?this.ys(e,Up(n,null,"F")):this.vs(e,u,n,l)}))})))}ws(e,n,r,i){return Iv(n)||i.isEqual(ye.min())?G.resolve(null):this.ps.getDocuments(e,r).next(s=>{const o=this.Ds(n,s);return this.Cs(n,o,r,i)?G.resolve(null):(So()<=Ve.DEBUG&&Z("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Co(n)),this.vs(e,o,n,vN(i,Zl)).next(a=>a))})}Ds(e,n){let r=new Qe(eC(e));return n.forEach((i,s)=>{Bu(e,s)&&(r=r.add(s))}),r}Cs(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ss(e,n,r){return So()<=Ve.DEBUG&&Z("QueryEngine","Using full collection scan to execute query:",Co(n)),this.ps.getDocumentsMatchingQuery(e,n,xn.min(),r)}vs(e,n,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gg="LocalStore",vb=3e8;class Tb{constructor(e,n,r,i){this.persistence=e,this.Fs=n,this.serializer=i,this.Ms=new lt(Ce),this.xs=new Yr(s=>Hs(s),Fu),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new BC(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ms))}}function GC(t,e,n,r){return new Tb(t,e,n,r)}async function $C(t,e){const n=Ae(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.Bs(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],a=[];let l=Ne();for(const u of i){o.push(u.batchId);for(const f of u.mutations)l=l.add(f.key)}for(const u of s){a.push(u.batchId);for(const f of u.mutations)l=l.add(f.key)}return n.localDocuments.getDocuments(r,l).next(u=>({Ls:u,removedBatchIds:o,addedBatchIds:a}))})})}function Eb(t,e){const n=Ae(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.Ns.newChangeBuffer({trackRemovals:!0});return function(a,l,u,f){const m=u.batch,g=m.keys();let v=G.resolve();return g.forEach(T=>{v=v.next(()=>f.getEntry(l,T)).next(x=>{const D=u.docVersions.get(T);pe(D!==null,48541),x.version.compareTo(D)<0&&(m.applyToRemoteDocument(x,u),x.isValidDocument()&&(x.setReadTime(u.commitVersion),f.addEntry(x)))})}),v.next(()=>a.mutationQueue.removeMutationBatch(l,m))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=Ne();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(l=l.add(a.batch.mutations[u].key));return l}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function zC(t){const e=Ae(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Pi.getLastRemoteSnapshotVersion(n))}function wb(t,e){const n=Ae(t),r=e.snapshotVersion;let i=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.Ns.newChangeBuffer({trackRemovals:!0});i=n.Ms;const a=[];e.targetChanges.forEach((f,m)=>{const g=i.get(m);if(!g)return;a.push(n.Pi.removeMatchingKeys(s,f.removedDocuments,m).next(()=>n.Pi.addMatchingKeys(s,f.addedDocuments,m)));let v=g.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(m)!==null?v=v.withResumeToken(Tt.EMPTY_BYTE_STRING,ye.min()).withLastLimboFreeSnapshotVersion(ye.min()):f.resumeToken.approximateByteSize()>0&&(v=v.withResumeToken(f.resumeToken,r)),i=i.insert(m,v),function(x,D,C){return x.resumeToken.approximateByteSize()===0||D.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=vb?!0:C.addedDocuments.size+C.modifiedDocuments.size+C.removedDocuments.size>0}(g,v,f)&&a.push(n.Pi.updateTargetData(s,v))});let l=Sn(),u=Ne();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,f))}),a.push(Ib(s,o,e.documentUpdates).next(f=>{l=f.ks,u=f.qs})),!r.isEqual(ye.min())){const f=n.Pi.getLastRemoteSnapshotVersion(s).next(m=>n.Pi.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(f)}return G.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,l,u)).next(()=>l)}).then(s=>(n.Ms=i,s))}function Ib(t,e,n){let r=Ne(),i=Ne();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=Sn();return n.forEach((a,l)=>{const u=s.get(a);l.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(a)),l.isNoDocument()&&l.version.isEqual(ye.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):Z(Gg,"Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",l.version)}),{ks:o,qs:i}})}function Sb(t,e){const n=Ae(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=Ls),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Cb(t,e){const n=Ae(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Pi.getTargetData(r,e).next(s=>s?(i=s,G.resolve(i)):n.Pi.allocateTargetId(r).next(o=>(i=new Fr(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Pi.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.Ms.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(r.targetId,r),n.xs.set(e,r.targetId)),r})}async function Wp(t,e,n){const r=Ae(t),i=r.Ms.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!Qi(o))throw o;Z(Gg,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(i.target)}function eT(t,e,n){const r=Ae(t);let i=ye.min(),s=Ne();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,u,f){const m=Ae(l),g=m.xs.get(f);return g!==void 0?G.resolve(m.Ms.get(g)):m.Pi.getTargetData(u,f)}(r,o,qn(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,a.targetId).next(l=>{s=l})}).next(()=>r.Fs.getDocumentsMatchingQuery(o,e,n?i:ye.min(),n?s:Ne())).next(a=>(Ab(r,dD(e),a),{documents:a,Qs:s})))}function Ab(t,e,n){let r=t.Os.get(e)||ye.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.Os.set(e,r)}class tT{constructor(){this.activeTargetIds=_D()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class HC{constructor(){this.Mo=new tT,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,r){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new tT,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xb{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nT="ConnectivityMonitor";class rT{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Z(nT,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Z(nT,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let kc=null;function Kp(){return kc===null?kc=function(){return 268435456+Math.round(2147483648*Math.random())}():kc++,"0x"+kc.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $f="RestConnection",Rb={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Pb{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===Ld?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,n,r,i,s){const o=Kp(),a=this.zo(e,n.toUriEncodedString());Z($f,`Sending RPC '${e}' ${o}:`,a,r);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,i,s);const{host:u}=new URL(a),f=xa(u);return this.Jo(e,a,l,r,f).then(m=>(Z($f,`Received RPC '${e}' ${o}: `,m),m),m=>{throw Gi($f,`RPC '${e}' ${o} failed with error: `,m,"url: ",a,"request:",r),m})}Ho(e,n,r,i,s,o){return this.Go(e,n,r,i,s)}jo(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ka}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((i,s)=>e[s]=i),r&&r.headers.forEach((i,s)=>e[s]=i)}zo(e,n){const r=Rb[e];return`${this.Uo}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kb{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ht="WebChannelConnection";class Nb extends Pb{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,i,s){const o=Kp();return new Promise((a,l)=>{const u=new lS;u.setWithCredentials(!0),u.listenOnce(uS.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case Zc.NO_ERROR:const m=u.getResponseJson();Z(Ht,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(m)),a(m);break;case Zc.TIMEOUT:Z(Ht,`RPC '${e}' ${o} timed out`),l(new re(j.DEADLINE_EXCEEDED,"Request time out"));break;case Zc.HTTP_ERROR:const g=u.getStatus();if(Z(Ht,`RPC '${e}' ${o} failed with status:`,g,"response text:",u.getResponseText()),g>0){let v=u.getResponseJson();Array.isArray(v)&&(v=v[0]);const T=v==null?void 0:v.error;if(T&&T.status&&T.message){const x=function(C){const w=C.toLowerCase().replace(/_/g,"-");return Object.values(j).indexOf(w)>=0?w:j.UNKNOWN}(T.status);l(new re(x,T.message))}else l(new re(j.UNKNOWN,"Server responded with status "+u.getStatus()))}else l(new re(j.UNAVAILABLE,"Connection failed."));break;default:he(9055,{l_:e,streamId:o,h_:u.getLastErrorCode(),P_:u.getLastError()})}}finally{Z(Ht,`RPC '${e}' ${o} completed.`)}});const f=JSON.stringify(i);Z(Ht,`RPC '${e}' ${o} sending request:`,i),u.send(n,"POST",f,r,15)})}T_(e,n,r){const i=Kp(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=hS(),a=dS(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(l.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,n,r),l.encodeInitMessageHeaders=!0;const f=s.join("");Z(Ht,`Creating RPC '${e}' stream ${i}: ${f}`,l);const m=o.createWebChannel(f,l);this.I_(m);let g=!1,v=!1;const T=new kb({Yo:D=>{v?Z(Ht,`Not sending because RPC '${e}' stream ${i} is closed:`,D):(g||(Z(Ht,`Opening RPC '${e}' stream ${i} transport.`),m.open(),g=!0),Z(Ht,`RPC '${e}' stream ${i} sending:`,D),m.send(D))},Zo:()=>m.close()}),x=(D,C,w)=>{D.listen(C,P=>{try{w(P)}catch(V){setTimeout(()=>{throw V},0)}})};return x(m,Tl.EventType.OPEN,()=>{v||(Z(Ht,`RPC '${e}' stream ${i} transport opened.`),T.o_())}),x(m,Tl.EventType.CLOSE,()=>{v||(v=!0,Z(Ht,`RPC '${e}' stream ${i} transport closed`),T.a_(),this.E_(m))}),x(m,Tl.EventType.ERROR,D=>{v||(v=!0,Gi(Ht,`RPC '${e}' stream ${i} transport errored. Name:`,D.name,"Message:",D.message),T.a_(new re(j.UNAVAILABLE,"The operation could not be completed")))}),x(m,Tl.EventType.MESSAGE,D=>{var C;if(!v){const w=D.data[0];pe(!!w,16349);const P=w,V=(P==null?void 0:P.error)||((C=P[0])==null?void 0:C.error);if(V){Z(Ht,`RPC '${e}' stream ${i} received error:`,V);const O=V.status;let B=function(A){const k=wt[A];if(k!==void 0)return fC(k)}(O),E=V.message;B===void 0&&(B=j.INTERNAL,E="Unknown error status: "+O+" with message "+V.message),v=!0,T.a_(new re(B,E)),m.close()}else Z(Ht,`RPC '${e}' stream ${i} received:`,w),T.u_(w)}}),x(a,cS.STAT_EVENT,D=>{D.stat===Cp.PROXY?Z(Ht,`RPC '${e}' stream ${i} detected buffering proxy`):D.stat===Cp.NOPROXY&&Z(Ht,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{T.__()},0),T}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(n=>n===e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Db(){return typeof window<"u"?window:null}function ud(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hh(t){return new bD(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WC{constructor(e,n,r=1e3,i=1.5,s=6e4){this.Mi=e,this.timerId=n,this.d_=r,this.A_=i,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,n-r);i>0&&Z("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iT="PersistentStream";class KC{constructor(e,n,r,i,s,o,a,l){this.Mi=e,this.S_=r,this.b_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new WC(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===j.RESOURCE_EXHAUSTED?(nn(n.toString()),nn("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===j.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.D_===n&&this.G_(r,i)},r=>{e(()=>{const i=new re(j.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)})})}G_(e,n){const r=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(i=>{r(()=>this.z_(i))}),this.stream.onMessage(i=>{r(()=>++this.F_==1?this.J_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return Z(iT,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget(()=>this.D_===e?n():(Z(iT,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class bb extends KC{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=LD(this.serializer,e),r=function(s){if(!("targetChange"in s))return ye.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?ye.min():o.readTime?on(o.readTime):ye.min()}(e);return this.listener.H_(n,r)}Y_(e){const n={};n.database=qp(this.serializer),n.addTarget=function(s,o){let a;const l=o.target;if(a=Ud(l)?{documents:EC(s,l)}:{query:wC(s,l).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=gC(s,o.resumeToken);const u=Op(s,o.expectedCount);u!==null&&(a.expectedCount=u)}else if(o.snapshotVersion.compareTo(ye.min())>0){a.readTime=_a(s,o.snapshotVersion.toTimestamp());const u=Op(s,o.expectedCount);u!==null&&(a.expectedCount=u)}return a}(this.serializer,e);const r=UD(this.serializer,e);r&&(n.labels=r),this.q_(n)}Z_(e){const n={};n.database=qp(this.serializer),n.removeTarget=e,this.q_(n)}}class Mb extends KC{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return pe(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,pe(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){pe(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=FD(e.writeResults,e.commitTime),r=on(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=qp(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>qd(this.serializer,r))};this.q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vb{}class Lb extends Vb{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new re(j.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Go(e,Bp(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===j.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new re(j.UNKNOWN,s.toString())})}Ho(e,n,r,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Ho(e,Bp(n,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===j.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new re(j.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class Fb{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(nn(n),this.aa=!1):Z("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Js="RemoteStore";class Ub{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo(o=>{r.enqueueAndForget(async()=>{ro(this)&&(Z(Js,"Restarting streams for network reachability change."),await async function(l){const u=Ae(l);u.Ea.add(4),await Gu(u),u.Ra.set("Unknown"),u.Ea.delete(4),await Wh(u)}(this))})}),this.Ra=new Fb(r,i)}}async function Wh(t){if(ro(t))for(const e of t.da)await e(!0)}async function Gu(t){for(const e of t.da)await e(!1)}function jC(t,e){const n=Ae(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),Wg(n)?Hg(n):Da(n).O_()&&zg(n,e))}function $g(t,e){const n=Ae(t),r=Da(n);n.Ia.delete(e),r.O_()&&JC(n,e),n.Ia.size===0&&(r.O_()?r.L_():ro(n)&&n.Ra.set("Unknown"))}function zg(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ye.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Da(t).Y_(e)}function JC(t,e){t.Va.Ue(e),Da(t).Z_(e)}function Hg(t){t.Va=new PD({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),Da(t).start(),t.Ra.ua()}function Wg(t){return ro(t)&&!Da(t).x_()&&t.Ia.size>0}function ro(t){return Ae(t).Ea.size===0}function QC(t){t.Va=void 0}async function Ob(t){t.Ra.set("Online")}async function Bb(t){t.Ia.forEach((e,n)=>{zg(t,e)})}async function qb(t,e){QC(t),Wg(t)?(t.Ra.ha(e),Hg(t)):t.Ra.set("Unknown")}async function Gb(t,e,n){if(t.Ra.set("Online"),e instanceof mC&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const a of s.targetIds)i.Ia.has(a)&&(await i.remoteSyncer.rejectListen(a,o),i.Ia.delete(a),i.Va.removeTarget(a))}(t,e)}catch(r){Z(Js,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Wd(t,r)}else if(e instanceof ad?t.Va.Ze(e):e instanceof pC?t.Va.st(e):t.Va.tt(e),!n.isEqual(ye.min()))try{const r=await zC(t.localStore);n.compareTo(r)>=0&&await function(s,o){const a=s.Va.Tt(o);return a.targetChanges.forEach((l,u)=>{if(l.resumeToken.approximateByteSize()>0){const f=s.Ia.get(u);f&&s.Ia.set(u,f.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,u)=>{const f=s.Ia.get(l);if(!f)return;s.Ia.set(l,f.withResumeToken(Tt.EMPTY_BYTE_STRING,f.snapshotVersion)),JC(s,l);const m=new Fr(f.target,l,u,f.sequenceNumber);zg(s,m)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){Z(Js,"Failed to raise snapshot:",r),await Wd(t,r)}}async function Wd(t,e,n){if(!Qi(e))throw e;t.Ea.add(1),await Gu(t),t.Ra.set("Offline"),n||(n=()=>zC(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Z(Js,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await Wh(t)})}function YC(t,e){return e().catch(n=>Wd(t,n,e))}async function $u(t){const e=Ae(t),n=Wi(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Ls;for(;$b(e);)try{const i=await Sb(e.localStore,r);if(i===null){e.Ta.length===0&&n.L_();break}r=i.batchId,zb(e,i)}catch(i){await Wd(e,i)}XC(e)&&ZC(e)}function $b(t){return ro(t)&&t.Ta.length<10}function zb(t,e){t.Ta.push(e);const n=Wi(t);n.O_()&&n.X_&&n.ea(e.mutations)}function XC(t){return ro(t)&&!Wi(t).x_()&&t.Ta.length>0}function ZC(t){Wi(t).start()}async function Hb(t){Wi(t).ra()}async function Wb(t){const e=Wi(t);for(const n of t.Ta)e.ea(n.mutations)}async function Kb(t,e,n){const r=t.Ta.shift(),i=Dg.from(r,e,n);await YC(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await $u(t)}async function jb(t,e){e&&Wi(t).X_&&await async function(r,i){if(function(o){return AD(o)&&o!==j.ABORTED}(i.code)){const s=r.Ta.shift();Wi(r).B_(),await YC(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await $u(r)}}(t,e),XC(t)&&ZC(t)}async function sT(t,e){const n=Ae(t);n.asyncQueue.verifyOperationInProgress(),Z(Js,"RemoteStore received new credentials");const r=ro(n);n.Ea.add(3),await Gu(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await Wh(n)}async function Jb(t,e){const n=Ae(t);e?(n.Ea.delete(2),await Wh(n)):e||(n.Ea.add(2),await Gu(n),n.Ra.set("Unknown"))}function Da(t){return t.ma||(t.ma=function(n,r,i){const s=Ae(n);return s.sa(),new bb(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Xo:Ob.bind(null,t),t_:Bb.bind(null,t),r_:qb.bind(null,t),H_:Gb.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),Wg(t)?Hg(t):t.Ra.set("Unknown")):(await t.ma.stop(),QC(t))})),t.ma}function Wi(t){return t.fa||(t.fa=function(n,r,i){const s=Ae(n);return s.sa(),new Mb(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:Hb.bind(null,t),r_:jb.bind(null,t),ta:Wb.bind(null,t),na:Kb.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await $u(t)):(await t.fa.stop(),t.Ta.length>0&&(Z(Js,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kg{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new vr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const o=Date.now()+r,a=new Kg(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new re(j.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function jg(t,e){if(nn("AsyncQueue",`${e}: ${t}`),Qi(t))return new re(j.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ko{static emptySet(e){return new Ko(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||oe.comparator(n.key,r.key):(n,r)=>oe.comparator(n.key,r.key),this.keyedMap=El(),this.sortedSet=new lt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Ko)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Ko;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oT{constructor(){this.ga=new lt(oe.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):he(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,r)=>{e.push(r)}),e}}class ya{constructor(e,n,r,i,s,o,a,l,u){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,n,r,i,s){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new ya(e,n,Ko.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Fh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qb{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class Yb{constructor(){this.queries=aT(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const i=Ae(n),s=i.queries;i.queries=aT(),s.forEach((o,a)=>{for(const l of a.Sa)l.onError(r)})})(this,new re(j.ABORTED,"Firestore shutting down"))}}function aT(){return new Yr(t=>ZS(t),Fh)}async function Jg(t,e){const n=Ae(t);let r=3;const i=e.query;let s=n.queries.get(i);s?!s.ba()&&e.Da()&&(r=2):(s=new Qb,r=e.Da()?0:1);try{switch(r){case 0:s.wa=await n.onListen(i,!0);break;case 1:s.wa=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(o){const a=jg(o,`Initialization of query '${Co(e.query)}' failed`);return void e.onError(a)}n.queries.set(i,s),s.Sa.push(e),e.va(n.onlineState),s.wa&&e.Fa(s.wa)&&Yg(n)}async function Qg(t,e){const n=Ae(t),r=e.query;let i=3;const s=n.queries.get(r);if(s){const o=s.Sa.indexOf(e);o>=0&&(s.Sa.splice(o,1),s.Sa.length===0?i=e.Da()?0:1:!s.ba()&&e.Da()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function Xb(t,e){const n=Ae(t);let r=!1;for(const i of e){const s=i.query,o=n.queries.get(s);if(o){for(const a of o.Sa)a.Fa(i)&&(r=!0);o.wa=i}}r&&Yg(n)}function Zb(t,e,n){const r=Ae(t),i=r.queries.get(e);if(i)for(const s of i.Sa)s.onError(n);r.queries.delete(e)}function Yg(t){t.Ca.forEach(e=>{e.next()})}var jp,lT;(lT=jp||(jp={})).Ma="default",lT.Cache="cache";class Xg{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new ya(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=ya.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==jp.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e0{constructor(e){this.key=e}}class t0{constructor(e){this.key=e}}class eM{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Ne(),this.mutatedKeys=Ne(),this.eu=eC(e),this.tu=new Ko(this.eu)}get nu(){return this.Ya}ru(e,n){const r=n?n.iu:new oT,i=n?n.tu:this.tu;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((f,m)=>{const g=i.get(f),v=Bu(this.query,m)?m:null,T=!!g&&this.mutatedKeys.has(g.key),x=!!v&&(v.hasLocalMutations||this.mutatedKeys.has(v.key)&&v.hasCommittedMutations);let D=!1;g&&v?g.data.isEqual(v.data)?T!==x&&(r.track({type:3,doc:v}),D=!0):this.su(g,v)||(r.track({type:2,doc:v}),D=!0,(l&&this.eu(v,l)>0||u&&this.eu(v,u)<0)&&(a=!0)):!g&&v?(r.track({type:0,doc:v}),D=!0):g&&!v&&(r.track({type:1,doc:g}),D=!0,(l||u)&&(a=!0)),D&&(v?(o=o.add(v),s=x?s.add(f):s.delete(f)):(o=o.delete(f),s=s.delete(f)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const f=this.query.limitType==="F"?o.last():o.first();o=o.delete(f.key),s=s.delete(f.key),r.track({type:1,doc:f})}return{tu:o,iu:r,Cs:a,mutatedKeys:s}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((f,m)=>function(v,T){const x=D=>{switch(D){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return he(20277,{Rt:D})}};return x(v)-x(T)}(f.type,m.type)||this.eu(f.doc,m.doc)),this.ou(r),i=i??!1;const a=n&&!i?this._u():[],l=this.Xa.size===0&&this.current&&!i?1:0,u=l!==this.Za;return this.Za=l,o.length!==0||u?{snapshot:new ya(this.query,e.tu,s,o,e.mutatedKeys,l===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new oT,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Ya=this.Ya.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ya=this.Ya.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Ne(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))});const n=[];return e.forEach(r=>{this.Xa.has(r)||n.push(new t0(r))}),this.Xa.forEach(r=>{e.has(r)||n.push(new e0(r))}),n}cu(e){this.Ya=e.Qs,this.Xa=Ne();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return ya.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Zg="SyncEngine";class tM{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class nM{constructor(e){this.key=e,this.hu=!1}}class rM{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Yr(a=>ZS(a),Fh),this.Iu=new Map,this.Eu=new Set,this.du=new lt(oe.comparator),this.Au=new Map,this.Ru=new Ug,this.Vu={},this.mu=new Map,this.fu=js.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function iM(t,e,n=!0){const r=a0(t);let i;const s=r.Tu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await n0(r,e,n,!0),i}async function sM(t,e){const n=a0(t);await n0(n,e,!0,!1)}async function n0(t,e,n,r){const i=await Cb(t.localStore,qn(e)),s=i.targetId,o=t.sharedClientState.addLocalQueryTarget(s,n);let a;return r&&(a=await oM(t,e,s,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&jC(t.remoteStore,i),a}async function oM(t,e,n,r,i){t.pu=(m,g,v)=>async function(x,D,C,w){let P=D.view.ru(C);P.Cs&&(P=await eT(x.localStore,D.query,!1).then(({documents:E})=>D.view.ru(E,P)));const V=w&&w.targetChanges.get(D.targetId),O=w&&w.targetMismatches.get(D.targetId)!=null,B=D.view.applyChanges(P,x.isPrimaryClient,V,O);return cT(x,D.targetId,B.au),B.snapshot}(t,m,g,v);const s=await eT(t.localStore,e,!0),o=new eM(e,s.Qs),a=o.ru(s.documents),l=qu.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),u=o.applyChanges(a,t.isPrimaryClient,l);cT(t,n,u.au);const f=new tM(e,n,o);return t.Tu.set(e,f),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),u.snapshot}async function aM(t,e,n){const r=Ae(t),i=r.Tu.get(e),s=r.Iu.get(i.targetId);if(s.length>1)return r.Iu.set(i.targetId,s.filter(o=>!Fh(o,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Wp(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&$g(r.remoteStore,i.targetId),Jp(r,i.targetId)}).catch(no)):(Jp(r,i.targetId),await Wp(r.localStore,i.targetId,!0))}async function lM(t,e){const n=Ae(t),r=n.Tu.get(e),i=n.Iu.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),$g(n.remoteStore,r.targetId))}async function uM(t,e,n){const r=l0(t);try{const i=await function(o,a){const l=Ae(o),u=We.now(),f=a.reduce((v,T)=>v.add(T.key),Ne());let m,g;return l.persistence.runTransaction("Locally write mutations","readwrite",v=>{let T=Sn(),x=Ne();return l.Ns.getEntries(v,f).next(D=>{T=D,T.forEach((C,w)=>{w.isValidDocument()||(x=x.add(C))})}).next(()=>l.localDocuments.getOverlayedDocuments(v,T)).next(D=>{m=D;const C=[];for(const w of a){const P=SD(w,m.get(w.key).overlayedDocument);P!=null&&C.push(new Xr(w.key,P,zS(P.value.mapValue),rn.exists(!0)))}return l.mutationQueue.addMutationBatch(v,u,C,a)}).next(D=>{g=D;const C=D.applyToLocalDocumentSet(m,x);return l.documentOverlayCache.saveOverlays(v,D.batchId,C)})}).then(()=>({batchId:g.batchId,changes:nC(m)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,l){let u=o.Vu[o.currentUser.toKey()];u||(u=new lt(Ce)),u=u.insert(a,l),o.Vu[o.currentUser.toKey()]=u}(r,i.batchId,n),await zu(r,i.changes),await $u(r.remoteStore)}catch(i){const s=jg(i,"Failed to persist write");n.reject(s)}}async function r0(t,e){const n=Ae(t);try{const r=await wb(n.localStore,e);e.targetChanges.forEach((i,s)=>{const o=n.Au.get(s);o&&(pe(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.hu=!0:i.modifiedDocuments.size>0?pe(o.hu,14607):i.removedDocuments.size>0&&(pe(o.hu,42227),o.hu=!1))}),await zu(n,r,e)}catch(r){await no(r)}}function uT(t,e,n){const r=Ae(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Tu.forEach((s,o)=>{const a=o.view.va(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){const l=Ae(o);l.onlineState=a;let u=!1;l.queries.forEach((f,m)=>{for(const g of m.Sa)g.va(a)&&(u=!0)}),u&&Yg(l)}(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function cM(t,e,n){const r=Ae(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Au.get(e),s=i&&i.key;if(s){let o=new lt(oe.comparator);o=o.insert(s,gt.newNoDocument(s,ye.min()));const a=Ne().add(s),l=new qh(ye.min(),new Map,new lt(Ce),o,a);await r0(r,l),r.du=r.du.remove(s),r.Au.delete(e),e_(r)}else await Wp(r.localStore,e,!1).then(()=>Jp(r,e,n)).catch(no)}async function dM(t,e){const n=Ae(t),r=e.batch.batchId;try{const i=await Eb(n.localStore,e);s0(n,r,null),i0(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await zu(n,i)}catch(i){await no(i)}}async function hM(t,e,n){const r=Ae(t);try{const i=await function(o,a){const l=Ae(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let f;return l.mutationQueue.lookupMutationBatch(u,a).next(m=>(pe(m!==null,37113),f=m.keys(),l.mutationQueue.removeMutationBatch(u,m))).next(()=>l.mutationQueue.performConsistencyCheck(u)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(u,f,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,f)).next(()=>l.localDocuments.getDocuments(u,f))})}(r.localStore,e);s0(r,e,n),i0(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await zu(r,i)}catch(i){await no(i)}}function i0(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function s0(t,e,n){const r=Ae(t);let i=r.Vu[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Vu[r.currentUser.toKey()]=i}}function Jp(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(r=>{t.Ru.containsKey(r)||o0(t,r)})}function o0(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&($g(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),e_(t))}function cT(t,e,n){for(const r of n)r instanceof e0?(t.Ru.addReference(r.key,e),fM(t,r)):r instanceof t0?(Z(Zg,"Document no longer in limbo: "+r.key),t.Ru.removeReference(r.key,e),t.Ru.containsKey(r.key)||o0(t,r.key)):he(19791,{wu:r})}function fM(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Eu.has(r)||(Z(Zg,"New document in limbo: "+n),t.Eu.add(r),e_(t))}function e_(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new oe($e.fromString(e)),r=t.fu.next();t.Au.set(r,new nM(n)),t.du=t.du.insert(n,r),jC(t.remoteStore,new Fr(qn(Ou(n.path)),r,"TargetPurposeLimboResolution",Un.ce))}}async function zu(t,e,n){const r=Ae(t),i=[],s=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((a,l)=>{o.push(r.pu(l,e,n).then(u=>{var f;if((u||n)&&r.isPrimaryClient){const m=u?!u.fromCache:(f=n==null?void 0:n.targetChanges.get(l.targetId))==null?void 0:f.current;r.sharedClientState.updateQueryState(l.targetId,m?"current":"not-current")}if(u){i.push(u);const m=qg.As(l.targetId,u);s.push(m)}}))}),await Promise.all(o),r.Pu.H_(i),await async function(l,u){const f=Ae(l);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>G.forEach(u,g=>G.forEach(g.Es,v=>f.persistence.referenceDelegate.addReference(m,g.targetId,v)).next(()=>G.forEach(g.ds,v=>f.persistence.referenceDelegate.removeReference(m,g.targetId,v)))))}catch(m){if(!Qi(m))throw m;Z(Gg,"Failed to update sequence numbers: "+m)}for(const m of u){const g=m.targetId;if(!m.fromCache){const v=f.Ms.get(g),T=v.snapshotVersion,x=v.withLastLimboFreeSnapshotVersion(T);f.Ms=f.Ms.insert(g,x)}}}(r.localStore,s))}async function pM(t,e){const n=Ae(t);if(!n.currentUser.isEqual(e)){Z(Zg,"User change. New user:",e.toKey());const r=await $C(n.localStore,e);n.currentUser=e,function(s,o){s.mu.forEach(a=>{a.forEach(l=>{l.reject(new re(j.CANCELLED,o))})}),s.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await zu(n,r.Ls)}}function mM(t,e){const n=Ae(t),r=n.Au.get(e);if(r&&r.hu)return Ne().add(r.key);{let i=Ne();const s=n.Iu.get(e);if(!s)return i;for(const o of s){const a=n.Tu.get(o);i=i.unionWith(a.view.nu)}return i}}function a0(t){const e=Ae(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=r0.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=mM.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=cM.bind(null,e),e.Pu.H_=Xb.bind(null,e.eventManager),e.Pu.yu=Zb.bind(null,e.eventManager),e}function l0(t){const e=Ae(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=dM.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=hM.bind(null,e),e}class cu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Hh(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return GC(this.persistence,new qC,e.initialUser,this.serializer)}Cu(e){return new Og(zh.mi,this.serializer)}Du(e){return new HC}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}cu.provider={build:()=>new cu};class gM extends cu{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){pe(this.persistence.referenceDelegate instanceof Hd,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new LC(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?jt.withCacheSize(this.cacheSizeBytes):jt.DEFAULT;return new Og(r=>Hd.mi(r,n),this.serializer)}}class _M extends cu{constructor(e,n,r){super(),this.xu=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await l0(this.xu.syncEngine),await $u(this.xu.remoteStore),await this.persistence.Ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}vu(e){return GC(this.persistence,new qC,e.initialUser,this.serializer)}Fu(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new LC(r,e.asyncQueue,n)}Mu(e,n){const r=new IN(n,this.persistence);return new wN(e.asyncQueue,r)}Cu(e){const n=_b(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?jt.withCacheSize(this.cacheSizeBytes):jt.DEFAULT;return new Bg(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,Db(),ud(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new HC}}class Kd{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>uT(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=pM.bind(null,this.syncEngine),await Jb(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new Yb}()}createDatastore(e){const n=Hh(e.databaseInfo.databaseId),r=function(s){return new Nb(s)}(e.databaseInfo);return function(s,o,a,l){return new Lb(s,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,a){return new Ub(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>uT(this.syncEngine,n,0),function(){return rT.v()?new rT:new xb}())}createSyncEngine(e,n){return function(i,s,o,a,l,u,f){const m=new rM(i,s,o,a,l,u);return f&&(m.gu=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(i){const s=Ae(i);Z(Js,"RemoteStore shutting down."),s.Ea.add(5),await Gu(s),s.Aa.shutdown(),s.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}Kd.provider={build:()=>new Kd};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t_{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):nn("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ki="FirestoreClient";class yM{constructor(e,n,r,i,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=qt.UNAUTHENTICATED,this.clientId=Rh.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{Z(Ki,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(Z(Ki,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new vr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=jg(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function zf(t,e){t.asyncQueue.verifyOperationInProgress(),Z(Ki,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await $C(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function dT(t,e){t.asyncQueue.verifyOperationInProgress();const n=await vM(t);Z(Ki,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>sT(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>sT(e.remoteStore,i)),t._onlineComponents=e}async function vM(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Z(Ki,"Using user provided OfflineComponentProvider");try{await zf(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(i){return i.name==="FirebaseError"?i.code===j.FAILED_PRECONDITION||i.code===j.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;Gi("Error using user provided cache. Falling back to memory cache: "+n),await zf(t,new cu)}}else Z(Ki,"Using default OfflineComponentProvider"),await zf(t,new gM(void 0));return t._offlineComponents}async function u0(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Z(Ki,"Using user provided OnlineComponentProvider"),await dT(t,t._uninitializedComponentsProvider._online)):(Z(Ki,"Using default OnlineComponentProvider"),await dT(t,new Kd))),t._onlineComponents}function TM(t){return u0(t).then(e=>e.syncEngine)}async function jd(t){const e=await u0(t),n=e.eventManager;return n.onListen=iM.bind(null,e.syncEngine),n.onUnlisten=aM.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=sM.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=lM.bind(null,e.syncEngine),n}function EM(t,e,n={}){const r=new vr;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,u){const f=new t_({next:g=>{f.Nu(),o.enqueueAndForget(()=>Qg(s,m));const v=g.docs.has(a);!v&&g.fromCache?u.reject(new re(j.UNAVAILABLE,"Failed to get document because the client is offline.")):v&&g.fromCache&&l&&l.source==="server"?u.reject(new re(j.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(g)},error:g=>u.reject(g)}),m=new Xg(Ou(a.path),f,{includeMetadataChanges:!0,qa:!0});return Jg(s,m)}(await jd(t),t.asyncQueue,e,n,r)),r.promise}function wM(t,e,n={}){const r=new vr;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,u){const f=new t_({next:g=>{f.Nu(),o.enqueueAndForget(()=>Qg(s,m)),g.fromCache&&l.source==="server"?u.reject(new re(j.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(g)},error:g=>u.reject(g)}),m=new Xg(a,f,{includeMetadataChanges:!0,qa:!0});return Jg(s,m)}(await jd(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c0(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hT=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d0="firestore.googleapis.com",fT=!0;class pT{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new re(j.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=d0,this.ssl=fT}else this.host=e.host,this.ssl=e.ssl??fT;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=DC;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<eb)throw new re(j.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}vS("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=c0(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new re(j.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new re(j.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new re(j.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Kh{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new pT({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new re(j.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new re(j.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new pT(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new gS;switch(r.type){case"firstParty":return new fN(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new re(j.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=hT.get(n);r&&(Z("ComponentProvider","Removing Datastore"),hT.delete(n),r.terminate())}(this),Promise.resolve()}}function h0(t,e,n,r={}){var u;t=sn(t,Kh);const i=xa(e),s=t._getSettings(),o={...s,emulatorOptions:t._getEmulatorOptions()},a=`${e}:${n}`;i&&(yI(`https://${a}`),vI("Firestore",!0)),s.host!==d0&&s.host!==a&&Gi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...s,host:a,ssl:i,emulatorOptions:r};if(!Gs(l,o)&&(t._setSettings(l),r.mockUserToken)){let f,m;if(typeof r.mockUserToken=="string")f=r.mockUserToken,m=qt.MOCK_USER;else{f=FR(r.mockUserToken,(u=t._app)==null?void 0:u.options.projectId);const g=r.mockUserToken.sub||r.mockUserToken.user_id;if(!g)throw new re(j.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");m=new qt(g)}t._authCredentials=new cN(new mS(f,m))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xi{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Xi(this.firestore,e,this._query)}}class ht{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Br(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ht(this.firestore,e,this._key)}toJSON(){return{type:ht._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(Vu(n,ht._jsonSchema))return new ht(e,r||null,new oe($e.fromString(n.referencePath)))}}ht._jsonSchemaVersion="firestore/documentReference/1.0",ht._jsonSchema={type:St("string",ht._jsonSchemaVersion),referencePath:St("string")};class Br extends Xi{constructor(e,n,r){super(e,n,Ou(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ht(this.firestore,null,new oe(e))}withConverter(e){return new Br(this.firestore,e,this._path)}}function Rt(t,e,...n){if(t=Dt(t),yS("collection","path",e),t instanceof Kh){const r=$e.fromString(e,...n);return iv(r),new Br(t,null,r)}{if(!(t instanceof ht||t instanceof Br))throw new re(j.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child($e.fromString(e,...n));return iv(r),new Br(t.firestore,null,r)}}function He(t,e,...n){if(t=Dt(t),arguments.length===1&&(e=Rh.newId()),yS("doc","path",e),t instanceof Kh){const r=$e.fromString(e,...n);return rv(r),new ht(t,null,new oe(r))}{if(!(t instanceof ht||t instanceof Br))throw new re(j.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child($e.fromString(e,...n));return rv(r),new ht(t.firestore,t instanceof Br?t.converter:null,new oe(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mT="AsyncQueue";class gT{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new WC(this,"async_queue_retry"),this._c=()=>{const r=ud();r&&Z(mT,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=ud();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=ud();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new vr;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Qi(e))throw e;Z(mT,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,nn("INTERNAL UNHANDLED ERROR: ",_T(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const i=Kg.createAndSchedule(this,e,n,r,s=>this.hc(s));return this.tc.push(i),i}uc(){this.nc&&he(47125,{Pc:_T(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function _T(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yT(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const i=n;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}class Sr extends Kh{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new gT,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new gT(e),this._firestoreClient=void 0,await e}}}function f0(t,e){const n=typeof t=="object"?t:xI(),r=typeof t=="string"?t:Ld,i=lg(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=VR("firestore");s&&h0(i,...s)}return i}function Hu(t){if(t._terminated)throw new re(j.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||p0(t),t._firestoreClient}function p0(t){var r,i,s;const e=t._freezeSettings(),n=function(a,l,u,f){return new XN(a,l,u,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,c0(f.experimentalLongPollingOptions),f.useFetchStreams,f.isUsingEmulator)}(t._databaseId,((r=t._app)==null?void 0:r.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(i=e.localCache)!=null&&i._offlineComponentProvider&&((s=e.localCache)!=null&&s._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new yM(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(t._componentsProvider))}function m0(t,e){Gi("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings();return IM(t,Kd.provider,{build:r=>new _M(r,n.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}function IM(t,e,n){if((t=sn(t,Sr))._firestoreClient||t._terminated)throw new re(j.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new re(j.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:n},p0(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class In{constructor(e){this._byteString=e}static fromBase64String(e){try{return new In(Tt.fromBase64String(e))}catch(n){throw new re(j.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new In(Tt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:In._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Vu(e,In._jsonSchema))return In.fromBase64String(e.bytes)}}In._jsonSchemaVersion="firestore/bytes/1.0",In._jsonSchema={type:St("string",In._jsonSchemaVersion),bytes:St("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wu{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new re(j.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new at(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ku{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tr{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new re(j.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new re(j.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Ce(this._lat,e._lat)||Ce(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:tr._jsonSchemaVersion}}static fromJSON(e){if(Vu(e,tr._jsonSchema))return new tr(e.latitude,e.longitude)}}tr._jsonSchemaVersion="firestore/geoPoint/1.0",tr._jsonSchema={type:St("string",tr._jsonSchemaVersion),latitude:St("number"),longitude:St("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nr{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}toJSON(){return{type:nr._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Vu(e,nr._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new nr(e.vectorValues);throw new re(j.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}nr._jsonSchemaVersion="firestore/vectorValue/1.0",nr._jsonSchema={type:St("string",nr._jsonSchemaVersion),vectorValues:St("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SM=/^__.*__$/;class CM{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Xr(e,this.data,this.fieldMask,n,this.fieldTransforms):new Na(e,this.data,n,this.fieldTransforms)}}class g0{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Xr(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function _0(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw he(40011,{Ac:t})}}class n_{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new n_({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var i;const n=(i=this.path)==null?void 0:i.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){var i;const n=(i=this.path)==null?void 0:i.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Jd(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(_0(this.Ac)&&SM.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class AM{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Hh(e)}Cc(e,n,r,i=!1){return new n_({Ac:e,methodName:n,Dc:r,path:at.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function r_(t){const e=t._freezeSettings(),n=Hh(t._databaseId);return new AM(t._databaseId,!!e.ignoreUndefinedProperties,n)}function xM(t,e,n,r,i,s={}){const o=t.Cc(s.merge||s.mergeFields?2:0,e,n,i);s_("Data must be an object, but it was:",o,r);const a=y0(r,o);let l,u;if(s.merge)l=new hn(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const f=[];for(const m of s.mergeFields){const g=Qp(e,m,n);if(!o.contains(g))throw new re(j.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);T0(f,g)||f.push(g)}l=new hn(f),u=o.fieldTransforms.filter(m=>l.covers(m.field))}else l=null,u=o.fieldTransforms;return new CM(new Qt(a),l,u)}class jh extends Ku{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof jh}}class i_ extends Ku{_toFieldTransform(e){return new uC(e.path,new pa)}isEqual(e){return e instanceof i_}}function RM(t,e,n,r){const i=t.Cc(1,e,n);s_("Data must be an object, but it was:",i,r);const s=[],o=Qt.empty();Yi(r,(l,u)=>{const f=o_(e,l,n);u=Dt(u);const m=i.yc(f);if(u instanceof jh)s.push(f);else{const g=ju(u,m);g!=null&&(s.push(f),o.set(f,g))}});const a=new hn(s);return new g0(o,a,i.fieldTransforms)}function PM(t,e,n,r,i,s){const o=t.Cc(1,e,n),a=[Qp(e,r,n)],l=[i];if(s.length%2!=0)throw new re(j.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<s.length;g+=2)a.push(Qp(e,s[g])),l.push(s[g+1]);const u=[],f=Qt.empty();for(let g=a.length-1;g>=0;--g)if(!T0(u,a[g])){const v=a[g];let T=l[g];T=Dt(T);const x=o.yc(v);if(T instanceof jh)u.push(v);else{const D=ju(T,x);D!=null&&(u.push(v),f.set(v,D))}}const m=new hn(u);return new g0(f,m,o.fieldTransforms)}function kM(t,e,n,r=!1){return ju(n,t.Cc(r?4:3,e))}function ju(t,e){if(v0(t=Dt(t)))return s_("Unsupported field value:",e,t),y0(t,e);if(t instanceof Ku)return function(r,i){if(!_0(i.Ac))throw i.Sc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const a of r){let l=ju(a,i.wc(o));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=Dt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return yD(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=We.fromDate(r);return{timestampValue:_a(i.serializer,s)}}if(r instanceof We){const s=new We(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:_a(i.serializer,s)}}if(r instanceof tr)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof In)return{bytesValue:gC(i.serializer,r._byteString)};if(r instanceof ht){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Vg(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof nr)return function(o,a){return{mapValue:{fields:{[xg]:{stringValue:Rg},[ca]:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw a.Sc("VectorValues must only contain numeric values.");return kg(a.serializer,u)})}}}}}}(r,i);throw i.Sc(`Unsupported field value: ${Ph(r)}`)}(t,e)}function y0(t,e){const n={};return VS(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Yi(t,(r,i)=>{const s=ju(i,e.mc(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function v0(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof We||t instanceof tr||t instanceof In||t instanceof ht||t instanceof Ku||t instanceof nr)}function s_(t,e,n){if(!v0(n)||!TS(n)){const r=Ph(n);throw r==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+r)}}function Qp(t,e,n){if((e=Dt(e))instanceof Wu)return e._internalPath;if(typeof e=="string")return o_(t,e);throw Jd("Field path arguments must be of type string or ",t,!1,void 0,n)}const NM=new RegExp("[~\\*/\\[\\]]");function o_(t,e,n){if(e.search(NM)>=0)throw Jd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Wu(...e.split("."))._internalPath}catch{throw Jd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Jd(t,e,n,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new re(j.INVALID_ARGUMENT,a+t+l)}function T0(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E0{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new ht(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new DM(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(a_("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class DM extends E0{data(){return super.data()}}function a_(t,e){return typeof e=="string"?o_(t,e):e instanceof Wu?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w0(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new re(j.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class l_{}class I0 extends l_{}function cd(t,e,...n){let r=[];e instanceof l_&&r.push(e),r=r.concat(n),function(s){const o=s.filter(l=>l instanceof Jh).length,a=s.filter(l=>l instanceof Ju).length;if(o>1||o>0&&a>0)throw new re(j.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class Ju extends I0{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Ju(e,n,r)}_apply(e){const n=this._parse(e);return S0(e._query,n),new Xi(e.firestore,e.converter,Fp(e._query,n))}_parse(e){const n=r_(e.firestore);return function(s,o,a,l,u,f,m){let g;if(u.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new re(j.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){TT(m,f);const T=[];for(const x of m)T.push(vT(l,s,x));g={arrayValue:{values:T}}}else g=vT(l,s,m)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||TT(m,f),g=kM(a,o,m,f==="in"||f==="not-in");return Le.create(u,f,g)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function dd(t,e,n){const r=e,i=a_("where",t);return Ju._create(i,r,n)}class Jh extends l_{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Jh(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Je.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i;const a=s.getFlattenedFilters();for(const l of a)S0(o,l),o=Fp(o,l)}(e._query,n),new Xi(e.firestore,e.converter,Fp(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function vT(t,e,n){if(typeof(n=Dt(n))=="string"){if(n==="")throw new re(j.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!XS(e)&&n.indexOf("/")!==-1)throw new re(j.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child($e.fromString(n));if(!oe.isDocumentKey(r))throw new re(j.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return au(t,new oe(r))}if(n instanceof ht)return au(t,n._key);throw new re(j.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Ph(n)}.`)}function TT(t,e){if(!Array.isArray(t)||t.length===0)throw new re(j.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function S0(t,e){const n=function(i,s){for(const o of i)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new re(j.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new re(j.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class C0{convertValue(e,n="none"){switch(zi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return st(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Hr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw he(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Yi(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertVectorValue(e){var r,i,s;const n=(s=(i=(r=e.fields)==null?void 0:r[ca].arrayValue)==null?void 0:i.values)==null?void 0:s.map(o=>st(o.doubleValue));return new nr(n)}convertGeoPoint(e){return new tr(st(e.latitude),st(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Vh(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(su(e));default:return null}}convertTimestamp(e){const n=zr(e);return new We(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=$e.fromString(e);pe(AC(r),9688,{name:e});const i=new $i(r.get(1),r.get(3)),s=new oe(r.popFirst(5));return i.isEqual(n)||nn(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bM(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class ko{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ni extends E0{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Ol(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(a_("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new re(j.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Ni._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}Ni._jsonSchemaVersion="firestore/documentSnapshot/1.0",Ni._jsonSchema={type:St("string",Ni._jsonSchemaVersion),bundleSource:St("string","DocumentSnapshot"),bundleName:St("string"),bundle:St("string")};class Ol extends Ni{data(e={}){return super.data(e)}}class Di{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new ko(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Ol(this._firestore,this._userDataWriter,r.key,r,new ko(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new re(j.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{const l=new Ol(i._firestore,i._userDataWriter,a.doc.key,a.doc,new ko(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{const l=new Ol(i._firestore,i._userDataWriter,a.doc.key,a.doc,new ko(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let u=-1,f=-1;return a.type!==0&&(u=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),f=o.indexOf(a.doc.key)),{type:MM(a.type),doc:l,oldIndex:u,newIndex:f}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new re(j.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Di._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Rh.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],i=[];return this.docs.forEach(s=>{s._document!==null&&(n.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function MM(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return he(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yp(t){t=sn(t,ht);const e=sn(t.firestore,Sr);return EM(Hu(e),t._key).then(n=>A0(e,t,n))}Di._jsonSchemaVersion="firestore/querySnapshot/1.0",Di._jsonSchema={type:St("string",Di._jsonSchemaVersion),bundleSource:St("string","QuerySnapshot"),bundleName:St("string"),bundle:St("string")};class u_ extends C0{constructor(e){super(),this.firestore=e}convertBytes(e){return new In(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new ht(this.firestore,null,n)}}function Po(t){t=sn(t,Xi);const e=sn(t.firestore,Sr),n=Hu(e),r=new u_(e);return w0(t._query),wM(n,t._query).then(i=>new Di(e,r,t,i))}function yt(t,e,n){t=sn(t,ht);const r=sn(t.firestore,Sr),i=bM(t.converter,e,n);return Qh(r,[xM(r_(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,rn.none())])}function Xp(t,e,n,...r){t=sn(t,ht);const i=sn(t.firestore,Sr),s=r_(i);let o;return o=typeof(e=Dt(e))=="string"||e instanceof Wu?PM(s,"updateDoc",t._key,e,n,r):RM(s,"updateDoc",t._key,e),Qh(i,[o.toMutation(t._key,rn.exists(!0))])}function Tn(t){return Qh(sn(t.firestore,Sr),[new Bh(t._key,rn.none())])}function Sl(t,...e){var l,u,f;t=Dt(t);let n={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||yT(e[r])||(n=e[r++]);const i={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(yT(e[r])){const m=e[r];e[r]=(l=m.next)==null?void 0:l.bind(m),e[r+1]=(u=m.error)==null?void 0:u.bind(m),e[r+2]=(f=m.complete)==null?void 0:f.bind(m)}let s,o,a;if(t instanceof ht)o=sn(t.firestore,Sr),a=Ou(t._key.path),s={next:m=>{e[r]&&e[r](A0(o,t,m))},error:e[r+1],complete:e[r+2]};else{const m=sn(t,Xi);o=sn(m.firestore,Sr),a=m._query;const g=new u_(o);s={next:v=>{e[r]&&e[r](new Di(o,g,m,v))},error:e[r+1],complete:e[r+2]},w0(t._query)}return function(g,v,T,x){const D=new t_(x),C=new Xg(v,D,T);return g.asyncQueue.enqueueAndForget(async()=>Jg(await jd(g),C)),()=>{D.Nu(),g.asyncQueue.enqueueAndForget(async()=>Qg(await jd(g),C))}}(Hu(o),a,i,s)}function Qh(t,e){return function(r,i){const s=new vr;return r.asyncQueue.enqueueAndForget(async()=>uM(await TM(r),i,s)),s.promise}(Hu(t),e)}function A0(t,e,n){const r=n.docs.get(e._key),i=new u_(t);return new Ni(t,i,e._key,r,new ko(n.hasPendingWrites,n.fromCache),e.converter)}function VM(){return new i_("serverTimestamp")}(function(e,n=!0){(function(i){ka=i})(Ra),ra(new $s("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),a=new Sr(new dN(r.getProvider("auth-internal")),new pN(o,r.getProvider("app-check-internal")),function(u,f){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new re(j.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new $i(u.options.projectId,f)}(o,i),o);return s={useFetchStreams:n,...s},a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),Ri(Zy,ev,e),Ri(Zy,ev,"esm2020")})();const Ts=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:C0,Bytes:In,CollectionReference:Br,DocumentReference:ht,DocumentSnapshot:Ni,FieldPath:Wu,FieldValue:Ku,Firestore:Sr,FirestoreError:re,GeoPoint:tr,Query:Xi,QueryCompositeFilterConstraint:Jh,QueryConstraint:I0,QueryDocumentSnapshot:Ol,QueryFieldFilterConstraint:Ju,QuerySnapshot:Di,SnapshotMetadata:ko,Timestamp:We,VectorValue:nr,_AutoId:Rh,_ByteString:Tt,_DatabaseId:$i,_DocumentKey:oe,_EmptyAuthCredentialsProvider:gS,_FieldPath:at,_cast:sn,_logWarn:Gi,_validateIsNotUsedTogether:vS,collection:Rt,connectFirestoreEmulator:h0,deleteDoc:Tn,doc:He,enableIndexedDbPersistence:m0,ensureFirestoreConfigured:Hu,executeWrite:Qh,getDoc:Yp,getDocs:Po,getFirestore:f0,onSnapshot:Sl,query:cd,serverTimestamp:VM,setDoc:yt,setLogLevel:fS,updateDoc:Xp,where:dd},Symbol.toStringTag,{value:"Module"}));fS("error");const LM={apiKey:"AIzaSyC1zhlBnbOxP_PCaHU6L-UsDOBRTjGgpfk",authDomain:"my-apss-da774.firebaseapp.com",projectId:"my-apss-da774",storageBucket:"my-apss-da774.firebasestorage.app",messagingSenderId:"528434940137",appId:"1:528434940137:web:56be66185a46f390b60878",measurementId:"G-WPGZGF4ZBG"},x0=AI(LM),pi=lN(x0);jk(pi,YI).catch(t=>console.error("Persistence error:",t));const Os=new Mr;Os.addScope("profile");Os.addScope("email");Os.setCustomParameters({prompt:"select_account",access_type:"offline"});if(typeof window<"u"){const t=navigator.userAgent.toLowerCase();t.includes("safari")&&!t.includes("chrome")&&!t.includes("firefox")&&Os.setCustomParameters({prompt:"consent"})}const ve=f0(x0);m0(ve).catch(t=>{t.code==="failed-precondition"?console.warn("Firestore: Multiple tabs open, persistence disabled"):t.code==="unimplemented"&&console.warn("Firestore: Browser does not support persistence")});async function R0(){const t=pi.currentUser;if(!t)throw new Error("로그인 필요");return await t.getIdToken()}async function Yh(t,e={}){var a;const n=await R0(),i=`https://firestore.googleapis.com/v1/projects/my-apss-da774/databases/(default)/documents${t}`,s={"Content-Type":"application/json",Authorization:`Bearer ${n}`,...e.headers||{}},o=await fetch(i,{...e,headers:s});if(!o.ok){const l=await o.json().catch(()=>({}));throw new Error(((a=l.error)==null?void 0:a.message)||o.statusText)}return o.json()}const P0=Object.freeze(Object.defineProperty({__proto__:null,firestoreFetch:Yh,getFirebaseIdToken:R0},Symbol.toStringTag,{value:"Module"}));var Zp={},k0={exports:{}},Pn={},N0={exports:{}},D0={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(te,ce){var me=te.length;te.push(ce);e:for(;0<me;){var Ee=me-1>>>1,Pe=te[Ee];if(0<i(Pe,ce))te[Ee]=ce,te[me]=Pe,me=Ee;else break e}}function n(te){return te.length===0?null:te[0]}function r(te){if(te.length===0)return null;var ce=te[0],me=te.pop();if(me!==ce){te[0]=me;e:for(var Ee=0,Pe=te.length,ze=Pe>>>1;Ee<ze;){var je=2*(Ee+1)-1,Mt=te[je],ut=je+1,fe=te[ut];if(0>i(Mt,me))ut<Pe&&0>i(fe,Mt)?(te[Ee]=fe,te[ut]=me,Ee=ut):(te[Ee]=Mt,te[je]=me,Ee=je);else if(ut<Pe&&0>i(fe,me))te[Ee]=fe,te[ut]=me,Ee=ut;else break e}}return ce}function i(te,ce){var me=te.sortIndex-ce.sortIndex;return me!==0?me:te.id-ce.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],u=[],f=1,m=null,g=3,v=!1,T=!1,x=!1,D=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function P(te){for(var ce=n(u);ce!==null;){if(ce.callback===null)r(u);else if(ce.startTime<=te)r(u),ce.sortIndex=ce.expirationTime,e(l,ce);else break;ce=n(u)}}function V(te){if(x=!1,P(te),!T)if(n(l)!==null)T=!0,Ke(O);else{var ce=n(u);ce!==null&&Te(V,ce.startTime-te)}}function O(te,ce){T=!1,x&&(x=!1,C(I),I=-1),v=!0;var me=g;try{for(P(ce),m=n(l);m!==null&&(!(m.expirationTime>ce)||te&&!b());){var Ee=m.callback;if(typeof Ee=="function"){m.callback=null,g=m.priorityLevel;var Pe=Ee(m.expirationTime<=ce);ce=t.unstable_now(),typeof Pe=="function"?m.callback=Pe:m===n(l)&&r(l),P(ce)}else r(l);m=n(l)}if(m!==null)var ze=!0;else{var je=n(u);je!==null&&Te(V,je.startTime-ce),ze=!1}return ze}finally{m=null,g=me,v=!1}}var B=!1,E=null,I=-1,A=5,k=-1;function b(){return!(t.unstable_now()-k<A)}function L(){if(E!==null){var te=t.unstable_now();k=te;var ce=!0;try{ce=E(!0,te)}finally{ce?N():(B=!1,E=null)}}else B=!1}var N;if(typeof w=="function")N=function(){w(L)};else if(typeof MessageChannel<"u"){var De=new MessageChannel,Fe=De.port2;De.port1.onmessage=L,N=function(){Fe.postMessage(null)}}else N=function(){D(L,0)};function Ke(te){E=te,B||(B=!0,N())}function Te(te,ce){I=D(function(){te(t.unstable_now())},ce)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(te){te.callback=null},t.unstable_continueExecution=function(){T||v||(T=!0,Ke(O))},t.unstable_forceFrameRate=function(te){0>te||125<te?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<te?Math.floor(1e3/te):5},t.unstable_getCurrentPriorityLevel=function(){return g},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(te){switch(g){case 1:case 2:case 3:var ce=3;break;default:ce=g}var me=g;g=ce;try{return te()}finally{g=me}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(te,ce){switch(te){case 1:case 2:case 3:case 4:case 5:break;default:te=3}var me=g;g=te;try{return ce()}finally{g=me}},t.unstable_scheduleCallback=function(te,ce,me){var Ee=t.unstable_now();switch(typeof me=="object"&&me!==null?(me=me.delay,me=typeof me=="number"&&0<me?Ee+me:Ee):me=Ee,te){case 1:var Pe=-1;break;case 2:Pe=250;break;case 5:Pe=1073741823;break;case 4:Pe=1e4;break;default:Pe=5e3}return Pe=me+Pe,te={id:f++,callback:ce,priorityLevel:te,startTime:me,expirationTime:Pe,sortIndex:-1},me>Ee?(te.sortIndex=me,e(u,te),n(l)===null&&te===n(u)&&(x?(C(I),I=-1):x=!0,Te(V,me-Ee))):(te.sortIndex=Pe,e(l,te),T||v||(T=!0,Ke(O))),te},t.unstable_shouldYield=b,t.unstable_wrapCallback=function(te){var ce=g;return function(){var me=g;g=ce;try{return te.apply(this,arguments)}finally{g=me}}}})(D0);N0.exports=D0;var FM=N0.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var UM=z,Rn=FM;function ee(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var b0=new Set,du={};function io(t,e){va(t,e),va(t+"Capture",e)}function va(t,e){for(du[t]=e,t=0;t<e.length;t++)b0.add(e[t])}var Wr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),em=Object.prototype.hasOwnProperty,OM=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,ET={},wT={};function BM(t){return em.call(wT,t)?!0:em.call(ET,t)?!1:OM.test(t)?wT[t]=!0:(ET[t]=!0,!1)}function qM(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function GM(t,e,n,r){if(e===null||typeof e>"u"||qM(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function un(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var zt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){zt[t]=new un(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];zt[e]=new un(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){zt[t]=new un(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){zt[t]=new un(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){zt[t]=new un(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){zt[t]=new un(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){zt[t]=new un(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){zt[t]=new un(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){zt[t]=new un(t,5,!1,t.toLowerCase(),null,!1,!1)});var c_=/[\-:]([a-z])/g;function d_(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(c_,d_);zt[e]=new un(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(c_,d_);zt[e]=new un(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(c_,d_);zt[e]=new un(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){zt[t]=new un(t,1,!1,t.toLowerCase(),null,!1,!1)});zt.xlinkHref=new un("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){zt[t]=new un(t,1,!1,t.toLowerCase(),null,!0,!0)});function h_(t,e,n,r){var i=zt.hasOwnProperty(e)?zt[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(GM(e,n,i,r)&&(n=null),r||i===null?BM(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Zr=UM.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Nc=Symbol.for("react.element"),No=Symbol.for("react.portal"),Do=Symbol.for("react.fragment"),f_=Symbol.for("react.strict_mode"),tm=Symbol.for("react.profiler"),M0=Symbol.for("react.provider"),V0=Symbol.for("react.context"),p_=Symbol.for("react.forward_ref"),nm=Symbol.for("react.suspense"),rm=Symbol.for("react.suspense_list"),m_=Symbol.for("react.memo"),mi=Symbol.for("react.lazy"),L0=Symbol.for("react.offscreen"),IT=Symbol.iterator;function dl(t){return t===null||typeof t!="object"?null:(t=IT&&t[IT]||t["@@iterator"],typeof t=="function"?t:null)}var pt=Object.assign,Hf;function Cl(t){if(Hf===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Hf=e&&e[1]||""}return`
`+Hf+t}var Wf=!1;function Kf(t,e){if(!t||Wf)return"";Wf=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{Wf=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Cl(t):""}function $M(t){switch(t.tag){case 5:return Cl(t.type);case 16:return Cl("Lazy");case 13:return Cl("Suspense");case 19:return Cl("SuspenseList");case 0:case 2:case 15:return t=Kf(t.type,!1),t;case 11:return t=Kf(t.type.render,!1),t;case 1:return t=Kf(t.type,!0),t;default:return""}}function im(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Do:return"Fragment";case No:return"Portal";case tm:return"Profiler";case f_:return"StrictMode";case nm:return"Suspense";case rm:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case V0:return(t.displayName||"Context")+".Consumer";case M0:return(t._context.displayName||"Context")+".Provider";case p_:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case m_:return e=t.displayName||null,e!==null?e:im(t.type)||"Memo";case mi:e=t._payload,t=t._init;try{return im(t(e))}catch{}}return null}function zM(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return im(e);case 8:return e===f_?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function ji(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function F0(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function HM(t){var e=F0(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Dc(t){t._valueTracker||(t._valueTracker=HM(t))}function U0(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=F0(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Qd(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function sm(t,e){var n=e.checked;return pt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function ST(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=ji(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function O0(t,e){e=e.checked,e!=null&&h_(t,"checked",e,!1)}function om(t,e){O0(t,e);var n=ji(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?am(t,e.type,n):e.hasOwnProperty("defaultValue")&&am(t,e.type,ji(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function CT(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function am(t,e,n){(e!=="number"||Qd(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Al=Array.isArray;function jo(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+ji(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function lm(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ee(91));return pt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function AT(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(ee(92));if(Al(n)){if(1<n.length)throw Error(ee(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:ji(n)}}function B0(t,e){var n=ji(e.value),r=ji(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function xT(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function q0(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function um(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?q0(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var bc,G0=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(bc=bc||document.createElement("div"),bc.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=bc.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function hu(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Bl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},WM=["Webkit","ms","Moz","O"];Object.keys(Bl).forEach(function(t){WM.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Bl[e]=Bl[t]})});function $0(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Bl.hasOwnProperty(t)&&Bl[t]?(""+e).trim():e+"px"}function z0(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=$0(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var KM=pt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function cm(t,e){if(e){if(KM[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ee(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ee(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ee(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ee(62))}}function dm(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var hm=null;function g_(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var fm=null,Jo=null,Qo=null;function RT(t){if(t=Xu(t)){if(typeof fm!="function")throw Error(ee(280));var e=t.stateNode;e&&(e=nf(e),fm(t.stateNode,t.type,e))}}function H0(t){Jo?Qo?Qo.push(t):Qo=[t]:Jo=t}function W0(){if(Jo){var t=Jo,e=Qo;if(Qo=Jo=null,RT(t),e)for(t=0;t<e.length;t++)RT(e[t])}}function K0(t,e){return t(e)}function j0(){}var jf=!1;function J0(t,e,n){if(jf)return t(e,n);jf=!0;try{return K0(t,e,n)}finally{jf=!1,(Jo!==null||Qo!==null)&&(j0(),W0())}}function fu(t,e){var n=t.stateNode;if(n===null)return null;var r=nf(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(ee(231,e,typeof n));return n}var pm=!1;if(Wr)try{var hl={};Object.defineProperty(hl,"passive",{get:function(){pm=!0}}),window.addEventListener("test",hl,hl),window.removeEventListener("test",hl,hl)}catch{pm=!1}function jM(t,e,n,r,i,s,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(f){this.onError(f)}}var ql=!1,Yd=null,Xd=!1,mm=null,JM={onError:function(t){ql=!0,Yd=t}};function QM(t,e,n,r,i,s,o,a,l){ql=!1,Yd=null,jM.apply(JM,arguments)}function YM(t,e,n,r,i,s,o,a,l){if(QM.apply(this,arguments),ql){if(ql){var u=Yd;ql=!1,Yd=null}else throw Error(ee(198));Xd||(Xd=!0,mm=u)}}function so(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Q0(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function PT(t){if(so(t)!==t)throw Error(ee(188))}function XM(t){var e=t.alternate;if(!e){if(e=so(t),e===null)throw Error(ee(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return PT(i),t;if(s===r)return PT(i),e;s=s.sibling}throw Error(ee(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(ee(189))}}if(n.alternate!==r)throw Error(ee(190))}if(n.tag!==3)throw Error(ee(188));return n.stateNode.current===n?t:e}function Y0(t){return t=XM(t),t!==null?X0(t):null}function X0(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=X0(t);if(e!==null)return e;t=t.sibling}return null}var Z0=Rn.unstable_scheduleCallback,kT=Rn.unstable_cancelCallback,ZM=Rn.unstable_shouldYield,e2=Rn.unstable_requestPaint,vt=Rn.unstable_now,t2=Rn.unstable_getCurrentPriorityLevel,__=Rn.unstable_ImmediatePriority,eA=Rn.unstable_UserBlockingPriority,Zd=Rn.unstable_NormalPriority,n2=Rn.unstable_LowPriority,tA=Rn.unstable_IdlePriority,Xh=null,Tr=null;function r2(t){if(Tr&&typeof Tr.onCommitFiberRoot=="function")try{Tr.onCommitFiberRoot(Xh,t,void 0,(t.current.flags&128)===128)}catch{}}var rr=Math.clz32?Math.clz32:o2,i2=Math.log,s2=Math.LN2;function o2(t){return t>>>=0,t===0?32:31-(i2(t)/s2|0)|0}var Mc=64,Vc=4194304;function xl(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function eh(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=xl(a):(s&=o,s!==0&&(r=xl(s)))}else o=n&~i,o!==0?r=xl(o):s!==0&&(r=xl(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-rr(e),i=1<<n,r|=t[n],e&=~i;return r}function a2(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function l2(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-rr(s),a=1<<o,l=i[o];l===-1?(!(a&n)||a&r)&&(i[o]=a2(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function gm(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function nA(){var t=Mc;return Mc<<=1,!(Mc&4194240)&&(Mc=64),t}function Jf(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Qu(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-rr(e),t[e]=n}function u2(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-rr(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function y_(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-rr(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var Ye=0;function rA(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var iA,v_,sA,oA,aA,_m=!1,Lc=[],bi=null,Mi=null,Vi=null,pu=new Map,mu=new Map,Ei=[],c2="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function NT(t,e){switch(t){case"focusin":case"focusout":bi=null;break;case"dragenter":case"dragleave":Mi=null;break;case"mouseover":case"mouseout":Vi=null;break;case"pointerover":case"pointerout":pu.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":mu.delete(e.pointerId)}}function fl(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Xu(e),e!==null&&v_(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function d2(t,e,n,r,i){switch(e){case"focusin":return bi=fl(bi,t,e,n,r,i),!0;case"dragenter":return Mi=fl(Mi,t,e,n,r,i),!0;case"mouseover":return Vi=fl(Vi,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return pu.set(s,fl(pu.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,mu.set(s,fl(mu.get(s)||null,t,e,n,r,i)),!0}return!1}function lA(t){var e=Ds(t.target);if(e!==null){var n=so(e);if(n!==null){if(e=n.tag,e===13){if(e=Q0(n),e!==null){t.blockedOn=e,aA(t.priority,function(){sA(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function hd(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=ym(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);hm=r,n.target.dispatchEvent(r),hm=null}else return e=Xu(n),e!==null&&v_(e),t.blockedOn=n,!1;e.shift()}return!0}function DT(t,e,n){hd(t)&&n.delete(e)}function h2(){_m=!1,bi!==null&&hd(bi)&&(bi=null),Mi!==null&&hd(Mi)&&(Mi=null),Vi!==null&&hd(Vi)&&(Vi=null),pu.forEach(DT),mu.forEach(DT)}function pl(t,e){t.blockedOn===e&&(t.blockedOn=null,_m||(_m=!0,Rn.unstable_scheduleCallback(Rn.unstable_NormalPriority,h2)))}function gu(t){function e(i){return pl(i,t)}if(0<Lc.length){pl(Lc[0],t);for(var n=1;n<Lc.length;n++){var r=Lc[n];r.blockedOn===t&&(r.blockedOn=null)}}for(bi!==null&&pl(bi,t),Mi!==null&&pl(Mi,t),Vi!==null&&pl(Vi,t),pu.forEach(e),mu.forEach(e),n=0;n<Ei.length;n++)r=Ei[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Ei.length&&(n=Ei[0],n.blockedOn===null);)lA(n),n.blockedOn===null&&Ei.shift()}var Yo=Zr.ReactCurrentBatchConfig,th=!0;function f2(t,e,n,r){var i=Ye,s=Yo.transition;Yo.transition=null;try{Ye=1,T_(t,e,n,r)}finally{Ye=i,Yo.transition=s}}function p2(t,e,n,r){var i=Ye,s=Yo.transition;Yo.transition=null;try{Ye=4,T_(t,e,n,r)}finally{Ye=i,Yo.transition=s}}function T_(t,e,n,r){if(th){var i=ym(t,e,n,r);if(i===null)sp(t,e,r,nh,n),NT(t,r);else if(d2(i,t,e,n,r))r.stopPropagation();else if(NT(t,r),e&4&&-1<c2.indexOf(t)){for(;i!==null;){var s=Xu(i);if(s!==null&&iA(s),s=ym(t,e,n,r),s===null&&sp(t,e,r,nh,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else sp(t,e,r,null,n)}}var nh=null;function ym(t,e,n,r){if(nh=null,t=g_(r),t=Ds(t),t!==null)if(e=so(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Q0(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return nh=t,null}function uA(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(t2()){case __:return 1;case eA:return 4;case Zd:case n2:return 16;case tA:return 536870912;default:return 16}default:return 16}}var Si=null,E_=null,fd=null;function cA(){if(fd)return fd;var t,e=E_,n=e.length,r,i="value"in Si?Si.value:Si.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return fd=i.slice(t,1<r?1-r:void 0)}function pd(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Fc(){return!0}function bT(){return!1}function kn(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Fc:bT,this.isPropagationStopped=bT,this}return pt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Fc)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Fc)},persist:function(){},isPersistent:Fc}),e}var ba={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},w_=kn(ba),Yu=pt({},ba,{view:0,detail:0}),m2=kn(Yu),Qf,Yf,ml,Zh=pt({},Yu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:I_,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ml&&(ml&&t.type==="mousemove"?(Qf=t.screenX-ml.screenX,Yf=t.screenY-ml.screenY):Yf=Qf=0,ml=t),Qf)},movementY:function(t){return"movementY"in t?t.movementY:Yf}}),MT=kn(Zh),g2=pt({},Zh,{dataTransfer:0}),_2=kn(g2),y2=pt({},Yu,{relatedTarget:0}),Xf=kn(y2),v2=pt({},ba,{animationName:0,elapsedTime:0,pseudoElement:0}),T2=kn(v2),E2=pt({},ba,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),w2=kn(E2),I2=pt({},ba,{data:0}),VT=kn(I2),S2={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},C2={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},A2={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function x2(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=A2[t])?!!e[t]:!1}function I_(){return x2}var R2=pt({},Yu,{key:function(t){if(t.key){var e=S2[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=pd(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?C2[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:I_,charCode:function(t){return t.type==="keypress"?pd(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?pd(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),P2=kn(R2),k2=pt({},Zh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),LT=kn(k2),N2=pt({},Yu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:I_}),D2=kn(N2),b2=pt({},ba,{propertyName:0,elapsedTime:0,pseudoElement:0}),M2=kn(b2),V2=pt({},Zh,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),L2=kn(V2),F2=[9,13,27,32],S_=Wr&&"CompositionEvent"in window,Gl=null;Wr&&"documentMode"in document&&(Gl=document.documentMode);var U2=Wr&&"TextEvent"in window&&!Gl,dA=Wr&&(!S_||Gl&&8<Gl&&11>=Gl),FT=" ",UT=!1;function hA(t,e){switch(t){case"keyup":return F2.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function fA(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var bo=!1;function O2(t,e){switch(t){case"compositionend":return fA(e);case"keypress":return e.which!==32?null:(UT=!0,FT);case"textInput":return t=e.data,t===FT&&UT?null:t;default:return null}}function B2(t,e){if(bo)return t==="compositionend"||!S_&&hA(t,e)?(t=cA(),fd=E_=Si=null,bo=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return dA&&e.locale!=="ko"?null:e.data;default:return null}}var q2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function OT(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!q2[t.type]:e==="textarea"}function pA(t,e,n,r){H0(r),e=rh(e,"onChange"),0<e.length&&(n=new w_("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var $l=null,_u=null;function G2(t){CA(t,0)}function ef(t){var e=Lo(t);if(U0(e))return t}function $2(t,e){if(t==="change")return e}var mA=!1;if(Wr){var Zf;if(Wr){var ep="oninput"in document;if(!ep){var BT=document.createElement("div");BT.setAttribute("oninput","return;"),ep=typeof BT.oninput=="function"}Zf=ep}else Zf=!1;mA=Zf&&(!document.documentMode||9<document.documentMode)}function qT(){$l&&($l.detachEvent("onpropertychange",gA),_u=$l=null)}function gA(t){if(t.propertyName==="value"&&ef(_u)){var e=[];pA(e,_u,t,g_(t)),J0(G2,e)}}function z2(t,e,n){t==="focusin"?(qT(),$l=e,_u=n,$l.attachEvent("onpropertychange",gA)):t==="focusout"&&qT()}function H2(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return ef(_u)}function W2(t,e){if(t==="click")return ef(e)}function K2(t,e){if(t==="input"||t==="change")return ef(e)}function j2(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var sr=typeof Object.is=="function"?Object.is:j2;function yu(t,e){if(sr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!em.call(e,i)||!sr(t[i],e[i]))return!1}return!0}function GT(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function $T(t,e){var n=GT(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=GT(n)}}function _A(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?_A(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function yA(){for(var t=window,e=Qd();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Qd(t.document)}return e}function C_(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function J2(t){var e=yA(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&_A(n.ownerDocument.documentElement,n)){if(r!==null&&C_(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=$T(n,s);var o=$T(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Q2=Wr&&"documentMode"in document&&11>=document.documentMode,Mo=null,vm=null,zl=null,Tm=!1;function zT(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Tm||Mo==null||Mo!==Qd(r)||(r=Mo,"selectionStart"in r&&C_(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),zl&&yu(zl,r)||(zl=r,r=rh(vm,"onSelect"),0<r.length&&(e=new w_("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Mo)))}function Uc(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Vo={animationend:Uc("Animation","AnimationEnd"),animationiteration:Uc("Animation","AnimationIteration"),animationstart:Uc("Animation","AnimationStart"),transitionend:Uc("Transition","TransitionEnd")},tp={},vA={};Wr&&(vA=document.createElement("div").style,"AnimationEvent"in window||(delete Vo.animationend.animation,delete Vo.animationiteration.animation,delete Vo.animationstart.animation),"TransitionEvent"in window||delete Vo.transitionend.transition);function tf(t){if(tp[t])return tp[t];if(!Vo[t])return t;var e=Vo[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in vA)return tp[t]=e[n];return t}var TA=tf("animationend"),EA=tf("animationiteration"),wA=tf("animationstart"),IA=tf("transitionend"),SA=new Map,HT="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Zi(t,e){SA.set(t,e),io(e,[t])}for(var np=0;np<HT.length;np++){var rp=HT[np],Y2=rp.toLowerCase(),X2=rp[0].toUpperCase()+rp.slice(1);Zi(Y2,"on"+X2)}Zi(TA,"onAnimationEnd");Zi(EA,"onAnimationIteration");Zi(wA,"onAnimationStart");Zi("dblclick","onDoubleClick");Zi("focusin","onFocus");Zi("focusout","onBlur");Zi(IA,"onTransitionEnd");va("onMouseEnter",["mouseout","mouseover"]);va("onMouseLeave",["mouseout","mouseover"]);va("onPointerEnter",["pointerout","pointerover"]);va("onPointerLeave",["pointerout","pointerover"]);io("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));io("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));io("onBeforeInput",["compositionend","keypress","textInput","paste"]);io("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));io("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));io("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Rl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Z2=new Set("cancel close invalid load scroll toggle".split(" ").concat(Rl));function WT(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,YM(r,e,void 0,t),t.currentTarget=null}function CA(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;WT(i,a,u),s=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;WT(i,a,u),s=l}}}if(Xd)throw t=mm,Xd=!1,mm=null,t}function tt(t,e){var n=e[Cm];n===void 0&&(n=e[Cm]=new Set);var r=t+"__bubble";n.has(r)||(AA(e,t,2,!1),n.add(r))}function ip(t,e,n){var r=0;e&&(r|=4),AA(n,t,r,e)}var Oc="_reactListening"+Math.random().toString(36).slice(2);function vu(t){if(!t[Oc]){t[Oc]=!0,b0.forEach(function(n){n!=="selectionchange"&&(Z2.has(n)||ip(n,!1,t),ip(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Oc]||(e[Oc]=!0,ip("selectionchange",!1,e))}}function AA(t,e,n,r){switch(uA(e)){case 1:var i=f2;break;case 4:i=p2;break;default:i=T_}n=i.bind(null,e,n,t),i=void 0,!pm||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function sp(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=Ds(a),o===null)return;if(l=o.tag,l===5||l===6){r=s=o;continue e}a=a.parentNode}}r=r.return}J0(function(){var u=s,f=g_(n),m=[];e:{var g=SA.get(t);if(g!==void 0){var v=w_,T=t;switch(t){case"keypress":if(pd(n)===0)break e;case"keydown":case"keyup":v=P2;break;case"focusin":T="focus",v=Xf;break;case"focusout":T="blur",v=Xf;break;case"beforeblur":case"afterblur":v=Xf;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":v=MT;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":v=_2;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":v=D2;break;case TA:case EA:case wA:v=T2;break;case IA:v=M2;break;case"scroll":v=m2;break;case"wheel":v=L2;break;case"copy":case"cut":case"paste":v=w2;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":v=LT}var x=(e&4)!==0,D=!x&&t==="scroll",C=x?g!==null?g+"Capture":null:g;x=[];for(var w=u,P;w!==null;){P=w;var V=P.stateNode;if(P.tag===5&&V!==null&&(P=V,C!==null&&(V=fu(w,C),V!=null&&x.push(Tu(w,V,P)))),D)break;w=w.return}0<x.length&&(g=new v(g,T,null,n,f),m.push({event:g,listeners:x}))}}if(!(e&7)){e:{if(g=t==="mouseover"||t==="pointerover",v=t==="mouseout"||t==="pointerout",g&&n!==hm&&(T=n.relatedTarget||n.fromElement)&&(Ds(T)||T[Kr]))break e;if((v||g)&&(g=f.window===f?f:(g=f.ownerDocument)?g.defaultView||g.parentWindow:window,v?(T=n.relatedTarget||n.toElement,v=u,T=T?Ds(T):null,T!==null&&(D=so(T),T!==D||T.tag!==5&&T.tag!==6)&&(T=null)):(v=null,T=u),v!==T)){if(x=MT,V="onMouseLeave",C="onMouseEnter",w="mouse",(t==="pointerout"||t==="pointerover")&&(x=LT,V="onPointerLeave",C="onPointerEnter",w="pointer"),D=v==null?g:Lo(v),P=T==null?g:Lo(T),g=new x(V,w+"leave",v,n,f),g.target=D,g.relatedTarget=P,V=null,Ds(f)===u&&(x=new x(C,w+"enter",T,n,f),x.target=P,x.relatedTarget=D,V=x),D=V,v&&T)t:{for(x=v,C=T,w=0,P=x;P;P=Io(P))w++;for(P=0,V=C;V;V=Io(V))P++;for(;0<w-P;)x=Io(x),w--;for(;0<P-w;)C=Io(C),P--;for(;w--;){if(x===C||C!==null&&x===C.alternate)break t;x=Io(x),C=Io(C)}x=null}else x=null;v!==null&&KT(m,g,v,x,!1),T!==null&&D!==null&&KT(m,D,T,x,!0)}}e:{if(g=u?Lo(u):window,v=g.nodeName&&g.nodeName.toLowerCase(),v==="select"||v==="input"&&g.type==="file")var O=$2;else if(OT(g))if(mA)O=K2;else{O=H2;var B=z2}else(v=g.nodeName)&&v.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(O=W2);if(O&&(O=O(t,u))){pA(m,O,n,f);break e}B&&B(t,g,u),t==="focusout"&&(B=g._wrapperState)&&B.controlled&&g.type==="number"&&am(g,"number",g.value)}switch(B=u?Lo(u):window,t){case"focusin":(OT(B)||B.contentEditable==="true")&&(Mo=B,vm=u,zl=null);break;case"focusout":zl=vm=Mo=null;break;case"mousedown":Tm=!0;break;case"contextmenu":case"mouseup":case"dragend":Tm=!1,zT(m,n,f);break;case"selectionchange":if(Q2)break;case"keydown":case"keyup":zT(m,n,f)}var E;if(S_)e:{switch(t){case"compositionstart":var I="onCompositionStart";break e;case"compositionend":I="onCompositionEnd";break e;case"compositionupdate":I="onCompositionUpdate";break e}I=void 0}else bo?hA(t,n)&&(I="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(I="onCompositionStart");I&&(dA&&n.locale!=="ko"&&(bo||I!=="onCompositionStart"?I==="onCompositionEnd"&&bo&&(E=cA()):(Si=f,E_="value"in Si?Si.value:Si.textContent,bo=!0)),B=rh(u,I),0<B.length&&(I=new VT(I,t,null,n,f),m.push({event:I,listeners:B}),E?I.data=E:(E=fA(n),E!==null&&(I.data=E)))),(E=U2?O2(t,n):B2(t,n))&&(u=rh(u,"onBeforeInput"),0<u.length&&(f=new VT("onBeforeInput","beforeinput",null,n,f),m.push({event:f,listeners:u}),f.data=E))}CA(m,e)})}function Tu(t,e,n){return{instance:t,listener:e,currentTarget:n}}function rh(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=fu(t,n),s!=null&&r.unshift(Tu(t,s,i)),s=fu(t,e),s!=null&&r.push(Tu(t,s,i))),t=t.return}return r}function Io(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function KT(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,u=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&u!==null&&(a=u,i?(l=fu(n,s),l!=null&&o.unshift(Tu(n,l,a))):i||(l=fu(n,s),l!=null&&o.push(Tu(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var eV=/\r\n?/g,tV=/\u0000|\uFFFD/g;function jT(t){return(typeof t=="string"?t:""+t).replace(eV,`
`).replace(tV,"")}function Bc(t,e,n){if(e=jT(e),jT(t)!==e&&n)throw Error(ee(425))}function ih(){}var Em=null,wm=null;function Im(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Sm=typeof setTimeout=="function"?setTimeout:void 0,nV=typeof clearTimeout=="function"?clearTimeout:void 0,JT=typeof Promise=="function"?Promise:void 0,rV=typeof queueMicrotask=="function"?queueMicrotask:typeof JT<"u"?function(t){return JT.resolve(null).then(t).catch(iV)}:Sm;function iV(t){setTimeout(function(){throw t})}function op(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),gu(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);gu(e)}function Li(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function QT(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Ma=Math.random().toString(36).slice(2),mr="__reactFiber$"+Ma,Eu="__reactProps$"+Ma,Kr="__reactContainer$"+Ma,Cm="__reactEvents$"+Ma,sV="__reactListeners$"+Ma,oV="__reactHandles$"+Ma;function Ds(t){var e=t[mr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Kr]||n[mr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=QT(t);t!==null;){if(n=t[mr])return n;t=QT(t)}return e}t=n,n=t.parentNode}return null}function Xu(t){return t=t[mr]||t[Kr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Lo(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ee(33))}function nf(t){return t[Eu]||null}var Am=[],Fo=-1;function es(t){return{current:t}}function rt(t){0>Fo||(t.current=Am[Fo],Am[Fo]=null,Fo--)}function et(t,e){Fo++,Am[Fo]=t.current,t.current=e}var Ji={},Zt=es(Ji),pn=es(!1),Qs=Ji;function Ta(t,e){var n=t.type.contextTypes;if(!n)return Ji;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function mn(t){return t=t.childContextTypes,t!=null}function sh(){rt(pn),rt(Zt)}function YT(t,e,n){if(Zt.current!==Ji)throw Error(ee(168));et(Zt,e),et(pn,n)}function xA(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(ee(108,zM(t)||"Unknown",i));return pt({},n,r)}function oh(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ji,Qs=Zt.current,et(Zt,t),et(pn,pn.current),!0}function XT(t,e,n){var r=t.stateNode;if(!r)throw Error(ee(169));n?(t=xA(t,e,Qs),r.__reactInternalMemoizedMergedChildContext=t,rt(pn),rt(Zt),et(Zt,t)):rt(pn),et(pn,n)}var br=null,rf=!1,ap=!1;function RA(t){br===null?br=[t]:br.push(t)}function aV(t){rf=!0,RA(t)}function ts(){if(!ap&&br!==null){ap=!0;var t=0,e=Ye;try{var n=br;for(Ye=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}br=null,rf=!1}catch(i){throw br!==null&&(br=br.slice(t+1)),Z0(__,ts),i}finally{Ye=e,ap=!1}}return null}var Uo=[],Oo=0,ah=null,lh=0,Ln=[],Fn=0,Ys=null,Ur=1,Or="";function Ss(t,e){Uo[Oo++]=lh,Uo[Oo++]=ah,ah=t,lh=e}function PA(t,e,n){Ln[Fn++]=Ur,Ln[Fn++]=Or,Ln[Fn++]=Ys,Ys=t;var r=Ur;t=Or;var i=32-rr(r)-1;r&=~(1<<i),n+=1;var s=32-rr(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Ur=1<<32-rr(e)+i|n<<i|r,Or=s+t}else Ur=1<<s|n<<i|r,Or=t}function A_(t){t.return!==null&&(Ss(t,1),PA(t,1,0))}function x_(t){for(;t===ah;)ah=Uo[--Oo],Uo[Oo]=null,lh=Uo[--Oo],Uo[Oo]=null;for(;t===Ys;)Ys=Ln[--Fn],Ln[Fn]=null,Or=Ln[--Fn],Ln[Fn]=null,Ur=Ln[--Fn],Ln[Fn]=null}var An=null,Cn=null,ot=!1,Yn=null;function kA(t,e){var n=On(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function ZT(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,An=t,Cn=Li(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,An=t,Cn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Ys!==null?{id:Ur,overflow:Or}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=On(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,An=t,Cn=null,!0):!1;default:return!1}}function xm(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Rm(t){if(ot){var e=Cn;if(e){var n=e;if(!ZT(t,e)){if(xm(t))throw Error(ee(418));e=Li(n.nextSibling);var r=An;e&&ZT(t,e)?kA(r,n):(t.flags=t.flags&-4097|2,ot=!1,An=t)}}else{if(xm(t))throw Error(ee(418));t.flags=t.flags&-4097|2,ot=!1,An=t}}}function eE(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;An=t}function qc(t){if(t!==An)return!1;if(!ot)return eE(t),ot=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Im(t.type,t.memoizedProps)),e&&(e=Cn)){if(xm(t))throw NA(),Error(ee(418));for(;e;)kA(t,e),e=Li(e.nextSibling)}if(eE(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ee(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Cn=Li(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Cn=null}}else Cn=An?Li(t.stateNode.nextSibling):null;return!0}function NA(){for(var t=Cn;t;)t=Li(t.nextSibling)}function Ea(){Cn=An=null,ot=!1}function R_(t){Yn===null?Yn=[t]:Yn.push(t)}var lV=Zr.ReactCurrentBatchConfig;function gl(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ee(309));var r=n.stateNode}if(!r)throw Error(ee(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(ee(284));if(!n._owner)throw Error(ee(290,t))}return t}function Gc(t,e){throw t=Object.prototype.toString.call(e),Error(ee(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function tE(t){var e=t._init;return e(t._payload)}function DA(t){function e(C,w){if(t){var P=C.deletions;P===null?(C.deletions=[w],C.flags|=16):P.push(w)}}function n(C,w){if(!t)return null;for(;w!==null;)e(C,w),w=w.sibling;return null}function r(C,w){for(C=new Map;w!==null;)w.key!==null?C.set(w.key,w):C.set(w.index,w),w=w.sibling;return C}function i(C,w){return C=Bi(C,w),C.index=0,C.sibling=null,C}function s(C,w,P){return C.index=P,t?(P=C.alternate,P!==null?(P=P.index,P<w?(C.flags|=2,w):P):(C.flags|=2,w)):(C.flags|=1048576,w)}function o(C){return t&&C.alternate===null&&(C.flags|=2),C}function a(C,w,P,V){return w===null||w.tag!==6?(w=pp(P,C.mode,V),w.return=C,w):(w=i(w,P),w.return=C,w)}function l(C,w,P,V){var O=P.type;return O===Do?f(C,w,P.props.children,V,P.key):w!==null&&(w.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===mi&&tE(O)===w.type)?(V=i(w,P.props),V.ref=gl(C,w,P),V.return=C,V):(V=Ed(P.type,P.key,P.props,null,C.mode,V),V.ref=gl(C,w,P),V.return=C,V)}function u(C,w,P,V){return w===null||w.tag!==4||w.stateNode.containerInfo!==P.containerInfo||w.stateNode.implementation!==P.implementation?(w=mp(P,C.mode,V),w.return=C,w):(w=i(w,P.children||[]),w.return=C,w)}function f(C,w,P,V,O){return w===null||w.tag!==7?(w=qs(P,C.mode,V,O),w.return=C,w):(w=i(w,P),w.return=C,w)}function m(C,w,P){if(typeof w=="string"&&w!==""||typeof w=="number")return w=pp(""+w,C.mode,P),w.return=C,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Nc:return P=Ed(w.type,w.key,w.props,null,C.mode,P),P.ref=gl(C,null,w),P.return=C,P;case No:return w=mp(w,C.mode,P),w.return=C,w;case mi:var V=w._init;return m(C,V(w._payload),P)}if(Al(w)||dl(w))return w=qs(w,C.mode,P,null),w.return=C,w;Gc(C,w)}return null}function g(C,w,P,V){var O=w!==null?w.key:null;if(typeof P=="string"&&P!==""||typeof P=="number")return O!==null?null:a(C,w,""+P,V);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case Nc:return P.key===O?l(C,w,P,V):null;case No:return P.key===O?u(C,w,P,V):null;case mi:return O=P._init,g(C,w,O(P._payload),V)}if(Al(P)||dl(P))return O!==null?null:f(C,w,P,V,null);Gc(C,P)}return null}function v(C,w,P,V,O){if(typeof V=="string"&&V!==""||typeof V=="number")return C=C.get(P)||null,a(w,C,""+V,O);if(typeof V=="object"&&V!==null){switch(V.$$typeof){case Nc:return C=C.get(V.key===null?P:V.key)||null,l(w,C,V,O);case No:return C=C.get(V.key===null?P:V.key)||null,u(w,C,V,O);case mi:var B=V._init;return v(C,w,P,B(V._payload),O)}if(Al(V)||dl(V))return C=C.get(P)||null,f(w,C,V,O,null);Gc(w,V)}return null}function T(C,w,P,V){for(var O=null,B=null,E=w,I=w=0,A=null;E!==null&&I<P.length;I++){E.index>I?(A=E,E=null):A=E.sibling;var k=g(C,E,P[I],V);if(k===null){E===null&&(E=A);break}t&&E&&k.alternate===null&&e(C,E),w=s(k,w,I),B===null?O=k:B.sibling=k,B=k,E=A}if(I===P.length)return n(C,E),ot&&Ss(C,I),O;if(E===null){for(;I<P.length;I++)E=m(C,P[I],V),E!==null&&(w=s(E,w,I),B===null?O=E:B.sibling=E,B=E);return ot&&Ss(C,I),O}for(E=r(C,E);I<P.length;I++)A=v(E,C,I,P[I],V),A!==null&&(t&&A.alternate!==null&&E.delete(A.key===null?I:A.key),w=s(A,w,I),B===null?O=A:B.sibling=A,B=A);return t&&E.forEach(function(b){return e(C,b)}),ot&&Ss(C,I),O}function x(C,w,P,V){var O=dl(P);if(typeof O!="function")throw Error(ee(150));if(P=O.call(P),P==null)throw Error(ee(151));for(var B=O=null,E=w,I=w=0,A=null,k=P.next();E!==null&&!k.done;I++,k=P.next()){E.index>I?(A=E,E=null):A=E.sibling;var b=g(C,E,k.value,V);if(b===null){E===null&&(E=A);break}t&&E&&b.alternate===null&&e(C,E),w=s(b,w,I),B===null?O=b:B.sibling=b,B=b,E=A}if(k.done)return n(C,E),ot&&Ss(C,I),O;if(E===null){for(;!k.done;I++,k=P.next())k=m(C,k.value,V),k!==null&&(w=s(k,w,I),B===null?O=k:B.sibling=k,B=k);return ot&&Ss(C,I),O}for(E=r(C,E);!k.done;I++,k=P.next())k=v(E,C,I,k.value,V),k!==null&&(t&&k.alternate!==null&&E.delete(k.key===null?I:k.key),w=s(k,w,I),B===null?O=k:B.sibling=k,B=k);return t&&E.forEach(function(L){return e(C,L)}),ot&&Ss(C,I),O}function D(C,w,P,V){if(typeof P=="object"&&P!==null&&P.type===Do&&P.key===null&&(P=P.props.children),typeof P=="object"&&P!==null){switch(P.$$typeof){case Nc:e:{for(var O=P.key,B=w;B!==null;){if(B.key===O){if(O=P.type,O===Do){if(B.tag===7){n(C,B.sibling),w=i(B,P.props.children),w.return=C,C=w;break e}}else if(B.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===mi&&tE(O)===B.type){n(C,B.sibling),w=i(B,P.props),w.ref=gl(C,B,P),w.return=C,C=w;break e}n(C,B);break}else e(C,B);B=B.sibling}P.type===Do?(w=qs(P.props.children,C.mode,V,P.key),w.return=C,C=w):(V=Ed(P.type,P.key,P.props,null,C.mode,V),V.ref=gl(C,w,P),V.return=C,C=V)}return o(C);case No:e:{for(B=P.key;w!==null;){if(w.key===B)if(w.tag===4&&w.stateNode.containerInfo===P.containerInfo&&w.stateNode.implementation===P.implementation){n(C,w.sibling),w=i(w,P.children||[]),w.return=C,C=w;break e}else{n(C,w);break}else e(C,w);w=w.sibling}w=mp(P,C.mode,V),w.return=C,C=w}return o(C);case mi:return B=P._init,D(C,w,B(P._payload),V)}if(Al(P))return T(C,w,P,V);if(dl(P))return x(C,w,P,V);Gc(C,P)}return typeof P=="string"&&P!==""||typeof P=="number"?(P=""+P,w!==null&&w.tag===6?(n(C,w.sibling),w=i(w,P),w.return=C,C=w):(n(C,w),w=pp(P,C.mode,V),w.return=C,C=w),o(C)):n(C,w)}return D}var wa=DA(!0),bA=DA(!1),uh=es(null),ch=null,Bo=null,P_=null;function k_(){P_=Bo=ch=null}function N_(t){var e=uh.current;rt(uh),t._currentValue=e}function Pm(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Xo(t,e){ch=t,P_=Bo=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(fn=!0),t.firstContext=null)}function zn(t){var e=t._currentValue;if(P_!==t)if(t={context:t,memoizedValue:e,next:null},Bo===null){if(ch===null)throw Error(ee(308));Bo=t,ch.dependencies={lanes:0,firstContext:t}}else Bo=Bo.next=t;return e}var bs=null;function D_(t){bs===null?bs=[t]:bs.push(t)}function MA(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,D_(e)):(n.next=i.next,i.next=n),e.interleaved=n,jr(t,r)}function jr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var gi=!1;function b_(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function VA(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function qr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Fi(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Be&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,jr(t,n)}return i=r.interleaved,i===null?(e.next=e,D_(r)):(e.next=i.next,i.next=e),r.interleaved=e,jr(t,n)}function md(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,y_(t,n)}}function nE(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function dh(t,e,n,r){var i=t.updateQueue;gi=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?s=u:o.next=u,o=l;var f=t.alternate;f!==null&&(f=f.updateQueue,a=f.lastBaseUpdate,a!==o&&(a===null?f.firstBaseUpdate=u:a.next=u,f.lastBaseUpdate=l))}if(s!==null){var m=i.baseState;o=0,f=u=l=null,a=s;do{var g=a.lane,v=a.eventTime;if((r&g)===g){f!==null&&(f=f.next={eventTime:v,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var T=t,x=a;switch(g=e,v=n,x.tag){case 1:if(T=x.payload,typeof T=="function"){m=T.call(v,m,g);break e}m=T;break e;case 3:T.flags=T.flags&-65537|128;case 0:if(T=x.payload,g=typeof T=="function"?T.call(v,m,g):T,g==null)break e;m=pt({},m,g);break e;case 2:gi=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,g=i.effects,g===null?i.effects=[a]:g.push(a))}else v={eventTime:v,lane:g,tag:a.tag,payload:a.payload,callback:a.callback,next:null},f===null?(u=f=v,l=m):f=f.next=v,o|=g;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;g=a,a=g.next,g.next=null,i.lastBaseUpdate=g,i.shared.pending=null}}while(!0);if(f===null&&(l=m),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=f,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Zs|=o,t.lanes=o,t.memoizedState=m}}function rE(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(ee(191,i));i.call(r)}}}var Zu={},Er=es(Zu),wu=es(Zu),Iu=es(Zu);function Ms(t){if(t===Zu)throw Error(ee(174));return t}function M_(t,e){switch(et(Iu,e),et(wu,t),et(Er,Zu),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:um(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=um(e,t)}rt(Er),et(Er,e)}function Ia(){rt(Er),rt(wu),rt(Iu)}function LA(t){Ms(Iu.current);var e=Ms(Er.current),n=um(e,t.type);e!==n&&(et(wu,t),et(Er,n))}function V_(t){wu.current===t&&(rt(Er),rt(wu))}var dt=es(0);function hh(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var lp=[];function L_(){for(var t=0;t<lp.length;t++)lp[t]._workInProgressVersionPrimary=null;lp.length=0}var gd=Zr.ReactCurrentDispatcher,up=Zr.ReactCurrentBatchConfig,Xs=0,ft=null,Pt=null,Ut=null,fh=!1,Hl=!1,Su=0,uV=0;function Wt(){throw Error(ee(321))}function F_(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!sr(t[n],e[n]))return!1;return!0}function U_(t,e,n,r,i,s){if(Xs=s,ft=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,gd.current=t===null||t.memoizedState===null?fV:pV,t=n(r,i),Hl){s=0;do{if(Hl=!1,Su=0,25<=s)throw Error(ee(301));s+=1,Ut=Pt=null,e.updateQueue=null,gd.current=mV,t=n(r,i)}while(Hl)}if(gd.current=ph,e=Pt!==null&&Pt.next!==null,Xs=0,Ut=Pt=ft=null,fh=!1,e)throw Error(ee(300));return t}function O_(){var t=Su!==0;return Su=0,t}function fr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ut===null?ft.memoizedState=Ut=t:Ut=Ut.next=t,Ut}function Hn(){if(Pt===null){var t=ft.alternate;t=t!==null?t.memoizedState:null}else t=Pt.next;var e=Ut===null?ft.memoizedState:Ut.next;if(e!==null)Ut=e,Pt=t;else{if(t===null)throw Error(ee(310));Pt=t,t={memoizedState:Pt.memoizedState,baseState:Pt.baseState,baseQueue:Pt.baseQueue,queue:Pt.queue,next:null},Ut===null?ft.memoizedState=Ut=t:Ut=Ut.next=t}return Ut}function Cu(t,e){return typeof e=="function"?e(t):e}function cp(t){var e=Hn(),n=e.queue;if(n===null)throw Error(ee(311));n.lastRenderedReducer=t;var r=Pt,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,l=null,u=s;do{var f=u.lane;if((Xs&f)===f)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var m={lane:f,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=m,o=r):l=l.next=m,ft.lanes|=f,Zs|=f}u=u.next}while(u!==null&&u!==s);l===null?o=r:l.next=a,sr(r,e.memoizedState)||(fn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,ft.lanes|=s,Zs|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function dp(t){var e=Hn(),n=e.queue;if(n===null)throw Error(ee(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);sr(s,e.memoizedState)||(fn=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function FA(){}function UA(t,e){var n=ft,r=Hn(),i=e(),s=!sr(r.memoizedState,i);if(s&&(r.memoizedState=i,fn=!0),r=r.queue,B_(qA.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||Ut!==null&&Ut.memoizedState.tag&1){if(n.flags|=2048,Au(9,BA.bind(null,n,r,i,e),void 0,null),Ot===null)throw Error(ee(349));Xs&30||OA(n,e,i)}return i}function OA(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=ft.updateQueue,e===null?(e={lastEffect:null,stores:null},ft.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function BA(t,e,n,r){e.value=n,e.getSnapshot=r,GA(e)&&$A(t)}function qA(t,e,n){return n(function(){GA(e)&&$A(t)})}function GA(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!sr(t,n)}catch{return!0}}function $A(t){var e=jr(t,1);e!==null&&ir(e,t,1,-1)}function iE(t){var e=fr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Cu,lastRenderedState:t},e.queue=t,t=t.dispatch=hV.bind(null,ft,t),[e.memoizedState,t]}function Au(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=ft.updateQueue,e===null?(e={lastEffect:null,stores:null},ft.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function zA(){return Hn().memoizedState}function _d(t,e,n,r){var i=fr();ft.flags|=t,i.memoizedState=Au(1|e,n,void 0,r===void 0?null:r)}function sf(t,e,n,r){var i=Hn();r=r===void 0?null:r;var s=void 0;if(Pt!==null){var o=Pt.memoizedState;if(s=o.destroy,r!==null&&F_(r,o.deps)){i.memoizedState=Au(e,n,s,r);return}}ft.flags|=t,i.memoizedState=Au(1|e,n,s,r)}function sE(t,e){return _d(8390656,8,t,e)}function B_(t,e){return sf(2048,8,t,e)}function HA(t,e){return sf(4,2,t,e)}function WA(t,e){return sf(4,4,t,e)}function KA(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function jA(t,e,n){return n=n!=null?n.concat([t]):null,sf(4,4,KA.bind(null,e,t),n)}function q_(){}function JA(t,e){var n=Hn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&F_(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function QA(t,e){var n=Hn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&F_(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function YA(t,e,n){return Xs&21?(sr(n,e)||(n=nA(),ft.lanes|=n,Zs|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,fn=!0),t.memoizedState=n)}function cV(t,e){var n=Ye;Ye=n!==0&&4>n?n:4,t(!0);var r=up.transition;up.transition={};try{t(!1),e()}finally{Ye=n,up.transition=r}}function XA(){return Hn().memoizedState}function dV(t,e,n){var r=Oi(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},ZA(t))ex(e,n);else if(n=MA(t,e,n,r),n!==null){var i=an();ir(n,t,r,i),tx(n,e,r)}}function hV(t,e,n){var r=Oi(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(ZA(t))ex(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,sr(a,o)){var l=e.interleaved;l===null?(i.next=i,D_(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=MA(t,e,i,r),n!==null&&(i=an(),ir(n,t,r,i),tx(n,e,r))}}function ZA(t){var e=t.alternate;return t===ft||e!==null&&e===ft}function ex(t,e){Hl=fh=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function tx(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,y_(t,n)}}var ph={readContext:zn,useCallback:Wt,useContext:Wt,useEffect:Wt,useImperativeHandle:Wt,useInsertionEffect:Wt,useLayoutEffect:Wt,useMemo:Wt,useReducer:Wt,useRef:Wt,useState:Wt,useDebugValue:Wt,useDeferredValue:Wt,useTransition:Wt,useMutableSource:Wt,useSyncExternalStore:Wt,useId:Wt,unstable_isNewReconciler:!1},fV={readContext:zn,useCallback:function(t,e){return fr().memoizedState=[t,e===void 0?null:e],t},useContext:zn,useEffect:sE,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,_d(4194308,4,KA.bind(null,e,t),n)},useLayoutEffect:function(t,e){return _d(4194308,4,t,e)},useInsertionEffect:function(t,e){return _d(4,2,t,e)},useMemo:function(t,e){var n=fr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=fr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=dV.bind(null,ft,t),[r.memoizedState,t]},useRef:function(t){var e=fr();return t={current:t},e.memoizedState=t},useState:iE,useDebugValue:q_,useDeferredValue:function(t){return fr().memoizedState=t},useTransition:function(){var t=iE(!1),e=t[0];return t=cV.bind(null,t[1]),fr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=ft,i=fr();if(ot){if(n===void 0)throw Error(ee(407));n=n()}else{if(n=e(),Ot===null)throw Error(ee(349));Xs&30||OA(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,sE(qA.bind(null,r,s,t),[t]),r.flags|=2048,Au(9,BA.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=fr(),e=Ot.identifierPrefix;if(ot){var n=Or,r=Ur;n=(r&~(1<<32-rr(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Su++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=uV++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},pV={readContext:zn,useCallback:JA,useContext:zn,useEffect:B_,useImperativeHandle:jA,useInsertionEffect:HA,useLayoutEffect:WA,useMemo:QA,useReducer:cp,useRef:zA,useState:function(){return cp(Cu)},useDebugValue:q_,useDeferredValue:function(t){var e=Hn();return YA(e,Pt.memoizedState,t)},useTransition:function(){var t=cp(Cu)[0],e=Hn().memoizedState;return[t,e]},useMutableSource:FA,useSyncExternalStore:UA,useId:XA,unstable_isNewReconciler:!1},mV={readContext:zn,useCallback:JA,useContext:zn,useEffect:B_,useImperativeHandle:jA,useInsertionEffect:HA,useLayoutEffect:WA,useMemo:QA,useReducer:dp,useRef:zA,useState:function(){return dp(Cu)},useDebugValue:q_,useDeferredValue:function(t){var e=Hn();return Pt===null?e.memoizedState=t:YA(e,Pt.memoizedState,t)},useTransition:function(){var t=dp(Cu)[0],e=Hn().memoizedState;return[t,e]},useMutableSource:FA,useSyncExternalStore:UA,useId:XA,unstable_isNewReconciler:!1};function jn(t,e){if(t&&t.defaultProps){e=pt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function km(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:pt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var of={isMounted:function(t){return(t=t._reactInternals)?so(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=an(),i=Oi(t),s=qr(r,i);s.payload=e,n!=null&&(s.callback=n),e=Fi(t,s,i),e!==null&&(ir(e,t,i,r),md(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=an(),i=Oi(t),s=qr(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=Fi(t,s,i),e!==null&&(ir(e,t,i,r),md(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=an(),r=Oi(t),i=qr(n,r);i.tag=2,e!=null&&(i.callback=e),e=Fi(t,i,r),e!==null&&(ir(e,t,r,n),md(e,t,r))}};function oE(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!yu(n,r)||!yu(i,s):!0}function nx(t,e,n){var r=!1,i=Ji,s=e.contextType;return typeof s=="object"&&s!==null?s=zn(s):(i=mn(e)?Qs:Zt.current,r=e.contextTypes,s=(r=r!=null)?Ta(t,i):Ji),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=of,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function aE(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&of.enqueueReplaceState(e,e.state,null)}function Nm(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},b_(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=zn(s):(s=mn(e)?Qs:Zt.current,i.context=Ta(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(km(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&of.enqueueReplaceState(i,i.state,null),dh(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Sa(t,e){try{var n="",r=e;do n+=$M(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function hp(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Dm(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var gV=typeof WeakMap=="function"?WeakMap:Map;function rx(t,e,n){n=qr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){gh||(gh=!0,Gm=r),Dm(t,e)},n}function ix(t,e,n){n=qr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){Dm(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){Dm(t,e),typeof r!="function"&&(Ui===null?Ui=new Set([this]):Ui.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function lE(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new gV;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=kV.bind(null,t,e,n),e.then(t,t))}function uE(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function cE(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=qr(-1,1),e.tag=2,Fi(n,e,1))),n.lanes|=1),t)}var _V=Zr.ReactCurrentOwner,fn=!1;function tn(t,e,n,r){e.child=t===null?bA(e,null,n,r):wa(e,t.child,n,r)}function dE(t,e,n,r,i){n=n.render;var s=e.ref;return Xo(e,i),r=U_(t,e,n,r,s,i),n=O_(),t!==null&&!fn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Jr(t,e,i)):(ot&&n&&A_(e),e.flags|=1,tn(t,e,r,i),e.child)}function hE(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!J_(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,sx(t,e,s,r,i)):(t=Ed(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:yu,n(o,r)&&t.ref===e.ref)return Jr(t,e,i)}return e.flags|=1,t=Bi(s,r),t.ref=e.ref,t.return=e,e.child=t}function sx(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(yu(s,r)&&t.ref===e.ref)if(fn=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(fn=!0);else return e.lanes=t.lanes,Jr(t,e,i)}return bm(t,e,n,r,i)}function ox(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},et(Go,En),En|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,et(Go,En),En|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,et(Go,En),En|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,et(Go,En),En|=r;return tn(t,e,i,n),e.child}function ax(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function bm(t,e,n,r,i){var s=mn(n)?Qs:Zt.current;return s=Ta(e,s),Xo(e,i),n=U_(t,e,n,r,s,i),r=O_(),t!==null&&!fn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Jr(t,e,i)):(ot&&r&&A_(e),e.flags|=1,tn(t,e,n,i),e.child)}function fE(t,e,n,r,i){if(mn(n)){var s=!0;oh(e)}else s=!1;if(Xo(e,i),e.stateNode===null)yd(t,e),nx(e,n,r),Nm(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=zn(u):(u=mn(n)?Qs:Zt.current,u=Ta(e,u));var f=n.getDerivedStateFromProps,m=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function";m||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==u)&&aE(e,o,r,u),gi=!1;var g=e.memoizedState;o.state=g,dh(e,r,o,i),l=e.memoizedState,a!==r||g!==l||pn.current||gi?(typeof f=="function"&&(km(e,n,f,r),l=e.memoizedState),(a=gi||oE(e,n,a,r,g,l,u))?(m||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=u,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,VA(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:jn(e.type,a),o.props=u,m=e.pendingProps,g=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=zn(l):(l=mn(n)?Qs:Zt.current,l=Ta(e,l));var v=n.getDerivedStateFromProps;(f=typeof v=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==m||g!==l)&&aE(e,o,r,l),gi=!1,g=e.memoizedState,o.state=g,dh(e,r,o,i);var T=e.memoizedState;a!==m||g!==T||pn.current||gi?(typeof v=="function"&&(km(e,n,v,r),T=e.memoizedState),(u=gi||oE(e,n,u,r,g,T,l)||!1)?(f||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,T,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,T,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=T),o.props=r,o.state=T,o.context=l,r=u):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),r=!1)}return Mm(t,e,n,r,s,i)}function Mm(t,e,n,r,i,s){ax(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&XT(e,n,!1),Jr(t,e,s);r=e.stateNode,_V.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=wa(e,t.child,null,s),e.child=wa(e,null,a,s)):tn(t,e,a,s),e.memoizedState=r.state,i&&XT(e,n,!0),e.child}function lx(t){var e=t.stateNode;e.pendingContext?YT(t,e.pendingContext,e.pendingContext!==e.context):e.context&&YT(t,e.context,!1),M_(t,e.containerInfo)}function pE(t,e,n,r,i){return Ea(),R_(i),e.flags|=256,tn(t,e,n,r),e.child}var Vm={dehydrated:null,treeContext:null,retryLane:0};function Lm(t){return{baseLanes:t,cachePool:null,transitions:null}}function ux(t,e,n){var r=e.pendingProps,i=dt.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),et(dt,i&1),t===null)return Rm(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=uf(o,r,0,null),t=qs(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Lm(n),e.memoizedState=Vm,t):G_(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return yV(t,e,o,r,a,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Bi(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=Bi(a,s):(s=qs(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?Lm(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=Vm,r}return s=t.child,t=s.sibling,r=Bi(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function G_(t,e){return e=uf({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function $c(t,e,n,r){return r!==null&&R_(r),wa(e,t.child,null,n),t=G_(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function yV(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=hp(Error(ee(422))),$c(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=uf({mode:"visible",children:r.children},i,0,null),s=qs(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&wa(e,t.child,null,o),e.child.memoizedState=Lm(o),e.memoizedState=Vm,s);if(!(e.mode&1))return $c(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(ee(419)),r=hp(s,r,void 0),$c(t,e,o,r)}if(a=(o&t.childLanes)!==0,fn||a){if(r=Ot,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,jr(t,i),ir(r,t,i,-1))}return j_(),r=hp(Error(ee(421))),$c(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=NV.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Cn=Li(i.nextSibling),An=e,ot=!0,Yn=null,t!==null&&(Ln[Fn++]=Ur,Ln[Fn++]=Or,Ln[Fn++]=Ys,Ur=t.id,Or=t.overflow,Ys=e),e=G_(e,r.children),e.flags|=4096,e)}function mE(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Pm(t.return,e,n)}function fp(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function cx(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(tn(t,e,r.children,n),r=dt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&mE(t,n,e);else if(t.tag===19)mE(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(et(dt,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&hh(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),fp(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&hh(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}fp(e,!0,n,null,s);break;case"together":fp(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function yd(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Jr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Zs|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ee(153));if(e.child!==null){for(t=e.child,n=Bi(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Bi(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function vV(t,e,n){switch(e.tag){case 3:lx(e),Ea();break;case 5:LA(e);break;case 1:mn(e.type)&&oh(e);break;case 4:M_(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;et(uh,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(et(dt,dt.current&1),e.flags|=128,null):n&e.child.childLanes?ux(t,e,n):(et(dt,dt.current&1),t=Jr(t,e,n),t!==null?t.sibling:null);et(dt,dt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return cx(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),et(dt,dt.current),r)break;return null;case 22:case 23:return e.lanes=0,ox(t,e,n)}return Jr(t,e,n)}var dx,Fm,hx,fx;dx=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Fm=function(){};hx=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Ms(Er.current);var s=null;switch(n){case"input":i=sm(t,i),r=sm(t,r),s=[];break;case"select":i=pt({},i,{value:void 0}),r=pt({},r,{value:void 0}),s=[];break;case"textarea":i=lm(t,i),r=lm(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=ih)}cm(n,r);var o;n=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var a=i[u];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(du.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var l=r[u];if(a=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(du.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&tt("scroll",t),s||a===l||(s=[])):(s=s||[]).push(u,l))}n&&(s=s||[]).push("style",n);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};fx=function(t,e,n,r){n!==r&&(e.flags|=4)};function _l(t,e){if(!ot)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Kt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function TV(t,e,n){var r=e.pendingProps;switch(x_(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Kt(e),null;case 1:return mn(e.type)&&sh(),Kt(e),null;case 3:return r=e.stateNode,Ia(),rt(pn),rt(Zt),L_(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(qc(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Yn!==null&&(Hm(Yn),Yn=null))),Fm(t,e),Kt(e),null;case 5:V_(e);var i=Ms(Iu.current);if(n=e.type,t!==null&&e.stateNode!=null)hx(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(ee(166));return Kt(e),null}if(t=Ms(Er.current),qc(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[mr]=e,r[Eu]=s,t=(e.mode&1)!==0,n){case"dialog":tt("cancel",r),tt("close",r);break;case"iframe":case"object":case"embed":tt("load",r);break;case"video":case"audio":for(i=0;i<Rl.length;i++)tt(Rl[i],r);break;case"source":tt("error",r);break;case"img":case"image":case"link":tt("error",r),tt("load",r);break;case"details":tt("toggle",r);break;case"input":ST(r,s),tt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},tt("invalid",r);break;case"textarea":AT(r,s),tt("invalid",r)}cm(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&Bc(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Bc(r.textContent,a,t),i=["children",""+a]):du.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&tt("scroll",r)}switch(n){case"input":Dc(r),CT(r,s,!0);break;case"textarea":Dc(r),xT(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=ih)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=q0(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[mr]=e,t[Eu]=r,dx(t,e,!1,!1),e.stateNode=t;e:{switch(o=dm(n,r),n){case"dialog":tt("cancel",t),tt("close",t),i=r;break;case"iframe":case"object":case"embed":tt("load",t),i=r;break;case"video":case"audio":for(i=0;i<Rl.length;i++)tt(Rl[i],t);i=r;break;case"source":tt("error",t),i=r;break;case"img":case"image":case"link":tt("error",t),tt("load",t),i=r;break;case"details":tt("toggle",t),i=r;break;case"input":ST(t,r),i=sm(t,r),tt("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=pt({},r,{value:void 0}),tt("invalid",t);break;case"textarea":AT(t,r),i=lm(t,r),tt("invalid",t);break;default:i=r}cm(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?z0(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&G0(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&hu(t,l):typeof l=="number"&&hu(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(du.hasOwnProperty(s)?l!=null&&s==="onScroll"&&tt("scroll",t):l!=null&&h_(t,s,l,o))}switch(n){case"input":Dc(t),CT(t,r,!1);break;case"textarea":Dc(t),xT(t);break;case"option":r.value!=null&&t.setAttribute("value",""+ji(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?jo(t,!!r.multiple,s,!1):r.defaultValue!=null&&jo(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=ih)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Kt(e),null;case 6:if(t&&e.stateNode!=null)fx(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(ee(166));if(n=Ms(Iu.current),Ms(Er.current),qc(e)){if(r=e.stateNode,n=e.memoizedProps,r[mr]=e,(s=r.nodeValue!==n)&&(t=An,t!==null))switch(t.tag){case 3:Bc(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Bc(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[mr]=e,e.stateNode=r}return Kt(e),null;case 13:if(rt(dt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ot&&Cn!==null&&e.mode&1&&!(e.flags&128))NA(),Ea(),e.flags|=98560,s=!1;else if(s=qc(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(ee(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ee(317));s[mr]=e}else Ea(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Kt(e),s=!1}else Yn!==null&&(Hm(Yn),Yn=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||dt.current&1?kt===0&&(kt=3):j_())),e.updateQueue!==null&&(e.flags|=4),Kt(e),null);case 4:return Ia(),Fm(t,e),t===null&&vu(e.stateNode.containerInfo),Kt(e),null;case 10:return N_(e.type._context),Kt(e),null;case 17:return mn(e.type)&&sh(),Kt(e),null;case 19:if(rt(dt),s=e.memoizedState,s===null)return Kt(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)_l(s,!1);else{if(kt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=hh(t),o!==null){for(e.flags|=128,_l(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return et(dt,dt.current&1|2),e.child}t=t.sibling}s.tail!==null&&vt()>Ca&&(e.flags|=128,r=!0,_l(s,!1),e.lanes=4194304)}else{if(!r)if(t=hh(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),_l(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!ot)return Kt(e),null}else 2*vt()-s.renderingStartTime>Ca&&n!==1073741824&&(e.flags|=128,r=!0,_l(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=vt(),e.sibling=null,n=dt.current,et(dt,r?n&1|2:n&1),e):(Kt(e),null);case 22:case 23:return K_(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?En&1073741824&&(Kt(e),e.subtreeFlags&6&&(e.flags|=8192)):Kt(e),null;case 24:return null;case 25:return null}throw Error(ee(156,e.tag))}function EV(t,e){switch(x_(e),e.tag){case 1:return mn(e.type)&&sh(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Ia(),rt(pn),rt(Zt),L_(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return V_(e),null;case 13:if(rt(dt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ee(340));Ea()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return rt(dt),null;case 4:return Ia(),null;case 10:return N_(e.type._context),null;case 22:case 23:return K_(),null;case 24:return null;default:return null}}var zc=!1,Jt=!1,wV=typeof WeakSet=="function"?WeakSet:Set,ue=null;function qo(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){mt(t,e,r)}else n.current=null}function Um(t,e,n){try{n()}catch(r){mt(t,e,r)}}var gE=!1;function IV(t,e){if(Em=th,t=yA(),C_(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,u=0,f=0,m=t,g=null;t:for(;;){for(var v;m!==n||i!==0&&m.nodeType!==3||(a=o+i),m!==s||r!==0&&m.nodeType!==3||(l=o+r),m.nodeType===3&&(o+=m.nodeValue.length),(v=m.firstChild)!==null;)g=m,m=v;for(;;){if(m===t)break t;if(g===n&&++u===i&&(a=o),g===s&&++f===r&&(l=o),(v=m.nextSibling)!==null)break;m=g,g=m.parentNode}m=v}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(wm={focusedElem:t,selectionRange:n},th=!1,ue=e;ue!==null;)if(e=ue,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ue=t;else for(;ue!==null;){e=ue;try{var T=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(T!==null){var x=T.memoizedProps,D=T.memoizedState,C=e.stateNode,w=C.getSnapshotBeforeUpdate(e.elementType===e.type?x:jn(e.type,x),D);C.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var P=e.stateNode.containerInfo;P.nodeType===1?P.textContent="":P.nodeType===9&&P.documentElement&&P.removeChild(P.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ee(163))}}catch(V){mt(e,e.return,V)}if(t=e.sibling,t!==null){t.return=e.return,ue=t;break}ue=e.return}return T=gE,gE=!1,T}function Wl(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&Um(e,n,s)}i=i.next}while(i!==r)}}function af(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Om(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function px(t){var e=t.alternate;e!==null&&(t.alternate=null,px(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[mr],delete e[Eu],delete e[Cm],delete e[sV],delete e[oV])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function mx(t){return t.tag===5||t.tag===3||t.tag===4}function _E(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||mx(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Bm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=ih));else if(r!==4&&(t=t.child,t!==null))for(Bm(t,e,n),t=t.sibling;t!==null;)Bm(t,e,n),t=t.sibling}function qm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(qm(t,e,n),t=t.sibling;t!==null;)qm(t,e,n),t=t.sibling}var Bt=null,Qn=!1;function fi(t,e,n){for(n=n.child;n!==null;)gx(t,e,n),n=n.sibling}function gx(t,e,n){if(Tr&&typeof Tr.onCommitFiberUnmount=="function")try{Tr.onCommitFiberUnmount(Xh,n)}catch{}switch(n.tag){case 5:Jt||qo(n,e);case 6:var r=Bt,i=Qn;Bt=null,fi(t,e,n),Bt=r,Qn=i,Bt!==null&&(Qn?(t=Bt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Bt.removeChild(n.stateNode));break;case 18:Bt!==null&&(Qn?(t=Bt,n=n.stateNode,t.nodeType===8?op(t.parentNode,n):t.nodeType===1&&op(t,n),gu(t)):op(Bt,n.stateNode));break;case 4:r=Bt,i=Qn,Bt=n.stateNode.containerInfo,Qn=!0,fi(t,e,n),Bt=r,Qn=i;break;case 0:case 11:case 14:case 15:if(!Jt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&Um(n,e,o),i=i.next}while(i!==r)}fi(t,e,n);break;case 1:if(!Jt&&(qo(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){mt(n,e,a)}fi(t,e,n);break;case 21:fi(t,e,n);break;case 22:n.mode&1?(Jt=(r=Jt)||n.memoizedState!==null,fi(t,e,n),Jt=r):fi(t,e,n);break;default:fi(t,e,n)}}function yE(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new wV),e.forEach(function(r){var i=DV.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Kn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Bt=a.stateNode,Qn=!1;break e;case 3:Bt=a.stateNode.containerInfo,Qn=!0;break e;case 4:Bt=a.stateNode.containerInfo,Qn=!0;break e}a=a.return}if(Bt===null)throw Error(ee(160));gx(s,o,i),Bt=null,Qn=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){mt(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)_x(e,t),e=e.sibling}function _x(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Kn(e,t),hr(t),r&4){try{Wl(3,t,t.return),af(3,t)}catch(x){mt(t,t.return,x)}try{Wl(5,t,t.return)}catch(x){mt(t,t.return,x)}}break;case 1:Kn(e,t),hr(t),r&512&&n!==null&&qo(n,n.return);break;case 5:if(Kn(e,t),hr(t),r&512&&n!==null&&qo(n,n.return),t.flags&32){var i=t.stateNode;try{hu(i,"")}catch(x){mt(t,t.return,x)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&O0(i,s),dm(a,o);var u=dm(a,s);for(o=0;o<l.length;o+=2){var f=l[o],m=l[o+1];f==="style"?z0(i,m):f==="dangerouslySetInnerHTML"?G0(i,m):f==="children"?hu(i,m):h_(i,f,m,u)}switch(a){case"input":om(i,s);break;case"textarea":B0(i,s);break;case"select":var g=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var v=s.value;v!=null?jo(i,!!s.multiple,v,!1):g!==!!s.multiple&&(s.defaultValue!=null?jo(i,!!s.multiple,s.defaultValue,!0):jo(i,!!s.multiple,s.multiple?[]:"",!1))}i[Eu]=s}catch(x){mt(t,t.return,x)}}break;case 6:if(Kn(e,t),hr(t),r&4){if(t.stateNode===null)throw Error(ee(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(x){mt(t,t.return,x)}}break;case 3:if(Kn(e,t),hr(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{gu(e.containerInfo)}catch(x){mt(t,t.return,x)}break;case 4:Kn(e,t),hr(t);break;case 13:Kn(e,t),hr(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(H_=vt())),r&4&&yE(t);break;case 22:if(f=n!==null&&n.memoizedState!==null,t.mode&1?(Jt=(u=Jt)||f,Kn(e,t),Jt=u):Kn(e,t),hr(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!f&&t.mode&1)for(ue=t,f=t.child;f!==null;){for(m=ue=f;ue!==null;){switch(g=ue,v=g.child,g.tag){case 0:case 11:case 14:case 15:Wl(4,g,g.return);break;case 1:qo(g,g.return);var T=g.stateNode;if(typeof T.componentWillUnmount=="function"){r=g,n=g.return;try{e=r,T.props=e.memoizedProps,T.state=e.memoizedState,T.componentWillUnmount()}catch(x){mt(r,n,x)}}break;case 5:qo(g,g.return);break;case 22:if(g.memoizedState!==null){TE(m);continue}}v!==null?(v.return=g,ue=v):TE(m)}f=f.sibling}e:for(f=null,m=t;;){if(m.tag===5){if(f===null){f=m;try{i=m.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=m.stateNode,l=m.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=$0("display",o))}catch(x){mt(t,t.return,x)}}}else if(m.tag===6){if(f===null)try{m.stateNode.nodeValue=u?"":m.memoizedProps}catch(x){mt(t,t.return,x)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===t)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===t)break e;for(;m.sibling===null;){if(m.return===null||m.return===t)break e;f===m&&(f=null),m=m.return}f===m&&(f=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:Kn(e,t),hr(t),r&4&&yE(t);break;case 21:break;default:Kn(e,t),hr(t)}}function hr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(mx(n)){var r=n;break e}n=n.return}throw Error(ee(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(hu(i,""),r.flags&=-33);var s=_E(t);qm(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=_E(t);Bm(t,a,o);break;default:throw Error(ee(161))}}catch(l){mt(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function SV(t,e,n){ue=t,yx(t)}function yx(t,e,n){for(var r=(t.mode&1)!==0;ue!==null;){var i=ue,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||zc;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||Jt;a=zc;var u=Jt;if(zc=o,(Jt=l)&&!u)for(ue=i;ue!==null;)o=ue,l=o.child,o.tag===22&&o.memoizedState!==null?EE(i):l!==null?(l.return=o,ue=l):EE(i);for(;s!==null;)ue=s,yx(s),s=s.sibling;ue=i,zc=a,Jt=u}vE(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,ue=s):vE(t)}}function vE(t){for(;ue!==null;){var e=ue;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Jt||af(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Jt)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:jn(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&rE(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}rE(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var f=u.memoizedState;if(f!==null){var m=f.dehydrated;m!==null&&gu(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ee(163))}Jt||e.flags&512&&Om(e)}catch(g){mt(e,e.return,g)}}if(e===t){ue=null;break}if(n=e.sibling,n!==null){n.return=e.return,ue=n;break}ue=e.return}}function TE(t){for(;ue!==null;){var e=ue;if(e===t){ue=null;break}var n=e.sibling;if(n!==null){n.return=e.return,ue=n;break}ue=e.return}}function EE(t){for(;ue!==null;){var e=ue;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{af(4,e)}catch(l){mt(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){mt(e,i,l)}}var s=e.return;try{Om(e)}catch(l){mt(e,s,l)}break;case 5:var o=e.return;try{Om(e)}catch(l){mt(e,o,l)}}}catch(l){mt(e,e.return,l)}if(e===t){ue=null;break}var a=e.sibling;if(a!==null){a.return=e.return,ue=a;break}ue=e.return}}var CV=Math.ceil,mh=Zr.ReactCurrentDispatcher,$_=Zr.ReactCurrentOwner,Gn=Zr.ReactCurrentBatchConfig,Be=0,Ot=null,It=null,$t=0,En=0,Go=es(0),kt=0,xu=null,Zs=0,lf=0,z_=0,Kl=null,dn=null,H_=0,Ca=1/0,Dr=null,gh=!1,Gm=null,Ui=null,Hc=!1,Ci=null,_h=0,jl=0,$m=null,vd=-1,Td=0;function an(){return Be&6?vt():vd!==-1?vd:vd=vt()}function Oi(t){return t.mode&1?Be&2&&$t!==0?$t&-$t:lV.transition!==null?(Td===0&&(Td=nA()),Td):(t=Ye,t!==0||(t=window.event,t=t===void 0?16:uA(t.type)),t):1}function ir(t,e,n,r){if(50<jl)throw jl=0,$m=null,Error(ee(185));Qu(t,n,r),(!(Be&2)||t!==Ot)&&(t===Ot&&(!(Be&2)&&(lf|=n),kt===4&&wi(t,$t)),gn(t,r),n===1&&Be===0&&!(e.mode&1)&&(Ca=vt()+500,rf&&ts()))}function gn(t,e){var n=t.callbackNode;l2(t,e);var r=eh(t,t===Ot?$t:0);if(r===0)n!==null&&kT(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&kT(n),e===1)t.tag===0?aV(wE.bind(null,t)):RA(wE.bind(null,t)),rV(function(){!(Be&6)&&ts()}),n=null;else{switch(rA(r)){case 1:n=__;break;case 4:n=eA;break;case 16:n=Zd;break;case 536870912:n=tA;break;default:n=Zd}n=Ax(n,vx.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function vx(t,e){if(vd=-1,Td=0,Be&6)throw Error(ee(327));var n=t.callbackNode;if(Zo()&&t.callbackNode!==n)return null;var r=eh(t,t===Ot?$t:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=yh(t,r);else{e=r;var i=Be;Be|=2;var s=Ex();(Ot!==t||$t!==e)&&(Dr=null,Ca=vt()+500,Bs(t,e));do try{RV();break}catch(a){Tx(t,a)}while(!0);k_(),mh.current=s,Be=i,It!==null?e=0:(Ot=null,$t=0,e=kt)}if(e!==0){if(e===2&&(i=gm(t),i!==0&&(r=i,e=zm(t,i))),e===1)throw n=xu,Bs(t,0),wi(t,r),gn(t,vt()),n;if(e===6)wi(t,r);else{if(i=t.current.alternate,!(r&30)&&!AV(i)&&(e=yh(t,r),e===2&&(s=gm(t),s!==0&&(r=s,e=zm(t,s))),e===1))throw n=xu,Bs(t,0),wi(t,r),gn(t,vt()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(ee(345));case 2:Cs(t,dn,Dr);break;case 3:if(wi(t,r),(r&130023424)===r&&(e=H_+500-vt(),10<e)){if(eh(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){an(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Sm(Cs.bind(null,t,dn,Dr),e);break}Cs(t,dn,Dr);break;case 4:if(wi(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-rr(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=vt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*CV(r/1960))-r,10<r){t.timeoutHandle=Sm(Cs.bind(null,t,dn,Dr),r);break}Cs(t,dn,Dr);break;case 5:Cs(t,dn,Dr);break;default:throw Error(ee(329))}}}return gn(t,vt()),t.callbackNode===n?vx.bind(null,t):null}function zm(t,e){var n=Kl;return t.current.memoizedState.isDehydrated&&(Bs(t,e).flags|=256),t=yh(t,e),t!==2&&(e=dn,dn=n,e!==null&&Hm(e)),t}function Hm(t){dn===null?dn=t:dn.push.apply(dn,t)}function AV(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!sr(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function wi(t,e){for(e&=~z_,e&=~lf,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-rr(e),r=1<<n;t[n]=-1,e&=~r}}function wE(t){if(Be&6)throw Error(ee(327));Zo();var e=eh(t,0);if(!(e&1))return gn(t,vt()),null;var n=yh(t,e);if(t.tag!==0&&n===2){var r=gm(t);r!==0&&(e=r,n=zm(t,r))}if(n===1)throw n=xu,Bs(t,0),wi(t,e),gn(t,vt()),n;if(n===6)throw Error(ee(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Cs(t,dn,Dr),gn(t,vt()),null}function W_(t,e){var n=Be;Be|=1;try{return t(e)}finally{Be=n,Be===0&&(Ca=vt()+500,rf&&ts())}}function eo(t){Ci!==null&&Ci.tag===0&&!(Be&6)&&Zo();var e=Be;Be|=1;var n=Gn.transition,r=Ye;try{if(Gn.transition=null,Ye=1,t)return t()}finally{Ye=r,Gn.transition=n,Be=e,!(Be&6)&&ts()}}function K_(){En=Go.current,rt(Go)}function Bs(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,nV(n)),It!==null)for(n=It.return;n!==null;){var r=n;switch(x_(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&sh();break;case 3:Ia(),rt(pn),rt(Zt),L_();break;case 5:V_(r);break;case 4:Ia();break;case 13:rt(dt);break;case 19:rt(dt);break;case 10:N_(r.type._context);break;case 22:case 23:K_()}n=n.return}if(Ot=t,It=t=Bi(t.current,null),$t=En=e,kt=0,xu=null,z_=lf=Zs=0,dn=Kl=null,bs!==null){for(e=0;e<bs.length;e++)if(n=bs[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}bs=null}return t}function Tx(t,e){do{var n=It;try{if(k_(),gd.current=ph,fh){for(var r=ft.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}fh=!1}if(Xs=0,Ut=Pt=ft=null,Hl=!1,Su=0,$_.current=null,n===null||n.return===null){kt=1,xu=e,It=null;break}e:{var s=t,o=n.return,a=n,l=e;if(e=$t,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,f=a,m=f.tag;if(!(f.mode&1)&&(m===0||m===11||m===15)){var g=f.alternate;g?(f.updateQueue=g.updateQueue,f.memoizedState=g.memoizedState,f.lanes=g.lanes):(f.updateQueue=null,f.memoizedState=null)}var v=uE(o);if(v!==null){v.flags&=-257,cE(v,o,a,s,e),v.mode&1&&lE(s,u,e),e=v,l=u;var T=e.updateQueue;if(T===null){var x=new Set;x.add(l),e.updateQueue=x}else T.add(l);break e}else{if(!(e&1)){lE(s,u,e),j_();break e}l=Error(ee(426))}}else if(ot&&a.mode&1){var D=uE(o);if(D!==null){!(D.flags&65536)&&(D.flags|=256),cE(D,o,a,s,e),R_(Sa(l,a));break e}}s=l=Sa(l,a),kt!==4&&(kt=2),Kl===null?Kl=[s]:Kl.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var C=rx(s,l,e);nE(s,C);break e;case 1:a=l;var w=s.type,P=s.stateNode;if(!(s.flags&128)&&(typeof w.getDerivedStateFromError=="function"||P!==null&&typeof P.componentDidCatch=="function"&&(Ui===null||!Ui.has(P)))){s.flags|=65536,e&=-e,s.lanes|=e;var V=ix(s,a,e);nE(s,V);break e}}s=s.return}while(s!==null)}Ix(n)}catch(O){e=O,It===n&&n!==null&&(It=n=n.return);continue}break}while(!0)}function Ex(){var t=mh.current;return mh.current=ph,t===null?ph:t}function j_(){(kt===0||kt===3||kt===2)&&(kt=4),Ot===null||!(Zs&268435455)&&!(lf&268435455)||wi(Ot,$t)}function yh(t,e){var n=Be;Be|=2;var r=Ex();(Ot!==t||$t!==e)&&(Dr=null,Bs(t,e));do try{xV();break}catch(i){Tx(t,i)}while(!0);if(k_(),Be=n,mh.current=r,It!==null)throw Error(ee(261));return Ot=null,$t=0,kt}function xV(){for(;It!==null;)wx(It)}function RV(){for(;It!==null&&!ZM();)wx(It)}function wx(t){var e=Cx(t.alternate,t,En);t.memoizedProps=t.pendingProps,e===null?Ix(t):It=e,$_.current=null}function Ix(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=EV(n,e),n!==null){n.flags&=32767,It=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{kt=6,It=null;return}}else if(n=TV(n,e,En),n!==null){It=n;return}if(e=e.sibling,e!==null){It=e;return}It=e=t}while(e!==null);kt===0&&(kt=5)}function Cs(t,e,n){var r=Ye,i=Gn.transition;try{Gn.transition=null,Ye=1,PV(t,e,n,r)}finally{Gn.transition=i,Ye=r}return null}function PV(t,e,n,r){do Zo();while(Ci!==null);if(Be&6)throw Error(ee(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(ee(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(u2(t,s),t===Ot&&(It=Ot=null,$t=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Hc||(Hc=!0,Ax(Zd,function(){return Zo(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=Gn.transition,Gn.transition=null;var o=Ye;Ye=1;var a=Be;Be|=4,$_.current=null,IV(t,n),_x(n,t),J2(wm),th=!!Em,wm=Em=null,t.current=n,SV(n),e2(),Be=a,Ye=o,Gn.transition=s}else t.current=n;if(Hc&&(Hc=!1,Ci=t,_h=i),s=t.pendingLanes,s===0&&(Ui=null),r2(n.stateNode),gn(t,vt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(gh)throw gh=!1,t=Gm,Gm=null,t;return _h&1&&t.tag!==0&&Zo(),s=t.pendingLanes,s&1?t===$m?jl++:(jl=0,$m=t):jl=0,ts(),null}function Zo(){if(Ci!==null){var t=rA(_h),e=Gn.transition,n=Ye;try{if(Gn.transition=null,Ye=16>t?16:t,Ci===null)var r=!1;else{if(t=Ci,Ci=null,_h=0,Be&6)throw Error(ee(331));var i=Be;for(Be|=4,ue=t.current;ue!==null;){var s=ue,o=s.child;if(ue.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(ue=u;ue!==null;){var f=ue;switch(f.tag){case 0:case 11:case 15:Wl(8,f,s)}var m=f.child;if(m!==null)m.return=f,ue=m;else for(;ue!==null;){f=ue;var g=f.sibling,v=f.return;if(px(f),f===u){ue=null;break}if(g!==null){g.return=v,ue=g;break}ue=v}}}var T=s.alternate;if(T!==null){var x=T.child;if(x!==null){T.child=null;do{var D=x.sibling;x.sibling=null,x=D}while(x!==null)}}ue=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,ue=o;else e:for(;ue!==null;){if(s=ue,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Wl(9,s,s.return)}var C=s.sibling;if(C!==null){C.return=s.return,ue=C;break e}ue=s.return}}var w=t.current;for(ue=w;ue!==null;){o=ue;var P=o.child;if(o.subtreeFlags&2064&&P!==null)P.return=o,ue=P;else e:for(o=w;ue!==null;){if(a=ue,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:af(9,a)}}catch(O){mt(a,a.return,O)}if(a===o){ue=null;break e}var V=a.sibling;if(V!==null){V.return=a.return,ue=V;break e}ue=a.return}}if(Be=i,ts(),Tr&&typeof Tr.onPostCommitFiberRoot=="function")try{Tr.onPostCommitFiberRoot(Xh,t)}catch{}r=!0}return r}finally{Ye=n,Gn.transition=e}}return!1}function IE(t,e,n){e=Sa(n,e),e=rx(t,e,1),t=Fi(t,e,1),e=an(),t!==null&&(Qu(t,1,e),gn(t,e))}function mt(t,e,n){if(t.tag===3)IE(t,t,n);else for(;e!==null;){if(e.tag===3){IE(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ui===null||!Ui.has(r))){t=Sa(n,t),t=ix(e,t,1),e=Fi(e,t,1),t=an(),e!==null&&(Qu(e,1,t),gn(e,t));break}}e=e.return}}function kV(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=an(),t.pingedLanes|=t.suspendedLanes&n,Ot===t&&($t&n)===n&&(kt===4||kt===3&&($t&130023424)===$t&&500>vt()-H_?Bs(t,0):z_|=n),gn(t,e)}function Sx(t,e){e===0&&(t.mode&1?(e=Vc,Vc<<=1,!(Vc&130023424)&&(Vc=4194304)):e=1);var n=an();t=jr(t,e),t!==null&&(Qu(t,e,n),gn(t,n))}function NV(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),Sx(t,n)}function DV(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(ee(314))}r!==null&&r.delete(e),Sx(t,n)}var Cx;Cx=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||pn.current)fn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return fn=!1,vV(t,e,n);fn=!!(t.flags&131072)}else fn=!1,ot&&e.flags&1048576&&PA(e,lh,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;yd(t,e),t=e.pendingProps;var i=Ta(e,Zt.current);Xo(e,n),i=U_(null,e,r,t,i,n);var s=O_();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,mn(r)?(s=!0,oh(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,b_(e),i.updater=of,e.stateNode=i,i._reactInternals=e,Nm(e,r,t,n),e=Mm(null,e,r,!0,s,n)):(e.tag=0,ot&&s&&A_(e),tn(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(yd(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=MV(r),t=jn(r,t),i){case 0:e=bm(null,e,r,t,n);break e;case 1:e=fE(null,e,r,t,n);break e;case 11:e=dE(null,e,r,t,n);break e;case 14:e=hE(null,e,r,jn(r.type,t),n);break e}throw Error(ee(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:jn(r,i),bm(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:jn(r,i),fE(t,e,r,i,n);case 3:e:{if(lx(e),t===null)throw Error(ee(387));r=e.pendingProps,s=e.memoizedState,i=s.element,VA(t,e),dh(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Sa(Error(ee(423)),e),e=pE(t,e,r,n,i);break e}else if(r!==i){i=Sa(Error(ee(424)),e),e=pE(t,e,r,n,i);break e}else for(Cn=Li(e.stateNode.containerInfo.firstChild),An=e,ot=!0,Yn=null,n=bA(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Ea(),r===i){e=Jr(t,e,n);break e}tn(t,e,r,n)}e=e.child}return e;case 5:return LA(e),t===null&&Rm(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,Im(r,i)?o=null:s!==null&&Im(r,s)&&(e.flags|=32),ax(t,e),tn(t,e,o,n),e.child;case 6:return t===null&&Rm(e),null;case 13:return ux(t,e,n);case 4:return M_(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=wa(e,null,r,n):tn(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:jn(r,i),dE(t,e,r,i,n);case 7:return tn(t,e,e.pendingProps,n),e.child;case 8:return tn(t,e,e.pendingProps.children,n),e.child;case 12:return tn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,et(uh,r._currentValue),r._currentValue=o,s!==null)if(sr(s.value,o)){if(s.children===i.children&&!pn.current){e=Jr(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=qr(-1,n&-n),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var f=u.pending;f===null?l.next=l:(l.next=f.next,f.next=l),u.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),Pm(s.return,n,e),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(ee(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),Pm(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}tn(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Xo(e,n),i=zn(i),r=r(i),e.flags|=1,tn(t,e,r,n),e.child;case 14:return r=e.type,i=jn(r,e.pendingProps),i=jn(r.type,i),hE(t,e,r,i,n);case 15:return sx(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:jn(r,i),yd(t,e),e.tag=1,mn(r)?(t=!0,oh(e)):t=!1,Xo(e,n),nx(e,r,i),Nm(e,r,i,n),Mm(null,e,r,!0,t,n);case 19:return cx(t,e,n);case 22:return ox(t,e,n)}throw Error(ee(156,e.tag))};function Ax(t,e){return Z0(t,e)}function bV(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function On(t,e,n,r){return new bV(t,e,n,r)}function J_(t){return t=t.prototype,!(!t||!t.isReactComponent)}function MV(t){if(typeof t=="function")return J_(t)?1:0;if(t!=null){if(t=t.$$typeof,t===p_)return 11;if(t===m_)return 14}return 2}function Bi(t,e){var n=t.alternate;return n===null?(n=On(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Ed(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")J_(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Do:return qs(n.children,i,s,e);case f_:o=8,i|=8;break;case tm:return t=On(12,n,e,i|2),t.elementType=tm,t.lanes=s,t;case nm:return t=On(13,n,e,i),t.elementType=nm,t.lanes=s,t;case rm:return t=On(19,n,e,i),t.elementType=rm,t.lanes=s,t;case L0:return uf(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case M0:o=10;break e;case V0:o=9;break e;case p_:o=11;break e;case m_:o=14;break e;case mi:o=16,r=null;break e}throw Error(ee(130,t==null?t:typeof t,""))}return e=On(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function qs(t,e,n,r){return t=On(7,t,r,e),t.lanes=n,t}function uf(t,e,n,r){return t=On(22,t,r,e),t.elementType=L0,t.lanes=n,t.stateNode={isHidden:!1},t}function pp(t,e,n){return t=On(6,t,null,e),t.lanes=n,t}function mp(t,e,n){return e=On(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function VV(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Jf(0),this.expirationTimes=Jf(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Jf(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Q_(t,e,n,r,i,s,o,a,l){return t=new VV(t,e,n,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=On(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},b_(s),t}function LV(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:No,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function xx(t){if(!t)return Ji;t=t._reactInternals;e:{if(so(t)!==t||t.tag!==1)throw Error(ee(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(mn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ee(171))}if(t.tag===1){var n=t.type;if(mn(n))return xA(t,n,e)}return e}function Rx(t,e,n,r,i,s,o,a,l){return t=Q_(n,r,!0,t,i,s,o,a,l),t.context=xx(null),n=t.current,r=an(),i=Oi(n),s=qr(r,i),s.callback=e??null,Fi(n,s,i),t.current.lanes=i,Qu(t,i,r),gn(t,r),t}function cf(t,e,n,r){var i=e.current,s=an(),o=Oi(i);return n=xx(n),e.context===null?e.context=n:e.pendingContext=n,e=qr(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Fi(i,e,o),t!==null&&(ir(t,i,o,s),md(t,i,o)),o}function vh(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function SE(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Y_(t,e){SE(t,e),(t=t.alternate)&&SE(t,e)}function FV(){return null}var Px=typeof reportError=="function"?reportError:function(t){console.error(t)};function X_(t){this._internalRoot=t}df.prototype.render=X_.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ee(409));cf(t,e,null,null)};df.prototype.unmount=X_.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;eo(function(){cf(null,t,null,null)}),e[Kr]=null}};function df(t){this._internalRoot=t}df.prototype.unstable_scheduleHydration=function(t){if(t){var e=oA();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Ei.length&&e!==0&&e<Ei[n].priority;n++);Ei.splice(n,0,t),n===0&&lA(t)}};function Z_(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function hf(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function CE(){}function UV(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var u=vh(o);s.call(u)}}var o=Rx(e,r,t,0,null,!1,!1,"",CE);return t._reactRootContainer=o,t[Kr]=o.current,vu(t.nodeType===8?t.parentNode:t),eo(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var u=vh(l);a.call(u)}}var l=Q_(t,0,!1,null,null,!1,!1,"",CE);return t._reactRootContainer=l,t[Kr]=l.current,vu(t.nodeType===8?t.parentNode:t),eo(function(){cf(e,l,n,r)}),l}function ff(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=vh(o);a.call(l)}}cf(e,o,t,i)}else o=UV(n,e,t,i,r);return vh(o)}iA=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=xl(e.pendingLanes);n!==0&&(y_(e,n|1),gn(e,vt()),!(Be&6)&&(Ca=vt()+500,ts()))}break;case 13:eo(function(){var r=jr(t,1);if(r!==null){var i=an();ir(r,t,1,i)}}),Y_(t,1)}};v_=function(t){if(t.tag===13){var e=jr(t,134217728);if(e!==null){var n=an();ir(e,t,134217728,n)}Y_(t,134217728)}};sA=function(t){if(t.tag===13){var e=Oi(t),n=jr(t,e);if(n!==null){var r=an();ir(n,t,e,r)}Y_(t,e)}};oA=function(){return Ye};aA=function(t,e){var n=Ye;try{return Ye=t,e()}finally{Ye=n}};fm=function(t,e,n){switch(e){case"input":if(om(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=nf(r);if(!i)throw Error(ee(90));U0(r),om(r,i)}}}break;case"textarea":B0(t,n);break;case"select":e=n.value,e!=null&&jo(t,!!n.multiple,e,!1)}};K0=W_;j0=eo;var OV={usingClientEntryPoint:!1,Events:[Xu,Lo,nf,H0,W0,W_]},yl={findFiberByHostInstance:Ds,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},BV={bundleType:yl.bundleType,version:yl.version,rendererPackageName:yl.rendererPackageName,rendererConfig:yl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Zr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Y0(t),t===null?null:t.stateNode},findFiberByHostInstance:yl.findFiberByHostInstance||FV,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Wc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Wc.isDisabled&&Wc.supportsFiber)try{Xh=Wc.inject(BV),Tr=Wc}catch{}}Pn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=OV;Pn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Z_(e))throw Error(ee(200));return LV(t,e,null,n)};Pn.createRoot=function(t,e){if(!Z_(t))throw Error(ee(299));var n=!1,r="",i=Px;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Q_(t,1,!1,null,null,n,!1,r,i),t[Kr]=e.current,vu(t.nodeType===8?t.parentNode:t),new X_(e)};Pn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ee(188)):(t=Object.keys(t).join(","),Error(ee(268,t)));return t=Y0(e),t=t===null?null:t.stateNode,t};Pn.flushSync=function(t){return eo(t)};Pn.hydrate=function(t,e,n){if(!hf(e))throw Error(ee(200));return ff(null,t,e,!0,n)};Pn.hydrateRoot=function(t,e,n){if(!Z_(t))throw Error(ee(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=Px;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=Rx(e,null,t,1,n??null,i,!1,s,o),t[Kr]=e.current,vu(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new df(e)};Pn.render=function(t,e,n){if(!hf(e))throw Error(ee(200));return ff(null,t,e,!1,n)};Pn.unmountComponentAtNode=function(t){if(!hf(t))throw Error(ee(40));return t._reactRootContainer?(eo(function(){ff(null,null,t,!1,function(){t._reactRootContainer=null,t[Kr]=null})}),!0):!1};Pn.unstable_batchedUpdates=W_;Pn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!hf(n))throw Error(ee(200));if(t==null||t._reactInternals===void 0)throw Error(ee(38));return ff(t,e,n,!1,r)};Pn.version="18.3.1-next-f1338f8080-20240426";function kx(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(kx)}catch(t){console.error(t)}}kx(),k0.exports=Pn;var qV=k0.exports,AE=qV;Zp.createRoot=AE.createRoot,Zp.hydrateRoot=AE.hydrateRoot;/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let GV,$V;function zV(){return{geminiUrl:GV,vertexUrl:$V}}function HV(t,e,n,r){var i,s;if(!(t!=null&&t.baseUrl)){const o=zV();return e?(i=o.vertexUrl)!==null&&i!==void 0?i:n:(s=o.geminiUrl)!==null&&s!==void 0?s:r}return t.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class oo{}function de(t,e){const n=/\{([^}]+)\}/g;return t.replace(n,(r,i)=>{if(Object.prototype.hasOwnProperty.call(e,i)){const s=e[i];return s!=null?String(s):""}else throw new Error(`Key '${i}' not found in valueMap.`)})}function h(t,e,n){for(let s=0;s<e.length-1;s++){const o=e[s];if(o.endsWith("[]")){const a=o.slice(0,-2);if(!(a in t))if(Array.isArray(n))t[a]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${o}`);if(Array.isArray(t[a])){const l=t[a];if(Array.isArray(n))for(let u=0;u<l.length;u++){const f=l[u];h(f,e.slice(s+1),n[u])}else for(const u of l)h(u,e.slice(s+1),n)}return}else if(o.endsWith("[0]")){const a=o.slice(0,-3);a in t||(t[a]=[{}]);const l=t[a];h(l[0],e.slice(s+1),n);return}(!t[o]||typeof t[o]!="object")&&(t[o]={}),t=t[o]}const r=e[e.length-1],i=t[r];if(i!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===i)return;if(typeof i=="object"&&typeof n=="object"&&i!==null&&n!==null)Object.assign(i,n);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else r==="_self"&&typeof n=="object"&&n!==null&&!Array.isArray(n)?Object.assign(t,n):t[r]=n}function c(t,e,n=void 0){try{if(e.length===1&&e[0]==="_self")return t;for(let r=0;r<e.length;r++){if(typeof t!="object"||t===null)return n;const i=e[r];if(i.endsWith("[]")){const s=i.slice(0,-2);if(s in t){const o=t[s];return Array.isArray(o)?o.map(a=>c(a,e.slice(r+1),n)):n}else return n}else t=t[i]}return t}catch(r){if(r instanceof TypeError)return n;throw r}}function WV(t,e){for(const[n,r]of Object.entries(e)){const i=n.split("."),s=r.split("."),o=new Set;let a=-1;for(let l=0;l<i.length;l++)if(i[l]==="*"){a=l;break}if(a!==-1&&s.length>a)for(let l=a;l<s.length;l++){const u=s[l];u!=="*"&&!u.endsWith("[]")&&!u.endsWith("[0]")&&o.add(u)}Wm(t,i,s,0,o)}}function Wm(t,e,n,r,i){if(r>=e.length||typeof t!="object"||t===null)return;const s=e[r];if(s.endsWith("[]")){const o=s.slice(0,-2),a=t;if(o in a&&Array.isArray(a[o]))for(const l of a[o])Wm(l,e,n,r+1,i)}else if(s==="*"){if(typeof t=="object"&&t!==null&&!Array.isArray(t)){const o=t,a=Object.keys(o).filter(u=>!u.startsWith("_")&&!i.has(u)),l={};for(const u of a)l[u]=o[u];for(const[u,f]of Object.entries(l)){const m=[];for(const g of n.slice(r))g==="*"?m.push(u):m.push(g);h(o,m,f)}for(const u of a)delete o[u]}}else{const o=t;s in o&&Wm(o[s],e,n,r+1,i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ey(t){if(typeof t!="string")throw new Error("fromImageBytes must be a string");return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function KV(t){const e={},n=c(t,["operationName"]);n!=null&&h(e,["operationName"],n);const r=c(t,["resourceName"]);return r!=null&&h(e,["_url","resourceName"],r),e}function jV(t){const e={},n=c(t,["name"]);n!=null&&h(e,["name"],n);const r=c(t,["metadata"]);r!=null&&h(e,["metadata"],r);const i=c(t,["done"]);i!=null&&h(e,["done"],i);const s=c(t,["error"]);s!=null&&h(e,["error"],s);const o=c(t,["response","generateVideoResponse"]);return o!=null&&h(e,["response"],QV(o)),e}function JV(t){const e={},n=c(t,["name"]);n!=null&&h(e,["name"],n);const r=c(t,["metadata"]);r!=null&&h(e,["metadata"],r);const i=c(t,["done"]);i!=null&&h(e,["done"],i);const s=c(t,["error"]);s!=null&&h(e,["error"],s);const o=c(t,["response"]);return o!=null&&h(e,["response"],YV(o)),e}function QV(t){const e={},n=c(t,["generatedSamples"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>XV(o))),h(e,["generatedVideos"],s)}const r=c(t,["raiMediaFilteredCount"]);r!=null&&h(e,["raiMediaFilteredCount"],r);const i=c(t,["raiMediaFilteredReasons"]);return i!=null&&h(e,["raiMediaFilteredReasons"],i),e}function YV(t){const e={},n=c(t,["videos"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>ZV(o))),h(e,["generatedVideos"],s)}const r=c(t,["raiMediaFilteredCount"]);r!=null&&h(e,["raiMediaFilteredCount"],r);const i=c(t,["raiMediaFilteredReasons"]);return i!=null&&h(e,["raiMediaFilteredReasons"],i),e}function XV(t){const e={},n=c(t,["video"]);return n!=null&&h(e,["video"],nL(n)),e}function ZV(t){const e={},n=c(t,["_self"]);return n!=null&&h(e,["video"],rL(n)),e}function eL(t){const e={},n=c(t,["operationName"]);return n!=null&&h(e,["_url","operationName"],n),e}function tL(t){const e={},n=c(t,["operationName"]);return n!=null&&h(e,["_url","operationName"],n),e}function nL(t){const e={},n=c(t,["uri"]);n!=null&&h(e,["uri"],n);const r=c(t,["encodedVideo"]);r!=null&&h(e,["videoBytes"],ey(r));const i=c(t,["encoding"]);return i!=null&&h(e,["mimeType"],i),e}function rL(t){const e={},n=c(t,["gcsUri"]);n!=null&&h(e,["uri"],n);const r=c(t,["bytesBase64Encoded"]);r!=null&&h(e,["videoBytes"],ey(r));const i=c(t,["mimeType"]);return i!=null&&h(e,["mimeType"],i),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var xE;(function(t){t.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",t.OUTCOME_OK="OUTCOME_OK",t.OUTCOME_FAILED="OUTCOME_FAILED",t.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(xE||(xE={}));var RE;(function(t){t.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",t.PYTHON="PYTHON"})(RE||(RE={}));var Bn;(function(t){t.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",t.STRING="STRING",t.NUMBER="NUMBER",t.INTEGER="INTEGER",t.BOOLEAN="BOOLEAN",t.ARRAY="ARRAY",t.OBJECT="OBJECT",t.NULL="NULL"})(Bn||(Bn={}));var PE;(function(t){t.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",t.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",t.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",t.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",t.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",t.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",t.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",t.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",t.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT"})(PE||(PE={}));var kE;(function(t){t.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",t.SEVERITY="SEVERITY",t.PROBABILITY="PROBABILITY"})(kE||(kE={}));var NE;(function(t){t.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE",t.OFF="OFF"})(NE||(NE={}));var DE;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(DE||(DE={}));var bE;(function(t){t.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",t.NO_AUTH="NO_AUTH",t.API_KEY_AUTH="API_KEY_AUTH",t.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",t.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",t.OAUTH="OAUTH",t.OIDC_AUTH="OIDC_AUTH"})(bE||(bE={}));var ME;(function(t){t.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",t.SIMPLE_SEARCH="SIMPLE_SEARCH",t.ELASTIC_SEARCH="ELASTIC_SEARCH"})(ME||(ME={}));var VE;(function(t){t.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",t.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",t.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",t.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",t.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(VE||(VE={}));var LE;(function(t){t.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.LANGUAGE="LANGUAGE",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.SPII="SPII",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.IMAGE_SAFETY="IMAGE_SAFETY",t.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",t.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",t.NO_IMAGE="NO_IMAGE"})(LE||(LE={}));var FE;(function(t){t.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",t.NEGLIGIBLE="NEGLIGIBLE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH"})(FE||(FE={}));var UE;(function(t){t.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",t.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",t.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",t.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",t.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(UE||(UE={}));var OE;(function(t){t.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",t.SAFETY="SAFETY",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.IMAGE_SAFETY="IMAGE_SAFETY"})(OE||(OE={}));var BE;(function(t){t.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",t.ON_DEMAND="ON_DEMAND",t.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(BE||(BE={}));var Th;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.AUDIO="AUDIO"})(Th||(Th={}));var qE;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(qE||(qE={}));var Km;(function(t){t.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",t.JOB_STATE_QUEUED="JOB_STATE_QUEUED",t.JOB_STATE_PENDING="JOB_STATE_PENDING",t.JOB_STATE_RUNNING="JOB_STATE_RUNNING",t.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",t.JOB_STATE_FAILED="JOB_STATE_FAILED",t.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",t.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",t.JOB_STATE_PAUSED="JOB_STATE_PAUSED",t.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",t.JOB_STATE_UPDATING="JOB_STATE_UPDATING",t.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Km||(Km={}));var GE;(function(t){t.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",t.TUNING_MODE_FULL="TUNING_MODE_FULL",t.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(GE||(GE={}));var $E;(function(t){t.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",t.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",t.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",t.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",t.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",t.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",t.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})($E||($E={}));var zE;(function(t){t.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",t.TUNING_TASK_I2V="TUNING_TASK_I2V",t.TUNING_TASK_T2V="TUNING_TASK_T2V"})(zE||(zE={}));var HE;(function(t){t.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",t.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",t.BALANCED="BALANCED",t.PRIORITIZE_COST="PRIORITIZE_COST"})(HE||(HE={}));var WE;(function(t){t.UNSPECIFIED="UNSPECIFIED",t.BLOCKING="BLOCKING",t.NON_BLOCKING="NON_BLOCKING"})(WE||(WE={}));var KE;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(KE||(KE={}));var jE;(function(t){t.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",t.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(jE||(jE={}));var JE;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.AUTO="AUTO",t.ANY="ANY",t.NONE="NONE",t.VALIDATED="VALIDATED"})(JE||(JE={}));var QE;(function(t){t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE"})(QE||(QE={}));var YE;(function(t){t.DONT_ALLOW="DONT_ALLOW",t.ALLOW_ADULT="ALLOW_ADULT",t.ALLOW_ALL="ALLOW_ALL"})(YE||(YE={}));var XE;(function(t){t.auto="auto",t.en="en",t.ja="ja",t.ko="ko",t.hi="hi",t.zh="zh",t.pt="pt",t.es="es"})(XE||(XE={}));var ZE;(function(t){t.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",t.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",t.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",t.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",t.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(ZE||(ZE={}));var ew;(function(t){t.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",t.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",t.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",t.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(ew||(ew={}));var tw;(function(t){t.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",t.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",t.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",t.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(tw||(tw={}));var nw;(function(t){t.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",t.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",t.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",t.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",t.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",t.EDIT_MODE_STYLE="EDIT_MODE_STYLE",t.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",t.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(nw||(nw={}));var rw;(function(t){t.FOREGROUND="FOREGROUND",t.BACKGROUND="BACKGROUND",t.PROMPT="PROMPT",t.SEMANTIC="SEMANTIC",t.INTERACTIVE="INTERACTIVE"})(rw||(rw={}));var iw;(function(t){t.ASSET="ASSET",t.STYLE="STYLE"})(iw||(iw={}));var sw;(function(t){t.INSERT="INSERT",t.REMOVE="REMOVE",t.REMOVE_STATIC="REMOVE_STATIC",t.OUTPAINT="OUTPAINT"})(sw||(sw={}));var ow;(function(t){t.OPTIMIZED="OPTIMIZED",t.LOSSLESS="LOSSLESS"})(ow||(ow={}));var aw;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.PROCESSING="PROCESSING",t.ACTIVE="ACTIVE",t.FAILED="FAILED"})(aw||(aw={}));var lw;(function(t){t.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",t.UPLOADED="UPLOADED",t.GENERATED="GENERATED"})(lw||(lw={}));var uw;(function(t){t.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.RESPONSE_REJECTED="RESPONSE_REJECTED",t.NEED_MORE_INPUT="NEED_MORE_INPUT"})(uw||(uw={}));var cw;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.VIDEO="VIDEO",t.AUDIO="AUDIO",t.DOCUMENT="DOCUMENT"})(cw||(cw={}));var dw;(function(t){t.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",t.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",t.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(dw||(dw={}));var hw;(function(t){t.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",t.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",t.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(hw||(hw={}));var fw;(function(t){t.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",t.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",t.NO_INTERRUPTION="NO_INTERRUPTION"})(fw||(fw={}));var pw;(function(t){t.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",t.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",t.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(pw||(pw={}));var mw;(function(t){t.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",t.SILENT="SILENT",t.WHEN_IDLE="WHEN_IDLE",t.INTERRUPT="INTERRUPT"})(mw||(mw={}));var gw;(function(t){t.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",t.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",t.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",t.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",t.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",t.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",t.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",t.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",t.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",t.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",t.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",t.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",t.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(gw||(gw={}));var _w;(function(t){t.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",t.QUALITY="QUALITY",t.DIVERSITY="DIVERSITY",t.VOCALIZATION="VOCALIZATION"})(_w||(_w={}));var $o;(function(t){t.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",t.PLAY="PLAY",t.PAUSE="PAUSE",t.STOP="STOP",t.RESET_CONTEXT="RESET_CONTEXT"})($o||($o={}));class jm{constructor(e){const n={};for(const r of e.headers.entries())n[r[0]]=r[1];this.headers=n,this.responseInternal=e}json(){return this.responseInternal.json()}}class vl{get text(){var e,n,r,i,s,o,a,l;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let u="",f=!1;const m=[];for(const g of(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)!==null&&l!==void 0?l:[]){for(const[v,T]of Object.entries(g))v!=="text"&&v!=="thought"&&(T!==null||T!==void 0)&&m.push(v);if(typeof g.text=="string"){if(typeof g.thought=="boolean"&&g.thought)continue;f=!0,u+=g.text}}return m.length>0&&console.warn(`there are non-text parts ${m} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),f?u:void 0}get data(){var e,n,r,i,s,o,a,l;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let u="";const f=[];for(const m of(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)!==null&&l!==void 0?l:[]){for(const[g,v]of Object.entries(m))g!=="inlineData"&&(v!==null||v!==void 0)&&f.push(g);m.inlineData&&typeof m.inlineData.data=="string"&&(u+=atob(m.inlineData.data))}return f.length>0&&console.warn(`there are non-data parts ${f} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),u.length>0?btoa(u):void 0}get functionCalls(){var e,n,r,i,s,o,a,l;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const u=(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(f=>f.functionCall).map(f=>f.functionCall).filter(f=>f!==void 0);if((u==null?void 0:u.length)!==0)return u}get executableCode(){var e,n,r,i,s,o,a,l,u;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const f=(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(m=>m.executableCode).map(m=>m.executableCode).filter(m=>m!==void 0);if((f==null?void 0:f.length)!==0)return(u=f==null?void 0:f[0])===null||u===void 0?void 0:u.code}get codeExecutionResult(){var e,n,r,i,s,o,a,l,u;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const f=(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(m=>m.codeExecutionResult).map(m=>m.codeExecutionResult).filter(m=>m!==void 0);if((f==null?void 0:f.length)!==0)return(u=f==null?void 0:f[0])===null||u===void 0?void 0:u.output}}class yw{}class vw{}class iL{}class sL{}class oL{}class aL{}class Tw{}class Ew{}class ww{}class lL{}class Eh{_fromAPIResponse({apiResponse:e,isVertexAI:n}){const r=new Eh;let i;const s=e;return n?i=JV(s):i=jV(s),Object.assign(r,i),r}}class Iw{}class Sw{}class Cw{}class uL{}class cL{}class dL{}class Aw{}class hL{get text(){var e,n,r;let i="",s=!1;const o=[];for(const a of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[l,u]of Object.entries(a))l!=="text"&&l!=="thought"&&u!==null&&o.push(l);if(typeof a.text=="string"){if(typeof a.thought=="boolean"&&a.thought)continue;s=!0,i+=a.text}}return o.length>0&&console.warn(`there are non-text parts ${o} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),s?i:void 0}get data(){var e,n,r;let i="";const s=[];for(const o of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[a,l]of Object.entries(o))a!=="inlineData"&&l!==null&&s.push(a);o.inlineData&&typeof o.inlineData.data=="string"&&(i+=atob(o.inlineData.data))}return s.length>0&&console.warn(`there are non-data parts ${s} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),i.length>0?btoa(i):void 0}}class fL{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ge(t,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(t.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const n=e.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function Nx(t,e){const n=Ge(t,e);return n?n.startsWith("publishers/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}`:n.startsWith("models/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/publishers/google/${n}`:n:""}function Dx(t){return Array.isArray(t)?t.map(e=>wh(e)):[wh(t)]}function wh(t){if(typeof t=="object"&&t!==null)return t;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof t}`)}function bx(t){const e=wh(t);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function Mx(t){const e=wh(t);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function xw(t){if(t==null)throw new Error("PartUnion is required");if(typeof t=="object")return t;if(typeof t=="string")return{text:t};throw new Error(`Unsupported part type: ${typeof t}`)}function Vx(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("PartListUnion is required");return Array.isArray(t)?t.map(e=>xw(e)):[xw(t)]}function Jm(t){return t!=null&&typeof t=="object"&&"parts"in t&&Array.isArray(t.parts)}function Rw(t){return t!=null&&typeof t=="object"&&"functionCall"in t}function Pw(t){return t!=null&&typeof t=="object"&&"functionResponse"in t}function Yt(t){if(t==null)throw new Error("ContentUnion is required");return Jm(t)?t:{role:"user",parts:Vx(t)}}function ty(t,e){if(!e)return[];if(t.isVertexAI()&&Array.isArray(e))return e.flatMap(n=>{const r=Yt(n);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(t.isVertexAI()){const n=Yt(e);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(e)?e.map(n=>Yt(n)):[Yt(e)]}function $n(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("contents are required");if(!Array.isArray(t)){if(Rw(t)||Pw(t))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Yt(t)]}const e=[],n=[],r=Jm(t[0]);for(const i of t){const s=Jm(i);if(s!=r)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(s)e.push(i);else{if(Rw(i)||Pw(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(i)}}return r||e.push({role:"user",parts:Vx(n)}),e}function pL(t,e){t.includes("null")&&(e.nullable=!0);const n=t.filter(r=>r!=="null");if(n.length===1)e.type=Object.values(Bn).includes(n[0].toUpperCase())?n[0].toUpperCase():Bn.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const r of n)e.anyOf.push({type:Object.values(Bn).includes(r.toUpperCase())?r.toUpperCase():Bn.TYPE_UNSPECIFIED})}}function ea(t){const e={},n=["items"],r=["anyOf"],i=["properties"];if(t.type&&t.anyOf)throw new Error("type and anyOf cannot be both populated.");const s=t.anyOf;s!=null&&s.length==2&&(s[0].type==="null"?(e.nullable=!0,t=s[1]):s[1].type==="null"&&(e.nullable=!0,t=s[0])),t.type instanceof Array&&pL(t.type,e);for(const[o,a]of Object.entries(t))if(a!=null)if(o=="type"){if(a==="null")throw new Error("type: null can not be the only possible type for the field.");if(a instanceof Array)continue;e.type=Object.values(Bn).includes(a.toUpperCase())?a.toUpperCase():Bn.TYPE_UNSPECIFIED}else if(n.includes(o))e[o]=ea(a);else if(r.includes(o)){const l=[];for(const u of a){if(u.type=="null"){e.nullable=!0;continue}l.push(ea(u))}e[o]=l}else if(i.includes(o)){const l={};for(const[u,f]of Object.entries(a))l[u]=ea(f);e[o]=l}else{if(o==="additionalProperties")continue;e[o]=a}return e}function ny(t){return ea(t)}function ry(t){if(typeof t=="object")return t;if(typeof t=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:t}}};throw new Error(`Unsupported speechConfig type: ${typeof t}`)}function iy(t){if("multiSpeakerVoiceConfig"in t)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return t}function Va(t){if(t.functionDeclarations)for(const e of t.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=ea(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=ea(e.response));return t}function La(t){if(t==null)throw new Error("tools is required");if(!Array.isArray(t))throw new Error("tools is required and must be an array of Tools");const e=[];for(const n of t)e.push(n);return e}function mL(t,e,n,r=1){const i=!e.startsWith(`${n}/`)&&e.split("/").length===r;return t.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${t.getProject()}/${e}`:e.startsWith(`${n}/`)?`projects/${t.getProject()}/locations/${t.getLocation()}/${e}`:i?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}/${e}`:e:i?`${n}/${e}`:e}function ei(t,e){if(typeof e!="string")throw new Error("name must be a string");return mL(t,e,"cachedContents")}function Lx(t){switch(t){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return t}}function ns(t){return ey(t)}function gL(t){return t!=null&&typeof t=="object"&&"name"in t}function _L(t){return t!=null&&typeof t=="object"&&"video"in t}function yL(t){return t!=null&&typeof t=="object"&&"uri"in t}function Fx(t){var e;let n;if(gL(t)&&(n=t.name),!(yL(t)&&(n=t.uri,n===void 0))&&!(_L(t)&&(n=(e=t.video)===null||e===void 0?void 0:e.uri,n===void 0))){if(typeof t=="string"&&(n=t),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const i=n.split("files/")[1].match(/[a-z0-9]+/);if(i===null)throw new Error(`Could not extract file name from URI ${n}`);n=i[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function Ux(t,e){let n;return t.isVertexAI()?n=e?"publishers/google/models":"models":n=e?"models":"tunedModels",n}function Ox(t){for(const e of["models","tunedModels","publisherModels"])if(vL(t,e))return t[e];return[]}function vL(t,e){return t!==null&&typeof t=="object"&&e in t}function TL(t,e={}){const n=t,r={name:n.name,description:n.description,parametersJsonSchema:n.inputSchema};return n.outputSchema&&(r.responseJsonSchema=n.outputSchema),e.behavior&&(r.behavior=e.behavior),{functionDeclarations:[r]}}function EL(t,e={}){const n=[],r=new Set;for(const i of t){const s=i.name;if(r.has(s))throw new Error(`Duplicate function name ${s} found in MCP tools. Please ensure function names are unique.`);r.add(s);const o=TL(i,e);o.functionDeclarations&&n.push(...o.functionDeclarations)}return{functionDeclarations:n}}function Bx(t,e){let n;if(typeof e=="string")if(t.isVertexAI())if(e.startsWith("gs://"))n={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))n={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))n={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(t.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");n={inlinedRequests:e}}else n=e;const r=[n.gcsUri,n.bigqueryUri].filter(Boolean).length,i=[n.inlinedRequests,n.fileName].filter(Boolean).length;if(t.isVertexAI()){if(i>0||r!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(r>0||i!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return n}function wL(t){if(typeof t!="string")return t;const e=t;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function qx(t){if(typeof t!="object"||t===null)return{};const e=t,n=e.inlinedResponses;if(typeof n!="object"||n===null)return t;const i=n.inlinedResponses;if(!Array.isArray(i)||i.length===0)return t;let s=!1;for(const o of i){if(typeof o!="object"||o===null)continue;const l=o.response;if(typeof l!="object"||l===null)continue;if(l.embedding!==void 0){s=!0;break}}return s&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),t}function Fa(t,e){const n=e;if(!t.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error(`Invalid batch job name: ${n}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error(`Invalid batch job name: ${n}.`)}function Gx(t){const e=t;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function IL(t){const e={},n=c(t,["responsesFile"]);n!=null&&h(e,["fileName"],n);const r=c(t,["inlinedResponses","inlinedResponses"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>eF(o))),h(e,["inlinedResponses"],s)}const i=c(t,["inlinedEmbedContentResponses","inlinedResponses"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),h(e,["inlinedEmbedContentResponses"],s)}return e}function SL(t){const e={},n=c(t,["predictionsFormat"]);n!=null&&h(e,["format"],n);const r=c(t,["gcsDestination","outputUriPrefix"]);r!=null&&h(e,["gcsUri"],r);const i=c(t,["bigqueryDestination","outputUri"]);return i!=null&&h(e,["bigqueryUri"],i),e}function CL(t){const e={},n=c(t,["format"]);n!=null&&h(e,["predictionsFormat"],n);const r=c(t,["gcsUri"]);r!=null&&h(e,["gcsDestination","outputUriPrefix"],r);const i=c(t,["bigqueryUri"]);if(i!=null&&h(e,["bigqueryDestination","outputUri"],i),c(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(c(t,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(c(t,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function wd(t){const e={},n=c(t,["name"]);n!=null&&h(e,["name"],n);const r=c(t,["metadata","displayName"]);r!=null&&h(e,["displayName"],r);const i=c(t,["metadata","state"]);i!=null&&h(e,["state"],Gx(i));const s=c(t,["metadata","createTime"]);s!=null&&h(e,["createTime"],s);const o=c(t,["metadata","endTime"]);o!=null&&h(e,["endTime"],o);const a=c(t,["metadata","updateTime"]);a!=null&&h(e,["updateTime"],a);const l=c(t,["metadata","model"]);l!=null&&h(e,["model"],l);const u=c(t,["metadata","output"]);return u!=null&&h(e,["dest"],IL(qx(u))),e}function Qm(t){const e={},n=c(t,["name"]);n!=null&&h(e,["name"],n);const r=c(t,["displayName"]);r!=null&&h(e,["displayName"],r);const i=c(t,["state"]);i!=null&&h(e,["state"],Gx(i));const s=c(t,["error"]);s!=null&&h(e,["error"],s);const o=c(t,["createTime"]);o!=null&&h(e,["createTime"],o);const a=c(t,["startTime"]);a!=null&&h(e,["startTime"],a);const l=c(t,["endTime"]);l!=null&&h(e,["endTime"],l);const u=c(t,["updateTime"]);u!=null&&h(e,["updateTime"],u);const f=c(t,["model"]);f!=null&&h(e,["model"],f);const m=c(t,["inputConfig"]);m!=null&&h(e,["src"],AL(m));const g=c(t,["outputConfig"]);return g!=null&&h(e,["dest"],SL(qx(g))),e}function AL(t){const e={},n=c(t,["instancesFormat"]);n!=null&&h(e,["format"],n);const r=c(t,["gcsSource","uris"]);r!=null&&h(e,["gcsUri"],r);const i=c(t,["bigquerySource","inputUri"]);return i!=null&&h(e,["bigqueryUri"],i),e}function xL(t,e){const n={};if(c(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(c(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(c(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const r=c(e,["fileName"]);r!=null&&h(n,["fileName"],r);const i=c(e,["inlinedRequests"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>ZL(t,o))),h(n,["requests","requests"],s)}return n}function RL(t){const e={},n=c(t,["format"]);n!=null&&h(e,["instancesFormat"],n);const r=c(t,["gcsUri"]);r!=null&&h(e,["gcsSource","uris"],r);const i=c(t,["bigqueryUri"]);if(i!=null&&h(e,["bigquerySource","inputUri"],i),c(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(c(t,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function PL(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["data"]);n!=null&&h(e,["data"],n);const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function kL(t,e){const n={},r=c(e,["name"]);return r!=null&&h(n,["_url","name"],Fa(t,r)),n}function NL(t,e){const n={},r=c(e,["name"]);return r!=null&&h(n,["_url","name"],Fa(t,r)),n}function DL(t){const e={},n=c(t,["content"]);n!=null&&h(e,["content"],n);const r=c(t,["citationMetadata"]);r!=null&&h(e,["citationMetadata"],bL(r));const i=c(t,["tokenCount"]);i!=null&&h(e,["tokenCount"],i);const s=c(t,["finishReason"]);s!=null&&h(e,["finishReason"],s);const o=c(t,["urlContextMetadata"]);o!=null&&h(e,["urlContextMetadata"],o);const a=c(t,["avgLogprobs"]);a!=null&&h(e,["avgLogprobs"],a);const l=c(t,["groundingMetadata"]);l!=null&&h(e,["groundingMetadata"],l);const u=c(t,["index"]);u!=null&&h(e,["index"],u);const f=c(t,["logprobsResult"]);f!=null&&h(e,["logprobsResult"],f);const m=c(t,["safetyRatings"]);if(m!=null){let g=m;Array.isArray(g)&&(g=g.map(v=>v)),h(e,["safetyRatings"],g)}return e}function bL(t){const e={},n=c(t,["citationSources"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>i)),h(e,["citations"],r)}return e}function $x(t){const e={},n=c(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>aF(s))),h(e,["parts"],i)}const r=c(t,["role"]);return r!=null&&h(e,["role"],r),e}function ML(t,e){const n={},r=c(t,["displayName"]);if(e!==void 0&&r!=null&&h(e,["batch","displayName"],r),c(t,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return n}function VL(t,e){const n={},r=c(t,["displayName"]);e!==void 0&&r!=null&&h(e,["displayName"],r);const i=c(t,["dest"]);return e!==void 0&&i!=null&&h(e,["outputConfig"],CL(wL(i))),n}function kw(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],Ge(t,r));const i=c(e,["src"]);i!=null&&h(n,["batch","inputConfig"],xL(t,Bx(t,i)));const s=c(e,["config"]);return s!=null&&ML(s,n),n}function LL(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["model"],Ge(t,r));const i=c(e,["src"]);i!=null&&h(n,["inputConfig"],RL(Bx(t,i)));const s=c(e,["config"]);return s!=null&&VL(s,n),n}function FL(t,e){const n={},r=c(t,["displayName"]);return e!==void 0&&r!=null&&h(e,["batch","displayName"],r),n}function UL(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],Ge(t,r));const i=c(e,["src"]);i!=null&&h(n,["batch","inputConfig"],HL(t,i));const s=c(e,["config"]);return s!=null&&FL(s,n),n}function OL(t,e){const n={},r=c(e,["name"]);return r!=null&&h(n,["_url","name"],Fa(t,r)),n}function BL(t,e){const n={},r=c(e,["name"]);return r!=null&&h(n,["_url","name"],Fa(t,r)),n}function qL(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["name"]);r!=null&&h(e,["name"],r);const i=c(t,["done"]);i!=null&&h(e,["done"],i);const s=c(t,["error"]);return s!=null&&h(e,["error"],s),e}function GL(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["name"]);r!=null&&h(e,["name"],r);const i=c(t,["done"]);i!=null&&h(e,["done"],i);const s=c(t,["error"]);return s!=null&&h(e,["error"],s),e}function $L(t,e){const n={},r=c(e,["contents"]);if(r!=null){let s=ty(t,r);Array.isArray(s)&&(s=s.map(o=>o)),h(n,["requests[]","request","content"],s)}const i=c(e,["config"]);return i!=null&&(h(n,["_self"],zL(i,n)),WV(n,{"requests[].*":"requests[].request.*"})),n}function zL(t,e){const n={},r=c(t,["taskType"]);e!==void 0&&r!=null&&h(e,["requests[]","taskType"],r);const i=c(t,["title"]);e!==void 0&&i!=null&&h(e,["requests[]","title"],i);const s=c(t,["outputDimensionality"]);if(e!==void 0&&s!=null&&h(e,["requests[]","outputDimensionality"],s),c(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(c(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function HL(t,e){const n={},r=c(e,["fileName"]);r!=null&&h(n,["file_name"],r);const i=c(e,["inlinedRequests"]);return i!=null&&h(n,["requests"],$L(t,i)),n}function WL(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["fileUri"]);n!=null&&h(e,["fileUri"],n);const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function KL(t,e,n){const r={},i=c(e,["systemInstruction"]);n!==void 0&&i!=null&&h(n,["systemInstruction"],$x(Yt(i)));const s=c(e,["temperature"]);s!=null&&h(r,["temperature"],s);const o=c(e,["topP"]);o!=null&&h(r,["topP"],o);const a=c(e,["topK"]);a!=null&&h(r,["topK"],a);const l=c(e,["candidateCount"]);l!=null&&h(r,["candidateCount"],l);const u=c(e,["maxOutputTokens"]);u!=null&&h(r,["maxOutputTokens"],u);const f=c(e,["stopSequences"]);f!=null&&h(r,["stopSequences"],f);const m=c(e,["responseLogprobs"]);m!=null&&h(r,["responseLogprobs"],m);const g=c(e,["logprobs"]);g!=null&&h(r,["logprobs"],g);const v=c(e,["presencePenalty"]);v!=null&&h(r,["presencePenalty"],v);const T=c(e,["frequencyPenalty"]);T!=null&&h(r,["frequencyPenalty"],T);const x=c(e,["seed"]);x!=null&&h(r,["seed"],x);const D=c(e,["responseMimeType"]);D!=null&&h(r,["responseMimeType"],D);const C=c(e,["responseSchema"]);C!=null&&h(r,["responseSchema"],ny(C));const w=c(e,["responseJsonSchema"]);if(w!=null&&h(r,["responseJsonSchema"],w),c(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(c(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const P=c(e,["safetySettings"]);if(n!==void 0&&P!=null){let L=P;Array.isArray(L)&&(L=L.map(N=>lF(N))),h(n,["safetySettings"],L)}const V=c(e,["tools"]);if(n!==void 0&&V!=null){let L=La(V);Array.isArray(L)&&(L=L.map(N=>uF(Va(N)))),h(n,["tools"],L)}const O=c(e,["toolConfig"]);if(n!==void 0&&O!=null&&h(n,["toolConfig"],O),c(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const B=c(e,["cachedContent"]);n!==void 0&&B!=null&&h(n,["cachedContent"],ei(t,B));const E=c(e,["responseModalities"]);E!=null&&h(r,["responseModalities"],E);const I=c(e,["mediaResolution"]);I!=null&&h(r,["mediaResolution"],I);const A=c(e,["speechConfig"]);if(A!=null&&h(r,["speechConfig"],ry(A)),c(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const k=c(e,["thinkingConfig"]);k!=null&&h(r,["thinkingConfig"],k);const b=c(e,["imageConfig"]);return b!=null&&h(r,["imageConfig"],b),r}function jL(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["candidates"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(u=>DL(u))),h(e,["candidates"],l)}const i=c(t,["modelVersion"]);i!=null&&h(e,["modelVersion"],i);const s=c(t,["promptFeedback"]);s!=null&&h(e,["promptFeedback"],s);const o=c(t,["responseId"]);o!=null&&h(e,["responseId"],o);const a=c(t,["usageMetadata"]);return a!=null&&h(e,["usageMetadata"],a),e}function JL(t,e){const n={},r=c(e,["name"]);return r!=null&&h(n,["_url","name"],Fa(t,r)),n}function QL(t,e){const n={},r=c(e,["name"]);return r!=null&&h(n,["_url","name"],Fa(t,r)),n}function YL(t){const e={};if(c(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=c(t,["enableWidget"]);return n!=null&&h(e,["enableWidget"],n),e}function XL(t){const e={},n=c(t,["timeRangeFilter"]);if(n!=null&&h(e,["timeRangeFilter"],n),c(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function ZL(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["request","model"],Ge(t,r));const i=c(e,["contents"]);if(i!=null){let a=$n(i);Array.isArray(a)&&(a=a.map(l=>$x(l))),h(n,["request","contents"],a)}const s=c(e,["metadata"]);s!=null&&h(n,["metadata"],s);const o=c(e,["config"]);return o!=null&&h(n,["request","generationConfig"],KL(t,o,c(n,["request"],{}))),n}function eF(t){const e={},n=c(t,["response"]);n!=null&&h(e,["response"],jL(n));const r=c(t,["error"]);return r!=null&&h(e,["error"],r),e}function tF(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&h(e,["_query","pageSize"],r);const i=c(t,["pageToken"]);if(e!==void 0&&i!=null&&h(e,["_query","pageToken"],i),c(t,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return n}function nF(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&h(e,["_query","pageSize"],r);const i=c(t,["pageToken"]);e!==void 0&&i!=null&&h(e,["_query","pageToken"],i);const s=c(t,["filter"]);return e!==void 0&&s!=null&&h(e,["_query","filter"],s),n}function rF(t){const e={},n=c(t,["config"]);return n!=null&&tF(n,e),e}function iF(t){const e={},n=c(t,["config"]);return n!=null&&nF(n,e),e}function sF(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=c(t,["operations"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>wd(o))),h(e,["batchJobs"],s)}return e}function oF(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=c(t,["batchPredictionJobs"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>Qm(o))),h(e,["batchJobs"],s)}return e}function aF(t){const e={},n=c(t,["videoMetadata"]);n!=null&&h(e,["videoMetadata"],n);const r=c(t,["thought"]);r!=null&&h(e,["thought"],r);const i=c(t,["inlineData"]);i!=null&&h(e,["inlineData"],PL(i));const s=c(t,["fileData"]);s!=null&&h(e,["fileData"],WL(s));const o=c(t,["thoughtSignature"]);o!=null&&h(e,["thoughtSignature"],o);const a=c(t,["functionCall"]);a!=null&&h(e,["functionCall"],a);const l=c(t,["codeExecutionResult"]);l!=null&&h(e,["codeExecutionResult"],l);const u=c(t,["executableCode"]);u!=null&&h(e,["executableCode"],u);const f=c(t,["functionResponse"]);f!=null&&h(e,["functionResponse"],f);const m=c(t,["text"]);return m!=null&&h(e,["text"],m),e}function lF(t){const e={};if(c(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=c(t,["category"]);n!=null&&h(e,["category"],n);const r=c(t,["threshold"]);return r!=null&&h(e,["threshold"],r),e}function uF(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(f=>f)),h(e,["functionDeclarations"],u)}if(c(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=c(t,["googleSearch"]);r!=null&&h(e,["googleSearch"],XL(r));const i=c(t,["googleSearchRetrieval"]);if(i!=null&&h(e,["googleSearchRetrieval"],i),c(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=c(t,["googleMaps"]);s!=null&&h(e,["googleMaps"],YL(s));const o=c(t,["urlContext"]);o!=null&&h(e,["urlContext"],o);const a=c(t,["computerUse"]);a!=null&&h(e,["computerUse"],a);const l=c(t,["codeExecution"]);return l!=null&&h(e,["codeExecution"],l),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var to;(function(t){t.PAGED_ITEM_BATCH_JOBS="batchJobs",t.PAGED_ITEM_MODELS="models",t.PAGED_ITEM_TUNING_JOBS="tuningJobs",t.PAGED_ITEM_FILES="files",t.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(to||(to={}));class ec{constructor(e,n,r,i){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(e,r,i)}init(e,n,r){var i,s;this.nameInternal=e,this.pageInternal=n[this.nameInternal]||[],this.sdkHttpResponseInternal=n==null?void 0:n.sdkHttpResponse,this.idxInternal=0;let o={config:{}};!r||Object.keys(r).length===0?o={config:{}}:typeof r=="object"?o=Object.assign({},r):o=r,o.config&&(o.config.pageToken=n.nextPageToken),this.paramsInternal=o,this.pageInternalSize=(s=(i=o.config)===null||i===void 0?void 0:i.pageSize)!==null&&s!==void 0?s:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class cF extends oo{constructor(e){super(),this.apiClient=e,this.create=async n=>(this.apiClient.isVertexAI()&&(n.config=this.formatDestination(n.src,n.config)),this.createInternal(n)),this.createEmbeddings=async n=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(n)},this.list=async(n={})=>new ec(to.PAGED_ITEM_BATCH_JOBS,r=>this.listInternal(r),await this.listInternal(n),n)}createInlinedGenerateContentRequest(e){const n=kw(this.apiClient,e),r=n._url,i=de("{model}:batchGenerateContent",r),a=n.batch.inputConfig.requests,l=a.requests,u=[];for(const f of l){const m=Object.assign({},f);if(m.systemInstruction){const g=m.systemInstruction;delete m.systemInstruction;const v=m.request;v.systemInstruction=g,m.request=v}u.push(m)}return a.requests=u,delete n.config,delete n._url,delete n._query,{path:i,body:n}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,n){const r=n?Object.assign({},n):{},i=Date.now().toString();if(r.displayName||(r.displayName=`genaiBatchJob_${i}`),r.dest===void 0){const s=this.getGcsUri(e),o=this.getBigqueryUri(e);if(s)s.endsWith(".jsonl")?r.dest=`${s.slice(0,-6)}/dest`:r.dest=`${s}_dest_${i}`;else if(o)r.dest=`${o}_dest_${i}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return r}async createInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=LL(this.apiClient,e);return a=de("batchPredictionJobs",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>Qm(f))}else{const u=kw(this.apiClient,e);return a=de("{model}:batchGenerateContent",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>wd(f))}}async createEmbeddingsInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=UL(this.apiClient,e);return s=de("{model}:asyncBatchEmbedContent",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>wd(l))}}async get(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=QL(this.apiClient,e);return a=de("batchPredictionJobs/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>Qm(f))}else{const u=JL(this.apiClient,e);return a=de("batches/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>wd(f))}}async cancel(e){var n,r,i,s;let o="",a={};if(this.apiClient.isVertexAI()){const l=NL(this.apiClient,e);o=de("batchPredictionJobs/{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}else{const l=kL(this.apiClient,e);o=de("batches/{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal})}}async listInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=iF(e);return a=de("batchPredictionJobs",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=oF(f),g=new Aw;return Object.assign(g,m),g})}else{const u=rF(e);return a=de("batches",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=sF(f),g=new Aw;return Object.assign(g,m),g})}}async delete(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=BL(this.apiClient,e);return a=de("batchPredictionJobs/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>GL(f))}else{const u=OL(this.apiClient,e);return a=de("batches/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>qL(f))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function dF(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["data"]);n!=null&&h(e,["data"],n);const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function Nw(t){const e={},n=c(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>DF(s))),h(e,["parts"],i)}const r=c(t,["role"]);return r!=null&&h(e,["role"],r),e}function hF(t,e){const n={},r=c(t,["ttl"]);e!==void 0&&r!=null&&h(e,["ttl"],r);const i=c(t,["expireTime"]);e!==void 0&&i!=null&&h(e,["expireTime"],i);const s=c(t,["displayName"]);e!==void 0&&s!=null&&h(e,["displayName"],s);const o=c(t,["contents"]);if(e!==void 0&&o!=null){let f=$n(o);Array.isArray(f)&&(f=f.map(m=>Nw(m))),h(e,["contents"],f)}const a=c(t,["systemInstruction"]);e!==void 0&&a!=null&&h(e,["systemInstruction"],Nw(Yt(a)));const l=c(t,["tools"]);if(e!==void 0&&l!=null){let f=l;Array.isArray(f)&&(f=f.map(m=>bF(m))),h(e,["tools"],f)}const u=c(t,["toolConfig"]);if(e!==void 0&&u!=null&&h(e,["toolConfig"],u),c(t,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function fF(t,e){const n={},r=c(t,["ttl"]);e!==void 0&&r!=null&&h(e,["ttl"],r);const i=c(t,["expireTime"]);e!==void 0&&i!=null&&h(e,["expireTime"],i);const s=c(t,["displayName"]);e!==void 0&&s!=null&&h(e,["displayName"],s);const o=c(t,["contents"]);if(e!==void 0&&o!=null){let m=$n(o);Array.isArray(m)&&(m=m.map(g=>g)),h(e,["contents"],m)}const a=c(t,["systemInstruction"]);e!==void 0&&a!=null&&h(e,["systemInstruction"],Yt(a));const l=c(t,["tools"]);if(e!==void 0&&l!=null){let m=l;Array.isArray(m)&&(m=m.map(g=>MF(g))),h(e,["tools"],m)}const u=c(t,["toolConfig"]);e!==void 0&&u!=null&&h(e,["toolConfig"],u);const f=c(t,["kmsKeyName"]);return e!==void 0&&f!=null&&h(e,["encryption_spec","kmsKeyName"],f),n}function pF(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["model"],Nx(t,r));const i=c(e,["config"]);return i!=null&&hF(i,n),n}function mF(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["model"],Nx(t,r));const i=c(e,["config"]);return i!=null&&fF(i,n),n}function gF(t,e){const n={},r=c(e,["name"]);return r!=null&&h(n,["_url","name"],ei(t,r)),n}function _F(t,e){const n={},r=c(e,["name"]);return r!=null&&h(n,["_url","name"],ei(t,r)),n}function yF(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&h(e,["sdkHttpResponse"],n),e}function vF(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&h(e,["sdkHttpResponse"],n),e}function TF(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["fileUri"]);n!=null&&h(e,["fileUri"],n);const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function EF(t){const e={};if(c(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=c(t,["description"]);n!=null&&h(e,["description"],n);const r=c(t,["name"]);r!=null&&h(e,["name"],r);const i=c(t,["parameters"]);i!=null&&h(e,["parameters"],i);const s=c(t,["parametersJsonSchema"]);s!=null&&h(e,["parametersJsonSchema"],s);const o=c(t,["response"]);o!=null&&h(e,["response"],o);const a=c(t,["responseJsonSchema"]);return a!=null&&h(e,["responseJsonSchema"],a),e}function wF(t,e){const n={},r=c(e,["name"]);return r!=null&&h(n,["_url","name"],ei(t,r)),n}function IF(t,e){const n={},r=c(e,["name"]);return r!=null&&h(n,["_url","name"],ei(t,r)),n}function SF(t){const e={};if(c(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=c(t,["enableWidget"]);return n!=null&&h(e,["enableWidget"],n),e}function CF(t){const e={},n=c(t,["timeRangeFilter"]);if(n!=null&&h(e,["timeRangeFilter"],n),c(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function AF(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&h(e,["_query","pageSize"],r);const i=c(t,["pageToken"]);return e!==void 0&&i!=null&&h(e,["_query","pageToken"],i),n}function xF(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&h(e,["_query","pageSize"],r);const i=c(t,["pageToken"]);return e!==void 0&&i!=null&&h(e,["_query","pageToken"],i),n}function RF(t){const e={},n=c(t,["config"]);return n!=null&&AF(n,e),e}function PF(t){const e={},n=c(t,["config"]);return n!=null&&xF(n,e),e}function kF(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=c(t,["cachedContents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),h(e,["cachedContents"],s)}return e}function NF(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=c(t,["cachedContents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),h(e,["cachedContents"],s)}return e}function DF(t){const e={},n=c(t,["videoMetadata"]);n!=null&&h(e,["videoMetadata"],n);const r=c(t,["thought"]);r!=null&&h(e,["thought"],r);const i=c(t,["inlineData"]);i!=null&&h(e,["inlineData"],dF(i));const s=c(t,["fileData"]);s!=null&&h(e,["fileData"],TF(s));const o=c(t,["thoughtSignature"]);o!=null&&h(e,["thoughtSignature"],o);const a=c(t,["functionCall"]);a!=null&&h(e,["functionCall"],a);const l=c(t,["codeExecutionResult"]);l!=null&&h(e,["codeExecutionResult"],l);const u=c(t,["executableCode"]);u!=null&&h(e,["executableCode"],u);const f=c(t,["functionResponse"]);f!=null&&h(e,["functionResponse"],f);const m=c(t,["text"]);return m!=null&&h(e,["text"],m),e}function bF(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(f=>f)),h(e,["functionDeclarations"],u)}if(c(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=c(t,["googleSearch"]);r!=null&&h(e,["googleSearch"],CF(r));const i=c(t,["googleSearchRetrieval"]);if(i!=null&&h(e,["googleSearchRetrieval"],i),c(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=c(t,["googleMaps"]);s!=null&&h(e,["googleMaps"],SF(s));const o=c(t,["urlContext"]);o!=null&&h(e,["urlContext"],o);const a=c(t,["computerUse"]);a!=null&&h(e,["computerUse"],a);const l=c(t,["codeExecution"]);return l!=null&&h(e,["codeExecution"],l),e}function MF(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let m=n;Array.isArray(m)&&(m=m.map(g=>EF(g))),h(e,["functionDeclarations"],m)}const r=c(t,["retrieval"]);r!=null&&h(e,["retrieval"],r);const i=c(t,["googleSearch"]);i!=null&&h(e,["googleSearch"],i);const s=c(t,["googleSearchRetrieval"]);s!=null&&h(e,["googleSearchRetrieval"],s);const o=c(t,["enterpriseWebSearch"]);o!=null&&h(e,["enterpriseWebSearch"],o);const a=c(t,["googleMaps"]);a!=null&&h(e,["googleMaps"],a);const l=c(t,["urlContext"]);l!=null&&h(e,["urlContext"],l);const u=c(t,["computerUse"]);u!=null&&h(e,["computerUse"],u);const f=c(t,["codeExecution"]);return f!=null&&h(e,["codeExecution"],f),e}function VF(t,e){const n={},r=c(t,["ttl"]);e!==void 0&&r!=null&&h(e,["ttl"],r);const i=c(t,["expireTime"]);return e!==void 0&&i!=null&&h(e,["expireTime"],i),n}function LF(t,e){const n={},r=c(t,["ttl"]);e!==void 0&&r!=null&&h(e,["ttl"],r);const i=c(t,["expireTime"]);return e!==void 0&&i!=null&&h(e,["expireTime"],i),n}function FF(t,e){const n={},r=c(e,["name"]);r!=null&&h(n,["_url","name"],ei(t,r));const i=c(e,["config"]);return i!=null&&VF(i,n),n}function UF(t,e){const n={},r=c(e,["name"]);r!=null&&h(n,["_url","name"],ei(t,r));const i=c(e,["config"]);return i!=null&&LF(i,n),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class OF extends oo{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new ec(to.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(n),n)}async create(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=mF(this.apiClient,e);return a=de("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>f)}else{const u=pF(this.apiClient,e);return a=de("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>f)}}async get(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=IF(this.apiClient,e);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>f)}else{const u=wF(this.apiClient,e);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>f)}}async delete(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=_F(this.apiClient,e);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=vF(f),g=new Sw;return Object.assign(g,m),g})}else{const u=gF(this.apiClient,e);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=yF(f),g=new Sw;return Object.assign(g,m),g})}}async update(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=UF(this.apiClient,e);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>f)}else{const u=FF(this.apiClient,e);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>f)}}async listInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=PF(e);return a=de("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=NF(f),g=new Cw;return Object.assign(g,m),g})}else{const u=RF(e);return a=de("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=kF(f),g=new Cw;return Object.assign(g,m),g})}}}function Dw(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function nt(t){return this instanceof nt?(this.v=t,this):new nt(t)}function ta(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),i,s=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(v){return function(T){return Promise.resolve(T).then(v,m)}}function a(v,T){r[v]&&(i[v]=function(x){return new Promise(function(D,C){s.push([v,x,D,C])>1||l(v,x)})},T&&(i[v]=T(i[v])))}function l(v,T){try{u(r[v](T))}catch(x){g(s[0][3],x)}}function u(v){v.value instanceof nt?Promise.resolve(v.value.v).then(f,m):g(s[0][2],v)}function f(v){l("next",v)}function m(v){l("throw",v)}function g(v,T){v(T),s.shift(),s.length&&l(s[0][0],s[0][1])}}function Jl(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof Dw=="function"?Dw(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(s){n[s]=t[s]&&function(o){return new Promise(function(a,l){o=t[s](o),i(a,l,o.done,o.value)})}}function i(s,o,a,l){Promise.resolve(l).then(function(u){s({value:u,done:a})},o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function BF(t){var e;if(t.candidates==null||t.candidates.length===0)return!1;const n=(e=t.candidates[0])===null||e===void 0?void 0:e.content;return n===void 0?!1:zx(n)}function zx(t){if(t.parts===void 0||t.parts.length===0)return!1;for(const e of t.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function qF(t){if(t.length!==0){for(const e of t)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function bw(t){if(t===void 0||t.length===0)return[];const e=[],n=t.length;let r=0;for(;r<n;)if(t[r].role==="user")e.push(t[r]),r++;else{const i=[];let s=!0;for(;r<n&&t[r].role==="model";)i.push(t[r]),s&&!zx(t[r])&&(s=!1),r++;s?e.push(...i):e.pop()}return e}class GF{constructor(e,n){this.modelsModule=e,this.apiClient=n}create(e){return new $F(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class $F{constructor(e,n,r,i={},s=[]){this.apiClient=e,this.modelsModule=n,this.model=r,this.config=i,this.history=s,this.sendPromise=Promise.resolve(),qF(s)}async sendMessage(e){var n;await this.sendPromise;const r=Yt(e.message),i=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var s,o,a;const l=await i,u=(o=(s=l.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content,f=l.automaticFunctionCallingHistory,m=this.getHistory(!0).length;let g=[];f!=null&&(g=(a=f.slice(m))!==null&&a!==void 0?a:[]);const v=u?[u]:[];this.recordHistory(r,v,g)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),i}async sendMessageStream(e){var n;await this.sendPromise;const r=Yt(e.message),i=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});this.sendPromise=i.then(()=>{}).catch(()=>{});const s=await i;return this.processStreamResponse(s,r)}getHistory(e=!1){const n=e?bw(this.history):this.history;return structuredClone(n)}processStreamResponse(e,n){var r,i;return ta(this,arguments,function*(){var o,a,l,u;const f=[];try{for(var m=!0,g=Jl(e),v;v=yield nt(g.next()),o=v.done,!o;m=!0){u=v.value,m=!1;const T=u;if(BF(T)){const x=(i=(r=T.candidates)===null||r===void 0?void 0:r[0])===null||i===void 0?void 0:i.content;x!==void 0&&f.push(x)}yield yield nt(T)}}catch(T){a={error:T}}finally{try{!m&&!o&&(l=g.return)&&(yield nt(l.call(g)))}finally{if(a)throw a.error}}this.recordHistory(n,f)})}recordHistory(e,n,r){let i=[];n.length>0&&n.every(s=>s.role!==void 0)?i=n:i.push({role:"model",parts:[]}),r&&r.length>0?this.history.push(...bw(r)):this.history.push(e),this.history.push(...i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class pf extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,pf.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function zF(t){const e={},n=c(t,["file"]);return n!=null&&h(e,["file"],n),e}function HF(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&h(e,["sdkHttpResponse"],n),e}function WF(t){const e={},n=c(t,["name"]);return n!=null&&h(e,["_url","file"],Fx(n)),e}function KF(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&h(e,["sdkHttpResponse"],n),e}function jF(t){const e={},n=c(t,["name"]);return n!=null&&h(e,["_url","file"],Fx(n)),e}function JF(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&h(e,["_query","pageSize"],r);const i=c(t,["pageToken"]);return e!==void 0&&i!=null&&h(e,["_query","pageToken"],i),n}function QF(t){const e={},n=c(t,["config"]);return n!=null&&JF(n,e),e}function YF(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=c(t,["files"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),h(e,["files"],s)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class XF extends oo{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new ec(to.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(n),n)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(n=>n)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=QF(e);return s=de("files",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>{const u=YF(l),f=new uL;return Object.assign(f,u),f})}}async createInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=zF(e);return s=de("upload/v1beta/files",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=HF(l),f=new cL;return Object.assign(f,u),f})}}async get(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=jF(e);return s=de("files/{file}",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>l)}}async delete(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=WF(e);return s=de("files/{file}",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>{const u=KF(l),f=new dL;return Object.assign(f,u),f})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Id(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["data"]);n!=null&&h(e,["data"],n);const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function ZF(t){const e={},n=c(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>pU(s))),h(e,["parts"],i)}const r=c(t,["role"]);return r!=null&&h(e,["role"],r),e}function eU(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["fileUri"]);n!=null&&h(e,["fileUri"],n);const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function tU(t){const e={};if(c(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=c(t,["description"]);n!=null&&h(e,["description"],n);const r=c(t,["name"]);r!=null&&h(e,["name"],r);const i=c(t,["parameters"]);i!=null&&h(e,["parameters"],i);const s=c(t,["parametersJsonSchema"]);s!=null&&h(e,["parametersJsonSchema"],s);const o=c(t,["response"]);o!=null&&h(e,["response"],o);const a=c(t,["responseJsonSchema"]);return a!=null&&h(e,["responseJsonSchema"],a),e}function nU(t){const e={},n=c(t,["modelSelectionConfig"]);n!=null&&h(e,["modelConfig"],n);const r=c(t,["audioTimestamp"]);r!=null&&h(e,["audioTimestamp"],r);const i=c(t,["candidateCount"]);i!=null&&h(e,["candidateCount"],i);const s=c(t,["enableAffectiveDialog"]);s!=null&&h(e,["enableAffectiveDialog"],s);const o=c(t,["frequencyPenalty"]);o!=null&&h(e,["frequencyPenalty"],o);const a=c(t,["logprobs"]);a!=null&&h(e,["logprobs"],a);const l=c(t,["maxOutputTokens"]);l!=null&&h(e,["maxOutputTokens"],l);const u=c(t,["mediaResolution"]);u!=null&&h(e,["mediaResolution"],u);const f=c(t,["presencePenalty"]);f!=null&&h(e,["presencePenalty"],f);const m=c(t,["responseJsonSchema"]);m!=null&&h(e,["responseJsonSchema"],m);const g=c(t,["responseLogprobs"]);g!=null&&h(e,["responseLogprobs"],g);const v=c(t,["responseMimeType"]);v!=null&&h(e,["responseMimeType"],v);const T=c(t,["responseModalities"]);T!=null&&h(e,["responseModalities"],T);const x=c(t,["responseSchema"]);x!=null&&h(e,["responseSchema"],x);const D=c(t,["routingConfig"]);D!=null&&h(e,["routingConfig"],D);const C=c(t,["seed"]);C!=null&&h(e,["seed"],C);const w=c(t,["speechConfig"]);w!=null&&h(e,["speechConfig"],Hx(w));const P=c(t,["stopSequences"]);P!=null&&h(e,["stopSequences"],P);const V=c(t,["temperature"]);V!=null&&h(e,["temperature"],V);const O=c(t,["thinkingConfig"]);O!=null&&h(e,["thinkingConfig"],O);const B=c(t,["topK"]);B!=null&&h(e,["topK"],B);const E=c(t,["topP"]);return E!=null&&h(e,["topP"],E),e}function rU(t){const e={};if(c(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=c(t,["enableWidget"]);return n!=null&&h(e,["enableWidget"],n),e}function iU(t){const e={},n=c(t,["timeRangeFilter"]);if(n!=null&&h(e,["timeRangeFilter"],n),c(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function sU(t,e){const n={},r=c(t,["generationConfig"]);e!==void 0&&r!=null&&h(e,["setup","generationConfig"],r);const i=c(t,["responseModalities"]);e!==void 0&&i!=null&&h(e,["setup","generationConfig","responseModalities"],i);const s=c(t,["temperature"]);e!==void 0&&s!=null&&h(e,["setup","generationConfig","temperature"],s);const o=c(t,["topP"]);e!==void 0&&o!=null&&h(e,["setup","generationConfig","topP"],o);const a=c(t,["topK"]);e!==void 0&&a!=null&&h(e,["setup","generationConfig","topK"],a);const l=c(t,["maxOutputTokens"]);e!==void 0&&l!=null&&h(e,["setup","generationConfig","maxOutputTokens"],l);const u=c(t,["mediaResolution"]);e!==void 0&&u!=null&&h(e,["setup","generationConfig","mediaResolution"],u);const f=c(t,["seed"]);e!==void 0&&f!=null&&h(e,["setup","generationConfig","seed"],f);const m=c(t,["speechConfig"]);e!==void 0&&m!=null&&h(e,["setup","generationConfig","speechConfig"],iy(m));const g=c(t,["thinkingConfig"]);e!==void 0&&g!=null&&h(e,["setup","generationConfig","thinkingConfig"],g);const v=c(t,["enableAffectiveDialog"]);e!==void 0&&v!=null&&h(e,["setup","generationConfig","enableAffectiveDialog"],v);const T=c(t,["systemInstruction"]);e!==void 0&&T!=null&&h(e,["setup","systemInstruction"],ZF(Yt(T)));const x=c(t,["tools"]);if(e!==void 0&&x!=null){let B=La(x);Array.isArray(B)&&(B=B.map(E=>gU(Va(E)))),h(e,["setup","tools"],B)}const D=c(t,["sessionResumption"]);e!==void 0&&D!=null&&h(e,["setup","sessionResumption"],mU(D));const C=c(t,["inputAudioTranscription"]);e!==void 0&&C!=null&&h(e,["setup","inputAudioTranscription"],C);const w=c(t,["outputAudioTranscription"]);e!==void 0&&w!=null&&h(e,["setup","outputAudioTranscription"],w);const P=c(t,["realtimeInputConfig"]);e!==void 0&&P!=null&&h(e,["setup","realtimeInputConfig"],P);const V=c(t,["contextWindowCompression"]);e!==void 0&&V!=null&&h(e,["setup","contextWindowCompression"],V);const O=c(t,["proactivity"]);return e!==void 0&&O!=null&&h(e,["setup","proactivity"],O),n}function oU(t,e){const n={},r=c(t,["generationConfig"]);e!==void 0&&r!=null&&h(e,["setup","generationConfig"],nU(r));const i=c(t,["responseModalities"]);e!==void 0&&i!=null&&h(e,["setup","generationConfig","responseModalities"],i);const s=c(t,["temperature"]);e!==void 0&&s!=null&&h(e,["setup","generationConfig","temperature"],s);const o=c(t,["topP"]);e!==void 0&&o!=null&&h(e,["setup","generationConfig","topP"],o);const a=c(t,["topK"]);e!==void 0&&a!=null&&h(e,["setup","generationConfig","topK"],a);const l=c(t,["maxOutputTokens"]);e!==void 0&&l!=null&&h(e,["setup","generationConfig","maxOutputTokens"],l);const u=c(t,["mediaResolution"]);e!==void 0&&u!=null&&h(e,["setup","generationConfig","mediaResolution"],u);const f=c(t,["seed"]);e!==void 0&&f!=null&&h(e,["setup","generationConfig","seed"],f);const m=c(t,["speechConfig"]);e!==void 0&&m!=null&&h(e,["setup","generationConfig","speechConfig"],Hx(iy(m)));const g=c(t,["thinkingConfig"]);e!==void 0&&g!=null&&h(e,["setup","generationConfig","thinkingConfig"],g);const v=c(t,["enableAffectiveDialog"]);e!==void 0&&v!=null&&h(e,["setup","generationConfig","enableAffectiveDialog"],v);const T=c(t,["systemInstruction"]);e!==void 0&&T!=null&&h(e,["setup","systemInstruction"],Yt(T));const x=c(t,["tools"]);if(e!==void 0&&x!=null){let B=La(x);Array.isArray(B)&&(B=B.map(E=>_U(Va(E)))),h(e,["setup","tools"],B)}const D=c(t,["sessionResumption"]);e!==void 0&&D!=null&&h(e,["setup","sessionResumption"],D);const C=c(t,["inputAudioTranscription"]);e!==void 0&&C!=null&&h(e,["setup","inputAudioTranscription"],C);const w=c(t,["outputAudioTranscription"]);e!==void 0&&w!=null&&h(e,["setup","outputAudioTranscription"],w);const P=c(t,["realtimeInputConfig"]);e!==void 0&&P!=null&&h(e,["setup","realtimeInputConfig"],P);const V=c(t,["contextWindowCompression"]);e!==void 0&&V!=null&&h(e,["setup","contextWindowCompression"],V);const O=c(t,["proactivity"]);return e!==void 0&&O!=null&&h(e,["setup","proactivity"],O),n}function aU(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["setup","model"],Ge(t,r));const i=c(e,["config"]);return i!=null&&h(n,["config"],sU(i,n)),n}function lU(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["setup","model"],Ge(t,r));const i=c(e,["config"]);return i!=null&&h(n,["config"],oU(i,n)),n}function uU(t){const e={},n=c(t,["musicGenerationConfig"]);return n!=null&&h(e,["musicGenerationConfig"],n),e}function cU(t){const e={},n=c(t,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>i)),h(e,["weightedPrompts"],r)}return e}function dU(t){const e={},n=c(t,["media"]);if(n!=null){let u=Dx(n);Array.isArray(u)&&(u=u.map(f=>Id(f))),h(e,["mediaChunks"],u)}const r=c(t,["audio"]);r!=null&&h(e,["audio"],Id(Mx(r)));const i=c(t,["audioStreamEnd"]);i!=null&&h(e,["audioStreamEnd"],i);const s=c(t,["video"]);s!=null&&h(e,["video"],Id(bx(s)));const o=c(t,["text"]);o!=null&&h(e,["text"],o);const a=c(t,["activityStart"]);a!=null&&h(e,["activityStart"],a);const l=c(t,["activityEnd"]);return l!=null&&h(e,["activityEnd"],l),e}function hU(t){const e={},n=c(t,["media"]);if(n!=null){let u=Dx(n);Array.isArray(u)&&(u=u.map(f=>f)),h(e,["mediaChunks"],u)}const r=c(t,["audio"]);r!=null&&h(e,["audio"],Mx(r));const i=c(t,["audioStreamEnd"]);i!=null&&h(e,["audioStreamEnd"],i);const s=c(t,["video"]);s!=null&&h(e,["video"],bx(s));const o=c(t,["text"]);o!=null&&h(e,["text"],o);const a=c(t,["activityStart"]);a!=null&&h(e,["activityStart"],a);const l=c(t,["activityEnd"]);return l!=null&&h(e,["activityEnd"],l),e}function fU(t){const e={},n=c(t,["setupComplete"]);n!=null&&h(e,["setupComplete"],n);const r=c(t,["serverContent"]);r!=null&&h(e,["serverContent"],r);const i=c(t,["toolCall"]);i!=null&&h(e,["toolCall"],i);const s=c(t,["toolCallCancellation"]);s!=null&&h(e,["toolCallCancellation"],s);const o=c(t,["usageMetadata"]);o!=null&&h(e,["usageMetadata"],yU(o));const a=c(t,["goAway"]);a!=null&&h(e,["goAway"],a);const l=c(t,["sessionResumptionUpdate"]);return l!=null&&h(e,["sessionResumptionUpdate"],l),e}function pU(t){const e={},n=c(t,["videoMetadata"]);n!=null&&h(e,["videoMetadata"],n);const r=c(t,["thought"]);r!=null&&h(e,["thought"],r);const i=c(t,["inlineData"]);i!=null&&h(e,["inlineData"],Id(i));const s=c(t,["fileData"]);s!=null&&h(e,["fileData"],eU(s));const o=c(t,["thoughtSignature"]);o!=null&&h(e,["thoughtSignature"],o);const a=c(t,["functionCall"]);a!=null&&h(e,["functionCall"],a);const l=c(t,["codeExecutionResult"]);l!=null&&h(e,["codeExecutionResult"],l);const u=c(t,["executableCode"]);u!=null&&h(e,["executableCode"],u);const f=c(t,["functionResponse"]);f!=null&&h(e,["functionResponse"],f);const m=c(t,["text"]);return m!=null&&h(e,["text"],m),e}function mU(t){const e={},n=c(t,["handle"]);if(n!=null&&h(e,["handle"],n),c(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function Hx(t){const e={},n=c(t,["voiceConfig"]);if(n!=null&&h(e,["voiceConfig"],n),c(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const r=c(t,["languageCode"]);return r!=null&&h(e,["languageCode"],r),e}function gU(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(f=>f)),h(e,["functionDeclarations"],u)}if(c(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=c(t,["googleSearch"]);r!=null&&h(e,["googleSearch"],iU(r));const i=c(t,["googleSearchRetrieval"]);if(i!=null&&h(e,["googleSearchRetrieval"],i),c(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=c(t,["googleMaps"]);s!=null&&h(e,["googleMaps"],rU(s));const o=c(t,["urlContext"]);o!=null&&h(e,["urlContext"],o);const a=c(t,["computerUse"]);a!=null&&h(e,["computerUse"],a);const l=c(t,["codeExecution"]);return l!=null&&h(e,["codeExecution"],l),e}function _U(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let m=n;Array.isArray(m)&&(m=m.map(g=>tU(g))),h(e,["functionDeclarations"],m)}const r=c(t,["retrieval"]);r!=null&&h(e,["retrieval"],r);const i=c(t,["googleSearch"]);i!=null&&h(e,["googleSearch"],i);const s=c(t,["googleSearchRetrieval"]);s!=null&&h(e,["googleSearchRetrieval"],s);const o=c(t,["enterpriseWebSearch"]);o!=null&&h(e,["enterpriseWebSearch"],o);const a=c(t,["googleMaps"]);a!=null&&h(e,["googleMaps"],a);const l=c(t,["urlContext"]);l!=null&&h(e,["urlContext"],l);const u=c(t,["computerUse"]);u!=null&&h(e,["computerUse"],u);const f=c(t,["codeExecution"]);return f!=null&&h(e,["codeExecution"],f),e}function yU(t){const e={},n=c(t,["promptTokenCount"]);n!=null&&h(e,["promptTokenCount"],n);const r=c(t,["cachedContentTokenCount"]);r!=null&&h(e,["cachedContentTokenCount"],r);const i=c(t,["candidatesTokenCount"]);i!=null&&h(e,["responseTokenCount"],i);const s=c(t,["toolUsePromptTokenCount"]);s!=null&&h(e,["toolUsePromptTokenCount"],s);const o=c(t,["thoughtsTokenCount"]);o!=null&&h(e,["thoughtsTokenCount"],o);const a=c(t,["totalTokenCount"]);a!=null&&h(e,["totalTokenCount"],a);const l=c(t,["promptTokensDetails"]);if(l!=null){let v=l;Array.isArray(v)&&(v=v.map(T=>T)),h(e,["promptTokensDetails"],v)}const u=c(t,["cacheTokensDetails"]);if(u!=null){let v=u;Array.isArray(v)&&(v=v.map(T=>T)),h(e,["cacheTokensDetails"],v)}const f=c(t,["candidatesTokensDetails"]);if(f!=null){let v=f;Array.isArray(v)&&(v=v.map(T=>T)),h(e,["responseTokensDetails"],v)}const m=c(t,["toolUsePromptTokensDetails"]);if(m!=null){let v=m;Array.isArray(v)&&(v=v.map(T=>T)),h(e,["toolUsePromptTokensDetails"],v)}const g=c(t,["trafficType"]);return g!=null&&h(e,["trafficType"],g),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function vU(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["data"]);n!=null&&h(e,["data"],n);const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function TU(t){const e={},n=c(t,["content"]);n!=null&&h(e,["content"],n);const r=c(t,["citationMetadata"]);r!=null&&h(e,["citationMetadata"],EU(r));const i=c(t,["tokenCount"]);i!=null&&h(e,["tokenCount"],i);const s=c(t,["finishReason"]);s!=null&&h(e,["finishReason"],s);const o=c(t,["urlContextMetadata"]);o!=null&&h(e,["urlContextMetadata"],o);const a=c(t,["avgLogprobs"]);a!=null&&h(e,["avgLogprobs"],a);const l=c(t,["groundingMetadata"]);l!=null&&h(e,["groundingMetadata"],l);const u=c(t,["index"]);u!=null&&h(e,["index"],u);const f=c(t,["logprobsResult"]);f!=null&&h(e,["logprobsResult"],f);const m=c(t,["safetyRatings"]);if(m!=null){let g=m;Array.isArray(g)&&(g=g.map(v=>v)),h(e,["safetyRatings"],g)}return e}function EU(t){const e={},n=c(t,["citationSources"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>i)),h(e,["citations"],r)}return e}function wU(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],Ge(t,r));const i=c(e,["contents"]);if(i!=null){let s=$n(i);Array.isArray(s)&&(s=s.map(o=>o)),h(n,["contents"],s)}return n}function IU(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["tokensInfo"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>s)),h(e,["tokensInfo"],i)}return e}function SU(t){const e={},n=c(t,["values"]);n!=null&&h(e,["values"],n);const r=c(t,["statistics"]);return r!=null&&h(e,["statistics"],CU(r)),e}function CU(t){const e={},n=c(t,["truncated"]);n!=null&&h(e,["truncated"],n);const r=c(t,["token_count"]);return r!=null&&h(e,["tokenCount"],r),e}function mf(t){const e={},n=c(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>k4(s))),h(e,["parts"],i)}const r=c(t,["role"]);return r!=null&&h(e,["role"],r),e}function AU(t){const e={},n=c(t,["controlType"]);n!=null&&h(e,["controlType"],n);const r=c(t,["enableControlImageComputation"]);return r!=null&&h(e,["computeControl"],r),e}function xU(t){const e={};if(c(t,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(c(t,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(c(t,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function RU(t,e){const n={},r=c(t,["systemInstruction"]);e!==void 0&&r!=null&&h(e,["systemInstruction"],Yt(r));const i=c(t,["tools"]);if(e!==void 0&&i!=null){let o=i;Array.isArray(o)&&(o=o.map(a=>Qx(a))),h(e,["tools"],o)}const s=c(t,["generationConfig"]);return e!==void 0&&s!=null&&h(e,["generationConfig"],_4(s)),n}function PU(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],Ge(t,r));const i=c(e,["contents"]);if(i!=null){let o=$n(i);Array.isArray(o)&&(o=o.map(a=>mf(a))),h(n,["contents"],o)}const s=c(e,["config"]);return s!=null&&xU(s),n}function kU(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],Ge(t,r));const i=c(e,["contents"]);if(i!=null){let o=$n(i);Array.isArray(o)&&(o=o.map(a=>a)),h(n,["contents"],o)}const s=c(e,["config"]);return s!=null&&RU(s,n),n}function NU(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["totalTokens"]);r!=null&&h(e,["totalTokens"],r);const i=c(t,["cachedContentTokenCount"]);return i!=null&&h(e,["cachedContentTokenCount"],i),e}function DU(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["totalTokens"]);return r!=null&&h(e,["totalTokens"],r),e}function bU(t,e){const n={},r=c(e,["model"]);return r!=null&&h(n,["_url","name"],Ge(t,r)),n}function MU(t,e){const n={},r=c(e,["model"]);return r!=null&&h(n,["_url","name"],Ge(t,r)),n}function VU(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&h(e,["sdkHttpResponse"],n),e}function LU(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&h(e,["sdkHttpResponse"],n),e}function FU(t,e){const n={},r=c(t,["outputGcsUri"]);e!==void 0&&r!=null&&h(e,["parameters","storageUri"],r);const i=c(t,["negativePrompt"]);e!==void 0&&i!=null&&h(e,["parameters","negativePrompt"],i);const s=c(t,["numberOfImages"]);e!==void 0&&s!=null&&h(e,["parameters","sampleCount"],s);const o=c(t,["aspectRatio"]);e!==void 0&&o!=null&&h(e,["parameters","aspectRatio"],o);const a=c(t,["guidanceScale"]);e!==void 0&&a!=null&&h(e,["parameters","guidanceScale"],a);const l=c(t,["seed"]);e!==void 0&&l!=null&&h(e,["parameters","seed"],l);const u=c(t,["safetyFilterLevel"]);e!==void 0&&u!=null&&h(e,["parameters","safetySetting"],u);const f=c(t,["personGeneration"]);e!==void 0&&f!=null&&h(e,["parameters","personGeneration"],f);const m=c(t,["includeSafetyAttributes"]);e!==void 0&&m!=null&&h(e,["parameters","includeSafetyAttributes"],m);const g=c(t,["includeRaiReason"]);e!==void 0&&g!=null&&h(e,["parameters","includeRaiReason"],g);const v=c(t,["language"]);e!==void 0&&v!=null&&h(e,["parameters","language"],v);const T=c(t,["outputMimeType"]);e!==void 0&&T!=null&&h(e,["parameters","outputOptions","mimeType"],T);const x=c(t,["outputCompressionQuality"]);e!==void 0&&x!=null&&h(e,["parameters","outputOptions","compressionQuality"],x);const D=c(t,["addWatermark"]);e!==void 0&&D!=null&&h(e,["parameters","addWatermark"],D);const C=c(t,["labels"]);e!==void 0&&C!=null&&h(e,["labels"],C);const w=c(t,["editMode"]);e!==void 0&&w!=null&&h(e,["parameters","editMode"],w);const P=c(t,["baseSteps"]);return e!==void 0&&P!=null&&h(e,["parameters","editConfig","baseSteps"],P),n}function UU(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],Ge(t,r));const i=c(e,["prompt"]);i!=null&&h(n,["instances[0]","prompt"],i);const s=c(e,["referenceImages"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>L4(l))),h(n,["instances[0]","referenceImages"],a)}const o=c(e,["config"]);return o!=null&&FU(o,n),n}function OU(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>gf(s))),h(e,["generatedImages"],i)}return e}function BU(t,e){const n={},r=c(t,["taskType"]);e!==void 0&&r!=null&&h(e,["requests[]","taskType"],r);const i=c(t,["title"]);e!==void 0&&i!=null&&h(e,["requests[]","title"],i);const s=c(t,["outputDimensionality"]);if(e!==void 0&&s!=null&&h(e,["requests[]","outputDimensionality"],s),c(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(c(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function qU(t,e){const n={},r=c(t,["taskType"]);e!==void 0&&r!=null&&h(e,["instances[]","task_type"],r);const i=c(t,["title"]);e!==void 0&&i!=null&&h(e,["instances[]","title"],i);const s=c(t,["outputDimensionality"]);e!==void 0&&s!=null&&h(e,["parameters","outputDimensionality"],s);const o=c(t,["mimeType"]);e!==void 0&&o!=null&&h(e,["instances[]","mimeType"],o);const a=c(t,["autoTruncate"]);return e!==void 0&&a!=null&&h(e,["parameters","autoTruncate"],a),n}function GU(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],Ge(t,r));const i=c(e,["contents"]);if(i!=null){let a=ty(t,i);Array.isArray(a)&&(a=a.map(l=>l)),h(n,["requests[]","content"],a)}const s=c(e,["config"]);s!=null&&BU(s,n);const o=c(e,["model"]);return o!==void 0&&h(n,["requests[]","model"],Ge(t,o)),n}function $U(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],Ge(t,r));const i=c(e,["contents"]);if(i!=null){let o=ty(t,i);Array.isArray(o)&&(o=o.map(a=>a)),h(n,["instances[]","content"],o)}const s=c(e,["config"]);return s!=null&&qU(s,n),n}function zU(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["embeddings"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>o)),h(e,["embeddings"],s)}const i=c(t,["metadata"]);return i!=null&&h(e,["metadata"],i),e}function HU(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["predictions[]","embeddings"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>SU(o))),h(e,["embeddings"],s)}const i=c(t,["metadata"]);return i!=null&&h(e,["metadata"],i),e}function WU(t){const e={},n=c(t,["endpoint"]);n!=null&&h(e,["name"],n);const r=c(t,["deployedModelId"]);return r!=null&&h(e,["deployedModelId"],r),e}function KU(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["fileUri"]);n!=null&&h(e,["fileUri"],n);const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function jU(t){const e={};if(c(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=c(t,["description"]);n!=null&&h(e,["description"],n);const r=c(t,["name"]);r!=null&&h(e,["name"],r);const i=c(t,["parameters"]);i!=null&&h(e,["parameters"],i);const s=c(t,["parametersJsonSchema"]);s!=null&&h(e,["parametersJsonSchema"],s);const o=c(t,["response"]);o!=null&&h(e,["response"],o);const a=c(t,["responseJsonSchema"]);return a!=null&&h(e,["responseJsonSchema"],a),e}function JU(t,e,n){const r={},i=c(e,["systemInstruction"]);n!==void 0&&i!=null&&h(n,["systemInstruction"],mf(Yt(i)));const s=c(e,["temperature"]);s!=null&&h(r,["temperature"],s);const o=c(e,["topP"]);o!=null&&h(r,["topP"],o);const a=c(e,["topK"]);a!=null&&h(r,["topK"],a);const l=c(e,["candidateCount"]);l!=null&&h(r,["candidateCount"],l);const u=c(e,["maxOutputTokens"]);u!=null&&h(r,["maxOutputTokens"],u);const f=c(e,["stopSequences"]);f!=null&&h(r,["stopSequences"],f);const m=c(e,["responseLogprobs"]);m!=null&&h(r,["responseLogprobs"],m);const g=c(e,["logprobs"]);g!=null&&h(r,["logprobs"],g);const v=c(e,["presencePenalty"]);v!=null&&h(r,["presencePenalty"],v);const T=c(e,["frequencyPenalty"]);T!=null&&h(r,["frequencyPenalty"],T);const x=c(e,["seed"]);x!=null&&h(r,["seed"],x);const D=c(e,["responseMimeType"]);D!=null&&h(r,["responseMimeType"],D);const C=c(e,["responseSchema"]);C!=null&&h(r,["responseSchema"],ny(C));const w=c(e,["responseJsonSchema"]);if(w!=null&&h(r,["responseJsonSchema"],w),c(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(c(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const P=c(e,["safetySettings"]);if(n!==void 0&&P!=null){let L=P;Array.isArray(L)&&(L=L.map(N=>F4(N))),h(n,["safetySettings"],L)}const V=c(e,["tools"]);if(n!==void 0&&V!=null){let L=La(V);Array.isArray(L)&&(L=L.map(N=>$4(Va(N)))),h(n,["tools"],L)}const O=c(e,["toolConfig"]);if(n!==void 0&&O!=null&&h(n,["toolConfig"],O),c(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const B=c(e,["cachedContent"]);n!==void 0&&B!=null&&h(n,["cachedContent"],ei(t,B));const E=c(e,["responseModalities"]);E!=null&&h(r,["responseModalities"],E);const I=c(e,["mediaResolution"]);I!=null&&h(r,["mediaResolution"],I);const A=c(e,["speechConfig"]);if(A!=null&&h(r,["speechConfig"],ry(A)),c(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const k=c(e,["thinkingConfig"]);k!=null&&h(r,["thinkingConfig"],k);const b=c(e,["imageConfig"]);return b!=null&&h(r,["imageConfig"],b),r}function QU(t,e,n){const r={},i=c(e,["systemInstruction"]);n!==void 0&&i!=null&&h(n,["systemInstruction"],Yt(i));const s=c(e,["temperature"]);s!=null&&h(r,["temperature"],s);const o=c(e,["topP"]);o!=null&&h(r,["topP"],o);const a=c(e,["topK"]);a!=null&&h(r,["topK"],a);const l=c(e,["candidateCount"]);l!=null&&h(r,["candidateCount"],l);const u=c(e,["maxOutputTokens"]);u!=null&&h(r,["maxOutputTokens"],u);const f=c(e,["stopSequences"]);f!=null&&h(r,["stopSequences"],f);const m=c(e,["responseLogprobs"]);m!=null&&h(r,["responseLogprobs"],m);const g=c(e,["logprobs"]);g!=null&&h(r,["logprobs"],g);const v=c(e,["presencePenalty"]);v!=null&&h(r,["presencePenalty"],v);const T=c(e,["frequencyPenalty"]);T!=null&&h(r,["frequencyPenalty"],T);const x=c(e,["seed"]);x!=null&&h(r,["seed"],x);const D=c(e,["responseMimeType"]);D!=null&&h(r,["responseMimeType"],D);const C=c(e,["responseSchema"]);C!=null&&h(r,["responseSchema"],ny(C));const w=c(e,["responseJsonSchema"]);w!=null&&h(r,["responseJsonSchema"],w);const P=c(e,["routingConfig"]);P!=null&&h(r,["routingConfig"],P);const V=c(e,["modelSelectionConfig"]);V!=null&&h(r,["modelConfig"],V);const O=c(e,["safetySettings"]);if(n!==void 0&&O!=null){let Ke=O;Array.isArray(Ke)&&(Ke=Ke.map(Te=>Te)),h(n,["safetySettings"],Ke)}const B=c(e,["tools"]);if(n!==void 0&&B!=null){let Ke=La(B);Array.isArray(Ke)&&(Ke=Ke.map(Te=>Qx(Va(Te)))),h(n,["tools"],Ke)}const E=c(e,["toolConfig"]);n!==void 0&&E!=null&&h(n,["toolConfig"],E);const I=c(e,["labels"]);n!==void 0&&I!=null&&h(n,["labels"],I);const A=c(e,["cachedContent"]);n!==void 0&&A!=null&&h(n,["cachedContent"],ei(t,A));const k=c(e,["responseModalities"]);k!=null&&h(r,["responseModalities"],k);const b=c(e,["mediaResolution"]);b!=null&&h(r,["mediaResolution"],b);const L=c(e,["speechConfig"]);L!=null&&h(r,["speechConfig"],Jx(ry(L)));const N=c(e,["audioTimestamp"]);N!=null&&h(r,["audioTimestamp"],N);const De=c(e,["thinkingConfig"]);De!=null&&h(r,["thinkingConfig"],De);const Fe=c(e,["imageConfig"]);return Fe!=null&&h(r,["imageConfig"],Fe),r}function Mw(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],Ge(t,r));const i=c(e,["contents"]);if(i!=null){let o=$n(i);Array.isArray(o)&&(o=o.map(a=>mf(a))),h(n,["contents"],o)}const s=c(e,["config"]);return s!=null&&h(n,["generationConfig"],JU(t,s,n)),n}function Vw(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],Ge(t,r));const i=c(e,["contents"]);if(i!=null){let o=$n(i);Array.isArray(o)&&(o=o.map(a=>a)),h(n,["contents"],o)}const s=c(e,["config"]);return s!=null&&h(n,["generationConfig"],QU(t,s,n)),n}function Lw(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["candidates"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(u=>TU(u))),h(e,["candidates"],l)}const i=c(t,["modelVersion"]);i!=null&&h(e,["modelVersion"],i);const s=c(t,["promptFeedback"]);s!=null&&h(e,["promptFeedback"],s);const o=c(t,["responseId"]);o!=null&&h(e,["responseId"],o);const a=c(t,["usageMetadata"]);return a!=null&&h(e,["usageMetadata"],a),e}function Fw(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["candidates"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(f=>f)),h(e,["candidates"],u)}const i=c(t,["createTime"]);i!=null&&h(e,["createTime"],i);const s=c(t,["modelVersion"]);s!=null&&h(e,["modelVersion"],s);const o=c(t,["promptFeedback"]);o!=null&&h(e,["promptFeedback"],o);const a=c(t,["responseId"]);a!=null&&h(e,["responseId"],a);const l=c(t,["usageMetadata"]);return l!=null&&h(e,["usageMetadata"],l),e}function YU(t,e){const n={};if(c(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(c(t,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const r=c(t,["numberOfImages"]);e!==void 0&&r!=null&&h(e,["parameters","sampleCount"],r);const i=c(t,["aspectRatio"]);e!==void 0&&i!=null&&h(e,["parameters","aspectRatio"],i);const s=c(t,["guidanceScale"]);if(e!==void 0&&s!=null&&h(e,["parameters","guidanceScale"],s),c(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=c(t,["safetyFilterLevel"]);e!==void 0&&o!=null&&h(e,["parameters","safetySetting"],o);const a=c(t,["personGeneration"]);e!==void 0&&a!=null&&h(e,["parameters","personGeneration"],a);const l=c(t,["includeSafetyAttributes"]);e!==void 0&&l!=null&&h(e,["parameters","includeSafetyAttributes"],l);const u=c(t,["includeRaiReason"]);e!==void 0&&u!=null&&h(e,["parameters","includeRaiReason"],u);const f=c(t,["language"]);e!==void 0&&f!=null&&h(e,["parameters","language"],f);const m=c(t,["outputMimeType"]);e!==void 0&&m!=null&&h(e,["parameters","outputOptions","mimeType"],m);const g=c(t,["outputCompressionQuality"]);if(e!==void 0&&g!=null&&h(e,["parameters","outputOptions","compressionQuality"],g),c(t,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(c(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const v=c(t,["imageSize"]);if(e!==void 0&&v!=null&&h(e,["parameters","sampleImageSize"],v),c(t,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function XU(t,e){const n={},r=c(t,["outputGcsUri"]);e!==void 0&&r!=null&&h(e,["parameters","storageUri"],r);const i=c(t,["negativePrompt"]);e!==void 0&&i!=null&&h(e,["parameters","negativePrompt"],i);const s=c(t,["numberOfImages"]);e!==void 0&&s!=null&&h(e,["parameters","sampleCount"],s);const o=c(t,["aspectRatio"]);e!==void 0&&o!=null&&h(e,["parameters","aspectRatio"],o);const a=c(t,["guidanceScale"]);e!==void 0&&a!=null&&h(e,["parameters","guidanceScale"],a);const l=c(t,["seed"]);e!==void 0&&l!=null&&h(e,["parameters","seed"],l);const u=c(t,["safetyFilterLevel"]);e!==void 0&&u!=null&&h(e,["parameters","safetySetting"],u);const f=c(t,["personGeneration"]);e!==void 0&&f!=null&&h(e,["parameters","personGeneration"],f);const m=c(t,["includeSafetyAttributes"]);e!==void 0&&m!=null&&h(e,["parameters","includeSafetyAttributes"],m);const g=c(t,["includeRaiReason"]);e!==void 0&&g!=null&&h(e,["parameters","includeRaiReason"],g);const v=c(t,["language"]);e!==void 0&&v!=null&&h(e,["parameters","language"],v);const T=c(t,["outputMimeType"]);e!==void 0&&T!=null&&h(e,["parameters","outputOptions","mimeType"],T);const x=c(t,["outputCompressionQuality"]);e!==void 0&&x!=null&&h(e,["parameters","outputOptions","compressionQuality"],x);const D=c(t,["addWatermark"]);e!==void 0&&D!=null&&h(e,["parameters","addWatermark"],D);const C=c(t,["labels"]);e!==void 0&&C!=null&&h(e,["labels"],C);const w=c(t,["imageSize"]);e!==void 0&&w!=null&&h(e,["parameters","sampleImageSize"],w);const P=c(t,["enhancePrompt"]);return e!==void 0&&P!=null&&h(e,["parameters","enhancePrompt"],P),n}function ZU(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],Ge(t,r));const i=c(e,["prompt"]);i!=null&&h(n,["instances[0]","prompt"],i);const s=c(e,["config"]);return s!=null&&YU(s,n),n}function e4(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],Ge(t,r));const i=c(e,["prompt"]);i!=null&&h(n,["instances[0]","prompt"],i);const s=c(e,["config"]);return s!=null&&XU(s,n),n}function t4(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>f4(o))),h(e,["generatedImages"],s)}const i=c(t,["positivePromptSafetyAttributes"]);return i!=null&&h(e,["positivePromptSafetyAttributes"],Kx(i)),e}function n4(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>gf(o))),h(e,["generatedImages"],s)}const i=c(t,["positivePromptSafetyAttributes"]);return i!=null&&h(e,["positivePromptSafetyAttributes"],jx(i)),e}function r4(t,e){const n={},r=c(t,["numberOfVideos"]);if(e!==void 0&&r!=null&&h(e,["parameters","sampleCount"],r),c(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(c(t,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const i=c(t,["durationSeconds"]);if(e!==void 0&&i!=null&&h(e,["parameters","durationSeconds"],i),c(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const s=c(t,["aspectRatio"]);e!==void 0&&s!=null&&h(e,["parameters","aspectRatio"],s);const o=c(t,["resolution"]);e!==void 0&&o!=null&&h(e,["parameters","resolution"],o);const a=c(t,["personGeneration"]);if(e!==void 0&&a!=null&&h(e,["parameters","personGeneration"],a),c(t,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const l=c(t,["negativePrompt"]);e!==void 0&&l!=null&&h(e,["parameters","negativePrompt"],l);const u=c(t,["enhancePrompt"]);if(e!==void 0&&u!=null&&h(e,["parameters","enhancePrompt"],u),c(t,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const f=c(t,["lastFrame"]);e!==void 0&&f!=null&&h(e,["instances[0]","lastFrame"],_f(f));const m=c(t,["referenceImages"]);if(e!==void 0&&m!=null){let g=m;Array.isArray(g)&&(g=g.map(v=>nO(v))),h(e,["instances[0]","referenceImages"],g)}if(c(t,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(c(t,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return n}function i4(t,e){const n={},r=c(t,["numberOfVideos"]);e!==void 0&&r!=null&&h(e,["parameters","sampleCount"],r);const i=c(t,["outputGcsUri"]);e!==void 0&&i!=null&&h(e,["parameters","storageUri"],i);const s=c(t,["fps"]);e!==void 0&&s!=null&&h(e,["parameters","fps"],s);const o=c(t,["durationSeconds"]);e!==void 0&&o!=null&&h(e,["parameters","durationSeconds"],o);const a=c(t,["seed"]);e!==void 0&&a!=null&&h(e,["parameters","seed"],a);const l=c(t,["aspectRatio"]);e!==void 0&&l!=null&&h(e,["parameters","aspectRatio"],l);const u=c(t,["resolution"]);e!==void 0&&u!=null&&h(e,["parameters","resolution"],u);const f=c(t,["personGeneration"]);e!==void 0&&f!=null&&h(e,["parameters","personGeneration"],f);const m=c(t,["pubsubTopic"]);e!==void 0&&m!=null&&h(e,["parameters","pubsubTopic"],m);const g=c(t,["negativePrompt"]);e!==void 0&&g!=null&&h(e,["parameters","negativePrompt"],g);const v=c(t,["enhancePrompt"]);e!==void 0&&v!=null&&h(e,["parameters","enhancePrompt"],v);const T=c(t,["generateAudio"]);e!==void 0&&T!=null&&h(e,["parameters","generateAudio"],T);const x=c(t,["lastFrame"]);e!==void 0&&x!=null&&h(e,["instances[0]","lastFrame"],or(x));const D=c(t,["referenceImages"]);if(e!==void 0&&D!=null){let P=D;Array.isArray(P)&&(P=P.map(V=>rO(V))),h(e,["instances[0]","referenceImages"],P)}const C=c(t,["mask"]);e!==void 0&&C!=null&&h(e,["instances[0]","mask"],tO(C));const w=c(t,["compressionQuality"]);return e!==void 0&&w!=null&&h(e,["parameters","compressionQuality"],w),n}function s4(t){const e={},n=c(t,["name"]);n!=null&&h(e,["name"],n);const r=c(t,["metadata"]);r!=null&&h(e,["metadata"],r);const i=c(t,["done"]);i!=null&&h(e,["done"],i);const s=c(t,["error"]);s!=null&&h(e,["error"],s);const o=c(t,["response","generateVideoResponse"]);return o!=null&&h(e,["response"],u4(o)),e}function o4(t){const e={},n=c(t,["name"]);n!=null&&h(e,["name"],n);const r=c(t,["metadata"]);r!=null&&h(e,["metadata"],r);const i=c(t,["done"]);i!=null&&h(e,["done"],i);const s=c(t,["error"]);s!=null&&h(e,["error"],s);const o=c(t,["response"]);return o!=null&&h(e,["response"],c4(o)),e}function a4(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],Ge(t,r));const i=c(e,["prompt"]);i!=null&&h(n,["instances[0]","prompt"],i);const s=c(e,["image"]);s!=null&&h(n,["instances[0]","image"],_f(s));const o=c(e,["video"]);o!=null&&h(n,["instances[0]","video"],Yx(o));const a=c(e,["source"]);a!=null&&d4(a,n);const l=c(e,["config"]);return l!=null&&r4(l,n),n}function l4(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],Ge(t,r));const i=c(e,["prompt"]);i!=null&&h(n,["instances[0]","prompt"],i);const s=c(e,["image"]);s!=null&&h(n,["instances[0]","image"],or(s));const o=c(e,["video"]);o!=null&&h(n,["instances[0]","video"],Xx(o));const a=c(e,["source"]);a!=null&&h4(a,n);const l=c(e,["config"]);return l!=null&&i4(l,n),n}function u4(t){const e={},n=c(t,["generatedSamples"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>m4(o))),h(e,["generatedVideos"],s)}const r=c(t,["raiMediaFilteredCount"]);r!=null&&h(e,["raiMediaFilteredCount"],r);const i=c(t,["raiMediaFilteredReasons"]);return i!=null&&h(e,["raiMediaFilteredReasons"],i),e}function c4(t){const e={},n=c(t,["videos"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>g4(o))),h(e,["generatedVideos"],s)}const r=c(t,["raiMediaFilteredCount"]);r!=null&&h(e,["raiMediaFilteredCount"],r);const i=c(t,["raiMediaFilteredReasons"]);return i!=null&&h(e,["raiMediaFilteredReasons"],i),e}function d4(t,e){const n={},r=c(t,["prompt"]);e!==void 0&&r!=null&&h(e,["instances[0]","prompt"],r);const i=c(t,["image"]);e!==void 0&&i!=null&&h(e,["instances[0]","image"],_f(i));const s=c(t,["video"]);return e!==void 0&&s!=null&&h(e,["instances[0]","video"],Yx(s)),n}function h4(t,e){const n={},r=c(t,["prompt"]);e!==void 0&&r!=null&&h(e,["instances[0]","prompt"],r);const i=c(t,["image"]);e!==void 0&&i!=null&&h(e,["instances[0]","image"],or(i));const s=c(t,["video"]);return e!==void 0&&s!=null&&h(e,["instances[0]","video"],Xx(s)),n}function f4(t){const e={},n=c(t,["_self"]);n!=null&&h(e,["image"],w4(n));const r=c(t,["raiFilteredReason"]);r!=null&&h(e,["raiFilteredReason"],r);const i=c(t,["_self"]);return i!=null&&h(e,["safetyAttributes"],Kx(i)),e}function gf(t){const e={},n=c(t,["_self"]);n!=null&&h(e,["image"],Wx(n));const r=c(t,["raiFilteredReason"]);r!=null&&h(e,["raiFilteredReason"],r);const i=c(t,["_self"]);i!=null&&h(e,["safetyAttributes"],jx(i));const s=c(t,["prompt"]);return s!=null&&h(e,["enhancedPrompt"],s),e}function p4(t){const e={},n=c(t,["_self"]);n!=null&&h(e,["mask"],Wx(n));const r=c(t,["labels"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>s)),h(e,["labels"],i)}return e}function m4(t){const e={},n=c(t,["video"]);return n!=null&&h(e,["video"],Z4(n)),e}function g4(t){const e={},n=c(t,["_self"]);return n!=null&&h(e,["video"],eO(n)),e}function _4(t){const e={},n=c(t,["modelSelectionConfig"]);n!=null&&h(e,["modelConfig"],n);const r=c(t,["audioTimestamp"]);r!=null&&h(e,["audioTimestamp"],r);const i=c(t,["candidateCount"]);i!=null&&h(e,["candidateCount"],i);const s=c(t,["enableAffectiveDialog"]);s!=null&&h(e,["enableAffectiveDialog"],s);const o=c(t,["frequencyPenalty"]);o!=null&&h(e,["frequencyPenalty"],o);const a=c(t,["logprobs"]);a!=null&&h(e,["logprobs"],a);const l=c(t,["maxOutputTokens"]);l!=null&&h(e,["maxOutputTokens"],l);const u=c(t,["mediaResolution"]);u!=null&&h(e,["mediaResolution"],u);const f=c(t,["presencePenalty"]);f!=null&&h(e,["presencePenalty"],f);const m=c(t,["responseJsonSchema"]);m!=null&&h(e,["responseJsonSchema"],m);const g=c(t,["responseLogprobs"]);g!=null&&h(e,["responseLogprobs"],g);const v=c(t,["responseMimeType"]);v!=null&&h(e,["responseMimeType"],v);const T=c(t,["responseModalities"]);T!=null&&h(e,["responseModalities"],T);const x=c(t,["responseSchema"]);x!=null&&h(e,["responseSchema"],x);const D=c(t,["routingConfig"]);D!=null&&h(e,["routingConfig"],D);const C=c(t,["seed"]);C!=null&&h(e,["seed"],C);const w=c(t,["speechConfig"]);w!=null&&h(e,["speechConfig"],Jx(w));const P=c(t,["stopSequences"]);P!=null&&h(e,["stopSequences"],P);const V=c(t,["temperature"]);V!=null&&h(e,["temperature"],V);const O=c(t,["thinkingConfig"]);O!=null&&h(e,["thinkingConfig"],O);const B=c(t,["topK"]);B!=null&&h(e,["topK"],B);const E=c(t,["topP"]);return E!=null&&h(e,["topP"],E),e}function y4(t,e){const n={},r=c(e,["model"]);return r!=null&&h(n,["_url","name"],Ge(t,r)),n}function v4(t,e){const n={},r=c(e,["model"]);return r!=null&&h(n,["_url","name"],Ge(t,r)),n}function T4(t){const e={};if(c(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=c(t,["enableWidget"]);return n!=null&&h(e,["enableWidget"],n),e}function E4(t){const e={},n=c(t,["timeRangeFilter"]);if(n!=null&&h(e,["timeRangeFilter"],n),c(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function w4(t){const e={},n=c(t,["bytesBase64Encoded"]);n!=null&&h(e,["imageBytes"],ns(n));const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function Wx(t){const e={},n=c(t,["gcsUri"]);n!=null&&h(e,["gcsUri"],n);const r=c(t,["bytesBase64Encoded"]);r!=null&&h(e,["imageBytes"],ns(r));const i=c(t,["mimeType"]);return i!=null&&h(e,["mimeType"],i),e}function _f(t){const e={};if(c(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=c(t,["imageBytes"]);n!=null&&h(e,["bytesBase64Encoded"],ns(n));const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function or(t){const e={},n=c(t,["gcsUri"]);n!=null&&h(e,["gcsUri"],n);const r=c(t,["imageBytes"]);r!=null&&h(e,["bytesBase64Encoded"],ns(r));const i=c(t,["mimeType"]);return i!=null&&h(e,["mimeType"],i),e}function I4(t,e,n){const r={},i=c(e,["pageSize"]);n!==void 0&&i!=null&&h(n,["_query","pageSize"],i);const s=c(e,["pageToken"]);n!==void 0&&s!=null&&h(n,["_query","pageToken"],s);const o=c(e,["filter"]);n!==void 0&&o!=null&&h(n,["_query","filter"],o);const a=c(e,["queryBase"]);return n!==void 0&&a!=null&&h(n,["_url","models_url"],Ux(t,a)),r}function S4(t,e,n){const r={},i=c(e,["pageSize"]);n!==void 0&&i!=null&&h(n,["_query","pageSize"],i);const s=c(e,["pageToken"]);n!==void 0&&s!=null&&h(n,["_query","pageToken"],s);const o=c(e,["filter"]);n!==void 0&&o!=null&&h(n,["_query","filter"],o);const a=c(e,["queryBase"]);return n!==void 0&&a!=null&&h(n,["_url","models_url"],Ux(t,a)),r}function C4(t,e){const n={},r=c(e,["config"]);return r!=null&&I4(t,r,n),n}function A4(t,e){const n={},r=c(e,["config"]);return r!=null&&S4(t,r,n),n}function x4(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=c(t,["_self"]);if(i!=null){let s=Ox(i);Array.isArray(s)&&(s=s.map(o=>Ym(o))),h(e,["models"],s)}return e}function R4(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=c(t,["_self"]);if(i!=null){let s=Ox(i);Array.isArray(s)&&(s=s.map(o=>Xm(o))),h(e,["models"],s)}return e}function P4(t){const e={},n=c(t,["maskMode"]);n!=null&&h(e,["maskMode"],n);const r=c(t,["segmentationClasses"]);r!=null&&h(e,["maskClasses"],r);const i=c(t,["maskDilation"]);return i!=null&&h(e,["dilation"],i),e}function Ym(t){const e={},n=c(t,["name"]);n!=null&&h(e,["name"],n);const r=c(t,["displayName"]);r!=null&&h(e,["displayName"],r);const i=c(t,["description"]);i!=null&&h(e,["description"],i);const s=c(t,["version"]);s!=null&&h(e,["version"],s);const o=c(t,["_self"]);o!=null&&h(e,["tunedModelInfo"],z4(o));const a=c(t,["inputTokenLimit"]);a!=null&&h(e,["inputTokenLimit"],a);const l=c(t,["outputTokenLimit"]);l!=null&&h(e,["outputTokenLimit"],l);const u=c(t,["supportedGenerationMethods"]);return u!=null&&h(e,["supportedActions"],u),e}function Xm(t){const e={},n=c(t,["name"]);n!=null&&h(e,["name"],n);const r=c(t,["displayName"]);r!=null&&h(e,["displayName"],r);const i=c(t,["description"]);i!=null&&h(e,["description"],i);const s=c(t,["versionId"]);s!=null&&h(e,["version"],s);const o=c(t,["deployedModels"]);if(o!=null){let m=o;Array.isArray(m)&&(m=m.map(g=>WU(g))),h(e,["endpoints"],m)}const a=c(t,["labels"]);a!=null&&h(e,["labels"],a);const l=c(t,["_self"]);l!=null&&h(e,["tunedModelInfo"],H4(l));const u=c(t,["defaultCheckpointId"]);u!=null&&h(e,["defaultCheckpointId"],u);const f=c(t,["checkpoints"]);if(f!=null){let m=f;Array.isArray(m)&&(m=m.map(g=>g)),h(e,["checkpoints"],m)}return e}function k4(t){const e={},n=c(t,["videoMetadata"]);n!=null&&h(e,["videoMetadata"],n);const r=c(t,["thought"]);r!=null&&h(e,["thought"],r);const i=c(t,["inlineData"]);i!=null&&h(e,["inlineData"],vU(i));const s=c(t,["fileData"]);s!=null&&h(e,["fileData"],KU(s));const o=c(t,["thoughtSignature"]);o!=null&&h(e,["thoughtSignature"],o);const a=c(t,["functionCall"]);a!=null&&h(e,["functionCall"],a);const l=c(t,["codeExecutionResult"]);l!=null&&h(e,["codeExecutionResult"],l);const u=c(t,["executableCode"]);u!=null&&h(e,["executableCode"],u);const f=c(t,["functionResponse"]);f!=null&&h(e,["functionResponse"],f);const m=c(t,["text"]);return m!=null&&h(e,["text"],m),e}function N4(t){const e={},n=c(t,["productImage"]);return n!=null&&h(e,["image"],or(n)),e}function D4(t,e){const n={},r=c(t,["numberOfImages"]);e!==void 0&&r!=null&&h(e,["parameters","sampleCount"],r);const i=c(t,["baseSteps"]);e!==void 0&&i!=null&&h(e,["parameters","editConfig","baseSteps"],i);const s=c(t,["outputGcsUri"]);e!==void 0&&s!=null&&h(e,["parameters","storageUri"],s);const o=c(t,["seed"]);e!==void 0&&o!=null&&h(e,["parameters","seed"],o);const a=c(t,["safetyFilterLevel"]);e!==void 0&&a!=null&&h(e,["parameters","safetySetting"],a);const l=c(t,["personGeneration"]);e!==void 0&&l!=null&&h(e,["parameters","personGeneration"],l);const u=c(t,["addWatermark"]);e!==void 0&&u!=null&&h(e,["parameters","addWatermark"],u);const f=c(t,["outputMimeType"]);e!==void 0&&f!=null&&h(e,["parameters","outputOptions","mimeType"],f);const m=c(t,["outputCompressionQuality"]);e!==void 0&&m!=null&&h(e,["parameters","outputOptions","compressionQuality"],m);const g=c(t,["enhancePrompt"]);e!==void 0&&g!=null&&h(e,["parameters","enhancePrompt"],g);const v=c(t,["labels"]);return e!==void 0&&v!=null&&h(e,["labels"],v),n}function b4(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],Ge(t,r));const i=c(e,["source"]);i!=null&&V4(i,n);const s=c(e,["config"]);return s!=null&&D4(s,n),n}function M4(t){const e={},n=c(t,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>gf(i))),h(e,["generatedImages"],r)}return e}function V4(t,e){const n={},r=c(t,["prompt"]);e!==void 0&&r!=null&&h(e,["instances[0]","prompt"],r);const i=c(t,["personImage"]);e!==void 0&&i!=null&&h(e,["instances[0]","personImage","image"],or(i));const s=c(t,["productImages"]);if(e!==void 0&&s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>N4(a))),h(e,["instances[0]","productImages"],o)}return n}function L4(t){const e={},n=c(t,["referenceImage"]);n!=null&&h(e,["referenceImage"],or(n));const r=c(t,["referenceId"]);r!=null&&h(e,["referenceId"],r);const i=c(t,["referenceType"]);i!=null&&h(e,["referenceType"],i);const s=c(t,["maskImageConfig"]);s!=null&&h(e,["maskImageConfig"],P4(s));const o=c(t,["controlImageConfig"]);o!=null&&h(e,["controlImageConfig"],AU(o));const a=c(t,["styleImageConfig"]);a!=null&&h(e,["styleImageConfig"],a);const l=c(t,["subjectImageConfig"]);return l!=null&&h(e,["subjectImageConfig"],l),e}function Kx(t){const e={},n=c(t,["safetyAttributes","categories"]);n!=null&&h(e,["categories"],n);const r=c(t,["safetyAttributes","scores"]);r!=null&&h(e,["scores"],r);const i=c(t,["contentType"]);return i!=null&&h(e,["contentType"],i),e}function jx(t){const e={},n=c(t,["safetyAttributes","categories"]);n!=null&&h(e,["categories"],n);const r=c(t,["safetyAttributes","scores"]);r!=null&&h(e,["scores"],r);const i=c(t,["contentType"]);return i!=null&&h(e,["contentType"],i),e}function F4(t){const e={};if(c(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=c(t,["category"]);n!=null&&h(e,["category"],n);const r=c(t,["threshold"]);return r!=null&&h(e,["threshold"],r),e}function U4(t){const e={},n=c(t,["image"]);return n!=null&&h(e,["image"],or(n)),e}function O4(t,e){const n={},r=c(t,["mode"]);e!==void 0&&r!=null&&h(e,["parameters","mode"],r);const i=c(t,["maxPredictions"]);e!==void 0&&i!=null&&h(e,["parameters","maxPredictions"],i);const s=c(t,["confidenceThreshold"]);e!==void 0&&s!=null&&h(e,["parameters","confidenceThreshold"],s);const o=c(t,["maskDilation"]);e!==void 0&&o!=null&&h(e,["parameters","maskDilation"],o);const a=c(t,["binaryColorThreshold"]);e!==void 0&&a!=null&&h(e,["parameters","binaryColorThreshold"],a);const l=c(t,["labels"]);return e!==void 0&&l!=null&&h(e,["labels"],l),n}function B4(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],Ge(t,r));const i=c(e,["source"]);i!=null&&G4(i,n);const s=c(e,["config"]);return s!=null&&O4(s,n),n}function q4(t){const e={},n=c(t,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>p4(i))),h(e,["generatedMasks"],r)}return e}function G4(t,e){const n={},r=c(t,["prompt"]);e!==void 0&&r!=null&&h(e,["instances[0]","prompt"],r);const i=c(t,["image"]);e!==void 0&&i!=null&&h(e,["instances[0]","image"],or(i));const s=c(t,["scribbleImage"]);return e!==void 0&&s!=null&&h(e,["instances[0]","scribble"],U4(s)),n}function Jx(t){const e={},n=c(t,["voiceConfig"]);if(n!=null&&h(e,["voiceConfig"],n),c(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const r=c(t,["languageCode"]);return r!=null&&h(e,["languageCode"],r),e}function $4(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(f=>f)),h(e,["functionDeclarations"],u)}if(c(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=c(t,["googleSearch"]);r!=null&&h(e,["googleSearch"],E4(r));const i=c(t,["googleSearchRetrieval"]);if(i!=null&&h(e,["googleSearchRetrieval"],i),c(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=c(t,["googleMaps"]);s!=null&&h(e,["googleMaps"],T4(s));const o=c(t,["urlContext"]);o!=null&&h(e,["urlContext"],o);const a=c(t,["computerUse"]);a!=null&&h(e,["computerUse"],a);const l=c(t,["codeExecution"]);return l!=null&&h(e,["codeExecution"],l),e}function Qx(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let m=n;Array.isArray(m)&&(m=m.map(g=>jU(g))),h(e,["functionDeclarations"],m)}const r=c(t,["retrieval"]);r!=null&&h(e,["retrieval"],r);const i=c(t,["googleSearch"]);i!=null&&h(e,["googleSearch"],i);const s=c(t,["googleSearchRetrieval"]);s!=null&&h(e,["googleSearchRetrieval"],s);const o=c(t,["enterpriseWebSearch"]);o!=null&&h(e,["enterpriseWebSearch"],o);const a=c(t,["googleMaps"]);a!=null&&h(e,["googleMaps"],a);const l=c(t,["urlContext"]);l!=null&&h(e,["urlContext"],l);const u=c(t,["computerUse"]);u!=null&&h(e,["computerUse"],u);const f=c(t,["codeExecution"]);return f!=null&&h(e,["codeExecution"],f),e}function z4(t){const e={},n=c(t,["baseModel"]);n!=null&&h(e,["baseModel"],n);const r=c(t,["createTime"]);r!=null&&h(e,["createTime"],r);const i=c(t,["updateTime"]);return i!=null&&h(e,["updateTime"],i),e}function H4(t){const e={},n=c(t,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&h(e,["baseModel"],n);const r=c(t,["createTime"]);r!=null&&h(e,["createTime"],r);const i=c(t,["updateTime"]);return i!=null&&h(e,["updateTime"],i),e}function W4(t,e){const n={},r=c(t,["displayName"]);e!==void 0&&r!=null&&h(e,["displayName"],r);const i=c(t,["description"]);e!==void 0&&i!=null&&h(e,["description"],i);const s=c(t,["defaultCheckpointId"]);return e!==void 0&&s!=null&&h(e,["defaultCheckpointId"],s),n}function K4(t,e){const n={},r=c(t,["displayName"]);e!==void 0&&r!=null&&h(e,["displayName"],r);const i=c(t,["description"]);e!==void 0&&i!=null&&h(e,["description"],i);const s=c(t,["defaultCheckpointId"]);return e!==void 0&&s!=null&&h(e,["defaultCheckpointId"],s),n}function j4(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","name"],Ge(t,r));const i=c(e,["config"]);return i!=null&&W4(i,n),n}function J4(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],Ge(t,r));const i=c(e,["config"]);return i!=null&&K4(i,n),n}function Q4(t,e){const n={},r=c(t,["outputGcsUri"]);e!==void 0&&r!=null&&h(e,["parameters","storageUri"],r);const i=c(t,["includeRaiReason"]);e!==void 0&&i!=null&&h(e,["parameters","includeRaiReason"],i);const s=c(t,["outputMimeType"]);e!==void 0&&s!=null&&h(e,["parameters","outputOptions","mimeType"],s);const o=c(t,["outputCompressionQuality"]);e!==void 0&&o!=null&&h(e,["parameters","outputOptions","compressionQuality"],o);const a=c(t,["enhanceInputImage"]);e!==void 0&&a!=null&&h(e,["parameters","upscaleConfig","enhanceInputImage"],a);const l=c(t,["imagePreservationFactor"]);e!==void 0&&l!=null&&h(e,["parameters","upscaleConfig","imagePreservationFactor"],l);const u=c(t,["labels"]);e!==void 0&&u!=null&&h(e,["labels"],u);const f=c(t,["numberOfImages"]);e!==void 0&&f!=null&&h(e,["parameters","sampleCount"],f);const m=c(t,["mode"]);return e!==void 0&&m!=null&&h(e,["parameters","mode"],m),n}function Y4(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],Ge(t,r));const i=c(e,["image"]);i!=null&&h(n,["instances[0]","image"],or(i));const s=c(e,["upscaleFactor"]);s!=null&&h(n,["parameters","upscaleConfig","upscaleFactor"],s);const o=c(e,["config"]);return o!=null&&Q4(o,n),n}function X4(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>gf(s))),h(e,["generatedImages"],i)}return e}function Z4(t){const e={},n=c(t,["uri"]);n!=null&&h(e,["uri"],n);const r=c(t,["encodedVideo"]);r!=null&&h(e,["videoBytes"],ns(r));const i=c(t,["encoding"]);return i!=null&&h(e,["mimeType"],i),e}function eO(t){const e={},n=c(t,["gcsUri"]);n!=null&&h(e,["uri"],n);const r=c(t,["bytesBase64Encoded"]);r!=null&&h(e,["videoBytes"],ns(r));const i=c(t,["mimeType"]);return i!=null&&h(e,["mimeType"],i),e}function tO(t){const e={},n=c(t,["image"]);n!=null&&h(e,["_self"],or(n));const r=c(t,["maskMode"]);return r!=null&&h(e,["maskMode"],r),e}function nO(t){const e={},n=c(t,["image"]);n!=null&&h(e,["image"],_f(n));const r=c(t,["referenceType"]);return r!=null&&h(e,["referenceType"],r),e}function rO(t){const e={},n=c(t,["image"]);n!=null&&h(e,["image"],or(n));const r=c(t,["referenceType"]);return r!=null&&h(e,["referenceType"],r),e}function Yx(t){const e={},n=c(t,["uri"]);n!=null&&h(e,["uri"],n);const r=c(t,["videoBytes"]);r!=null&&h(e,["encodedVideo"],ns(r));const i=c(t,["mimeType"]);return i!=null&&h(e,["encoding"],i),e}function Xx(t){const e={},n=c(t,["uri"]);n!=null&&h(e,["gcsUri"],n);const r=c(t,["videoBytes"]);r!=null&&h(e,["bytesBase64Encoded"],ns(r));const i=c(t,["mimeType"]);return i!=null&&h(e,["mimeType"],i),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const iO="Content-Type",sO="X-Server-Timeout",oO="User-Agent",Zm="x-goog-api-client",aO="1.25.0",lO=`google-genai-sdk/${aO}`,uO="v1beta1",cO="v1beta",Uw=/^\s*data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class dO{constructor(e){var n,r;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const i={};this.clientOptions.vertexai?(i.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:uO,i.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(i.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:cO,i.baseUrl="https://generativelanguage.googleapis.com/"),i.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=i,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(i,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&r.push(e.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),n=new URL(e);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,n,r){const i=[this.getRequestUrlInternal(n)];return r&&i.push(this.getBaseResourcePath()),e!==""&&i.push(e),new URL(`${i.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,n,r);if(e.queryParams)for(const[o,a]of Object.entries(e.queryParams))i.searchParams.append(o,String(a));let s={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else s.body=e.body;return s=await this.includeExtraHttpOptionsToRequestInit(s,n,e.abortSignal),this.unaryApiCall(i,s,e.httpMethod)}patchHttpOptions(e,n){const r=JSON.parse(JSON.stringify(e));for(const[i,s]of Object.entries(n))typeof s=="object"?r[i]=Object.assign(Object.assign({},r[i]),s):s!==void 0&&(r[i]=s);return r}async requestStream(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,n,r);(!i.searchParams.has("alt")||i.searchParams.get("alt")!=="sse")&&i.searchParams.set("alt","sse");let s={};return s.body=e.body,s=await this.includeExtraHttpOptionsToRequestInit(s,n,e.abortSignal),this.streamApiCall(i,s,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,n,r){if(n&&n.timeout||r){const i=new AbortController,s=i.signal;if(n.timeout&&(n==null?void 0:n.timeout)>0){const o=setTimeout(()=>i.abort(),n.timeout);o&&typeof o.unref=="function"&&o.unref()}r&&r.addEventListener("abort",()=>{i.abort()}),e.signal=s}return n&&n.extraBody!==null&&hO(e,n.extraBody),e.headers=await this.getHeadersInternal(n),e}async unaryApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async i=>(await Ow(i),new jm(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}async streamApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async i=>(await Ow(i),this.processStreamResponse(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}processStreamResponse(e){var n;return ta(this,arguments,function*(){const i=(n=e==null?void 0:e.body)===null||n===void 0?void 0:n.getReader(),s=new TextDecoder("utf-8");if(!i)throw new Error("Response body is empty");try{let o="";for(;;){const{done:a,value:l}=yield nt(i.read());if(a){if(o.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const u=s.decode(l,{stream:!0});try{const m=JSON.parse(u);if("error"in m){const g=JSON.parse(JSON.stringify(m.error)),v=g.status,T=g.code,x=`got status: ${v}. ${JSON.stringify(m)}`;if(T>=400&&T<600)throw new pf({message:x,status:T})}}catch(m){if(m.name==="ApiError")throw m}o+=u;let f=o.match(Uw);for(;f;){const m=f[1];try{const g=new Response(m,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield nt(new jm(g)),o=o.slice(f[0].length),f=o.match(Uw)}catch(g){throw new Error(`exception parsing stream chunk ${m}. ${g}`)}}}}finally{i.releaseLock()}})}async apiCall(e,n){return fetch(e,n).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const e={},n=lO+" "+this.clientOptions.userAgentExtra;return e[oO]=n,e[Zm]=n,e[iO]="application/json",e}async getHeadersInternal(e){const n=new Headers;if(e&&e.headers){for(const[r,i]of Object.entries(e.headers))n.append(r,i);e.timeout&&e.timeout>0&&n.append(sO,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(n),n}async uploadFile(e,n){var r;const i={};n!=null&&(i.mimeType=n.mimeType,i.name=n.name,i.displayName=n.displayName),i.name&&!i.name.startsWith("files/")&&(i.name=`files/${i.name}`);const s=this.clientOptions.uploader,o=await s.stat(e);i.sizeBytes=String(o.size);const a=(r=n==null?void 0:n.mimeType)!==null&&r!==void 0?r:o.type;if(a===void 0||a==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");i.mimeType=a;const l=await this.fetchUploadUrl(i,n);return s.upload(e,l,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,n){var r;let i={};n!=null&&n.httpOptions?i=n.httpOptions:i={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};const s={file:e},o=await this.request({path:de("upload/v1beta/files",s._url),body:JSON.stringify(s),httpMethod:"POST",httpOptions:i});if(!o||!(o!=null&&o.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const a=(r=o==null?void 0:o.headers)===null||r===void 0?void 0:r["x-goog-upload-url"];if(a===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return a}}async function Ow(t){var e;if(t===void 0)throw new Error("response is undefined");if(!t.ok){const n=t.status;let r;!((e=t.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?r=await t.json():r={error:{message:await t.text(),code:t.status,status:t.statusText}};const i=JSON.stringify(r);throw n>=400&&n<600?new pf({message:i,status:n}):new Error(i)}}function hO(t,e){if(!e||Object.keys(e).length===0)return;if(t.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let n={};if(typeof t.body=="string"&&t.body.length>0)try{const s=JSON.parse(t.body);if(typeof s=="object"&&s!==null&&!Array.isArray(s))n=s;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function r(s,o){const a=Object.assign({},s);for(const l in o)if(Object.prototype.hasOwnProperty.call(o,l)){const u=o[l],f=a[l];u&&typeof u=="object"&&!Array.isArray(u)&&f&&typeof f=="object"&&!Array.isArray(f)?a[l]=r(f,u):(f&&u&&typeof f!=typeof u&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${l}". Original type: ${typeof f}, New type: ${typeof u}. Overwriting.`),a[l]=u)}return a}const i=r(n,e);t.body=JSON.stringify(i)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const fO="mcp_used/unknown";let pO=!1;function Zx(t){for(const e of t)if(mO(e)||typeof e=="object"&&"inputSchema"in e)return!0;return pO}function eR(t){var e;const n=(e=t[Zm])!==null&&e!==void 0?e:"";t[Zm]=(n+` ${fO}`).trimStart()}function mO(t){return t!==null&&typeof t=="object"&&t instanceof sy}function gO(t,e=100){return ta(this,arguments,function*(){let r,i=0;for(;i<e;){const s=yield nt(t.listTools({cursor:r}));for(const o of s.tools)yield yield nt(o),i++;if(!s.nextCursor)break;r=s.nextCursor}})}class sy{constructor(e=[],n){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=n}static create(e,n){return new sy(e,n)}async initialize(){var e,n,r,i;if(this.mcpTools.length>0)return;const s={},o=[];for(const f of this.mcpClients)try{for(var a=!0,l=(n=void 0,Jl(gO(f))),u;u=await l.next(),e=u.done,!e;a=!0){i=u.value,a=!1;const m=i;o.push(m);const g=m.name;if(s[g])throw new Error(`Duplicate function name ${g} found in MCP tools. Please ensure function names are unique.`);s[g]=f}}catch(m){n={error:m}}finally{try{!a&&!e&&(r=l.return)&&await r.call(l)}finally{if(n)throw n.error}}this.mcpTools=o,this.functionNameToMcpClient=s}async tool(){return await this.initialize(),EL(this.mcpTools,this.config)}async callTool(e){await this.initialize();const n=[];for(const r of e)if(r.name in this.functionNameToMcpClient){const i=this.functionNameToMcpClient[r.name];let s;this.config.timeout&&(s={timeout:this.config.timeout});const o=await i.callTool({name:r.name,arguments:r.args},void 0,s);n.push({functionResponse:{name:r.name,response:o.isError?{error:o}:o}})}return n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function _O(t,e,n){const r=new fL;let i;n.data instanceof Blob?i=JSON.parse(await n.data.text()):i=JSON.parse(n.data),Object.assign(r,i),e(r)}class yO{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r}async connect(e){var n,r;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const i=this.apiClient.getWebsocketBaseUrl(),s=this.apiClient.getApiVersion(),o=EO(this.apiClient.getDefaultHeaders()),a=this.apiClient.getApiKey(),l=`${i}/ws/google.ai.generativelanguage.${s}.GenerativeService.BidiGenerateMusic?key=${a}`;let u=()=>{};const f=new Promise(P=>{u=P}),m=e.callbacks,g=function(){u({})},v=this.apiClient,T={onopen:g,onmessage:P=>{_O(v,m.onmessage,P)},onerror:(n=m==null?void 0:m.onerror)!==null&&n!==void 0?n:function(P){},onclose:(r=m==null?void 0:m.onclose)!==null&&r!==void 0?r:function(P){}},x=this.webSocketFactory.create(l,TO(o),T);x.connect(),await f;const w={setup:{model:Ge(this.apiClient,e.model)}};return x.send(JSON.stringify(w)),new vO(x,this.apiClient)}}class vO{constructor(e,n){this.conn=e,this.apiClient=n}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const n=cU(e);this.conn.send(JSON.stringify({clientContent:n}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const n=uU(e);this.conn.send(JSON.stringify(n))}sendPlaybackControl(e){const n={playbackControl:e};this.conn.send(JSON.stringify(n))}play(){this.sendPlaybackControl($o.PLAY)}pause(){this.sendPlaybackControl($o.PAUSE)}stop(){this.sendPlaybackControl($o.STOP)}resetContext(){this.sendPlaybackControl($o.RESET_CONTEXT)}close(){this.conn.close()}}function TO(t){const e={};return t.forEach((n,r)=>{e[r]=n}),e}function EO(t){const e=new Headers;for(const[n,r]of Object.entries(t))e.append(n,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const wO="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function IO(t,e,n){const r=new hL;let i;n.data instanceof Blob?i=await n.data.text():n.data instanceof ArrayBuffer?i=new TextDecoder().decode(n.data):i=n.data;const s=JSON.parse(i);if(t.isVertexAI()){const o=fU(s);Object.assign(r,o)}else Object.assign(r,s);e(r)}class SO{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r,this.music=new yO(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var n,r,i,s,o,a;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const l=this.apiClient.getWebsocketBaseUrl(),u=this.apiClient.getApiVersion();let f;const m=this.apiClient.getHeaders();e.config&&e.config.tools&&Zx(e.config.tools)&&eR(m);const g=RO(m);if(this.apiClient.isVertexAI())f=`${l}/ws/google.cloud.aiplatform.${u}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(g);else{const A=this.apiClient.getApiKey();let k="BidiGenerateContent",b="key";A!=null&&A.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),u!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),k="BidiGenerateContentConstrained",b="access_token"),f=`${l}/ws/google.ai.generativelanguage.${u}.GenerativeService.${k}?${b}=${A}`}let v=()=>{};const T=new Promise(A=>{v=A}),x=e.callbacks,D=function(){var A;(A=x==null?void 0:x.onopen)===null||A===void 0||A.call(x),v({})},C=this.apiClient,w={onopen:D,onmessage:A=>{IO(C,x.onmessage,A)},onerror:(n=x==null?void 0:x.onerror)!==null&&n!==void 0?n:function(A){},onclose:(r=x==null?void 0:x.onclose)!==null&&r!==void 0?r:function(A){}},P=this.webSocketFactory.create(f,xO(g),w);P.connect(),await T;let V=Ge(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&V.startsWith("publishers/")){const A=this.apiClient.getProject(),k=this.apiClient.getLocation();V=`projects/${A}/locations/${k}/`+V}let O={};this.apiClient.isVertexAI()&&((i=e.config)===null||i===void 0?void 0:i.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[Th.AUDIO]}:e.config.responseModalities=[Th.AUDIO]),!((s=e.config)===null||s===void 0)&&s.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const B=(a=(o=e.config)===null||o===void 0?void 0:o.tools)!==null&&a!==void 0?a:[],E=[];for(const A of B)if(this.isCallableTool(A)){const k=A;E.push(await k.tool())}else E.push(A);E.length>0&&(e.config.tools=E);const I={model:V,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?O=lU(this.apiClient,I):O=aU(this.apiClient,I),delete O.config,P.send(JSON.stringify(O)),new AO(P,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const CO={turnComplete:!0};class AO{constructor(e,n){this.conn=e,this.apiClient=n}tLiveClientContent(e,n){if(n.turns!==null&&n.turns!==void 0){let r=[];try{r=$n(n.turns),e.isVertexAI()||(r=r.map(i=>mf(i)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:r,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(e,n){let r=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?r=n.functionResponses:r=[n.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const s of r){if(typeof s!="object"||s===null||!("name"in s)||!("response"in s))throw new Error(`Could not parse function response, type '${typeof s}'.`);if(!e.isVertexAI()&&!("id"in s))throw new Error(wO)}return{toolResponse:{functionResponses:r}}}sendClientContent(e){e=Object.assign(Object.assign({},CO),e);const n=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(n))}sendRealtimeInput(e){let n={};this.apiClient.isVertexAI()?n={realtimeInput:hU(e)}:n={realtimeInput:dU(e)},this.conn.send(JSON.stringify(n))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function xO(t){const e={};return t.forEach((n,r)=>{e[r]=n}),e}function RO(t){const e=new Headers;for(const[n,r]of Object.entries(t))e.append(n,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Bw=10;function qw(t){var e,n,r;if(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let i=!1;for(const o of(n=t==null?void 0:t.tools)!==null&&n!==void 0?n:[])if(na(o)){i=!0;break}if(!i)return!0;const s=(r=t==null?void 0:t.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls;return s&&(s<0||!Number.isInteger(s))||s==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",s),!0):!1}function na(t){return"callTool"in t&&typeof t.callTool=="function"}function PO(t){var e,n,r;return(r=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(i=>na(i)))!==null&&r!==void 0?r:!1}function kO(t){var e,n,r;return(r=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(i=>!na(i)))!==null&&r!==void 0?r:!1}function Gw(t){var e;return!(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class NO extends oo{constructor(e){super(),this.apiClient=e,this.generateContent=async n=>{var r,i,s,o,a;const l=await this.processParamsMaybeAddMcpUsage(n);if(this.maybeMoveToResponseJsonSchem(n),!PO(n)||qw(n.config))return await this.generateContentInternal(l);if(kO(n))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");let u,f;const m=$n(l.contents),g=(s=(i=(r=l.config)===null||r===void 0?void 0:r.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&s!==void 0?s:Bw;let v=0;for(;v<g&&(u=await this.generateContentInternal(l),!(!u.functionCalls||u.functionCalls.length===0));){const T=u.candidates[0].content,x=[];for(const D of(a=(o=n.config)===null||o===void 0?void 0:o.tools)!==null&&a!==void 0?a:[])if(na(D)){const w=await D.callTool(u.functionCalls);x.push(...w)}v++,f={role:"user",parts:x},l.contents=$n(l.contents),l.contents.push(T),l.contents.push(f),Gw(l.config)&&(m.push(T),m.push(f))}return Gw(l.config)&&(u.automaticFunctionCallingHistory=m),u},this.generateContentStream=async n=>{if(this.maybeMoveToResponseJsonSchem(n),qw(n.config)){const r=await this.processParamsMaybeAddMcpUsage(n);return await this.generateContentStreamInternal(r)}else return await this.processAfcStream(n)},this.generateImages=async n=>await this.generateImagesInternal(n).then(r=>{var i;let s;const o=[];if(r!=null&&r.generatedImages)for(const l of r.generatedImages)l&&(l!=null&&l.safetyAttributes)&&((i=l==null?void 0:l.safetyAttributes)===null||i===void 0?void 0:i.contentType)==="Positive Prompt"?s=l==null?void 0:l.safetyAttributes:o.push(l);let a;return s?a={generatedImages:o,positivePromptSafetyAttributes:s,sdkHttpResponse:r.sdkHttpResponse}:a={generatedImages:o,sdkHttpResponse:r.sdkHttpResponse},a}),this.list=async n=>{var r;const o={config:Object.assign(Object.assign({},{queryBase:!0}),n==null?void 0:n.config)};if(this.apiClient.isVertexAI()&&!o.config.queryBase){if(!((r=o.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");o.config.filter="labels.tune-type:*"}return new ec(to.PAGED_ITEM_MODELS,a=>this.listInternal(a),await this.listInternal(o),o)},this.editImage=async n=>{const r={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(r.referenceImages=n.referenceImages.map(i=>i.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async n=>{let r={numberOfImages:1,mode:"upscale"};n.config&&(r=Object.assign(Object.assign({},r),n.config));const i={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:r};return await this.upscaleImageInternal(i)},this.generateVideos=async n=>{var r,i,s,o,a,l;if((n.prompt||n.image||n.video)&&n.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((r=n.video)===null||r===void 0)&&r.uri&&(!((i=n.video)===null||i===void 0)&&i.videoBytes)?n.video={uri:n.video.uri,mimeType:n.video.mimeType}:!((o=(s=n.source)===null||s===void 0?void 0:s.video)===null||o===void 0)&&o.uri&&(!((l=(a=n.source)===null||a===void 0?void 0:a.video)===null||l===void 0)&&l.videoBytes)&&(n.source.video={uri:n.source.video.uri,mimeType:n.source.video.mimeType})),await this.generateVideosInternal(n)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var n,r,i;const s=(n=e.config)===null||n===void 0?void 0:n.tools;if(!s)return e;const o=await Promise.all(s.map(async l=>na(l)?await l.tool():l)),a={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:o})};if(a.config.tools=o,e.config&&e.config.tools&&Zx(e.config.tools)){const l=(i=(r=e.config.httpOptions)===null||r===void 0?void 0:r.headers)!==null&&i!==void 0?i:{};let u=Object.assign({},l);Object.keys(u).length===0&&(u=this.apiClient.getDefaultHeaders()),eR(u),a.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:u})}return a}async initAfcToolsMap(e){var n,r,i;const s=new Map;for(const o of(r=(n=e.config)===null||n===void 0?void 0:n.tools)!==null&&r!==void 0?r:[])if(na(o)){const a=o,l=await a.tool();for(const u of(i=l.functionDeclarations)!==null&&i!==void 0?i:[]){if(!u.name)throw new Error("Function declaration name is required.");if(s.has(u.name))throw new Error(`Duplicate tool declaration name: ${u.name}`);s.set(u.name,a)}}return s}async processAfcStream(e){var n,r,i;const s=(i=(r=(n=e.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&i!==void 0?i:Bw;let o=!1,a=0;const l=await this.initAfcToolsMap(e);return function(u,f,m){var g,v;return ta(this,arguments,function*(){for(var T,x,D,C;a<s;){o&&(a++,o=!1);const O=yield nt(u.processParamsMaybeAddMcpUsage(m)),B=yield nt(u.generateContentStreamInternal(O)),E=[],I=[];try{for(var w=!0,P=(x=void 0,Jl(B)),V;V=yield nt(P.next()),T=V.done,!T;w=!0){C=V.value,w=!1;const A=C;if(yield yield nt(A),A.candidates&&(!((g=A.candidates[0])===null||g===void 0)&&g.content)){I.push(A.candidates[0].content);for(const k of(v=A.candidates[0].content.parts)!==null&&v!==void 0?v:[])if(a<s&&k.functionCall){if(!k.functionCall.name)throw new Error("Function call name was not returned by the model.");if(f.has(k.functionCall.name)){const b=yield nt(f.get(k.functionCall.name).callTool([k.functionCall]));E.push(...b)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${f.keys()}, mising tool: ${k.functionCall.name}`)}}}}catch(A){x={error:A}}finally{try{!w&&!T&&(D=P.return)&&(yield nt(D.call(P)))}finally{if(x)throw x.error}}if(E.length>0){o=!0;const A=new vl;A.candidates=[{content:{role:"user",parts:E}}],yield yield nt(A);const k=[];k.push(...I),k.push({role:"user",parts:E});const b=$n(m.contents).concat(k);m.contents=b}else break}})}(this,l,e)}async generateContentInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=Vw(this.apiClient,e);return a=de("{model}:generateContent",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=Fw(f),g=new vl;return Object.assign(g,m),g})}else{const u=Mw(this.apiClient,e);return a=de("{model}:generateContent",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=Lw(f),g=new vl;return Object.assign(g,m),g})}}async generateContentStreamInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=Vw(this.apiClient,e);return a=de("{model}:streamGenerateContent?alt=sse",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.requestStream({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}),o.then(function(m){return ta(this,arguments,function*(){var g,v,T,x;try{for(var D=!0,C=Jl(m),w;w=yield nt(C.next()),g=w.done,!g;D=!0){x=w.value,D=!1;const P=x,V=Fw(yield nt(P.json()));V.sdkHttpResponse={headers:P.headers};const O=new vl;Object.assign(O,V),yield yield nt(O)}}catch(P){v={error:P}}finally{try{!D&&!g&&(T=C.return)&&(yield nt(T.call(C)))}finally{if(v)throw v.error}}})})}else{const u=Mw(this.apiClient,e);return a=de("{model}:streamGenerateContent?alt=sse",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.requestStream({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}),o.then(function(m){return ta(this,arguments,function*(){var g,v,T,x;try{for(var D=!0,C=Jl(m),w;w=yield nt(C.next()),g=w.done,!g;D=!0){x=w.value,D=!1;const P=x,V=Lw(yield nt(P.json()));V.sdkHttpResponse={headers:P.headers};const O=new vl;Object.assign(O,V),yield yield nt(O)}}catch(P){v={error:P}}finally{try{!D&&!g&&(T=C.return)&&(yield nt(T.call(C)))}finally{if(v)throw v.error}}})})}}async embedContent(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=$U(this.apiClient,e);return a=de("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=HU(f),g=new yw;return Object.assign(g,m),g})}else{const u=GU(this.apiClient,e);return a=de("{model}:batchEmbedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=zU(f),g=new yw;return Object.assign(g,m),g})}}async generateImagesInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=e4(this.apiClient,e);return a=de("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=n4(f),g=new vw;return Object.assign(g,m),g})}else{const u=ZU(this.apiClient,e);return a=de("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=t4(f),g=new vw;return Object.assign(g,m),g})}}async editImageInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=UU(this.apiClient,e);return s=de("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>{const u=OU(l),f=new iL;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=Y4(this.apiClient,e);return s=de("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>{const u=X4(l),f=new sL;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=b4(this.apiClient,e);return s=de("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=M4(l),f=new oL;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=B4(this.apiClient,e);return s=de("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=q4(l),f=new aL;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=v4(this.apiClient,e);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>Xm(f))}else{const u=y4(this.apiClient,e);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>Ym(f))}}async listInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=A4(this.apiClient,e);return a=de("{models_url}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=R4(f),g=new Tw;return Object.assign(g,m),g})}else{const u=C4(this.apiClient,e);return a=de("{models_url}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=x4(f),g=new Tw;return Object.assign(g,m),g})}}async update(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=J4(this.apiClient,e);return a=de("{model}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>Xm(f))}else{const u=j4(this.apiClient,e);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>Ym(f))}}async delete(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=MU(this.apiClient,e);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=LU(f),g=new Ew;return Object.assign(g,m),g})}else{const u=bU(this.apiClient,e);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=VU(f),g=new Ew;return Object.assign(g,m),g})}}async countTokens(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=kU(this.apiClient,e);return a=de("{model}:countTokens",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=DU(f),g=new ww;return Object.assign(g,m),g})}else{const u=PU(this.apiClient,e);return a=de("{model}:countTokens",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=NU(f),g=new ww;return Object.assign(g,m),g})}}async computeTokens(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=wU(this.apiClient,e);return s=de("{model}:computeTokens",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>{const u=IU(l),f=new lL;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=l4(this.apiClient,e);return a=de("{model}:predictLongRunning",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>{const m=o4(f),g=new Eh;return Object.assign(g,m),g})}else{const u=a4(this.apiClient,e);return a=de("{model}:predictLongRunning",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>{const m=s4(f),g=new Eh;return Object.assign(g,m),g})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class DO extends oo{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const n=e.operation,r=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=n.name.split("/operations/")[0];let s;r&&"httpOptions"in r&&(s=r.httpOptions);const o=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:i,config:{httpOptions:s}});return n._fromAPIResponse({apiResponse:o,isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:i,isVertexAI:!1})}}async get(e){const n=e.operation,r=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=n.name.split("/operations/")[0];let s;r&&"httpOptions"in r&&(s=r.httpOptions);const o=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:i,config:{httpOptions:s}});return n._fromAPIResponse({apiResponse:o,isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:i,isVertexAI:!1})}}async getVideosOperationInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=tL(e);return a=de("{operationName}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o}else{const u=eL(e);return a=de("{operationName}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o}}async fetchPredictVideosOperationInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=KV(e);return s=de("{resourceName}:fetchPredictOperation",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function bO(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["data"]);n!=null&&h(e,["data"],n);const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function MO(t){const e={},n=c(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>GO(s))),h(e,["parts"],i)}const r=c(t,["role"]);return r!=null&&h(e,["role"],r),e}function VO(t,e,n){const r={},i=c(e,["expireTime"]);n!==void 0&&i!=null&&h(n,["expireTime"],i);const s=c(e,["newSessionExpireTime"]);n!==void 0&&s!=null&&h(n,["newSessionExpireTime"],s);const o=c(e,["uses"]);n!==void 0&&o!=null&&h(n,["uses"],o);const a=c(e,["liveConnectConstraints"]);n!==void 0&&a!=null&&h(n,["bidiGenerateContentSetup"],qO(t,a));const l=c(e,["lockAdditionalFields"]);return n!==void 0&&l!=null&&h(n,["fieldMask"],l),r}function LO(t,e){const n={},r=c(e,["config"]);return r!=null&&h(n,["config"],VO(t,r,n)),n}function FO(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["fileUri"]);n!=null&&h(e,["fileUri"],n);const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function UO(t){const e={};if(c(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=c(t,["enableWidget"]);return n!=null&&h(e,["enableWidget"],n),e}function OO(t){const e={},n=c(t,["timeRangeFilter"]);if(n!=null&&h(e,["timeRangeFilter"],n),c(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function BO(t,e){const n={},r=c(t,["generationConfig"]);e!==void 0&&r!=null&&h(e,["setup","generationConfig"],r);const i=c(t,["responseModalities"]);e!==void 0&&i!=null&&h(e,["setup","generationConfig","responseModalities"],i);const s=c(t,["temperature"]);e!==void 0&&s!=null&&h(e,["setup","generationConfig","temperature"],s);const o=c(t,["topP"]);e!==void 0&&o!=null&&h(e,["setup","generationConfig","topP"],o);const a=c(t,["topK"]);e!==void 0&&a!=null&&h(e,["setup","generationConfig","topK"],a);const l=c(t,["maxOutputTokens"]);e!==void 0&&l!=null&&h(e,["setup","generationConfig","maxOutputTokens"],l);const u=c(t,["mediaResolution"]);e!==void 0&&u!=null&&h(e,["setup","generationConfig","mediaResolution"],u);const f=c(t,["seed"]);e!==void 0&&f!=null&&h(e,["setup","generationConfig","seed"],f);const m=c(t,["speechConfig"]);e!==void 0&&m!=null&&h(e,["setup","generationConfig","speechConfig"],iy(m));const g=c(t,["thinkingConfig"]);e!==void 0&&g!=null&&h(e,["setup","generationConfig","thinkingConfig"],g);const v=c(t,["enableAffectiveDialog"]);e!==void 0&&v!=null&&h(e,["setup","generationConfig","enableAffectiveDialog"],v);const T=c(t,["systemInstruction"]);e!==void 0&&T!=null&&h(e,["setup","systemInstruction"],MO(Yt(T)));const x=c(t,["tools"]);if(e!==void 0&&x!=null){let B=La(x);Array.isArray(B)&&(B=B.map(E=>zO(Va(E)))),h(e,["setup","tools"],B)}const D=c(t,["sessionResumption"]);e!==void 0&&D!=null&&h(e,["setup","sessionResumption"],$O(D));const C=c(t,["inputAudioTranscription"]);e!==void 0&&C!=null&&h(e,["setup","inputAudioTranscription"],C);const w=c(t,["outputAudioTranscription"]);e!==void 0&&w!=null&&h(e,["setup","outputAudioTranscription"],w);const P=c(t,["realtimeInputConfig"]);e!==void 0&&P!=null&&h(e,["setup","realtimeInputConfig"],P);const V=c(t,["contextWindowCompression"]);e!==void 0&&V!=null&&h(e,["setup","contextWindowCompression"],V);const O=c(t,["proactivity"]);return e!==void 0&&O!=null&&h(e,["setup","proactivity"],O),n}function qO(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["setup","model"],Ge(t,r));const i=c(e,["config"]);return i!=null&&h(n,["config"],BO(i,n)),n}function GO(t){const e={},n=c(t,["videoMetadata"]);n!=null&&h(e,["videoMetadata"],n);const r=c(t,["thought"]);r!=null&&h(e,["thought"],r);const i=c(t,["inlineData"]);i!=null&&h(e,["inlineData"],bO(i));const s=c(t,["fileData"]);s!=null&&h(e,["fileData"],FO(s));const o=c(t,["thoughtSignature"]);o!=null&&h(e,["thoughtSignature"],o);const a=c(t,["functionCall"]);a!=null&&h(e,["functionCall"],a);const l=c(t,["codeExecutionResult"]);l!=null&&h(e,["codeExecutionResult"],l);const u=c(t,["executableCode"]);u!=null&&h(e,["executableCode"],u);const f=c(t,["functionResponse"]);f!=null&&h(e,["functionResponse"],f);const m=c(t,["text"]);return m!=null&&h(e,["text"],m),e}function $O(t){const e={},n=c(t,["handle"]);if(n!=null&&h(e,["handle"],n),c(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function zO(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(f=>f)),h(e,["functionDeclarations"],u)}if(c(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=c(t,["googleSearch"]);r!=null&&h(e,["googleSearch"],OO(r));const i=c(t,["googleSearchRetrieval"]);if(i!=null&&h(e,["googleSearchRetrieval"],i),c(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=c(t,["googleMaps"]);s!=null&&h(e,["googleMaps"],UO(s));const o=c(t,["urlContext"]);o!=null&&h(e,["urlContext"],o);const a=c(t,["computerUse"]);a!=null&&h(e,["computerUse"],a);const l=c(t,["codeExecution"]);return l!=null&&h(e,["codeExecution"],l),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function HO(t){const e=[];for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const r=t[n];if(typeof r=="object"&&r!=null&&Object.keys(r).length>0){const i=Object.keys(r).map(s=>`${n}.${s}`);e.push(...i)}else e.push(n)}return e.join(",")}function WO(t,e){let n=null;const r=t.bidiGenerateContentSetup;if(typeof r=="object"&&r!==null&&"setup"in r){const s=r.setup;typeof s=="object"&&s!==null?(t.bidiGenerateContentSetup=s,n=s):delete t.bidiGenerateContentSetup}else r!==void 0&&delete t.bidiGenerateContentSetup;const i=t.fieldMask;if(n){const s=HO(n);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)s?t.fieldMask=s:delete t.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&i!==null&&Array.isArray(i)&&i.length>0){const o=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let a=[];i.length>0&&(a=i.map(u=>o.includes(u)?`generationConfig.${u}`:u));const l=[];s&&l.push(s),a.length>0&&l.push(...a),l.length>0?t.fieldMask=l.join(","):delete t.fieldMask}else delete t.fieldMask}else i!==null&&Array.isArray(i)&&i.length>0?t.fieldMask=i.join(","):delete t.fieldMask;return t}class KO extends oo{constructor(e){super(),this.apiClient=e}async create(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const a=LO(this.apiClient,e);s=de("auth_tokens",a._url),o=a._query,delete a.config,delete a._url,delete a._query;const l=WO(a,e.config);return i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>u)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function jO(t){const e={},n=c(t,["name"]);return n!=null&&h(e,["_url","name"],n),e}function JO(t){const e={},n=c(t,["name"]);return n!=null&&h(e,["_url","name"],n),e}function QO(t,e){const n={};if(c(t,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const r=c(t,["tunedModelDisplayName"]);if(e!==void 0&&r!=null&&h(e,["displayName"],r),c(t,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const i=c(t,["epochCount"]);e!==void 0&&i!=null&&h(e,["tuningTask","hyperparameters","epochCount"],i);const s=c(t,["learningRateMultiplier"]);if(s!=null&&h(n,["tuningTask","hyperparameters","learningRateMultiplier"],s),c(t,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(c(t,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(c(t,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const o=c(t,["batchSize"]);e!==void 0&&o!=null&&h(e,["tuningTask","hyperparameters","batchSize"],o);const a=c(t,["learningRate"]);if(e!==void 0&&a!=null&&h(e,["tuningTask","hyperparameters","learningRate"],a),c(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");return n}function YO(t,e){const n={},r=c(t,["validationDataset"]);e!==void 0&&r!=null&&h(e,["supervisedTuningSpec"],h3(r,n));const i=c(t,["tunedModelDisplayName"]);e!==void 0&&i!=null&&h(e,["tunedModelDisplayName"],i);const s=c(t,["description"]);e!==void 0&&s!=null&&h(e,["description"],s);const o=c(t,["epochCount"]);e!==void 0&&o!=null&&h(e,["supervisedTuningSpec","hyperParameters","epochCount"],o);const a=c(t,["learningRateMultiplier"]);e!==void 0&&a!=null&&h(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],a);const l=c(t,["exportLastCheckpointOnly"]);e!==void 0&&l!=null&&h(e,["supervisedTuningSpec","exportLastCheckpointOnly"],l);const u=c(t,["adapterSize"]);if(e!==void 0&&u!=null&&h(e,["supervisedTuningSpec","hyperParameters","adapterSize"],u),c(t,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(c(t,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const f=c(t,["labels"]);return e!==void 0&&f!=null&&h(e,["labels"],f),n}function XO(t){const e={},n=c(t,["baseModel"]);n!=null&&h(e,["baseModel"],n);const r=c(t,["preTunedModel"]);r!=null&&h(e,["preTunedModel"],r);const i=c(t,["trainingDataset"]);i!=null&&h(e,["tuningTask","trainingData"],u3(i));const s=c(t,["config"]);return s!=null&&QO(s,e),e}function ZO(t){const e={},n=c(t,["baseModel"]);n!=null&&h(e,["baseModel"],n);const r=c(t,["preTunedModel"]);r!=null&&h(e,["preTunedModel"],r);const i=c(t,["trainingDataset"]);i!=null&&h(e,["supervisedTuningSpec","trainingDatasetUri"],c3(i,e));const s=c(t,["config"]);return s!=null&&YO(s,e),e}function e3(t){const e={},n=c(t,["name"]);return n!=null&&h(e,["_url","name"],n),e}function t3(t){const e={},n=c(t,["name"]);return n!=null&&h(e,["_url","name"],n),e}function n3(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&h(e,["_query","pageSize"],r);const i=c(t,["pageToken"]);e!==void 0&&i!=null&&h(e,["_query","pageToken"],i);const s=c(t,["filter"]);return e!==void 0&&s!=null&&h(e,["_query","filter"],s),n}function r3(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&h(e,["_query","pageSize"],r);const i=c(t,["pageToken"]);e!==void 0&&i!=null&&h(e,["_query","pageToken"],i);const s=c(t,["filter"]);return e!==void 0&&s!=null&&h(e,["_query","filter"],s),n}function i3(t){const e={},n=c(t,["config"]);return n!=null&&n3(n,e),e}function s3(t){const e={},n=c(t,["config"]);return n!=null&&r3(n,e),e}function o3(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=c(t,["tunedModels"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>tR(o))),h(e,["tuningJobs"],s)}return e}function a3(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=c(t,["tuningJobs"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>eg(o))),h(e,["tuningJobs"],s)}return e}function l3(t){const e={},n=c(t,["name"]);n!=null&&h(e,["model"],n);const r=c(t,["name"]);return r!=null&&h(e,["endpoint"],r),e}function u3(t){const e={};if(c(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(c(t,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const n=c(t,["examples"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>i)),h(e,["examples","examples"],r)}return e}function c3(t,e){const n={},r=c(t,["gcsUri"]);e!==void 0&&r!=null&&h(e,["supervisedTuningSpec","trainingDatasetUri"],r);const i=c(t,["vertexDatasetResource"]);if(e!==void 0&&i!=null&&h(e,["supervisedTuningSpec","trainingDatasetUri"],i),c(t,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return n}function tR(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["name"]);r!=null&&h(e,["name"],r);const i=c(t,["state"]);i!=null&&h(e,["state"],Lx(i));const s=c(t,["createTime"]);s!=null&&h(e,["createTime"],s);const o=c(t,["tuningTask","startTime"]);o!=null&&h(e,["startTime"],o);const a=c(t,["tuningTask","completeTime"]);a!=null&&h(e,["endTime"],a);const l=c(t,["updateTime"]);l!=null&&h(e,["updateTime"],l);const u=c(t,["description"]);u!=null&&h(e,["description"],u);const f=c(t,["baseModel"]);f!=null&&h(e,["baseModel"],f);const m=c(t,["_self"]);m!=null&&h(e,["tunedModel"],l3(m));const g=c(t,["customBaseModel"]);g!=null&&h(e,["customBaseModel"],g);const v=c(t,["experiment"]);v!=null&&h(e,["experiment"],v);const T=c(t,["labels"]);T!=null&&h(e,["labels"],T);const x=c(t,["outputUri"]);x!=null&&h(e,["outputUri"],x);const D=c(t,["pipelineJob"]);D!=null&&h(e,["pipelineJob"],D);const C=c(t,["serviceAccount"]);C!=null&&h(e,["serviceAccount"],C);const w=c(t,["tunedModelDisplayName"]);w!=null&&h(e,["tunedModelDisplayName"],w);const P=c(t,["veoTuningSpec"]);return P!=null&&h(e,["veoTuningSpec"],P),e}function eg(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["name"]);r!=null&&h(e,["name"],r);const i=c(t,["state"]);i!=null&&h(e,["state"],Lx(i));const s=c(t,["createTime"]);s!=null&&h(e,["createTime"],s);const o=c(t,["startTime"]);o!=null&&h(e,["startTime"],o);const a=c(t,["endTime"]);a!=null&&h(e,["endTime"],a);const l=c(t,["updateTime"]);l!=null&&h(e,["updateTime"],l);const u=c(t,["error"]);u!=null&&h(e,["error"],u);const f=c(t,["description"]);f!=null&&h(e,["description"],f);const m=c(t,["baseModel"]);m!=null&&h(e,["baseModel"],m);const g=c(t,["tunedModel"]);g!=null&&h(e,["tunedModel"],g);const v=c(t,["preTunedModel"]);v!=null&&h(e,["preTunedModel"],v);const T=c(t,["supervisedTuningSpec"]);T!=null&&h(e,["supervisedTuningSpec"],T);const x=c(t,["tuningDataStats"]);x!=null&&h(e,["tuningDataStats"],x);const D=c(t,["encryptionSpec"]);D!=null&&h(e,["encryptionSpec"],D);const C=c(t,["partnerModelTuningSpec"]);C!=null&&h(e,["partnerModelTuningSpec"],C);const w=c(t,["customBaseModel"]);w!=null&&h(e,["customBaseModel"],w);const P=c(t,["experiment"]);P!=null&&h(e,["experiment"],P);const V=c(t,["labels"]);V!=null&&h(e,["labels"],V);const O=c(t,["outputUri"]);O!=null&&h(e,["outputUri"],O);const B=c(t,["pipelineJob"]);B!=null&&h(e,["pipelineJob"],B);const E=c(t,["serviceAccount"]);E!=null&&h(e,["serviceAccount"],E);const I=c(t,["tunedModelDisplayName"]);I!=null&&h(e,["tunedModelDisplayName"],I);const A=c(t,["veoTuningSpec"]);return A!=null&&h(e,["veoTuningSpec"],A),e}function d3(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["name"]);r!=null&&h(e,["name"],r);const i=c(t,["metadata"]);i!=null&&h(e,["metadata"],i);const s=c(t,["done"]);s!=null&&h(e,["done"],s);const o=c(t,["error"]);return o!=null&&h(e,["error"],o),e}function h3(t,e){const n={},r=c(t,["gcsUri"]);r!=null&&h(n,["validationDatasetUri"],r);const i=c(t,["vertexDatasetResource"]);return e!==void 0&&i!=null&&h(e,["supervisedTuningSpec","trainingDatasetUri"],i),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class f3 extends oo{constructor(e){super(),this.apiClient=e,this.get=async n=>await this.getInternal(n),this.list=async(n={})=>new ec(to.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(n),n),this.tune=async n=>{var r;if(this.apiClient.isVertexAI())if(n.baseModel.startsWith("projects/")){const i={tunedModelName:n.baseModel};!((r=n.config)===null||r===void 0)&&r.preTunedModelCheckpointId&&(i.checkpointId=n.config.preTunedModelCheckpointId);const s=Object.assign(Object.assign({},n),{preTunedModel:i});return s.baseModel=void 0,await this.tuneInternal(s)}else{const i=Object.assign({},n);return await this.tuneInternal(i)}else{const i=Object.assign({},n),s=await this.tuneMldevInternal(i);let o="";return s.metadata!==void 0&&s.metadata.tunedModel!==void 0?o=s.metadata.tunedModel:s.name!==void 0&&s.name.includes("/operations/")&&(o=s.name.split("/operations/")[0]),{name:o,state:Km.JOB_STATE_QUEUED}}}}async getInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=t3(e);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>eg(f))}else{const u=e3(e);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>tR(f))}}async listInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=s3(e);return a=de("tuningJobs",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=a3(f),g=new Iw;return Object.assign(g,m),g})}else{const u=i3(e);return a=de("tunedModels",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=o3(f),g=new Iw;return Object.assign(g,m),g})}}async cancel(e){var n,r,i,s;let o="",a={};if(this.apiClient.isVertexAI()){const l=JO(e);o=de("{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}else{const l=jO(e);o=de("{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal})}}async tuneInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=ZO(e);return s=de("tuningJobs",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>eg(l))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=XO(e);return s=de("tunedModels",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>d3(l))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class p3{async download(e,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const m3=1024*1024*8,g3=3,_3=1e3,y3=2,gp="x-goog-upload-status";async function v3(t,e,n){var r,i,s;let o=0,a=0,l=new jm(new Response),u="upload";for(o=t.size;a<o;){const m=Math.min(m3,o-a),g=t.slice(a,a+m);a+m>=o&&(u+=", finalize");let v=0,T=_3;for(;v<g3&&(l=await n.request({path:"",body:g,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":u,"X-Goog-Upload-Offset":String(a),"Content-Length":String(m)}}}),!(!((r=l==null?void 0:l.headers)===null||r===void 0)&&r[gp]));)v++,await E3(T),T=T*y3;if(a+=m,((i=l==null?void 0:l.headers)===null||i===void 0?void 0:i[gp])!=="active")break;if(o<=a)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const f=await(l==null?void 0:l.json());if(((s=l==null?void 0:l.headers)===null||s===void 0?void 0:s[gp])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return f.file}async function T3(t){return{size:t.size,type:t.type}}function E3(t){return new Promise(e=>setTimeout(e,t))}class w3{async upload(e,n,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await v3(e,n,r)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await T3(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class I3{create(e,n,r){return new S3(e,n,r)}}class S3{constructor(e,n,r){this.url=e,this.headers=n,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const $w="x-goog-api-key";class C3{constructor(e){this.apiKey=e}async addAuthHeaders(e){if(e.get($w)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append($w,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const A3="gl-node/";class x3{constructor(e){var n;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=e.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=e.apiKey;const r=HV(e.httpOptions,e.vertexai,void 0,void 0);r&&(e.httpOptions?e.httpOptions.baseUrl=r:e.httpOptions={baseUrl:r}),this.apiVersion=e.apiVersion;const i=new C3(this.apiKey);this.apiClient=new dO({auth:i,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:A3+"web",uploader:new w3,downloader:new p3}),this.models=new NO(this.apiClient),this.live=new SO(this.apiClient,i,new I3),this.batches=new cF(this.apiClient),this.chats=new GF(this.models,this.apiClient),this.caches=new OF(this.apiClient),this.files=new XF(this.apiClient),this.operations=new DO(this.apiClient),this.authTokens=new KO(this.apiClient),this.tunings=new f3(this.apiClient)}}async function R3(t){var n,r,i,s;return((s=(i=(r=(n=(await Yh(`/users/${t}/data/todos`)).fields)==null?void 0:n.todos)==null?void 0:r.arrayValue)==null?void 0:i.values)==null?void 0:s.map(o=>{var a;return(a=o.mapValue)!=null&&a.fields?Ru(o.mapValue.fields):{}}))||[]}async function P3(t){var n;return((n=(await Yh(`/users/${t}/folders`)).documents)==null?void 0:n.map(r=>({id:r.name.split("/").pop(),...Ru(r.fields)})))||[]}async function k3(t,e){return((await Yh(`/users/${t}/todos`)).documents||[]).map(r=>{const i=Ru(r.fields);return i.folderId===e?{id:r.name.split("/").pop(),...i,isSharedTodo:!0}:null}).filter(Boolean)}function Ru(t){if(!t)return{};const e={};for(const[n,r]of Object.entries(t)){const i=r;i.stringValue!==void 0?e[n]=i.stringValue:i.integerValue!==void 0?e[n]=parseInt(i.integerValue):i.doubleValue!==void 0?e[n]=i.doubleValue:i.booleanValue!==void 0?e[n]=i.booleanValue:i.timestampValue!==void 0?e[n]=i.timestampValue:i.mapValue!==void 0?e[n]=Ru(i.mapValue.fields):i.arrayValue!==void 0?e[n]=(i.arrayValue.values||[]).map(Ru):e[n]=null}return e}const zw=()=>{const e=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Mobile|Tablet/i.test(navigator.userAgent),n=navigator.maxTouchPoints&&navigator.maxTouchPoints>2,r=window.innerWidth<=768;return console.log("Mobile detection:",{isUserAgentMobile:e,isTouchDevice:n,isSmallScreen:r,userAgent:navigator.userAgent}),e||n&&r},Hw=()=>window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0,xt=t=>{if(t==null)return;if(typeof t!="object")return t;if(Array.isArray(t)){const r=t.filter(i=>i!==void 0).map(i=>xt(i)).filter(i=>i!==void 0);return r.length>0?r:void 0}if(t===null)return;let e;try{e=Object.entries(t)}catch(r){console.error("❌ Object.entries 실패:",r,t);return}const n={};for(const[r,i]of e){if(i===void 0||typeof i=="string"&&i.trim()===""){console.warn(`⚠️ 필드 제거됨: ${r} = ${i}`);continue}if(typeof i=="object"&&i!==null){const s=xt(i);s!==void 0?n[r]=s:console.warn(`⚠️ 중첩 객체/배열 제거됨: ${r}`)}else n[r]=i}return Object.keys(n).length>0?n:void 0},Ww=()=>window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",nR=async()=>"Notification"in window?Notification.permission==="granted"?!0:Notification.permission!=="denied"?await Notification.requestPermission()==="granted":!1:(console.log("This browser does not support notifications"),!1),rR=async()=>{try{if(!("serviceWorker"in navigator)||!("PushManager"in window))return console.log("Push notifications not supported"),!1;const e=await(await navigator.serviceWorker.ready).pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:N3("BOEd9nQKXBj8LJXNM6LJt6Nua5MJMhF8cCQvMNJ-2NWoWsM0cGgNqDG3kNm-QMYbdMDYAXaJ55MFP_fPHqH7SFA")});return await D3(e),!0}catch(t){return console.error("Failed to subscribe to push notifications:",t),!1}},N3=t=>{const e="=".repeat((4-t.length%4)%4),n=(t+e).replace(/\-/g,"+").replace(/_/g,"/"),r=window.atob(n),i=new Uint8Array(r.length);for(let s=0;s<r.length;++s)i[s]=r.charCodeAt(s);return i},D3=async t=>{try{(await fetch("/api/subscribe",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({subscription:t.toJSON(),endpoint:t.endpoint})})).ok||console.error("Failed to send subscription to server")}catch(e){console.error("Error sending subscription to server:",e)}},b3=({onClose:t})=>{const[e,n]=z.useState(null),[r,i]=z.useState(!1);z.useEffect(()=>{const o=/iPad|iPhone|iPod/.test(navigator.userAgent);i(o);const a=l=>{l.preventDefault(),n(l)};return window.addEventListener("beforeinstallprompt",a),()=>{window.removeEventListener("beforeinstallprompt",a)}},[]);const s=async()=>{if(e){e.prompt();const{outcome:o}=await e.userChoice;o==="accepted"&&(n(null),t())}};return p.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:p.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-sm w-full",children:[p.jsxs("div",{className:"text-center mb-4",children:[p.jsx("div",{className:"w-16 h-16 bg-indigo-600 rounded-lg mx-auto mb-4 flex items-center justify-center",children:p.jsx("span",{className:"text-white text-2xl font-bold",children:"N"})}),p.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"앱으로 설치하기"}),p.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-sm",children:"Nova Beta를 홈 화면에 추가하여 더 편리하게 사용하세요."})]}),r?p.jsxs("div",{className:"mb-4",children:[p.jsx("div",{className:"bg-blue-50 dark:bg-blue-900 p-3 rounded-lg mb-3",children:p.jsx("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:"iOS에서 설치하는 방법:"})}),p.jsxs("ol",{className:"text-sm text-gray-600 dark:text-gray-300 space-y-2",children:[p.jsxs("li",{className:"flex items-center",children:[p.jsx("span",{className:"w-6 h-6 bg-indigo-600 text-white rounded-full flex items-center justify-center text-xs mr-2",children:"1"}),"하단의 공유 버튼 (□↗) 탭"]}),p.jsxs("li",{className:"flex items-center",children:[p.jsx("span",{className:"w-6 h-6 bg-indigo-600 text-white rounded-full flex items-center justify-center text-xs mr-2",children:"2"}),'"홈 화면에 추가" 선택']}),p.jsxs("li",{className:"flex items-center",children:[p.jsx("span",{className:"w-6 h-6 bg-indigo-600 text-white rounded-full flex items-center justify-center text-xs mr-2",children:"3"}),'"추가" 버튼 탭']})]})]}):p.jsx("div",{className:"mb-4",children:e?p.jsx("button",{onClick:s,className:"w-full bg-indigo-600 text-white py-2 px-4 rounded-lg hover:bg-indigo-700 transition-colors",children:"지금 설치하기"}):p.jsx("div",{className:"bg-gray-50 dark:bg-gray-700 p-3 rounded-lg",children:p.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:'브라우저 메뉴에서 "홈 화면에 추가" 또는 "앱 설치"를 선택하세요.'})})}),p.jsxs("div",{className:"flex space-x-2",children:[p.jsx("button",{onClick:t,className:"flex-1 bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-gray-200 py-2 px-4 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-500 transition-colors",children:"나중에"}),p.jsx("button",{onClick:()=>{localStorage.setItem("pwa-prompt-dismissed","true"),t()},className:"flex-1 bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-gray-200 py-2 px-4 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-500 transition-colors",children:"다시 보지 않기"})]})]})})},M3={ko:{language_selection_title:"언어",error_wish_required:"목표를 입력해주세요.",error_outcome_required:"결과를 입력해주세요.",error_obstacle_required:"장애물을 입력해주세요.",error_plan_required:"If-Then 계획을 입력해주세요.",error_deadline_required:"마감일을 선택해주세요.",error_day_required:"하나 이상의 요일을 선택해주세요.",my_goals_title:"나의 목표",all_goals_label:"나의 목표",sort_label_manual:"사용자화",sort_label_deadline:"마감일순",sort_label_newest:"최신순",sort_label_alphabetical:"이름순",sort_label_ai:"우선순위로 정렬",ai_sorting_button:"정렬 중...",add_new_goal_button_label:"새로운 목표 추가",filter_all:"나의 목표",filter_active:"진행중",filter_completed:"완료됨",filter_category:"카테고리",category_all:"모든 카테고리",category_school:"학교",category_work:"회사",category_personal:"개인",category_other:"기타",category_label:"카테고리 선택",empty_message_all:"+ 버튼으로 목표를 추가해보세요",empty_message_active:"진행중인 목표가 없습니다.",empty_message_completed:"아직 완료된 목표가 없습니다.",empty_encouragement_1:"새로운 여정의 첫 걸음을 내딛어보세요.",empty_encouragement_2:"작은 변화가 큰 성취로 이어집니다.",empty_encouragement_3:"오늘 하는 일이 내일을 만듭니다.",empty_encouragement_4:"당신의 목표가 현실이 되는 순간을 만나보세요.",delete_button:"삭제",edit_button_aria:"편집",info_button_aria:"정보",filter_title:"필터",sort_title:"정렬",filter_sort_button_aria:"필터 및 정렬",calendar_view_button_aria:"달력 보기",list_view_button_aria:"목록 보기",more_options_button_aria:"더보기",select_button_label:"선택",cancel_selection_button_label:"취소",delete_selected_button_label:"{count}개 삭제",select_all_button_label:"전체선택",delete_selected_confirm_title:"목표 삭제",delete_selected_confirm_message:"선택한 {count}개의 목표가 영구적으로 삭제됩니다. 이 작업은 되돌릴 수 없습니다.",days_left:"{count}일 남음",d_day:"오늘",days_overdue:"{count}일 지남",month_names:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],day_names_short:["일","월","화","수","목","금","토"],day_names_long:["일요일","월요일","화요일","수요일","목요일","금요일","토요일"],calendar_header_month_format:"{year}년 {month}",calendar_view_day3:"3일",calendar_view_week:"주",calendar_view_month:"월",settings_title:"설정",sort_alert_title:"정렬 실패",sort_alert_message:"우선순위 정렬을 사용하려면<br/>2개 이상의 목표가 필요합니다.",ai_sort_error_title:"정렬 오류",ai_sort_error_message:"서버에 연결할 수 없습니다. 나중에 다시 시도해주세요.",confirm_button:"확인",new_goal_modal_title:"새로운 목표",edit_goal_modal_title:"목표 편집",wish_label:"목표",outcome_label:"최상의 결과",obstacle_label:"장애물",plan_label:"If-Then 계획",deadline_label:"마감일",cancel_button:"취소",add_button:"추가",save_button:"저장",goal_details_modal_title:"목표 상세 정보",ai_coach_suggestion:"요약보기",ai_analyzing:"분석 중...",close_button:"닫기",ai_sort_reason_modal_title:"AI 정렬 재안",ai_sort_criteria:"AI 정렬 기준",delete_account_final_confirm_title:"계정 삭제",delete_account_final_confirm_message:"계정을 포함한 모든 목표, 폴더, 설정, 데이터가 영구적으로 삭제되며, 이 작업은 되돌릴 수 없습니다.",delete_all_data_button:"계정 완전 삭제",settings_done_button:"완료",settings_section_data:"데이터 관리",settings_section_account:"Nova Beta 계정",settings_sync_data:"지금 동기화",settings_load_data:"불러오기",settings_logout:"로그아웃",settings_export_data:"데이터 내보내기",settings_import_data:"데이터 가져오기",import_confirm_title:"데이터 가져오기",import_confirm_message:"현재 목표를 새로운 데이터로 교체합니다. 이 작업은 되돌릴 수 없습니다.",import_success_toast:"데이터를 성공적으로 가져왔습니다.",import_error_alert_title:"가져오기 실패",import_error_alert_message:"파일을 읽는 중 오류가 발생했거나 파일 형식이 올바르지 않습니다. 나중에 다시 시도히십시오.",settings_section_general:"일반",settings_section_info:"정보",settings_section_help:"사용방법",settings_theme_mode:"테마 모드",theme_mode_light:"라이트 모드",theme_mode_light_desc:"항상 밝은 테마 사용",theme_mode_dark:"다크 모드",theme_mode_dark_desc:"항상 어두운 테마 사용",theme_mode_system:"자동",theme_mode_system_desc:"기기의 설정에에 동기화 됩니다.",settings_dark_mode:"다크 모드",settings_language:"언어",settings_api_key:"Gemini AI 설정",settings_api_key_placeholder:"Gemini API 키 입력",settings_offline_mode:"오프라인 사용",settings_offline_mode_desc:"AI 기능 없이 기본 기능 사용",settings_notifications:"알림",settings_notifications_desc:"PWA 알림 설정",notification_settings_title:"어떤 알림을 받을까요?",reminder_add_title:"미리알림 추가",reminder_step_title:"{step}/5 단계",reminder_step1_title:"🔔 제목",reminder_step1_desc:"미리알림의 제목을 입력하세요",reminder_step2_title:"📅 기한 & ⏰ 시간",reminder_step2_desc:"기한 날짜와 시간을 설정하세요 (선택사항)",reminder_step2_date_toggle:"기한 설정",reminder_step2_time_toggle:"시간 설정",reminder_step3_title:"🔄 반복 설정",reminder_step3_desc:"반복 여부와 반복 주기를 선택하세요",reminder_step3_enable_recurring:"반복 설정",reminder_step4_title:"📝 설명",reminder_step4_desc:"추가 설명을 입력하세요 (선택사항)",reminder_step5_title:"✅ 활성화",reminder_step5_desc:"미리알림 활성화 여부를 선택하세요",reminder_next_button:"다음",reminder_back_button:"이전",reminder_submit_button:"추가",reminder_form_title:"제목",reminder_form_date:"기한",reminder_form_time:"시간",reminder_form_recurring:"반복",reminder_form_description:"설명",reminder_form_enabled:"활성화",recurring_type_none:"반복 없음",recurring_type_daily:"매일",recurring_type_weekly:"매주",recurring_type_monthly:"매월",notification_deadline:"마감일 임박 알림",notification_deadline_desc:"마감이 가까운 목표에 대해 알려줍니다.",notification_suggestion:"지금할일 제안",notification_suggestion_desc:"오늘 해야할 목표를 제안해줍니다.",notification_achievement:"목표 달성 축하",notification_achievement_desc:"목표를 달성했을 때 축하해줍니다.",notification_reminder:"일반 미리알림",notification_reminder_desc:"설정한 시간에 미리알림을 받습니다.",reminder_time_settings_title:"미리알림 시간 설정",reminder_start_time:"시작 시간",reminder_end_time:"종료 시간",language_name:"한국어 (대한민국)",language_modal_title:"언어",settings_section_background:"화면",settings_bg_default:"라이트",settings_bg_default_dark:"다크",settings_bg_pink:"핑크",settings_bg_cherry_noir:"다크 체리",settings_bg_blue:"블루",settings_bg_deep_ocean:"오션",settings_bg_green:"그린",settings_bg_forest_green:"포레스트 그린",settings_bg_purple:"퍼플",settings_bg_royal_purple:"딥 퍼플",settings_version:"버전",test_long_alert:"긴 알림 테스트",test_long_alert_desc:"긴 내용의 알림 팝업 테스트",folder_manage_title:"폴더 관리",folder_manage_info:"폴더 정보",folder_manage_collaborators:"협업자",folder_manage_settings:"설정",folder_name_edit:"폴더 이름 편집",folder_invite_new:"새 협업자 초대",folder_invite_email:"이메일 주소",folder_invite_role:"역할",folder_role_owner:"소유자",folder_role_editor:"편집자",folder_role_viewer:"뷰어",folder_invite_button:"초대하기",folder_leave:"폴더 나가기",folder_delete:"폴더 삭제",folder_share_link:"공유 링크",folder_share_link_desc:"이 링크로 다른 사용자를 초대할 수 있습니다",folder_copy_link:"링크 복사",folder_leave_confirm:"폴더에서 나가시겠습니까?",folder_delete_confirm:"폴더를 삭제하시겠습니까? 나의 목표로 이동됩니다.",settings_developer:"개발자",developer_name:"Kim Kyumin",settings_copyright:"저작권",copyright_notice:"© 2025 Kim Kyumin. All Rights Reserved.",build_number:"빌드 번호",settings_data_header:"데이터 관리",settings_data_header_desc:"목표 데이터를 파일로 내보내거나, 파일에서 가져옵니다.",settings_background_header:"배경화면",settings_background_header_desc:"앱의 배경화면 스타일을 변경하여 개성을 표현해 보세요.",data_importing:"가져오는 중...",data_exporting:"내보내는 중...",data_deleting:"삭제 중...",url_import_title:"URL에서 데이터 불러오기",url_import_message:"URL의 데이터로 현재 목표 목록을 병합하시겠습니까?",url_import_confirm:"불러오기",url_import_success:"URL에서 데이터를 성공적으로 가져왔습니다!",url_import_error:"URL의 데이터가 올바르지 않습니다.",settings_share_link_header:"링크로 공유",settings_generate_link:"공유 링크 생성",settings_copy_link:"복사",link_copied_toast:"링크가 클립보드에 복사되었습니다.",short_url_created:"📎 단축 URL이 생성되었습니다!",share_link_created:"🔗 공유 링크가 생성되었습니다!",short_url_failed:"⚠️ 단축 URL 생성에 실패하여 기본 링크를 사용합니다.",no_data_to_share:"공유할 목표가 없습니다.",usage_guide_tab:"사용방법",usage_guide_title:"사용 가이드",usage_basic_title:"목표 추가하기",usage_basic_desc:`1. 홈 화면에서 "목표 추가 및 편집" 버튼을 탭하세요.
2. 목표, 결과, 장애물, 계획을 차례로 입력하세요.
3. 마감일과 반복 요일을 선택하세요.
4. "저장" 버튼을 눌러 목표를 추가하세요.`,usage_ai_title:"Gemini AI 기능 사용하기",usage_ai_desc:`• 목표 작성 시 "요약보기" 버튼으로 Gemini AI의 개선된 목표를 받아보세요.
• 목표 목록에서 "우선순위 정렬" 버튼으로 중요도 순 정렬이 가능합니다.
• Gemini AI 분석을 통해 더 효과적인 목표 설정을 도와드립니다.

※ Gemini AI 기능 사용을 위해서는 API 키 설정이 필요합니다.`,usage_ai_setup_title:"Gemini AI 설정하기",usage_ai_setup_desc:`1. 설정 > 일반에서 "Gemini AI 설정" 항목을 찾으세요.
2. Google Gemini API 키를 입력하세요.
3. API 키 발급 방법은 다음 Google 지원 문서를 참조하세요:
   https://ai.google.dev/gemini-api/docs/api-key
4. 키 입력 후 Gemini AI 기능이 활성화됩니다.`,usage_share_title:"목표 공유하기",usage_share_desc:`1. 설정 > 공유에서 "목표 링크 생성" 버튼을 탭하세요.
2. 자동으로 생성된 단축 링크를 확인하세요.
3. "링크 복사" 버튼으로 클립보드에 복사하세요.
4. 메신저나 이메일로 링크를 공유하세요.`,usage_theme_title:"테마 변경하기",usage_theme_desc:`1. 설정 > 모양에서 다크 모드 토글을 사용하세요.
2. 배경 테마에서 원하는 색상을 선택하세요.
3. 기본, 핑크, 블루, 그린, 퍼플 테마 중 선택 가능합니다.
4. 변경 사항은 즉시 적용됩니다.`,usage_calendar_title:"캘린더 보기 사용하기",usage_calendar_desc:`1. 하단 탭에서 캘린더 아이콘을 탭하세요.
2. 3일/주간/월간 보기를 선택할 수 있습니다.
3. 날짜를 탭하여 해당 날의 목표를 확인하세요.
4. 좌우 화살표로 날짜를 이동할 수 있습니다.`,usage_offline_title:"오프라인 모드 사용하기",usage_offline_desc:`1. 설정 > 일반에서 "오프라인 모드" 토글을 켜세요.
2. API 키 없이도 목표 추가, 편집, 삭제가 가능합니다.
3. AI 기능은 사용할 수 없지만 모든 기본 기능은 정상 작동합니다.
4. 데이터는 브라우저에 안전하게 저장됩니다.`,goal_assistant_title:"새로운 목표",goal_assistant_mode_woop:"WOOP",goal_assistant_mode_automation:"장기 계획",automation_title:"장기 목표 만들기",automation_base_name_label:"목표 이름",automation_base_name_placeholder:"예: 영어 단어 학습",automation_total_units_label:"총 분량",automation_total_units_placeholder:"예: 30",automation_units_per_day_label:"일일 분량",automation_period_label:"기간",automation_start_date_label:"시작일",automation_end_date_label:"종료일",automation_generate_button:"{count}개 생성",automation_error_all_fields:"모든 필드를 올바르게 입력해주세요.",automation_error_start_after_end:"시작일은 종료일보다 빨라야 합니다.",automation_error_short_period:"기간이 너무 짧습니다. (1일 이상)",next_button:"다음",back_button:"이전",wish_tip:"측정 가능하고 구체적인, 도전적이면서도 현실적인 목표를 설정하세요.",wish_example:"예: 3개월 안에 5kg 감량하기, 이번 학기에 A+ 받기",outcome_tip:"목표 달성 시 얻게 될 가장 긍정적인 결과를 생생하게 상상해 보세요.",outcome_example:"예: 더 건강하고 자신감 있는 모습, 성적 장학금 수령",obstacle_tip:"목표 달성을 방해할 수 있는 내면의 장애물(습관, 감정 등)은 무엇인가요?",obstacle_example:"예: 퇴근 후 피곤해서 운동 가기 싫은 마음, 어려운 과제를 미루는 습관",plan_tip:"'만약 ~라면, ~하겠다' 형식으로 장애물에 대한 구체적인 대응 계획을 세워보세요.",plan_example:"예: 만약 퇴근 후 운동 가기 싫다면, 일단 운동복으로 갈아입고 10분만 스트레칭한다.",recurrence_label:"반복",recurrence_tip:"정해진 요일에 꾸준히 해야 하는 목표인가요? 반복으로 설정하여 연속 달성을 기록해 보세요.",recurrence_example:"예: 매주 월,수,금 헬스장 가기",recurrence_option_daily:"반복 목표",deadline_tip:"현실적인 마감일을 설정하여 동기를 부여하세요. 마감일이 없는 장기 목표도 좋습니다.",deadline_option_no_deadline:"마감일 없음",day_names_short_picker:["월","화","수","목","금","토","일"],settings_delete_account:"계정 삭제",delete_account_header:"계정 삭제",delete_account_header_desc:"이 작업은 되돌릴 수 없으며, 계정과 모든 데이터가 영구적으로 삭제됩니다.",version_update_title:"새로운 기능",version_update_1_title:"Firebase 클라우드 동기화",version_update_1_desc:"Google 로그인으로 목표와 설정값을 클라우드에 저장하고 불러올 수 있습니다. 목표는 같은 Google 계정으로 로그인된 여러 기기에서 동기화됩니다.",version_update_2_title:"자동 설정 동기화",version_update_2_desc:"언어, 테마, 배경 색상 등 모든 설정값이 클라우드에 저장되어 다른 기기에서도 동일하게 적용됩니다.",version_update_3_title:"안전한 로그아웃",version_update_3_desc:"로그아웃 시 모든 데이터가 클라우드에 저장되고, 로컬 데이터는 완전히 삭제되며 홈으로 이동합니다.",version_update_4_title:"상태 표시 UI",version_update_4_desc:"로그인, 로그아웃, 동기화 등의 작업 중 버튼 상태가 변화하여 진행 상황을 명확히 보여줍니다."},en:{language_selection_title:"Language",error_wish_required:"Please enter your wish.",error_outcome_required:"Please enter the outcome.",error_obstacle_required:"Please enter the obstacle.",error_plan_required:"Please enter your If-Then plan.",error_deadline_required:"Please select a deadline.",error_day_required:"Please select at least one day.",my_goals_title:"My Goals",all_goals_label:"나의 목표",sort_label_manual:"Manual",sort_label_deadline:"Deadline",sort_label_newest:"Newest",sort_label_alphabetical:"Alphabetical",sort_label_ai:"Priority Order",ai_sorting_button:"Sorting...",add_new_goal_button_label:"Add New Goal",filter_all:"나의 목표",filter_active:"In Progress",filter_completed:"Completed",filter_category:"Category",category_all:"All Categories",category_school:"School",category_work:"Work",category_personal:"Personal",category_other:"Other",category_label:"Select Category",empty_message_all:"Add a goal with the + button",empty_message_active:"No goals in progress.",empty_message_completed:"No completed goals yet.",empty_encouragement_1:"Take the first step toward something amazing.",empty_encouragement_2:"Small changes lead to big achievements.",empty_encouragement_3:"What you do today shapes tomorrow.",empty_encouragement_4:"Your goals are waiting to become reality.",delete_button:"Delete",edit_button_aria:"Edit Goal",info_button_aria:"Details",filter_title:"Filter",sort_title:"Sort",filter_sort_button_aria:"Filter and Sort",calendar_view_button_aria:"Calendar View",list_view_button_aria:"List View",more_options_button_aria:"More",select_button_label:"Select",cancel_selection_button_label:"Cancel",delete_selected_button_label:"Delete {count}",select_all_button_label:"Select All",delete_selected_confirm_title:"Delete Goals",delete_selected_confirm_message:"The {count} selected goals will be permanently deleted.",days_left:"{count} days left",d_day:"D-DAY",days_overdue:"{count} days overdue",month_names:["January","February","March","April","May","June","July","August","September","October","November","December"],day_names_short:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],day_names_long:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],calendar_header_month_format:"{month} {year}",calendar_view_day3:"3-Day",calendar_view_week:"Week",calendar_view_month:"Month",settings_title:"Settings",sort_alert_title:"Unable to Sort",sort_alert_message:"Add at least two goals to use priority order.",ai_sort_error_title:"Unable to Sort",ai_sort_error_message:"Cannot connect to server. Please try again later.",confirm_button:"OK",new_goal_modal_title:"New Goal",edit_goal_modal_title:"Edit Goal",wish_label:"Wish",outcome_label:"Outcome",obstacle_label:"Obstacle",plan_label:"If-Then Plan",deadline_label:"Deadline",cancel_button:"Cancel",add_button:"Add",save_button:"Save",goal_details_modal_title:"Goal Details",ai_coach_suggestion:"View Summary",ai_analyzing:"Analyzing...",close_button:"Close",ai_sort_reason_modal_title:"Sort Reason",ai_sort_criteria:"🤖 Sort Criteria",delete_account_final_confirm_title:"Delete Account",delete_account_final_confirm_message:"Your account and all data (goals, folders, settings) will be permanently deleted. This action cannot be undone.",delete_all_data_button:"Delete Account",settings_done_button:"Done",settings_section_data:"Data Management",settings_export_data:"Export",settings_import_data:"Import",import_confirm_title:"Import Data",import_confirm_message:"This will replace your current goals with new data. This action cannot be undone.",import_success_toast:"Data imported successfully.",import_error_alert_title:"Import Failed",import_error_alert_message:"There was an error reading the file, or the file format is incorrect.",settings_section_general:"General",settings_section_info:"Information",settings_section_help:"How to Use",settings_theme_mode:"Theme Mode",theme_mode_light:"Light Mode",theme_mode_light_desc:"Use bright theme",theme_mode_dark:"Dark Mode",theme_mode_dark_desc:"Use dark theme",theme_mode_system:"Follow System Settings",theme_mode_system_desc:"Automatically adjust to device settings",settings_dark_mode:"Dark Mode",settings_language:"Language",settings_api_key:"Gemini AI Setup",settings_api_key_placeholder:"Enter Gemini API key",settings_offline_mode:"Offline Mode",settings_offline_mode_desc:"Use basic features without AI",settings_notifications:"Notifications",settings_notifications_desc:"PWA notification settings",notification_settings_title:"What notifications would you like?",notification_deadline:"Deadline Alerts",notification_deadline_desc:"Get notified when deadlines are approaching.",notification_suggestion:"Today's Suggestions",notification_suggestion_desc:"Get suggestions on what to do today.",notification_achievement:"Achievement Celebration",notification_achievement_desc:"Celebrate when you achieve a goal.",notification_reminder:"General Reminder",notification_reminder_desc:"Get reminded at scheduled times.",reminder_time_settings_title:"Reminder Time Settings",reminder_start_time:"Start Time",reminder_end_time:"End Time",reminder_add_title:"Add Reminder",reminder_step_title:"Step {step}/5",reminder_step1_title:"🔔 Title",reminder_step1_desc:"Enter the reminder title",reminder_step2_title:"📅 Date & ⏰ Time",reminder_step2_desc:"Set the reminder date and time (optional)",reminder_step2_date_toggle:"Set Date",reminder_step2_time_toggle:"Set Time",reminder_step3_title:"🔄 Recurring",reminder_step3_desc:"Choose recurrence settings",reminder_step3_enable_recurring:"Enable Recurring",reminder_step4_title:"📝 Description",reminder_step4_desc:"Add optional description",reminder_step5_title:"✅ Enable",reminder_step5_desc:"Choose whether to enable reminder",reminder_next_button:"Next",reminder_back_button:"Back",reminder_submit_button:"Add",reminder_form_title:"Title",reminder_form_date:"Date",reminder_form_time:"Time",reminder_form_recurring:"Recurring",reminder_form_description:"Description",reminder_form_enabled:"Enabled",recurring_type_none:"No Recurrence",recurring_type_daily:"Daily",recurring_type_weekly:"Weekly",recurring_type_monthly:"Monthly",language_name:"English (US)",language_modal_title:"Language",settings_section_background:"Appearance",settings_share_link_header:"Share via Link",settings_generate_link:"Generate Share Link",settings_bg_default:"Light",settings_bg_default_dark:"Dark",settings_bg_pink:"Pink",settings_bg_cherry_noir:"Cherry Noir",settings_bg_blue:"Blue",settings_bg_deep_ocean:"Ocean",settings_bg_green:"Green",settings_bg_forest_green:"Forest",settings_bg_purple:"Purple",settings_bg_royal_purple:"Royal Purple",settings_section_account:"Nova Beta Account",settings_sync_data:"Sync Data",settings_load_data:"Load Data",settings_logout:"Sign Out",settings_delete_account:"Delete Account",delete_account_header:"Delete Account",delete_account_header_desc:"This action is irreversible and will permanently delete your account and all data.",data_deleting:"Deleting...",settings_version:"Version",test_long_alert:"Test Long Alert",test_long_alert_desc:"Test alert popup with long content",settings_developer:"Developer",developer_name:"GimGyuMin",settings_copyright:"Copyright",copyright_notice:"© 2025 GimGyuMin. All Rights Reserved.",build_number:"Build Number",settings_data_header:"Data Management",settings_data_header_desc:"Export or import your goal data.",settings_background_header:"Background",settings_background_header_desc:"Change the app's background style to express your personality.",data_importing:"Importing...",data_exporting:"Exporting..."}},Ie={add:p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),p.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),check:p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:p.jsx("polyline",{points:"20 6 9 17 4 12"})}),info:p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("circle",{cx:"12",cy:"12",r:"10"}),p.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),p.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),delete:p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("polyline",{points:"3 6 5 6 21 6"}),p.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}),p.jsx("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),p.jsx("line",{x1:"14",y1:"11",x2:"14",y2:"17"})]}),edit:p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),p.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),close:p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),p.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}),back:p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:p.jsx("polyline",{points:"15 18 9 12 15 6"})}),forward:p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:p.jsx("polyline",{points:"9 18 15 12 9 6"})}),calendar:p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),p.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),p.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),p.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),list:p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("line",{x1:"8",y1:"6",x2:"21",y2:"6"}),p.jsx("line",{x1:"8",y1:"12",x2:"21",y2:"12"}),p.jsx("line",{x1:"8",y1:"18",x2:"21",y2:"18"}),p.jsx("line",{x1:"3",y1:"6",x2:"3.01",y2:"6"}),p.jsx("line",{x1:"3",y1:"12",x2:"3.01",y2:"12"}),p.jsx("line",{x1:"3",y1:"18",x2:"3.01",y2:"18"})]}),settings:p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("circle",{cx:"12",cy:"12",r:"3"}),p.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]}),filter:p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:p.jsx("polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"})}),ai:p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("path",{d:"M12 3L14.34 8.66L20 11L14.34 13.34L12 19L9.66 13.34L4 11L9.66 8.66L12 3Z"}),p.jsx("path",{d:"M5 21L7 16"}),p.jsx("path",{d:"M19 21L17 16"})]}),flame:p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:p.jsx("path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"})}),data:p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83"}),p.jsx("path",{d:"M22 12A10 10 0 0 0 12 2v10z"})]}),background:p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),p.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),p.jsx("polyline",{points:"21 15 16 10 5 21"})]}),exclamation:p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 15c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1zm1-4h-2V7h2v6z"})})},Ql=(t,e)=>{const n=new Date(t),r=new Date(e);return n.getFullYear()===r.getFullYear()&&n.getMonth()===r.getMonth()&&n.getDate()===r.getDate()},V3=(t,e)=>{if(!t)return null;const n=new Date;n.setHours(0,0,0,0);const r=new Date(t);r.setHours(0,0,0,0);const i=r.getTime()-n.getTime(),s=Math.ceil(i/(1e3*60*60*24));return s===0?e("d_day"):s>0?e("days_left").replace("{count}",String(s)):e("days_overdue").replace("{count}",String(Math.abs(s)))},Kw=(t,e=1)=>{const n=new Date(t),r=n.getDay(),i=(r<e?7:0)+r-e;return n.setDate(n.getDate()-i),n.setHours(0,0,0,0),n},jw=t=>{try{const e=new TextEncoder().encode(t),n=Array.from(e).map(r=>String.fromCharCode(r)).join("");return btoa(n)}catch(e){return console.error("UTF-8 to Base64 encoding failed:",e),""}},Jw=t=>{try{const e=atob(t),n=new Uint8Array(e.length);for(let r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return new TextDecoder().decode(n)}catch(e){return console.error("Base64 to UTF-8 decoding failed:",e),""}},Qw=t=>{try{const n=JSON.stringify(t).replace(/\s+/g," ").trim();return jw(n)}catch(e){return console.error("Data compression failed:",e),jw(JSON.stringify(t))}},L3=async t=>{if(t.length<1500)return t;const e=[{name:"is.gd",createUrl:async n=>{const r=await fetch(`https://is.gd/create.php?format=simple&url=${encodeURIComponent(n)}`);if(!r.ok)throw new Error("is.gd API failed");const i=await r.text();if(i.includes("Error")||!i.startsWith("http"))throw new Error("Invalid response from is.gd");return i.trim()}},{name:"tinyurl",createUrl:async n=>new Promise((r,i)=>{const s=`tinyurl_${Date.now()}`,o=document.createElement("script"),a=setTimeout(()=>{l(),i(new Error("TinyURL timeout"))},5e3),l=()=>{clearTimeout(a),o.parentNode&&document.head.removeChild(o),delete window[s]};window[s]=u=>{l(),u&&typeof u=="string"&&!u.includes("Error")&&u.startsWith("http")?r(u.trim()):i(new Error("Invalid TinyURL response"))},o.onerror=()=>{l(),i(new Error("TinyURL script load failed"))},o.src=`https://tinyurl.com/api-create.php?url=${encodeURIComponent(n)}&callback=${s}`,document.head.appendChild(o)})},{name:"v.gd",createUrl:async n=>{const r=await fetch(`https://v.gd/create.php?format=simple&url=${encodeURIComponent(n)}`);if(!r.ok)throw new Error("v.gd API failed");const i=await r.text();if(i.includes("Error")||!i.startsWith("http"))throw new Error("Invalid response from v.gd");return i.trim()}}];for(const n of e)try{console.log(`Trying ${n.name} for URL shortening...`);const r=await n.createUrl(t);return console.log(`✅ ${n.name} success:`,r),r}catch(r){console.warn(`❌ ${n.name} failed:`,r);continue}return console.warn("All URL shortening services failed, using original URL"),t},tg=[{id:"default",lightThemeClass:"bg-solid-default",darkThemeClass:"bg-solid-default",lightNameKey:"settings_bg_default",darkNameKey:"settings_bg_default_dark"},{id:"pink",lightThemeClass:"bg-solid-pink",darkThemeClass:"bg-solid-pink",lightNameKey:"settings_bg_pink",darkNameKey:"settings_bg_cherry_noir"},{id:"blue",lightThemeClass:"bg-solid-blue",darkThemeClass:"bg-solid-blue",lightNameKey:"settings_bg_blue",darkNameKey:"settings_bg_deep_ocean"},{id:"green",lightThemeClass:"bg-solid-green",darkThemeClass:"bg-solid-green",lightNameKey:"settings_bg_green",darkNameKey:"settings_bg_forest_green"},{id:"purple",lightThemeClass:"bg-solid-purple",darkThemeClass:"bg-solid-purple",lightNameKey:"settings_bg_purple",darkNameKey:"settings_bg_royal_purple"}],F3=()=>{const[t,e]=z.useState("ko"),[n,r]=z.useState([]),[i,s]=z.useState([]),[o,a]=z.useState(null);z.useEffect(()=>{if(i.length===0){a(null);return}o&&!i.some(S=>S.id===o)&&a(i[0].id),!o&&i.length>0&&a(i[0].id)},[i]);const[l,u]=z.useState("all"),[f,m]=z.useState("all"),[g,v]=z.useState("manual"),[T,x]=z.useState(["school","work","personal","other"]),[D,C]=z.useState(()=>Ww()==="dark"),[w,P]=z.useState("system"),[V,O]=z.useState("default"),[B,E]=z.useState([]),[I,A]=z.useState({}),[k,b]=z.useState([]),[L,N]=z.useState(!1),[De,Fe]=z.useState(!1),[Ke,Te]=z.useState(null),[te,ce]=z.useState(!1),[me,Ee]=z.useState(null),[Pe,ze]=z.useState(""),[je,Mt]=z.useState(""),[ut,fe]=z.useState("editor"),[en,_n]=z.useState(!1),[Nn,ar]=z.useState(null),[lr,cn]=z.useState(!1),[Cr,Me]=z.useState(!1),[Ct,qe]=z.useState(!1),[ct,ae]=z.useState(null),[Vt,ti]=z.useState(!1),[rs,is]=z.useState(new Set),[lo,xe]=z.useState(""),[tc,Ar]=z.useState("idle"),[ss,Oa]=z.useState(!1),[nc,Ba]=z.useState(!1),[rc,os]=z.useState(""),[qa,as]=z.useState(!1),[yn,ls]=z.useState(void 0),[uo,Ga]=z.useState(!1),[Dn,us]=z.useState(""),[_t,ic]=z.useState(!1),[ur,cs]=z.useState(!0),[J,$a]=z.useState(null),[ds,oy]=z.useState(""),[ay,za]=z.useState(!1),[sc,co]=z.useState(!1),[Ha,xr]=z.useState(!1),[Wa,Et]=z.useState(!1),[oc,Ka]=z.useState(!1),[hs,ho]=z.useState(!0);z.useEffect(()=>{let S=null,M=null,U={},q=!1,F=null;ho(!0);const K=Yk(pi,async W=>{if($a(W),ho(!1),F=W,W){await fo(W);const Y=async()=>{var X,Q;if(!(!F||q)){try{const le=await R3(F.uid);r(we=>{const ge=we.filter(Ue=>Ue.isSharedTodo===!0),_e=le.map(Ue=>({...Ue,isSharedTodo:!1}));return _e.length!==we.filter(Ue=>!Ue.isSharedTodo).length||_e.some((Ue,it)=>{const Wn=we.filter(Vn=>!Vn.isSharedTodo)[it];return!Wn||JSON.stringify(Wn)!==JSON.stringify(Ue)})?[..._e,...ge]:we})}catch(le){((X=le==null?void 0:le.message)!=null&&X.includes("quota")||(Q=le==null?void 0:le.message)!=null&&Q.includes("exceed"))&&alert("서버 할당량이 초과되어 데이터를 불러올 수 없습니다. 잠시 후 다시 시도해주세요.")}S=setTimeout(Y,5e3)}},ne=async()=>{var X,Q;if(!(!F||q)){try{const le=await P3(F.uid);s(ge=>le.length!==ge.length||le.some((Re,Ue)=>{const it=ge[Ue];return!it||JSON.stringify(it)!==JSON.stringify(Re)})?le:ge);const we=le.filter(ge=>ge.isShared&&ge.ownerId&&ge.ownerId!==F.uid);for(const ge of we){U[ge.id]&&clearTimeout(U[ge.id]);const _e=async()=>{var Re,Ue;if(!(!F||q)){try{const it=await k3(ge.ownerId,ge.id);r(Wn=>{const Vn=Wn.filter(kr=>!(kr.folderId===ge.id&&kr.isSharedTodo===!0)),_c=it.filter(kr=>!Vn.some(oi=>oi.id===kr.id)),gs=[...Vn,..._c];return gs.length!==Wn.length||gs.some((kr,oi)=>{const yc=Wn[oi];return!yc||JSON.stringify(yc)!==JSON.stringify(kr)})?gs:Wn})}catch(it){((Re=it==null?void 0:it.message)!=null&&Re.includes("quota")||(Ue=it==null?void 0:it.message)!=null&&Ue.includes("exceed"))&&alert("서버 할당량이 초과되어 공유 데이터를 불러올 수 없습니다.")}U[ge.id]=setTimeout(_e,7e3)}};_e()}}catch(le){((X=le==null?void 0:le.message)!=null&&X.includes("quota")||(Q=le==null?void 0:le.message)!=null&&Q.includes("exceed"))&&alert("서버 할당량이 초과되어 폴더 데이터를 불러올 수 없습니다.")}M=setTimeout(ne,5e3)}};Y(),ne()}else r([]),s([]),e("ko"),P("system"),O("default"),us(""),x(["school","work","personal","other"]),S&&clearTimeout(S),M&&clearTimeout(M),Object.values(U).forEach(Y=>clearTimeout(Y))});return()=>{q=!0,K(),S&&clearTimeout(S),M&&clearTimeout(M),Object.values(U).forEach(W=>clearTimeout(W))}},[]);const ac=z.useCallback(()=>{console.log("🔍 Firebase 진단 시작..."),console.log("Firebase Auth:",pi),console.log("Firebase DB:",ve),console.log("Google Provider:",Os),console.log("환경 변수 확인:"),console.log("- VITE_FIREBASE_API_KEY:","✅ 설정됨"),console.log("- VITE_FIREBASE_AUTH_DOMAIN:","✅ 설정됨"),console.log("- VITE_FIREBASE_PROJECT_ID:","✅ 설정됨"),console.log("브라우저 정보:"),console.log("- User Agent:",navigator.userAgent),console.log("- 쿠키 활성화:",navigator.cookieEnabled),console.log("- 로컬 스토리지 지원:",typeof Storage<"u"),console.log("네트워크 상태:",navigator.onLine?"✅ 온라인":"❌ 오프라인")},[]),ja=z.useCallback(async()=>{co(!0);try{console.log("🔄 Google 로그인 시작..."),console.log("Auth 상태:",pi),console.log("Google Provider 설정:",Os);const S=window.open("","_blank","width=1,height=1");if(!S||S.closed||typeof S.closed>"u")throw new Error("팝업이 차단되었습니다. 브라우저 설정에서 팝업을 허용해주세요.");S.close(),console.log("🔄 signInWithPopup 호출 중...");const M=await _1(pi,Os);console.log("✅ 로그인 성공:",M.user.email),$a(M.user),xe("✅ Google 로그인 성공!"),setTimeout(async()=>{var U;try{console.log("📥 사용자 데이터 로딩 시작...");const{doc:q,getDoc:F}=await Nr(async()=>{const{doc:X,getDoc:Q}=await Promise.resolve().then(()=>Ts);return{doc:X,getDoc:Q}},void 0),K=q(ve,"users",M.user.uid,"data","todos"),W=await F(K);if(W.exists()){const X=W.data();r(X.todos||[]),console.log("📥 목표 데이터 로드 완료:",((U=X.todos)==null?void 0:U.length)||0)}else console.log("📝 새 사용자 - 빈 목표 목록으로 시작"),r([]);const Y=q(ve,"users",M.user.uid,"data","settings"),ne=await F(Y);if(ne.exists()){const X=ne.data();X.language&&e(X.language),X.themeMode&&P(X.themeMode),X.isDarkMode!==void 0&&C(X.isDarkMode),X.backgroundTheme&&O(X.backgroundTheme),X.apiKey&&us(X.apiKey)}xe("✅ 로그인 완료! 데이터 로드됨")}catch(q){console.error("데이터 로드 실패:",q),xe("⚠️ 로그인은 성공했으나 데이터 로드 실패")}co(!1),setTimeout(()=>xe(""),3e3)},500),setTimeout(()=>xe(""),3e3)}catch(S){console.error("❌ Google 로그인 오류:",S),console.error("오류 코드:",S.code),console.error("오류 메시지:",S.message);let M="로그인 중 오류가 발생했습니다.";switch(S.code){case"auth/popup-closed-by-user":M="로그인이 취소되었습니다.";break;case"auth/popup-blocked":M="팝업이 차단되었습니다. 브라우저 설정에서 팝업을 허용해주세요.";break;case"auth/cancelled-popup-request":M="다른 로그인 요청이 진행 중입니다.";break;case"auth/network-request-failed":M="네트워크 연결을 확인해주세요.";break;case"auth/too-many-requests":M="너무 많은 요청이 발생했습니다. 잠시 후 다시 시도해주세요.";break;case"auth/user-disabled":M="계정이 비활성화되었습니다.";break;case"auth/operation-not-allowed":M="Google 로그인이 활성화되지 않았습니다. 관리자에게 문의하세요.";break;default:M=`로그인 실패: ${S.message}`}S.code!=="auth/popup-closed-by-user"&&ae({title:"로그인 실패",message:M,confirmText:"확인",onConfirm:()=>ae(null)}),co(!1)}},[]),lc=(S,M)=>{if(S===null)return;const U=i.map(q=>q.id===S?{...q,collaborators:M}:q);s(U),yn&&yn.id===S&&ls({...yn,collaborators:M}),xe("✅ 폴더 협업자가 업데이트되었습니다"),setTimeout(()=>xe(""),3e3)},yf=z.useCallback(async()=>{xr(!0);try{if(J){xe("⏳ 데이터 저장 중...");const S=n.filter(X=>X!=null),{doc:M,setDoc:U,serverTimestamp:q}=await Nr(async()=>{const{doc:X,setDoc:Q,serverTimestamp:le}=await Promise.resolve().then(()=>Ts);return{doc:X,setDoc:Q,serverTimestamp:le}},void 0),F=S.map(X=>xt(X)).filter(X=>X!==void 0),K=M(ve,"users",J.uid,"data","todos"),W={todos:F,lastSyncTime:q(),totalGoals:F.length,syncedAt:new Date().toISOString()},Y=xt(W);Y?(await U(K,Y),console.log("✅ Todos Firestore 저장 완료:",{count:F.length})):console.error("❌ Todos 데이터 정제 실패");const ne=M(ve,"users",J.uid,"data","settings");await U(ne,{language:t,themeMode:w,isDarkMode:D,backgroundTheme:V,updatedAt:q()})}await Xk(pi),$a(null),r([]),e("ko"),O("default"),P("system"),C(Ww()==="dark"),Te(null),cn(!1),Fe(!1),xe("✅ 로그아웃 완료"),setTimeout(()=>xe(""),3e3),xr(!1)}catch(S){console.error("로그아웃 오류:",S),ae({title:"로그아웃 실패",message:"로그아웃 중 오류가 발생했습니다.",confirmText:"확인",onConfirm:()=>ae(null)}),xr(!1)}},[J,n,t,w,D,V]),Rr=z.useCallback(async()=>{if(!J){ae({title:"로그인 필요",message:"먼저 로그인해주세요",confirmText:"확인",onConfirm:()=>ae(null)});return}Et(!0);try{const S=n.filter(Q=>Q!=null),{doc:M,setDoc:U,serverTimestamp:q}=await Nr(async()=>{const{doc:Q,setDoc:le,serverTimestamp:we}=await Promise.resolve().then(()=>Ts);return{doc:Q,setDoc:le,serverTimestamp:we}},void 0),F=S.map(Q=>xt(Q)).filter(Q=>Q!==void 0),K=M(ve,"users",J.uid,"data","todos"),W={todos:F,lastSyncTime:q(),totalGoals:F.length,syncedAt:new Date().toISOString()},Y=xt(W);if(Y)await U(K,Y),console.log("✅ 백업 Todos Firestore 저장 완료:",{count:F.length});else throw new Error("Todos 데이터 정제 실패");const ne=M(ve,"users",J.uid,"data","settings"),X={language:t,themeMode:w,isDarkMode:D,backgroundTheme:V,apiKey:Dn,userCategories:T,updatedAt:q()};await U(ne,X);for(const Q of i)try{const le=M(ve,"users",J.uid,"folders",Q.id),we={...Q,ownerId:Q.ownerId||J.uid,collaborators:Q.collaborators||[],updatedAt:q()};await U(le,we),console.log(`✅ 폴더 ${Q.id} 동기화 완료`)}catch(le){console.error(`❌ 폴더 ${Q.id} 동기화 실패:`,le)}Et(!1)}catch(S){console.error("동기화 오류:",S),ae({title:"동기화 실패",message:S.message||"데이터 동기화 중 오류가 발생했습니다.",confirmText:"확인",onConfirm:()=>ae(null)}),Et(!1)}},[J,n,t,w,D,V,Dn]),fo=z.useCallback(async S=>{var M;try{const{doc:U,getDoc:q,collection:F,getDocs:K}=await Nr(async()=>{const{doc:Q,getDoc:le,collection:we,getDocs:ge}=await Promise.resolve().then(()=>Ts);return{doc:Q,getDoc:le,collection:we,getDocs:ge}},void 0),W=U(ve,"users",S.uid,"data","todos"),Y=await q(W);if(Y.exists()){const le=Y.data().todos||[];r(we=>{const ge=new Set(we.map(Ue=>Ue.id)),_e=le.filter(Ue=>!ge.has(Ue.id)),Re=[...we,..._e];return console.log("🔄 목표 데이터 병합:",{기존:we.length,로드됨:le.length,새로추가:_e.length,전체:Re.length}),Re})}const ne=U(ve,"users",S.uid,"data","settings"),X=await q(ne);if(X.exists()){const Q=X.data();Q.language&&e(Q.language),Q.themeMode&&P(Q.themeMode),Q.isDarkMode!==void 0&&C(Q.isDarkMode),Q.backgroundTheme&&O(Q.backgroundTheme),Q.apiKey&&us(Q.apiKey),Q.userCategories&&x(Q.userCategories)}try{const Q=F(ve,"users",S.uid,"folders"),le=await K(Q),we=[];le.forEach(ge=>{const _e=ge.data(),Re={id:ge.id,..._e,collaborators:_e.collaborators||[],ownerId:_e.ownerId||S.uid};we.push(Re)}),s(ge=>{const _e=new Set(ge.map(it=>it.id)),Re=we.filter(it=>!_e.has(it.id)),Ue=[...ge,...Re];return console.log("🔄 폴더 데이터 병합:",{기존:ge.length,로드됨:we.length,새로추가:Re.length,전체:Ue.length}),Ue}),console.log("✅ 폴더 로드 완료:",{count:we.length})}catch(Q){console.warn("⚠️ 폴더 로드 실패, 빈 배열로 설정:",Q)}console.log("✅ 클라우드 데이터 로드 완료:",{todos:Y.exists()&&((M=Y.data().todos)==null?void 0:M.length)||0,folders:"로드됨",settings:X.exists()?"로드됨":"없음"})}catch(U){console.error("❌ 클라우드 데이터 로드 실패:",U)}},[]),Ja=z.useCallback(async()=>{if(!J){ae({title:"로그인 필요",message:"먼저 로그인해주세요",confirmText:"확인",onConfirm:()=>ae(null)});return}Ka(!0);try{await fo(J),xe("✅ 클라우드 데이터 로드 완료!")}catch(S){console.error("로드 오류:",S),ae({title:"로드 실패",message:S.message||"데이터 로드 중 오류가 발생했습니다.",confirmText:"확인",onConfirm:()=>ae(null)})}finally{Ka(!1)}},[J,fo]),se=z.useCallback(S=>M3[t][S]||S,[t]),bn=z.useCallback(S=>{const M=S||Dn;if(_t||!M)return null;try{return new x3({apiKey:M})}catch(U){return console.error("Failed to create AI instance:",U),null}},[Dn,_t]),Qa=z.useCallback(S=>{P(S)},[]),Ya=z.useMemo(()=>[se("empty_encouragement_1"),se("empty_encouragement_2"),se("empty_encouragement_3"),se("empty_encouragement_4")],[se]),uc=z.useMemo(()=>Ya[Math.floor(Math.random()*Ya.length)],[Ya]);z.useEffect(()=>{console.log("🚀 클라우드 기반 앱 시작 - localStorage 사용 안 함")},[]),z.useEffect(()=>{(()=>{s(M=>{const U=M.filter(q=>{if(!q.collaborators||q.collaborators.length===0)return!0;const F=q.collaborators.find(K=>K.role==="owner");return!F||!F.userId||F.userId.startsWith("owner_")?(console.warn("🗑️ 잘못된 공유 폴더 제거:",q.name,F==null?void 0:F.userId),!1):!0});return U.length!==M.length&&console.log("✅ 잘못된 공유 폴더 정리 완료:",{제거됨:M.length-U.length,남은폴더:U.length}),U})})()},[]),z.useEffect(()=>{if(hs)return;const S=async()=>{const M=new URLSearchParams(window.location.search),U=M.get("data"),q=M.get("folder_share");if(q){try{const F=Jw(q),K=JSON.parse(F);if(K.type==="folder_share"&&K.folderId){if(K.password){const Y=sessionStorage.getItem(`folder_${K.folderId}_password`);if(!Y||Y!==K.password){ae({title:"암호 입력",message:"이 폴더는 암호로 보호되어 있습니다. 암호를 입력하세요.",confirmText:"확인",cancelText:"취소",onConfirm:()=>{const ne=prompt("폴더 암호를 입력하세요:");ne===K.password?(sessionStorage.setItem(`folder_${K.folderId}_password`,ne),ae(null),S()):ne!==null&&ae({title:"암호 오류",message:"암호가 일치하지 않습니다.",confirmText:"확인",onConfirm:()=>{window.history.replaceState({},document.title,window.location.pathname)}})},onCancel:()=>{window.history.replaceState({},document.title,window.location.pathname)}});return}}if(i.some(Y=>Y.id===K.folderId))window.history.replaceState({},document.title,window.location.pathname);else{if(K.ownerId&&!J&&!hs){ae({title:"로그인 필요",message:"이 공유 폴더는 소유자 기반 동기화를 위해 로그인이 필요합니다. 계속하려면 로그인하세요.",confirmText:"로그인",cancelText:"취소",onConfirm:async()=>{try{await ja()}catch(Q){console.error("로그인 중 오류:",Q)}},onCancel:()=>{window.history.replaceState({},document.title,window.location.pathname)}});return}const Y=K.ownerId||null;if(!Y){console.error("❌ 공유 링크에 소유자 정보가 없습니다:",K),ae({title:"❌ 공유 링크 오류",message:`공유 링크에 소유자 정보가 없습니다.
폴더 소유자에게 다시 공유 링크를 요청해주세요.`,confirmText:"확인",onConfirm:()=>{ae(null),window.history.replaceState({},document.title,window.location.pathname)}});return}const ne={id:K.folderId,name:K.folderName,color:K.folderColor||"#007AFF",ownerId:Y,collaborators:[{userId:Y,email:K.sharedBy||"",role:"owner",addedAt:K.sharedAt}],createdAt:K.sharedAt,updatedAt:K.sharedAt,isShared:!0};let X=ne;if(Y&&J)try{console.log("🔍 협업자 추가 시작:",{ownerUserId:Y,googleUserUid:J.uid});const Q=Rt(ve,"users",Y,"folders"),le=He(Q,K.folderId),we=await Yp(le);if(console.log("📄 폴더 조회 결과:",{exists:we.exists()}),we.exists()){let ge=we.data().collaborators||[];console.log("👥 현재 협업자 목록:",ge);const _e=ge.some(Re=>Re.userId===J.uid);if(console.log("🔎 협업자 여부:",{isCollaborator:_e}),_e)console.log("ℹ️ 이미 협업자임");else{const Re={userId:J.uid,email:J.email||"",role:"editor",addedAt:new Date().toISOString()};ge=[...ge,Re],console.log("📝 새로운 협업자 목록:",ge);const Ue=xt(ge);Ue?(await yt(le,{collaborators:Ue,updatedAt:new Date().toISOString()},{merge:!0}),console.log("✅ 협업자 Firestore 저장 완료:",Re)):console.warn("⚠️ 협업자 정제 후 데이터가 없음")}X={...ne,collaborators:ge}}else console.warn("⚠️ 폴더가 존재하지 않음:",K.folderId)}catch(Q){console.error("❌ 협업자 목록 조회/추가 실패:",Q)}else console.warn("⚠️ 협업자 추가 조건 미충족:",{ownerUserId:Y,hasGoogleUser:!!J});if(s([...i,X]),J)try{const{doc:Q,setDoc:le}=await Nr(async()=>{const{doc:ge,setDoc:_e}=await Promise.resolve().then(()=>Ts);return{doc:ge,setDoc:_e}},void 0),we=Q(ve,"users",J.uid,"folders",X.id);await le(we,{name:X.name,color:X.color,ownerId:X.ownerId,createdAt:X.createdAt,updatedAt:X.updatedAt,isShared:X.isShared,collaborators:X.collaborators||[],collaborationSettings:X.collaborationSettings||{enabled:!0,showPresence:!0,showEditingState:!0,enableConflictDetection:!0,allowGuestView:!1,requireApproval:!1}}),console.log("✅ 공유 폴더 Firebase 저장 완료:",X.id)}catch(Q){console.error("❌ 공유 폴더 Firebase 저장 실패:",Q)}a(X.id),ae({title:"공유 폴더 추가됨",message:`"${K.folderName}" 폴더가 추가되었습니다. 잠시 후 목표들이 로드됩니다.`,confirmText:"확인",onConfirm:()=>{window.history.replaceState({},document.title,window.location.pathname)}})}}}catch(F){console.error("폴더 공유 데이터 파싱 실패:",F),window.history.replaceState({},document.title,window.location.pathname)}return}if(U)try{const F=Jw(U),K=JSON.parse(F);if(Array.isArray(K)&&(K.length===0||"wish"in K[0]&&"id"in K[0]))ae({title:se("url_import_title"),message:se("url_import_message"),confirmText:se("url_import_confirm"),cancelText:se("cancel_button"),onConfirm:()=>{r(K),xe(se("url_import_success")),window.history.replaceState({},document.title,window.location.pathname)},onCancel:()=>{window.history.replaceState({},document.title,window.location.pathname)}});else throw new Error("Invalid data format")}catch(F){console.error("Failed to parse data from URL",F),ae({title:se("import_error_alert_title"),message:se("url_import_error")}),window.history.replaceState({},document.title,window.location.pathname)}};S()},[se,i,J,ja,hs]),z.useEffect(()=>{if(!o||!J)return;const S=i.find(ne=>ne.id===o);if(!S||!S.collaborators||S.collaborators.length===0)return;const M=S.collaborators.find(ne=>ne.role==="owner");if(!M)return;const U=M.userId;if(!U||U.startsWith("owner_")){console.warn("⚠️ Invalid owner UID:",M);return}const q=[],F=He(ve,"users",U,"folders",o),K=Sl(F,ne=>{if(ne.exists()){const X=ne.data();X.collaborators&&s(Q=>Q.map(le=>le.id===o?{...le,collaborators:X.collaborators}:le))}},ne=>{console.warn("⚠️ 공유 폴더 메타데이터 접근 오류 (협업자 목록 업데이트 안 됨):",ne.code)});q.push(K);const W=Rt(ve,"users",U,"todos");console.log("📊 Syncing todos from owner:",{ownerUid:U,currentFolderId:o});const Y=Sl(W,ne=>{const X=[];ne.forEach(Q=>{const le=Q.data();le.folderId===o&&X.push({id:parseInt(Q.id),...le})}),console.log("🎯 Owner todos received:",{count:X.length,ownerTodos:X}),r(Q=>{const le=Q.filter(Re=>Re.folderId!==o),we=Q.filter(Re=>Re.folderId===o),ge=[],_e=new Set;return X.forEach(Re=>{ge.push(Re),_e.add(Re.id)}),we.forEach(Re=>{_e.has(Re.id)||ge.push(Re)}),[...le,...ge]})},ne=>{console.error("❌ 실시간 동기화 실패:",ne),ne.code==="permission-denied"?(console.warn("⚠️ 권한 부족으로 실시간 동기화 실패 - 수동 동기화를 사용하세요"),xe("⚠️ 실시간 동기화 실패 - 🔄 버튼으로 수동 동기화하세요")):ne.code==="not-found"?(console.warn("⚠️ 폴더를 찾을 수 없음 - 폴더가 삭제되었을 수 있습니다"),xe("⚠️ 공유 폴더를 찾을 수 없습니다")):(console.warn("⚠️ 네트워크 오류로 실시간 동기화 실패"),xe("⚠️ 네트워크 오류 - 🔄 버튼으로 재시도하세요"))});return q.push(Y),()=>{q.forEach(ne=>ne())}},[o,J]),z.useEffect(()=>{var ne,X;if(!o||!J)return;const S=i.find(Q=>Q.id===o),M=((ne=S==null?void 0:S.collaborationSettings)==null?void 0:ne.enabled)||(S==null?void 0:S.isShared)||!1,U=((X=S==null?void 0:S.collaborationSettings)==null?void 0:X.showPresence)??!0;if(!M||!U){E([]);return}console.log("👥 실시간 접속 상태 추적 시작:",{folderId:o,showPresence:U});const q=Rt(ve,"folderPresence",o,"users"),F=He(q,J.uid);(async()=>{try{await yt(F,{userId:J.uid,displayName:J.displayName||"Anonymous",photoURL:J.photoURL||null,isOnline:!0,lastSeen:new Date,currentFolder:o},{merge:!0}),console.log("✅ 내 접속 상태 등록:",J.displayName)}catch(Q){console.warn("presence set failed",Q)}})();const W=setInterval(()=>{yt(F,{lastSeen:new Date,isOnline:!0},{merge:!0}).catch(()=>{})},3e4),Y=Sl(q,Q=>{const we=Q.docs.map(ge=>{const _e=ge.data();return{userId:_e.userId||ge.id,displayName:_e.displayName||"Anonymous",photoURL:_e.photoURL||void 0,isOnline:!!_e.isOnline,lastSeen:_e.lastSeen?_e.lastSeen.toDate?_e.lastSeen.toDate():new Date(_e.lastSeen):new Date,currentFolder:_e.currentFolder}}).filter(ge=>!!ge.userId&&ge.isOnline);E(we),console.log("👥 활성 사용자 업데이트:",we.map(ge=>ge.displayName))},Q=>console.warn("presence listen failed",Q));return()=>{clearInterval(W),yt(F,{isOnline:!1,lastSeen:new Date},{merge:!0}).catch(()=>{}),Y()}},[o,J,i]),z.useCallback(async S=>{var F,K;if(!o||!J)return;const M=i.find(W=>W.id===o),U=((F=M==null?void 0:M.collaborationSettings)==null?void 0:F.showEditingState)??!0;if(!(!((K=M==null?void 0:M.collaborationSettings)!=null&&K.enabled||M!=null&&M.isShared)||!U))try{const W=He(ve,"folderEditing",`${o}_${S}`);await yt(W,{todoId:S,userId:J.uid,userName:J.displayName||"Anonymous",startTime:new Date,folderId:o}),console.log("✏️ 편집 시작:",{todoId:S,user:J.displayName})}catch(W){console.warn("start editing failed",W)}},[o,J,i]),z.useCallback(async S=>{var F,K;if(!o||!J)return;const M=i.find(W=>W.id===o),U=((F=M==null?void 0:M.collaborationSettings)==null?void 0:F.showEditingState)??!0;if(!(!((K=M==null?void 0:M.collaborationSettings)!=null&&K.enabled||M!=null&&M.isShared)||!U))try{const W=He(ve,"folderEditing",`${o}_${S}`);await Tn(W),console.log("✅ 편집 종료:",{todoId:S,user:J.displayName})}catch(W){console.warn("stop editing failed",W)}},[o,J,i]),z.useEffect(()=>{var K,W;if(!o)return;const S=i.find(Y=>Y.id===o),M=((K=S==null?void 0:S.collaborationSettings)==null?void 0:K.showEditingState)??!0;if(!(((W=S==null?void 0:S.collaborationSettings)==null?void 0:W.enabled)||(S==null?void 0:S.isShared)||!1)||!M){A({});return}console.log("✏️ 편집 상태 추적 시작:",{folderId:o});const q=cd(Rt(ve,"folderEditing"),dd("folderId","==",o)),F=Sl(q,Y=>{const ne={};Y.docs.forEach(X=>{const Q=X.data();Q&&Q.todoId&&(ne[Q.todoId]={todoId:Q.todoId,userId:Q.userId,userName:Q.userName,startTime:Q.startTime?Q.startTime.toDate?Q.startTime.toDate():new Date(Q.startTime):new Date,folderId:Q.folderId})}),A(ne),console.log("✏️ 편집 상태 업데이트:",Object.keys(ne).length+"개 항목")},Y=>console.warn("editing states listen failed",Y));return()=>F()},[o,i]),z.useCallback(async S=>{var M,U;try{const q=S.ownerId||(J==null?void 0:J.uid);if(!q)throw new Error("No owner UID");const F=i.find(X=>X.id===o),K=((M=F==null?void 0:F.collaborationSettings)==null?void 0:M.enableConflictDetection)??!0,W=((U=F==null?void 0:F.collaborationSettings)==null?void 0:U.enabled)||(F==null?void 0:F.isShared)||!1,Y=He(ve,"users",q,"todos",S.id.toString());if(W&&K){const X=await Yp(Y),Q=X.exists()?X.data():null,le=(Q==null?void 0:Q.version)||0,we=S.version||0;if(Q&&le>we&&(b(_e=>[..._e,{todoId:S.id,conflictType:"version_mismatch",localVersion:S,serverVersion:Q,lastModifiedBy:Q.lastModifiedBy||"unknown",lastModifiedAt:Q.lastModified?Q.lastModified.toDate?Q.lastModified.toDate():new Date(Q.lastModified):new Date}]),console.warn("⚠️ 충돌 감지:",{todoId:S.id,localVersion:we,serverVersion:le,lastModifiedBy:Q.lastModifiedBy}),!window.confirm("다른 사용자가 이 항목을 수정했습니다. 덮어쓰시겠습니까? (취소하면 변경이 중단됩니다)")))return!1}const ne=xt({...S,version:(S.version||0)+1,lastModified:new Date,lastModifiedBy:(J==null?void 0:J.uid)||"unknown"});return ne&&(await yt(Y,ne),console.log("✅ Todo 저장 완료:",{todoId:S.id,version:ne.version})),!0}catch(q){return console.error("attemptSaveTodo failed",q),!1}},[J,o,i]),z.useEffect(()=>{const S=window.matchMedia("(prefers-color-scheme: dark)"),M=U=>{w==="system"&&C(U.matches)};return C(w==="system"?S.matches:w==="dark"),S.addEventListener("change",M),()=>S.removeEventListener("change",M)},[w]),z.useEffect(()=>{const S=()=>{console.log("🌐 인터넷 연결됨"),xe("✅ 인터넷에 다시 연결되었습니다"),setTimeout(()=>xe(""),3e3)},M=()=>{console.log("📡 인터넷 연결 끊김"),xe("⚠️ 오프라인 모드 - 클라우드 동기화 불가"),setTimeout(()=>xe(""),5e3)};return navigator.onLine||console.log("📡 현재 오프라인 상태"),window.addEventListener("online",S),window.addEventListener("offline",M),()=>{window.removeEventListener("online",S),window.removeEventListener("offline",M)}},[]),z.useEffect(()=>{const S=localStorage.getItem("pwa-prompt-dismissed"),M=zw(),U=Hw();console.log("PWA Check:",{isMobileDevice:M,isInStandalone:U,isDismissed:S,userAgent:navigator.userAgent}),M&&!U&&!S&&(console.log("Showing PWA prompt immediately"),Ga(!0))},[]),z.useEffect(()=>{"serviceWorker"in navigator&&navigator.serviceWorker.register("/Nova-AI-Planer/sw.js").then(S=>{console.log("SW registered: ",S);const M=Hw(),U=zw();M&&U&&setTimeout(()=>{nR().then(q=>{q&&rR()})},2e3)}).catch(S=>{console.log("SW registration failed: ",S)})},[]),z.useEffect(()=>{},[w,D]);const ni=z.useRef(null);z.useEffect(()=>{if(!(!ur||!J))return ni.current&&clearTimeout(ni.current),ni.current=setTimeout(()=>{Rr()},5e3),()=>{ni.current&&clearTimeout(ni.current)}},[n,i,t,w,D,V,Dn,T,ur,J]),z.useEffect(()=>{const S=tg.find(U=>U.id===V)||tg[0],M=D?S.darkThemeClass:S.lightThemeClass;document.body.className="",D&&document.body.classList.add("dark-mode"),M&&document.body.classList.add(M)},[V,D]),z.useEffect(()=>{if(lo){const S=setTimeout(()=>xe(""),3e3);return()=>clearTimeout(S)}},[lo]);const po=z.useMemo(()=>{let S=[...n];if(o===null)S=S.filter(M=>{if(M.isSharedTodo===!0)return!1;const U=i.find(q=>q.id===M.folderId);return U?U.isShared!==!0:!0});else if(o!=="all"){const M=i.find(U=>U.id===o);M&&M.isShared?S=S.filter(U=>U.folderId===o):S=S.filter(U=>U.folderId===o)}return g==="deadline"?S.sort((M,U)=>!M.deadline&&!U.deadline?0:M.deadline?U.deadline?new Date(M.deadline).getTime()-new Date(U.deadline).getTime():-1:1):g==="newest"?S.sort((M,U)=>U.id-M.id):g==="alphabetical"&&S.sort((M,U)=>M.wish.localeCompare(U.wish)),l==="active"&&(S=S.filter(M=>!M.completed)),l==="completed"&&(S=S.filter(M=>M.completed)),f!=="all"&&(S=S.filter(M=>(M.category||"other")===f)),S},[n,l,g,f,o]),Xa=async S=>{const M={...S,id:Date.now(),completed:!1,lastCompletedDate:null,streak:0,folderId:o==="all"||o===null?void 0:o};if(J)try{const U=i.find(Y=>Y.id===o),q=(U==null?void 0:U.ownerId)||J.uid,F=Rt(ve,"users",q,"todos"),K=He(F,M.id.toString()),W=xt(M);W?(await yt(K,W),console.log("✅ 목표 Firestore 저장:",{targetOwnerUid:q,newTodo:W})):console.warn("⚠️ 정제 후 저장할 데이터가 없음")}catch(U){console.error("❌ 목표 Firestore 저장 실패:",U)}r(U=>[M,...U]),Fe(!1)},Za=async S=>{const M=S.map((U,q)=>({...U,id:Date.now()+q,completed:!1,lastCompletedDate:null,streak:0,folderId:o||void 0})).reverse();if(J)try{const U=i.find(F=>F.id===o),q=(U==null?void 0:U.ownerId)||J.uid;for(const F of M){const K=Rt(ve,"users",q,"todos"),W=He(K,F.id.toString()),Y=xt(F);Y?await yt(W,Y):console.warn("⚠️ 정제 후 저장할 데이터가 없음:",F.id)}console.log("✅ 여러 목표 Firestore 저장:",{targetOwnerUid:q,count:M.length})}catch(U){console.error("❌ 여러 목표 Firestore 저장 실패:",U)}r(U=>[...M,...U]),Fe(!1)},el=async S=>{if(J)try{const M=i.find(W=>W.id===S.folderId),U=(M==null?void 0:M.ownerId)||J.uid,q=Rt(ve,"users",U,"todos"),F=He(q,S.id.toString()),K=xt(S);K?(await yt(F,K),console.log("✅ 목표 업데이트 Firestore 저장:",{targetOwnerUid:U,updatedTodo:K})):console.warn("⚠️ 정제 후 저장할 데이터가 없음")}catch(M){console.error("❌ 목표 업데이트 Firestore 저장 실패:",M)}r(n.map(M=>M.id===S.id?S:M)),Te(null)},cc=async S=>{const M=n.find(q=>q.id===S),U=n.filter(q=>q.id!==S);if(r(U),J&&M)try{const q=i.find(Y=>Y.id===M.folderId),F=(q==null?void 0:q.ownerId)||J.uid,K=Rt(ve,"users",F,"todos"),W=He(K,S.toString());await Tn(W),console.log("✅ 개별 목표 Firestore 삭제:",{targetOwnerUid:F,id:S});try{const Y=He(ve,"users",F,"data","todos");await yt(Y,{todos:U,lastUpdated:new Date().toISOString()},{merge:!0}),console.log("✅ 백업 데이터 업데이트 완료 - 삭제 반영")}catch(Y){console.warn("⚠️ 백업 데이터 업데이트 실패:",Y)}ur&&setTimeout(()=>{Rr()},1e3)}catch(q){console.error("❌ 목표 Firestore 삭제 실패:",q),M&&r(F=>[...F,M])}},dc=async S=>{var U;if(!S.trim()){ae({title:"Error",message:"Folder name cannot be empty."});return}const M={id:Date.now().toString(),name:S,ownerId:((U=pi.currentUser)==null?void 0:U.uid)||"unknown",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),color:"#3b82f6",collaborationSettings:{enabled:!1,showPresence:!0,showEditingState:!0,enableConflictDetection:!0,allowGuestView:!1,requireApproval:!0},isShared:!1};if(s([...i,M]),J)try{const{doc:q,setDoc:F}=await Nr(async()=>{const{doc:W,setDoc:Y}=await Promise.resolve().then(()=>Ts);return{doc:W,setDoc:Y}},void 0),K=q(ve,"users",J.uid,"folders",M.id);await F(K,{name:M.name,color:M.color,ownerId:M.ownerId,createdAt:M.createdAt,updatedAt:M.updatedAt,isShared:M.isShared,collaborators:[],collaborationSettings:M.collaborationSettings}),console.log("✅ 폴더 Firebase 저장 완료:",M.id)}catch(q){console.error("❌ 폴더 Firebase 저장 실패:",q)}return console.log("📁 새 폴더 생성:",{name:S,collaborationEnabled:!1}),M},tl=z.useCallback(async(S,M)=>{try{if(s(U=>U.map(q=>{if(q.id===S){const F={...q.collaborationSettings,...M};return console.log("⚙️ 공동작업 설정 업데이트:",{folderId:S,settings:F}),{...q,collaborationSettings:F,updatedAt:new Date().toISOString()}}return q})),J){const U=He(ve,"users",J.uid,"folders",S);await Xp(U,{collaborationSettings:{...M},updatedAt:new Date().toISOString()})}}catch(U){console.error("공동작업 설정 업데이트 실패:",U)}},[J]),cr=z.useCallback(async(S,M)=>{await tl(S,{enabled:M}),M?(s(U=>U.map(q=>q.id===S?{...q,isShared:!0}:q)),console.log("🤝 폴더 공동작업 활성화:",S)):(E([]),A({}),console.log("🔒 폴더 공동작업 비활성화:",S))},[tl]);z.useCallback(()=>{if(!o)return null;const S=i.find(M=>M.id===o);return(S==null?void 0:S.collaborationSettings)||null},[o,i]);const Mn=(S,M)=>{if(!M.trim()){ae({title:"Error",message:"Folder name cannot be empty."});return}s(i.map(U=>U.id===S?{...U,name:M,updatedAt:new Date().toISOString()}:U))},ri=async S=>{const M=i.find(q=>q.id===S);if(!M)return;const U=n.filter(q=>q.folderId===S);if(J&&U.length>0)try{for(const q of U){const F={...q};delete F.folderId;const K=M.ownerId||J.uid,W=Rt(ve,"users",K,"todos"),Y=He(W,q.id.toString()),ne=xt(F);ne&&await yt(Y,ne)}}catch(q){console.error("❌ 폴더 삭제 시 목표 이동 실패:",q)}if(J)try{const q=He(ve,"users",J.uid,"folders",S);await Tn(q)}catch(q){console.error("❌ 폴더 Firebase 삭제 실패:",q)}r(q=>q.map(F=>{if(F.folderId===S){const K={...F};return delete K.folderId,K}return F})),s(q=>q.filter(F=>F.id!==S)),o===S&&a(null)},ii=async S=>{if(!Pe.trim()||!J){ze("");return}try{const M={...S,name:Pe.trim(),updatedAt:new Date().toISOString()},U=He(ve,"users",J.uid,"folders",S.id),q=xt(M);if(q)await yt(U,q),console.log("✅ 폴더 이름 변경 Firestore 저장 완료");else throw new Error("폴더 데이터 정제 실패");s(i.map(F=>F.id===S.id?M:F)),ze(""),console.log("✅ 폴더 이름 변경 완료:",Pe.trim())}catch(M){console.error("❌ 폴더 이름 변경 실패:",M),ze("")}},nl=async S=>{var M;if(!(!je.trim()||!J||en)){_n(!0);try{if(((M=S.sharedWith)==null?void 0:M.some(Y=>Y.email===je.trim()))||S.ownerEmail===je.trim()){alert("이미 초대된 사용자입니다."),_n(!1);return}const q={email:je.trim(),userId:"",role:ut,addedAt:new Date().toISOString()},F={...S,sharedWith:[...S.sharedWith||[],q],updatedAt:new Date().toISOString()},K=He(ve,"users",J.uid,"folders",S.id),W=xt(F);if(W)await yt(K,W),console.log("✅ 협업자 초대 Firestore 저장 완료");else throw new Error("폴더 데이터 정제 실패");s(i.map(Y=>Y.id===S.id?{...F,sharedWith:Array.isArray(F.sharedWith)?F.sharedWith.filter(ne=>ne&&typeof ne.role=="string"&&["owner","editor","viewer"].includes(ne.role)).map(ne=>({...ne,role:ne.role})):[]}:Y)),Mt(""),console.log("✅ 협업자 초대 완료:",q)}catch(U){console.error("❌ 협업자 초대 실패:",U)}finally{_n(!1)}}},Xe=async(S,M,U)=>{var q;if(J)try{const F={...S,sharedWith:(q=S.sharedWith)==null?void 0:q.map(Y=>Y.userId===M?{...Y,role:U}:Y),updatedAt:new Date().toISOString()},K=He(ve,"users",J.uid,"folders",S.id),W=xt(F);if(W)await yt(K,W);else throw new Error("폴더 데이터 정제 실패");s(i.map(Y=>Y.id===S.id?{...F,sharedWith:Array.isArray(F.sharedWith)?F.sharedWith.filter(ne=>ne&&typeof ne.role=="string"&&["owner","editor","viewer"].includes(ne.role)).map(ne=>({...ne,role:ne.role})):[]}:Y)),console.log("✅ 협업자 역할 변경 완료:",{userId:M,newRole:U})}catch(F){console.error("❌ 협업자 역할 변경 실패:",F)}},mo=async(S,M)=>{var U;if(J&&confirm("이 협업자를 제거하시겠습니까?"))try{const q={...S,sharedWith:(U=S.sharedWith)==null?void 0:U.filter(W=>W.userId!==M),updatedAt:new Date().toISOString()},F=He(ve,"users",J.uid,"folders",S.id),K=xt(q);if(K)await yt(F,K);else throw new Error("폴더 데이터 정제 실패");s(i.map(W=>W.id===S.id?q:W)),console.log("✅ 협업자 제거 완료:",M)}catch(q){console.error("❌ 협업자 제거 실패:",q)}},fs=S=>{const M=`${window.location.origin}${window.location.pathname}?invite=${S.id}`;navigator.clipboard.writeText(M).then(()=>{alert("공유 링크가 복사되었습니다!")}).catch(()=>{alert("링크 복사에 실패했습니다.")})},ps=S=>{confirm(se("folder_leave_confirm"))&&vf(S)},vf=async S=>{var M;if(J)try{const U={...S,sharedWith:(M=S.sharedWith)==null?void 0:M.filter(K=>K.userId!==J.uid),updatedAt:new Date().toISOString()},q=He(ve,"users",S.ownerId,"folders",S.id),F=xt(U);if(F)await yt(q,F);else throw new Error("폴더 데이터 정제 실패");s(i.filter(K=>K.id!==S.id)),o===S.id&&a(null),ce(!1),console.log("✅ 폴더 나가기 완료")}catch(U){console.error("❌ 폴더 나가기 실패:",U)}},hc=S=>{confirm(se("folder_delete_confirm"))&&(ri(S.id),ce(!1))},Tf=S=>{if(a(S),S&&J){const M=i.find(U=>U.id===S);M!=null&&M.ownerId&&(async()=>{try{console.log("📥 Firestore에서 폴더 목표 로드:",{folderId:S,ownerUid:M.ownerId});const U=Rt(ve,"users",M.ownerId,"todos"),q=cd(U,dd("folderId","==",S)),F=await Po(q),K=[];F.forEach(W=>{K.push({id:parseInt(W.id),...W.data()})}),console.log("✅ 폴더 목표 로드 완료:",{count:K.length,todos:K}),r(W=>{const Y=W.filter(le=>le.folderId!==S),ne=new Set(Y.map(le=>le.id)),X=K.filter(le=>!ne.has(le.id)),Q=[...Y,...X];return console.log("🔄 목표 병합 완료:",{기존목표:Y.length,새로운목표:X.length,전체목표:Q.length,중복제거됨:K.length-X.length}),Q})}catch(U){console.error("❌ 폴더 목표 로드 실패:",U)}})()}},Ef=async()=>{if(!o||!J){xe("❌ 동기화할 폴더가 없습니다");return}Et(!0);try{console.log("🔄 폴더 정보 재로딩 중...",o);const{doc:S,getDoc:M,collection:U,query:q,where:F,getDocs:K}=await Nr(async()=>{const{doc:_e,getDoc:Re,collection:Ue,query:it,where:Wn,getDocs:Vn}=await Promise.resolve().then(()=>Ts);return{doc:_e,getDoc:Re,collection:Ue,query:it,where:Wn,getDocs:Vn}},void 0);let W=i.find(_e=>_e.id===o);if(!W||!W.collaborators||W.collaborators.length===0){console.log("⚠️ 로컬 폴더 정보가 불완전함, Firebase에서 재로딩...");const _e=S(ve,"users",J.uid,"folders",o),Re=await M(_e);if(Re.exists())W={id:o,...Re.data()},console.log("✅ 사용자 폴더에서 로드됨:",W);else{console.log("🔍 공유된 폴더 검색 중..."),ae({title:"📡 폴더 정보 로딩 중",message:`폴더 정보를 불러오는 중입니다.
잠시 후 다시 시도하거나 새로고침해주세요.`,confirmText:"확인",onConfirm:()=>ae(null)}),Et(!1);return}}if(!W||!W.collaborators||W.collaborators.length===0){ae({title:"❌ 협업 폴더 아님",message:`이것은 공유 폴더가 아닙니다.
개인 폴더는 개별적으로 동기화됩니다.`,confirmText:"확인",onConfirm:()=>ae(null)}),Et(!1);return}const Y=W.collaborators.find(_e=>_e.role==="owner");if(!Y||!Y.userId){ae({title:"❌ 소유자 정보 오류",message:`폴더 소유자 정보가 없습니다.
폴더를 다시 공유받아주세요.`,confirmText:"확인",onConfirm:()=>ae(null)}),Et(!1);return}if(Y.userId.startsWith("owner_")){console.warn("⚠️ 임시 소유자 ID 발견:",Y.userId),ae({title:"⚠️ 소유자 정보 오류",message:`폴더 소유자 정보에 문제가 있습니다.
폴더 소유자에게 새로운 공유 링크를 요청해주세요.`,confirmText:"확인",onConfirm:()=>ae(null)}),Et(!1);return}console.log("🔄 수동 동기화 시작:",{folderId:o,ownerUid:Y.userId});const ne=n.filter(_e=>_e.folderId===o);console.log("📊 현재 로컬 목표 수:",ne.length);const X=U(ve,"users",Y.userId,"todos"),Q=q(X,F("folderId","==",o)),le=await K(Q),we=[];le.forEach(_e=>{we.push({id:parseInt(_e.id),..._e.data()})}),console.log("📊 서버 목표 수:",we.length),ne.length===we.length?(console.log("✅ 실시간 동기화가 정상 작동 중입니다"),xe(`✅ 동기화 확인 완료 (${we.length}개 항목 - 이미 최신 상태)`)):(console.log("⚠️ 로컬과 서버 데이터 불일치 감지:",{local:ne.length,server:we.length}),r(_e=>[..._e.filter(it=>it.folderId!==o),...we]),xe(`🔄 동기화 완료 (${we.length}개 항목 - ${Math.abs(we.length-ne.length)}개 차이 수정)`)),console.log("📡 실시간 리스너 상태:",o&&J?"활성":"비활성")}catch(S){console.error("❌ 동기화 실패:",S),S instanceof Error?S.message.includes("permission-denied")?xe("❌ 동기화 실패: 폴더 접근 권한이 없습니다"):S.message.includes("not-found")?xe("❌ 동기화 실패: 폴더를 찾을 수 없습니다"):xe("❌ 동기화 실패: "+S.message):xe("❌ 동기화 실패: 알 수 없는 오류")}finally{Et(!1)}},wf=async()=>{Et(!0);try{console.log("🔄 수동 동기화 시작..."),await Rr(),xe("✅ 데이터 동기화 완료"),console.log("✅ 수동 동기화 완료")}catch(S){console.error("❌ 수동 동기화 실패:",S),xe("❌ 동기화 실패")}finally{Et(!1)}},If=async(S,M)=>{const U=n.find(W=>W.id===S);if(!U)return;const q=i.find(W=>W.id===M),F=(q==null?void 0:q.isShared)===!0,K={...U,folderId:M||void 0,isSharedTodo:F};if(J)try{const W=i.find(le=>le.id===(M||U.folderId)),Y=(W==null?void 0:W.ownerId)||J.uid,ne=Rt(ve,"users",Y,"todos"),X=He(ne,S.toString()),Q=xt(K);Q?(await yt(X,Q),console.log("✅ 목표 폴더 이동 Firestore 저장:",{targetOwnerUid:Y,goalId:S,folderId:M,isSharedTodo:K.isSharedTodo})):console.warn("⚠️ 정제 후 저장할 데이터가 없음")}catch(W){console.error("❌ 목표 폴더 이동 Firestore 저장 실패:",W)}r(n.map(W=>W.id===S?K:W)),xe("✅ 목표가 폴더로 이동되었습니다"),setTimeout(()=>xe(""),3e3)},ms=async S=>{const M=new Date().toISOString(),U=(()=>{const q=n.find(W=>W.id===S);if(!q)return null;const F=!q.completed;let K=q.streak;return q.isRecurring&&(F?(!q.lastCompletedDate||!Ql(M,q.lastCompletedDate))&&(K=(q.streak||0)+1):q.lastCompletedDate&&Ql(M,q.lastCompletedDate)&&(K=Math.max(0,(q.streak||1)-1))),{...q,completed:F,lastCompletedDate:F?M:q.lastCompletedDate,streak:K}})();if(U){if(J)try{const q=i.find(ne=>ne.id===U.folderId),F=(q==null?void 0:q.ownerId)||J.uid,K=Rt(ve,"users",F,"todos"),W=He(K,S.toString()),Y=xt(U);Y?(await yt(W,Y),console.log("✅ 목표 완료 상태 Firestore 저장:",{targetOwnerUid:F,id:S,completed:U.completed})):console.warn("⚠️ 정제 후 저장할 데이터가 없음")}catch(q){console.error("❌ 목표 완료 상태 Firestore 저장 실패:",q)}r(n.map(q=>q.id===S?U:q))}},Pr=async S=>{if(S==="ai"){if(n.length<2){ae({title:se("sort_alert_title"),message:se("sort_alert_message")});return}Me(!0);try{const M=bn();if(!M){xe(_t?"오프라인 모드에서는 AI 정렬을 사용할 수 없습니다.":"AI 정렬을 사용하려면 설정에서 API 키를 입력해주세요."),Me(!1),v("manual");return}const U=`Here is a list of goals with their details (wish, outcome, obstacle, plan, deadline). Prioritize them based on urgency (closer deadline), importance (based on outcome), and feasibility (based on plan). Return a JSON object with "sorted_ids" array and "reasoning" string explaining your prioritization logic. Goals: ${JSON.stringify(n.map(({id:Q,wish:le,outcome:we,obstacle:ge,plan:_e,deadline:Re})=>({id:Q,wish:le,outcome:we,obstacle:ge,plan:_e,deadline:Re})))}`,q=await M.models.generateContent({model:"gemini-2.5-flash",contents:U,config:{responseMimeType:"application/json",responseSchema:{type:Bn.OBJECT,properties:{sorted_ids:{type:Bn.ARRAY,items:{type:Bn.NUMBER}},reasoning:{type:Bn.STRING}}}}}),F=JSON.parse(q.text),K=F.sorted_ids.map(Number),W=new Map(n.map(Q=>[Number(Q.id),Q])),Y=K.map(Q=>W.get(Q)).filter(Boolean),ne=n.filter(Q=>!K.includes(Number(Q.id))),X=[...Y,...ne].map(Q=>({...Q,id:Number(Q.id)}));r(X),v("manual"),os(F.reasoning||""),as(!0)}catch(M){console.error("AI sort failed:",M),ae({title:se("ai_sort_error_title"),message:se("ai_sort_error_message")})}finally{Me(!1)}}else v(S)},fc=S=>{const M=new Set(rs);M.has(S)?M.delete(S):M.add(S),is(M)},rl=()=>{ti(!1),is(new Set)},pc=()=>{const S=new Set(po.map(M=>M.id));is(S)},mc=()=>{const S=rs.size;ae({title:se("delete_selected_confirm_title"),message:se("delete_selected_confirm_message").replace("{count}",String(S)),isDestructive:!0,confirmText:se("delete_selected_button_label").replace("{count}",String(S)),cancelText:se("cancel_button"),onConfirm:()=>{r(n.filter(M=>!rs.has(M.id))),rl()}})},gc=()=>{Ar("exporting");const S=JSON.stringify(n,null,2),M="data:application/json;charset=utf-8,"+encodeURIComponent(S),U="nova_goals.json",q=document.createElement("a");q.setAttribute("href",M),q.setAttribute("download",U),q.click(),setTimeout(()=>{Ar("idle"),cn(!1)},1500)},si=S=>{var q;const M=(q=S.target.files)==null?void 0:q[0];if(!M)return;const U=new FileReader;U.onload=F=>{var K;try{const W=(K=F.target)==null?void 0:K.result;if(typeof W!="string")throw new Error("File content is not a string");const Y=JSON.parse(W);if(Array.isArray(Y)&&Y.every(ne=>"wish"in ne&&"id"in ne))ae({title:se("import_confirm_title"),message:se("import_confirm_message"),confirmText:se("settings_import_data"),cancelText:se("cancel_button"),onConfirm:()=>{Ar("importing"),setTimeout(()=>{r(Y),xe(se("import_success_toast")),Ar("idle"),cn(!1)},1500)}});else throw new Error("Invalid file format")}catch{ae({title:se("import_error_alert_title"),message:se("import_error_alert_message")})}},U.onerror=()=>ae({title:se("import_error_alert_title"),message:se("import_error_alert_message")}),U.readAsText(M),S.target.value=""},Sf=()=>{ae({title:"⚠️ 계정 삭제",message:`정말로 계정과 모든 데이터를 삭제하시겠습니까?

이 작업은 되돌릴 수 없습니다:

• 계정 및 모든 목표, 폴더, 설정, 협업 정보
• Firebase 클라우드 데이터
• 로컬 설정 및 공유 폴더 데이터`,confirmText:"계정 완전 삭제",cancelText:"취소",isDestructive:!0,onConfirm:async()=>{ae(null);try{await Cf(),setTimeout(()=>{typeof window<"u"&&window.location.reload()},2e3)}catch(S){ae({title:"❌ 계정 삭제 실패",message:`계정 삭제 중 오류가 발생했습니다.

`+(S instanceof Error?S.message:""),confirmText:"확인",onConfirm:()=>ae(null)})}},onCancel:()=>{ae(null)}})},Cf=async()=>{console.log("🗑️ performDeleteAccount 함수 시작"),Ar("deleting");try{if(J){console.log("📧 사용자 정보:",{uid:J.uid,email:J.email}),console.log("🗑️ Firebase 데이터 삭제 시작...");const{firestoreFetch:S}=await Nr(async()=>{const{firestoreFetch:F}=await Promise.resolve().then(()=>P0);return{firestoreFetch:F}},void 0),M="my-apss-da774";try{await S(`/users/${J.uid}/data/todos`,{method:"DELETE"}),console.log("✅ REST todos 문서 삭제 완료")}catch(F){console.warn("⚠️ REST todos 문서 삭제 실패:",F)}try{await S(`/users/${J.uid}/data/settings`,{method:"DELETE"}),console.log("✅ REST settings 문서 삭제 완료")}catch(F){console.warn("⚠️ REST settings 문서 삭제 실패:",F)}try{const F=await S(`/users/${J.uid}/todos`,{method:"GET"});F.documents&&await Promise.all(F.documents.map(K=>S(`/users/${J.uid}/todos/${K.name.split("/").pop()}`,{method:"DELETE"}))),console.log("✅ REST todos 컬렉션 삭제 완료")}catch(F){console.warn("⚠️ REST todos 컬렉션 삭제 실패:",F)}try{const F=await S(`/users/${J.uid}/folders`,{method:"GET"});F.documents&&await Promise.all(F.documents.map(K=>S(`/users/${J.uid}/folders/${K.name.split("/").pop()}`,{method:"DELETE"}))),console.log("✅ REST folders 컬렉션 삭제 완료")}catch(F){console.warn("⚠️ REST folders 컬렉션 삭제 실패:",F)}try{await S(`/users/${J.uid}`,{method:"DELETE"}),console.log("✅ REST 사용자 프로필 문서 삭제 완료")}catch(F){console.warn("⚠️ REST 사용자 프로필 문서 삭제 실패:",F)}const U=Rt(ve,"sharedFolders"),q=await Po(U);for(const F of q.docs){const K=F.data();if(K.collaborators&&Array.isArray(K.collaborators)){const W=K.collaborators.filter(Y=>Y.userId!==J.uid);W.length!==K.collaborators.length&&(await Xp(F.ref,{collaborators:W}),console.log("✅ 공유 폴더에서 내 계정 제거:",F.id))}}try{for(const F of i)if(F.id){const K=He(ve,"folderPresence",F.id,"users",J.uid);await Tn(K)}console.log("✅ presence 데이터 삭제 완료")}catch(F){console.warn("⚠️ presence 데이터 삭제 중 일부 오류:",F)}try{const F=cd(Rt(ve,"folderEditing"),dd("userId","==",J.uid)),W=(await Po(F)).docs.map(Y=>Tn(Y.ref));await Promise.all(W),console.log("✅ editing states 삭제 완료")}catch(F){console.warn("⚠️ editing states 삭제 중 일부 오류:",F)}try{const F=He(ve,"users",J.uid);await Tn(F),console.log("✅ 사용자 프로필 문서 삭제 완료")}catch(F){console.warn("⚠️ 사용자 프로필 문서 삭제 실패:",F)}try{const F=Rt(ve,"notifications",J.uid,"items"),W=(await Po(F)).docs.map(ne=>Tn(ne.ref));await Promise.all(W);const Y=He(ve,"notifications",J.uid);await Tn(Y),console.log("✅ 알림 데이터 삭제 완료")}catch(F){console.warn("⚠️ 알림 데이터 삭제 중 일부 오류:",F)}try{const F=Rt(ve,"userActivity",J.uid,"logs"),W=(await Po(F)).docs.map(ne=>Tn(ne.ref));await Promise.all(W);const Y=He(ve,"userActivity",J.uid);await Tn(Y),console.log("✅ 사용자 활동 로그 삭제 완료")}catch(F){console.warn("⚠️ 사용자 활동 로그 삭제 중 일부 오류:",F)}try{const F=He(ve,"userMetadata",J.uid);await Tn(F),console.log("✅ 사용자 메타데이터 삭제 완료")}catch(F){console.warn("⚠️ 사용자 메타데이터 삭제 중 일부 오류:",F)}try{const F=He(ve,"userSessions",J.uid);await Tn(F),console.log("✅ 사용자 세션 데이터 삭제 완료")}catch(F){console.warn("⚠️ 사용자 세션 데이터 삭제 중 일부 오류:",F)}console.log("🔥 모든 클라우드 데이터 삭제 완료 - 사용자 데이터가 완전히 제거되었습니다")}if(console.log("🔄 로컬 상태 초기화 시작..."),r([]),s([]),E([]),A({}),b([]),a(null),is(new Set),ti(!1),u("all"),m("all"),console.log("⚙️ 설정 초기화 시작..."),e("ko"),C(!0),O("default"),v("manual"),x(["school","work","personal","other"]),console.log("💾 localStorage 초기화 시작..."),localStorage.clear(),console.log("✅ localStorage 완전 삭제 완료"),J)try{await J.delete(),console.log("✅ Firebase 계정 삭제 완료")}catch(S){throw S.code==="auth/requires-recent-login"&&ae({title:"재로그인 필요",message:`계정 삭제를 위해 다시 로그인해야 합니다.
로그아웃 후 재로그인 후 다시 시도해주세요.`,confirmText:"확인",onConfirm:()=>ae(null)}),S}console.log("✅ 계정 및 모든 데이터 삭제 완료"),xe("✅ 계정이 완전히 삭제되었습니다."),setTimeout(()=>{window.location.reload()},1500)}catch(S){console.error("❌ 데이터 삭제 중 오류:",S);let M="❌ 삭제 실패",U="데이터 삭제 중 오류가 발생했습니다.";S instanceof Error&&(S.message.includes("permission-denied")||S.message.includes("insufficient permissions")?(M="❌ 권한 부족",U=`삭제 권한이 부족합니다.

잠시 후 다시 시도해주세요.
(Firebase 보안 규칙이 업데이트 중일 수 있습니다)`):S.message.includes("network-request-failed")?(M="❌ 네트워크 오류",U="인터넷 연결을 확인하고 다시 시도해주세요."):S.message.includes("unauthenticated")?(M="❌ 로그인 필요",U=`로그인이 만료되었습니다.
다시 로그인해주세요.`):U=`데이터 삭제 중 오류가 발생했습니다.

오류 내용: `+S.message),ae({title:M,message:U,confirmText:"확인",onConfirm:()=>ae(null)})}finally{Ar("idle"),cn(!1)}},Af=De||!!Ke||!!Nn||lr||!!ct||ss||nc;return p.jsxs("div",{className:`main-page-layout ${Ct?"calendar-view-active":""}`,children:[p.jsxs("div",{className:`page-content ${Af?"modal-open":""}`,children:[p.jsx(U3,{folders:i,currentFolderId:o,onSetCurrentFolder:Tf,onCreateFolder:dc,onRenameFolder:Mn,onDeleteFolder:ri,onSetCollaboratingFolder:ls,todos:n,t:se,onManageFolder:S=>{Ee(S),ce(!0)},currentUserId:J==null?void 0:J.uid}),p.jsxs("div",{className:"container",children:[p.jsx(O3,{t:se,isSelectionMode:Vt,selectedCount:rs.size,totalVisibleCount:po.length,onCancelSelection:rl,onDeleteSelected:mc,onSelectAll:pc,isViewModeCalendar:Ct,onToggleViewMode:()=>qe(!Ct),isAiSorting:Cr,sortType:g,onSort:Pr,filter:l,onFilter:u,categoryFilter:f,onCategoryFilter:m,userCategories:T,onAddCategory:S=>x([...T,S]),onRemoveCategory:S=>x(T.filter(M=>M!==S)),onSetSelectionMode:()=>ti(!0),onOpenSettings:()=>cn(!0),onAddGoal:()=>Fe(!0),currentFolderId:o,folders:i,onSyncSharedFolder:Ef,isSyncing:Wa,isSyncingData:Wa,onManualSync:wf,activeUsers:B,editingStates:I,onToggleCollaboration:cr,onUpdateCollaborationSettings:tl}),Ct?p.jsx(j3,{todos:n,t:se,onGoalClick:ar,language:t}):p.jsx(p.Fragment,{children:p.jsx(B3,{todos:po,onToggleComplete:ms,onDelete:cc,onEdit:Te,onInfo:ar,t:se,filter:l,randomEncouragement:uc,isSelectionMode:Vt,selectedTodoIds:rs,onSelectTodo:fc,folders:i,onMoveToFolder:If})})]})]}),De&&p.jsx(Yw,{onClose:()=>Fe(!1),onAddTodo:Xa,onAddMultipleTodos:Za,t:se,language:t,createAI:bn,userCategories:T}),Ke&&p.jsx(Yw,{onClose:()=>Te(null),onEditTodo:el,existingTodo:Ke,t:se,language:t,createAI:bn}),Nn&&p.jsx(z3,{todo:Nn,onClose:()=>ar(null),t:se,createAI:bn,onOpenCollaboration:S=>{const M=i.find(U=>U.id===S.folderId)||(S.folderId===null||S.folderId===void 0?null:void 0);M!==void 0&&ls(M||null)},userCategories:T,onUpdateGoal:el}),yn!==void 0&&p.jsx(H3,{folder:yn,onClose:()=>ls(void 0),t:se,googleUser:J,onUpdateCollaborators:lc,setAlertConfig:ae}),lr&&p.jsx(W3,{onClose:()=>cn(!1),isDarkMode:D,onToggleDarkMode:()=>C(!D),themeMode:w,onThemeChange:Qa,backgroundTheme:V,onSetBackgroundTheme:O,onExportData:gc,onImportData:si,setAlertConfig:ae,onDeleteAllData:Sf,dataActionStatus:tc,language:t,onSetLanguage:e,t:se,todos:n,setToastMessage:xe,onOpenVersionInfo:()=>Oa(!0),onOpenUsageGuide:()=>Ba(!0),apiKey:Dn,onSetApiKey:us,isOfflineMode:_t,onToggleOfflineMode:()=>ic(!_t),googleUser:J,onGoogleLogin:ja,onGoogleLogout:yf,onSyncDataToFirebase:Rr,onLoadDataFromFirebase:Ja,isGoogleLoggingIn:sc,isGoogleLoggingOut:Ha,isSyncingData:Wa,isLoadingData:oc,isAutoSyncEnabled:ur,setIsAutoSyncEnabled:cs,onDiagnoseFirebase:ac}),ss&&p.jsx(Xw,{onClose:()=>Oa(!1),t:se}),nc&&p.jsx(K3,{onClose:()=>Ba(!1),t:se}),qa&&p.jsx(ao,{onClose:()=>as(!1),isClosing:!1,className:"ai-sort-reason-modal",children:p.jsxs("div",{style:{padding:"24px"},children:[p.jsx("h2",{style:{marginBottom:"16px",fontSize:"1.3rem",fontWeight:600},children:se("ai_sort_reason_modal_title")}),p.jsx("div",{style:{marginBottom:"24px",padding:"16px",backgroundColor:"var(--card-bg-color)",borderRadius:"8px",border:"1px solid var(--border-color)",lineHeight:"1.6",color:"var(--text-secondary-color)"},children:rc}),p.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:p.jsx("button",{onClick:()=>as(!1),className:"primary",children:se("close_button")})})]})}),ss&&p.jsx(Xw,{onClose:()=>Oa(!1),t:se}),ct&&p.jsx(J3,{title:ct.title,message:ct.message,onConfirm:()=>{var S;(S=ct.onConfirm)==null||S.call(ct),ae(null)},onCancel:ct.onCancel?()=>{var S;(S=ct.onCancel)==null||S.call(ct),ae(null)}:void 0,confirmText:ct.confirmText,cancelText:ct.cancelText,isDestructive:ct.isDestructive,t:se}),lo&&p.jsx("div",{className:"toast-notification",children:lo}),uo&&p.jsx(b3,{onClose:()=>Ga(!1)}),te&&me&&p.jsx("div",{className:"modal-backdrop",onClick:()=>ce(!1),children:p.jsxs("div",{className:"modal-content large-modal",onClick:S=>S.stopPropagation(),children:[p.jsxs("div",{className:"modal-header",children:[p.jsx("h3",{children:se("folder_manage_title")}),p.jsx("button",{onClick:()=>ce(!1),children:"✕"})]}),p.jsx("div",{className:"modal-body",children:(()=>{var q,F,K;const S=i.find(W=>W.id===me);if(!S)return null;const M=S.ownerId===(J==null?void 0:J.uid),U=M?"owner":((F=(q=S.sharedWith)==null?void 0:q.find(W=>W.userId===(J==null?void 0:J.uid)))==null?void 0:F.role)||"viewer";return p.jsxs("div",{className:"folder-manage-content",children:[p.jsxs("div",{className:"folder-info-section",children:[p.jsx("h4",{children:se("folder_manage_info")}),p.jsxs("div",{className:"folder-info-item",children:[p.jsxs("label",{children:[se("folder_name"),":"]}),Pe?p.jsxs("div",{className:"inline-edit",children:[p.jsx("input",{type:"text",value:Pe,onChange:W=>ze(W.target.value),onKeyPress:W=>{W.key==="Enter"&&ii(S)}}),p.jsx("button",{onClick:()=>ii(S),children:"✓"}),p.jsx("button",{onClick:()=>ze(""),children:"✕"})]}):p.jsxs("div",{className:"folder-name-display",children:[p.jsx("span",{children:S.name}),M&&p.jsx("button",{className:"edit-btn",onClick:()=>ze(S.name),children:"✏️"})]})]}),p.jsxs("div",{className:"folder-info-item",children:[p.jsxs("label",{children:[se("folder_owner"),":"]}),p.jsx("span",{children:S.ownerEmail||S.ownerId})]}),p.jsxs("div",{className:"folder-info-item",children:[p.jsxs("label",{children:[se("role"),":"]}),p.jsx("span",{children:se(U==="owner"?"folder_role_owner":U==="editor"?"folder_role_editor":"folder_role_viewer")})]}),p.jsxs("div",{className:"folder-info-item",children:[p.jsxs("label",{children:[se("created_date"),":"]}),p.jsx("span",{children:new Date(S.createdAt).toLocaleDateString()})]})]}),p.jsxs("div",{className:"collaborators-section",children:[p.jsx("h4",{children:se("folder_manage_collaborators")}),p.jsxs("div",{className:"collaborator-list",children:[p.jsx("div",{className:"collaborator-item owner",children:p.jsxs("div",{className:"collaborator-info",children:[p.jsx("span",{className:"email",children:S.ownerEmail||S.ownerId}),p.jsx("span",{className:"role owner-role",children:se("folder_role_owner")})]})}),((K=S.sharedWith)==null?void 0:K.map((W,Y)=>p.jsxs("div",{className:"collaborator-item",children:[p.jsxs("div",{className:"collaborator-info",children:[p.jsx("span",{className:"email",children:W.email||W.userId}),p.jsx("span",{className:`role ${W.role}`,children:W.role==="editor"?se("folder_role_editor"):se("folder_role_viewer")})]}),M&&p.jsxs("div",{className:"collaborator-actions",children:[p.jsxs("select",{value:W.role,onChange:ne=>Xe(S,W.userId,ne.target.value),children:[p.jsx("option",{value:"editor",children:se("folder_role_editor")}),p.jsx("option",{value:"viewer",children:se("folder_role_viewer")})]}),p.jsx("button",{className:"remove-btn",onClick:()=>mo(S,W.userId),children:"🗑️"})]})]},Y)))||[]]}),(M||U==="editor")&&p.jsxs("div",{className:"invite-section",children:[p.jsx("h5",{children:se("folder_invite_new")}),p.jsxs("div",{className:"invite-form",children:[p.jsx("input",{type:"email",placeholder:se("folder_invite_email"),value:je,onChange:W=>Mt(W.target.value)}),p.jsxs("select",{value:ut,onChange:W=>fe(W.target.value),children:[p.jsx("option",{value:"editor",children:se("folder_role_editor")}),p.jsx("option",{value:"viewer",children:se("folder_role_viewer")})]}),p.jsx("button",{onClick:()=>nl(S),disabled:!je||en,children:en?"초대 중...":se("folder_invite_button")})]})]})]}),p.jsxs("div",{className:"folder-settings-section",children:[p.jsx("h4",{children:se("folder_manage_settings")}),p.jsxs("div",{className:"share-link-section",children:[p.jsx("label",{children:se("folder_share_link")}),p.jsx("p",{className:"share-link-desc",children:se("folder_share_link_desc")}),p.jsxs("div",{className:"share-link-input",children:[p.jsx("input",{type:"text",readOnly:!0,value:`${window.location.origin}${window.location.pathname}?invite=${S.id}`}),p.jsx("button",{onClick:()=>fs(S),children:se("folder_copy_link")})]})]}),p.jsxs("div",{className:"folder-actions",children:[!M&&p.jsx("button",{className:"leave-folder-btn",onClick:()=>ps(S),children:se("folder_leave")}),M&&p.jsx("button",{className:"delete-folder-btn",onClick:()=>hc(S),children:se("folder_delete")})]})]})]})})()})]})})]})},U3=({folders:t,currentFolderId:e,onSetCurrentFolder:n,onCreateFolder:r,onRenameFolder:i,onDeleteFolder:s,onSetCollaboratingFolder:o,todos:a,t:l,onManageFolder:u,currentUserId:f})=>{var B;const[m,g]=z.useState(!1),[v,T]=z.useState(""),[x,D]=z.useState(null),[C,w]=z.useState(""),[P,V]=z.useState(null),O=()=>{v.trim()&&(r(v),T(""),g(!1))};return p.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid var(--border-color)",overflowX:"auto",display:"flex",gap:"8px",alignItems:"center",backgroundColor:"var(--card-bg-color)"},children:[p.jsxs("button",{onClick:()=>n(null),style:{padding:"6px 12px",borderRadius:"8px",border:"none",backgroundColor:e===null?"var(--primary-color)":"transparent",color:e===null?"white":"var(--text-color)",cursor:"pointer",fontSize:"0.9rem",fontWeight:500,whiteSpace:"nowrap",transition:"all 0.2s",minWidth:"80px",textAlign:"center"},children:["📁 ",l("all_goals_label")||"All"]}),p.jsx("button",{onClick:()=>n("all"),style:{padding:"6px 12px",borderRadius:"8px",border:"none",backgroundColor:e==="all"?"#ff6b6b":"transparent",color:e==="all"?"white":"var(--text-color)",cursor:"pointer",fontSize:"0.9rem",fontWeight:500,whiteSpace:"nowrap",transition:"all 0.2s",minWidth:"80px",textAlign:"center"},children:"🌐 전체"}),t.length>0&&t.filter(E=>e===null?!E.isShared||E.isShared&&E.ownerId===f:!0).map(E=>{const I=a.filter(A=>A.folderId===E.id).length;return p.jsxs("div",{style:{position:"relative",display:"inline-flex",alignItems:"center",gap:"2px"},children:[p.jsxs("button",{onClick:()=>n(E.id),style:{padding:"6px 12px",borderRadius:"8px",border:"none",backgroundColor:e===E.id?E.color||"var(--primary-color)":`${E.color}20`||"transparent",color:e===E.id?"white":"var(--text-color)",cursor:"pointer",fontSize:"0.9rem",fontWeight:500,whiteSpace:"nowrap",transition:"all 0.2s",position:"relative"},title:E.isShared?"공유 폴더":"개인 폴더",children:[E.isShared?"👥":"📁"," ",E.name," (",I,")"]}),e===E.id&&p.jsxs("div",{style:{display:"flex",gap:"2px"},children:[p.jsx("button",{onClick:()=>o(E),style:{width:"24px",height:"24px",padding:"0",borderRadius:"4px",border:"none",backgroundColor:"var(--primary-color)",color:"white",cursor:"pointer",fontSize:"0.8rem",lineHeight:"1",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s"},title:"폴더 협업",children:"👥"}),p.jsx("button",{onClick:()=>u(E.id),style:{width:"24px",height:"24px",padding:"0",borderRadius:"4px",border:"none",backgroundColor:"var(--button-bg-color)",color:"var(--text-color)",cursor:"pointer",fontSize:"0.8rem",lineHeight:"1",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s"},title:"폴더 관리",children:"⚙️"}),p.jsx("button",{onClick:()=>{D(E.id),w(E.name)},style:{width:"24px",height:"24px",padding:"0",borderRadius:"4px",border:"none",backgroundColor:"var(--button-bg-color)",color:"var(--text-color)",cursor:"pointer",fontSize:"0.8rem",lineHeight:"1",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s"},title:"폴더 이름 변경",children:"✏"}),p.jsx("button",{onClick:()=>{V(E.id)},style:{width:"24px",height:"24px",padding:"0",borderRadius:"4px",border:"none",backgroundColor:"var(--danger-color)",color:"white",cursor:"pointer",fontSize:"0.8rem",lineHeight:"1",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s"},title:"폴더 삭제",children:"×"})]})]},E.id)}),m?p.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[p.jsx("input",{type:"text",value:v,onChange:E=>T(E.target.value),onKeyPress:E=>{E.key==="Enter"&&O(),E.key==="Escape"&&(g(!1),T(""))},placeholder:"폴더 이름...",autoFocus:!0,style:{padding:"6px 12px",borderRadius:"8px",border:"2px solid var(--primary-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontSize:"0.9rem",outline:"none",width:"120px"}}),p.jsx("button",{onClick:O,style:{padding:"4px 12px",borderRadius:"8px",border:"none",backgroundColor:"var(--primary-color)",color:"white",cursor:"pointer",fontSize:"0.85rem",fontWeight:600,transition:"all 0.2s"},children:"완료"}),p.jsx("button",{onClick:()=>{g(!1),T("")},style:{padding:"4px 12px",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"transparent",color:"var(--text-color)",cursor:"pointer",fontSize:"0.85rem",transition:"all 0.2s"},children:"취소"})]}):p.jsx("button",{onClick:()=>g(!0),style:{padding:"6px 12px",borderRadius:"8px",border:"2px solid var(--primary-color)",backgroundColor:"transparent",color:"var(--primary-color)",cursor:"pointer",fontSize:"0.9rem",fontWeight:500,whiteSpace:"nowrap",transition:"all 0.2s",display:"flex",alignItems:"center",gap:"4px"},children:"➕ 폴더"}),P&&p.jsx("div",{className:"modal-backdrop alert-backdrop",children:p.jsxs("div",{className:"modal-content alert-modal",children:[p.jsxs("div",{className:"alert-content",children:[p.jsx("h2",{children:"폴더 삭제"}),p.jsxs("p",{style:{fontSize:"0.9rem"},children:['"',(B=t.find(E=>E.id===P))==null?void 0:B.name,'" 폴더를 삭제하시겠습니까?',p.jsx("br",{}),'폴더 내 목표는 "나의 목표"로 이동됩니다.']})]}),p.jsxs("div",{className:"modal-buttons",children:[p.jsx("button",{onClick:()=>V(null),className:"secondary",children:"취소"}),p.jsx("button",{onClick:()=>{s(P),V(null)},className:"destructive",children:"삭제"})]})]})}),x&&p.jsx("div",{className:"modal-backdrop alert-backdrop",children:p.jsxs("div",{className:"modal-content alert-modal",children:[p.jsxs("div",{className:"alert-content",children:[p.jsx("h2",{children:"폴더 이름 변경"}),p.jsx("p",{style:{fontSize:"0.9rem",marginBottom:"16px"},children:"새로운 폴더 이름을 입력하세요"}),p.jsx("input",{type:"text",value:C,onChange:E=>w(E.target.value),onKeyPress:E=>{E.key==="Enter"&&C.trim()&&(i(x,C),D(null),w(""))},placeholder:"폴더 이름...",autoFocus:!0,style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontSize:"0.95rem",outline:"none",boxSizing:"border-box"}})]}),p.jsxs("div",{className:"modal-buttons",children:[p.jsx("button",{onClick:()=>{D(null),w("")},className:"secondary",children:"취소"}),p.jsx("button",{onClick:()=>{C.trim()&&(i(x,C),D(null),w(""))},className:"primary",children:"변경"})]})]})})]})},O3=({t,isSelectionMode:e,selectedCount:n,totalVisibleCount:r,onCancelSelection:i,onDeleteSelected:s,onSelectAll:o,isViewModeCalendar:a,onToggleViewMode:l,isAiSorting:u,sortType:f,onSort:m,filter:g,onFilter:v,categoryFilter:T,onCategoryFilter:x,userCategories:D,onAddCategory:C,onRemoveCategory:w,onSetSelectionMode:P,onOpenSettings:V,onAddGoal:O,currentFolderId:B,folders:E,onSyncSharedFolder:I,isSyncing:A,isSyncingData:k,onManualSync:b,activeUsers:L,editingStates:N,onToggleCollaboration:De,onUpdateCollaborationSettings:Fe})=>{var Mt,ut;const[Ke,Te]=z.useState(!1),[te,ce]=z.useState(!1),me=B?E.find(fe=>fe.id===B):null,Ee=me==null?void 0:me.collaborationSettings,Pe=(Ee==null?void 0:Ee.enabled)||(me==null?void 0:me.isShared)||!1;z.useEffect(()=>{const fe=()=>{Te(!1),ce(!1)};return document.addEventListener("click",fe),document.addEventListener("touchstart",fe),()=>{document.removeEventListener("click",fe),document.removeEventListener("touchstart",fe)}},[]);const ze=fe=>{fe.stopPropagation(),Te(en=>!en)},je=fe=>{fe.stopPropagation()};return p.jsxs("header",{children:[p.jsx("div",{className:"header-left",children:e&&p.jsx("button",{onClick:i,className:"header-action-button",children:t("cancel_selection_button_label")})}),p.jsxs("div",{className:"header-title-group",children:[p.jsx("h1",{children:t("my_goals_title")}),!e&&p.jsxs("div",{className:"header-inline-actions",children:[p.jsx("button",{onClick:l,className:"header-icon-button","aria-label":t(a?"list_view_button_aria":"calendar_view_button_aria"),children:a?Ie.list:Ie.calendar}),p.jsxs("div",{className:"filter-sort-container",children:[p.jsx("button",{onClick:ze,onTouchStart:ze,className:"header-icon-button","aria-label":t("filter_sort_button_aria"),children:u?p.jsx("div",{className:"spinner"}):Ie.filter}),Ke&&p.jsxs("div",{className:"profile-popover filter-sort-popover",onClick:je,onTouchStart:je,children:[p.jsx("div",{className:"popover-section",children:p.jsx("button",{onClick:()=>{P(),Te(!1)},className:"popover-action-button",children:p.jsx("span",{children:t("select_button_label")})})}),p.jsxs("div",{className:"popover-section",children:[p.jsx("h4",{children:t("filter_title")}),p.jsxs("button",{onClick:()=>{v("all")},className:`popover-action-button ${g==="all"?"active":""}`,children:[p.jsx("span",{children:t("filter_all")}),g==="all"&&Ie.check]}),p.jsxs("button",{onClick:()=>{v("active")},className:`popover-action-button ${g==="active"?"active":""}`,children:[p.jsx("span",{children:t("filter_active")}),g==="active"&&Ie.check]}),p.jsxs("button",{onClick:()=>{v("completed")},className:`popover-action-button ${g==="completed"?"active":""}`,children:[p.jsx("span",{children:t("filter_completed")}),g==="completed"&&Ie.check]})]}),p.jsxs("div",{className:"popover-section",children:[p.jsxs("h4",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[p.jsx("span",{children:t("filter_category")}),p.jsx("button",{onClick:()=>{const fe=prompt("새 카테고리 이름: (New category name:)");fe&&fe.trim()&&!D.includes(fe.trim())&&C(fe.trim())},style:{background:"none",border:"none",color:"var(--primary-color)",cursor:"pointer",fontSize:"1.2rem",padding:"0"},children:"+"})]}),p.jsxs("button",{onClick:()=>{x("all")},className:`popover-action-button ${T==="all"?"active":""}`,children:[p.jsx("span",{children:t("category_all")}),T==="all"&&Ie.check]}),D.map(fe=>p.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[p.jsxs("button",{onClick:()=>{x(fe)},className:`popover-action-button ${T===fe?"active":""}`,style:{flex:1,justifyContent:"space-between"},children:[p.jsx("span",{children:fe}),T===fe&&Ie.check]}),!["school","work","personal","other"].includes(fe)&&p.jsx("button",{onClick:()=>w(fe),style:{background:"rgba(255, 59, 48, 0.1)",border:"none",color:"var(--danger-color)",borderRadius:"4px",padding:"4px 8px",cursor:"pointer",fontSize:"0.8rem"},children:"✕"})]},fe))]}),p.jsxs("div",{className:"popover-section",children:[p.jsx("h4",{children:t("sort_title")}),p.jsxs("button",{onClick:()=>{m("manual")},className:`popover-action-button ${f==="manual"?"active":""}`,children:[p.jsx("span",{children:t("sort_label_manual")}),f==="manual"&&Ie.check]}),p.jsxs("button",{onClick:()=>{m("deadline")},className:`popover-action-button ${f==="deadline"?"active":""}`,children:[p.jsx("span",{children:t("sort_label_deadline")}),f==="deadline"&&Ie.check]}),p.jsxs("button",{onClick:()=>{m("newest")},className:`popover-action-button ${f==="newest"?"active":""}`,children:[p.jsx("span",{children:t("sort_label_newest")}),f==="newest"&&Ie.check]}),p.jsxs("button",{onClick:()=>{m("alphabetical")},className:`popover-action-button ${f==="alphabetical"?"active":""}`,children:[p.jsx("span",{children:t("sort_label_alphabetical")}),f==="alphabetical"&&Ie.check]}),p.jsxs("button",{onClick:()=>{m("ai")},className:"popover-action-button with-icon",children:[p.jsx("span",{className:"popover-button-icon",children:Ie.ai}),p.jsx("span",{children:t(u?"ai_sorting_button":"sort_label_ai")})]}),p.jsx("button",{onClick:()=>{m("ai"),Te(!1)},className:"popover-action-button",style:{backgroundColor:"rgba(88, 86, 214, 0.1)",marginTop:"8px",color:"var(--icon-color-indigo)"},children:p.jsx("span",{children:"💡 정렬 제안 보기"})})]})]})]}),B&&((Mt=E.find(fe=>fe.id===B))==null?void 0:Mt.isShared)&&p.jsxs("div",{className:"collaboration-settings",children:[p.jsx("button",{onClick:()=>ce(!te),className:`main-action-button ${Pe?"collaboration-active":""}`,"aria-label":"공동작업 설정",title:"공동작업 설정",style:{borderRadius:"999px",padding:"8px 16px",fontWeight:500},children:Pe?"공동작업":"단독작업"}),te&&B&&p.jsx("div",{className:"profile-popover collaboration-popover",style:{right:"60px",top:"50px"},children:p.jsxs("div",{className:"popover-section",children:[p.jsx("h4",{style:{marginBottom:"12px"},children:"공동작업 설정"}),p.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[p.jsx("span",{children:"공동작업 활성화"}),p.jsx("button",{onClick:()=>De(B,!Pe),style:{background:Pe?"var(--primary-color)":"#ccc",border:"none",borderRadius:"12px",width:"44px",height:"24px",position:"relative",cursor:"pointer",transition:"background 0.2s"},children:p.jsx("div",{style:{background:"white",borderRadius:"50%",width:"20px",height:"20px",position:"absolute",top:"2px",left:Pe?"22px":"2px",transition:"left 0.2s"}})})]}),Pe&&L.length>0&&p.jsxs("div",{style:{marginBottom:"16px"},children:[p.jsxs("h5",{style:{marginBottom:"8px",fontSize:"0.9rem"},children:["현재 접속자 (",L.length,"명)"]}),p.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:L.map(fe=>p.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",background:"rgba(var(--primary-color-rgb), 0.1)",padding:"4px 8px",borderRadius:"12px",fontSize:"0.8rem"},children:[fe.photoURL&&p.jsx("img",{src:fe.photoURL,alt:"",style:{width:"16px",height:"16px",borderRadius:"50%"}}),p.jsx("span",{children:fe.displayName}),p.jsx("div",{style:{width:"6px",height:"6px",background:fe.isOnline?"#34C759":"#ccc",borderRadius:"50%"}})]},fe.userId))})]}),Pe&&p.jsx(p.Fragment,{children:p.jsxs("div",{style:{borderTop:"1px solid #eee",paddingTop:"16px"},children:[p.jsx("h5",{style:{marginBottom:"8px",fontSize:"0.9rem"},children:"세부 설정"}),p.jsxs("label",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px",cursor:"pointer"},children:[p.jsx("span",{style:{fontSize:"0.8rem"},children:"접속자 표시"}),p.jsx("input",{type:"checkbox",checked:(Ee==null?void 0:Ee.showPresence)??!0,onChange:fe=>Fe(B,{showPresence:fe.target.checked})})]}),p.jsxs("label",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px",cursor:"pointer"},children:[p.jsx("span",{style:{fontSize:"0.8rem"},children:"편집 상태 표시"}),p.jsx("input",{type:"checkbox",checked:(Ee==null?void 0:Ee.showEditingState)??!0,onChange:fe=>Fe(B,{showEditingState:fe.target.checked})})]}),p.jsxs("label",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px",cursor:"pointer"},children:[p.jsx("span",{style:{fontSize:"0.8rem"},children:"충돌 감지"}),p.jsx("input",{type:"checkbox",checked:(Ee==null?void 0:Ee.enableConflictDetection)??!0,onChange:fe=>Fe(B,{enableConflictDetection:fe.target.checked})})]})]})})]})})]}),B&&((ut=E.find(fe=>fe.id===B))==null?void 0:ut.isShared)&&p.jsx("button",{onClick:I,disabled:A,className:"main-action-button","aria-label":"동기화",title:A?"동기화 중...":`공유 폴더 수동 동기화
실시간 동기화가 실패했을 때 사용하세요`,style:{borderRadius:"999px",padding:"8px 16px",fontWeight:500,marginLeft:8},children:A?p.jsx("div",{className:"spinner",style:{width:"20px",height:"20px"}}):"동기화"}),p.jsx("button",{className:"sync-status-indicator clickable",onClick:()=>{var fe;k||(B&&((fe=E.find(en=>en.id===B))!=null&&fe.isShared)?I():b())},disabled:k,title:k?"동기화 중...":"클릭하여 수동 동기화",children:k?p.jsx("span",{style:{fontSize:"12px"},children:"동기화중"}):p.jsx("span",{style:{fontSize:"12px"},children:"동기화"})}),p.jsx("button",{onClick:V,className:"header-icon-button","aria-label":t("settings_title"),children:Ie.settings})]})]}),p.jsx("div",{className:"header-right",children:e?p.jsxs(p.Fragment,{children:[n===0?p.jsx("button",{onClick:o,className:"header-action-button",children:t("select_all_button_label")}):n===r?p.jsx("button",{onClick:i,className:"header-action-button",children:t("cancel_selection_button_label")}):p.jsxs(p.Fragment,{children:[p.jsx("button",{onClick:o,className:"header-action-button",children:t("select_all_button_label")}),p.jsx("button",{onClick:i,className:"header-action-button",children:t("cancel_selection_button_label")})]}),n>0&&p.jsx("button",{onClick:s,className:"header-action-button destructive",children:t("delete_selected_button_label").replace("{count}",String(n))})]}):p.jsx(p.Fragment,{children:p.jsx("button",{onClick:O,className:"header-icon-button","aria-label":t("add_new_goal_button_label"),children:Ie.add})})})]})},B3=({todos:t,onToggleComplete:e,onDelete:n,onEdit:r,onInfo:i,t:s,filter:o,randomEncouragement:a,isSelectionMode:l,selectedTodoIds:u,onSelectTodo:f,folders:m,onMoveToFolder:g})=>{if(t.length===0){const v=`empty_message_${o}`;return p.jsx("div",{className:"empty-message",children:p.jsx("p",{children:s(v)})})}return p.jsx("div",{style:{maxHeight:"50vh",overflowY:"auto",paddingRight:4},children:p.jsx("ul",{children:t.map(v=>p.jsx(q3,{todo:v,onToggleComplete:e,onDelete:n,onEdit:r,onInfo:i,t:s,isSelectionMode:l,isSelected:u.has(v.id),onSelect:f,folders:m,onMoveToFolder:g},v.id))})})},q3=uI.memo(({todo:t,onToggleComplete:e,onDelete:n,onEdit:r,onInfo:i,t:s,isSelectionMode:o,isSelected:a,onSelect:l,folders:u,onMoveToFolder:f})=>{var T;const m=()=>{o&&l(t.id)},g={school:"🎓",work:"💼",personal:"👤",other:"📌"},v=x=>x?{school:s("category_school"),work:s("category_work"),personal:s("category_personal"),other:s("category_other")}[x]||x:"";return p.jsx("li",{className:`${t.completed?"completed":""} ${o?"selection-mode":""} ${a?"selected":""}`,onClick:m,children:p.jsxs("div",{className:"swipeable-content",children:[p.jsxs("label",{className:"checkbox-container",onClick:x=>x.stopPropagation(),children:[p.jsx("input",{type:"checkbox",checked:t.completed,onChange:()=>e(t.id)}),p.jsx("span",{className:"checkmark"})]}),p.jsxs("div",{className:"todo-text-with-streak",children:[p.jsx("span",{className:"todo-text",children:t.wish}),t.isRecurring&&t.streak>0&&p.jsxs("div",{className:"streak-indicator",children:[Ie.flame,p.jsx("span",{children:t.streak})]})]}),p.jsxs("div",{className:"todo-actions-and-meta",children:[p.jsxs("div",{className:"todo-meta-badges",children:[t.category&&p.jsxs("span",{style:{backgroundColor:"rgba(88, 86, 214, 0.1)",color:"var(--icon-color-indigo)",padding:"4px 8px",borderRadius:"4px",fontSize:"0.8rem",marginRight:"4px",display:"inline-flex",alignItems:"center",gap:"4px",whiteSpace:"nowrap"},children:[g[t.category]||"📌"," ",v(t.category)]}),t.deadline&&p.jsx("span",{className:"todo-deadline",children:V3(t.deadline,s)}),t.collaborators&&t.collaborators.length>0&&p.jsxs("span",{style:{backgroundColor:"rgba(52, 199, 89, 0.1)",color:"var(--success-color)",padding:"4px 8px",borderRadius:"4px",fontSize:"0.85rem",marginLeft:"4px",display:"inline-flex",alignItems:"center",gap:"4px"},children:["🤝 ",t.collaborators.length]}),t.folderId&&p.jsxs("span",{style:{backgroundColor:"rgba(100, 150, 200, 0.15)",color:"var(--primary-color)",padding:"4px 8px",borderRadius:"4px",fontSize:"0.8rem",marginLeft:"4px",display:"inline-flex",alignItems:"center",gap:"4px",whiteSpace:"nowrap"},children:["📁 ",((T=u.find(x=>x.id===t.folderId))==null?void 0:T.name)||"Unknown"]})]}),p.jsxs("div",{className:"todo-buttons",children:[p.jsxs("select",{onClick:x=>x.stopPropagation(),onChange:x=>{f(t.id,x.target.value==="root"?null:x.target.value)},defaultValue:t.folderId||"root",style:{padding:"4px 8px",borderRadius:"4px",border:"1px solid var(--border-color)",backgroundColor:"var(--card-bg-color)",color:"var(--text-color)",cursor:"pointer",fontSize:"0.85rem",fontFamily:"inherit"},title:"폴더 선택",children:[p.jsx("option",{value:"root",children:"📁 나의 목표"}),u.map(x=>p.jsx("option",{value:x.id,children:x.name},x.id))]}),p.jsx("button",{onClick:x=>{x.stopPropagation(),r(t)},className:"info-button edit-button","aria-label":s("edit_button_aria"),children:Ie.edit}),p.jsx("button",{onClick:x=>{x.stopPropagation(),n(t.id)},className:"delete-button","aria-label":s("delete_button"),children:Ie.delete}),p.jsx("button",{onClick:x=>{x.stopPropagation(),i(t)},className:"info-button","aria-label":s("info_button_aria"),children:Ie.info})]})]})]})})}),ao=({onClose:t,children:e,className:n="",isClosing:r,size:i="large"})=>{const s={small:"modal-content-small",medium:"modal-content-medium",large:"modal-content-large"}[i];return p.jsx("div",{className:`modal-backdrop ${r?"is-closing":""}`,onClick:t,children:p.jsx("div",{className:`modal-content ${s} ${n} ${r?"is-closing":""}`,onClick:o=>o.stopPropagation(),children:e})})},Ua=t=>{const[e,n]=z.useState(!1);return[e,()=>{n(!0),setTimeout(t,500)}]},G3=({step:t,t:e,createAI:n,...r})=>{const{wish:i,setWish:s,outcome:o,setOutcome:a,obstacle:l,setObstacle:u,plan:f,setPlan:m,isRecurring:g,setIsRecurring:v,recurringDays:T,setRecurringDays:x,deadline:D,setDeadline:C,noDeadline:w,setNoDeadline:P,category:V,setCategory:O,userCategories:B,errors:E,language:I}=r,[A,k]=z.useState(!1),[b,L]=z.useState(""),[N,De]=z.useState(""),Fe=async(Ke,Te)=>{if(Te){k(!0),L(""),De("");try{const te=n();if(!te){De("AI 기능을 사용하려면 설정에서 API 키를 입력해주세요."),k(!1);return}const ce=`Provide concise, actionable feedback on this part of a WOOP goal: ${Ke} - "${Te}". The feedback should be helpful and encouraging, in ${I==="ko"?"Korean":"English"}. Keep it to 1-2 sentences.`,me=await te.models.generateContent({model:"gemini-2.5-flash",contents:ce});L(me.text)}catch(te){console.error("AI Feedback Error:",te),De("Failed to get AI feedback.")}finally{k(!1)}}};switch(t){case 1:return p.jsxs("div",{children:[p.jsx("h3",{children:e("wish_label")}),p.jsxs("div",{className:"step-guidance",children:[p.jsx("p",{className:"tip",children:e("wish_tip")}),p.jsx("p",{className:"example",children:e("wish_example")})]}),p.jsx("textarea",{value:i,onChange:Te=>{s(Te.target.value),L(""),De("")},placeholder:e("wish_label"),className:E.wish?"input-error":"",rows:3}),E.wish&&p.jsxs("p",{className:"field-error-message",children:[Ie.exclamation," ",e("error_wish_required")]}),p.jsxs("div",{className:"ai-feedback-section",children:[p.jsxs("button",{onClick:()=>Fe("Wish",i),disabled:!i.trim()||A,className:"ai-feedback-button",children:[A?p.jsx("div",{className:"spinner-small"}):"🤖",p.jsx("span",{children:e(A?"ai_analyzing":"ai_coach_suggestion")})]}),b&&p.jsx("div",{className:"ai-feedback-bubble",children:b}),N&&p.jsx("div",{className:"ai-feedback-bubble error",children:N})]})]});case 2:return p.jsxs("div",{children:[p.jsx("h3",{children:e("outcome_label")}),p.jsxs("div",{className:"step-guidance",children:[p.jsx("p",{className:"tip",children:e("outcome_tip")}),p.jsx("p",{className:"example",children:e("outcome_example")})]}),p.jsx("textarea",{value:o,onChange:Te=>{a(Te.target.value),L(""),De("")},placeholder:e("outcome_label"),className:E.outcome?"input-error":"",rows:3}),E.outcome&&p.jsxs("p",{className:"field-error-message",children:[Ie.exclamation," ",e("error_outcome_required")]}),p.jsxs("div",{className:"ai-feedback-section",children:[p.jsxs("button",{onClick:()=>Fe("Outcome",o),disabled:!o.trim()||A,className:"ai-feedback-button",children:[A?p.jsx("div",{className:"spinner-small"}):"🤖",p.jsx("span",{children:e(A?"ai_analyzing":"ai_coach_suggestion")})]}),b&&p.jsx("div",{className:"ai-feedback-bubble",children:b}),N&&p.jsx("div",{className:"ai-feedback-bubble error",children:N})]})]});case 3:return p.jsxs("div",{children:[p.jsx("h3",{children:e("obstacle_label")}),p.jsxs("div",{className:"step-guidance",children:[p.jsx("p",{className:"tip",children:e("obstacle_tip")}),p.jsx("p",{className:"example",children:e("obstacle_example")})]}),p.jsx("textarea",{value:l,onChange:Te=>{u(Te.target.value),L(""),De("")},placeholder:e("obstacle_label"),className:E.obstacle?"input-error":"",rows:3}),E.obstacle&&p.jsxs("p",{className:"field-error-message",children:[Ie.exclamation," ",e("error_obstacle_required")]}),p.jsxs("div",{className:"ai-feedback-section",children:[p.jsxs("button",{onClick:()=>Fe("Obstacle",l),disabled:!l.trim()||A,className:"ai-feedback-button",children:[A?p.jsx("div",{className:"spinner-small"}):"🤖",p.jsx("span",{children:e(A?"ai_analyzing":"ai_coach_suggestion")})]}),b&&p.jsx("div",{className:"ai-feedback-bubble",children:b}),N&&p.jsx("div",{className:"ai-feedback-bubble error",children:N})]})]});case 4:return p.jsxs("div",{children:[p.jsx("h3",{children:e("plan_label")}),p.jsxs("div",{className:"step-guidance",children:[p.jsx("p",{className:"tip",children:e("plan_tip")}),p.jsx("p",{className:"example",children:e("plan_example")})]}),p.jsx("textarea",{value:f,onChange:Te=>{m(Te.target.value),L(""),De("")},placeholder:e("plan_label"),className:E.plan?"input-error":"",rows:3}),E.plan&&p.jsxs("p",{className:"field-error-message",children:[Ie.exclamation," ",e("error_plan_required")]}),p.jsxs("div",{className:"ai-feedback-section",children:[p.jsxs("button",{onClick:()=>Fe("Plan",f),disabled:!f.trim()||A,className:"ai-feedback-button",children:[A?p.jsx("div",{className:"spinner-small"}):"🤖",p.jsx("span",{children:e(A?"ai_analyzing":"ai_coach_suggestion")})]}),b&&p.jsx("div",{className:"ai-feedback-bubble",children:b}),N&&p.jsx("div",{className:"ai-feedback-bubble error",children:N})]})]});case 5:const Ke=Te=>{const te=[...T],ce=te.indexOf(Te);ce>-1?te.splice(ce,1):te.push(Te),x(te)};return p.jsxs("div",{children:[p.jsxs("h3",{children:[e("recurrence_label")," & ",e("deadline_label")," & ",e("category_label")]}),p.jsxs("div",{className:"step-guidance",children:[p.jsx("p",{className:"tip",children:e("recurrence_tip")}),p.jsx("p",{className:"example",children:e("recurrence_example")})]}),p.jsxs("label",{className:"settings-item standalone-toggle",children:[p.jsx("span",{style:{fontWeight:500},children:e("recurrence_option_daily")}),p.jsxs("label",{className:"theme-toggle-switch",children:[p.jsx("input",{type:"checkbox",checked:g,onChange:Te=>v(Te.target.checked)}),p.jsx("span",{className:"slider round"})]})]}),g&&p.jsx("div",{className:"day-picker",children:e("day_names_short_picker").map((Te,te)=>p.jsx("button",{onClick:()=>Ke(te),className:`day-button ${T.includes(te)?"selected":""}`,children:Te},te))}),E.recurringDays&&p.jsxs("p",{className:"field-error-message",children:[Ie.exclamation," ",e("error_day_required")]}),p.jsx("hr",{}),p.jsx("div",{className:"step-guidance",style:{marginTop:"16px"},children:p.jsx("p",{className:"tip",children:e("deadline_tip")})}),p.jsxs("label",{className:"settings-item standalone-toggle",children:[p.jsx("span",{style:{fontWeight:500},children:e("deadline_option_no_deadline")}),p.jsxs("label",{className:"theme-toggle-switch",children:[p.jsx("input",{type:"checkbox",checked:w,onChange:Te=>P(Te.target.checked)}),p.jsx("span",{className:"slider round"})]})]}),!w&&p.jsx("input",{type:"date",value:D,onChange:Te=>C(Te.target.value),className:E.deadline?"input-error":"",style:{marginTop:"12px"}}),E.deadline&&p.jsxs("p",{className:"field-error-message",children:[Ie.exclamation," ",e("error_deadline_required")]}),p.jsx("hr",{}),p.jsx("div",{className:"step-guidance",style:{marginTop:"16px"},children:p.jsx("p",{className:"tip",children:e("category_label")})}),p.jsx("div",{style:{display:"grid",gridTemplateColumns:B&&B.length>2?"repeat(2, 1fr)":"repeat(1, 1fr)",gap:"8px",marginTop:"12px"},children:B&&B.map(Te=>p.jsx("button",{onClick:()=>O(Te),className:`category-button ${V===Te?"active":""}`,children:Te},Te))})]});default:return null}},$3=({onGenerate:t,t:e})=>{const[n,r]=z.useState(""),[i,s]=z.useState(""),[o,a]=z.useState(""),[l,u]=z.useState(""),[f,m]=z.useState(""),{endDate:g,generatedCount:v}=z.useMemo(()=>{const x=parseInt(i,10),D=parseInt(o,10);if(!l||!x||x<=0||!D||D<=0)return{endDate:"",generatedCount:0};const C=Math.ceil(x/D),w=new Date(l),P=new Date(w);return P.setDate(w.getDate()+C-1),{endDate:P.toISOString().split("T")[0],generatedCount:C}},[i,o,l]),T=()=>{const x=parseInt(i,10),D=parseInt(o,10);if(!n.trim()||!l||!x||x<=0||!D||D<=0){m(e("automation_error_all_fields"));return}const C=[],w=Math.ceil(x/D),P=new Date(l);for(let V=0;V<w;V++){const O=new Date(P);O.setDate(P.getDate()+V);const B=V*D+1,E=Math.min((V+1)*D,x),I=`${n.trim()} ${B}`+(E>B?` - ${E}`:"");C.push({wish:I,outcome:"",obstacle:"",plan:"",isRecurring:!1,recurringDays:[],deadline:O.toISOString().split("T")[0],category:"personal"})}m(""),t(C)};return p.jsxs("div",{className:"automation-form-container",children:[p.jsx("h3",{children:e("automation_title")}),p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:e("automation_base_name_label")}),p.jsx("input",{type:"text",value:n,onChange:x=>r(x.target.value),placeholder:e("automation_base_name_placeholder")})]}),p.jsxs("div",{className:"automation-form-grid",children:[p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:e("automation_total_units_label")}),p.jsx("input",{type:"number",value:i,onChange:x=>s(x.target.value),placeholder:e("automation_total_units_placeholder")})]}),p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:e("automation_units_per_day_label")}),p.jsx("input",{type:"number",value:o,onChange:x=>a(x.target.value),placeholder:"예: 5"})]})]}),p.jsxs("div",{className:"automation-form-grid",children:[p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:e("automation_start_date_label")}),p.jsx("input",{type:"date",value:l,onChange:x=>u(x.target.value)})]}),p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:e("automation_end_date_label")}),p.jsx("input",{type:"date",value:g,readOnly:!0})]})]}),f&&p.jsxs("p",{className:"field-error-message",style:{justifyContent:"center"},children:[Ie.exclamation," ",f]}),p.jsx("div",{className:"goal-assistant-nav",children:p.jsx("button",{onClick:T,className:"primary",disabled:v===0,children:e("automation_generate_button").replace("{count}",String(v))})})]})},Yw=({onClose:t,onAddTodo:e,onAddMultipleTodos:n,onEditTodo:r,existingTodo:i,t:s,language:o,createAI:a,userCategories:l=["personal"]})=>{const[u,f]=Ua(t),[m,g]=z.useState("woop"),[v,T]=z.useState(1),[x,D]=z.useState("forward"),[C,w]=z.useState((i==null?void 0:i.wish)||""),[P,V]=z.useState((i==null?void 0:i.outcome)||""),[O,B]=z.useState((i==null?void 0:i.obstacle)||""),[E,I]=z.useState((i==null?void 0:i.plan)||""),[A,k]=z.useState((i==null?void 0:i.isRecurring)||!1),[b,L]=z.useState((i==null?void 0:i.recurringDays)||[]),[N,De]=z.useState((i==null?void 0:i.deadline)||""),[Fe,Ke]=z.useState(!(i!=null&&i.deadline)),[Te,te]=z.useState((i==null?void 0:i.category)||"personal"),[ce,me]=z.useState({}),[Ee,Pe]=z.useState(""),[ze,je]=z.useState(""),[Mt,ut]=z.useState(""),[fe,en]=z.useState("personal"),_n=5,Nn=Me=>{const Ct={};return Me===1&&!C.trim()&&(Ct.wish=!0),Me===2&&!P.trim()&&(Ct.outcome=!0),Me===3&&!O.trim()&&(Ct.obstacle=!0),Me===4&&!E.trim()&&(Ct.plan=!0),Me===5&&(!Fe&&!N&&(Ct.deadline=!0),A&&b.length===0&&(Ct.recurringDays=!0)),me(Ct),Object.keys(Ct).length===0},ar=()=>{Nn(v)&&(v<_n?(D("forward"),T(Me=>Me+1)):cn())},lr=()=>{v>1&&(D("backward"),T(Me=>Me-1))},cn=()=>{if(!Nn(5))return;const Me={wish:C,outcome:P,obstacle:O,plan:E,isRecurring:A,recurringDays:b,deadline:Fe?"":N,category:Te};i&&r?r({...i,...Me}):e&&e(Me)},Cr=()=>{Ee.trim()&&(e&&e({wish:Ee.trim(),outcome:Ee.trim(),obstacle:"",plan:"",isRecurring:!1,recurringDays:[],deadline:ze,category:fe}),Pe(""),je(""),ut(""),en("personal"),f())};return p.jsxs(ao,{onClose:f,isClosing:u,className:"goal-assistant-modal",children:[p.jsxs("div",{className:"goal-assistant-header",children:[p.jsx("div",{className:"goal-assistant-header-left",children:v>1&&m==="woop"&&p.jsx("button",{onClick:lr,className:"settings-back-button",children:Ie.back})}),p.jsx("h2",{children:m==="woop"?"새로운 목표":m==="quick"?"새로운 할일":m==="automation"?"새로운 계획":s("goal_assistant_title")}),p.jsx("div",{className:"goal-assistant-header-right",children:p.jsx("button",{onClick:f,className:"close-button",children:Ie.close})})]}),!i&&p.jsx("div",{className:"modal-mode-switcher-container",children:p.jsxs("div",{className:"modal-mode-switcher",children:[p.jsx("button",{onClick:()=>g("woop"),className:m==="woop"?"active":"",children:s("goal_assistant_mode_woop")}),p.jsx("button",{onClick:()=>g("quick"),className:m==="quick"?"active":"",children:"새로운 할일"}),p.jsx("button",{onClick:()=>g("automation"),className:m==="automation"?"active":"",children:s("goal_assistant_mode_automation")})]})}),p.jsx("div",{className:"goal-assistant-body",children:m==="woop"?p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"progress-bar-container",children:p.jsx("div",{className:"progress-bar",style:{width:`${v/_n*100}%`}})}),p.jsx("div",{className:`goal-assistant-step-content-animator ${x}`,children:p.jsx(G3,{step:v,t:s,createAI:a,wish:C,setWish:w,outcome:P,setOutcome:V,obstacle:O,setObstacle:B,plan:E,setPlan:I,isRecurring:A,setIsRecurring:k,recurringDays:b,setRecurringDays:L,deadline:N,setDeadline:De,noDeadline:Fe,setNoDeadline:Ke,category:Te,setCategory:te,userCategories:l,errors:ce,language:o})},v),p.jsxs("div",{className:"goal-assistant-nav",children:[v>1?p.jsx("button",{onClick:lr,className:"secondary",children:s("back_button")}):p.jsx("div",{}),p.jsx("button",{onClick:ar,className:"primary",children:s(v===_n?i?"save_button":"add_button":"next_button")})]})]}):m==="quick"?p.jsxs("div",{style:{padding:"24px 16px"},children:[p.jsxs("div",{style:{marginBottom:"20px"},children:[p.jsx("h3",{style:{fontSize:"1rem",fontWeight:"600",marginBottom:"12px"},children:"새로운 할일"}),p.jsx("div",{className:"step-guidance",children:p.jsx("p",{className:"tip",children:"빠르게 할일을 추가하세요"})}),p.jsx("textarea",{value:Ee,onChange:Me=>Pe(Me.target.value),placeholder:"예: 선물 사기",rows:2,style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontSize:"14px",fontFamily:"inherit",resize:"none",marginTop:"12px"},onKeyPress:Me=>{Me.key==="Enter"&&Me.ctrlKey&&Cr()}})]}),p.jsx("hr",{}),p.jsxs("div",{style:{marginBottom:"20px"},children:[p.jsx("div",{className:"step-guidance",style:{marginTop:"16px"},children:p.jsx("p",{className:"tip",children:"마감일 설정 (선택)"})}),p.jsxs("label",{className:"settings-item standalone-toggle",style:{marginTop:"12px"},children:[p.jsx("span",{style:{fontWeight:"500"},children:"마감일 설정"}),p.jsxs("label",{className:"theme-toggle-switch",children:[p.jsx("input",{type:"checkbox",checked:!!ze,onChange:Me=>je(Me.target.checked?new Date().toISOString().split("T")[0]:"")}),p.jsx("span",{className:"slider round"})]})]}),ze&&p.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",marginTop:"12px"},children:[p.jsxs("div",{children:[p.jsx("label",{style:{fontSize:"12px",opacity:.7,display:"block",marginBottom:"4px"},children:"날짜"}),p.jsx("input",{type:"date",value:ze,onChange:Me=>je(Me.target.value),style:{width:"100%",padding:"10px",borderRadius:"6px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontSize:"13px"}})]}),p.jsxs("div",{children:[p.jsx("label",{style:{fontSize:"12px",opacity:.7,display:"block",marginBottom:"4px"},children:"시간 (선택)"}),p.jsx("input",{type:"time",value:Mt,onChange:Me=>ut(Me.target.value),style:{width:"100%",padding:"10px",borderRadius:"6px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontSize:"13px"}})]})]})]}),p.jsx("hr",{}),p.jsxs("div",{style:{marginBottom:"24px"},children:[p.jsx("div",{className:"step-guidance",style:{marginTop:"16px"},children:p.jsx("p",{className:"tip",children:s("category_label")})}),p.jsx("div",{style:{display:"grid",gridTemplateColumns:l&&l.length>2?"repeat(2, 1fr)":"repeat(1, 1fr)",gap:"8px",marginTop:"12px"},children:l&&l.map(Me=>p.jsx("button",{onClick:()=>en(Me),className:`category-button ${fe===Me?"active":""}`,children:Me},Me))})]}),p.jsxs("div",{className:"goal-assistant-nav",children:[p.jsx("button",{onClick:f,className:"secondary",children:s("cancel_button")}),p.jsx("button",{onClick:Cr,className:"primary",disabled:!Ee.trim(),children:s("add_button")})]})]}):n&&p.jsx($3,{onGenerate:n,t:s})})]})},z3=({todo:t,onClose:e,t:n,createAI:r,onOpenCollaboration:i,userCategories:s,onUpdateGoal:o})=>{const[a,l]=Ua(e),[u,f]=z.useState(""),[m,g]=z.useState(!1),[v,T]=z.useState(!1),x=async()=>{g(!0),f(""),T(!1);try{const D=r();if(!D){f("AI 기능을 사용하려면 설정에서 API 키를 입력해주세요."),g(!1);return}const C=`Based on the WOOP method, provide a concise and encouraging suggestion for the following goal: Wish: "${t.wish}", Best Outcome: "${t.outcome}", Obstacle: "${t.obstacle}", Plan: "${t.plan}". Focus on strengthening the plan or reframing the obstacle.`,w=await D.models.generateContent({model:"gemini-2.5-flash",contents:C});f(w.text)}catch(D){console.error(D),T(!0)}finally{g(!1)}};return p.jsxs(ao,{onClose:l,isClosing:a,className:"info-modal",children:[p.jsxs("div",{className:"info-modal-content",children:[p.jsx("h2",{children:n("goal_details_modal_title")}),p.jsxs("div",{className:"info-section",children:[p.jsx("h4",{children:n("wish_label")}),p.jsx("p",{children:t.wish})]}),p.jsxs("div",{className:"info-section",children:[p.jsx("h4",{children:n("outcome_label")}),p.jsx("p",{children:t.outcome})]}),p.jsxs("div",{className:"info-section",children:[p.jsx("h4",{children:n("obstacle_label")}),p.jsx("p",{children:t.obstacle})]}),p.jsxs("div",{className:"info-section",children:[p.jsx("h4",{children:n("plan_label")}),p.jsx("p",{children:t.plan})]}),s&&s.length>0&&o&&p.jsxs("div",{className:"info-section",style:{borderTop:"1px solid var(--border-color)",paddingTop:"16px",marginTop:"16px"},children:[p.jsx("h4",{style:{marginBottom:"12px"},children:n("category_label")}),p.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:s.map(D=>p.jsx("button",{onClick:()=>{o({...t,category:D}),l()},className:`category-button ${t.category===D?"active":""}`,style:{padding:"8px 16px",borderRadius:"20px",border:t.category===D?"2px solid var(--primary-color)":"2px solid var(--border-color)",backgroundColor:t.category===D?"var(--primary-color)":"transparent",color:t.category===D?"white":"var(--text-color)",cursor:"pointer",fontSize:"14px",fontWeight:t.category===D?"600":"500",transition:"all 0.25s ease",whiteSpace:"nowrap",display:"inline-block",boxShadow:t.category===D?"0 2px 8px rgba(88, 86, 214, 0.2)":"none"},children:D},D))})]}),p.jsxs("div",{className:"ai-analysis-section",children:[p.jsx("h4",{children:n("ai_coach_suggestion")}),m?p.jsx("p",{children:n("ai_analyzing")}):u?p.jsx("p",{children:u}):v?p.jsx("p",{className:"ai-error",children:n("ai_sort_error_message")}):p.jsx("button",{onClick:x,className:"feedback-button",children:n("ai_coach_suggestion")})]})]}),p.jsxs("div",{className:"modal-buttons",children:[i&&p.jsx("button",{onClick:()=>{i(t),l()},className:"secondary",children:"🤝 협업"}),p.jsx("button",{onClick:l,className:"primary",children:n("close_button")})]})]})},H3=({folder:t,onClose:e,t:n,googleUser:r,onUpdateCollaborators:i,setAlertConfig:s})=>{const[o,a]=Ua(e),[l,u]=z.useState(""),[f,m]=z.useState(!1),[g,v]=z.useState(""),[T,x]=z.useState(!1),D=async()=>{if(!(!t||!r)){m(!0);try{const V=`${t.id}-${Math.random().toString(36).substr(2,8)}`,O={fields:{folderId:{stringValue:t.id},ownerId:{stringValue:r.uid},createdAt:{stringValue:new Date().toISOString()},...T&&g?{password:{stringValue:g}}:{}}},{firestoreFetch:B}=await Nr(async()=>{const{firestoreFetch:I}=await Promise.resolve().then(()=>P0);return{firestoreFetch:I}},void 0);await B(`/shared_links/${V}`,{method:"PATCH",body:JSON.stringify(O)});const E=window.location.origin;u(`${E}/share/${V}`)}catch(V){console.error("공유 링크 생성 실패:",V),s({title:"공유 링크 생성 실패",message:"공유 링크를 만드는 중 오류가 발생했어요.",confirmText:"확인",onConfirm:()=>{}})}finally{m(!1)}}},C=()=>{l&&(navigator.clipboard.writeText(l),s({title:"복사 완료",message:"링크가 클립보드에 복사됐어요!",confirmText:"확인",onConfirm:()=>{}}))};return t?p.jsxs(ao,{onClose:a,isClosing:o,className:"goal-assistant-modal",children:[p.jsxs("div",{className:"goal-assistant-header",children:[p.jsx("div",{className:"goal-assistant-header-left"}),p.jsxs("h2",{children:[t.name," 폴더 공유"]}),p.jsx("div",{className:"goal-assistant-header-right",children:p.jsx("button",{onClick:a,className:"close-button",children:Ie.close})})]}),p.jsx("div",{className:"goal-assistant-body",children:p.jsxs("div",{style:{padding:"24px 16px"},children:[p.jsxs("div",{style:{marginBottom:"20px"},children:[p.jsx("h3",{style:{fontSize:"1rem",fontWeight:"600",marginBottom:"12px"},children:"현재 협업자"}),t.collaborators&&t.collaborators.length>0?p.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:t.collaborators.map(V=>p.jsxs("div",{className:"settings-item",style:{padding:"12px",backgroundColor:"var(--card-bg-color)",borderRadius:"8px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[p.jsxs("div",{style:{flex:1},children:[p.jsx("div",{style:{fontWeight:"500",fontSize:"0.95rem"},children:V.email}),V.role==="owner"?p.jsx("div",{style:{fontSize:"0.85rem",color:"var(--text-secondary-color)",marginTop:"2px"},children:"소유자"}):p.jsxs("select",{value:V.role,onChange:O=>P(V.userId,O.target.value),style:{fontSize:"0.85rem",padding:"4px 8px",marginTop:"4px",borderRadius:"4px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",cursor:"pointer"},children:[p.jsx("option",{value:"editor",children:"편집자"}),p.jsx("option",{value:"viewer",children:"뷰어"})]})]}),V.role!=="owner"&&p.jsx("button",{onClick:()=>w(V.userId),style:{padding:"4px 12px",backgroundColor:"var(--danger-color)",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"0.8rem",marginLeft:"12px",whiteSpace:"nowrap"},children:"제거"})]},V.userId))}):p.jsx("div",{className:"step-guidance",children:p.jsx("p",{className:"tip",children:"협업자가 없습니다. 공유 링크로 협업자를 추가하세요."})})]}),p.jsx("hr",{style:{margin:"20px 0",border:"none",borderTop:"1px solid var(--border-color)"}}),p.jsxs("div",{style:{marginBottom:"20px"},children:[p.jsx("h3",{style:{fontSize:"1rem",fontWeight:"600",marginBottom:"12px"},children:"공유 링크로 협업자 추가"}),p.jsx("div",{className:"step-guidance",children:p.jsx("p",{className:"tip",children:"공유 링크를 생성하고 협업자에게 전달하면, 그들이 해당 폴더에 접근할 수 있습니다."})}),l?p.jsxs("div",{style:{marginTop:"16px",display:"flex",flexDirection:"column",gap:"12px"},children:[p.jsx("div",{style:{padding:"12px",backgroundColor:"var(--card-bg-color)",borderRadius:"8px",border:"1px solid var(--border-color)"},children:p.jsx("input",{type:"text",readOnly:!0,value:l,onClick:V=>V.target.select(),style:{width:"100%",padding:"10px",border:"1px solid var(--border-color)",borderRadius:"6px",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontSize:"0.85rem",boxSizing:"border-box",fontFamily:"monospace"}})}),p.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[p.jsx("button",{onClick:C,className:"primary",children:"클립보드 복사"}),p.jsx("button",{onClick:()=>{u(""),v(""),x(!1)},className:"secondary",children:"새로 생성"})]})]}):p.jsxs("div",{style:{marginTop:"16px",display:"flex",flexDirection:"column",gap:"12px"},children:[p.jsxs("label",{className:"settings-item standalone-toggle",children:[p.jsx("span",{style:{fontWeight:"500"},children:"링크에 암호 설정"}),p.jsxs("label",{className:"theme-toggle-switch",children:[p.jsx("input",{type:"checkbox",checked:T,onChange:V=>{x(V.target.checked),V.target.checked||v("")}}),p.jsx("span",{className:"slider round"})]})]}),T&&p.jsx("input",{type:"password",placeholder:"암호 입력",value:g,onChange:V=>v(V.target.value),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontFamily:"inherit",fontSize:"14px",boxSizing:"border-box"}}),p.jsx("button",{onClick:D,disabled:f||T&&!g.trim(),className:"primary",style:{width:"100%",padding:"14px 0",backgroundColor:"var(--primary-color)",color:"white",border:"none",borderRadius:"24px",boxShadow:"0 2px 8px rgba(88,86,214,0.08)",fontWeight:700,fontSize:"16px",letterSpacing:"0.01em",cursor:f||T&&!g.trim()?"not-allowed":"pointer",opacity:f||T&&!g.trim()?.6:1,transition:"all 0.2s"},children:f?"링크 생성 중...":"공유 링크 생성"})]})]})]})}),p.jsxs("div",{className:"goal-assistant-nav",children:[p.jsx("div",{}),p.jsx("button",{onClick:a,className:"primary",children:"닫기"})]})]}):null},W3=({onClose:t,isDarkMode:e,onToggleDarkMode:n,themeMode:r,onThemeChange:i,backgroundTheme:s,onSetBackgroundTheme:o,onExportData:a,onImportData:l,setAlertConfig:u,onDeleteAllData:f,dataActionStatus:m,language:g,onSetLanguage:v,t:T,todos:x,setToastMessage:D,onOpenVersionInfo:C,onOpenUsageGuide:w,apiKey:P,onSetApiKey:V,isOfflineMode:O,onToggleOfflineMode:B,googleUser:E,onGoogleLogin:I,onGoogleLogout:A,onSyncDataToFirebase:k,onLoadDataFromFirebase:b,isGoogleLoggingIn:L=!1,isGoogleLoggingOut:N=!1,isSyncingData:De=!1,isLoadingData:Fe=!1,isAutoSyncEnabled:Ke,setIsAutoSyncEnabled:Te,onDiagnoseFirebase:te})=>{const[ce,me]=Ua(t),[Ee,Pe]=z.useState("appearance"),[ze,je]=z.useState(""),[Mt,ut]=z.useState(!1),[fe,en]=z.useState("medium"),[_n,Nn]=z.useState(null),ar=z.useRef(null),lr=[{id:"appearance",label:T("settings_section_background"),icon:Ie.background},{id:"notifications",label:T("settings_notifications"),icon:Ie.settings},{id:"general",label:T("settings_section_general"),icon:Ie.settings},{id:"data",label:T("settings_section_data"),icon:Ie.data}],cn=()=>u({title:T("delete_account_header"),message:T("delete_account_header_desc"),isDestructive:!0,confirmText:T("delete_all_data_button"),cancelText:T("cancel_button"),onConfirm:f,onCancel:()=>{}}),Cr=async()=>{if(!x||x.length===0){Nn(T("no_data_to_share"));return}ut(!0);try{const qe=Qw(x),ct=`${window.location.origin}${window.location.pathname}?data=${encodeURIComponent(qe)}`,ae=await L3(ct);je(ae),ae!==ct&&ae.length<ct.length?D(T("short_url_created")):D(T("share_link_created"))}catch(qe){console.error("Failed to create share link",qe);const ct=Qw(x),ae=`${window.location.origin}${window.location.pathname}?data=${encodeURIComponent(ct)}`;je(ae),D(T("short_url_failed"))}finally{ut(!1)}},Me=()=>{ze&&navigator.clipboard.writeText(ze).then(()=>{D(T("link_copied_toast"))})},Ct=()=>{switch(Ee){case"appearance":return p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"settings-section-header",children:T("settings_theme_mode")}),p.jsxs("div",{className:"settings-section-body",children:[p.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>i("light"),children:[p.jsxs("div",{children:[p.jsx("span",{children:T("theme_mode_light")}),p.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:T("theme_mode_light_desc")})]}),r==="light"&&Ie.check]}),p.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>i("dark"),children:[p.jsxs("div",{children:[p.jsx("span",{children:T("theme_mode_dark")}),p.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:T("theme_mode_dark_desc")})]}),r==="dark"&&Ie.check]}),p.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>i("system"),children:[p.jsxs("div",{children:[p.jsx("span",{children:T("theme_mode_system")}),p.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:T("theme_mode_system_desc")})]}),r==="system"&&Ie.check]})]}),p.jsx("div",{className:"settings-section-header",children:T("settings_background_header")}),p.jsx("div",{className:"settings-section-body",children:tg.map(qe=>p.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>o(qe.id),children:[p.jsx("span",{children:T(e?qe.darkNameKey:qe.lightNameKey)}),s===qe.id&&Ie.check]},qe.id))})]});case"notifications":return p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"settings-section-header",children:T("notification_settings_title")}),p.jsxs("div",{className:"settings-section-body",children:[p.jsxs("label",{className:"settings-item",children:[p.jsxs("div",{children:[p.jsx("span",{children:T("notification_deadline")}),p.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:T("notification_deadline_desc")})]}),p.jsxs("div",{className:"theme-toggle-switch",children:[p.jsx("input",{type:"checkbox",defaultChecked:!0,onChange:()=>{}}),p.jsx("span",{className:"slider round"})]})]}),p.jsxs("label",{className:"settings-item",children:[p.jsxs("div",{children:[p.jsx("span",{children:T("notification_suggestion")}),p.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:"지정된 시간에 할일을 제안합니다."})]}),p.jsxs("div",{className:"theme-toggle-switch",children:[p.jsx("input",{type:"checkbox",defaultChecked:!0,onChange:()=>{}}),p.jsx("span",{className:"slider round"})]})]})]}),p.jsx("div",{className:"settings-section-header",children:"알림 권한"}),p.jsxs("div",{className:"settings-section-body",children:[p.jsx("button",{className:"settings-item action-item",onClick:async()=>{await nR()?(D("알림 권한이 허용되었습니다."),await rR()):D("알림 권한을 거부했습니다.")},children:p.jsx("span",{className:"action-text",children:"알림 권한 요청"})}),p.jsxs("div",{style:{fontSize:"12px",opacity:.7,padding:"12px",marginTop:"8px"},children:["현재 권한: ",Notification.permission==="granted"?"✓ 허용됨":Notification.permission==="denied"?"✗ 거부됨":"? 미정"]})]})]});case"general":return p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"settings-section-header",children:T("settings_language")}),p.jsxs("div",{className:"settings-section-body",children:[p.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>v("ko"),children:[p.jsx("span",{children:"한국어"}),g==="ko"&&Ie.check]}),p.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>v("en"),children:[p.jsx("span",{children:"English"}),g==="en"&&Ie.check]})]}),p.jsx("div",{className:"settings-section-header",children:T("settings_api_key")}),p.jsxs("div",{className:"settings-section-body",children:[p.jsx("div",{className:"settings-item",children:p.jsx("input",{type:"password",placeholder:T("settings_api_key_placeholder"),value:P,onChange:qe=>V(qe.target.value),style:{width:"100%",padding:"8px",border:"1px solid var(--border-color)",borderRadius:"4px",backgroundColor:"var(--input-bg)"}})}),p.jsxs("label",{className:"settings-item",children:[p.jsxs("div",{children:[p.jsx("span",{children:T("settings_offline_mode")}),p.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:T("settings_offline_mode_desc")})]}),p.jsxs("div",{className:"theme-toggle-switch",children:[p.jsx("input",{type:"checkbox",checked:O,onChange:B}),p.jsx("span",{className:"slider round"})]})]})]}),p.jsx("div",{className:"settings-section-header",children:T("settings_section_info")}),p.jsxs("div",{className:"settings-section-body",children:[p.jsxs("div",{className:"settings-item nav-indicator",onClick:C,children:[p.jsx("span",{children:T("settings_version")}),p.jsxs("div",{className:"settings-item-value-with-icon",children:[p.jsx("span",{children:"1.5"}),Ie.forward]})]}),p.jsxs("div",{className:"settings-item nav-indicator",onClick:w,children:[p.jsx("span",{children:T("usage_guide_title")}),p.jsx("div",{className:"settings-item-value-with-icon",children:Ie.forward})]}),p.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>{Nn(`이것은 매우 긴 알림 메시지입니다.

이 메시지는 여러 줄에 걸쳐 작성되었으며, 알림 팝업이 내용에 맞게 세로로 확장되는지 테스트하기 위한 목적으로 만들어졌습니다.

줄바꿈 문자도 포함되어 있고,
여러 문단으로 구성되어 있습니다.

이런 식으로 긴 에러 메시지나 안내 메시지가 표시될 때도 팝업이 적절하게 크기 조정이 되어야 합니다.

스크롤이 필요할 정도로 매우 긴 내용일 때는 스크롤바가 나타나야 하고, 버튼 영역은 항상 하단에 고정되어 있어야 합니다.`)},children:[p.jsx("span",{children:T("test_long_alert")}),p.jsxs("div",{className:"settings-item-value-with-icon",children:[p.jsx("span",{children:T("test_long_alert_desc")}),Ie.forward]})]}),p.jsxs("div",{className:"settings-item",children:[p.jsx("span",{children:T("settings_developer")}),p.jsx("span",{className:"settings-item-value",children:T("developer_name")})]}),p.jsxs("div",{className:"settings-item",children:[p.jsx("span",{children:T("settings_copyright")}),p.jsx("span",{className:"settings-item-value",children:T("copyright_notice")})]})]})]});case"data":return p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"settings-section-header",children:"계정"}),p.jsx("div",{className:"settings-section-body",children:E?p.jsxs("div",{children:[p.jsxs("div",{className:"settings-item",children:[p.jsxs("div",{children:[p.jsx("span",{children:"Google 계정"}),p.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:E.email}),p.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:E.displayName})]}),p.jsx("span",{style:{color:"var(--success-color, #4CAF50)"},children:"✓"})]}),p.jsx("button",{className:"settings-item action-item",onClick:A,disabled:N,style:{opacity:N?.6:1},children:p.jsx("span",{className:"action-text",children:N?"⏳ 로그아웃 중...":"로그아웃"})})]}):p.jsxs("div",{children:[p.jsx("div",{style:{display:"flex",justifyContent:"center",padding:"12px 0"},children:p.jsxs("button",{onClick:I,disabled:L,style:{backgroundColor:L?"#E0E0E0":"white",border:"1px solid #D3D3D3",borderRadius:"24px",padding:"8px 20px",fontSize:"14px",fontWeight:"500",cursor:L?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"8px",color:L?"#999999":"#1F2937",transition:"all 0.2s",opacity:L?.6:1},children:[p.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",children:[p.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),p.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),p.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),p.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),L?"로그인 중...":"Google로 로그인"]})}),p.jsx("div",{style:{display:"flex",justifyContent:"center",padding:"8px 0"},children:p.jsx("button",{onClick:te,style:{backgroundColor:"transparent",border:"1px solid #D3D3D3",borderRadius:"16px",padding:"4px 12px",fontSize:"12px",color:"#666",cursor:"pointer"},children:"🔍 로그인 문제 진단"})})]})}),E&&p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"settings-section-header",children:"클라우드 동기화"}),p.jsxs("div",{className:"settings-section-body",children:[p.jsx("button",{className:"settings-item action-item",onClick:k,disabled:De,children:p.jsx("span",{className:"action-text",children:De?"저장중...":"클라우드에 저장"})}),p.jsx("button",{className:"settings-item action-item",onClick:b,disabled:Fe,children:p.jsx("span",{className:"action-text",children:Fe?"로드중...":"클라우드에서 불러오기"})}),p.jsxs("label",{className:"settings-item",children:[p.jsxs("div",{children:[p.jsx("span",{children:"자동 동기화"}),p.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:"목표 변경 시 자동으로 저장"})]}),p.jsxs("div",{className:"theme-toggle-switch",children:[p.jsx("input",{type:"checkbox",checked:Ke,onChange:qe=>Te(qe.target.checked)}),p.jsx("span",{className:"slider round"})]})]})]})]}),p.jsx("div",{className:"settings-section-header",children:T("settings_data_header")}),p.jsxs("div",{className:"settings-section-body",children:[p.jsx("div",{style:{fontSize:"12px",opacity:.7,marginBottom:"12px",padding:"8px",backgroundColor:"var(--bg-color-secondary)",borderRadius:"8px"},children:T("settings_data_header_desc")}),p.jsx("button",{className:"settings-item action-item",onClick:a,disabled:m!=="idle",children:p.jsx("span",{className:"action-text",children:T(m==="exporting"?"data_exporting":"settings_export_data")})}),p.jsxs("button",{className:"settings-item action-item",onClick:()=>{var qe;return(qe=ar.current)==null?void 0:qe.click()},disabled:m!=="idle",children:[p.jsx("span",{className:"action-text",children:T(m==="importing"?"data_importing":"settings_import_data")}),p.jsx("input",{type:"file",ref:ar,onChange:l,accept:".json",style:{display:"none"}})]})]}),x.length>0&&p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"settings-section-header",children:T("settings_share_link_header")}),p.jsxs("div",{className:"settings-section-body",children:[!ze&&p.jsx("button",{className:"settings-item action-item",onClick:Cr,disabled:Mt,children:p.jsx("span",{className:"action-text",children:Mt?"단축 URL 생성 중...":T("settings_generate_link")})}),ze&&p.jsxs("div",{className:"share-link-container",children:[p.jsxs("div",{style:{marginBottom:"8px",fontSize:"12px",opacity:.7},children:[ze.length<100?"단축 URL":"일반 링크"," (",ze.length,"자)"]}),p.jsx("input",{type:"text",readOnly:!0,value:ze,onClick:qe=>qe.target.select()}),p.jsx("button",{onClick:Me,children:T("settings_copy_link")})]})]})]}),p.jsx("div",{className:"settings-section-header",children:T("settings_section_info")}),p.jsxs("div",{className:"settings-section-body",children:[p.jsxs("div",{className:"settings-item nav-indicator",onClick:C,children:[p.jsx("span",{children:T("settings_version")}),p.jsxs("div",{className:"settings-item-value-with-icon",children:[p.jsx("span",{children:"1.5"}),Ie.forward]})]}),p.jsxs("div",{className:"settings-item nav-indicator",onClick:w,children:[p.jsx("span",{children:T("usage_guide_title")}),p.jsx("div",{className:"settings-item-value-with-icon",children:Ie.forward})]}),p.jsxs("div",{className:"settings-item",children:[p.jsx("span",{children:T("settings_developer")}),p.jsx("span",{className:"settings-item-value",children:T("developer_name")})]}),p.jsxs("div",{className:"settings-item",children:[p.jsx("span",{children:T("settings_copyright")}),p.jsx("span",{className:"settings-item-value",children:T("copyright_notice")})]})]}),p.jsx("div",{className:"settings-section-header",children:T("settings_delete_account")}),p.jsx("div",{className:"settings-section-body",children:p.jsx("button",{className:"settings-item action-item",onClick:cn,disabled:m!=="idle",children:p.jsx("span",{className:"action-text destructive",children:T(m==="deleting"?"data_deleting":"settings_delete_account")})})})]});default:return null}};return p.jsxs(ao,{onClose:me,isClosing:ce,className:"settings-modal",size:fe,children:[p.jsxs("div",{className:"settings-modal-header",children:[p.jsx("h2",{children:T("settings_title")}),p.jsx("div",{className:"settings-modal-header-right",children:p.jsx("button",{onClick:me,className:"close-button",children:Ie.close})})]}),p.jsxs("div",{className:"settings-modal-body",children:[p.jsx("div",{className:"settings-tabs",children:lr.map(qe=>p.jsxs("button",{className:`settings-tab-button ${Ee===qe.id?"active":""}`,onClick:()=>Pe(qe.id),"aria-label":qe.label,children:[p.jsx("div",{className:"settings-tab-icon",children:qe.icon}),p.jsx("span",{children:qe.label})]},qe.id))}),p.jsx("div",{className:"settings-tab-content-container",children:p.jsx("div",{className:"settings-tab-content",children:Ct()},Ee)})]}),_n&&p.jsx("div",{className:"modal-backdrop alert-backdrop",children:p.jsxs("div",{className:"modal-content alert-modal",children:[p.jsxs("div",{className:"alert-content",children:[p.jsx("h2",{children:"알림"}),p.jsx("p",{children:_n})]}),p.jsx("div",{className:"modal-buttons",children:p.jsx("button",{onClick:()=>Nn(null),className:"primary",children:"확인"})})]})})]})},Xw=({onClose:t,t:e})=>{const[n,r]=Ua(t),i="2.0.0 (25.10.24)",s=[{icon:"🔔",title:"미리알림 관리",desc:"Step-by-step 미리알림 추가. 제목, 기한(선택), 시간(선택), 반복 설정, 설명, 활성화 여부"},{icon:"📅",title:"유연한 날짜/시간 설정",desc:"기한 없음, 시간 없음 옵션으로 필요한 정보만 선택적 입력 가능"},{icon:"🎯",title:"WOOP 목표 설정",desc:"5단계 마법사 (Wish → Outcome → Obstacle → Plan → 기한/반복)로 구조화된 목표 계획"},{icon:"🤖",title:"AI 코치 피드백",desc:"Gemini API 기반 각 단계별 실시간 AI 피드백으로 목표 개선"},{icon:"🔐",title:"Google 로그인",desc:"Google OAuth 인증으로 보안 강화 및 계정 관리"},{icon:"☁️",title:"Firebase 클라우드 동기화",desc:"목표, 설정, 미리알림 등 모든 데이터 Firebase Firestore에 자동 저장"},{icon:"🔄",title:"자동 동기화 제어",desc:"켜고 끄기 옵션으로 클라우드 자동 동기화 제어 가능"},{icon:"🌙",title:"다크 모드 & 테마",desc:"시스템/라이트/다크 모드 자동 감지 및 8가지 배경 테마 지원"},{icon:"📱",title:"PWA & 오프라인",desc:"모바일 PWA 자동 설치 배너, 오프라인 모드, 푸시 알림 지원"},{icon:"🗓️",title:"달력 보기",desc:"3일/주간/월간 달력 뷰로 목표 스케줄링 및 시각화"},{icon:"📤",title:"데이터 내보내기/가져오기",desc:"JSON 형식으로 모든 데이터 로컬 저장 및 복원"},{icon:"🌍",title:"다국어 지원",desc:"한국어, 영어 등 다국어 인터페이스 지원"}];return p.jsxs(ao,{onClose:r,isClosing:n,className:"version-info-modal",children:[p.jsxs("div",{className:"version-info-header",children:[p.jsx("h2",{children:"🧪 Nova AI Planner v2.0 Beta"}),p.jsxs("p",{children:[e("build_number"),": ",i]})]}),p.jsx("div",{className:"version-info-body",children:s.map((o,a)=>p.jsxs("div",{className:"changelog-item",children:[p.jsx("div",{className:"changelog-icon",style:{"--icon-bg":"var(--primary-color)"},children:o.icon}),p.jsxs("div",{className:"changelog-text",children:[p.jsx("h3",{children:o.title}),p.jsx("p",{children:o.desc})]})]},a))}),p.jsx("div",{className:"modal-buttons",children:p.jsx("button",{onClick:r,className:"primary",children:e("settings_done_button")})})]})},K3=({onClose:t,t:e})=>{const[n,r]=Ua(t),i=o=>{const a=/(https?:\/\/[^\s]+)/g;return o.split(a).map((u,f)=>a.test(u)?p.jsx("a",{href:u,target:"_blank",rel:"noopener noreferrer",className:"guide-link",children:u},f):u)},s=[{titleKey:"usage_basic_title",descKey:"usage_basic_desc"},{titleKey:"usage_ai_setup_title",descKey:"usage_ai_setup_desc"},{titleKey:"usage_ai_use_title",descKey:"usage_ai_use_desc"},{titleKey:"usage_share_title",descKey:"usage_share_desc"},{titleKey:"usage_theme_title",descKey:"usage_theme_desc"},{titleKey:"usage_calendar_title",descKey:"usage_calendar_desc"},{titleKey:"usage_offline_title",descKey:"usage_offline_desc"}];return p.jsxs(ao,{onClose:r,isClosing:n,className:"usage-guide-modal",children:[p.jsx("div",{className:"version-info-header",children:p.jsx("h2",{children:e("usage_guide_title")})}),p.jsx("div",{className:"version-info-body",children:s.map((o,a)=>p.jsxs("div",{className:"usage-guide-item",children:[p.jsx("h3",{children:e(o.titleKey)}),p.jsx("p",{children:o.titleKey==="usage_ai_setup_title"?i(e(o.descKey)):e(o.descKey)})]},a))}),p.jsx("div",{className:"modal-buttons",children:p.jsx("button",{onClick:r,className:"primary",children:e("settings_done_button")})})]})},j3=({todos:t,t:e,onGoalClick:n,language:r})=>{const[i,s]=z.useState(new Date),[o,a]=z.useState("week"),l=g=>{const v=new Date(i);o==="month"?v.setMonth(v.getMonth()+g):o==="week"?v.setDate(v.getDate()+g*7):v.setDate(v.getDate()+g*3),s(v)},u=z.useMemo(()=>{const g=[];let v,T;if(o==="month"){const x=new Date(i.getFullYear(),i.getMonth(),1);v=Kw(x,r==="ko"?1:0),T=42}else o==="week"?(v=Kw(i,r==="ko"?1:0),T=7):(v=new Date(i),v.setDate(v.getDate()-1),T=3);for(let x=0;x<T;x++){const D=new Date(v);D.setDate(D.getDate()+x),g.push(D)}return g},[i,o,r]),f=z.useMemo(()=>{if(o==="month"){const g=i.getFullYear(),v=e("month_names")[i.getMonth()],T=e("calendar_header_month_format");return T&&typeof T=="string"&&T!=="calendar_header_month_format"?T.replace("{year}",String(g)).replace("{month}",v):`${v} ${g}`}return`${i.getFullYear()}.${i.getMonth()+1}`},[i,o,e]),m=z.useMemo(()=>{const g=e("day_names_short");if(r==="ko"&&Array.isArray(g)){const[v,...T]=g;return[...T,v]}return g},[r,e]);return p.jsxs("div",{className:"calendar-view-container",children:[p.jsxs("div",{className:"calendar-header",children:[p.jsx("button",{onClick:()=>l(-1),children:Ie.back}),p.jsx("h2",{children:f}),p.jsx("button",{onClick:()=>l(1),children:Ie.forward})]}),p.jsxs("div",{className:"calendar-view-mode-selector",children:[p.jsx("button",{onClick:()=>a("day3"),className:o==="day3"?"active":"",children:e("calendar_view_day3")}),p.jsx("button",{onClick:()=>a("week"),className:o==="week"?"active":"",children:e("calendar_view_week")}),p.jsx("button",{onClick:()=>a("month"),className:`calendar-view-button-month ${o==="month"?"active":""}`,children:e("calendar_view_month")})]}),(o==="week"||o==="month")&&p.jsx("div",{className:"calendar-days-of-week",children:Array.isArray(m)&&m.map(g=>p.jsx("div",{children:g},g))}),p.jsx("div",{className:`calendar-grid view-mode-${o}`,children:u.map(g=>{const T=Ql(g,new Date),x=g.getMonth()===i.getMonth(),D=t.filter(C=>{if(C.isRecurring){const w=(g.getDay()+6)%7;return C.recurringDays.includes(w)}return C.deadline&&Ql(g,C.deadline)});return p.jsxs("div",{className:`calendar-day ${!x&&o==="month"?"not-current-month":""} ${T?"is-today":""}`,"data-day-name":e("day_names_long")[g.getDay()],children:[p.jsx("div",{className:"day-header",children:p.jsx("span",{className:"day-number",children:g.getDate()})}),p.jsx("div",{className:"calendar-goals",children:D.map(C=>p.jsx("div",{className:`calendar-goal-item ${C.completed&&C.lastCompletedDate&&Ql(g,C.lastCompletedDate)?"completed":""}`,onClick:()=>n(C),children:C.wish},C.id))})]},g.toISOString())})})]})},J3=({title:t,message:e,onConfirm:n,onCancel:r,confirmText:i,cancelText:s,isDestructive:o,t:a})=>{const l=typeof r=="function";return p.jsx("div",{className:"modal-backdrop alert-backdrop",children:p.jsxs("div",{className:"modal-content alert-modal",children:[p.jsxs("div",{className:"alert-content",children:[p.jsx("h2",{children:t}),p.jsx("p",{dangerouslySetInnerHTML:{__html:e}})]}),p.jsxs("div",{className:"modal-buttons",children:[l&&p.jsx("button",{onClick:r,className:"secondary",children:s||a("cancel_button")}),p.jsx("button",{onClick:n,className:o?"destructive":"primary",children:i||a("confirm_button")})]})]})})},Q3=Zp.createRoot(document.getElementById("root"));Q3.render(p.jsx(uI.StrictMode,{children:p.jsx(F3,{})}));
