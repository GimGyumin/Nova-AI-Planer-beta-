(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();const sR="modulepreload",oR=function(t){return"/Nova-1.0/"+t},xy={},Ri=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(n.map(l=>{if(l=oR(l),l in xy)return;xy[l]=!0;const u=l.endsWith(".css"),p=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${p}`))return;const m=document.createElement("link");if(m.rel=u?"stylesheet":sR,u||(m.as="script"),m.crossOrigin="",m.href=l,a&&m.setAttribute("nonce",a),document.head.appendChild(m),u)return new Promise((g,v)=>{m.addEventListener("load",g),m.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return i.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return e().catch(s)})};function aR(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var nI={exports:{}},Mh={},rI={exports:{}},ke={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $u=Symbol.for("react.element"),lR=Symbol.for("react.portal"),uR=Symbol.for("react.fragment"),cR=Symbol.for("react.strict_mode"),dR=Symbol.for("react.profiler"),hR=Symbol.for("react.provider"),fR=Symbol.for("react.context"),pR=Symbol.for("react.forward_ref"),mR=Symbol.for("react.suspense"),gR=Symbol.for("react.memo"),_R=Symbol.for("react.lazy"),Cy=Symbol.iterator;function yR(t){return t===null||typeof t!="object"?null:(t=Cy&&t[Cy]||t["@@iterator"],typeof t=="function"?t:null)}var iI={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},sI=Object.assign,oI={};function Ha(t,e,n){this.props=t,this.context=e,this.refs=oI,this.updater=n||iI}Ha.prototype.isReactComponent={};Ha.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Ha.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function aI(){}aI.prototype=Ha.prototype;function vg(t,e,n){this.props=t,this.context=e,this.refs=oI,this.updater=n||iI}var Tg=vg.prototype=new aI;Tg.constructor=vg;sI(Tg,Ha.prototype);Tg.isPureReactComponent=!0;var Ay=Array.isArray,lI=Object.prototype.hasOwnProperty,Eg={current:null},uI={key:!0,ref:!0,__self:!0,__source:!0};function cI(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)lI.call(e,r)&&!uI.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];i.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:$u,type:t,key:s,ref:o,props:i,_owner:Eg.current}}function vR(t,e){return{$$typeof:$u,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function wg(t){return typeof t=="object"&&t!==null&&t.$$typeof===$u}function TR(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Ry=/\/+/g;function qf(t,e){return typeof t=="object"&&t!==null&&t.key!=null?TR(""+t.key):e.toString(36)}function od(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case $u:case lR:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+qf(o,0):r,Ay(i)?(n="",t!=null&&(n=t.replace(Ry,"$&/")+"/"),od(i,e,n,"",function(u){return u})):i!=null&&(wg(i)&&(i=vR(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(Ry,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",Ay(t))for(var a=0;a<t.length;a++){s=t[a];var l=r+qf(s,a);o+=od(s,e,n,l,i)}else if(l=yR(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=r+qf(s,a++),o+=od(s,e,n,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Vc(t,e,n){if(t==null)return t;var r=[],i=0;return od(t,r,"","",function(s){return e.call(n,s,i++)}),r}function ER(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var pn={current:null},ad={transition:null},wR={ReactCurrentDispatcher:pn,ReactCurrentBatchConfig:ad,ReactCurrentOwner:Eg};function dI(){throw Error("act(...) is not supported in production builds of React.")}ke.Children={map:Vc,forEach:function(t,e,n){Vc(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Vc(t,function(){e++}),e},toArray:function(t){return Vc(t,function(e){return e})||[]},only:function(t){if(!wg(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ke.Component=Ha;ke.Fragment=uR;ke.Profiler=dR;ke.PureComponent=vg;ke.StrictMode=cR;ke.Suspense=mR;ke.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=wR;ke.act=dI;ke.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=sI({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=Eg.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)lI.call(e,l)&&!uI.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];r.children=a}return{$$typeof:$u,type:t.type,key:i,ref:s,props:r,_owner:o}};ke.createContext=function(t){return t={$$typeof:fR,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:hR,_context:t},t.Consumer=t};ke.createElement=cI;ke.createFactory=function(t){var e=cI.bind(null,t);return e.type=t,e};ke.createRef=function(){return{current:null}};ke.forwardRef=function(t){return{$$typeof:pR,render:t}};ke.isValidElement=wg;ke.lazy=function(t){return{$$typeof:_R,_payload:{_status:-1,_result:t},_init:ER}};ke.memo=function(t,e){return{$$typeof:gR,type:t,compare:e===void 0?null:e}};ke.startTransition=function(t){var e=ad.transition;ad.transition={};try{t()}finally{ad.transition=e}};ke.unstable_act=dI;ke.useCallback=function(t,e){return pn.current.useCallback(t,e)};ke.useContext=function(t){return pn.current.useContext(t)};ke.useDebugValue=function(){};ke.useDeferredValue=function(t){return pn.current.useDeferredValue(t)};ke.useEffect=function(t,e){return pn.current.useEffect(t,e)};ke.useId=function(){return pn.current.useId()};ke.useImperativeHandle=function(t,e,n){return pn.current.useImperativeHandle(t,e,n)};ke.useInsertionEffect=function(t,e){return pn.current.useInsertionEffect(t,e)};ke.useLayoutEffect=function(t,e){return pn.current.useLayoutEffect(t,e)};ke.useMemo=function(t,e){return pn.current.useMemo(t,e)};ke.useReducer=function(t,e,n){return pn.current.useReducer(t,e,n)};ke.useRef=function(t){return pn.current.useRef(t)};ke.useState=function(t){return pn.current.useState(t)};ke.useSyncExternalStore=function(t,e,n){return pn.current.useSyncExternalStore(t,e,n)};ke.useTransition=function(){return pn.current.useTransition()};ke.version="18.3.1";rI.exports=ke;var G=rI.exports;const hI=aR(G);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var IR=G,SR=Symbol.for("react.element"),xR=Symbol.for("react.fragment"),CR=Object.prototype.hasOwnProperty,AR=IR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,RR={key:!0,ref:!0,__self:!0,__source:!0};function fI(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)CR.call(e,r)&&!RR.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:SR,type:t,key:s,ref:o,props:i,_owner:AR.current}}Mh.Fragment=xR;Mh.jsx=fI;Mh.jsxs=fI;nI.exports=Mh;var h=nI.exports,bp={},pI={exports:{}},Vn={},mI={exports:{}},gI={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(Z,he){var fe=Z.length;Z.push(he);e:for(;0<fe;){var Ce=fe-1>>>1,Le=Z[Ce];if(0<i(Le,he))Z[Ce]=he,Z[fe]=Le,fe=Ce;else break e}}function n(Z){return Z.length===0?null:Z[0]}function r(Z){if(Z.length===0)return null;var he=Z[0],fe=Z.pop();if(fe!==he){Z[0]=fe;e:for(var Ce=0,Le=Z.length,At=Le>>>1;Ce<At;){var Oe=2*(Ce+1)-1,Dt=Z[Oe],Ne=Oe+1,je=Z[Ne];if(0>i(Dt,fe))Ne<Le&&0>i(je,Dt)?(Z[Ce]=je,Z[Ne]=fe,Ce=Ne):(Z[Ce]=Dt,Z[Oe]=fe,Ce=Oe);else if(Ne<Le&&0>i(je,fe))Z[Ce]=je,Z[Ne]=fe,Ce=Ne;else break e}}return he}function i(Z,he){var fe=Z.sortIndex-he.sortIndex;return fe!==0?fe:Z.id-he.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],u=[],p=1,m=null,g=3,v=!1,I=!1,P=!1,V=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function A(Z){for(var he=n(u);he!==null;){if(he.callback===null)r(u);else if(he.startTime<=Z)r(u),he.sortIndex=he.expirationTime,e(l,he);else break;he=n(u)}}function L(Z){if(P=!1,A(Z),!I)if(n(l)!==null)I=!0,Ue(q);else{var he=n(u);he!==null&&Ee(L,he.startTime-Z)}}function q(Z,he){I=!1,P&&(P=!1,C(x),x=-1),v=!0;var fe=g;try{for(A(he),m=n(l);m!==null&&(!(m.expirationTime>he)||Z&&!M());){var Ce=m.callback;if(typeof Ce=="function"){m.callback=null,g=m.priorityLevel;var Le=Ce(m.expirationTime<=he);he=t.unstable_now(),typeof Le=="function"?m.callback=Le:m===n(l)&&r(l),A(he)}else r(l);m=n(l)}if(m!==null)var At=!0;else{var Oe=n(u);Oe!==null&&Ee(L,Oe.startTime-he),At=!1}return At}finally{m=null,g=fe,v=!1}}var z=!1,E=null,x=-1,R=5,N=-1;function M(){return!(t.unstable_now()-N<R)}function U(){if(E!==null){var Z=t.unstable_now();N=Z;var he=!0;try{he=E(!0,Z)}finally{he?b():(z=!1,E=null)}}else z=!1}var b;if(typeof S=="function")b=function(){S(U)};else if(typeof MessageChannel<"u"){var xe=new MessageChannel,Ye=xe.port2;xe.port1.onmessage=U,b=function(){Ye.postMessage(null)}}else b=function(){V(U,0)};function Ue(Z){E=Z,z||(z=!0,b())}function Ee(Z,he){x=V(function(){Z(t.unstable_now())},he)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Z){Z.callback=null},t.unstable_continueExecution=function(){I||v||(I=!0,Ue(q))},t.unstable_forceFrameRate=function(Z){0>Z||125<Z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<Z?Math.floor(1e3/Z):5},t.unstable_getCurrentPriorityLevel=function(){return g},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(Z){switch(g){case 1:case 2:case 3:var he=3;break;default:he=g}var fe=g;g=he;try{return Z()}finally{g=fe}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Z,he){switch(Z){case 1:case 2:case 3:case 4:case 5:break;default:Z=3}var fe=g;g=Z;try{return he()}finally{g=fe}},t.unstable_scheduleCallback=function(Z,he,fe){var Ce=t.unstable_now();switch(typeof fe=="object"&&fe!==null?(fe=fe.delay,fe=typeof fe=="number"&&0<fe?Ce+fe:Ce):fe=Ce,Z){case 1:var Le=-1;break;case 2:Le=250;break;case 5:Le=1073741823;break;case 4:Le=1e4;break;default:Le=5e3}return Le=fe+Le,Z={id:p++,callback:he,priorityLevel:Z,startTime:fe,expirationTime:Le,sortIndex:-1},fe>Ce?(Z.sortIndex=fe,e(u,Z),n(l)===null&&Z===n(u)&&(P?(C(x),x=-1):P=!0,Ee(L,fe-Ce))):(Z.sortIndex=Le,e(l,Z),I||v||(I=!0,Ue(q))),Z},t.unstable_shouldYield=M,t.unstable_wrapCallback=function(Z){var he=g;return function(){var fe=g;g=he;try{return Z.apply(this,arguments)}finally{g=fe}}}})(gI);mI.exports=gI;var PR=mI.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kR=G,Dn=PR;function ne(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var _I=new Set,fu={};function vo(t,e){wa(t,e),wa(t+"Capture",e)}function wa(t,e){for(fu[t]=e,t=0;t<e.length;t++)_I.add(e[t])}var ni=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Dp=Object.prototype.hasOwnProperty,NR=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Py={},ky={};function bR(t){return Dp.call(ky,t)?!0:Dp.call(Py,t)?!1:NR.test(t)?ky[t]=!0:(Py[t]=!0,!1)}function DR(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function MR(t,e,n,r){if(e===null||typeof e>"u"||DR(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function mn(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Kt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Kt[t]=new mn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Kt[e]=new mn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Kt[t]=new mn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Kt[t]=new mn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Kt[t]=new mn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Kt[t]=new mn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Kt[t]=new mn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Kt[t]=new mn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Kt[t]=new mn(t,5,!1,t.toLowerCase(),null,!1,!1)});var Ig=/[\-:]([a-z])/g;function Sg(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Ig,Sg);Kt[e]=new mn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Ig,Sg);Kt[e]=new mn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Ig,Sg);Kt[e]=new mn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Kt[t]=new mn(t,1,!1,t.toLowerCase(),null,!1,!1)});Kt.xlinkHref=new mn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Kt[t]=new mn(t,1,!1,t.toLowerCase(),null,!0,!0)});function xg(t,e,n,r){var i=Kt.hasOwnProperty(e)?Kt[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(MR(e,n,i,r)&&(n=null),r||i===null?bR(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var ci=kR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Lc=Symbol.for("react.element"),Jo=Symbol.for("react.portal"),Qo=Symbol.for("react.fragment"),Cg=Symbol.for("react.strict_mode"),Mp=Symbol.for("react.profiler"),yI=Symbol.for("react.provider"),vI=Symbol.for("react.context"),Ag=Symbol.for("react.forward_ref"),Vp=Symbol.for("react.suspense"),Lp=Symbol.for("react.suspense_list"),Rg=Symbol.for("react.memo"),Li=Symbol.for("react.lazy"),TI=Symbol.for("react.offscreen"),Ny=Symbol.iterator;function El(t){return t===null||typeof t!="object"?null:(t=Ny&&t[Ny]||t["@@iterator"],typeof t=="function"?t:null)}var gt=Object.assign,zf;function Vl(t){if(zf===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);zf=e&&e[1]||""}return`
`+zf+t}var $f=!1;function jf(t,e){if(!t||$f)return"";$f=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{$f=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Vl(t):""}function VR(t){switch(t.tag){case 5:return Vl(t.type);case 16:return Vl("Lazy");case 13:return Vl("Suspense");case 19:return Vl("SuspenseList");case 0:case 2:case 15:return t=jf(t.type,!1),t;case 11:return t=jf(t.type.render,!1),t;case 1:return t=jf(t.type,!0),t;default:return""}}function Fp(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Qo:return"Fragment";case Jo:return"Portal";case Mp:return"Profiler";case Cg:return"StrictMode";case Vp:return"Suspense";case Lp:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case vI:return(t.displayName||"Context")+".Consumer";case yI:return(t._context.displayName||"Context")+".Provider";case Ag:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Rg:return e=t.displayName||null,e!==null?e:Fp(t.type)||"Memo";case Li:e=t._payload,t=t._init;try{return Fp(t(e))}catch{}}return null}function LR(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Fp(e);case 8:return e===Cg?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function ls(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function EI(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function FR(t){var e=EI(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Fc(t){t._valueTracker||(t._valueTracker=FR(t))}function wI(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=EI(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Vd(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Up(t,e){var n=e.checked;return gt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function by(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=ls(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function II(t,e){e=e.checked,e!=null&&xg(t,"checked",e,!1)}function Op(t,e){II(t,e);var n=ls(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Bp(t,e.type,n):e.hasOwnProperty("defaultValue")&&Bp(t,e.type,ls(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Dy(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Bp(t,e,n){(e!=="number"||Vd(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Ll=Array.isArray;function ua(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+ls(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Gp(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ne(91));return gt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function My(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(ne(92));if(Ll(n)){if(1<n.length)throw Error(ne(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:ls(n)}}function SI(t,e){var n=ls(e.value),r=ls(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Vy(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function xI(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function qp(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?xI(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Uc,CI=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Uc=Uc||document.createElement("div"),Uc.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Uc.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function pu(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var jl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},UR=["Webkit","ms","Moz","O"];Object.keys(jl).forEach(function(t){UR.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),jl[e]=jl[t]})});function AI(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||jl.hasOwnProperty(t)&&jl[t]?(""+e).trim():e+"px"}function RI(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=AI(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var OR=gt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function zp(t,e){if(e){if(OR[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ne(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ne(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ne(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ne(62))}}function $p(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var jp=null;function Pg(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Hp=null,ca=null,da=null;function Ly(t){if(t=Wu(t)){if(typeof Hp!="function")throw Error(ne(280));var e=t.stateNode;e&&(e=Oh(e),Hp(t.stateNode,t.type,e))}}function PI(t){ca?da?da.push(t):da=[t]:ca=t}function kI(){if(ca){var t=ca,e=da;if(da=ca=null,Ly(t),e)for(t=0;t<e.length;t++)Ly(e[t])}}function NI(t,e){return t(e)}function bI(){}var Hf=!1;function DI(t,e,n){if(Hf)return t(e,n);Hf=!0;try{return NI(t,e,n)}finally{Hf=!1,(ca!==null||da!==null)&&(bI(),kI())}}function mu(t,e){var n=t.stateNode;if(n===null)return null;var r=Oh(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(ne(231,e,typeof n));return n}var Wp=!1;if(ni)try{var wl={};Object.defineProperty(wl,"passive",{get:function(){Wp=!0}}),window.addEventListener("test",wl,wl),window.removeEventListener("test",wl,wl)}catch{Wp=!1}function BR(t,e,n,r,i,s,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(p){this.onError(p)}}var Hl=!1,Ld=null,Fd=!1,Kp=null,GR={onError:function(t){Hl=!0,Ld=t}};function qR(t,e,n,r,i,s,o,a,l){Hl=!1,Ld=null,BR.apply(GR,arguments)}function zR(t,e,n,r,i,s,o,a,l){if(qR.apply(this,arguments),Hl){if(Hl){var u=Ld;Hl=!1,Ld=null}else throw Error(ne(198));Fd||(Fd=!0,Kp=u)}}function To(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function MI(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Fy(t){if(To(t)!==t)throw Error(ne(188))}function $R(t){var e=t.alternate;if(!e){if(e=To(t),e===null)throw Error(ne(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return Fy(i),t;if(s===r)return Fy(i),e;s=s.sibling}throw Error(ne(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(ne(189))}}if(n.alternate!==r)throw Error(ne(190))}if(n.tag!==3)throw Error(ne(188));return n.stateNode.current===n?t:e}function VI(t){return t=$R(t),t!==null?LI(t):null}function LI(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=LI(t);if(e!==null)return e;t=t.sibling}return null}var FI=Dn.unstable_scheduleCallback,Uy=Dn.unstable_cancelCallback,jR=Dn.unstable_shouldYield,HR=Dn.unstable_requestPaint,wt=Dn.unstable_now,WR=Dn.unstable_getCurrentPriorityLevel,kg=Dn.unstable_ImmediatePriority,UI=Dn.unstable_UserBlockingPriority,Ud=Dn.unstable_NormalPriority,KR=Dn.unstable_LowPriority,OI=Dn.unstable_IdlePriority,Vh=null,Nr=null;function JR(t){if(Nr&&typeof Nr.onCommitFiberRoot=="function")try{Nr.onCommitFiberRoot(Vh,t,void 0,(t.current.flags&128)===128)}catch{}}var fr=Math.clz32?Math.clz32:XR,QR=Math.log,YR=Math.LN2;function XR(t){return t>>>=0,t===0?32:31-(QR(t)/YR|0)|0}var Oc=64,Bc=4194304;function Fl(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Od(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=Fl(a):(s&=o,s!==0&&(r=Fl(s)))}else o=n&~i,o!==0?r=Fl(o):s!==0&&(r=Fl(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-fr(e),i=1<<n,r|=t[n],e&=~i;return r}function ZR(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function eP(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-fr(s),a=1<<o,l=i[o];l===-1?(!(a&n)||a&r)&&(i[o]=ZR(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function Jp(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function BI(){var t=Oc;return Oc<<=1,!(Oc&4194240)&&(Oc=64),t}function Wf(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function ju(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-fr(e),t[e]=n}function tP(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-fr(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function Ng(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-fr(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var We=0;function GI(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var qI,bg,zI,$I,jI,Qp=!1,Gc=[],Wi=null,Ki=null,Ji=null,gu=new Map,_u=new Map,Ui=[],nP="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Oy(t,e){switch(t){case"focusin":case"focusout":Wi=null;break;case"dragenter":case"dragleave":Ki=null;break;case"mouseover":case"mouseout":Ji=null;break;case"pointerover":case"pointerout":gu.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":_u.delete(e.pointerId)}}function Il(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Wu(e),e!==null&&bg(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function rP(t,e,n,r,i){switch(e){case"focusin":return Wi=Il(Wi,t,e,n,r,i),!0;case"dragenter":return Ki=Il(Ki,t,e,n,r,i),!0;case"mouseover":return Ji=Il(Ji,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return gu.set(s,Il(gu.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,_u.set(s,Il(_u.get(s)||null,t,e,n,r,i)),!0}return!1}function HI(t){var e=Ws(t.target);if(e!==null){var n=To(e);if(n!==null){if(e=n.tag,e===13){if(e=MI(n),e!==null){t.blockedOn=e,jI(t.priority,function(){zI(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function ld(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Yp(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);jp=r,n.target.dispatchEvent(r),jp=null}else return e=Wu(n),e!==null&&bg(e),t.blockedOn=n,!1;e.shift()}return!0}function By(t,e,n){ld(t)&&n.delete(e)}function iP(){Qp=!1,Wi!==null&&ld(Wi)&&(Wi=null),Ki!==null&&ld(Ki)&&(Ki=null),Ji!==null&&ld(Ji)&&(Ji=null),gu.forEach(By),_u.forEach(By)}function Sl(t,e){t.blockedOn===e&&(t.blockedOn=null,Qp||(Qp=!0,Dn.unstable_scheduleCallback(Dn.unstable_NormalPriority,iP)))}function yu(t){function e(i){return Sl(i,t)}if(0<Gc.length){Sl(Gc[0],t);for(var n=1;n<Gc.length;n++){var r=Gc[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Wi!==null&&Sl(Wi,t),Ki!==null&&Sl(Ki,t),Ji!==null&&Sl(Ji,t),gu.forEach(e),_u.forEach(e),n=0;n<Ui.length;n++)r=Ui[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Ui.length&&(n=Ui[0],n.blockedOn===null);)HI(n),n.blockedOn===null&&Ui.shift()}var ha=ci.ReactCurrentBatchConfig,Bd=!0;function sP(t,e,n,r){var i=We,s=ha.transition;ha.transition=null;try{We=1,Dg(t,e,n,r)}finally{We=i,ha.transition=s}}function oP(t,e,n,r){var i=We,s=ha.transition;ha.transition=null;try{We=4,Dg(t,e,n,r)}finally{We=i,ha.transition=s}}function Dg(t,e,n,r){if(Bd){var i=Yp(t,e,n,r);if(i===null)rp(t,e,r,Gd,n),Oy(t,r);else if(rP(i,t,e,n,r))r.stopPropagation();else if(Oy(t,r),e&4&&-1<nP.indexOf(t)){for(;i!==null;){var s=Wu(i);if(s!==null&&qI(s),s=Yp(t,e,n,r),s===null&&rp(t,e,r,Gd,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else rp(t,e,r,null,n)}}var Gd=null;function Yp(t,e,n,r){if(Gd=null,t=Pg(r),t=Ws(t),t!==null)if(e=To(t),e===null)t=null;else if(n=e.tag,n===13){if(t=MI(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Gd=t,null}function WI(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(WR()){case kg:return 1;case UI:return 4;case Ud:case KR:return 16;case OI:return 536870912;default:return 16}default:return 16}}var $i=null,Mg=null,ud=null;function KI(){if(ud)return ud;var t,e=Mg,n=e.length,r,i="value"in $i?$i.value:$i.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return ud=i.slice(t,1<r?1-r:void 0)}function cd(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function qc(){return!0}function Gy(){return!1}function Ln(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?qc:Gy,this.isPropagationStopped=Gy,this}return gt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=qc)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=qc)},persist:function(){},isPersistent:qc}),e}var Wa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Vg=Ln(Wa),Hu=gt({},Wa,{view:0,detail:0}),aP=Ln(Hu),Kf,Jf,xl,Lh=gt({},Hu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Lg,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==xl&&(xl&&t.type==="mousemove"?(Kf=t.screenX-xl.screenX,Jf=t.screenY-xl.screenY):Jf=Kf=0,xl=t),Kf)},movementY:function(t){return"movementY"in t?t.movementY:Jf}}),qy=Ln(Lh),lP=gt({},Lh,{dataTransfer:0}),uP=Ln(lP),cP=gt({},Hu,{relatedTarget:0}),Qf=Ln(cP),dP=gt({},Wa,{animationName:0,elapsedTime:0,pseudoElement:0}),hP=Ln(dP),fP=gt({},Wa,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),pP=Ln(fP),mP=gt({},Wa,{data:0}),zy=Ln(mP),gP={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},_P={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},yP={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function vP(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=yP[t])?!!e[t]:!1}function Lg(){return vP}var TP=gt({},Hu,{key:function(t){if(t.key){var e=gP[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=cd(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?_P[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Lg,charCode:function(t){return t.type==="keypress"?cd(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?cd(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),EP=Ln(TP),wP=gt({},Lh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),$y=Ln(wP),IP=gt({},Hu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Lg}),SP=Ln(IP),xP=gt({},Wa,{propertyName:0,elapsedTime:0,pseudoElement:0}),CP=Ln(xP),AP=gt({},Lh,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),RP=Ln(AP),PP=[9,13,27,32],Fg=ni&&"CompositionEvent"in window,Wl=null;ni&&"documentMode"in document&&(Wl=document.documentMode);var kP=ni&&"TextEvent"in window&&!Wl,JI=ni&&(!Fg||Wl&&8<Wl&&11>=Wl),jy=" ",Hy=!1;function QI(t,e){switch(t){case"keyup":return PP.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function YI(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Yo=!1;function NP(t,e){switch(t){case"compositionend":return YI(e);case"keypress":return e.which!==32?null:(Hy=!0,jy);case"textInput":return t=e.data,t===jy&&Hy?null:t;default:return null}}function bP(t,e){if(Yo)return t==="compositionend"||!Fg&&QI(t,e)?(t=KI(),ud=Mg=$i=null,Yo=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return JI&&e.locale!=="ko"?null:e.data;default:return null}}var DP={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Wy(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!DP[t.type]:e==="textarea"}function XI(t,e,n,r){PI(r),e=qd(e,"onChange"),0<e.length&&(n=new Vg("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Kl=null,vu=null;function MP(t){uS(t,0)}function Fh(t){var e=ea(t);if(wI(e))return t}function VP(t,e){if(t==="change")return e}var ZI=!1;if(ni){var Yf;if(ni){var Xf="oninput"in document;if(!Xf){var Ky=document.createElement("div");Ky.setAttribute("oninput","return;"),Xf=typeof Ky.oninput=="function"}Yf=Xf}else Yf=!1;ZI=Yf&&(!document.documentMode||9<document.documentMode)}function Jy(){Kl&&(Kl.detachEvent("onpropertychange",eS),vu=Kl=null)}function eS(t){if(t.propertyName==="value"&&Fh(vu)){var e=[];XI(e,vu,t,Pg(t)),DI(MP,e)}}function LP(t,e,n){t==="focusin"?(Jy(),Kl=e,vu=n,Kl.attachEvent("onpropertychange",eS)):t==="focusout"&&Jy()}function FP(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Fh(vu)}function UP(t,e){if(t==="click")return Fh(e)}function OP(t,e){if(t==="input"||t==="change")return Fh(e)}function BP(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var yr=typeof Object.is=="function"?Object.is:BP;function Tu(t,e){if(yr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Dp.call(e,i)||!yr(t[i],e[i]))return!1}return!0}function Qy(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Yy(t,e){var n=Qy(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Qy(n)}}function tS(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?tS(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function nS(){for(var t=window,e=Vd();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Vd(t.document)}return e}function Ug(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function GP(t){var e=nS(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&tS(n.ownerDocument.documentElement,n)){if(r!==null&&Ug(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=Yy(n,s);var o=Yy(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var qP=ni&&"documentMode"in document&&11>=document.documentMode,Xo=null,Xp=null,Jl=null,Zp=!1;function Xy(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Zp||Xo==null||Xo!==Vd(r)||(r=Xo,"selectionStart"in r&&Ug(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Jl&&Tu(Jl,r)||(Jl=r,r=qd(Xp,"onSelect"),0<r.length&&(e=new Vg("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Xo)))}function zc(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Zo={animationend:zc("Animation","AnimationEnd"),animationiteration:zc("Animation","AnimationIteration"),animationstart:zc("Animation","AnimationStart"),transitionend:zc("Transition","TransitionEnd")},Zf={},rS={};ni&&(rS=document.createElement("div").style,"AnimationEvent"in window||(delete Zo.animationend.animation,delete Zo.animationiteration.animation,delete Zo.animationstart.animation),"TransitionEvent"in window||delete Zo.transitionend.transition);function Uh(t){if(Zf[t])return Zf[t];if(!Zo[t])return t;var e=Zo[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in rS)return Zf[t]=e[n];return t}var iS=Uh("animationend"),sS=Uh("animationiteration"),oS=Uh("animationstart"),aS=Uh("transitionend"),lS=new Map,Zy="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function _s(t,e){lS.set(t,e),vo(e,[t])}for(var ep=0;ep<Zy.length;ep++){var tp=Zy[ep],zP=tp.toLowerCase(),$P=tp[0].toUpperCase()+tp.slice(1);_s(zP,"on"+$P)}_s(iS,"onAnimationEnd");_s(sS,"onAnimationIteration");_s(oS,"onAnimationStart");_s("dblclick","onDoubleClick");_s("focusin","onFocus");_s("focusout","onBlur");_s(aS,"onTransitionEnd");wa("onMouseEnter",["mouseout","mouseover"]);wa("onMouseLeave",["mouseout","mouseover"]);wa("onPointerEnter",["pointerout","pointerover"]);wa("onPointerLeave",["pointerout","pointerover"]);vo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));vo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));vo("onBeforeInput",["compositionend","keypress","textInput","paste"]);vo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));vo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));vo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ul="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),jP=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ul));function ev(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,zR(r,e,void 0,t),t.currentTarget=null}function uS(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;ev(i,a,u),s=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;ev(i,a,u),s=l}}}if(Fd)throw t=Kp,Fd=!1,Kp=null,t}function it(t,e){var n=e[im];n===void 0&&(n=e[im]=new Set);var r=t+"__bubble";n.has(r)||(cS(e,t,2,!1),n.add(r))}function np(t,e,n){var r=0;e&&(r|=4),cS(n,t,r,e)}var $c="_reactListening"+Math.random().toString(36).slice(2);function Eu(t){if(!t[$c]){t[$c]=!0,_I.forEach(function(n){n!=="selectionchange"&&(jP.has(n)||np(n,!1,t),np(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[$c]||(e[$c]=!0,np("selectionchange",!1,e))}}function cS(t,e,n,r){switch(WI(e)){case 1:var i=sP;break;case 4:i=oP;break;default:i=Dg}n=i.bind(null,e,n,t),i=void 0,!Wp||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function rp(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=Ws(a),o===null)return;if(l=o.tag,l===5||l===6){r=s=o;continue e}a=a.parentNode}}r=r.return}DI(function(){var u=s,p=Pg(n),m=[];e:{var g=lS.get(t);if(g!==void 0){var v=Vg,I=t;switch(t){case"keypress":if(cd(n)===0)break e;case"keydown":case"keyup":v=EP;break;case"focusin":I="focus",v=Qf;break;case"focusout":I="blur",v=Qf;break;case"beforeblur":case"afterblur":v=Qf;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":v=qy;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":v=uP;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":v=SP;break;case iS:case sS:case oS:v=hP;break;case aS:v=CP;break;case"scroll":v=aP;break;case"wheel":v=RP;break;case"copy":case"cut":case"paste":v=pP;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":v=$y}var P=(e&4)!==0,V=!P&&t==="scroll",C=P?g!==null?g+"Capture":null:g;P=[];for(var S=u,A;S!==null;){A=S;var L=A.stateNode;if(A.tag===5&&L!==null&&(A=L,C!==null&&(L=mu(S,C),L!=null&&P.push(wu(S,L,A)))),V)break;S=S.return}0<P.length&&(g=new v(g,I,null,n,p),m.push({event:g,listeners:P}))}}if(!(e&7)){e:{if(g=t==="mouseover"||t==="pointerover",v=t==="mouseout"||t==="pointerout",g&&n!==jp&&(I=n.relatedTarget||n.fromElement)&&(Ws(I)||I[ri]))break e;if((v||g)&&(g=p.window===p?p:(g=p.ownerDocument)?g.defaultView||g.parentWindow:window,v?(I=n.relatedTarget||n.toElement,v=u,I=I?Ws(I):null,I!==null&&(V=To(I),I!==V||I.tag!==5&&I.tag!==6)&&(I=null)):(v=null,I=u),v!==I)){if(P=qy,L="onMouseLeave",C="onMouseEnter",S="mouse",(t==="pointerout"||t==="pointerover")&&(P=$y,L="onPointerLeave",C="onPointerEnter",S="pointer"),V=v==null?g:ea(v),A=I==null?g:ea(I),g=new P(L,S+"leave",v,n,p),g.target=V,g.relatedTarget=A,L=null,Ws(p)===u&&(P=new P(C,S+"enter",I,n,p),P.target=A,P.relatedTarget=V,L=P),V=L,v&&I)t:{for(P=v,C=I,S=0,A=P;A;A=Fo(A))S++;for(A=0,L=C;L;L=Fo(L))A++;for(;0<S-A;)P=Fo(P),S--;for(;0<A-S;)C=Fo(C),A--;for(;S--;){if(P===C||C!==null&&P===C.alternate)break t;P=Fo(P),C=Fo(C)}P=null}else P=null;v!==null&&tv(m,g,v,P,!1),I!==null&&V!==null&&tv(m,V,I,P,!0)}}e:{if(g=u?ea(u):window,v=g.nodeName&&g.nodeName.toLowerCase(),v==="select"||v==="input"&&g.type==="file")var q=VP;else if(Wy(g))if(ZI)q=OP;else{q=FP;var z=LP}else(v=g.nodeName)&&v.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(q=UP);if(q&&(q=q(t,u))){XI(m,q,n,p);break e}z&&z(t,g,u),t==="focusout"&&(z=g._wrapperState)&&z.controlled&&g.type==="number"&&Bp(g,"number",g.value)}switch(z=u?ea(u):window,t){case"focusin":(Wy(z)||z.contentEditable==="true")&&(Xo=z,Xp=u,Jl=null);break;case"focusout":Jl=Xp=Xo=null;break;case"mousedown":Zp=!0;break;case"contextmenu":case"mouseup":case"dragend":Zp=!1,Xy(m,n,p);break;case"selectionchange":if(qP)break;case"keydown":case"keyup":Xy(m,n,p)}var E;if(Fg)e:{switch(t){case"compositionstart":var x="onCompositionStart";break e;case"compositionend":x="onCompositionEnd";break e;case"compositionupdate":x="onCompositionUpdate";break e}x=void 0}else Yo?QI(t,n)&&(x="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(x="onCompositionStart");x&&(JI&&n.locale!=="ko"&&(Yo||x!=="onCompositionStart"?x==="onCompositionEnd"&&Yo&&(E=KI()):($i=p,Mg="value"in $i?$i.value:$i.textContent,Yo=!0)),z=qd(u,x),0<z.length&&(x=new zy(x,t,null,n,p),m.push({event:x,listeners:z}),E?x.data=E:(E=YI(n),E!==null&&(x.data=E)))),(E=kP?NP(t,n):bP(t,n))&&(u=qd(u,"onBeforeInput"),0<u.length&&(p=new zy("onBeforeInput","beforeinput",null,n,p),m.push({event:p,listeners:u}),p.data=E))}uS(m,e)})}function wu(t,e,n){return{instance:t,listener:e,currentTarget:n}}function qd(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=mu(t,n),s!=null&&r.unshift(wu(t,s,i)),s=mu(t,e),s!=null&&r.push(wu(t,s,i))),t=t.return}return r}function Fo(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function tv(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,u=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&u!==null&&(a=u,i?(l=mu(n,s),l!=null&&o.unshift(wu(n,l,a))):i||(l=mu(n,s),l!=null&&o.push(wu(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var HP=/\r\n?/g,WP=/\u0000|\uFFFD/g;function nv(t){return(typeof t=="string"?t:""+t).replace(HP,`
`).replace(WP,"")}function jc(t,e,n){if(e=nv(e),nv(t)!==e&&n)throw Error(ne(425))}function zd(){}var em=null,tm=null;function nm(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var rm=typeof setTimeout=="function"?setTimeout:void 0,KP=typeof clearTimeout=="function"?clearTimeout:void 0,rv=typeof Promise=="function"?Promise:void 0,JP=typeof queueMicrotask=="function"?queueMicrotask:typeof rv<"u"?function(t){return rv.resolve(null).then(t).catch(QP)}:rm;function QP(t){setTimeout(function(){throw t})}function ip(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),yu(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);yu(e)}function Qi(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function iv(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Ka=Math.random().toString(36).slice(2),Rr="__reactFiber$"+Ka,Iu="__reactProps$"+Ka,ri="__reactContainer$"+Ka,im="__reactEvents$"+Ka,YP="__reactListeners$"+Ka,XP="__reactHandles$"+Ka;function Ws(t){var e=t[Rr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[ri]||n[Rr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=iv(t);t!==null;){if(n=t[Rr])return n;t=iv(t)}return e}t=n,n=t.parentNode}return null}function Wu(t){return t=t[Rr]||t[ri],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function ea(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ne(33))}function Oh(t){return t[Iu]||null}var sm=[],ta=-1;function ys(t){return{current:t}}function at(t){0>ta||(t.current=sm[ta],sm[ta]=null,ta--)}function nt(t,e){ta++,sm[ta]=t.current,t.current=e}var us={},sn=ys(us),Tn=ys(!1),io=us;function Ia(t,e){var n=t.type.contextTypes;if(!n)return us;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function En(t){return t=t.childContextTypes,t!=null}function $d(){at(Tn),at(sn)}function sv(t,e,n){if(sn.current!==us)throw Error(ne(168));nt(sn,e),nt(Tn,n)}function dS(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(ne(108,LR(t)||"Unknown",i));return gt({},n,r)}function jd(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||us,io=sn.current,nt(sn,t),nt(Tn,Tn.current),!0}function ov(t,e,n){var r=t.stateNode;if(!r)throw Error(ne(169));n?(t=dS(t,e,io),r.__reactInternalMemoizedMergedChildContext=t,at(Tn),at(sn),nt(sn,t)):at(Tn),nt(Tn,n)}var Wr=null,Bh=!1,sp=!1;function hS(t){Wr===null?Wr=[t]:Wr.push(t)}function ZP(t){Bh=!0,hS(t)}function vs(){if(!sp&&Wr!==null){sp=!0;var t=0,e=We;try{var n=Wr;for(We=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Wr=null,Bh=!1}catch(i){throw Wr!==null&&(Wr=Wr.slice(t+1)),FI(kg,vs),i}finally{We=e,sp=!1}}return null}var na=[],ra=0,Hd=null,Wd=0,$n=[],jn=0,so=null,Jr=1,Qr="";function Fs(t,e){na[ra++]=Wd,na[ra++]=Hd,Hd=t,Wd=e}function fS(t,e,n){$n[jn++]=Jr,$n[jn++]=Qr,$n[jn++]=so,so=t;var r=Jr;t=Qr;var i=32-fr(r)-1;r&=~(1<<i),n+=1;var s=32-fr(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Jr=1<<32-fr(e)+i|n<<i|r,Qr=s+t}else Jr=1<<s|n<<i|r,Qr=t}function Og(t){t.return!==null&&(Fs(t,1),fS(t,1,0))}function Bg(t){for(;t===Hd;)Hd=na[--ra],na[ra]=null,Wd=na[--ra],na[ra]=null;for(;t===so;)so=$n[--jn],$n[jn]=null,Qr=$n[--jn],$n[jn]=null,Jr=$n[--jn],$n[jn]=null}var bn=null,kn=null,ct=!1,cr=null;function pS(t,e){var n=Hn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function av(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,bn=t,kn=Qi(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,bn=t,kn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=so!==null?{id:Jr,overflow:Qr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Hn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,bn=t,kn=null,!0):!1;default:return!1}}function om(t){return(t.mode&1)!==0&&(t.flags&128)===0}function am(t){if(ct){var e=kn;if(e){var n=e;if(!av(t,e)){if(om(t))throw Error(ne(418));e=Qi(n.nextSibling);var r=bn;e&&av(t,e)?pS(r,n):(t.flags=t.flags&-4097|2,ct=!1,bn=t)}}else{if(om(t))throw Error(ne(418));t.flags=t.flags&-4097|2,ct=!1,bn=t}}}function lv(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;bn=t}function Hc(t){if(t!==bn)return!1;if(!ct)return lv(t),ct=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!nm(t.type,t.memoizedProps)),e&&(e=kn)){if(om(t))throw mS(),Error(ne(418));for(;e;)pS(t,e),e=Qi(e.nextSibling)}if(lv(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ne(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){kn=Qi(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}kn=null}}else kn=bn?Qi(t.stateNode.nextSibling):null;return!0}function mS(){for(var t=kn;t;)t=Qi(t.nextSibling)}function Sa(){kn=bn=null,ct=!1}function Gg(t){cr===null?cr=[t]:cr.push(t)}var ek=ci.ReactCurrentBatchConfig;function Cl(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ne(309));var r=n.stateNode}if(!r)throw Error(ne(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(ne(284));if(!n._owner)throw Error(ne(290,t))}return t}function Wc(t,e){throw t=Object.prototype.toString.call(e),Error(ne(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function uv(t){var e=t._init;return e(t._payload)}function gS(t){function e(C,S){if(t){var A=C.deletions;A===null?(C.deletions=[S],C.flags|=16):A.push(S)}}function n(C,S){if(!t)return null;for(;S!==null;)e(C,S),S=S.sibling;return null}function r(C,S){for(C=new Map;S!==null;)S.key!==null?C.set(S.key,S):C.set(S.index,S),S=S.sibling;return C}function i(C,S){return C=es(C,S),C.index=0,C.sibling=null,C}function s(C,S,A){return C.index=A,t?(A=C.alternate,A!==null?(A=A.index,A<S?(C.flags|=2,S):A):(C.flags|=2,S)):(C.flags|=1048576,S)}function o(C){return t&&C.alternate===null&&(C.flags|=2),C}function a(C,S,A,L){return S===null||S.tag!==6?(S=hp(A,C.mode,L),S.return=C,S):(S=i(S,A),S.return=C,S)}function l(C,S,A,L){var q=A.type;return q===Qo?p(C,S,A.props.children,L,A.key):S!==null&&(S.elementType===q||typeof q=="object"&&q!==null&&q.$$typeof===Li&&uv(q)===S.type)?(L=i(S,A.props),L.ref=Cl(C,S,A),L.return=C,L):(L=_d(A.type,A.key,A.props,null,C.mode,L),L.ref=Cl(C,S,A),L.return=C,L)}function u(C,S,A,L){return S===null||S.tag!==4||S.stateNode.containerInfo!==A.containerInfo||S.stateNode.implementation!==A.implementation?(S=fp(A,C.mode,L),S.return=C,S):(S=i(S,A.children||[]),S.return=C,S)}function p(C,S,A,L,q){return S===null||S.tag!==7?(S=Zs(A,C.mode,L,q),S.return=C,S):(S=i(S,A),S.return=C,S)}function m(C,S,A){if(typeof S=="string"&&S!==""||typeof S=="number")return S=hp(""+S,C.mode,A),S.return=C,S;if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Lc:return A=_d(S.type,S.key,S.props,null,C.mode,A),A.ref=Cl(C,null,S),A.return=C,A;case Jo:return S=fp(S,C.mode,A),S.return=C,S;case Li:var L=S._init;return m(C,L(S._payload),A)}if(Ll(S)||El(S))return S=Zs(S,C.mode,A,null),S.return=C,S;Wc(C,S)}return null}function g(C,S,A,L){var q=S!==null?S.key:null;if(typeof A=="string"&&A!==""||typeof A=="number")return q!==null?null:a(C,S,""+A,L);if(typeof A=="object"&&A!==null){switch(A.$$typeof){case Lc:return A.key===q?l(C,S,A,L):null;case Jo:return A.key===q?u(C,S,A,L):null;case Li:return q=A._init,g(C,S,q(A._payload),L)}if(Ll(A)||El(A))return q!==null?null:p(C,S,A,L,null);Wc(C,A)}return null}function v(C,S,A,L,q){if(typeof L=="string"&&L!==""||typeof L=="number")return C=C.get(A)||null,a(S,C,""+L,q);if(typeof L=="object"&&L!==null){switch(L.$$typeof){case Lc:return C=C.get(L.key===null?A:L.key)||null,l(S,C,L,q);case Jo:return C=C.get(L.key===null?A:L.key)||null,u(S,C,L,q);case Li:var z=L._init;return v(C,S,A,z(L._payload),q)}if(Ll(L)||El(L))return C=C.get(A)||null,p(S,C,L,q,null);Wc(S,L)}return null}function I(C,S,A,L){for(var q=null,z=null,E=S,x=S=0,R=null;E!==null&&x<A.length;x++){E.index>x?(R=E,E=null):R=E.sibling;var N=g(C,E,A[x],L);if(N===null){E===null&&(E=R);break}t&&E&&N.alternate===null&&e(C,E),S=s(N,S,x),z===null?q=N:z.sibling=N,z=N,E=R}if(x===A.length)return n(C,E),ct&&Fs(C,x),q;if(E===null){for(;x<A.length;x++)E=m(C,A[x],L),E!==null&&(S=s(E,S,x),z===null?q=E:z.sibling=E,z=E);return ct&&Fs(C,x),q}for(E=r(C,E);x<A.length;x++)R=v(E,C,x,A[x],L),R!==null&&(t&&R.alternate!==null&&E.delete(R.key===null?x:R.key),S=s(R,S,x),z===null?q=R:z.sibling=R,z=R);return t&&E.forEach(function(M){return e(C,M)}),ct&&Fs(C,x),q}function P(C,S,A,L){var q=El(A);if(typeof q!="function")throw Error(ne(150));if(A=q.call(A),A==null)throw Error(ne(151));for(var z=q=null,E=S,x=S=0,R=null,N=A.next();E!==null&&!N.done;x++,N=A.next()){E.index>x?(R=E,E=null):R=E.sibling;var M=g(C,E,N.value,L);if(M===null){E===null&&(E=R);break}t&&E&&M.alternate===null&&e(C,E),S=s(M,S,x),z===null?q=M:z.sibling=M,z=M,E=R}if(N.done)return n(C,E),ct&&Fs(C,x),q;if(E===null){for(;!N.done;x++,N=A.next())N=m(C,N.value,L),N!==null&&(S=s(N,S,x),z===null?q=N:z.sibling=N,z=N);return ct&&Fs(C,x),q}for(E=r(C,E);!N.done;x++,N=A.next())N=v(E,C,x,N.value,L),N!==null&&(t&&N.alternate!==null&&E.delete(N.key===null?x:N.key),S=s(N,S,x),z===null?q=N:z.sibling=N,z=N);return t&&E.forEach(function(U){return e(C,U)}),ct&&Fs(C,x),q}function V(C,S,A,L){if(typeof A=="object"&&A!==null&&A.type===Qo&&A.key===null&&(A=A.props.children),typeof A=="object"&&A!==null){switch(A.$$typeof){case Lc:e:{for(var q=A.key,z=S;z!==null;){if(z.key===q){if(q=A.type,q===Qo){if(z.tag===7){n(C,z.sibling),S=i(z,A.props.children),S.return=C,C=S;break e}}else if(z.elementType===q||typeof q=="object"&&q!==null&&q.$$typeof===Li&&uv(q)===z.type){n(C,z.sibling),S=i(z,A.props),S.ref=Cl(C,z,A),S.return=C,C=S;break e}n(C,z);break}else e(C,z);z=z.sibling}A.type===Qo?(S=Zs(A.props.children,C.mode,L,A.key),S.return=C,C=S):(L=_d(A.type,A.key,A.props,null,C.mode,L),L.ref=Cl(C,S,A),L.return=C,C=L)}return o(C);case Jo:e:{for(z=A.key;S!==null;){if(S.key===z)if(S.tag===4&&S.stateNode.containerInfo===A.containerInfo&&S.stateNode.implementation===A.implementation){n(C,S.sibling),S=i(S,A.children||[]),S.return=C,C=S;break e}else{n(C,S);break}else e(C,S);S=S.sibling}S=fp(A,C.mode,L),S.return=C,C=S}return o(C);case Li:return z=A._init,V(C,S,z(A._payload),L)}if(Ll(A))return I(C,S,A,L);if(El(A))return P(C,S,A,L);Wc(C,A)}return typeof A=="string"&&A!==""||typeof A=="number"?(A=""+A,S!==null&&S.tag===6?(n(C,S.sibling),S=i(S,A),S.return=C,C=S):(n(C,S),S=hp(A,C.mode,L),S.return=C,C=S),o(C)):n(C,S)}return V}var xa=gS(!0),_S=gS(!1),Kd=ys(null),Jd=null,ia=null,qg=null;function zg(){qg=ia=Jd=null}function $g(t){var e=Kd.current;at(Kd),t._currentValue=e}function lm(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function fa(t,e){Jd=t,qg=ia=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(yn=!0),t.firstContext=null)}function Xn(t){var e=t._currentValue;if(qg!==t)if(t={context:t,memoizedValue:e,next:null},ia===null){if(Jd===null)throw Error(ne(308));ia=t,Jd.dependencies={lanes:0,firstContext:t}}else ia=ia.next=t;return e}var Ks=null;function jg(t){Ks===null?Ks=[t]:Ks.push(t)}function yS(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,jg(e)):(n.next=i.next,i.next=n),e.interleaved=n,ii(t,r)}function ii(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Fi=!1;function Hg(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function vS(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function ei(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Yi(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Fe&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,ii(t,n)}return i=r.interleaved,i===null?(e.next=e,jg(r)):(e.next=i.next,i.next=e),r.interleaved=e,ii(t,n)}function dd(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Ng(t,n)}}function cv(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Qd(t,e,n,r){var i=t.updateQueue;Fi=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?s=u:o.next=u,o=l;var p=t.alternate;p!==null&&(p=p.updateQueue,a=p.lastBaseUpdate,a!==o&&(a===null?p.firstBaseUpdate=u:a.next=u,p.lastBaseUpdate=l))}if(s!==null){var m=i.baseState;o=0,p=u=l=null,a=s;do{var g=a.lane,v=a.eventTime;if((r&g)===g){p!==null&&(p=p.next={eventTime:v,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var I=t,P=a;switch(g=e,v=n,P.tag){case 1:if(I=P.payload,typeof I=="function"){m=I.call(v,m,g);break e}m=I;break e;case 3:I.flags=I.flags&-65537|128;case 0:if(I=P.payload,g=typeof I=="function"?I.call(v,m,g):I,g==null)break e;m=gt({},m,g);break e;case 2:Fi=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,g=i.effects,g===null?i.effects=[a]:g.push(a))}else v={eventTime:v,lane:g,tag:a.tag,payload:a.payload,callback:a.callback,next:null},p===null?(u=p=v,l=m):p=p.next=v,o|=g;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;g=a,a=g.next,g.next=null,i.lastBaseUpdate=g,i.shared.pending=null}}while(!0);if(p===null&&(l=m),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=p,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);ao|=o,t.lanes=o,t.memoizedState=m}}function dv(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(ne(191,i));i.call(r)}}}var Ku={},br=ys(Ku),Su=ys(Ku),xu=ys(Ku);function Js(t){if(t===Ku)throw Error(ne(174));return t}function Wg(t,e){switch(nt(xu,e),nt(Su,t),nt(br,Ku),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:qp(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=qp(e,t)}at(br),nt(br,e)}function Ca(){at(br),at(Su),at(xu)}function TS(t){Js(xu.current);var e=Js(br.current),n=qp(e,t.type);e!==n&&(nt(Su,t),nt(br,n))}function Kg(t){Su.current===t&&(at(br),at(Su))}var ft=ys(0);function Yd(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var op=[];function Jg(){for(var t=0;t<op.length;t++)op[t]._workInProgressVersionPrimary=null;op.length=0}var hd=ci.ReactCurrentDispatcher,ap=ci.ReactCurrentBatchConfig,oo=0,mt=null,Rt=null,Lt=null,Xd=!1,Ql=!1,Cu=0,tk=0;function Qt(){throw Error(ne(321))}function Qg(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!yr(t[n],e[n]))return!1;return!0}function Yg(t,e,n,r,i,s){if(oo=s,mt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,hd.current=t===null||t.memoizedState===null?sk:ok,t=n(r,i),Ql){s=0;do{if(Ql=!1,Cu=0,25<=s)throw Error(ne(301));s+=1,Lt=Rt=null,e.updateQueue=null,hd.current=ak,t=n(r,i)}while(Ql)}if(hd.current=Zd,e=Rt!==null&&Rt.next!==null,oo=0,Lt=Rt=mt=null,Xd=!1,e)throw Error(ne(300));return t}function Xg(){var t=Cu!==0;return Cu=0,t}function Cr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Lt===null?mt.memoizedState=Lt=t:Lt=Lt.next=t,Lt}function Zn(){if(Rt===null){var t=mt.alternate;t=t!==null?t.memoizedState:null}else t=Rt.next;var e=Lt===null?mt.memoizedState:Lt.next;if(e!==null)Lt=e,Rt=t;else{if(t===null)throw Error(ne(310));Rt=t,t={memoizedState:Rt.memoizedState,baseState:Rt.baseState,baseQueue:Rt.baseQueue,queue:Rt.queue,next:null},Lt===null?mt.memoizedState=Lt=t:Lt=Lt.next=t}return Lt}function Au(t,e){return typeof e=="function"?e(t):e}function lp(t){var e=Zn(),n=e.queue;if(n===null)throw Error(ne(311));n.lastRenderedReducer=t;var r=Rt,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,l=null,u=s;do{var p=u.lane;if((oo&p)===p)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var m={lane:p,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=m,o=r):l=l.next=m,mt.lanes|=p,ao|=p}u=u.next}while(u!==null&&u!==s);l===null?o=r:l.next=a,yr(r,e.memoizedState)||(yn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,mt.lanes|=s,ao|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function up(t){var e=Zn(),n=e.queue;if(n===null)throw Error(ne(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);yr(s,e.memoizedState)||(yn=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function ES(){}function wS(t,e){var n=mt,r=Zn(),i=e(),s=!yr(r.memoizedState,i);if(s&&(r.memoizedState=i,yn=!0),r=r.queue,Zg(xS.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||Lt!==null&&Lt.memoizedState.tag&1){if(n.flags|=2048,Ru(9,SS.bind(null,n,r,i,e),void 0,null),Ft===null)throw Error(ne(349));oo&30||IS(n,e,i)}return i}function IS(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=mt.updateQueue,e===null?(e={lastEffect:null,stores:null},mt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function SS(t,e,n,r){e.value=n,e.getSnapshot=r,CS(e)&&AS(t)}function xS(t,e,n){return n(function(){CS(e)&&AS(t)})}function CS(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!yr(t,n)}catch{return!0}}function AS(t){var e=ii(t,1);e!==null&&pr(e,t,1,-1)}function hv(t){var e=Cr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Au,lastRenderedState:t},e.queue=t,t=t.dispatch=ik.bind(null,mt,t),[e.memoizedState,t]}function Ru(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=mt.updateQueue,e===null?(e={lastEffect:null,stores:null},mt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function RS(){return Zn().memoizedState}function fd(t,e,n,r){var i=Cr();mt.flags|=t,i.memoizedState=Ru(1|e,n,void 0,r===void 0?null:r)}function Gh(t,e,n,r){var i=Zn();r=r===void 0?null:r;var s=void 0;if(Rt!==null){var o=Rt.memoizedState;if(s=o.destroy,r!==null&&Qg(r,o.deps)){i.memoizedState=Ru(e,n,s,r);return}}mt.flags|=t,i.memoizedState=Ru(1|e,n,s,r)}function fv(t,e){return fd(8390656,8,t,e)}function Zg(t,e){return Gh(2048,8,t,e)}function PS(t,e){return Gh(4,2,t,e)}function kS(t,e){return Gh(4,4,t,e)}function NS(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function bS(t,e,n){return n=n!=null?n.concat([t]):null,Gh(4,4,NS.bind(null,e,t),n)}function e_(){}function DS(t,e){var n=Zn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Qg(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function MS(t,e){var n=Zn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Qg(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function VS(t,e,n){return oo&21?(yr(n,e)||(n=BI(),mt.lanes|=n,ao|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,yn=!0),t.memoizedState=n)}function nk(t,e){var n=We;We=n!==0&&4>n?n:4,t(!0);var r=ap.transition;ap.transition={};try{t(!1),e()}finally{We=n,ap.transition=r}}function LS(){return Zn().memoizedState}function rk(t,e,n){var r=Zi(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},FS(t))US(e,n);else if(n=yS(t,e,n,r),n!==null){var i=dn();pr(n,t,r,i),OS(n,e,r)}}function ik(t,e,n){var r=Zi(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(FS(t))US(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,yr(a,o)){var l=e.interleaved;l===null?(i.next=i,jg(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=yS(t,e,i,r),n!==null&&(i=dn(),pr(n,t,r,i),OS(n,e,r))}}function FS(t){var e=t.alternate;return t===mt||e!==null&&e===mt}function US(t,e){Ql=Xd=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function OS(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Ng(t,n)}}var Zd={readContext:Xn,useCallback:Qt,useContext:Qt,useEffect:Qt,useImperativeHandle:Qt,useInsertionEffect:Qt,useLayoutEffect:Qt,useMemo:Qt,useReducer:Qt,useRef:Qt,useState:Qt,useDebugValue:Qt,useDeferredValue:Qt,useTransition:Qt,useMutableSource:Qt,useSyncExternalStore:Qt,useId:Qt,unstable_isNewReconciler:!1},sk={readContext:Xn,useCallback:function(t,e){return Cr().memoizedState=[t,e===void 0?null:e],t},useContext:Xn,useEffect:fv,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,fd(4194308,4,NS.bind(null,e,t),n)},useLayoutEffect:function(t,e){return fd(4194308,4,t,e)},useInsertionEffect:function(t,e){return fd(4,2,t,e)},useMemo:function(t,e){var n=Cr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Cr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=rk.bind(null,mt,t),[r.memoizedState,t]},useRef:function(t){var e=Cr();return t={current:t},e.memoizedState=t},useState:hv,useDebugValue:e_,useDeferredValue:function(t){return Cr().memoizedState=t},useTransition:function(){var t=hv(!1),e=t[0];return t=nk.bind(null,t[1]),Cr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=mt,i=Cr();if(ct){if(n===void 0)throw Error(ne(407));n=n()}else{if(n=e(),Ft===null)throw Error(ne(349));oo&30||IS(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,fv(xS.bind(null,r,s,t),[t]),r.flags|=2048,Ru(9,SS.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=Cr(),e=Ft.identifierPrefix;if(ct){var n=Qr,r=Jr;n=(r&~(1<<32-fr(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Cu++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=tk++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},ok={readContext:Xn,useCallback:DS,useContext:Xn,useEffect:Zg,useImperativeHandle:bS,useInsertionEffect:PS,useLayoutEffect:kS,useMemo:MS,useReducer:lp,useRef:RS,useState:function(){return lp(Au)},useDebugValue:e_,useDeferredValue:function(t){var e=Zn();return VS(e,Rt.memoizedState,t)},useTransition:function(){var t=lp(Au)[0],e=Zn().memoizedState;return[t,e]},useMutableSource:ES,useSyncExternalStore:wS,useId:LS,unstable_isNewReconciler:!1},ak={readContext:Xn,useCallback:DS,useContext:Xn,useEffect:Zg,useImperativeHandle:bS,useInsertionEffect:PS,useLayoutEffect:kS,useMemo:MS,useReducer:up,useRef:RS,useState:function(){return up(Au)},useDebugValue:e_,useDeferredValue:function(t){var e=Zn();return Rt===null?e.memoizedState=t:VS(e,Rt.memoizedState,t)},useTransition:function(){var t=up(Au)[0],e=Zn().memoizedState;return[t,e]},useMutableSource:ES,useSyncExternalStore:wS,useId:LS,unstable_isNewReconciler:!1};function ar(t,e){if(t&&t.defaultProps){e=gt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function um(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:gt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var qh={isMounted:function(t){return(t=t._reactInternals)?To(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=dn(),i=Zi(t),s=ei(r,i);s.payload=e,n!=null&&(s.callback=n),e=Yi(t,s,i),e!==null&&(pr(e,t,i,r),dd(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=dn(),i=Zi(t),s=ei(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=Yi(t,s,i),e!==null&&(pr(e,t,i,r),dd(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=dn(),r=Zi(t),i=ei(n,r);i.tag=2,e!=null&&(i.callback=e),e=Yi(t,i,r),e!==null&&(pr(e,t,r,n),dd(e,t,r))}};function pv(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!Tu(n,r)||!Tu(i,s):!0}function BS(t,e,n){var r=!1,i=us,s=e.contextType;return typeof s=="object"&&s!==null?s=Xn(s):(i=En(e)?io:sn.current,r=e.contextTypes,s=(r=r!=null)?Ia(t,i):us),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=qh,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function mv(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&qh.enqueueReplaceState(e,e.state,null)}function cm(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},Hg(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Xn(s):(s=En(e)?io:sn.current,i.context=Ia(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(um(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&qh.enqueueReplaceState(i,i.state,null),Qd(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Aa(t,e){try{var n="",r=e;do n+=VR(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function cp(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function dm(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var lk=typeof WeakMap=="function"?WeakMap:Map;function GS(t,e,n){n=ei(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){th||(th=!0,Em=r),dm(t,e)},n}function qS(t,e,n){n=ei(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){dm(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){dm(t,e),typeof r!="function"&&(Xi===null?Xi=new Set([this]):Xi.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function gv(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new lk;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=wk.bind(null,t,e,n),e.then(t,t))}function _v(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function yv(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=ei(-1,1),e.tag=2,Yi(n,e,1))),n.lanes|=1),t)}var uk=ci.ReactCurrentOwner,yn=!1;function ln(t,e,n,r){e.child=t===null?_S(e,null,n,r):xa(e,t.child,n,r)}function vv(t,e,n,r,i){n=n.render;var s=e.ref;return fa(e,i),r=Yg(t,e,n,r,s,i),n=Xg(),t!==null&&!yn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,si(t,e,i)):(ct&&n&&Og(e),e.flags|=1,ln(t,e,r,i),e.child)}function Tv(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!l_(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,zS(t,e,s,r,i)):(t=_d(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:Tu,n(o,r)&&t.ref===e.ref)return si(t,e,i)}return e.flags|=1,t=es(s,r),t.ref=e.ref,t.return=e,e.child=t}function zS(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(Tu(s,r)&&t.ref===e.ref)if(yn=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(yn=!0);else return e.lanes=t.lanes,si(t,e,i)}return hm(t,e,n,r,i)}function $S(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},nt(oa,An),An|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,nt(oa,An),An|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,nt(oa,An),An|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,nt(oa,An),An|=r;return ln(t,e,i,n),e.child}function jS(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function hm(t,e,n,r,i){var s=En(n)?io:sn.current;return s=Ia(e,s),fa(e,i),n=Yg(t,e,n,r,s,i),r=Xg(),t!==null&&!yn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,si(t,e,i)):(ct&&r&&Og(e),e.flags|=1,ln(t,e,n,i),e.child)}function Ev(t,e,n,r,i){if(En(n)){var s=!0;jd(e)}else s=!1;if(fa(e,i),e.stateNode===null)pd(t,e),BS(e,n,r),cm(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=Xn(u):(u=En(n)?io:sn.current,u=Ia(e,u));var p=n.getDerivedStateFromProps,m=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function";m||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==u)&&mv(e,o,r,u),Fi=!1;var g=e.memoizedState;o.state=g,Qd(e,r,o,i),l=e.memoizedState,a!==r||g!==l||Tn.current||Fi?(typeof p=="function"&&(um(e,n,p,r),l=e.memoizedState),(a=Fi||pv(e,n,a,r,g,l,u))?(m||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=u,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,vS(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:ar(e.type,a),o.props=u,m=e.pendingProps,g=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=Xn(l):(l=En(n)?io:sn.current,l=Ia(e,l));var v=n.getDerivedStateFromProps;(p=typeof v=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==m||g!==l)&&mv(e,o,r,l),Fi=!1,g=e.memoizedState,o.state=g,Qd(e,r,o,i);var I=e.memoizedState;a!==m||g!==I||Tn.current||Fi?(typeof v=="function"&&(um(e,n,v,r),I=e.memoizedState),(u=Fi||pv(e,n,u,r,g,I,l)||!1)?(p||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,I,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,I,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=I),o.props=r,o.state=I,o.context=l,r=u):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),r=!1)}return fm(t,e,n,r,s,i)}function fm(t,e,n,r,i,s){jS(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&ov(e,n,!1),si(t,e,s);r=e.stateNode,uk.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=xa(e,t.child,null,s),e.child=xa(e,null,a,s)):ln(t,e,a,s),e.memoizedState=r.state,i&&ov(e,n,!0),e.child}function HS(t){var e=t.stateNode;e.pendingContext?sv(t,e.pendingContext,e.pendingContext!==e.context):e.context&&sv(t,e.context,!1),Wg(t,e.containerInfo)}function wv(t,e,n,r,i){return Sa(),Gg(i),e.flags|=256,ln(t,e,n,r),e.child}var pm={dehydrated:null,treeContext:null,retryLane:0};function mm(t){return{baseLanes:t,cachePool:null,transitions:null}}function WS(t,e,n){var r=e.pendingProps,i=ft.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),nt(ft,i&1),t===null)return am(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=jh(o,r,0,null),t=Zs(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=mm(n),e.memoizedState=pm,t):t_(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return ck(t,e,o,r,a,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=es(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=es(a,s):(s=Zs(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?mm(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=pm,r}return s=t.child,t=s.sibling,r=es(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function t_(t,e){return e=jh({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Kc(t,e,n,r){return r!==null&&Gg(r),xa(e,t.child,null,n),t=t_(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function ck(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=cp(Error(ne(422))),Kc(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=jh({mode:"visible",children:r.children},i,0,null),s=Zs(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&xa(e,t.child,null,o),e.child.memoizedState=mm(o),e.memoizedState=pm,s);if(!(e.mode&1))return Kc(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(ne(419)),r=cp(s,r,void 0),Kc(t,e,o,r)}if(a=(o&t.childLanes)!==0,yn||a){if(r=Ft,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,ii(t,i),pr(r,t,i,-1))}return a_(),r=cp(Error(ne(421))),Kc(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=Ik.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,kn=Qi(i.nextSibling),bn=e,ct=!0,cr=null,t!==null&&($n[jn++]=Jr,$n[jn++]=Qr,$n[jn++]=so,Jr=t.id,Qr=t.overflow,so=e),e=t_(e,r.children),e.flags|=4096,e)}function Iv(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),lm(t.return,e,n)}function dp(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function KS(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(ln(t,e,r.children,n),r=ft.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Iv(t,n,e);else if(t.tag===19)Iv(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(nt(ft,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&Yd(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),dp(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Yd(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}dp(e,!0,n,null,s);break;case"together":dp(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function pd(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function si(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),ao|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ne(153));if(e.child!==null){for(t=e.child,n=es(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=es(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function dk(t,e,n){switch(e.tag){case 3:HS(e),Sa();break;case 5:TS(e);break;case 1:En(e.type)&&jd(e);break;case 4:Wg(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;nt(Kd,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(nt(ft,ft.current&1),e.flags|=128,null):n&e.child.childLanes?WS(t,e,n):(nt(ft,ft.current&1),t=si(t,e,n),t!==null?t.sibling:null);nt(ft,ft.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return KS(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),nt(ft,ft.current),r)break;return null;case 22:case 23:return e.lanes=0,$S(t,e,n)}return si(t,e,n)}var JS,gm,QS,YS;JS=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};gm=function(){};QS=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Js(br.current);var s=null;switch(n){case"input":i=Up(t,i),r=Up(t,r),s=[];break;case"select":i=gt({},i,{value:void 0}),r=gt({},r,{value:void 0}),s=[];break;case"textarea":i=Gp(t,i),r=Gp(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=zd)}zp(n,r);var o;n=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var a=i[u];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(fu.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var l=r[u];if(a=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(fu.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&it("scroll",t),s||a===l||(s=[])):(s=s||[]).push(u,l))}n&&(s=s||[]).push("style",n);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};YS=function(t,e,n,r){n!==r&&(e.flags|=4)};function Al(t,e){if(!ct)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Yt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function hk(t,e,n){var r=e.pendingProps;switch(Bg(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Yt(e),null;case 1:return En(e.type)&&$d(),Yt(e),null;case 3:return r=e.stateNode,Ca(),at(Tn),at(sn),Jg(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Hc(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,cr!==null&&(Sm(cr),cr=null))),gm(t,e),Yt(e),null;case 5:Kg(e);var i=Js(xu.current);if(n=e.type,t!==null&&e.stateNode!=null)QS(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(ne(166));return Yt(e),null}if(t=Js(br.current),Hc(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[Rr]=e,r[Iu]=s,t=(e.mode&1)!==0,n){case"dialog":it("cancel",r),it("close",r);break;case"iframe":case"object":case"embed":it("load",r);break;case"video":case"audio":for(i=0;i<Ul.length;i++)it(Ul[i],r);break;case"source":it("error",r);break;case"img":case"image":case"link":it("error",r),it("load",r);break;case"details":it("toggle",r);break;case"input":by(r,s),it("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},it("invalid",r);break;case"textarea":My(r,s),it("invalid",r)}zp(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&jc(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&jc(r.textContent,a,t),i=["children",""+a]):fu.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&it("scroll",r)}switch(n){case"input":Fc(r),Dy(r,s,!0);break;case"textarea":Fc(r),Vy(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=zd)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=xI(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Rr]=e,t[Iu]=r,JS(t,e,!1,!1),e.stateNode=t;e:{switch(o=$p(n,r),n){case"dialog":it("cancel",t),it("close",t),i=r;break;case"iframe":case"object":case"embed":it("load",t),i=r;break;case"video":case"audio":for(i=0;i<Ul.length;i++)it(Ul[i],t);i=r;break;case"source":it("error",t),i=r;break;case"img":case"image":case"link":it("error",t),it("load",t),i=r;break;case"details":it("toggle",t),i=r;break;case"input":by(t,r),i=Up(t,r),it("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=gt({},r,{value:void 0}),it("invalid",t);break;case"textarea":My(t,r),i=Gp(t,r),it("invalid",t);break;default:i=r}zp(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?RI(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&CI(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&pu(t,l):typeof l=="number"&&pu(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(fu.hasOwnProperty(s)?l!=null&&s==="onScroll"&&it("scroll",t):l!=null&&xg(t,s,l,o))}switch(n){case"input":Fc(t),Dy(t,r,!1);break;case"textarea":Fc(t),Vy(t);break;case"option":r.value!=null&&t.setAttribute("value",""+ls(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?ua(t,!!r.multiple,s,!1):r.defaultValue!=null&&ua(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=zd)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Yt(e),null;case 6:if(t&&e.stateNode!=null)YS(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(ne(166));if(n=Js(xu.current),Js(br.current),Hc(e)){if(r=e.stateNode,n=e.memoizedProps,r[Rr]=e,(s=r.nodeValue!==n)&&(t=bn,t!==null))switch(t.tag){case 3:jc(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&jc(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Rr]=e,e.stateNode=r}return Yt(e),null;case 13:if(at(ft),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ct&&kn!==null&&e.mode&1&&!(e.flags&128))mS(),Sa(),e.flags|=98560,s=!1;else if(s=Hc(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(ne(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ne(317));s[Rr]=e}else Sa(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Yt(e),s=!1}else cr!==null&&(Sm(cr),cr=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||ft.current&1?Pt===0&&(Pt=3):a_())),e.updateQueue!==null&&(e.flags|=4),Yt(e),null);case 4:return Ca(),gm(t,e),t===null&&Eu(e.stateNode.containerInfo),Yt(e),null;case 10:return $g(e.type._context),Yt(e),null;case 17:return En(e.type)&&$d(),Yt(e),null;case 19:if(at(ft),s=e.memoizedState,s===null)return Yt(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)Al(s,!1);else{if(Pt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Yd(t),o!==null){for(e.flags|=128,Al(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return nt(ft,ft.current&1|2),e.child}t=t.sibling}s.tail!==null&&wt()>Ra&&(e.flags|=128,r=!0,Al(s,!1),e.lanes=4194304)}else{if(!r)if(t=Yd(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Al(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!ct)return Yt(e),null}else 2*wt()-s.renderingStartTime>Ra&&n!==1073741824&&(e.flags|=128,r=!0,Al(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=wt(),e.sibling=null,n=ft.current,nt(ft,r?n&1|2:n&1),e):(Yt(e),null);case 22:case 23:return o_(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?An&1073741824&&(Yt(e),e.subtreeFlags&6&&(e.flags|=8192)):Yt(e),null;case 24:return null;case 25:return null}throw Error(ne(156,e.tag))}function fk(t,e){switch(Bg(e),e.tag){case 1:return En(e.type)&&$d(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Ca(),at(Tn),at(sn),Jg(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Kg(e),null;case 13:if(at(ft),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ne(340));Sa()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return at(ft),null;case 4:return Ca(),null;case 10:return $g(e.type._context),null;case 22:case 23:return o_(),null;case 24:return null;default:return null}}var Jc=!1,en=!1,pk=typeof WeakSet=="function"?WeakSet:Set,oe=null;function sa(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){vt(t,e,r)}else n.current=null}function _m(t,e,n){try{n()}catch(r){vt(t,e,r)}}var Sv=!1;function mk(t,e){if(em=Bd,t=nS(),Ug(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,u=0,p=0,m=t,g=null;t:for(;;){for(var v;m!==n||i!==0&&m.nodeType!==3||(a=o+i),m!==s||r!==0&&m.nodeType!==3||(l=o+r),m.nodeType===3&&(o+=m.nodeValue.length),(v=m.firstChild)!==null;)g=m,m=v;for(;;){if(m===t)break t;if(g===n&&++u===i&&(a=o),g===s&&++p===r&&(l=o),(v=m.nextSibling)!==null)break;m=g,g=m.parentNode}m=v}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(tm={focusedElem:t,selectionRange:n},Bd=!1,oe=e;oe!==null;)if(e=oe,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,oe=t;else for(;oe!==null;){e=oe;try{var I=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(I!==null){var P=I.memoizedProps,V=I.memoizedState,C=e.stateNode,S=C.getSnapshotBeforeUpdate(e.elementType===e.type?P:ar(e.type,P),V);C.__reactInternalSnapshotBeforeUpdate=S}break;case 3:var A=e.stateNode.containerInfo;A.nodeType===1?A.textContent="":A.nodeType===9&&A.documentElement&&A.removeChild(A.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ne(163))}}catch(L){vt(e,e.return,L)}if(t=e.sibling,t!==null){t.return=e.return,oe=t;break}oe=e.return}return I=Sv,Sv=!1,I}function Yl(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&_m(e,n,s)}i=i.next}while(i!==r)}}function zh(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function ym(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function XS(t){var e=t.alternate;e!==null&&(t.alternate=null,XS(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Rr],delete e[Iu],delete e[im],delete e[YP],delete e[XP])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function ZS(t){return t.tag===5||t.tag===3||t.tag===4}function xv(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||ZS(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function vm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=zd));else if(r!==4&&(t=t.child,t!==null))for(vm(t,e,n),t=t.sibling;t!==null;)vm(t,e,n),t=t.sibling}function Tm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Tm(t,e,n),t=t.sibling;t!==null;)Tm(t,e,n),t=t.sibling}var $t=null,lr=!1;function Pi(t,e,n){for(n=n.child;n!==null;)ex(t,e,n),n=n.sibling}function ex(t,e,n){if(Nr&&typeof Nr.onCommitFiberUnmount=="function")try{Nr.onCommitFiberUnmount(Vh,n)}catch{}switch(n.tag){case 5:en||sa(n,e);case 6:var r=$t,i=lr;$t=null,Pi(t,e,n),$t=r,lr=i,$t!==null&&(lr?(t=$t,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):$t.removeChild(n.stateNode));break;case 18:$t!==null&&(lr?(t=$t,n=n.stateNode,t.nodeType===8?ip(t.parentNode,n):t.nodeType===1&&ip(t,n),yu(t)):ip($t,n.stateNode));break;case 4:r=$t,i=lr,$t=n.stateNode.containerInfo,lr=!0,Pi(t,e,n),$t=r,lr=i;break;case 0:case 11:case 14:case 15:if(!en&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&_m(n,e,o),i=i.next}while(i!==r)}Pi(t,e,n);break;case 1:if(!en&&(sa(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){vt(n,e,a)}Pi(t,e,n);break;case 21:Pi(t,e,n);break;case 22:n.mode&1?(en=(r=en)||n.memoizedState!==null,Pi(t,e,n),en=r):Pi(t,e,n);break;default:Pi(t,e,n)}}function Cv(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new pk),e.forEach(function(r){var i=Sk.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function or(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:$t=a.stateNode,lr=!1;break e;case 3:$t=a.stateNode.containerInfo,lr=!0;break e;case 4:$t=a.stateNode.containerInfo,lr=!0;break e}a=a.return}if($t===null)throw Error(ne(160));ex(s,o,i),$t=null,lr=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){vt(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)tx(e,t),e=e.sibling}function tx(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(or(e,t),Sr(t),r&4){try{Yl(3,t,t.return),zh(3,t)}catch(P){vt(t,t.return,P)}try{Yl(5,t,t.return)}catch(P){vt(t,t.return,P)}}break;case 1:or(e,t),Sr(t),r&512&&n!==null&&sa(n,n.return);break;case 5:if(or(e,t),Sr(t),r&512&&n!==null&&sa(n,n.return),t.flags&32){var i=t.stateNode;try{pu(i,"")}catch(P){vt(t,t.return,P)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&II(i,s),$p(a,o);var u=$p(a,s);for(o=0;o<l.length;o+=2){var p=l[o],m=l[o+1];p==="style"?RI(i,m):p==="dangerouslySetInnerHTML"?CI(i,m):p==="children"?pu(i,m):xg(i,p,m,u)}switch(a){case"input":Op(i,s);break;case"textarea":SI(i,s);break;case"select":var g=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var v=s.value;v!=null?ua(i,!!s.multiple,v,!1):g!==!!s.multiple&&(s.defaultValue!=null?ua(i,!!s.multiple,s.defaultValue,!0):ua(i,!!s.multiple,s.multiple?[]:"",!1))}i[Iu]=s}catch(P){vt(t,t.return,P)}}break;case 6:if(or(e,t),Sr(t),r&4){if(t.stateNode===null)throw Error(ne(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(P){vt(t,t.return,P)}}break;case 3:if(or(e,t),Sr(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{yu(e.containerInfo)}catch(P){vt(t,t.return,P)}break;case 4:or(e,t),Sr(t);break;case 13:or(e,t),Sr(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(i_=wt())),r&4&&Cv(t);break;case 22:if(p=n!==null&&n.memoizedState!==null,t.mode&1?(en=(u=en)||p,or(e,t),en=u):or(e,t),Sr(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!p&&t.mode&1)for(oe=t,p=t.child;p!==null;){for(m=oe=p;oe!==null;){switch(g=oe,v=g.child,g.tag){case 0:case 11:case 14:case 15:Yl(4,g,g.return);break;case 1:sa(g,g.return);var I=g.stateNode;if(typeof I.componentWillUnmount=="function"){r=g,n=g.return;try{e=r,I.props=e.memoizedProps,I.state=e.memoizedState,I.componentWillUnmount()}catch(P){vt(r,n,P)}}break;case 5:sa(g,g.return);break;case 22:if(g.memoizedState!==null){Rv(m);continue}}v!==null?(v.return=g,oe=v):Rv(m)}p=p.sibling}e:for(p=null,m=t;;){if(m.tag===5){if(p===null){p=m;try{i=m.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=m.stateNode,l=m.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=AI("display",o))}catch(P){vt(t,t.return,P)}}}else if(m.tag===6){if(p===null)try{m.stateNode.nodeValue=u?"":m.memoizedProps}catch(P){vt(t,t.return,P)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===t)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===t)break e;for(;m.sibling===null;){if(m.return===null||m.return===t)break e;p===m&&(p=null),m=m.return}p===m&&(p=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:or(e,t),Sr(t),r&4&&Cv(t);break;case 21:break;default:or(e,t),Sr(t)}}function Sr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(ZS(n)){var r=n;break e}n=n.return}throw Error(ne(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(pu(i,""),r.flags&=-33);var s=xv(t);Tm(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=xv(t);vm(t,a,o);break;default:throw Error(ne(161))}}catch(l){vt(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function gk(t,e,n){oe=t,nx(t)}function nx(t,e,n){for(var r=(t.mode&1)!==0;oe!==null;){var i=oe,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||Jc;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||en;a=Jc;var u=en;if(Jc=o,(en=l)&&!u)for(oe=i;oe!==null;)o=oe,l=o.child,o.tag===22&&o.memoizedState!==null?Pv(i):l!==null?(l.return=o,oe=l):Pv(i);for(;s!==null;)oe=s,nx(s),s=s.sibling;oe=i,Jc=a,en=u}Av(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,oe=s):Av(t)}}function Av(t){for(;oe!==null;){var e=oe;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:en||zh(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!en)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:ar(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&dv(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}dv(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var p=u.memoizedState;if(p!==null){var m=p.dehydrated;m!==null&&yu(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ne(163))}en||e.flags&512&&ym(e)}catch(g){vt(e,e.return,g)}}if(e===t){oe=null;break}if(n=e.sibling,n!==null){n.return=e.return,oe=n;break}oe=e.return}}function Rv(t){for(;oe!==null;){var e=oe;if(e===t){oe=null;break}var n=e.sibling;if(n!==null){n.return=e.return,oe=n;break}oe=e.return}}function Pv(t){for(;oe!==null;){var e=oe;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{zh(4,e)}catch(l){vt(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){vt(e,i,l)}}var s=e.return;try{ym(e)}catch(l){vt(e,s,l)}break;case 5:var o=e.return;try{ym(e)}catch(l){vt(e,o,l)}}}catch(l){vt(e,e.return,l)}if(e===t){oe=null;break}var a=e.sibling;if(a!==null){a.return=e.return,oe=a;break}oe=e.return}}var _k=Math.ceil,eh=ci.ReactCurrentDispatcher,n_=ci.ReactCurrentOwner,Jn=ci.ReactCurrentBatchConfig,Fe=0,Ft=null,xt=null,Wt=0,An=0,oa=ys(0),Pt=0,Pu=null,ao=0,$h=0,r_=0,Xl=null,_n=null,i_=0,Ra=1/0,Hr=null,th=!1,Em=null,Xi=null,Qc=!1,ji=null,nh=0,Zl=0,wm=null,md=-1,gd=0;function dn(){return Fe&6?wt():md!==-1?md:md=wt()}function Zi(t){return t.mode&1?Fe&2&&Wt!==0?Wt&-Wt:ek.transition!==null?(gd===0&&(gd=BI()),gd):(t=We,t!==0||(t=window.event,t=t===void 0?16:WI(t.type)),t):1}function pr(t,e,n,r){if(50<Zl)throw Zl=0,wm=null,Error(ne(185));ju(t,n,r),(!(Fe&2)||t!==Ft)&&(t===Ft&&(!(Fe&2)&&($h|=n),Pt===4&&Oi(t,Wt)),wn(t,r),n===1&&Fe===0&&!(e.mode&1)&&(Ra=wt()+500,Bh&&vs()))}function wn(t,e){var n=t.callbackNode;eP(t,e);var r=Od(t,t===Ft?Wt:0);if(r===0)n!==null&&Uy(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Uy(n),e===1)t.tag===0?ZP(kv.bind(null,t)):hS(kv.bind(null,t)),JP(function(){!(Fe&6)&&vs()}),n=null;else{switch(GI(r)){case 1:n=kg;break;case 4:n=UI;break;case 16:n=Ud;break;case 536870912:n=OI;break;default:n=Ud}n=cx(n,rx.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function rx(t,e){if(md=-1,gd=0,Fe&6)throw Error(ne(327));var n=t.callbackNode;if(pa()&&t.callbackNode!==n)return null;var r=Od(t,t===Ft?Wt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=rh(t,r);else{e=r;var i=Fe;Fe|=2;var s=sx();(Ft!==t||Wt!==e)&&(Hr=null,Ra=wt()+500,Xs(t,e));do try{Tk();break}catch(a){ix(t,a)}while(!0);zg(),eh.current=s,Fe=i,xt!==null?e=0:(Ft=null,Wt=0,e=Pt)}if(e!==0){if(e===2&&(i=Jp(t),i!==0&&(r=i,e=Im(t,i))),e===1)throw n=Pu,Xs(t,0),Oi(t,r),wn(t,wt()),n;if(e===6)Oi(t,r);else{if(i=t.current.alternate,!(r&30)&&!yk(i)&&(e=rh(t,r),e===2&&(s=Jp(t),s!==0&&(r=s,e=Im(t,s))),e===1))throw n=Pu,Xs(t,0),Oi(t,r),wn(t,wt()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(ne(345));case 2:Us(t,_n,Hr);break;case 3:if(Oi(t,r),(r&130023424)===r&&(e=i_+500-wt(),10<e)){if(Od(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){dn(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=rm(Us.bind(null,t,_n,Hr),e);break}Us(t,_n,Hr);break;case 4:if(Oi(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-fr(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=wt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*_k(r/1960))-r,10<r){t.timeoutHandle=rm(Us.bind(null,t,_n,Hr),r);break}Us(t,_n,Hr);break;case 5:Us(t,_n,Hr);break;default:throw Error(ne(329))}}}return wn(t,wt()),t.callbackNode===n?rx.bind(null,t):null}function Im(t,e){var n=Xl;return t.current.memoizedState.isDehydrated&&(Xs(t,e).flags|=256),t=rh(t,e),t!==2&&(e=_n,_n=n,e!==null&&Sm(e)),t}function Sm(t){_n===null?_n=t:_n.push.apply(_n,t)}function yk(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!yr(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Oi(t,e){for(e&=~r_,e&=~$h,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-fr(e),r=1<<n;t[n]=-1,e&=~r}}function kv(t){if(Fe&6)throw Error(ne(327));pa();var e=Od(t,0);if(!(e&1))return wn(t,wt()),null;var n=rh(t,e);if(t.tag!==0&&n===2){var r=Jp(t);r!==0&&(e=r,n=Im(t,r))}if(n===1)throw n=Pu,Xs(t,0),Oi(t,e),wn(t,wt()),n;if(n===6)throw Error(ne(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Us(t,_n,Hr),wn(t,wt()),null}function s_(t,e){var n=Fe;Fe|=1;try{return t(e)}finally{Fe=n,Fe===0&&(Ra=wt()+500,Bh&&vs())}}function lo(t){ji!==null&&ji.tag===0&&!(Fe&6)&&pa();var e=Fe;Fe|=1;var n=Jn.transition,r=We;try{if(Jn.transition=null,We=1,t)return t()}finally{We=r,Jn.transition=n,Fe=e,!(Fe&6)&&vs()}}function o_(){An=oa.current,at(oa)}function Xs(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,KP(n)),xt!==null)for(n=xt.return;n!==null;){var r=n;switch(Bg(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&$d();break;case 3:Ca(),at(Tn),at(sn),Jg();break;case 5:Kg(r);break;case 4:Ca();break;case 13:at(ft);break;case 19:at(ft);break;case 10:$g(r.type._context);break;case 22:case 23:o_()}n=n.return}if(Ft=t,xt=t=es(t.current,null),Wt=An=e,Pt=0,Pu=null,r_=$h=ao=0,_n=Xl=null,Ks!==null){for(e=0;e<Ks.length;e++)if(n=Ks[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}Ks=null}return t}function ix(t,e){do{var n=xt;try{if(zg(),hd.current=Zd,Xd){for(var r=mt.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Xd=!1}if(oo=0,Lt=Rt=mt=null,Ql=!1,Cu=0,n_.current=null,n===null||n.return===null){Pt=1,Pu=e,xt=null;break}e:{var s=t,o=n.return,a=n,l=e;if(e=Wt,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,p=a,m=p.tag;if(!(p.mode&1)&&(m===0||m===11||m===15)){var g=p.alternate;g?(p.updateQueue=g.updateQueue,p.memoizedState=g.memoizedState,p.lanes=g.lanes):(p.updateQueue=null,p.memoizedState=null)}var v=_v(o);if(v!==null){v.flags&=-257,yv(v,o,a,s,e),v.mode&1&&gv(s,u,e),e=v,l=u;var I=e.updateQueue;if(I===null){var P=new Set;P.add(l),e.updateQueue=P}else I.add(l);break e}else{if(!(e&1)){gv(s,u,e),a_();break e}l=Error(ne(426))}}else if(ct&&a.mode&1){var V=_v(o);if(V!==null){!(V.flags&65536)&&(V.flags|=256),yv(V,o,a,s,e),Gg(Aa(l,a));break e}}s=l=Aa(l,a),Pt!==4&&(Pt=2),Xl===null?Xl=[s]:Xl.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var C=GS(s,l,e);cv(s,C);break e;case 1:a=l;var S=s.type,A=s.stateNode;if(!(s.flags&128)&&(typeof S.getDerivedStateFromError=="function"||A!==null&&typeof A.componentDidCatch=="function"&&(Xi===null||!Xi.has(A)))){s.flags|=65536,e&=-e,s.lanes|=e;var L=qS(s,a,e);cv(s,L);break e}}s=s.return}while(s!==null)}ax(n)}catch(q){e=q,xt===n&&n!==null&&(xt=n=n.return);continue}break}while(!0)}function sx(){var t=eh.current;return eh.current=Zd,t===null?Zd:t}function a_(){(Pt===0||Pt===3||Pt===2)&&(Pt=4),Ft===null||!(ao&268435455)&&!($h&268435455)||Oi(Ft,Wt)}function rh(t,e){var n=Fe;Fe|=2;var r=sx();(Ft!==t||Wt!==e)&&(Hr=null,Xs(t,e));do try{vk();break}catch(i){ix(t,i)}while(!0);if(zg(),Fe=n,eh.current=r,xt!==null)throw Error(ne(261));return Ft=null,Wt=0,Pt}function vk(){for(;xt!==null;)ox(xt)}function Tk(){for(;xt!==null&&!jR();)ox(xt)}function ox(t){var e=ux(t.alternate,t,An);t.memoizedProps=t.pendingProps,e===null?ax(t):xt=e,n_.current=null}function ax(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=fk(n,e),n!==null){n.flags&=32767,xt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Pt=6,xt=null;return}}else if(n=hk(n,e,An),n!==null){xt=n;return}if(e=e.sibling,e!==null){xt=e;return}xt=e=t}while(e!==null);Pt===0&&(Pt=5)}function Us(t,e,n){var r=We,i=Jn.transition;try{Jn.transition=null,We=1,Ek(t,e,n,r)}finally{Jn.transition=i,We=r}return null}function Ek(t,e,n,r){do pa();while(ji!==null);if(Fe&6)throw Error(ne(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(ne(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(tP(t,s),t===Ft&&(xt=Ft=null,Wt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Qc||(Qc=!0,cx(Ud,function(){return pa(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=Jn.transition,Jn.transition=null;var o=We;We=1;var a=Fe;Fe|=4,n_.current=null,mk(t,n),tx(n,t),GP(tm),Bd=!!em,tm=em=null,t.current=n,gk(n),HR(),Fe=a,We=o,Jn.transition=s}else t.current=n;if(Qc&&(Qc=!1,ji=t,nh=i),s=t.pendingLanes,s===0&&(Xi=null),JR(n.stateNode),wn(t,wt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(th)throw th=!1,t=Em,Em=null,t;return nh&1&&t.tag!==0&&pa(),s=t.pendingLanes,s&1?t===wm?Zl++:(Zl=0,wm=t):Zl=0,vs(),null}function pa(){if(ji!==null){var t=GI(nh),e=Jn.transition,n=We;try{if(Jn.transition=null,We=16>t?16:t,ji===null)var r=!1;else{if(t=ji,ji=null,nh=0,Fe&6)throw Error(ne(331));var i=Fe;for(Fe|=4,oe=t.current;oe!==null;){var s=oe,o=s.child;if(oe.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(oe=u;oe!==null;){var p=oe;switch(p.tag){case 0:case 11:case 15:Yl(8,p,s)}var m=p.child;if(m!==null)m.return=p,oe=m;else for(;oe!==null;){p=oe;var g=p.sibling,v=p.return;if(XS(p),p===u){oe=null;break}if(g!==null){g.return=v,oe=g;break}oe=v}}}var I=s.alternate;if(I!==null){var P=I.child;if(P!==null){I.child=null;do{var V=P.sibling;P.sibling=null,P=V}while(P!==null)}}oe=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,oe=o;else e:for(;oe!==null;){if(s=oe,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Yl(9,s,s.return)}var C=s.sibling;if(C!==null){C.return=s.return,oe=C;break e}oe=s.return}}var S=t.current;for(oe=S;oe!==null;){o=oe;var A=o.child;if(o.subtreeFlags&2064&&A!==null)A.return=o,oe=A;else e:for(o=S;oe!==null;){if(a=oe,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:zh(9,a)}}catch(q){vt(a,a.return,q)}if(a===o){oe=null;break e}var L=a.sibling;if(L!==null){L.return=a.return,oe=L;break e}oe=a.return}}if(Fe=i,vs(),Nr&&typeof Nr.onPostCommitFiberRoot=="function")try{Nr.onPostCommitFiberRoot(Vh,t)}catch{}r=!0}return r}finally{We=n,Jn.transition=e}}return!1}function Nv(t,e,n){e=Aa(n,e),e=GS(t,e,1),t=Yi(t,e,1),e=dn(),t!==null&&(ju(t,1,e),wn(t,e))}function vt(t,e,n){if(t.tag===3)Nv(t,t,n);else for(;e!==null;){if(e.tag===3){Nv(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Xi===null||!Xi.has(r))){t=Aa(n,t),t=qS(e,t,1),e=Yi(e,t,1),t=dn(),e!==null&&(ju(e,1,t),wn(e,t));break}}e=e.return}}function wk(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=dn(),t.pingedLanes|=t.suspendedLanes&n,Ft===t&&(Wt&n)===n&&(Pt===4||Pt===3&&(Wt&130023424)===Wt&&500>wt()-i_?Xs(t,0):r_|=n),wn(t,e)}function lx(t,e){e===0&&(t.mode&1?(e=Bc,Bc<<=1,!(Bc&130023424)&&(Bc=4194304)):e=1);var n=dn();t=ii(t,e),t!==null&&(ju(t,e,n),wn(t,n))}function Ik(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),lx(t,n)}function Sk(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(ne(314))}r!==null&&r.delete(e),lx(t,n)}var ux;ux=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Tn.current)yn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return yn=!1,dk(t,e,n);yn=!!(t.flags&131072)}else yn=!1,ct&&e.flags&1048576&&fS(e,Wd,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;pd(t,e),t=e.pendingProps;var i=Ia(e,sn.current);fa(e,n),i=Yg(null,e,r,t,i,n);var s=Xg();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,En(r)?(s=!0,jd(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Hg(e),i.updater=qh,e.stateNode=i,i._reactInternals=e,cm(e,r,t,n),e=fm(null,e,r,!0,s,n)):(e.tag=0,ct&&s&&Og(e),ln(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(pd(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=Ck(r),t=ar(r,t),i){case 0:e=hm(null,e,r,t,n);break e;case 1:e=Ev(null,e,r,t,n);break e;case 11:e=vv(null,e,r,t,n);break e;case 14:e=Tv(null,e,r,ar(r.type,t),n);break e}throw Error(ne(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ar(r,i),hm(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ar(r,i),Ev(t,e,r,i,n);case 3:e:{if(HS(e),t===null)throw Error(ne(387));r=e.pendingProps,s=e.memoizedState,i=s.element,vS(t,e),Qd(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Aa(Error(ne(423)),e),e=wv(t,e,r,n,i);break e}else if(r!==i){i=Aa(Error(ne(424)),e),e=wv(t,e,r,n,i);break e}else for(kn=Qi(e.stateNode.containerInfo.firstChild),bn=e,ct=!0,cr=null,n=_S(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Sa(),r===i){e=si(t,e,n);break e}ln(t,e,r,n)}e=e.child}return e;case 5:return TS(e),t===null&&am(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,nm(r,i)?o=null:s!==null&&nm(r,s)&&(e.flags|=32),jS(t,e),ln(t,e,o,n),e.child;case 6:return t===null&&am(e),null;case 13:return WS(t,e,n);case 4:return Wg(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=xa(e,null,r,n):ln(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ar(r,i),vv(t,e,r,i,n);case 7:return ln(t,e,e.pendingProps,n),e.child;case 8:return ln(t,e,e.pendingProps.children,n),e.child;case 12:return ln(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,nt(Kd,r._currentValue),r._currentValue=o,s!==null)if(yr(s.value,o)){if(s.children===i.children&&!Tn.current){e=si(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=ei(-1,n&-n),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var p=u.pending;p===null?l.next=l:(l.next=p.next,p.next=l),u.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),lm(s.return,n,e),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(ne(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),lm(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}ln(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,fa(e,n),i=Xn(i),r=r(i),e.flags|=1,ln(t,e,r,n),e.child;case 14:return r=e.type,i=ar(r,e.pendingProps),i=ar(r.type,i),Tv(t,e,r,i,n);case 15:return zS(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ar(r,i),pd(t,e),e.tag=1,En(r)?(t=!0,jd(e)):t=!1,fa(e,n),BS(e,r,i),cm(e,r,i,n),fm(null,e,r,!0,t,n);case 19:return KS(t,e,n);case 22:return $S(t,e,n)}throw Error(ne(156,e.tag))};function cx(t,e){return FI(t,e)}function xk(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Hn(t,e,n,r){return new xk(t,e,n,r)}function l_(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Ck(t){if(typeof t=="function")return l_(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Ag)return 11;if(t===Rg)return 14}return 2}function es(t,e){var n=t.alternate;return n===null?(n=Hn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function _d(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")l_(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Qo:return Zs(n.children,i,s,e);case Cg:o=8,i|=8;break;case Mp:return t=Hn(12,n,e,i|2),t.elementType=Mp,t.lanes=s,t;case Vp:return t=Hn(13,n,e,i),t.elementType=Vp,t.lanes=s,t;case Lp:return t=Hn(19,n,e,i),t.elementType=Lp,t.lanes=s,t;case TI:return jh(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case yI:o=10;break e;case vI:o=9;break e;case Ag:o=11;break e;case Rg:o=14;break e;case Li:o=16,r=null;break e}throw Error(ne(130,t==null?t:typeof t,""))}return e=Hn(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function Zs(t,e,n,r){return t=Hn(7,t,r,e),t.lanes=n,t}function jh(t,e,n,r){return t=Hn(22,t,r,e),t.elementType=TI,t.lanes=n,t.stateNode={isHidden:!1},t}function hp(t,e,n){return t=Hn(6,t,null,e),t.lanes=n,t}function fp(t,e,n){return e=Hn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Ak(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Wf(0),this.expirationTimes=Wf(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Wf(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function u_(t,e,n,r,i,s,o,a,l){return t=new Ak(t,e,n,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Hn(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Hg(s),t}function Rk(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Jo,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function dx(t){if(!t)return us;t=t._reactInternals;e:{if(To(t)!==t||t.tag!==1)throw Error(ne(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(En(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ne(171))}if(t.tag===1){var n=t.type;if(En(n))return dS(t,n,e)}return e}function hx(t,e,n,r,i,s,o,a,l){return t=u_(n,r,!0,t,i,s,o,a,l),t.context=dx(null),n=t.current,r=dn(),i=Zi(n),s=ei(r,i),s.callback=e??null,Yi(n,s,i),t.current.lanes=i,ju(t,i,r),wn(t,r),t}function Hh(t,e,n,r){var i=e.current,s=dn(),o=Zi(i);return n=dx(n),e.context===null?e.context=n:e.pendingContext=n,e=ei(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Yi(i,e,o),t!==null&&(pr(t,i,o,s),dd(t,i,o)),o}function ih(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function bv(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function c_(t,e){bv(t,e),(t=t.alternate)&&bv(t,e)}function Pk(){return null}var fx=typeof reportError=="function"?reportError:function(t){console.error(t)};function d_(t){this._internalRoot=t}Wh.prototype.render=d_.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ne(409));Hh(t,e,null,null)};Wh.prototype.unmount=d_.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;lo(function(){Hh(null,t,null,null)}),e[ri]=null}};function Wh(t){this._internalRoot=t}Wh.prototype.unstable_scheduleHydration=function(t){if(t){var e=$I();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Ui.length&&e!==0&&e<Ui[n].priority;n++);Ui.splice(n,0,t),n===0&&HI(t)}};function h_(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Kh(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Dv(){}function kk(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var u=ih(o);s.call(u)}}var o=hx(e,r,t,0,null,!1,!1,"",Dv);return t._reactRootContainer=o,t[ri]=o.current,Eu(t.nodeType===8?t.parentNode:t),lo(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var u=ih(l);a.call(u)}}var l=u_(t,0,!1,null,null,!1,!1,"",Dv);return t._reactRootContainer=l,t[ri]=l.current,Eu(t.nodeType===8?t.parentNode:t),lo(function(){Hh(e,l,n,r)}),l}function Jh(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=ih(o);a.call(l)}}Hh(e,o,t,i)}else o=kk(n,e,t,i,r);return ih(o)}qI=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Fl(e.pendingLanes);n!==0&&(Ng(e,n|1),wn(e,wt()),!(Fe&6)&&(Ra=wt()+500,vs()))}break;case 13:lo(function(){var r=ii(t,1);if(r!==null){var i=dn();pr(r,t,1,i)}}),c_(t,1)}};bg=function(t){if(t.tag===13){var e=ii(t,134217728);if(e!==null){var n=dn();pr(e,t,134217728,n)}c_(t,134217728)}};zI=function(t){if(t.tag===13){var e=Zi(t),n=ii(t,e);if(n!==null){var r=dn();pr(n,t,e,r)}c_(t,e)}};$I=function(){return We};jI=function(t,e){var n=We;try{return We=t,e()}finally{We=n}};Hp=function(t,e,n){switch(e){case"input":if(Op(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=Oh(r);if(!i)throw Error(ne(90));wI(r),Op(r,i)}}}break;case"textarea":SI(t,n);break;case"select":e=n.value,e!=null&&ua(t,!!n.multiple,e,!1)}};NI=s_;bI=lo;var Nk={usingClientEntryPoint:!1,Events:[Wu,ea,Oh,PI,kI,s_]},Rl={findFiberByHostInstance:Ws,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},bk={bundleType:Rl.bundleType,version:Rl.version,rendererPackageName:Rl.rendererPackageName,rendererConfig:Rl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ci.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=VI(t),t===null?null:t.stateNode},findFiberByHostInstance:Rl.findFiberByHostInstance||Pk,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Yc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Yc.isDisabled&&Yc.supportsFiber)try{Vh=Yc.inject(bk),Nr=Yc}catch{}}Vn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Nk;Vn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h_(e))throw Error(ne(200));return Rk(t,e,null,n)};Vn.createRoot=function(t,e){if(!h_(t))throw Error(ne(299));var n=!1,r="",i=fx;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=u_(t,1,!1,null,null,n,!1,r,i),t[ri]=e.current,Eu(t.nodeType===8?t.parentNode:t),new d_(e)};Vn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ne(188)):(t=Object.keys(t).join(","),Error(ne(268,t)));return t=VI(e),t=t===null?null:t.stateNode,t};Vn.flushSync=function(t){return lo(t)};Vn.hydrate=function(t,e,n){if(!Kh(e))throw Error(ne(200));return Jh(null,t,e,!0,n)};Vn.hydrateRoot=function(t,e,n){if(!h_(t))throw Error(ne(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=fx;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=hx(e,null,t,1,n??null,i,!1,s,o),t[ri]=e.current,Eu(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new Wh(e)};Vn.render=function(t,e,n){if(!Kh(e))throw Error(ne(200));return Jh(null,t,e,!1,n)};Vn.unmountComponentAtNode=function(t){if(!Kh(t))throw Error(ne(40));return t._reactRootContainer?(lo(function(){Jh(null,null,t,!1,function(){t._reactRootContainer=null,t[ri]=null})}),!0):!1};Vn.unstable_batchedUpdates=s_;Vn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Kh(n))throw Error(ne(200));if(t==null||t._reactInternals===void 0)throw Error(ne(38));return Jh(t,e,n,!1,r)};Vn.version="18.3.1-next-f1338f8080-20240426";function px(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(px)}catch(t){console.error(t)}}px(),pI.exports=Vn;var Dk=pI.exports,Mv=Dk;bp.createRoot=Mv.createRoot,bp.hydrateRoot=Mv.hydrateRoot;/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let Mk,Vk;function Lk(){return{geminiUrl:Mk,vertexUrl:Vk}}function Fk(t,e,n,r){var i,s;if(!(t!=null&&t.baseUrl)){const o=Lk();return e?(i=o.vertexUrl)!==null&&i!==void 0?i:n:(s=o.geminiUrl)!==null&&s!==void 0?s:r}return t.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Eo{}function ce(t,e){const n=/\{([^}]+)\}/g;return t.replace(n,(r,i)=>{if(Object.prototype.hasOwnProperty.call(e,i)){const s=e[i];return s!=null?String(s):""}else throw new Error(`Key '${i}' not found in valueMap.`)})}function f(t,e,n){for(let s=0;s<e.length-1;s++){const o=e[s];if(o.endsWith("[]")){const a=o.slice(0,-2);if(!(a in t))if(Array.isArray(n))t[a]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${o}`);if(Array.isArray(t[a])){const l=t[a];if(Array.isArray(n))for(let u=0;u<l.length;u++){const p=l[u];f(p,e.slice(s+1),n[u])}else for(const u of l)f(u,e.slice(s+1),n)}return}else if(o.endsWith("[0]")){const a=o.slice(0,-3);a in t||(t[a]=[{}]);const l=t[a];f(l[0],e.slice(s+1),n);return}(!t[o]||typeof t[o]!="object")&&(t[o]={}),t=t[o]}const r=e[e.length-1],i=t[r];if(i!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===i)return;if(typeof i=="object"&&typeof n=="object"&&i!==null&&n!==null)Object.assign(i,n);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else r==="_self"&&typeof n=="object"&&n!==null&&!Array.isArray(n)?Object.assign(t,n):t[r]=n}function d(t,e,n=void 0){try{if(e.length===1&&e[0]==="_self")return t;for(let r=0;r<e.length;r++){if(typeof t!="object"||t===null)return n;const i=e[r];if(i.endsWith("[]")){const s=i.slice(0,-2);if(s in t){const o=t[s];return Array.isArray(o)?o.map(a=>d(a,e.slice(r+1),n)):n}else return n}else t=t[i]}return t}catch(r){if(r instanceof TypeError)return n;throw r}}function Uk(t,e){for(const[n,r]of Object.entries(e)){const i=n.split("."),s=r.split("."),o=new Set;let a=-1;for(let l=0;l<i.length;l++)if(i[l]==="*"){a=l;break}if(a!==-1&&s.length>a)for(let l=a;l<s.length;l++){const u=s[l];u!=="*"&&!u.endsWith("[]")&&!u.endsWith("[0]")&&o.add(u)}xm(t,i,s,0,o)}}function xm(t,e,n,r,i){if(r>=e.length||typeof t!="object"||t===null)return;const s=e[r];if(s.endsWith("[]")){const o=s.slice(0,-2),a=t;if(o in a&&Array.isArray(a[o]))for(const l of a[o])xm(l,e,n,r+1,i)}else if(s==="*"){if(typeof t=="object"&&t!==null&&!Array.isArray(t)){const o=t,a=Object.keys(o).filter(u=>!u.startsWith("_")&&!i.has(u)),l={};for(const u of a)l[u]=o[u];for(const[u,p]of Object.entries(l)){const m=[];for(const g of n.slice(r))g==="*"?m.push(u):m.push(g);f(o,m,p)}for(const u of a)delete o[u]}}else{const o=t;s in o&&xm(o[s],e,n,r+1,i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function f_(t){if(typeof t!="string")throw new Error("fromImageBytes must be a string");return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ok(t){const e={},n=d(t,["operationName"]);n!=null&&f(e,["operationName"],n);const r=d(t,["resourceName"]);return r!=null&&f(e,["_url","resourceName"],r),e}function Bk(t){const e={},n=d(t,["name"]);n!=null&&f(e,["name"],n);const r=d(t,["metadata"]);r!=null&&f(e,["metadata"],r);const i=d(t,["done"]);i!=null&&f(e,["done"],i);const s=d(t,["error"]);s!=null&&f(e,["error"],s);const o=d(t,["response","generateVideoResponse"]);return o!=null&&f(e,["response"],qk(o)),e}function Gk(t){const e={},n=d(t,["name"]);n!=null&&f(e,["name"],n);const r=d(t,["metadata"]);r!=null&&f(e,["metadata"],r);const i=d(t,["done"]);i!=null&&f(e,["done"],i);const s=d(t,["error"]);s!=null&&f(e,["error"],s);const o=d(t,["response"]);return o!=null&&f(e,["response"],zk(o)),e}function qk(t){const e={},n=d(t,["generatedSamples"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>$k(o))),f(e,["generatedVideos"],s)}const r=d(t,["raiMediaFilteredCount"]);r!=null&&f(e,["raiMediaFilteredCount"],r);const i=d(t,["raiMediaFilteredReasons"]);return i!=null&&f(e,["raiMediaFilteredReasons"],i),e}function zk(t){const e={},n=d(t,["videos"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>jk(o))),f(e,["generatedVideos"],s)}const r=d(t,["raiMediaFilteredCount"]);r!=null&&f(e,["raiMediaFilteredCount"],r);const i=d(t,["raiMediaFilteredReasons"]);return i!=null&&f(e,["raiMediaFilteredReasons"],i),e}function $k(t){const e={},n=d(t,["video"]);return n!=null&&f(e,["video"],Kk(n)),e}function jk(t){const e={},n=d(t,["_self"]);return n!=null&&f(e,["video"],Jk(n)),e}function Hk(t){const e={},n=d(t,["operationName"]);return n!=null&&f(e,["_url","operationName"],n),e}function Wk(t){const e={},n=d(t,["operationName"]);return n!=null&&f(e,["_url","operationName"],n),e}function Kk(t){const e={},n=d(t,["uri"]);n!=null&&f(e,["uri"],n);const r=d(t,["encodedVideo"]);r!=null&&f(e,["videoBytes"],f_(r));const i=d(t,["encoding"]);return i!=null&&f(e,["mimeType"],i),e}function Jk(t){const e={},n=d(t,["gcsUri"]);n!=null&&f(e,["uri"],n);const r=d(t,["bytesBase64Encoded"]);r!=null&&f(e,["videoBytes"],f_(r));const i=d(t,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Vv;(function(t){t.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",t.OUTCOME_OK="OUTCOME_OK",t.OUTCOME_FAILED="OUTCOME_FAILED",t.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Vv||(Vv={}));var Lv;(function(t){t.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",t.PYTHON="PYTHON"})(Lv||(Lv={}));var Fv;(function(t){t.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",t.SILENT="SILENT",t.WHEN_IDLE="WHEN_IDLE",t.INTERRUPT="INTERRUPT"})(Fv||(Fv={}));var Wn;(function(t){t.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",t.STRING="STRING",t.NUMBER="NUMBER",t.INTEGER="INTEGER",t.BOOLEAN="BOOLEAN",t.ARRAY="ARRAY",t.OBJECT="OBJECT",t.NULL="NULL"})(Wn||(Wn={}));var Uv;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(Uv||(Uv={}));var Ov;(function(t){t.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",t.NO_AUTH="NO_AUTH",t.API_KEY_AUTH="API_KEY_AUTH",t.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",t.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",t.OAUTH="OAUTH",t.OIDC_AUTH="OIDC_AUTH"})(Ov||(Ov={}));var Bv;(function(t){t.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",t.SIMPLE_SEARCH="SIMPLE_SEARCH",t.ELASTIC_SEARCH="ELASTIC_SEARCH"})(Bv||(Bv={}));var Gv;(function(t){t.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",t.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",t.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",t.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",t.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",t.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",t.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",t.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",t.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(Gv||(Gv={}));var qv;(function(t){t.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",t.SEVERITY="SEVERITY",t.PROBABILITY="PROBABILITY"})(qv||(qv={}));var zv;(function(t){t.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE",t.OFF="OFF"})(zv||(zv={}));var $v;(function(t){t.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.LANGUAGE="LANGUAGE",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.SPII="SPII",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.IMAGE_SAFETY="IMAGE_SAFETY",t.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",t.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",t.NO_IMAGE="NO_IMAGE"})($v||($v={}));var jv;(function(t){t.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",t.NEGLIGIBLE="NEGLIGIBLE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH"})(jv||(jv={}));var Hv;(function(t){t.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",t.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",t.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",t.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",t.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(Hv||(Hv={}));var Wv;(function(t){t.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",t.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",t.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",t.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",t.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(Wv||(Wv={}));var Kv;(function(t){t.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",t.SAFETY="SAFETY",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.IMAGE_SAFETY="IMAGE_SAFETY",t.MODEL_ARMOR="MODEL_ARMOR",t.JAILBREAK="JAILBREAK"})(Kv||(Kv={}));var Jv;(function(t){t.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",t.ON_DEMAND="ON_DEMAND",t.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(Jv||(Jv={}));var sh;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.AUDIO="AUDIO"})(sh||(sh={}));var Qv;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(Qv||(Qv={}));var Yv;(function(t){t.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",t.TUNING_MODE_FULL="TUNING_MODE_FULL",t.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(Yv||(Yv={}));var Xv;(function(t){t.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",t.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",t.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",t.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",t.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",t.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",t.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(Xv||(Xv={}));var Cm;(function(t){t.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",t.JOB_STATE_QUEUED="JOB_STATE_QUEUED",t.JOB_STATE_PENDING="JOB_STATE_PENDING",t.JOB_STATE_RUNNING="JOB_STATE_RUNNING",t.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",t.JOB_STATE_FAILED="JOB_STATE_FAILED",t.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",t.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",t.JOB_STATE_PAUSED="JOB_STATE_PAUSED",t.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",t.JOB_STATE_UPDATING="JOB_STATE_UPDATING",t.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Cm||(Cm={}));var Zv;(function(t){t.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",t.TUNING_TASK_I2V="TUNING_TASK_I2V",t.TUNING_TASK_T2V="TUNING_TASK_T2V"})(Zv||(Zv={}));var eT;(function(t){t.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",t.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",t.BALANCED="BALANCED",t.PRIORITIZE_COST="PRIORITIZE_COST"})(eT||(eT={}));var tT;(function(t){t.UNSPECIFIED="UNSPECIFIED",t.BLOCKING="BLOCKING",t.NON_BLOCKING="NON_BLOCKING"})(tT||(tT={}));var nT;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(nT||(nT={}));var rT;(function(t){t.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",t.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(rT||(rT={}));var iT;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.AUTO="AUTO",t.ANY="ANY",t.NONE="NONE",t.VALIDATED="VALIDATED"})(iT||(iT={}));var sT;(function(t){t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE"})(sT||(sT={}));var oT;(function(t){t.DONT_ALLOW="DONT_ALLOW",t.ALLOW_ADULT="ALLOW_ADULT",t.ALLOW_ALL="ALLOW_ALL"})(oT||(oT={}));var aT;(function(t){t.auto="auto",t.en="en",t.ja="ja",t.ko="ko",t.hi="hi",t.zh="zh",t.pt="pt",t.es="es"})(aT||(aT={}));var lT;(function(t){t.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",t.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",t.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",t.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",t.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(lT||(lT={}));var uT;(function(t){t.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",t.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",t.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",t.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(uT||(uT={}));var cT;(function(t){t.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",t.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",t.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",t.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(cT||(cT={}));var dT;(function(t){t.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",t.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",t.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",t.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",t.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",t.EDIT_MODE_STYLE="EDIT_MODE_STYLE",t.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",t.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(dT||(dT={}));var hT;(function(t){t.FOREGROUND="FOREGROUND",t.BACKGROUND="BACKGROUND",t.PROMPT="PROMPT",t.SEMANTIC="SEMANTIC",t.INTERACTIVE="INTERACTIVE"})(hT||(hT={}));var fT;(function(t){t.ASSET="ASSET",t.STYLE="STYLE"})(fT||(fT={}));var pT;(function(t){t.INSERT="INSERT",t.REMOVE="REMOVE",t.REMOVE_STATIC="REMOVE_STATIC",t.OUTPAINT="OUTPAINT"})(pT||(pT={}));var mT;(function(t){t.OPTIMIZED="OPTIMIZED",t.LOSSLESS="LOSSLESS"})(mT||(mT={}));var gT;(function(t){t.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",t.PREFERENCE_TUNING="PREFERENCE_TUNING"})(gT||(gT={}));var _T;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.PROCESSING="PROCESSING",t.ACTIVE="ACTIVE",t.FAILED="FAILED"})(_T||(_T={}));var yT;(function(t){t.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",t.UPLOADED="UPLOADED",t.GENERATED="GENERATED"})(yT||(yT={}));var vT;(function(t){t.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.RESPONSE_REJECTED="RESPONSE_REJECTED",t.NEED_MORE_INPUT="NEED_MORE_INPUT"})(vT||(vT={}));var TT;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.VIDEO="VIDEO",t.AUDIO="AUDIO",t.DOCUMENT="DOCUMENT"})(TT||(TT={}));var ET;(function(t){t.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",t.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",t.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(ET||(ET={}));var wT;(function(t){t.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",t.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",t.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(wT||(wT={}));var IT;(function(t){t.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",t.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",t.NO_INTERRUPTION="NO_INTERRUPTION"})(IT||(IT={}));var ST;(function(t){t.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",t.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",t.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(ST||(ST={}));var xT;(function(t){t.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",t.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",t.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",t.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",t.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",t.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",t.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",t.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",t.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",t.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",t.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",t.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",t.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(xT||(xT={}));var CT;(function(t){t.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",t.QUALITY="QUALITY",t.DIVERSITY="DIVERSITY",t.VOCALIZATION="VOCALIZATION"})(CT||(CT={}));var aa;(function(t){t.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",t.PLAY="PLAY",t.PAUSE="PAUSE",t.STOP="STOP",t.RESET_CONTEXT="RESET_CONTEXT"})(aa||(aa={}));class Am{constructor(e){const n={};for(const r of e.headers.entries())n[r[0]]=r[1];this.headers=n,this.responseInternal=e}json(){return this.responseInternal.json()}}class Pl{get text(){var e,n,r,i,s,o,a,l;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let u="",p=!1;const m=[];for(const g of(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)!==null&&l!==void 0?l:[]){for(const[v,I]of Object.entries(g))v!=="text"&&v!=="thought"&&(I!==null||I!==void 0)&&m.push(v);if(typeof g.text=="string"){if(typeof g.thought=="boolean"&&g.thought)continue;p=!0,u+=g.text}}return m.length>0&&console.warn(`there are non-text parts ${m} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),p?u:void 0}get data(){var e,n,r,i,s,o,a,l;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let u="";const p=[];for(const m of(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)!==null&&l!==void 0?l:[]){for(const[g,v]of Object.entries(m))g!=="inlineData"&&(v!==null||v!==void 0)&&p.push(g);m.inlineData&&typeof m.inlineData.data=="string"&&(u+=atob(m.inlineData.data))}return p.length>0&&console.warn(`there are non-data parts ${p} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),u.length>0?btoa(u):void 0}get functionCalls(){var e,n,r,i,s,o,a,l;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const u=(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(p=>p.functionCall).map(p=>p.functionCall).filter(p=>p!==void 0);if((u==null?void 0:u.length)!==0)return u}get executableCode(){var e,n,r,i,s,o,a,l,u;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const p=(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(m=>m.executableCode).map(m=>m.executableCode).filter(m=>m!==void 0);if((p==null?void 0:p.length)!==0)return(u=p==null?void 0:p[0])===null||u===void 0?void 0:u.code}get codeExecutionResult(){var e,n,r,i,s,o,a,l,u;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const p=(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(m=>m.codeExecutionResult).map(m=>m.codeExecutionResult).filter(m=>m!==void 0);if((p==null?void 0:p.length)!==0)return(u=p==null?void 0:p[0])===null||u===void 0?void 0:u.output}}class AT{}class RT{}class Qk{}class Yk{}class Xk{}class Zk{}class PT{}class kT{}class NT{}class e1{}class oh{_fromAPIResponse({apiResponse:e,isVertexAI:n}){const r=new oh;let i;const s=e;return n?i=Gk(s):i=Bk(s),Object.assign(r,i),r}}class bT{}class DT{}class MT{}class t1{}class n1{}class r1{}class VT{}class i1{get text(){var e,n,r;let i="",s=!1;const o=[];for(const a of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[l,u]of Object.entries(a))l!=="text"&&l!=="thought"&&u!==null&&o.push(l);if(typeof a.text=="string"){if(typeof a.thought=="boolean"&&a.thought)continue;s=!0,i+=a.text}}return o.length>0&&console.warn(`there are non-text parts ${o} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),s?i:void 0}get data(){var e,n,r;let i="";const s=[];for(const o of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[a,l]of Object.entries(o))a!=="inlineData"&&l!==null&&s.push(a);o.inlineData&&typeof o.inlineData.data=="string"&&(i+=atob(o.inlineData.data))}return s.length>0&&console.warn(`there are non-data parts ${s} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),i.length>0?btoa(i):void 0}}class s1{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Be(t,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(t.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const n=e.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function mx(t,e){const n=Be(t,e);return n?n.startsWith("publishers/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}`:n.startsWith("models/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/publishers/google/${n}`:n:""}function gx(t){return Array.isArray(t)?t.map(e=>ah(e)):[ah(t)]}function ah(t){if(typeof t=="object"&&t!==null)return t;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof t}`)}function _x(t){const e=ah(t);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function yx(t){const e=ah(t);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function LT(t){if(t==null)throw new Error("PartUnion is required");if(typeof t=="object")return t;if(typeof t=="string")return{text:t};throw new Error(`Unsupported part type: ${typeof t}`)}function vx(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("PartListUnion is required");return Array.isArray(t)?t.map(e=>LT(e)):[LT(t)]}function Rm(t){return t!=null&&typeof t=="object"&&"parts"in t&&Array.isArray(t.parts)}function FT(t){return t!=null&&typeof t=="object"&&"functionCall"in t}function UT(t){return t!=null&&typeof t=="object"&&"functionResponse"in t}function nn(t){if(t==null)throw new Error("ContentUnion is required");return Rm(t)?t:{role:"user",parts:vx(t)}}function p_(t,e){if(!e)return[];if(t.isVertexAI()&&Array.isArray(e))return e.flatMap(n=>{const r=nn(n);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(t.isVertexAI()){const n=nn(e);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(e)?e.map(n=>nn(n)):[nn(e)]}function Qn(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("contents are required");if(!Array.isArray(t)){if(FT(t)||UT(t))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[nn(t)]}const e=[],n=[],r=Rm(t[0]);for(const i of t){const s=Rm(i);if(s!=r)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(s)e.push(i);else{if(FT(i)||UT(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(i)}}return r||e.push({role:"user",parts:vx(n)}),e}function o1(t,e){t.includes("null")&&(e.nullable=!0);const n=t.filter(r=>r!=="null");if(n.length===1)e.type=Object.values(Wn).includes(n[0].toUpperCase())?n[0].toUpperCase():Wn.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const r of n)e.anyOf.push({type:Object.values(Wn).includes(r.toUpperCase())?r.toUpperCase():Wn.TYPE_UNSPECIFIED})}}function ma(t){const e={},n=["items"],r=["anyOf"],i=["properties"];if(t.type&&t.anyOf)throw new Error("type and anyOf cannot be both populated.");const s=t.anyOf;s!=null&&s.length==2&&(s[0].type==="null"?(e.nullable=!0,t=s[1]):s[1].type==="null"&&(e.nullable=!0,t=s[0])),t.type instanceof Array&&o1(t.type,e);for(const[o,a]of Object.entries(t))if(a!=null)if(o=="type"){if(a==="null")throw new Error("type: null can not be the only possible type for the field.");if(a instanceof Array)continue;e.type=Object.values(Wn).includes(a.toUpperCase())?a.toUpperCase():Wn.TYPE_UNSPECIFIED}else if(n.includes(o))e[o]=ma(a);else if(r.includes(o)){const l=[];for(const u of a){if(u.type=="null"){e.nullable=!0;continue}l.push(ma(u))}e[o]=l}else if(i.includes(o)){const l={};for(const[u,p]of Object.entries(a))l[u]=ma(p);e[o]=l}else{if(o==="additionalProperties")continue;e[o]=a}return e}function m_(t){return ma(t)}function g_(t){if(typeof t=="object")return t;if(typeof t=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:t}}};throw new Error(`Unsupported speechConfig type: ${typeof t}`)}function __(t){if("multiSpeakerVoiceConfig"in t)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return t}function Ja(t){if(t.functionDeclarations)for(const e of t.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=ma(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=ma(e.response));return t}function Qa(t){if(t==null)throw new Error("tools is required");if(!Array.isArray(t))throw new Error("tools is required and must be an array of Tools");const e=[];for(const n of t)e.push(n);return e}function a1(t,e,n,r=1){const i=!e.startsWith(`${n}/`)&&e.split("/").length===r;return t.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${t.getProject()}/${e}`:e.startsWith(`${n}/`)?`projects/${t.getProject()}/locations/${t.getLocation()}/${e}`:i?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}/${e}`:e:i?`${n}/${e}`:e}function di(t,e){if(typeof e!="string")throw new Error("name must be a string");return a1(t,e,"cachedContents")}function Tx(t){switch(t){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return t}}function Ts(t){return f_(t)}function l1(t){return t!=null&&typeof t=="object"&&"name"in t}function u1(t){return t!=null&&typeof t=="object"&&"video"in t}function c1(t){return t!=null&&typeof t=="object"&&"uri"in t}function Ex(t){var e;let n;if(l1(t)&&(n=t.name),!(c1(t)&&(n=t.uri,n===void 0))&&!(u1(t)&&(n=(e=t.video)===null||e===void 0?void 0:e.uri,n===void 0))){if(typeof t=="string"&&(n=t),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const i=n.split("files/")[1].match(/[a-z0-9]+/);if(i===null)throw new Error(`Could not extract file name from URI ${n}`);n=i[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function wx(t,e){let n;return t.isVertexAI()?n=e?"publishers/google/models":"models":n=e?"models":"tunedModels",n}function Ix(t){for(const e of["models","tunedModels","publisherModels"])if(d1(t,e))return t[e];return[]}function d1(t,e){return t!==null&&typeof t=="object"&&e in t}function h1(t,e={}){const n=t,r={name:n.name,description:n.description,parametersJsonSchema:n.inputSchema};return n.outputSchema&&(r.responseJsonSchema=n.outputSchema),e.behavior&&(r.behavior=e.behavior),{functionDeclarations:[r]}}function f1(t,e={}){const n=[],r=new Set;for(const i of t){const s=i.name;if(r.has(s))throw new Error(`Duplicate function name ${s} found in MCP tools. Please ensure function names are unique.`);r.add(s);const o=h1(i,e);o.functionDeclarations&&n.push(...o.functionDeclarations)}return{functionDeclarations:n}}function Sx(t,e){let n;if(typeof e=="string")if(t.isVertexAI())if(e.startsWith("gs://"))n={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))n={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))n={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(t.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");n={inlinedRequests:e}}else n=e;const r=[n.gcsUri,n.bigqueryUri].filter(Boolean).length,i=[n.inlinedRequests,n.fileName].filter(Boolean).length;if(t.isVertexAI()){if(i>0||r!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(r>0||i!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return n}function p1(t){if(typeof t!="string")return t;const e=t;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function xx(t){if(typeof t!="object"||t===null)return{};const e=t,n=e.inlinedResponses;if(typeof n!="object"||n===null)return t;const i=n.inlinedResponses;if(!Array.isArray(i)||i.length===0)return t;let s=!1;for(const o of i){if(typeof o!="object"||o===null)continue;const l=o.response;if(typeof l!="object"||l===null)continue;if(l.embedding!==void 0){s=!0;break}}return s&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),t}function Ya(t,e){const n=e;if(!t.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error(`Invalid batch job name: ${n}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error(`Invalid batch job name: ${n}.`)}function Cx(t){const e=t;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function m1(t){const e={},n=d(t,["responsesFile"]);n!=null&&f(e,["fileName"],n);const r=d(t,["inlinedResponses","inlinedResponses"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>H1(o))),f(e,["inlinedResponses"],s)}const i=d(t,["inlinedEmbedContentResponses","inlinedResponses"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),f(e,["inlinedEmbedContentResponses"],s)}return e}function g1(t){const e={},n=d(t,["predictionsFormat"]);n!=null&&f(e,["format"],n);const r=d(t,["gcsDestination","outputUriPrefix"]);r!=null&&f(e,["gcsUri"],r);const i=d(t,["bigqueryDestination","outputUri"]);return i!=null&&f(e,["bigqueryUri"],i),e}function _1(t){const e={},n=d(t,["format"]);n!=null&&f(e,["predictionsFormat"],n);const r=d(t,["gcsUri"]);r!=null&&f(e,["gcsDestination","outputUriPrefix"],r);const i=d(t,["bigqueryUri"]);if(i!=null&&f(e,["bigqueryDestination","outputUri"],i),d(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(d(t,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(d(t,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function yd(t){const e={},n=d(t,["name"]);n!=null&&f(e,["name"],n);const r=d(t,["metadata","displayName"]);r!=null&&f(e,["displayName"],r);const i=d(t,["metadata","state"]);i!=null&&f(e,["state"],Cx(i));const s=d(t,["metadata","createTime"]);s!=null&&f(e,["createTime"],s);const o=d(t,["metadata","endTime"]);o!=null&&f(e,["endTime"],o);const a=d(t,["metadata","updateTime"]);a!=null&&f(e,["updateTime"],a);const l=d(t,["metadata","model"]);l!=null&&f(e,["model"],l);const u=d(t,["metadata","output"]);return u!=null&&f(e,["dest"],m1(xx(u))),e}function Pm(t){const e={},n=d(t,["name"]);n!=null&&f(e,["name"],n);const r=d(t,["displayName"]);r!=null&&f(e,["displayName"],r);const i=d(t,["state"]);i!=null&&f(e,["state"],Cx(i));const s=d(t,["error"]);s!=null&&f(e,["error"],s);const o=d(t,["createTime"]);o!=null&&f(e,["createTime"],o);const a=d(t,["startTime"]);a!=null&&f(e,["startTime"],a);const l=d(t,["endTime"]);l!=null&&f(e,["endTime"],l);const u=d(t,["updateTime"]);u!=null&&f(e,["updateTime"],u);const p=d(t,["model"]);p!=null&&f(e,["model"],p);const m=d(t,["inputConfig"]);m!=null&&f(e,["src"],y1(m));const g=d(t,["outputConfig"]);return g!=null&&f(e,["dest"],g1(xx(g))),e}function y1(t){const e={},n=d(t,["instancesFormat"]);n!=null&&f(e,["format"],n);const r=d(t,["gcsSource","uris"]);r!=null&&f(e,["gcsUri"],r);const i=d(t,["bigquerySource","inputUri"]);return i!=null&&f(e,["bigqueryUri"],i),e}function v1(t,e){const n={};if(d(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(d(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(d(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const r=d(e,["fileName"]);r!=null&&f(n,["fileName"],r);const i=d(e,["inlinedRequests"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>j1(t,o))),f(n,["requests","requests"],s)}return n}function T1(t){const e={},n=d(t,["format"]);n!=null&&f(e,["instancesFormat"],n);const r=d(t,["gcsUri"]);r!=null&&f(e,["gcsSource","uris"],r);const i=d(t,["bigqueryUri"]);if(i!=null&&f(e,["bigquerySource","inputUri"],i),d(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(d(t,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function E1(t){const e={},n=d(t,["data"]);if(n!=null&&f(e,["data"],n),d(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=d(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function w1(t,e){const n={},r=d(e,["name"]);return r!=null&&f(n,["_url","name"],Ya(t,r)),n}function I1(t,e){const n={},r=d(e,["name"]);return r!=null&&f(n,["_url","name"],Ya(t,r)),n}function S1(t){const e={},n=d(t,["content"]);n!=null&&f(e,["content"],n);const r=d(t,["citationMetadata"]);r!=null&&f(e,["citationMetadata"],x1(r));const i=d(t,["tokenCount"]);i!=null&&f(e,["tokenCount"],i);const s=d(t,["finishReason"]);s!=null&&f(e,["finishReason"],s);const o=d(t,["avgLogprobs"]);o!=null&&f(e,["avgLogprobs"],o);const a=d(t,["groundingMetadata"]);a!=null&&f(e,["groundingMetadata"],a);const l=d(t,["index"]);l!=null&&f(e,["index"],l);const u=d(t,["logprobsResult"]);u!=null&&f(e,["logprobsResult"],u);const p=d(t,["safetyRatings"]);if(p!=null){let g=p;Array.isArray(g)&&(g=g.map(v=>v)),f(e,["safetyRatings"],g)}const m=d(t,["urlContextMetadata"]);return m!=null&&f(e,["urlContextMetadata"],m),e}function x1(t){const e={},n=d(t,["citationSources"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>i)),f(e,["citations"],r)}return e}function Ax(t){const e={},n=d(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>Z1(s))),f(e,["parts"],i)}const r=d(t,["role"]);return r!=null&&f(e,["role"],r),e}function C1(t,e){const n={},r=d(t,["displayName"]);if(e!==void 0&&r!=null&&f(e,["batch","displayName"],r),d(t,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return n}function A1(t,e){const n={},r=d(t,["displayName"]);e!==void 0&&r!=null&&f(e,["displayName"],r);const i=d(t,["dest"]);return e!==void 0&&i!=null&&f(e,["outputConfig"],_1(p1(i))),n}function OT(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["_url","model"],Be(t,r));const i=d(e,["src"]);i!=null&&f(n,["batch","inputConfig"],v1(t,Sx(t,i)));const s=d(e,["config"]);return s!=null&&C1(s,n),n}function R1(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["model"],Be(t,r));const i=d(e,["src"]);i!=null&&f(n,["inputConfig"],T1(Sx(t,i)));const s=d(e,["config"]);return s!=null&&A1(s,n),n}function P1(t,e){const n={},r=d(t,["displayName"]);return e!==void 0&&r!=null&&f(e,["batch","displayName"],r),n}function k1(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["_url","model"],Be(t,r));const i=d(e,["src"]);i!=null&&f(n,["batch","inputConfig"],F1(t,i));const s=d(e,["config"]);return s!=null&&P1(s,n),n}function N1(t,e){const n={},r=d(e,["name"]);return r!=null&&f(n,["_url","name"],Ya(t,r)),n}function b1(t,e){const n={},r=d(e,["name"]);return r!=null&&f(n,["_url","name"],Ya(t,r)),n}function D1(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["name"]);r!=null&&f(e,["name"],r);const i=d(t,["done"]);i!=null&&f(e,["done"],i);const s=d(t,["error"]);return s!=null&&f(e,["error"],s),e}function M1(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["name"]);r!=null&&f(e,["name"],r);const i=d(t,["done"]);i!=null&&f(e,["done"],i);const s=d(t,["error"]);return s!=null&&f(e,["error"],s),e}function V1(t,e){const n={},r=d(e,["contents"]);if(r!=null){let s=p_(t,r);Array.isArray(s)&&(s=s.map(o=>o)),f(n,["requests[]","request","content"],s)}const i=d(e,["config"]);return i!=null&&(f(n,["_self"],L1(i,n)),Uk(n,{"requests[].*":"requests[].request.*"})),n}function L1(t,e){const n={},r=d(t,["taskType"]);e!==void 0&&r!=null&&f(e,["requests[]","taskType"],r);const i=d(t,["title"]);e!==void 0&&i!=null&&f(e,["requests[]","title"],i);const s=d(t,["outputDimensionality"]);if(e!==void 0&&s!=null&&f(e,["requests[]","outputDimensionality"],s),d(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(d(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function F1(t,e){const n={},r=d(e,["fileName"]);r!=null&&f(n,["file_name"],r);const i=d(e,["inlinedRequests"]);return i!=null&&f(n,["requests"],V1(t,i)),n}function U1(t){const e={};if(d(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=d(t,["fileUri"]);n!=null&&f(e,["fileUri"],n);const r=d(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function O1(t,e,n){const r={},i=d(e,["systemInstruction"]);n!==void 0&&i!=null&&f(n,["systemInstruction"],Ax(nn(i)));const s=d(e,["temperature"]);s!=null&&f(r,["temperature"],s);const o=d(e,["topP"]);o!=null&&f(r,["topP"],o);const a=d(e,["topK"]);a!=null&&f(r,["topK"],a);const l=d(e,["candidateCount"]);l!=null&&f(r,["candidateCount"],l);const u=d(e,["maxOutputTokens"]);u!=null&&f(r,["maxOutputTokens"],u);const p=d(e,["stopSequences"]);p!=null&&f(r,["stopSequences"],p);const m=d(e,["responseLogprobs"]);m!=null&&f(r,["responseLogprobs"],m);const g=d(e,["logprobs"]);g!=null&&f(r,["logprobs"],g);const v=d(e,["presencePenalty"]);v!=null&&f(r,["presencePenalty"],v);const I=d(e,["frequencyPenalty"]);I!=null&&f(r,["frequencyPenalty"],I);const P=d(e,["seed"]);P!=null&&f(r,["seed"],P);const V=d(e,["responseMimeType"]);V!=null&&f(r,["responseMimeType"],V);const C=d(e,["responseSchema"]);C!=null&&f(r,["responseSchema"],m_(C));const S=d(e,["responseJsonSchema"]);if(S!=null&&f(r,["responseJsonSchema"],S),d(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(d(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const A=d(e,["safetySettings"]);if(n!==void 0&&A!=null){let U=A;Array.isArray(U)&&(U=U.map(b=>eN(b))),f(n,["safetySettings"],U)}const L=d(e,["tools"]);if(n!==void 0&&L!=null){let U=Qa(L);Array.isArray(U)&&(U=U.map(b=>tN(Ja(b)))),f(n,["tools"],U)}const q=d(e,["toolConfig"]);if(n!==void 0&&q!=null&&f(n,["toolConfig"],q),d(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const z=d(e,["cachedContent"]);n!==void 0&&z!=null&&f(n,["cachedContent"],di(t,z));const E=d(e,["responseModalities"]);E!=null&&f(r,["responseModalities"],E);const x=d(e,["mediaResolution"]);x!=null&&f(r,["mediaResolution"],x);const R=d(e,["speechConfig"]);if(R!=null&&f(r,["speechConfig"],g_(R)),d(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const N=d(e,["thinkingConfig"]);N!=null&&f(r,["thinkingConfig"],N);const M=d(e,["imageConfig"]);return M!=null&&f(r,["imageConfig"],M),r}function B1(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["candidates"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(u=>S1(u))),f(e,["candidates"],l)}const i=d(t,["modelVersion"]);i!=null&&f(e,["modelVersion"],i);const s=d(t,["promptFeedback"]);s!=null&&f(e,["promptFeedback"],s);const o=d(t,["responseId"]);o!=null&&f(e,["responseId"],o);const a=d(t,["usageMetadata"]);return a!=null&&f(e,["usageMetadata"],a),e}function G1(t,e){const n={},r=d(e,["name"]);return r!=null&&f(n,["_url","name"],Ya(t,r)),n}function q1(t,e){const n={},r=d(e,["name"]);return r!=null&&f(n,["_url","name"],Ya(t,r)),n}function z1(t){const e={};if(d(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=d(t,["enableWidget"]);return n!=null&&f(e,["enableWidget"],n),e}function $1(t){const e={};if(d(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");const n=d(t,["timeRangeFilter"]);return n!=null&&f(e,["timeRangeFilter"],n),e}function j1(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["request","model"],Be(t,r));const i=d(e,["contents"]);if(i!=null){let a=Qn(i);Array.isArray(a)&&(a=a.map(l=>Ax(l))),f(n,["request","contents"],a)}const s=d(e,["metadata"]);s!=null&&f(n,["metadata"],s);const o=d(e,["config"]);return o!=null&&f(n,["request","generationConfig"],O1(t,o,d(n,["request"],{}))),n}function H1(t){const e={},n=d(t,["response"]);n!=null&&f(e,["response"],B1(n));const r=d(t,["error"]);return r!=null&&f(e,["error"],r),e}function W1(t,e){const n={},r=d(t,["pageSize"]);e!==void 0&&r!=null&&f(e,["_query","pageSize"],r);const i=d(t,["pageToken"]);if(e!==void 0&&i!=null&&f(e,["_query","pageToken"],i),d(t,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return n}function K1(t,e){const n={},r=d(t,["pageSize"]);e!==void 0&&r!=null&&f(e,["_query","pageSize"],r);const i=d(t,["pageToken"]);e!==void 0&&i!=null&&f(e,["_query","pageToken"],i);const s=d(t,["filter"]);return e!==void 0&&s!=null&&f(e,["_query","filter"],s),n}function J1(t){const e={},n=d(t,["config"]);return n!=null&&W1(n,e),e}function Q1(t){const e={},n=d(t,["config"]);return n!=null&&K1(n,e),e}function Y1(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const i=d(t,["operations"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>yd(o))),f(e,["batchJobs"],s)}return e}function X1(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const i=d(t,["batchPredictionJobs"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>Pm(o))),f(e,["batchJobs"],s)}return e}function Z1(t){const e={},n=d(t,["functionCall"]);n!=null&&f(e,["functionCall"],n);const r=d(t,["codeExecutionResult"]);r!=null&&f(e,["codeExecutionResult"],r);const i=d(t,["executableCode"]);i!=null&&f(e,["executableCode"],i);const s=d(t,["fileData"]);s!=null&&f(e,["fileData"],U1(s));const o=d(t,["functionResponse"]);o!=null&&f(e,["functionResponse"],o);const a=d(t,["inlineData"]);a!=null&&f(e,["inlineData"],E1(a));const l=d(t,["text"]);l!=null&&f(e,["text"],l);const u=d(t,["thought"]);u!=null&&f(e,["thought"],u);const p=d(t,["thoughtSignature"]);p!=null&&f(e,["thoughtSignature"],p);const m=d(t,["videoMetadata"]);return m!=null&&f(e,["videoMetadata"],m),e}function eN(t){const e={},n=d(t,["category"]);if(n!=null&&f(e,["category"],n),d(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=d(t,["threshold"]);return r!=null&&f(e,["threshold"],r),e}function tN(t){const e={},n=d(t,["functionDeclarations"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(p=>p)),f(e,["functionDeclarations"],u)}if(d(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=d(t,["googleSearchRetrieval"]);r!=null&&f(e,["googleSearchRetrieval"],r);const i=d(t,["googleMaps"]);i!=null&&f(e,["googleMaps"],z1(i));const s=d(t,["computerUse"]);s!=null&&f(e,["computerUse"],s);const o=d(t,["codeExecution"]);if(o!=null&&f(e,["codeExecution"],o),d(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=d(t,["googleSearch"]);a!=null&&f(e,["googleSearch"],$1(a));const l=d(t,["urlContext"]);return l!=null&&f(e,["urlContext"],l),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var uo;(function(t){t.PAGED_ITEM_BATCH_JOBS="batchJobs",t.PAGED_ITEM_MODELS="models",t.PAGED_ITEM_TUNING_JOBS="tuningJobs",t.PAGED_ITEM_FILES="files",t.PAGED_ITEM_CACHED_CONTENTS="cachedContents",t.PAGED_ITEM_RAG_STORES="ragStores",t.PAGED_ITEM_DOCUMENTS="documents"})(uo||(uo={}));class Ju{constructor(e,n,r,i){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(e,r,i)}init(e,n,r){var i,s;this.nameInternal=e,this.pageInternal=n[this.nameInternal]||[],this.sdkHttpResponseInternal=n==null?void 0:n.sdkHttpResponse,this.idxInternal=0;let o={config:{}};!r||Object.keys(r).length===0?o={config:{}}:typeof r=="object"?o=Object.assign({},r):o=r,o.config&&(o.config.pageToken=n.nextPageToken),this.paramsInternal=o,this.pageInternalSize=(s=(i=o.config)===null||i===void 0?void 0:i.pageSize)!==null&&s!==void 0?s:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class nN extends Eo{constructor(e){super(),this.apiClient=e,this.create=async n=>(this.apiClient.isVertexAI()&&(n.config=this.formatDestination(n.src,n.config)),this.createInternal(n)),this.createEmbeddings=async n=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(n)},this.list=async(n={})=>new Ju(uo.PAGED_ITEM_BATCH_JOBS,r=>this.listInternal(r),await this.listInternal(n),n)}createInlinedGenerateContentRequest(e){const n=OT(this.apiClient,e),r=n._url,i=ce("{model}:batchGenerateContent",r),a=n.batch.inputConfig.requests,l=a.requests,u=[];for(const p of l){const m=Object.assign({},p);if(m.systemInstruction){const g=m.systemInstruction;delete m.systemInstruction;const v=m.request;v.systemInstruction=g,m.request=v}u.push(m)}return a.requests=u,delete n.config,delete n._url,delete n._query,{path:i,body:n}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,n){const r=n?Object.assign({},n):{},i=Date.now().toString();if(r.displayName||(r.displayName=`genaiBatchJob_${i}`),r.dest===void 0){const s=this.getGcsUri(e),o=this.getBigqueryUri(e);if(s)s.endsWith(".jsonl")?r.dest=`${s.slice(0,-6)}/dest`:r.dest=`${s}_dest_${i}`;else if(o)r.dest=`${o}_dest_${i}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return r}async createInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=R1(this.apiClient,e);return a=ce("batchPredictionJobs",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),o.then(p=>Pm(p))}else{const u=OT(this.apiClient,e);return a=ce("{model}:batchGenerateContent",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json()),o.then(p=>yd(p))}}async createEmbeddingsInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=k1(this.apiClient,e);return s=ce("{model}:asyncBatchEmbedContent",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>yd(l))}}async get(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=q1(this.apiClient,e);return a=ce("batchPredictionJobs/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),o.then(p=>Pm(p))}else{const u=G1(this.apiClient,e);return a=ce("batches/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json()),o.then(p=>yd(p))}}async cancel(e){var n,r,i,s;let o="",a={};if(this.apiClient.isVertexAI()){const l=I1(this.apiClient,e);o=ce("batchPredictionJobs/{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}else{const l=w1(this.apiClient,e);o=ce("batches/{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal})}}async listInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=Q1(e);return a=ce("batchPredictionJobs",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:p.headers},g})),o.then(p=>{const m=X1(p),g=new VT;return Object.assign(g,m),g})}else{const u=J1(e);return a=ce("batches",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:p.headers},g})),o.then(p=>{const m=Y1(p),g=new VT;return Object.assign(g,m),g})}}async delete(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=b1(this.apiClient,e);return a=ce("batchPredictionJobs/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:p.headers},g})),o.then(p=>M1(p))}else{const u=N1(this.apiClient,e);return a=ce("batches/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:p.headers},g})),o.then(p=>D1(p))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function rN(t){const e={},n=d(t,["data"]);if(n!=null&&f(e,["data"],n),d(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=d(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function BT(t){const e={},n=d(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>SN(s))),f(e,["parts"],i)}const r=d(t,["role"]);return r!=null&&f(e,["role"],r),e}function iN(t,e){const n={},r=d(t,["ttl"]);e!==void 0&&r!=null&&f(e,["ttl"],r);const i=d(t,["expireTime"]);e!==void 0&&i!=null&&f(e,["expireTime"],i);const s=d(t,["displayName"]);e!==void 0&&s!=null&&f(e,["displayName"],s);const o=d(t,["contents"]);if(e!==void 0&&o!=null){let p=Qn(o);Array.isArray(p)&&(p=p.map(m=>BT(m))),f(e,["contents"],p)}const a=d(t,["systemInstruction"]);e!==void 0&&a!=null&&f(e,["systemInstruction"],BT(nn(a)));const l=d(t,["tools"]);if(e!==void 0&&l!=null){let p=l;Array.isArray(p)&&(p=p.map(m=>xN(m))),f(e,["tools"],p)}const u=d(t,["toolConfig"]);if(e!==void 0&&u!=null&&f(e,["toolConfig"],u),d(t,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function sN(t,e){const n={},r=d(t,["ttl"]);e!==void 0&&r!=null&&f(e,["ttl"],r);const i=d(t,["expireTime"]);e!==void 0&&i!=null&&f(e,["expireTime"],i);const s=d(t,["displayName"]);e!==void 0&&s!=null&&f(e,["displayName"],s);const o=d(t,["contents"]);if(e!==void 0&&o!=null){let m=Qn(o);Array.isArray(m)&&(m=m.map(g=>g)),f(e,["contents"],m)}const a=d(t,["systemInstruction"]);e!==void 0&&a!=null&&f(e,["systemInstruction"],nn(a));const l=d(t,["tools"]);if(e!==void 0&&l!=null){let m=l;Array.isArray(m)&&(m=m.map(g=>CN(g))),f(e,["tools"],m)}const u=d(t,["toolConfig"]);e!==void 0&&u!=null&&f(e,["toolConfig"],u);const p=d(t,["kmsKeyName"]);return e!==void 0&&p!=null&&f(e,["encryption_spec","kmsKeyName"],p),n}function oN(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["model"],mx(t,r));const i=d(e,["config"]);return i!=null&&iN(i,n),n}function aN(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["model"],mx(t,r));const i=d(e,["config"]);return i!=null&&sN(i,n),n}function lN(t,e){const n={},r=d(e,["name"]);return r!=null&&f(n,["_url","name"],di(t,r)),n}function uN(t,e){const n={},r=d(e,["name"]);return r!=null&&f(n,["_url","name"],di(t,r)),n}function cN(t){const e={},n=d(t,["sdkHttpResponse"]);return n!=null&&f(e,["sdkHttpResponse"],n),e}function dN(t){const e={},n=d(t,["sdkHttpResponse"]);return n!=null&&f(e,["sdkHttpResponse"],n),e}function hN(t){const e={};if(d(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=d(t,["fileUri"]);n!=null&&f(e,["fileUri"],n);const r=d(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function fN(t){const e={};if(d(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=d(t,["description"]);n!=null&&f(e,["description"],n);const r=d(t,["name"]);r!=null&&f(e,["name"],r);const i=d(t,["parameters"]);i!=null&&f(e,["parameters"],i);const s=d(t,["parametersJsonSchema"]);s!=null&&f(e,["parametersJsonSchema"],s);const o=d(t,["response"]);o!=null&&f(e,["response"],o);const a=d(t,["responseJsonSchema"]);return a!=null&&f(e,["responseJsonSchema"],a),e}function pN(t,e){const n={},r=d(e,["name"]);return r!=null&&f(n,["_url","name"],di(t,r)),n}function mN(t,e){const n={},r=d(e,["name"]);return r!=null&&f(n,["_url","name"],di(t,r)),n}function gN(t){const e={};if(d(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=d(t,["enableWidget"]);return n!=null&&f(e,["enableWidget"],n),e}function _N(t){const e={};if(d(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");const n=d(t,["timeRangeFilter"]);return n!=null&&f(e,["timeRangeFilter"],n),e}function yN(t,e){const n={},r=d(t,["pageSize"]);e!==void 0&&r!=null&&f(e,["_query","pageSize"],r);const i=d(t,["pageToken"]);return e!==void 0&&i!=null&&f(e,["_query","pageToken"],i),n}function vN(t,e){const n={},r=d(t,["pageSize"]);e!==void 0&&r!=null&&f(e,["_query","pageSize"],r);const i=d(t,["pageToken"]);return e!==void 0&&i!=null&&f(e,["_query","pageToken"],i),n}function TN(t){const e={},n=d(t,["config"]);return n!=null&&yN(n,e),e}function EN(t){const e={},n=d(t,["config"]);return n!=null&&vN(n,e),e}function wN(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const i=d(t,["cachedContents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),f(e,["cachedContents"],s)}return e}function IN(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const i=d(t,["cachedContents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),f(e,["cachedContents"],s)}return e}function SN(t){const e={},n=d(t,["functionCall"]);n!=null&&f(e,["functionCall"],n);const r=d(t,["codeExecutionResult"]);r!=null&&f(e,["codeExecutionResult"],r);const i=d(t,["executableCode"]);i!=null&&f(e,["executableCode"],i);const s=d(t,["fileData"]);s!=null&&f(e,["fileData"],hN(s));const o=d(t,["functionResponse"]);o!=null&&f(e,["functionResponse"],o);const a=d(t,["inlineData"]);a!=null&&f(e,["inlineData"],rN(a));const l=d(t,["text"]);l!=null&&f(e,["text"],l);const u=d(t,["thought"]);u!=null&&f(e,["thought"],u);const p=d(t,["thoughtSignature"]);p!=null&&f(e,["thoughtSignature"],p);const m=d(t,["videoMetadata"]);return m!=null&&f(e,["videoMetadata"],m),e}function xN(t){const e={},n=d(t,["functionDeclarations"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(p=>p)),f(e,["functionDeclarations"],u)}if(d(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=d(t,["googleSearchRetrieval"]);r!=null&&f(e,["googleSearchRetrieval"],r);const i=d(t,["googleMaps"]);i!=null&&f(e,["googleMaps"],gN(i));const s=d(t,["computerUse"]);s!=null&&f(e,["computerUse"],s);const o=d(t,["codeExecution"]);if(o!=null&&f(e,["codeExecution"],o),d(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=d(t,["googleSearch"]);a!=null&&f(e,["googleSearch"],_N(a));const l=d(t,["urlContext"]);return l!=null&&f(e,["urlContext"],l),e}function CN(t){const e={},n=d(t,["functionDeclarations"]);if(n!=null){let m=n;Array.isArray(m)&&(m=m.map(g=>fN(g))),f(e,["functionDeclarations"],m)}const r=d(t,["retrieval"]);r!=null&&f(e,["retrieval"],r);const i=d(t,["googleSearchRetrieval"]);i!=null&&f(e,["googleSearchRetrieval"],i);const s=d(t,["googleMaps"]);s!=null&&f(e,["googleMaps"],s);const o=d(t,["computerUse"]);o!=null&&f(e,["computerUse"],o);const a=d(t,["codeExecution"]);a!=null&&f(e,["codeExecution"],a);const l=d(t,["enterpriseWebSearch"]);l!=null&&f(e,["enterpriseWebSearch"],l);const u=d(t,["googleSearch"]);u!=null&&f(e,["googleSearch"],u);const p=d(t,["urlContext"]);return p!=null&&f(e,["urlContext"],p),e}function AN(t,e){const n={},r=d(t,["ttl"]);e!==void 0&&r!=null&&f(e,["ttl"],r);const i=d(t,["expireTime"]);return e!==void 0&&i!=null&&f(e,["expireTime"],i),n}function RN(t,e){const n={},r=d(t,["ttl"]);e!==void 0&&r!=null&&f(e,["ttl"],r);const i=d(t,["expireTime"]);return e!==void 0&&i!=null&&f(e,["expireTime"],i),n}function PN(t,e){const n={},r=d(e,["name"]);r!=null&&f(n,["_url","name"],di(t,r));const i=d(e,["config"]);return i!=null&&AN(i,n),n}function kN(t,e){const n={},r=d(e,["name"]);r!=null&&f(n,["_url","name"],di(t,r));const i=d(e,["config"]);return i!=null&&RN(i,n),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class NN extends Eo{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new Ju(uo.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(n),n)}async create(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=aN(this.apiClient,e);return a=ce("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),o.then(p=>p)}else{const u=oN(this.apiClient,e);return a=ce("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json()),o.then(p=>p)}}async get(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=mN(this.apiClient,e);return a=ce("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),o.then(p=>p)}else{const u=pN(this.apiClient,e);return a=ce("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json()),o.then(p=>p)}}async delete(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=uN(this.apiClient,e);return a=ce("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:p.headers},g})),o.then(p=>{const m=dN(p),g=new DT;return Object.assign(g,m),g})}else{const u=lN(this.apiClient,e);return a=ce("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:p.headers},g})),o.then(p=>{const m=cN(p),g=new DT;return Object.assign(g,m),g})}}async update(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=kN(this.apiClient,e);return a=ce("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),o.then(p=>p)}else{const u=PN(this.apiClient,e);return a=ce("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json()),o.then(p=>p)}}async listInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=EN(e);return a=ce("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:p.headers},g})),o.then(p=>{const m=IN(p),g=new MT;return Object.assign(g,m),g})}else{const u=TN(e);return a=ce("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:p.headers},g})),o.then(p=>{const m=wN(p),g=new MT;return Object.assign(g,m),g})}}}function GT(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ot(t){return this instanceof ot?(this.v=t,this):new ot(t)}function ga(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),i,s=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(v){return function(I){return Promise.resolve(I).then(v,m)}}function a(v,I){r[v]&&(i[v]=function(P){return new Promise(function(V,C){s.push([v,P,V,C])>1||l(v,P)})},I&&(i[v]=I(i[v])))}function l(v,I){try{u(r[v](I))}catch(P){g(s[0][3],P)}}function u(v){v.value instanceof ot?Promise.resolve(v.value.v).then(p,m):g(s[0][2],v)}function p(v){l("next",v)}function m(v){l("throw",v)}function g(v,I){v(I),s.shift(),s.length&&l(s[0][0],s[0][1])}}function eu(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof GT=="function"?GT(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(s){n[s]=t[s]&&function(o){return new Promise(function(a,l){o=t[s](o),i(a,l,o.done,o.value)})}}function i(s,o,a,l){Promise.resolve(l).then(function(u){s({value:u,done:a})},o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function bN(t){var e;if(t.candidates==null||t.candidates.length===0)return!1;const n=(e=t.candidates[0])===null||e===void 0?void 0:e.content;return n===void 0?!1:Rx(n)}function Rx(t){if(t.parts===void 0||t.parts.length===0)return!1;for(const e of t.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function DN(t){if(t.length!==0){for(const e of t)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function qT(t){if(t===void 0||t.length===0)return[];const e=[],n=t.length;let r=0;for(;r<n;)if(t[r].role==="user")e.push(t[r]),r++;else{const i=[];let s=!0;for(;r<n&&t[r].role==="model";)i.push(t[r]),s&&!Rx(t[r])&&(s=!1),r++;s?e.push(...i):e.pop()}return e}class MN{constructor(e,n){this.modelsModule=e,this.apiClient=n}create(e){return new VN(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class VN{constructor(e,n,r,i={},s=[]){this.apiClient=e,this.modelsModule=n,this.model=r,this.config=i,this.history=s,this.sendPromise=Promise.resolve(),DN(s)}async sendMessage(e){var n;await this.sendPromise;const r=nn(e.message),i=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var s,o,a;const l=await i,u=(o=(s=l.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content,p=l.automaticFunctionCallingHistory,m=this.getHistory(!0).length;let g=[];p!=null&&(g=(a=p.slice(m))!==null&&a!==void 0?a:[]);const v=u?[u]:[];this.recordHistory(r,v,g)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),i}async sendMessageStream(e){var n;await this.sendPromise;const r=nn(e.message),i=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});this.sendPromise=i.then(()=>{}).catch(()=>{});const s=await i;return this.processStreamResponse(s,r)}getHistory(e=!1){const n=e?qT(this.history):this.history;return structuredClone(n)}processStreamResponse(e,n){var r,i;return ga(this,arguments,function*(){var o,a,l,u;const p=[];try{for(var m=!0,g=eu(e),v;v=yield ot(g.next()),o=v.done,!o;m=!0){u=v.value,m=!1;const I=u;if(bN(I)){const P=(i=(r=I.candidates)===null||r===void 0?void 0:r[0])===null||i===void 0?void 0:i.content;P!==void 0&&p.push(P)}yield yield ot(I)}}catch(I){a={error:I}}finally{try{!m&&!o&&(l=g.return)&&(yield ot(l.call(g)))}finally{if(a)throw a.error}}this.recordHistory(n,p)})}recordHistory(e,n,r){let i=[];n.length>0&&n.every(s=>s.role!==void 0)?i=n:i.push({role:"model",parts:[]}),r&&r.length>0?this.history.push(...qT(r)):this.history.push(e),this.history.push(...i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Qh extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,Qh.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function LN(t){const e={},n=d(t,["file"]);return n!=null&&f(e,["file"],n),e}function FN(t){const e={},n=d(t,["sdkHttpResponse"]);return n!=null&&f(e,["sdkHttpResponse"],n),e}function UN(t){const e={},n=d(t,["name"]);return n!=null&&f(e,["_url","file"],Ex(n)),e}function ON(t){const e={},n=d(t,["sdkHttpResponse"]);return n!=null&&f(e,["sdkHttpResponse"],n),e}function BN(t){const e={},n=d(t,["name"]);return n!=null&&f(e,["_url","file"],Ex(n)),e}function GN(t,e){const n={},r=d(t,["pageSize"]);e!==void 0&&r!=null&&f(e,["_query","pageSize"],r);const i=d(t,["pageToken"]);return e!==void 0&&i!=null&&f(e,["_query","pageToken"],i),n}function qN(t){const e={},n=d(t,["config"]);return n!=null&&GN(n,e),e}function zN(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const i=d(t,["files"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),f(e,["files"],s)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class $N extends Eo{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new Ju(uo.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(n),n)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(n=>n)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=qN(e);return s=ce("files",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const p=u;return p.sdkHttpResponse={headers:l.headers},p})),i.then(l=>{const u=zN(l),p=new t1;return Object.assign(p,u),p})}}async createInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=LN(e);return s=ce("upload/v1beta/files",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=FN(l),p=new n1;return Object.assign(p,u),p})}}async get(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=BN(e);return s=ce("files/{file}",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>l)}}async delete(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=UN(e);return s=ce("files/{file}",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const p=u;return p.sdkHttpResponse={headers:l.headers},p})),i.then(l=>{const u=ON(l),p=new r1;return Object.assign(p,u),p})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function vd(t){const e={},n=d(t,["data"]);if(n!=null&&f(e,["data"],n),d(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=d(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function jN(t){const e={},n=d(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>ob(s))),f(e,["parts"],i)}const r=d(t,["role"]);return r!=null&&f(e,["role"],r),e}function HN(t){const e={};if(d(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=d(t,["fileUri"]);n!=null&&f(e,["fileUri"],n);const r=d(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function WN(t){const e={};if(d(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=d(t,["description"]);n!=null&&f(e,["description"],n);const r=d(t,["name"]);r!=null&&f(e,["name"],r);const i=d(t,["parameters"]);i!=null&&f(e,["parameters"],i);const s=d(t,["parametersJsonSchema"]);s!=null&&f(e,["parametersJsonSchema"],s);const o=d(t,["response"]);o!=null&&f(e,["response"],o);const a=d(t,["responseJsonSchema"]);return a!=null&&f(e,["responseJsonSchema"],a),e}function KN(t){const e={},n=d(t,["modelSelectionConfig"]);n!=null&&f(e,["modelConfig"],n);const r=d(t,["audioTimestamp"]);r!=null&&f(e,["audioTimestamp"],r);const i=d(t,["candidateCount"]);i!=null&&f(e,["candidateCount"],i);const s=d(t,["enableAffectiveDialog"]);s!=null&&f(e,["enableAffectiveDialog"],s);const o=d(t,["frequencyPenalty"]);o!=null&&f(e,["frequencyPenalty"],o);const a=d(t,["logprobs"]);a!=null&&f(e,["logprobs"],a);const l=d(t,["maxOutputTokens"]);l!=null&&f(e,["maxOutputTokens"],l);const u=d(t,["mediaResolution"]);u!=null&&f(e,["mediaResolution"],u);const p=d(t,["presencePenalty"]);p!=null&&f(e,["presencePenalty"],p);const m=d(t,["responseJsonSchema"]);m!=null&&f(e,["responseJsonSchema"],m);const g=d(t,["responseLogprobs"]);g!=null&&f(e,["responseLogprobs"],g);const v=d(t,["responseMimeType"]);v!=null&&f(e,["responseMimeType"],v);const I=d(t,["responseModalities"]);I!=null&&f(e,["responseModalities"],I);const P=d(t,["responseSchema"]);P!=null&&f(e,["responseSchema"],P);const V=d(t,["routingConfig"]);V!=null&&f(e,["routingConfig"],V);const C=d(t,["seed"]);C!=null&&f(e,["seed"],C);const S=d(t,["speechConfig"]);S!=null&&f(e,["speechConfig"],Px(S));const A=d(t,["stopSequences"]);A!=null&&f(e,["stopSequences"],A);const L=d(t,["temperature"]);L!=null&&f(e,["temperature"],L);const q=d(t,["thinkingConfig"]);q!=null&&f(e,["thinkingConfig"],q);const z=d(t,["topK"]);z!=null&&f(e,["topK"],z);const E=d(t,["topP"]);if(E!=null&&f(e,["topP"],E),d(t,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function JN(t){const e={};if(d(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=d(t,["enableWidget"]);return n!=null&&f(e,["enableWidget"],n),e}function QN(t){const e={};if(d(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");const n=d(t,["timeRangeFilter"]);return n!=null&&f(e,["timeRangeFilter"],n),e}function YN(t,e){const n={},r=d(t,["generationConfig"]);e!==void 0&&r!=null&&f(e,["setup","generationConfig"],r);const i=d(t,["responseModalities"]);e!==void 0&&i!=null&&f(e,["setup","generationConfig","responseModalities"],i);const s=d(t,["temperature"]);e!==void 0&&s!=null&&f(e,["setup","generationConfig","temperature"],s);const o=d(t,["topP"]);e!==void 0&&o!=null&&f(e,["setup","generationConfig","topP"],o);const a=d(t,["topK"]);e!==void 0&&a!=null&&f(e,["setup","generationConfig","topK"],a);const l=d(t,["maxOutputTokens"]);e!==void 0&&l!=null&&f(e,["setup","generationConfig","maxOutputTokens"],l);const u=d(t,["mediaResolution"]);e!==void 0&&u!=null&&f(e,["setup","generationConfig","mediaResolution"],u);const p=d(t,["seed"]);e!==void 0&&p!=null&&f(e,["setup","generationConfig","seed"],p);const m=d(t,["speechConfig"]);e!==void 0&&m!=null&&f(e,["setup","generationConfig","speechConfig"],__(m));const g=d(t,["thinkingConfig"]);e!==void 0&&g!=null&&f(e,["setup","generationConfig","thinkingConfig"],g);const v=d(t,["enableAffectiveDialog"]);e!==void 0&&v!=null&&f(e,["setup","generationConfig","enableAffectiveDialog"],v);const I=d(t,["systemInstruction"]);e!==void 0&&I!=null&&f(e,["setup","systemInstruction"],jN(nn(I)));const P=d(t,["tools"]);if(e!==void 0&&P!=null){let z=Qa(P);Array.isArray(z)&&(z=z.map(E=>lb(Ja(E)))),f(e,["setup","tools"],z)}const V=d(t,["sessionResumption"]);e!==void 0&&V!=null&&f(e,["setup","sessionResumption"],ab(V));const C=d(t,["inputAudioTranscription"]);e!==void 0&&C!=null&&f(e,["setup","inputAudioTranscription"],C);const S=d(t,["outputAudioTranscription"]);e!==void 0&&S!=null&&f(e,["setup","outputAudioTranscription"],S);const A=d(t,["realtimeInputConfig"]);e!==void 0&&A!=null&&f(e,["setup","realtimeInputConfig"],A);const L=d(t,["contextWindowCompression"]);e!==void 0&&L!=null&&f(e,["setup","contextWindowCompression"],L);const q=d(t,["proactivity"]);return e!==void 0&&q!=null&&f(e,["setup","proactivity"],q),n}function XN(t,e){const n={},r=d(t,["generationConfig"]);e!==void 0&&r!=null&&f(e,["setup","generationConfig"],KN(r));const i=d(t,["responseModalities"]);e!==void 0&&i!=null&&f(e,["setup","generationConfig","responseModalities"],i);const s=d(t,["temperature"]);e!==void 0&&s!=null&&f(e,["setup","generationConfig","temperature"],s);const o=d(t,["topP"]);e!==void 0&&o!=null&&f(e,["setup","generationConfig","topP"],o);const a=d(t,["topK"]);e!==void 0&&a!=null&&f(e,["setup","generationConfig","topK"],a);const l=d(t,["maxOutputTokens"]);e!==void 0&&l!=null&&f(e,["setup","generationConfig","maxOutputTokens"],l);const u=d(t,["mediaResolution"]);e!==void 0&&u!=null&&f(e,["setup","generationConfig","mediaResolution"],u);const p=d(t,["seed"]);e!==void 0&&p!=null&&f(e,["setup","generationConfig","seed"],p);const m=d(t,["speechConfig"]);e!==void 0&&m!=null&&f(e,["setup","generationConfig","speechConfig"],Px(__(m)));const g=d(t,["thinkingConfig"]);e!==void 0&&g!=null&&f(e,["setup","generationConfig","thinkingConfig"],g);const v=d(t,["enableAffectiveDialog"]);e!==void 0&&v!=null&&f(e,["setup","generationConfig","enableAffectiveDialog"],v);const I=d(t,["systemInstruction"]);e!==void 0&&I!=null&&f(e,["setup","systemInstruction"],nn(I));const P=d(t,["tools"]);if(e!==void 0&&P!=null){let z=Qa(P);Array.isArray(z)&&(z=z.map(E=>ub(Ja(E)))),f(e,["setup","tools"],z)}const V=d(t,["sessionResumption"]);e!==void 0&&V!=null&&f(e,["setup","sessionResumption"],V);const C=d(t,["inputAudioTranscription"]);e!==void 0&&C!=null&&f(e,["setup","inputAudioTranscription"],C);const S=d(t,["outputAudioTranscription"]);e!==void 0&&S!=null&&f(e,["setup","outputAudioTranscription"],S);const A=d(t,["realtimeInputConfig"]);e!==void 0&&A!=null&&f(e,["setup","realtimeInputConfig"],A);const L=d(t,["contextWindowCompression"]);e!==void 0&&L!=null&&f(e,["setup","contextWindowCompression"],L);const q=d(t,["proactivity"]);return e!==void 0&&q!=null&&f(e,["setup","proactivity"],q),n}function ZN(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["setup","model"],Be(t,r));const i=d(e,["config"]);return i!=null&&f(n,["config"],YN(i,n)),n}function eb(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["setup","model"],Be(t,r));const i=d(e,["config"]);return i!=null&&f(n,["config"],XN(i,n)),n}function tb(t){const e={},n=d(t,["musicGenerationConfig"]);return n!=null&&f(e,["musicGenerationConfig"],n),e}function nb(t){const e={},n=d(t,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>i)),f(e,["weightedPrompts"],r)}return e}function rb(t){const e={},n=d(t,["media"]);if(n!=null){let u=gx(n);Array.isArray(u)&&(u=u.map(p=>vd(p))),f(e,["mediaChunks"],u)}const r=d(t,["audio"]);r!=null&&f(e,["audio"],vd(yx(r)));const i=d(t,["audioStreamEnd"]);i!=null&&f(e,["audioStreamEnd"],i);const s=d(t,["video"]);s!=null&&f(e,["video"],vd(_x(s)));const o=d(t,["text"]);o!=null&&f(e,["text"],o);const a=d(t,["activityStart"]);a!=null&&f(e,["activityStart"],a);const l=d(t,["activityEnd"]);return l!=null&&f(e,["activityEnd"],l),e}function ib(t){const e={},n=d(t,["media"]);if(n!=null){let u=gx(n);Array.isArray(u)&&(u=u.map(p=>p)),f(e,["mediaChunks"],u)}const r=d(t,["audio"]);r!=null&&f(e,["audio"],yx(r));const i=d(t,["audioStreamEnd"]);i!=null&&f(e,["audioStreamEnd"],i);const s=d(t,["video"]);s!=null&&f(e,["video"],_x(s));const o=d(t,["text"]);o!=null&&f(e,["text"],o);const a=d(t,["activityStart"]);a!=null&&f(e,["activityStart"],a);const l=d(t,["activityEnd"]);return l!=null&&f(e,["activityEnd"],l),e}function sb(t){const e={},n=d(t,["setupComplete"]);n!=null&&f(e,["setupComplete"],n);const r=d(t,["serverContent"]);r!=null&&f(e,["serverContent"],r);const i=d(t,["toolCall"]);i!=null&&f(e,["toolCall"],i);const s=d(t,["toolCallCancellation"]);s!=null&&f(e,["toolCallCancellation"],s);const o=d(t,["usageMetadata"]);o!=null&&f(e,["usageMetadata"],cb(o));const a=d(t,["goAway"]);a!=null&&f(e,["goAway"],a);const l=d(t,["sessionResumptionUpdate"]);return l!=null&&f(e,["sessionResumptionUpdate"],l),e}function ob(t){const e={},n=d(t,["functionCall"]);n!=null&&f(e,["functionCall"],n);const r=d(t,["codeExecutionResult"]);r!=null&&f(e,["codeExecutionResult"],r);const i=d(t,["executableCode"]);i!=null&&f(e,["executableCode"],i);const s=d(t,["fileData"]);s!=null&&f(e,["fileData"],HN(s));const o=d(t,["functionResponse"]);o!=null&&f(e,["functionResponse"],o);const a=d(t,["inlineData"]);a!=null&&f(e,["inlineData"],vd(a));const l=d(t,["text"]);l!=null&&f(e,["text"],l);const u=d(t,["thought"]);u!=null&&f(e,["thought"],u);const p=d(t,["thoughtSignature"]);p!=null&&f(e,["thoughtSignature"],p);const m=d(t,["videoMetadata"]);return m!=null&&f(e,["videoMetadata"],m),e}function ab(t){const e={},n=d(t,["handle"]);if(n!=null&&f(e,["handle"],n),d(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function Px(t){const e={},n=d(t,["languageCode"]);n!=null&&f(e,["languageCode"],n);const r=d(t,["voiceConfig"]);if(r!=null&&f(e,["voiceConfig"],r),d(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return e}function lb(t){const e={},n=d(t,["functionDeclarations"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(p=>p)),f(e,["functionDeclarations"],u)}if(d(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=d(t,["googleSearchRetrieval"]);r!=null&&f(e,["googleSearchRetrieval"],r);const i=d(t,["googleMaps"]);i!=null&&f(e,["googleMaps"],JN(i));const s=d(t,["computerUse"]);s!=null&&f(e,["computerUse"],s);const o=d(t,["codeExecution"]);if(o!=null&&f(e,["codeExecution"],o),d(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=d(t,["googleSearch"]);a!=null&&f(e,["googleSearch"],QN(a));const l=d(t,["urlContext"]);return l!=null&&f(e,["urlContext"],l),e}function ub(t){const e={},n=d(t,["functionDeclarations"]);if(n!=null){let m=n;Array.isArray(m)&&(m=m.map(g=>WN(g))),f(e,["functionDeclarations"],m)}const r=d(t,["retrieval"]);r!=null&&f(e,["retrieval"],r);const i=d(t,["googleSearchRetrieval"]);i!=null&&f(e,["googleSearchRetrieval"],i);const s=d(t,["googleMaps"]);s!=null&&f(e,["googleMaps"],s);const o=d(t,["computerUse"]);o!=null&&f(e,["computerUse"],o);const a=d(t,["codeExecution"]);a!=null&&f(e,["codeExecution"],a);const l=d(t,["enterpriseWebSearch"]);l!=null&&f(e,["enterpriseWebSearch"],l);const u=d(t,["googleSearch"]);u!=null&&f(e,["googleSearch"],u);const p=d(t,["urlContext"]);return p!=null&&f(e,["urlContext"],p),e}function cb(t){const e={},n=d(t,["promptTokenCount"]);n!=null&&f(e,["promptTokenCount"],n);const r=d(t,["cachedContentTokenCount"]);r!=null&&f(e,["cachedContentTokenCount"],r);const i=d(t,["candidatesTokenCount"]);i!=null&&f(e,["responseTokenCount"],i);const s=d(t,["toolUsePromptTokenCount"]);s!=null&&f(e,["toolUsePromptTokenCount"],s);const o=d(t,["thoughtsTokenCount"]);o!=null&&f(e,["thoughtsTokenCount"],o);const a=d(t,["totalTokenCount"]);a!=null&&f(e,["totalTokenCount"],a);const l=d(t,["promptTokensDetails"]);if(l!=null){let v=l;Array.isArray(v)&&(v=v.map(I=>I)),f(e,["promptTokensDetails"],v)}const u=d(t,["cacheTokensDetails"]);if(u!=null){let v=u;Array.isArray(v)&&(v=v.map(I=>I)),f(e,["cacheTokensDetails"],v)}const p=d(t,["candidatesTokensDetails"]);if(p!=null){let v=p;Array.isArray(v)&&(v=v.map(I=>I)),f(e,["responseTokensDetails"],v)}const m=d(t,["toolUsePromptTokensDetails"]);if(m!=null){let v=m;Array.isArray(v)&&(v=v.map(I=>I)),f(e,["toolUsePromptTokensDetails"],v)}const g=d(t,["trafficType"]);return g!=null&&f(e,["trafficType"],g),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function db(t){const e={},n=d(t,["data"]);if(n!=null&&f(e,["data"],n),d(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=d(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function hb(t){const e={},n=d(t,["content"]);n!=null&&f(e,["content"],n);const r=d(t,["citationMetadata"]);r!=null&&f(e,["citationMetadata"],fb(r));const i=d(t,["tokenCount"]);i!=null&&f(e,["tokenCount"],i);const s=d(t,["finishReason"]);s!=null&&f(e,["finishReason"],s);const o=d(t,["avgLogprobs"]);o!=null&&f(e,["avgLogprobs"],o);const a=d(t,["groundingMetadata"]);a!=null&&f(e,["groundingMetadata"],a);const l=d(t,["index"]);l!=null&&f(e,["index"],l);const u=d(t,["logprobsResult"]);u!=null&&f(e,["logprobsResult"],u);const p=d(t,["safetyRatings"]);if(p!=null){let g=p;Array.isArray(g)&&(g=g.map(v=>v)),f(e,["safetyRatings"],g)}const m=d(t,["urlContextMetadata"]);return m!=null&&f(e,["urlContextMetadata"],m),e}function fb(t){const e={},n=d(t,["citationSources"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>i)),f(e,["citations"],r)}return e}function pb(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["_url","model"],Be(t,r));const i=d(e,["contents"]);if(i!=null){let s=Qn(i);Array.isArray(s)&&(s=s.map(o=>o)),f(n,["contents"],s)}return n}function mb(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["tokensInfo"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>s)),f(e,["tokensInfo"],i)}return e}function gb(t){const e={},n=d(t,["values"]);n!=null&&f(e,["values"],n);const r=d(t,["statistics"]);return r!=null&&f(e,["statistics"],_b(r)),e}function _b(t){const e={},n=d(t,["truncated"]);n!=null&&f(e,["truncated"],n);const r=d(t,["token_count"]);return r!=null&&f(e,["tokenCount"],r),e}function Yh(t){const e={},n=d(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>wD(s))),f(e,["parts"],i)}const r=d(t,["role"]);return r!=null&&f(e,["role"],r),e}function yb(t){const e={},n=d(t,["controlType"]);n!=null&&f(e,["controlType"],n);const r=d(t,["enableControlImageComputation"]);return r!=null&&f(e,["computeControl"],r),e}function vb(t){const e={};if(d(t,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(d(t,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(d(t,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function Tb(t,e){const n={},r=d(t,["systemInstruction"]);e!==void 0&&r!=null&&f(e,["systemInstruction"],nn(r));const i=d(t,["tools"]);if(e!==void 0&&i!=null){let o=i;Array.isArray(o)&&(o=o.map(a=>Mx(a))),f(e,["tools"],o)}const s=d(t,["generationConfig"]);return e!==void 0&&s!=null&&f(e,["generationConfig"],uD(s)),n}function Eb(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["_url","model"],Be(t,r));const i=d(e,["contents"]);if(i!=null){let o=Qn(i);Array.isArray(o)&&(o=o.map(a=>Yh(a))),f(n,["contents"],o)}const s=d(e,["config"]);return s!=null&&vb(s),n}function wb(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["_url","model"],Be(t,r));const i=d(e,["contents"]);if(i!=null){let o=Qn(i);Array.isArray(o)&&(o=o.map(a=>a)),f(n,["contents"],o)}const s=d(e,["config"]);return s!=null&&Tb(s,n),n}function Ib(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["totalTokens"]);r!=null&&f(e,["totalTokens"],r);const i=d(t,["cachedContentTokenCount"]);return i!=null&&f(e,["cachedContentTokenCount"],i),e}function Sb(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["totalTokens"]);return r!=null&&f(e,["totalTokens"],r),e}function xb(t,e){const n={},r=d(e,["model"]);return r!=null&&f(n,["_url","name"],Be(t,r)),n}function Cb(t,e){const n={},r=d(e,["model"]);return r!=null&&f(n,["_url","name"],Be(t,r)),n}function Ab(t){const e={},n=d(t,["sdkHttpResponse"]);return n!=null&&f(e,["sdkHttpResponse"],n),e}function Rb(t){const e={},n=d(t,["sdkHttpResponse"]);return n!=null&&f(e,["sdkHttpResponse"],n),e}function Pb(t,e){const n={},r=d(t,["outputGcsUri"]);e!==void 0&&r!=null&&f(e,["parameters","storageUri"],r);const i=d(t,["negativePrompt"]);e!==void 0&&i!=null&&f(e,["parameters","negativePrompt"],i);const s=d(t,["numberOfImages"]);e!==void 0&&s!=null&&f(e,["parameters","sampleCount"],s);const o=d(t,["aspectRatio"]);e!==void 0&&o!=null&&f(e,["parameters","aspectRatio"],o);const a=d(t,["guidanceScale"]);e!==void 0&&a!=null&&f(e,["parameters","guidanceScale"],a);const l=d(t,["seed"]);e!==void 0&&l!=null&&f(e,["parameters","seed"],l);const u=d(t,["safetyFilterLevel"]);e!==void 0&&u!=null&&f(e,["parameters","safetySetting"],u);const p=d(t,["personGeneration"]);e!==void 0&&p!=null&&f(e,["parameters","personGeneration"],p);const m=d(t,["includeSafetyAttributes"]);e!==void 0&&m!=null&&f(e,["parameters","includeSafetyAttributes"],m);const g=d(t,["includeRaiReason"]);e!==void 0&&g!=null&&f(e,["parameters","includeRaiReason"],g);const v=d(t,["language"]);e!==void 0&&v!=null&&f(e,["parameters","language"],v);const I=d(t,["outputMimeType"]);e!==void 0&&I!=null&&f(e,["parameters","outputOptions","mimeType"],I);const P=d(t,["outputCompressionQuality"]);e!==void 0&&P!=null&&f(e,["parameters","outputOptions","compressionQuality"],P);const V=d(t,["addWatermark"]);e!==void 0&&V!=null&&f(e,["parameters","addWatermark"],V);const C=d(t,["labels"]);e!==void 0&&C!=null&&f(e,["labels"],C);const S=d(t,["editMode"]);e!==void 0&&S!=null&&f(e,["parameters","editMode"],S);const A=d(t,["baseSteps"]);return e!==void 0&&A!=null&&f(e,["parameters","editConfig","baseSteps"],A),n}function kb(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["_url","model"],Be(t,r));const i=d(e,["prompt"]);i!=null&&f(n,["instances[0]","prompt"],i);const s=d(e,["referenceImages"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>RD(l))),f(n,["instances[0]","referenceImages"],a)}const o=d(e,["config"]);return o!=null&&Pb(o,n),n}function Nb(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>Xh(s))),f(e,["generatedImages"],i)}return e}function bb(t,e){const n={},r=d(t,["taskType"]);e!==void 0&&r!=null&&f(e,["requests[]","taskType"],r);const i=d(t,["title"]);e!==void 0&&i!=null&&f(e,["requests[]","title"],i);const s=d(t,["outputDimensionality"]);if(e!==void 0&&s!=null&&f(e,["requests[]","outputDimensionality"],s),d(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(d(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function Db(t,e){const n={},r=d(t,["taskType"]);e!==void 0&&r!=null&&f(e,["instances[]","task_type"],r);const i=d(t,["title"]);e!==void 0&&i!=null&&f(e,["instances[]","title"],i);const s=d(t,["outputDimensionality"]);e!==void 0&&s!=null&&f(e,["parameters","outputDimensionality"],s);const o=d(t,["mimeType"]);e!==void 0&&o!=null&&f(e,["instances[]","mimeType"],o);const a=d(t,["autoTruncate"]);return e!==void 0&&a!=null&&f(e,["parameters","autoTruncate"],a),n}function Mb(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["_url","model"],Be(t,r));const i=d(e,["contents"]);if(i!=null){let a=p_(t,i);Array.isArray(a)&&(a=a.map(l=>l)),f(n,["requests[]","content"],a)}const s=d(e,["config"]);s!=null&&bb(s,n);const o=d(e,["model"]);return o!==void 0&&f(n,["requests[]","model"],Be(t,o)),n}function Vb(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["_url","model"],Be(t,r));const i=d(e,["contents"]);if(i!=null){let o=p_(t,i);Array.isArray(o)&&(o=o.map(a=>a)),f(n,["instances[]","content"],o)}const s=d(e,["config"]);return s!=null&&Db(s,n),n}function Lb(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["embeddings"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>o)),f(e,["embeddings"],s)}const i=d(t,["metadata"]);return i!=null&&f(e,["metadata"],i),e}function Fb(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["predictions[]","embeddings"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>gb(o))),f(e,["embeddings"],s)}const i=d(t,["metadata"]);return i!=null&&f(e,["metadata"],i),e}function Ub(t){const e={},n=d(t,["endpoint"]);n!=null&&f(e,["name"],n);const r=d(t,["deployedModelId"]);return r!=null&&f(e,["deployedModelId"],r),e}function Ob(t){const e={};if(d(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=d(t,["fileUri"]);n!=null&&f(e,["fileUri"],n);const r=d(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function Bb(t){const e={};if(d(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=d(t,["description"]);n!=null&&f(e,["description"],n);const r=d(t,["name"]);r!=null&&f(e,["name"],r);const i=d(t,["parameters"]);i!=null&&f(e,["parameters"],i);const s=d(t,["parametersJsonSchema"]);s!=null&&f(e,["parametersJsonSchema"],s);const o=d(t,["response"]);o!=null&&f(e,["response"],o);const a=d(t,["responseJsonSchema"]);return a!=null&&f(e,["responseJsonSchema"],a),e}function Gb(t,e,n){const r={},i=d(e,["systemInstruction"]);n!==void 0&&i!=null&&f(n,["systemInstruction"],Yh(nn(i)));const s=d(e,["temperature"]);s!=null&&f(r,["temperature"],s);const o=d(e,["topP"]);o!=null&&f(r,["topP"],o);const a=d(e,["topK"]);a!=null&&f(r,["topK"],a);const l=d(e,["candidateCount"]);l!=null&&f(r,["candidateCount"],l);const u=d(e,["maxOutputTokens"]);u!=null&&f(r,["maxOutputTokens"],u);const p=d(e,["stopSequences"]);p!=null&&f(r,["stopSequences"],p);const m=d(e,["responseLogprobs"]);m!=null&&f(r,["responseLogprobs"],m);const g=d(e,["logprobs"]);g!=null&&f(r,["logprobs"],g);const v=d(e,["presencePenalty"]);v!=null&&f(r,["presencePenalty"],v);const I=d(e,["frequencyPenalty"]);I!=null&&f(r,["frequencyPenalty"],I);const P=d(e,["seed"]);P!=null&&f(r,["seed"],P);const V=d(e,["responseMimeType"]);V!=null&&f(r,["responseMimeType"],V);const C=d(e,["responseSchema"]);C!=null&&f(r,["responseSchema"],m_(C));const S=d(e,["responseJsonSchema"]);if(S!=null&&f(r,["responseJsonSchema"],S),d(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(d(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const A=d(e,["safetySettings"]);if(n!==void 0&&A!=null){let U=A;Array.isArray(U)&&(U=U.map(b=>PD(b))),f(n,["safetySettings"],U)}const L=d(e,["tools"]);if(n!==void 0&&L!=null){let U=Qa(L);Array.isArray(U)&&(U=U.map(b=>VD(Ja(b)))),f(n,["tools"],U)}const q=d(e,["toolConfig"]);if(n!==void 0&&q!=null&&f(n,["toolConfig"],q),d(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const z=d(e,["cachedContent"]);n!==void 0&&z!=null&&f(n,["cachedContent"],di(t,z));const E=d(e,["responseModalities"]);E!=null&&f(r,["responseModalities"],E);const x=d(e,["mediaResolution"]);x!=null&&f(r,["mediaResolution"],x);const R=d(e,["speechConfig"]);if(R!=null&&f(r,["speechConfig"],g_(R)),d(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const N=d(e,["thinkingConfig"]);N!=null&&f(r,["thinkingConfig"],N);const M=d(e,["imageConfig"]);return M!=null&&f(r,["imageConfig"],M),r}function qb(t,e,n){const r={},i=d(e,["systemInstruction"]);n!==void 0&&i!=null&&f(n,["systemInstruction"],nn(i));const s=d(e,["temperature"]);s!=null&&f(r,["temperature"],s);const o=d(e,["topP"]);o!=null&&f(r,["topP"],o);const a=d(e,["topK"]);a!=null&&f(r,["topK"],a);const l=d(e,["candidateCount"]);l!=null&&f(r,["candidateCount"],l);const u=d(e,["maxOutputTokens"]);u!=null&&f(r,["maxOutputTokens"],u);const p=d(e,["stopSequences"]);p!=null&&f(r,["stopSequences"],p);const m=d(e,["responseLogprobs"]);m!=null&&f(r,["responseLogprobs"],m);const g=d(e,["logprobs"]);g!=null&&f(r,["logprobs"],g);const v=d(e,["presencePenalty"]);v!=null&&f(r,["presencePenalty"],v);const I=d(e,["frequencyPenalty"]);I!=null&&f(r,["frequencyPenalty"],I);const P=d(e,["seed"]);P!=null&&f(r,["seed"],P);const V=d(e,["responseMimeType"]);V!=null&&f(r,["responseMimeType"],V);const C=d(e,["responseSchema"]);C!=null&&f(r,["responseSchema"],m_(C));const S=d(e,["responseJsonSchema"]);S!=null&&f(r,["responseJsonSchema"],S);const A=d(e,["routingConfig"]);A!=null&&f(r,["routingConfig"],A);const L=d(e,["modelSelectionConfig"]);L!=null&&f(r,["modelConfig"],L);const q=d(e,["safetySettings"]);if(n!==void 0&&q!=null){let Ue=q;Array.isArray(Ue)&&(Ue=Ue.map(Ee=>Ee)),f(n,["safetySettings"],Ue)}const z=d(e,["tools"]);if(n!==void 0&&z!=null){let Ue=Qa(z);Array.isArray(Ue)&&(Ue=Ue.map(Ee=>Mx(Ja(Ee)))),f(n,["tools"],Ue)}const E=d(e,["toolConfig"]);n!==void 0&&E!=null&&f(n,["toolConfig"],E);const x=d(e,["labels"]);n!==void 0&&x!=null&&f(n,["labels"],x);const R=d(e,["cachedContent"]);n!==void 0&&R!=null&&f(n,["cachedContent"],di(t,R));const N=d(e,["responseModalities"]);N!=null&&f(r,["responseModalities"],N);const M=d(e,["mediaResolution"]);M!=null&&f(r,["mediaResolution"],M);const U=d(e,["speechConfig"]);U!=null&&f(r,["speechConfig"],Dx(g_(U)));const b=d(e,["audioTimestamp"]);b!=null&&f(r,["audioTimestamp"],b);const xe=d(e,["thinkingConfig"]);xe!=null&&f(r,["thinkingConfig"],xe);const Ye=d(e,["imageConfig"]);return Ye!=null&&f(r,["imageConfig"],Ye),r}function zT(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["_url","model"],Be(t,r));const i=d(e,["contents"]);if(i!=null){let o=Qn(i);Array.isArray(o)&&(o=o.map(a=>Yh(a))),f(n,["contents"],o)}const s=d(e,["config"]);return s!=null&&f(n,["generationConfig"],Gb(t,s,n)),n}function $T(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["_url","model"],Be(t,r));const i=d(e,["contents"]);if(i!=null){let o=Qn(i);Array.isArray(o)&&(o=o.map(a=>a)),f(n,["contents"],o)}const s=d(e,["config"]);return s!=null&&f(n,["generationConfig"],qb(t,s,n)),n}function jT(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["candidates"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(u=>hb(u))),f(e,["candidates"],l)}const i=d(t,["modelVersion"]);i!=null&&f(e,["modelVersion"],i);const s=d(t,["promptFeedback"]);s!=null&&f(e,["promptFeedback"],s);const o=d(t,["responseId"]);o!=null&&f(e,["responseId"],o);const a=d(t,["usageMetadata"]);return a!=null&&f(e,["usageMetadata"],a),e}function HT(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["candidates"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(p=>p)),f(e,["candidates"],u)}const i=d(t,["createTime"]);i!=null&&f(e,["createTime"],i);const s=d(t,["modelVersion"]);s!=null&&f(e,["modelVersion"],s);const o=d(t,["promptFeedback"]);o!=null&&f(e,["promptFeedback"],o);const a=d(t,["responseId"]);a!=null&&f(e,["responseId"],a);const l=d(t,["usageMetadata"]);return l!=null&&f(e,["usageMetadata"],l),e}function zb(t,e){const n={};if(d(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(d(t,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const r=d(t,["numberOfImages"]);e!==void 0&&r!=null&&f(e,["parameters","sampleCount"],r);const i=d(t,["aspectRatio"]);e!==void 0&&i!=null&&f(e,["parameters","aspectRatio"],i);const s=d(t,["guidanceScale"]);if(e!==void 0&&s!=null&&f(e,["parameters","guidanceScale"],s),d(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=d(t,["safetyFilterLevel"]);e!==void 0&&o!=null&&f(e,["parameters","safetySetting"],o);const a=d(t,["personGeneration"]);e!==void 0&&a!=null&&f(e,["parameters","personGeneration"],a);const l=d(t,["includeSafetyAttributes"]);e!==void 0&&l!=null&&f(e,["parameters","includeSafetyAttributes"],l);const u=d(t,["includeRaiReason"]);e!==void 0&&u!=null&&f(e,["parameters","includeRaiReason"],u);const p=d(t,["language"]);e!==void 0&&p!=null&&f(e,["parameters","language"],p);const m=d(t,["outputMimeType"]);e!==void 0&&m!=null&&f(e,["parameters","outputOptions","mimeType"],m);const g=d(t,["outputCompressionQuality"]);if(e!==void 0&&g!=null&&f(e,["parameters","outputOptions","compressionQuality"],g),d(t,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(d(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const v=d(t,["imageSize"]);if(e!==void 0&&v!=null&&f(e,["parameters","sampleImageSize"],v),d(t,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function $b(t,e){const n={},r=d(t,["outputGcsUri"]);e!==void 0&&r!=null&&f(e,["parameters","storageUri"],r);const i=d(t,["negativePrompt"]);e!==void 0&&i!=null&&f(e,["parameters","negativePrompt"],i);const s=d(t,["numberOfImages"]);e!==void 0&&s!=null&&f(e,["parameters","sampleCount"],s);const o=d(t,["aspectRatio"]);e!==void 0&&o!=null&&f(e,["parameters","aspectRatio"],o);const a=d(t,["guidanceScale"]);e!==void 0&&a!=null&&f(e,["parameters","guidanceScale"],a);const l=d(t,["seed"]);e!==void 0&&l!=null&&f(e,["parameters","seed"],l);const u=d(t,["safetyFilterLevel"]);e!==void 0&&u!=null&&f(e,["parameters","safetySetting"],u);const p=d(t,["personGeneration"]);e!==void 0&&p!=null&&f(e,["parameters","personGeneration"],p);const m=d(t,["includeSafetyAttributes"]);e!==void 0&&m!=null&&f(e,["parameters","includeSafetyAttributes"],m);const g=d(t,["includeRaiReason"]);e!==void 0&&g!=null&&f(e,["parameters","includeRaiReason"],g);const v=d(t,["language"]);e!==void 0&&v!=null&&f(e,["parameters","language"],v);const I=d(t,["outputMimeType"]);e!==void 0&&I!=null&&f(e,["parameters","outputOptions","mimeType"],I);const P=d(t,["outputCompressionQuality"]);e!==void 0&&P!=null&&f(e,["parameters","outputOptions","compressionQuality"],P);const V=d(t,["addWatermark"]);e!==void 0&&V!=null&&f(e,["parameters","addWatermark"],V);const C=d(t,["labels"]);e!==void 0&&C!=null&&f(e,["labels"],C);const S=d(t,["imageSize"]);e!==void 0&&S!=null&&f(e,["parameters","sampleImageSize"],S);const A=d(t,["enhancePrompt"]);return e!==void 0&&A!=null&&f(e,["parameters","enhancePrompt"],A),n}function jb(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["_url","model"],Be(t,r));const i=d(e,["prompt"]);i!=null&&f(n,["instances[0]","prompt"],i);const s=d(e,["config"]);return s!=null&&zb(s,n),n}function Hb(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["_url","model"],Be(t,r));const i=d(e,["prompt"]);i!=null&&f(n,["instances[0]","prompt"],i);const s=d(e,["config"]);return s!=null&&$b(s,n),n}function Wb(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>sD(o))),f(e,["generatedImages"],s)}const i=d(t,["positivePromptSafetyAttributes"]);return i!=null&&f(e,["positivePromptSafetyAttributes"],Nx(i)),e}function Kb(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>Xh(o))),f(e,["generatedImages"],s)}const i=d(t,["positivePromptSafetyAttributes"]);return i!=null&&f(e,["positivePromptSafetyAttributes"],bx(i)),e}function Jb(t,e){const n={},r=d(t,["numberOfVideos"]);if(e!==void 0&&r!=null&&f(e,["parameters","sampleCount"],r),d(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(d(t,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const i=d(t,["durationSeconds"]);if(e!==void 0&&i!=null&&f(e,["parameters","durationSeconds"],i),d(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const s=d(t,["aspectRatio"]);e!==void 0&&s!=null&&f(e,["parameters","aspectRatio"],s);const o=d(t,["resolution"]);e!==void 0&&o!=null&&f(e,["parameters","resolution"],o);const a=d(t,["personGeneration"]);if(e!==void 0&&a!=null&&f(e,["parameters","personGeneration"],a),d(t,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const l=d(t,["negativePrompt"]);e!==void 0&&l!=null&&f(e,["parameters","negativePrompt"],l);const u=d(t,["enhancePrompt"]);if(e!==void 0&&u!=null&&f(e,["parameters","enhancePrompt"],u),d(t,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const p=d(t,["lastFrame"]);e!==void 0&&p!=null&&f(e,["instances[0]","lastFrame"],Zh(p));const m=d(t,["referenceImages"]);if(e!==void 0&&m!=null){let g=m;Array.isArray(g)&&(g=g.map(v=>KD(v))),f(e,["instances[0]","referenceImages"],g)}if(d(t,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(d(t,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return n}function Qb(t,e){const n={},r=d(t,["numberOfVideos"]);e!==void 0&&r!=null&&f(e,["parameters","sampleCount"],r);const i=d(t,["outputGcsUri"]);e!==void 0&&i!=null&&f(e,["parameters","storageUri"],i);const s=d(t,["fps"]);e!==void 0&&s!=null&&f(e,["parameters","fps"],s);const o=d(t,["durationSeconds"]);e!==void 0&&o!=null&&f(e,["parameters","durationSeconds"],o);const a=d(t,["seed"]);e!==void 0&&a!=null&&f(e,["parameters","seed"],a);const l=d(t,["aspectRatio"]);e!==void 0&&l!=null&&f(e,["parameters","aspectRatio"],l);const u=d(t,["resolution"]);e!==void 0&&u!=null&&f(e,["parameters","resolution"],u);const p=d(t,["personGeneration"]);e!==void 0&&p!=null&&f(e,["parameters","personGeneration"],p);const m=d(t,["pubsubTopic"]);e!==void 0&&m!=null&&f(e,["parameters","pubsubTopic"],m);const g=d(t,["negativePrompt"]);e!==void 0&&g!=null&&f(e,["parameters","negativePrompt"],g);const v=d(t,["enhancePrompt"]);e!==void 0&&v!=null&&f(e,["parameters","enhancePrompt"],v);const I=d(t,["generateAudio"]);e!==void 0&&I!=null&&f(e,["parameters","generateAudio"],I);const P=d(t,["lastFrame"]);e!==void 0&&P!=null&&f(e,["instances[0]","lastFrame"],vr(P));const V=d(t,["referenceImages"]);if(e!==void 0&&V!=null){let A=V;Array.isArray(A)&&(A=A.map(L=>JD(L))),f(e,["instances[0]","referenceImages"],A)}const C=d(t,["mask"]);e!==void 0&&C!=null&&f(e,["instances[0]","mask"],WD(C));const S=d(t,["compressionQuality"]);return e!==void 0&&S!=null&&f(e,["parameters","compressionQuality"],S),n}function Yb(t){const e={},n=d(t,["name"]);n!=null&&f(e,["name"],n);const r=d(t,["metadata"]);r!=null&&f(e,["metadata"],r);const i=d(t,["done"]);i!=null&&f(e,["done"],i);const s=d(t,["error"]);s!=null&&f(e,["error"],s);const o=d(t,["response","generateVideoResponse"]);return o!=null&&f(e,["response"],tD(o)),e}function Xb(t){const e={},n=d(t,["name"]);n!=null&&f(e,["name"],n);const r=d(t,["metadata"]);r!=null&&f(e,["metadata"],r);const i=d(t,["done"]);i!=null&&f(e,["done"],i);const s=d(t,["error"]);s!=null&&f(e,["error"],s);const o=d(t,["response"]);return o!=null&&f(e,["response"],nD(o)),e}function Zb(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["_url","model"],Be(t,r));const i=d(e,["prompt"]);i!=null&&f(n,["instances[0]","prompt"],i);const s=d(e,["image"]);s!=null&&f(n,["instances[0]","image"],Zh(s));const o=d(e,["video"]);o!=null&&f(n,["instances[0]","video"],Vx(o));const a=d(e,["source"]);a!=null&&rD(a,n);const l=d(e,["config"]);return l!=null&&Jb(l,n),n}function eD(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["_url","model"],Be(t,r));const i=d(e,["prompt"]);i!=null&&f(n,["instances[0]","prompt"],i);const s=d(e,["image"]);s!=null&&f(n,["instances[0]","image"],vr(s));const o=d(e,["video"]);o!=null&&f(n,["instances[0]","video"],Lx(o));const a=d(e,["source"]);a!=null&&iD(a,n);const l=d(e,["config"]);return l!=null&&Qb(l,n),n}function tD(t){const e={},n=d(t,["generatedSamples"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>aD(o))),f(e,["generatedVideos"],s)}const r=d(t,["raiMediaFilteredCount"]);r!=null&&f(e,["raiMediaFilteredCount"],r);const i=d(t,["raiMediaFilteredReasons"]);return i!=null&&f(e,["raiMediaFilteredReasons"],i),e}function nD(t){const e={},n=d(t,["videos"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>lD(o))),f(e,["generatedVideos"],s)}const r=d(t,["raiMediaFilteredCount"]);r!=null&&f(e,["raiMediaFilteredCount"],r);const i=d(t,["raiMediaFilteredReasons"]);return i!=null&&f(e,["raiMediaFilteredReasons"],i),e}function rD(t,e){const n={},r=d(t,["prompt"]);e!==void 0&&r!=null&&f(e,["instances[0]","prompt"],r);const i=d(t,["image"]);e!==void 0&&i!=null&&f(e,["instances[0]","image"],Zh(i));const s=d(t,["video"]);return e!==void 0&&s!=null&&f(e,["instances[0]","video"],Vx(s)),n}function iD(t,e){const n={},r=d(t,["prompt"]);e!==void 0&&r!=null&&f(e,["instances[0]","prompt"],r);const i=d(t,["image"]);e!==void 0&&i!=null&&f(e,["instances[0]","image"],vr(i));const s=d(t,["video"]);return e!==void 0&&s!=null&&f(e,["instances[0]","video"],Lx(s)),n}function sD(t){const e={},n=d(t,["_self"]);n!=null&&f(e,["image"],pD(n));const r=d(t,["raiFilteredReason"]);r!=null&&f(e,["raiFilteredReason"],r);const i=d(t,["_self"]);return i!=null&&f(e,["safetyAttributes"],Nx(i)),e}function Xh(t){const e={},n=d(t,["_self"]);n!=null&&f(e,["image"],kx(n));const r=d(t,["raiFilteredReason"]);r!=null&&f(e,["raiFilteredReason"],r);const i=d(t,["_self"]);i!=null&&f(e,["safetyAttributes"],bx(i));const s=d(t,["prompt"]);return s!=null&&f(e,["enhancedPrompt"],s),e}function oD(t){const e={},n=d(t,["_self"]);n!=null&&f(e,["mask"],kx(n));const r=d(t,["labels"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>s)),f(e,["labels"],i)}return e}function aD(t){const e={},n=d(t,["video"]);return n!=null&&f(e,["video"],jD(n)),e}function lD(t){const e={},n=d(t,["_self"]);return n!=null&&f(e,["video"],HD(n)),e}function uD(t){const e={},n=d(t,["modelSelectionConfig"]);n!=null&&f(e,["modelConfig"],n);const r=d(t,["audioTimestamp"]);r!=null&&f(e,["audioTimestamp"],r);const i=d(t,["candidateCount"]);i!=null&&f(e,["candidateCount"],i);const s=d(t,["enableAffectiveDialog"]);s!=null&&f(e,["enableAffectiveDialog"],s);const o=d(t,["frequencyPenalty"]);o!=null&&f(e,["frequencyPenalty"],o);const a=d(t,["logprobs"]);a!=null&&f(e,["logprobs"],a);const l=d(t,["maxOutputTokens"]);l!=null&&f(e,["maxOutputTokens"],l);const u=d(t,["mediaResolution"]);u!=null&&f(e,["mediaResolution"],u);const p=d(t,["presencePenalty"]);p!=null&&f(e,["presencePenalty"],p);const m=d(t,["responseJsonSchema"]);m!=null&&f(e,["responseJsonSchema"],m);const g=d(t,["responseLogprobs"]);g!=null&&f(e,["responseLogprobs"],g);const v=d(t,["responseMimeType"]);v!=null&&f(e,["responseMimeType"],v);const I=d(t,["responseModalities"]);I!=null&&f(e,["responseModalities"],I);const P=d(t,["responseSchema"]);P!=null&&f(e,["responseSchema"],P);const V=d(t,["routingConfig"]);V!=null&&f(e,["routingConfig"],V);const C=d(t,["seed"]);C!=null&&f(e,["seed"],C);const S=d(t,["speechConfig"]);S!=null&&f(e,["speechConfig"],Dx(S));const A=d(t,["stopSequences"]);A!=null&&f(e,["stopSequences"],A);const L=d(t,["temperature"]);L!=null&&f(e,["temperature"],L);const q=d(t,["thinkingConfig"]);q!=null&&f(e,["thinkingConfig"],q);const z=d(t,["topK"]);z!=null&&f(e,["topK"],z);const E=d(t,["topP"]);if(E!=null&&f(e,["topP"],E),d(t,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function cD(t,e){const n={},r=d(e,["model"]);return r!=null&&f(n,["_url","name"],Be(t,r)),n}function dD(t,e){const n={},r=d(e,["model"]);return r!=null&&f(n,["_url","name"],Be(t,r)),n}function hD(t){const e={};if(d(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=d(t,["enableWidget"]);return n!=null&&f(e,["enableWidget"],n),e}function fD(t){const e={};if(d(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");const n=d(t,["timeRangeFilter"]);return n!=null&&f(e,["timeRangeFilter"],n),e}function pD(t){const e={},n=d(t,["bytesBase64Encoded"]);n!=null&&f(e,["imageBytes"],Ts(n));const r=d(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function kx(t){const e={},n=d(t,["gcsUri"]);n!=null&&f(e,["gcsUri"],n);const r=d(t,["bytesBase64Encoded"]);r!=null&&f(e,["imageBytes"],Ts(r));const i=d(t,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function Zh(t){const e={};if(d(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=d(t,["imageBytes"]);n!=null&&f(e,["bytesBase64Encoded"],Ts(n));const r=d(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function vr(t){const e={},n=d(t,["gcsUri"]);n!=null&&f(e,["gcsUri"],n);const r=d(t,["imageBytes"]);r!=null&&f(e,["bytesBase64Encoded"],Ts(r));const i=d(t,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function mD(t,e,n){const r={},i=d(e,["pageSize"]);n!==void 0&&i!=null&&f(n,["_query","pageSize"],i);const s=d(e,["pageToken"]);n!==void 0&&s!=null&&f(n,["_query","pageToken"],s);const o=d(e,["filter"]);n!==void 0&&o!=null&&f(n,["_query","filter"],o);const a=d(e,["queryBase"]);return n!==void 0&&a!=null&&f(n,["_url","models_url"],wx(t,a)),r}function gD(t,e,n){const r={},i=d(e,["pageSize"]);n!==void 0&&i!=null&&f(n,["_query","pageSize"],i);const s=d(e,["pageToken"]);n!==void 0&&s!=null&&f(n,["_query","pageToken"],s);const o=d(e,["filter"]);n!==void 0&&o!=null&&f(n,["_query","filter"],o);const a=d(e,["queryBase"]);return n!==void 0&&a!=null&&f(n,["_url","models_url"],wx(t,a)),r}function _D(t,e){const n={},r=d(e,["config"]);return r!=null&&mD(t,r,n),n}function yD(t,e){const n={},r=d(e,["config"]);return r!=null&&gD(t,r,n),n}function vD(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const i=d(t,["_self"]);if(i!=null){let s=Ix(i);Array.isArray(s)&&(s=s.map(o=>km(o))),f(e,["models"],s)}return e}function TD(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const i=d(t,["_self"]);if(i!=null){let s=Ix(i);Array.isArray(s)&&(s=s.map(o=>Nm(o))),f(e,["models"],s)}return e}function ED(t){const e={},n=d(t,["maskMode"]);n!=null&&f(e,["maskMode"],n);const r=d(t,["segmentationClasses"]);r!=null&&f(e,["maskClasses"],r);const i=d(t,["maskDilation"]);return i!=null&&f(e,["dilation"],i),e}function km(t){const e={},n=d(t,["name"]);n!=null&&f(e,["name"],n);const r=d(t,["displayName"]);r!=null&&f(e,["displayName"],r);const i=d(t,["description"]);i!=null&&f(e,["description"],i);const s=d(t,["version"]);s!=null&&f(e,["version"],s);const o=d(t,["_self"]);o!=null&&f(e,["tunedModelInfo"],LD(o));const a=d(t,["inputTokenLimit"]);a!=null&&f(e,["inputTokenLimit"],a);const l=d(t,["outputTokenLimit"]);l!=null&&f(e,["outputTokenLimit"],l);const u=d(t,["supportedGenerationMethods"]);return u!=null&&f(e,["supportedActions"],u),e}function Nm(t){const e={},n=d(t,["name"]);n!=null&&f(e,["name"],n);const r=d(t,["displayName"]);r!=null&&f(e,["displayName"],r);const i=d(t,["description"]);i!=null&&f(e,["description"],i);const s=d(t,["versionId"]);s!=null&&f(e,["version"],s);const o=d(t,["deployedModels"]);if(o!=null){let m=o;Array.isArray(m)&&(m=m.map(g=>Ub(g))),f(e,["endpoints"],m)}const a=d(t,["labels"]);a!=null&&f(e,["labels"],a);const l=d(t,["_self"]);l!=null&&f(e,["tunedModelInfo"],FD(l));const u=d(t,["defaultCheckpointId"]);u!=null&&f(e,["defaultCheckpointId"],u);const p=d(t,["checkpoints"]);if(p!=null){let m=p;Array.isArray(m)&&(m=m.map(g=>g)),f(e,["checkpoints"],m)}return e}function wD(t){const e={},n=d(t,["functionCall"]);n!=null&&f(e,["functionCall"],n);const r=d(t,["codeExecutionResult"]);r!=null&&f(e,["codeExecutionResult"],r);const i=d(t,["executableCode"]);i!=null&&f(e,["executableCode"],i);const s=d(t,["fileData"]);s!=null&&f(e,["fileData"],Ob(s));const o=d(t,["functionResponse"]);o!=null&&f(e,["functionResponse"],o);const a=d(t,["inlineData"]);a!=null&&f(e,["inlineData"],db(a));const l=d(t,["text"]);l!=null&&f(e,["text"],l);const u=d(t,["thought"]);u!=null&&f(e,["thought"],u);const p=d(t,["thoughtSignature"]);p!=null&&f(e,["thoughtSignature"],p);const m=d(t,["videoMetadata"]);return m!=null&&f(e,["videoMetadata"],m),e}function ID(t){const e={},n=d(t,["productImage"]);return n!=null&&f(e,["image"],vr(n)),e}function SD(t,e){const n={},r=d(t,["numberOfImages"]);e!==void 0&&r!=null&&f(e,["parameters","sampleCount"],r);const i=d(t,["baseSteps"]);e!==void 0&&i!=null&&f(e,["parameters","editConfig","baseSteps"],i);const s=d(t,["outputGcsUri"]);e!==void 0&&s!=null&&f(e,["parameters","storageUri"],s);const o=d(t,["seed"]);e!==void 0&&o!=null&&f(e,["parameters","seed"],o);const a=d(t,["safetyFilterLevel"]);e!==void 0&&a!=null&&f(e,["parameters","safetySetting"],a);const l=d(t,["personGeneration"]);e!==void 0&&l!=null&&f(e,["parameters","personGeneration"],l);const u=d(t,["addWatermark"]);e!==void 0&&u!=null&&f(e,["parameters","addWatermark"],u);const p=d(t,["outputMimeType"]);e!==void 0&&p!=null&&f(e,["parameters","outputOptions","mimeType"],p);const m=d(t,["outputCompressionQuality"]);e!==void 0&&m!=null&&f(e,["parameters","outputOptions","compressionQuality"],m);const g=d(t,["enhancePrompt"]);e!==void 0&&g!=null&&f(e,["parameters","enhancePrompt"],g);const v=d(t,["labels"]);return e!==void 0&&v!=null&&f(e,["labels"],v),n}function xD(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["_url","model"],Be(t,r));const i=d(e,["source"]);i!=null&&AD(i,n);const s=d(e,["config"]);return s!=null&&SD(s,n),n}function CD(t){const e={},n=d(t,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>Xh(i))),f(e,["generatedImages"],r)}return e}function AD(t,e){const n={},r=d(t,["prompt"]);e!==void 0&&r!=null&&f(e,["instances[0]","prompt"],r);const i=d(t,["personImage"]);e!==void 0&&i!=null&&f(e,["instances[0]","personImage","image"],vr(i));const s=d(t,["productImages"]);if(e!==void 0&&s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>ID(a))),f(e,["instances[0]","productImages"],o)}return n}function RD(t){const e={},n=d(t,["referenceImage"]);n!=null&&f(e,["referenceImage"],vr(n));const r=d(t,["referenceId"]);r!=null&&f(e,["referenceId"],r);const i=d(t,["referenceType"]);i!=null&&f(e,["referenceType"],i);const s=d(t,["maskImageConfig"]);s!=null&&f(e,["maskImageConfig"],ED(s));const o=d(t,["controlImageConfig"]);o!=null&&f(e,["controlImageConfig"],yb(o));const a=d(t,["styleImageConfig"]);a!=null&&f(e,["styleImageConfig"],a);const l=d(t,["subjectImageConfig"]);return l!=null&&f(e,["subjectImageConfig"],l),e}function Nx(t){const e={},n=d(t,["safetyAttributes","categories"]);n!=null&&f(e,["categories"],n);const r=d(t,["safetyAttributes","scores"]);r!=null&&f(e,["scores"],r);const i=d(t,["contentType"]);return i!=null&&f(e,["contentType"],i),e}function bx(t){const e={},n=d(t,["safetyAttributes","categories"]);n!=null&&f(e,["categories"],n);const r=d(t,["safetyAttributes","scores"]);r!=null&&f(e,["scores"],r);const i=d(t,["contentType"]);return i!=null&&f(e,["contentType"],i),e}function PD(t){const e={},n=d(t,["category"]);if(n!=null&&f(e,["category"],n),d(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=d(t,["threshold"]);return r!=null&&f(e,["threshold"],r),e}function kD(t){const e={},n=d(t,["image"]);return n!=null&&f(e,["image"],vr(n)),e}function ND(t,e){const n={},r=d(t,["mode"]);e!==void 0&&r!=null&&f(e,["parameters","mode"],r);const i=d(t,["maxPredictions"]);e!==void 0&&i!=null&&f(e,["parameters","maxPredictions"],i);const s=d(t,["confidenceThreshold"]);e!==void 0&&s!=null&&f(e,["parameters","confidenceThreshold"],s);const o=d(t,["maskDilation"]);e!==void 0&&o!=null&&f(e,["parameters","maskDilation"],o);const a=d(t,["binaryColorThreshold"]);e!==void 0&&a!=null&&f(e,["parameters","binaryColorThreshold"],a);const l=d(t,["labels"]);return e!==void 0&&l!=null&&f(e,["labels"],l),n}function bD(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["_url","model"],Be(t,r));const i=d(e,["source"]);i!=null&&MD(i,n);const s=d(e,["config"]);return s!=null&&ND(s,n),n}function DD(t){const e={},n=d(t,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>oD(i))),f(e,["generatedMasks"],r)}return e}function MD(t,e){const n={},r=d(t,["prompt"]);e!==void 0&&r!=null&&f(e,["instances[0]","prompt"],r);const i=d(t,["image"]);e!==void 0&&i!=null&&f(e,["instances[0]","image"],vr(i));const s=d(t,["scribbleImage"]);return e!==void 0&&s!=null&&f(e,["instances[0]","scribble"],kD(s)),n}function Dx(t){const e={},n=d(t,["languageCode"]);n!=null&&f(e,["languageCode"],n);const r=d(t,["voiceConfig"]);if(r!=null&&f(e,["voiceConfig"],r),d(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return e}function VD(t){const e={},n=d(t,["functionDeclarations"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(p=>p)),f(e,["functionDeclarations"],u)}if(d(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=d(t,["googleSearchRetrieval"]);r!=null&&f(e,["googleSearchRetrieval"],r);const i=d(t,["googleMaps"]);i!=null&&f(e,["googleMaps"],hD(i));const s=d(t,["computerUse"]);s!=null&&f(e,["computerUse"],s);const o=d(t,["codeExecution"]);if(o!=null&&f(e,["codeExecution"],o),d(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=d(t,["googleSearch"]);a!=null&&f(e,["googleSearch"],fD(a));const l=d(t,["urlContext"]);return l!=null&&f(e,["urlContext"],l),e}function Mx(t){const e={},n=d(t,["functionDeclarations"]);if(n!=null){let m=n;Array.isArray(m)&&(m=m.map(g=>Bb(g))),f(e,["functionDeclarations"],m)}const r=d(t,["retrieval"]);r!=null&&f(e,["retrieval"],r);const i=d(t,["googleSearchRetrieval"]);i!=null&&f(e,["googleSearchRetrieval"],i);const s=d(t,["googleMaps"]);s!=null&&f(e,["googleMaps"],s);const o=d(t,["computerUse"]);o!=null&&f(e,["computerUse"],o);const a=d(t,["codeExecution"]);a!=null&&f(e,["codeExecution"],a);const l=d(t,["enterpriseWebSearch"]);l!=null&&f(e,["enterpriseWebSearch"],l);const u=d(t,["googleSearch"]);u!=null&&f(e,["googleSearch"],u);const p=d(t,["urlContext"]);return p!=null&&f(e,["urlContext"],p),e}function LD(t){const e={},n=d(t,["baseModel"]);n!=null&&f(e,["baseModel"],n);const r=d(t,["createTime"]);r!=null&&f(e,["createTime"],r);const i=d(t,["updateTime"]);return i!=null&&f(e,["updateTime"],i),e}function FD(t){const e={},n=d(t,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&f(e,["baseModel"],n);const r=d(t,["createTime"]);r!=null&&f(e,["createTime"],r);const i=d(t,["updateTime"]);return i!=null&&f(e,["updateTime"],i),e}function UD(t,e){const n={},r=d(t,["displayName"]);e!==void 0&&r!=null&&f(e,["displayName"],r);const i=d(t,["description"]);e!==void 0&&i!=null&&f(e,["description"],i);const s=d(t,["defaultCheckpointId"]);return e!==void 0&&s!=null&&f(e,["defaultCheckpointId"],s),n}function OD(t,e){const n={},r=d(t,["displayName"]);e!==void 0&&r!=null&&f(e,["displayName"],r);const i=d(t,["description"]);e!==void 0&&i!=null&&f(e,["description"],i);const s=d(t,["defaultCheckpointId"]);return e!==void 0&&s!=null&&f(e,["defaultCheckpointId"],s),n}function BD(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["_url","name"],Be(t,r));const i=d(e,["config"]);return i!=null&&UD(i,n),n}function GD(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["_url","model"],Be(t,r));const i=d(e,["config"]);return i!=null&&OD(i,n),n}function qD(t,e){const n={},r=d(t,["outputGcsUri"]);e!==void 0&&r!=null&&f(e,["parameters","storageUri"],r);const i=d(t,["safetyFilterLevel"]);e!==void 0&&i!=null&&f(e,["parameters","safetySetting"],i);const s=d(t,["personGeneration"]);e!==void 0&&s!=null&&f(e,["parameters","personGeneration"],s);const o=d(t,["includeRaiReason"]);e!==void 0&&o!=null&&f(e,["parameters","includeRaiReason"],o);const a=d(t,["outputMimeType"]);e!==void 0&&a!=null&&f(e,["parameters","outputOptions","mimeType"],a);const l=d(t,["outputCompressionQuality"]);e!==void 0&&l!=null&&f(e,["parameters","outputOptions","compressionQuality"],l);const u=d(t,["enhanceInputImage"]);e!==void 0&&u!=null&&f(e,["parameters","upscaleConfig","enhanceInputImage"],u);const p=d(t,["imagePreservationFactor"]);e!==void 0&&p!=null&&f(e,["parameters","upscaleConfig","imagePreservationFactor"],p);const m=d(t,["labels"]);e!==void 0&&m!=null&&f(e,["labels"],m);const g=d(t,["numberOfImages"]);e!==void 0&&g!=null&&f(e,["parameters","sampleCount"],g);const v=d(t,["mode"]);return e!==void 0&&v!=null&&f(e,["parameters","mode"],v),n}function zD(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["_url","model"],Be(t,r));const i=d(e,["image"]);i!=null&&f(n,["instances[0]","image"],vr(i));const s=d(e,["upscaleFactor"]);s!=null&&f(n,["parameters","upscaleConfig","upscaleFactor"],s);const o=d(e,["config"]);return o!=null&&qD(o,n),n}function $D(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>Xh(s))),f(e,["generatedImages"],i)}return e}function jD(t){const e={},n=d(t,["uri"]);n!=null&&f(e,["uri"],n);const r=d(t,["encodedVideo"]);r!=null&&f(e,["videoBytes"],Ts(r));const i=d(t,["encoding"]);return i!=null&&f(e,["mimeType"],i),e}function HD(t){const e={},n=d(t,["gcsUri"]);n!=null&&f(e,["uri"],n);const r=d(t,["bytesBase64Encoded"]);r!=null&&f(e,["videoBytes"],Ts(r));const i=d(t,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function WD(t){const e={},n=d(t,["image"]);n!=null&&f(e,["_self"],vr(n));const r=d(t,["maskMode"]);return r!=null&&f(e,["maskMode"],r),e}function KD(t){const e={},n=d(t,["image"]);n!=null&&f(e,["image"],Zh(n));const r=d(t,["referenceType"]);return r!=null&&f(e,["referenceType"],r),e}function JD(t){const e={},n=d(t,["image"]);n!=null&&f(e,["image"],vr(n));const r=d(t,["referenceType"]);return r!=null&&f(e,["referenceType"],r),e}function Vx(t){const e={},n=d(t,["uri"]);n!=null&&f(e,["uri"],n);const r=d(t,["videoBytes"]);r!=null&&f(e,["encodedVideo"],Ts(r));const i=d(t,["mimeType"]);return i!=null&&f(e,["encoding"],i),e}function Lx(t){const e={},n=d(t,["uri"]);n!=null&&f(e,["gcsUri"],n);const r=d(t,["videoBytes"]);r!=null&&f(e,["bytesBase64Encoded"],Ts(r));const i=d(t,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const QD="Content-Type",YD="X-Server-Timeout",XD="User-Agent",bm="x-goog-api-client",ZD="1.28.0",eM=`google-genai-sdk/${ZD}`,tM="v1beta1",nM="v1beta",WT=/^\s*data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class rM{constructor(e){var n,r;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const i={};this.clientOptions.vertexai?(i.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:tM,i.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(i.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:nM,i.baseUrl="https://generativelanguage.googleapis.com/"),i.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=i,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(i,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&r.push(e.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),n=new URL(e);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,n,r){const i=[this.getRequestUrlInternal(n)];return r&&i.push(this.getBaseResourcePath()),e!==""&&i.push(e),new URL(`${i.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,n,r);if(e.queryParams)for(const[o,a]of Object.entries(e.queryParams))i.searchParams.append(o,String(a));let s={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else s.body=e.body;return s=await this.includeExtraHttpOptionsToRequestInit(s,n,i.toString(),e.abortSignal),this.unaryApiCall(i,s,e.httpMethod)}patchHttpOptions(e,n){const r=JSON.parse(JSON.stringify(e));for(const[i,s]of Object.entries(n))typeof s=="object"?r[i]=Object.assign(Object.assign({},r[i]),s):s!==void 0&&(r[i]=s);return r}async requestStream(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,n,r);(!i.searchParams.has("alt")||i.searchParams.get("alt")!=="sse")&&i.searchParams.set("alt","sse");let s={};return s.body=e.body,s=await this.includeExtraHttpOptionsToRequestInit(s,n,i.toString(),e.abortSignal),this.streamApiCall(i,s,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,n,r,i){if(n&&n.timeout||i){const s=new AbortController,o=s.signal;if(n.timeout&&(n==null?void 0:n.timeout)>0){const a=setTimeout(()=>s.abort(),n.timeout);a&&typeof a.unref=="function"&&a.unref()}i&&i.addEventListener("abort",()=>{s.abort()}),e.signal=o}return n&&n.extraBody!==null&&iM(e,n.extraBody),e.headers=await this.getHeadersInternal(n,r),e}async unaryApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async i=>(await KT(i),new Am(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}async streamApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async i=>(await KT(i),this.processStreamResponse(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}processStreamResponse(e){var n;return ga(this,arguments,function*(){const i=(n=e==null?void 0:e.body)===null||n===void 0?void 0:n.getReader(),s=new TextDecoder("utf-8");if(!i)throw new Error("Response body is empty");try{let o="";for(;;){const{done:a,value:l}=yield ot(i.read());if(a){if(o.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const u=s.decode(l,{stream:!0});try{const m=JSON.parse(u);if("error"in m){const g=JSON.parse(JSON.stringify(m.error)),v=g.status,I=g.code,P=`got status: ${v}. ${JSON.stringify(m)}`;if(I>=400&&I<600)throw new Qh({message:P,status:I})}}catch(m){if(m.name==="ApiError")throw m}o+=u;let p=o.match(WT);for(;p;){const m=p[1];try{const g=new Response(m,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield ot(new Am(g)),o=o.slice(p[0].length),p=o.match(WT)}catch(g){throw new Error(`exception parsing stream chunk ${m}. ${g}`)}}}}finally{i.releaseLock()}})}async apiCall(e,n){return fetch(e,n).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const e={},n=eM+" "+this.clientOptions.userAgentExtra;return e[XD]=n,e[bm]=n,e[QD]="application/json",e}async getHeadersInternal(e,n){const r=new Headers;if(e&&e.headers){for(const[i,s]of Object.entries(e.headers))r.append(i,s);e.timeout&&e.timeout>0&&r.append(YD,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(r,n),r}async uploadFile(e,n){var r,i;const s={};n!=null&&(s.mimeType=n.mimeType,s.name=n.name,s.displayName=n.displayName),s.name&&!s.name.startsWith("files/")&&(s.name=`files/${s.name}`);const o=this.clientOptions.uploader,a=await o.stat(e);s.sizeBytes=String(a.size);const l=(r=n==null?void 0:n.mimeType)!==null&&r!==void 0?r:a.type;if(l===void 0||l==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");s.mimeType=l;let u="";typeof e=="string"&&(u=e.replace(/[/\\]+$/,""),u=(i=u.split(/[/\\]/).pop())!==null&&i!==void 0?i:"");const p=await this.fetchUploadUrl(s,u,n);return o.upload(e,p,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,n,r){var i;let s={};r!=null&&r.httpOptions?s=r.httpOptions:s={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`},n?{"X-Goog-Upload-File-Name":n}:{})};const o={file:e},a=await this.request({path:ce("upload/v1beta/files",o._url),body:JSON.stringify(o),httpMethod:"POST",httpOptions:s});if(!a||!(a!=null&&a.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const l=(i=a==null?void 0:a.headers)===null||i===void 0?void 0:i["x-goog-upload-url"];if(l===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return l}}async function KT(t){var e;if(t===void 0)throw new Error("response is undefined");if(!t.ok){const n=t.status;let r;!((e=t.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?r=await t.json():r={error:{message:await t.text(),code:t.status,status:t.statusText}};const i=JSON.stringify(r);throw n>=400&&n<600?new Qh({message:i,status:n}):new Error(i)}}function iM(t,e){if(!e||Object.keys(e).length===0)return;if(t.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let n={};if(typeof t.body=="string"&&t.body.length>0)try{const s=JSON.parse(t.body);if(typeof s=="object"&&s!==null&&!Array.isArray(s))n=s;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function r(s,o){const a=Object.assign({},s);for(const l in o)if(Object.prototype.hasOwnProperty.call(o,l)){const u=o[l],p=a[l];u&&typeof u=="object"&&!Array.isArray(u)&&p&&typeof p=="object"&&!Array.isArray(p)?a[l]=r(p,u):(p&&u&&typeof p!=typeof u&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${l}". Original type: ${typeof p}, New type: ${typeof u}. Overwriting.`),a[l]=u)}return a}const i=r(n,e);t.body=JSON.stringify(i)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const sM="mcp_used/unknown";let oM=!1;function Fx(t){for(const e of t)if(aM(e)||typeof e=="object"&&"inputSchema"in e)return!0;return oM}function Ux(t){var e;const n=(e=t[bm])!==null&&e!==void 0?e:"";t[bm]=(n+` ${sM}`).trimStart()}function aM(t){return t!==null&&typeof t=="object"&&t instanceof y_}function lM(t,e=100){return ga(this,arguments,function*(){let r,i=0;for(;i<e;){const s=yield ot(t.listTools({cursor:r}));for(const o of s.tools)yield yield ot(o),i++;if(!s.nextCursor)break;r=s.nextCursor}})}class y_{constructor(e=[],n){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=n}static create(e,n){return new y_(e,n)}async initialize(){var e,n,r,i;if(this.mcpTools.length>0)return;const s={},o=[];for(const p of this.mcpClients)try{for(var a=!0,l=(n=void 0,eu(lM(p))),u;u=await l.next(),e=u.done,!e;a=!0){i=u.value,a=!1;const m=i;o.push(m);const g=m.name;if(s[g])throw new Error(`Duplicate function name ${g} found in MCP tools. Please ensure function names are unique.`);s[g]=p}}catch(m){n={error:m}}finally{try{!a&&!e&&(r=l.return)&&await r.call(l)}finally{if(n)throw n.error}}this.mcpTools=o,this.functionNameToMcpClient=s}async tool(){return await this.initialize(),f1(this.mcpTools,this.config)}async callTool(e){await this.initialize();const n=[];for(const r of e)if(r.name in this.functionNameToMcpClient){const i=this.functionNameToMcpClient[r.name];let s;this.config.timeout&&(s={timeout:this.config.timeout});const o=await i.callTool({name:r.name,arguments:r.args},void 0,s);n.push({functionResponse:{name:r.name,response:o.isError?{error:o}:o}})}return n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function uM(t,e,n){const r=new s1;let i;n.data instanceof Blob?i=JSON.parse(await n.data.text()):i=JSON.parse(n.data),Object.assign(r,i),e(r)}class cM{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r}async connect(e){var n,r;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const i=this.apiClient.getWebsocketBaseUrl(),s=this.apiClient.getApiVersion(),o=fM(this.apiClient.getDefaultHeaders()),a=this.apiClient.getApiKey(),l=`${i}/ws/google.ai.generativelanguage.${s}.GenerativeService.BidiGenerateMusic?key=${a}`;let u=()=>{};const p=new Promise(A=>{u=A}),m=e.callbacks,g=function(){u({})},v=this.apiClient,I={onopen:g,onmessage:A=>{uM(v,m.onmessage,A)},onerror:(n=m==null?void 0:m.onerror)!==null&&n!==void 0?n:function(A){},onclose:(r=m==null?void 0:m.onclose)!==null&&r!==void 0?r:function(A){}},P=this.webSocketFactory.create(l,hM(o),I);P.connect(),await p;const S={setup:{model:Be(this.apiClient,e.model)}};return P.send(JSON.stringify(S)),new dM(P,this.apiClient)}}class dM{constructor(e,n){this.conn=e,this.apiClient=n}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const n=nb(e);this.conn.send(JSON.stringify({clientContent:n}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const n=tb(e);this.conn.send(JSON.stringify(n))}sendPlaybackControl(e){const n={playbackControl:e};this.conn.send(JSON.stringify(n))}play(){this.sendPlaybackControl(aa.PLAY)}pause(){this.sendPlaybackControl(aa.PAUSE)}stop(){this.sendPlaybackControl(aa.STOP)}resetContext(){this.sendPlaybackControl(aa.RESET_CONTEXT)}close(){this.conn.close()}}function hM(t){const e={};return t.forEach((n,r)=>{e[r]=n}),e}function fM(t){const e=new Headers;for(const[n,r]of Object.entries(t))e.append(n,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const pM="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function mM(t,e,n){const r=new i1;let i;n.data instanceof Blob?i=await n.data.text():n.data instanceof ArrayBuffer?i=new TextDecoder().decode(n.data):i=n.data;const s=JSON.parse(i);if(t.isVertexAI()){const o=sb(s);Object.assign(r,o)}else Object.assign(r,s);e(r)}class gM{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r,this.music=new cM(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var n,r,i,s,o,a;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const l=this.apiClient.getWebsocketBaseUrl(),u=this.apiClient.getApiVersion();let p;const m=this.apiClient.getHeaders();e.config&&e.config.tools&&Fx(e.config.tools)&&Ux(m);const g=TM(m);if(this.apiClient.isVertexAI())p=`${l}/ws/google.cloud.aiplatform.${u}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(g,p);else{const R=this.apiClient.getApiKey();let N="BidiGenerateContent",M="key";R!=null&&R.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),u!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),N="BidiGenerateContentConstrained",M="access_token"),p=`${l}/ws/google.ai.generativelanguage.${u}.GenerativeService.${N}?${M}=${R}`}let v=()=>{};const I=new Promise(R=>{v=R}),P=e.callbacks,V=function(){var R;(R=P==null?void 0:P.onopen)===null||R===void 0||R.call(P),v({})},C=this.apiClient,S={onopen:V,onmessage:R=>{mM(C,P.onmessage,R)},onerror:(n=P==null?void 0:P.onerror)!==null&&n!==void 0?n:function(R){},onclose:(r=P==null?void 0:P.onclose)!==null&&r!==void 0?r:function(R){}},A=this.webSocketFactory.create(p,vM(g),S);A.connect(),await I;let L=Be(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&L.startsWith("publishers/")){const R=this.apiClient.getProject(),N=this.apiClient.getLocation();L=`projects/${R}/locations/${N}/`+L}let q={};this.apiClient.isVertexAI()&&((i=e.config)===null||i===void 0?void 0:i.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[sh.AUDIO]}:e.config.responseModalities=[sh.AUDIO]),!((s=e.config)===null||s===void 0)&&s.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const z=(a=(o=e.config)===null||o===void 0?void 0:o.tools)!==null&&a!==void 0?a:[],E=[];for(const R of z)if(this.isCallableTool(R)){const N=R;E.push(await N.tool())}else E.push(R);E.length>0&&(e.config.tools=E);const x={model:L,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?q=eb(this.apiClient,x):q=ZN(this.apiClient,x),delete q.config,A.send(JSON.stringify(q)),new yM(A,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const _M={turnComplete:!0};class yM{constructor(e,n){this.conn=e,this.apiClient=n}tLiveClientContent(e,n){if(n.turns!==null&&n.turns!==void 0){let r=[];try{r=Qn(n.turns),e.isVertexAI()||(r=r.map(i=>Yh(i)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:r,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(e,n){let r=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?r=n.functionResponses:r=[n.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const s of r){if(typeof s!="object"||s===null||!("name"in s)||!("response"in s))throw new Error(`Could not parse function response, type '${typeof s}'.`);if(!e.isVertexAI()&&!("id"in s))throw new Error(pM)}return{toolResponse:{functionResponses:r}}}sendClientContent(e){e=Object.assign(Object.assign({},_M),e);const n=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(n))}sendRealtimeInput(e){let n={};this.apiClient.isVertexAI()?n={realtimeInput:ib(e)}:n={realtimeInput:rb(e)},this.conn.send(JSON.stringify(n))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function vM(t){const e={};return t.forEach((n,r)=>{e[r]=n}),e}function TM(t){const e=new Headers;for(const[n,r]of Object.entries(t))e.append(n,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const JT=10;function QT(t){var e,n,r;if(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let i=!1;for(const o of(n=t==null?void 0:t.tools)!==null&&n!==void 0?n:[])if(_a(o)){i=!0;break}if(!i)return!0;const s=(r=t==null?void 0:t.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls;return s&&(s<0||!Number.isInteger(s))||s==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",s),!0):!1}function _a(t){return"callTool"in t&&typeof t.callTool=="function"}function EM(t){var e,n,r;return(r=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(i=>_a(i)))!==null&&r!==void 0?r:!1}function wM(t){var e,n,r;return(r=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(i=>!_a(i)))!==null&&r!==void 0?r:!1}function YT(t){var e;return!(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class IM extends Eo{constructor(e){super(),this.apiClient=e,this.generateContent=async n=>{var r,i,s,o,a;const l=await this.processParamsMaybeAddMcpUsage(n);if(this.maybeMoveToResponseJsonSchem(n),!EM(n)||QT(n.config))return await this.generateContentInternal(l);if(wM(n))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");let u,p;const m=Qn(l.contents),g=(s=(i=(r=l.config)===null||r===void 0?void 0:r.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&s!==void 0?s:JT;let v=0;for(;v<g&&(u=await this.generateContentInternal(l),!(!u.functionCalls||u.functionCalls.length===0));){const I=u.candidates[0].content,P=[];for(const V of(a=(o=n.config)===null||o===void 0?void 0:o.tools)!==null&&a!==void 0?a:[])if(_a(V)){const S=await V.callTool(u.functionCalls);P.push(...S)}v++,p={role:"user",parts:P},l.contents=Qn(l.contents),l.contents.push(I),l.contents.push(p),YT(l.config)&&(m.push(I),m.push(p))}return YT(l.config)&&(u.automaticFunctionCallingHistory=m),u},this.generateContentStream=async n=>{if(this.maybeMoveToResponseJsonSchem(n),QT(n.config)){const r=await this.processParamsMaybeAddMcpUsage(n);return await this.generateContentStreamInternal(r)}else return await this.processAfcStream(n)},this.generateImages=async n=>await this.generateImagesInternal(n).then(r=>{var i;let s;const o=[];if(r!=null&&r.generatedImages)for(const l of r.generatedImages)l&&(l!=null&&l.safetyAttributes)&&((i=l==null?void 0:l.safetyAttributes)===null||i===void 0?void 0:i.contentType)==="Positive Prompt"?s=l==null?void 0:l.safetyAttributes:o.push(l);let a;return s?a={generatedImages:o,positivePromptSafetyAttributes:s,sdkHttpResponse:r.sdkHttpResponse}:a={generatedImages:o,sdkHttpResponse:r.sdkHttpResponse},a}),this.list=async n=>{var r;const o={config:Object.assign(Object.assign({},{queryBase:!0}),n==null?void 0:n.config)};if(this.apiClient.isVertexAI()&&!o.config.queryBase){if(!((r=o.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");o.config.filter="labels.tune-type:*"}return new Ju(uo.PAGED_ITEM_MODELS,a=>this.listInternal(a),await this.listInternal(o),o)},this.editImage=async n=>{const r={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(r.referenceImages=n.referenceImages.map(i=>i.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async n=>{let r={numberOfImages:1,mode:"upscale"};n.config&&(r=Object.assign(Object.assign({},r),n.config));const i={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:r};return await this.upscaleImageInternal(i)},this.generateVideos=async n=>{var r,i,s,o,a,l;if((n.prompt||n.image||n.video)&&n.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((r=n.video)===null||r===void 0)&&r.uri&&(!((i=n.video)===null||i===void 0)&&i.videoBytes)?n.video={uri:n.video.uri,mimeType:n.video.mimeType}:!((o=(s=n.source)===null||s===void 0?void 0:s.video)===null||o===void 0)&&o.uri&&(!((l=(a=n.source)===null||a===void 0?void 0:a.video)===null||l===void 0)&&l.videoBytes)&&(n.source.video={uri:n.source.video.uri,mimeType:n.source.video.mimeType})),await this.generateVideosInternal(n)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var n,r,i;const s=(n=e.config)===null||n===void 0?void 0:n.tools;if(!s)return e;const o=await Promise.all(s.map(async l=>_a(l)?await l.tool():l)),a={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:o})};if(a.config.tools=o,e.config&&e.config.tools&&Fx(e.config.tools)){const l=(i=(r=e.config.httpOptions)===null||r===void 0?void 0:r.headers)!==null&&i!==void 0?i:{};let u=Object.assign({},l);Object.keys(u).length===0&&(u=this.apiClient.getDefaultHeaders()),Ux(u),a.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:u})}return a}async initAfcToolsMap(e){var n,r,i;const s=new Map;for(const o of(r=(n=e.config)===null||n===void 0?void 0:n.tools)!==null&&r!==void 0?r:[])if(_a(o)){const a=o,l=await a.tool();for(const u of(i=l.functionDeclarations)!==null&&i!==void 0?i:[]){if(!u.name)throw new Error("Function declaration name is required.");if(s.has(u.name))throw new Error(`Duplicate tool declaration name: ${u.name}`);s.set(u.name,a)}}return s}async processAfcStream(e){var n,r,i;const s=(i=(r=(n=e.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&i!==void 0?i:JT;let o=!1,a=0;const l=await this.initAfcToolsMap(e);return function(u,p,m){var g,v;return ga(this,arguments,function*(){for(var I,P,V,C;a<s;){o&&(a++,o=!1);const q=yield ot(u.processParamsMaybeAddMcpUsage(m)),z=yield ot(u.generateContentStreamInternal(q)),E=[],x=[];try{for(var S=!0,A=(P=void 0,eu(z)),L;L=yield ot(A.next()),I=L.done,!I;S=!0){C=L.value,S=!1;const R=C;if(yield yield ot(R),R.candidates&&(!((g=R.candidates[0])===null||g===void 0)&&g.content)){x.push(R.candidates[0].content);for(const N of(v=R.candidates[0].content.parts)!==null&&v!==void 0?v:[])if(a<s&&N.functionCall){if(!N.functionCall.name)throw new Error("Function call name was not returned by the model.");if(p.has(N.functionCall.name)){const M=yield ot(p.get(N.functionCall.name).callTool([N.functionCall]));E.push(...M)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${p.keys()}, mising tool: ${N.functionCall.name}`)}}}}catch(R){P={error:R}}finally{try{!S&&!I&&(V=A.return)&&(yield ot(V.call(A)))}finally{if(P)throw P.error}}if(E.length>0){o=!0;const R=new Pl;R.candidates=[{content:{role:"user",parts:E}}],yield yield ot(R);const N=[];N.push(...x),N.push({role:"user",parts:E});const M=Qn(m.contents).concat(N);m.contents=M}else break}})}(this,l,e)}async generateContentInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=$T(this.apiClient,e);return a=ce("{model}:generateContent",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:p.headers},g})),o.then(p=>{const m=HT(p),g=new Pl;return Object.assign(g,m),g})}else{const u=zT(this.apiClient,e);return a=ce("{model}:generateContent",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:p.headers},g})),o.then(p=>{const m=jT(p),g=new Pl;return Object.assign(g,m),g})}}async generateContentStreamInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=$T(this.apiClient,e);return a=ce("{model}:streamGenerateContent?alt=sse",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.requestStream({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}),o.then(function(m){return ga(this,arguments,function*(){var g,v,I,P;try{for(var V=!0,C=eu(m),S;S=yield ot(C.next()),g=S.done,!g;V=!0){P=S.value,V=!1;const A=P,L=HT(yield ot(A.json()));L.sdkHttpResponse={headers:A.headers};const q=new Pl;Object.assign(q,L),yield yield ot(q)}}catch(A){v={error:A}}finally{try{!V&&!g&&(I=C.return)&&(yield ot(I.call(C)))}finally{if(v)throw v.error}}})})}else{const u=zT(this.apiClient,e);return a=ce("{model}:streamGenerateContent?alt=sse",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.requestStream({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}),o.then(function(m){return ga(this,arguments,function*(){var g,v,I,P;try{for(var V=!0,C=eu(m),S;S=yield ot(C.next()),g=S.done,!g;V=!0){P=S.value,V=!1;const A=P,L=jT(yield ot(A.json()));L.sdkHttpResponse={headers:A.headers};const q=new Pl;Object.assign(q,L),yield yield ot(q)}}catch(A){v={error:A}}finally{try{!V&&!g&&(I=C.return)&&(yield ot(I.call(C)))}finally{if(v)throw v.error}}})})}}async embedContent(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=Vb(this.apiClient,e);return a=ce("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:p.headers},g})),o.then(p=>{const m=Fb(p),g=new AT;return Object.assign(g,m),g})}else{const u=Mb(this.apiClient,e);return a=ce("{model}:batchEmbedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:p.headers},g})),o.then(p=>{const m=Lb(p),g=new AT;return Object.assign(g,m),g})}}async generateImagesInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=Hb(this.apiClient,e);return a=ce("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:p.headers},g})),o.then(p=>{const m=Kb(p),g=new RT;return Object.assign(g,m),g})}else{const u=jb(this.apiClient,e);return a=ce("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:p.headers},g})),o.then(p=>{const m=Wb(p),g=new RT;return Object.assign(g,m),g})}}async editImageInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=kb(this.apiClient,e);return s=ce("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const p=u;return p.sdkHttpResponse={headers:l.headers},p})),i.then(l=>{const u=Nb(l),p=new Qk;return Object.assign(p,u),p})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=zD(this.apiClient,e);return s=ce("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const p=u;return p.sdkHttpResponse={headers:l.headers},p})),i.then(l=>{const u=$D(l),p=new Yk;return Object.assign(p,u),p})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=xD(this.apiClient,e);return s=ce("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=CD(l),p=new Xk;return Object.assign(p,u),p})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=bD(this.apiClient,e);return s=ce("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=DD(l),p=new Zk;return Object.assign(p,u),p})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=dD(this.apiClient,e);return a=ce("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),o.then(p=>Nm(p))}else{const u=cD(this.apiClient,e);return a=ce("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json()),o.then(p=>km(p))}}async listInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=yD(this.apiClient,e);return a=ce("{models_url}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:p.headers},g})),o.then(p=>{const m=TD(p),g=new PT;return Object.assign(g,m),g})}else{const u=_D(this.apiClient,e);return a=ce("{models_url}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:p.headers},g})),o.then(p=>{const m=vD(p),g=new PT;return Object.assign(g,m),g})}}async update(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=GD(this.apiClient,e);return a=ce("{model}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),o.then(p=>Nm(p))}else{const u=BD(this.apiClient,e);return a=ce("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json()),o.then(p=>km(p))}}async delete(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=Cb(this.apiClient,e);return a=ce("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:p.headers},g})),o.then(p=>{const m=Rb(p),g=new kT;return Object.assign(g,m),g})}else{const u=xb(this.apiClient,e);return a=ce("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:p.headers},g})),o.then(p=>{const m=Ab(p),g=new kT;return Object.assign(g,m),g})}}async countTokens(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=wb(this.apiClient,e);return a=ce("{model}:countTokens",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:p.headers},g})),o.then(p=>{const m=Sb(p),g=new NT;return Object.assign(g,m),g})}else{const u=Eb(this.apiClient,e);return a=ce("{model}:countTokens",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:p.headers},g})),o.then(p=>{const m=Ib(p),g=new NT;return Object.assign(g,m),g})}}async computeTokens(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=pb(this.apiClient,e);return s=ce("{model}:computeTokens",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const p=u;return p.sdkHttpResponse={headers:l.headers},p})),i.then(l=>{const u=mb(l),p=new e1;return Object.assign(p,u),p})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=eD(this.apiClient,e);return a=ce("{model}:predictLongRunning",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),o.then(p=>{const m=Xb(p),g=new oh;return Object.assign(g,m),g})}else{const u=Zb(this.apiClient,e);return a=ce("{model}:predictLongRunning",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json()),o.then(p=>{const m=Yb(p),g=new oh;return Object.assign(g,m),g})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class SM extends Eo{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const n=e.operation,r=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=n.name.split("/operations/")[0];let s;r&&"httpOptions"in r&&(s=r.httpOptions);const o=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:i,config:{httpOptions:s}});return n._fromAPIResponse({apiResponse:o,isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:i,isVertexAI:!1})}}async get(e){const n=e.operation,r=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=n.name.split("/operations/")[0];let s;r&&"httpOptions"in r&&(s=r.httpOptions);const o=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:i,config:{httpOptions:s}});return n._fromAPIResponse({apiResponse:o,isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:i,isVertexAI:!1})}}async getVideosOperationInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=Wk(e);return a=ce("{operationName}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),o}else{const u=Hk(e);return a=ce("{operationName}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json()),o}}async fetchPredictVideosOperationInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=Ok(e);return s=ce("{resourceName}:fetchPredictOperation",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function xM(t){const e={},n=d(t,["data"]);if(n!=null&&f(e,["data"],n),d(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=d(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function CM(t){const e={},n=d(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>MM(s))),f(e,["parts"],i)}const r=d(t,["role"]);return r!=null&&f(e,["role"],r),e}function AM(t,e,n){const r={},i=d(e,["expireTime"]);n!==void 0&&i!=null&&f(n,["expireTime"],i);const s=d(e,["newSessionExpireTime"]);n!==void 0&&s!=null&&f(n,["newSessionExpireTime"],s);const o=d(e,["uses"]);n!==void 0&&o!=null&&f(n,["uses"],o);const a=d(e,["liveConnectConstraints"]);n!==void 0&&a!=null&&f(n,["bidiGenerateContentSetup"],DM(t,a));const l=d(e,["lockAdditionalFields"]);return n!==void 0&&l!=null&&f(n,["fieldMask"],l),r}function RM(t,e){const n={},r=d(e,["config"]);return r!=null&&f(n,["config"],AM(t,r,n)),n}function PM(t){const e={};if(d(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=d(t,["fileUri"]);n!=null&&f(e,["fileUri"],n);const r=d(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function kM(t){const e={};if(d(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=d(t,["enableWidget"]);return n!=null&&f(e,["enableWidget"],n),e}function NM(t){const e={};if(d(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");const n=d(t,["timeRangeFilter"]);return n!=null&&f(e,["timeRangeFilter"],n),e}function bM(t,e){const n={},r=d(t,["generationConfig"]);e!==void 0&&r!=null&&f(e,["setup","generationConfig"],r);const i=d(t,["responseModalities"]);e!==void 0&&i!=null&&f(e,["setup","generationConfig","responseModalities"],i);const s=d(t,["temperature"]);e!==void 0&&s!=null&&f(e,["setup","generationConfig","temperature"],s);const o=d(t,["topP"]);e!==void 0&&o!=null&&f(e,["setup","generationConfig","topP"],o);const a=d(t,["topK"]);e!==void 0&&a!=null&&f(e,["setup","generationConfig","topK"],a);const l=d(t,["maxOutputTokens"]);e!==void 0&&l!=null&&f(e,["setup","generationConfig","maxOutputTokens"],l);const u=d(t,["mediaResolution"]);e!==void 0&&u!=null&&f(e,["setup","generationConfig","mediaResolution"],u);const p=d(t,["seed"]);e!==void 0&&p!=null&&f(e,["setup","generationConfig","seed"],p);const m=d(t,["speechConfig"]);e!==void 0&&m!=null&&f(e,["setup","generationConfig","speechConfig"],__(m));const g=d(t,["thinkingConfig"]);e!==void 0&&g!=null&&f(e,["setup","generationConfig","thinkingConfig"],g);const v=d(t,["enableAffectiveDialog"]);e!==void 0&&v!=null&&f(e,["setup","generationConfig","enableAffectiveDialog"],v);const I=d(t,["systemInstruction"]);e!==void 0&&I!=null&&f(e,["setup","systemInstruction"],CM(nn(I)));const P=d(t,["tools"]);if(e!==void 0&&P!=null){let z=Qa(P);Array.isArray(z)&&(z=z.map(E=>LM(Ja(E)))),f(e,["setup","tools"],z)}const V=d(t,["sessionResumption"]);e!==void 0&&V!=null&&f(e,["setup","sessionResumption"],VM(V));const C=d(t,["inputAudioTranscription"]);e!==void 0&&C!=null&&f(e,["setup","inputAudioTranscription"],C);const S=d(t,["outputAudioTranscription"]);e!==void 0&&S!=null&&f(e,["setup","outputAudioTranscription"],S);const A=d(t,["realtimeInputConfig"]);e!==void 0&&A!=null&&f(e,["setup","realtimeInputConfig"],A);const L=d(t,["contextWindowCompression"]);e!==void 0&&L!=null&&f(e,["setup","contextWindowCompression"],L);const q=d(t,["proactivity"]);return e!==void 0&&q!=null&&f(e,["setup","proactivity"],q),n}function DM(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["setup","model"],Be(t,r));const i=d(e,["config"]);return i!=null&&f(n,["config"],bM(i,n)),n}function MM(t){const e={},n=d(t,["functionCall"]);n!=null&&f(e,["functionCall"],n);const r=d(t,["codeExecutionResult"]);r!=null&&f(e,["codeExecutionResult"],r);const i=d(t,["executableCode"]);i!=null&&f(e,["executableCode"],i);const s=d(t,["fileData"]);s!=null&&f(e,["fileData"],PM(s));const o=d(t,["functionResponse"]);o!=null&&f(e,["functionResponse"],o);const a=d(t,["inlineData"]);a!=null&&f(e,["inlineData"],xM(a));const l=d(t,["text"]);l!=null&&f(e,["text"],l);const u=d(t,["thought"]);u!=null&&f(e,["thought"],u);const p=d(t,["thoughtSignature"]);p!=null&&f(e,["thoughtSignature"],p);const m=d(t,["videoMetadata"]);return m!=null&&f(e,["videoMetadata"],m),e}function VM(t){const e={},n=d(t,["handle"]);if(n!=null&&f(e,["handle"],n),d(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function LM(t){const e={},n=d(t,["functionDeclarations"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(p=>p)),f(e,["functionDeclarations"],u)}if(d(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=d(t,["googleSearchRetrieval"]);r!=null&&f(e,["googleSearchRetrieval"],r);const i=d(t,["googleMaps"]);i!=null&&f(e,["googleMaps"],kM(i));const s=d(t,["computerUse"]);s!=null&&f(e,["computerUse"],s);const o=d(t,["codeExecution"]);if(o!=null&&f(e,["codeExecution"],o),d(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=d(t,["googleSearch"]);a!=null&&f(e,["googleSearch"],NM(a));const l=d(t,["urlContext"]);return l!=null&&f(e,["urlContext"],l),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function FM(t){const e=[];for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const r=t[n];if(typeof r=="object"&&r!=null&&Object.keys(r).length>0){const i=Object.keys(r).map(s=>`${n}.${s}`);e.push(...i)}else e.push(n)}return e.join(",")}function UM(t,e){let n=null;const r=t.bidiGenerateContentSetup;if(typeof r=="object"&&r!==null&&"setup"in r){const s=r.setup;typeof s=="object"&&s!==null?(t.bidiGenerateContentSetup=s,n=s):delete t.bidiGenerateContentSetup}else r!==void 0&&delete t.bidiGenerateContentSetup;const i=t.fieldMask;if(n){const s=FM(n);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)s?t.fieldMask=s:delete t.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&i!==null&&Array.isArray(i)&&i.length>0){const o=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let a=[];i.length>0&&(a=i.map(u=>o.includes(u)?`generationConfig.${u}`:u));const l=[];s&&l.push(s),a.length>0&&l.push(...a),l.length>0?t.fieldMask=l.join(","):delete t.fieldMask}else delete t.fieldMask}else i!==null&&Array.isArray(i)&&i.length>0?t.fieldMask=i.join(","):delete t.fieldMask;return t}class OM extends Eo{constructor(e){super(),this.apiClient=e}async create(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const a=RM(this.apiClient,e);s=ce("auth_tokens",a._url),o=a._query,delete a.config,delete a._url,delete a._query;const l=UM(a,e.config);return i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>u)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function BM(t,e){const n={},r=d(t,["name"]);return r!=null&&f(n,["_url","name"],r),n}function GM(t,e){const n={},r=d(t,["name"]);return r!=null&&f(n,["_url","name"],r),n}function qM(t,e,n){const r={};if(d(t,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const i=d(t,["tunedModelDisplayName"]);if(e!==void 0&&i!=null&&f(e,["displayName"],i),d(t,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const s=d(t,["epochCount"]);e!==void 0&&s!=null&&f(e,["tuningTask","hyperparameters","epochCount"],s);const o=d(t,["learningRateMultiplier"]);if(o!=null&&f(r,["tuningTask","hyperparameters","learningRateMultiplier"],o),d(t,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(d(t,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(d(t,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const a=d(t,["batchSize"]);e!==void 0&&a!=null&&f(e,["tuningTask","hyperparameters","batchSize"],a);const l=d(t,["learningRate"]);if(e!==void 0&&l!=null&&f(e,["tuningTask","hyperparameters","learningRate"],l),d(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(d(t,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return r}function zM(t,e,n){const r={};let i=d(n,["config","method"]);if(i===void 0&&(i="SUPERVISED_FINE_TUNING"),i==="SUPERVISED_FINE_TUNING"){const v=d(t,["validationDataset"]);e!==void 0&&v!=null&&f(e,["supervisedTuningSpec"],XT(v))}else if(i==="PREFERENCE_TUNING"){const v=d(t,["validationDataset"]);e!==void 0&&v!=null&&f(e,["preferenceOptimizationSpec"],XT(v))}const s=d(t,["tunedModelDisplayName"]);e!==void 0&&s!=null&&f(e,["tunedModelDisplayName"],s);const o=d(t,["description"]);e!==void 0&&o!=null&&f(e,["description"],o);let a=d(n,["config","method"]);if(a===void 0&&(a="SUPERVISED_FINE_TUNING"),a==="SUPERVISED_FINE_TUNING"){const v=d(t,["epochCount"]);e!==void 0&&v!=null&&f(e,["supervisedTuningSpec","hyperParameters","epochCount"],v)}else if(a==="PREFERENCE_TUNING"){const v=d(t,["epochCount"]);e!==void 0&&v!=null&&f(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],v)}let l=d(n,["config","method"]);if(l===void 0&&(l="SUPERVISED_FINE_TUNING"),l==="SUPERVISED_FINE_TUNING"){const v=d(t,["learningRateMultiplier"]);e!==void 0&&v!=null&&f(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],v)}else if(l==="PREFERENCE_TUNING"){const v=d(t,["learningRateMultiplier"]);e!==void 0&&v!=null&&f(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],v)}let u=d(n,["config","method"]);if(u===void 0&&(u="SUPERVISED_FINE_TUNING"),u==="SUPERVISED_FINE_TUNING"){const v=d(t,["exportLastCheckpointOnly"]);e!==void 0&&v!=null&&f(e,["supervisedTuningSpec","exportLastCheckpointOnly"],v)}else if(u==="PREFERENCE_TUNING"){const v=d(t,["exportLastCheckpointOnly"]);e!==void 0&&v!=null&&f(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],v)}let p=d(n,["config","method"]);if(p===void 0&&(p="SUPERVISED_FINE_TUNING"),p==="SUPERVISED_FINE_TUNING"){const v=d(t,["adapterSize"]);e!==void 0&&v!=null&&f(e,["supervisedTuningSpec","hyperParameters","adapterSize"],v)}else if(p==="PREFERENCE_TUNING"){const v=d(t,["adapterSize"]);e!==void 0&&v!=null&&f(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],v)}if(d(t,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(d(t,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const m=d(t,["labels"]);e!==void 0&&m!=null&&f(e,["labels"],m);const g=d(t,["beta"]);return e!==void 0&&g!=null&&f(e,["preferenceOptimizationSpec","hyperParameters","beta"],g),r}function $M(t,e){const n={},r=d(t,["baseModel"]);r!=null&&f(n,["baseModel"],r);const i=d(t,["preTunedModel"]);i!=null&&f(n,["preTunedModel"],i);const s=d(t,["trainingDataset"]);s!=null&&t2(s);const o=d(t,["config"]);return o!=null&&qM(o,n),n}function jM(t,e){const n={},r=d(t,["baseModel"]);r!=null&&f(n,["baseModel"],r);const i=d(t,["preTunedModel"]);i!=null&&f(n,["preTunedModel"],i);const s=d(t,["trainingDataset"]);s!=null&&n2(s,n,e);const o=d(t,["config"]);return o!=null&&zM(o,n,e),n}function HM(t,e){const n={},r=d(t,["name"]);return r!=null&&f(n,["_url","name"],r),n}function WM(t,e){const n={},r=d(t,["name"]);return r!=null&&f(n,["_url","name"],r),n}function KM(t,e,n){const r={},i=d(t,["pageSize"]);e!==void 0&&i!=null&&f(e,["_query","pageSize"],i);const s=d(t,["pageToken"]);e!==void 0&&s!=null&&f(e,["_query","pageToken"],s);const o=d(t,["filter"]);return e!==void 0&&o!=null&&f(e,["_query","filter"],o),r}function JM(t,e,n){const r={},i=d(t,["pageSize"]);e!==void 0&&i!=null&&f(e,["_query","pageSize"],i);const s=d(t,["pageToken"]);e!==void 0&&s!=null&&f(e,["_query","pageToken"],s);const o=d(t,["filter"]);return e!==void 0&&o!=null&&f(e,["_query","filter"],o),r}function QM(t,e){const n={},r=d(t,["config"]);return r!=null&&KM(r,n),n}function YM(t,e){const n={},r=d(t,["config"]);return r!=null&&JM(r,n),n}function XM(t,e){const n={},r=d(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const i=d(t,["nextPageToken"]);i!=null&&f(n,["nextPageToken"],i);const s=d(t,["tunedModels"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>Ox(a))),f(n,["tuningJobs"],o)}return n}function ZM(t,e){const n={},r=d(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const i=d(t,["nextPageToken"]);i!=null&&f(n,["nextPageToken"],i);const s=d(t,["tuningJobs"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>Dm(a))),f(n,["tuningJobs"],o)}return n}function e2(t,e){const n={},r=d(t,["name"]);r!=null&&f(n,["model"],r);const i=d(t,["name"]);return i!=null&&f(n,["endpoint"],i),n}function t2(t,e){const n={};if(d(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(d(t,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const r=d(t,["examples"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>s)),f(n,["examples","examples"],i)}return n}function n2(t,e,n){const r={};let i=d(n,["config","method"]);if(i===void 0&&(i="SUPERVISED_FINE_TUNING"),i==="SUPERVISED_FINE_TUNING"){const o=d(t,["gcsUri"]);e!==void 0&&o!=null&&f(e,["supervisedTuningSpec","trainingDatasetUri"],o)}else if(i==="PREFERENCE_TUNING"){const o=d(t,["gcsUri"]);e!==void 0&&o!=null&&f(e,["preferenceOptimizationSpec","trainingDatasetUri"],o)}let s=d(n,["config","method"]);if(s===void 0&&(s="SUPERVISED_FINE_TUNING"),s==="SUPERVISED_FINE_TUNING"){const o=d(t,["vertexDatasetResource"]);e!==void 0&&o!=null&&f(e,["supervisedTuningSpec","trainingDatasetUri"],o)}else if(s==="PREFERENCE_TUNING"){const o=d(t,["vertexDatasetResource"]);e!==void 0&&o!=null&&f(e,["preferenceOptimizationSpec","trainingDatasetUri"],o)}if(d(t,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return r}function Ox(t,e){const n={},r=d(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const i=d(t,["name"]);i!=null&&f(n,["name"],i);const s=d(t,["state"]);s!=null&&f(n,["state"],Tx(s));const o=d(t,["createTime"]);o!=null&&f(n,["createTime"],o);const a=d(t,["tuningTask","startTime"]);a!=null&&f(n,["startTime"],a);const l=d(t,["tuningTask","completeTime"]);l!=null&&f(n,["endTime"],l);const u=d(t,["updateTime"]);u!=null&&f(n,["updateTime"],u);const p=d(t,["description"]);p!=null&&f(n,["description"],p);const m=d(t,["baseModel"]);m!=null&&f(n,["baseModel"],m);const g=d(t,["_self"]);return g!=null&&f(n,["tunedModel"],e2(g)),n}function Dm(t,e){const n={},r=d(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const i=d(t,["name"]);i!=null&&f(n,["name"],i);const s=d(t,["state"]);s!=null&&f(n,["state"],Tx(s));const o=d(t,["createTime"]);o!=null&&f(n,["createTime"],o);const a=d(t,["startTime"]);a!=null&&f(n,["startTime"],a);const l=d(t,["endTime"]);l!=null&&f(n,["endTime"],l);const u=d(t,["updateTime"]);u!=null&&f(n,["updateTime"],u);const p=d(t,["error"]);p!=null&&f(n,["error"],p);const m=d(t,["description"]);m!=null&&f(n,["description"],m);const g=d(t,["baseModel"]);g!=null&&f(n,["baseModel"],g);const v=d(t,["tunedModel"]);v!=null&&f(n,["tunedModel"],v);const I=d(t,["preTunedModel"]);I!=null&&f(n,["preTunedModel"],I);const P=d(t,["supervisedTuningSpec"]);P!=null&&f(n,["supervisedTuningSpec"],P);const V=d(t,["preferenceOptimizationSpec"]);V!=null&&f(n,["preferenceOptimizationSpec"],V);const C=d(t,["tuningDataStats"]);C!=null&&f(n,["tuningDataStats"],C);const S=d(t,["encryptionSpec"]);S!=null&&f(n,["encryptionSpec"],S);const A=d(t,["partnerModelTuningSpec"]);A!=null&&f(n,["partnerModelTuningSpec"],A);const L=d(t,["customBaseModel"]);L!=null&&f(n,["customBaseModel"],L);const q=d(t,["experiment"]);q!=null&&f(n,["experiment"],q);const z=d(t,["labels"]);z!=null&&f(n,["labels"],z);const E=d(t,["outputUri"]);E!=null&&f(n,["outputUri"],E);const x=d(t,["pipelineJob"]);x!=null&&f(n,["pipelineJob"],x);const R=d(t,["serviceAccount"]);R!=null&&f(n,["serviceAccount"],R);const N=d(t,["tunedModelDisplayName"]);N!=null&&f(n,["tunedModelDisplayName"],N);const M=d(t,["veoTuningSpec"]);return M!=null&&f(n,["veoTuningSpec"],M),n}function r2(t,e){const n={},r=d(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const i=d(t,["name"]);i!=null&&f(n,["name"],i);const s=d(t,["metadata"]);s!=null&&f(n,["metadata"],s);const o=d(t,["done"]);o!=null&&f(n,["done"],o);const a=d(t,["error"]);return a!=null&&f(n,["error"],a),n}function XT(t,e){const n={},r=d(t,["gcsUri"]);r!=null&&f(n,["validationDatasetUri"],r);const i=d(t,["vertexDatasetResource"]);return i!=null&&f(n,["validationDatasetUri"],i),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class i2 extends Eo{constructor(e){super(),this.apiClient=e,this.get=async n=>await this.getInternal(n),this.list=async(n={})=>new Ju(uo.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(n),n),this.tune=async n=>{var r;if(this.apiClient.isVertexAI())if(n.baseModel.startsWith("projects/")){const i={tunedModelName:n.baseModel};!((r=n.config)===null||r===void 0)&&r.preTunedModelCheckpointId&&(i.checkpointId=n.config.preTunedModelCheckpointId);const s=Object.assign(Object.assign({},n),{preTunedModel:i});return s.baseModel=void 0,await this.tuneInternal(s)}else{const i=Object.assign({},n);return await this.tuneInternal(i)}else{const i=Object.assign({},n),s=await this.tuneMldevInternal(i);let o="";return s.metadata!==void 0&&s.metadata.tunedModel!==void 0?o=s.metadata.tunedModel:s.name!==void 0&&s.name.includes("/operations/")&&(o=s.name.split("/operations/")[0]),{name:o,state:Cm.JOB_STATE_QUEUED}}}}async getInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=WM(e);return a=ce("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:p.headers},g})),o.then(p=>Dm(p))}else{const u=HM(e);return a=ce("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:p.headers},g})),o.then(p=>Ox(p))}}async listInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=YM(e);return a=ce("tuningJobs",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:p.headers},g})),o.then(p=>{const m=ZM(p),g=new bT;return Object.assign(g,m),g})}else{const u=QM(e);return a=ce("tunedModels",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:p.headers},g})),o.then(p=>{const m=XM(p),g=new bT;return Object.assign(g,m),g})}}async cancel(e){var n,r,i,s;let o="",a={};if(this.apiClient.isVertexAI()){const l=GM(e);o=ce("{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}else{const l=BM(e);o=ce("{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal})}}async tuneInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=jM(e,e);return s=ce("tuningJobs",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const p=u;return p.sdkHttpResponse={headers:l.headers},p})),i.then(l=>Dm(l))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=$M(e);return s=ce("tunedModels",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const p=u;return p.sdkHttpResponse={headers:l.headers},p})),i.then(l=>r2(l))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class s2{async download(e,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const o2=1024*1024*8,a2=3,l2=1e3,u2=2,pp="x-goog-upload-status";async function c2(t,e,n){var r,i,s;let o=0,a=0,l=new Am(new Response),u="upload";for(o=t.size;a<o;){const m=Math.min(o2,o-a),g=t.slice(a,a+m);a+m>=o&&(u+=", finalize");let v=0,I=l2;for(;v<a2&&(l=await n.request({path:"",body:g,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":u,"X-Goog-Upload-Offset":String(a),"Content-Length":String(m)}}}),!(!((r=l==null?void 0:l.headers)===null||r===void 0)&&r[pp]));)v++,await h2(I),I=I*u2;if(a+=m,((i=l==null?void 0:l.headers)===null||i===void 0?void 0:i[pp])!=="active")break;if(o<=a)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const p=await(l==null?void 0:l.json());if(((s=l==null?void 0:l.headers)===null||s===void 0?void 0:s[pp])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return p.file}async function d2(t){return{size:t.size,type:t.type}}function h2(t){return new Promise(e=>setTimeout(e,t))}class f2{async upload(e,n,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await c2(e,n,r)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await d2(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class p2{create(e,n,r){return new m2(e,n,r)}}class m2{constructor(e,n,r){this.url=e,this.headers=n,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const ZT="x-goog-api-key";class g2{constructor(e){this.apiKey=e}async addAuthHeaders(e,n){if(e.get(ZT)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(ZT,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const _2="gl-node/";class y2{constructor(e){var n;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=e.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=e.apiKey;const r=Fk(e.httpOptions,e.vertexai,void 0,void 0);r&&(e.httpOptions?e.httpOptions.baseUrl=r:e.httpOptions={baseUrl:r}),this.apiVersion=e.apiVersion;const i=new g2(this.apiKey);this.apiClient=new rM({auth:i,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:_2+"web",uploader:new f2,downloader:new s2}),this.models=new IM(this.apiClient),this.live=new gM(this.apiClient,i,new p2),this.batches=new nN(this.apiClient),this.chats=new MN(this.models,this.apiClient),this.caches=new NN(this.apiClient),this.files=new $N(this.apiClient),this.operations=new SM(this.apiClient),this.authTokens=new OM(this.apiClient),this.tunings=new i2(this.apiClient)}}const v2=()=>{};var eE={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bx=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},T2=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],o=t[n++],a=t[n++],l=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},Gx={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],o=i+1<t.length,a=o?t[i+1]:0,l=i+2<t.length,u=l?t[i+2]:0,p=s>>2,m=(s&3)<<4|a>>4;let g=(a&15)<<2|u>>6,v=u&63;l||(v=64,o||(g=64)),r.push(n[p],n[m],n[g],n[v])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Bx(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):T2(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0;++i;const u=i<t.length?n[t.charAt(i)]:64;++i;const m=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||a==null||u==null||m==null)throw new E2;const g=s<<2|a>>4;if(r.push(g),u!==64){const v=a<<4&240|u>>2;if(r.push(v),m!==64){const I=u<<6&192|m;r.push(I)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class E2 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const w2=function(t){const e=Bx(t);return Gx.encodeByteArray(e,!0)},lh=function(t){return w2(t).replace(/\./g,"")},qx=function(t){try{return Gx.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zx(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I2=()=>zx().__FIREBASE_DEFAULTS__,S2=()=>{if(typeof process>"u"||typeof eE>"u")return;const t=eE.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},x2=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&qx(t[1]);return e&&JSON.parse(e)},ef=()=>{try{return v2()||I2()||S2()||x2()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},$x=t=>{var e,n;return(n=(e=ef())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},C2=t=>{const e=$x(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},jx=()=>{var t;return(t=ef())==null?void 0:t.config},Hx=t=>{var e;return(e=ef())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A2{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xa(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Wx(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R2(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...t};return[lh(JSON.stringify(n)),lh(JSON.stringify(o)),""].join(".")}const tu={};function P2(){const t={prod:[],emulator:[]};for(const e of Object.keys(tu))tu[e]?t.emulator.push(e):t.prod.push(e);return t}function k2(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let tE=!1;function Kx(t,e){if(typeof window>"u"||typeof document>"u"||!Xa(window.location.host)||tu[t]===e||tu[t]||tE)return;tu[t]=e;function n(g){return`__firebase__banner__${g}`}const r="__firebase__banner",s=P2().prod.length>0;function o(){const g=document.getElementById(r);g&&g.remove()}function a(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function l(g,v){g.setAttribute("width","24"),g.setAttribute("id",v),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function u(){const g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{tE=!0,o()},g}function p(g,v){g.setAttribute("id",v),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function m(){const g=k2(r),v=n("text"),I=document.getElementById(v)||document.createElement("span"),P=n("learnmore"),V=document.getElementById(P)||document.createElement("a"),C=n("preprendIcon"),S=document.getElementById(C)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){const A=g.element;a(A),p(V,P);const L=u();l(S,C),A.append(S,I,V,L),document.body.appendChild(A)}s?(I.innerText="Preview backend disconnected.",S.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(S.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,I.innerText="Preview backend running in this workspace."),I.setAttribute("id",v)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",m):m()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function N2(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(kt())}function Jx(){var e;const t=(e=ef())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function b2(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function D2(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function M2(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function V2(){const t=kt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function Qx(){return!Jx()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Yx(){return!Jx()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function Xx(){try{return typeof indexedDB=="object"}catch{return!1}}function L2(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)==null?void 0:s.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F2="FirebaseError";class hi extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=F2,Object.setPrototypeOf(this,hi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Qu.prototype.create)}}class Qu{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?U2(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new hi(i,a,r)}}function U2(t,e){return t.replace(O2,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const O2=/\{\$([^}]+)}/g;function B2(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function co(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],o=e[i];if(nE(s)&&nE(o)){if(!co(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function nE(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yu(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function G2(t,e){const n=new q2(t,e);return n.subscribe.bind(n)}class q2{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");z2(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=mp),i.error===void 0&&(i.error=mp),i.complete===void 0&&(i.complete=mp);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function z2(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function mp(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nt(t){return t&&t._delegate?t._delegate:t}class ho{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Os="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $2{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new A2;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(H2(e))try{this.getOrInitializeService({instanceIdentifier:Os})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Os){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Os){return this.instances.has(e)}getOptions(e=Os){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:j2(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Os){return this.component?this.component.multipleInstances?e:Os:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function j2(t){return t===Os?void 0:t}function H2(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W2{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new $2(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var De;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(De||(De={}));const K2={debug:De.DEBUG,verbose:De.VERBOSE,info:De.INFO,warn:De.WARN,error:De.ERROR,silent:De.SILENT},J2=De.INFO,Q2={[De.DEBUG]:"log",[De.VERBOSE]:"log",[De.INFO]:"info",[De.WARN]:"warn",[De.ERROR]:"error"},Y2=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=Q2[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class v_{constructor(e){this.name=e,this._logLevel=J2,this._logHandler=Y2,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in De))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?K2[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,De.DEBUG,...e),this._logHandler(this,De.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,De.VERBOSE,...e),this._logHandler(this,De.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,De.INFO,...e),this._logHandler(this,De.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,De.WARN,...e),this._logHandler(this,De.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,De.ERROR,...e),this._logHandler(this,De.ERROR,...e)}}const X2=(t,e)=>e.some(n=>t instanceof n);let rE,iE;function Z2(){return rE||(rE=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function eV(){return iE||(iE=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Zx=new WeakMap,Mm=new WeakMap,e0=new WeakMap,gp=new WeakMap,T_=new WeakMap;function tV(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(ts(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&Zx.set(n,t)}).catch(()=>{}),T_.set(e,t),e}function nV(t){if(Mm.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});Mm.set(t,e)}let Vm={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Mm.get(t);if(e==="objectStoreNames")return t.objectStoreNames||e0.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ts(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function rV(t){Vm=t(Vm)}function iV(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(_p(this),e,...n);return e0.set(r,e.sort?e.sort():[e]),ts(r)}:eV().includes(t)?function(...e){return t.apply(_p(this),e),ts(Zx.get(this))}:function(...e){return ts(t.apply(_p(this),e))}}function sV(t){return typeof t=="function"?iV(t):(t instanceof IDBTransaction&&nV(t),X2(t,Z2())?new Proxy(t,Vm):t)}function ts(t){if(t instanceof IDBRequest)return tV(t);if(gp.has(t))return gp.get(t);const e=sV(t);return e!==t&&(gp.set(t,e),T_.set(e,t)),e}const _p=t=>T_.get(t);function oV(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),a=ts(o);return r&&o.addEventListener("upgradeneeded",l=>{r(ts(o.result),l.oldVersion,l.newVersion,ts(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}const aV=["get","getKey","getAll","getAllKeys","count"],lV=["put","add","delete","clear"],yp=new Map;function sE(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(yp.get(e))return yp.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=lV.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||aV.includes(n)))return;const s=async function(o,...a){const l=this.transaction(o,i?"readwrite":"readonly");let u=l.store;return r&&(u=u.index(a.shift())),(await Promise.all([u[n](...a),i&&l.done]))[0]};return yp.set(e,s),s}rV(t=>({...t,get:(e,n,r)=>sE(e,n)||t.get(e,n,r),has:(e,n)=>!!sE(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uV{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(cV(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function cV(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Lm="@firebase/app",oE="0.14.5";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oi=new v_("@firebase/app"),dV="@firebase/app-compat",hV="@firebase/analytics-compat",fV="@firebase/analytics",pV="@firebase/app-check-compat",mV="@firebase/app-check",gV="@firebase/auth",_V="@firebase/auth-compat",yV="@firebase/database",vV="@firebase/data-connect",TV="@firebase/database-compat",EV="@firebase/functions",wV="@firebase/functions-compat",IV="@firebase/installations",SV="@firebase/installations-compat",xV="@firebase/messaging",CV="@firebase/messaging-compat",AV="@firebase/performance",RV="@firebase/performance-compat",PV="@firebase/remote-config",kV="@firebase/remote-config-compat",NV="@firebase/storage",bV="@firebase/storage-compat",DV="@firebase/firestore",MV="@firebase/ai",VV="@firebase/firestore-compat",LV="firebase",FV="12.5.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fm="[DEFAULT]",UV={[Lm]:"fire-core",[dV]:"fire-core-compat",[fV]:"fire-analytics",[hV]:"fire-analytics-compat",[mV]:"fire-app-check",[pV]:"fire-app-check-compat",[gV]:"fire-auth",[_V]:"fire-auth-compat",[yV]:"fire-rtdb",[vV]:"fire-data-connect",[TV]:"fire-rtdb-compat",[EV]:"fire-fn",[wV]:"fire-fn-compat",[IV]:"fire-iid",[SV]:"fire-iid-compat",[xV]:"fire-fcm",[CV]:"fire-fcm-compat",[AV]:"fire-perf",[RV]:"fire-perf-compat",[PV]:"fire-rc",[kV]:"fire-rc-compat",[NV]:"fire-gcs",[bV]:"fire-gcs-compat",[DV]:"fire-fst",[VV]:"fire-fst-compat",[MV]:"fire-vertex","fire-js":"fire-js",[LV]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uh=new Map,OV=new Map,Um=new Map;function aE(t,e){try{t.container.addComponent(e)}catch(n){oi.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Pa(t){const e=t.name;if(Um.has(e))return oi.debug(`There were multiple attempts to register component ${e}.`),!1;Um.set(e,t);for(const n of uh.values())aE(n,t);for(const n of OV.values())aE(n,t);return!0}function E_(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function dr(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BV={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ns=new Qu("app","Firebase",BV);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GV{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new ho("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ns.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Za=FV;function t0(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:Fm,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw ns.create("bad-app-name",{appName:String(i)});if(n||(n=jx()),!n)throw ns.create("no-options");const s=uh.get(i);if(s){if(co(n,s.options)&&co(r,s.config))return s;throw ns.create("duplicate-app",{appName:i})}const o=new W2(i);for(const l of Um.values())o.addComponent(l);const a=new GV(n,r,o);return uh.set(i,a),a}function n0(t=Fm){const e=uh.get(t);if(!e&&t===Fm&&jx())return t0();if(!e)throw ns.create("no-app",{appName:t});return e}function rs(t,e,n){let r=UV[t]??t;n&&(r+=`-${n}`);const i=r.match(/\s|\//),s=e.match(/\s|\//);if(i||s){const o=[`Unable to register library "${r}" with version "${e}":`];i&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),oi.warn(o.join(" "));return}Pa(new ho(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qV="firebase-heartbeat-database",zV=1,ku="firebase-heartbeat-store";let vp=null;function r0(){return vp||(vp=oV(qV,zV,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(ku)}catch(n){console.warn(n)}}}}).catch(t=>{throw ns.create("idb-open",{originalErrorMessage:t.message})})),vp}async function $V(t){try{const n=(await r0()).transaction(ku),r=await n.objectStore(ku).get(i0(t));return await n.done,r}catch(e){if(e instanceof hi)oi.warn(e.message);else{const n=ns.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});oi.warn(n.message)}}}async function lE(t,e){try{const r=(await r0()).transaction(ku,"readwrite");await r.objectStore(ku).put(e,i0(t)),await r.done}catch(n){if(n instanceof hi)oi.warn(n.message);else{const r=ns.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});oi.warn(r.message)}}}function i0(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jV=1024,HV=30;class WV{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new JV(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=uE();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>HV){const o=QV(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){oi.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=uE(),{heartbeatsToSend:r,unsentEntries:i}=KV(this._heartbeatsCache.heartbeats),s=lh(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return oi.warn(n),""}}}function uE(){return new Date().toISOString().substring(0,10)}function KV(t,e=jV){const n=[];let r=t.slice();for(const i of t){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),cE(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),cE(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class JV{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Xx()?L2().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await $V(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return lE(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return lE(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function cE(t){return lh(JSON.stringify({version:2,heartbeats:t})).length}function QV(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YV(t){Pa(new ho("platform-logger",e=>new uV(e),"PRIVATE")),Pa(new ho("heartbeat",e=>new WV(e),"PRIVATE")),rs(Lm,oE,t),rs(Lm,oE,"esm2020"),rs("fire-js","")}YV("");var XV="firebase",ZV="12.5.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */rs(XV,ZV,"app");function s0(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const eL=s0,o0=new Qu("auth","Firebase",s0());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ch=new v_("@firebase/auth");function tL(t,...e){ch.logLevel<=De.WARN&&ch.warn(`Auth (${Za}): ${t}`,...e)}function Td(t,...e){ch.logLevel<=De.ERROR&&ch.error(`Auth (${Za}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vr(t,...e){throw I_(t,...e)}function mr(t,...e){return I_(t,...e)}function w_(t,e,n){const r={...eL(),[e]:n};return new Qu("auth","Firebase",r).create(e,{appName:t.name})}function eo(t){return w_(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function nL(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&Vr(t,"argument-error"),w_(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function I_(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return o0.create(t,...e)}function ye(t,e,...n){if(!t)throw I_(e,...n)}function Yr(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Td(e),new Error(e)}function ai(t,e){t||Yr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Om(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function rL(){return dE()==="http:"||dE()==="https:"}function dE(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iL(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(rL()||D2()||"connection"in navigator)?navigator.onLine:!0}function sL(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xu{constructor(e,n){this.shortDelay=e,this.longDelay=n,ai(n>e,"Short delay should be less than long delay!"),this.isMobile=N2()||M2()}get(){return iL()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S_(t,e){ai(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a0{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Yr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Yr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Yr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oL={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aL=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],lL=new Xu(3e4,6e4);function x_(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function el(t,e,n,r,i={}){return l0(t,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const a=Yu({key:t.config.apiKey,...o}).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const u={method:e,headers:l,...s};return b2()||(u.referrerPolicy="no-referrer"),t.emulatorConfig&&Xa(t.emulatorConfig.host)&&(u.credentials="include"),a0.fetch()(await u0(t,t.config.apiHost,n,a),u)})}async function l0(t,e,n){t._canInitEmulator=!1;const r={...oL,...e};try{const i=new cL(t),s=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw Xc(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[l,u]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Xc(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw Xc(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw Xc(t,"user-disabled",o);const p=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw w_(t,p,u);Vr(t,p)}}catch(i){if(i instanceof hi)throw i;Vr(t,"network-request-failed",{message:String(i)})}}async function uL(t,e,n,r,i={}){const s=await el(t,e,n,r,i);return"mfaPendingCredential"in s&&Vr(t,"multi-factor-auth-required",{_serverResponse:s}),s}async function u0(t,e,n,r){const i=`${e}${n}?${r}`,s=t,o=s.config.emulator?S_(t.config,i):`${t.config.apiScheme}://${i}`;return aL.includes(n)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}class cL{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(mr(this.auth,"network-request-failed")),lL.get())})}}function Xc(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=mr(t,e,r);return i.customData._tokenResponse=n,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dL(t,e){return el(t,"POST","/v1/accounts:delete",e)}async function dh(t,e){return el(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nu(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function hL(t,e=!1){const n=Nt(t),r=await n.getIdToken(e),i=C_(r);ye(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:nu(Tp(i.auth_time)),issuedAtTime:nu(Tp(i.iat)),expirationTime:nu(Tp(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function Tp(t){return Number(t)*1e3}function C_(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Td("JWT malformed, contained fewer than 3 sections"),null;try{const i=qx(n);return i?JSON.parse(i):(Td("Failed to decode base64 JWT payload"),null)}catch(i){return Td("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function hE(t){const e=C_(t);return ye(e,"internal-error"),ye(typeof e.exp<"u","internal-error"),ye(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Nu(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof hi&&fL(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function fL({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pL{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bm{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=nu(this.lastLoginAt),this.creationTime=nu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hh(t){var m;const e=t.auth,n=await t.getIdToken(),r=await Nu(t,dh(e,{idToken:n}));ye(r==null?void 0:r.users.length,e,"internal-error");const i=r.users[0];t._notifyReloadListener(i);const s=(m=i.providerUserInfo)!=null&&m.length?c0(i.providerUserInfo):[],o=gL(t.providerData,s),a=t.isAnonymous,l=!(t.email&&i.passwordHash)&&!(o!=null&&o.length),u=a?l:!1,p={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new Bm(i.createdAt,i.lastLoginAt),isAnonymous:u};Object.assign(t,p)}async function mL(t){const e=Nt(t);await hh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function gL(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function c0(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _L(t,e){const n=await l0(t,{},async()=>{const r=Yu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,o=await u0(t,i,"/v1/token",`key=${s}`),a=await t._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:a,body:r};return t.emulatorConfig&&Xa(t.emulatorConfig.host)&&(l.credentials="include"),a0.fetch()(o,l)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function yL(t,e){return el(t,"POST","/v2/accounts:revokeToken",x_(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ya{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ye(e.idToken,"internal-error"),ye(typeof e.idToken<"u","internal-error"),ye(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):hE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){ye(e.length!==0,"internal-error");const n=hE(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(ye(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:s}=await _L(e,n);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:s}=n,o=new ya;return r&&(ye(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(ye(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(ye(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ya,this.toJSON())}_performRefresh(){return Yr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ki(t,e){ye(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class hr{constructor({uid:e,auth:n,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new pL(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Bm(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await Nu(this,this.stsTokenManager.getToken(this.auth,e));return ye(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return hL(this,e)}reload(){return mL(this)}_assign(e){this!==e&&(ye(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new hr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){ye(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await hh(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(dr(this.auth.app))return Promise.reject(eo(this.auth));const e=await this.getIdToken();return await Nu(this,dL(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,i=n.email??void 0,s=n.phoneNumber??void 0,o=n.photoURL??void 0,a=n.tenantId??void 0,l=n._redirectEventId??void 0,u=n.createdAt??void 0,p=n.lastLoginAt??void 0,{uid:m,emailVerified:g,isAnonymous:v,providerData:I,stsTokenManager:P}=n;ye(m&&P,e,"internal-error");const V=ya.fromJSON(this.name,P);ye(typeof m=="string",e,"internal-error"),ki(r,e.name),ki(i,e.name),ye(typeof g=="boolean",e,"internal-error"),ye(typeof v=="boolean",e,"internal-error"),ki(s,e.name),ki(o,e.name),ki(a,e.name),ki(l,e.name),ki(u,e.name),ki(p,e.name);const C=new hr({uid:m,auth:e,email:i,emailVerified:g,displayName:r,isAnonymous:v,photoURL:o,phoneNumber:s,tenantId:a,stsTokenManager:V,createdAt:u,lastLoginAt:p});return I&&Array.isArray(I)&&(C.providerData=I.map(S=>({...S}))),l&&(C._redirectEventId=l),C}static async _fromIdTokenResponse(e,n,r=!1){const i=new ya;i.updateFromServerResponse(n);const s=new hr({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await hh(s),s}static async _fromGetAccountInfoResponse(e,n,r){const i=n.users[0];ye(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?c0(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),a=new ya;a.updateFromIdToken(r);const l=new hr({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Bm(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(l,u),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fE=new Map;function Xr(t){ai(t instanceof Function,"Expected a class definition");let e=fE.get(t);return e?(ai(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,fE.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d0{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}d0.type="NONE";const pE=d0;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ed(t,e,n){return`firebase:${t}:${e}:${n}`}class va{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=Ed(this.userKey,i.apiKey,s),this.fullPersistenceKey=Ed("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await dh(this.auth,{idToken:e}).catch(()=>{});return n?hr._fromGetAccountInfoResponse(this.auth,n,e):null}return hr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new va(Xr(pE),e,r);const i=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let s=i[0]||Xr(pE);const o=Ed(r,e.config.apiKey,e.name);let a=null;for(const u of n)try{const p=await u._get(o);if(p){let m;if(typeof p=="string"){const g=await dh(e,{idToken:p}).catch(()=>{});if(!g)break;m=await hr._fromGetAccountInfoResponse(e,g,p)}else m=hr._fromJSON(e,p);u!==s&&(a=m),s=u;break}}catch{}const l=i.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new va(s,e,r):(s=l[0],a&&await s._set(o,a.toJSON()),await Promise.all(n.map(async u=>{if(u!==s)try{await u._remove(o)}catch{}})),new va(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mE(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(m0(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(h0(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(_0(e))return"Blackberry";if(y0(e))return"Webos";if(f0(e))return"Safari";if((e.includes("chrome/")||p0(e))&&!e.includes("edge/"))return"Chrome";if(g0(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function h0(t=kt()){return/firefox\//i.test(t)}function f0(t=kt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function p0(t=kt()){return/crios\//i.test(t)}function m0(t=kt()){return/iemobile/i.test(t)}function g0(t=kt()){return/android/i.test(t)}function _0(t=kt()){return/blackberry/i.test(t)}function y0(t=kt()){return/webos/i.test(t)}function A_(t=kt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function vL(t=kt()){var e;return A_(t)&&!!((e=window.navigator)!=null&&e.standalone)}function TL(){return V2()&&document.documentMode===10}function v0(t=kt()){return A_(t)||g0(t)||y0(t)||_0(t)||/windows phone/i.test(t)||m0(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T0(t,e=[]){let n;switch(t){case"Browser":n=mE(kt());break;case"Worker":n=`${mE(kt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Za}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EL{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=s=>new Promise((o,a)=>{try{const l=e(s);o(l)}catch(l){a(l)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wL(t,e={}){return el(t,"GET","/v2/passwordPolicy",x_(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IL=6;class SL{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??IL,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xL{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new gE(this),this.idTokenSubscription=new gE(this),this.beforeStateQueue=new EL(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=o0,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Xr(n)),this._initializationPromise=this.queue(async()=>{var r,i,s;if(!this._deleted&&(this.persistenceManager=await va.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((i=this._popupRedirectResolver)!=null&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)==null?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await dh(this,{idToken:e}),r=await hr._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var s;if(dr(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(s=this.redirectUser)==null?void 0:s._redirectEventId,a=r==null?void 0:r._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(r=l.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return ye(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await hh(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=sL()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(dr(this.app))return Promise.reject(eo(this));const n=e?Nt(e):null;return n&&ye(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&ye(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return dr(this.app)?Promise.reject(eo(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return dr(this.app)?Promise.reject(eo(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Xr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await wL(this),n=new SL(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Qu("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await yL(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Xr(e)||this._popupRedirectResolver;ye(n,this,"argument-error"),this.redirectPersistenceManager=await va.create(this,[Xr(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(ye(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,r,i);return()=>{o=!0,l()}}else{const l=e.addObserver(n);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ye(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=T0(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var i;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((i=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:i.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if(dr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&tL(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function tf(t){return Nt(t)}class gE{constructor(e){this.auth=e,this.observer=null,this.addObserver=G2(n=>this.observer=n)}get next(){return ye(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let R_={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function CL(t){R_=t}function AL(t){return R_.loadJS(t)}function RL(){return R_.gapiScript}function PL(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kL(t,e){const n=E_(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),s=n.getOptions();if(co(s,e??{}))return i;Vr(i,"already-initialized")}return n.initialize({options:e})}function NL(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Xr);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function bL(t,e,n){const r=tf(t);ye(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,s=E0(e),{host:o,port:a}=DL(e),l=a===null?"":`:${a}`,u={url:`${s}//${o}${l}/`},p=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){ye(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),ye(co(u,r.config.emulator)&&co(p,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=u,r.emulatorConfig=p,r.settings.appVerificationDisabledForTesting=!0,Xa(o)?(Wx(`${s}//${o}${l}`),Kx("Auth",!0)):ML()}function E0(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function DL(t){const e=E0(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:_E(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:_E(o)}}}function _E(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function ML(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w0{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Yr("not implemented")}_getIdTokenResponse(e){return Yr("not implemented")}_linkToIdToken(e,n){return Yr("not implemented")}_getReauthenticationResolver(e){return Yr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ta(t,e){return uL(t,"POST","/v1/accounts:signInWithIdp",x_(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VL="http://localhost";class fo extends w0{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new fo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Vr("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...s}=n;if(!r||!i)return null;const o=new fo(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Ta(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Ta(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Ta(e,n)}buildRequest(){const e={requestUri:VL,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Yu(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P_{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zu extends P_{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bi extends Zu{constructor(){super("facebook.com")}static credential(e){return fo._fromParams({providerId:Bi.PROVIDER_ID,signInMethod:Bi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Bi.credentialFromTaggedObject(e)}static credentialFromError(e){return Bi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Bi.credential(e.oauthAccessToken)}catch{return null}}}Bi.FACEBOOK_SIGN_IN_METHOD="facebook.com";Bi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kr extends Zu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return fo._fromParams({providerId:Kr.PROVIDER_ID,signInMethod:Kr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Kr.credentialFromTaggedObject(e)}static credentialFromError(e){return Kr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Kr.credential(n,r)}catch{return null}}}Kr.GOOGLE_SIGN_IN_METHOD="google.com";Kr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gi extends Zu{constructor(){super("github.com")}static credential(e){return fo._fromParams({providerId:Gi.PROVIDER_ID,signInMethod:Gi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Gi.credentialFromTaggedObject(e)}static credentialFromError(e){return Gi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Gi.credential(e.oauthAccessToken)}catch{return null}}}Gi.GITHUB_SIGN_IN_METHOD="github.com";Gi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qi extends Zu{constructor(){super("twitter.com")}static credential(e,n){return fo._fromParams({providerId:qi.PROVIDER_ID,signInMethod:qi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return qi.credentialFromTaggedObject(e)}static credentialFromError(e){return qi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return qi.credential(n,r)}catch{return null}}}qi.TWITTER_SIGN_IN_METHOD="twitter.com";qi.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ka{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const s=await hr._fromIdTokenResponse(e,r,i),o=yE(r);return new ka({user:s,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=yE(r);return new ka({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function yE(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fh extends hi{constructor(e,n,r,i){super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,fh.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new fh(e,n,r,i)}}function I0(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?fh._fromErrorAndOperation(t,s,e,r):s})}async function LL(t,e,n=!1){const r=await Nu(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return ka._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function FL(t,e,n=!1){const{auth:r}=t;if(dr(r.app))return Promise.reject(eo(r));const i="reauthenticate";try{const s=await Nu(t,I0(r,i,e,t),n);ye(s.idToken,r,"internal-error");const o=C_(s.idToken);ye(o,r,"internal-error");const{sub:a}=o;return ye(t.uid===a,r,"user-mismatch"),ka._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&Vr(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UL(t,e,n=!1){if(dr(t.app))return Promise.reject(eo(t));const r="signIn",i=await I0(t,r,e),s=await ka._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(s.user),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OL(t,e){return Nt(t).setPersistence(e)}function BL(t,e,n,r){return Nt(t).onIdTokenChanged(e,n,r)}function GL(t,e,n){return Nt(t).beforeAuthStateChanged(e,n)}function qL(t,e,n,r){return Nt(t).onAuthStateChanged(e,n,r)}function vE(t){return Nt(t).signOut()}const ph="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S0{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(ph,"1"),this.storage.removeItem(ph),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zL=1e3,$L=10;class x0 extends S0{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=v0(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;n?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);TL()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,$L):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},zL)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}x0.type="LOCAL";const C0=x0;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A0 extends S0{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}A0.type="SESSION";const R0=A0;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jL(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new nf(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:s}=n.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const a=Array.from(o).map(async u=>u(n.origin,s)),l=await jL(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}nf.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k_(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HL{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,l)=>{const u=k_("",20);i.port1.start();const p=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(m){const g=m;if(g.data.eventId===u)switch(g.data.status){case"ack":clearTimeout(p),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(g.data.response);break;default:clearTimeout(p),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dr(){return window}function WL(t){Dr().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P0(){return typeof Dr().WorkerGlobalScope<"u"&&typeof Dr().importScripts=="function"}async function KL(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function JL(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function QL(){return P0()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k0="firebaseLocalStorageDb",YL=1,mh="firebaseLocalStorage",N0="fbase_key";class ec{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function rf(t,e){return t.transaction([mh],e?"readwrite":"readonly").objectStore(mh)}function XL(){const t=indexedDB.deleteDatabase(k0);return new ec(t).toPromise()}function Gm(){const t=indexedDB.open(k0,YL);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(mh,{keyPath:N0})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(mh)?e(r):(r.close(),await XL(),e(await Gm()))})})}async function TE(t,e,n){const r=rf(t,!0).put({[N0]:e,value:n});return new ec(r).toPromise()}async function ZL(t,e){const n=rf(t,!1).get(e),r=await new ec(n).toPromise();return r===void 0?null:r.value}function EE(t,e){const n=rf(t,!0).delete(e);return new ec(n).toPromise()}const eF=800,tF=3;class b0{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Gm(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>tF)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return P0()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=nf._getInstance(QL()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await KL(),!this.activeServiceWorker)return;this.sender=new HL(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||JL()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Gm();return await TE(e,ph,"1"),await EE(e,ph),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>TE(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>ZL(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>EE(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=rf(i,!1).getAll();return new ec(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),eF)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}b0.type="LOCAL";const nF=b0;new Xu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D0(t,e){return e?Xr(e):(ye(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N_ extends w0{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ta(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Ta(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Ta(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function rF(t){return UL(t.auth,new N_(t),t.bypassAuthState)}function iF(t){const{auth:e,user:n}=t;return ye(n,e,"internal-error"),FL(n,new N_(t),t.bypassAuthState)}async function sF(t){const{auth:e,user:n}=t;return ye(n,e,"internal-error"),LL(n,new N_(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M0{constructor(e,n,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return rF;case"linkViaPopup":case"linkViaRedirect":return sF;case"reauthViaPopup":case"reauthViaRedirect":return iF;default:Vr(this.auth,"internal-error")}}resolve(e){ai(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ai(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oF=new Xu(2e3,1e4);async function aF(t,e,n){if(dr(t.app))return Promise.reject(mr(t,"operation-not-supported-in-this-environment"));const r=tf(t);nL(t,e,P_);const i=D0(r,n);return new Qs(r,"signInViaPopup",e,i).executeNotNull()}class Qs extends M0{constructor(e,n,r,i,s){super(e,n,i,s),this.provider=r,this.authWindow=null,this.pollId=null,Qs.currentPopupAction&&Qs.currentPopupAction.cancel(),Qs.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ye(e,this.auth,"internal-error"),e}async onExecution(){ai(this.filter.length===1,"Popup operations only handle one event");const e=k_();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(mr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(mr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Qs.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(mr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,oF.get())};e()}}Qs.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lF="pendingRedirect",wd=new Map;class uF extends M0{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=wd.get(this.auth._key());if(!e){try{const r=await cF(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}wd.set(this.auth._key(),e)}return this.bypassAuthState||wd.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function cF(t,e){const n=fF(e),r=hF(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}function dF(t,e){wd.set(t._key(),e)}function hF(t){return Xr(t._redirectPersistence)}function fF(t){return Ed(lF,t.config.apiKey,t.name)}async function pF(t,e,n=!1){if(dr(t.app))return Promise.reject(eo(t));const r=tf(t),i=D0(r,e),o=await new uF(r,i,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mF=10*60*1e3;class gF{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!_F(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!V0(e)){const i=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(mr(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=mF&&this.cachedEventUids.clear(),this.cachedEventUids.has(wE(e))}saveEventToCache(e){this.cachedEventUids.add(wE(e)),this.lastProcessedEventTime=Date.now()}}function wE(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function V0({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function _F(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return V0(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yF(t,e={}){return el(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vF=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,TF=/^https?/;async function EF(t){if(t.config.emulator)return;const{authorizedDomains:e}=await yF(t);for(const n of e)try{if(wF(n))return}catch{}Vr(t,"unauthorized-domain")}function wF(t){const e=Om(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!TF.test(n))return!1;if(vF.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IF=new Xu(3e4,6e4);function IE(){const t=Dr().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function SF(t){return new Promise((e,n)=>{var i,s,o;function r(){IE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{IE(),n(mr(t,"network-request-failed"))},timeout:IF.get()})}if((s=(i=Dr().gapi)==null?void 0:i.iframes)!=null&&s.Iframe)e(gapi.iframes.getContext());else if((o=Dr().gapi)!=null&&o.load)r();else{const a=PL("iframefcb");return Dr()[a]=()=>{gapi.load?r():n(mr(t,"network-request-failed"))},AL(`${RL()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw Id=null,e})}let Id=null;function xF(t){return Id=Id||SF(t),Id}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CF=new Xu(5e3,15e3),AF="__/auth/iframe",RF="emulator/auth/iframe",PF={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},kF=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function NF(t){const e=t.config;ye(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?S_(e,RF):`https://${t.config.authDomain}/${AF}`,r={apiKey:e.apiKey,appName:t.name,v:Za},i=kF.get(t.config.apiHost);i&&(r.eid=i);const s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${Yu(r).slice(1)}`}async function bF(t){const e=await xF(t),n=Dr().gapi;return ye(n,t,"internal-error"),e.open({where:document.body,url:NF(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:PF,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=mr(t,"network-request-failed"),a=Dr().setTimeout(()=>{s(o)},CF.get());function l(){Dr().clearTimeout(a),i(r)}r.ping(l).then(l,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DF={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},MF=500,VF=600,LF="_blank",FF="http://localhost";class SE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function UF(t,e,n,r=MF,i=VF){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l={...DF,width:r.toString(),height:i.toString(),top:s,left:o},u=kt().toLowerCase();n&&(a=p0(u)?LF:n),h0(u)&&(e=e||FF,l.scrollbars="yes");const p=Object.entries(l).reduce((g,[v,I])=>`${g}${v}=${I},`,"");if(vL(u)&&a!=="_self")return OF(e||"",a),new SE(null);const m=window.open(e||"",a,p);ye(m,t,"popup-blocked");try{m.focus()}catch{}return new SE(m)}function OF(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BF="__/auth/handler",GF="emulator/auth/handler",qF=encodeURIComponent("fac");async function xE(t,e,n,r,i,s){ye(t.config.authDomain,t,"auth-domain-config-required"),ye(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Za,eventId:i};if(e instanceof P_){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",B2(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[p,m]of Object.entries({}))o[p]=m}if(e instanceof Zu){const p=e.getScopes().filter(m=>m!=="");p.length>0&&(o.scopes=p.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const p of Object.keys(a))a[p]===void 0&&delete a[p];const l=await t._getAppCheckToken(),u=l?`#${qF}=${encodeURIComponent(l)}`:"";return`${zF(t)}?${Yu(a).slice(1)}${u}`}function zF({config:t}){return t.emulator?S_(t,GF):`https://${t.authDomain}/${BF}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ep="webStorageSupport";class $F{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=R0,this._completeRedirectFn=pF,this._overrideRedirectResult=dF}async _openPopup(e,n,r,i){var o;ai((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const s=await xE(e,n,r,Om(),i);return UF(e,s,k_())}async _openRedirect(e,n,r,i){await this._originValidation(e);const s=await xE(e,n,r,Om(),i);return WL(s),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:s}=this.eventManagers[n];return i?Promise.resolve(i):(ai(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await bF(e),r=new gF(e);return n.register("authEvent",i=>(ye(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Ep,{type:Ep},i=>{var o;const s=(o=i==null?void 0:i[0])==null?void 0:o[Ep];s!==void 0&&n(!!s),Vr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=EF(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return v0()||f0()||A_()}}const jF=$F;var CE="@firebase/auth",AE="1.11.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HF{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){ye(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WF(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function KF(t){Pa(new ho("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;ye(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:T0(t)},u=new xL(r,i,s,l);return NL(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Pa(new ho("auth-internal",e=>{const n=tf(e.getProvider("auth").getImmediate());return(r=>new HF(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),rs(CE,AE,WF(t)),rs(CE,AE,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JF=5*60,QF=Hx("authIdTokenMaxAge")||JF;let RE=null;const YF=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>QF)return;const i=n==null?void 0:n.token;RE!==i&&(RE=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function XF(t=n0()){const e=E_(t,"auth");if(e.isInitialized())return e.getImmediate();const n=kL(t,{popupRedirectResolver:jF,persistence:[nF,C0,R0]}),r=Hx("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const o=YF(s.toString());GL(n,o,()=>o(n.currentUser)),BL(n,a=>o(a))}}const i=$x("auth");return i&&bL(n,`http://${i}`),n}function ZF(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}CL({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const s=mr("internal-error");s.customData=i,n(s)},r.type="text/javascript",r.charset="UTF-8",ZF().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});KF("Browser");var PE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var is,L0;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(E,x){function R(){}R.prototype=x.prototype,E.F=x.prototype,E.prototype=new R,E.prototype.constructor=E,E.D=function(N,M,U){for(var b=Array(arguments.length-2),xe=2;xe<arguments.length;xe++)b[xe-2]=arguments[xe];return x.prototype[M].apply(N,b)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(E,x,R){R||(R=0);const N=Array(16);if(typeof x=="string")for(var M=0;M<16;++M)N[M]=x.charCodeAt(R++)|x.charCodeAt(R++)<<8|x.charCodeAt(R++)<<16|x.charCodeAt(R++)<<24;else for(M=0;M<16;++M)N[M]=x[R++]|x[R++]<<8|x[R++]<<16|x[R++]<<24;x=E.g[0],R=E.g[1],M=E.g[2];let U=E.g[3],b;b=x+(U^R&(M^U))+N[0]+3614090360&4294967295,x=R+(b<<7&4294967295|b>>>25),b=U+(M^x&(R^M))+N[1]+3905402710&4294967295,U=x+(b<<12&4294967295|b>>>20),b=M+(R^U&(x^R))+N[2]+606105819&4294967295,M=U+(b<<17&4294967295|b>>>15),b=R+(x^M&(U^x))+N[3]+3250441966&4294967295,R=M+(b<<22&4294967295|b>>>10),b=x+(U^R&(M^U))+N[4]+4118548399&4294967295,x=R+(b<<7&4294967295|b>>>25),b=U+(M^x&(R^M))+N[5]+1200080426&4294967295,U=x+(b<<12&4294967295|b>>>20),b=M+(R^U&(x^R))+N[6]+2821735955&4294967295,M=U+(b<<17&4294967295|b>>>15),b=R+(x^M&(U^x))+N[7]+4249261313&4294967295,R=M+(b<<22&4294967295|b>>>10),b=x+(U^R&(M^U))+N[8]+1770035416&4294967295,x=R+(b<<7&4294967295|b>>>25),b=U+(M^x&(R^M))+N[9]+2336552879&4294967295,U=x+(b<<12&4294967295|b>>>20),b=M+(R^U&(x^R))+N[10]+4294925233&4294967295,M=U+(b<<17&4294967295|b>>>15),b=R+(x^M&(U^x))+N[11]+2304563134&4294967295,R=M+(b<<22&4294967295|b>>>10),b=x+(U^R&(M^U))+N[12]+1804603682&4294967295,x=R+(b<<7&4294967295|b>>>25),b=U+(M^x&(R^M))+N[13]+4254626195&4294967295,U=x+(b<<12&4294967295|b>>>20),b=M+(R^U&(x^R))+N[14]+2792965006&4294967295,M=U+(b<<17&4294967295|b>>>15),b=R+(x^M&(U^x))+N[15]+1236535329&4294967295,R=M+(b<<22&4294967295|b>>>10),b=x+(M^U&(R^M))+N[1]+4129170786&4294967295,x=R+(b<<5&4294967295|b>>>27),b=U+(R^M&(x^R))+N[6]+3225465664&4294967295,U=x+(b<<9&4294967295|b>>>23),b=M+(x^R&(U^x))+N[11]+643717713&4294967295,M=U+(b<<14&4294967295|b>>>18),b=R+(U^x&(M^U))+N[0]+3921069994&4294967295,R=M+(b<<20&4294967295|b>>>12),b=x+(M^U&(R^M))+N[5]+3593408605&4294967295,x=R+(b<<5&4294967295|b>>>27),b=U+(R^M&(x^R))+N[10]+38016083&4294967295,U=x+(b<<9&4294967295|b>>>23),b=M+(x^R&(U^x))+N[15]+3634488961&4294967295,M=U+(b<<14&4294967295|b>>>18),b=R+(U^x&(M^U))+N[4]+3889429448&4294967295,R=M+(b<<20&4294967295|b>>>12),b=x+(M^U&(R^M))+N[9]+568446438&4294967295,x=R+(b<<5&4294967295|b>>>27),b=U+(R^M&(x^R))+N[14]+3275163606&4294967295,U=x+(b<<9&4294967295|b>>>23),b=M+(x^R&(U^x))+N[3]+4107603335&4294967295,M=U+(b<<14&4294967295|b>>>18),b=R+(U^x&(M^U))+N[8]+1163531501&4294967295,R=M+(b<<20&4294967295|b>>>12),b=x+(M^U&(R^M))+N[13]+2850285829&4294967295,x=R+(b<<5&4294967295|b>>>27),b=U+(R^M&(x^R))+N[2]+4243563512&4294967295,U=x+(b<<9&4294967295|b>>>23),b=M+(x^R&(U^x))+N[7]+1735328473&4294967295,M=U+(b<<14&4294967295|b>>>18),b=R+(U^x&(M^U))+N[12]+2368359562&4294967295,R=M+(b<<20&4294967295|b>>>12),b=x+(R^M^U)+N[5]+4294588738&4294967295,x=R+(b<<4&4294967295|b>>>28),b=U+(x^R^M)+N[8]+2272392833&4294967295,U=x+(b<<11&4294967295|b>>>21),b=M+(U^x^R)+N[11]+1839030562&4294967295,M=U+(b<<16&4294967295|b>>>16),b=R+(M^U^x)+N[14]+4259657740&4294967295,R=M+(b<<23&4294967295|b>>>9),b=x+(R^M^U)+N[1]+2763975236&4294967295,x=R+(b<<4&4294967295|b>>>28),b=U+(x^R^M)+N[4]+1272893353&4294967295,U=x+(b<<11&4294967295|b>>>21),b=M+(U^x^R)+N[7]+4139469664&4294967295,M=U+(b<<16&4294967295|b>>>16),b=R+(M^U^x)+N[10]+3200236656&4294967295,R=M+(b<<23&4294967295|b>>>9),b=x+(R^M^U)+N[13]+681279174&4294967295,x=R+(b<<4&4294967295|b>>>28),b=U+(x^R^M)+N[0]+3936430074&4294967295,U=x+(b<<11&4294967295|b>>>21),b=M+(U^x^R)+N[3]+3572445317&4294967295,M=U+(b<<16&4294967295|b>>>16),b=R+(M^U^x)+N[6]+76029189&4294967295,R=M+(b<<23&4294967295|b>>>9),b=x+(R^M^U)+N[9]+3654602809&4294967295,x=R+(b<<4&4294967295|b>>>28),b=U+(x^R^M)+N[12]+3873151461&4294967295,U=x+(b<<11&4294967295|b>>>21),b=M+(U^x^R)+N[15]+530742520&4294967295,M=U+(b<<16&4294967295|b>>>16),b=R+(M^U^x)+N[2]+3299628645&4294967295,R=M+(b<<23&4294967295|b>>>9),b=x+(M^(R|~U))+N[0]+4096336452&4294967295,x=R+(b<<6&4294967295|b>>>26),b=U+(R^(x|~M))+N[7]+1126891415&4294967295,U=x+(b<<10&4294967295|b>>>22),b=M+(x^(U|~R))+N[14]+2878612391&4294967295,M=U+(b<<15&4294967295|b>>>17),b=R+(U^(M|~x))+N[5]+4237533241&4294967295,R=M+(b<<21&4294967295|b>>>11),b=x+(M^(R|~U))+N[12]+1700485571&4294967295,x=R+(b<<6&4294967295|b>>>26),b=U+(R^(x|~M))+N[3]+2399980690&4294967295,U=x+(b<<10&4294967295|b>>>22),b=M+(x^(U|~R))+N[10]+4293915773&4294967295,M=U+(b<<15&4294967295|b>>>17),b=R+(U^(M|~x))+N[1]+2240044497&4294967295,R=M+(b<<21&4294967295|b>>>11),b=x+(M^(R|~U))+N[8]+1873313359&4294967295,x=R+(b<<6&4294967295|b>>>26),b=U+(R^(x|~M))+N[15]+4264355552&4294967295,U=x+(b<<10&4294967295|b>>>22),b=M+(x^(U|~R))+N[6]+2734768916&4294967295,M=U+(b<<15&4294967295|b>>>17),b=R+(U^(M|~x))+N[13]+1309151649&4294967295,R=M+(b<<21&4294967295|b>>>11),b=x+(M^(R|~U))+N[4]+4149444226&4294967295,x=R+(b<<6&4294967295|b>>>26),b=U+(R^(x|~M))+N[11]+3174756917&4294967295,U=x+(b<<10&4294967295|b>>>22),b=M+(x^(U|~R))+N[2]+718787259&4294967295,M=U+(b<<15&4294967295|b>>>17),b=R+(U^(M|~x))+N[9]+3951481745&4294967295,E.g[0]=E.g[0]+x&4294967295,E.g[1]=E.g[1]+(M+(b<<21&4294967295|b>>>11))&4294967295,E.g[2]=E.g[2]+M&4294967295,E.g[3]=E.g[3]+U&4294967295}r.prototype.v=function(E,x){x===void 0&&(x=E.length);const R=x-this.blockSize,N=this.C;let M=this.h,U=0;for(;U<x;){if(M==0)for(;U<=R;)i(this,E,U),U+=this.blockSize;if(typeof E=="string"){for(;U<x;)if(N[M++]=E.charCodeAt(U++),M==this.blockSize){i(this,N),M=0;break}}else for(;U<x;)if(N[M++]=E[U++],M==this.blockSize){i(this,N),M=0;break}}this.h=M,this.o+=x},r.prototype.A=function(){var E=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);E[0]=128;for(var x=1;x<E.length-8;++x)E[x]=0;x=this.o*8;for(var R=E.length-8;R<E.length;++R)E[R]=x&255,x/=256;for(this.v(E),E=Array(16),x=0,R=0;R<4;++R)for(let N=0;N<32;N+=8)E[x++]=this.g[R]>>>N&255;return E};function s(E,x){var R=a;return Object.prototype.hasOwnProperty.call(R,E)?R[E]:R[E]=x(E)}function o(E,x){this.h=x;const R=[];let N=!0;for(let M=E.length-1;M>=0;M--){const U=E[M]|0;N&&U==x||(R[M]=U,N=!1)}this.g=R}var a={};function l(E){return-128<=E&&E<128?s(E,function(x){return new o([x|0],x<0?-1:0)}):new o([E|0],E<0?-1:0)}function u(E){if(isNaN(E)||!isFinite(E))return m;if(E<0)return V(u(-E));const x=[];let R=1;for(let N=0;E>=R;N++)x[N]=E/R|0,R*=4294967296;return new o(x,0)}function p(E,x){if(E.length==0)throw Error("number format error: empty string");if(x=x||10,x<2||36<x)throw Error("radix out of range: "+x);if(E.charAt(0)=="-")return V(p(E.substring(1),x));if(E.indexOf("-")>=0)throw Error('number format error: interior "-" character');const R=u(Math.pow(x,8));let N=m;for(let U=0;U<E.length;U+=8){var M=Math.min(8,E.length-U);const b=parseInt(E.substring(U,U+M),x);M<8?(M=u(Math.pow(x,M)),N=N.j(M).add(u(b))):(N=N.j(R),N=N.add(u(b)))}return N}var m=l(0),g=l(1),v=l(16777216);t=o.prototype,t.m=function(){if(P(this))return-V(this).m();let E=0,x=1;for(let R=0;R<this.g.length;R++){const N=this.i(R);E+=(N>=0?N:4294967296+N)*x,x*=4294967296}return E},t.toString=function(E){if(E=E||10,E<2||36<E)throw Error("radix out of range: "+E);if(I(this))return"0";if(P(this))return"-"+V(this).toString(E);const x=u(Math.pow(E,6));var R=this;let N="";for(;;){const M=L(R,x).g;R=C(R,M.j(x));let U=((R.g.length>0?R.g[0]:R.h)>>>0).toString(E);if(R=M,I(R))return U+N;for(;U.length<6;)U="0"+U;N=U+N}},t.i=function(E){return E<0?0:E<this.g.length?this.g[E]:this.h};function I(E){if(E.h!=0)return!1;for(let x=0;x<E.g.length;x++)if(E.g[x]!=0)return!1;return!0}function P(E){return E.h==-1}t.l=function(E){return E=C(this,E),P(E)?-1:I(E)?0:1};function V(E){const x=E.g.length,R=[];for(let N=0;N<x;N++)R[N]=~E.g[N];return new o(R,~E.h).add(g)}t.abs=function(){return P(this)?V(this):this},t.add=function(E){const x=Math.max(this.g.length,E.g.length),R=[];let N=0;for(let M=0;M<=x;M++){let U=N+(this.i(M)&65535)+(E.i(M)&65535),b=(U>>>16)+(this.i(M)>>>16)+(E.i(M)>>>16);N=b>>>16,U&=65535,b&=65535,R[M]=b<<16|U}return new o(R,R[R.length-1]&-2147483648?-1:0)};function C(E,x){return E.add(V(x))}t.j=function(E){if(I(this)||I(E))return m;if(P(this))return P(E)?V(this).j(V(E)):V(V(this).j(E));if(P(E))return V(this.j(V(E)));if(this.l(v)<0&&E.l(v)<0)return u(this.m()*E.m());const x=this.g.length+E.g.length,R=[];for(var N=0;N<2*x;N++)R[N]=0;for(N=0;N<this.g.length;N++)for(let M=0;M<E.g.length;M++){const U=this.i(N)>>>16,b=this.i(N)&65535,xe=E.i(M)>>>16,Ye=E.i(M)&65535;R[2*N+2*M]+=b*Ye,S(R,2*N+2*M),R[2*N+2*M+1]+=U*Ye,S(R,2*N+2*M+1),R[2*N+2*M+1]+=b*xe,S(R,2*N+2*M+1),R[2*N+2*M+2]+=U*xe,S(R,2*N+2*M+2)}for(E=0;E<x;E++)R[E]=R[2*E+1]<<16|R[2*E];for(E=x;E<2*x;E++)R[E]=0;return new o(R,0)};function S(E,x){for(;(E[x]&65535)!=E[x];)E[x+1]+=E[x]>>>16,E[x]&=65535,x++}function A(E,x){this.g=E,this.h=x}function L(E,x){if(I(x))throw Error("division by zero");if(I(E))return new A(m,m);if(P(E))return x=L(V(E),x),new A(V(x.g),V(x.h));if(P(x))return x=L(E,V(x)),new A(V(x.g),x.h);if(E.g.length>30){if(P(E)||P(x))throw Error("slowDivide_ only works with positive integers.");for(var R=g,N=x;N.l(E)<=0;)R=q(R),N=q(N);var M=z(R,1),U=z(N,1);for(N=z(N,2),R=z(R,2);!I(N);){var b=U.add(N);b.l(E)<=0&&(M=M.add(R),U=b),N=z(N,1),R=z(R,1)}return x=C(E,M.j(x)),new A(M,x)}for(M=m;E.l(x)>=0;){for(R=Math.max(1,Math.floor(E.m()/x.m())),N=Math.ceil(Math.log(R)/Math.LN2),N=N<=48?1:Math.pow(2,N-48),U=u(R),b=U.j(x);P(b)||b.l(E)>0;)R-=N,U=u(R),b=U.j(x);I(U)&&(U=g),M=M.add(U),E=C(E,b)}return new A(M,E)}t.B=function(E){return L(this,E).h},t.and=function(E){const x=Math.max(this.g.length,E.g.length),R=[];for(let N=0;N<x;N++)R[N]=this.i(N)&E.i(N);return new o(R,this.h&E.h)},t.or=function(E){const x=Math.max(this.g.length,E.g.length),R=[];for(let N=0;N<x;N++)R[N]=this.i(N)|E.i(N);return new o(R,this.h|E.h)},t.xor=function(E){const x=Math.max(this.g.length,E.g.length),R=[];for(let N=0;N<x;N++)R[N]=this.i(N)^E.i(N);return new o(R,this.h^E.h)};function q(E){const x=E.g.length+1,R=[];for(let N=0;N<x;N++)R[N]=E.i(N)<<1|E.i(N-1)>>>31;return new o(R,E.h)}function z(E,x){const R=x>>5;x%=32;const N=E.g.length-R,M=[];for(let U=0;U<N;U++)M[U]=x>0?E.i(U+R)>>>x|E.i(U+R+1)<<32-x:E.i(U+R);return new o(M,E.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,L0=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=p,is=o}).apply(typeof PE<"u"?PE:typeof self<"u"?self:typeof window<"u"?window:{});var Zc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var F0,Ol,U0,Sd,qm,O0,B0,G0;(function(){var t,e=Object.defineProperty;function n(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof Zc=="object"&&Zc];for(var _=0;_<c.length;++_){var y=c[_];if(y&&y.Math==Math)return y}throw Error("Cannot find global object")}var r=n(this);function i(c,_){if(_)e:{var y=r;c=c.split(".");for(var w=0;w<c.length-1;w++){var D=c[w];if(!(D in y))break e;y=y[D]}c=c[c.length-1],w=y[c],_=_(w),_!=w&&_!=null&&e(y,c,{configurable:!0,writable:!0,value:_})}}i("Symbol.dispose",function(c){return c||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(c){return c||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(c){return c||function(_){var y=[],w;for(w in _)Object.prototype.hasOwnProperty.call(_,w)&&y.push([w,_[w]]);return y}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var s=s||{},o=this||self;function a(c){var _=typeof c;return _=="object"&&c!=null||_=="function"}function l(c,_,y){return c.call.apply(c.bind,arguments)}function u(c,_,y){return u=l,u.apply(null,arguments)}function p(c,_){var y=Array.prototype.slice.call(arguments,1);return function(){var w=y.slice();return w.push.apply(w,arguments),c.apply(this,w)}}function m(c,_){function y(){}y.prototype=_.prototype,c.Z=_.prototype,c.prototype=new y,c.prototype.constructor=c,c.Ob=function(w,D,F){for(var X=Array(arguments.length-2),me=2;me<arguments.length;me++)X[me-2]=arguments[me];return _.prototype[D].apply(w,X)}}var g=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?c=>c&&AsyncContext.Snapshot.wrap(c):c=>c;function v(c){const _=c.length;if(_>0){const y=Array(_);for(let w=0;w<_;w++)y[w]=c[w];return y}return[]}function I(c,_){for(let w=1;w<arguments.length;w++){const D=arguments[w];var y=typeof D;if(y=y!="object"?y:D?Array.isArray(D)?"array":y:"null",y=="array"||y=="object"&&typeof D.length=="number"){y=c.length||0;const F=D.length||0;c.length=y+F;for(let X=0;X<F;X++)c[y+X]=D[X]}else c.push(D)}}class P{constructor(_,y){this.i=_,this.j=y,this.h=0,this.g=null}get(){let _;return this.h>0?(this.h--,_=this.g,this.g=_.next,_.next=null):_=this.i(),_}}function V(c){o.setTimeout(()=>{throw c},0)}function C(){var c=E;let _=null;return c.g&&(_=c.g,c.g=c.g.next,c.g||(c.h=null),_.next=null),_}class S{constructor(){this.h=this.g=null}add(_,y){const w=A.get();w.set(_,y),this.h?this.h.next=w:this.g=w,this.h=w}}var A=new P(()=>new L,c=>c.reset());class L{constructor(){this.next=this.g=this.h=null}set(_,y){this.h=_,this.g=y,this.next=null}reset(){this.next=this.g=this.h=null}}let q,z=!1,E=new S,x=()=>{const c=Promise.resolve(void 0);q=()=>{c.then(R)}};function R(){for(var c;c=C();){try{c.h.call(c.g)}catch(y){V(y)}var _=A;_.j(c),_.h<100&&(_.h++,c.next=_.g,_.g=c)}z=!1}function N(){this.u=this.u,this.C=this.C}N.prototype.u=!1,N.prototype.dispose=function(){this.u||(this.u=!0,this.N())},N.prototype[Symbol.dispose]=function(){this.dispose()},N.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function M(c,_){this.type=c,this.g=this.target=_,this.defaultPrevented=!1}M.prototype.h=function(){this.defaultPrevented=!0};var U=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var c=!1,_=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const y=()=>{};o.addEventListener("test",y,_),o.removeEventListener("test",y,_)}catch{}return c}();function b(c){return/^[\s\xa0]*$/.test(c)}function xe(c,_){M.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c&&this.init(c,_)}m(xe,M),xe.prototype.init=function(c,_){const y=this.type=c.type,w=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;this.target=c.target||c.srcElement,this.g=_,_=c.relatedTarget,_||(y=="mouseover"?_=c.fromElement:y=="mouseout"&&(_=c.toElement)),this.relatedTarget=_,w?(this.clientX=w.clientX!==void 0?w.clientX:w.pageX,this.clientY=w.clientY!==void 0?w.clientY:w.pageY,this.screenX=w.screenX||0,this.screenY=w.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=c.pointerType,this.state=c.state,this.i=c,c.defaultPrevented&&xe.Z.h.call(this)},xe.prototype.h=function(){xe.Z.h.call(this);const c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var Ye="closure_listenable_"+(Math.random()*1e6|0),Ue=0;function Ee(c,_,y,w,D){this.listener=c,this.proxy=null,this.src=_,this.type=y,this.capture=!!w,this.ha=D,this.key=++Ue,this.da=this.fa=!1}function Z(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function he(c,_,y){for(const w in c)_.call(y,c[w],w,c)}function fe(c,_){for(const y in c)_.call(void 0,c[y],y,c)}function Ce(c){const _={};for(const y in c)_[y]=c[y];return _}const Le="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function At(c,_){let y,w;for(let D=1;D<arguments.length;D++){w=arguments[D];for(y in w)c[y]=w[y];for(let F=0;F<Le.length;F++)y=Le[F],Object.prototype.hasOwnProperty.call(w,y)&&(c[y]=w[y])}}function Oe(c){this.src=c,this.g={},this.h=0}Oe.prototype.add=function(c,_,y,w,D){const F=c.toString();c=this.g[F],c||(c=this.g[F]=[],this.h++);const X=Ne(c,_,w,D);return X>-1?(_=c[X],y||(_.fa=!1)):(_=new Ee(_,this.src,F,!!w,D),_.fa=y,c.push(_)),_};function Dt(c,_){const y=_.type;if(y in c.g){var w=c.g[y],D=Array.prototype.indexOf.call(w,_,void 0),F;(F=D>=0)&&Array.prototype.splice.call(w,D,1),F&&(Z(_),c.g[y].length==0&&(delete c.g[y],c.h--))}}function Ne(c,_,y,w){for(let D=0;D<c.length;++D){const F=c[D];if(!F.da&&F.listener==_&&F.capture==!!y&&F.ha==w)return D}return-1}var je="closure_lm_"+(Math.random()*1e6|0),Ut={};function Ot(c,_,y,w,D){if(Array.isArray(_)){for(let F=0;F<_.length;F++)Ot(c,_[F],y,w,D);return null}return y=Re(y),c&&c[Ye]?c.J(_,y,a(w)?!!w.capture:!1,D):In(c,_,y,!1,w,D)}function In(c,_,y,w,D,F){if(!_)throw Error("Invalid event type");const X=a(D)?!!D.capture:!!D;let me=Sn(c);if(me||(c[je]=me=new Oe(c)),y=me.add(_,y,w,X,F),y.proxy)return y;if(w=er(),y.proxy=w,w.src=c,w.listener=y,c.addEventListener)U||(D=X),D===void 0&&(D=!1),c.addEventListener(_.toString(),w,D);else if(c.attachEvent)c.attachEvent(Je(_.toString()),w);else if(c.addListener&&c.removeListener)c.addListener(w);else throw Error("addEventListener and attachEvent are unavailable.");return y}function er(){function c(y){return _.call(c.src,c.listener,y)}const _=Tr;return c}function _t(c,_,y,w,D){if(Array.isArray(_))for(var F=0;F<_.length;F++)_t(c,_[F],y,w,D);else w=a(w)?!!w.capture:!!w,y=Re(y),c&&c[Ye]?(c=c.i,F=String(_).toString(),F in c.g&&(_=c.g[F],y=Ne(_,y,w,D),y>-1&&(Z(_[y]),Array.prototype.splice.call(_,y,1),_.length==0&&(delete c.g[F],c.h--)))):c&&(c=Sn(c))&&(_=c.g[_.toString()],c=-1,_&&(c=Ne(_,y,w,D)),(y=c>-1?_[c]:null)&&ae(y))}function ae(c){if(typeof c!="number"&&c&&!c.da){var _=c.src;if(_&&_[Ye])Dt(_.i,c);else{var y=c.type,w=c.proxy;_.removeEventListener?_.removeEventListener(y,w,c.capture):_.detachEvent?_.detachEvent(Je(y),w):_.addListener&&_.removeListener&&_.removeListener(w),(y=Sn(_))?(Dt(y,c),y.h==0&&(y.src=null,_[je]=null)):Z(c)}}}function Je(c){return c in Ut?Ut[c]:Ut[c]="on"+c}function Tr(c,_){if(c.da)c=!0;else{_=new xe(_,this);const y=c.listener,w=c.ha||c.src;c.fa&&ae(c),c=y.call(w,_)}return c}function Sn(c){return c=c[je],c instanceof Oe?c:null}var tr="__closure_events_fn_"+(Math.random()*1e9>>>0);function Re(c){return typeof c=="function"?c:(c[tr]||(c[tr]=function(_){return c.handleEvent(_)}),c[tr])}function Ge(){N.call(this),this.i=new Oe(this),this.M=this,this.G=null}m(Ge,N),Ge.prototype[Ye]=!0,Ge.prototype.removeEventListener=function(c,_,y,w){_t(this,c,_,y,w)};function qe(c,_){var y,w=c.G;if(w)for(y=[];w;w=w.G)y.push(w);if(c=c.M,w=_.type||_,typeof _=="string")_=new M(_,c);else if(_ instanceof M)_.target=_.target||c;else{var D=_;_=new M(w,c),At(_,D)}D=!0;let F,X;if(y)for(X=y.length-1;X>=0;X--)F=_.g=y[X],D=on(F,w,!0,_)&&D;if(F=_.g=c,D=on(F,w,!0,_)&&D,D=on(F,w,!1,_)&&D,y)for(X=0;X<y.length;X++)F=_.g=y[X],D=on(F,w,!1,_)&&D}Ge.prototype.N=function(){if(Ge.Z.N.call(this),this.i){var c=this.i;for(const _ in c.g){const y=c.g[_];for(let w=0;w<y.length;w++)Z(y[w]);delete c.g[_],c.h--}}this.G=null},Ge.prototype.J=function(c,_,y,w){return this.i.add(String(c),_,!1,y,w)},Ge.prototype.K=function(c,_,y,w){return this.i.add(String(c),_,!0,y,w)};function on(c,_,y,w){if(_=c.i.g[String(_)],!_)return!0;_=_.concat();let D=!0;for(let F=0;F<_.length;++F){const X=_[F];if(X&&!X.da&&X.capture==y){const me=X.listener,Pe=X.ha||X.src;X.fa&&Dt(c.i,X),D=me.call(Pe,w)!==!1&&D}}return D&&!w.defaultPrevented}function nr(c,_){if(typeof c!="function")if(c&&typeof c.handleEvent=="function")c=u(c.handleEvent,c);else throw Error("Invalid listener argument");return Number(_)>2147483647?-1:o.setTimeout(c,_||0)}function gn(c){c.g=nr(()=>{c.g=null,c.i&&(c.i=!1,gn(c))},c.l);const _=c.h;c.h=null,c.m.apply(null,_)}class an extends N{constructor(_,y){super(),this.m=_,this.l=y,this.h=null,this.i=!1,this.g=null}j(_){this.h=arguments,this.g?this.i=!0:gn(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Fn(c){N.call(this),this.h=c,this.g={}}m(Fn,N);var Qe=[];function xs(c){he(c.g,function(_,y){this.g.hasOwnProperty(y)&&ae(_)},c),c.g={}}Fn.prototype.N=function(){Fn.Z.N.call(this),xs(this)},Fn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Et=o.JSON.stringify,_e=o.JSON.parse,gi=class{stringify(c){return o.JSON.stringify(c,void 0)}parse(c){return o.JSON.parse(c,void 0)}};function Ur(){}function Er(){}var Un={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function xn(){M.call(this,"d")}m(xn,M);function we(){M.call(this,"c")}m(we,M);var Cn={},rr=null;function Or(){return rr=rr||new Ge}Cn.Ia="serverreachability";function le(c){M.call(this,Cn.Ia,c)}m(le,M);function rt(c){const _=Or();qe(_,new le(_))}Cn.STAT_EVENT="statevent";function _i(c,_){M.call(this,Cn.STAT_EVENT,c),this.stat=_}m(_i,M);function Bt(c){const _=Or();qe(_,new _i(_,c))}Cn.Ja="timingevent";function gc(c,_){M.call(this,Cn.Ja,c),this.size=_}m(gc,M);function Cs(c,_){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){c()},_)}function Br(){this.g=!0}Br.prototype.ua=function(){this.g=!1};function As(c,_,y,w,D,F){c.info(function(){if(c.g)if(F){var X="",me=F.split("&");for(let Ae=0;Ae<me.length;Ae++){var Pe=me[Ae].split("=");if(Pe.length>1){const tt=Pe[0];Pe=Pe[1];const zn=tt.split("_");X=zn.length>=2&&zn[1]=="type"?X+(tt+"="+Pe+"&"):X+(tt+"=redacted&")}}}else X=null;else X=F;return"XMLHTTP REQ ("+w+") [attempt "+D+"]: "+_+`
`+y+`
`+X})}function il(c,_,y,w,D,F,X){c.info(function(){return"XMLHTTP RESP ("+w+") [ attempt "+D+"]: "+_+`
`+y+`
`+F+" "+X})}function yi(c,_,y,w){c.info(function(){return"XMLHTTP TEXT ("+_+"): "+vi(c,y)+(w?" "+w:"")})}function _c(c,_){c.info(function(){return"TIMEOUT: "+_})}Br.prototype.info=function(){};function vi(c,_){if(!c.g)return _;if(!_)return null;try{const F=JSON.parse(_);if(F){for(c=0;c<F.length;c++)if(Array.isArray(F[c])){var y=F[c];if(!(y.length<2)){var w=y[1];if(Array.isArray(w)&&!(w.length<1)){var D=w[0];if(D!="noop"&&D!="stop"&&D!="close")for(let X=1;X<w.length;X++)w[X]=""}}}}return Et(F)}catch{return _}}var wr={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Ti={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},sl;function Ei(){}m(Ei,Ur),Ei.prototype.g=function(){return new XMLHttpRequest},sl=new Ei;function wi(c){return encodeURIComponent(String(c))}function Rf(c){var _=1;c=c.split(":");const y=[];for(;_>0&&c.length;)y.push(c.shift()),_--;return c.length&&y.push(c.join(":")),y}function ir(c,_,y,w){this.j=c,this.i=_,this.l=y,this.S=w||1,this.V=new Fn(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new J}function J(){this.i=null,this.g="",this.h=!1}var Rs={},yc={};function vc(c,_,y){c.M=1,c.A=Bn(sr(_)),c.u=y,c.R=!0,Pf(c,null)}function Pf(c,_){c.F=Date.now(),xo(c),c.B=sr(c.A);var y=c.B,w=c.S;Array.isArray(w)||(w=[String(w)]),Ci(y.i,"t",w),c.C=0,y=c.j.L,c.h=new J,c.g=B(c.j,y?_:null,!c.u),c.P>0&&(c.O=new an(u(c.Y,c,c.g),c.P)),_=c.V,y=c.g,w=c.ba;var D="readystatechange";Array.isArray(D)||(D&&(Qe[0]=D.toString()),D=Qe);for(let F=0;F<D.length;F++){const X=Ot(y,D[F],w||_.handleEvent,!1,_.h||_);if(!X)break;_.g[X.key]=X}_=c.J?Ce(c.J):{},c.u?(c.v||(c.v="POST"),_["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.B,c.v,c.u,_)):(c.v="GET",c.g.ea(c.B,c.v,null,_)),rt(),As(c.i,c.v,c.B,c.l,c.S,c.u)}ir.prototype.ba=function(c){c=c.target;const _=this.O;_&&Ir(c)==3?_.j():this.Y(c)},ir.prototype.Y=function(c){try{if(c==this.g)e:{const me=Ir(this.g),Pe=this.g.ya(),Ae=this.g.ca();if(!(me<3)&&(me!=3||this.g&&(this.h.h||this.g.la()||Cc(this.g)))){this.K||me!=4||Pe==7||(Pe==8||Ae<=0?rt(3):rt(2)),ks(this);var _=this.g.ca();this.X=_;var y=Iy(this);if(this.o=_==200,il(this.i,this.v,this.B,this.l,this.S,me,_),this.o){if(this.U&&!this.L){t:{if(this.g){var w,D=this.g;if((w=D.g?D.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!b(w)){var F=w;break t}}F=null}if(c=F)yi(this.i,this.l,c,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Ns(this,c);else{this.o=!1,this.m=3,Bt(12),Gr(this),Xe(this);break e}}if(this.R){c=!0;let tt;for(;!this.K&&this.C<y.length;)if(tt=So(this,y),tt==yc){me==4&&(this.m=4,Bt(14),c=!1),yi(this.i,this.l,null,"[Incomplete Response]");break}else if(tt==Rs){this.m=4,Bt(15),yi(this.i,this.l,y,"[Invalid Chunk]"),c=!1;break}else yi(this.i,this.l,tt,null),Ns(this,tt);if(Tc(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),me!=4||y.length!=0||this.h.h||(this.m=1,Bt(16),c=!1),this.o=this.o&&c,!c)yi(this.i,this.l,y,"[Invalid Chunked Response]"),Gr(this),Xe(this);else if(y.length>0&&!this.W){this.W=!0;var X=this.j;X.g==this&&X.aa&&!X.P&&(X.j.info("Great, no buffering proxy detected. Bytes received: "+y.length),Tl(X),X.P=!0,Bt(11))}}else yi(this.i,this.l,y,null),Ns(this,y);me==4&&Gr(this),this.o&&!this.K&&(me==4?Dc(this.j,this):(this.o=!1,xo(this)))}else Gf(this.g),_==400&&y.indexOf("Unknown SID")>0?(this.m=3,Bt(12)):(this.m=0,Bt(13)),Gr(this),Xe(this)}}}catch{}finally{}};function Iy(c){if(!Tc(c))return c.g.la();const _=Cc(c.g);if(_==="")return"";let y="";const w=_.length,D=Ir(c.g)==4;if(!c.h.i){if(typeof TextDecoder>"u")return Gr(c),Xe(c),"";c.h.i=new o.TextDecoder}for(let F=0;F<w;F++)c.h.h=!0,y+=c.h.i.decode(_[F],{stream:!(D&&F==w-1)});return _.length=0,c.h.g+=y,c.C=0,c.h.g}function Tc(c){return c.g?c.v=="GET"&&c.M!=2&&c.j.Aa:!1}function So(c,_){var y=c.C,w=_.indexOf(`
`,y);return w==-1?yc:(y=Number(_.substring(y,w)),isNaN(y)?Rs:(w+=1,w+y>_.length?yc:(_=_.slice(w,w+y),c.C=w+y,_)))}ir.prototype.cancel=function(){this.K=!0,Gr(this)};function xo(c){c.T=Date.now()+c.H,Ps(c,c.H)}function Ps(c,_){if(c.D!=null)throw Error("WatchDog timer not null");c.D=Cs(u(c.aa,c),_)}function ks(c){c.D&&(o.clearTimeout(c.D),c.D=null)}ir.prototype.aa=function(){this.D=null;const c=Date.now();c-this.T>=0?(_c(this.i,this.B),this.M!=2&&(rt(),Bt(17)),Gr(this),this.m=2,Xe(this)):Ps(this,this.T-c)};function Xe(c){c.j.I==0||c.K||Dc(c.j,c)}function Gr(c){ks(c);var _=c.O;_&&typeof _.dispose=="function"&&_.dispose(),c.O=null,xs(c.V),c.g&&(_=c.g,c.g=null,_.abort(),_.dispose())}function Ns(c,_){try{var y=c.j;if(y.I!=0&&(y.g==c||wc(y.h,c))){if(!c.L&&wc(y.h,c)&&y.I==3){try{var w=y.Ba.g.parse(_)}catch{w=null}if(Array.isArray(w)&&w.length==3){var D=w;if(D[0]==0){e:if(!y.v){if(y.g)if(y.g.F+3e3<c.F)Mo(y),bo(y);else break e;vl(y),Bt(18)}}else y.xa=D[1],0<y.xa-y.K&&D[2]<37500&&y.F&&y.A==0&&!y.C&&(y.C=Cs(u(y.Va,y),6e3));Nf(y.h)<=1&&y.ta&&(y.ta=void 0)}else T(y,11)}else if((c.L||y.g==c)&&Mo(y),!b(_))for(D=y.Ba.g.parse(_),_=0;_<D.length;_++){let Ae=D[_];const tt=Ae[0];if(!(tt<=y.K))if(y.K=tt,Ae=Ae[1],y.I==2)if(Ae[0]=="c"){y.M=Ae[1],y.ba=Ae[2];const zn=Ae[3];zn!=null&&(y.ka=zn,y.j.info("VER="+y.ka));const Jt=Ae[4];Jt!=null&&(y.za=Jt,y.j.info("SVER="+y.za));const Mt=Ae[5];Mt!=null&&typeof Mt=="number"&&Mt>0&&(w=1.5*Mt,y.O=w,y.j.info("backChannelRequestTimeoutMs_="+w)),w=y;const Gt=c.g;if(Gt){const qt=Gt.g?Gt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(qt){var F=w.h;F.g||qt.indexOf("spdy")==-1&&qt.indexOf("quic")==-1&&qt.indexOf("h2")==-1||(F.j=F.l,F.g=new Set,F.h&&(al(F,F.h),F.h=null))}if(w.G){const Lo=Gt.g?Gt.g.getResponseHeader("X-HTTP-Session-Id"):null;Lo&&(w.wa=Lo,Ze(w.J,w.G,Lo))}}y.I=3,y.l&&y.l.ra(),y.aa&&(y.T=Date.now()-c.F,y.j.info("Handshake RTT: "+y.T+"ms")),w=y;var X=c;if(w.na=O(w,w.L?w.ba:null,w.W),X.L){bf(w.h,X);var me=X,Pe=w.O;Pe&&(me.H=Pe),me.D&&(ks(me),xo(me)),w.g=X}else Nc(w);y.i.length>0&&Do(y)}else Ae[0]!="stop"&&Ae[0]!="close"||T(y,7);else y.I==3&&(Ae[0]=="stop"||Ae[0]=="close"?Ae[0]=="stop"?T(y,7):_l(y):Ae[0]!="noop"&&y.l&&y.l.qa(Ae),y.A=0)}}rt(4)}catch{}}var ol=class{constructor(c,_){this.g=c,this.map=_}};function Ec(c){this.l=c||10,o.PerformanceNavigationTiming?(c=o.performance.getEntriesByType("navigation"),c=c.length>0&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function kf(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function Nf(c){return c.h?1:c.g?c.g.size:0}function wc(c,_){return c.h?c.h==_:c.g?c.g.has(_):!1}function al(c,_){c.g?c.g.add(_):c.h=_}function bf(c,_){c.h&&c.h==_?c.h=null:c.g&&c.g.has(_)&&c.g.delete(_)}Ec.prototype.cancel=function(){if(this.i=ll(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function ll(c){if(c.h!=null)return c.i.concat(c.h.G);if(c.g!=null&&c.g.size!==0){let _=c.i;for(const y of c.g.values())_=_.concat(y.G);return _}return v(c.i)}var Co=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Df(c,_){if(c){c=c.split("&");for(let y=0;y<c.length;y++){const w=c[y].indexOf("=");let D,F=null;w>=0?(D=c[y].substring(0,w),F=c[y].substring(w+1)):D=c[y],_(D,F?decodeURIComponent(F.replace(/\+/g," ")):"")}}}function On(c){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let _;c instanceof On?(this.l=c.l,Ao(this,c.j),this.o=c.o,this.g=c.g,Ii(this,c.u),this.h=c.h,Ro(this,Ds(c.i)),this.m=c.m):c&&(_=String(c).match(Co))?(this.l=!1,Ao(this,_[1]||"",!0),this.o=Si(_[2]||""),this.g=Si(_[3]||"",!0),Ii(this,_[4]),this.h=Si(_[5]||"",!0),Ro(this,_[6]||"",!0),this.m=Si(_[7]||"")):(this.l=!1,this.i=new Gn(null,this.l))}On.prototype.toString=function(){const c=[];var _=this.j;_&&c.push(qr(_,Ic,!0),":");var y=this.g;return(y||_=="file")&&(c.push("//"),(_=this.o)&&c.push(qr(_,Ic,!0),"@"),c.push(wi(y).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y=this.u,y!=null&&c.push(":",String(y))),(y=this.h)&&(this.g&&y.charAt(0)!="/"&&c.push("/"),c.push(qr(y,y.charAt(0)=="/"?ul:bs,!0))),(y=this.i.toString())&&c.push("?",y),(y=this.m)&&c.push("#",qr(y,re)),c.join("")},On.prototype.resolve=function(c){const _=sr(this);let y=!!c.j;y?Ao(_,c.j):y=!!c.o,y?_.o=c.o:y=!!c.g,y?_.g=c.g:y=c.u!=null;var w=c.h;if(y)Ii(_,c.u);else if(y=!!c.h){if(w.charAt(0)!="/")if(this.g&&!this.h)w="/"+w;else{var D=_.h.lastIndexOf("/");D!=-1&&(w=_.h.slice(0,D+1)+w)}if(D=w,D==".."||D==".")w="";else if(D.indexOf("./")!=-1||D.indexOf("/.")!=-1){w=D.lastIndexOf("/",0)==0,D=D.split("/");const F=[];for(let X=0;X<D.length;){const me=D[X++];me=="."?w&&X==D.length&&F.push(""):me==".."?((F.length>1||F.length==1&&F[0]!="")&&F.pop(),w&&X==D.length&&F.push("")):(F.push(me),w=!0)}w=F.join("/")}else w=D}return y?_.h=w:y=c.i.toString()!=="",y?Ro(_,Ds(c.i)):y=!!c.m,y&&(_.m=c.m),_};function sr(c){return new On(c)}function Ao(c,_,y){c.j=y?Si(_,!0):_,c.j&&(c.j=c.j.replace(/:$/,""))}function Ii(c,_){if(_){if(_=Number(_),isNaN(_)||_<0)throw Error("Bad port number "+_);c.u=_}else c.u=null}function Ro(c,_,y){_ instanceof Gn?(c.i=_,Lf(c.i,c.l)):(y||(_=qr(_,Vf)),c.i=new Gn(_,c.l))}function Ze(c,_,y){c.i.set(_,y)}function Bn(c){return Ze(c,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),c}function Si(c,_){return c?_?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function qr(c,_,y){return typeof c=="string"?(c=encodeURI(c).replace(_,Mf),y&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function Mf(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var Ic=/[#\/\?@]/g,bs=/[#\?:]/g,ul=/[#\?]/g,Vf=/[#\?@]/g,re=/#/g;function Gn(c,_){this.h=this.g=null,this.i=c||null,this.j=!!_}function zr(c){c.g||(c.g=new Map,c.h=0,c.i&&Df(c.i,function(_,y){c.add(decodeURIComponent(_.replace(/\+/g," ")),y)}))}t=Gn.prototype,t.add=function(c,_){zr(this),this.i=null,c=$r(this,c);let y=this.g.get(c);return y||this.g.set(c,y=[]),y.push(_),this.h+=1,this};function Po(c,_){zr(c),_=$r(c,_),c.g.has(_)&&(c.i=null,c.h-=c.g.get(_).length,c.g.delete(_))}function Sc(c,_){return zr(c),_=$r(c,_),c.g.has(_)}t.forEach=function(c,_){zr(this),this.g.forEach(function(y,w){y.forEach(function(D){c.call(_,D,w,this)},this)},this)};function xi(c,_){zr(c);let y=[];if(typeof _=="string")Sc(c,_)&&(y=y.concat(c.g.get($r(c,_))));else for(c=Array.from(c.g.values()),_=0;_<c.length;_++)y=y.concat(c[_]);return y}t.set=function(c,_){return zr(this),this.i=null,c=$r(this,c),Sc(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[_]),this.h+=1,this},t.get=function(c,_){return c?(c=xi(this,c),c.length>0?String(c[0]):_):_};function Ci(c,_,y){Po(c,_),y.length>0&&(c.i=null,c.g.set($r(c,_),v(y)),c.h+=y.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],_=Array.from(this.g.keys());for(let w=0;w<_.length;w++){var y=_[w];const D=wi(y);y=xi(this,y);for(let F=0;F<y.length;F++){let X=D;y[F]!==""&&(X+="="+wi(y[F])),c.push(X)}}return this.i=c.join("&")};function Ds(c){const _=new Gn;return _.i=c.i,c.g&&(_.g=new Map(c.g),_.h=c.h),_}function $r(c,_){return _=String(_),c.j&&(_=_.toLowerCase()),_}function Lf(c,_){_&&!c.j&&(zr(c),c.i=null,c.g.forEach(function(y,w){const D=w.toLowerCase();w!=D&&(Po(this,w),Ci(this,D,y))},c)),c.j=_}function Ff(c,_){const y=new Br;if(o.Image){const w=new Image;w.onload=p(qn,y,"TestLoadImage: loaded",!0,_,w),w.onerror=p(qn,y,"TestLoadImage: error",!1,_,w),w.onabort=p(qn,y,"TestLoadImage: abort",!1,_,w),w.ontimeout=p(qn,y,"TestLoadImage: timeout",!1,_,w),o.setTimeout(function(){w.ontimeout&&w.ontimeout()},1e4),w.src=c}else _(!1)}function Uf(c,_){const y=new Br,w=new AbortController,D=setTimeout(()=>{w.abort(),qn(y,"TestPingServer: timeout",!1,_)},1e4);fetch(c,{signal:w.signal}).then(F=>{clearTimeout(D),F.ok?qn(y,"TestPingServer: ok",!0,_):qn(y,"TestPingServer: server error",!1,_)}).catch(()=>{clearTimeout(D),qn(y,"TestPingServer: error",!1,_)})}function qn(c,_,y,w,D){try{D&&(D.onload=null,D.onerror=null,D.onabort=null,D.ontimeout=null),w(y)}catch{}}function cl(){this.g=new gi}function dl(c){this.i=c.Sb||null,this.h=c.ab||!1}m(dl,Ur),dl.prototype.g=function(){return new ko(this.i,this.h)};function ko(c,_){Ge.call(this),this.H=c,this.o=_,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}m(ko,Ge),t=ko.prototype,t.open=function(c,_){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=c,this.D=_,this.readyState=1,jr(this)},t.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const _={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};c&&(_.body=c),(this.H||o).fetch(new Request(this.D,_)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Ai(this)),this.readyState=0},t.Pa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,jr(this)),this.g&&(this.readyState=3,jr(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;hl(this)}else c.text().then(this.Oa.bind(this),this.ga.bind(this))};function hl(c){c.j.read().then(c.Ma.bind(c)).catch(c.ga.bind(c))}t.Ma=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var _=c.value?c.value:new Uint8Array(0);(_=this.B.decode(_,{stream:!c.done}))&&(this.response=this.responseText+=_)}c.done?Ai(this):jr(this),this.readyState==3&&hl(this)}},t.Oa=function(c){this.g&&(this.response=this.responseText=c,Ai(this))},t.Na=function(c){this.g&&(this.response=c,Ai(this))},t.ga=function(){this.g&&Ai(this)};function Ai(c){c.readyState=4,c.l=null,c.j=null,c.B=null,jr(c)}t.setRequestHeader=function(c,_){this.A.append(c,_)},t.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],_=this.h.entries();for(var y=_.next();!y.done;)y=y.value,c.push(y[0]+": "+y[1]),y=_.next();return c.join(`\r
`)};function jr(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(ko.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function fl(c){let _="";return he(c,function(y,w){_+=w,_+=":",_+=y,_+=`\r
`}),_}function pl(c,_,y){e:{for(w in y){var w=!1;break e}w=!0}w||(y=fl(y),typeof c=="string"?y!=null&&wi(y):Ze(c,_,y))}function et(c){Ge.call(this),this.headers=new Map,this.L=c||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}m(et,Ge);var Of=/^https?$/i,Bf=["POST","PUT"];t=et.prototype,t.Fa=function(c){this.H=c},t.ea=function(c,_,y,w){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);_=_?_.toUpperCase():"GET",this.D=c,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():sl.g(),this.g.onreadystatechange=g(u(this.Ca,this));try{this.B=!0,this.g.open(_,String(c),!0),this.B=!1}catch(F){ml(this,F);return}if(c=y||"",y=new Map(this.headers),w)if(Object.getPrototypeOf(w)===Object.prototype)for(var D in w)y.set(D,w[D]);else if(typeof w.keys=="function"&&typeof w.get=="function")for(const F of w.keys())y.set(F,w.get(F));else throw Error("Unknown input type for opt_headers: "+String(w));w=Array.from(y.keys()).find(F=>F.toLowerCase()=="content-type"),D=o.FormData&&c instanceof o.FormData,!(Array.prototype.indexOf.call(Bf,_,void 0)>=0)||w||D||y.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[F,X]of y)this.g.setRequestHeader(F,X);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(c),this.v=!1}catch(F){ml(this,F)}};function ml(c,_){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=_,c.o=5,gl(c),No(c)}function gl(c){c.A||(c.A=!0,qe(c,"complete"),qe(c,"error"))}t.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=c||7,qe(this,"complete"),qe(this,"abort"),No(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),No(this,!0)),et.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?xc(this):this.Xa())},t.Xa=function(){xc(this)};function xc(c){if(c.h&&typeof s<"u"){if(c.v&&Ir(c)==4)setTimeout(c.Ca.bind(c),0);else if(qe(c,"readystatechange"),Ir(c)==4){c.h=!1;try{const F=c.ca();e:switch(F){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var _=!0;break e;default:_=!1}var y;if(!(y=_)){var w;if(w=F===0){let X=String(c.D).match(Co)[1]||null;!X&&o.self&&o.self.location&&(X=o.self.location.protocol.slice(0,-1)),w=!Of.test(X?X.toLowerCase():"")}y=w}if(y)qe(c,"complete"),qe(c,"success");else{c.o=6;try{var D=Ir(c)>2?c.g.statusText:""}catch{D=""}c.l=D+" ["+c.ca()+"]",gl(c)}}finally{No(c)}}}}function No(c,_){if(c.g){c.m&&(clearTimeout(c.m),c.m=null);const y=c.g;c.g=null,_||qe(c,"ready");try{y.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function Ir(c){return c.g?c.g.readyState:0}t.ca=function(){try{return Ir(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(c){if(this.g){var _=this.g.responseText;return c&&_.indexOf(c)==0&&(_=_.substring(c.length)),_e(_)}};function Cc(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.F){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function Gf(c){const _={};c=(c.g&&Ir(c)>=2&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let w=0;w<c.length;w++){if(b(c[w]))continue;var y=Rf(c[w]);const D=y[0];if(y=y[1],typeof y!="string")continue;y=y.trim();const F=_[D]||[];_[D]=F,F.push(y)}fe(_,function(w){return w.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ms(c,_,y){return y&&y.internalChannelParams&&y.internalChannelParams[c]||_}function Ac(c){this.za=0,this.i=[],this.j=new Br,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Ms("failFast",!1,c),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Ms("baseRetryDelayMs",5e3,c),this.Za=Ms("retryDelaySeedMs",1e4,c),this.Ta=Ms("forwardChannelMaxRetries",2,c),this.va=Ms("forwardChannelRequestTimeoutMs",2e4,c),this.ma=c&&c.xmlHttpFactory||void 0,this.Ua=c&&c.Rb||void 0,this.Aa=c&&c.useFetchStreams||!1,this.O=void 0,this.L=c&&c.supportsCrossDomainXhr||!1,this.M="",this.h=new Ec(c&&c.concurrentRequestLimit),this.Ba=new cl,this.S=c&&c.fastHandshake||!1,this.R=c&&c.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=c&&c.Pb||!1,c&&c.ua&&this.j.ua(),c&&c.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&c&&c.detectBufferingProxy||!1,this.ia=void 0,c&&c.longPollingTimeout&&c.longPollingTimeout>0&&(this.ia=c.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=Ac.prototype,t.ka=8,t.I=1,t.connect=function(c,_,y,w){Bt(0),this.W=c,this.H=_||{},y&&w!==void 0&&(this.H.OSID=y,this.H.OAID=w),this.F=this.X,this.J=O(this,null,this.W),Do(this)};function _l(c){if(Rc(c),c.I==3){var _=c.V++,y=sr(c.J);if(Ze(y,"SID",c.M),Ze(y,"RID",_),Ze(y,"TYPE","terminate"),Vs(c,y),_=new ir(c,c.j,_),_.M=2,_.A=Bn(sr(y)),y=!1,o.navigator&&o.navigator.sendBeacon)try{y=o.navigator.sendBeacon(_.A.toString(),"")}catch{}!y&&o.Image&&(new Image().src=_.A,y=!0),y||(_.g=B(_.j,null),_.g.ea(_.A)),_.F=Date.now(),xo(_)}k(c)}function bo(c){c.g&&(Tl(c),c.g.cancel(),c.g=null)}function Rc(c){bo(c),c.v&&(o.clearTimeout(c.v),c.v=null),Mo(c),c.h.cancel(),c.m&&(typeof c.m=="number"&&o.clearTimeout(c.m),c.m=null)}function Do(c){if(!kf(c.h)&&!c.m){c.m=!0;var _=c.Ea;q||x(),z||(q(),z=!0),E.add(_,c),c.D=0}}function Pc(c,_){return Nf(c.h)>=c.h.j-(c.m?1:0)?!1:c.m?(c.i=_.G.concat(c.i),!0):c.I==1||c.I==2||c.D>=(c.Sa?0:c.Ta)?!1:(c.m=Cs(u(c.Ea,c,_),Vo(c,c.D)),c.D++,!0)}t.Ea=function(c){if(this.m)if(this.m=null,this.I==1){if(!c){this.V=Math.floor(Math.random()*1e5),c=this.V++;const D=new ir(this,this.j,c);let F=this.o;if(this.U&&(F?(F=Ce(F),At(F,this.U)):F=this.U),this.u!==null||this.R||(D.J=F,F=null),this.S)e:{for(var _=0,y=0;y<this.i.length;y++){t:{var w=this.i[y];if("__data__"in w.map&&(w=w.map.__data__,typeof w=="string")){w=w.length;break t}w=void 0}if(w===void 0)break;if(_+=w,_>4096){_=y;break e}if(_===4096||y===this.i.length-1){_=y+1;break e}}_=1e3}else _=1e3;_=yl(this,D,_),y=sr(this.J),Ze(y,"RID",c),Ze(y,"CVER",22),this.G&&Ze(y,"X-HTTP-Session-Id",this.G),Vs(this,y),F&&(this.R?_="headers="+wi(fl(F))+"&"+_:this.u&&pl(y,this.u,F)),al(this.h,D),this.Ra&&Ze(y,"TYPE","init"),this.S?(Ze(y,"$req",_),Ze(y,"SID","null"),D.U=!0,vc(D,y,null)):vc(D,y,_),this.I=2}}else this.I==3&&(c?kc(this,c):this.i.length==0||kf(this.h)||kc(this))};function kc(c,_){var y;_?y=_.l:y=c.V++;const w=sr(c.J);Ze(w,"SID",c.M),Ze(w,"RID",y),Ze(w,"AID",c.K),Vs(c,w),c.u&&c.o&&pl(w,c.u,c.o),y=new ir(c,c.j,y,c.D+1),c.u===null&&(y.J=c.o),_&&(c.i=_.G.concat(c.i)),_=yl(c,y,1e3),y.H=Math.round(c.va*.5)+Math.round(c.va*.5*Math.random()),al(c.h,y),vc(y,w,_)}function Vs(c,_){c.H&&he(c.H,function(y,w){Ze(_,w,y)}),c.l&&he({},function(y,w){Ze(_,w,y)})}function yl(c,_,y){y=Math.min(c.i.length,y);const w=c.l?u(c.l.Ka,c.l,c):null;e:{var D=c.i;let me=-1;for(;;){const Pe=["count="+y];me==-1?y>0?(me=D[0].g,Pe.push("ofs="+me)):me=0:Pe.push("ofs="+me);let Ae=!0;for(let tt=0;tt<y;tt++){var F=D[tt].g;const zn=D[tt].map;if(F-=me,F<0)me=Math.max(0,D[tt].g-100),Ae=!1;else try{F="req"+F+"_"||"";try{var X=zn instanceof Map?zn:Object.entries(zn);for(const[Jt,Mt]of X){let Gt=Mt;a(Mt)&&(Gt=Et(Mt)),Pe.push(F+Jt+"="+encodeURIComponent(Gt))}}catch(Jt){throw Pe.push(F+"type="+encodeURIComponent("_badmap")),Jt}}catch{w&&w(zn)}}if(Ae){X=Pe.join("&");break e}}X=void 0}return c=c.i.splice(0,y),_.G=c,X}function Nc(c){if(!c.g&&!c.v){c.Y=1;var _=c.Da;q||x(),z||(q(),z=!0),E.add(_,c),c.A=0}}function vl(c){return c.g||c.v||c.A>=3?!1:(c.Y++,c.v=Cs(u(c.Da,c),Vo(c,c.A)),c.A++,!0)}t.Da=function(){if(this.v=null,bc(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var c=4*this.T;this.j.info("BP detection timer enabled: "+c),this.B=Cs(u(this.Wa,this),c)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Bt(10),bo(this),bc(this))};function Tl(c){c.B!=null&&(o.clearTimeout(c.B),c.B=null)}function bc(c){c.g=new ir(c,c.j,"rpc",c.Y),c.u===null&&(c.g.J=c.o),c.g.P=0;var _=sr(c.na);Ze(_,"RID","rpc"),Ze(_,"SID",c.M),Ze(_,"AID",c.K),Ze(_,"CI",c.F?"0":"1"),!c.F&&c.ia&&Ze(_,"TO",c.ia),Ze(_,"TYPE","xmlhttp"),Vs(c,_),c.u&&c.o&&pl(_,c.u,c.o),c.O&&(c.g.H=c.O);var y=c.g;c=c.ba,y.M=1,y.A=Bn(sr(_)),y.u=null,y.R=!0,Pf(y,c)}t.Va=function(){this.C!=null&&(this.C=null,bo(this),vl(this),Bt(19))};function Mo(c){c.C!=null&&(o.clearTimeout(c.C),c.C=null)}function Dc(c,_){var y=null;if(c.g==_){Mo(c),Tl(c),c.g=null;var w=2}else if(wc(c.h,_))y=_.G,bf(c.h,_),w=1;else return;if(c.I!=0){if(_.o)if(w==1){y=_.u?_.u.length:0,_=Date.now()-_.F;var D=c.D;w=Or(),qe(w,new gc(w,y)),Do(c)}else Nc(c);else if(D=_.m,D==3||D==0&&_.X>0||!(w==1&&Pc(c,_)||w==2&&vl(c)))switch(y&&y.length>0&&(_=c.h,_.i=_.i.concat(y)),D){case 1:T(c,5);break;case 4:T(c,10);break;case 3:T(c,6);break;default:T(c,2)}}}function Vo(c,_){let y=c.Qa+Math.floor(Math.random()*c.Za);return c.isActive()||(y*=2),y*_}function T(c,_){if(c.j.info("Error code "+_),_==2){var y=u(c.bb,c),w=c.Ua;const D=!w;w=new On(w||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||Ao(w,"https"),Bn(w),D?Ff(w.toString(),y):Uf(w.toString(),y)}else Bt(2);c.I=0,c.l&&c.l.pa(_),k(c),Rc(c)}t.bb=function(c){c?(this.j.info("Successfully pinged google.com"),Bt(2)):(this.j.info("Failed to ping google.com"),Bt(1))};function k(c){if(c.I=0,c.ja=[],c.l){const _=ll(c.h);(_.length!=0||c.i.length!=0)&&(I(c.ja,_),I(c.ja,c.i),c.h.i.length=0,v(c.i),c.i.length=0),c.l.oa()}}function O(c,_,y){var w=y instanceof On?sr(y):new On(y);if(w.g!="")_&&(w.g=_+"."+w.g),Ii(w,w.u);else{var D=o.location;w=D.protocol,_=_?_+"."+D.hostname:D.hostname,D=+D.port;const F=new On(null);w&&Ao(F,w),_&&(F.g=_),D&&Ii(F,D),y&&(F.h=y),w=F}return y=c.G,_=c.wa,y&&_&&Ze(w,y,_),Ze(w,"VER",c.ka),Vs(c,w),w}function B(c,_,y){if(_&&!c.L)throw Error("Can't create secondary domain capable XhrIo object.");return _=c.Aa&&!c.ma?new et(new dl({ab:y})):new et(c.ma),_.Fa(c.L),_}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function $(){}t=$.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function K(){}K.prototype.g=function(c,_){return new H(c,_)};function H(c,_){Ge.call(this),this.g=new Ac(_),this.l=c,this.h=_&&_.messageUrlParams||null,c=_&&_.messageHeaders||null,_&&_.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=_&&_.initMessageHeaders||null,_&&_.messageContentType&&(c?c["X-WebChannel-Content-Type"]=_.messageContentType:c={"X-WebChannel-Content-Type":_.messageContentType}),_&&_.sa&&(c?c["X-WebChannel-Client-Profile"]=_.sa:c={"X-WebChannel-Client-Profile":_.sa}),this.g.U=c,(c=_&&_.Qb)&&!b(c)&&(this.g.u=c),this.A=_&&_.supportsCrossDomainXhr||!1,this.v=_&&_.sendRawJson||!1,(_=_&&_.httpSessionIdParam)&&!b(_)&&(this.g.G=_,c=this.h,c!==null&&_ in c&&(c=this.h,_ in c&&delete c[_])),this.j=new ee(this)}m(H,Ge),H.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},H.prototype.close=function(){_l(this.g)},H.prototype.o=function(c){var _=this.g;if(typeof c=="string"){var y={};y.__data__=c,c=y}else this.v&&(y={},y.__data__=Et(c),c=y);_.i.push(new ol(_.Ya++,c)),_.I==3&&Do(_)},H.prototype.N=function(){this.g.l=null,delete this.j,_l(this.g),delete this.g,H.Z.N.call(this)};function Y(c){xn.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var _=c.__sm__;if(_){e:{for(const y in _){c=y;break e}c=void 0}(this.i=c)&&(c=this.i,_=_!==null&&c in _?_[c]:void 0),this.data=_}else this.data=c}m(Y,xn);function W(){we.call(this),this.status=1}m(W,we);function ee(c){this.g=c}m(ee,$),ee.prototype.ra=function(){qe(this.g,"a")},ee.prototype.qa=function(c){qe(this.g,new Y(c))},ee.prototype.pa=function(c){qe(this.g,new W)},ee.prototype.oa=function(){qe(this.g,"b")},K.prototype.createWebChannel=K.prototype.g,H.prototype.send=H.prototype.o,H.prototype.open=H.prototype.m,H.prototype.close=H.prototype.close,G0=function(){return new K},B0=function(){return Or()},O0=Cn,qm={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},wr.NO_ERROR=0,wr.TIMEOUT=8,wr.HTTP_ERROR=6,Sd=wr,Ti.COMPLETE="complete",U0=Ti,Er.EventType=Un,Un.OPEN="a",Un.CLOSE="b",Un.ERROR="c",Un.MESSAGE="d",Ge.prototype.listen=Ge.prototype.J,Ol=Er,et.prototype.listenOnce=et.prototype.K,et.prototype.getLastError=et.prototype.Ha,et.prototype.getLastErrorCode=et.prototype.ya,et.prototype.getStatus=et.prototype.ca,et.prototype.getResponseJson=et.prototype.La,et.prototype.getResponseText=et.prototype.la,et.prototype.send=et.prototype.ea,et.prototype.setWithCredentials=et.prototype.Fa,F0=et}).apply(typeof Zc<"u"?Zc:typeof self<"u"?self:typeof window<"u"?window:{});const kE="@firebase/firestore",NE="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}jt.UNAUTHENTICATED=new jt(null),jt.GOOGLE_CREDENTIALS=new jt("google-credentials-uid"),jt.FIRST_PARTY=new jt("first-party-uid"),jt.MOCK_USER=new jt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tl="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cs=new v_("@firebase/firestore");function $o(){return cs.logLevel}function q0(t){cs.setLogLevel(t)}function te(t,...e){if(cs.logLevel<=De.DEBUG){const n=e.map(b_);cs.debug(`Firestore (${tl}): ${t}`,...n)}}function un(t,...e){if(cs.logLevel<=De.ERROR){const n=e.map(b_);cs.error(`Firestore (${tl}): ${t}`,...n)}}function ds(t,...e){if(cs.logLevel<=De.WARN){const n=e.map(b_);cs.warn(`Firestore (${tl}): ${t}`,...n)}}function b_(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function de(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,z0(t,r,n)}function z0(t,e,n){let r=`FIRESTORE (${tl}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw un(r),new Error(r)}function pe(t,e,n,r){let i="Unexpected state";typeof n=="string"?i=n:r=n,t||z0(e,i,r)}function Te(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ie extends hi{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mr{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $0{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class j0{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(jt.UNAUTHENTICATED))}shutdown(){}}class eU{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class tU{constructor(e){this.t=e,this.currentUser=jt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){pe(this.o===void 0,42304);let r=this.i;const i=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let s=new Mr;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Mr,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},a=l=>{te("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(te("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Mr)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(te("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(pe(typeof r.accessToken=="string",31837,{l:r}),new $0(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return pe(e===null||typeof e=="string",2055,{h:e}),new jt(e)}}class nU{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=jt.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class rU{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new nU(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(jt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class bE{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class iU{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,dr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){pe(this.o===void 0,3512);const r=s=>{s.error!=null&&te("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,te("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{te("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):te("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new bE(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(pe(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new bE(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sU(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sf{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=sU(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%62))}return r}}function ve(t,e){return t<e?-1:t>e?1:0}function zm(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const i=t.charAt(r),s=e.charAt(r);if(i!==s)return wp(i)===wp(s)?ve(i,s):wp(i)?1:-1}return ve(t.length,e.length)}const oU=55296,aU=57343;function wp(t){const e=t.charCodeAt(0);return e>=oU&&e<=aU}function Na(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function H0(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DE="__name__";class Ar{constructor(e,n,r){n===void 0?n=0:n>e.length&&de(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&de(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Ar.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Ar?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=Ar.compareSegments(e.get(i),n.get(i));if(s!==0)return s}return ve(e.length,n.length)}static compareSegments(e,n){const r=Ar.isNumericId(e),i=Ar.isNumericId(n);return r&&!i?-1:!r&&i?1:r&&i?Ar.extractNumericId(e).compare(Ar.extractNumericId(n)):zm(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return is.fromString(e.substring(4,e.length-2))}}class ze extends Ar{construct(e,n,r){return new ze(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new ie(Q.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new ze(n)}static emptyPath(){return new ze([])}}const lU=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class dt extends Ar{construct(e,n,r){return new dt(e,n,r)}static isValidIdentifier(e){return lU.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),dt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===DE}static keyField(){return new dt([DE])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new ie(Q.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new ie(Q.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new ie(Q.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new ie(Q.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new dt(n)}static emptyPath(){return new dt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class se{constructor(e){this.path=e}static fromPath(e){return new se(ze.fromString(e))}static fromName(e){return new se(ze.fromString(e).popFirst(5))}static empty(){return new se(ze.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ze.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return ze.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new se(new ze(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W0(t,e,n){if(!n)throw new ie(Q.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function K0(t,e,n,r){if(e===!0&&r===!0)throw new ie(Q.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function ME(t){if(!se.isDocumentKey(t))throw new ie(Q.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function VE(t){if(se.isDocumentKey(t))throw new ie(Q.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function J0(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function of(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":de(12329,{type:typeof t})}function hn(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new ie(Q.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=of(t);throw new ie(Q.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ct(t,e){const n={typeString:t};return e&&(n.value=e),n}function tc(t,e){if(!J0(t))throw new ie(Q.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(i&&typeof o!==i){n=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&o!==s.value){n=`Expected '${r}' field to equal '${s.value}'`;break}}if(n)throw new ie(Q.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LE=-62135596800,FE=1e6;class $e{static now(){return $e.fromMillis(Date.now())}static fromDate(e){return $e.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*FE);return new $e(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new ie(Q.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new ie(Q.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<LE)throw new ie(Q.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ie(Q.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/FE}_compareTo(e){return this.seconds===e.seconds?ve(this.nanoseconds,e.nanoseconds):ve(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:$e._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(tc(e,$e._jsonSchema))return new $e(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-LE;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}$e._jsonSchemaVersion="firestore/timestamp/1.0",$e._jsonSchema={type:Ct("string",$e._jsonSchemaVersion),seconds:Ct("number"),nanoseconds:Ct("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ge{static fromTimestamp(e){return new ge(e)}static min(){return new ge(new $e(0,0))}static max(){return new ge(new $e(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bu=-1;class gh{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}}function $m(t){return t.fields.find(e=>e.kind===2)}function Bs(t){return t.fields.filter(e=>e.kind!==2)}gh.UNKNOWN_ID=-1;class xd{constructor(e,n){this.fieldPath=e,this.kind=n}}class Du{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new Du(0,Mn.min())}}function uU(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=ge.fromTimestamp(r===1e9?new $e(n+1,0):new $e(n,r));return new Mn(i,se.empty(),e)}function Q0(t){return new Mn(t.readTime,t.key,bu)}class Mn{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Mn(ge.min(),se.empty(),bu)}static max(){return new Mn(ge.max(),se.empty(),bu)}}function D_(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=se.comparator(t.documentKey,e.documentKey),n!==0?n:ve(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y0="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class X0{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wo(t){if(t.code!==Q.FAILED_PRECONDITION||t.message!==Y0)throw t;te("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&de(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new j((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof j?n:j.resolve(n)}catch(n){return j.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):j.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):j.reject(n)}static resolve(e){return new j((n,r)=>{n(e)})}static reject(e){return new j((n,r)=>{r(e)})}static waitFor(e){return new j((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},l=>r(l))}),o=!0,s===i&&n()})}static or(e){let n=j.resolve(!1);for(const r of e)n=n.next(i=>i?j.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new j((r,i)=>{const s=e.length,o=new Array(s);let a=0;for(let l=0;l<s;l++){const u=l;n(e[u]).next(p=>{o[u]=p,++a,a===s&&r(o)},p=>i(p))}})}static doWhile(e,n){return new j((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rn="SimpleDb";class af{static open(e,n,r,i){try{return new af(n,e.transaction(i,r))}catch(s){throw new ru(n,s)}}constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.S=new Mr,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{n.error?this.S.reject(new ru(e,n.error)):this.S.resolve()},this.transaction.onerror=r=>{const i=M_(r.target.error);this.S.reject(new ru(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(te(Rn,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new dU(n)}}class ss{static delete(e){return te(Rn,"Removing database:",e),zs(zx().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!Xx())return!1;if(ss.F())return!0;const e=kt(),n=ss.M(e),r=0<n&&n<10,i=Z0(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)==null?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)==="YES"}static O(e,n){return e.store(n)}static M(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,n,r){this.name=e,this.version=n,this.N=r,this.B=null,ss.M(kt())===12.2&&un("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(te(Rn,"Opening database:",this.name),this.db=await new Promise((n,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const o=s.target.result;n(o)},i.onblocked=()=>{r(new ru(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const o=s.target.error;o.name==="VersionError"?r(new ie(Q.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new ie(Q.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new ru(e,o))},i.onupgradeneeded=s=>{te(Rn,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.N.k(o,i.transaction,s.oldVersion,this.version).next(()=>{te(Rn,"Database upgrade to version "+this.version+" complete")})}})),this.q&&(this.db.onversionchange=n=>this.q(n)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,i){const s=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const a=af.open(this.db,e,s?"readonly":"readwrite",r),l=i(a).next(u=>(a.C(),u)).catch(u=>(a.abort(u),j.reject(u))).toPromise();return l.catch(()=>{}),await a.D,l}catch(a){const l=a,u=l.name!=="FirebaseError"&&o<3;if(te(Rn,"Transaction failed with error:",l.message,"Retrying:",u),this.close(),!u)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function Z0(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class cU{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return zs(this.U.delete())}}class ru extends ie{constructor(e,n){super(Q.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function Es(t){return t.name==="IndexedDbTransactionError"}class dU{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(te(Rn,"PUT",this.store.name,e,n),r=this.store.put(n,e)):(te(Rn,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),zs(r)}add(e){return te(Rn,"ADD",this.store.name,e,e),zs(this.store.add(e))}get(e){return zs(this.store.get(e)).next(n=>(n===void 0&&(n=null),te(Rn,"GET",this.store.name,e,n),n))}delete(e){return te(Rn,"DELETE",this.store.name,e),zs(this.store.delete(e))}count(){return te(Rn,"COUNT",this.store.name),zs(this.store.count())}J(e,n){const r=this.options(e,n),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const s=i.getAll(r.range);return new j((o,a)=>{s.onerror=l=>{a(l.target.error)},s.onsuccess=l=>{o(l.target.result)}})}{const s=this.cursor(r),o=[];return this.H(s,(a,l)=>{o.push(l)}).next(()=>o)}}Y(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new j((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}Z(e,n){te(Rn,"DELETE ALL",this.store.name);const r=this.options(e,n);r.X=!1;const i=this.cursor(r);return this.H(i,(s,o,a)=>a.delete())}ee(e,n){let r;n?r=e:(r={},n=e);const i=this.cursor(r);return this.H(i,n)}te(e){const n=this.cursor({});return new j((r,i)=>{n.onerror=s=>{const o=M_(s.target.error);i(o)},n.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}H(e,n){const r=[];return new j((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void i();const l=new cU(a),u=n(a.primaryKey,a.value,l);if(u instanceof j){const p=u.catch(m=>(l.done(),j.reject(m)));r.push(p)}l.isDone?i():l.G===null?a.continue():a.continue(l.G)}}).next(()=>j.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function zs(t){return new j((e,n)=>{t.onsuccess=r=>{const i=r.target.result;e(i)},t.onerror=r=>{const i=M_(r.target.error);n(i)}})}let UE=!1;function M_(t){const e=ss.M(kt());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new ie("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return UE||(UE=!0,setTimeout(()=>{throw r},0)),r}}return t}const iu="IndexBackfiller";class hU{constructor(e,n){this.asyncQueue=e,this.ne=n,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){te(iu,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const n=await this.ne.ie();te(iu,`Documents written: ${n}`)}catch(n){Es(n)?te(iu,"Ignoring IndexedDB error during index backfill: ",n):await wo(n)}await this.re(6e4)})}}class fU{constructor(e,n){this.localStore=e,this.persistence=n}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.se(n,e))}se(e,n){const r=new Set;let i=n,s=!0;return j.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return te(iu,`Processing collection: ${o}`),this.oe(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>n-i)}oe(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this._e(i,s)).next(a=>(te(iu,`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}_e(e,n){let r=e;return n.changes.forEach((i,s)=>{const o=Q0(s);D_(o,r)>0&&(r=o)}),new Mn(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kn{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Kn.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const to=-1;function lf(t){return t==null}function Mu(t){return t===0&&1/t==-1/0}function pU(t){return typeof t=="number"&&Number.isInteger(t)&&!Mu(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _h="";function rn(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=OE(e)),e=mU(t.get(n),e);return OE(e)}function mU(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const s=t.charAt(i);switch(s){case"\0":n+="";break;case _h:n+="";break;default:n+=s}}return n}function OE(t){return t+_h+""}function Pr(t){const e=t.length;if(pe(e>=2,64408,{path:t}),e===2)return pe(t.charAt(0)===_h&&t.charAt(1)==="",56145,{path:t}),ze.emptyPath();const n=e-2,r=[];let i="";for(let s=0;s<e;){const o=t.indexOf(_h,s);switch((o<0||o>n)&&de(50515,{path:t}),t.charAt(o+1)){case"":const a=t.substring(s,o);let l;i.length===0?l=a:(i+=a,l=i,i=""),r.push(l);break;case"":i+=t.substring(s,o),i+="\0";break;case"":i+=t.substring(s,o+1);break;default:de(61167,{path:t})}s=o+2}return new ze(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gs="remoteDocuments",nc="owner",Uo="owner",Vu="mutationQueues",gU="userId",ur="mutations",BE="batchId",Ys="userMutationsIndex",GE=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cd(t,e){return[t,rn(e)]}function eC(t,e,n){return[t,rn(e),n]}const _U={},ba="documentMutations",yh="remoteDocumentsV14",yU=["prefixPath","collectionGroup","readTime","documentId"],Ad="documentKeyIndex",vU=["prefixPath","collectionGroup","documentId"],tC="collectionGroupIndex",TU=["collectionGroup","readTime","prefixPath","documentId"],Lu="remoteDocumentGlobal",jm="remoteDocumentGlobalKey",Da="targets",nC="queryTargetsIndex",EU=["canonicalId","targetId"],Ma="targetDocuments",wU=["targetId","path"],V_="documentTargetsIndex",IU=["path","targetId"],vh="targetGlobalKey",no="targetGlobal",Fu="collectionParents",SU=["collectionId","parent"],Va="clientMetadata",xU="clientId",uf="bundles",CU="bundleId",cf="namedQueries",AU="name",L_="indexConfiguration",RU="indexId",Hm="collectionGroupIndex",PU="collectionGroup",su="indexState",kU=["indexId","uid"],rC="sequenceNumberIndex",NU=["uid","sequenceNumber"],ou="indexEntries",bU=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],iC="documentKeyIndex",DU=["indexId","uid","orderedDocumentKey"],df="documentOverlays",MU=["userId","collectionPath","documentId"],Wm="collectionPathOverlayIndex",VU=["userId","collectionPath","largestBatchId"],sC="collectionGroupOverlayIndex",LU=["userId","collectionGroup","largestBatchId"],F_="globals",FU="name",oC=[Vu,ur,ba,Gs,Da,nc,no,Ma,Va,Lu,Fu,uf,cf],UU=[...oC,df],aC=[Vu,ur,ba,yh,Da,nc,no,Ma,Va,Lu,Fu,uf,cf,df],lC=aC,U_=[...lC,L_,su,ou],OU=U_,uC=[...U_,F_],BU=uC;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Km extends X0{constructor(e,n){super(),this.le=e,this.currentSequenceNumber=n}}function bt(t,e){const n=Te(t);return ss.O(n.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qE(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ws(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function cC(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ht{constructor(e,n){this.comparator=e,this.root=n||Ht.EMPTY}insert(e,n){return new ht(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Ht.BLACK,null,null))}remove(e){return new ht(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ht.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ed(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ed(this.root,e,this.comparator,!1)}getReverseIterator(){return new ed(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ed(this.root,e,this.comparator,!0)}}class ed{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ht{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??Ht.RED,this.left=i??Ht.EMPTY,this.right=s??Ht.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new Ht(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Ht.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return Ht.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ht.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ht.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw de(43730,{key:this.key,value:this.value});if(this.right.isRed())throw de(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw de(27949);return e+(this.isRed()?0:1)}}Ht.EMPTY=null,Ht.RED=!0,Ht.BLACK=!1;Ht.EMPTY=new class{constructor(){this.size=0}get key(){throw de(57766)}get value(){throw de(16141)}get color(){throw de(16727)}get left(){throw de(29726)}get right(){throw de(36894)}copy(e,n,r,i,s){return this}insert(e,n,r){return new Ht(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ke{constructor(e){this.comparator=e,this.data=new ht(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new zE(this.data.getIterator())}getIteratorFrom(e){return new zE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Ke)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Ke(this.comparator);return n.data=e,n}}class zE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Oo(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vn{constructor(e){this.fields=e,e.sort(dt.comparator)}static empty(){return new vn([])}unionWith(e){let n=new Ke(dt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new vn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Na(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dC extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class It{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new dC("Invalid base64 string: "+s):s}}(e);return new It(n)}static fromUint8Array(e){const n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new It(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ve(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}It.EMPTY_BYTE_STRING=new It("");const GU=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function li(t){if(pe(!!t,39018),typeof t=="string"){let e=0;const n=GU.exec(t);if(pe(!!n,46558,{timestamp:t}),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ut(t.seconds),nanos:ut(t.nanos)}}function ut(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function ui(t){return typeof t=="string"?It.fromBase64String(t):It.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hC="server_timestamp",fC="__type__",pC="__previous_value__",mC="__local_write_time__";function O_(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[fC])==null?void 0:r.stringValue)===hC}function hf(t){const e=t.mapValue.fields[pC];return O_(e)?hf(e):e}function Uu(t){const e=li(t.mapValue.fields[mC].timestampValue);return new $e(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qU{constructor(e,n,r,i,s,o,a,l,u,p){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=u,this.isUsingEmulator=p}}const Th="(default)";class hs{constructor(e,n){this.projectId=e,this.database=n||Th}static empty(){return new hs("","")}get isDefaultDatabase(){return this.database===Th}isEqual(e){return e instanceof hs&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B_="__type__",gC="__max__",Hi={mapValue:{fields:{__type__:{stringValue:gC}}}},G_="__vector__",La="value",Rd={nullValue:"NULL_VALUE"};function fs(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?O_(t)?4:_C(t)?9007199254740991:ff(t)?10:11:de(28295,{value:t})}function Lr(t,e){if(t===e)return!0;const n=fs(t);if(n!==fs(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Uu(t).isEqual(Uu(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=li(i.timestampValue),a=li(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return ui(i.bytesValue).isEqual(ui(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return ut(i.geoPointValue.latitude)===ut(s.geoPointValue.latitude)&&ut(i.geoPointValue.longitude)===ut(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return ut(i.integerValue)===ut(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=ut(i.doubleValue),a=ut(s.doubleValue);return o===a?Mu(o)===Mu(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return Na(t.arrayValue.values||[],e.arrayValue.values||[],Lr);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(qE(o)!==qE(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!Lr(o[l],a[l])))return!1;return!0}(t,e);default:return de(52216,{left:t})}}function Ou(t,e){return(t.values||[]).find(n=>Lr(n,e))!==void 0}function ps(t,e){if(t===e)return 0;const n=fs(t),r=fs(e);if(n!==r)return ve(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return ve(t.booleanValue,e.booleanValue);case 2:return function(s,o){const a=ut(s.integerValue||s.doubleValue),l=ut(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(t,e);case 3:return $E(t.timestampValue,e.timestampValue);case 4:return $E(Uu(t),Uu(e));case 5:return zm(t.stringValue,e.stringValue);case 6:return function(s,o){const a=ui(s),l=ui(o);return a.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),l=o.split("/");for(let u=0;u<a.length&&u<l.length;u++){const p=ve(a[u],l[u]);if(p!==0)return p}return ve(a.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){const a=ve(ut(s.latitude),ut(o.latitude));return a!==0?a:ve(ut(s.longitude),ut(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return jE(t.arrayValue,e.arrayValue);case 10:return function(s,o){var g,v,I,P;const a=s.fields||{},l=o.fields||{},u=(g=a[La])==null?void 0:g.arrayValue,p=(v=l[La])==null?void 0:v.arrayValue,m=ve(((I=u==null?void 0:u.values)==null?void 0:I.length)||0,((P=p==null?void 0:p.values)==null?void 0:P.length)||0);return m!==0?m:jE(u,p)}(t.mapValue,e.mapValue);case 11:return function(s,o){if(s===Hi.mapValue&&o===Hi.mapValue)return 0;if(s===Hi.mapValue)return 1;if(o===Hi.mapValue)return-1;const a=s.fields||{},l=Object.keys(a),u=o.fields||{},p=Object.keys(u);l.sort(),p.sort();for(let m=0;m<l.length&&m<p.length;++m){const g=zm(l[m],p[m]);if(g!==0)return g;const v=ps(a[l[m]],u[p[m]]);if(v!==0)return v}return ve(l.length,p.length)}(t.mapValue,e.mapValue);default:throw de(23264,{he:n})}}function $E(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return ve(t,e);const n=li(t),r=li(e),i=ve(n.seconds,r.seconds);return i!==0?i:ve(n.nanos,r.nanos)}function jE(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const s=ps(n[i],r[i]);if(s)return s}return ve(n.length,r.length)}function Fa(t){return Jm(t)}function Jm(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=li(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return ui(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return se.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=Jm(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${Jm(n.fields[o])}`;return i+"}"}(t.mapValue):de(61005,{value:t})}function Pd(t){switch(fs(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=hf(t);return e?16+Pd(e):16;case 5:return 2*t.stringValue.length;case 6:return ui(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,s)=>i+Pd(s),0)}(t.arrayValue);case 10:case 11:return function(r){let i=0;return ws(r.fields,(s,o)=>{i+=s.length+Pd(o)}),i}(t.mapValue);default:throw de(13486,{value:t})}}function Bu(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Qm(t){return!!t&&"integerValue"in t}function Gu(t){return!!t&&"arrayValue"in t}function HE(t){return!!t&&"nullValue"in t}function WE(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function kd(t){return!!t&&"mapValue"in t}function ff(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[B_])==null?void 0:r.stringValue)===G_}function au(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return ws(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=au(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=au(t.arrayValue.values[n]);return e}return{...t}}function _C(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===gC}const yC={mapValue:{fields:{[B_]:{stringValue:G_},[La]:{arrayValue:{}}}}};function zU(t){return"nullValue"in t?Rd:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?Bu(hs.empty(),se.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?ff(t)?yC:{mapValue:{}}:de(35942,{value:t})}function $U(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?Bu(hs.empty(),se.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?yC:"mapValue"in t?ff(t)?{mapValue:{}}:Hi:de(61959,{value:t})}function KE(t,e){const n=ps(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function JE(t,e){const n=ps(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tn{constructor(e){this.value=e}static empty(){return new tn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!kd(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=au(n)}setAll(e){let n=dt.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=au(o):i.push(a.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());kd(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Lr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];kd(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){ws(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new tn(au(this.value))}}function vC(t){const e=[];return ws(t.fields,(n,r)=>{const i=new dt([n]);if(kd(r)){const s=vC(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new vn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tt{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Tt(e,0,ge.min(),ge.min(),ge.min(),tn.empty(),0)}static newFoundDocument(e,n,r,i){return new Tt(e,1,n,ge.min(),r,i,0)}static newNoDocument(e,n){return new Tt(e,2,n,ge.min(),ge.min(),tn.empty(),0)}static newUnknownDocument(e,n){return new Tt(e,3,n,ge.min(),ge.min(),tn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(ge.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=tn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=tn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ge.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Tt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Tt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ua{constructor(e,n){this.position=e,this.inclusive=n}}function QE(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(s.field.isKeyField()?r=se.comparator(se.fromName(o.referenceValue),n.key):r=ps(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function YE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Lr(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eh{constructor(e,n="asc"){this.field=e,this.dir=n}}function jU(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TC{}class Me extends TC{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new HU(e,n,r):n==="array-contains"?new JU(e,r):n==="in"?new CC(e,r):n==="not-in"?new QU(e,r):n==="array-contains-any"?new YU(e,r):new Me(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new WU(e,r):new KU(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(ps(n,this.value)):n!==null&&fs(this.value)===fs(n)&&this.matchesComparison(ps(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return de(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class He extends TC{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new He(e,n)}matches(e){return Oa(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Oa(t){return t.op==="and"}function Ym(t){return t.op==="or"}function q_(t){return EC(t)&&Oa(t)}function EC(t){for(const e of t.filters)if(e instanceof He)return!1;return!0}function Xm(t){if(t instanceof Me)return t.field.canonicalString()+t.op.toString()+Fa(t.value);if(q_(t))return t.filters.map(e=>Xm(e)).join(",");{const e=t.filters.map(n=>Xm(n)).join(",");return`${t.op}(${e})`}}function wC(t,e){return t instanceof Me?function(r,i){return i instanceof Me&&r.op===i.op&&r.field.isEqual(i.field)&&Lr(r.value,i.value)}(t,e):t instanceof He?function(r,i){return i instanceof He&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&wC(o,i.filters[a]),!0):!1}(t,e):void de(19439)}function IC(t,e){const n=t.filters.concat(e);return He.create(n,t.op)}function SC(t){return t instanceof Me?function(n){return`${n.field.canonicalString()} ${n.op} ${Fa(n.value)}`}(t):t instanceof He?function(n){return n.op.toString()+" {"+n.getFilters().map(SC).join(" ,")+"}"}(t):"Filter"}class HU extends Me{constructor(e,n,r){super(e,n,r),this.key=se.fromName(r.referenceValue)}matches(e){const n=se.comparator(e.key,this.key);return this.matchesComparison(n)}}class WU extends Me{constructor(e,n){super(e,"in",n),this.keys=xC("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class KU extends Me{constructor(e,n){super(e,"not-in",n),this.keys=xC("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function xC(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(r=>se.fromName(r.referenceValue))}class JU extends Me{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Gu(n)&&Ou(n.arrayValue,this.value)}}class CC extends Me{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Ou(this.value.arrayValue,n)}}class QU extends Me{constructor(e,n){super(e,"not-in",n)}matches(e){if(Ou(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Ou(this.value.arrayValue,n)}}class YU extends Me{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Gu(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Ou(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XU{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.Te=null}}function Zm(t,e=null,n=[],r=[],i=null,s=null,o=null){return new XU(t,e,n,r,i,s,o)}function po(t){const e=Te(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Xm(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),lf(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Fa(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Fa(r)).join(",")),e.Te=n}return e.Te}function rc(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!jU(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!wC(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!YE(t.startAt,e.startAt)&&YE(t.endAt,e.endAt)}function wh(t){return se.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function Ih(t,e){return t.filters.filter(n=>n instanceof Me&&n.field.isEqual(e))}function XE(t,e,n){let r=Rd,i=!0;for(const s of Ih(t,e)){let o=Rd,a=!0;switch(s.op){case"<":case"<=":o=zU(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=Rd}KE({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];KE({value:r,inclusive:i},{value:o,inclusive:n.inclusive})<0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}function ZE(t,e,n){let r=Hi,i=!0;for(const s of Ih(t,e)){let o=Hi,a=!0;switch(s.op){case">=":case">":o=$U(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=Hi}JE({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];JE({value:r,inclusive:i},{value:o,inclusive:n.inclusive})>0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ic{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function ZU(t,e,n,r,i,s,o,a){return new ic(t,e,n,r,i,s,o,a)}function sc(t){return new ic(t)}function ew(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function AC(t){return t.collectionGroup!==null}function lu(t){const e=Te(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Ke(dt.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(u=>{u.isInequality()&&(a=a.add(u.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new Eh(s,r))}),n.has(dt.keyField().canonicalString())||e.Ie.push(new Eh(dt.keyField(),r))}return e.Ie}function Yn(t){const e=Te(t);return e.Ee||(e.Ee=e4(e,lu(t))),e.Ee}function e4(t,e){if(t.limitType==="F")return Zm(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new Eh(i.field,s)});const n=t.endAt?new Ua(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Ua(t.startAt.position,t.startAt.inclusive):null;return Zm(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function eg(t,e){const n=t.filters.concat([e]);return new ic(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function tg(t,e,n){return new ic(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function pf(t,e){return rc(Yn(t),Yn(e))&&t.limitType===e.limitType}function RC(t){return`${po(Yn(t))}|lt:${t.limitType}`}function jo(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>SC(i)).join(", ")}]`),lf(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>Fa(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>Fa(i)).join(",")),`Target(${r})`}(Yn(t))}; limitType=${t.limitType})`}function oc(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):se.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of lu(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,a,l){const u=QE(o,a,l);return o.inclusive?u<=0:u<0}(r.startAt,lu(r),i)||r.endAt&&!function(o,a,l){const u=QE(o,a,l);return o.inclusive?u>=0:u>0}(r.endAt,lu(r),i))}(t,e)}function t4(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function PC(t){return(e,n)=>{let r=!1;for(const i of lu(t)){const s=n4(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function n4(t,e,n){const r=t.field.isKeyField()?se.comparator(e.key,n.key):function(s,o,a){const l=o.data.field(s),u=a.data.field(s);return l!==null&&u!==null?ps(l,u):de(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return de(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fi{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){ws(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return cC(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r4=new ht(se.comparator);function Nn(){return r4}const kC=new ht(se.comparator);function Bl(...t){let e=kC;for(const n of t)e=e.insert(n.key,n);return e}function NC(t){let e=kC;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function kr(){return uu()}function bC(){return uu()}function uu(){return new fi(t=>t.toString(),(t,e)=>t.isEqual(e))}const i4=new ht(se.comparator),s4=new Ke(se.comparator);function Se(...t){let e=s4;for(const n of t)e=e.add(n);return e}const o4=new Ke(ve);function a4(){return o4}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z_(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Mu(e)?"-0":e}}function DC(t){return{integerValue:""+t}}function l4(t,e){return pU(e)?DC(e):z_(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mf{constructor(){this._=void 0}}function u4(t,e,n){return t instanceof Ba?function(i,s){const o={fields:{[fC]:{stringValue:hC},[mC]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&O_(s)&&(s=hf(s)),s&&(o.fields[pC]=s),{mapValue:o}}(n,e):t instanceof Ga?VC(t,e):t instanceof qa?LC(t,e):function(i,s){const o=MC(i,s),a=tw(o)+tw(i.Ae);return Qm(o)&&Qm(i.Ae)?DC(a):z_(i.serializer,a)}(t,e)}function c4(t,e,n){return t instanceof Ga?VC(t,e):t instanceof qa?LC(t,e):n}function MC(t,e){return t instanceof qu?function(r){return Qm(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class Ba extends mf{}class Ga extends mf{constructor(e){super(),this.elements=e}}function VC(t,e){const n=FC(e);for(const r of t.elements)n.some(i=>Lr(i,r))||n.push(r);return{arrayValue:{values:n}}}class qa extends mf{constructor(e){super(),this.elements=e}}function LC(t,e){let n=FC(e);for(const r of t.elements)n=n.filter(i=>!Lr(i,r));return{arrayValue:{values:n}}}class qu extends mf{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function tw(t){return ut(t.integerValue||t.doubleValue)}function FC(t){return Gu(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UC{constructor(e,n){this.field=e,this.transform=n}}function d4(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof Ga&&i instanceof Ga||r instanceof qa&&i instanceof qa?Na(r.elements,i.elements,Lr):r instanceof qu&&i instanceof qu?Lr(r.Ae,i.Ae):r instanceof Ba&&i instanceof Ba}(t.transform,e.transform)}class h4{constructor(e,n){this.version=e,this.transformResults=n}}class cn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new cn}static exists(e){return new cn(void 0,e)}static updateTime(e){return new cn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Nd(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class gf{}function OC(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new _f(t.key,cn.none()):new nl(t.key,t.data,cn.none());{const n=t.data,r=tn.empty();let i=new Ke(dt.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new pi(t.key,r,new vn(i.toArray()),cn.none())}}function f4(t,e,n){t instanceof nl?function(i,s,o){const a=i.value.clone(),l=rw(i.fieldTransforms,s,o.transformResults);a.setAll(l),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof pi?function(i,s,o){if(!Nd(i.precondition,s))return void s.convertToUnknownDocument(o.version);const a=rw(i.fieldTransforms,s,o.transformResults),l=s.data;l.setAll(BC(i)),l.setAll(a),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function cu(t,e,n,r){return t instanceof nl?function(s,o,a,l){if(!Nd(s.precondition,o))return a;const u=s.value.clone(),p=iw(s.fieldTransforms,l,o);return u.setAll(p),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,n,r):t instanceof pi?function(s,o,a,l){if(!Nd(s.precondition,o))return a;const u=iw(s.fieldTransforms,l,o),p=o.data;return p.setAll(BC(s)),p.setAll(u),o.convertToFoundDocument(o.version,p).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(m=>m.field))}(t,e,n,r):function(s,o,a){return Nd(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function p4(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=MC(r.transform,i||null);s!=null&&(n===null&&(n=tn.empty()),n.set(r.field,s))}return n||null}function nw(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Na(r,i,(s,o)=>d4(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class nl extends gf{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class pi extends gf{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function BC(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function rw(t,e,n){const r=new Map;pe(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,c4(o,a,n[i]))}return r}function iw(t,e,n){const r=new Map;for(const i of t){const s=i.transform,o=n.data.field(i.field);r.set(i.field,u4(s,o,e))}return r}class _f extends gf{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class GC extends gf{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $_{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&f4(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=cu(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=cu(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=bC();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;const l=OC(o,a);l!==null&&r.set(i.key,l),o.isValidDocument()||o.convertToNoDocument(ge.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Se())}isEqual(e){return this.batchId===e.batchId&&Na(this.mutations,e.mutations,(n,r)=>nw(n,r))&&Na(this.baseMutations,e.baseMutations,(n,r)=>nw(n,r))}}class j_{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){pe(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=function(){return i4}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new j_(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H_{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m4{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var St,Ve;function g4(t){switch(t){case Q.OK:return de(64938);case Q.CANCELLED:case Q.UNKNOWN:case Q.DEADLINE_EXCEEDED:case Q.RESOURCE_EXHAUSTED:case Q.INTERNAL:case Q.UNAVAILABLE:case Q.UNAUTHENTICATED:return!1;case Q.INVALID_ARGUMENT:case Q.NOT_FOUND:case Q.ALREADY_EXISTS:case Q.PERMISSION_DENIED:case Q.FAILED_PRECONDITION:case Q.ABORTED:case Q.OUT_OF_RANGE:case Q.UNIMPLEMENTED:case Q.DATA_LOSS:return!0;default:return de(15467,{code:t})}}function qC(t){if(t===void 0)return un("GRPC error has no .code"),Q.UNKNOWN;switch(t){case St.OK:return Q.OK;case St.CANCELLED:return Q.CANCELLED;case St.UNKNOWN:return Q.UNKNOWN;case St.DEADLINE_EXCEEDED:return Q.DEADLINE_EXCEEDED;case St.RESOURCE_EXHAUSTED:return Q.RESOURCE_EXHAUSTED;case St.INTERNAL:return Q.INTERNAL;case St.UNAVAILABLE:return Q.UNAVAILABLE;case St.UNAUTHENTICATED:return Q.UNAUTHENTICATED;case St.INVALID_ARGUMENT:return Q.INVALID_ARGUMENT;case St.NOT_FOUND:return Q.NOT_FOUND;case St.ALREADY_EXISTS:return Q.ALREADY_EXISTS;case St.PERMISSION_DENIED:return Q.PERMISSION_DENIED;case St.FAILED_PRECONDITION:return Q.FAILED_PRECONDITION;case St.ABORTED:return Q.ABORTED;case St.OUT_OF_RANGE:return Q.OUT_OF_RANGE;case St.UNIMPLEMENTED:return Q.UNIMPLEMENTED;case St.DATA_LOSS:return Q.DATA_LOSS;default:return de(39323,{code:t})}}(Ve=St||(St={}))[Ve.OK=0]="OK",Ve[Ve.CANCELLED=1]="CANCELLED",Ve[Ve.UNKNOWN=2]="UNKNOWN",Ve[Ve.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ve[Ve.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ve[Ve.NOT_FOUND=5]="NOT_FOUND",Ve[Ve.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ve[Ve.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ve[Ve.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ve[Ve.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ve[Ve.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ve[Ve.ABORTED=10]="ABORTED",Ve[Ve.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ve[Ve.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ve[Ve.INTERNAL=13]="INTERNAL",Ve[Ve.UNAVAILABLE=14]="UNAVAILABLE",Ve[Ve.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _4(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y4=new is([4294967295,4294967295],0);function sw(t){const e=_4().encode(t),n=new L0;return n.update(e),new Uint8Array(n.digest())}function ow(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new is([n,r],0),new is([i,s],0)]}class W_{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Gl(`Invalid padding: ${n}`);if(r<0)throw new Gl(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Gl(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Gl(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=is.fromNumber(this.ge)}ye(e,n,r){let i=e.add(n.multiply(is.fromNumber(r)));return i.compare(y4)===1&&(i=new is([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=sw(e),[r,i]=ow(n);for(let s=0;s<this.hashCount;s++){const o=this.ye(r,i,s);if(!this.we(o))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new W_(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.ge===0)return;const n=sw(e),[r,i]=ow(n);for(let s=0;s<this.hashCount;s++){const o=this.ye(r,i,s);this.Se(o)}}Se(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Gl extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yf{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,ac.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new yf(ge.min(),i,new ht(ve),Nn(),Se())}}class ac{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new ac(r,n,Se(),Se(),Se())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bd{constructor(e,n,r,i){this.be=e,this.removedTargetIds=n,this.key=r,this.De=i}}class zC{constructor(e,n){this.targetId=e,this.Ce=n}}class $C{constructor(e,n,r=It.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class aw{constructor(){this.ve=0,this.Fe=lw(),this.Me=It.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Se(),n=Se(),r=Se();return this.Fe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:de(38017,{changeType:s})}}),new ac(this.Me,this.xe,e,n,r)}qe(){this.Oe=!1,this.Fe=lw()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,pe(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class v4{constructor(e){this.Ge=e,this.ze=new Map,this.je=Nn(),this.Je=td(),this.He=td(),this.Ye=new ht(ve)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:de(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((r,i)=>{this.rt(i)&&n(i)})}st(e){const n=e.targetId,r=e.Ce.count,i=this.ot(n);if(i){const s=i.target;if(wh(s))if(r===0){const o=new se(s.path);this.et(n,o,Tt.newNoDocument(o,ge.min()))}else pe(r===1,20013,{expectedCount:r});else{const o=this._t(n);if(o!==r){const a=this.ut(e),l=a?this.ct(a,e,o):1;if(l!==0){this.it(n);const u=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,u)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let o,a;try{o=ui(r).toUint8Array()}catch(l){if(l instanceof dC)return ds("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new W_(o,i,s)}catch(l){return ds(l instanceof Gl?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.ge===0?null:a}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.et(n,s,null),i++)}),i}Tt(e){const n=new Map;this.ze.forEach((s,o)=>{const a=this.ot(o);if(a){if(s.current&&wh(a.target)){const l=new se(a.target.path);this.It(l).has(o)||this.Et(o,l)||this.et(o,l,Tt.newNoDocument(l,e))}s.Be&&(n.set(o,s.ke()),s.qe())}});let r=Se();this.He.forEach((s,o)=>{let a=!0;o.forEachWhile(l=>{const u=this.ot(l);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.je.forEach((s,o)=>o.setReadTime(e));const i=new yf(e,n,this.Ye,this.je,r);return this.je=Nn(),this.Je=td(),this.He=td(),this.Ye=new ht(ve),i}Xe(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,r),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,n)?i.Qe(n,1):i.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new aw,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new Ke(ve),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new Ke(ve),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||te("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new aw),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function td(){return new ht(se.comparator)}function lw(){return new ht(se.comparator)}const T4={asc:"ASCENDING",desc:"DESCENDING"},E4={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},w4={and:"AND",or:"OR"};class I4{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function ng(t,e){return t.useProto3Json||lf(e)?e:{value:e}}function za(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function jC(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function S4(t,e){return za(t,e.toTimestamp())}function fn(t){return pe(!!t,49232),ge.fromTimestamp(function(n){const r=li(n);return new $e(r.seconds,r.nanos)}(t))}function K_(t,e){return rg(t,e).canonicalString()}function rg(t,e){const n=function(i){return new ze(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function HC(t){const e=ze.fromString(t);return pe(tA(e),10190,{key:e.toString()}),e}function Sh(t,e){return K_(t.databaseId,e.path)}function ro(t,e){const n=HC(e);if(n.get(1)!==t.databaseId.projectId)throw new ie(Q.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new ie(Q.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new se(JC(n))}function WC(t,e){return K_(t.databaseId,e)}function KC(t){const e=HC(t);return e.length===4?ze.emptyPath():JC(e)}function ig(t){return new ze(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function JC(t){return pe(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function uw(t,e,n){return{name:Sh(t,e),fields:n.value.mapValue.fields}}function x4(t,e,n){const r=ro(t,e.name),i=fn(e.updateTime),s=e.createTime?fn(e.createTime):ge.min(),o=new tn({mapValue:{fields:e.fields}}),a=Tt.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function C4(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:de(39313,{state:u})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(u,p){return u.useProto3Json?(pe(p===void 0||typeof p=="string",58123),It.fromBase64String(p||"")):(pe(p===void 0||p instanceof Buffer||p instanceof Uint8Array,16193),It.fromUint8Array(p||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(u){const p=u.code===void 0?Q.UNKNOWN:qC(u.code);return new ie(p,u.message||"")}(o);n=new $C(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=ro(t,r.document.name),s=fn(r.document.updateTime),o=r.document.createTime?fn(r.document.createTime):ge.min(),a=new tn({mapValue:{fields:r.document.fields}}),l=Tt.newFoundDocument(i,s,o,a),u=r.targetIds||[],p=r.removedTargetIds||[];n=new bd(u,p,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=ro(t,r.document),s=r.readTime?fn(r.readTime):ge.min(),o=Tt.newNoDocument(i,s),a=r.removedTargetIds||[];n=new bd([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=ro(t,r.document),s=r.removedTargetIds||[];n=new bd([],s,i,null)}else{if(!("filter"in e))return de(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new m4(i,s),a=r.targetId;n=new zC(a,o)}}return n}function xh(t,e){let n;if(e instanceof nl)n={update:uw(t,e.key,e.value)};else if(e instanceof _f)n={delete:Sh(t,e.key)};else if(e instanceof pi)n={update:uw(t,e.key,e.data),updateMask:b4(e.fieldMask)};else{if(!(e instanceof GC))return de(16599,{Vt:e.type});n={verify:Sh(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const a=o.transform;if(a instanceof Ba)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Ga)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof qa)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof qu)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw de(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:S4(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:de(27497)}(t,e.precondition)),n}function sg(t,e){const n=e.currentDocument?function(s){return s.updateTime!==void 0?cn.updateTime(fn(s.updateTime)):s.exists!==void 0?cn.exists(s.exists):cn.none()}(e.currentDocument):cn.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let l=null;if("setToServerValue"in a)pe(a.setToServerValue==="REQUEST_TIME",16630,{proto:a}),l=new Ba;else if("appendMissingElements"in a){const p=a.appendMissingElements.values||[];l=new Ga(p)}else if("removeAllFromArray"in a){const p=a.removeAllFromArray.values||[];l=new qa(p)}else"increment"in a?l=new qu(o,a.increment):de(16584,{proto:a});const u=dt.fromServerFormat(a.fieldPath);return new UC(u,l)}(t,i)):[];if(e.update){e.update.name;const i=ro(t,e.update.name),s=new tn({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(l){const u=l.fieldPaths||[];return new vn(u.map(p=>dt.fromServerFormat(p)))}(e.updateMask);return new pi(i,s,o,n,r)}return new nl(i,s,n,r)}if(e.delete){const i=ro(t,e.delete);return new _f(i,n)}if(e.verify){const i=ro(t,e.verify);return new GC(i,n)}return de(1463,{proto:e})}function A4(t,e){return t&&t.length>0?(pe(e!==void 0,14353),t.map(n=>function(i,s){let o=i.updateTime?fn(i.updateTime):fn(s);return o.isEqual(ge.min())&&(o=fn(s)),new h4(o,i.transformResults||[])}(n,e))):[]}function QC(t,e){return{documents:[WC(t,e.path)]}}function YC(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=WC(t,i);const s=function(u){if(u.length!==0)return eA(He.create(u,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const o=function(u){if(u.length!==0)return u.map(p=>function(g){return{field:Ho(g.field),direction:P4(g.dir)}}(p))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=ng(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{ft:n,parent:i}}function XC(t){let e=KC(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){pe(r===1,65062);const p=n.from[0];p.allDescendants?i=p.collectionId:e=e.child(p.collectionId)}let s=[];n.where&&(s=function(m){const g=ZC(m);return g instanceof He&&q_(g)?g.getFilters():[g]}(n.where));let o=[];n.orderBy&&(o=function(m){return m.map(g=>function(I){return new Eh(Wo(I.field),function(V){switch(V){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(I.direction))}(g))}(n.orderBy));let a=null;n.limit&&(a=function(m){let g;return g=typeof m=="object"?m.value:m,lf(g)?null:g}(n.limit));let l=null;n.startAt&&(l=function(m){const g=!!m.before,v=m.values||[];return new Ua(v,g)}(n.startAt));let u=null;return n.endAt&&(u=function(m){const g=!m.before,v=m.values||[];return new Ua(v,g)}(n.endAt)),ZU(e,i,o,s,a,"F",l,u)}function R4(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return de(28987,{purpose:i})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function ZC(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Wo(n.unaryFilter.field);return Me.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Wo(n.unaryFilter.field);return Me.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Wo(n.unaryFilter.field);return Me.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Wo(n.unaryFilter.field);return Me.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return de(61313);default:return de(60726)}}(t):t.fieldFilter!==void 0?function(n){return Me.create(Wo(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return de(58110);default:return de(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return He.create(n.compositeFilter.filters.map(r=>ZC(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return de(1026)}}(n.compositeFilter.op))}(t):de(30097,{filter:t})}function P4(t){return T4[t]}function k4(t){return E4[t]}function N4(t){return w4[t]}function Ho(t){return{fieldPath:t.canonicalString()}}function Wo(t){return dt.fromServerFormat(t.fieldPath)}function eA(t){return t instanceof Me?function(n){if(n.op==="=="){if(WE(n.value))return{unaryFilter:{field:Ho(n.field),op:"IS_NAN"}};if(HE(n.value))return{unaryFilter:{field:Ho(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(WE(n.value))return{unaryFilter:{field:Ho(n.field),op:"IS_NOT_NAN"}};if(HE(n.value))return{unaryFilter:{field:Ho(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ho(n.field),op:k4(n.op),value:n.value}}}(t):t instanceof He?function(n){const r=n.getFilters().map(i=>eA(i));return r.length===1?r[0]:{compositeFilter:{op:N4(n.op),filters:r}}}(t):de(54877,{filter:t})}function b4(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function tA(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zr{constructor(e,n,r,i,s=ge.min(),o=ge.min(),a=It.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new Zr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Zr(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Zr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Zr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nA{constructor(e){this.yt=e}}function D4(t,e){let n;if(e.document)n=x4(t.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=se.fromSegments(e.noDocument.path),i=go(e.noDocument.readTime);n=Tt.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return de(56709);{const r=se.fromSegments(e.unknownDocument.path),i=go(e.unknownDocument.version);n=Tt.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){const s=new $e(i[0],i[1]);return ge.fromTimestamp(s)}(e.readTime)),n}function cw(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Ch(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:Sh(s,o.key),fields:o.data.value.mapValue.fields,updateTime:za(s,o.version.toTimestamp()),createTime:za(s,o.createTime.toTimestamp())}}(t.yt,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:mo(e.version)};else{if(!e.isUnknownDocument())return de(57904,{document:e});r.unknownDocument={path:n.path.toArray(),version:mo(e.version)}}return r}function Ch(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function mo(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function go(t){const e=new $e(t.seconds,t.nanoseconds);return ge.fromTimestamp(e)}function $s(t,e){const n=(e.baseMutations||[]).map(s=>sg(t.yt,s));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map(s=>sg(t.yt,s)),i=$e.fromMillis(e.localWriteTimeMs);return new $_(e.batchId,i,n,r)}function ql(t){const e=go(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?go(t.lastLimboFreeSnapshotVersion):ge.min();let r;return r=function(s){return s.documents!==void 0}(t.query)?function(s){const o=s.documents.length;return pe(o===1,1966,{count:o}),Yn(sc(KC(s.documents[0])))}(t.query):function(s){return Yn(XC(s))}(t.query),new Zr(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,It.fromBase64String(t.resumeToken))}function rA(t,e){const n=mo(e.snapshotVersion),r=mo(e.lastLimboFreeSnapshotVersion);let i;i=wh(e.target)?QC(t.yt,e.target):YC(t.yt,e.target).ft;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:po(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function iA(t){const e=XC({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?tg(e,e.limit,"L"):e}function Ip(t,e){return new H_(e.largestBatchId,sg(t.yt,e.overlayMutation))}function dw(t,e){const n=e.path.lastSegment();return[t,rn(e.path.popLast()),n]}function hw(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:mo(r.readTime),documentKey:rn(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M4{getBundleMetadata(e,n){return fw(e).get(n).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:go(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,n){return fw(e).put(function(i){return{bundleId:i.id,createTime:mo(fn(i.createTime)),version:i.version}}(n))}getNamedQuery(e,n){return pw(e).get(n).next(r=>{if(r)return function(s){return{name:s.name,query:iA(s.bundledQuery),readTime:go(s.readTime)}}(r)})}saveNamedQuery(e,n){return pw(e).put(function(i){return{name:i.name,readTime:mo(fn(i.readTime)),bundledQuery:i.bundledQuery}}(n))}}function fw(t){return bt(t,uf)}function pw(t){return bt(t,cf)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vf{constructor(e,n){this.serializer=e,this.userId=n}static wt(e,n){const r=n.uid||"";return new vf(e,r)}getOverlay(e,n){return kl(e).get(dw(this.userId,n)).next(r=>r?Ip(this.serializer,r):null)}getOverlays(e,n){const r=kr();return j.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){const i=[];return r.forEach((s,o)=>{const a=new H_(n,o);i.push(this.St(e,a))}),j.waitFor(i)}removeOverlaysForBatchId(e,n,r){const i=new Set;n.forEach(o=>i.add(rn(o.getCollectionPath())));const s=[];return i.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(kl(e).Z(Wm,a))}),j.waitFor(s)}getOverlaysForCollection(e,n,r){const i=kr(),s=rn(n),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return kl(e).J(Wm,o).next(a=>{for(const l of a){const u=Ip(this.serializer,l);i.set(u.getKey(),u)}return i})}getOverlaysForCollectionGroup(e,n,r,i){const s=kr();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return kl(e).ee({index:sC,range:a},(l,u,p)=>{const m=Ip(this.serializer,u);s.size()<i||m.largestBatchId===o?(s.set(m.getKey(),m),o=m.largestBatchId):p.done()}).next(()=>s)}St(e,n){return kl(e).put(function(i,s,o){const[a,l,u]=dw(s,o.mutation.key);return{userId:s,collectionPath:l,documentId:u,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:xh(i.yt,o.mutation)}}(this.serializer,this.userId,n))}}function kl(t){return bt(t,df)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V4{bt(e){return bt(e,F_)}getSessionToken(e){return this.bt(e).get("sessionToken").next(n=>{const r=n==null?void 0:n.value;return r?It.fromUint8Array(r):It.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.bt(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class js{constructor(){}Dt(e,n){this.Ct(e,n),n.vt()}Ct(e,n){if("nullValue"in e)this.Ft(n,5);else if("booleanValue"in e)this.Ft(n,10),n.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(n,15),n.Mt(ut(e.integerValue));else if("doubleValue"in e){const r=ut(e.doubleValue);isNaN(r)?this.Ft(n,13):(this.Ft(n,15),Mu(r)?n.Mt(0):n.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(n,20),typeof r=="string"&&(r=li(r)),n.xt(`${r.seconds||""}`),n.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,n),this.Nt(n);else if("bytesValue"in e)this.Ft(n,30),n.Bt(ui(e.bytesValue)),this.Nt(n);else if("referenceValue"in e)this.Lt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(n,45),n.Mt(r.latitude||0),n.Mt(r.longitude||0)}else"mapValue"in e?_C(e)?this.Ft(n,Number.MAX_SAFE_INTEGER):ff(e)?this.kt(e.mapValue,n):(this.qt(e.mapValue,n),this.Nt(n)):"arrayValue"in e?(this.Qt(e.arrayValue,n),this.Nt(n)):de(19022,{$t:e})}Ot(e,n){this.Ft(n,25),this.Ut(e,n)}Ut(e,n){n.xt(e)}qt(e,n){const r=e.fields||{};this.Ft(n,55);for(const i of Object.keys(r))this.Ot(i,n),this.Ct(r[i],n)}kt(e,n){var o,a;const r=e.fields||{};this.Ft(n,53);const i=La,s=((a=(o=r[i].arrayValue)==null?void 0:o.values)==null?void 0:a.length)||0;this.Ft(n,15),n.Mt(ut(s)),this.Ot(i,n),this.Ct(r[i],n)}Qt(e,n){const r=e.values||[];this.Ft(n,50);for(const i of r)this.Ct(i,n)}Lt(e,n){this.Ft(n,37),se.fromName(e).path.forEach(r=>{this.Ft(n,60),this.Ut(r,n)})}Ft(e,n){e.Mt(n)}Nt(e){e.Mt(2)}}js.Kt=new js;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bo=255;function L4(t){if(t===0)return 8;let e=0;return t>>4||(e+=4,t<<=4),t>>6||(e+=2,t<<=2),t>>7||(e+=1),e}function mw(t){const e=64-function(r){let i=0;for(let s=0;s<8;++s){const o=L4(255&r[s]);if(i+=o,o!==8)break}return i}(t);return Math.ceil(e/8)}class F4{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Gt(r.value),r=n.next();this.zt()}jt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Jt(r.value),r=n.next();this.Ht()}Yt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const i=n.codePointAt(0);this.Gt(240|i>>>18),this.Gt(128|63&i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i)}}this.zt()}Zt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const i=n.codePointAt(0);this.Jt(240|i>>>18),this.Jt(128|63&i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i)}}this.Ht()}Xt(e){const n=this.en(e),r=mw(n);this.tn(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}nn(e){const n=this.en(e),r=mw(n);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}rn(){this.sn(Bo),this.sn(255)}_n(){this.an(Bo),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const n=function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=!!(128&n[0]);n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Gt(e){const n=255&e;n===0?(this.sn(0),this.sn(255)):n===Bo?(this.sn(Bo),this.sn(0)):this.sn(n)}Jt(e){const n=255&e;n===0?(this.an(0),this.an(255)):n===Bo?(this.an(Bo),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class U4{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class O4{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class Nl{constructor(){this.cn=new F4,this.ln=new U4(this.cn),this.hn=new O4(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hs{constructor(e,n,r,i){this.Tn=e,this.In=n,this.En=r,this.dn=i}An(){const e=this.dn.length,n=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.dn,0),n!==e?r.set([0],this.dn.length):++r[r.length-1],new Hs(this.Tn,this.In,this.En,r)}Rn(e,n,r){return{indexId:this.Tn,uid:e,arrayValue:Dd(this.En),directionalValue:Dd(this.dn),orderedDocumentKey:Dd(n),documentKey:r.path.toArray()}}Vn(e,n,r){const i=this.Rn(e,n,r);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}}function Ni(t,e){let n=t.Tn-e.Tn;return n!==0?n:(n=gw(t.En,e.En),n!==0?n:(n=gw(t.dn,e.dn),n!==0?n:se.comparator(t.In,e.In)))}function gw(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}function Dd(t){return Yx()?function(n){let r="";for(let i=0;i<n.length;i++)r+=String.fromCharCode(n[i]);return r}(t):t}function _w(t){return typeof t!="string"?t:function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(t)}class yw{constructor(e){this.mn=new Ke((n,r)=>dt.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const n of e.filters){const r=n;r.isInequality()?this.mn=this.mn.add(r):this.gn.push(r)}}get pn(){return this.mn.size>1}yn(e){if(pe(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const n=$m(e);if(n!==void 0&&!this.wn(n))return!1;const r=Bs(e);let i=new Set,s=0,o=0;for(;s<r.length&&this.wn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.mn.size>0){const a=this.mn.getIterator().getNext();if(!i.has(a.field.canonicalString())){const l=r[s];if(!this.Sn(a,l)||!this.bn(this.fn[o++],l))return!1}++s}for(;s<r.length;++s){const a=r[s];if(o>=this.fn.length||!this.bn(this.fn[o++],a))return!1}return!0}Dn(){if(this.pn)return null;let e=new Ke(dt.comparator);const n=[];for(const r of this.gn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new xd(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new xd(r.field,0))}for(const r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new xd(r.field,r.dir==="asc"?0:1)));return new gh(gh.UNKNOWN_ID,this.collectionId,n,Du.empty())}wn(e){for(const n of this.gn)if(this.Sn(n,e))return!0;return!1}Sn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}bn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sA(t){var n,r;if(pe(t instanceof Me||t instanceof He,20012),t instanceof Me){if(t instanceof CC){const i=((r=(n=t.value.arrayValue)==null?void 0:n.values)==null?void 0:r.map(s=>Me.create(t.field,"==",s)))||[];return He.create(i,"or")}return t}const e=t.filters.map(i=>sA(i));return He.create(e,t.op)}function B4(t){if(t.getFilters().length===0)return[];const e=lg(sA(t));return pe(oA(e),7391),og(e)||ag(e)?[e]:e.getFilters()}function og(t){return t instanceof Me}function ag(t){return t instanceof He&&q_(t)}function oA(t){return og(t)||ag(t)||function(n){if(n instanceof He&&Ym(n)){for(const r of n.getFilters())if(!og(r)&&!ag(r))return!1;return!0}return!1}(t)}function lg(t){if(pe(t instanceof Me||t instanceof He,34018),t instanceof Me)return t;if(t.filters.length===1)return lg(t.filters[0]);const e=t.filters.map(r=>lg(r));let n=He.create(e,t.op);return n=Ah(n),oA(n)?n:(pe(n instanceof He,64498),pe(Oa(n),40251),pe(n.filters.length>1,57927),n.filters.reduce((r,i)=>J_(r,i)))}function J_(t,e){let n;return pe(t instanceof Me||t instanceof He,38388),pe(e instanceof Me||e instanceof He,25473),n=t instanceof Me?e instanceof Me?function(i,s){return He.create([i,s],"and")}(t,e):vw(t,e):e instanceof Me?vw(e,t):function(i,s){if(pe(i.filters.length>0&&s.filters.length>0,48005),Oa(i)&&Oa(s))return IC(i,s.getFilters());const o=Ym(i)?i:s,a=Ym(i)?s:i,l=o.filters.map(u=>J_(u,a));return He.create(l,"or")}(t,e),Ah(n)}function vw(t,e){if(Oa(e))return IC(e,t.getFilters());{const n=e.filters.map(r=>J_(t,r));return He.create(n,"or")}}function Ah(t){if(pe(t instanceof Me||t instanceof He,11850),t instanceof Me)return t;const e=t.getFilters();if(e.length===1)return Ah(e[0]);if(EC(t))return t;const n=e.map(i=>Ah(i)),r=[];return n.forEach(i=>{i instanceof Me?r.push(i):i instanceof He&&(i.op===t.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:He.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G4{constructor(){this.Cn=new Q_}addToCollectionParentIndex(e,n){return this.Cn.add(n),j.resolve()}getCollectionParents(e,n){return j.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return j.resolve()}deleteFieldIndex(e,n){return j.resolve()}deleteAllFieldIndexes(e){return j.resolve()}createTargetIndexes(e,n){return j.resolve()}getDocumentsMatchingTarget(e,n){return j.resolve(null)}getIndexType(e,n){return j.resolve(0)}getFieldIndexes(e,n){return j.resolve([])}getNextCollectionGroupToUpdate(e){return j.resolve(null)}getMinOffset(e,n){return j.resolve(Mn.min())}getMinOffsetFromCollectionGroup(e,n){return j.resolve(Mn.min())}updateCollectionGroup(e,n,r){return j.resolve()}updateIndexEntries(e,n){return j.resolve()}}class Q_{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Ke(ze.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Ke(ze.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tw="IndexedDbIndexManager",nd=new Uint8Array(0);class q4{constructor(e,n){this.databaseId=n,this.vn=new Q_,this.Fn=new fi(r=>po(r),(r,i)=>rc(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.vn.has(n)){const r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this.vn.add(n)});const s={collectionId:r,parent:rn(i)};return Ew(e).put(s)}return j.resolve()}getCollectionParents(e,n){const r=[],i=IDBKeyRange.bound([n,""],[H0(n),""],!1,!0);return Ew(e).J(i).next(s=>{for(const o of s){if(o.collectionId!==n)break;r.push(Pr(o.parent))}return r})}addFieldIndex(e,n){const r=bl(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(l=>[l.fieldPath.canonicalString(),l.kind])}}(n);delete i.indexId;const s=r.add(i);if(n.indexState){const o=qo(e);return s.next(a=>{o.put(hw(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){const r=bl(e),i=qo(e),s=Go(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=bl(e),r=Go(e),i=qo(e);return n.Z().next(()=>r.Z()).next(()=>i.Z())}createTargetIndexes(e,n){return j.forEach(this.Mn(n),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){const s=new yw(r).Dn();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,n){const r=Go(e);let i=!0;const s=new Map;return j.forEach(this.Mn(n),o=>this.xn(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=Se();const a=[];return j.forEach(s,(l,u)=>{te(Tw,`Using index ${function(A){return`id=${A.indexId}|cg=${A.collectionGroup}|f=${A.fields.map(L=>`${L.fieldPath}:${L.kind}`).join(",")}`}(l)} to execute ${po(n)}`);const p=function(A,L){const q=$m(L);if(q===void 0)return null;for(const z of Ih(A,q.fieldPath))switch(z.op){case"array-contains-any":return z.value.arrayValue.values||[];case"array-contains":return[z.value]}return null}(u,l),m=function(A,L){const q=new Map;for(const z of Bs(L))for(const E of Ih(A,z.fieldPath))switch(E.op){case"==":case"in":q.set(z.fieldPath.canonicalString(),E.value);break;case"not-in":case"!=":return q.set(z.fieldPath.canonicalString(),E.value),Array.from(q.values())}return null}(u,l),g=function(A,L){const q=[];let z=!0;for(const E of Bs(L)){const x=E.kind===0?XE(A,E.fieldPath,A.startAt):ZE(A,E.fieldPath,A.startAt);q.push(x.value),z&&(z=x.inclusive)}return new Ua(q,z)}(u,l),v=function(A,L){const q=[];let z=!0;for(const E of Bs(L)){const x=E.kind===0?ZE(A,E.fieldPath,A.endAt):XE(A,E.fieldPath,A.endAt);q.push(x.value),z&&(z=x.inclusive)}return new Ua(q,z)}(u,l),I=this.On(l,u,g),P=this.On(l,u,v),V=this.Nn(l,u,m),C=this.Bn(l.indexId,p,I,g.inclusive,P,v.inclusive,V);return j.forEach(C,S=>r.Y(S,n.limit).next(A=>{A.forEach(L=>{const q=se.fromSegments(L.documentKey);o.has(q)||(o=o.add(q),a.push(q))})}))}).next(()=>a)}return j.resolve(null)})}Mn(e){let n=this.Fn.get(e);return n||(e.filters.length===0?n=[e]:n=B4(He.create(e.filters,"and")).map(r=>Zm(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.Fn.set(e,n),n)}Bn(e,n,r,i,s,o,a){const l=(n!=null?n.length:1)*Math.max(r.length,s.length),u=l/(n!=null?n.length:1),p=[];for(let m=0;m<l;++m){const g=n?this.Ln(n[m/u]):nd,v=this.kn(e,g,r[m%u],i),I=this.qn(e,g,s[m%u],o),P=a.map(V=>this.kn(e,g,V,!0));p.push(...this.createRange(v,I,P))}return p}kn(e,n,r,i){const s=new Hs(e,se.empty(),n,r);return i?s:s.An()}qn(e,n,r,i){const s=new Hs(e,se.empty(),n,r);return i?s.An():s}xn(e,n){const r=new yw(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(const a of s)r.yn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2;const i=this.Mn(n);return j.forEach(i,s=>this.xn(e,s).next(o=>{o?r!==0&&o.fields.length<function(l){let u=new Ke(dt.comparator),p=!1;for(const m of l.filters)for(const g of m.getFlattenedFilters())g.field.isKeyField()||(g.op==="array-contains"||g.op==="array-contains-any"?p=!0:u=u.add(g.field));for(const m of l.orderBy)m.field.isKeyField()||(u=u.add(m.field));return u.size+(p?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&i.length>1&&r===2?1:r)}Qn(e,n){const r=new Nl;for(const i of Bs(e)){const s=n.data.field(i.fieldPath);if(s==null)return null;const o=r.Pn(i.kind);js.Kt.Dt(s,o)}return r.un()}Ln(e){const n=new Nl;return js.Kt.Dt(e,n.Pn(0)),n.un()}$n(e,n){const r=new Nl;return js.Kt.Dt(Bu(this.databaseId,n),r.Pn(function(s){const o=Bs(s);return o.length===0?0:o[o.length-1].kind}(e))),r.un()}Nn(e,n,r){if(r===null)return[];let i=[];i.push(new Nl);let s=0;for(const o of Bs(e)){const a=r[s++];for(const l of i)if(this.Un(n,o.fieldPath)&&Gu(a))i=this.Kn(i,o,a);else{const u=l.Pn(o.kind);js.Kt.Dt(a,u)}}return this.Wn(i)}On(e,n,r){return this.Nn(e,n,r.position)}Wn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].un();return n}Kn(e,n,r){const i=[...e],s=[];for(const o of r.arrayValue.values||[])for(const a of i){const l=new Nl;l.seed(a.un()),js.Kt.Dt(o,l.Pn(n.kind)),s.push(l)}return s}Un(e,n){return!!e.filters.find(r=>r instanceof Me&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=bl(e),i=qo(e);return(n?r.J(Hm,IDBKeyRange.bound(n,n)):r.J()).next(s=>{const o=[];return j.forEach(s,a=>i.get([a.indexId,this.uid]).next(l=>{o.push(function(p,m){const g=m?new Du(m.sequenceNumber,new Mn(go(m.readTime),new se(Pr(m.documentKey)),m.largestBatchId)):Du.empty(),v=p.fields.map(([I,P])=>new xd(dt.fromServerFormat(I),P));return new gh(p.indexId,p.collectionGroup,v,g)}(a,l))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:ve(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const i=bl(e),s=qo(e);return this.Gn(e).next(o=>i.J(Hm,IDBKeyRange.bound(n,n)).next(a=>j.forEach(a,l=>s.put(hw(l.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){const r=new Map;return j.forEach(n,(i,s)=>{const o=r.get(i.collectionGroup);return(o?j.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),j.forEach(a,l=>this.zn(e,i,l).next(u=>{const p=this.jn(s,l);return u.isEqual(p)?j.resolve():this.Jn(e,s,l,u,p)}))))})}Hn(e,n,r,i){return Go(e).put(i.Rn(this.uid,this.$n(r,n.key),n.key))}Yn(e,n,r,i){return Go(e).delete(i.Vn(this.uid,this.$n(r,n.key),n.key))}zn(e,n,r){const i=Go(e);let s=new Ke(Ni);return i.ee({index:iC,range:IDBKeyRange.only([r.indexId,this.uid,Dd(this.$n(r,n))])},(o,a)=>{s=s.add(new Hs(r.indexId,n,_w(a.arrayValue),_w(a.directionalValue)))}).next(()=>s)}jn(e,n){let r=new Ke(Ni);const i=this.Qn(n,e);if(i==null)return r;const s=$m(n);if(s!=null){const o=e.data.field(s.fieldPath);if(Gu(o))for(const a of o.arrayValue.values||[])r=r.add(new Hs(n.indexId,e.key,this.Ln(a),i))}else r=r.add(new Hs(n.indexId,e.key,nd,i));return r}Jn(e,n,r,i,s){te(Tw,"Updating index entries for document '%s'",n.key);const o=[];return function(l,u,p,m,g){const v=l.getIterator(),I=u.getIterator();let P=Oo(v),V=Oo(I);for(;P||V;){let C=!1,S=!1;if(P&&V){const A=p(P,V);A<0?S=!0:A>0&&(C=!0)}else P!=null?S=!0:C=!0;C?(m(V),V=Oo(I)):S?(g(P),P=Oo(v)):(P=Oo(v),V=Oo(I))}}(i,s,Ni,a=>{o.push(this.Hn(e,n,r,a))},a=>{o.push(this.Yn(e,n,r,a))}),j.waitFor(o)}Gn(e){let n=1;return qo(e).ee({index:rC,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>Ni(o,a)).filter((o,a,l)=>!a||Ni(o,l[a-1])!==0);const i=[];i.push(e);for(const o of r){const a=Ni(o,e),l=Ni(o,n);if(a===0)i[0]=e.An();else if(a>0&&l<0)i.push(o),i.push(o.An());else if(l>0)break}i.push(n);const s=[];for(let o=0;o<i.length;o+=2){if(this.Zn(i[o],i[o+1]))return[];const a=i[o].Vn(this.uid,nd,se.empty()),l=i[o+1].Vn(this.uid,nd,se.empty());s.push(IDBKeyRange.bound(a,l))}return s}Zn(e,n){return Ni(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(ww)}getMinOffset(e,n){return j.mapArray(this.Mn(n),r=>this.xn(e,r).next(i=>i||de(44426))).next(ww)}}function Ew(t){return bt(t,Fu)}function Go(t){return bt(t,ou)}function bl(t){return bt(t,L_)}function qo(t){return bt(t,su)}function ww(t){pe(t.length!==0,28825);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const i=t[r].indexState.offset;D_(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new Mn(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iw={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},aA=41943040;class Zt{static withCacheSize(e){return new Zt(e,Zt.DEFAULT_COLLECTION_PERCENTILE,Zt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lA(t,e,n){const r=t.store(ur),i=t.store(ba),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const l=r.ee({range:o},(p,m,g)=>(a++,g.delete()));s.push(l.next(()=>{pe(a===1,47070,{batchId:n.batchId})}));const u=[];for(const p of n.mutations){const m=eC(e,p.key.path,n.batchId);s.push(i.delete(m)),u.push(p.key)}return j.waitFor(s).next(()=>u)}function Rh(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw de(14731);e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Zt.DEFAULT_COLLECTION_PERCENTILE=10,Zt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Zt.DEFAULT=new Zt(aA,Zt.DEFAULT_COLLECTION_PERCENTILE,Zt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Zt.DISABLED=new Zt(-1,0,0);class Tf{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Xn={}}static wt(e,n,r,i){pe(e.uid!=="",64387);const s=e.isAuthenticated()?e.uid:"";return new Tf(s,n,r,i)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return bi(e).ee({index:Ys,range:r},(i,s,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,i){const s=Ko(e),o=bi(e);return o.add({}).next(a=>{pe(typeof a=="number",49019);const l=new $_(a,n,r,i),u=function(v,I,P){const V=P.baseMutations.map(S=>xh(v.yt,S)),C=P.mutations.map(S=>xh(v.yt,S));return{userId:I,batchId:P.batchId,localWriteTimeMs:P.localWriteTime.toMillis(),baseMutations:V,mutations:C}}(this.serializer,this.userId,l),p=[];let m=new Ke((g,v)=>ve(g.canonicalString(),v.canonicalString()));for(const g of i){const v=eC(this.userId,g.key.path,a);m=m.add(g.key.path.popLast()),p.push(o.put(u)),p.push(s.put(v,_U))}return m.forEach(g=>{p.push(this.indexManager.addToCollectionParentIndex(e,g))}),e.addOnCommittedListener(()=>{this.Xn[a]=l.keys()}),j.waitFor(p).next(()=>l)})}lookupMutationBatch(e,n){return bi(e).get(n).next(r=>r?(pe(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:n}),$s(this.serializer,r)):null)}er(e,n){return this.Xn[n]?j.resolve(this.Xn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const i=r.keys();return this.Xn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return bi(e).ee({index:Ys,range:i},(o,a,l)=>{a.userId===this.userId&&(pe(a.batchId>=r,47524,{tr:r}),s=$s(this.serializer,a)),l.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=to;return bi(e).ee({index:Ys,range:n,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,to],[this.userId,Number.POSITIVE_INFINITY]);return bi(e).J(Ys,n).next(r=>r.map(i=>$s(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=Cd(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return Ko(e).ee({range:i},(o,a,l)=>{const[u,p,m]=o,g=Pr(p);if(u===this.userId&&n.path.isEqual(g))return bi(e).get(m).next(v=>{if(!v)throw de(61480,{nr:o,batchId:m});pe(v.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:v.userId,batchId:m}),s.push($s(this.serializer,v))});l.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ke(ve);const i=[];return n.forEach(s=>{const o=Cd(this.userId,s.path),a=IDBKeyRange.lowerBound(o),l=Ko(e).ee({range:a},(u,p,m)=>{const[g,v,I]=u,P=Pr(v);g===this.userId&&s.path.isEqual(P)?r=r.add(I):m.done()});i.push(l)}),j.waitFor(i).next(()=>this.rr(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1,s=Cd(this.userId,r),o=IDBKeyRange.lowerBound(s);let a=new Ke(ve);return Ko(e).ee({range:o},(l,u,p)=>{const[m,g,v]=l,I=Pr(g);m===this.userId&&r.isPrefixOf(I)?I.length===i&&(a=a.add(v)):p.done()}).next(()=>this.rr(e,a))}rr(e,n){const r=[],i=[];return n.forEach(s=>{i.push(bi(e).get(s).next(o=>{if(o===null)throw de(35274,{batchId:s});pe(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:s}),r.push($s(this.serializer,o))}))}),j.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return lA(e.le,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.ir(n.batchId)}),j.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return j.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return Ko(e).ee({range:r},(s,o,a)=>{if(s[0]===this.userId){const l=Pr(s[1]);i.push(l)}else a.done()}).next(()=>{pe(i.length===0,56720,{sr:i.map(s=>s.canonicalString())})})})}containsKey(e,n){return uA(e,this.userId,n)}_r(e){return cA(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:to,lastStreamToken:""})}}function uA(t,e,n){const r=Cd(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return Ko(t).ee({range:s,X:!0},(a,l,u)=>{const[p,m,g]=a;p===e&&m===i&&(o=!0),u.done()}).next(()=>o)}function bi(t){return bt(t,ur)}function Ko(t){return bt(t,ba)}function cA(t){return bt(t,Vu)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _o{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new _o(0)}static cr(){return new _o(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z4{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.lr(e).next(n=>{const r=new _o(n.highestTargetId);return n.highestTargetId=r.next(),this.hr(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.lr(e).next(n=>ge.fromTimestamp(new $e(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.lr(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.lr(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.hr(e,i)))}addTargetData(e,n){return this.Pr(e,n).next(()=>this.lr(e).next(r=>(r.targetCount+=1,this.Tr(n,r),this.hr(e,r))))}updateTargetData(e,n){return this.Pr(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>zo(e).delete(n.targetId)).next(()=>this.lr(e)).next(r=>(pe(r.targetCount>0,8065),r.targetCount-=1,this.hr(e,r)))}removeTargets(e,n,r){let i=0;const s=[];return zo(e).ee((o,a)=>{const l=ql(a);l.sequenceNumber<=n&&r.get(l.targetId)===null&&(i++,s.push(this.removeTargetData(e,l)))}).next(()=>j.waitFor(s)).next(()=>i)}forEachTarget(e,n){return zo(e).ee((r,i)=>{const s=ql(i);n(s)})}lr(e){return Sw(e).get(vh).next(n=>(pe(n!==null,2888),n))}hr(e,n){return Sw(e).put(vh,n)}Pr(e,n){return zo(e).put(rA(this.serializer,n))}Tr(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next(n=>n.targetCount)}getTargetData(e,n){const r=po(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return zo(e).ee({range:i,index:nC},(o,a,l)=>{const u=ql(a);rc(n,u.target)&&(s=u,l.done())}).next(()=>s)}addMatchingKeys(e,n,r){const i=[],s=zi(e);return n.forEach(o=>{const a=rn(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),j.waitFor(i)}removeMatchingKeys(e,n,r){const i=zi(e);return j.forEach(n,s=>{const o=rn(s.path);return j.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){const r=zi(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),i=zi(e);let s=Se();return i.ee({range:r,X:!0},(o,a,l)=>{const u=Pr(o[1]),p=new se(u);s=s.add(p)}).next(()=>s)}containsKey(e,n){const r=rn(n.path),i=IDBKeyRange.bound([r],[H0(r)],!1,!0);let s=0;return zi(e).ee({index:V_,X:!0,range:i},([o,a],l,u)=>{o!==0&&(s++,u.done())}).next(()=>s>0)}At(e,n){return zo(e).get(n).next(r=>r?ql(r):null)}}function zo(t){return bt(t,Da)}function Sw(t){return bt(t,no)}function zi(t){return bt(t,Ma)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xw="LruGarbageCollector",$4=1048576;function Cw([t,e],[n,r]){const i=ve(t,n);return i===0?ve(e,r):i}class j4{constructor(e){this.Ir=e,this.buffer=new Ke(Cw),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();Cw(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class dA{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){te(xw,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Es(n)?te(xw,"Ignoring IndexedDB error during garbage collection: ",n):await wo(n)}await this.Vr(3e5)})}}class H4{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return j.resolve(Kn.ce);const r=new j4(n);return this.mr.forEachTarget(e,i=>r.Ar(i.sequenceNumber)).next(()=>this.mr.pr(e,i=>r.Ar(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.mr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(te("LruGarbageCollector","Garbage collection skipped; disabled"),j.resolve(Iw)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(te("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Iw):this.yr(e,n))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let r,i,s,o,a,l,u;const p=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(m=>(m>this.params.maximumSequenceNumbersToCollect?(te("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),i=this.params.maximumSequenceNumbersToCollect):i=m,o=Date.now(),this.nthSequenceNumber(e,i))).next(m=>(r=m,a=Date.now(),this.removeTargets(e,r,n))).next(m=>(s=m,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(m=>(u=Date.now(),$o()<=De.DEBUG&&te("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-p}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(l-a)+`ms
	Removed ${m} documents in `+(u-l)+`ms
Total Duration: ${u-p}ms`),j.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:m})))}}function hA(t,e){return new H4(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W4{constructor(e,n){this.db=e,this.garbageCollector=hA(this,n)}gr(e){const n=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}pr(e,n){return this.Sr(e,(r,i)=>n(i))}addReference(e,n,r){return rd(e,r)}removeReference(e,n,r){return rd(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return rd(e,n)}br(e,n){return function(i,s){let o=!1;return cA(i).te(a=>uA(i,a,s).next(l=>(l&&(o=!0),j.resolve(!l)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Sr(e,(o,a)=>{if(a<=n){const l=this.br(e,o).next(u=>{if(!u)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,ge.min()),zi(e).delete(function(m){return[0,rn(m.path)]}(o))))});i.push(l)}}).next(()=>j.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return rd(e,n)}Sr(e,n){const r=zi(e);let i,s=Kn.ce;return r.ee({index:V_},([o,a],{path:l,sequenceNumber:u})=>{o===0?(s!==Kn.ce&&n(new se(Pr(i)),s),s=u,i=l):s=Kn.ce}).next(()=>{s!==Kn.ce&&n(new se(Pr(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function rd(t,e){return zi(t).put(function(r,i){return{targetId:0,path:rn(r.path),sequenceNumber:i}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fA{constructor(){this.changes=new fi(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Tt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?j.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K4{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return Ls(e).put(r)}removeEntry(e,n,r){return Ls(e).delete(function(s,o){const a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Ch(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.Dr(e,r)))}getEntry(e,n){let r=Tt.newInvalidDocument(n);return Ls(e).ee({index:Ad,range:IDBKeyRange.only(Dl(n))},(i,s)=>{r=this.Cr(n,s)}).next(()=>r)}vr(e,n){let r={size:0,document:Tt.newInvalidDocument(n)};return Ls(e).ee({index:Ad,range:IDBKeyRange.only(Dl(n))},(i,s)=>{r={document:this.Cr(n,s),size:Rh(s)}}).next(()=>r)}getEntries(e,n){let r=Nn();return this.Fr(e,n,(i,s)=>{const o=this.Cr(i,s);r=r.insert(i,o)}).next(()=>r)}Mr(e,n){let r=Nn(),i=new ht(se.comparator);return this.Fr(e,n,(s,o)=>{const a=this.Cr(s,o);r=r.insert(s,a),i=i.insert(s,Rh(o))}).next(()=>({documents:r,Or:i}))}Fr(e,n,r){if(n.isEmpty())return j.resolve();let i=new Ke(Pw);n.forEach(l=>i=i.add(l));const s=IDBKeyRange.bound(Dl(i.first()),Dl(i.last())),o=i.getIterator();let a=o.getNext();return Ls(e).ee({index:Ad,range:s},(l,u,p)=>{const m=se.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;a&&Pw(a,m)<0;)r(a,null),a=o.getNext();a&&a.isEqual(m)&&(r(a,u),a=o.hasNext()?o.getNext():null),a?p.j(Dl(a)):p.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,s){const o=n.path,a=[o.popLast().toArray(),o.lastSegment(),Ch(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Ls(e).J(IDBKeyRange.bound(a,l,!0)).next(u=>{s==null||s.incrementDocumentReadCount(u.length);let p=Nn();for(const m of u){const g=this.Cr(se.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);g.isFoundDocument()&&(oc(n,g)||i.has(g.key))&&(p=p.insert(g.key,g))}return p})}getAllFromCollectionGroup(e,n,r,i){let s=Nn();const o=Rw(n,r),a=Rw(n,Mn.max());return Ls(e).ee({index:tC,range:IDBKeyRange.bound(o,a,!0)},(l,u,p)=>{const m=this.Cr(se.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);s=s.insert(m.key,m),s.size===i&&p.done()}).next(()=>s)}newChangeBuffer(e){return new J4(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return Aw(e).get(jm).next(n=>(pe(!!n,20021),n))}Dr(e,n){return Aw(e).put(jm,n)}Cr(e,n){if(n){const r=D4(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(ge.min())))return r}return Tt.newInvalidDocument(e)}}function pA(t){return new K4(t)}class J4 extends fA{constructor(e,n){super(),this.Nr=e,this.trackRemovals=n,this.Br=new fi(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const n=[];let r=0,i=new Ke((s,o)=>ve(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const a=this.Br.get(s);if(n.push(this.Nr.removeEntry(e,s,a.readTime)),o.isValidDocument()){const l=cw(this.Nr.serializer,o);i=i.add(s.path.popLast());const u=Rh(l);r+=u-a.size,n.push(this.Nr.addEntry(e,s,l))}else if(r-=a.size,this.trackRemovals){const l=cw(this.Nr.serializer,o.convertToNoDocument(ge.min()));n.push(this.Nr.addEntry(e,s,l))}}),i.forEach(s=>{n.push(this.Nr.indexManager.addToCollectionParentIndex(e,s))}),n.push(this.Nr.updateMetadata(e,r)),j.waitFor(n)}getFromCache(e,n){return this.Nr.vr(e,n).next(r=>(this.Br.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.Nr.Mr(e,n).next(({documents:r,Or:i})=>(i.forEach((s,o)=>{this.Br.set(s,{size:o,readTime:r.get(s).readTime})}),r))}}function Aw(t){return bt(t,Lu)}function Ls(t){return bt(t,yh)}function Dl(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function Rw(t,e){const n=e.documentKey.path.toArray();return[t,Ch(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function Pw(t,e){const n=t.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=ve(n[s],r[s]),i)return i;return i=ve(n.length,r.length),i||(i=ve(n[n.length-2],r[r.length-2]),i||ve(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q4{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mA{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&cu(r.mutation,i,vn.empty(),$e.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Se()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Se()){const i=kr();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=Bl();return s.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=kr();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Se()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=Nn();const o=uu(),a=function(){return uu()}();return n.forEach((l,u)=>{const p=r.get(u.key);i.has(u.key)&&(p===void 0||p.mutation instanceof pi)?s=s.insert(u.key,u):p!==void 0?(o.set(u.key,p.mutation.getFieldMask()),cu(p.mutation,u,p.mutation.getFieldMask(),$e.now())):o.set(u.key,vn.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((u,p)=>o.set(u,p)),n.forEach((u,p)=>a.set(u,new Q4(p,o.get(u)??null))),a))}recalculateAndSaveOverlays(e,n){const r=uu();let i=new ht((o,a)=>o-a),s=Se();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const u=n.get(l);if(u===null)return;let p=r.get(l)||vn.empty();p=a.applyToLocalView(u,p),r.set(l,p);const m=(i.get(a.batchId)||Se()).add(l);i=i.insert(a.batchId,m)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),u=l.key,p=l.value,m=bC();p.forEach(g=>{if(!s.has(g)){const v=OC(n.get(g),r.get(g));v!==null&&m.set(g,v),s=s.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,m))}return j.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return se.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):AC(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):j.resolve(kr());let a=bu,l=s;return o.next(u=>j.forEach(u,(p,m)=>(a<m.largestBatchId&&(a=m.largestBatchId),s.get(p)?j.resolve():this.remoteDocumentCache.getEntry(e,p).next(g=>{l=l.insert(p,g)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,l,u,Se())).next(p=>({batchId:a,changes:NC(p)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new se(n)).next(r=>{let i=Bl();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let o=Bl();return this.indexManager.getCollectionParents(e,s).next(a=>j.forEach(a,l=>{const u=function(m,g){return new ic(g,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(n,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,r,i).next(p=>{p.forEach((m,g)=>{o=o.insert(m,g)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((l,u)=>{const p=u.getKey();o.get(p)===null&&(o=o.insert(p,Tt.newInvalidDocument(p)))});let a=Bl();return o.forEach((l,u)=>{const p=s.get(l);p!==void 0&&cu(p.mutation,u,vn.empty(),$e.now()),oc(n,u)&&(a=a.insert(l,u))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y4{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return j.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:fn(i.createTime)}}(n)),j.resolve()}getNamedQuery(e,n){return j.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,function(i){return{name:i.name,query:iA(i.bundledQuery),readTime:fn(i.readTime)}}(n)),j.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X4{constructor(){this.overlays=new ht(se.comparator),this.qr=new Map}getOverlay(e,n){return j.resolve(this.overlays.get(n))}getOverlays(e,n){const r=kr();return j.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.St(e,n,s)}),j.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.qr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.qr.delete(r)),j.resolve()}getOverlaysForCollection(e,n,r){const i=kr(),s=n.length+1,o=new se(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,u=l.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return j.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new ht((u,p)=>u-p);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let p=s.get(u.largestBatchId);p===null&&(p=kr(),s=s.insert(u.largestBatchId,p)),p.set(u.getKey(),u)}}const a=kr(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((u,p)=>a.set(u,p)),!(a.size()>=i)););return j.resolve(a)}St(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new H_(n,r));let s=this.qr.get(n);s===void 0&&(s=Se(),this.qr.set(n,s)),this.qr.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z4{constructor(){this.sessionToken=It.EMPTY_BYTE_STRING}getSessionToken(e){return j.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,j.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y_{constructor(){this.Qr=new Ke(Vt.$r),this.Ur=new Ke(Vt.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const r=new Vt(e,n);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Gr(new Vt(e,n))}zr(e,n){e.forEach(r=>this.removeReference(r,n))}jr(e){const n=new se(new ze([])),r=new Vt(n,e),i=new Vt(n,e+1),s=[];return this.Ur.forEachInRange([r,i],o=>{this.Gr(o),s.push(o.key)}),s}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new se(new ze([])),r=new Vt(n,e),i=new Vt(n,e+1);let s=Se();return this.Ur.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const n=new Vt(e,0),r=this.Qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Vt{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return se.comparator(e.key,n.key)||ve(e.Yr,n.Yr)}static Kr(e,n){return ve(e.Yr,n.Yr)||se.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eO{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new Ke(Vt.$r)}checkEmpty(e){return j.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new $_(s,n,r,i);this.mutationQueue.push(o);for(const a of i)this.Zr=this.Zr.add(new Vt(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return j.resolve(o)}lookupMutationBatch(e,n){return j.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.ei(r),s=i<0?0:i;return j.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return j.resolve(this.mutationQueue.length===0?to:this.tr-1)}getAllMutationBatches(e){return j.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Vt(n,0),i=new Vt(n,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([r,i],o=>{const a=this.Xr(o.Yr);s.push(a)}),j.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ke(ve);return n.forEach(i=>{const s=new Vt(i,0),o=new Vt(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,o],a=>{r=r.add(a.Yr)})}),j.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;se.isDocumentKey(s)||(s=s.child(""));const o=new Vt(new se(s),0);let a=new Ke(ve);return this.Zr.forEachWhile(l=>{const u=l.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(a=a.add(l.Yr)),!0)},o),j.resolve(this.ti(a))}ti(e){const n=[];return e.forEach(r=>{const i=this.Xr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){pe(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return j.forEach(n.mutations,i=>{const s=new Vt(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,n){const r=new Vt(n,0),i=this.Zr.firstAfterOrEqual(r);return j.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,j.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tO{constructor(e){this.ri=e,this.docs=function(){return new ht(se.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.ri(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return j.resolve(r?r.document.mutableCopy():Tt.newInvalidDocument(n))}getEntries(e,n){let r=Nn();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Tt.newInvalidDocument(i))}),j.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=Nn();const o=n.path,a=new se(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:u,value:{document:p}}=l.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||D_(Q0(p),r)<=0||(i.has(p.key)||oc(n,p))&&(s=s.insert(p.key,p.mutableCopy()))}return j.resolve(s)}getAllFromCollectionGroup(e,n,r,i){de(9500)}ii(e,n){return j.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new nO(this)}getSize(e){return j.resolve(this.size)}}class nO extends fA{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)}),j.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rO{constructor(e){this.persistence=e,this.si=new fi(n=>po(n),rc),this.lastRemoteSnapshotVersion=ge.min(),this.highestTargetId=0,this.oi=0,this._i=new Y_,this.targetCount=0,this.ai=_o.ur()}forEachTarget(e,n){return this.si.forEach((r,i)=>n(i)),j.resolve()}getLastRemoteSnapshotVersion(e){return j.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return j.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),j.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.oi&&(this.oi=n),j.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new _o(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,j.resolve()}updateTargetData(e,n){return this.Pr(n),j.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,j.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.si.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.si.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),j.waitFor(s).next(()=>i)}getTargetCount(e){return j.resolve(this.targetCount)}getTargetData(e,n){const r=this.si.get(n)||null;return j.resolve(r)}addMatchingKeys(e,n,r){return this._i.Wr(n,r),j.resolve()}removeMatchingKeys(e,n,r){this._i.zr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),j.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),j.resolve()}getMatchingKeysForTargetId(e,n){const r=this._i.Hr(n);return j.resolve(r)}containsKey(e,n){return j.resolve(this._i.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X_{constructor(e,n){this.ui={},this.overlays={},this.ci=new Kn(0),this.li=!1,this.li=!0,this.hi=new Z4,this.referenceDelegate=e(this),this.Pi=new rO(this),this.indexManager=new G4,this.remoteDocumentCache=function(i){return new tO(i)}(r=>this.referenceDelegate.Ti(r)),this.serializer=new nA(n),this.Ii=new Y4(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new X4,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ui[e.toKey()];return r||(r=new eO(n,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,r){te("MemoryPersistence","Starting transaction:",e);const i=new iO(this.ci.next());return this.referenceDelegate.Ei(),r(i).next(s=>this.referenceDelegate.di(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ai(e,n){return j.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,n)))}}class iO extends X0{constructor(e){super(),this.currentSequenceNumber=e}}class Ef{constructor(e){this.persistence=e,this.Ri=new Y_,this.Vi=null}static mi(e){return new Ef(e)}get fi(){if(this.Vi)return this.Vi;throw de(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.fi.delete(r.toString()),j.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.fi.add(r.toString()),j.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),j.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach(i=>this.fi.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.fi.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return j.forEach(this.fi,r=>{const i=se.fromPath(r);return this.gi(e,i).next(s=>{s||n.removeEntry(i,ge.min())})}).next(()=>(this.Vi=null,n.apply(e)))}updateLimboDocument(e,n){return this.gi(e,n).next(r=>{r?this.fi.delete(n.toString()):this.fi.add(n.toString())})}Ti(e){return 0}gi(e,n){return j.or([()=>j.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class Ph{constructor(e,n){this.persistence=e,this.pi=new fi(r=>rn(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=hA(this,n)}static mi(e,n){return new Ph(e,n)}Ei(){}di(e){return j.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}pr(e,n){return j.forEach(this.pi,(r,i)=>this.br(e,r,i).next(s=>s?j.resolve():n(i)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ii(e,o=>this.br(e,o,n).next(a=>{a||(r++,s.removeEntry(o,ge.min()))})).next(()=>s.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),j.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),j.resolve()}removeReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),j.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),j.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=Pd(e.data.value)),n}br(e,n,r){return j.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const i=this.pi.get(n);return j.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sO{constructor(e){this.serializer=e}k(e,n,r,i){const s=new af("createOrUpgrade",n);r<1&&i>=1&&(function(l){l.createObjectStore(nc)}(e),function(l){l.createObjectStore(Vu,{keyPath:gU}),l.createObjectStore(ur,{keyPath:BE,autoIncrement:!0}).createIndex(Ys,GE,{unique:!0}),l.createObjectStore(ba)}(e),kw(e),function(l){l.createObjectStore(Gs)}(e));let o=j.resolve();return r<3&&i>=3&&(r!==0&&(function(l){l.deleteObjectStore(Ma),l.deleteObjectStore(Da),l.deleteObjectStore(no)}(e),kw(e)),o=o.next(()=>function(l){const u=l.store(no),p={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:ge.min().toTimestamp(),targetCount:0};return u.put(vh,p)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(l,u){return u.store(ur).J().next(m=>{l.deleteObjectStore(ur),l.createObjectStore(ur,{keyPath:BE,autoIncrement:!0}).createIndex(Ys,GE,{unique:!0});const g=u.store(ur),v=m.map(I=>g.put(I));return j.waitFor(v)})}(e,s))),o=o.next(()=>{(function(l){l.createObjectStore(Va,{keyPath:xU})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.yi(s))),r<6&&i>=6&&(o=o.next(()=>(function(l){l.createObjectStore(Lu)}(e),this.wi(s)))),r<7&&i>=7&&(o=o.next(()=>this.Si(s))),r<8&&i>=8&&(o=o.next(()=>this.bi(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.Di(s))),r<11&&i>=11&&(o=o.next(()=>{(function(l){l.createObjectStore(uf,{keyPath:CU})})(e),function(l){l.createObjectStore(cf,{keyPath:AU})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(l){const u=l.createObjectStore(df,{keyPath:MU});u.createIndex(Wm,VU,{unique:!1}),u.createIndex(sC,LU,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(l){const u=l.createObjectStore(yh,{keyPath:yU});u.createIndex(Ad,vU),u.createIndex(tC,TU)}(e)).next(()=>this.Ci(e,s)).next(()=>e.deleteObjectStore(Gs))),r<14&&i>=14&&(o=o.next(()=>this.Fi(e,s))),r<15&&i>=15&&(o=o.next(()=>function(l){l.createObjectStore(L_,{keyPath:RU,autoIncrement:!0}).createIndex(Hm,PU,{unique:!1}),l.createObjectStore(su,{keyPath:kU}).createIndex(rC,NU,{unique:!1}),l.createObjectStore(ou,{keyPath:bU}).createIndex(iC,DU,{unique:!1})}(e))),r<16&&i>=16&&(o=o.next(()=>{n.objectStore(su).clear()}).next(()=>{n.objectStore(ou).clear()})),r<17&&i>=17&&(o=o.next(()=>{(function(l){l.createObjectStore(F_,{keyPath:FU})})(e)})),r<18&&i>=18&&Yx()&&(o=o.next(()=>{n.objectStore(su).clear()}).next(()=>{n.objectStore(ou).clear()})),o}wi(e){let n=0;return e.store(Gs).ee((r,i)=>{n+=Rh(i)}).next(()=>{const r={byteSize:n};return e.store(Lu).put(jm,r)})}yi(e){const n=e.store(Vu),r=e.store(ur);return n.J().next(i=>j.forEach(i,s=>{const o=IDBKeyRange.bound([s.userId,to],[s.userId,s.lastAcknowledgedBatchId]);return r.J(Ys,o).next(a=>j.forEach(a,l=>{pe(l.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:l.batchId});const u=$s(this.serializer,l);return lA(e,s.userId,u).next(()=>{})}))}))}Si(e){const n=e.store(Ma),r=e.store(Gs);return e.store(no).get(vh).next(i=>{const s=[];return r.ee((o,a)=>{const l=new ze(o),u=function(m){return[0,rn(m)]}(l);s.push(n.get(u).next(p=>p?j.resolve():(m=>n.put({targetId:0,path:rn(m),sequenceNumber:i.highestListenSequenceNumber}))(l)))}).next(()=>j.waitFor(s))})}bi(e,n){e.createObjectStore(Fu,{keyPath:SU});const r=n.store(Fu),i=new Q_,s=o=>{if(i.add(o)){const a=o.lastSegment(),l=o.popLast();return r.put({collectionId:a,parent:rn(l)})}};return n.store(Gs).ee({X:!0},(o,a)=>{const l=new ze(o);return s(l.popLast())}).next(()=>n.store(ba).ee({X:!0},([o,a,l],u)=>{const p=Pr(a);return s(p.popLast())}))}Di(e){const n=e.store(Da);return n.ee((r,i)=>{const s=ql(i),o=rA(this.serializer,s);return n.put(o)})}Ci(e,n){const r=n.store(Gs),i=[];return r.ee((s,o)=>{const a=n.store(yh),l=function(m){return m.document?new se(ze.fromString(m.document.name).popFirst(5)):m.noDocument?se.fromSegments(m.noDocument.path):m.unknownDocument?se.fromSegments(m.unknownDocument.path):de(36783)}(o).path.toArray(),u={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(u))}).next(()=>j.waitFor(i))}Fi(e,n){const r=n.store(ur),i=pA(this.serializer),s=new X_(Ef.mi,this.serializer.yt);return r.J().next(o=>{const a=new Map;return o.forEach(l=>{let u=a.get(l.userId)??Se();$s(this.serializer,l).keys().forEach(p=>u=u.add(p)),a.set(l.userId,u)}),j.forEach(a,(l,u)=>{const p=new jt(u),m=vf.wt(this.serializer,p),g=s.getIndexManager(p),v=Tf.wt(p,this.serializer,g,s.referenceDelegate);return new mA(i,v,m,g).recalculateAndSaveOverlaysForDocumentKeys(new Km(n,Kn.ce),l).next()})})}}function kw(t){t.createObjectStore(Ma,{keyPath:wU}).createIndex(V_,IU,{unique:!0}),t.createObjectStore(Da,{keyPath:"targetId"}).createIndex(nC,EU,{unique:!0}),t.createObjectStore(no)}const Di="IndexedDbPersistence",Sp=18e5,xp=5e3,Cp="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",oO="main";class Z_{constructor(e,n,r,i,s,o,a,l,u,p,m=18){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Mi=s,this.window=o,this.document=a,this.xi=u,this.Oi=p,this.Ni=m,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=g=>Promise.resolve(),!Z_.v())throw new ie(Q.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new W4(this,i),this.$i=n+oO,this.serializer=new nA(l),this.Ui=new ss(this.$i,this.Ni,new sO(this.serializer)),this.hi=new V4,this.Pi=new z4(this.referenceDelegate,this.serializer),this.remoteDocumentCache=pA(this.serializer),this.Ii=new M4,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,p===!1&&un(Di,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new ie(Q.FAILED_PRECONDITION,Cp);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Pi.getHighestSequenceNumber(e))}).then(e=>{this.ci=new Kn(e,this.xi)}).then(()=>{this.li=!0}).catch(e=>(this.Ui&&this.Ui.close(),Promise.reject(e)))}Ji(e){return this.Qi=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget(async()=>{this.started&&await this.Wi()}))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>id(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Hi(e).next(n=>{n||(this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)))})}).next(()=>this.Yi(e)).next(n=>this.isPrimary&&!n?this.Zi(e).next(()=>!1):!!n&&this.Xi(e).next(()=>!0))).catch(e=>{if(Es(e))return te(Di,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return te(Di,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable(()=>this.Qi(e)),this.isPrimary=e})}Hi(e){return Ml(e).get(Uo).next(n=>j.resolve(this.es(n)))}ts(e){return id(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,Sp)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=bt(n,Va);return r.J().next(i=>{const s=this.ss(i,Sp),o=i.filter(a=>s.indexOf(a)===-1);return j.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Ki)for(const n of e)this.Ki.removeItem(this._s(n.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Wi().then(()=>this.ns()).then(()=>this.ji()))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?j.resolve(!0):Ml(e).get(Uo).next(n=>{if(n!==null&&this.rs(n.leaseTimestampMs,xp)&&!this.us(n.ownerId)){if(this.es(n)&&this.networkEnabled)return!0;if(!this.es(n)){if(!n.allowTabSynchronization)throw new ie(Q.FAILED_PRECONDITION,Cp);return!1}}return!(!this.networkEnabled||!this.inForeground)||id(e).J().next(r=>this.ss(r,xp).find(i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&te(Di,`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[nc,Va],e=>{const n=new Km(e,Kn.ce);return this.Zi(n).next(()=>this.ts(n))}),this.Ui.close(),this.Ps()}ss(e,n){return e.filter(r=>this.rs(r.updateTimeMs,n)&&!this.us(r.clientId))}Ts(){return this.runTransaction("getActiveClients","readonly",e=>id(e).J().next(n=>this.ss(n,Sp).map(r=>r.clientId)))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,n){return Tf.wt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new q4(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return vf.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,n,r){te(Di,"Starting transaction:",e);const i=n==="readonly"?"readonly":"readwrite",s=function(l){return l===18?BU:l===17?uC:l===16?OU:l===15?U_:l===14?lC:l===13?aC:l===12?UU:l===11?oC:void de(60245)}(this.Ni);let o;return this.Ui.runTransaction(e,i,s,a=>(o=new Km(a,this.ci?this.ci.next():Kn.ce),n==="readwrite-primary"?this.Hi(o).next(l=>!!l||this.Yi(o)).next(l=>{if(!l)throw un(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)),new ie(Q.FAILED_PRECONDITION,Y0);return r(o)}).next(l=>this.Xi(o).next(()=>l)):this.Is(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Is(e){return Ml(e).get(Uo).next(n=>{if(n!==null&&this.rs(n.leaseTimestampMs,xp)&&!this.us(n.ownerId)&&!this.es(n)&&!(this.Oi||this.allowTabSynchronization&&n.allowTabSynchronization))throw new ie(Q.FAILED_PRECONDITION,Cp)})}Xi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Ml(e).put(Uo,n)}static v(){return ss.v()}Zi(e){const n=Ml(e);return n.get(Uo).next(r=>this.es(r)?(te(Di,"Releasing primary lease."),n.delete(Uo)):j.resolve())}rs(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(un(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi()))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){var e;typeof((e=this.window)==null?void 0:e.addEventListener)=="function"&&(this.Bi=()=>{this.cs();const n=/(?:Version|Mobile)\/1[456]/;Qx()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){var n;try{const r=((n=this.Ki)==null?void 0:n.getItem(this._s(e)))!==null;return te(Di,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return un(Di,"Failed to get zombied client id.",r),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){un("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Ml(t){return bt(t,nc)}function id(t){return bt(t,Va)}function aO(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ey{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.Es=r,this.ds=i}static As(e,n){let r=Se(),i=Se();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new ey(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lO{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gA{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return Qx()?8:Z0(kt())>0?6:4}()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.ys(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ws(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new lO;return this.Ss(e,n,o).next(a=>{if(s.result=a,this.Vs)return this.bs(e,n,o,a.size)})}).next(()=>s.result)}bs(e,n,r,i){return r.documentReadCount<this.fs?($o()<=De.DEBUG&&te("QueryEngine","SDK will not create cache indexes for query:",jo(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),j.resolve()):($o()<=De.DEBUG&&te("QueryEngine","Query:",jo(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?($o()<=De.DEBUG&&te("QueryEngine","The SDK decides to create cache indexes for query:",jo(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Yn(n))):j.resolve())}ys(e,n){if(ew(n))return j.resolve(null);let r=Yn(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=tg(n,null,"F"),r=Yn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=Se(...s);return this.ps.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const u=this.Ds(n,a);return this.Cs(n,u,o,l.readTime)?this.ys(e,tg(n,null,"F")):this.vs(e,u,n,l)}))})))}ws(e,n,r,i){return ew(n)||i.isEqual(ge.min())?j.resolve(null):this.ps.getDocuments(e,r).next(s=>{const o=this.Ds(n,s);return this.Cs(n,o,r,i)?j.resolve(null):($o()<=De.DEBUG&&te("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),jo(n)),this.vs(e,o,n,uU(i,bu)).next(a=>a))})}Ds(e,n){let r=new Ke(PC(e));return n.forEach((i,s)=>{oc(e,s)&&(r=r.add(s))}),r}Cs(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ss(e,n,r){return $o()<=De.DEBUG&&te("QueryEngine","Using full collection scan to execute query:",jo(n)),this.ps.getDocumentsMatchingQuery(e,n,Mn.min(),r)}vs(e,n,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ty="LocalStore",uO=3e8;class cO{constructor(e,n,r,i){this.persistence=e,this.Fs=n,this.serializer=i,this.Ms=new ht(ve),this.xs=new fi(s=>po(s),rc),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new mA(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ms))}}function _A(t,e,n,r){return new cO(t,e,n,r)}async function yA(t,e){const n=Te(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.Bs(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],a=[];let l=Se();for(const u of i){o.push(u.batchId);for(const p of u.mutations)l=l.add(p.key)}for(const u of s){a.push(u.batchId);for(const p of u.mutations)l=l.add(p.key)}return n.localDocuments.getDocuments(r,l).next(u=>({Ls:u,removedBatchIds:o,addedBatchIds:a}))})})}function dO(t,e){const n=Te(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.Ns.newChangeBuffer({trackRemovals:!0});return function(a,l,u,p){const m=u.batch,g=m.keys();let v=j.resolve();return g.forEach(I=>{v=v.next(()=>p.getEntry(l,I)).next(P=>{const V=u.docVersions.get(I);pe(V!==null,48541),P.version.compareTo(V)<0&&(m.applyToRemoteDocument(P,u),P.isValidDocument()&&(P.setReadTime(u.commitVersion),p.addEntry(P)))})}),v.next(()=>a.mutationQueue.removeMutationBatch(l,m))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=Se();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(l=l.add(a.batch.mutations[u].key));return l}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function vA(t){const e=Te(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Pi.getLastRemoteSnapshotVersion(n))}function hO(t,e){const n=Te(t),r=e.snapshotVersion;let i=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.Ns.newChangeBuffer({trackRemovals:!0});i=n.Ms;const a=[];e.targetChanges.forEach((p,m)=>{const g=i.get(m);if(!g)return;a.push(n.Pi.removeMatchingKeys(s,p.removedDocuments,m).next(()=>n.Pi.addMatchingKeys(s,p.addedDocuments,m)));let v=g.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(m)!==null?v=v.withResumeToken(It.EMPTY_BYTE_STRING,ge.min()).withLastLimboFreeSnapshotVersion(ge.min()):p.resumeToken.approximateByteSize()>0&&(v=v.withResumeToken(p.resumeToken,r)),i=i.insert(m,v),function(P,V,C){return P.resumeToken.approximateByteSize()===0||V.snapshotVersion.toMicroseconds()-P.snapshotVersion.toMicroseconds()>=uO?!0:C.addedDocuments.size+C.modifiedDocuments.size+C.removedDocuments.size>0}(g,v,p)&&a.push(n.Pi.updateTargetData(s,v))});let l=Nn(),u=Se();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,p))}),a.push(fO(s,o,e.documentUpdates).next(p=>{l=p.ks,u=p.qs})),!r.isEqual(ge.min())){const p=n.Pi.getLastRemoteSnapshotVersion(s).next(m=>n.Pi.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(p)}return j.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,l,u)).next(()=>l)}).then(s=>(n.Ms=i,s))}function fO(t,e,n){let r=Se(),i=Se();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=Nn();return n.forEach((a,l)=>{const u=s.get(a);l.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(a)),l.isNoDocument()&&l.version.isEqual(ge.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):te(ty,"Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",l.version)}),{ks:o,qs:i}})}function pO(t,e){const n=Te(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=to),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function mO(t,e){const n=Te(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Pi.getTargetData(r,e).next(s=>s?(i=s,j.resolve(i)):n.Pi.allocateTargetId(r).next(o=>(i=new Zr(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Pi.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.Ms.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(r.targetId,r),n.xs.set(e,r.targetId)),r})}async function ug(t,e,n){const r=Te(t),i=r.Ms.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!Es(o))throw o;te(ty,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(i.target)}function Nw(t,e,n){const r=Te(t);let i=ge.min(),s=Se();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,u,p){const m=Te(l),g=m.xs.get(p);return g!==void 0?j.resolve(m.Ms.get(g)):m.Pi.getTargetData(u,p)}(r,o,Yn(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,a.targetId).next(l=>{s=l})}).next(()=>r.Fs.getDocumentsMatchingQuery(o,e,n?i:ge.min(),n?s:Se())).next(a=>(gO(r,t4(e),a),{documents:a,Qs:s})))}function gO(t,e,n){let r=t.Os.get(e)||ge.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.Os.set(e,r)}class bw{constructor(){this.activeTargetIds=a4()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class TA{constructor(){this.Mo=new bw,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,r){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new bw,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _O{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dw="ConnectivityMonitor";class Mw{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){te(Dw,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){te(Dw,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let sd=null;function cg(){return sd===null?sd=function(){return 268435456+Math.round(2147483648*Math.random())}():sd++,"0x"+sd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ap="RestConnection",yO={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class vO{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===Th?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,n,r,i,s){const o=cg(),a=this.zo(e,n.toUriEncodedString());te(Ap,`Sending RPC '${e}' ${o}:`,a,r);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,i,s);const{host:u}=new URL(a),p=Xa(u);return this.Jo(e,a,l,r,p).then(m=>(te(Ap,`Received RPC '${e}' ${o}: `,m),m),m=>{throw ds(Ap,`RPC '${e}' ${o} failed with error: `,m,"url: ",a,"request:",r),m})}Ho(e,n,r,i,s,o){return this.Go(e,n,r,i,s)}jo(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+tl}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((i,s)=>e[s]=i),r&&r.headers.forEach((i,s)=>e[s]=i)}zo(e,n){const r=yO[e];return`${this.Uo}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TO{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xt="WebChannelConnection";class EO extends vO{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,i,s){const o=cg();return new Promise((a,l)=>{const u=new F0;u.setWithCredentials(!0),u.listenOnce(U0.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case Sd.NO_ERROR:const m=u.getResponseJson();te(Xt,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(m)),a(m);break;case Sd.TIMEOUT:te(Xt,`RPC '${e}' ${o} timed out`),l(new ie(Q.DEADLINE_EXCEEDED,"Request time out"));break;case Sd.HTTP_ERROR:const g=u.getStatus();if(te(Xt,`RPC '${e}' ${o} failed with status:`,g,"response text:",u.getResponseText()),g>0){let v=u.getResponseJson();Array.isArray(v)&&(v=v[0]);const I=v==null?void 0:v.error;if(I&&I.status&&I.message){const P=function(C){const S=C.toLowerCase().replace(/_/g,"-");return Object.values(Q).indexOf(S)>=0?S:Q.UNKNOWN}(I.status);l(new ie(P,I.message))}else l(new ie(Q.UNKNOWN,"Server responded with status "+u.getStatus()))}else l(new ie(Q.UNAVAILABLE,"Connection failed."));break;default:de(9055,{l_:e,streamId:o,h_:u.getLastErrorCode(),P_:u.getLastError()})}}finally{te(Xt,`RPC '${e}' ${o} completed.`)}});const p=JSON.stringify(i);te(Xt,`RPC '${e}' ${o} sending request:`,i),u.send(n,"POST",p,r,15)})}T_(e,n,r){const i=cg(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=G0(),a=B0(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(l.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,n,r),l.encodeInitMessageHeaders=!0;const p=s.join("");te(Xt,`Creating RPC '${e}' stream ${i}: ${p}`,l);const m=o.createWebChannel(p,l);this.I_(m);let g=!1,v=!1;const I=new TO({Yo:V=>{v?te(Xt,`Not sending because RPC '${e}' stream ${i} is closed:`,V):(g||(te(Xt,`Opening RPC '${e}' stream ${i} transport.`),m.open(),g=!0),te(Xt,`RPC '${e}' stream ${i} sending:`,V),m.send(V))},Zo:()=>m.close()}),P=(V,C,S)=>{V.listen(C,A=>{try{S(A)}catch(L){setTimeout(()=>{throw L},0)}})};return P(m,Ol.EventType.OPEN,()=>{v||(te(Xt,`RPC '${e}' stream ${i} transport opened.`),I.o_())}),P(m,Ol.EventType.CLOSE,()=>{v||(v=!0,te(Xt,`RPC '${e}' stream ${i} transport closed`),I.a_(),this.E_(m))}),P(m,Ol.EventType.ERROR,V=>{v||(v=!0,ds(Xt,`RPC '${e}' stream ${i} transport errored. Name:`,V.name,"Message:",V.message),I.a_(new ie(Q.UNAVAILABLE,"The operation could not be completed")))}),P(m,Ol.EventType.MESSAGE,V=>{var C;if(!v){const S=V.data[0];pe(!!S,16349);const A=S,L=(A==null?void 0:A.error)||((C=A[0])==null?void 0:C.error);if(L){te(Xt,`RPC '${e}' stream ${i} received error:`,L);const q=L.status;let z=function(R){const N=St[R];if(N!==void 0)return qC(N)}(q),E=L.message;z===void 0&&(z=Q.INTERNAL,E="Unknown error status: "+q+" with message "+L.message),v=!0,I.a_(new ie(z,E)),m.close()}else te(Xt,`RPC '${e}' stream ${i} received:`,S),I.u_(S)}}),P(a,O0.STAT_EVENT,V=>{V.stat===qm.PROXY?te(Xt,`RPC '${e}' stream ${i} detected buffering proxy`):V.stat===qm.NOPROXY&&te(Xt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{I.__()},0),I}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(n=>n===e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wO(){return typeof window<"u"?window:null}function Md(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wf(t){return new I4(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EA{constructor(e,n,r=1e3,i=1.5,s=6e4){this.Mi=e,this.timerId=n,this.d_=r,this.A_=i,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,n-r);i>0&&te("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vw="PersistentStream";class wA{constructor(e,n,r,i,s,o,a,l){this.Mi=e,this.S_=r,this.b_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new EA(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===Q.RESOURCE_EXHAUSTED?(un(n.toString()),un("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===Q.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.D_===n&&this.G_(r,i)},r=>{e(()=>{const i=new ie(Q.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)})})}G_(e,n){const r=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(i=>{r(()=>this.z_(i))}),this.stream.onMessage(i=>{r(()=>++this.F_==1?this.J_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return te(Vw,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget(()=>this.D_===e?n():(te(Vw,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class IO extends wA{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=C4(this.serializer,e),r=function(s){if(!("targetChange"in s))return ge.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?ge.min():o.readTime?fn(o.readTime):ge.min()}(e);return this.listener.H_(n,r)}Y_(e){const n={};n.database=ig(this.serializer),n.addTarget=function(s,o){let a;const l=o.target;if(a=wh(l)?{documents:QC(s,l)}:{query:YC(s,l).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=jC(s,o.resumeToken);const u=ng(s,o.expectedCount);u!==null&&(a.expectedCount=u)}else if(o.snapshotVersion.compareTo(ge.min())>0){a.readTime=za(s,o.snapshotVersion.toTimestamp());const u=ng(s,o.expectedCount);u!==null&&(a.expectedCount=u)}return a}(this.serializer,e);const r=R4(this.serializer,e);r&&(n.labels=r),this.q_(n)}Z_(e){const n={};n.database=ig(this.serializer),n.removeTarget=e,this.q_(n)}}class SO extends wA{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return pe(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,pe(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){pe(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=A4(e.writeResults,e.commitTime),r=fn(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=ig(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>xh(this.serializer,r))};this.q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xO{}class CO extends xO{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new ie(Q.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Go(e,rg(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===Q.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new ie(Q.UNKNOWN,s.toString())})}Ho(e,n,r,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Ho(e,rg(n,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===Q.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new ie(Q.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class AO{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(un(n),this.aa=!1):te("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yo="RemoteStore";class RO{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo(o=>{r.enqueueAndForget(async()=>{Io(this)&&(te(yo,"Restarting streams for network reachability change."),await async function(l){const u=Te(l);u.Ea.add(4),await lc(u),u.Ra.set("Unknown"),u.Ea.delete(4),await If(u)}(this))})}),this.Ra=new AO(r,i)}}async function If(t){if(Io(t))for(const e of t.da)await e(!0)}async function lc(t){for(const e of t.da)await e(!1)}function IA(t,e){const n=Te(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),sy(n)?iy(n):rl(n).O_()&&ry(n,e))}function ny(t,e){const n=Te(t),r=rl(n);n.Ia.delete(e),r.O_()&&SA(n,e),n.Ia.size===0&&(r.O_()?r.L_():Io(n)&&n.Ra.set("Unknown"))}function ry(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ge.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}rl(t).Y_(e)}function SA(t,e){t.Va.Ue(e),rl(t).Z_(e)}function iy(t){t.Va=new v4({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),rl(t).start(),t.Ra.ua()}function sy(t){return Io(t)&&!rl(t).x_()&&t.Ia.size>0}function Io(t){return Te(t).Ea.size===0}function xA(t){t.Va=void 0}async function PO(t){t.Ra.set("Online")}async function kO(t){t.Ia.forEach((e,n)=>{ry(t,e)})}async function NO(t,e){xA(t),sy(t)?(t.Ra.ha(e),iy(t)):t.Ra.set("Unknown")}async function bO(t,e,n){if(t.Ra.set("Online"),e instanceof $C&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const a of s.targetIds)i.Ia.has(a)&&(await i.remoteSyncer.rejectListen(a,o),i.Ia.delete(a),i.Va.removeTarget(a))}(t,e)}catch(r){te(yo,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await kh(t,r)}else if(e instanceof bd?t.Va.Ze(e):e instanceof zC?t.Va.st(e):t.Va.tt(e),!n.isEqual(ge.min()))try{const r=await vA(t.localStore);n.compareTo(r)>=0&&await function(s,o){const a=s.Va.Tt(o);return a.targetChanges.forEach((l,u)=>{if(l.resumeToken.approximateByteSize()>0){const p=s.Ia.get(u);p&&s.Ia.set(u,p.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,u)=>{const p=s.Ia.get(l);if(!p)return;s.Ia.set(l,p.withResumeToken(It.EMPTY_BYTE_STRING,p.snapshotVersion)),SA(s,l);const m=new Zr(p.target,l,u,p.sequenceNumber);ry(s,m)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){te(yo,"Failed to raise snapshot:",r),await kh(t,r)}}async function kh(t,e,n){if(!Es(e))throw e;t.Ea.add(1),await lc(t),t.Ra.set("Offline"),n||(n=()=>vA(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{te(yo,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await If(t)})}function CA(t,e){return e().catch(n=>kh(t,n,e))}async function uc(t){const e=Te(t),n=ms(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:to;for(;DO(e);)try{const i=await pO(e.localStore,r);if(i===null){e.Ta.length===0&&n.L_();break}r=i.batchId,MO(e,i)}catch(i){await kh(e,i)}AA(e)&&RA(e)}function DO(t){return Io(t)&&t.Ta.length<10}function MO(t,e){t.Ta.push(e);const n=ms(t);n.O_()&&n.X_&&n.ea(e.mutations)}function AA(t){return Io(t)&&!ms(t).x_()&&t.Ta.length>0}function RA(t){ms(t).start()}async function VO(t){ms(t).ra()}async function LO(t){const e=ms(t);for(const n of t.Ta)e.ea(n.mutations)}async function FO(t,e,n){const r=t.Ta.shift(),i=j_.from(r,e,n);await CA(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await uc(t)}async function UO(t,e){e&&ms(t).X_&&await async function(r,i){if(function(o){return g4(o)&&o!==Q.ABORTED}(i.code)){const s=r.Ta.shift();ms(r).B_(),await CA(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await uc(r)}}(t,e),AA(t)&&RA(t)}async function Lw(t,e){const n=Te(t);n.asyncQueue.verifyOperationInProgress(),te(yo,"RemoteStore received new credentials");const r=Io(n);n.Ea.add(3),await lc(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await If(n)}async function OO(t,e){const n=Te(t);e?(n.Ea.delete(2),await If(n)):e||(n.Ea.add(2),await lc(n),n.Ra.set("Unknown"))}function rl(t){return t.ma||(t.ma=function(n,r,i){const s=Te(n);return s.sa(),new IO(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Xo:PO.bind(null,t),t_:kO.bind(null,t),r_:NO.bind(null,t),H_:bO.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),sy(t)?iy(t):t.Ra.set("Unknown")):(await t.ma.stop(),xA(t))})),t.ma}function ms(t){return t.fa||(t.fa=function(n,r,i){const s=Te(n);return s.sa(),new SO(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:VO.bind(null,t),r_:UO.bind(null,t),ta:LO.bind(null,t),na:FO.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await uc(t)):(await t.fa.stop(),t.Ta.length>0&&(te(yo,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oy{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Mr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const o=Date.now()+r,a=new oy(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ie(Q.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function ay(t,e){if(un("AsyncQueue",`${e}: ${t}`),Es(t))return new ie(Q.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ea{static emptySet(e){return new Ea(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||se.comparator(n.key,r.key):(n,r)=>se.comparator(n.key,r.key),this.keyedMap=Bl(),this.sortedSet=new ht(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Ea)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Ea;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fw{constructor(){this.ga=new ht(se.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):de(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,r)=>{e.push(r)}),e}}class $a{constructor(e,n,r,i,s,o,a,l,u){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,n,r,i,s){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new $a(e,n,Ea.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&pf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BO{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class GO{constructor(){this.queries=Uw(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const i=Te(n),s=i.queries;i.queries=Uw(),s.forEach((o,a)=>{for(const l of a.Sa)l.onError(r)})})(this,new ie(Q.ABORTED,"Firestore shutting down"))}}function Uw(){return new fi(t=>RC(t),pf)}async function ly(t,e){const n=Te(t);let r=3;const i=e.query;let s=n.queries.get(i);s?!s.ba()&&e.Da()&&(r=2):(s=new BO,r=e.Da()?0:1);try{switch(r){case 0:s.wa=await n.onListen(i,!0);break;case 1:s.wa=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(o){const a=ay(o,`Initialization of query '${jo(e.query)}' failed`);return void e.onError(a)}n.queries.set(i,s),s.Sa.push(e),e.va(n.onlineState),s.wa&&e.Fa(s.wa)&&cy(n)}async function uy(t,e){const n=Te(t),r=e.query;let i=3;const s=n.queries.get(r);if(s){const o=s.Sa.indexOf(e);o>=0&&(s.Sa.splice(o,1),s.Sa.length===0?i=e.Da()?0:1:!s.ba()&&e.Da()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function qO(t,e){const n=Te(t);let r=!1;for(const i of e){const s=i.query,o=n.queries.get(s);if(o){for(const a of o.Sa)a.Fa(i)&&(r=!0);o.wa=i}}r&&cy(n)}function zO(t,e,n){const r=Te(t),i=r.queries.get(e);if(i)for(const s of i.Sa)s.onError(n);r.queries.delete(e)}function cy(t){t.Ca.forEach(e=>{e.next()})}var dg,Ow;(Ow=dg||(dg={})).Ma="default",Ow.Cache="cache";class dy{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new $a(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=$a.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==dg.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PA{constructor(e){this.key=e}}class kA{constructor(e){this.key=e}}class $O{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Se(),this.mutatedKeys=Se(),this.eu=PC(e),this.tu=new Ea(this.eu)}get nu(){return this.Ya}ru(e,n){const r=n?n.iu:new Fw,i=n?n.tu:this.tu;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((p,m)=>{const g=i.get(p),v=oc(this.query,m)?m:null,I=!!g&&this.mutatedKeys.has(g.key),P=!!v&&(v.hasLocalMutations||this.mutatedKeys.has(v.key)&&v.hasCommittedMutations);let V=!1;g&&v?g.data.isEqual(v.data)?I!==P&&(r.track({type:3,doc:v}),V=!0):this.su(g,v)||(r.track({type:2,doc:v}),V=!0,(l&&this.eu(v,l)>0||u&&this.eu(v,u)<0)&&(a=!0)):!g&&v?(r.track({type:0,doc:v}),V=!0):g&&!v&&(r.track({type:1,doc:g}),V=!0,(l||u)&&(a=!0)),V&&(v?(o=o.add(v),s=P?s.add(p):s.delete(p)):(o=o.delete(p),s=s.delete(p)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const p=this.query.limitType==="F"?o.last():o.first();o=o.delete(p.key),s=s.delete(p.key),r.track({type:1,doc:p})}return{tu:o,iu:r,Cs:a,mutatedKeys:s}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((p,m)=>function(v,I){const P=V=>{switch(V){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return de(20277,{Rt:V})}};return P(v)-P(I)}(p.type,m.type)||this.eu(p.doc,m.doc)),this.ou(r),i=i??!1;const a=n&&!i?this._u():[],l=this.Xa.size===0&&this.current&&!i?1:0,u=l!==this.Za;return this.Za=l,o.length!==0||u?{snapshot:new $a(this.query,e.tu,s,o,e.mutatedKeys,l===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Fw,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Ya=this.Ya.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ya=this.Ya.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Se(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))});const n=[];return e.forEach(r=>{this.Xa.has(r)||n.push(new kA(r))}),this.Xa.forEach(r=>{e.has(r)||n.push(new PA(r))}),n}cu(e){this.Ya=e.Qs,this.Xa=Se();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return $a.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const hy="SyncEngine";class jO{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class HO{constructor(e){this.key=e,this.hu=!1}}class WO{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new fi(a=>RC(a),pf),this.Iu=new Map,this.Eu=new Set,this.du=new ht(se.comparator),this.Au=new Map,this.Ru=new Y_,this.Vu={},this.mu=new Map,this.fu=_o.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function KO(t,e,n=!0){const r=LA(t);let i;const s=r.Tu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await NA(r,e,n,!0),i}async function JO(t,e){const n=LA(t);await NA(n,e,!0,!1)}async function NA(t,e,n,r){const i=await mO(t.localStore,Yn(e)),s=i.targetId,o=t.sharedClientState.addLocalQueryTarget(s,n);let a;return r&&(a=await QO(t,e,s,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&IA(t.remoteStore,i),a}async function QO(t,e,n,r,i){t.pu=(m,g,v)=>async function(P,V,C,S){let A=V.view.ru(C);A.Cs&&(A=await Nw(P.localStore,V.query,!1).then(({documents:E})=>V.view.ru(E,A)));const L=S&&S.targetChanges.get(V.targetId),q=S&&S.targetMismatches.get(V.targetId)!=null,z=V.view.applyChanges(A,P.isPrimaryClient,L,q);return Gw(P,V.targetId,z.au),z.snapshot}(t,m,g,v);const s=await Nw(t.localStore,e,!0),o=new $O(e,s.Qs),a=o.ru(s.documents),l=ac.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),u=o.applyChanges(a,t.isPrimaryClient,l);Gw(t,n,u.au);const p=new jO(e,n,o);return t.Tu.set(e,p),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),u.snapshot}async function YO(t,e,n){const r=Te(t),i=r.Tu.get(e),s=r.Iu.get(i.targetId);if(s.length>1)return r.Iu.set(i.targetId,s.filter(o=>!pf(o,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await ug(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&ny(r.remoteStore,i.targetId),hg(r,i.targetId)}).catch(wo)):(hg(r,i.targetId),await ug(r.localStore,i.targetId,!0))}async function XO(t,e){const n=Te(t),r=n.Tu.get(e),i=n.Iu.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),ny(n.remoteStore,r.targetId))}async function ZO(t,e,n){const r=FA(t);try{const i=await function(o,a){const l=Te(o),u=$e.now(),p=a.reduce((v,I)=>v.add(I.key),Se());let m,g;return l.persistence.runTransaction("Locally write mutations","readwrite",v=>{let I=Nn(),P=Se();return l.Ns.getEntries(v,p).next(V=>{I=V,I.forEach((C,S)=>{S.isValidDocument()||(P=P.add(C))})}).next(()=>l.localDocuments.getOverlayedDocuments(v,I)).next(V=>{m=V;const C=[];for(const S of a){const A=p4(S,m.get(S.key).overlayedDocument);A!=null&&C.push(new pi(S.key,A,vC(A.value.mapValue),cn.exists(!0)))}return l.mutationQueue.addMutationBatch(v,u,C,a)}).next(V=>{g=V;const C=V.applyToLocalDocumentSet(m,P);return l.documentOverlayCache.saveOverlays(v,V.batchId,C)})}).then(()=>({batchId:g.batchId,changes:NC(m)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,l){let u=o.Vu[o.currentUser.toKey()];u||(u=new ht(ve)),u=u.insert(a,l),o.Vu[o.currentUser.toKey()]=u}(r,i.batchId,n),await cc(r,i.changes),await uc(r.remoteStore)}catch(i){const s=ay(i,"Failed to persist write");n.reject(s)}}async function bA(t,e){const n=Te(t);try{const r=await hO(n.localStore,e);e.targetChanges.forEach((i,s)=>{const o=n.Au.get(s);o&&(pe(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.hu=!0:i.modifiedDocuments.size>0?pe(o.hu,14607):i.removedDocuments.size>0&&(pe(o.hu,42227),o.hu=!1))}),await cc(n,r,e)}catch(r){await wo(r)}}function Bw(t,e,n){const r=Te(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Tu.forEach((s,o)=>{const a=o.view.va(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){const l=Te(o);l.onlineState=a;let u=!1;l.queries.forEach((p,m)=>{for(const g of m.Sa)g.va(a)&&(u=!0)}),u&&cy(l)}(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function e6(t,e,n){const r=Te(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Au.get(e),s=i&&i.key;if(s){let o=new ht(se.comparator);o=o.insert(s,Tt.newNoDocument(s,ge.min()));const a=Se().add(s),l=new yf(ge.min(),new Map,new ht(ve),o,a);await bA(r,l),r.du=r.du.remove(s),r.Au.delete(e),fy(r)}else await ug(r.localStore,e,!1).then(()=>hg(r,e,n)).catch(wo)}async function t6(t,e){const n=Te(t),r=e.batch.batchId;try{const i=await dO(n.localStore,e);MA(n,r,null),DA(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await cc(n,i)}catch(i){await wo(i)}}async function n6(t,e,n){const r=Te(t);try{const i=await function(o,a){const l=Te(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let p;return l.mutationQueue.lookupMutationBatch(u,a).next(m=>(pe(m!==null,37113),p=m.keys(),l.mutationQueue.removeMutationBatch(u,m))).next(()=>l.mutationQueue.performConsistencyCheck(u)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(u,p,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,p)).next(()=>l.localDocuments.getDocuments(u,p))})}(r.localStore,e);MA(r,e,n),DA(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await cc(r,i)}catch(i){await wo(i)}}function DA(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function MA(t,e,n){const r=Te(t);let i=r.Vu[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Vu[r.currentUser.toKey()]=i}}function hg(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(r=>{t.Ru.containsKey(r)||VA(t,r)})}function VA(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(ny(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),fy(t))}function Gw(t,e,n){for(const r of n)r instanceof PA?(t.Ru.addReference(r.key,e),r6(t,r)):r instanceof kA?(te(hy,"Document no longer in limbo: "+r.key),t.Ru.removeReference(r.key,e),t.Ru.containsKey(r.key)||VA(t,r.key)):de(19791,{wu:r})}function r6(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Eu.has(r)||(te(hy,"New document in limbo: "+n),t.Eu.add(r),fy(t))}function fy(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new se(ze.fromString(e)),r=t.fu.next();t.Au.set(r,new HO(n)),t.du=t.du.insert(n,r),IA(t.remoteStore,new Zr(Yn(sc(n.path)),r,"TargetPurposeLimboResolution",Kn.ce))}}async function cc(t,e,n){const r=Te(t),i=[],s=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((a,l)=>{o.push(r.pu(l,e,n).then(u=>{var p;if((u||n)&&r.isPrimaryClient){const m=u?!u.fromCache:(p=n==null?void 0:n.targetChanges.get(l.targetId))==null?void 0:p.current;r.sharedClientState.updateQueryState(l.targetId,m?"current":"not-current")}if(u){i.push(u);const m=ey.As(l.targetId,u);s.push(m)}}))}),await Promise.all(o),r.Pu.H_(i),await async function(l,u){const p=Te(l);try{await p.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>j.forEach(u,g=>j.forEach(g.Es,v=>p.persistence.referenceDelegate.addReference(m,g.targetId,v)).next(()=>j.forEach(g.ds,v=>p.persistence.referenceDelegate.removeReference(m,g.targetId,v)))))}catch(m){if(!Es(m))throw m;te(ty,"Failed to update sequence numbers: "+m)}for(const m of u){const g=m.targetId;if(!m.fromCache){const v=p.Ms.get(g),I=v.snapshotVersion,P=v.withLastLimboFreeSnapshotVersion(I);p.Ms=p.Ms.insert(g,P)}}}(r.localStore,s))}async function i6(t,e){const n=Te(t);if(!n.currentUser.isEqual(e)){te(hy,"User change. New user:",e.toKey());const r=await yA(n.localStore,e);n.currentUser=e,function(s,o){s.mu.forEach(a=>{a.forEach(l=>{l.reject(new ie(Q.CANCELLED,o))})}),s.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await cc(n,r.Ls)}}function s6(t,e){const n=Te(t),r=n.Au.get(e);if(r&&r.hu)return Se().add(r.key);{let i=Se();const s=n.Iu.get(e);if(!s)return i;for(const o of s){const a=n.Tu.get(o);i=i.unionWith(a.view.nu)}return i}}function LA(t){const e=Te(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=bA.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=s6.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=e6.bind(null,e),e.Pu.H_=qO.bind(null,e.eventManager),e.Pu.yu=zO.bind(null,e.eventManager),e}function FA(t){const e=Te(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=t6.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=n6.bind(null,e),e}class zu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=wf(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return _A(this.persistence,new gA,e.initialUser,this.serializer)}Cu(e){return new X_(Ef.mi,this.serializer)}Du(e){return new TA}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}zu.provider={build:()=>new zu};class o6 extends zu{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){pe(this.persistence.referenceDelegate instanceof Ph,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new dA(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?Zt.withCacheSize(this.cacheSizeBytes):Zt.DEFAULT;return new X_(r=>Ph.mi(r,n),this.serializer)}}class a6 extends zu{constructor(e,n,r){super(),this.xu=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await FA(this.xu.syncEngine),await uc(this.xu.remoteStore),await this.persistence.Ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}vu(e){return _A(this.persistence,new gA,e.initialUser,this.serializer)}Fu(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new dA(r,e.asyncQueue,n)}Mu(e,n){const r=new fU(n,this.persistence);return new hU(e.asyncQueue,r)}Cu(e){const n=aO(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Zt.withCacheSize(this.cacheSizeBytes):Zt.DEFAULT;return new Z_(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,wO(),Md(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new TA}}class Nh{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Bw(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=i6.bind(null,this.syncEngine),await OO(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new GO}()}createDatastore(e){const n=wf(e.databaseInfo.databaseId),r=function(s){return new EO(s)}(e.databaseInfo);return function(s,o,a,l){return new CO(s,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,a){return new RO(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>Bw(this.syncEngine,n,0),function(){return Mw.v()?new Mw:new _O}())}createSyncEngine(e,n){return function(i,s,o,a,l,u,p){const m=new WO(i,s,o,a,l,u);return p&&(m.gu=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(i){const s=Te(i);te(yo,"RemoteStore shutting down."),s.Ea.add(5),await lc(s),s.Aa.shutdown(),s.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}Nh.provider={build:()=>new Nh};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class py{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):un("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gs="FirestoreClient";class l6{constructor(e,n,r,i,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=jt.UNAUTHENTICATED,this.clientId=sf.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{te(gs,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(te(gs,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Mr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=ay(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Rp(t,e){t.asyncQueue.verifyOperationInProgress(),te(gs,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await yA(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function qw(t,e){t.asyncQueue.verifyOperationInProgress();const n=await u6(t);te(gs,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>Lw(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>Lw(e.remoteStore,i)),t._onlineComponents=e}async function u6(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){te(gs,"Using user provided OfflineComponentProvider");try{await Rp(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(i){return i.name==="FirebaseError"?i.code===Q.FAILED_PRECONDITION||i.code===Q.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;ds("Error using user provided cache. Falling back to memory cache: "+n),await Rp(t,new zu)}}else te(gs,"Using default OfflineComponentProvider"),await Rp(t,new o6(void 0));return t._offlineComponents}async function UA(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(te(gs,"Using user provided OnlineComponentProvider"),await qw(t,t._uninitializedComponentsProvider._online)):(te(gs,"Using default OnlineComponentProvider"),await qw(t,new Nh))),t._onlineComponents}function c6(t){return UA(t).then(e=>e.syncEngine)}async function bh(t){const e=await UA(t),n=e.eventManager;return n.onListen=KO.bind(null,e.syncEngine),n.onUnlisten=YO.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=JO.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=XO.bind(null,e.syncEngine),n}function d6(t,e,n={}){const r=new Mr;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,u){const p=new py({next:g=>{p.Nu(),o.enqueueAndForget(()=>uy(s,m));const v=g.docs.has(a);!v&&g.fromCache?u.reject(new ie(Q.UNAVAILABLE,"Failed to get document because the client is offline.")):v&&g.fromCache&&l&&l.source==="server"?u.reject(new ie(Q.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(g)},error:g=>u.reject(g)}),m=new dy(sc(a.path),p,{includeMetadataChanges:!0,qa:!0});return ly(s,m)}(await bh(t),t.asyncQueue,e,n,r)),r.promise}function h6(t,e,n={}){const r=new Mr;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,u){const p=new py({next:g=>{p.Nu(),o.enqueueAndForget(()=>uy(s,m)),g.fromCache&&l.source==="server"?u.reject(new ie(Q.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(g)},error:g=>u.reject(g)}),m=new dy(a,p,{includeMetadataChanges:!0,qa:!0});return ly(s,m)}(await bh(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OA(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zw=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BA="firestore.googleapis.com",$w=!0;class jw{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new ie(Q.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=BA,this.ssl=$w}else this.host=e.host,this.ssl=e.ssl??$w;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=aA;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<$4)throw new ie(Q.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}K0("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=OA(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new ie(Q.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new ie(Q.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new ie(Q.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Sf{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new jw({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ie(Q.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ie(Q.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new jw(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new j0;switch(r.type){case"firstParty":return new rU(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new ie(Q.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=zw.get(n);r&&(te("ComponentProvider","Removing Datastore"),zw.delete(n),r.terminate())}(this),Promise.resolve()}}function GA(t,e,n,r={}){var u;t=hn(t,Sf);const i=Xa(e),s=t._getSettings(),o={...s,emulatorOptions:t._getEmulatorOptions()},a=`${e}:${n}`;i&&(Wx(`https://${a}`),Kx("Firestore",!0)),s.host!==BA&&s.host!==a&&ds("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...s,host:a,ssl:i,emulatorOptions:r};if(!co(l,o)&&(t._setSettings(l),r.mockUserToken)){let p,m;if(typeof r.mockUserToken=="string")p=r.mockUserToken,m=jt.MOCK_USER;else{p=R2(r.mockUserToken,(u=t._app)==null?void 0:u.options.projectId);const g=r.mockUserToken.sub||r.mockUserToken.user_id;if(!g)throw new ie(Q.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");m=new jt(g)}t._authCredentials=new eU(new $0(p,m))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Is{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Is(this.firestore,e,this._query)}}class pt{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ti(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new pt(this.firestore,e,this._key)}toJSON(){return{type:pt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(tc(n,pt._jsonSchema))return new pt(e,r||null,new se(ze.fromString(n.referencePath)))}}pt._jsonSchemaVersion="firestore/documentReference/1.0",pt._jsonSchema={type:Ct("string",pt._jsonSchemaVersion),referencePath:Ct("string")};class ti extends Is{constructor(e,n,r){super(e,n,sc(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new pt(this.firestore,null,new se(e))}withConverter(e){return new ti(this.firestore,e,this._path)}}function lt(t,e,...n){if(t=Nt(t),W0("collection","path",e),t instanceof Sf){const r=ze.fromString(e,...n);return VE(r),new ti(t,null,r)}{if(!(t instanceof pt||t instanceof ti))throw new ie(Q.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ze.fromString(e,...n));return VE(r),new ti(t.firestore,null,r)}}function be(t,e,...n){if(t=Nt(t),arguments.length===1&&(e=sf.newId()),W0("doc","path",e),t instanceof Sf){const r=ze.fromString(e,...n);return ME(r),new pt(t,null,new se(r))}{if(!(t instanceof pt||t instanceof ti))throw new ie(Q.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ze.fromString(e,...n));return ME(r),new pt(t.firestore,t instanceof ti?t.converter:null,new se(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hw="AsyncQueue";class Ww{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new EA(this,"async_queue_retry"),this._c=()=>{const r=Md();r&&te(Hw,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=Md();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=Md();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new Mr;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Es(e))throw e;te(Hw,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,un("INTERNAL UNHANDLED ERROR: ",Kw(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const i=oy.createAndSchedule(this,e,n,r,s=>this.hc(s));return this.tc.push(i),i}uc(){this.nc&&de(47125,{Pc:Kw(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function Kw(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jw(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const i=n;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}class Fr extends Sf{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new Ww,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Ww(e),this._firestoreClient=void 0,await e}}}function qA(t,e){const n=typeof t=="object"?t:n0(),r=typeof t=="string"?t:Th,i=E_(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=C2("firestore");s&&GA(i,...s)}return i}function dc(t){if(t._terminated)throw new ie(Q.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||zA(t),t._firestoreClient}function zA(t){var r,i,s;const e=t._freezeSettings(),n=function(a,l,u,p){return new qU(a,l,u,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,OA(p.experimentalLongPollingOptions),p.useFetchStreams,p.isUsingEmulator)}(t._databaseId,((r=t._app)==null?void 0:r.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(i=e.localCache)!=null&&i._offlineComponentProvider&&((s=e.localCache)!=null&&s._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new l6(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(t._componentsProvider))}function $A(t,e){ds("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings();return f6(t,Nh.provider,{build:r=>new a6(r,n.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}function f6(t,e,n){if((t=hn(t,Fr))._firestoreClient||t._terminated)throw new ie(Q.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new ie(Q.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:n},zA(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Pn(It.fromBase64String(e))}catch(n){throw new ie(Q.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Pn(It.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Pn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(tc(e,Pn._jsonSchema))return Pn.fromBase64String(e.bytes)}}Pn._jsonSchemaVersion="firestore/bytes/1.0",Pn._jsonSchema={type:Ct("string",Pn._jsonSchemaVersion),bytes:Ct("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hc{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new ie(Q.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new dt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fc{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gr{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new ie(Q.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new ie(Q.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return ve(this._lat,e._lat)||ve(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:gr._jsonSchemaVersion}}static fromJSON(e){if(tc(e,gr._jsonSchema))return new gr(e.latitude,e.longitude)}}gr._jsonSchemaVersion="firestore/geoPoint/1.0",gr._jsonSchema={type:Ct("string",gr._jsonSchemaVersion),latitude:Ct("number"),longitude:Ct("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _r{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}toJSON(){return{type:_r._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(tc(e,_r._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new _r(e.vectorValues);throw new ie(Q.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}_r._jsonSchemaVersion="firestore/vectorValue/1.0",_r._jsonSchema={type:Ct("string",_r._jsonSchemaVersion),vectorValues:Ct("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p6=/^__.*__$/;class m6{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new pi(e,this.data,this.fieldMask,n,this.fieldTransforms):new nl(e,this.data,n,this.fieldTransforms)}}class jA{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new pi(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function HA(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw de(40011,{Ac:t})}}class my{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new my({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var i;const n=(i=this.path)==null?void 0:i.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){var i;const n=(i=this.path)==null?void 0:i.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Dh(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(HA(this.Ac)&&p6.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class g6{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||wf(e)}Cc(e,n,r,i=!1){return new my({Ac:e,methodName:n,Dc:r,path:dt.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function gy(t){const e=t._freezeSettings(),n=wf(t._databaseId);return new g6(t._databaseId,!!e.ignoreUndefinedProperties,n)}function _6(t,e,n,r,i,s={}){const o=t.Cc(s.merge||s.mergeFields?2:0,e,n,i);yy("Data must be an object, but it was:",o,r);const a=WA(r,o);let l,u;if(s.merge)l=new vn(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const p=[];for(const m of s.mergeFields){const g=fg(e,m,n);if(!o.contains(g))throw new ie(Q.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);JA(p,g)||p.push(g)}l=new vn(p),u=o.fieldTransforms.filter(m=>l.covers(m.field))}else l=null,u=o.fieldTransforms;return new m6(new tn(a),l,u)}class xf extends fc{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof xf}}class _y extends fc{_toFieldTransform(e){return new UC(e.path,new Ba)}isEqual(e){return e instanceof _y}}function y6(t,e,n,r){const i=t.Cc(1,e,n);yy("Data must be an object, but it was:",i,r);const s=[],o=tn.empty();ws(r,(l,u)=>{const p=vy(e,l,n);u=Nt(u);const m=i.yc(p);if(u instanceof xf)s.push(p);else{const g=pc(u,m);g!=null&&(s.push(p),o.set(p,g))}});const a=new vn(s);return new jA(o,a,i.fieldTransforms)}function v6(t,e,n,r,i,s){const o=t.Cc(1,e,n),a=[fg(e,r,n)],l=[i];if(s.length%2!=0)throw new ie(Q.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<s.length;g+=2)a.push(fg(e,s[g])),l.push(s[g+1]);const u=[],p=tn.empty();for(let g=a.length-1;g>=0;--g)if(!JA(u,a[g])){const v=a[g];let I=l[g];I=Nt(I);const P=o.yc(v);if(I instanceof xf)u.push(v);else{const V=pc(I,P);V!=null&&(u.push(v),p.set(v,V))}}const m=new vn(u);return new jA(p,m,o.fieldTransforms)}function T6(t,e,n,r=!1){return pc(n,t.Cc(r?4:3,e))}function pc(t,e){if(KA(t=Nt(t)))return yy("Unsupported field value:",e,t),WA(t,e);if(t instanceof fc)return function(r,i){if(!HA(i.Ac))throw i.Sc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const a of r){let l=pc(a,i.wc(o));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=Nt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return l4(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=$e.fromDate(r);return{timestampValue:za(i.serializer,s)}}if(r instanceof $e){const s=new $e(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:za(i.serializer,s)}}if(r instanceof gr)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Pn)return{bytesValue:jC(i.serializer,r._byteString)};if(r instanceof pt){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:K_(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof _r)return function(o,a){return{mapValue:{fields:{[B_]:{stringValue:G_},[La]:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw a.Sc("VectorValues must only contain numeric values.");return z_(a.serializer,u)})}}}}}}(r,i);throw i.Sc(`Unsupported field value: ${of(r)}`)}(t,e)}function WA(t,e){const n={};return cC(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ws(t,(r,i)=>{const s=pc(i,e.mc(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function KA(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof $e||t instanceof gr||t instanceof Pn||t instanceof pt||t instanceof fc||t instanceof _r)}function yy(t,e,n){if(!KA(n)||!J0(n)){const r=of(n);throw r==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+r)}}function fg(t,e,n){if((e=Nt(e))instanceof hc)return e._internalPath;if(typeof e=="string")return vy(t,e);throw Dh("Field path arguments must be of type string or ",t,!1,void 0,n)}const E6=new RegExp("[~\\*/\\[\\]]");function vy(t,e,n){if(e.search(E6)>=0)throw Dh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new hc(...e.split("."))._internalPath}catch{throw Dh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Dh(t,e,n,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new ie(Q.INVALID_ARGUMENT,a+t+l)}function JA(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QA{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new pt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new w6(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Ty("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class w6 extends QA{data(){return super.data()}}function Ty(t,e){return typeof e=="string"?vy(t,e):e instanceof hc?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YA(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new ie(Q.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Ey{}class XA extends Ey{}function zl(t,e,...n){let r=[];e instanceof Ey&&r.push(e),r=r.concat(n),function(s){const o=s.filter(l=>l instanceof Cf).length,a=s.filter(l=>l instanceof mc).length;if(o>1||o>0&&a>0)throw new ie(Q.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class mc extends XA{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new mc(e,n,r)}_apply(e){const n=this._parse(e);return ZA(e._query,n),new Is(e.firestore,e.converter,eg(e._query,n))}_parse(e){const n=gy(e.firestore);return function(s,o,a,l,u,p,m){let g;if(u.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new ie(Q.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){Yw(m,p);const I=[];for(const P of m)I.push(Qw(l,s,P));g={arrayValue:{values:I}}}else g=Qw(l,s,m)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||Yw(m,p),g=T6(a,o,m,p==="in"||p==="not-in");return Me.create(u,p,g)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function $l(t,e,n){const r=e,i=Ty("where",t);return mc._create(i,r,n)}class Cf extends Ey{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Cf(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:He.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i;const a=s.getFlattenedFilters();for(const l of a)ZA(o,l),o=eg(o,l)}(e._query,n),new Is(e.firestore,e.converter,eg(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function Qw(t,e,n){if(typeof(n=Nt(n))=="string"){if(n==="")throw new ie(Q.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!AC(e)&&n.indexOf("/")!==-1)throw new ie(Q.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(ze.fromString(n));if(!se.isDocumentKey(r))throw new ie(Q.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Bu(t,new se(r))}if(n instanceof pt)return Bu(t,n._key);throw new ie(Q.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${of(n)}.`)}function Yw(t,e){if(!Array.isArray(t)||t.length===0)throw new ie(Q.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function ZA(t,e){const n=function(i,s){for(const o of i)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new ie(Q.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ie(Q.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class eR{convertValue(e,n="none"){switch(fs(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ut(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(ui(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw de(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return ws(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertVectorValue(e){var r,i,s;const n=(s=(i=(r=e.fields)==null?void 0:r[La].arrayValue)==null?void 0:i.values)==null?void 0:s.map(o=>ut(o.doubleValue));return new _r(n)}convertGeoPoint(e){return new gr(ut(e.latitude),ut(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=hf(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Uu(e));default:return null}}convertTimestamp(e){const n=li(e);return new $e(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=ze.fromString(e);pe(tA(r),9688,{name:e});const i=new hs(r.get(1),r.get(3)),s=new se(r.popFirst(5));return i.isEqual(n)||un(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I6(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class la{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class os extends QA{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new du(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Ty("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ie(Q.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=os._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}os._jsonSchemaVersion="firestore/documentSnapshot/1.0",os._jsonSchema={type:Ct("string",os._jsonSchemaVersion),bundleSource:Ct("string","DocumentSnapshot"),bundleName:Ct("string"),bundle:Ct("string")};class du extends os{data(e={}){return super.data(e)}}class as{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new la(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new du(this._firestore,this._userDataWriter,r.key,r,new la(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new ie(Q.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{const l=new du(i._firestore,i._userDataWriter,a.doc.key,a.doc,new la(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{const l=new du(i._firestore,i._userDataWriter,a.doc.key,a.doc,new la(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let u=-1,p=-1;return a.type!==0&&(u=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),p=o.indexOf(a.doc.key)),{type:S6(a.type),doc:l,oldIndex:u,newIndex:p}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ie(Q.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=as._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=sf.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],i=[];return this.docs.forEach(s=>{s._document!==null&&(n.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function S6(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return de(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pg(t){t=hn(t,pt);const e=hn(t.firestore,Fr);return d6(dc(e),t._key).then(n=>tR(e,t,n))}as._jsonSchemaVersion="firestore/querySnapshot/1.0",as._jsonSchema={type:Ct("string",as._jsonSchemaVersion),bundleSource:Ct("string","QuerySnapshot"),bundleName:Ct("string"),bundle:Ct("string")};class wy extends eR{constructor(e){super(),this.firestore=e}convertBytes(e){return new Pn(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new pt(this.firestore,null,n)}}function Vi(t){t=hn(t,Is);const e=hn(t.firestore,Fr),n=dc(e),r=new wy(e);return YA(t._query),h6(n,t._query).then(i=>new as(e,r,t,i))}function yt(t,e,n){t=hn(t,pt);const r=hn(t.firestore,Fr),i=I6(t.converter,e,n);return Af(r,[_6(gy(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,cn.none())])}function mg(t,e,n,...r){t=hn(t,pt);const i=hn(t.firestore,Fr),s=gy(i);let o;return o=typeof(e=Nt(e))=="string"||e instanceof hc?v6(s,"updateDoc",t._key,e,n,r):y6(s,"updateDoc",t._key,e),Af(i,[o.toMutation(t._key,cn.exists(!0))])}function zt(t){return Af(hn(t.firestore,Fr),[new _f(t._key,cn.none())])}function xr(t,...e){var l,u,p;t=Nt(t);let n={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||Jw(e[r])||(n=e[r++]);const i={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(Jw(e[r])){const m=e[r];e[r]=(l=m.next)==null?void 0:l.bind(m),e[r+1]=(u=m.error)==null?void 0:u.bind(m),e[r+2]=(p=m.complete)==null?void 0:p.bind(m)}let s,o,a;if(t instanceof pt)o=hn(t.firestore,Fr),a=sc(t._key.path),s={next:m=>{e[r]&&e[r](tR(o,t,m))},error:e[r+1],complete:e[r+2]};else{const m=hn(t,Is);o=hn(m.firestore,Fr),a=m._query;const g=new wy(o);s={next:v=>{e[r]&&e[r](new as(o,g,m,v))},error:e[r+1],complete:e[r+2]},YA(t._query)}return function(g,v,I,P){const V=new py(P),C=new dy(v,V,I);return g.asyncQueue.enqueueAndForget(async()=>ly(await bh(g),C)),()=>{V.Nu(),g.asyncQueue.enqueueAndForget(async()=>uy(await bh(g),C))}}(dc(o),a,i,s)}function Af(t,e){return function(r,i){const s=new Mr;return r.asyncQueue.enqueueAndForget(async()=>ZO(await c6(r),i,s)),s.promise}(dc(t),e)}function tR(t,e,n){const r=n.docs.get(e._key),i=new wy(t);return new os(t,i,e._key,r,new la(n.hasPendingWrites,n.fromCache),e.converter)}function x6(){return new _y("serverTimestamp")}(function(e,n=!0){(function(i){tl=i})(Za),Pa(new ho("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),a=new Fr(new tU(r.getProvider("auth-internal")),new iU(o,r.getProvider("app-check-internal")),function(u,p){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new ie(Q.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new hs(u.options.projectId,p)}(o,i),o);return s={useFetchStreams:n,...s},a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),rs(kE,NE,e),rs(kE,NE,"esm2020")})();const Mi=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:eR,Bytes:Pn,CollectionReference:ti,DocumentReference:pt,DocumentSnapshot:os,FieldPath:hc,FieldValue:fc,Firestore:Fr,FirestoreError:ie,GeoPoint:gr,Query:Is,QueryCompositeFilterConstraint:Cf,QueryConstraint:XA,QueryDocumentSnapshot:du,QueryFieldFilterConstraint:mc,QuerySnapshot:as,SnapshotMetadata:la,Timestamp:$e,VectorValue:_r,_AutoId:sf,_ByteString:It,_DatabaseId:hs,_DocumentKey:se,_EmptyAuthCredentialsProvider:j0,_FieldPath:dt,_cast:hn,_logWarn:ds,_validateIsNotUsedTogether:K0,collection:lt,connectFirestoreEmulator:GA,deleteDoc:zt,doc:be,enableIndexedDbPersistence:$A,ensureFirestoreConfigured:dc,executeWrite:Af,getDoc:pg,getDocs:Vi,getFirestore:qA,onSnapshot:xr,query:zl,serverTimestamp:x6,setDoc:yt,setLogLevel:q0,updateDoc:mg,where:$l},Symbol.toStringTag,{value:"Module"}));q0("error");const C6={apiKey:"AIzaSyC1zhlBnbOxP_PCaHU6L-UsDOBRTjGgpfk",authDomain:"my-apss-da774.firebaseapp.com",projectId:"my-apss-da774",storageBucket:"my-apss-da774.firebasestorage.app",messagingSenderId:"528434940137",appId:"1:528434940137:web:56be66185a46f390b60878",measurementId:"G-WPGZGF4ZBG"},nR=t0(C6),qs=XF(nR);OL(qs,C0).catch(t=>console.error("Persistence error:",t));const ja=new Kr;ja.addScope("profile");ja.addScope("email");ja.setCustomParameters({prompt:"select_account",access_type:"offline"});if(typeof window<"u"){const t=navigator.userAgent.toLowerCase();t.includes("safari")&&!t.includes("chrome")&&!t.includes("firefox")&&ja.setCustomParameters({prompt:"consent"})}const ue=qA(nR);$A(ue).catch(t=>{t.code==="failed-precondition"?console.warn("Firestore: Multiple tabs open, persistence disabled"):t.code==="unimplemented"&&console.warn("Firestore: Browser does not support persistence")});const st=t=>{if(t==null)return;if(typeof t!="object")return t;if(Array.isArray(t)){const r=t.filter(i=>i!==void 0).map(i=>st(i)).filter(i=>i!==void 0);return r.length>0?r:void 0}let e;try{e=Object.entries(t)}catch(r){console.error("sanitizeFirestoreData: failed to enumerate object",r,t);return}const n={};for(const[r,i]of e)if(!(i===void 0||typeof i=="string"&&i.trim()===""))if(typeof i=="object"&&i!==null){const s=st(i);s!==void 0&&(n[r]=s)}else n[r]=i;return Object.keys(n).length>0?n:void 0},A6=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Mobile|Tablet/i,Pp=()=>{const t=A6.test(navigator.userAgent),e=navigator.maxTouchPoints&&navigator.maxTouchPoints>2,n=window.innerWidth<=768;return t||e&&n},Xw=()=>window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0,kp=()=>window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",R6=({onClose:t})=>{const[e,n]=G.useState(null),[r,i]=G.useState(!1),[s,o]=G.useState(!1);G.useEffect(()=>{const l=/iPad|iPhone|iPod/.test(navigator.userAgent),p=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Mobile|Tablet/i.test(navigator.userAgent);i(l),o(p);const m=g=>{g.preventDefault(),n(g)};return window.addEventListener("beforeinstallprompt",m),()=>{window.removeEventListener("beforeinstallprompt",m)}},[]);const a=async()=>{if(e){e.prompt();const{outcome:l}=await e.userChoice;l==="accepted"&&(n(null),t())}};return s?h.jsx("div",{className:"pwa-fullscreen-prompt",children:h.jsxs("div",{className:"pwa-fullscreen-content",children:[h.jsxs("div",{className:"pwa-fullscreen-header",children:[h.jsx("div",{className:"w-20 h-20 bg-indigo-600 rounded-lg mx-auto mb-6 flex items-center justify-center",children:h.jsx("span",{className:"text-white text-4xl font-bold",children:"N"})}),h.jsx("h2",{className:"text-3xl font-bold text-white mb-3",children:"Nova  "}),h.jsx("p",{className:"text-lg text-gray-200 mb-4",children:"     "})]}),h.jsx("div",{className:"pwa-fullscreen-body",children:r?h.jsxs("div",{children:[h.jsx("div",{className:"pwa-instruction-box mb-6",children:h.jsx("p",{className:"text-white font-semibold mb-4",children:"iOS  :"})}),h.jsxs("ol",{className:"pwa-instruction-steps",children:[h.jsxs("li",{className:"pwa-instruction-step",children:[h.jsx("div",{className:"step-number",children:"1"}),h.jsxs("div",{className:"step-content",children:[h.jsx("p",{className:"font-semibold",children:"   "}),h.jsx("p",{className:"text-sm",children:"    () "})]})]}),h.jsxs("li",{className:"pwa-instruction-step",children:[h.jsx("div",{className:"step-number",children:"2"}),h.jsxs("div",{className:"step-content",children:[h.jsx("p",{className:"font-semibold",children:"   "}),h.jsx("p",{className:"text-sm",children:'   "  " '})]})]}),h.jsxs("li",{className:"pwa-instruction-step",children:[h.jsx("div",{className:"step-number",children:"3"}),h.jsxs("div",{className:"step-content",children:[h.jsx("p",{className:"font-semibold",children:"  "}),h.jsx("p",{className:"text-sm",children:'  ""    '})]})]})]})]}):h.jsxs("div",{children:[h.jsx("div",{className:"pwa-instruction-box mb-6",children:h.jsx("p",{className:"text-white font-semibold mb-4",children:"Android  :"})}),h.jsxs("ol",{className:"pwa-instruction-steps",children:[h.jsxs("li",{className:"pwa-instruction-step",children:[h.jsx("div",{className:"step-number",children:"1"}),h.jsxs("div",{className:"step-content",children:[h.jsx("p",{className:"font-semibold",children:"  "}),h.jsx("p",{className:"text-sm",children:"    ()    "})]})]}),h.jsxs("li",{className:"pwa-instruction-step",children:[h.jsx("div",{className:"step-number",children:"2"}),h.jsxs("div",{className:"step-content",children:[h.jsx("p",{className:"font-semibold",children:"  "}),h.jsx("p",{className:"text-sm",children:'"  "  " "  '})]})]}),h.jsxs("li",{className:"pwa-instruction-step",children:[h.jsx("div",{className:"step-number",children:"3"}),h.jsxs("div",{className:"step-content",children:[h.jsx("p",{className:"font-semibold",children:" "}),h.jsx("p",{className:"text-sm",children:'  ""   '})]})]})]}),e&&h.jsx("button",{onClick:a,className:"pwa-install-button mt-6",children:" "})]})}),h.jsx("div",{className:"pwa-fullscreen-footer",children:h.jsx("p",{className:"text-gray-300 text-sm mb-4",children:"       "})})]})}):h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:h.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-sm w-full",children:[h.jsxs("div",{className:"text-center mb-4",children:[h.jsx("div",{className:"w-16 h-16 bg-indigo-600 rounded-lg mx-auto mb-4 flex items-center justify-center",children:h.jsx("span",{className:"text-white text-2xl font-bold",children:"N"})}),h.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:" "}),h.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-sm",children:"Nova AI Planner      ."})]}),r?h.jsxs("div",{className:"mb-4",children:[h.jsx("div",{className:"bg-blue-50 dark:bg-blue-900 p-3 rounded-lg mb-3",children:h.jsx("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:"iOS  :"})}),h.jsxs("ol",{className:"text-sm text-gray-600 dark:text-gray-300 space-y-2",children:[h.jsxs("li",{className:"flex items-center",children:[h.jsx("span",{className:"w-6 h-6 bg-indigo-600 text-white rounded-full flex items-center justify-center text-xs mr-2",children:"1"}),"   () "]}),h.jsxs("li",{className:"flex items-center",children:[h.jsx("span",{className:"w-6 h-6 bg-indigo-600 text-white rounded-full flex items-center justify-center text-xs mr-2",children:"2"}),'"  " ']}),h.jsxs("li",{className:"flex items-center",children:[h.jsx("span",{className:"w-6 h-6 bg-indigo-600 text-white rounded-full flex items-center justify-center text-xs mr-2",children:"3"}),'""  ']})]})]}):h.jsx("div",{className:"mb-4",children:e?h.jsx("button",{onClick:a,className:"w-full bg-indigo-600 text-white py-2 px-4 rounded-lg hover:bg-indigo-700 transition-colors",children:" "}):h.jsx("div",{className:"bg-gray-50 dark:bg-gray-700 p-3 rounded-lg",children:h.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:'  "  "  " " .'})})}),h.jsxs("div",{className:"flex space-x-2",children:[h.jsx("button",{onClick:t,className:"flex-1 bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-gray-200 py-2 px-4 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-500 transition-colors",children:""}),h.jsx("button",{onClick:()=>{localStorage.setItem("pwa-prompt-dismissed","true"),t()},className:"flex-1 bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-gray-200 py-2 px-4 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-500 transition-colors",children:"  "})]})]})})},P6=({todos:t,onEditTodo:e,t:n})=>{const r=G.useMemo(()=>t.filter(i=>i.wish&&i.wish.trim()||i.outcome&&i.outcome.trim()||i.obstacle&&i.obstacle.trim()||i.plan&&i.plan.trim()),[t]);return r.length===0?null:h.jsxs("div",{className:"woop-section",children:[h.jsx("div",{className:"woop-title",children:"WOOP "}),h.jsx("div",{className:"woop-cards-container",children:r.map(i=>h.jsxs("div",{className:"woop-card-item",onClick:()=>e(i),style:{cursor:"pointer"},children:[h.jsxs("div",{className:"woop-field",children:[h.jsx("div",{className:"woop-field-label",children:" Wish ()"}),h.jsx("div",{className:"woop-field-content",children:i.wish?h.jsx("div",{style:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis"},children:i.wish}):h.jsx("span",{className:"woop-empty",children:n("woop_not_set")})})]}),h.jsxs("div",{className:"woop-field",children:[h.jsx("div",{className:"woop-field-label",children:"Outcome ()"}),h.jsx("div",{className:"woop-field-content",children:i.outcome?h.jsx("div",{style:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis"},children:i.outcome}):h.jsx("span",{className:"woop-empty",children:n("woop_not_set")})})]}),h.jsxs("div",{className:"woop-field",children:[h.jsx("div",{className:"woop-field-label",children:"Obstacle ()"}),h.jsx("div",{className:"woop-field-content",children:i.obstacle?h.jsx("div",{style:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis"},children:i.obstacle}):h.jsx("span",{className:"woop-empty",children:n("woop_not_set")})})]}),h.jsxs("div",{className:"woop-field",children:[h.jsx("div",{className:"woop-field-label",children:"plan ()"}),h.jsx("div",{className:"woop-field-content",children:i.plan?h.jsx("div",{style:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis"},children:i.plan}):h.jsx("span",{className:"woop-empty",children:n("woop_not_set")})})]}),h.jsx("button",{className:"woop-card-btn",onClick:s=>{s.stopPropagation(),e(i)},style:{marginTop:"auto",width:"100%"},children:""})]},i.id))})]})},k6={ko:{language_selection_title:"",error_wish_required:" ",error_outcome_required:" ",error_obstacle_required:" ",error_plan_required:" ",error_deadline_required:" ",error_day_required:" ",my_goals_title:"",all_goals_label:" ",all_goals_button:"",sort_label_manual:"",sort_label_deadline:"",sort_label_newest:"",sort_label_alphabetical:"",sort_label_ai:"",ai_sorting_button:" ",add_new_goal_button_label:" ",filter_all:" ",filter_active:" ",filter_completed:"",filter_category:"",category_all:" ",category_school:"",category_work:"",category_personal:"",category_other:"",category_label:"",empty_message_all:"  ",empty_message_active:"   ",empty_message_completed:"  ",empty_encouragement_1:"  ",empty_encouragement_2:"    ",empty_encouragement_3:"   ",empty_encouragement_4:"  ",delete_button:"",edit_button_aria:"",info_button_aria:"",filter_title:"",sort_title:"",filter_sort_button_aria:"  ",category_filter_button_aria:" ",calendar_view_button_aria:"",list_view_button_aria:"",more_options_button_aria:"",select_button_label:"",cancel_selection_button_label:"",delete_selected_button_label:"{count} ",selection_summary_label:"{count}/{total} ",select_all_button_label:" ",delete_selected_confirm_title:" ",delete_selected_confirm_message:"{count}  .     .",days_left:"{count} ",d_day:"",days_overdue:"{count} ",month_names:["1","2","3","4","5","6","7","8","9","10","11","12"],day_names_short:["","","","","","",""],day_names_long:["","","","","","",""],calendar_header_month_format:"{year} {month}",calendar_view_day3:"3",calendar_view_week:"",calendar_view_month:"",settings_title:"",sort_alert_title:"  ",sort_alert_message:"2   ",ai_sort_error_title:" ",ai_sort_error_message:"  .  .",confirm_button:"",new_goal_modal_title:" ",edit_goal_modal_title:" ",wish_label:"",outcome_label:"",obstacle_label:"",plan_label:"",deadline_label:"",cancel_button:"",add_button:"",save_button:"",goal_details_modal_title:" ",todo_details_title:" ",task_title_label:"",due_date_label:"",time_label:"",completion_status_label:" ",completed:"",pending:" ",ai_coach_suggestion:" ",ai_analyzing:" ",close_button:"",ai_sort_reason_modal_title:"AI ",ai_sort_criteria:" ",delete_account_final_confirm_title:"  ",delete_account_final_confirm_message:"   .     .",delete_all_data_button:"  ",settings_done_button:"",settings_section_data:"",settings_section_account:"",settings_sync_data:" ",settings_syncing:" ",settings_save_to_cloud:"Google ",settings_loading:" ",settings_load_from_cloud:" ",settings_auto_sync:" ",settings_auto_sync_desc:"  ",settings_cloud_sync_header:"Google ",woop_not_set:"",settings_logout:"",settings_export_data:"",settings_import_data:"",import_confirm_title:" ",import_confirm_message:"    .   .",import_success_toast:" ",import_error_alert_title:" ",import_error_alert_message:"   .  .",settings_section_general:"",settings_section_info:"",settings_section_help:"",settings_theme_mode:"",theme_mode_light:"",theme_mode_light_desc:" ",theme_mode_dark:"",theme_mode_dark_desc:" ",theme_mode_system:"",theme_mode_system_desc:"  ",settings_dark_mode:" ",settings_language:"",settings_api_key:"AI ",settings_api_key_placeholder:"API  ",settings_offline_mode:" ",settings_offline_mode_desc:"AI  ",settings_notifications:"",settings_notifications_desc:" ",notification_settings_title:" ",notification_permission_denied:" ",notification_permission_denied_desc:"     ",notification_permission_request:"  ",reminder_add_title:" ",reminder_step_title:"{step}/5 ",reminder_step1_title:" ",reminder_step1_desc:"  ",reminder_step2_title:"  &  ",reminder_step2_desc:"    ()",reminder_step2_date_toggle:" ",reminder_step2_time_toggle:" ",reminder_step3_title:"  ",reminder_step3_desc:"    ",reminder_step3_enable_recurring:" ",reminder_step4_title:" ",reminder_step4_desc:"   ()",reminder_step5_title:" ",reminder_step5_desc:"   ",reminder_next_button:"",reminder_back_button:"",reminder_submit_button:"",reminder_form_title:"",reminder_form_date:"",reminder_form_time:"",reminder_form_recurring:"",reminder_form_description:"",reminder_form_enabled:"",recurring_type_none:" ",recurring_type_daily:"",recurring_type_weekly:"",recurring_type_monthly:"",notification_deadline:"  ",notification_deadline_desc:"     .",notification_suggestion:" ",notification_suggestion_desc:"   .",notification_achievement:"  ",notification_achievement_desc:"    .",notification_reminder:" ",notification_reminder_desc:"    .",reminder_time_settings_title:"  ",reminder_start_time:" ",reminder_end_time:" ",language_name:" ()",language_modal_title:"",settings_section_background:"",settings_bg_default:"",settings_bg_default_dark:"",settings_bg_pink:"",settings_bg_cherry_noir:" ",settings_bg_blue:"",settings_bg_deep_ocean:"",settings_bg_green:"",settings_bg_forest_green:" ",settings_bg_purple:"",settings_bg_royal_purple:" ",settings_version:"",folder_manage_title:" ",folder_manage_info:" ",folder_manage_collaborators:"",folder_manage_settings:"",folder_name_edit:"  ",folder_invite_new:"  ",assignment_management:" ",add_assignment:" ",assignment_name:"",subject:"",estimated_time:" ()",difficulty:"",due_date:" ",today_schedule:"   ",minutes:"",difficulty_level:" ",auto_allocated:" ",ai_analysis:"AI ",ai_estimate_time:" AI ",ai_estimate_difficulty:" AI ",ai_optimize_schedule:" AI ",ai_suggestion:"AI ",assignment_description:" ",assignment_description_placeholder:"    (AI     )",folder_invite_email:"   ",folder_invite_role:"",folder_role_owner:"",folder_role_editor:"",folder_role_viewer:"",folder_invite_button:"",folder_leave:" ",folder_delete:" ",folder_share_link:" ",folder_share_link_desc:"      ",folder_copy_link:" ",folder_leave_confirm:" ?",folder_delete_confirm:" ?       .",settings_developer:"",developer_name:"Kim Kyumin",settings_copyright:"",copyright_notice:" 2025 Kim Kyumin. All Rights Reserved.",build_number:" ",settings_data_header:" ",settings_data_header_desc:"   ,  .",settings_background_header:"",settings_background_header_desc:"     .",data_importing:" ...",data_exporting:" ...",data_deleting:" ...",url_import_title:"URL  ",url_import_message:"URL     ?",url_import_confirm:"",url_import_success:"URL   !",url_import_error:"URL   .",settings_share_link_header:" ",settings_generate_link:"  ",settings_copy_link:"",link_copied_toast:" .",short_url_created:"URL !",share_link_created:"URL ",short_url_failed:"URL     .",no_data_to_share:"  .",usage_guide_tab:"",usage_guide_title:" ",usage_basic_title:" ",usage_basic_desc:`1.   "   "  .
2. , , ,   .
3.    .
4. ""    .`,usage_ai_title:"Gemini AI  ",usage_ai_desc:`    ""  Gemini AI   .
   " "     .
 Gemini AI       .

 Gemini AI    API   .`,usage_ai_setup_title:"Gemini AI ",usage_ai_setup_desc:`1.  >  "Gemini AI "  .
2. Google Gemini API  .
3. API     Google   :
   https://ai.google.dev/gemini-api/docs/api-key
4.    Gemini AI  .`,usage_share_title:" ",usage_share_desc:`1.  >  "  "  .
2.     .
3. " "   .
4.    .`,usage_theme_title:" ",usage_theme_desc:`1.  >     .
2.     .
3. , , , ,     .
4.    .`,usage_calendar_title:"  ",usage_calendar_desc:`1.     .
2. 3//    .
3.      .
4.      .`,usage_offline_title:"  ",usage_offline_desc:`1.  >  " "  .
2. API    , ,  .
3. AI         .
4.    .`,goal_assistant_title:" ",goal_assistant_mode_woop:"WOOP",goal_assistant_mode_automation:" ",automation_title:"  ",automation_base_name_label:" ",automation_base_name_placeholder:":   ",automation_total_units_label:" ",automation_total_units_placeholder:": 30",automation_units_per_day_label:" ",automation_period_label:"",automation_start_date_label:"",automation_end_date_label:"",automation_generate_button:"{count} ",automation_error_all_fields:"   .",automation_error_start_after_end:"   .",automation_error_short_period:"  . (1 )",next_button:"",back_button:"",wish_tip:"  ,    .",wish_example:": 3  5kg ,   90  ",outcome_tip:"          .",outcome_example:":     ,   ",obstacle_tip:"      (,  ) ?",obstacle_example:":       ,    ",plan_tip:"' ~, ~'       .",plan_example:":      ,    10 .",recurrence_label:"",recurrence_tip:"     ?      .",recurrence_example:":  ,,  ",recurrence_option_daily:" ",deadline_tip:"    .     .",deadline_option_no_deadline:" ",day_names_short_picker:["","","","","","",""],settings_delete_account:"   ",edit_todo_title:" ",todo_title_label:" ",todo_title_placeholder:" ",recurring_label:" ",recurring_days_label:" ",delete_account_header:" ",delete_account_header_desc:"    ,     .",version_update_title:" ",version_update_1_title:"Firebase  ",version_update_1_desc:"Google        .   Google     .",version_update_2_title:"  ",version_update_2_desc:", ,           .",version_update_3_title:" ",version_update_3_desc:"     ,      .",version_update_4_title:"  UI",version_update_4_desc:", ,           ."},en:{language_selection_title:"Language",error_wish_required:"Enter your goal",error_outcome_required:"Enter the outcome",error_obstacle_required:"Enter the obstacle",error_plan_required:"Enter your plan",error_deadline_required:"Select a date",error_day_required:"Select a day",my_goals_title:"Goals",all_goals_label:"All",all_goals_button:"All",sort_label_manual:"Manual",sort_label_deadline:"By Date",sort_label_newest:"Recent",sort_label_alphabetical:"Name",sort_label_ai:"Priority",ai_sorting_button:"Sorting",add_new_goal_button_label:"Add Goal",filter_all:"All Goals",filter_active:"In Progress",filter_completed:"Complete",filter_category:"Category",category_all:"All Categories",category_school:"School",category_work:"Work",category_personal:"Personal",category_other:"Other",category_label:"Category",empty_message_all:"Add your first goal",empty_message_active:"No goals in progress",empty_message_completed:"No completed goals",empty_encouragement_1:"Take the first step",empty_encouragement_2:"Small changes lead to big achievements",empty_encouragement_3:"Today is the perfect day to start",empty_encouragement_4:"Turn your goals into reality",delete_button:"Delete",edit_button_aria:"Edit",info_button_aria:"Info",filter_title:"Filter",sort_title:"Sort",filter_sort_button_aria:"Filter & Sort",category_filter_button_aria:"Category Filter",calendar_view_button_aria:"Calendar",list_view_button_aria:"List",more_options_button_aria:"More",select_button_label:"Select",cancel_selection_button_label:"Cancel",delete_selected_button_label:"Delete {count}",selection_summary_label:"{count} of {total} selected",select_all_button_label:"Select All",delete_selected_confirm_title:"Delete Goals",delete_selected_confirm_message:"{count} goals will be deleted. This cannot be undone.",days_left:"{count} days left",d_day:"Due Today",days_overdue:"{count} days overdue",month_names:["January","February","March","April","May","June","July","August","September","October","November","December"],day_names_short:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],day_names_long:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],calendar_header_month_format:"{month} {year}",calendar_view_day3:"3-Day",calendar_view_week:"Week",calendar_view_month:"Month",settings_title:"Settings",sort_alert_title:"Unable to Sort",sort_alert_message:"Add at least two goals to use priority order.",ai_sort_error_title:"Unable to Sort",ai_sort_error_message:"Cannot connect to server. Please try again later.",confirm_button:"OK",new_goal_modal_title:"New Goal",edit_goal_modal_title:"Edit Goal",wish_label:"Wish",outcome_label:"Outcome",obstacle_label:"Obstacle",plan_label:"If-Then Plan",deadline_label:"Deadline",cancel_button:"Cancel",add_button:"Add",save_button:"Save",goal_details_modal_title:"Goal Details",todo_details_title:"Task Details",task_title_label:"Task",due_date_label:"Due Date",time_label:"Time",completion_status_label:"Status",completed:"Completed",pending:"In Progress",ai_coach_suggestion:"View Summary",ai_analyzing:"Analyzing...",close_button:"Close",ai_sort_reason_modal_title:"Sort Reason",ai_sort_criteria:" Sort Criteria",delete_account_final_confirm_title:"Delete All Data",delete_account_final_confirm_message:"All your goals and data will be permanently deleted. This action cannot be undone.",delete_all_data_button:"Delete All Data",settings_done_button:"Done",settings_section_data:"Data Management",settings_export_data:"Export",settings_import_data:"Import",import_confirm_title:"Import Data",import_confirm_message:"This will replace your current goals with new data. This action cannot be undone.",import_success_toast:"Data imported successfully.",import_error_alert_title:"Import Failed",import_error_alert_message:"There was an error reading the file, or the file format is incorrect.",settings_section_general:"General",settings_section_info:"Information",settings_section_help:"How to Use",settings_theme_mode:"Theme Mode",theme_mode_light:"Light Mode",theme_mode_light_desc:"Use bright theme",theme_mode_dark:"Dark Mode",theme_mode_dark_desc:"Use dark theme",theme_mode_system:"Follow System Settings",theme_mode_system_desc:"Automatically adjust to device settings",settings_dark_mode:"Dark Mode",settings_language:"Language",settings_api_key:"Gemini AI Setup",settings_api_key_placeholder:"Enter Gemini API key",settings_offline_mode:"Offline Mode",settings_offline_mode_desc:"Use basic features without AI",settings_notifications:"Notifications",settings_notifications_desc:"PWA notification settings",notification_settings_title:"What notifications would you like?",notification_permission_denied:"Notifications Blocked",notification_permission_denied_desc:"Enable notifications in settings to use this feature",notification_permission_request:"Request Permission",notification_deadline:"Deadline Alerts",notification_deadline_desc:"Get notified when deadlines are approaching.",notification_suggestion:"Today's Suggestions",notification_suggestion_desc:"Get suggestions on what to do today.",notification_achievement:"Achievement Celebration",notification_achievement_desc:"Celebrate when you achieve a goal.",notification_reminder:"General Todo",notification_reminder_desc:"Get notified at scheduled times.",reminder_time_settings_title:"Todo Time Settings",reminder_start_time:"Start Time",reminder_end_time:"End Time",reminder_add_title:"Add Todo",reminder_step_title:"Step {step}/5",reminder_step1_title:" Title",reminder_step1_desc:"Enter the todo title",reminder_step2_title:" Date &  Time",reminder_step2_desc:"Set the todo date and time (optional)",reminder_step2_date_toggle:"Set Date",reminder_step2_time_toggle:"Set Time",reminder_step3_title:" Recurring",reminder_step3_desc:"Choose recurrence settings",reminder_step3_enable_recurring:"Enable Recurring",reminder_step4_title:" Description",reminder_step4_desc:"Add optional description",reminder_step5_title:" Enable",reminder_step5_desc:"Choose whether to enable todo",reminder_next_button:"Next",reminder_back_button:"Back",reminder_submit_button:"Add",reminder_form_title:"Title",reminder_form_date:"Date",reminder_form_time:"Time",reminder_form_recurring:"Recurring",reminder_form_description:"Description",reminder_form_enabled:"Enabled",recurring_type_none:"No Recurrence",recurring_type_daily:"Daily",recurring_type_weekly:"Weekly",recurring_type_monthly:"Monthly",language_name:"English (US)",language_modal_title:"Language",settings_section_background:"Appearance",settings_share_link_header:"Share via Link",settings_generate_link:"Generate Share Link",settings_bg_default:"Light",settings_bg_default_dark:"Dark",settings_bg_pink:"Pink",settings_bg_cherry_noir:"Cherry Noir",settings_bg_blue:"Blue",settings_bg_deep_ocean:"Ocean",settings_bg_green:"Green",settings_bg_forest_green:"Forest",settings_bg_purple:"Purple",settings_bg_royal_purple:"Royal Purple",settings_section_account:"Nova AI Planner Account",settings_sync_data:"Sync Data",settings_syncing:"Saving...",settings_save_to_cloud:"Save to Cloud",settings_loading:"Loading...",settings_load_from_cloud:"Load from Cloud",settings_auto_sync:"Auto Sync",settings_auto_sync_desc:"Automatically save when goals change",settings_cloud_sync_header:"Cloud Sync",woop_not_set:"Not Set",settings_logout:"Sign Out",settings_delete_account:"Delete My Data",edit_todo_title:"Edit Todo",todo_title_label:"Todo Title",todo_title_placeholder:"Enter your todo",recurring_label:"Recurring",recurring_days_label:"Recurring Days",delete_account_header:"Delete Data",delete_account_header_desc:"This action is irreversible and will permanently delete all your goals and data.",data_deleting:"Deleting...",settings_version:"Version",settings_developer:"Developer",developer_name:"GimGyuMin",settings_copyright:"Copyright",copyright_notice:" 2025 GimGyuMin. All Rights Reserved.",build_number:"Build Number",settings_data_header:"Data Management",settings_data_header_desc:"Export or import your goal data.",settings_background_header:"Background",settings_background_header_desc:"Change the app's background style to express your personality.",data_importing:"Importing...",data_exporting:"Exporting..."}},Ie={add:h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[h.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),h.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),check:h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:h.jsx("polyline",{points:"20 6 9 17 4 12"})}),info:h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[h.jsx("circle",{cx:"12",cy:"12",r:"10"}),h.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),h.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),delete:h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[h.jsx("polyline",{points:"3 6 5 6 21 6"}),h.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}),h.jsx("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),h.jsx("line",{x1:"14",y1:"11",x2:"14",y2:"17"})]}),edit:h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[h.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),h.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),close:h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[h.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),h.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}),back:h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:h.jsx("polyline",{points:"15 18 9 12 15 6"})}),forward:h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:h.jsx("polyline",{points:"9 18 15 12 9 6"})}),calendar:h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[h.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),h.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),h.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),h.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),list:h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[h.jsx("line",{x1:"8",y1:"6",x2:"21",y2:"6"}),h.jsx("line",{x1:"8",y1:"12",x2:"21",y2:"12"}),h.jsx("line",{x1:"8",y1:"18",x2:"21",y2:"18"}),h.jsx("line",{x1:"3",y1:"6",x2:"3.01",y2:"6"}),h.jsx("line",{x1:"3",y1:"12",x2:"3.01",y2:"12"}),h.jsx("line",{x1:"3",y1:"18",x2:"3.01",y2:"18"})]}),settings:h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[h.jsx("circle",{cx:"12",cy:"12",r:"3"}),h.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]}),filter:h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:h.jsx("polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"})}),ai:h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[h.jsx("path",{d:"M12 3L14.34 8.66L20 11L14.34 13.34L12 19L9.66 13.34L4 11L9.66 8.66L12 3Z"}),h.jsx("path",{d:"M5 21L7 16"}),h.jsx("path",{d:"M19 21L17 16"})]}),flame:h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:h.jsx("path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"})}),data:h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[h.jsx("path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83"}),h.jsx("path",{d:"M22 12A10 10 0 0 0 12 2v10z"})]}),background:h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[h.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),h.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),h.jsx("polyline",{points:"21 15 16 10 5 21"})]}),exclamation:h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:h.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 15c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1zm1-4h-2V7h2v6z"})})},hu=(t,e)=>{const n=new Date(t),r=new Date(e);return n.getFullYear()===r.getFullYear()&&n.getMonth()===r.getMonth()&&n.getDate()===r.getDate()},N6=(t,e)=>{if(!t)return null;const n=new Date;n.setHours(0,0,0,0);const r=new Date(t);r.setHours(0,0,0,0);const i=r.getTime()-n.getTime(),s=Math.ceil(i/(1e3*60*60*24));return s===0?e("d_day"):s>0?e("days_left").replace("{count}",String(s)):e("days_overdue").replace("{count}",String(Math.abs(s)))},Zw=(t,e=1)=>{const n=new Date(t),r=n.getDay(),i=(r<e?7:0)+r-e;return n.setDate(n.getDate()-i),n.setHours(0,0,0,0),n},gg=t=>!!(t.wish||t.outcome||t.obstacle||t.plan),_g=t=>{try{const e=new TextEncoder().encode(t),n=Array.from(e).map(r=>String.fromCharCode(r)).join("");return btoa(n)}catch(e){return console.error("UTF-8 to Base64 encoding failed:",e),""}},eI=t=>{try{const e=atob(t),n=new Uint8Array(e.length);for(let r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return new TextDecoder().decode(n)}catch(e){return console.error("Base64 to UTF-8 decoding failed:",e),""}},tI=t=>{try{const n=JSON.stringify(t).replace(/\s+/g," ").trim();return _g(n)}catch(e){return console.error("Data compression failed:",e),_g(JSON.stringify(t))}},rR=async t=>{if(t.length<1500)return t;const e=[{name:"is.gd",createUrl:async n=>{const r=await fetch(`https://is.gd/create.php?format=simple&url=${encodeURIComponent(n)}`);if(!r.ok)throw new Error("is.gd API failed");const i=await r.text();if(i.includes("Error")||!i.startsWith("http"))throw new Error("Invalid response from is.gd");return i.trim()}},{name:"tinyurl",createUrl:async n=>new Promise((r,i)=>{const s=`tinyurl_${Date.now()}`,o=document.createElement("script"),a=setTimeout(()=>{l(),i(new Error("TinyURL timeout"))},5e3),l=()=>{clearTimeout(a),o.parentNode&&document.head.removeChild(o),delete window[s]};window[s]=u=>{l(),u&&typeof u=="string"&&!u.includes("Error")&&u.startsWith("http")?r(u.trim()):i(new Error("Invalid TinyURL response"))},o.onerror=()=>{l(),i(new Error("TinyURL script load failed"))},o.src=`https://tinyurl.com/api-create.php?url=${encodeURIComponent(n)}&callback=${s}`,document.head.appendChild(o)})},{name:"v.gd",createUrl:async n=>{const r=await fetch(`https://v.gd/create.php?format=simple&url=${encodeURIComponent(n)}`);if(!r.ok)throw new Error("v.gd API failed");const i=await r.text();if(i.includes("Error")||!i.startsWith("http"))throw new Error("Invalid response from v.gd");return i.trim()}}];for(const n of e)try{console.log(`Trying ${n.name} for URL shortening...`);const r=await n.createUrl(t);return console.log(` ${n.name} success:`,r),r}catch(r){console.warn(` ${n.name} failed:`,r);continue}return console.warn("All URL shortening services failed, using original URL"),t},yg=[{id:"default",lightThemeClass:"bg-solid-default",darkThemeClass:"bg-solid-default",lightNameKey:"settings_bg_default",darkNameKey:"settings_bg_default_dark"},{id:"pink",lightThemeClass:"bg-solid-pink",darkThemeClass:"bg-solid-pink",lightNameKey:"settings_bg_pink",darkNameKey:"settings_bg_cherry_noir"},{id:"blue",lightThemeClass:"bg-solid-blue",darkThemeClass:"bg-solid-blue",lightNameKey:"settings_bg_blue",darkNameKey:"settings_bg_deep_ocean"},{id:"green",lightThemeClass:"bg-solid-green",darkThemeClass:"bg-solid-green",lightNameKey:"settings_bg_green",darkNameKey:"settings_bg_forest_green"},{id:"purple",lightThemeClass:"bg-solid-purple",darkThemeClass:"bg-solid-purple",lightNameKey:"settings_bg_purple",darkNameKey:"settings_bg_royal_purple"}],b6=()=>{const[t,e]=G.useState("ko"),[n,r]=G.useState([]),[i,s]=G.useState([]),[o,a]=G.useState([]),[l,u]=G.useState([]),[p,m]=G.useState("my-goals"),[g,v]=G.useState("all"),[I,P]=G.useState("all"),[V,C]=G.useState("manual"),[S,A]=G.useState(["school","work","personal","other"]),[L,q]=G.useState(()=>kp()==="dark"),[z,E]=G.useState("system"),[x,R]=G.useState("default"),[N,M]=G.useState([]),[U,b]=G.useState({}),[xe,Ye]=G.useState([]),[Ue,Ee]=G.useState(!1),[Z,he]=G.useState(!1),[fe,Ce]=G.useState(null),[Le,At]=G.useState(!1),[Oe,Dt]=G.useState(null),[Ne,je]=G.useState(!1),[Ut,Ot]=G.useState(!1),[In,er]=G.useState(null),[_t,ae]=G.useState(""),[Je,Tr]=G.useState(""),[Sn,tr]=G.useState("editor"),[Re,Ge]=G.useState(!1),[qe,on]=G.useState(null),[nr,gn]=G.useState(!1),[an,Fn]=G.useState(!1),[Qe,xs]=G.useState(!1),[Et,_e]=G.useState(null),[gi,Ur]=G.useState(!1),[Er,Un]=G.useState(new Set),[xn,we]=G.useState(""),[Cn,rr]=G.useState("idle"),[Or,le]=G.useState(!1),[rt,_i]=G.useState(!1),[Bt,gc]=G.useState(""),[Cs,Br]=G.useState(!1),[As,il]=G.useState(void 0),[yi,_c]=G.useState(!1),[vi,wr]=G.useState(""),[Ti,sl]=G.useState(!1),[Ei,wi]=G.useState(!0),[Rf,ir]=G.useState("default"),[J,Rs]=G.useState(null),[yc,vc]=G.useState(""),[Pf,Iy]=G.useState(!1),[Tc,So]=G.useState(!1),[xo,Ps]=G.useState(!1),[ks,Xe]=G.useState(!1),[Gr,Ns]=G.useState(!1),[ol,Ec]=G.useState(!0),[kf,Nf]=G.useState(!1),[wc,al]=G.useState(0),[bf,ll]=G.useState("activity-based"),[Co,Df]=G.useState(null),[On,sr]=G.useState(3e3),[Ao,Ii]=G.useState(!1),[Ro,Ze]=G.useState(!1),[Bn,Si]=G.useState("todos");G.useEffect(()=>{const T=()=>{"Notification"in window&&ir(Notification.permission)};T();const k=()=>{T()};return window.addEventListener("focus",k),()=>window.removeEventListener("focus",k)},[]),G.useEffect(()=>{let T=null,k=null,O=null;const B=qL(qs,async $=>{if(Rs($),Ec(!1),$){console.log("    - Firebase   "),await ul($),console.log("      ...");let K=null,H=null,Y=null;const W=be(ue,"users",$.uid,"data","todos");T=xr(W,_=>{K&&clearTimeout(K),K=setTimeout(()=>{if(_.exists()){const w=_.data().todos||[];r(D=>{const F=D.filter(Pe=>Pe.isSharedTodo===!0),X=w.map(Pe=>({...Pe,isSharedTodo:!1}));return JSON.stringify(D.filter(Pe=>!Pe.isSharedTodo))!==JSON.stringify(X)?(console.log("     :",X.length,"  :",F.length),[...X,...F]):D})}},2e3)});const ee=be(ue,"users",$.uid,"data","assignments");xr(ee,_=>{H&&clearTimeout(H),H=setTimeout(()=>{var y;if(_.exists()){const w=_.data();s(w.assignments||[]),a(w.dailyAllocations||[]),console.log("    :",((y=w.assignments)==null?void 0:y.length)||0)}},2e3)});const c=lt(ue,"users",$.uid,"folders");k=xr(c,async _=>{Y&&clearTimeout(Y),Y=setTimeout(async()=>{const y=[];_.forEach(D=>{const F=D.data(),X={id:D.id,name:F.name||"  ",color:F.color||"#007AFF",...F,collaborators:F.collaborators||[],ownerId:F.ownerId||$.uid};y.push(X)});const w=y.filter(D=>D.isShared&&D.ownerId&&D.ownerId!==$.uid);if(w.length>0){console.log("     :",w.map(F=>({id:F.id,name:F.name,ownerId:F.ownerId}))),O&&O();const D=[];for(const F of w)if(F.ownerId)try{const X=be(ue,"users",F.ownerId,"folders",F.id),me=xr(X,Jt=>{if(Jt.exists()){const Mt=Jt.data();console.log("     :",{folderId:F.id,name:Mt.name,color:Mt.color}),u(Gt=>Gt.map(qt=>qt.id===F.id?{...qt,name:Mt.name||qt.name||" ",color:Mt.color||qt.color,updatedAt:Mt.updatedAt||qt.updatedAt}:qt))}},Jt=>{console.error("     :",Jt)});D.push(me);const Pe=lt(ue,"users",F.ownerId,"todos"),Ae=zl(Pe,$l("folderId","==",F.id));let tt=null;const zn=xr(Ae,Jt=>{tt&&clearTimeout(tt),tt=setTimeout(()=>{const Mt=[];Jt.forEach(Gt=>{const qt=Gt.data();Mt.push({id:parseInt(Gt.id),...qt,isSharedTodo:!0})}),console.log("     :",{folderId:F.id,count:Mt.length}),r(Gt=>{const qt=Gt.filter(Mc=>!(Mc.folderId===F.id&&Mc.isSharedTodo===!0)),Lo=Mt.filter(Mc=>!qt.some(iR=>iR.id===Mc.id)),Sy=[...qt,...Lo];return console.log("   :",{:Gt.length,:Gt.length-qt.length,:Lo.length,:Sy.length}),Sy})},1500)},Jt=>{console.warn("     :",{folderId:F.id,error:Jt.code})});D.push(zn)}catch(X){console.warn("     :",{folderId:F.id,error:X})}O=()=>{D.forEach(F=>F())}}u(D=>JSON.stringify(D)!==JSON.stringify(y)?(console.log("    :",y.map(X=>({id:X.id,name:X.name}))),y):D)},3e3)})}else console.log("    -  "),T&&(T(),T=null),k&&(k(),k=null),O&&(O(),O=null),r([]),u([]),e("ko"),E("system"),R("default"),wr(""),A(["school","work","personal","other"])});return()=>{B(),T&&T(),k&&k(),O&&O()}},[]);const qr=G.useCallback(async()=>{So(!0);try{console.log(" Google  ..."),console.log("Auth :",qs),console.log("Google Provider :",ja);const T=window.open("","_blank","width=1,height=1");if(!T||T.closed||typeof T.closed>"u")throw new Error(" .    .");T.close(),console.log(" signInWithPopup  ...");const k=await aF(qs,ja);console.log("  :",k.user.email),Rs(k.user),we(" Google  !"),setTimeout(async()=>{var O;try{console.log("    ...");const{doc:B,getDoc:$}=await Ri(async()=>{const{doc:ee,getDoc:c}=await Promise.resolve().then(()=>Mi);return{doc:ee,getDoc:c}},void 0),K=B(ue,"users",k.user.uid,"data","todos"),H=await $(K);if(H.exists()){const ee=H.data();r(ee.todos||[]),console.log("    :",((O=ee.todos)==null?void 0:O.length)||0)}else console.log("   -    "),r([]);const Y=B(ue,"users",k.user.uid,"data","settings"),W=await $(Y);if(W.exists()){const ee=W.data();ee.language&&e(ee.language),ee.themeMode&&E(ee.themeMode),ee.isDarkMode!==void 0&&q(ee.isDarkMode),ee.backgroundTheme&&R(ee.backgroundTheme),ee.apiKey&&wr(ee.apiKey)}we("  !  ")}catch(B){console.error("  :",B),we("     ")}So(!1),setTimeout(()=>we(""),3e3)},500),setTimeout(()=>we(""),3e3)}catch(T){console.error(" Google  :",T),console.error(" :",T.code),console.error(" :",T.message);let k="   .";switch(T.code){case"auth/popup-closed-by-user":k=" .";break;case"auth/popup-blocked":k=" .    .";break;case"auth/cancelled-popup-request":k="    .";break;case"auth/network-request-failed":k="  .";break;case"auth/too-many-requests":k="   .    .";break;case"auth/user-disabled":k=" .";break;case"auth/operation-not-allowed":k="Google   .  .";break;default:k=` : ${T.message}`}T.code!=="auth/popup-closed-by-user"&&_e({title:" ",message:k,confirmText:"",onConfirm:()=>_e(null)}),So(!1)}},[]),Mf=(T,k)=>{if(T===null)return;const O=l.map(B=>B.id===T?{...B,collaborators:k}:B);u(O),As&&As.id===T&&il({...As,collaborators:k}),we("   "),setTimeout(()=>we(""),3e3)},Ic=G.useCallback(async()=>{Ps(!0);try{if(J){we("   ...");const T=n.filter(w=>w!=null),{doc:k,setDoc:O,serverTimestamp:B}=await Ri(async()=>{const{doc:w,setDoc:D,serverTimestamp:F}=await Promise.resolve().then(()=>Mi);return{doc:w,setDoc:D,serverTimestamp:F}},void 0),$=T.map(w=>st(w)).filter(w=>w!==void 0),K=k(ue,"users",J.uid,"data","todos"),H={todos:$,lastSyncTime:B(),totalGoals:$.length,syncedAt:new Date().toISOString()},Y=st(H);Y?(await O(K,Y),console.log(" Todos Firestore  :",{count:$.length})):console.error(" Todos   ");const W=k(ue,"users",J.uid,"data","assignments"),ee=i.map(w=>st(w)).filter(w=>w!==void 0),c={assignments:ee,dailyAllocations:o,lastSyncTime:B(),totalAssignments:ee.length,syncedAt:new Date().toISOString()},_=st(c);_&&(await O(W,_),console.log(" Assignments Firestore  :",{count:ee.length}));const y=k(ue,"users",J.uid,"data","settings");await O(y,{language:t,themeMode:z,isDarkMode:L,backgroundTheme:x,updatedAt:B()})}await vE(qs),Rs(null),r([]),s([]),a([]),e("ko"),R("default"),E("system"),q(kp()==="dark"),Ce(null),gn(!1),he(!1),we("  "),setTimeout(()=>we(""),3e3),Ps(!1)}catch(T){console.error(" :",T),_e({title:" ",message:"   .",confirmText:"",onConfirm:()=>_e(null)}),Ps(!1)}},[J,n,t,z,L,x]),bs=G.useCallback(async()=>{if(!J){_e({title:" ",message:" ",confirmText:"",onConfirm:()=>_e(null)});return}Xe(!0);try{const T=n.filter(D=>D!=null),{doc:k,setDoc:O,serverTimestamp:B}=await Ri(async()=>{const{doc:D,setDoc:F,serverTimestamp:X}=await Promise.resolve().then(()=>Mi);return{doc:D,setDoc:F,serverTimestamp:X}},void 0),$=T.map(D=>st(D)).filter(D=>D!==void 0),K=k(ue,"users",J.uid,"data","todos"),H={todos:$,lastSyncTime:B(),totalGoals:$.length,syncedAt:new Date().toISOString()},Y=st(H);if(Y)await O(K,Y),console.log(" Todos Firestore  :",{count:$.length});else throw new Error("Todos   ");const W=k(ue,"users",J.uid,"data","assignments"),ee=i.map(D=>st(D)).filter(D=>D!==void 0),c={assignments:ee,dailyAllocations:o,lastSyncTime:B(),totalAssignments:ee.length,syncedAt:new Date().toISOString()},_=st(c);if(_&&(await O(W,_),console.log(" Assignments Firestore  :",{count:ee.length})),Y)await O(K,Y),console.log("  Todos Firestore  :",{count:$.length});else throw new Error("Todos   ");const y=k(ue,"users",J.uid,"data","settings"),w={language:t,themeMode:z,isDarkMode:L,backgroundTheme:x,apiKey:vi,userCategories:S,updatedAt:B()};await O(y,w);for(const D of l)try{const F=k(ue,"users",J.uid,"folders",D.id),X={...D,ownerId:D.ownerId||J.uid,collaborators:D.collaborators||[],updatedAt:B()};await O(F,X),console.log(`  ${D.id}  `)}catch(F){console.error(`  ${D.id}  :`,F)}Xe(!1)}catch(T){console.error(" :",T),_e({title:" ",message:T.message||"    .",confirmText:"",onConfirm:()=>_e(null)}),Xe(!1)}},[J,n,t,z,L,x,vi]),ul=G.useCallback(async T=>{var k,O;try{const{doc:B,getDoc:$,collection:K,getDocs:H}=await Ri(async()=>{const{doc:w,getDoc:D,collection:F,getDocs:X}=await Promise.resolve().then(()=>Mi);return{doc:w,getDoc:D,collection:F,getDocs:X}},void 0),Y=B(ue,"users",T.uid,"data","todos"),W=await $(Y);if(W.exists()){const D=W.data().todos||[];r(F=>{const X=new Set(F.map(Ae=>Ae.id)),me=D.filter(Ae=>!X.has(Ae.id)),Pe=[...F,...me];return console.log("   :",{:F.length,:D.length,:me.length,:Pe.length}),Pe})}const ee=B(ue,"users",T.uid,"data","assignments"),c=await $(ee);if(c.exists()){const w=c.data();s(w.assignments||[]),a(w.dailyAllocations||[]),console.log(" Assignments   :",{count:((k=w.assignments)==null?void 0:k.length)||0})}const _=B(ue,"users",T.uid,"data","settings"),y=await $(_);if(y.exists()){const w=y.data();w.language&&e(w.language),w.themeMode&&E(w.themeMode),w.isDarkMode!==void 0&&q(w.isDarkMode),w.backgroundTheme&&R(w.backgroundTheme),w.apiKey&&wr(w.apiKey),w.userCategories&&A(w.userCategories)}try{const w=K(ue,"users",T.uid,"folders"),D=await H(w),F=[];D.forEach(X=>{const me=X.data(),Pe={id:X.id,...me,collaborators:me.collaborators||[],ownerId:me.ownerId||T.uid};F.push(Pe)}),u(X=>{const me=new Set(X.map(tt=>tt.id)),Pe=F.filter(tt=>!me.has(tt.id)),Ae=[...X,...Pe];return console.log("   :",{:X.length,:F.length,:Pe.length,:Ae.length}),Ae}),console.log("   :",{count:F.length})}catch(w){console.warn("   ,   :",w)}console.log("    :",{todos:W.exists()&&((O=W.data().todos)==null?void 0:O.length)||0,folders:"",settings:y.exists()?"":""})}catch(B){console.error("    :",B)}},[]),Vf=G.useCallback(async()=>{if(!J){_e({title:" ",message:" ",confirmText:"",onConfirm:()=>_e(null)});return}Ns(!0);try{await ul(J),we("    !")}catch(T){console.error(" :",T),_e({title:" ",message:T.message||"    .",confirmText:"",onConfirm:()=>_e(null)})}finally{Ns(!1)}},[J,ul]),re=G.useCallback(T=>k6[t][T]||T,[t]),Gn=G.useCallback(T=>{let k=T||vi;if(Ti||!k)return null;try{return k=k.trim(),/^[\x00-\x7F]*$/.test(k)?k.length===0?(console.warn(" API  ."),null):new y2({apiKey:k}):(console.error(" API      . ASCII  ."),null)}catch(O){return console.error(" AI   :",O),null}},[vi,Ti]),zr=G.useCallback(T=>{E(T)},[]),Po=G.useMemo(()=>[re("empty_encouragement_1"),re("empty_encouragement_2"),re("empty_encouragement_3"),re("empty_encouragement_4")],[re]),Sc=G.useMemo(()=>Po[Math.floor(Math.random()*Po.length)],[Po]);G.useEffect(()=>{console.log("     - localStorage   ")},[]),G.useEffect(()=>{const T=z==="dark"||z==="system"&&kp()==="dark";T?document.documentElement.classList.add("dark-mode"):document.documentElement.classList.remove("dark-mode"),document.documentElement.setAttribute("data-bg-theme",x),console.log("  :",{themeMode:z,backgroundTheme:x,isDark:T})},[z,x]),G.useEffect(()=>{(()=>{u(k=>{const O=k.filter(B=>{if(!B.collaborators||B.collaborators.length===0)return!0;const $=B.collaborators.find(K=>K.role==="owner");return!$||!$.userId||$.userId.startsWith("owner_")?(console.warn("    :",B.name,$==null?void 0:$.userId),!1):!0});return O.length!==k.length&&console.log("     :",{:k.length-O.length,:O.length}),O})})()},[]),G.useEffect(()=>{if(ol)return;const T=async()=>{const k=new URLSearchParams(window.location.search),O=k.get("data"),B=k.get("folder_share");if(B){try{const $=eI(B),K=JSON.parse($);if(K.type==="folder_share"&&K.folderId){if(K.password){const Y=sessionStorage.getItem(`folder_${K.folderId}_password`);if(!Y||Y!==K.password){_e({title:" ",message:"    .  .",confirmText:"",cancelText:"",onConfirm:()=>{const W=prompt("  :");W===K.password?(sessionStorage.setItem(`folder_${K.folderId}_password`,W),_e(null),T()):W!==null&&_e({title:" ",message:"  .",confirmText:"",onConfirm:()=>{window.history.replaceState({},document.title,window.location.pathname)}})},onCancel:()=>{window.history.replaceState({},document.title,window.location.pathname)}});return}}if(l.some(Y=>Y.id===K.folderId))window.history.replaceState({},document.title,window.location.pathname);else{if(K.ownerId&&!J&&!ol){_e({title:" ",message:"        .  .",confirmText:"",cancelText:"",onConfirm:async()=>{try{await qr()}catch(c){console.error("  :",c)}},onCancel:()=>{window.history.replaceState({},document.title,window.location.pathname)}});return}const Y=K.ownerId||null;if(!Y){console.error("     :",K),_e({title:"   ",message:`    .
     .`,confirmText:"",onConfirm:()=>{_e(null),window.history.replaceState({},document.title,window.location.pathname)}});return}const W={id:K.folderId,name:K.folderName,color:K.folderColor||"#007AFF",ownerId:Y,collaborators:[{userId:Y,email:K.sharedBy||"",role:"owner",addedAt:K.sharedAt}],createdAt:K.sharedAt,updatedAt:K.sharedAt,isShared:!0};let ee=W;if(Y&&J)try{console.log("   :",{ownerUserId:Y,googleUserUid:J.uid});const c=lt(ue,"users",Y,"folders"),_=be(c,K.folderId),y=await pg(_);if(console.log("   :",{exists:y.exists()}),y.exists()){let w=y.data().collaborators||[];console.log("   :",w);const D=w.some(F=>F.userId===J.uid);if(console.log("  :",{isCollaborator:D}),D)console.log("  ");else{const F={userId:J.uid,email:J.email||"",role:"editor",addedAt:new Date().toISOString()};w=[...w,F],console.log("   :",w);const X=st(w);X?(await yt(_,{collaborators:X,updatedAt:new Date().toISOString()},{merge:!0}),console.log("  Firestore  :",F)):console.warn("     ")}ee={...W,collaborators:w}}else console.warn("   :",K.folderId)}catch(c){console.error("   / :",c)}else console.warn("    :",{ownerUserId:Y,hasGoogleUser:!!J});if(u([...l,ee]),J)try{const{doc:c,setDoc:_}=await Ri(async()=>{const{doc:w,setDoc:D}=await Promise.resolve().then(()=>Mi);return{doc:w,setDoc:D}},void 0),y=c(ue,"users",J.uid,"folders",ee.id);await _(y,{name:ee.name,color:ee.color,ownerId:ee.ownerId,createdAt:ee.createdAt,updatedAt:ee.updatedAt,isShared:ee.isShared,collaborators:ee.collaborators||[],collaborationSettings:ee.collaborationSettings||{enabled:!0,showPresence:!0,showEditingState:!0,enableConflictDetection:!0,allowGuestView:!1,requireApproval:!1}}),console.log("   Firebase  :",ee.id)}catch(c){console.error("   Firebase  :",c)}m(ee.id),_e({title:"  ",message:`"${K.folderName}"  .    .`,confirmText:"",onConfirm:()=>{window.history.replaceState({},document.title,window.location.pathname)}})}}}catch($){console.error("    :",$),window.history.replaceState({},document.title,window.location.pathname)}return}if(O)try{const $=eI(O),K=JSON.parse($);if(Array.isArray(K)&&(K.length===0||"wish"in K[0]&&"id"in K[0]))_e({title:re("url_import_title"),message:re("url_import_message"),confirmText:re("url_import_confirm"),cancelText:re("cancel_button"),onConfirm:()=>{r(K),we(re("url_import_success")),window.history.replaceState({},document.title,window.location.pathname)},onCancel:()=>{window.history.replaceState({},document.title,window.location.pathname)}});else throw new Error("Invalid data format")}catch($){console.error("Failed to parse data from URL",$),_e({title:re("import_error_alert_title"),message:re("url_import_error")}),window.history.replaceState({},document.title,window.location.pathname)}};T()},[re,l,J,qr,ol]),G.useEffect(()=>{if(!p||!J)return;const T=l.find(W=>W.id===p);if(!T||!T.collaborators||T.collaborators.length===0)return;const k=T.collaborators.find(W=>W.role==="owner");if(!k)return;const O=k.userId;if(!O||O.startsWith("owner_")){console.warn(" Invalid owner UID:",k);return}const B=[],$=be(ue,"users",O,"folders",p),K=xr($,W=>{if(W.exists()){const ee=W.data();ee.collaborators&&u(c=>c.map(_=>_.id===p?{..._,collaborators:ee.collaborators}:_))}},W=>{console.warn("      (    ):",W.code)});B.push(K);const H=lt(ue,"users",O,"todos");console.log(" Syncing todos from owner:",{ownerUid:O,currentFolderId:p});const Y=xr(H,W=>{const ee=[];W.forEach(c=>{const _=c.data();_.folderId===p&&ee.push({id:parseInt(c.id),..._})}),console.log(" Owner todos received:",{count:ee.length,ownerTodos:ee}),r(c=>{const _=c.filter(F=>F.folderId!==p),y=c.filter(F=>F.folderId===p),w=[],D=new Set;return ee.forEach(F=>{w.push(F),D.add(F.id)}),y.forEach(F=>{D.has(F.id)||w.push(F)}),[..._,...w]})},W=>{console.error("   :",W),W.code==="permission-denied"?(console.warn("      -   "),we("    -    ")):W.code==="not-found"?(console.warn("     -    "),we("     ")):(console.warn("     "),we("   -   "))});return B.push(Y),()=>{B.forEach(W=>W())}},[p,J]),G.useEffect(()=>{var W,ee;if(!p||!J)return;const T=l.find(c=>c.id===p),k=((W=T==null?void 0:T.collaborationSettings)==null?void 0:W.enabled)||(T==null?void 0:T.isShared)||!1,O=((ee=T==null?void 0:T.collaborationSettings)==null?void 0:ee.showPresence)??!0;if(!k||!O){M([]);return}console.log("     :",{folderId:p,showPresence:O});const B=lt(ue,"folderPresence",p,"users"),$=be(B,J.uid);(async()=>{try{await yt($,{userId:J.uid,displayName:J.displayName||"Anonymous",photoURL:J.photoURL||null,isOnline:!0,lastSeen:new Date,currentFolder:p},{merge:!0}),console.log("    :",J.displayName)}catch(c){console.warn("presence set failed",c)}})();const H=setInterval(()=>{yt($,{lastSeen:new Date,isOnline:!0},{merge:!0}).catch(()=>{})},3e4),Y=xr(B,c=>{const y=c.docs.map(w=>{const D=w.data();return{userId:D.userId||w.id,displayName:D.displayName||"Anonymous",photoURL:D.photoURL||void 0,isOnline:!!D.isOnline,lastSeen:D.lastSeen?D.lastSeen.toDate?D.lastSeen.toDate():new Date(D.lastSeen):new Date,currentFolder:D.currentFolder}}).filter(w=>!!w.userId&&w.isOnline);M(y),console.log("   :",y.map(w=>w.displayName))},c=>console.warn("presence listen failed",c));return()=>{clearInterval(H),yt($,{isOnline:!1,lastSeen:new Date},{merge:!0}).catch(()=>{}),Y()}},[p,J,l]),G.useCallback(async T=>{var $,K;if(!p||!J)return;const k=l.find(H=>H.id===p),O=(($=k==null?void 0:k.collaborationSettings)==null?void 0:$.showEditingState)??!0;if(!(!((K=k==null?void 0:k.collaborationSettings)!=null&&K.enabled||k!=null&&k.isShared)||!O))try{const H=be(ue,"folderEditing",`${p}_${T}`);await yt(H,{todoId:T,userId:J.uid,userName:J.displayName||"Anonymous",startTime:new Date,folderId:p}),console.log("  :",{todoId:T,user:J.displayName})}catch(H){console.warn("start editing failed",H)}},[p,J,l]),G.useCallback(async T=>{var $,K;if(!p||!J)return;const k=l.find(H=>H.id===p),O=(($=k==null?void 0:k.collaborationSettings)==null?void 0:$.showEditingState)??!0;if(!(!((K=k==null?void 0:k.collaborationSettings)!=null&&K.enabled||k!=null&&k.isShared)||!O))try{const H=be(ue,"folderEditing",`${p}_${T}`);await zt(H),console.log("  :",{todoId:T,user:J.displayName})}catch(H){console.warn("stop editing failed",H)}},[p,J,l]),G.useEffect(()=>{var K,H;if(!p)return;const T=l.find(Y=>Y.id===p),k=((K=T==null?void 0:T.collaborationSettings)==null?void 0:K.showEditingState)??!0;if(!(((H=T==null?void 0:T.collaborationSettings)==null?void 0:H.enabled)||(T==null?void 0:T.isShared)||!1)||!k){b({});return}console.log("    :",{folderId:p});const B=zl(lt(ue,"folderEditing"),$l("folderId","==",p)),$=xr(B,Y=>{const W={};Y.docs.forEach(ee=>{const c=ee.data();c&&c.todoId&&(W[c.todoId]={todoId:c.todoId,userId:c.userId,userName:c.userName,startTime:c.startTime?c.startTime.toDate?c.startTime.toDate():new Date(c.startTime):new Date,folderId:c.folderId})}),b(W),console.log("   :",Object.keys(W).length+" ")},Y=>console.warn("editing states listen failed",Y));return()=>$()},[p,l]),G.useCallback(async T=>{var k,O;try{const B=T.ownerId||(J==null?void 0:J.uid);if(!B)throw new Error("No owner UID");const $=l.find(ee=>ee.id===p),K=((k=$==null?void 0:$.collaborationSettings)==null?void 0:k.enableConflictDetection)??!0,H=((O=$==null?void 0:$.collaborationSettings)==null?void 0:O.enabled)||($==null?void 0:$.isShared)||!1,Y=be(ue,"users",B,"todos",T.id.toString());if(H&&K){const ee=await pg(Y),c=ee.exists()?ee.data():null,_=(c==null?void 0:c.version)||0,y=T.version||0;if(c&&_>y&&(Ye(D=>[...D,{todoId:T.id,conflictType:"version_mismatch",localVersion:T,serverVersion:c,lastModifiedBy:c.lastModifiedBy||"unknown",lastModifiedAt:c.lastModified?c.lastModified.toDate?c.lastModified.toDate():new Date(c.lastModified):new Date}]),console.warn("  :",{todoId:T.id,localVersion:y,serverVersion:_,lastModifiedBy:c.lastModifiedBy}),!window.confirm("    . ? (  )")))return!1}const W=st({...T,version:(T.version||0)+1,lastModified:new Date,lastModifiedBy:(J==null?void 0:J.uid)||"unknown"});return W&&(await yt(Y,W),console.log(" Todo  :",{todoId:T.id,version:W.version})),!0}catch(B){return console.error("attemptSaveTodo failed",B),!1}},[J,p,l]),G.useEffect(()=>{const T=window.matchMedia("(prefers-color-scheme: dark)"),k=O=>{z==="system"&&q(O.matches)};return q(z==="system"?T.matches:z==="dark"),T.addEventListener("change",k),()=>T.removeEventListener("change",k)},[z]),G.useEffect(()=>{const T=()=>{console.log("  "),we("   "),setTimeout(()=>we(""),3e3)},k=()=>{console.log("   "),we("   -   "),setTimeout(()=>we(""),5e3)};return navigator.onLine||console.log("   "),window.addEventListener("online",T),window.addEventListener("offline",k),()=>{window.removeEventListener("online",T),window.removeEventListener("offline",k)}},[]),G.useEffect(()=>{const T=localStorage.getItem("pwa-prompt-dismissed"),k=Pp(),O=Xw();console.log("PWA Check:",{isMobileDevice:k,isInStandalone:O,isDismissed:T,userAgent:navigator.userAgent}),k&&!O&&!T&&(console.log("Showing PWA prompt immediately"),_c(!0))},[]),G.useEffect(()=>{"serviceWorker"in navigator&&navigator.serviceWorker.register("/Nova-AI-Planer/sw.js").then(T=>{console.log("SW registered: ",T),Xw()}).catch(T=>{console.log("SW registration failed: ",T)})},[]),G.useEffect(()=>{},[z,L]);const xi=G.useRef(null);G.useEffect(()=>{if(!(!Ei||!J))return xi.current&&clearTimeout(xi.current),xi.current=setTimeout(()=>{bs()},5e3),()=>{xi.current&&clearTimeout(xi.current)}},[n,l,t,z,L,x,vi,S,Ei,J]),G.useEffect(()=>{const T=yg.find(O=>O.id===x)||yg[0],k=L?T.darkThemeClass:T.lightThemeClass;document.body.className="",L&&document.body.classList.add("dark-mode"),k&&document.body.classList.add(k)},[x,L]),G.useEffect(()=>{if(xn){const T=setTimeout(()=>we(""),3e3);return()=>clearTimeout(T)}},[xn]);const Ci=G.useMemo(()=>{let T=[...n];return console.log("   :",{totalTodos:n.length,currentFolderId:p,filter:g,categoryFilter:I,sortType:V}),p===null?T=T.filter(k=>{if(k.isSharedTodo===!0)return!1;const O=l.find(B=>B.id===k.folderId);return O?O.isShared!==!0:!0}):p==="my-goals"?T=T.filter(k=>{const O=l.find(B=>B.id===k.folderId);return O?O.isShared!==!0:!0}):p==="all"?T=T:T=T.filter(k=>k.folderId===p),V==="deadline"?T.sort((k,O)=>!k.deadline&&!O.deadline?0:k.deadline?O.deadline?new Date(k.deadline).getTime()-new Date(O.deadline).getTime():-1:1):V==="newest"?T.sort((k,O)=>O.id-k.id):V==="alphabetical"&&T.sort((k,O)=>{const B=k.title||k.wish||"",$=O.title||O.wish||"";return B.localeCompare($)}),g==="active"&&(T=T.filter(k=>!k.completed)),g==="completed"&&(T=T.filter(k=>k.completed)),I!=="all"&&(T=T.filter(k=>(k.category||"other")===I)),console.log("   :",{finalCount:T.length,todos:T.map(k=>({id:k.id,wish:k.wish,folderId:k.folderId,completed:k.completed}))}),T},[n,g,V,I,p]),Ds=G.useCallback(()=>{const T=Date.now();al(T),Co&&clearTimeout(Co);const k=setTimeout(async()=>{if(console.log("    -    (  "+On/1e3+")"),!Ro&&J)try{console.log("   : activity-based "),await bs()}catch(O){console.error("   :",O)}},On);Df(k)},[Co,On,Ro,J]);G.useEffect(()=>{const T=l.find(O=>O.id===p),k=(T==null?void 0:T.isShared)&&(T==null?void 0:T.ownerId)&&(T==null?void 0:T.ownerId)!==(J==null?void 0:J.uid);Ze(k||!1),k?(ll("realtime"),Ii(!0),console.log("     ( )")):(ll("activity-based"),Ii(!1),console.log("     ( )"))},[p,l,J==null?void 0:J.uid]);const $r=T=>{const k={...T,id:Date.now(),createdAt:new Date().toISOString()};s(O=>[...O,k]),Uf(k)},Lf=T=>{s(k=>k.filter(O=>O.id!==T)),a(k=>k.filter(O=>O.assignmentId!==T))},Ff=(T,k)=>{s(O=>O.map(B=>B.id===T?{...B,...k}:B))},Uf=T=>{const k=new Date,O=new Date(T.dueDate),B=Math.max(1,Math.ceil((O.getTime()-k.getTime())/(1e3*60*60*24))),$=Math.ceil(T.estimatedMinutes/B),K=[];let H=T.estimatedMinutes;for(let Y=0;Y<B;Y++){const W=new Date;W.setDate(k.getDate()+Y);const ee=Math.min($,H);if(K.push({assignmentId:T.id,date:W.toISOString().split("T")[0],allocatedMinutes:ee,completed:!1}),H-=ee,H<=0)break}a(Y=>[...Y,...K])},qn=async(T,k,O)=>{try{const B=Gn();if(!B)return console.warn("AI instance not available"),null;const $=`  :
: ${T}
: ${k}
: ${O||" "}

  JSON :
{
  "estimatedMinutes": (, ),
  "difficulty": (1-5, ),
  "optimizedSchedule": "   ",
  "studyTips": " "
}`;console.log(" AI  ...");const H=(await B.models.generateContent({model:"gemini-2.5-flash",contents:$})).text.trim();console.log(" AI  :",H);const Y=H.match(/\{[\s\S]*\}/);return Y?JSON.parse(Y[0]):null}catch(B){return console.error("AI  :",B),null}},cl=()=>{const T=new Date().toISOString().split("T")[0];return o.filter(k=>k.date===T).map(k=>{const O=i.find(B=>B.id===k.assignmentId);return O?{...k,assignment:O}:null}).filter(Boolean)},dl=(T,k)=>{a(O=>O.map(B=>B.assignmentId===T&&B.date===k?{...B,completed:!B.completed}:B))},ko=()=>{const T=new Date;T.setHours(0,0,0,0);const O=[...i.filter($=>!$.completed)].sort(($,K)=>{if(!$.dueDate&&K.dueDate)return 1;if($.dueDate&&!K.dueDate)return-1;if(!$.dueDate&&!K.dueDate)return K.estimatedMinutes!==$.estimatedMinutes?K.estimatedMinutes-$.estimatedMinutes:K.difficulty-$.difficulty;const H=Math.ceil((new Date($.dueDate).getTime()-T.getTime())/(1e3*60*60*24)),Y=Math.ceil((new Date(K.dueDate).getTime()-T.getTime())/(1e3*60*60*24));return H!==Y?H-Y:K.estimatedMinutes!==$.estimatedMinutes?K.estimatedMinutes-$.estimatedMinutes:K.difficulty-$.difficulty}),B=[];O.forEach($=>{if(!$.dueDate)B.push({assignmentId:$.id,date:T.toISOString().split("T")[0],allocatedMinutes:$.estimatedMinutes,completed:!1});else{const K=new Date($.dueDate);K.setHours(0,0,0,0);const H=Math.max(1,Math.ceil((K.getTime()-T.getTime())/(1e3*60*60*24))),Y=Math.ceil($.estimatedMinutes/H);for(let W=0;W<H;W++){const ee=new Date(T);ee.setDate(T.getDate()+W);const c=ee.toISOString().split("T")[0];B.push({assignmentId:$.id,date:c,allocatedMinutes:Y,completed:!1})}}}),a(B)};G.useEffect(()=>{i.length>0&&ko(),(async()=>{if(J)try{const{doc:k,setDoc:O,serverTimestamp:B}=await Ri(async()=>{const{doc:W,setDoc:ee,serverTimestamp:c}=await Promise.resolve().then(()=>Mi);return{doc:W,setDoc:ee,serverTimestamp:c}},void 0),$=k(ue,"users",J.uid,"data","assignments"),K=i.map(W=>st(W)).filter(W=>W!==void 0),H={assignments:K,dailyAllocations:o,lastSyncTime:B(),totalAssignments:K.length,syncedAt:new Date().toISOString()},Y=st(H);Y&&(await O($,Y),console.log(" Assignments   :",{count:K.length}))}catch(k){console.error(" Assignments   :",k)}})()},[i,o,J]);const hl=async T=>{try{Ds();const k={...T,id:Date.now(),completed:!1,lastCompletedDate:null,streak:0,folderId:p==="all"||p===null?void 0:p};if(r(O=>[k,...O]),J){Xe(!0);try{const O=l.find(Y=>Y.id===p),B=(O==null?void 0:O.ownerId)||J.uid,$=lt(ue,"users",B,"todos"),K=be($,k.id.toString()),H=st(k);H?(await yt(K,H),console.log("  Firestore :",{targetOwnerUid:B,newTodo:H})):console.warn("     ")}catch(O){console.error("  Firestore  :",O)}finally{Xe(!1)}}he(!1)}catch(k){console.error("   :",k),Xe(!1)}},Ai=async T=>{try{const k=T.map((O,B)=>({...O,id:Date.now()+B,completed:!1,lastCompletedDate:null,streak:0,folderId:p||void 0})).reverse();if(J){Xe(!0);try{const O=l.find($=>$.id===p),B=(O==null?void 0:O.ownerId)||J.uid;for(const $ of k){const K=lt(ue,"users",B,"todos"),H=be(K,$.id.toString()),Y=st($);Y?await yt(H,Y):console.warn("     :",$.id)}console.log("   Firestore :",{targetOwnerUid:B,count:k.length})}catch(O){console.error("   Firestore  :",O)}finally{Xe(!1)}}r(O=>[...k,...O]),he(!1)}catch(k){console.error("    :",k),Xe(!1)}},jr=async T=>{try{if(Ds(),J){Xe(!0);try{const k=l.find(H=>H.id===T.folderId),O=(k==null?void 0:k.ownerId)||J.uid,B=lt(ue,"users",O,"todos"),$=be(B,T.id.toString()),K=st(T);K?(await yt($,K),console.log("   Firestore :",{targetOwnerUid:O,updatedTodo:K})):console.warn("     ")}catch(k){console.error("   Firestore  :",k)}finally{Xe(!1)}}r(n.map(k=>k.id===T.id?T:k)),Ce(null)}catch(k){console.error("   :",k),Xe(!1)}},fl=async T=>{Ds();const k=n.find(B=>B.id===T),O=n.filter(B=>B.id!==T);if(r(O),J&&k)try{const B=l.find(Y=>Y.id===k.folderId),$=(B==null?void 0:B.ownerId)||J.uid,K=lt(ue,"users",$,"todos"),H=be(K,T.toString());await zt(H),console.log("   Firestore :",{targetOwnerUid:$,id:T});try{const Y=be(ue,"users",$,"data","todos");await yt(Y,{todos:O,lastUpdated:new Date().toISOString()},{merge:!0}),console.log("     -  ")}catch(Y){console.warn("    :",Y)}Ei&&setTimeout(()=>{bs()},1e3)}catch(B){console.error("  Firestore  :",B),k&&r($=>[...$,k])}},pl=async T=>{var O;if(!T.trim()){_e({title:"Error",message:"Folder name cannot be empty."});return}const k={id:Date.now().toString(),name:T,ownerId:((O=qs.currentUser)==null?void 0:O.uid)||"unknown",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),color:"#3b82f6",collaborationSettings:{enabled:!1,showPresence:!0,showEditingState:!0,enableConflictDetection:!0,allowGuestView:!1,requireApproval:!0},isShared:!1};if(u([...l,k]),J)try{const{doc:B,setDoc:$}=await Ri(async()=>{const{doc:H,setDoc:Y}=await Promise.resolve().then(()=>Mi);return{doc:H,setDoc:Y}},void 0),K=B(ue,"users",J.uid,"folders",k.id);await $(K,{name:k.name,color:k.color,ownerId:k.ownerId,createdAt:k.createdAt,updatedAt:k.updatedAt,isShared:k.isShared,collaborators:[],collaborationSettings:k.collaborationSettings}),console.log("  Firebase  :",k.id)}catch(B){console.error("  Firebase  :",B)}return console.log("   :",{name:T,collaborationEnabled:!1}),k},et=G.useCallback(async(T,k)=>{try{if(u(O=>O.map(B=>{if(B.id===T){const $={...B.collaborationSettings,...k};return console.log("   :",{folderId:T,settings:$}),{...B,collaborationSettings:$,updatedAt:new Date().toISOString()}}return B})),J){const O=be(ue,"users",J.uid,"folders",T);await mg(O,{collaborationSettings:{...k},updatedAt:new Date().toISOString()})}}catch(O){console.error("   :",O)}},[J]),Of=G.useCallback(async(T,k)=>{await et(T,{enabled:k}),k?(u(O=>O.map(B=>B.id===T?{...B,isShared:!0}:B)),console.log("   :",T)):(M([]),b({}),console.log("   :",T))},[et]);G.useCallback(()=>{if(!p)return null;const T=l.find(k=>k.id===p);return(T==null?void 0:T.collaborationSettings)||null},[p,l]);const Bf=(T,k)=>{if(!k.trim()){_e({title:"Error",message:"Folder name cannot be empty."});return}u(l.map(O=>O.id===T?{...O,name:k,updatedAt:new Date().toISOString()}:O))},ml=async T=>{const k=l.find(B=>B.id===T);if(!k)return;const O=n.filter(B=>B.folderId===T);if(J&&O.length>0)try{for(const B of O){const $={...B};delete $.folderId;const K=k.ownerId||J.uid,H=lt(ue,"users",K,"todos"),Y=be(H,B.id.toString()),W=st($);W?(await yt(Y,W),console.log(`  ${B.id} Firebase   `)):console.warn(`  ${B.id}   `)}console.log("     Firebase  :",{count:O.length})}catch(B){console.error("      :",B)}if(J)try{const B=be(ue,"users",J.uid,"folders",T);await zt(B),console.log("  Firebase  :",T)}catch(B){console.error("  Firebase  :",B)}r(n.map(B=>{if(B.folderId===T){const $={...B};return delete $.folderId,$}return B})),u(l.filter(B=>B.id!==T)),p===T&&m(null)},gl=async T=>{if(!_t.trim()||!J){ae("");return}try{const k={...T,name:_t.trim(),updatedAt:new Date().toISOString()},O=be(ue,"users",J.uid,"folders",T.id),B=st(k);if(B)await yt(O,B),console.log("    Firestore  ");else throw new Error("   ");u(l.map($=>$.id===T.id?k:$)),ae(""),console.log("    :",_t.trim())}catch(k){console.error("    :",k),ae("")}},xc=async T=>{var k;if(!(!Je.trim()||!J||Re)){Ge(!0);try{if(((k=T.sharedWith)==null?void 0:k.some(Y=>Y.email===Je.trim()))||T.ownerEmail===Je.trim()){alert("  ."),Ge(!1);return}const B={email:Je.trim(),userId:"",role:Sn,addedAt:new Date().toISOString()},$={...T,sharedWith:[...T.sharedWith||[],B],updatedAt:new Date().toISOString()},K=be(ue,"users",J.uid,"folders",T.id),H=st($);if(H)await yt(K,H),console.log("   Firestore  ");else throw new Error("   ");u(l.map(Y=>Y.id===T.id?{...$,sharedWith:Array.isArray($.sharedWith)?$.sharedWith.filter(W=>W&&typeof W.role=="string"&&["owner","editor","viewer"].includes(W.role)).map(W=>({...W,role:W.role})):[]}:Y)),Tr(""),console.log("   :",B)}catch(O){console.error("   :",O)}finally{Ge(!1)}}},No=async(T,k,O)=>{var B;if(J)try{const $={...T,sharedWith:(B=T.sharedWith)==null?void 0:B.map(Y=>Y.userId===k?{...Y,role:O}:Y),updatedAt:new Date().toISOString()},K=be(ue,"users",J.uid,"folders",T.id),H=st($);if(H)await yt(K,H);else throw new Error("   ");u(l.map(Y=>Y.id===T.id?{...$,sharedWith:Array.isArray($.sharedWith)?$.sharedWith.filter(W=>W&&typeof W.role=="string"&&["owner","editor","viewer"].includes(W.role)).map(W=>({...W,role:W.role})):[]}:Y)),console.log("    :",{userId:k,newRole:O})}catch($){console.error("    :",$)}},Ir=async(T,k)=>{var O;if(J&&confirm("  ?"))try{const B={...T,sharedWith:(O=T.sharedWith)==null?void 0:O.filter(H=>H.userId!==k),updatedAt:new Date().toISOString()},$=be(ue,"users",J.uid,"folders",T.id),K=st(B);if(K)await yt($,K);else throw new Error("   ");u(l.map(H=>H.id===T.id?B:H)),console.log("   :",k)}catch(B){console.error("   :",B)}},Cc=T=>{const k=`${window.location.origin}${window.location.pathname}?invite=${T.id}`;navigator.clipboard.writeText(k).then(()=>{alert("  !")}).catch(()=>{alert("  .")})},Gf=T=>{confirm(re("folder_leave_confirm"))&&Ms(T)},Ms=async T=>{var k;if(J)try{const O={...T,sharedWith:(k=T.sharedWith)==null?void 0:k.filter(K=>K.userId!==J.uid),updatedAt:new Date().toISOString()},B=be(ue,"users",T.ownerId,"folders",T.id),$=st(O);if($)await yt(B,$);else throw new Error("   ");u(l.filter(K=>K.id!==T.id)),p===T.id&&m(null),Ot(!1),console.log("   ")}catch(O){console.error("   :",O)}},Ac=T=>{confirm(re("folder_delete_confirm"))&&(ml(T.id),Ot(!1))},_l=T=>{if(m(T),T&&J){const k=l.find(O=>O.id===T);k!=null&&k.ownerId&&(async()=>{try{console.log(" Firestore   :",{folderId:T,ownerUid:k.ownerId});const O=lt(ue,"users",k.ownerId,"todos"),B=zl(O,$l("folderId","==",T)),$=await Vi(B),K=[];$.forEach(H=>{K.push({id:parseInt(H.id),...H.data()})}),console.log("    :",{count:K.length,todos:K}),r(H=>{const Y=H.filter(_=>_.folderId!==T),W=new Set(Y.map(_=>_.id)),ee=K.filter(_=>!W.has(_.id)),c=[...Y,...ee];return console.log("   :",{:Y.length,:ee.length,:c.length,:K.length-ee.length}),c})}catch(O){console.error("    :",O)}})()}},bo=async()=>{if(!p||!J){we("   ");return}Xe(!0);try{console.log("    ...",p);const{doc:T,getDoc:k,collection:O,query:B,where:$,getDocs:K}=await Ri(async()=>{const{doc:D,getDoc:F,collection:X,query:me,where:Pe,getDocs:Ae}=await Promise.resolve().then(()=>Mi);return{doc:D,getDoc:F,collection:X,query:me,where:Pe,getDocs:Ae}},void 0);let H=l.find(D=>D.id===p);if(!H||!H.collaborators||H.collaborators.length===0){console.log("    , Firebase ...");const D=T(ue,"users",J.uid,"folders",p),F=await k(D);if(F.exists())H={id:p,...F.data()},console.log("   :",H);else{console.log("    ..."),_e({title:"    ",message:`   .
    .`,confirmText:"",onConfirm:()=>_e(null)}),Xe(!1);return}}if(!H||!H.collaborators||H.collaborators.length===0){_e({title:"   ",message:`   .
   .`,confirmText:"",onConfirm:()=>_e(null)}),Xe(!1);return}const Y=H.collaborators.find(D=>D.role==="owner");if(!Y||!Y.userId){_e({title:"   ",message:`   .
  .`,confirmText:"",onConfirm:()=>_e(null)}),Xe(!1);return}if(Y.userId.startsWith("owner_")){console.warn("   ID :",Y.userId),_e({title:"   ",message:`    .
     .`,confirmText:"",onConfirm:()=>_e(null)}),Xe(!1);return}console.log("   :",{folderId:p,ownerUid:Y.userId});const W=n.filter(D=>D.folderId===p);console.log("    :",W.length);const ee=O(ue,"users",Y.userId,"todos"),c=B(ee,$("folderId","==",p)),_=await K(c),y=[];_.forEach(D=>{y.push({id:parseInt(D.id),...D.data()})}),console.log("   :",y.length),W.length===y.length?(console.log("     "),we(`    (${y.length}  -   )`)):(console.log("     :",{local:W.length,server:y.length}),r(D=>[...D.filter(me=>me.folderId!==p),...y]),we(`   (${y.length}  - ${Math.abs(y.length-W.length)}  )`)),console.log("   :",p&&J?"":"")}catch(T){console.error("  :",T),T instanceof Error?T.message.includes("permission-denied")?we("  :    "):T.message.includes("not-found")?we("  :    "):we("  : "+T.message):we("  :    ")}finally{Xe(!1)}},Rc=async()=>{Xe(!0);try{console.log("   ..."),await bs(),we("   "),console.log("   ")}catch(T){console.error("   :",T),we("  ")}finally{Xe(!1)}},Do=async(T,k)=>{const O=n.find(H=>H.id===T);if(!O)return;const B=l.find(H=>H.id===k),$=(B==null?void 0:B.isShared)===!0,K={...O,folderId:k||void 0,isSharedTodo:$};if(!O.wish&&!O.outcome&&!O.obstacle&&!O.plan&&(delete K.wish,delete K.outcome,delete K.obstacle,delete K.plan),J)try{const H=l.find(_=>_.id===(k||O.folderId)),Y=(H==null?void 0:H.ownerId)||J.uid,W=lt(ue,"users",Y,"todos"),ee=be(W,T.toString()),c=st(K);c?(await yt(ee,c),console.log("    Firestore :",{targetOwnerUid:Y,goalId:T,folderId:k,isSharedTodo:K.isSharedTodo})):console.warn("     ")}catch(H){console.error("    Firestore  :",H)}r(n.map(H=>H.id===T?K:H)),we("   "),setTimeout(()=>we(""),3e3)},Pc=async T=>{Ds();const k=new Date().toISOString(),O=(()=>{const B=n.find(H=>H.id===T);if(!B)return null;const $=!B.completed;let K=B.streak;return B.isRecurring&&($?(!B.lastCompletedDate||!hu(k,B.lastCompletedDate))&&(K=(B.streak||0)+1):B.lastCompletedDate&&hu(k,B.lastCompletedDate)&&(K=Math.max(0,(B.streak||1)-1))),{...B,completed:$,lastCompletedDate:$?k:B.lastCompletedDate,streak:K}})();if(O){if(J)try{const B=l.find(W=>W.id===O.folderId),$=(B==null?void 0:B.ownerId)||J.uid,K=lt(ue,"users",$,"todos"),H=be(K,T.toString()),Y=st(O);Y?(await yt(H,Y),console.log("    Firestore :",{targetOwnerUid:$,id:T,completed:O.completed})):console.warn("     ")}catch(B){console.error("    Firestore  :",B)}r(n.map(B=>B.id===T?O:B))}},kc=async T=>{if(T==="ai"){if(n.length<2){_e({title:re("sort_alert_title"),message:re("sort_alert_message")});return}Fn(!0);try{const k=Gn();if(!k){we(Ti?"  AI    .":"AI    API  ."),Fn(!1),C("manual");return}const O=`Here is a list of goals with their details (wish, outcome, obstacle, plan, deadline). Prioritize them based on urgency (closer deadline), importance (based on outcome), and feasibility (based on plan). Return a JSON object with "sorted_ids" array and "reasoning" string explaining your prioritization logic. Goals: ${JSON.stringify(n.map(({id:c,wish:_,outcome:y,obstacle:w,plan:D,deadline:F})=>({id:c,wish:_,outcome:y,obstacle:w,plan:D,deadline:F})))}`,B=await k.models.generateContent({model:"gemini-2.5-flash",contents:O,config:{responseMimeType:"application/json",responseSchema:{type:Wn.OBJECT,properties:{sorted_ids:{type:Wn.ARRAY,items:{type:Wn.NUMBER}},reasoning:{type:Wn.STRING}}}}}),$=JSON.parse(B.text),K=$.sorted_ids.map(Number),H=new Map(n.map(c=>[Number(c.id),c])),Y=K.map(c=>H.get(c)).filter(Boolean),W=n.filter(c=>!K.includes(Number(c.id))),ee=[...Y,...W].map(c=>({...c,id:Number(c.id)}));r(ee),C("manual"),gc($.reasoning||""),Br(!0)}catch(k){console.error("AI sort failed:",k),_e({title:re("ai_sort_error_title"),message:re("ai_sort_error_message")})}finally{Fn(!1)}}else C(T)},Vs=T=>{const k=new Set(Er);k.has(T)?k.delete(T):k.add(T),Un(k)},yl=()=>{Ur(!1),Un(new Set)},Nc=()=>{const T=new Set(Ci.map(k=>k.id));Un(T)},vl=()=>{const T=Er.size;_e({title:re("delete_selected_confirm_title"),message:re("delete_selected_confirm_message").replace("{count}",String(T)),isDestructive:!0,confirmText:re("delete_selected_button_label").replace("{count}",String(T)),cancelText:re("cancel_button"),onConfirm:()=>{r(n.filter(k=>!Er.has(k.id))),yl()}})},Tl=()=>{rr("exporting");const T=JSON.stringify(n,null,2),k="data:application/json;charset=utf-8,"+encodeURIComponent(T),O="nova_goals.json",B=document.createElement("a");B.setAttribute("href",k),B.setAttribute("download",O),B.click(),setTimeout(()=>{rr("idle"),gn(!1)},1500)},bc=T=>{var B;const k=(B=T.target.files)==null?void 0:B[0];if(!k)return;const O=new FileReader;O.onload=$=>{var K;try{const H=(K=$.target)==null?void 0:K.result;if(typeof H!="string")throw new Error("File content is not a string");const Y=JSON.parse(H);if(Array.isArray(Y)&&Y.every(W=>"wish"in W&&"id"in W))_e({title:re("import_confirm_title"),message:re("import_confirm_message"),confirmText:re("settings_import_data"),cancelText:re("cancel_button"),onConfirm:()=>{rr("importing"),setTimeout(()=>{r(Y),we(re("import_success_toast")),rr("idle"),gn(!1)},1500)}});else throw new Error("Invalid file format")}catch{_e({title:re("import_error_alert_title"),message:re("import_error_alert_message")})}},O.onerror=()=>_e({title:re("import_error_alert_title"),message:re("import_error_alert_message")}),O.readAsText(k),T.target.value=""},Mo=()=>{_e({title:"   ",message:`   ?

    :

   
 Firebase  
  
   
   `,confirmText:"",cancelText:"",isDestructive:!0,onConfirm:()=>{_e(null),Dc()},onCancel:()=>{_e(null)}})},Dc=async()=>{console.log(" performDeleteAllData  "),rr("deleting");try{if(J){console.log("  :",{uid:J.uid,email:J.email}),console.log(" Firebase   ...");try{const W=be(ue,"users",J.uid,"data","todos");await zt(W),console.log("  todos   ")}catch(W){console.warn("  todos   :",W)}try{const W=be(ue,"users",J.uid,"data","settings");await zt(W),console.log("  settings   ")}catch(W){console.warn("  settings   :",W)}const T=lt(ue,"users",J.uid,"todos"),k=await Vi(T);console.log("  todos :",k.size);const O=k.docs.map(W=>zt(W.ref));await Promise.all(O),console.log("  todos  :",k.size,"");const B=lt(ue,"users",J.uid,"folders"),$=await Vi(B);console.log("  folders :",$.size);const K=$.docs.map(W=>zt(W.ref));await Promise.all(K),console.log(" folders  :",$.size,"");const H=lt(ue,"sharedFolders"),Y=await Vi(H);for(const W of Y.docs){const ee=W.data();if(ee.collaborators&&Array.isArray(ee.collaborators)){const c=ee.collaborators.filter(_=>_.userId!==J.uid);c.length!==ee.collaborators.length&&(await mg(W.ref,{collaborators:c}),console.log("     :",W.id))}}try{for(const W of l)if(W.id){const ee=be(ue,"folderPresence",W.id,"users",J.uid);await zt(ee)}console.log(" presence   ")}catch(W){console.warn(" presence     :",W)}try{const W=zl(lt(ue,"folderEditing"),$l("userId","==",J.uid)),c=(await Vi(W)).docs.map(_=>zt(_.ref));await Promise.all(c),console.log(" editing states  ")}catch(W){console.warn(" editing states    :",W)}try{const W=be(ue,"users",J.uid);await zt(W),console.log("     ")}catch(W){console.warn("     :",W)}try{const W=lt(ue,"notifications",J.uid,"items"),c=(await Vi(W)).docs.map(y=>zt(y.ref));await Promise.all(c);const _=be(ue,"notifications",J.uid);await zt(_),console.log("    ")}catch(W){console.warn("      :",W)}try{const W=lt(ue,"userActivity",J.uid,"logs"),c=(await Vi(W)).docs.map(y=>zt(y.ref));await Promise.all(c);const _=be(ue,"userActivity",J.uid);await zt(_),console.log("     ")}catch(W){console.warn("       :",W)}try{const W=be(ue,"userMetadata",J.uid);await zt(W),console.log("    ")}catch(W){console.warn("      :",W)}try{const W=be(ue,"userSessions",J.uid);await zt(W),console.log("     ")}catch(W){console.warn("       :",W)}console.log("      -    ")}console.log("    ..."),r([]),u([]),M([]),b({}),Ye([]),m(null),Un(new Set),Ur(!1),v("all"),P("all"),console.log("   ..."),e("ko"),q(!0),R("default"),C("manual"),A(["school","work","personal","other"]),wr(""),sl(!1),wi(!0),console.log(" localStorage  ...");try{const T=Object.keys(localStorage);console.log("  localStorage :",T),T.forEach(k=>{localStorage.removeItem(k),console.log(`  : ${k}`)}),localStorage.clear(),sessionStorage.clear(),console.log(" localStorage  sessionStorage   ")}catch(T){console.error(" localStorage   :",T)}if(J){console.log(" Firebase  ...");try{await vE(qs),console.log(" Firebase  ")}catch(T){console.warn("   :",T)}}console.log("   ..."),Rs(null),So(!1),Ps(!1),Xe(!1),Ns(!1),console.log("    "),we("    .    ."),gn(!1),setTimeout(()=>{console.log("    ..."),window.location.reload()},2500)}catch(T){console.error("    :",T);let k="  ",O="    .";T instanceof Error&&(T.message.includes("permission-denied")||T.message.includes("insufficient permissions")?(k="  ",O=`  .

   .
(Firebase      )`):T.message.includes("network-request-failed")?(k="  ",O="    ."):T.message.includes("unauthenticated")?(k="  ",O=` .
 .`):O=`    .

 : `+T.message),_e({title:k,message:O,confirmText:"",onConfirm:()=>_e(null)}),rr("idle")}},Vo=Z||!!fe||!!qe||nr||!!Et||Or||rt;return G.useEffect(()=>{if(Pp()&&Vo)return document.body.classList.add("modal-open"),()=>{document.body.classList.remove("modal-open")};document.body.classList.remove("modal-open")},[Vo]),h.jsxs("div",{className:`main-page-layout ${Qe?"calendar-view-active":""}`,children:[h.jsxs("div",{className:`page-content ${Vo?"modal-open":""}`,children:[h.jsx(D6,{folders:l,currentFolderId:p,onSetCurrentFolder:_l,onCreateFolder:pl,onRenameFolder:Bf,onDeleteFolder:ml,onSetCollaboratingFolder:il,todos:n,t:re,onManageFolder:T=>{er(T),Ot(!0)},currentUserId:J==null?void 0:J.uid}),h.jsxs("div",{className:"content-with-sidebar",children:[h.jsx(V6,{t:re,isSelectionMode:gi,selectedCount:Er.size,totalVisibleCount:Ci.length,onCancelSelection:yl,onDeleteSelected:vl,onSelectAll:Nc,onSetSelectionMode:()=>Ur(!0),isViewModeCalendar:Qe,onToggleViewMode:()=>xs(!Qe),isAiSorting:an,sortType:V,onSort:kc,filter:g,onFilter:v,onOpenSettings:()=>gn(!0),onAddGoal:()=>he(!0),currentFolderId:p,folders:l,onSyncSharedFolder:bo,isSyncing:ks,isSyncingData:ks,onManualSync:Rc,activeUsers:N,onToggleCollaboration:Of,onUpdateCollaborationSettings:et,categoryFilter:I,onCategoryFilter:P,userCategories:S,onAddCategory:T=>A([...S,T]),onRemoveCategory:T=>A(S.filter(k=>k!==T))}),h.jsxs("div",{className:"container",children:[h.jsx(M6,{t:re,categoryFilter:I,onCategoryFilter:P,userCategories:S,onAddCategory:T=>A([...S,T]),onRemoveCategory:T=>A(S.filter(k=>k!==T))}),cl().length>0&&h.jsxs("div",{className:"today-assignments",style:{marginBottom:"24px",padding:"20px",backgroundColor:"var(--bg-secondary-color)",borderRadius:"16px",border:"1px solid var(--border-color)"},children:[h.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:h.jsxs("h3",{style:{margin:0,fontSize:"1.2rem",fontWeight:"600"},children:[" ",re("today_schedule")]})}),(()=>{const T=cl(),k=T.filter($=>$.completed).length,O=T.length,B=O>0?Math.round(k/O*100):0;return h.jsxs("div",{style:{marginBottom:"16px"},children:[h.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[h.jsx("span",{style:{fontSize:"0.9rem",color:"var(--text-secondary-color)"},children:""}),h.jsxs("span",{style:{fontSize:"1rem",fontWeight:"600",color:B===100?"#4CAF50":"var(--primary-color)"},children:[B,"% (",k,"/",O,")"]})]}),h.jsx("div",{style:{width:"100%",height:"8px",backgroundColor:"var(--border-color)",borderRadius:"4px",overflow:"hidden"},children:h.jsx("div",{style:{width:`${B}%`,height:"100%",backgroundColor:B===100?"#4CAF50":"var(--primary-color)",transition:"width 0.3s ease",borderRadius:"4px"}})})]})})(),h.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:cl().map(T=>h.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",padding:"12px 16px",backgroundColor:"var(--card-bg-color, rgba(255, 255, 255, 0.05))",borderRadius:"12px",border:"1px solid var(--border-color)",opacity:T.completed?.6:1},children:[h.jsxs("label",{className:"checkbox-container",children:[h.jsx("input",{type:"checkbox",checked:T.completed,onChange:()=>dl(T.assignmentId,T.date)}),h.jsx("span",{className:"checkmark"})]}),h.jsxs("div",{style:{flex:1},children:[h.jsxs("div",{style:{fontWeight:"500",textDecoration:T.completed?"line-through":"none"},children:[T.assignment.name," (",T.assignment.subject,")"]}),h.jsxs("div",{style:{fontSize:"0.85rem",color:"var(--text-secondary-color)",marginTop:"4px"},children:[re("auto_allocated"),": ",T.allocatedMinutes,re("minutes"),"  ",re("difficulty_level"),T.assignment.difficulty]})]}),h.jsxs("div",{style:{fontSize:"0.8rem",color:"var(--text-secondary-color)"},children:[Math.ceil((new Date(T.assignment.dueDate).getTime()-new Date().getTime())/(1e3*60*60*24)),re("days_left")]})]},`${T.assignmentId}-${T.date}`))})]}),Qe?h.jsx(H6,{todos:n,t:re,onGoalClick:on,language:t}):h.jsxs(h.Fragment,{children:[h.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"20px",borderBottom:"1px solid var(--border-color)",padding:"0 4px"},children:[h.jsx("button",{onClick:()=>Si("todos"),style:{padding:"12px 24px",border:"none",background:Bn==="todos"?"var(--primary-color)":"transparent",color:Bn==="todos"?"white":"var(--text-color)",borderRadius:"8px 8px 0 0",cursor:"pointer",fontSize:"15px",fontWeight:"600",transition:"all 0.2s",borderBottom:Bn==="todos"?"3px solid var(--primary-color)":"3px solid transparent",marginBottom:"-1px"},children:" "}),h.jsx("button",{onClick:()=>Si("assignments"),style:{padding:"12px 24px",border:"none",background:Bn==="assignments"?"var(--primary-color)":"transparent",color:Bn==="assignments"?"white":"var(--text-color)",borderRadius:"8px 8px 0 0",cursor:"pointer",fontSize:"15px",fontWeight:"600",transition:"all 0.2s",borderBottom:Bn==="assignments"?"3px solid var(--primary-color)":"3px solid transparent",marginBottom:"-1px"},children:"  "})]}),Bn==="todos"?h.jsxs("div",{className:"goals-split-layout",children:[h.jsx("div",{className:"woop-section",children:h.jsx(P6,{todos:Ci,onEditTodo:Ce,t:re})}),h.jsxs("div",{className:"todos-section",children:[Ci.length>0&&h.jsx("div",{className:"section-title",style:{fontSize:"18px",fontWeight:"600",marginBottom:"16px",color:"var(--text-color)",borderBottom:"2px solid var(--primary-color)",paddingBottom:"8px",display:"inline-block",position:"relative"},children:""}),h.jsx(L6,{todos:Ci,onToggleComplete:Pc,onDelete:fl,onEdit:Ce,onInfo:on,t:re,filter:g,randomEncouragement:Sc,isSelectionMode:gi,selectedTodoIds:Er,onSelectTodo:Vs,folders:l,onMoveToFolder:Do})]})]}):h.jsxs("div",{className:"assignments-view",children:[h.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[h.jsx("h2",{style:{margin:0,fontSize:"20px",fontWeight:"600"},children:"  "}),h.jsx("button",{onClick:()=>{At(!0)},style:{padding:"10px 20px",backgroundColor:"var(--primary-color)",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"600",display:"flex",alignItems:"center",gap:"6px"},children:"   "})]}),i.length===0?h.jsxs("div",{style:{textAlign:"center",padding:"60px 20px",color:"var(--text-secondary-color)"},children:[h.jsx("div",{style:{fontSize:"48px",marginBottom:"16px"},children:""}),h.jsx("h3",{style:{margin:"0 0 8px 0",fontSize:"18px"},children:"  "}),h.jsx("p",{style:{margin:0,fontSize:"14px"},children:'"  "    '})]}):h.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:i.map(T=>h.jsxs("div",{style:{padding:"16px",backgroundColor:"var(--bg-secondary-color)",borderRadius:"12px",border:"1px solid var(--border-color)",display:"flex",flexDirection:"column",gap:"12px"},children:[h.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[h.jsxs("div",{style:{flex:1},children:[h.jsx("div",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"4px",color:"var(--text-color)"},children:T.name}),h.jsxs("div",{style:{fontSize:"13px",color:"var(--text-secondary-color)",marginBottom:"8px"},children:[" ",T.subject]}),T.dueDate&&h.jsxs("div",{style:{fontSize:"13px",color:"var(--text-secondary-color)"},children:[" : ",T.dueDate]})]}),h.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",gap:"4px"},children:[h.jsxs("span",{style:{padding:"4px 12px",backgroundColor:"var(--primary-color)",color:"white",borderRadius:"16px",fontSize:"13px",fontWeight:"600"},children:[" ",T.estimatedMinutes,""]}),h.jsxs("span",{style:{fontSize:"13px",color:"var(--text-secondary-color)"},children:[": ","".repeat(T.difficulty)]})]})]}),h.jsxs("div",{style:{display:"flex",gap:"8px"},children:[h.jsx("button",{onClick:()=>{Dt(T)},style:{flex:1,padding:"10px",backgroundColor:"var(--bg-color)",color:"var(--text-color)",border:"1px solid var(--border-color)",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"600",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},children:" "}),h.jsx("button",{onClick:()=>{window.confirm(`"${T.name}"  ?`)&&Lf(T.id)},style:{flex:1,padding:"10px",backgroundColor:"#ff4444",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"600",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},children:" "})]})]},T.id))})]})]})]})]}),Pp()&&!Qe&&h.jsx("button",{onClick:()=>he(!0),className:"mobile-fab-button","aria-label":re("add_new_goal_button_label"),title:re("add_new_goal_button_label"),children:Ie.add})]}),Z&&h.jsx(Np,{onClose:()=>he(!1),onAddTodo:hl,onAddMultipleTodos:Ai,onAddAssignment:$r,analyzeAssignmentWithAI:qn,t:re,language:t,createAI:Gn,userCategories:S}),fe&&gg(fe)&&h.jsx(Np,{onClose:()=>Ce(null),onEditTodo:jr,existingTodo:fe,t:re,language:t,createAI:Gn}),fe&&!gg(fe)&&h.jsx(W6,{todo:fe,onClose:()=>Ce(null),onSave:jr,t:re}),qe&&h.jsx(G6,{todo:qe,onClose:()=>on(null),t:re,createAI:Gn,onDeleteGoal:T=>{on(null),fl(T)},userCategories:S,onUpdateGoal:jr,onToggleComplete:T=>{on(null),Pc(T)}}),Le&&h.jsx(Np,{onClose:()=>At(!1),onAddTodo:hl,onAddMultipleTodos:Ai,onAddAssignment:$r,analyzeAssignmentWithAI:qn,t:re,language:t,createAI:Gn,userCategories:S,initialMode:"assignment"}),Oe&&h.jsx(B6,{assignment:Oe,onClose:()=>Dt(null),onSave:Ff,t:re,analyzeAssignmentWithAI:qn}),As!==void 0&&h.jsx(q6,{folder:As,onClose:()=>il(void 0),t:re,googleUser:J,onUpdateCollaborators:Mf,setAlertConfig:_e}),nr&&h.jsx(z6,{onClose:()=>gn(!1),isDarkMode:L,onToggleDarkMode:()=>q(!L),themeMode:z,onThemeChange:zr,backgroundTheme:x,onSetBackgroundTheme:R,onExportData:Tl,onImportData:bc,setAlertConfig:_e,onDeleteAllData:Mo,dataActionStatus:Cn,language:t,onSetLanguage:e,t:re,todos:n,setToastMessage:we,onOpenVersionInfo:()=>le(!0),onOpenUsageGuide:()=>_i(!0),apiKey:vi,onSetApiKey:wr,isOfflineMode:Ti,onToggleOfflineMode:()=>sl(!Ti),googleUser:J,onGoogleLogin:qr,onGoogleLogout:Ic,onSyncDataToFirebase:bs,onLoadDataFromFirebase:Vf,isGoogleLoggingIn:Tc,isGoogleLoggingOut:xo,isSyncingData:ks,isLoadingData:Gr,isAutoSyncEnabled:Ei,setIsAutoSyncEnabled:wi,notificationPermission:Rf,setNotificationPermission:ir}),Or&&h.jsx($6,{onClose:()=>le(!1),t:re}),rt&&h.jsx(j6,{onClose:()=>_i(!1),t:re}),Cs&&h.jsx(mi,{onClose:()=>Br(!1),isClosing:!1,className:"ai-sort-reason-modal",children:h.jsxs("div",{style:{padding:"24px"},children:[h.jsx("h2",{style:{marginBottom:"16px",fontSize:"1.3rem",fontWeight:600},children:re("ai_sort_reason_modal_title")}),h.jsx("div",{style:{marginBottom:"24px",padding:"16px",backgroundColor:"var(--card-bg-color)",borderRadius:"8px",border:"1px solid var(--border-color)",lineHeight:"1.6",color:"var(--text-secondary-color)"},children:Bt}),h.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:h.jsx("button",{onClick:()=>Br(!1),className:"primary",children:re("close_button")})})]})}),Et&&h.jsx(K6,{title:Et.title,message:Et.message,onConfirm:()=>{var T;(T=Et.onConfirm)==null||T.call(Et),_e(null)},onCancel:Et.onCancel?()=>{var T;(T=Et.onCancel)==null||T.call(Et),_e(null)}:void 0,confirmText:Et.confirmText,cancelText:Et.cancelText,isDestructive:Et.isDestructive,t:re}),xn&&h.jsx("div",{className:"toast-notification",children:xn}),yi&&h.jsx(R6,{onClose:()=>_c(!1)}),Ut&&In&&h.jsx("div",{className:"modal-backdrop",onClick:()=>Ot(!1),children:h.jsxs("div",{className:"modal-content large-modal",onClick:T=>T.stopPropagation(),children:[h.jsxs("div",{className:"modal-header",children:[h.jsx("h3",{children:re("folder_manage_title")}),h.jsx("button",{onClick:()=>Ot(!1),children:""})]}),h.jsx("div",{className:"modal-body",children:(()=>{var B,$,K;const T=l.find(H=>H.id===In);if(!T)return null;const k=T.ownerId===(J==null?void 0:J.uid),O=k?"owner":(($=(B=T.sharedWith)==null?void 0:B.find(H=>H.userId===(J==null?void 0:J.uid)))==null?void 0:$.role)||"viewer";return h.jsxs("div",{className:"folder-manage-content",children:[h.jsxs("div",{className:"folder-info-section",children:[h.jsx("h4",{children:re("folder_manage_info")}),h.jsxs("div",{className:"folder-info-item",children:[h.jsxs("label",{children:[re("folder_name"),":"]}),_t?h.jsxs("div",{className:"inline-edit",children:[h.jsx("input",{type:"text",value:_t,onChange:H=>ae(H.target.value),onKeyPress:H=>{H.key==="Enter"&&gl(T)}}),h.jsx("button",{onClick:()=>gl(T),children:""}),h.jsx("button",{onClick:()=>ae(""),children:""})]}):h.jsxs("div",{className:"folder-name-display",children:[h.jsx("span",{children:T.name}),k&&h.jsx("button",{className:"edit-btn",onClick:()=>ae(T.name),children:""})]})]}),h.jsxs("div",{className:"folder-info-item",children:[h.jsxs("label",{children:[re("folder_owner"),":"]}),h.jsx("span",{children:T.ownerEmail||T.ownerId})]}),h.jsxs("div",{className:"folder-info-item",children:[h.jsxs("label",{children:[re("role"),":"]}),h.jsx("span",{children:re(O==="owner"?"folder_role_owner":O==="editor"?"folder_role_editor":"folder_role_viewer")})]}),h.jsxs("div",{className:"folder-info-item",children:[h.jsxs("label",{children:[re("created_date"),":"]}),h.jsx("span",{children:new Date(T.createdAt).toLocaleDateString()})]})]}),h.jsxs("div",{className:"collaborators-section",children:[h.jsx("h4",{children:re("folder_manage_collaborators")}),h.jsxs("div",{className:"collaborator-list",children:[h.jsx("div",{className:"collaborator-item owner",children:h.jsxs("div",{className:"collaborator-info",children:[h.jsx("span",{className:"email",children:T.ownerEmail||T.ownerId}),h.jsx("span",{className:"role owner-role",children:re("folder_role_owner")})]})}),((K=T.sharedWith)==null?void 0:K.map((H,Y)=>h.jsxs("div",{className:"collaborator-item",children:[h.jsxs("div",{className:"collaborator-info",children:[h.jsx("span",{className:"email",children:H.email||H.userId}),h.jsx("span",{className:`role ${H.role}`,children:H.role==="editor"?re("folder_role_editor"):re("folder_role_viewer")})]}),k&&h.jsxs("div",{className:"collaborator-actions",children:[h.jsxs("select",{value:H.role,onChange:W=>No(T,H.userId,W.target.value),children:[h.jsx("option",{value:"editor",children:re("folder_role_editor")}),h.jsx("option",{value:"viewer",children:re("folder_role_viewer")})]}),h.jsx("button",{className:"remove-btn",onClick:()=>Ir(T,H.userId),children:""})]})]},Y)))||[]]}),(k||O==="editor")&&h.jsxs("div",{className:"invite-section",children:[h.jsx("h5",{children:re("folder_invite_new")}),h.jsxs("div",{className:"invite-form",children:[h.jsx("input",{type:"email",placeholder:re("folder_invite_email"),value:Je,onChange:H=>Tr(H.target.value)}),h.jsxs("select",{value:Sn,onChange:H=>tr(H.target.value),children:[h.jsx("option",{value:"editor",children:re("folder_role_editor")}),h.jsx("option",{value:"viewer",children:re("folder_role_viewer")})]}),h.jsx("button",{onClick:()=>xc(T),disabled:!Je||Re,children:Re?" ...":re("folder_invite_button")})]})]})]}),h.jsxs("div",{className:"folder-settings-section",children:[h.jsx("h4",{children:re("folder_manage_settings")}),h.jsxs("div",{className:"share-link-section",children:[h.jsx("label",{children:re("folder_share_link")}),h.jsx("p",{className:"share-link-desc",children:re("folder_share_link_desc")}),h.jsxs("div",{className:"share-link-input",children:[h.jsx("input",{type:"text",readOnly:!0,value:`${window.location.origin}${window.location.pathname}?invite=${T.id}`}),h.jsx("button",{onClick:()=>Cc(T),children:re("folder_copy_link")})]})]}),h.jsxs("div",{className:"folder-actions",children:[!k&&h.jsx("button",{className:"leave-folder-btn",onClick:()=>Gf(T),children:re("folder_leave")}),k&&h.jsx("button",{className:"delete-folder-btn",onClick:()=>Ac(T),children:re("folder_delete")})]})]})]})})()})]})})]})},D6=({folders:t,currentFolderId:e,onSetCurrentFolder:n,onCreateFolder:r,onRenameFolder:i,onDeleteFolder:s,onSetCollaboratingFolder:o,todos:a,t:l,onManageFolder:u,currentUserId:p})=>{var z;const[m,g]=G.useState(!1),[v,I]=G.useState(""),[P,V]=G.useState(null),[C,S]=G.useState(""),[A,L]=G.useState(null),q=()=>{v.trim()&&(r(v),I(""),g(!1))};return h.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid var(--border-color)",overflowX:"auto",display:"flex",gap:"8px",alignItems:"center",backgroundColor:"var(--card-bg-color)"},children:[h.jsxs("button",{onClick:()=>n("my-goals"),style:{padding:"6px 12px",borderRadius:"8px",border:"none",backgroundColor:e==="my-goals"?"var(--primary-color)":"transparent",color:e==="my-goals"?"white":"var(--text-color)",cursor:"pointer",fontSize:"0.9rem",fontWeight:500,whiteSpace:"nowrap",transition:"all 0.2s",minWidth:"80px",textAlign:"center"},children:[" ",l("all_goals_label")||"All"]}),h.jsx("button",{onClick:()=>n("all"),style:{padding:"6px 12px",borderRadius:"8px",border:"none",backgroundColor:e==="all"?"#ff6b6b":"transparent",color:e==="all"?"white":"var(--text-color)",cursor:"pointer",fontSize:"0.9rem",fontWeight:500,whiteSpace:"nowrap",transition:"all 0.2s",minWidth:"80px",textAlign:"center"},children:l("all_goals_button")}),t.length>0&&t.filter(E=>e===null?!E.isShared||E.isShared&&E.ownerId===p:!0).map(E=>{const x=a.filter(R=>R.folderId===E.id).length;return h.jsxs("div",{style:{position:"relative",display:"inline-flex",alignItems:"center",gap:"2px"},children:[h.jsxs("button",{onClick:()=>n(E.id),style:{padding:"6px 12px",borderRadius:"8px",border:"none",backgroundColor:e===E.id?E.color||"var(--primary-color)":`${E.color}20`||"transparent",color:e===E.id?"white":"var(--text-color)",cursor:"pointer",fontSize:"0.9rem",fontWeight:500,whiteSpace:"nowrap",transition:"all 0.2s",position:"relative"},title:E.isShared?" ":" ",children:[E.isShared?"":""," ",E.name," (",x,")"]}),e===E.id&&h.jsxs("div",{style:{display:"flex",gap:"2px"},children:[h.jsx("button",{onClick:()=>o(E),style:{width:"24px",height:"24px",padding:"0",borderRadius:"4px",border:"none",backgroundColor:"var(--primary-color)",color:"white",cursor:"pointer",fontSize:"0.8rem",lineHeight:"1",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s"},title:" ",children:""}),h.jsx("button",{onClick:()=>u(E.id),style:{width:"24px",height:"24px",padding:"0",borderRadius:"4px",border:"none",backgroundColor:"var(--button-bg-color)",color:"var(--text-color)",cursor:"pointer",fontSize:"0.8rem",lineHeight:"1",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s"},title:" ",children:""}),h.jsx("button",{onClick:()=>{V(E.id),S(E.name)},style:{width:"24px",height:"24px",padding:"0",borderRadius:"4px",border:"none",backgroundColor:"var(--button-bg-color)",color:"var(--text-color)",cursor:"pointer",fontSize:"0.8rem",lineHeight:"1",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s"},title:"  ",children:""}),h.jsx("button",{onClick:()=>{L(E.id)},style:{width:"24px",height:"24px",padding:"0",borderRadius:"4px",border:"none",backgroundColor:"var(--danger-color)",color:"white",cursor:"pointer",fontSize:"0.8rem",lineHeight:"1",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s"},title:" ",children:""})]})]},E.id)}),m?h.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[h.jsx("input",{type:"text",value:v,onChange:E=>I(E.target.value),onKeyPress:E=>{E.key==="Enter"&&q(),E.key==="Escape"&&(g(!1),I(""))},placeholder:" ...",autoFocus:!0,style:{padding:"6px 12px",borderRadius:"8px",border:"2px solid var(--primary-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontSize:"0.9rem",outline:"none",width:"120px"}}),h.jsx("button",{onClick:q,style:{padding:"4px 12px",borderRadius:"8px",border:"none",backgroundColor:"var(--primary-color)",color:"white",cursor:"pointer",fontSize:"0.85rem",fontWeight:600,transition:"all 0.2s"},children:""}),h.jsx("button",{onClick:()=>{g(!1),I("")},style:{padding:"4px 12px",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"transparent",color:"var(--text-color)",cursor:"pointer",fontSize:"0.85rem",transition:"all 0.2s"},children:""})]}):h.jsx("button",{onClick:()=>g(!0),style:{padding:"6px 12px",borderRadius:"8px",border:"2px solid var(--primary-color)",backgroundColor:"transparent",color:"var(--primary-color)",cursor:"pointer",fontSize:"0.9rem",fontWeight:500,whiteSpace:"nowrap",transition:"all 0.2s",display:"flex",alignItems:"center",gap:"4px"},children:" "}),A&&h.jsx("div",{className:"modal-backdrop alert-backdrop",children:h.jsxs("div",{className:"modal-content alert-modal",children:[h.jsxs("div",{className:"alert-content",children:[h.jsx("h2",{children:l("folder_delete")}),h.jsxs("p",{style:{fontSize:"0.9rem"},children:['"',(z=t.find(E=>E.id===A))==null?void 0:z.name,'" ',l("folder_delete_confirm")]})]}),h.jsxs("div",{className:"modal-buttons",children:[h.jsx("button",{onClick:()=>L(null),className:"secondary",children:l("cancel_button")}),h.jsx("button",{onClick:()=>{s(A),L(null)},className:"destructive",children:""})]})]})}),P&&h.jsx("div",{className:"modal-backdrop alert-backdrop",children:h.jsxs("div",{className:"modal-content alert-modal",children:[h.jsxs("div",{className:"alert-content",children:[h.jsx("h2",{children:"  "}),h.jsx("p",{style:{fontSize:"0.9rem",marginBottom:"16px"},children:"   "}),h.jsx("input",{type:"text",value:C,onChange:E=>S(E.target.value),onKeyPress:E=>{E.key==="Enter"&&C.trim()&&(i(P,C),V(null),S(""))},placeholder:" ...",autoFocus:!0,style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontSize:"0.95rem",outline:"none",boxSizing:"border-box"}})]}),h.jsxs("div",{className:"modal-buttons",children:[h.jsx("button",{onClick:()=>{V(null),S("")},className:"secondary",children:""}),h.jsx("button",{onClick:()=>{C.trim()&&(i(P,C),V(null),S(""))},className:"primary",children:""})]})]})})]})},M6=({t,categoryFilter:e,onCategoryFilter:n,userCategories:r,onAddCategory:i,onRemoveCategory:s})=>{const[o,a]=G.useState(!1),[l,u]=G.useState(!1),[p,m]=G.useState(""),g=G.useRef(null);G.useEffect(()=>{const P=V=>{g.current&&!g.current.contains(V.target)&&a(!1)};return document.addEventListener("click",P),document.addEventListener("touchstart",P),()=>{document.removeEventListener("click",P),document.removeEventListener("touchstart",P)}},[]);const v=()=>{const P=p.trim();P&&!r.includes(P)&&(i(P),m(""),u(!1))},I=()=>{m(""),u(!1)};return h.jsxs(h.Fragment,{children:[h.jsx("header",{className:"goals-header",children:h.jsx("div",{className:"header-title-group",children:h.jsx("h1",{children:t("my_goals_title")})})}),l&&h.jsx("div",{className:"modal-backdrop alert-backdrop",children:h.jsxs("div",{className:"modal-content alert-modal",children:[h.jsxs("div",{className:"alert-content",children:[h.jsx("h2",{children:"  "}),h.jsx("input",{type:"text",value:p,onChange:P=>m(P.target.value),placeholder:"  ",style:{width:"100%",padding:"12px",border:"1px solid var(--border-color)",borderRadius:"8px",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontSize:"16px",marginTop:"16px"},onKeyPress:P=>{P.key==="Enter"&&v()},autoFocus:!0})]}),h.jsxs("div",{className:"modal-buttons",children:[h.jsx("button",{onClick:I,className:"secondary",children:""}),h.jsx("button",{onClick:v,className:"primary",disabled:!p.trim()||r.includes(p.trim()),children:""})]})]})})]})},V6=({t,isSelectionMode:e,selectedCount:n,totalVisibleCount:r,onCancelSelection:i,onDeleteSelected:s,onSelectAll:o,onSetSelectionMode:a,isViewModeCalendar:l,onToggleViewMode:u,isAiSorting:p,sortType:m,onSort:g,filter:v,onFilter:I,onOpenSettings:P,onAddGoal:V,currentFolderId:C,folders:S,onSyncSharedFolder:A,isSyncing:L,isSyncingData:q,onManualSync:z,activeUsers:E,onToggleCollaboration:x,onUpdateCollaborationSettings:R,categoryFilter:N,onCategoryFilter:M,userCategories:U,onAddCategory:b,onRemoveCategory:xe})=>{const[Ye,Ue]=G.useState(!1),[Ee,Z]=G.useState(!1),[he,fe]=G.useState(!1),[Ce,Le]=G.useState(!1),[At,Oe]=G.useState(""),Dt=G.useRef(null),Ne=C?S.find(ae=>ae.id===C):null,je=Ne==null?void 0:Ne.collaborationSettings,Ut=(je==null?void 0:je.enabled)||(Ne==null?void 0:Ne.isShared)||!1;G.useEffect(()=>{const ae=()=>{Ue(!1),Z(!1)};return document.addEventListener("click",ae),document.addEventListener("touchstart",ae),()=>{document.removeEventListener("click",ae),document.removeEventListener("touchstart",ae)}},[]);const Ot=ae=>{ae.stopPropagation()},In=()=>{const ae=At.trim();ae&&!U.includes(ae)&&(b(ae),Oe(""),Le(!1))},er=()=>{Oe(""),Le(!1)},_t=(t("selection_summary_label")||"{count}/{total}").replace("{count}",String(n)).replace("{total}",String(r));return h.jsxs("aside",{className:"app-sidebar",children:[e?h.jsxs("div",{className:"sidebar-card",children:[h.jsx("p",{className:"sidebar-section-title",children:_t}),h.jsxs("div",{className:"sidebar-selection-buttons",children:[h.jsx("button",{onClick:o,className:"sidebar-button",children:t("select_all_button_label")}),h.jsx("button",{onClick:i,className:"sidebar-button",children:t("cancel_selection_button_label")}),n>0&&h.jsx("button",{onClick:s,className:"sidebar-button destructive",children:t("delete_selected_button_label").replace("{count}",String(n))})]})]}):h.jsxs(h.Fragment,{children:[h.jsxs("button",{onClick:V,className:"sidebar-primary-button","aria-label":t("add_new_goal_button_label"),children:[Ie.add,h.jsx("span",{children:t("add_new_goal_button_label")})]}),h.jsxs("div",{className:"sidebar-card",children:[h.jsx("p",{className:"sidebar-section-title",children:t(l?"list_view_button_aria":"calendar_view_button_aria")}),h.jsxs("button",{onClick:u,className:"sidebar-button","aria-label":t(l?"list_view_button_aria":"calendar_view_button_aria"),children:[l?Ie.list:Ie.calendar,h.jsx("span",{children:t(l?"list_view_button_aria":"calendar_view_button_aria")})]})]}),h.jsxs("div",{className:"sidebar-card",children:[h.jsx("p",{className:"sidebar-section-title",children:t("filter_sort_button_aria")}),h.jsxs("div",{className:"filter-sort-container",children:[h.jsxs("button",{onClick:ae=>{ae.stopPropagation(),Ue(Je=>!Je)},onTouchStart:ae=>{ae.stopPropagation(),Ue(Je=>!Je)},className:"sidebar-button","aria-label":t("filter_sort_button_aria"),children:[p?h.jsx("div",{className:"spinner"}):Ie.filter,h.jsx("span",{children:t("filter_sort_button_aria")})]}),Ye&&h.jsxs("div",{className:"profile-popover filter-sort-popover",onClick:Ot,onTouchStart:Ot,children:[h.jsx("div",{className:"popover-section",children:h.jsx("button",{onClick:()=>{a(),Ue(!1)},className:"popover-action-button",children:h.jsx("span",{children:t("select_button_label")})})}),h.jsxs("div",{className:"popover-section",children:[h.jsx("h4",{children:t("filter_title")}),h.jsxs("button",{onClick:()=>{I("all")},className:`popover-action-button ${v==="all"?"active":""}`,children:[h.jsx("span",{children:t("filter_all")}),v==="all"&&Ie.check]}),h.jsxs("button",{onClick:()=>{I("active")},className:`popover-action-button ${v==="active"?"active":""}`,children:[h.jsx("span",{children:t("filter_active")}),v==="active"&&Ie.check]}),h.jsxs("button",{onClick:()=>{I("completed")},className:`popover-action-button ${v==="completed"?"active":""}`,children:[h.jsx("span",{children:t("filter_completed")}),v==="completed"&&Ie.check]})]}),h.jsxs("div",{className:"popover-section",children:[h.jsx("h4",{children:t("sort_title")}),h.jsxs("button",{onClick:()=>{g("manual")},className:`popover-action-button ${m==="manual"?"active":""}`,children:[h.jsx("span",{children:t("sort_label_manual")}),m==="manual"&&Ie.check]}),h.jsxs("button",{onClick:()=>{g("deadline")},className:`popover-action-button ${m==="deadline"?"active":""}`,children:[h.jsx("span",{children:t("sort_label_deadline")}),m==="deadline"&&Ie.check]}),h.jsxs("button",{onClick:()=>{g("newest")},className:`popover-action-button ${m==="newest"?"active":""}`,children:[h.jsx("span",{children:t("sort_label_newest")}),m==="newest"&&Ie.check]}),h.jsxs("button",{onClick:()=>{g("alphabetical")},className:`popover-action-button ${m==="alphabetical"?"active":""}`,children:[h.jsx("span",{children:t("sort_label_alphabetical")}),m==="alphabetical"&&Ie.check]}),h.jsxs("button",{onClick:()=>{g("ai")},className:"popover-action-button with-icon",children:[h.jsx("span",{className:"popover-button-icon",children:Ie.ai}),h.jsx("span",{children:t(p?"ai_sorting_button":"sort_label_ai")})]}),h.jsx("button",{onClick:()=>{g("ai"),Ue(!1)},className:"popover-action-button",style:{backgroundColor:"rgba(88, 86, 214, 0.1)",marginTop:"8px",color:"var(--icon-color-indigo)"},children:h.jsx("span",{children:"   "})})]})]})]})]}),C&&(Ne==null?void 0:Ne.isShared)&&h.jsxs("div",{className:"sidebar-card",children:[h.jsx("p",{className:"sidebar-section-title",children:""}),h.jsxs("div",{className:"collaboration-settings",children:[h.jsx("button",{onClick:ae=>{ae.stopPropagation(),Z(Je=>!Je)},className:`sidebar-button ${Ut?"collaboration-active":""}`,"aria-label":" ",children:Ut?"":""}),Ee&&C&&h.jsx("div",{className:"profile-popover collaboration-popover",onClick:Ot,onTouchStart:Ot,children:h.jsxs("div",{className:"popover-section",children:[h.jsx("h4",{style:{marginBottom:"12px"},children:" "}),h.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[h.jsx("span",{children:" "}),h.jsx("button",{onClick:()=>x(C,!Ut),style:{background:Ut?"var(--primary-color)":"#ccc",border:"none",borderRadius:"12px",width:"44px",height:"24px",position:"relative",cursor:"pointer",transition:"background 0.2s"},children:h.jsx("div",{style:{background:"white",borderRadius:"50%",width:"20px",height:"20px",position:"absolute",top:"2px",left:Ut?"22px":"2px",transition:"left 0.2s"}})})]}),Ut&&E.length>0&&h.jsxs("div",{style:{marginBottom:"16px"},children:[h.jsxs("h5",{style:{marginBottom:"8px",fontSize:"0.9rem"},children:["  (",E.length,")"]}),h.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:E.map(ae=>h.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",background:"rgba(var(--primary-color-rgb), 0.1)",padding:"4px 8px",borderRadius:"12px",fontSize:"0.8rem"},children:[ae.photoURL&&h.jsx("img",{src:ae.photoURL,alt:"",style:{width:"16px",height:"16px",borderRadius:"50%"}}),h.jsx("span",{children:ae.displayName}),h.jsx("div",{style:{width:"6px",height:"6px",background:ae.isOnline?"#34C759":"#ccc",borderRadius:"50%"}})]},ae.userId))})]}),Ut&&h.jsxs("div",{style:{borderTop:"1px solid #eee",paddingTop:"16px"},children:[h.jsx("h5",{style:{marginBottom:"8px",fontSize:"0.9rem"},children:" "}),h.jsxs("label",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px",cursor:"pointer"},children:[h.jsx("span",{style:{fontSize:"0.8rem"},children:" "}),h.jsx("input",{type:"checkbox",checked:(je==null?void 0:je.showPresence)??!0,onChange:ae=>R(C,{showPresence:ae.target.checked})})]}),h.jsxs("label",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px",cursor:"pointer"},children:[h.jsx("span",{style:{fontSize:"0.8rem"},children:"  "}),h.jsx("input",{type:"checkbox",checked:(je==null?void 0:je.showEditingState)??!0,onChange:ae=>R(C,{showEditingState:ae.target.checked})})]}),h.jsxs("label",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px",cursor:"pointer"},children:[h.jsx("span",{style:{fontSize:"0.8rem"},children:" "}),h.jsx("input",{type:"checkbox",checked:(je==null?void 0:je.enableConflictDetection)??!0,onChange:ae=>R(C,{enableConflictDetection:ae.target.checked})})]})]})]})})]})]}),h.jsxs("div",{className:"sidebar-card",children:[h.jsx("p",{className:"sidebar-section-title",children:""}),C&&(Ne==null?void 0:Ne.isShared)&&h.jsx("button",{onClick:A,disabled:L,className:"sidebar-button","aria-label":"",children:L?h.jsx("div",{className:"spinner",style:{width:"20px",height:"20px"}}):"  "}),h.jsx("button",{className:"sync-status-indicator clickable",onClick:()=>{q||(C&&(Ne!=null&&Ne.isShared)?A():z())},disabled:q,title:q?" ...":"  ",children:q?h.jsx("span",{style:{fontSize:"12px"},children:""}):h.jsx("span",{style:{fontSize:"12px"},children:""})})]}),h.jsxs("div",{className:"sidebar-card",children:[h.jsx("p",{className:"sidebar-section-title",children:" "}),h.jsxs("div",{className:"category-dropdown-container",ref:Dt,children:[h.jsxs("button",{onClick:ae=>{ae.stopPropagation(),fe(Je=>!Je)},className:"category-dropdown-button",style:{width:"100%",justifyContent:"space-between"},"aria-label":t("category_filter_button_aria"),children:[h.jsx("span",{children:N==="all"?t("category_all"):N}),h.jsx("span",{className:"dropdown-arrow",children:""})]}),he&&h.jsxs("div",{className:"category-dropdown-menu",onClick:ae=>ae.stopPropagation(),children:[h.jsxs("div",{className:"dropdown-header",children:[h.jsx("span",{children:t("filter_category")}),h.jsx("button",{onClick:ae=>{ae.stopPropagation(),Le(!0),fe(!1)},className:"add-category-button",title:"  ",children:"+"})]}),h.jsxs("div",{className:"dropdown-items",children:[h.jsxs("button",{onClick:()=>{M("all"),fe(!1)},className:`dropdown-item ${N==="all"?"active":""}`,children:[h.jsx("span",{children:t("category_all")}),N==="all"&&h.jsx("span",{className:"check-icon",children:""})]}),U.map(ae=>h.jsxs("div",{className:"dropdown-item-container",children:[h.jsxs("button",{onClick:()=>{M(ae),fe(!1)},className:`dropdown-item ${N===ae?"active":""}`,children:[h.jsx("span",{children:ae}),N===ae&&h.jsx("span",{className:"check-icon",children:""})]}),!["school","work","personal","other"].includes(ae)&&h.jsx("button",{onClick:()=>xe(ae),className:"remove-category-button",title:" ",children:""})]},ae))]})]})]})]}),h.jsxs("div",{className:"sidebar-card",children:[h.jsx("p",{className:"sidebar-section-title",children:t("settings_title")}),h.jsxs("button",{onClick:P,className:"sidebar-button","aria-label":t("settings_title"),children:[Ie.settings,h.jsx("span",{children:t("settings_title")})]})]})]}),Ce&&h.jsx("div",{className:"modal-backdrop alert-backdrop",children:h.jsxs("div",{className:"modal-content alert-modal",children:[h.jsxs("div",{className:"alert-content",children:[h.jsx("h2",{children:"  "}),h.jsx("input",{type:"text",value:At,onChange:ae=>Oe(ae.target.value),placeholder:"  ",style:{width:"100%",padding:"12px",border:"1px solid var(--border-color)",borderRadius:"8px",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontSize:"16px",marginTop:"16px"},onKeyPress:ae=>{ae.key==="Enter"&&In()},autoFocus:!0})]}),h.jsxs("div",{className:"modal-buttons",children:[h.jsx("button",{onClick:er,className:"secondary",children:""}),h.jsx("button",{onClick:In,className:"primary",disabled:!At.trim()||U.includes(At.trim()),children:""})]})]})})]})},L6=({todos:t,onToggleComplete:e,onDelete:n,onEdit:r,onInfo:i,t:s,filter:o,randomEncouragement:a,isSelectionMode:l,selectedTodoIds:u,onSelectTodo:p,folders:m,onMoveToFolder:g})=>{if(t.length===0){const v=`empty_message_${o}`;return h.jsx("div",{className:"empty-message",children:h.jsx("p",{children:s(v)})})}return h.jsx("ul",{children:t.map(v=>h.jsx(F6,{todo:v,onToggleComplete:e,onDelete:n,onEdit:r,onInfo:i,t:s,isSelectionMode:l,isSelected:u.has(v.id),onSelect:p,folders:m,onMoveToFolder:g},v.id))})},F6=hI.memo(({todo:t,onToggleComplete:e,onDelete:n,onEdit:r,onInfo:i,t:s,isSelectionMode:o,isSelected:a,onSelect:l,folders:u,onMoveToFolder:p})=>{var I;const m=()=>{o&&l(t.id)},g={school:"",work:"",personal:"",other:""},v=P=>P?{school:s("category_school"),work:s("category_work"),personal:s("category_personal"),other:s("category_other")}[P]||P:"";return h.jsx("li",{className:`${t.completed?"completed":""} ${o?"selection-mode":""} ${a?"selected":""}`,onClick:m,children:h.jsxs("div",{className:"swipeable-content",children:[h.jsxs("label",{className:"checkbox-container",onClick:P=>P.stopPropagation(),children:[h.jsx("input",{type:"checkbox",checked:t.completed,onChange:()=>e(t.id)}),h.jsx("span",{className:"checkmark"})]}),h.jsxs("div",{className:"todo-text-with-streak",children:[h.jsx("span",{className:"todo-text",children:t.title||t.wish}),t.isRecurring&&t.streak>0&&h.jsxs("div",{className:"streak-indicator",children:[Ie.flame,h.jsx("span",{children:t.streak})]})]}),h.jsxs("div",{className:"todo-actions-and-meta",children:[h.jsxs("div",{className:"todo-meta-badges",children:[t.category&&h.jsxs("span",{style:{backgroundColor:"rgba(88, 86, 214, 0.1)",color:"var(--icon-color-indigo)",padding:"4px 8px",borderRadius:"4px",fontSize:"0.8rem",marginRight:"4px",display:"inline-flex",alignItems:"center",gap:"4px",whiteSpace:"nowrap"},children:[g[t.category]||""," ",v(t.category)]}),t.deadline&&h.jsx("span",{className:"todo-deadline",children:N6(t.deadline,s)}),t.collaborators&&t.collaborators.length>0&&h.jsxs("span",{style:{backgroundColor:"rgba(52, 199, 89, 0.1)",color:"var(--success-color)",padding:"4px 8px",borderRadius:"4px",fontSize:"0.85rem",marginLeft:"4px",display:"inline-flex",alignItems:"center",gap:"4px"},children:[" ",t.collaborators.length]}),t.folderId&&h.jsxs("span",{style:{backgroundColor:"rgba(100, 150, 200, 0.15)",color:"var(--primary-color)",padding:"4px 8px",borderRadius:"4px",fontSize:"0.8rem",marginLeft:"4px",display:"inline-flex",alignItems:"center",gap:"4px",whiteSpace:"nowrap"},children:[" ",((I=u.find(P=>P.id===t.folderId))==null?void 0:I.name)||"Unknown"]})]}),h.jsxs("div",{className:"todo-buttons",children:[h.jsxs("select",{onClick:P=>P.stopPropagation(),onChange:P=>{p(t.id,P.target.value==="root"?null:P.target.value)},defaultValue:t.folderId||"root",style:{padding:"4px 8px",borderRadius:"4px",border:"1px solid var(--border-color)",backgroundColor:"var(--card-bg-color)",color:"var(--text-color)",cursor:"pointer",fontSize:"0.85rem",fontFamily:"inherit"},title:" ",children:[h.jsx("option",{value:"root",children:"  "}),u.map(P=>h.jsx("option",{value:P.id,children:P.name},P.id))]}),h.jsx("button",{onClick:P=>{P.stopPropagation(),r(t)},className:"info-button edit-button","aria-label":s("edit_button_aria"),children:Ie.edit}),h.jsx("button",{onClick:P=>{P.stopPropagation(),n(t.id)},className:"delete-button","aria-label":s("delete_button"),children:Ie.delete}),h.jsx("button",{onClick:P=>{P.stopPropagation(),i(t)},className:"info-button","aria-label":s("info_button_aria"),children:Ie.info})]})]})]})})}),mi=({onClose:t,children:e,className:n="",isClosing:r,size:i="large"})=>{const s={small:"modal-content-small",medium:"modal-content-medium",large:"modal-content-large"}[i];return h.jsx("div",{className:`modal-backdrop ${r?"is-closing":""}`,onClick:t,children:h.jsx("div",{className:`modal-content ${s} ${n} ${r?"is-closing":""}`,onClick:o=>o.stopPropagation(),children:e})})},Ss=t=>{const[e,n]=G.useState(!1);return[e,()=>{n(!0),setTimeout(t,500)}]},U6=({step:t,t:e,createAI:n,...r})=>{const{wish:i,setWish:s,outcome:o,setOutcome:a,obstacle:l,setObstacle:u,plan:p,setPlan:m,isRecurring:g,setIsRecurring:v,recurringDays:I,setRecurringDays:P,deadline:V,setDeadline:C,noDeadline:S,setNoDeadline:A,category:L,setCategory:q,userCategories:z,errors:E,language:x}=r,[R,N]=G.useState(!1),[M,U]=G.useState(""),[b,xe]=G.useState(""),Ye=async(Ue,Ee)=>{if(Ee){N(!0),U(""),xe("");try{const Z=n();if(!Z){xe("AI    API  ."),N(!1);return}const he=`Provide concise, actionable feedback on this part of a WOOP goal: ${Ue} - "${Ee}". The feedback should be helpful and encouraging, in ${x==="ko"?"Korean":"English"}. Keep it to 1-2 sentences.`,fe=await Z.models.generateContent({model:"gemini-2.5-flash",contents:he});U(fe.text)}catch(Z){console.error("AI Feedback Error:",Z),xe("Failed to get AI feedback.")}finally{N(!1)}}};switch(t){case 1:return h.jsxs("div",{children:[h.jsx("h3",{children:e("wish_label")}),h.jsxs("div",{className:"step-guidance",children:[h.jsx("p",{className:"tip",children:e("wish_tip")}),h.jsx("p",{className:"example",children:e("wish_example")})]}),h.jsx("textarea",{value:i,onChange:Ee=>{s(Ee.target.value),U(""),xe("")},placeholder:e("wish_label"),className:E.wish?"input-error":"",rows:3}),E.wish&&h.jsxs("p",{className:"field-error-message",children:[Ie.exclamation," ",e("error_wish_required")]}),h.jsxs("div",{className:"ai-feedback-section",children:[h.jsxs("button",{onClick:()=>Ye("Wish",i),disabled:!i.trim()||R,className:"ai-feedback-button",children:[R?h.jsx("div",{className:"spinner-small"}):"",h.jsx("span",{children:e(R?"ai_analyzing":"ai_coach_suggestion")})]}),M&&h.jsx("div",{className:"ai-feedback-bubble",children:M}),b&&h.jsx("div",{className:"ai-feedback-bubble error",children:b})]})]});case 2:return h.jsxs("div",{children:[h.jsx("h3",{children:e("outcome_label")}),h.jsxs("div",{className:"step-guidance",children:[h.jsx("p",{className:"tip",children:e("outcome_tip")}),h.jsx("p",{className:"example",children:e("outcome_example")})]}),h.jsx("textarea",{value:o,onChange:Ee=>{a(Ee.target.value),U(""),xe("")},placeholder:e("outcome_label"),className:E.outcome?"input-error":"",rows:3}),E.outcome&&h.jsxs("p",{className:"field-error-message",children:[Ie.exclamation," ",e("error_outcome_required")]}),h.jsxs("div",{className:"ai-feedback-section",children:[h.jsxs("button",{onClick:()=>Ye("Outcome",o),disabled:!o.trim()||R,className:"ai-feedback-button",children:[R?h.jsx("div",{className:"spinner-small"}):"",h.jsx("span",{children:e(R?"ai_analyzing":"ai_coach_suggestion")})]}),M&&h.jsx("div",{className:"ai-feedback-bubble",children:M}),b&&h.jsx("div",{className:"ai-feedback-bubble error",children:b})]})]});case 3:return h.jsxs("div",{children:[h.jsx("h3",{children:e("obstacle_label")}),h.jsxs("div",{className:"step-guidance",children:[h.jsx("p",{className:"tip",children:e("obstacle_tip")}),h.jsx("p",{className:"example",children:e("obstacle_example")})]}),h.jsx("textarea",{value:l,onChange:Ee=>{u(Ee.target.value),U(""),xe("")},placeholder:e("obstacle_label"),className:E.obstacle?"input-error":"",rows:3}),E.obstacle&&h.jsxs("p",{className:"field-error-message",children:[Ie.exclamation," ",e("error_obstacle_required")]}),h.jsxs("div",{className:"ai-feedback-section",children:[h.jsxs("button",{onClick:()=>Ye("Obstacle",l),disabled:!l.trim()||R,className:"ai-feedback-button",children:[R?h.jsx("div",{className:"spinner-small"}):"",h.jsx("span",{children:e(R?"ai_analyzing":"ai_coach_suggestion")})]}),M&&h.jsx("div",{className:"ai-feedback-bubble",children:M}),b&&h.jsx("div",{className:"ai-feedback-bubble error",children:b})]})]});case 4:return h.jsxs("div",{children:[h.jsx("h3",{children:e("plan_label")}),h.jsxs("div",{className:"step-guidance",children:[h.jsx("p",{className:"tip",children:e("plan_tip")}),h.jsx("p",{className:"example",children:e("plan_example")})]}),h.jsx("textarea",{value:p,onChange:Ee=>{m(Ee.target.value),U(""),xe("")},placeholder:e("plan_label"),className:E.plan?"input-error":"",rows:3}),E.plan&&h.jsxs("p",{className:"field-error-message",children:[Ie.exclamation," ",e("error_plan_required")]}),h.jsxs("div",{className:"ai-feedback-section",children:[h.jsxs("button",{onClick:()=>Ye("Plan",p),disabled:!p.trim()||R,className:"ai-feedback-button",children:[R?h.jsx("div",{className:"spinner-small"}):"",h.jsx("span",{children:e(R?"ai_analyzing":"ai_coach_suggestion")})]}),M&&h.jsx("div",{className:"ai-feedback-bubble",children:M}),b&&h.jsx("div",{className:"ai-feedback-bubble error",children:b})]})]});case 5:const Ue=Ee=>{const Z=[...I],he=Z.indexOf(Ee);he>-1?Z.splice(he,1):Z.push(Ee),P(Z)};return h.jsxs("div",{children:[h.jsxs("h3",{children:[e("recurrence_label")," & ",e("deadline_label")," & ",e("category_label")]}),h.jsxs("div",{className:"step-guidance",children:[h.jsx("p",{className:"tip",children:e("recurrence_tip")}),h.jsx("p",{className:"example",children:e("recurrence_example")})]}),h.jsxs("label",{className:"settings-item standalone-toggle",children:[h.jsx("span",{style:{fontWeight:500},children:e("recurrence_option_daily")}),h.jsxs("label",{className:"theme-toggle-switch",children:[h.jsx("input",{type:"checkbox",checked:g,onChange:Ee=>v(Ee.target.checked)}),h.jsx("span",{className:"slider round"})]})]}),g&&h.jsx("div",{className:"day-picker",children:e("day_names_short_picker").map((Ee,Z)=>h.jsx("button",{onClick:()=>Ue(Z),className:`day-button ${I.includes(Z)?"selected":""}`,children:Ee},Z))}),E.recurringDays&&h.jsxs("p",{className:"field-error-message",children:[Ie.exclamation," ",e("error_day_required")]}),h.jsx("hr",{}),h.jsx("div",{className:"step-guidance",style:{marginTop:"16px"},children:h.jsx("p",{className:"tip",children:e("deadline_tip")})}),h.jsxs("label",{className:"settings-item standalone-toggle",children:[h.jsx("span",{style:{fontWeight:500},children:e("deadline_option_no_deadline")}),h.jsxs("label",{className:"theme-toggle-switch",children:[h.jsx("input",{type:"checkbox",checked:S,onChange:Ee=>A(Ee.target.checked)}),h.jsx("span",{className:"slider round"})]})]}),!S&&h.jsx("input",{type:"date",value:V,onChange:Ee=>C(Ee.target.value),className:E.deadline?"input-error":"",style:{marginTop:"12px"}}),E.deadline&&h.jsxs("p",{className:"field-error-message",children:[Ie.exclamation," ",e("error_deadline_required")]}),h.jsx("hr",{}),h.jsx("div",{className:"step-guidance",style:{marginTop:"16px"},children:h.jsx("p",{className:"tip",children:e("category_label")})}),h.jsx("div",{style:{display:"grid",gridTemplateColumns:z&&z.length>2?"repeat(2, 1fr)":"repeat(1, 1fr)",gap:"8px",marginTop:"12px"},children:z&&z.map(Ee=>h.jsx("button",{onClick:()=>q(Ee),className:`category-button ${L===Ee?"active":""}`,children:Ee},Ee))})]});default:return null}},O6=({onGenerate:t,t:e,onCancel:n})=>{const[r,i]=G.useState(""),[s,o]=G.useState(""),[a,l]=G.useState(""),[u,p]=G.useState(""),[m,g]=G.useState(""),{endDate:v,generatedCount:I}=G.useMemo(()=>{const V=parseInt(s,10),C=parseInt(a,10);if(!u||!V||V<=0||!C||C<=0)return{endDate:"",generatedCount:0};const S=Math.ceil(V/C),A=new Date(u),L=new Date(A);return L.setDate(A.getDate()+S-1),{endDate:L.toISOString().split("T")[0],generatedCount:S}},[s,a,u]),P=()=>{const V=parseInt(s,10),C=parseInt(a,10);if(!r.trim()||!u||!V||V<=0||!C||C<=0){g(e("automation_error_all_fields"));return}const S=[],A=Math.ceil(V/C),L=new Date(u);for(let q=0;q<A;q++){const z=new Date(L);z.setDate(L.getDate()+q);const E=q*C+1,x=Math.min((q+1)*C,V),R=`${r.trim()} ${E}`+(x>E?` - ${x}`:"");S.push({wish:R,outcome:"",obstacle:"",plan:"",isRecurring:!1,recurringDays:[],deadline:z.toISOString().split("T")[0],category:"personal"})}g(""),t(S)};return h.jsxs("div",{className:"automation-form-container",children:[h.jsx("h3",{children:e("automation_title")}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{children:e("automation_base_name_label")}),h.jsx("input",{type:"text",value:r,onChange:V=>i(V.target.value),placeholder:e("automation_base_name_placeholder")})]}),h.jsxs("div",{className:"automation-form-grid",children:[h.jsxs("div",{className:"form-group",children:[h.jsx("label",{children:e("automation_total_units_label")}),h.jsx("input",{type:"number",value:s,onChange:V=>o(V.target.value),placeholder:e("automation_total_units_placeholder")})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{children:e("automation_units_per_day_label")}),h.jsx("input",{type:"number",value:a,onChange:V=>l(V.target.value),placeholder:": 5"})]})]}),h.jsxs("div",{className:"automation-form-grid",children:[h.jsxs("div",{className:"form-group",children:[h.jsx("label",{children:e("automation_start_date_label")}),h.jsx("input",{type:"date",value:u,onChange:V=>p(V.target.value)})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{children:e("automation_end_date_label")}),h.jsx("input",{type:"date",value:v,readOnly:!0})]})]}),m&&h.jsxs("p",{className:"field-error-message",style:{justifyContent:"center"},children:[Ie.exclamation," ",m]}),h.jsxs("div",{className:"goal-assistant-nav",children:[h.jsx("button",{onClick:n,className:"secondary",children:e("cancel_button")}),h.jsx("button",{onClick:P,className:"primary",disabled:I===0,children:I>0?`${I} `:e("automation_generate_button").replace("{count}",String(I))})]})]})},Np=({onClose:t,onAddTodo:e,onAddMultipleTodos:n,onEditTodo:r,existingTodo:i,t:s,language:o,createAI:a,userCategories:l=["personal"],onAddAssignment:u,analyzeAssignmentWithAI:p,initialMode:m="woop"})=>{const[g,v]=Ss(t),[I,P]=G.useState(m),[V,C]=G.useState(1),[S,A]=G.useState("forward"),[L,q]=G.useState((i==null?void 0:i.wish)||""),[z,E]=G.useState((i==null?void 0:i.outcome)||""),[x,R]=G.useState((i==null?void 0:i.obstacle)||""),[N,M]=G.useState((i==null?void 0:i.plan)||""),[U,b]=G.useState((i==null?void 0:i.isRecurring)||!1),[xe,Ye]=G.useState((i==null?void 0:i.recurringDays)||[]),[Ue,Ee]=G.useState((i==null?void 0:i.deadline)||""),[Z,he]=G.useState(!(i!=null&&i.deadline)),[fe,Ce]=G.useState((i==null?void 0:i.category)||"personal"),[Le,At]=G.useState({}),[Oe,Dt]=G.useState(""),[Ne,je]=G.useState(""),[Ut,Ot]=G.useState(""),[In,er]=G.useState("personal"),[_t,ae]=G.useState(""),[Je,Tr]=G.useState(""),[Sn,tr]=G.useState(""),[Re,Ge]=G.useState(""),[qe,on]=G.useState(3),[nr,gn]=G.useState(""),[an,Fn]=G.useState(!1),[Qe,xs]=G.useState(!1),[Et,_e]=G.useState(""),gi=5,Ur=le=>{const rt={};return le===1&&!L.trim()&&(rt.wish=!0),le===2&&!z.trim()&&(rt.outcome=!0),le===3&&!x.trim()&&(rt.obstacle=!0),le===4&&!N.trim()&&(rt.plan=!0),le===5&&(!Z&&!Ue&&(rt.deadline=!0),U&&xe.length===0&&(rt.recurringDays=!0)),At(rt),Object.keys(rt).length===0},Er=()=>{Ur(V)&&(V<gi?(A("forward"),C(le=>le+1)):we())},Un=()=>{V>1&&(A("backward"),C(le=>le-1))},xn=le=>{le==="quick"&&(q(""),E(""),R(""),M("")),le==="assignment"&&(ae(""),Tr(""),tr(""),Ge(""),on(3),gn(""),_e("")),P(le)},we=async()=>{if(I==="quick"){console.log("    handleSubmit  - handleQuickTaskSubmit "),Cn();return}if(!Ur(5))return;const le={wish:L,outcome:z,obstacle:x,plan:N,isRecurring:U,recurringDays:xe,deadline:Z?"":Ue,category:fe};console.log(" WOOP  :",le);try{i&&r?await r({...i,...le}):e&&await e(le)}catch(rt){console.error("   :",rt)}v()},Cn=()=>{if(Oe.trim()){if(e){const le={title:Oe.trim(),wish:"",outcome:"",obstacle:"",plan:"",isRecurring:!1,recurringDays:[],deadline:Ne,category:In};console.log("   :",le),e(le)}Dt(""),je(""),Ot(""),er("personal"),v()}},rr=async()=>{if(!(!_t.trim()||!Je.trim())){xs(!0);try{if(p){let le=Sn;if(nr&&!an){const _i=`
: ${nr}`;le=Sn?`${Sn}${_i}`:_i}const rt=await p(_t,Je,le);rt&&(Ge(rt.estimatedMinutes.toString()),on(rt.difficulty),_e(rt.studyTips||rt.optimizedSchedule||""))}}catch(le){console.error("AI  :",le)}finally{xs(!1)}}},Or=()=>{!_t.trim()||!Je.trim()||!Re||!an&&!nr||(u&&u({name:_t.trim(),subject:Je.trim(),estimatedMinutes:parseInt(Re),difficulty:qe,dueDate:an?"":nr,completed:!1}),ae(""),Tr(""),tr(""),Ge(""),on(3),gn(""),Fn(!1),_e(""),v())};return h.jsxs(mi,{onClose:v,isClosing:g,className:"goal-assistant-modal",children:[h.jsxs("div",{className:"goal-assistant-header",children:[h.jsx("div",{className:"goal-assistant-header-left"}),h.jsx("h2",{children:I==="woop"?" ":I==="quick"?" ":I==="assignment"?"  ":I==="automation"?" ":s("goal_assistant_title")}),h.jsx("div",{className:"goal-assistant-header-right",style:{width:"40px"}})]}),!i&&h.jsx("div",{className:"modal-mode-switcher-container",children:h.jsxs("div",{className:"modal-mode-switcher",children:[h.jsx("button",{onClick:()=>xn("woop"),className:I==="woop"?"active":"",children:s("goal_assistant_mode_woop")}),h.jsx("button",{onClick:()=>xn("quick"),className:I==="quick"?"active":"",children:" "}),u&&h.jsx("button",{onClick:()=>xn("assignment"),className:I==="assignment"?"active":"",children:" "}),h.jsx("button",{onClick:()=>xn("automation"),className:I==="automation"?"active":"",children:s("goal_assistant_mode_automation")})]})}),"            ",h.jsx("div",{className:"goal-assistant-body",children:I==="woop"?h.jsxs(h.Fragment,{children:[h.jsxs("div",{style:{padding:"24px 16px",flex:1,overflowY:"auto"},children:[h.jsx("div",{className:"progress-bar-container",children:h.jsx("div",{className:"progress-bar",style:{width:`${V/gi*100}%`}})}),h.jsx("div",{className:`goal-assistant-step-content-animator ${S}`,children:h.jsx(U6,{step:V,t:s,createAI:a,wish:L,setWish:q,outcome:z,setOutcome:E,obstacle:x,setObstacle:R,plan:N,setPlan:M,isRecurring:U,setIsRecurring:b,recurringDays:xe,setRecurringDays:Ye,deadline:Ue,setDeadline:Ee,noDeadline:Z,setNoDeadline:he,category:fe,setCategory:Ce,userCategories:l,errors:Le,language:o})},V)]}),h.jsxs("div",{className:"goal-assistant-nav",children:[V>1?h.jsx("button",{onClick:Un,className:"secondary",children:s("back_button")}):h.jsx("button",{onClick:v,className:"secondary",children:s("cancel_button")}),h.jsx("button",{onClick:Er,className:"primary",children:s(V===gi?i?"save_button":"add_button":"next_button")})]})]}):I==="quick"?h.jsxs(h.Fragment,{children:[h.jsxs("div",{style:{padding:"24px 16px",flex:1,overflowY:"auto"},children:[h.jsxs("div",{style:{marginBottom:"20px"},children:[h.jsx("h3",{style:{fontSize:"1rem",fontWeight:"600",marginBottom:"12px"},children:" "}),h.jsx("div",{className:"step-guidance",children:h.jsx("p",{className:"tip",children:"  "})}),h.jsx("textarea",{value:Oe,onChange:le=>Dt(le.target.value),placeholder:":  ",rows:2,style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontSize:"14px",fontFamily:"inherit",resize:"none",marginTop:"12px"},onKeyPress:le=>{le.key==="Enter"&&le.ctrlKey&&Cn()}})]}),h.jsx("hr",{}),h.jsxs("div",{style:{marginBottom:"20px"},children:[h.jsx("div",{className:"step-guidance",style:{marginTop:"16px"},children:h.jsx("p",{className:"tip",children:"  ()"})}),h.jsxs("label",{className:"settings-item standalone-toggle",style:{marginTop:"12px"},children:[h.jsx("span",{style:{fontWeight:"500"},children:" "}),h.jsxs("label",{className:"theme-toggle-switch",children:[h.jsx("input",{type:"checkbox",checked:!!Ne,onChange:le=>je(le.target.checked?new Date().toISOString().split("T")[0]:"")}),h.jsx("span",{className:"slider round"})]})]}),Ne&&h.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",marginTop:"12px"},children:[h.jsxs("div",{children:[h.jsx("label",{style:{fontSize:"12px",opacity:.7,display:"block",marginBottom:"4px"},children:""}),h.jsx("input",{type:"date",value:Ne,onChange:le=>je(le.target.value),style:{width:"100%",padding:"10px",borderRadius:"6px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontSize:"13px"}})]}),h.jsxs("div",{children:[h.jsx("label",{style:{fontSize:"12px",opacity:.7,display:"block",marginBottom:"4px"},children:" ()"}),h.jsx("input",{type:"time",value:Ut,onChange:le=>Ot(le.target.value),style:{width:"100%",padding:"10px",borderRadius:"6px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontSize:"13px"}})]})]})]}),h.jsx("hr",{}),h.jsxs("div",{style:{marginBottom:"24px"},children:[h.jsx("div",{className:"step-guidance",style:{marginTop:"16px"},children:h.jsx("p",{className:"tip",children:s("category_label")})}),h.jsx("div",{style:{display:"grid",gridTemplateColumns:l&&l.length>2?"repeat(2, 1fr)":"repeat(1, 1fr)",gap:"8px",marginTop:"12px"},children:l&&l.map(le=>h.jsx("button",{onClick:()=>er(le),className:`category-button ${In===le?"active":""}`,children:le},le))})]})]}),h.jsxs("div",{className:"goal-assistant-nav",children:[h.jsx("button",{onClick:v,className:"secondary",children:s("cancel_button")}),h.jsx("button",{onClick:Cn,className:"primary",disabled:!Oe.trim(),children:s("add_button")})]})]}):I==="assignment"?h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:"goal-assistant-step-content",children:[h.jsxs("div",{className:"info-section",children:[h.jsx("h4",{children:s("subject")}),h.jsx("input",{type:"text",value:Je,onChange:le=>Tr(le.target.value),placeholder:": ",disabled:Qe,style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",opacity:Qe?.6:1,cursor:Qe?"not-allowed":"text"}})]}),h.jsxs("div",{className:"info-section",children:[h.jsx("h4",{children:s("assignment_name")}),h.jsx("input",{type:"text",value:_t,onChange:le=>ae(le.target.value),placeholder:":   3",disabled:Qe,style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",opacity:Qe?.6:1,cursor:Qe?"not-allowed":"text"}})]}),h.jsxs("div",{className:"info-section",children:[h.jsxs("h4",{children:[s("assignment_description")," ()"]}),h.jsx("textarea",{value:Sn,onChange:le=>tr(le.target.value),placeholder:s("assignment_description_placeholder"),rows:3,disabled:Qe,style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",resize:"vertical",opacity:Qe?.6:1,cursor:Qe?"not-allowed":"text"}})]}),h.jsxs("div",{className:"info-section",children:[h.jsx("h4",{children:s("due_date")}),h.jsx("input",{type:"date",value:nr,onChange:le=>gn(le.target.value),min:new Date().toISOString().split("T")[0],disabled:an,style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",opacity:an?.5:1,cursor:an?"not-allowed":"text"}}),h.jsxs("div",{style:{marginTop:"12px",display:"flex",alignItems:"center",gap:"8px",cursor:"pointer",userSelect:"none"},onClick:()=>{Fn(!an),an||gn("")},children:[h.jsx("div",{style:{width:"44px",height:"24px",borderRadius:"12px",backgroundColor:an?"var(--primary-color)":"var(--border-color)",position:"relative",transition:"background-color 0.2s",cursor:"pointer"},children:h.jsx("div",{style:{width:"20px",height:"20px",borderRadius:"50%",backgroundColor:"white",position:"absolute",top:"2px",left:an?"22px":"2px",transition:"left 0.2s",boxShadow:"0 2px 4px rgba(0,0,0,0.2)"}})}),h.jsx("span",{style:{fontSize:"0.9rem",color:"var(--text-color)"},children:" "})]})]}),_t.trim()&&Je.trim()&&Qe&&h.jsx("div",{style:{padding:"16px",backgroundColor:"var(--bg-secondary-color)",borderRadius:"12px",border:"1px solid var(--primary-color)",marginBottom:"16px",textAlign:"center"},children:h.jsxs("p",{style:{fontSize:"0.95rem",color:"var(--primary-color)",margin:0},children:[" ",s("ai_analyzing"),"..."]})}),Et&&h.jsxs("div",{style:{padding:"16px",backgroundColor:"var(--bg-secondary-color)",borderRadius:"12px",border:"1px solid var(--border-color)",marginBottom:"16px"},children:[h.jsxs("h4",{style:{marginBottom:"8px",fontSize:"0.9rem"},children:[" ",s("ai_suggestion")]}),h.jsx("p",{style:{fontSize:"0.9rem",lineHeight:"1.5",color:"var(--text-secondary-color)",margin:0},children:Et})]}),h.jsxs("div",{className:"info-section",children:[h.jsx("h4",{children:s("difficulty")}),h.jsx("div",{style:{display:"flex",gap:"8px",justifyContent:"space-between"},children:[1,2,3,4,5].map(le=>h.jsx("button",{onClick:()=>!Qe&&on(le),disabled:Qe,style:{flex:1,padding:"12px",borderRadius:"8px",border:qe===le?"2px solid var(--primary-color)":"1px solid var(--border-color)",backgroundColor:qe===le?"var(--primary-color)":"var(--bg-secondary-color)",color:qe===le?"white":"var(--text-color)",cursor:Qe?"not-allowed":"pointer",fontSize:"0.9rem",fontWeight:qe===le?"600":"500",opacity:Qe?.6:1},children:le},le))})]}),h.jsxs("div",{className:"info-section",children:[h.jsx("h4",{children:s("estimated_time")}),h.jsx("input",{type:"number",value:Re,onChange:le=>Ge(le.target.value),placeholder:"",min:"1",disabled:Qe,style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",opacity:Qe?.6:1,cursor:Qe?"not-allowed":"text"}})]})]}),h.jsxs("div",{className:"goal-assistant-nav",style:{display:"flex",gap:"8px"},children:[h.jsx("button",{onClick:v,className:"secondary",children:s("cancel_button")}),h.jsx("button",{onClick:rr,className:"secondary",disabled:!_t.trim()||!Je.trim()||Qe,style:{flex:1},children:Qe?"  ...":" AI "}),h.jsx("button",{onClick:Or,className:"primary",disabled:!_t.trim()||!Je.trim()||!Re||!an&&!nr,style:{flex:1},children:s("add_assignment")})]})]}):n&&h.jsx(O6,{onGenerate:n,t:s,onCancel:v})})]})},B6=({assignment:t,onClose:e,onSave:n,t:r,analyzeAssignmentWithAI:i})=>{const[s,o]=Ss(e),[a,l]=G.useState(t.name),[u,p]=G.useState(t.subject),[m,g]=G.useState(t.estimatedMinutes.toString()),[v,I]=G.useState(t.difficulty),[P,V]=G.useState(t.dueDate),[C,S]=G.useState(!1),[A,L]=G.useState(""),q=async()=>{if(!(!a.trim()||!u.trim())){S(!0);try{const E=await i(a,u,"");E&&(g(E.estimatedMinutes.toString()),I(E.difficulty),L(E.studyTips||E.optimizedSchedule||""))}catch(E){console.error("AI  :",E)}finally{S(!1)}}},z=()=>{!a.trim()||!u.trim()||!m||!P||(n(t.id,{name:a.trim(),subject:u.trim(),estimatedMinutes:parseInt(m),difficulty:v,dueDate:P}),o())};return h.jsxs(mi,{onClose:o,isClosing:s,className:"info-modal",children:[h.jsxs("div",{className:"info-modal-content",children:[h.jsx("h2",{children:"  "}),h.jsxs("div",{className:"info-section",children:[h.jsx("h4",{children:r("assignment_name")}),h.jsx("input",{type:"text",value:a,onChange:E=>l(E.target.value),placeholder:":   3",style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)"}})]}),h.jsxs("div",{className:"info-section",children:[h.jsx("h4",{children:r("subject")}),h.jsx("input",{type:"text",value:u,onChange:E=>p(E.target.value),placeholder:": ",style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)"}})]}),h.jsxs("div",{className:"info-section",children:[h.jsx("h4",{children:r("estimated_time")}),h.jsx("input",{type:"number",value:m,onChange:E=>g(E.target.value),placeholder:"60",min:"1",style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)"}})]}),h.jsxs("div",{className:"info-section",children:[h.jsxs("h4",{children:[r("difficulty")," (1-5)"]}),h.jsx("div",{style:{display:"flex",gap:"8px",marginTop:"8px"},children:[1,2,3,4,5].map(E=>h.jsx("button",{onClick:()=>I(E),style:{padding:"8px 16px",borderRadius:"8px",border:v===E?"2px solid var(--primary-color)":"1px solid var(--border-color)",backgroundColor:v===E?"var(--primary-color)":"var(--button-bg-color)",color:v===E?"white":"var(--text-color)",cursor:"pointer",fontWeight:v===E?"600":"500"},children:E},E))})]}),h.jsxs("div",{className:"info-section",children:[h.jsx("h4",{children:r("due_date")}),h.jsx("input",{type:"date",value:P,onChange:E=>V(E.target.value),min:new Date().toISOString().split("T")[0],style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)"}})]})]}),h.jsxs("div",{className:"modal-buttons",style:{display:"flex",gap:"8px"},children:[h.jsx("button",{onClick:o,className:"secondary",children:r("cancel_button")}),h.jsx("button",{onClick:q,className:"secondary",disabled:!a.trim()||!u.trim()||C,style:{flex:1},children:C?"  ...":" AI "}),h.jsx("button",{onClick:z,className:"primary",disabled:!a.trim()||!u.trim()||!m||!P,style:{flex:1},children:" "})]})]})},G6=({todo:t,onClose:e,t:n,createAI:r,onDeleteGoal:i,userCategories:s,onUpdateGoal:o,onToggleComplete:a})=>{const[l,u]=Ss(e),[p,m]=G.useState(""),[g,v]=G.useState(!1),[I,P]=G.useState(!1),V=async()=>{v(!0),m(""),P(!1);try{const S=r();if(!S){m("AI    API  ."),v(!1);return}const A=`Based on the WOOP method, provide a concise and encouraging suggestion for the following goal: Wish: "${t.wish}", Best Outcome: "${t.outcome}", Obstacle: "${t.obstacle}", Plan: "${t.plan}". Focus on strengthening the plan or reframing the obstacle.`,L=await S.models.generateContent({model:"gemini-2.5-flash",contents:A});m(L.text)}catch(S){console.error(S),P(!0)}finally{v(!1)}},C=gg(t);return h.jsxs(mi,{onClose:u,isClosing:l,className:"info-modal",children:[h.jsxs("div",{className:"info-modal-content",children:[h.jsx("h2",{children:n(C?"goal_details_modal_title":"todo_details_title")}),C?h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:"info-section",children:[h.jsx("h4",{children:n("wish_label")}),h.jsx("p",{children:t.wish})]}),h.jsxs("div",{className:"info-section",children:[h.jsx("h4",{children:n("outcome_label")}),h.jsx("p",{children:t.outcome})]}),h.jsxs("div",{className:"info-section",children:[h.jsx("h4",{children:n("obstacle_label")}),h.jsx("p",{children:t.obstacle})]}),h.jsxs("div",{className:"info-section",children:[h.jsx("h4",{children:n("plan_label")}),h.jsx("p",{children:t.plan})]})]}):h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:"info-section",children:[h.jsx("h4",{children:n("task_title_label")}),h.jsx("p",{children:t.title})]}),t.date&&h.jsxs("div",{className:"info-section",children:[h.jsx("h4",{children:n("due_date_label")}),h.jsx("p",{children:new Date(t.date).toLocaleDateString()})]}),t.time&&h.jsxs("div",{className:"info-section",children:[h.jsx("h4",{children:n("time_label")}),h.jsx("p",{children:t.time})]}),h.jsxs("div",{className:"info-section",children:[h.jsx("h4",{children:n("completion_status_label")}),h.jsx("p",{children:t.completed?n("completed"):n("pending")})]})]}),s&&s.length>0&&o&&h.jsxs("div",{className:"info-section",style:{borderTop:"1px solid var(--border-color)",paddingTop:"16px",marginTop:"16px"},children:[h.jsx("h4",{style:{marginBottom:"12px"},children:n("category_label")}),h.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:s.map(S=>h.jsx("button",{onClick:()=>{o({...t,category:S}),u()},className:`category-button ${t.category===S?"active":""}`,style:{padding:"8px 16px",borderRadius:"20px",border:t.category===S?"2px solid var(--primary-color)":"2px solid var(--border-color)",backgroundColor:t.category===S?"var(--primary-color)":"transparent",color:t.category===S?"white":"var(--text-color)",cursor:"pointer",fontSize:"14px",fontWeight:t.category===S?"600":"500",transition:"all 0.25s ease",whiteSpace:"nowrap",display:"inline-block",boxShadow:t.category===S?"0 2px 8px rgba(88, 86, 214, 0.2)":"none"},children:S},S))})]}),C&&h.jsxs("div",{className:"ai-analysis-section",children:[h.jsx("h4",{children:n("ai_coach_suggestion")}),g?h.jsx("p",{children:n("ai_analyzing")}):p?h.jsx("p",{children:p}):I?h.jsx("p",{className:"ai-error",children:n("ai_sort_error_message")}):h.jsx("button",{onClick:V,className:"feedback-button",children:n("ai_coach_suggestion")})]})]}),h.jsxs("div",{className:"modal-buttons",children:[a&&h.jsx("button",{onClick:()=>{a(t.id),u()},className:`secondary ${t.completed?"destructive":""}`,children:t.completed?"  ":"  "}),i&&h.jsxs("button",{onClick:()=>{i(t.id)},className:"secondary destructive",children:[" ",n("delete_button")]}),h.jsx("button",{onClick:u,className:"primary",children:n("close_button")})]})]})},q6=({folder:t,onClose:e,t:n,googleUser:r,onUpdateCollaborators:i,setAlertConfig:s})=>{const[o,a]=Ss(e),[l,u]=G.useState(""),[p,m]=G.useState(!1),[g,v]=G.useState(""),[I,P]=G.useState(!1),V=async()=>{if(!(!t||!r)){m(!0);try{if(!g||g.trim().length===0){s({title:"  ",message:"      .",confirmText:"",onConfirm:()=>{}}),m(!1);return}const L={type:"folder_share",folderId:t.id,folderName:t.name,folderColor:t.color,goals:[],sharedBy:r==null?void 0:r.email,ownerId:r==null?void 0:r.uid,sharedAt:new Date().toISOString(),password:g},q=lt(ue,"users",r.uid,"folders"),z=be(q,t.id),E=t.collaborators||[];await yt(z,{collaborators:E,shareInfo:{password:g,createdAt:new Date().toISOString()},updatedAt:new Date().toISOString()},{merge:!0});const x=_g(JSON.stringify(L)),R=`${window.location.origin}${window.location.pathname}?folder_share=${encodeURIComponent(x)}`,N=await rR(R);u(N),s({title:"   ",message:" .  !",confirmText:"",onConfirm:()=>{navigator.clipboard.writeText(N)}})}catch(L){console.error("   :",L),s({title:" ",message:"   .  .",confirmText:"",onConfirm:()=>{}})}finally{m(!1)}}},C=()=>{l&&navigator.clipboard.writeText(l).then(()=>{s({title:" ",message:"  .",confirmText:"",onConfirm:()=>{}})})},S=async L=>{if(!(!t||!r))try{const q=lt(ue,"users",r.uid,"folders"),z=be(q,t.id),E=(t.collaborators||[]).filter(x=>x.userId!==L);await yt(z,{collaborators:E,updatedAt:new Date().toISOString()},{merge:!0}),i(t.id,E),s({title:" ",message:" .",confirmText:"",onConfirm:()=>{}})}catch(q){console.error("  :",q),s({title:" ",message:"  .",confirmText:"",onConfirm:()=>{}})}},A=async(L,q)=>{if(!(!t||!r))try{const z=lt(ue,"users",r.uid,"folders"),E=be(z,t.id),x=(t.collaborators||[]).map(R=>R.userId===L?{...R,role:q}:R);await yt(E,{collaborators:x,updatedAt:new Date().toISOString()},{merge:!0}),i(t.id,x),s({title:"  ",message:`  ${q==="editor"?"":""} .`,confirmText:"",onConfirm:()=>{}})}catch(z){console.error("  :",z)}};return t?h.jsxs(mi,{onClose:a,isClosing:o,className:"goal-assistant-modal",children:[h.jsxs("div",{className:"goal-assistant-header",children:[h.jsx("div",{className:"goal-assistant-header-left"}),h.jsxs("h2",{children:[t.name,"  "]}),h.jsx("div",{className:"goal-assistant-header-right",children:h.jsx("button",{onClick:a,className:"close-button",children:Ie.close})})]}),h.jsx("div",{className:"goal-assistant-body",children:h.jsxs("div",{style:{padding:"24px 16px"},children:[h.jsxs("div",{style:{marginBottom:"20px"},children:[h.jsx("h3",{style:{fontSize:"1rem",fontWeight:"600",marginBottom:"12px"},children:" "}),t.collaborators&&t.collaborators.length>0?h.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:t.collaborators.map(L=>h.jsxs("div",{className:"settings-item",style:{padding:"12px",backgroundColor:"var(--card-bg-color)",borderRadius:"8px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[h.jsxs("div",{style:{flex:1},children:[h.jsx("div",{style:{fontWeight:"500",fontSize:"0.95rem"},children:L.email}),L.role==="owner"?h.jsx("div",{style:{fontSize:"0.85rem",color:"var(--text-secondary-color)",marginTop:"2px"},children:""}):h.jsxs("select",{value:L.role,onChange:q=>A(L.userId,q.target.value),style:{fontSize:"0.85rem",padding:"4px 8px",marginTop:"4px",borderRadius:"4px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",cursor:"pointer"},children:[h.jsx("option",{value:"editor",children:""}),h.jsx("option",{value:"viewer",children:""})]})]}),L.role!=="owner"&&h.jsx("button",{onClick:()=>S(L.userId),style:{padding:"4px 12px",backgroundColor:"var(--danger-color)",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"0.8rem",marginLeft:"12px",whiteSpace:"nowrap"},children:""})]},L.userId))}):h.jsx("div",{className:"step-guidance",children:h.jsx("p",{className:"tip",children:" .    ."})})]}),h.jsx("hr",{style:{margin:"20px 0",border:"none",borderTop:"1px solid var(--border-color)"}}),h.jsxs("div",{style:{marginBottom:"20px"},children:[h.jsx("h3",{style:{fontSize:"1rem",fontWeight:"600",marginBottom:"12px"},children:"   "}),h.jsx("div",{className:"step-guidance",children:h.jsx("p",{className:"tip",children:"    ,      ."})}),l?h.jsxs("div",{style:{marginTop:"16px",display:"flex",flexDirection:"column",gap:"12px"},children:[h.jsx("div",{style:{padding:"12px",backgroundColor:"var(--card-bg-color)",borderRadius:"8px",border:"1px solid var(--border-color)"},children:h.jsx("input",{type:"text",readOnly:!0,value:l,onClick:L=>L.target.select(),style:{width:"100%",padding:"10px",border:"1px solid var(--border-color)",borderRadius:"6px",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontSize:"0.85rem",boxSizing:"border-box",fontFamily:"monospace"}})}),h.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[h.jsx("button",{onClick:C,className:"primary",children:" "}),h.jsx("button",{onClick:()=>{u(""),v(""),P(!1)},className:"secondary",children:" "})]})]}):h.jsxs("div",{style:{marginTop:"16px",display:"flex",flexDirection:"column",gap:"12px"},children:[h.jsxs("label",{className:"settings-item standalone-toggle",children:[h.jsx("span",{style:{fontWeight:"500"},children:"  "}),h.jsxs("label",{className:"theme-toggle-switch",children:[h.jsx("input",{type:"checkbox",checked:I,onChange:L=>{P(L.target.checked),L.target.checked||v("")}}),h.jsx("span",{className:"slider round"})]})]}),I&&h.jsx("input",{type:"password",placeholder:" ",value:g,onChange:L=>v(L.target.value),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontFamily:"inherit",fontSize:"14px",boxSizing:"border-box"}}),h.jsx("button",{onClick:V,disabled:p||!g.trim(),className:"primary",style:{width:"100%",padding:"14px 0",backgroundColor:"var(--primary-color)",color:"white",border:"none",borderRadius:"24px",boxShadow:"0 2px 8px rgba(88,86,214,0.08)",fontWeight:700,fontSize:"16px",letterSpacing:"0.01em",cursor:p||!g.trim()?"not-allowed":"pointer",opacity:p||!g.trim()?.6:1,transition:"all 0.2s"},children:p?"  ...":"  "})]})]})]})}),h.jsxs("div",{className:"goal-assistant-nav",children:[h.jsx("div",{}),h.jsx("button",{onClick:a,className:"primary",children:""})]})]}):null},z6=({onClose:t,isDarkMode:e,onToggleDarkMode:n,themeMode:r,onThemeChange:i,backgroundTheme:s,onSetBackgroundTheme:o,onExportData:a,onImportData:l,setAlertConfig:u,onDeleteAllData:p,dataActionStatus:m,language:g,onSetLanguage:v,t:I,todos:P,setToastMessage:V,onOpenVersionInfo:C,onOpenUsageGuide:S,apiKey:A,onSetApiKey:L,isOfflineMode:q,onToggleOfflineMode:z,googleUser:E,onGoogleLogin:x,onGoogleLogout:R,onSyncDataToFirebase:N,onLoadDataFromFirebase:M,isGoogleLoggingIn:U=!1,isGoogleLoggingOut:b=!1,isSyncingData:xe=!1,isLoadingData:Ye=!1,isAutoSyncEnabled:Ue,setIsAutoSyncEnabled:Ee,notificationPermission:Z,setNotificationPermission:he})=>{const[fe,Ce]=Ss(t),[Le,At]=G.useState("appearance"),[Oe,Dt]=G.useState(""),[Ne,je]=G.useState(!1),[Ut,Ot]=G.useState("medium"),[In,er]=G.useState(null),_t=G.useRef(null),ae=[{id:"appearance",label:I("settings_section_background"),icon:Ie.background},{id:"general",label:I("settings_section_general"),icon:Ie.settings},{id:"data",label:I("settings_section_data"),icon:Ie.data}],Je=()=>u({title:I("delete_account_header"),message:I("delete_account_header_desc"),isDestructive:!0,confirmText:I("delete_all_data_button"),cancelText:I("cancel_button"),onConfirm:p,onCancel:()=>{}}),Tr=async()=>{if(!P||P.length===0){er(I("no_data_to_share"));return}je(!0);try{const Re=tI(P),Ge=`${window.location.origin}${window.location.pathname}?data=${encodeURIComponent(Re)}`,qe=await rR(Ge);Dt(qe),qe!==Ge&&qe.length<Ge.length?V(I("short_url_created")):V(I("share_link_created"))}catch(Re){console.error("Failed to create share link",Re);const Ge=tI(P),qe=`${window.location.origin}${window.location.pathname}?data=${encodeURIComponent(Ge)}`;Dt(qe),V(I("short_url_failed"))}finally{je(!1)}},Sn=()=>{Oe&&navigator.clipboard.writeText(Oe).then(()=>{V(I("link_copied_toast"))})},tr=()=>{switch(Le){case"appearance":return h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"settings-section-header",children:I("settings_theme_mode")}),h.jsxs("div",{className:"settings-section-body",children:[h.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>i("light"),children:[h.jsxs("div",{children:[h.jsx("span",{children:I("theme_mode_light")}),h.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:I("theme_mode_light_desc")})]}),r==="light"&&Ie.check]}),h.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>i("dark"),children:[h.jsxs("div",{children:[h.jsx("span",{children:I("theme_mode_dark")}),h.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:I("theme_mode_dark_desc")})]}),r==="dark"&&Ie.check]}),h.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>i("system"),children:[h.jsxs("div",{children:[h.jsx("span",{children:I("theme_mode_system")}),h.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:I("theme_mode_system_desc")})]}),r==="system"&&Ie.check]})]}),h.jsx("div",{className:"settings-section-header",children:I("settings_background_header")}),h.jsx("div",{className:"settings-section-body",children:yg.map(Re=>h.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>o(Re.id),children:[h.jsx("span",{children:I(e?Re.darkNameKey:Re.lightNameKey)}),s===Re.id&&Ie.check]},Re.id))})]});case"general":return h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"settings-section-header",children:I("settings_language")}),h.jsxs("div",{className:"settings-section-body",children:[h.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>v("ko"),children:[h.jsx("span",{children:""}),g==="ko"&&Ie.check]}),h.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>v("en"),children:[h.jsx("span",{children:"English"}),g==="en"&&Ie.check]})]}),h.jsx("div",{className:"settings-section-header",children:I("settings_api_key")}),h.jsxs("div",{className:"settings-section-body",children:[h.jsx("div",{className:"settings-item",children:h.jsx("input",{type:"password",placeholder:I("settings_api_key_placeholder"),value:A,onChange:Re=>L(Re.target.value),style:{width:"100%",padding:"8px",border:"1px solid var(--border-color)",borderRadius:"4px",backgroundColor:"var(--input-bg)"}})}),h.jsxs("label",{className:"settings-item",children:[h.jsxs("div",{children:[h.jsx("span",{children:I("settings_offline_mode")}),h.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:I("settings_offline_mode_desc")})]}),h.jsxs("div",{className:"theme-toggle-switch",children:[h.jsx("input",{type:"checkbox",checked:q,onChange:z}),h.jsx("span",{className:"slider round"})]})]})]}),h.jsx("div",{className:"settings-section-header",children:I("settings_section_info")}),h.jsxs("div",{className:"settings-section-body",children:[h.jsxs("div",{className:"settings-item nav-indicator",onClick:C,children:[h.jsx("span",{children:I("settings_version")}),h.jsxs("div",{className:"settings-item-value-with-icon",children:[h.jsx("span",{children:"2.0"}),Ie.forward]})]}),h.jsxs("div",{className:"settings-item nav-indicator",onClick:S,children:[h.jsx("span",{children:I("usage_guide_title")}),h.jsx("div",{className:"settings-item-value-with-icon",children:Ie.forward})]}),h.jsxs("div",{className:"settings-item",children:[h.jsx("span",{children:I("settings_developer")}),h.jsx("span",{className:"settings-item-value",children:I("developer_name")})]}),h.jsxs("div",{className:"settings-item",children:[h.jsx("span",{children:I("settings_copyright")}),h.jsx("span",{className:"settings-item-value",children:I("copyright_notice")})]})]})]});case"data":return h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"settings-section-header",children:""}),h.jsx("div",{className:"settings-section-body",children:E?h.jsxs("div",{children:[h.jsxs("div",{className:"settings-item",children:[h.jsxs("div",{children:[h.jsx("span",{children:"Google "}),h.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:E.email}),h.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:E.displayName})]}),h.jsx("span",{style:{color:"var(--success-color, #4CAF50)"},children:""})]}),h.jsx("button",{className:"settings-item action-item",onClick:R,disabled:b,style:{opacity:b?.6:1},children:h.jsx("span",{className:"action-text",children:b?"  ...":""})})]}):h.jsx("div",{children:h.jsx("div",{style:{display:"flex",justifyContent:"center",padding:"12px 0"},children:h.jsxs("button",{onClick:x,disabled:U,style:{backgroundColor:U?e?"#2A2A2A":"#E0E0E0":e?"#1F1F1F":"white",border:`1px solid ${e?"#404040":"#D3D3D3"}`,borderRadius:"24px",padding:"8px 20px",fontSize:"14px",fontWeight:"500",cursor:U?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"8px",color:U?e?"#666":"#999999":e?"#E0E0E0":"#1F2937",transition:"all 0.2s",opacity:U?.6:1},children:[e?h.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",children:[h.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),h.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),h.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),h.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}):h.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",children:[h.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),h.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),h.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),h.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),U?" ...":"Google "]})})})}),E&&h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"settings-section-header",children:I("settings_cloud_sync_header")}),h.jsxs("div",{className:"settings-section-body",children:[h.jsx("button",{className:"settings-item action-item",onClick:N,disabled:xe,children:h.jsx("span",{className:"action-text",children:I(xe?"settings_syncing":"settings_sync_data")})}),h.jsx("button",{className:"settings-item action-item",onClick:M,disabled:Ye,children:h.jsx("span",{className:"action-text",children:I(Ye?"settings_loading":"settings_load_from_cloud")})}),h.jsxs("label",{className:"settings-item",children:[h.jsxs("div",{children:[h.jsx("span",{children:I("settings_auto_sync")}),h.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:I("settings_auto_sync_desc")})]}),h.jsxs("div",{className:"theme-toggle-switch",children:[h.jsx("input",{type:"checkbox",checked:Ue,onChange:Re=>Ee(Re.target.checked)}),h.jsx("span",{className:"slider round"})]})]})]})]}),h.jsx("div",{className:"settings-section-header",children:I("settings_data_header")}),h.jsxs("div",{className:"settings-section-body",children:[h.jsx("div",{style:{fontSize:"12px",opacity:.7,marginBottom:"12px",padding:"8px",backgroundColor:"var(--bg-color-secondary)",borderRadius:"8px"},children:I("settings_data_header_desc")}),h.jsx("button",{className:"settings-item action-item",onClick:a,disabled:m!=="idle",children:h.jsx("span",{className:"action-text",children:I(m==="exporting"?"data_exporting":"settings_export_data")})}),h.jsxs("button",{className:"settings-item action-item",onClick:()=>{var Re;return(Re=_t.current)==null?void 0:Re.click()},disabled:m!=="idle",children:[h.jsx("span",{className:"action-text",children:I(m==="importing"?"data_importing":"settings_import_data")}),h.jsx("input",{type:"file",ref:_t,onChange:l,accept:".json",style:{display:"none"}})]})]}),P.length>0&&h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"settings-section-header",children:I("settings_share_link_header")}),h.jsxs("div",{className:"settings-section-body",children:[!Oe&&h.jsx("button",{className:"settings-item action-item",onClick:Tr,disabled:Ne,children:h.jsx("span",{className:"action-text",children:Ne?" URL  ...":I("settings_generate_link")})}),Oe&&h.jsxs("div",{className:"share-link-container",children:[h.jsxs("div",{style:{marginBottom:"8px",fontSize:"12px",opacity:.7},children:[Oe.length<100?" URL":" "," (",Oe.length,")"]}),h.jsx("input",{type:"text",readOnly:!0,value:Oe,onClick:Re=>Re.target.select()}),h.jsx("button",{onClick:Sn,children:I("settings_copy_link")})]})]})]}),h.jsx("div",{className:"settings-section-header",children:I("settings_delete_account")}),h.jsxs("div",{className:"settings-section-body",children:[h.jsx("div",{style:{fontSize:"12px",opacity:.7,marginBottom:"12px",padding:"8px",backgroundColor:"var(--bg-color-secondary)",borderRadius:"8px"},children:E?"         .     .":"    ."}),h.jsx("button",{className:"settings-item action-item",onClick:Je,disabled:m!=="idle",children:h.jsx("span",{className:"action-text destructive",children:I(m==="deleting"?"data_deleting":"settings_delete_account")})})]})]});default:return null}};return h.jsxs(mi,{onClose:Ce,isClosing:fe,className:"settings-modal",size:Ut,children:[h.jsxs("div",{className:"settings-modal-header",children:[h.jsx("div",{style:{width:"40px"}}),h.jsx("h2",{children:I("settings_title")}),h.jsx("div",{className:"settings-modal-header-right",style:{width:"40px"}})]}),h.jsxs("div",{className:"settings-modal-body",children:[h.jsx("div",{className:"settings-tabs",children:ae.map(Re=>h.jsxs("button",{className:`settings-tab-button ${Le===Re.id?"active":""}`,onClick:()=>At(Re.id),"aria-label":Re.label,children:[h.jsx("div",{className:"settings-tab-icon",children:Re.icon}),h.jsx("span",{children:Re.label})]},Re.id))}),h.jsx("div",{className:"settings-tab-content-container",children:h.jsx("div",{className:"settings-tab-content",children:tr()},Le)}),h.jsxs("div",{className:"goal-assistant-nav",style:{padding:"16px 24px",borderTop:"1px solid var(--border-color)"},children:[h.jsx("div",{style:{width:"1px"}}),h.jsx("button",{onClick:Ce,className:"primary",style:{minWidth:"120px"},children:I("settings_done_button")})]})]}),In&&h.jsx("div",{className:"modal-backdrop alert-backdrop",children:h.jsxs("div",{className:"modal-content alert-modal",children:[h.jsxs("div",{className:"alert-content",children:[h.jsx("h2",{children:""}),h.jsx("p",{children:In})]}),h.jsx("div",{className:"modal-buttons",children:h.jsx("button",{onClick:()=>er(null),className:"primary",children:""})})]})})]})},$6=({onClose:t,t:e})=>{const[n,r]=Ss(t),i="2.0.0 (25.10.24)",s=[{icon:"",title:" ",desc:"Step-by-step  . , (), (),  , ,  "},{icon:"",title:" / ",desc:" ,        "},{icon:"",title:"WOOP  ",desc:"5  (Wish  Outcome  Obstacle  Plan  /)   "},{icon:"",title:"AI  ",desc:"Gemini API     AI   "},{icon:"",title:"Google ",desc:"Google OAuth      "},{icon:"",title:"Firebase  ",desc:", ,     Firebase Firestore  "},{icon:"",title:"  ",desc:"       "},{icon:"",title:"  & ",desc:"//     8   "},{icon:"",title:"PWA & ",desc:" PWA   ,  ,   "},{icon:"",title:" ",desc:"3//      "},{icon:"",title:" /",desc:"JSON       "},{icon:"",title:" ",desc:",     "}];return h.jsxs(mi,{onClose:r,isClosing:n,className:"version-info-modal",children:[h.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%",overflow:"hidden"},children:[h.jsxs("div",{className:"version-info-header",style:{flexShrink:0,paddingBottom:"16px",borderBottom:"1px solid var(--border-color)"},children:[h.jsx("h2",{children:" Nova AI Planner v2.0"}),h.jsxs("p",{children:[e("build_number"),": ",i]})]}),h.jsx("div",{className:"version-info-body",children:s.map((o,a)=>h.jsxs("div",{className:"changelog-item",children:[h.jsx("div",{className:"changelog-icon",style:{"--icon-bg":"var(--primary-color)"},children:o.icon}),h.jsxs("div",{className:"changelog-text",children:[h.jsx("h3",{children:o.title}),h.jsx("p",{children:o.desc})]})]},a))})]}),h.jsx("div",{className:"modal-buttons",children:h.jsx("button",{onClick:r,className:"primary",children:e("settings_done_button")})})]})},j6=({onClose:t,t:e})=>{const[n,r]=Ss(t),i=o=>{const a=/(https?:\/\/[^\s]+)/g;return o.split(a).map((u,p)=>a.test(u)?h.jsx("a",{href:u,target:"_blank",rel:"noopener noreferrer",className:"guide-link",children:u},p):u)},s=[{titleKey:"usage_basic_title",descKey:"usage_basic_desc"},{titleKey:"usage_ai_setup_title",descKey:"usage_ai_setup_desc"},{titleKey:"usage_ai_use_title",descKey:"usage_ai_use_desc"},{titleKey:"usage_share_title",descKey:"usage_share_desc"},{titleKey:"usage_theme_title",descKey:"usage_theme_desc"},{titleKey:"usage_calendar_title",descKey:"usage_calendar_desc"},{titleKey:"usage_offline_title",descKey:"usage_offline_desc"}];return h.jsxs(mi,{onClose:r,isClosing:n,className:"usage-guide-modal",children:[h.jsx("div",{className:"version-info-header",children:h.jsx("h2",{children:e("usage_guide_title")})}),h.jsx("div",{className:"version-info-body",children:s.map((o,a)=>h.jsxs("div",{className:"usage-guide-item",children:[h.jsx("h3",{children:e(o.titleKey)}),h.jsx("p",{children:o.titleKey==="usage_ai_setup_title"?i(e(o.descKey)):e(o.descKey)})]},a))}),h.jsx("div",{className:"modal-buttons",children:h.jsx("button",{onClick:r,className:"primary",children:e("settings_done_button")})})]})},H6=({todos:t,t:e,onGoalClick:n,language:r})=>{const[i,s]=G.useState(new Date),[o,a]=G.useState("week"),l=g=>{const v=new Date(i);o==="month"?v.setMonth(v.getMonth()+g):o==="week"?v.setDate(v.getDate()+g*7):v.setDate(v.getDate()+g*3),s(v)},u=G.useMemo(()=>{const g=[];let v,I;if(o==="month"){const P=new Date(i.getFullYear(),i.getMonth(),1);v=Zw(P,r==="ko"?1:0),I=42}else o==="week"?(v=Zw(i,r==="ko"?1:0),I=7):(v=new Date(i),v.setDate(v.getDate()-1),I=3);for(let P=0;P<I;P++){const V=new Date(v);V.setDate(V.getDate()+P),g.push(V)}return g},[i,o,r]),p=G.useMemo(()=>{if(o==="month"){const g=i.getFullYear(),v=e("month_names")[i.getMonth()],I=e("calendar_header_month_format");return I&&typeof I=="string"&&I!=="calendar_header_month_format"?I.replace("{year}",String(g)).replace("{month}",v):`${v} ${g}`}return`${i.getFullYear()}.${i.getMonth()+1}`},[i,o,e]),m=G.useMemo(()=>{const g=e("day_names_short");if(r==="ko"&&Array.isArray(g)){const[v,...I]=g;return[...I,v]}return g},[r,e]);return h.jsxs("div",{className:"calendar-view-container",children:[h.jsxs("div",{className:"calendar-header",children:[h.jsx("button",{onClick:()=>l(-1),children:Ie.back}),h.jsx("h2",{children:p}),h.jsx("button",{onClick:()=>l(1),children:Ie.forward})]}),h.jsxs("div",{className:"calendar-view-mode-selector",children:[h.jsx("button",{onClick:()=>a("day3"),className:o==="day3"?"active":"",children:e("calendar_view_day3")}),h.jsx("button",{onClick:()=>a("week"),className:o==="week"?"active":"",children:e("calendar_view_week")}),h.jsx("button",{onClick:()=>a("month"),className:`calendar-view-button-month ${o==="month"?"active":""}`,children:e("calendar_view_month")})]}),(o==="week"||o==="month")&&h.jsx("div",{className:"calendar-days-of-week",children:Array.isArray(m)&&m.map(g=>h.jsx("div",{children:g},g))}),h.jsx("div",{className:`calendar-grid view-mode-${o}`,children:u.map(g=>{const I=hu(g,new Date),P=g.getMonth()===i.getMonth(),V=t.filter(C=>{if(C.isRecurring){const S=(g.getDay()+6)%7;return C.recurringDays.includes(S)}return C.deadline&&hu(g,C.deadline)});return h.jsxs("div",{className:`calendar-day ${!P&&o==="month"?"not-current-month":""} ${I?"is-today":""}`,"data-day-name":e("day_names_long")[g.getDay()],children:[h.jsx("div",{className:"day-header",children:h.jsx("span",{className:"day-number",children:g.getDate()})}),h.jsx("div",{className:"calendar-goals",children:V.map(C=>h.jsx("div",{className:`calendar-goal-item ${C.completed&&C.lastCompletedDate&&hu(g,C.lastCompletedDate)?"completed":""}`,onClick:()=>n(C),children:C.title||C.wish},C.id))})]},g.toISOString())})})]})},W6=({todo:t,onClose:e,onSave:n,t:r})=>{const[i,s]=Ss(e),[o,a]=G.useState(t.title||""),[l,u]=G.useState(t.deadline||""),[p,m]=G.useState(t.isRecurring||!1),[g,v]=G.useState(t.recurringDays||[]),[I,P]=G.useState(!t.deadline),V=()=>{const S={...t,title:o.trim(),deadline:I?"":l,isRecurring:p,recurringDays:g};n(S),s()},C=S=>{v(A=>A.includes(S)?A.filter(L=>L!==S):[...A,S].sort())};return h.jsxs(mi,{onClose:s,isClosing:i,className:"goal-assistant-modal",children:[h.jsxs("div",{className:"modal-header",children:[h.jsx("h2",{children:r("edit_todo_title")}),h.jsx("button",{onClick:s,className:"close-button","aria-label":r("close_button"),children:""})]}),h.jsxs("div",{className:"goal-assistant-body",children:[h.jsxs("div",{style:{padding:"24px 16px",flex:1,overflowY:"auto"},children:[h.jsxs("div",{style:{marginBottom:"20px"},children:[h.jsx("div",{className:"step-guidance",children:h.jsx("p",{className:"tip",children:r("todo_title_label")})}),h.jsx("textarea",{value:o,onChange:S=>a(S.target.value),placeholder:r("todo_title_placeholder"),rows:2,style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontSize:"14px",fontFamily:"inherit",resize:"none",marginTop:"12px"},autoFocus:!0})]}),h.jsx("hr",{}),h.jsxs("div",{style:{marginBottom:"20px"},children:[h.jsx("div",{className:"step-guidance",style:{marginTop:"16px"},children:h.jsxs("p",{className:"tip",children:[r("deadline_label")," ()"]})}),h.jsxs("label",{className:"settings-item standalone-toggle",style:{marginTop:"12px"},children:[h.jsx("span",{style:{fontWeight:"500"},children:" "}),h.jsxs("label",{className:"theme-toggle-switch",children:[h.jsx("input",{type:"checkbox",checked:!I,onChange:S=>{P(!S.target.checked),S.target.checked&&!l&&u(new Date().toISOString().split("T")[0])}}),h.jsx("span",{className:"slider round"})]})]}),!I&&h.jsx("div",{style:{marginTop:"12px"},children:h.jsx("input",{type:"date",value:l,onChange:S=>u(S.target.value),style:{width:"100%",padding:"10px",borderRadius:"6px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontSize:"13px"}})})]}),h.jsx("hr",{}),h.jsxs("div",{style:{marginBottom:"20px"},children:[h.jsx("div",{className:"step-guidance",style:{marginTop:"16px"},children:h.jsx("p",{className:"tip",children:r("recurring_label")})}),h.jsxs("label",{className:"settings-item standalone-toggle",style:{marginTop:"12px"},children:[h.jsx("span",{style:{fontWeight:"500"},children:" "}),h.jsxs("label",{className:"theme-toggle-switch",children:[h.jsx("input",{type:"checkbox",checked:p,onChange:S=>m(S.target.checked)}),h.jsx("span",{className:"slider round"})]})]}),p&&h.jsxs("div",{style:{marginTop:"12px"},children:[h.jsx("label",{style:{fontSize:"12px",opacity:.7,display:"block",marginBottom:"8px"},children:r("recurring_days_label")}),h.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:"8px"},children:["","","","","","",""].map((S,A)=>h.jsx("button",{type:"button",onClick:()=>C(A),style:{padding:"8px 4px",borderRadius:"6px",border:g.includes(A)?"2px solid var(--primary-color)":"2px solid var(--border-color)",backgroundColor:g.includes(A)?"var(--primary-color)":"transparent",color:g.includes(A)?"white":"var(--text-color)",fontSize:"12px",fontWeight:"500",cursor:"pointer",transition:"all 0.2s ease"},children:S},A))})]})]})]}),h.jsxs("div",{className:"goal-assistant-nav",children:[h.jsx("button",{onClick:s,className:"secondary",children:r("cancel_button")}),h.jsx("button",{onClick:V,className:"primary",disabled:!o.trim(),children:r("save_button")})]})]})]})},K6=({title:t,message:e,onConfirm:n,onCancel:r,confirmText:i,cancelText:s,isDestructive:o,t:a})=>{const l=typeof r=="function";return h.jsx("div",{className:"modal-backdrop alert-backdrop",children:h.jsxs("div",{className:"modal-content alert-modal",children:[h.jsxs("div",{className:"alert-content",children:[h.jsx("h2",{children:t}),h.jsx("p",{dangerouslySetInnerHTML:{__html:e}})]}),h.jsxs("div",{className:"modal-buttons",children:[l&&h.jsx("button",{onClick:r,className:"secondary",children:s||a("cancel_button")}),h.jsx("button",{onClick:n,className:o?"destructive":"primary",children:i||a("confirm_button")})]})]})})},J6=bp.createRoot(document.getElementById("root"));J6.render(h.jsx(hI.StrictMode,{children:h.jsx(b6,{})}));
