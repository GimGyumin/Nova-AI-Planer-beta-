(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();const tR="modulepreload",nR=function(t){return"/Nova-AI-Planer-beta-/"+t},yy={},gi=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(n.map(l=>{if(l=nR(l),l in yy)return;yy[l]=!0;const u=l.endsWith(".css"),f=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${f}`))return;const m=document.createElement("link");if(m.rel=u?"stylesheet":tR,u||(m.as="script"),m.crossOrigin="",m.href=l,a&&m.setAttribute("nonce",a),document.head.appendChild(m),u)return new Promise((g,v)=>{m.addEventListener("load",g),m.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return i.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return e().catch(s)})};function rR(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var XI={exports:{}},Sh={},ZI={exports:{}},be={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mu=Symbol.for("react.element"),iR=Symbol.for("react.portal"),sR=Symbol.for("react.fragment"),oR=Symbol.for("react.strict_mode"),aR=Symbol.for("react.profiler"),lR=Symbol.for("react.provider"),uR=Symbol.for("react.context"),cR=Symbol.for("react.forward_ref"),dR=Symbol.for("react.suspense"),hR=Symbol.for("react.memo"),fR=Symbol.for("react.lazy"),vy=Symbol.iterator;function pR(t){return t===null||typeof t!="object"?null:(t=vy&&t[vy]||t["@@iterator"],typeof t=="function"?t:null)}var ew={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},tw=Object.assign,nw={};function ka(t,e,n){this.props=t,this.context=e,this.refs=nw,this.updater=n||ew}ka.prototype.isReactComponent={};ka.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};ka.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function rw(){}rw.prototype=ka.prototype;function rg(t,e,n){this.props=t,this.context=e,this.refs=nw,this.updater=n||ew}var ig=rg.prototype=new rw;ig.constructor=rg;tw(ig,ka.prototype);ig.isPureReactComponent=!0;var Ty=Array.isArray,iw=Object.prototype.hasOwnProperty,sg={current:null},sw={key:!0,ref:!0,__self:!0,__source:!0};function ow(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)iw.call(e,r)&&!sw.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];i.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:Mu,type:t,key:s,ref:o,props:i,_owner:sg.current}}function mR(t,e){return{$$typeof:Mu,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function og(t){return typeof t=="object"&&t!==null&&t.$$typeof===Mu}function gR(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Ey=/\/+/g;function Nf(t,e){return typeof t=="object"&&t!==null&&t.key!=null?gR(""+t.key):e.toString(36)}function Qc(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Mu:case iR:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+Nf(o,0):r,Ty(i)?(n="",t!=null&&(n=t.replace(Ey,"$&/")+"/"),Qc(i,e,n,"",function(u){return u})):i!=null&&(og(i)&&(i=mR(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(Ey,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",Ty(t))for(var a=0;a<t.length;a++){s=t[a];var l=r+Nf(s,a);o+=Qc(s,e,n,l,i)}else if(l=pR(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=r+Nf(s,a++),o+=Qc(s,e,n,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Cc(t,e,n){if(t==null)return t;var r=[],i=0;return Qc(t,r,"","",function(s){return e.call(n,s,i++)}),r}function _R(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var un={current:null},Yc={transition:null},yR={ReactCurrentDispatcher:un,ReactCurrentBatchConfig:Yc,ReactCurrentOwner:sg};function aw(){throw Error("act(...) is not supported in production builds of React.")}be.Children={map:Cc,forEach:function(t,e,n){Cc(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Cc(t,function(){e++}),e},toArray:function(t){return Cc(t,function(e){return e})||[]},only:function(t){if(!og(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};be.Component=ka;be.Fragment=sR;be.Profiler=aR;be.PureComponent=rg;be.StrictMode=oR;be.Suspense=dR;be.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=yR;be.act=aw;be.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=tw({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=sg.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)iw.call(e,l)&&!sw.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];r.children=a}return{$$typeof:Mu,type:t.type,key:i,ref:s,props:r,_owner:o}};be.createContext=function(t){return t={$$typeof:uR,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:lR,_context:t},t.Consumer=t};be.createElement=ow;be.createFactory=function(t){var e=ow.bind(null,t);return e.type=t,e};be.createRef=function(){return{current:null}};be.forwardRef=function(t){return{$$typeof:cR,render:t}};be.isValidElement=og;be.lazy=function(t){return{$$typeof:fR,_payload:{_status:-1,_result:t},_init:_R}};be.memo=function(t,e){return{$$typeof:hR,type:t,compare:e===void 0?null:e}};be.startTransition=function(t){var e=Yc.transition;Yc.transition={};try{t()}finally{Yc.transition=e}};be.unstable_act=aw;be.useCallback=function(t,e){return un.current.useCallback(t,e)};be.useContext=function(t){return un.current.useContext(t)};be.useDebugValue=function(){};be.useDeferredValue=function(t){return un.current.useDeferredValue(t)};be.useEffect=function(t,e){return un.current.useEffect(t,e)};be.useId=function(){return un.current.useId()};be.useImperativeHandle=function(t,e,n){return un.current.useImperativeHandle(t,e,n)};be.useInsertionEffect=function(t,e){return un.current.useInsertionEffect(t,e)};be.useLayoutEffect=function(t,e){return un.current.useLayoutEffect(t,e)};be.useMemo=function(t,e){return un.current.useMemo(t,e)};be.useReducer=function(t,e,n){return un.current.useReducer(t,e,n)};be.useRef=function(t){return un.current.useRef(t)};be.useState=function(t){return un.current.useState(t)};be.useSyncExternalStore=function(t,e,n){return un.current.useSyncExternalStore(t,e,n)};be.useTransition=function(){return un.current.useTransition()};be.version="18.3.1";ZI.exports=be;var z=ZI.exports;const lw=rR(z);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vR=z,TR=Symbol.for("react.element"),ER=Symbol.for("react.fragment"),IR=Object.prototype.hasOwnProperty,wR=vR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,SR={key:!0,ref:!0,__self:!0,__source:!0};function uw(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)IR.call(e,r)&&!SR.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:TR,type:t,key:s,ref:o,props:i,_owner:wR.current}}Sh.Fragment=ER;Sh.jsx=uw;Sh.jsxs=uw;XI.exports=Sh;var p=XI.exports,yp={},cw={exports:{}},Dn={},dw={exports:{}},hw={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(ne,ce){var ye=ne.length;ne.push(ce);e:for(;0<ye;){var we=ye-1>>>1,Pe=ne[we];if(0<i(Pe,ce))ne[we]=ce,ne[ye]=Pe,ye=we;else break e}}function n(ne){return ne.length===0?null:ne[0]}function r(ne){if(ne.length===0)return null;var ce=ne[0],ye=ne.pop();if(ye!==ce){ne[0]=ye;e:for(var we=0,Pe=ne.length,$e=Pe>>>1;we<$e;){var Ke=2*(we+1)-1,Mt=ne[Ke],lt=Ke+1,ge=ne[lt];if(0>i(Mt,ye))lt<Pe&&0>i(ge,Mt)?(ne[we]=ge,ne[lt]=ye,we=lt):(ne[we]=Mt,ne[Ke]=ye,we=Ke);else if(lt<Pe&&0>i(ge,ye))ne[we]=ge,ne[lt]=ye,we=lt;else break e}}return ce}function i(ne,ce){var ye=ne.sortIndex-ce.sortIndex;return ye!==0?ye:ne.id-ce.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],u=[],f=1,m=null,g=3,v=!1,T=!1,A=!1,D=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,I=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function P(ne){for(var ce=n(u);ce!==null;){if(ce.callback===null)r(u);else if(ce.startTime<=ne)r(u),ce.sortIndex=ce.expirationTime,e(l,ce);else break;ce=n(u)}}function V(ne){if(A=!1,P(ne),!T)if(n(l)!==null)T=!0,We(U);else{var ce=n(u);ce!==null&&Ee(V,ce.startTime-ne)}}function U(ne,ce){T=!1,A&&(A=!1,S(w),w=-1),v=!0;var ye=g;try{for(P(ce),m=n(l);m!==null&&(!(m.expirationTime>ce)||ne&&!b());){var we=m.callback;if(typeof we=="function"){m.callback=null,g=m.priorityLevel;var Pe=we(m.expirationTime<=ce);ce=t.unstable_now(),typeof Pe=="function"?m.callback=Pe:m===n(l)&&r(l),P(ce)}else r(l);m=n(l)}if(m!==null)var $e=!0;else{var Ke=n(u);Ke!==null&&Ee(V,Ke.startTime-ce),$e=!1}return $e}finally{m=null,g=ye,v=!1}}var O=!1,E=null,w=-1,C=5,k=-1;function b(){return!(t.unstable_now()-k<C)}function L(){if(E!==null){var ne=t.unstable_now();k=ne;var ce=!0;try{ce=E(!0,ne)}finally{ce?N():(O=!1,E=null)}}else O=!1}var N;if(typeof I=="function")N=function(){I(L)};else if(typeof MessageChannel<"u"){var De=new MessageChannel,Fe=De.port2;De.port1.onmessage=L,N=function(){Fe.postMessage(null)}}else N=function(){D(L,0)};function We(ne){E=ne,O||(O=!0,N())}function Ee(ne,ce){w=D(function(){ne(t.unstable_now())},ce)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ne){ne.callback=null},t.unstable_continueExecution=function(){T||v||(T=!0,We(U))},t.unstable_forceFrameRate=function(ne){0>ne||125<ne?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<ne?Math.floor(1e3/ne):5},t.unstable_getCurrentPriorityLevel=function(){return g},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(ne){switch(g){case 1:case 2:case 3:var ce=3;break;default:ce=g}var ye=g;g=ce;try{return ne()}finally{g=ye}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(ne,ce){switch(ne){case 1:case 2:case 3:case 4:case 5:break;default:ne=3}var ye=g;g=ne;try{return ce()}finally{g=ye}},t.unstable_scheduleCallback=function(ne,ce,ye){var we=t.unstable_now();switch(typeof ye=="object"&&ye!==null?(ye=ye.delay,ye=typeof ye=="number"&&0<ye?we+ye:we):ye=we,ne){case 1:var Pe=-1;break;case 2:Pe=250;break;case 5:Pe=1073741823;break;case 4:Pe=1e4;break;default:Pe=5e3}return Pe=ye+Pe,ne={id:f++,callback:ce,priorityLevel:ne,startTime:ye,expirationTime:Pe,sortIndex:-1},ye>we?(ne.sortIndex=ye,e(u,ne),n(l)===null&&ne===n(u)&&(A?(S(w),w=-1):A=!0,Ee(V,ye-we))):(ne.sortIndex=Pe,e(l,ne),T||v||(T=!0,We(U))),ne},t.unstable_shouldYield=b,t.unstable_wrapCallback=function(ne){var ce=g;return function(){var ye=g;g=ce;try{return ne.apply(this,arguments)}finally{g=ye}}}})(hw);dw.exports=hw;var CR=dw.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var AR=z,kn=CR;function te(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var fw=new Set,ru={};function oo(t,e){aa(t,e),aa(t+"Capture",e)}function aa(t,e){for(ru[t]=e,t=0;t<e.length;t++)fw.add(e[t])}var Hr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),vp=Object.prototype.hasOwnProperty,xR=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Iy={},wy={};function RR(t){return vp.call(wy,t)?!0:vp.call(Iy,t)?!1:xR.test(t)?wy[t]=!0:(Iy[t]=!0,!1)}function PR(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function kR(t,e,n,r){if(e===null||typeof e>"u"||PR(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function cn(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Ht={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Ht[t]=new cn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Ht[e]=new cn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Ht[t]=new cn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Ht[t]=new cn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Ht[t]=new cn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Ht[t]=new cn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Ht[t]=new cn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Ht[t]=new cn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Ht[t]=new cn(t,5,!1,t.toLowerCase(),null,!1,!1)});var ag=/[\-:]([a-z])/g;function lg(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(ag,lg);Ht[e]=new cn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(ag,lg);Ht[e]=new cn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(ag,lg);Ht[e]=new cn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Ht[t]=new cn(t,1,!1,t.toLowerCase(),null,!1,!1)});Ht.xlinkHref=new cn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Ht[t]=new cn(t,1,!1,t.toLowerCase(),null,!0,!0)});function ug(t,e,n,r){var i=Ht.hasOwnProperty(e)?Ht[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(kR(e,n,i,r)&&(n=null),r||i===null?RR(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Zr=AR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ac=Symbol.for("react.element"),Mo=Symbol.for("react.portal"),Vo=Symbol.for("react.fragment"),cg=Symbol.for("react.strict_mode"),Tp=Symbol.for("react.profiler"),pw=Symbol.for("react.provider"),mw=Symbol.for("react.context"),dg=Symbol.for("react.forward_ref"),Ep=Symbol.for("react.suspense"),Ip=Symbol.for("react.suspense_list"),hg=Symbol.for("react.memo"),Ti=Symbol.for("react.lazy"),gw=Symbol.for("react.offscreen"),Sy=Symbol.iterator;function dl(t){return t===null||typeof t!="object"?null:(t=Sy&&t[Sy]||t["@@iterator"],typeof t=="function"?t:null)}var mt=Object.assign,Df;function Cl(t){if(Df===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Df=e&&e[1]||""}return`
`+Df+t}var bf=!1;function Mf(t,e){if(!t||bf)return"";bf=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{bf=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Cl(t):""}function NR(t){switch(t.tag){case 5:return Cl(t.type);case 16:return Cl("Lazy");case 13:return Cl("Suspense");case 19:return Cl("SuspenseList");case 0:case 2:case 15:return t=Mf(t.type,!1),t;case 11:return t=Mf(t.type.render,!1),t;case 1:return t=Mf(t.type,!0),t;default:return""}}function wp(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Vo:return"Fragment";case Mo:return"Portal";case Tp:return"Profiler";case cg:return"StrictMode";case Ep:return"Suspense";case Ip:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case mw:return(t.displayName||"Context")+".Consumer";case pw:return(t._context.displayName||"Context")+".Provider";case dg:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case hg:return e=t.displayName||null,e!==null?e:wp(t.type)||"Memo";case Ti:e=t._payload,t=t._init;try{return wp(t(e))}catch{}}return null}function DR(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return wp(e);case 8:return e===cg?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Wi(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function _w(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function bR(t){var e=_w(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function xc(t){t._valueTracker||(t._valueTracker=bR(t))}function yw(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=_w(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Cd(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Sp(t,e){var n=e.checked;return mt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Cy(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Wi(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function vw(t,e){e=e.checked,e!=null&&ug(t,"checked",e,!1)}function Cp(t,e){vw(t,e);var n=Wi(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Ap(t,e.type,n):e.hasOwnProperty("defaultValue")&&Ap(t,e.type,Wi(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Ay(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Ap(t,e,n){(e!=="number"||Cd(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Al=Array.isArray;function jo(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Wi(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function xp(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(te(91));return mt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function xy(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(te(92));if(Al(n)){if(1<n.length)throw Error(te(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Wi(n)}}function Tw(t,e){var n=Wi(e.value),r=Wi(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Ry(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Ew(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Rp(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Ew(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Rc,Iw=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Rc=Rc||document.createElement("div"),Rc.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Rc.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function iu(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Vl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},MR=["Webkit","ms","Moz","O"];Object.keys(Vl).forEach(function(t){MR.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Vl[e]=Vl[t]})});function ww(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Vl.hasOwnProperty(t)&&Vl[t]?(""+e).trim():e+"px"}function Sw(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=ww(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var VR=mt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Pp(t,e){if(e){if(VR[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(te(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(te(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(te(61))}if(e.style!=null&&typeof e.style!="object")throw Error(te(62))}}function kp(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Np=null;function fg(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Dp=null,Jo=null,Qo=null;function Py(t){if(t=Fu(t)){if(typeof Dp!="function")throw Error(te(280));var e=t.stateNode;e&&(e=Ph(e),Dp(t.stateNode,t.type,e))}}function Cw(t){Jo?Qo?Qo.push(t):Qo=[t]:Jo=t}function Aw(){if(Jo){var t=Jo,e=Qo;if(Qo=Jo=null,Py(t),e)for(t=0;t<e.length;t++)Py(e[t])}}function xw(t,e){return t(e)}function Rw(){}var Vf=!1;function Pw(t,e,n){if(Vf)return t(e,n);Vf=!0;try{return xw(t,e,n)}finally{Vf=!1,(Jo!==null||Qo!==null)&&(Rw(),Aw())}}function su(t,e){var n=t.stateNode;if(n===null)return null;var r=Ph(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(te(231,e,typeof n));return n}var bp=!1;if(Hr)try{var hl={};Object.defineProperty(hl,"passive",{get:function(){bp=!0}}),window.addEventListener("test",hl,hl),window.removeEventListener("test",hl,hl)}catch{bp=!1}function LR(t,e,n,r,i,s,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(f){this.onError(f)}}var Ll=!1,Ad=null,xd=!1,Mp=null,FR={onError:function(t){Ll=!0,Ad=t}};function UR(t,e,n,r,i,s,o,a,l){Ll=!1,Ad=null,LR.apply(FR,arguments)}function OR(t,e,n,r,i,s,o,a,l){if(UR.apply(this,arguments),Ll){if(Ll){var u=Ad;Ll=!1,Ad=null}else throw Error(te(198));xd||(xd=!0,Mp=u)}}function ao(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function kw(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function ky(t){if(ao(t)!==t)throw Error(te(188))}function BR(t){var e=t.alternate;if(!e){if(e=ao(t),e===null)throw Error(te(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return ky(i),t;if(s===r)return ky(i),e;s=s.sibling}throw Error(te(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(te(189))}}if(n.alternate!==r)throw Error(te(190))}if(n.tag!==3)throw Error(te(188));return n.stateNode.current===n?t:e}function Nw(t){return t=BR(t),t!==null?Dw(t):null}function Dw(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Dw(t);if(e!==null)return e;t=t.sibling}return null}var bw=kn.unstable_scheduleCallback,Ny=kn.unstable_cancelCallback,qR=kn.unstable_shouldYield,GR=kn.unstable_requestPaint,Tt=kn.unstable_now,zR=kn.unstable_getCurrentPriorityLevel,pg=kn.unstable_ImmediatePriority,Mw=kn.unstable_UserBlockingPriority,Rd=kn.unstable_NormalPriority,$R=kn.unstable_LowPriority,Vw=kn.unstable_IdlePriority,Ch=null,Ir=null;function HR(t){if(Ir&&typeof Ir.onCommitFiberRoot=="function")try{Ir.onCommitFiberRoot(Ch,t,void 0,(t.current.flags&128)===128)}catch{}}var rr=Math.clz32?Math.clz32:jR,WR=Math.log,KR=Math.LN2;function jR(t){return t>>>=0,t===0?32:31-(WR(t)/KR|0)|0}var Pc=64,kc=4194304;function xl(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Pd(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=xl(a):(s&=o,s!==0&&(r=xl(s)))}else o=n&~i,o!==0?r=xl(o):s!==0&&(r=xl(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-rr(e),i=1<<n,r|=t[n],e&=~i;return r}function JR(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function QR(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-rr(s),a=1<<o,l=i[o];l===-1?(!(a&n)||a&r)&&(i[o]=JR(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function Vp(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Lw(){var t=Pc;return Pc<<=1,!(Pc&4194240)&&(Pc=64),t}function Lf(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Vu(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-rr(e),t[e]=n}function YR(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-rr(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function mg(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-rr(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var Je=0;function Fw(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Uw,gg,Ow,Bw,qw,Lp=!1,Nc=[],Ni=null,Di=null,bi=null,ou=new Map,au=new Map,Ii=[],XR="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Dy(t,e){switch(t){case"focusin":case"focusout":Ni=null;break;case"dragenter":case"dragleave":Di=null;break;case"mouseover":case"mouseout":bi=null;break;case"pointerover":case"pointerout":ou.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":au.delete(e.pointerId)}}function fl(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Fu(e),e!==null&&gg(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function ZR(t,e,n,r,i){switch(e){case"focusin":return Ni=fl(Ni,t,e,n,r,i),!0;case"dragenter":return Di=fl(Di,t,e,n,r,i),!0;case"mouseover":return bi=fl(bi,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return ou.set(s,fl(ou.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,au.set(s,fl(au.get(s)||null,t,e,n,r,i)),!0}return!1}function Gw(t){var e=Ms(t.target);if(e!==null){var n=ao(e);if(n!==null){if(e=n.tag,e===13){if(e=kw(n),e!==null){t.blockedOn=e,qw(t.priority,function(){Ow(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Xc(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Fp(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Np=r,n.target.dispatchEvent(r),Np=null}else return e=Fu(n),e!==null&&gg(e),t.blockedOn=n,!1;e.shift()}return!0}function by(t,e,n){Xc(t)&&n.delete(e)}function eP(){Lp=!1,Ni!==null&&Xc(Ni)&&(Ni=null),Di!==null&&Xc(Di)&&(Di=null),bi!==null&&Xc(bi)&&(bi=null),ou.forEach(by),au.forEach(by)}function pl(t,e){t.blockedOn===e&&(t.blockedOn=null,Lp||(Lp=!0,kn.unstable_scheduleCallback(kn.unstable_NormalPriority,eP)))}function lu(t){function e(i){return pl(i,t)}if(0<Nc.length){pl(Nc[0],t);for(var n=1;n<Nc.length;n++){var r=Nc[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Ni!==null&&pl(Ni,t),Di!==null&&pl(Di,t),bi!==null&&pl(bi,t),ou.forEach(e),au.forEach(e),n=0;n<Ii.length;n++)r=Ii[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Ii.length&&(n=Ii[0],n.blockedOn===null);)Gw(n),n.blockedOn===null&&Ii.shift()}var Yo=Zr.ReactCurrentBatchConfig,kd=!0;function tP(t,e,n,r){var i=Je,s=Yo.transition;Yo.transition=null;try{Je=1,_g(t,e,n,r)}finally{Je=i,Yo.transition=s}}function nP(t,e,n,r){var i=Je,s=Yo.transition;Yo.transition=null;try{Je=4,_g(t,e,n,r)}finally{Je=i,Yo.transition=s}}function _g(t,e,n,r){if(kd){var i=Fp(t,e,n,r);if(i===null)Wf(t,e,r,Nd,n),Dy(t,r);else if(ZR(i,t,e,n,r))r.stopPropagation();else if(Dy(t,r),e&4&&-1<XR.indexOf(t)){for(;i!==null;){var s=Fu(i);if(s!==null&&Uw(s),s=Fp(t,e,n,r),s===null&&Wf(t,e,r,Nd,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else Wf(t,e,r,null,n)}}var Nd=null;function Fp(t,e,n,r){if(Nd=null,t=fg(r),t=Ms(t),t!==null)if(e=ao(t),e===null)t=null;else if(n=e.tag,n===13){if(t=kw(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Nd=t,null}function zw(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(zR()){case pg:return 1;case Mw:return 4;case Rd:case $R:return 16;case Vw:return 536870912;default:return 16}default:return 16}}var Ri=null,yg=null,Zc=null;function $w(){if(Zc)return Zc;var t,e=yg,n=e.length,r,i="value"in Ri?Ri.value:Ri.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return Zc=i.slice(t,1<r?1-r:void 0)}function ed(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Dc(){return!0}function My(){return!1}function bn(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Dc:My,this.isPropagationStopped=My,this}return mt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Dc)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Dc)},persist:function(){},isPersistent:Dc}),e}var Na={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},vg=bn(Na),Lu=mt({},Na,{view:0,detail:0}),rP=bn(Lu),Ff,Uf,ml,Ah=mt({},Lu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Tg,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ml&&(ml&&t.type==="mousemove"?(Ff=t.screenX-ml.screenX,Uf=t.screenY-ml.screenY):Uf=Ff=0,ml=t),Ff)},movementY:function(t){return"movementY"in t?t.movementY:Uf}}),Vy=bn(Ah),iP=mt({},Ah,{dataTransfer:0}),sP=bn(iP),oP=mt({},Lu,{relatedTarget:0}),Of=bn(oP),aP=mt({},Na,{animationName:0,elapsedTime:0,pseudoElement:0}),lP=bn(aP),uP=mt({},Na,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),cP=bn(uP),dP=mt({},Na,{data:0}),Ly=bn(dP),hP={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fP={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},pP={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function mP(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=pP[t])?!!e[t]:!1}function Tg(){return mP}var gP=mt({},Lu,{key:function(t){if(t.key){var e=hP[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=ed(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?fP[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Tg,charCode:function(t){return t.type==="keypress"?ed(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?ed(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),_P=bn(gP),yP=mt({},Ah,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Fy=bn(yP),vP=mt({},Lu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Tg}),TP=bn(vP),EP=mt({},Na,{propertyName:0,elapsedTime:0,pseudoElement:0}),IP=bn(EP),wP=mt({},Ah,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),SP=bn(wP),CP=[9,13,27,32],Eg=Hr&&"CompositionEvent"in window,Fl=null;Hr&&"documentMode"in document&&(Fl=document.documentMode);var AP=Hr&&"TextEvent"in window&&!Fl,Hw=Hr&&(!Eg||Fl&&8<Fl&&11>=Fl),Uy=" ",Oy=!1;function Ww(t,e){switch(t){case"keyup":return CP.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Kw(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Lo=!1;function xP(t,e){switch(t){case"compositionend":return Kw(e);case"keypress":return e.which!==32?null:(Oy=!0,Uy);case"textInput":return t=e.data,t===Uy&&Oy?null:t;default:return null}}function RP(t,e){if(Lo)return t==="compositionend"||!Eg&&Ww(t,e)?(t=$w(),Zc=yg=Ri=null,Lo=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Hw&&e.locale!=="ko"?null:e.data;default:return null}}var PP={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function By(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!PP[t.type]:e==="textarea"}function jw(t,e,n,r){Cw(r),e=Dd(e,"onChange"),0<e.length&&(n=new vg("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Ul=null,uu=null;function kP(t){sS(t,0)}function xh(t){var e=Oo(t);if(yw(e))return t}function NP(t,e){if(t==="change")return e}var Jw=!1;if(Hr){var Bf;if(Hr){var qf="oninput"in document;if(!qf){var qy=document.createElement("div");qy.setAttribute("oninput","return;"),qf=typeof qy.oninput=="function"}Bf=qf}else Bf=!1;Jw=Bf&&(!document.documentMode||9<document.documentMode)}function Gy(){Ul&&(Ul.detachEvent("onpropertychange",Qw),uu=Ul=null)}function Qw(t){if(t.propertyName==="value"&&xh(uu)){var e=[];jw(e,uu,t,fg(t)),Pw(kP,e)}}function DP(t,e,n){t==="focusin"?(Gy(),Ul=e,uu=n,Ul.attachEvent("onpropertychange",Qw)):t==="focusout"&&Gy()}function bP(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return xh(uu)}function MP(t,e){if(t==="click")return xh(e)}function VP(t,e){if(t==="input"||t==="change")return xh(e)}function LP(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var lr=typeof Object.is=="function"?Object.is:LP;function cu(t,e){if(lr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!vp.call(e,i)||!lr(t[i],e[i]))return!1}return!0}function zy(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function $y(t,e){var n=zy(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=zy(n)}}function Yw(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Yw(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Xw(){for(var t=window,e=Cd();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Cd(t.document)}return e}function Ig(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function FP(t){var e=Xw(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Yw(n.ownerDocument.documentElement,n)){if(r!==null&&Ig(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=$y(n,s);var o=$y(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var UP=Hr&&"documentMode"in document&&11>=document.documentMode,Fo=null,Up=null,Ol=null,Op=!1;function Hy(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Op||Fo==null||Fo!==Cd(r)||(r=Fo,"selectionStart"in r&&Ig(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Ol&&cu(Ol,r)||(Ol=r,r=Dd(Up,"onSelect"),0<r.length&&(e=new vg("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Fo)))}function bc(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Uo={animationend:bc("Animation","AnimationEnd"),animationiteration:bc("Animation","AnimationIteration"),animationstart:bc("Animation","AnimationStart"),transitionend:bc("Transition","TransitionEnd")},Gf={},Zw={};Hr&&(Zw=document.createElement("div").style,"AnimationEvent"in window||(delete Uo.animationend.animation,delete Uo.animationiteration.animation,delete Uo.animationstart.animation),"TransitionEvent"in window||delete Uo.transitionend.transition);function Rh(t){if(Gf[t])return Gf[t];if(!Uo[t])return t;var e=Uo[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Zw)return Gf[t]=e[n];return t}var eS=Rh("animationend"),tS=Rh("animationiteration"),nS=Rh("animationstart"),rS=Rh("transitionend"),iS=new Map,Wy="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ts(t,e){iS.set(t,e),oo(e,[t])}for(var zf=0;zf<Wy.length;zf++){var $f=Wy[zf],OP=$f.toLowerCase(),BP=$f[0].toUpperCase()+$f.slice(1);ts(OP,"on"+BP)}ts(eS,"onAnimationEnd");ts(tS,"onAnimationIteration");ts(nS,"onAnimationStart");ts("dblclick","onDoubleClick");ts("focusin","onFocus");ts("focusout","onBlur");ts(rS,"onTransitionEnd");aa("onMouseEnter",["mouseout","mouseover"]);aa("onMouseLeave",["mouseout","mouseover"]);aa("onPointerEnter",["pointerout","pointerover"]);aa("onPointerLeave",["pointerout","pointerover"]);oo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));oo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));oo("onBeforeInput",["compositionend","keypress","textInput","paste"]);oo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));oo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));oo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Rl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),qP=new Set("cancel close invalid load scroll toggle".split(" ").concat(Rl));function Ky(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,OR(r,e,void 0,t),t.currentTarget=null}function sS(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;Ky(i,a,u),s=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;Ky(i,a,u),s=l}}}if(xd)throw t=Mp,xd=!1,Mp=null,t}function tt(t,e){var n=e[$p];n===void 0&&(n=e[$p]=new Set);var r=t+"__bubble";n.has(r)||(oS(e,t,2,!1),n.add(r))}function Hf(t,e,n){var r=0;e&&(r|=4),oS(n,t,r,e)}var Mc="_reactListening"+Math.random().toString(36).slice(2);function du(t){if(!t[Mc]){t[Mc]=!0,fw.forEach(function(n){n!=="selectionchange"&&(qP.has(n)||Hf(n,!1,t),Hf(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Mc]||(e[Mc]=!0,Hf("selectionchange",!1,e))}}function oS(t,e,n,r){switch(zw(e)){case 1:var i=tP;break;case 4:i=nP;break;default:i=_g}n=i.bind(null,e,n,t),i=void 0,!bp||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function Wf(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=Ms(a),o===null)return;if(l=o.tag,l===5||l===6){r=s=o;continue e}a=a.parentNode}}r=r.return}Pw(function(){var u=s,f=fg(n),m=[];e:{var g=iS.get(t);if(g!==void 0){var v=vg,T=t;switch(t){case"keypress":if(ed(n)===0)break e;case"keydown":case"keyup":v=_P;break;case"focusin":T="focus",v=Of;break;case"focusout":T="blur",v=Of;break;case"beforeblur":case"afterblur":v=Of;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":v=Vy;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":v=sP;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":v=TP;break;case eS:case tS:case nS:v=lP;break;case rS:v=IP;break;case"scroll":v=rP;break;case"wheel":v=SP;break;case"copy":case"cut":case"paste":v=cP;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":v=Fy}var A=(e&4)!==0,D=!A&&t==="scroll",S=A?g!==null?g+"Capture":null:g;A=[];for(var I=u,P;I!==null;){P=I;var V=P.stateNode;if(P.tag===5&&V!==null&&(P=V,S!==null&&(V=su(I,S),V!=null&&A.push(hu(I,V,P)))),D)break;I=I.return}0<A.length&&(g=new v(g,T,null,n,f),m.push({event:g,listeners:A}))}}if(!(e&7)){e:{if(g=t==="mouseover"||t==="pointerover",v=t==="mouseout"||t==="pointerout",g&&n!==Np&&(T=n.relatedTarget||n.fromElement)&&(Ms(T)||T[Wr]))break e;if((v||g)&&(g=f.window===f?f:(g=f.ownerDocument)?g.defaultView||g.parentWindow:window,v?(T=n.relatedTarget||n.toElement,v=u,T=T?Ms(T):null,T!==null&&(D=ao(T),T!==D||T.tag!==5&&T.tag!==6)&&(T=null)):(v=null,T=u),v!==T)){if(A=Vy,V="onMouseLeave",S="onMouseEnter",I="mouse",(t==="pointerout"||t==="pointerover")&&(A=Fy,V="onPointerLeave",S="onPointerEnter",I="pointer"),D=v==null?g:Oo(v),P=T==null?g:Oo(T),g=new A(V,I+"leave",v,n,f),g.target=D,g.relatedTarget=P,V=null,Ms(f)===u&&(A=new A(S,I+"enter",T,n,f),A.target=P,A.relatedTarget=D,V=A),D=V,v&&T)t:{for(A=v,S=T,I=0,P=A;P;P=Io(P))I++;for(P=0,V=S;V;V=Io(V))P++;for(;0<I-P;)A=Io(A),I--;for(;0<P-I;)S=Io(S),P--;for(;I--;){if(A===S||S!==null&&A===S.alternate)break t;A=Io(A),S=Io(S)}A=null}else A=null;v!==null&&jy(m,g,v,A,!1),T!==null&&D!==null&&jy(m,D,T,A,!0)}}e:{if(g=u?Oo(u):window,v=g.nodeName&&g.nodeName.toLowerCase(),v==="select"||v==="input"&&g.type==="file")var U=NP;else if(By(g))if(Jw)U=VP;else{U=bP;var O=DP}else(v=g.nodeName)&&v.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(U=MP);if(U&&(U=U(t,u))){jw(m,U,n,f);break e}O&&O(t,g,u),t==="focusout"&&(O=g._wrapperState)&&O.controlled&&g.type==="number"&&Ap(g,"number",g.value)}switch(O=u?Oo(u):window,t){case"focusin":(By(O)||O.contentEditable==="true")&&(Fo=O,Up=u,Ol=null);break;case"focusout":Ol=Up=Fo=null;break;case"mousedown":Op=!0;break;case"contextmenu":case"mouseup":case"dragend":Op=!1,Hy(m,n,f);break;case"selectionchange":if(UP)break;case"keydown":case"keyup":Hy(m,n,f)}var E;if(Eg)e:{switch(t){case"compositionstart":var w="onCompositionStart";break e;case"compositionend":w="onCompositionEnd";break e;case"compositionupdate":w="onCompositionUpdate";break e}w=void 0}else Lo?Ww(t,n)&&(w="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(w="onCompositionStart");w&&(Hw&&n.locale!=="ko"&&(Lo||w!=="onCompositionStart"?w==="onCompositionEnd"&&Lo&&(E=$w()):(Ri=f,yg="value"in Ri?Ri.value:Ri.textContent,Lo=!0)),O=Dd(u,w),0<O.length&&(w=new Ly(w,t,null,n,f),m.push({event:w,listeners:O}),E?w.data=E:(E=Kw(n),E!==null&&(w.data=E)))),(E=AP?xP(t,n):RP(t,n))&&(u=Dd(u,"onBeforeInput"),0<u.length&&(f=new Ly("onBeforeInput","beforeinput",null,n,f),m.push({event:f,listeners:u}),f.data=E))}sS(m,e)})}function hu(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Dd(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=su(t,n),s!=null&&r.unshift(hu(t,s,i)),s=su(t,e),s!=null&&r.push(hu(t,s,i))),t=t.return}return r}function Io(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function jy(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,u=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&u!==null&&(a=u,i?(l=su(n,s),l!=null&&o.unshift(hu(n,l,a))):i||(l=su(n,s),l!=null&&o.push(hu(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var GP=/\r\n?/g,zP=/\u0000|\uFFFD/g;function Jy(t){return(typeof t=="string"?t:""+t).replace(GP,`
`).replace(zP,"")}function Vc(t,e,n){if(e=Jy(e),Jy(t)!==e&&n)throw Error(te(425))}function bd(){}var Bp=null,qp=null;function Gp(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var zp=typeof setTimeout=="function"?setTimeout:void 0,$P=typeof clearTimeout=="function"?clearTimeout:void 0,Qy=typeof Promise=="function"?Promise:void 0,HP=typeof queueMicrotask=="function"?queueMicrotask:typeof Qy<"u"?function(t){return Qy.resolve(null).then(t).catch(WP)}:zp;function WP(t){setTimeout(function(){throw t})}function Kf(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),lu(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);lu(e)}function Mi(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Yy(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Da=Math.random().toString(36).slice(2),vr="__reactFiber$"+Da,fu="__reactProps$"+Da,Wr="__reactContainer$"+Da,$p="__reactEvents$"+Da,KP="__reactListeners$"+Da,jP="__reactHandles$"+Da;function Ms(t){var e=t[vr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Wr]||n[vr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Yy(t);t!==null;){if(n=t[vr])return n;t=Yy(t)}return e}t=n,n=t.parentNode}return null}function Fu(t){return t=t[vr]||t[Wr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Oo(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(te(33))}function Ph(t){return t[fu]||null}var Hp=[],Bo=-1;function ns(t){return{current:t}}function rt(t){0>Bo||(t.current=Hp[Bo],Hp[Bo]=null,Bo--)}function et(t,e){Bo++,Hp[Bo]=t.current,t.current=e}var Ki={},en=ns(Ki),_n=ns(!1),Ws=Ki;function la(t,e){var n=t.type.contextTypes;if(!n)return Ki;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function yn(t){return t=t.childContextTypes,t!=null}function Md(){rt(_n),rt(en)}function Xy(t,e,n){if(en.current!==Ki)throw Error(te(168));et(en,e),et(_n,n)}function aS(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(te(108,DR(t)||"Unknown",i));return mt({},n,r)}function Vd(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ki,Ws=en.current,et(en,t),et(_n,_n.current),!0}function Zy(t,e,n){var r=t.stateNode;if(!r)throw Error(te(169));n?(t=aS(t,e,Ws),r.__reactInternalMemoizedMergedChildContext=t,rt(_n),rt(en),et(en,t)):rt(_n),et(_n,n)}var Lr=null,kh=!1,jf=!1;function lS(t){Lr===null?Lr=[t]:Lr.push(t)}function JP(t){kh=!0,lS(t)}function rs(){if(!jf&&Lr!==null){jf=!0;var t=0,e=Je;try{var n=Lr;for(Je=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Lr=null,kh=!1}catch(i){throw Lr!==null&&(Lr=Lr.slice(t+1)),bw(pg,rs),i}finally{Je=e,jf=!1}}return null}var qo=[],Go=0,Ld=null,Fd=0,Bn=[],qn=0,Ks=null,Ur=1,Or="";function Cs(t,e){qo[Go++]=Fd,qo[Go++]=Ld,Ld=t,Fd=e}function uS(t,e,n){Bn[qn++]=Ur,Bn[qn++]=Or,Bn[qn++]=Ks,Ks=t;var r=Ur;t=Or;var i=32-rr(r)-1;r&=~(1<<i),n+=1;var s=32-rr(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Ur=1<<32-rr(e)+i|n<<i|r,Or=s+t}else Ur=1<<s|n<<i|r,Or=t}function wg(t){t.return!==null&&(Cs(t,1),uS(t,1,0))}function Sg(t){for(;t===Ld;)Ld=qo[--Go],qo[Go]=null,Fd=qo[--Go],qo[Go]=null;for(;t===Ks;)Ks=Bn[--qn],Bn[qn]=null,Or=Bn[--qn],Bn[qn]=null,Ur=Bn[--qn],Bn[qn]=null}var Pn=null,xn=null,st=!1,er=null;function cS(t,e){var n=Gn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function ev(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Pn=t,xn=Mi(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Pn=t,xn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Ks!==null?{id:Ur,overflow:Or}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Gn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Pn=t,xn=null,!0):!1;default:return!1}}function Wp(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Kp(t){if(st){var e=xn;if(e){var n=e;if(!ev(t,e)){if(Wp(t))throw Error(te(418));e=Mi(n.nextSibling);var r=Pn;e&&ev(t,e)?cS(r,n):(t.flags=t.flags&-4097|2,st=!1,Pn=t)}}else{if(Wp(t))throw Error(te(418));t.flags=t.flags&-4097|2,st=!1,Pn=t}}}function tv(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Pn=t}function Lc(t){if(t!==Pn)return!1;if(!st)return tv(t),st=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Gp(t.type,t.memoizedProps)),e&&(e=xn)){if(Wp(t))throw dS(),Error(te(418));for(;e;)cS(t,e),e=Mi(e.nextSibling)}if(tv(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(te(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){xn=Mi(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}xn=null}}else xn=Pn?Mi(t.stateNode.nextSibling):null;return!0}function dS(){for(var t=xn;t;)t=Mi(t.nextSibling)}function ua(){xn=Pn=null,st=!1}function Cg(t){er===null?er=[t]:er.push(t)}var QP=Zr.ReactCurrentBatchConfig;function gl(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(te(309));var r=n.stateNode}if(!r)throw Error(te(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(te(284));if(!n._owner)throw Error(te(290,t))}return t}function Fc(t,e){throw t=Object.prototype.toString.call(e),Error(te(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function nv(t){var e=t._init;return e(t._payload)}function hS(t){function e(S,I){if(t){var P=S.deletions;P===null?(S.deletions=[I],S.flags|=16):P.push(I)}}function n(S,I){if(!t)return null;for(;I!==null;)e(S,I),I=I.sibling;return null}function r(S,I){for(S=new Map;I!==null;)I.key!==null?S.set(I.key,I):S.set(I.index,I),I=I.sibling;return S}function i(S,I){return S=Ui(S,I),S.index=0,S.sibling=null,S}function s(S,I,P){return S.index=P,t?(P=S.alternate,P!==null?(P=P.index,P<I?(S.flags|=2,I):P):(S.flags|=2,I)):(S.flags|=1048576,I)}function o(S){return t&&S.alternate===null&&(S.flags|=2),S}function a(S,I,P,V){return I===null||I.tag!==6?(I=tp(P,S.mode,V),I.return=S,I):(I=i(I,P),I.return=S,I)}function l(S,I,P,V){var U=P.type;return U===Vo?f(S,I,P.props.children,V,P.key):I!==null&&(I.elementType===U||typeof U=="object"&&U!==null&&U.$$typeof===Ti&&nv(U)===I.type)?(V=i(I,P.props),V.ref=gl(S,I,P),V.return=S,V):(V=ad(P.type,P.key,P.props,null,S.mode,V),V.ref=gl(S,I,P),V.return=S,V)}function u(S,I,P,V){return I===null||I.tag!==4||I.stateNode.containerInfo!==P.containerInfo||I.stateNode.implementation!==P.implementation?(I=np(P,S.mode,V),I.return=S,I):(I=i(I,P.children||[]),I.return=S,I)}function f(S,I,P,V,U){return I===null||I.tag!==7?(I=Bs(P,S.mode,V,U),I.return=S,I):(I=i(I,P),I.return=S,I)}function m(S,I,P){if(typeof I=="string"&&I!==""||typeof I=="number")return I=tp(""+I,S.mode,P),I.return=S,I;if(typeof I=="object"&&I!==null){switch(I.$$typeof){case Ac:return P=ad(I.type,I.key,I.props,null,S.mode,P),P.ref=gl(S,null,I),P.return=S,P;case Mo:return I=np(I,S.mode,P),I.return=S,I;case Ti:var V=I._init;return m(S,V(I._payload),P)}if(Al(I)||dl(I))return I=Bs(I,S.mode,P,null),I.return=S,I;Fc(S,I)}return null}function g(S,I,P,V){var U=I!==null?I.key:null;if(typeof P=="string"&&P!==""||typeof P=="number")return U!==null?null:a(S,I,""+P,V);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case Ac:return P.key===U?l(S,I,P,V):null;case Mo:return P.key===U?u(S,I,P,V):null;case Ti:return U=P._init,g(S,I,U(P._payload),V)}if(Al(P)||dl(P))return U!==null?null:f(S,I,P,V,null);Fc(S,P)}return null}function v(S,I,P,V,U){if(typeof V=="string"&&V!==""||typeof V=="number")return S=S.get(P)||null,a(I,S,""+V,U);if(typeof V=="object"&&V!==null){switch(V.$$typeof){case Ac:return S=S.get(V.key===null?P:V.key)||null,l(I,S,V,U);case Mo:return S=S.get(V.key===null?P:V.key)||null,u(I,S,V,U);case Ti:var O=V._init;return v(S,I,P,O(V._payload),U)}if(Al(V)||dl(V))return S=S.get(P)||null,f(I,S,V,U,null);Fc(I,V)}return null}function T(S,I,P,V){for(var U=null,O=null,E=I,w=I=0,C=null;E!==null&&w<P.length;w++){E.index>w?(C=E,E=null):C=E.sibling;var k=g(S,E,P[w],V);if(k===null){E===null&&(E=C);break}t&&E&&k.alternate===null&&e(S,E),I=s(k,I,w),O===null?U=k:O.sibling=k,O=k,E=C}if(w===P.length)return n(S,E),st&&Cs(S,w),U;if(E===null){for(;w<P.length;w++)E=m(S,P[w],V),E!==null&&(I=s(E,I,w),O===null?U=E:O.sibling=E,O=E);return st&&Cs(S,w),U}for(E=r(S,E);w<P.length;w++)C=v(E,S,w,P[w],V),C!==null&&(t&&C.alternate!==null&&E.delete(C.key===null?w:C.key),I=s(C,I,w),O===null?U=C:O.sibling=C,O=C);return t&&E.forEach(function(b){return e(S,b)}),st&&Cs(S,w),U}function A(S,I,P,V){var U=dl(P);if(typeof U!="function")throw Error(te(150));if(P=U.call(P),P==null)throw Error(te(151));for(var O=U=null,E=I,w=I=0,C=null,k=P.next();E!==null&&!k.done;w++,k=P.next()){E.index>w?(C=E,E=null):C=E.sibling;var b=g(S,E,k.value,V);if(b===null){E===null&&(E=C);break}t&&E&&b.alternate===null&&e(S,E),I=s(b,I,w),O===null?U=b:O.sibling=b,O=b,E=C}if(k.done)return n(S,E),st&&Cs(S,w),U;if(E===null){for(;!k.done;w++,k=P.next())k=m(S,k.value,V),k!==null&&(I=s(k,I,w),O===null?U=k:O.sibling=k,O=k);return st&&Cs(S,w),U}for(E=r(S,E);!k.done;w++,k=P.next())k=v(E,S,w,k.value,V),k!==null&&(t&&k.alternate!==null&&E.delete(k.key===null?w:k.key),I=s(k,I,w),O===null?U=k:O.sibling=k,O=k);return t&&E.forEach(function(L){return e(S,L)}),st&&Cs(S,w),U}function D(S,I,P,V){if(typeof P=="object"&&P!==null&&P.type===Vo&&P.key===null&&(P=P.props.children),typeof P=="object"&&P!==null){switch(P.$$typeof){case Ac:e:{for(var U=P.key,O=I;O!==null;){if(O.key===U){if(U=P.type,U===Vo){if(O.tag===7){n(S,O.sibling),I=i(O,P.props.children),I.return=S,S=I;break e}}else if(O.elementType===U||typeof U=="object"&&U!==null&&U.$$typeof===Ti&&nv(U)===O.type){n(S,O.sibling),I=i(O,P.props),I.ref=gl(S,O,P),I.return=S,S=I;break e}n(S,O);break}else e(S,O);O=O.sibling}P.type===Vo?(I=Bs(P.props.children,S.mode,V,P.key),I.return=S,S=I):(V=ad(P.type,P.key,P.props,null,S.mode,V),V.ref=gl(S,I,P),V.return=S,S=V)}return o(S);case Mo:e:{for(O=P.key;I!==null;){if(I.key===O)if(I.tag===4&&I.stateNode.containerInfo===P.containerInfo&&I.stateNode.implementation===P.implementation){n(S,I.sibling),I=i(I,P.children||[]),I.return=S,S=I;break e}else{n(S,I);break}else e(S,I);I=I.sibling}I=np(P,S.mode,V),I.return=S,S=I}return o(S);case Ti:return O=P._init,D(S,I,O(P._payload),V)}if(Al(P))return T(S,I,P,V);if(dl(P))return A(S,I,P,V);Fc(S,P)}return typeof P=="string"&&P!==""||typeof P=="number"?(P=""+P,I!==null&&I.tag===6?(n(S,I.sibling),I=i(I,P),I.return=S,S=I):(n(S,I),I=tp(P,S.mode,V),I.return=S,S=I),o(S)):n(S,I)}return D}var ca=hS(!0),fS=hS(!1),Ud=ns(null),Od=null,zo=null,Ag=null;function xg(){Ag=zo=Od=null}function Rg(t){var e=Ud.current;rt(Ud),t._currentValue=e}function jp(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Xo(t,e){Od=t,Ag=zo=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(mn=!0),t.firstContext=null)}function jn(t){var e=t._currentValue;if(Ag!==t)if(t={context:t,memoizedValue:e,next:null},zo===null){if(Od===null)throw Error(te(308));zo=t,Od.dependencies={lanes:0,firstContext:t}}else zo=zo.next=t;return e}var Vs=null;function Pg(t){Vs===null?Vs=[t]:Vs.push(t)}function pS(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,Pg(e)):(n.next=i.next,i.next=n),e.interleaved=n,Kr(t,r)}function Kr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Ei=!1;function kg(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function mS(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function zr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Vi(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Be&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Kr(t,n)}return i=r.interleaved,i===null?(e.next=e,Pg(r)):(e.next=i.next,i.next=e),r.interleaved=e,Kr(t,n)}function td(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,mg(t,n)}}function rv(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Bd(t,e,n,r){var i=t.updateQueue;Ei=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?s=u:o.next=u,o=l;var f=t.alternate;f!==null&&(f=f.updateQueue,a=f.lastBaseUpdate,a!==o&&(a===null?f.firstBaseUpdate=u:a.next=u,f.lastBaseUpdate=l))}if(s!==null){var m=i.baseState;o=0,f=u=l=null,a=s;do{var g=a.lane,v=a.eventTime;if((r&g)===g){f!==null&&(f=f.next={eventTime:v,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var T=t,A=a;switch(g=e,v=n,A.tag){case 1:if(T=A.payload,typeof T=="function"){m=T.call(v,m,g);break e}m=T;break e;case 3:T.flags=T.flags&-65537|128;case 0:if(T=A.payload,g=typeof T=="function"?T.call(v,m,g):T,g==null)break e;m=mt({},m,g);break e;case 2:Ei=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,g=i.effects,g===null?i.effects=[a]:g.push(a))}else v={eventTime:v,lane:g,tag:a.tag,payload:a.payload,callback:a.callback,next:null},f===null?(u=f=v,l=m):f=f.next=v,o|=g;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;g=a,a=g.next,g.next=null,i.lastBaseUpdate=g,i.shared.pending=null}}while(!0);if(f===null&&(l=m),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=f,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Js|=o,t.lanes=o,t.memoizedState=m}}function iv(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(te(191,i));i.call(r)}}}var Uu={},wr=ns(Uu),pu=ns(Uu),mu=ns(Uu);function Ls(t){if(t===Uu)throw Error(te(174));return t}function Ng(t,e){switch(et(mu,e),et(pu,t),et(wr,Uu),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Rp(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Rp(e,t)}rt(wr),et(wr,e)}function da(){rt(wr),rt(pu),rt(mu)}function gS(t){Ls(mu.current);var e=Ls(wr.current),n=Rp(e,t.type);e!==n&&(et(pu,t),et(wr,n))}function Dg(t){pu.current===t&&(rt(wr),rt(pu))}var ht=ns(0);function qd(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Jf=[];function bg(){for(var t=0;t<Jf.length;t++)Jf[t]._workInProgressVersionPrimary=null;Jf.length=0}var nd=Zr.ReactCurrentDispatcher,Qf=Zr.ReactCurrentBatchConfig,js=0,pt=null,Pt=null,Ut=null,Gd=!1,Bl=!1,gu=0,YP=0;function Wt(){throw Error(te(321))}function Mg(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!lr(t[n],e[n]))return!1;return!0}function Vg(t,e,n,r,i,s){if(js=s,pt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,nd.current=t===null||t.memoizedState===null?tk:nk,t=n(r,i),Bl){s=0;do{if(Bl=!1,gu=0,25<=s)throw Error(te(301));s+=1,Ut=Pt=null,e.updateQueue=null,nd.current=rk,t=n(r,i)}while(Bl)}if(nd.current=zd,e=Pt!==null&&Pt.next!==null,js=0,Ut=Pt=pt=null,Gd=!1,e)throw Error(te(300));return t}function Lg(){var t=gu!==0;return gu=0,t}function _r(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ut===null?pt.memoizedState=Ut=t:Ut=Ut.next=t,Ut}function Jn(){if(Pt===null){var t=pt.alternate;t=t!==null?t.memoizedState:null}else t=Pt.next;var e=Ut===null?pt.memoizedState:Ut.next;if(e!==null)Ut=e,Pt=t;else{if(t===null)throw Error(te(310));Pt=t,t={memoizedState:Pt.memoizedState,baseState:Pt.baseState,baseQueue:Pt.baseQueue,queue:Pt.queue,next:null},Ut===null?pt.memoizedState=Ut=t:Ut=Ut.next=t}return Ut}function _u(t,e){return typeof e=="function"?e(t):e}function Yf(t){var e=Jn(),n=e.queue;if(n===null)throw Error(te(311));n.lastRenderedReducer=t;var r=Pt,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,l=null,u=s;do{var f=u.lane;if((js&f)===f)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var m={lane:f,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=m,o=r):l=l.next=m,pt.lanes|=f,Js|=f}u=u.next}while(u!==null&&u!==s);l===null?o=r:l.next=a,lr(r,e.memoizedState)||(mn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,pt.lanes|=s,Js|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Xf(t){var e=Jn(),n=e.queue;if(n===null)throw Error(te(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);lr(s,e.memoizedState)||(mn=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function _S(){}function yS(t,e){var n=pt,r=Jn(),i=e(),s=!lr(r.memoizedState,i);if(s&&(r.memoizedState=i,mn=!0),r=r.queue,Fg(ES.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||Ut!==null&&Ut.memoizedState.tag&1){if(n.flags|=2048,yu(9,TS.bind(null,n,r,i,e),void 0,null),Ot===null)throw Error(te(349));js&30||vS(n,e,i)}return i}function vS(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=pt.updateQueue,e===null?(e={lastEffect:null,stores:null},pt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function TS(t,e,n,r){e.value=n,e.getSnapshot=r,IS(e)&&wS(t)}function ES(t,e,n){return n(function(){IS(e)&&wS(t)})}function IS(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!lr(t,n)}catch{return!0}}function wS(t){var e=Kr(t,1);e!==null&&ir(e,t,1,-1)}function sv(t){var e=_r();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:_u,lastRenderedState:t},e.queue=t,t=t.dispatch=ek.bind(null,pt,t),[e.memoizedState,t]}function yu(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=pt.updateQueue,e===null?(e={lastEffect:null,stores:null},pt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function SS(){return Jn().memoizedState}function rd(t,e,n,r){var i=_r();pt.flags|=t,i.memoizedState=yu(1|e,n,void 0,r===void 0?null:r)}function Nh(t,e,n,r){var i=Jn();r=r===void 0?null:r;var s=void 0;if(Pt!==null){var o=Pt.memoizedState;if(s=o.destroy,r!==null&&Mg(r,o.deps)){i.memoizedState=yu(e,n,s,r);return}}pt.flags|=t,i.memoizedState=yu(1|e,n,s,r)}function ov(t,e){return rd(8390656,8,t,e)}function Fg(t,e){return Nh(2048,8,t,e)}function CS(t,e){return Nh(4,2,t,e)}function AS(t,e){return Nh(4,4,t,e)}function xS(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function RS(t,e,n){return n=n!=null?n.concat([t]):null,Nh(4,4,xS.bind(null,e,t),n)}function Ug(){}function PS(t,e){var n=Jn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Mg(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function kS(t,e){var n=Jn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Mg(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function NS(t,e,n){return js&21?(lr(n,e)||(n=Lw(),pt.lanes|=n,Js|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,mn=!0),t.memoizedState=n)}function XP(t,e){var n=Je;Je=n!==0&&4>n?n:4,t(!0);var r=Qf.transition;Qf.transition={};try{t(!1),e()}finally{Je=n,Qf.transition=r}}function DS(){return Jn().memoizedState}function ZP(t,e,n){var r=Fi(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},bS(t))MS(e,n);else if(n=pS(t,e,n,r),n!==null){var i=on();ir(n,t,r,i),VS(n,e,r)}}function ek(t,e,n){var r=Fi(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(bS(t))MS(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,lr(a,o)){var l=e.interleaved;l===null?(i.next=i,Pg(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=pS(t,e,i,r),n!==null&&(i=on(),ir(n,t,r,i),VS(n,e,r))}}function bS(t){var e=t.alternate;return t===pt||e!==null&&e===pt}function MS(t,e){Bl=Gd=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function VS(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,mg(t,n)}}var zd={readContext:jn,useCallback:Wt,useContext:Wt,useEffect:Wt,useImperativeHandle:Wt,useInsertionEffect:Wt,useLayoutEffect:Wt,useMemo:Wt,useReducer:Wt,useRef:Wt,useState:Wt,useDebugValue:Wt,useDeferredValue:Wt,useTransition:Wt,useMutableSource:Wt,useSyncExternalStore:Wt,useId:Wt,unstable_isNewReconciler:!1},tk={readContext:jn,useCallback:function(t,e){return _r().memoizedState=[t,e===void 0?null:e],t},useContext:jn,useEffect:ov,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,rd(4194308,4,xS.bind(null,e,t),n)},useLayoutEffect:function(t,e){return rd(4194308,4,t,e)},useInsertionEffect:function(t,e){return rd(4,2,t,e)},useMemo:function(t,e){var n=_r();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=_r();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=ZP.bind(null,pt,t),[r.memoizedState,t]},useRef:function(t){var e=_r();return t={current:t},e.memoizedState=t},useState:sv,useDebugValue:Ug,useDeferredValue:function(t){return _r().memoizedState=t},useTransition:function(){var t=sv(!1),e=t[0];return t=XP.bind(null,t[1]),_r().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=pt,i=_r();if(st){if(n===void 0)throw Error(te(407));n=n()}else{if(n=e(),Ot===null)throw Error(te(349));js&30||vS(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,ov(ES.bind(null,r,s,t),[t]),r.flags|=2048,yu(9,TS.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=_r(),e=Ot.identifierPrefix;if(st){var n=Or,r=Ur;n=(r&~(1<<32-rr(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=gu++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=YP++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},nk={readContext:jn,useCallback:PS,useContext:jn,useEffect:Fg,useImperativeHandle:RS,useInsertionEffect:CS,useLayoutEffect:AS,useMemo:kS,useReducer:Yf,useRef:SS,useState:function(){return Yf(_u)},useDebugValue:Ug,useDeferredValue:function(t){var e=Jn();return NS(e,Pt.memoizedState,t)},useTransition:function(){var t=Yf(_u)[0],e=Jn().memoizedState;return[t,e]},useMutableSource:_S,useSyncExternalStore:yS,useId:DS,unstable_isNewReconciler:!1},rk={readContext:jn,useCallback:PS,useContext:jn,useEffect:Fg,useImperativeHandle:RS,useInsertionEffect:CS,useLayoutEffect:AS,useMemo:kS,useReducer:Xf,useRef:SS,useState:function(){return Xf(_u)},useDebugValue:Ug,useDeferredValue:function(t){var e=Jn();return Pt===null?e.memoizedState=t:NS(e,Pt.memoizedState,t)},useTransition:function(){var t=Xf(_u)[0],e=Jn().memoizedState;return[t,e]},useMutableSource:_S,useSyncExternalStore:yS,useId:DS,unstable_isNewReconciler:!1};function Yn(t,e){if(t&&t.defaultProps){e=mt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Jp(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:mt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Dh={isMounted:function(t){return(t=t._reactInternals)?ao(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=on(),i=Fi(t),s=zr(r,i);s.payload=e,n!=null&&(s.callback=n),e=Vi(t,s,i),e!==null&&(ir(e,t,i,r),td(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=on(),i=Fi(t),s=zr(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=Vi(t,s,i),e!==null&&(ir(e,t,i,r),td(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=on(),r=Fi(t),i=zr(n,r);i.tag=2,e!=null&&(i.callback=e),e=Vi(t,i,r),e!==null&&(ir(e,t,r,n),td(e,t,r))}};function av(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!cu(n,r)||!cu(i,s):!0}function LS(t,e,n){var r=!1,i=Ki,s=e.contextType;return typeof s=="object"&&s!==null?s=jn(s):(i=yn(e)?Ws:en.current,r=e.contextTypes,s=(r=r!=null)?la(t,i):Ki),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Dh,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function lv(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Dh.enqueueReplaceState(e,e.state,null)}function Qp(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},kg(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=jn(s):(s=yn(e)?Ws:en.current,i.context=la(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Jp(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Dh.enqueueReplaceState(i,i.state,null),Bd(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function ha(t,e){try{var n="",r=e;do n+=NR(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function Zf(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Yp(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var ik=typeof WeakMap=="function"?WeakMap:Map;function FS(t,e,n){n=zr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Hd||(Hd=!0,am=r),Yp(t,e)},n}function US(t,e,n){n=zr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){Yp(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){Yp(t,e),typeof r!="function"&&(Li===null?Li=new Set([this]):Li.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function uv(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new ik;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=yk.bind(null,t,e,n),e.then(t,t))}function cv(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function dv(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=zr(-1,1),e.tag=2,Vi(n,e,1))),n.lanes|=1),t)}var sk=Zr.ReactCurrentOwner,mn=!1;function nn(t,e,n,r){e.child=t===null?fS(e,null,n,r):ca(e,t.child,n,r)}function hv(t,e,n,r,i){n=n.render;var s=e.ref;return Xo(e,i),r=Vg(t,e,n,r,s,i),n=Lg(),t!==null&&!mn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,jr(t,e,i)):(st&&n&&wg(e),e.flags|=1,nn(t,e,r,i),e.child)}function fv(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!Wg(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,OS(t,e,s,r,i)):(t=ad(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:cu,n(o,r)&&t.ref===e.ref)return jr(t,e,i)}return e.flags|=1,t=Ui(s,r),t.ref=e.ref,t.return=e,e.child=t}function OS(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(cu(s,r)&&t.ref===e.ref)if(mn=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(mn=!0);else return e.lanes=t.lanes,jr(t,e,i)}return Xp(t,e,n,r,i)}function BS(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},et(Ho,Sn),Sn|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,et(Ho,Sn),Sn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,et(Ho,Sn),Sn|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,et(Ho,Sn),Sn|=r;return nn(t,e,i,n),e.child}function qS(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Xp(t,e,n,r,i){var s=yn(n)?Ws:en.current;return s=la(e,s),Xo(e,i),n=Vg(t,e,n,r,s,i),r=Lg(),t!==null&&!mn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,jr(t,e,i)):(st&&r&&wg(e),e.flags|=1,nn(t,e,n,i),e.child)}function pv(t,e,n,r,i){if(yn(n)){var s=!0;Vd(e)}else s=!1;if(Xo(e,i),e.stateNode===null)id(t,e),LS(e,n,r),Qp(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=jn(u):(u=yn(n)?Ws:en.current,u=la(e,u));var f=n.getDerivedStateFromProps,m=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function";m||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==u)&&lv(e,o,r,u),Ei=!1;var g=e.memoizedState;o.state=g,Bd(e,r,o,i),l=e.memoizedState,a!==r||g!==l||_n.current||Ei?(typeof f=="function"&&(Jp(e,n,f,r),l=e.memoizedState),(a=Ei||av(e,n,a,r,g,l,u))?(m||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=u,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,mS(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:Yn(e.type,a),o.props=u,m=e.pendingProps,g=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=jn(l):(l=yn(n)?Ws:en.current,l=la(e,l));var v=n.getDerivedStateFromProps;(f=typeof v=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==m||g!==l)&&lv(e,o,r,l),Ei=!1,g=e.memoizedState,o.state=g,Bd(e,r,o,i);var T=e.memoizedState;a!==m||g!==T||_n.current||Ei?(typeof v=="function"&&(Jp(e,n,v,r),T=e.memoizedState),(u=Ei||av(e,n,u,r,g,T,l)||!1)?(f||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,T,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,T,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=T),o.props=r,o.state=T,o.context=l,r=u):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),r=!1)}return Zp(t,e,n,r,s,i)}function Zp(t,e,n,r,i,s){qS(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&Zy(e,n,!1),jr(t,e,s);r=e.stateNode,sk.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=ca(e,t.child,null,s),e.child=ca(e,null,a,s)):nn(t,e,a,s),e.memoizedState=r.state,i&&Zy(e,n,!0),e.child}function GS(t){var e=t.stateNode;e.pendingContext?Xy(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Xy(t,e.context,!1),Ng(t,e.containerInfo)}function mv(t,e,n,r,i){return ua(),Cg(i),e.flags|=256,nn(t,e,n,r),e.child}var em={dehydrated:null,treeContext:null,retryLane:0};function tm(t){return{baseLanes:t,cachePool:null,transitions:null}}function zS(t,e,n){var r=e.pendingProps,i=ht.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),et(ht,i&1),t===null)return Kp(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=Vh(o,r,0,null),t=Bs(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=tm(n),e.memoizedState=em,t):Og(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return ok(t,e,o,r,a,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Ui(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=Ui(a,s):(s=Bs(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?tm(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=em,r}return s=t.child,t=s.sibling,r=Ui(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Og(t,e){return e=Vh({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Uc(t,e,n,r){return r!==null&&Cg(r),ca(e,t.child,null,n),t=Og(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function ok(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=Zf(Error(te(422))),Uc(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=Vh({mode:"visible",children:r.children},i,0,null),s=Bs(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&ca(e,t.child,null,o),e.child.memoizedState=tm(o),e.memoizedState=em,s);if(!(e.mode&1))return Uc(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(te(419)),r=Zf(s,r,void 0),Uc(t,e,o,r)}if(a=(o&t.childLanes)!==0,mn||a){if(r=Ot,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Kr(t,i),ir(r,t,i,-1))}return Hg(),r=Zf(Error(te(421))),Uc(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=vk.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,xn=Mi(i.nextSibling),Pn=e,st=!0,er=null,t!==null&&(Bn[qn++]=Ur,Bn[qn++]=Or,Bn[qn++]=Ks,Ur=t.id,Or=t.overflow,Ks=e),e=Og(e,r.children),e.flags|=4096,e)}function gv(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),jp(t.return,e,n)}function ep(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function $S(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(nn(t,e,r.children,n),r=ht.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&gv(t,n,e);else if(t.tag===19)gv(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(et(ht,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&qd(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),ep(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&qd(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}ep(e,!0,n,null,s);break;case"together":ep(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function id(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function jr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Js|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(te(153));if(e.child!==null){for(t=e.child,n=Ui(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Ui(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function ak(t,e,n){switch(e.tag){case 3:GS(e),ua();break;case 5:gS(e);break;case 1:yn(e.type)&&Vd(e);break;case 4:Ng(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;et(Ud,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(et(ht,ht.current&1),e.flags|=128,null):n&e.child.childLanes?zS(t,e,n):(et(ht,ht.current&1),t=jr(t,e,n),t!==null?t.sibling:null);et(ht,ht.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return $S(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),et(ht,ht.current),r)break;return null;case 22:case 23:return e.lanes=0,BS(t,e,n)}return jr(t,e,n)}var HS,nm,WS,KS;HS=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};nm=function(){};WS=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Ls(wr.current);var s=null;switch(n){case"input":i=Sp(t,i),r=Sp(t,r),s=[];break;case"select":i=mt({},i,{value:void 0}),r=mt({},r,{value:void 0}),s=[];break;case"textarea":i=xp(t,i),r=xp(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=bd)}Pp(n,r);var o;n=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var a=i[u];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(ru.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var l=r[u];if(a=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(ru.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&tt("scroll",t),s||a===l||(s=[])):(s=s||[]).push(u,l))}n&&(s=s||[]).push("style",n);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};KS=function(t,e,n,r){n!==r&&(e.flags|=4)};function _l(t,e){if(!st)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Kt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function lk(t,e,n){var r=e.pendingProps;switch(Sg(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Kt(e),null;case 1:return yn(e.type)&&Md(),Kt(e),null;case 3:return r=e.stateNode,da(),rt(_n),rt(en),bg(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Lc(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,er!==null&&(cm(er),er=null))),nm(t,e),Kt(e),null;case 5:Dg(e);var i=Ls(mu.current);if(n=e.type,t!==null&&e.stateNode!=null)WS(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(te(166));return Kt(e),null}if(t=Ls(wr.current),Lc(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[vr]=e,r[fu]=s,t=(e.mode&1)!==0,n){case"dialog":tt("cancel",r),tt("close",r);break;case"iframe":case"object":case"embed":tt("load",r);break;case"video":case"audio":for(i=0;i<Rl.length;i++)tt(Rl[i],r);break;case"source":tt("error",r);break;case"img":case"image":case"link":tt("error",r),tt("load",r);break;case"details":tt("toggle",r);break;case"input":Cy(r,s),tt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},tt("invalid",r);break;case"textarea":xy(r,s),tt("invalid",r)}Pp(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&Vc(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Vc(r.textContent,a,t),i=["children",""+a]):ru.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&tt("scroll",r)}switch(n){case"input":xc(r),Ay(r,s,!0);break;case"textarea":xc(r),Ry(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=bd)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Ew(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[vr]=e,t[fu]=r,HS(t,e,!1,!1),e.stateNode=t;e:{switch(o=kp(n,r),n){case"dialog":tt("cancel",t),tt("close",t),i=r;break;case"iframe":case"object":case"embed":tt("load",t),i=r;break;case"video":case"audio":for(i=0;i<Rl.length;i++)tt(Rl[i],t);i=r;break;case"source":tt("error",t),i=r;break;case"img":case"image":case"link":tt("error",t),tt("load",t),i=r;break;case"details":tt("toggle",t),i=r;break;case"input":Cy(t,r),i=Sp(t,r),tt("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=mt({},r,{value:void 0}),tt("invalid",t);break;case"textarea":xy(t,r),i=xp(t,r),tt("invalid",t);break;default:i=r}Pp(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?Sw(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Iw(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&iu(t,l):typeof l=="number"&&iu(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(ru.hasOwnProperty(s)?l!=null&&s==="onScroll"&&tt("scroll",t):l!=null&&ug(t,s,l,o))}switch(n){case"input":xc(t),Ay(t,r,!1);break;case"textarea":xc(t),Ry(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Wi(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?jo(t,!!r.multiple,s,!1):r.defaultValue!=null&&jo(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=bd)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Kt(e),null;case 6:if(t&&e.stateNode!=null)KS(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(te(166));if(n=Ls(mu.current),Ls(wr.current),Lc(e)){if(r=e.stateNode,n=e.memoizedProps,r[vr]=e,(s=r.nodeValue!==n)&&(t=Pn,t!==null))switch(t.tag){case 3:Vc(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Vc(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[vr]=e,e.stateNode=r}return Kt(e),null;case 13:if(rt(ht),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(st&&xn!==null&&e.mode&1&&!(e.flags&128))dS(),ua(),e.flags|=98560,s=!1;else if(s=Lc(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(te(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(te(317));s[vr]=e}else ua(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Kt(e),s=!1}else er!==null&&(cm(er),er=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||ht.current&1?kt===0&&(kt=3):Hg())),e.updateQueue!==null&&(e.flags|=4),Kt(e),null);case 4:return da(),nm(t,e),t===null&&du(e.stateNode.containerInfo),Kt(e),null;case 10:return Rg(e.type._context),Kt(e),null;case 17:return yn(e.type)&&Md(),Kt(e),null;case 19:if(rt(ht),s=e.memoizedState,s===null)return Kt(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)_l(s,!1);else{if(kt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=qd(t),o!==null){for(e.flags|=128,_l(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return et(ht,ht.current&1|2),e.child}t=t.sibling}s.tail!==null&&Tt()>fa&&(e.flags|=128,r=!0,_l(s,!1),e.lanes=4194304)}else{if(!r)if(t=qd(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),_l(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!st)return Kt(e),null}else 2*Tt()-s.renderingStartTime>fa&&n!==1073741824&&(e.flags|=128,r=!0,_l(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Tt(),e.sibling=null,n=ht.current,et(ht,r?n&1|2:n&1),e):(Kt(e),null);case 22:case 23:return $g(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Sn&1073741824&&(Kt(e),e.subtreeFlags&6&&(e.flags|=8192)):Kt(e),null;case 24:return null;case 25:return null}throw Error(te(156,e.tag))}function uk(t,e){switch(Sg(e),e.tag){case 1:return yn(e.type)&&Md(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return da(),rt(_n),rt(en),bg(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Dg(e),null;case 13:if(rt(ht),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(te(340));ua()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return rt(ht),null;case 4:return da(),null;case 10:return Rg(e.type._context),null;case 22:case 23:return $g(),null;case 24:return null;default:return null}}var Oc=!1,Qt=!1,ck=typeof WeakSet=="function"?WeakSet:Set,ue=null;function $o(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){gt(t,e,r)}else n.current=null}function rm(t,e,n){try{n()}catch(r){gt(t,e,r)}}var _v=!1;function dk(t,e){if(Bp=kd,t=Xw(),Ig(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,u=0,f=0,m=t,g=null;t:for(;;){for(var v;m!==n||i!==0&&m.nodeType!==3||(a=o+i),m!==s||r!==0&&m.nodeType!==3||(l=o+r),m.nodeType===3&&(o+=m.nodeValue.length),(v=m.firstChild)!==null;)g=m,m=v;for(;;){if(m===t)break t;if(g===n&&++u===i&&(a=o),g===s&&++f===r&&(l=o),(v=m.nextSibling)!==null)break;m=g,g=m.parentNode}m=v}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(qp={focusedElem:t,selectionRange:n},kd=!1,ue=e;ue!==null;)if(e=ue,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ue=t;else for(;ue!==null;){e=ue;try{var T=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(T!==null){var A=T.memoizedProps,D=T.memoizedState,S=e.stateNode,I=S.getSnapshotBeforeUpdate(e.elementType===e.type?A:Yn(e.type,A),D);S.__reactInternalSnapshotBeforeUpdate=I}break;case 3:var P=e.stateNode.containerInfo;P.nodeType===1?P.textContent="":P.nodeType===9&&P.documentElement&&P.removeChild(P.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(te(163))}}catch(V){gt(e,e.return,V)}if(t=e.sibling,t!==null){t.return=e.return,ue=t;break}ue=e.return}return T=_v,_v=!1,T}function ql(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&rm(e,n,s)}i=i.next}while(i!==r)}}function bh(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function im(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function jS(t){var e=t.alternate;e!==null&&(t.alternate=null,jS(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[vr],delete e[fu],delete e[$p],delete e[KP],delete e[jP])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function JS(t){return t.tag===5||t.tag===3||t.tag===4}function yv(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||JS(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function sm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=bd));else if(r!==4&&(t=t.child,t!==null))for(sm(t,e,n),t=t.sibling;t!==null;)sm(t,e,n),t=t.sibling}function om(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(om(t,e,n),t=t.sibling;t!==null;)om(t,e,n),t=t.sibling}var qt=null,Xn=!1;function di(t,e,n){for(n=n.child;n!==null;)QS(t,e,n),n=n.sibling}function QS(t,e,n){if(Ir&&typeof Ir.onCommitFiberUnmount=="function")try{Ir.onCommitFiberUnmount(Ch,n)}catch{}switch(n.tag){case 5:Qt||$o(n,e);case 6:var r=qt,i=Xn;qt=null,di(t,e,n),qt=r,Xn=i,qt!==null&&(Xn?(t=qt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):qt.removeChild(n.stateNode));break;case 18:qt!==null&&(Xn?(t=qt,n=n.stateNode,t.nodeType===8?Kf(t.parentNode,n):t.nodeType===1&&Kf(t,n),lu(t)):Kf(qt,n.stateNode));break;case 4:r=qt,i=Xn,qt=n.stateNode.containerInfo,Xn=!0,di(t,e,n),qt=r,Xn=i;break;case 0:case 11:case 14:case 15:if(!Qt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&rm(n,e,o),i=i.next}while(i!==r)}di(t,e,n);break;case 1:if(!Qt&&($o(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){gt(n,e,a)}di(t,e,n);break;case 21:di(t,e,n);break;case 22:n.mode&1?(Qt=(r=Qt)||n.memoizedState!==null,di(t,e,n),Qt=r):di(t,e,n);break;default:di(t,e,n)}}function vv(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new ck),e.forEach(function(r){var i=Tk.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Qn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:qt=a.stateNode,Xn=!1;break e;case 3:qt=a.stateNode.containerInfo,Xn=!0;break e;case 4:qt=a.stateNode.containerInfo,Xn=!0;break e}a=a.return}if(qt===null)throw Error(te(160));QS(s,o,i),qt=null,Xn=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){gt(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)YS(e,t),e=e.sibling}function YS(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Qn(e,t),gr(t),r&4){try{ql(3,t,t.return),bh(3,t)}catch(A){gt(t,t.return,A)}try{ql(5,t,t.return)}catch(A){gt(t,t.return,A)}}break;case 1:Qn(e,t),gr(t),r&512&&n!==null&&$o(n,n.return);break;case 5:if(Qn(e,t),gr(t),r&512&&n!==null&&$o(n,n.return),t.flags&32){var i=t.stateNode;try{iu(i,"")}catch(A){gt(t,t.return,A)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&vw(i,s),kp(a,o);var u=kp(a,s);for(o=0;o<l.length;o+=2){var f=l[o],m=l[o+1];f==="style"?Sw(i,m):f==="dangerouslySetInnerHTML"?Iw(i,m):f==="children"?iu(i,m):ug(i,f,m,u)}switch(a){case"input":Cp(i,s);break;case"textarea":Tw(i,s);break;case"select":var g=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var v=s.value;v!=null?jo(i,!!s.multiple,v,!1):g!==!!s.multiple&&(s.defaultValue!=null?jo(i,!!s.multiple,s.defaultValue,!0):jo(i,!!s.multiple,s.multiple?[]:"",!1))}i[fu]=s}catch(A){gt(t,t.return,A)}}break;case 6:if(Qn(e,t),gr(t),r&4){if(t.stateNode===null)throw Error(te(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(A){gt(t,t.return,A)}}break;case 3:if(Qn(e,t),gr(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{lu(e.containerInfo)}catch(A){gt(t,t.return,A)}break;case 4:Qn(e,t),gr(t);break;case 13:Qn(e,t),gr(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Gg=Tt())),r&4&&vv(t);break;case 22:if(f=n!==null&&n.memoizedState!==null,t.mode&1?(Qt=(u=Qt)||f,Qn(e,t),Qt=u):Qn(e,t),gr(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!f&&t.mode&1)for(ue=t,f=t.child;f!==null;){for(m=ue=f;ue!==null;){switch(g=ue,v=g.child,g.tag){case 0:case 11:case 14:case 15:ql(4,g,g.return);break;case 1:$o(g,g.return);var T=g.stateNode;if(typeof T.componentWillUnmount=="function"){r=g,n=g.return;try{e=r,T.props=e.memoizedProps,T.state=e.memoizedState,T.componentWillUnmount()}catch(A){gt(r,n,A)}}break;case 5:$o(g,g.return);break;case 22:if(g.memoizedState!==null){Ev(m);continue}}v!==null?(v.return=g,ue=v):Ev(m)}f=f.sibling}e:for(f=null,m=t;;){if(m.tag===5){if(f===null){f=m;try{i=m.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=m.stateNode,l=m.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=ww("display",o))}catch(A){gt(t,t.return,A)}}}else if(m.tag===6){if(f===null)try{m.stateNode.nodeValue=u?"":m.memoizedProps}catch(A){gt(t,t.return,A)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===t)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===t)break e;for(;m.sibling===null;){if(m.return===null||m.return===t)break e;f===m&&(f=null),m=m.return}f===m&&(f=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:Qn(e,t),gr(t),r&4&&vv(t);break;case 21:break;default:Qn(e,t),gr(t)}}function gr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(JS(n)){var r=n;break e}n=n.return}throw Error(te(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(iu(i,""),r.flags&=-33);var s=yv(t);om(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=yv(t);sm(t,a,o);break;default:throw Error(te(161))}}catch(l){gt(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function hk(t,e,n){ue=t,XS(t)}function XS(t,e,n){for(var r=(t.mode&1)!==0;ue!==null;){var i=ue,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||Oc;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||Qt;a=Oc;var u=Qt;if(Oc=o,(Qt=l)&&!u)for(ue=i;ue!==null;)o=ue,l=o.child,o.tag===22&&o.memoizedState!==null?Iv(i):l!==null?(l.return=o,ue=l):Iv(i);for(;s!==null;)ue=s,XS(s),s=s.sibling;ue=i,Oc=a,Qt=u}Tv(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,ue=s):Tv(t)}}function Tv(t){for(;ue!==null;){var e=ue;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Qt||bh(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Qt)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Yn(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&iv(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}iv(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var f=u.memoizedState;if(f!==null){var m=f.dehydrated;m!==null&&lu(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(te(163))}Qt||e.flags&512&&im(e)}catch(g){gt(e,e.return,g)}}if(e===t){ue=null;break}if(n=e.sibling,n!==null){n.return=e.return,ue=n;break}ue=e.return}}function Ev(t){for(;ue!==null;){var e=ue;if(e===t){ue=null;break}var n=e.sibling;if(n!==null){n.return=e.return,ue=n;break}ue=e.return}}function Iv(t){for(;ue!==null;){var e=ue;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{bh(4,e)}catch(l){gt(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){gt(e,i,l)}}var s=e.return;try{im(e)}catch(l){gt(e,s,l)}break;case 5:var o=e.return;try{im(e)}catch(l){gt(e,o,l)}}}catch(l){gt(e,e.return,l)}if(e===t){ue=null;break}var a=e.sibling;if(a!==null){a.return=e.return,ue=a;break}ue=e.return}}var fk=Math.ceil,$d=Zr.ReactCurrentDispatcher,Bg=Zr.ReactCurrentOwner,Hn=Zr.ReactCurrentBatchConfig,Be=0,Ot=null,St=null,$t=0,Sn=0,Ho=ns(0),kt=0,vu=null,Js=0,Mh=0,qg=0,Gl=null,pn=null,Gg=0,fa=1/0,Vr=null,Hd=!1,am=null,Li=null,Bc=!1,Pi=null,Wd=0,zl=0,lm=null,sd=-1,od=0;function on(){return Be&6?Tt():sd!==-1?sd:sd=Tt()}function Fi(t){return t.mode&1?Be&2&&$t!==0?$t&-$t:QP.transition!==null?(od===0&&(od=Lw()),od):(t=Je,t!==0||(t=window.event,t=t===void 0?16:zw(t.type)),t):1}function ir(t,e,n,r){if(50<zl)throw zl=0,lm=null,Error(te(185));Vu(t,n,r),(!(Be&2)||t!==Ot)&&(t===Ot&&(!(Be&2)&&(Mh|=n),kt===4&&wi(t,$t)),vn(t,r),n===1&&Be===0&&!(e.mode&1)&&(fa=Tt()+500,kh&&rs()))}function vn(t,e){var n=t.callbackNode;QR(t,e);var r=Pd(t,t===Ot?$t:0);if(r===0)n!==null&&Ny(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Ny(n),e===1)t.tag===0?JP(wv.bind(null,t)):lS(wv.bind(null,t)),HP(function(){!(Be&6)&&rs()}),n=null;else{switch(Fw(r)){case 1:n=pg;break;case 4:n=Mw;break;case 16:n=Rd;break;case 536870912:n=Vw;break;default:n=Rd}n=oC(n,ZS.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function ZS(t,e){if(sd=-1,od=0,Be&6)throw Error(te(327));var n=t.callbackNode;if(Zo()&&t.callbackNode!==n)return null;var r=Pd(t,t===Ot?$t:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Kd(t,r);else{e=r;var i=Be;Be|=2;var s=tC();(Ot!==t||$t!==e)&&(Vr=null,fa=Tt()+500,Os(t,e));do try{gk();break}catch(a){eC(t,a)}while(!0);xg(),$d.current=s,Be=i,St!==null?e=0:(Ot=null,$t=0,e=kt)}if(e!==0){if(e===2&&(i=Vp(t),i!==0&&(r=i,e=um(t,i))),e===1)throw n=vu,Os(t,0),wi(t,r),vn(t,Tt()),n;if(e===6)wi(t,r);else{if(i=t.current.alternate,!(r&30)&&!pk(i)&&(e=Kd(t,r),e===2&&(s=Vp(t),s!==0&&(r=s,e=um(t,s))),e===1))throw n=vu,Os(t,0),wi(t,r),vn(t,Tt()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(te(345));case 2:As(t,pn,Vr);break;case 3:if(wi(t,r),(r&130023424)===r&&(e=Gg+500-Tt(),10<e)){if(Pd(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){on(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=zp(As.bind(null,t,pn,Vr),e);break}As(t,pn,Vr);break;case 4:if(wi(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-rr(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=Tt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*fk(r/1960))-r,10<r){t.timeoutHandle=zp(As.bind(null,t,pn,Vr),r);break}As(t,pn,Vr);break;case 5:As(t,pn,Vr);break;default:throw Error(te(329))}}}return vn(t,Tt()),t.callbackNode===n?ZS.bind(null,t):null}function um(t,e){var n=Gl;return t.current.memoizedState.isDehydrated&&(Os(t,e).flags|=256),t=Kd(t,e),t!==2&&(e=pn,pn=n,e!==null&&cm(e)),t}function cm(t){pn===null?pn=t:pn.push.apply(pn,t)}function pk(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!lr(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function wi(t,e){for(e&=~qg,e&=~Mh,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-rr(e),r=1<<n;t[n]=-1,e&=~r}}function wv(t){if(Be&6)throw Error(te(327));Zo();var e=Pd(t,0);if(!(e&1))return vn(t,Tt()),null;var n=Kd(t,e);if(t.tag!==0&&n===2){var r=Vp(t);r!==0&&(e=r,n=um(t,r))}if(n===1)throw n=vu,Os(t,0),wi(t,e),vn(t,Tt()),n;if(n===6)throw Error(te(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,As(t,pn,Vr),vn(t,Tt()),null}function zg(t,e){var n=Be;Be|=1;try{return t(e)}finally{Be=n,Be===0&&(fa=Tt()+500,kh&&rs())}}function Qs(t){Pi!==null&&Pi.tag===0&&!(Be&6)&&Zo();var e=Be;Be|=1;var n=Hn.transition,r=Je;try{if(Hn.transition=null,Je=1,t)return t()}finally{Je=r,Hn.transition=n,Be=e,!(Be&6)&&rs()}}function $g(){Sn=Ho.current,rt(Ho)}function Os(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,$P(n)),St!==null)for(n=St.return;n!==null;){var r=n;switch(Sg(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Md();break;case 3:da(),rt(_n),rt(en),bg();break;case 5:Dg(r);break;case 4:da();break;case 13:rt(ht);break;case 19:rt(ht);break;case 10:Rg(r.type._context);break;case 22:case 23:$g()}n=n.return}if(Ot=t,St=t=Ui(t.current,null),$t=Sn=e,kt=0,vu=null,qg=Mh=Js=0,pn=Gl=null,Vs!==null){for(e=0;e<Vs.length;e++)if(n=Vs[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}Vs=null}return t}function eC(t,e){do{var n=St;try{if(xg(),nd.current=zd,Gd){for(var r=pt.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Gd=!1}if(js=0,Ut=Pt=pt=null,Bl=!1,gu=0,Bg.current=null,n===null||n.return===null){kt=1,vu=e,St=null;break}e:{var s=t,o=n.return,a=n,l=e;if(e=$t,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,f=a,m=f.tag;if(!(f.mode&1)&&(m===0||m===11||m===15)){var g=f.alternate;g?(f.updateQueue=g.updateQueue,f.memoizedState=g.memoizedState,f.lanes=g.lanes):(f.updateQueue=null,f.memoizedState=null)}var v=cv(o);if(v!==null){v.flags&=-257,dv(v,o,a,s,e),v.mode&1&&uv(s,u,e),e=v,l=u;var T=e.updateQueue;if(T===null){var A=new Set;A.add(l),e.updateQueue=A}else T.add(l);break e}else{if(!(e&1)){uv(s,u,e),Hg();break e}l=Error(te(426))}}else if(st&&a.mode&1){var D=cv(o);if(D!==null){!(D.flags&65536)&&(D.flags|=256),dv(D,o,a,s,e),Cg(ha(l,a));break e}}s=l=ha(l,a),kt!==4&&(kt=2),Gl===null?Gl=[s]:Gl.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var S=FS(s,l,e);rv(s,S);break e;case 1:a=l;var I=s.type,P=s.stateNode;if(!(s.flags&128)&&(typeof I.getDerivedStateFromError=="function"||P!==null&&typeof P.componentDidCatch=="function"&&(Li===null||!Li.has(P)))){s.flags|=65536,e&=-e,s.lanes|=e;var V=US(s,a,e);rv(s,V);break e}}s=s.return}while(s!==null)}rC(n)}catch(U){e=U,St===n&&n!==null&&(St=n=n.return);continue}break}while(!0)}function tC(){var t=$d.current;return $d.current=zd,t===null?zd:t}function Hg(){(kt===0||kt===3||kt===2)&&(kt=4),Ot===null||!(Js&268435455)&&!(Mh&268435455)||wi(Ot,$t)}function Kd(t,e){var n=Be;Be|=2;var r=tC();(Ot!==t||$t!==e)&&(Vr=null,Os(t,e));do try{mk();break}catch(i){eC(t,i)}while(!0);if(xg(),Be=n,$d.current=r,St!==null)throw Error(te(261));return Ot=null,$t=0,kt}function mk(){for(;St!==null;)nC(St)}function gk(){for(;St!==null&&!qR();)nC(St)}function nC(t){var e=sC(t.alternate,t,Sn);t.memoizedProps=t.pendingProps,e===null?rC(t):St=e,Bg.current=null}function rC(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=uk(n,e),n!==null){n.flags&=32767,St=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{kt=6,St=null;return}}else if(n=lk(n,e,Sn),n!==null){St=n;return}if(e=e.sibling,e!==null){St=e;return}St=e=t}while(e!==null);kt===0&&(kt=5)}function As(t,e,n){var r=Je,i=Hn.transition;try{Hn.transition=null,Je=1,_k(t,e,n,r)}finally{Hn.transition=i,Je=r}return null}function _k(t,e,n,r){do Zo();while(Pi!==null);if(Be&6)throw Error(te(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(te(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(YR(t,s),t===Ot&&(St=Ot=null,$t=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Bc||(Bc=!0,oC(Rd,function(){return Zo(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=Hn.transition,Hn.transition=null;var o=Je;Je=1;var a=Be;Be|=4,Bg.current=null,dk(t,n),YS(n,t),FP(qp),kd=!!Bp,qp=Bp=null,t.current=n,hk(n),GR(),Be=a,Je=o,Hn.transition=s}else t.current=n;if(Bc&&(Bc=!1,Pi=t,Wd=i),s=t.pendingLanes,s===0&&(Li=null),HR(n.stateNode),vn(t,Tt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Hd)throw Hd=!1,t=am,am=null,t;return Wd&1&&t.tag!==0&&Zo(),s=t.pendingLanes,s&1?t===lm?zl++:(zl=0,lm=t):zl=0,rs(),null}function Zo(){if(Pi!==null){var t=Fw(Wd),e=Hn.transition,n=Je;try{if(Hn.transition=null,Je=16>t?16:t,Pi===null)var r=!1;else{if(t=Pi,Pi=null,Wd=0,Be&6)throw Error(te(331));var i=Be;for(Be|=4,ue=t.current;ue!==null;){var s=ue,o=s.child;if(ue.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(ue=u;ue!==null;){var f=ue;switch(f.tag){case 0:case 11:case 15:ql(8,f,s)}var m=f.child;if(m!==null)m.return=f,ue=m;else for(;ue!==null;){f=ue;var g=f.sibling,v=f.return;if(jS(f),f===u){ue=null;break}if(g!==null){g.return=v,ue=g;break}ue=v}}}var T=s.alternate;if(T!==null){var A=T.child;if(A!==null){T.child=null;do{var D=A.sibling;A.sibling=null,A=D}while(A!==null)}}ue=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,ue=o;else e:for(;ue!==null;){if(s=ue,s.flags&2048)switch(s.tag){case 0:case 11:case 15:ql(9,s,s.return)}var S=s.sibling;if(S!==null){S.return=s.return,ue=S;break e}ue=s.return}}var I=t.current;for(ue=I;ue!==null;){o=ue;var P=o.child;if(o.subtreeFlags&2064&&P!==null)P.return=o,ue=P;else e:for(o=I;ue!==null;){if(a=ue,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:bh(9,a)}}catch(U){gt(a,a.return,U)}if(a===o){ue=null;break e}var V=a.sibling;if(V!==null){V.return=a.return,ue=V;break e}ue=a.return}}if(Be=i,rs(),Ir&&typeof Ir.onPostCommitFiberRoot=="function")try{Ir.onPostCommitFiberRoot(Ch,t)}catch{}r=!0}return r}finally{Je=n,Hn.transition=e}}return!1}function Sv(t,e,n){e=ha(n,e),e=FS(t,e,1),t=Vi(t,e,1),e=on(),t!==null&&(Vu(t,1,e),vn(t,e))}function gt(t,e,n){if(t.tag===3)Sv(t,t,n);else for(;e!==null;){if(e.tag===3){Sv(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Li===null||!Li.has(r))){t=ha(n,t),t=US(e,t,1),e=Vi(e,t,1),t=on(),e!==null&&(Vu(e,1,t),vn(e,t));break}}e=e.return}}function yk(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=on(),t.pingedLanes|=t.suspendedLanes&n,Ot===t&&($t&n)===n&&(kt===4||kt===3&&($t&130023424)===$t&&500>Tt()-Gg?Os(t,0):qg|=n),vn(t,e)}function iC(t,e){e===0&&(t.mode&1?(e=kc,kc<<=1,!(kc&130023424)&&(kc=4194304)):e=1);var n=on();t=Kr(t,e),t!==null&&(Vu(t,e,n),vn(t,n))}function vk(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),iC(t,n)}function Tk(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(te(314))}r!==null&&r.delete(e),iC(t,n)}var sC;sC=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||_n.current)mn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return mn=!1,ak(t,e,n);mn=!!(t.flags&131072)}else mn=!1,st&&e.flags&1048576&&uS(e,Fd,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;id(t,e),t=e.pendingProps;var i=la(e,en.current);Xo(e,n),i=Vg(null,e,r,t,i,n);var s=Lg();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,yn(r)?(s=!0,Vd(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,kg(e),i.updater=Dh,e.stateNode=i,i._reactInternals=e,Qp(e,r,t,n),e=Zp(null,e,r,!0,s,n)):(e.tag=0,st&&s&&wg(e),nn(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(id(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=Ik(r),t=Yn(r,t),i){case 0:e=Xp(null,e,r,t,n);break e;case 1:e=pv(null,e,r,t,n);break e;case 11:e=hv(null,e,r,t,n);break e;case 14:e=fv(null,e,r,Yn(r.type,t),n);break e}throw Error(te(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Yn(r,i),Xp(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Yn(r,i),pv(t,e,r,i,n);case 3:e:{if(GS(e),t===null)throw Error(te(387));r=e.pendingProps,s=e.memoizedState,i=s.element,mS(t,e),Bd(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=ha(Error(te(423)),e),e=mv(t,e,r,n,i);break e}else if(r!==i){i=ha(Error(te(424)),e),e=mv(t,e,r,n,i);break e}else for(xn=Mi(e.stateNode.containerInfo.firstChild),Pn=e,st=!0,er=null,n=fS(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(ua(),r===i){e=jr(t,e,n);break e}nn(t,e,r,n)}e=e.child}return e;case 5:return gS(e),t===null&&Kp(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,Gp(r,i)?o=null:s!==null&&Gp(r,s)&&(e.flags|=32),qS(t,e),nn(t,e,o,n),e.child;case 6:return t===null&&Kp(e),null;case 13:return zS(t,e,n);case 4:return Ng(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=ca(e,null,r,n):nn(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Yn(r,i),hv(t,e,r,i,n);case 7:return nn(t,e,e.pendingProps,n),e.child;case 8:return nn(t,e,e.pendingProps.children,n),e.child;case 12:return nn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,et(Ud,r._currentValue),r._currentValue=o,s!==null)if(lr(s.value,o)){if(s.children===i.children&&!_n.current){e=jr(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=zr(-1,n&-n),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var f=u.pending;f===null?l.next=l:(l.next=f.next,f.next=l),u.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),jp(s.return,n,e),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(te(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),jp(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}nn(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Xo(e,n),i=jn(i),r=r(i),e.flags|=1,nn(t,e,r,n),e.child;case 14:return r=e.type,i=Yn(r,e.pendingProps),i=Yn(r.type,i),fv(t,e,r,i,n);case 15:return OS(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Yn(r,i),id(t,e),e.tag=1,yn(r)?(t=!0,Vd(e)):t=!1,Xo(e,n),LS(e,r,i),Qp(e,r,i,n),Zp(null,e,r,!0,t,n);case 19:return $S(t,e,n);case 22:return BS(t,e,n)}throw Error(te(156,e.tag))};function oC(t,e){return bw(t,e)}function Ek(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Gn(t,e,n,r){return new Ek(t,e,n,r)}function Wg(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Ik(t){if(typeof t=="function")return Wg(t)?1:0;if(t!=null){if(t=t.$$typeof,t===dg)return 11;if(t===hg)return 14}return 2}function Ui(t,e){var n=t.alternate;return n===null?(n=Gn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function ad(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")Wg(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Vo:return Bs(n.children,i,s,e);case cg:o=8,i|=8;break;case Tp:return t=Gn(12,n,e,i|2),t.elementType=Tp,t.lanes=s,t;case Ep:return t=Gn(13,n,e,i),t.elementType=Ep,t.lanes=s,t;case Ip:return t=Gn(19,n,e,i),t.elementType=Ip,t.lanes=s,t;case gw:return Vh(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case pw:o=10;break e;case mw:o=9;break e;case dg:o=11;break e;case hg:o=14;break e;case Ti:o=16,r=null;break e}throw Error(te(130,t==null?t:typeof t,""))}return e=Gn(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function Bs(t,e,n,r){return t=Gn(7,t,r,e),t.lanes=n,t}function Vh(t,e,n,r){return t=Gn(22,t,r,e),t.elementType=gw,t.lanes=n,t.stateNode={isHidden:!1},t}function tp(t,e,n){return t=Gn(6,t,null,e),t.lanes=n,t}function np(t,e,n){return e=Gn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function wk(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Lf(0),this.expirationTimes=Lf(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Lf(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Kg(t,e,n,r,i,s,o,a,l){return t=new wk(t,e,n,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Gn(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},kg(s),t}function Sk(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Mo,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function aC(t){if(!t)return Ki;t=t._reactInternals;e:{if(ao(t)!==t||t.tag!==1)throw Error(te(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(yn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(te(171))}if(t.tag===1){var n=t.type;if(yn(n))return aS(t,n,e)}return e}function lC(t,e,n,r,i,s,o,a,l){return t=Kg(n,r,!0,t,i,s,o,a,l),t.context=aC(null),n=t.current,r=on(),i=Fi(n),s=zr(r,i),s.callback=e??null,Vi(n,s,i),t.current.lanes=i,Vu(t,i,r),vn(t,r),t}function Lh(t,e,n,r){var i=e.current,s=on(),o=Fi(i);return n=aC(n),e.context===null?e.context=n:e.pendingContext=n,e=zr(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Vi(i,e,o),t!==null&&(ir(t,i,o,s),td(t,i,o)),o}function jd(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Cv(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function jg(t,e){Cv(t,e),(t=t.alternate)&&Cv(t,e)}function Ck(){return null}var uC=typeof reportError=="function"?reportError:function(t){console.error(t)};function Jg(t){this._internalRoot=t}Fh.prototype.render=Jg.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(te(409));Lh(t,e,null,null)};Fh.prototype.unmount=Jg.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Qs(function(){Lh(null,t,null,null)}),e[Wr]=null}};function Fh(t){this._internalRoot=t}Fh.prototype.unstable_scheduleHydration=function(t){if(t){var e=Bw();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Ii.length&&e!==0&&e<Ii[n].priority;n++);Ii.splice(n,0,t),n===0&&Gw(t)}};function Qg(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Uh(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Av(){}function Ak(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var u=jd(o);s.call(u)}}var o=lC(e,r,t,0,null,!1,!1,"",Av);return t._reactRootContainer=o,t[Wr]=o.current,du(t.nodeType===8?t.parentNode:t),Qs(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var u=jd(l);a.call(u)}}var l=Kg(t,0,!1,null,null,!1,!1,"",Av);return t._reactRootContainer=l,t[Wr]=l.current,du(t.nodeType===8?t.parentNode:t),Qs(function(){Lh(e,l,n,r)}),l}function Oh(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=jd(o);a.call(l)}}Lh(e,o,t,i)}else o=Ak(n,e,t,i,r);return jd(o)}Uw=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=xl(e.pendingLanes);n!==0&&(mg(e,n|1),vn(e,Tt()),!(Be&6)&&(fa=Tt()+500,rs()))}break;case 13:Qs(function(){var r=Kr(t,1);if(r!==null){var i=on();ir(r,t,1,i)}}),jg(t,1)}};gg=function(t){if(t.tag===13){var e=Kr(t,134217728);if(e!==null){var n=on();ir(e,t,134217728,n)}jg(t,134217728)}};Ow=function(t){if(t.tag===13){var e=Fi(t),n=Kr(t,e);if(n!==null){var r=on();ir(n,t,e,r)}jg(t,e)}};Bw=function(){return Je};qw=function(t,e){var n=Je;try{return Je=t,e()}finally{Je=n}};Dp=function(t,e,n){switch(e){case"input":if(Cp(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=Ph(r);if(!i)throw Error(te(90));yw(r),Cp(r,i)}}}break;case"textarea":Tw(t,n);break;case"select":e=n.value,e!=null&&jo(t,!!n.multiple,e,!1)}};xw=zg;Rw=Qs;var xk={usingClientEntryPoint:!1,Events:[Fu,Oo,Ph,Cw,Aw,zg]},yl={findFiberByHostInstance:Ms,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Rk={bundleType:yl.bundleType,version:yl.version,rendererPackageName:yl.rendererPackageName,rendererConfig:yl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Zr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Nw(t),t===null?null:t.stateNode},findFiberByHostInstance:yl.findFiberByHostInstance||Ck,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var qc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!qc.isDisabled&&qc.supportsFiber)try{Ch=qc.inject(Rk),Ir=qc}catch{}}Dn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xk;Dn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Qg(e))throw Error(te(200));return Sk(t,e,null,n)};Dn.createRoot=function(t,e){if(!Qg(t))throw Error(te(299));var n=!1,r="",i=uC;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Kg(t,1,!1,null,null,n,!1,r,i),t[Wr]=e.current,du(t.nodeType===8?t.parentNode:t),new Jg(e)};Dn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(te(188)):(t=Object.keys(t).join(","),Error(te(268,t)));return t=Nw(e),t=t===null?null:t.stateNode,t};Dn.flushSync=function(t){return Qs(t)};Dn.hydrate=function(t,e,n){if(!Uh(e))throw Error(te(200));return Oh(null,t,e,!0,n)};Dn.hydrateRoot=function(t,e,n){if(!Qg(t))throw Error(te(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=uC;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=lC(e,null,t,1,n??null,i,!1,s,o),t[Wr]=e.current,du(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new Fh(e)};Dn.render=function(t,e,n){if(!Uh(e))throw Error(te(200));return Oh(null,t,e,!1,n)};Dn.unmountComponentAtNode=function(t){if(!Uh(t))throw Error(te(40));return t._reactRootContainer?(Qs(function(){Oh(null,null,t,!1,function(){t._reactRootContainer=null,t[Wr]=null})}),!0):!1};Dn.unstable_batchedUpdates=zg;Dn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Uh(n))throw Error(te(200));if(t==null||t._reactInternals===void 0)throw Error(te(38));return Oh(t,e,n,!1,r)};Dn.version="18.3.1-next-f1338f8080-20240426";function cC(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(cC)}catch(t){console.error(t)}}cC(),cw.exports=Dn;var Pk=cw.exports,xv=Pk;yp.createRoot=xv.createRoot,yp.hydrateRoot=xv.hydrateRoot;/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let kk,Nk;function Dk(){return{geminiUrl:kk,vertexUrl:Nk}}function bk(t,e,n,r){var i,s;if(!(t!=null&&t.baseUrl)){const o=Dk();return e?(i=o.vertexUrl)!==null&&i!==void 0?i:n:(s=o.geminiUrl)!==null&&s!==void 0?s:r}return t.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class lo{}function de(t,e){const n=/\{([^}]+)\}/g;return t.replace(n,(r,i)=>{if(Object.prototype.hasOwnProperty.call(e,i)){const s=e[i];return s!=null?String(s):""}else throw new Error(`Key '${i}' not found in valueMap.`)})}function h(t,e,n){for(let s=0;s<e.length-1;s++){const o=e[s];if(o.endsWith("[]")){const a=o.slice(0,-2);if(!(a in t))if(Array.isArray(n))t[a]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${o}`);if(Array.isArray(t[a])){const l=t[a];if(Array.isArray(n))for(let u=0;u<l.length;u++){const f=l[u];h(f,e.slice(s+1),n[u])}else for(const u of l)h(u,e.slice(s+1),n)}return}else if(o.endsWith("[0]")){const a=o.slice(0,-3);a in t||(t[a]=[{}]);const l=t[a];h(l[0],e.slice(s+1),n);return}(!t[o]||typeof t[o]!="object")&&(t[o]={}),t=t[o]}const r=e[e.length-1],i=t[r];if(i!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===i)return;if(typeof i=="object"&&typeof n=="object"&&i!==null&&n!==null)Object.assign(i,n);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else r==="_self"&&typeof n=="object"&&n!==null&&!Array.isArray(n)?Object.assign(t,n):t[r]=n}function c(t,e,n=void 0){try{if(e.length===1&&e[0]==="_self")return t;for(let r=0;r<e.length;r++){if(typeof t!="object"||t===null)return n;const i=e[r];if(i.endsWith("[]")){const s=i.slice(0,-2);if(s in t){const o=t[s];return Array.isArray(o)?o.map(a=>c(a,e.slice(r+1),n)):n}else return n}else t=t[i]}return t}catch(r){if(r instanceof TypeError)return n;throw r}}function Mk(t,e){for(const[n,r]of Object.entries(e)){const i=n.split("."),s=r.split("."),o=new Set;let a=-1;for(let l=0;l<i.length;l++)if(i[l]==="*"){a=l;break}if(a!==-1&&s.length>a)for(let l=a;l<s.length;l++){const u=s[l];u!=="*"&&!u.endsWith("[]")&&!u.endsWith("[0]")&&o.add(u)}dm(t,i,s,0,o)}}function dm(t,e,n,r,i){if(r>=e.length||typeof t!="object"||t===null)return;const s=e[r];if(s.endsWith("[]")){const o=s.slice(0,-2),a=t;if(o in a&&Array.isArray(a[o]))for(const l of a[o])dm(l,e,n,r+1,i)}else if(s==="*"){if(typeof t=="object"&&t!==null&&!Array.isArray(t)){const o=t,a=Object.keys(o).filter(u=>!u.startsWith("_")&&!i.has(u)),l={};for(const u of a)l[u]=o[u];for(const[u,f]of Object.entries(l)){const m=[];for(const g of n.slice(r))g==="*"?m.push(u):m.push(g);h(o,m,f)}for(const u of a)delete o[u]}}else{const o=t;s in o&&dm(o[s],e,n,r+1,i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Yg(t){if(typeof t!="string")throw new Error("fromImageBytes must be a string");return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Vk(t){const e={},n=c(t,["operationName"]);n!=null&&h(e,["operationName"],n);const r=c(t,["resourceName"]);return r!=null&&h(e,["_url","resourceName"],r),e}function Lk(t){const e={},n=c(t,["name"]);n!=null&&h(e,["name"],n);const r=c(t,["metadata"]);r!=null&&h(e,["metadata"],r);const i=c(t,["done"]);i!=null&&h(e,["done"],i);const s=c(t,["error"]);s!=null&&h(e,["error"],s);const o=c(t,["response","generateVideoResponse"]);return o!=null&&h(e,["response"],Uk(o)),e}function Fk(t){const e={},n=c(t,["name"]);n!=null&&h(e,["name"],n);const r=c(t,["metadata"]);r!=null&&h(e,["metadata"],r);const i=c(t,["done"]);i!=null&&h(e,["done"],i);const s=c(t,["error"]);s!=null&&h(e,["error"],s);const o=c(t,["response"]);return o!=null&&h(e,["response"],Ok(o)),e}function Uk(t){const e={},n=c(t,["generatedSamples"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>Bk(o))),h(e,["generatedVideos"],s)}const r=c(t,["raiMediaFilteredCount"]);r!=null&&h(e,["raiMediaFilteredCount"],r);const i=c(t,["raiMediaFilteredReasons"]);return i!=null&&h(e,["raiMediaFilteredReasons"],i),e}function Ok(t){const e={},n=c(t,["videos"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>qk(o))),h(e,["generatedVideos"],s)}const r=c(t,["raiMediaFilteredCount"]);r!=null&&h(e,["raiMediaFilteredCount"],r);const i=c(t,["raiMediaFilteredReasons"]);return i!=null&&h(e,["raiMediaFilteredReasons"],i),e}function Bk(t){const e={},n=c(t,["video"]);return n!=null&&h(e,["video"],$k(n)),e}function qk(t){const e={},n=c(t,["_self"]);return n!=null&&h(e,["video"],Hk(n)),e}function Gk(t){const e={},n=c(t,["operationName"]);return n!=null&&h(e,["_url","operationName"],n),e}function zk(t){const e={},n=c(t,["operationName"]);return n!=null&&h(e,["_url","operationName"],n),e}function $k(t){const e={},n=c(t,["uri"]);n!=null&&h(e,["uri"],n);const r=c(t,["encodedVideo"]);r!=null&&h(e,["videoBytes"],Yg(r));const i=c(t,["encoding"]);return i!=null&&h(e,["mimeType"],i),e}function Hk(t){const e={},n=c(t,["gcsUri"]);n!=null&&h(e,["uri"],n);const r=c(t,["bytesBase64Encoded"]);r!=null&&h(e,["videoBytes"],Yg(r));const i=c(t,["mimeType"]);return i!=null&&h(e,["mimeType"],i),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Rv;(function(t){t.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",t.OUTCOME_OK="OUTCOME_OK",t.OUTCOME_FAILED="OUTCOME_FAILED",t.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Rv||(Rv={}));var Pv;(function(t){t.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",t.PYTHON="PYTHON"})(Pv||(Pv={}));var zn;(function(t){t.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",t.STRING="STRING",t.NUMBER="NUMBER",t.INTEGER="INTEGER",t.BOOLEAN="BOOLEAN",t.ARRAY="ARRAY",t.OBJECT="OBJECT",t.NULL="NULL"})(zn||(zn={}));var kv;(function(t){t.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",t.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",t.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",t.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",t.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",t.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",t.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",t.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",t.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT"})(kv||(kv={}));var Nv;(function(t){t.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",t.SEVERITY="SEVERITY",t.PROBABILITY="PROBABILITY"})(Nv||(Nv={}));var Dv;(function(t){t.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE",t.OFF="OFF"})(Dv||(Dv={}));var bv;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(bv||(bv={}));var Mv;(function(t){t.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",t.NO_AUTH="NO_AUTH",t.API_KEY_AUTH="API_KEY_AUTH",t.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",t.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",t.OAUTH="OAUTH",t.OIDC_AUTH="OIDC_AUTH"})(Mv||(Mv={}));var Vv;(function(t){t.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",t.SIMPLE_SEARCH="SIMPLE_SEARCH",t.ELASTIC_SEARCH="ELASTIC_SEARCH"})(Vv||(Vv={}));var Lv;(function(t){t.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",t.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",t.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",t.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",t.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(Lv||(Lv={}));var Fv;(function(t){t.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.LANGUAGE="LANGUAGE",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.SPII="SPII",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.IMAGE_SAFETY="IMAGE_SAFETY",t.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",t.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",t.NO_IMAGE="NO_IMAGE"})(Fv||(Fv={}));var Uv;(function(t){t.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",t.NEGLIGIBLE="NEGLIGIBLE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH"})(Uv||(Uv={}));var Ov;(function(t){t.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",t.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",t.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",t.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",t.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(Ov||(Ov={}));var Bv;(function(t){t.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",t.SAFETY="SAFETY",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.IMAGE_SAFETY="IMAGE_SAFETY"})(Bv||(Bv={}));var qv;(function(t){t.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",t.ON_DEMAND="ON_DEMAND",t.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(qv||(qv={}));var Jd;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.AUDIO="AUDIO"})(Jd||(Jd={}));var Gv;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(Gv||(Gv={}));var hm;(function(t){t.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",t.JOB_STATE_QUEUED="JOB_STATE_QUEUED",t.JOB_STATE_PENDING="JOB_STATE_PENDING",t.JOB_STATE_RUNNING="JOB_STATE_RUNNING",t.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",t.JOB_STATE_FAILED="JOB_STATE_FAILED",t.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",t.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",t.JOB_STATE_PAUSED="JOB_STATE_PAUSED",t.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",t.JOB_STATE_UPDATING="JOB_STATE_UPDATING",t.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(hm||(hm={}));var zv;(function(t){t.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",t.TUNING_MODE_FULL="TUNING_MODE_FULL",t.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(zv||(zv={}));var $v;(function(t){t.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",t.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",t.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",t.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",t.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",t.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",t.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})($v||($v={}));var Hv;(function(t){t.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",t.TUNING_TASK_I2V="TUNING_TASK_I2V",t.TUNING_TASK_T2V="TUNING_TASK_T2V"})(Hv||(Hv={}));var Wv;(function(t){t.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",t.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",t.BALANCED="BALANCED",t.PRIORITIZE_COST="PRIORITIZE_COST"})(Wv||(Wv={}));var Kv;(function(t){t.UNSPECIFIED="UNSPECIFIED",t.BLOCKING="BLOCKING",t.NON_BLOCKING="NON_BLOCKING"})(Kv||(Kv={}));var jv;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(jv||(jv={}));var Jv;(function(t){t.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",t.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(Jv||(Jv={}));var Qv;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.AUTO="AUTO",t.ANY="ANY",t.NONE="NONE",t.VALIDATED="VALIDATED"})(Qv||(Qv={}));var Yv;(function(t){t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE"})(Yv||(Yv={}));var Xv;(function(t){t.DONT_ALLOW="DONT_ALLOW",t.ALLOW_ADULT="ALLOW_ADULT",t.ALLOW_ALL="ALLOW_ALL"})(Xv||(Xv={}));var Zv;(function(t){t.auto="auto",t.en="en",t.ja="ja",t.ko="ko",t.hi="hi",t.zh="zh",t.pt="pt",t.es="es"})(Zv||(Zv={}));var eT;(function(t){t.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",t.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",t.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",t.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",t.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(eT||(eT={}));var tT;(function(t){t.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",t.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",t.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",t.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(tT||(tT={}));var nT;(function(t){t.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",t.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",t.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",t.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(nT||(nT={}));var rT;(function(t){t.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",t.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",t.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",t.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",t.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",t.EDIT_MODE_STYLE="EDIT_MODE_STYLE",t.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",t.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(rT||(rT={}));var iT;(function(t){t.FOREGROUND="FOREGROUND",t.BACKGROUND="BACKGROUND",t.PROMPT="PROMPT",t.SEMANTIC="SEMANTIC",t.INTERACTIVE="INTERACTIVE"})(iT||(iT={}));var sT;(function(t){t.ASSET="ASSET",t.STYLE="STYLE"})(sT||(sT={}));var oT;(function(t){t.INSERT="INSERT",t.REMOVE="REMOVE",t.REMOVE_STATIC="REMOVE_STATIC",t.OUTPAINT="OUTPAINT"})(oT||(oT={}));var aT;(function(t){t.OPTIMIZED="OPTIMIZED",t.LOSSLESS="LOSSLESS"})(aT||(aT={}));var lT;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.PROCESSING="PROCESSING",t.ACTIVE="ACTIVE",t.FAILED="FAILED"})(lT||(lT={}));var uT;(function(t){t.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",t.UPLOADED="UPLOADED",t.GENERATED="GENERATED"})(uT||(uT={}));var cT;(function(t){t.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.RESPONSE_REJECTED="RESPONSE_REJECTED",t.NEED_MORE_INPUT="NEED_MORE_INPUT"})(cT||(cT={}));var dT;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.VIDEO="VIDEO",t.AUDIO="AUDIO",t.DOCUMENT="DOCUMENT"})(dT||(dT={}));var hT;(function(t){t.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",t.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",t.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(hT||(hT={}));var fT;(function(t){t.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",t.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",t.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(fT||(fT={}));var pT;(function(t){t.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",t.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",t.NO_INTERRUPTION="NO_INTERRUPTION"})(pT||(pT={}));var mT;(function(t){t.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",t.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",t.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(mT||(mT={}));var gT;(function(t){t.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",t.SILENT="SILENT",t.WHEN_IDLE="WHEN_IDLE",t.INTERRUPT="INTERRUPT"})(gT||(gT={}));var _T;(function(t){t.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",t.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",t.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",t.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",t.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",t.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",t.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",t.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",t.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",t.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",t.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",t.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",t.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(_T||(_T={}));var yT;(function(t){t.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",t.QUALITY="QUALITY",t.DIVERSITY="DIVERSITY",t.VOCALIZATION="VOCALIZATION"})(yT||(yT={}));var Wo;(function(t){t.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",t.PLAY="PLAY",t.PAUSE="PAUSE",t.STOP="STOP",t.RESET_CONTEXT="RESET_CONTEXT"})(Wo||(Wo={}));class fm{constructor(e){const n={};for(const r of e.headers.entries())n[r[0]]=r[1];this.headers=n,this.responseInternal=e}json(){return this.responseInternal.json()}}class vl{get text(){var e,n,r,i,s,o,a,l;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let u="",f=!1;const m=[];for(const g of(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)!==null&&l!==void 0?l:[]){for(const[v,T]of Object.entries(g))v!=="text"&&v!=="thought"&&(T!==null||T!==void 0)&&m.push(v);if(typeof g.text=="string"){if(typeof g.thought=="boolean"&&g.thought)continue;f=!0,u+=g.text}}return m.length>0&&console.warn(`there are non-text parts ${m} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),f?u:void 0}get data(){var e,n,r,i,s,o,a,l;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let u="";const f=[];for(const m of(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)!==null&&l!==void 0?l:[]){for(const[g,v]of Object.entries(m))g!=="inlineData"&&(v!==null||v!==void 0)&&f.push(g);m.inlineData&&typeof m.inlineData.data=="string"&&(u+=atob(m.inlineData.data))}return f.length>0&&console.warn(`there are non-data parts ${f} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),u.length>0?btoa(u):void 0}get functionCalls(){var e,n,r,i,s,o,a,l;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const u=(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(f=>f.functionCall).map(f=>f.functionCall).filter(f=>f!==void 0);if((u==null?void 0:u.length)!==0)return u}get executableCode(){var e,n,r,i,s,o,a,l,u;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const f=(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(m=>m.executableCode).map(m=>m.executableCode).filter(m=>m!==void 0);if((f==null?void 0:f.length)!==0)return(u=f==null?void 0:f[0])===null||u===void 0?void 0:u.code}get codeExecutionResult(){var e,n,r,i,s,o,a,l,u;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const f=(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(m=>m.codeExecutionResult).map(m=>m.codeExecutionResult).filter(m=>m!==void 0);if((f==null?void 0:f.length)!==0)return(u=f==null?void 0:f[0])===null||u===void 0?void 0:u.output}}class vT{}class TT{}class Wk{}class Kk{}class jk{}class Jk{}class ET{}class IT{}class wT{}class Qk{}class Qd{_fromAPIResponse({apiResponse:e,isVertexAI:n}){const r=new Qd;let i;const s=e;return n?i=Fk(s):i=Lk(s),Object.assign(r,i),r}}class ST{}class CT{}class AT{}class Yk{}class Xk{}class Zk{}class xT{}class e1{get text(){var e,n,r;let i="",s=!1;const o=[];for(const a of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[l,u]of Object.entries(a))l!=="text"&&l!=="thought"&&u!==null&&o.push(l);if(typeof a.text=="string"){if(typeof a.thought=="boolean"&&a.thought)continue;s=!0,i+=a.text}}return o.length>0&&console.warn(`there are non-text parts ${o} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),s?i:void 0}get data(){var e,n,r;let i="";const s=[];for(const o of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[a,l]of Object.entries(o))a!=="inlineData"&&l!==null&&s.push(a);o.inlineData&&typeof o.inlineData.data=="string"&&(i+=atob(o.inlineData.data))}return s.length>0&&console.warn(`there are non-data parts ${s} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),i.length>0?btoa(i):void 0}}class t1{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ge(t,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(t.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const n=e.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function dC(t,e){const n=Ge(t,e);return n?n.startsWith("publishers/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}`:n.startsWith("models/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/publishers/google/${n}`:n:""}function hC(t){return Array.isArray(t)?t.map(e=>Yd(e)):[Yd(t)]}function Yd(t){if(typeof t=="object"&&t!==null)return t;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof t}`)}function fC(t){const e=Yd(t);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function pC(t){const e=Yd(t);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function RT(t){if(t==null)throw new Error("PartUnion is required");if(typeof t=="object")return t;if(typeof t=="string")return{text:t};throw new Error(`Unsupported part type: ${typeof t}`)}function mC(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("PartListUnion is required");return Array.isArray(t)?t.map(e=>RT(e)):[RT(t)]}function pm(t){return t!=null&&typeof t=="object"&&"parts"in t&&Array.isArray(t.parts)}function PT(t){return t!=null&&typeof t=="object"&&"functionCall"in t}function kT(t){return t!=null&&typeof t=="object"&&"functionResponse"in t}function Xt(t){if(t==null)throw new Error("ContentUnion is required");return pm(t)?t:{role:"user",parts:mC(t)}}function Xg(t,e){if(!e)return[];if(t.isVertexAI()&&Array.isArray(e))return e.flatMap(n=>{const r=Xt(n);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(t.isVertexAI()){const n=Xt(e);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(e)?e.map(n=>Xt(n)):[Xt(e)]}function Wn(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("contents are required");if(!Array.isArray(t)){if(PT(t)||kT(t))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Xt(t)]}const e=[],n=[],r=pm(t[0]);for(const i of t){const s=pm(i);if(s!=r)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(s)e.push(i);else{if(PT(i)||kT(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(i)}}return r||e.push({role:"user",parts:mC(n)}),e}function n1(t,e){t.includes("null")&&(e.nullable=!0);const n=t.filter(r=>r!=="null");if(n.length===1)e.type=Object.values(zn).includes(n[0].toUpperCase())?n[0].toUpperCase():zn.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const r of n)e.anyOf.push({type:Object.values(zn).includes(r.toUpperCase())?r.toUpperCase():zn.TYPE_UNSPECIFIED})}}function ea(t){const e={},n=["items"],r=["anyOf"],i=["properties"];if(t.type&&t.anyOf)throw new Error("type and anyOf cannot be both populated.");const s=t.anyOf;s!=null&&s.length==2&&(s[0].type==="null"?(e.nullable=!0,t=s[1]):s[1].type==="null"&&(e.nullable=!0,t=s[0])),t.type instanceof Array&&n1(t.type,e);for(const[o,a]of Object.entries(t))if(a!=null)if(o=="type"){if(a==="null")throw new Error("type: null can not be the only possible type for the field.");if(a instanceof Array)continue;e.type=Object.values(zn).includes(a.toUpperCase())?a.toUpperCase():zn.TYPE_UNSPECIFIED}else if(n.includes(o))e[o]=ea(a);else if(r.includes(o)){const l=[];for(const u of a){if(u.type=="null"){e.nullable=!0;continue}l.push(ea(u))}e[o]=l}else if(i.includes(o)){const l={};for(const[u,f]of Object.entries(a))l[u]=ea(f);e[o]=l}else{if(o==="additionalProperties")continue;e[o]=a}return e}function Zg(t){return ea(t)}function e_(t){if(typeof t=="object")return t;if(typeof t=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:t}}};throw new Error(`Unsupported speechConfig type: ${typeof t}`)}function t_(t){if("multiSpeakerVoiceConfig"in t)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return t}function ba(t){if(t.functionDeclarations)for(const e of t.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=ea(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=ea(e.response));return t}function Ma(t){if(t==null)throw new Error("tools is required");if(!Array.isArray(t))throw new Error("tools is required and must be an array of Tools");const e=[];for(const n of t)e.push(n);return e}function r1(t,e,n,r=1){const i=!e.startsWith(`${n}/`)&&e.split("/").length===r;return t.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${t.getProject()}/${e}`:e.startsWith(`${n}/`)?`projects/${t.getProject()}/locations/${t.getLocation()}/${e}`:i?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}/${e}`:e:i?`${n}/${e}`:e}function ei(t,e){if(typeof e!="string")throw new Error("name must be a string");return r1(t,e,"cachedContents")}function gC(t){switch(t){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return t}}function is(t){return Yg(t)}function i1(t){return t!=null&&typeof t=="object"&&"name"in t}function s1(t){return t!=null&&typeof t=="object"&&"video"in t}function o1(t){return t!=null&&typeof t=="object"&&"uri"in t}function _C(t){var e;let n;if(i1(t)&&(n=t.name),!(o1(t)&&(n=t.uri,n===void 0))&&!(s1(t)&&(n=(e=t.video)===null||e===void 0?void 0:e.uri,n===void 0))){if(typeof t=="string"&&(n=t),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const i=n.split("files/")[1].match(/[a-z0-9]+/);if(i===null)throw new Error(`Could not extract file name from URI ${n}`);n=i[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function yC(t,e){let n;return t.isVertexAI()?n=e?"publishers/google/models":"models":n=e?"models":"tunedModels",n}function vC(t){for(const e of["models","tunedModels","publisherModels"])if(a1(t,e))return t[e];return[]}function a1(t,e){return t!==null&&typeof t=="object"&&e in t}function l1(t,e={}){const n=t,r={name:n.name,description:n.description,parametersJsonSchema:n.inputSchema};return n.outputSchema&&(r.responseJsonSchema=n.outputSchema),e.behavior&&(r.behavior=e.behavior),{functionDeclarations:[r]}}function u1(t,e={}){const n=[],r=new Set;for(const i of t){const s=i.name;if(r.has(s))throw new Error(`Duplicate function name ${s} found in MCP tools. Please ensure function names are unique.`);r.add(s);const o=l1(i,e);o.functionDeclarations&&n.push(...o.functionDeclarations)}return{functionDeclarations:n}}function TC(t,e){let n;if(typeof e=="string")if(t.isVertexAI())if(e.startsWith("gs://"))n={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))n={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))n={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(t.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");n={inlinedRequests:e}}else n=e;const r=[n.gcsUri,n.bigqueryUri].filter(Boolean).length,i=[n.inlinedRequests,n.fileName].filter(Boolean).length;if(t.isVertexAI()){if(i>0||r!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(r>0||i!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return n}function c1(t){if(typeof t!="string")return t;const e=t;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function EC(t){if(typeof t!="object"||t===null)return{};const e=t,n=e.inlinedResponses;if(typeof n!="object"||n===null)return t;const i=n.inlinedResponses;if(!Array.isArray(i)||i.length===0)return t;let s=!1;for(const o of i){if(typeof o!="object"||o===null)continue;const l=o.response;if(typeof l!="object"||l===null)continue;if(l.embedding!==void 0){s=!0;break}}return s&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),t}function Va(t,e){const n=e;if(!t.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error(`Invalid batch job name: ${n}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error(`Invalid batch job name: ${n}.`)}function IC(t){const e=t;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function d1(t){const e={},n=c(t,["responsesFile"]);n!=null&&h(e,["fileName"],n);const r=c(t,["inlinedResponses","inlinedResponses"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>G1(o))),h(e,["inlinedResponses"],s)}const i=c(t,["inlinedEmbedContentResponses","inlinedResponses"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),h(e,["inlinedEmbedContentResponses"],s)}return e}function h1(t){const e={},n=c(t,["predictionsFormat"]);n!=null&&h(e,["format"],n);const r=c(t,["gcsDestination","outputUriPrefix"]);r!=null&&h(e,["gcsUri"],r);const i=c(t,["bigqueryDestination","outputUri"]);return i!=null&&h(e,["bigqueryUri"],i),e}function f1(t){const e={},n=c(t,["format"]);n!=null&&h(e,["predictionsFormat"],n);const r=c(t,["gcsUri"]);r!=null&&h(e,["gcsDestination","outputUriPrefix"],r);const i=c(t,["bigqueryUri"]);if(i!=null&&h(e,["bigqueryDestination","outputUri"],i),c(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(c(t,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(c(t,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function ld(t){const e={},n=c(t,["name"]);n!=null&&h(e,["name"],n);const r=c(t,["metadata","displayName"]);r!=null&&h(e,["displayName"],r);const i=c(t,["metadata","state"]);i!=null&&h(e,["state"],IC(i));const s=c(t,["metadata","createTime"]);s!=null&&h(e,["createTime"],s);const o=c(t,["metadata","endTime"]);o!=null&&h(e,["endTime"],o);const a=c(t,["metadata","updateTime"]);a!=null&&h(e,["updateTime"],a);const l=c(t,["metadata","model"]);l!=null&&h(e,["model"],l);const u=c(t,["metadata","output"]);return u!=null&&h(e,["dest"],d1(EC(u))),e}function mm(t){const e={},n=c(t,["name"]);n!=null&&h(e,["name"],n);const r=c(t,["displayName"]);r!=null&&h(e,["displayName"],r);const i=c(t,["state"]);i!=null&&h(e,["state"],IC(i));const s=c(t,["error"]);s!=null&&h(e,["error"],s);const o=c(t,["createTime"]);o!=null&&h(e,["createTime"],o);const a=c(t,["startTime"]);a!=null&&h(e,["startTime"],a);const l=c(t,["endTime"]);l!=null&&h(e,["endTime"],l);const u=c(t,["updateTime"]);u!=null&&h(e,["updateTime"],u);const f=c(t,["model"]);f!=null&&h(e,["model"],f);const m=c(t,["inputConfig"]);m!=null&&h(e,["src"],p1(m));const g=c(t,["outputConfig"]);return g!=null&&h(e,["dest"],h1(EC(g))),e}function p1(t){const e={},n=c(t,["instancesFormat"]);n!=null&&h(e,["format"],n);const r=c(t,["gcsSource","uris"]);r!=null&&h(e,["gcsUri"],r);const i=c(t,["bigquerySource","inputUri"]);return i!=null&&h(e,["bigqueryUri"],i),e}function m1(t,e){const n={};if(c(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(c(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(c(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const r=c(e,["fileName"]);r!=null&&h(n,["fileName"],r);const i=c(e,["inlinedRequests"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>q1(t,o))),h(n,["requests","requests"],s)}return n}function g1(t){const e={},n=c(t,["format"]);n!=null&&h(e,["instancesFormat"],n);const r=c(t,["gcsUri"]);r!=null&&h(e,["gcsSource","uris"],r);const i=c(t,["bigqueryUri"]);if(i!=null&&h(e,["bigquerySource","inputUri"],i),c(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(c(t,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function _1(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["data"]);n!=null&&h(e,["data"],n);const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function y1(t,e){const n={},r=c(e,["name"]);return r!=null&&h(n,["_url","name"],Va(t,r)),n}function v1(t,e){const n={},r=c(e,["name"]);return r!=null&&h(n,["_url","name"],Va(t,r)),n}function T1(t){const e={},n=c(t,["content"]);n!=null&&h(e,["content"],n);const r=c(t,["citationMetadata"]);r!=null&&h(e,["citationMetadata"],E1(r));const i=c(t,["tokenCount"]);i!=null&&h(e,["tokenCount"],i);const s=c(t,["finishReason"]);s!=null&&h(e,["finishReason"],s);const o=c(t,["urlContextMetadata"]);o!=null&&h(e,["urlContextMetadata"],o);const a=c(t,["avgLogprobs"]);a!=null&&h(e,["avgLogprobs"],a);const l=c(t,["groundingMetadata"]);l!=null&&h(e,["groundingMetadata"],l);const u=c(t,["index"]);u!=null&&h(e,["index"],u);const f=c(t,["logprobsResult"]);f!=null&&h(e,["logprobsResult"],f);const m=c(t,["safetyRatings"]);if(m!=null){let g=m;Array.isArray(g)&&(g=g.map(v=>v)),h(e,["safetyRatings"],g)}return e}function E1(t){const e={},n=c(t,["citationSources"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>i)),h(e,["citations"],r)}return e}function wC(t){const e={},n=c(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>J1(s))),h(e,["parts"],i)}const r=c(t,["role"]);return r!=null&&h(e,["role"],r),e}function I1(t,e){const n={},r=c(t,["displayName"]);if(e!==void 0&&r!=null&&h(e,["batch","displayName"],r),c(t,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return n}function w1(t,e){const n={},r=c(t,["displayName"]);e!==void 0&&r!=null&&h(e,["displayName"],r);const i=c(t,["dest"]);return e!==void 0&&i!=null&&h(e,["outputConfig"],f1(c1(i))),n}function NT(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],Ge(t,r));const i=c(e,["src"]);i!=null&&h(n,["batch","inputConfig"],m1(t,TC(t,i)));const s=c(e,["config"]);return s!=null&&I1(s,n),n}function S1(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["model"],Ge(t,r));const i=c(e,["src"]);i!=null&&h(n,["inputConfig"],g1(TC(t,i)));const s=c(e,["config"]);return s!=null&&w1(s,n),n}function C1(t,e){const n={},r=c(t,["displayName"]);return e!==void 0&&r!=null&&h(e,["batch","displayName"],r),n}function A1(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],Ge(t,r));const i=c(e,["src"]);i!=null&&h(n,["batch","inputConfig"],b1(t,i));const s=c(e,["config"]);return s!=null&&C1(s,n),n}function x1(t,e){const n={},r=c(e,["name"]);return r!=null&&h(n,["_url","name"],Va(t,r)),n}function R1(t,e){const n={},r=c(e,["name"]);return r!=null&&h(n,["_url","name"],Va(t,r)),n}function P1(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["name"]);r!=null&&h(e,["name"],r);const i=c(t,["done"]);i!=null&&h(e,["done"],i);const s=c(t,["error"]);return s!=null&&h(e,["error"],s),e}function k1(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["name"]);r!=null&&h(e,["name"],r);const i=c(t,["done"]);i!=null&&h(e,["done"],i);const s=c(t,["error"]);return s!=null&&h(e,["error"],s),e}function N1(t,e){const n={},r=c(e,["contents"]);if(r!=null){let s=Xg(t,r);Array.isArray(s)&&(s=s.map(o=>o)),h(n,["requests[]","request","content"],s)}const i=c(e,["config"]);return i!=null&&(h(n,["_self"],D1(i,n)),Mk(n,{"requests[].*":"requests[].request.*"})),n}function D1(t,e){const n={},r=c(t,["taskType"]);e!==void 0&&r!=null&&h(e,["requests[]","taskType"],r);const i=c(t,["title"]);e!==void 0&&i!=null&&h(e,["requests[]","title"],i);const s=c(t,["outputDimensionality"]);if(e!==void 0&&s!=null&&h(e,["requests[]","outputDimensionality"],s),c(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(c(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function b1(t,e){const n={},r=c(e,["fileName"]);r!=null&&h(n,["file_name"],r);const i=c(e,["inlinedRequests"]);return i!=null&&h(n,["requests"],N1(t,i)),n}function M1(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["fileUri"]);n!=null&&h(e,["fileUri"],n);const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function V1(t,e,n){const r={},i=c(e,["systemInstruction"]);n!==void 0&&i!=null&&h(n,["systemInstruction"],wC(Xt(i)));const s=c(e,["temperature"]);s!=null&&h(r,["temperature"],s);const o=c(e,["topP"]);o!=null&&h(r,["topP"],o);const a=c(e,["topK"]);a!=null&&h(r,["topK"],a);const l=c(e,["candidateCount"]);l!=null&&h(r,["candidateCount"],l);const u=c(e,["maxOutputTokens"]);u!=null&&h(r,["maxOutputTokens"],u);const f=c(e,["stopSequences"]);f!=null&&h(r,["stopSequences"],f);const m=c(e,["responseLogprobs"]);m!=null&&h(r,["responseLogprobs"],m);const g=c(e,["logprobs"]);g!=null&&h(r,["logprobs"],g);const v=c(e,["presencePenalty"]);v!=null&&h(r,["presencePenalty"],v);const T=c(e,["frequencyPenalty"]);T!=null&&h(r,["frequencyPenalty"],T);const A=c(e,["seed"]);A!=null&&h(r,["seed"],A);const D=c(e,["responseMimeType"]);D!=null&&h(r,["responseMimeType"],D);const S=c(e,["responseSchema"]);S!=null&&h(r,["responseSchema"],Zg(S));const I=c(e,["responseJsonSchema"]);if(I!=null&&h(r,["responseJsonSchema"],I),c(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(c(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const P=c(e,["safetySettings"]);if(n!==void 0&&P!=null){let L=P;Array.isArray(L)&&(L=L.map(N=>Q1(N))),h(n,["safetySettings"],L)}const V=c(e,["tools"]);if(n!==void 0&&V!=null){let L=Ma(V);Array.isArray(L)&&(L=L.map(N=>Y1(ba(N)))),h(n,["tools"],L)}const U=c(e,["toolConfig"]);if(n!==void 0&&U!=null&&h(n,["toolConfig"],U),c(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const O=c(e,["cachedContent"]);n!==void 0&&O!=null&&h(n,["cachedContent"],ei(t,O));const E=c(e,["responseModalities"]);E!=null&&h(r,["responseModalities"],E);const w=c(e,["mediaResolution"]);w!=null&&h(r,["mediaResolution"],w);const C=c(e,["speechConfig"]);if(C!=null&&h(r,["speechConfig"],e_(C)),c(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const k=c(e,["thinkingConfig"]);k!=null&&h(r,["thinkingConfig"],k);const b=c(e,["imageConfig"]);return b!=null&&h(r,["imageConfig"],b),r}function L1(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["candidates"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(u=>T1(u))),h(e,["candidates"],l)}const i=c(t,["modelVersion"]);i!=null&&h(e,["modelVersion"],i);const s=c(t,["promptFeedback"]);s!=null&&h(e,["promptFeedback"],s);const o=c(t,["responseId"]);o!=null&&h(e,["responseId"],o);const a=c(t,["usageMetadata"]);return a!=null&&h(e,["usageMetadata"],a),e}function F1(t,e){const n={},r=c(e,["name"]);return r!=null&&h(n,["_url","name"],Va(t,r)),n}function U1(t,e){const n={},r=c(e,["name"]);return r!=null&&h(n,["_url","name"],Va(t,r)),n}function O1(t){const e={};if(c(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=c(t,["enableWidget"]);return n!=null&&h(e,["enableWidget"],n),e}function B1(t){const e={},n=c(t,["timeRangeFilter"]);if(n!=null&&h(e,["timeRangeFilter"],n),c(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function q1(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["request","model"],Ge(t,r));const i=c(e,["contents"]);if(i!=null){let a=Wn(i);Array.isArray(a)&&(a=a.map(l=>wC(l))),h(n,["request","contents"],a)}const s=c(e,["metadata"]);s!=null&&h(n,["metadata"],s);const o=c(e,["config"]);return o!=null&&h(n,["request","generationConfig"],V1(t,o,c(n,["request"],{}))),n}function G1(t){const e={},n=c(t,["response"]);n!=null&&h(e,["response"],L1(n));const r=c(t,["error"]);return r!=null&&h(e,["error"],r),e}function z1(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&h(e,["_query","pageSize"],r);const i=c(t,["pageToken"]);if(e!==void 0&&i!=null&&h(e,["_query","pageToken"],i),c(t,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return n}function $1(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&h(e,["_query","pageSize"],r);const i=c(t,["pageToken"]);e!==void 0&&i!=null&&h(e,["_query","pageToken"],i);const s=c(t,["filter"]);return e!==void 0&&s!=null&&h(e,["_query","filter"],s),n}function H1(t){const e={},n=c(t,["config"]);return n!=null&&z1(n,e),e}function W1(t){const e={},n=c(t,["config"]);return n!=null&&$1(n,e),e}function K1(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=c(t,["operations"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>ld(o))),h(e,["batchJobs"],s)}return e}function j1(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=c(t,["batchPredictionJobs"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>mm(o))),h(e,["batchJobs"],s)}return e}function J1(t){const e={},n=c(t,["videoMetadata"]);n!=null&&h(e,["videoMetadata"],n);const r=c(t,["thought"]);r!=null&&h(e,["thought"],r);const i=c(t,["inlineData"]);i!=null&&h(e,["inlineData"],_1(i));const s=c(t,["fileData"]);s!=null&&h(e,["fileData"],M1(s));const o=c(t,["thoughtSignature"]);o!=null&&h(e,["thoughtSignature"],o);const a=c(t,["functionCall"]);a!=null&&h(e,["functionCall"],a);const l=c(t,["codeExecutionResult"]);l!=null&&h(e,["codeExecutionResult"],l);const u=c(t,["executableCode"]);u!=null&&h(e,["executableCode"],u);const f=c(t,["functionResponse"]);f!=null&&h(e,["functionResponse"],f);const m=c(t,["text"]);return m!=null&&h(e,["text"],m),e}function Q1(t){const e={};if(c(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=c(t,["category"]);n!=null&&h(e,["category"],n);const r=c(t,["threshold"]);return r!=null&&h(e,["threshold"],r),e}function Y1(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(f=>f)),h(e,["functionDeclarations"],u)}if(c(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=c(t,["googleSearch"]);r!=null&&h(e,["googleSearch"],B1(r));const i=c(t,["googleSearchRetrieval"]);if(i!=null&&h(e,["googleSearchRetrieval"],i),c(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=c(t,["googleMaps"]);s!=null&&h(e,["googleMaps"],O1(s));const o=c(t,["urlContext"]);o!=null&&h(e,["urlContext"],o);const a=c(t,["computerUse"]);a!=null&&h(e,["computerUse"],a);const l=c(t,["codeExecution"]);return l!=null&&h(e,["codeExecution"],l),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Ys;(function(t){t.PAGED_ITEM_BATCH_JOBS="batchJobs",t.PAGED_ITEM_MODELS="models",t.PAGED_ITEM_TUNING_JOBS="tuningJobs",t.PAGED_ITEM_FILES="files",t.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(Ys||(Ys={}));class Ou{constructor(e,n,r,i){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(e,r,i)}init(e,n,r){var i,s;this.nameInternal=e,this.pageInternal=n[this.nameInternal]||[],this.sdkHttpResponseInternal=n==null?void 0:n.sdkHttpResponse,this.idxInternal=0;let o={config:{}};!r||Object.keys(r).length===0?o={config:{}}:typeof r=="object"?o=Object.assign({},r):o=r,o.config&&(o.config.pageToken=n.nextPageToken),this.paramsInternal=o,this.pageInternalSize=(s=(i=o.config)===null||i===void 0?void 0:i.pageSize)!==null&&s!==void 0?s:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class X1 extends lo{constructor(e){super(),this.apiClient=e,this.create=async n=>(this.apiClient.isVertexAI()&&(n.config=this.formatDestination(n.src,n.config)),this.createInternal(n)),this.createEmbeddings=async n=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(n)},this.list=async(n={})=>new Ou(Ys.PAGED_ITEM_BATCH_JOBS,r=>this.listInternal(r),await this.listInternal(n),n)}createInlinedGenerateContentRequest(e){const n=NT(this.apiClient,e),r=n._url,i=de("{model}:batchGenerateContent",r),a=n.batch.inputConfig.requests,l=a.requests,u=[];for(const f of l){const m=Object.assign({},f);if(m.systemInstruction){const g=m.systemInstruction;delete m.systemInstruction;const v=m.request;v.systemInstruction=g,m.request=v}u.push(m)}return a.requests=u,delete n.config,delete n._url,delete n._query,{path:i,body:n}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,n){const r=n?Object.assign({},n):{},i=Date.now().toString();if(r.displayName||(r.displayName=`genaiBatchJob_${i}`),r.dest===void 0){const s=this.getGcsUri(e),o=this.getBigqueryUri(e);if(s)s.endsWith(".jsonl")?r.dest=`${s.slice(0,-6)}/dest`:r.dest=`${s}_dest_${i}`;else if(o)r.dest=`${o}_dest_${i}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return r}async createInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=S1(this.apiClient,e);return a=de("batchPredictionJobs",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>mm(f))}else{const u=NT(this.apiClient,e);return a=de("{model}:batchGenerateContent",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>ld(f))}}async createEmbeddingsInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=A1(this.apiClient,e);return s=de("{model}:asyncBatchEmbedContent",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>ld(l))}}async get(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=U1(this.apiClient,e);return a=de("batchPredictionJobs/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>mm(f))}else{const u=F1(this.apiClient,e);return a=de("batches/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>ld(f))}}async cancel(e){var n,r,i,s;let o="",a={};if(this.apiClient.isVertexAI()){const l=v1(this.apiClient,e);o=de("batchPredictionJobs/{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}else{const l=y1(this.apiClient,e);o=de("batches/{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal})}}async listInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=W1(e);return a=de("batchPredictionJobs",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=j1(f),g=new xT;return Object.assign(g,m),g})}else{const u=H1(e);return a=de("batches",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=K1(f),g=new xT;return Object.assign(g,m),g})}}async delete(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=R1(this.apiClient,e);return a=de("batchPredictionJobs/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>k1(f))}else{const u=x1(this.apiClient,e);return a=de("batches/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>P1(f))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Z1(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["data"]);n!=null&&h(e,["data"],n);const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function DT(t){const e={},n=c(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>TN(s))),h(e,["parts"],i)}const r=c(t,["role"]);return r!=null&&h(e,["role"],r),e}function eN(t,e){const n={},r=c(t,["ttl"]);e!==void 0&&r!=null&&h(e,["ttl"],r);const i=c(t,["expireTime"]);e!==void 0&&i!=null&&h(e,["expireTime"],i);const s=c(t,["displayName"]);e!==void 0&&s!=null&&h(e,["displayName"],s);const o=c(t,["contents"]);if(e!==void 0&&o!=null){let f=Wn(o);Array.isArray(f)&&(f=f.map(m=>DT(m))),h(e,["contents"],f)}const a=c(t,["systemInstruction"]);e!==void 0&&a!=null&&h(e,["systemInstruction"],DT(Xt(a)));const l=c(t,["tools"]);if(e!==void 0&&l!=null){let f=l;Array.isArray(f)&&(f=f.map(m=>EN(m))),h(e,["tools"],f)}const u=c(t,["toolConfig"]);if(e!==void 0&&u!=null&&h(e,["toolConfig"],u),c(t,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function tN(t,e){const n={},r=c(t,["ttl"]);e!==void 0&&r!=null&&h(e,["ttl"],r);const i=c(t,["expireTime"]);e!==void 0&&i!=null&&h(e,["expireTime"],i);const s=c(t,["displayName"]);e!==void 0&&s!=null&&h(e,["displayName"],s);const o=c(t,["contents"]);if(e!==void 0&&o!=null){let m=Wn(o);Array.isArray(m)&&(m=m.map(g=>g)),h(e,["contents"],m)}const a=c(t,["systemInstruction"]);e!==void 0&&a!=null&&h(e,["systemInstruction"],Xt(a));const l=c(t,["tools"]);if(e!==void 0&&l!=null){let m=l;Array.isArray(m)&&(m=m.map(g=>IN(g))),h(e,["tools"],m)}const u=c(t,["toolConfig"]);e!==void 0&&u!=null&&h(e,["toolConfig"],u);const f=c(t,["kmsKeyName"]);return e!==void 0&&f!=null&&h(e,["encryption_spec","kmsKeyName"],f),n}function nN(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["model"],dC(t,r));const i=c(e,["config"]);return i!=null&&eN(i,n),n}function rN(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["model"],dC(t,r));const i=c(e,["config"]);return i!=null&&tN(i,n),n}function iN(t,e){const n={},r=c(e,["name"]);return r!=null&&h(n,["_url","name"],ei(t,r)),n}function sN(t,e){const n={},r=c(e,["name"]);return r!=null&&h(n,["_url","name"],ei(t,r)),n}function oN(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&h(e,["sdkHttpResponse"],n),e}function aN(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&h(e,["sdkHttpResponse"],n),e}function lN(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["fileUri"]);n!=null&&h(e,["fileUri"],n);const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function uN(t){const e={};if(c(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=c(t,["description"]);n!=null&&h(e,["description"],n);const r=c(t,["name"]);r!=null&&h(e,["name"],r);const i=c(t,["parameters"]);i!=null&&h(e,["parameters"],i);const s=c(t,["parametersJsonSchema"]);s!=null&&h(e,["parametersJsonSchema"],s);const o=c(t,["response"]);o!=null&&h(e,["response"],o);const a=c(t,["responseJsonSchema"]);return a!=null&&h(e,["responseJsonSchema"],a),e}function cN(t,e){const n={},r=c(e,["name"]);return r!=null&&h(n,["_url","name"],ei(t,r)),n}function dN(t,e){const n={},r=c(e,["name"]);return r!=null&&h(n,["_url","name"],ei(t,r)),n}function hN(t){const e={};if(c(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=c(t,["enableWidget"]);return n!=null&&h(e,["enableWidget"],n),e}function fN(t){const e={},n=c(t,["timeRangeFilter"]);if(n!=null&&h(e,["timeRangeFilter"],n),c(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function pN(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&h(e,["_query","pageSize"],r);const i=c(t,["pageToken"]);return e!==void 0&&i!=null&&h(e,["_query","pageToken"],i),n}function mN(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&h(e,["_query","pageSize"],r);const i=c(t,["pageToken"]);return e!==void 0&&i!=null&&h(e,["_query","pageToken"],i),n}function gN(t){const e={},n=c(t,["config"]);return n!=null&&pN(n,e),e}function _N(t){const e={},n=c(t,["config"]);return n!=null&&mN(n,e),e}function yN(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=c(t,["cachedContents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),h(e,["cachedContents"],s)}return e}function vN(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=c(t,["cachedContents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),h(e,["cachedContents"],s)}return e}function TN(t){const e={},n=c(t,["videoMetadata"]);n!=null&&h(e,["videoMetadata"],n);const r=c(t,["thought"]);r!=null&&h(e,["thought"],r);const i=c(t,["inlineData"]);i!=null&&h(e,["inlineData"],Z1(i));const s=c(t,["fileData"]);s!=null&&h(e,["fileData"],lN(s));const o=c(t,["thoughtSignature"]);o!=null&&h(e,["thoughtSignature"],o);const a=c(t,["functionCall"]);a!=null&&h(e,["functionCall"],a);const l=c(t,["codeExecutionResult"]);l!=null&&h(e,["codeExecutionResult"],l);const u=c(t,["executableCode"]);u!=null&&h(e,["executableCode"],u);const f=c(t,["functionResponse"]);f!=null&&h(e,["functionResponse"],f);const m=c(t,["text"]);return m!=null&&h(e,["text"],m),e}function EN(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(f=>f)),h(e,["functionDeclarations"],u)}if(c(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=c(t,["googleSearch"]);r!=null&&h(e,["googleSearch"],fN(r));const i=c(t,["googleSearchRetrieval"]);if(i!=null&&h(e,["googleSearchRetrieval"],i),c(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=c(t,["googleMaps"]);s!=null&&h(e,["googleMaps"],hN(s));const o=c(t,["urlContext"]);o!=null&&h(e,["urlContext"],o);const a=c(t,["computerUse"]);a!=null&&h(e,["computerUse"],a);const l=c(t,["codeExecution"]);return l!=null&&h(e,["codeExecution"],l),e}function IN(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let m=n;Array.isArray(m)&&(m=m.map(g=>uN(g))),h(e,["functionDeclarations"],m)}const r=c(t,["retrieval"]);r!=null&&h(e,["retrieval"],r);const i=c(t,["googleSearch"]);i!=null&&h(e,["googleSearch"],i);const s=c(t,["googleSearchRetrieval"]);s!=null&&h(e,["googleSearchRetrieval"],s);const o=c(t,["enterpriseWebSearch"]);o!=null&&h(e,["enterpriseWebSearch"],o);const a=c(t,["googleMaps"]);a!=null&&h(e,["googleMaps"],a);const l=c(t,["urlContext"]);l!=null&&h(e,["urlContext"],l);const u=c(t,["computerUse"]);u!=null&&h(e,["computerUse"],u);const f=c(t,["codeExecution"]);return f!=null&&h(e,["codeExecution"],f),e}function wN(t,e){const n={},r=c(t,["ttl"]);e!==void 0&&r!=null&&h(e,["ttl"],r);const i=c(t,["expireTime"]);return e!==void 0&&i!=null&&h(e,["expireTime"],i),n}function SN(t,e){const n={},r=c(t,["ttl"]);e!==void 0&&r!=null&&h(e,["ttl"],r);const i=c(t,["expireTime"]);return e!==void 0&&i!=null&&h(e,["expireTime"],i),n}function CN(t,e){const n={},r=c(e,["name"]);r!=null&&h(n,["_url","name"],ei(t,r));const i=c(e,["config"]);return i!=null&&wN(i,n),n}function AN(t,e){const n={},r=c(e,["name"]);r!=null&&h(n,["_url","name"],ei(t,r));const i=c(e,["config"]);return i!=null&&SN(i,n),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class xN extends lo{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new Ou(Ys.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(n),n)}async create(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=rN(this.apiClient,e);return a=de("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>f)}else{const u=nN(this.apiClient,e);return a=de("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>f)}}async get(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=dN(this.apiClient,e);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>f)}else{const u=cN(this.apiClient,e);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>f)}}async delete(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=sN(this.apiClient,e);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=aN(f),g=new CT;return Object.assign(g,m),g})}else{const u=iN(this.apiClient,e);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=oN(f),g=new CT;return Object.assign(g,m),g})}}async update(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=AN(this.apiClient,e);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>f)}else{const u=CN(this.apiClient,e);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>f)}}async listInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=_N(e);return a=de("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=vN(f),g=new AT;return Object.assign(g,m),g})}else{const u=gN(e);return a=de("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=yN(f),g=new AT;return Object.assign(g,m),g})}}}function bT(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function nt(t){return this instanceof nt?(this.v=t,this):new nt(t)}function ta(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),i,s=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(v){return function(T){return Promise.resolve(T).then(v,m)}}function a(v,T){r[v]&&(i[v]=function(A){return new Promise(function(D,S){s.push([v,A,D,S])>1||l(v,A)})},T&&(i[v]=T(i[v])))}function l(v,T){try{u(r[v](T))}catch(A){g(s[0][3],A)}}function u(v){v.value instanceof nt?Promise.resolve(v.value.v).then(f,m):g(s[0][2],v)}function f(v){l("next",v)}function m(v){l("throw",v)}function g(v,T){v(T),s.shift(),s.length&&l(s[0][0],s[0][1])}}function $l(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof bT=="function"?bT(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(s){n[s]=t[s]&&function(o){return new Promise(function(a,l){o=t[s](o),i(a,l,o.done,o.value)})}}function i(s,o,a,l){Promise.resolve(l).then(function(u){s({value:u,done:a})},o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function RN(t){var e;if(t.candidates==null||t.candidates.length===0)return!1;const n=(e=t.candidates[0])===null||e===void 0?void 0:e.content;return n===void 0?!1:SC(n)}function SC(t){if(t.parts===void 0||t.parts.length===0)return!1;for(const e of t.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function PN(t){if(t.length!==0){for(const e of t)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function MT(t){if(t===void 0||t.length===0)return[];const e=[],n=t.length;let r=0;for(;r<n;)if(t[r].role==="user")e.push(t[r]),r++;else{const i=[];let s=!0;for(;r<n&&t[r].role==="model";)i.push(t[r]),s&&!SC(t[r])&&(s=!1),r++;s?e.push(...i):e.pop()}return e}class kN{constructor(e,n){this.modelsModule=e,this.apiClient=n}create(e){return new NN(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class NN{constructor(e,n,r,i={},s=[]){this.apiClient=e,this.modelsModule=n,this.model=r,this.config=i,this.history=s,this.sendPromise=Promise.resolve(),PN(s)}async sendMessage(e){var n;await this.sendPromise;const r=Xt(e.message),i=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var s,o,a;const l=await i,u=(o=(s=l.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content,f=l.automaticFunctionCallingHistory,m=this.getHistory(!0).length;let g=[];f!=null&&(g=(a=f.slice(m))!==null&&a!==void 0?a:[]);const v=u?[u]:[];this.recordHistory(r,v,g)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),i}async sendMessageStream(e){var n;await this.sendPromise;const r=Xt(e.message),i=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});this.sendPromise=i.then(()=>{}).catch(()=>{});const s=await i;return this.processStreamResponse(s,r)}getHistory(e=!1){const n=e?MT(this.history):this.history;return structuredClone(n)}processStreamResponse(e,n){var r,i;return ta(this,arguments,function*(){var o,a,l,u;const f=[];try{for(var m=!0,g=$l(e),v;v=yield nt(g.next()),o=v.done,!o;m=!0){u=v.value,m=!1;const T=u;if(RN(T)){const A=(i=(r=T.candidates)===null||r===void 0?void 0:r[0])===null||i===void 0?void 0:i.content;A!==void 0&&f.push(A)}yield yield nt(T)}}catch(T){a={error:T}}finally{try{!m&&!o&&(l=g.return)&&(yield nt(l.call(g)))}finally{if(a)throw a.error}}this.recordHistory(n,f)})}recordHistory(e,n,r){let i=[];n.length>0&&n.every(s=>s.role!==void 0)?i=n:i.push({role:"model",parts:[]}),r&&r.length>0?this.history.push(...MT(r)):this.history.push(e),this.history.push(...i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Bh extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,Bh.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function DN(t){const e={},n=c(t,["file"]);return n!=null&&h(e,["file"],n),e}function bN(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&h(e,["sdkHttpResponse"],n),e}function MN(t){const e={},n=c(t,["name"]);return n!=null&&h(e,["_url","file"],_C(n)),e}function VN(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&h(e,["sdkHttpResponse"],n),e}function LN(t){const e={},n=c(t,["name"]);return n!=null&&h(e,["_url","file"],_C(n)),e}function FN(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&h(e,["_query","pageSize"],r);const i=c(t,["pageToken"]);return e!==void 0&&i!=null&&h(e,["_query","pageToken"],i),n}function UN(t){const e={},n=c(t,["config"]);return n!=null&&FN(n,e),e}function ON(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=c(t,["files"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),h(e,["files"],s)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class BN extends lo{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new Ou(Ys.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(n),n)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(n=>n)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=UN(e);return s=de("files",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>{const u=ON(l),f=new Yk;return Object.assign(f,u),f})}}async createInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=DN(e);return s=de("upload/v1beta/files",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=bN(l),f=new Xk;return Object.assign(f,u),f})}}async get(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=LN(e);return s=de("files/{file}",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>l)}}async delete(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=MN(e);return s=de("files/{file}",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>{const u=VN(l),f=new Zk;return Object.assign(f,u),f})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ud(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["data"]);n!=null&&h(e,["data"],n);const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function qN(t){const e={},n=c(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>nD(s))),h(e,["parts"],i)}const r=c(t,["role"]);return r!=null&&h(e,["role"],r),e}function GN(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["fileUri"]);n!=null&&h(e,["fileUri"],n);const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function zN(t){const e={};if(c(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=c(t,["description"]);n!=null&&h(e,["description"],n);const r=c(t,["name"]);r!=null&&h(e,["name"],r);const i=c(t,["parameters"]);i!=null&&h(e,["parameters"],i);const s=c(t,["parametersJsonSchema"]);s!=null&&h(e,["parametersJsonSchema"],s);const o=c(t,["response"]);o!=null&&h(e,["response"],o);const a=c(t,["responseJsonSchema"]);return a!=null&&h(e,["responseJsonSchema"],a),e}function $N(t){const e={},n=c(t,["modelSelectionConfig"]);n!=null&&h(e,["modelConfig"],n);const r=c(t,["audioTimestamp"]);r!=null&&h(e,["audioTimestamp"],r);const i=c(t,["candidateCount"]);i!=null&&h(e,["candidateCount"],i);const s=c(t,["enableAffectiveDialog"]);s!=null&&h(e,["enableAffectiveDialog"],s);const o=c(t,["frequencyPenalty"]);o!=null&&h(e,["frequencyPenalty"],o);const a=c(t,["logprobs"]);a!=null&&h(e,["logprobs"],a);const l=c(t,["maxOutputTokens"]);l!=null&&h(e,["maxOutputTokens"],l);const u=c(t,["mediaResolution"]);u!=null&&h(e,["mediaResolution"],u);const f=c(t,["presencePenalty"]);f!=null&&h(e,["presencePenalty"],f);const m=c(t,["responseJsonSchema"]);m!=null&&h(e,["responseJsonSchema"],m);const g=c(t,["responseLogprobs"]);g!=null&&h(e,["responseLogprobs"],g);const v=c(t,["responseMimeType"]);v!=null&&h(e,["responseMimeType"],v);const T=c(t,["responseModalities"]);T!=null&&h(e,["responseModalities"],T);const A=c(t,["responseSchema"]);A!=null&&h(e,["responseSchema"],A);const D=c(t,["routingConfig"]);D!=null&&h(e,["routingConfig"],D);const S=c(t,["seed"]);S!=null&&h(e,["seed"],S);const I=c(t,["speechConfig"]);I!=null&&h(e,["speechConfig"],CC(I));const P=c(t,["stopSequences"]);P!=null&&h(e,["stopSequences"],P);const V=c(t,["temperature"]);V!=null&&h(e,["temperature"],V);const U=c(t,["thinkingConfig"]);U!=null&&h(e,["thinkingConfig"],U);const O=c(t,["topK"]);O!=null&&h(e,["topK"],O);const E=c(t,["topP"]);return E!=null&&h(e,["topP"],E),e}function HN(t){const e={};if(c(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=c(t,["enableWidget"]);return n!=null&&h(e,["enableWidget"],n),e}function WN(t){const e={},n=c(t,["timeRangeFilter"]);if(n!=null&&h(e,["timeRangeFilter"],n),c(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function KN(t,e){const n={},r=c(t,["generationConfig"]);e!==void 0&&r!=null&&h(e,["setup","generationConfig"],r);const i=c(t,["responseModalities"]);e!==void 0&&i!=null&&h(e,["setup","generationConfig","responseModalities"],i);const s=c(t,["temperature"]);e!==void 0&&s!=null&&h(e,["setup","generationConfig","temperature"],s);const o=c(t,["topP"]);e!==void 0&&o!=null&&h(e,["setup","generationConfig","topP"],o);const a=c(t,["topK"]);e!==void 0&&a!=null&&h(e,["setup","generationConfig","topK"],a);const l=c(t,["maxOutputTokens"]);e!==void 0&&l!=null&&h(e,["setup","generationConfig","maxOutputTokens"],l);const u=c(t,["mediaResolution"]);e!==void 0&&u!=null&&h(e,["setup","generationConfig","mediaResolution"],u);const f=c(t,["seed"]);e!==void 0&&f!=null&&h(e,["setup","generationConfig","seed"],f);const m=c(t,["speechConfig"]);e!==void 0&&m!=null&&h(e,["setup","generationConfig","speechConfig"],t_(m));const g=c(t,["thinkingConfig"]);e!==void 0&&g!=null&&h(e,["setup","generationConfig","thinkingConfig"],g);const v=c(t,["enableAffectiveDialog"]);e!==void 0&&v!=null&&h(e,["setup","generationConfig","enableAffectiveDialog"],v);const T=c(t,["systemInstruction"]);e!==void 0&&T!=null&&h(e,["setup","systemInstruction"],qN(Xt(T)));const A=c(t,["tools"]);if(e!==void 0&&A!=null){let O=Ma(A);Array.isArray(O)&&(O=O.map(E=>iD(ba(E)))),h(e,["setup","tools"],O)}const D=c(t,["sessionResumption"]);e!==void 0&&D!=null&&h(e,["setup","sessionResumption"],rD(D));const S=c(t,["inputAudioTranscription"]);e!==void 0&&S!=null&&h(e,["setup","inputAudioTranscription"],S);const I=c(t,["outputAudioTranscription"]);e!==void 0&&I!=null&&h(e,["setup","outputAudioTranscription"],I);const P=c(t,["realtimeInputConfig"]);e!==void 0&&P!=null&&h(e,["setup","realtimeInputConfig"],P);const V=c(t,["contextWindowCompression"]);e!==void 0&&V!=null&&h(e,["setup","contextWindowCompression"],V);const U=c(t,["proactivity"]);return e!==void 0&&U!=null&&h(e,["setup","proactivity"],U),n}function jN(t,e){const n={},r=c(t,["generationConfig"]);e!==void 0&&r!=null&&h(e,["setup","generationConfig"],$N(r));const i=c(t,["responseModalities"]);e!==void 0&&i!=null&&h(e,["setup","generationConfig","responseModalities"],i);const s=c(t,["temperature"]);e!==void 0&&s!=null&&h(e,["setup","generationConfig","temperature"],s);const o=c(t,["topP"]);e!==void 0&&o!=null&&h(e,["setup","generationConfig","topP"],o);const a=c(t,["topK"]);e!==void 0&&a!=null&&h(e,["setup","generationConfig","topK"],a);const l=c(t,["maxOutputTokens"]);e!==void 0&&l!=null&&h(e,["setup","generationConfig","maxOutputTokens"],l);const u=c(t,["mediaResolution"]);e!==void 0&&u!=null&&h(e,["setup","generationConfig","mediaResolution"],u);const f=c(t,["seed"]);e!==void 0&&f!=null&&h(e,["setup","generationConfig","seed"],f);const m=c(t,["speechConfig"]);e!==void 0&&m!=null&&h(e,["setup","generationConfig","speechConfig"],CC(t_(m)));const g=c(t,["thinkingConfig"]);e!==void 0&&g!=null&&h(e,["setup","generationConfig","thinkingConfig"],g);const v=c(t,["enableAffectiveDialog"]);e!==void 0&&v!=null&&h(e,["setup","generationConfig","enableAffectiveDialog"],v);const T=c(t,["systemInstruction"]);e!==void 0&&T!=null&&h(e,["setup","systemInstruction"],Xt(T));const A=c(t,["tools"]);if(e!==void 0&&A!=null){let O=Ma(A);Array.isArray(O)&&(O=O.map(E=>sD(ba(E)))),h(e,["setup","tools"],O)}const D=c(t,["sessionResumption"]);e!==void 0&&D!=null&&h(e,["setup","sessionResumption"],D);const S=c(t,["inputAudioTranscription"]);e!==void 0&&S!=null&&h(e,["setup","inputAudioTranscription"],S);const I=c(t,["outputAudioTranscription"]);e!==void 0&&I!=null&&h(e,["setup","outputAudioTranscription"],I);const P=c(t,["realtimeInputConfig"]);e!==void 0&&P!=null&&h(e,["setup","realtimeInputConfig"],P);const V=c(t,["contextWindowCompression"]);e!==void 0&&V!=null&&h(e,["setup","contextWindowCompression"],V);const U=c(t,["proactivity"]);return e!==void 0&&U!=null&&h(e,["setup","proactivity"],U),n}function JN(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["setup","model"],Ge(t,r));const i=c(e,["config"]);return i!=null&&h(n,["config"],KN(i,n)),n}function QN(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["setup","model"],Ge(t,r));const i=c(e,["config"]);return i!=null&&h(n,["config"],jN(i,n)),n}function YN(t){const e={},n=c(t,["musicGenerationConfig"]);return n!=null&&h(e,["musicGenerationConfig"],n),e}function XN(t){const e={},n=c(t,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>i)),h(e,["weightedPrompts"],r)}return e}function ZN(t){const e={},n=c(t,["media"]);if(n!=null){let u=hC(n);Array.isArray(u)&&(u=u.map(f=>ud(f))),h(e,["mediaChunks"],u)}const r=c(t,["audio"]);r!=null&&h(e,["audio"],ud(pC(r)));const i=c(t,["audioStreamEnd"]);i!=null&&h(e,["audioStreamEnd"],i);const s=c(t,["video"]);s!=null&&h(e,["video"],ud(fC(s)));const o=c(t,["text"]);o!=null&&h(e,["text"],o);const a=c(t,["activityStart"]);a!=null&&h(e,["activityStart"],a);const l=c(t,["activityEnd"]);return l!=null&&h(e,["activityEnd"],l),e}function eD(t){const e={},n=c(t,["media"]);if(n!=null){let u=hC(n);Array.isArray(u)&&(u=u.map(f=>f)),h(e,["mediaChunks"],u)}const r=c(t,["audio"]);r!=null&&h(e,["audio"],pC(r));const i=c(t,["audioStreamEnd"]);i!=null&&h(e,["audioStreamEnd"],i);const s=c(t,["video"]);s!=null&&h(e,["video"],fC(s));const o=c(t,["text"]);o!=null&&h(e,["text"],o);const a=c(t,["activityStart"]);a!=null&&h(e,["activityStart"],a);const l=c(t,["activityEnd"]);return l!=null&&h(e,["activityEnd"],l),e}function tD(t){const e={},n=c(t,["setupComplete"]);n!=null&&h(e,["setupComplete"],n);const r=c(t,["serverContent"]);r!=null&&h(e,["serverContent"],r);const i=c(t,["toolCall"]);i!=null&&h(e,["toolCall"],i);const s=c(t,["toolCallCancellation"]);s!=null&&h(e,["toolCallCancellation"],s);const o=c(t,["usageMetadata"]);o!=null&&h(e,["usageMetadata"],oD(o));const a=c(t,["goAway"]);a!=null&&h(e,["goAway"],a);const l=c(t,["sessionResumptionUpdate"]);return l!=null&&h(e,["sessionResumptionUpdate"],l),e}function nD(t){const e={},n=c(t,["videoMetadata"]);n!=null&&h(e,["videoMetadata"],n);const r=c(t,["thought"]);r!=null&&h(e,["thought"],r);const i=c(t,["inlineData"]);i!=null&&h(e,["inlineData"],ud(i));const s=c(t,["fileData"]);s!=null&&h(e,["fileData"],GN(s));const o=c(t,["thoughtSignature"]);o!=null&&h(e,["thoughtSignature"],o);const a=c(t,["functionCall"]);a!=null&&h(e,["functionCall"],a);const l=c(t,["codeExecutionResult"]);l!=null&&h(e,["codeExecutionResult"],l);const u=c(t,["executableCode"]);u!=null&&h(e,["executableCode"],u);const f=c(t,["functionResponse"]);f!=null&&h(e,["functionResponse"],f);const m=c(t,["text"]);return m!=null&&h(e,["text"],m),e}function rD(t){const e={},n=c(t,["handle"]);if(n!=null&&h(e,["handle"],n),c(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function CC(t){const e={},n=c(t,["voiceConfig"]);if(n!=null&&h(e,["voiceConfig"],n),c(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const r=c(t,["languageCode"]);return r!=null&&h(e,["languageCode"],r),e}function iD(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(f=>f)),h(e,["functionDeclarations"],u)}if(c(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=c(t,["googleSearch"]);r!=null&&h(e,["googleSearch"],WN(r));const i=c(t,["googleSearchRetrieval"]);if(i!=null&&h(e,["googleSearchRetrieval"],i),c(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=c(t,["googleMaps"]);s!=null&&h(e,["googleMaps"],HN(s));const o=c(t,["urlContext"]);o!=null&&h(e,["urlContext"],o);const a=c(t,["computerUse"]);a!=null&&h(e,["computerUse"],a);const l=c(t,["codeExecution"]);return l!=null&&h(e,["codeExecution"],l),e}function sD(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let m=n;Array.isArray(m)&&(m=m.map(g=>zN(g))),h(e,["functionDeclarations"],m)}const r=c(t,["retrieval"]);r!=null&&h(e,["retrieval"],r);const i=c(t,["googleSearch"]);i!=null&&h(e,["googleSearch"],i);const s=c(t,["googleSearchRetrieval"]);s!=null&&h(e,["googleSearchRetrieval"],s);const o=c(t,["enterpriseWebSearch"]);o!=null&&h(e,["enterpriseWebSearch"],o);const a=c(t,["googleMaps"]);a!=null&&h(e,["googleMaps"],a);const l=c(t,["urlContext"]);l!=null&&h(e,["urlContext"],l);const u=c(t,["computerUse"]);u!=null&&h(e,["computerUse"],u);const f=c(t,["codeExecution"]);return f!=null&&h(e,["codeExecution"],f),e}function oD(t){const e={},n=c(t,["promptTokenCount"]);n!=null&&h(e,["promptTokenCount"],n);const r=c(t,["cachedContentTokenCount"]);r!=null&&h(e,["cachedContentTokenCount"],r);const i=c(t,["candidatesTokenCount"]);i!=null&&h(e,["responseTokenCount"],i);const s=c(t,["toolUsePromptTokenCount"]);s!=null&&h(e,["toolUsePromptTokenCount"],s);const o=c(t,["thoughtsTokenCount"]);o!=null&&h(e,["thoughtsTokenCount"],o);const a=c(t,["totalTokenCount"]);a!=null&&h(e,["totalTokenCount"],a);const l=c(t,["promptTokensDetails"]);if(l!=null){let v=l;Array.isArray(v)&&(v=v.map(T=>T)),h(e,["promptTokensDetails"],v)}const u=c(t,["cacheTokensDetails"]);if(u!=null){let v=u;Array.isArray(v)&&(v=v.map(T=>T)),h(e,["cacheTokensDetails"],v)}const f=c(t,["candidatesTokensDetails"]);if(f!=null){let v=f;Array.isArray(v)&&(v=v.map(T=>T)),h(e,["responseTokensDetails"],v)}const m=c(t,["toolUsePromptTokensDetails"]);if(m!=null){let v=m;Array.isArray(v)&&(v=v.map(T=>T)),h(e,["toolUsePromptTokensDetails"],v)}const g=c(t,["trafficType"]);return g!=null&&h(e,["trafficType"],g),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function aD(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["data"]);n!=null&&h(e,["data"],n);const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function lD(t){const e={},n=c(t,["content"]);n!=null&&h(e,["content"],n);const r=c(t,["citationMetadata"]);r!=null&&h(e,["citationMetadata"],uD(r));const i=c(t,["tokenCount"]);i!=null&&h(e,["tokenCount"],i);const s=c(t,["finishReason"]);s!=null&&h(e,["finishReason"],s);const o=c(t,["urlContextMetadata"]);o!=null&&h(e,["urlContextMetadata"],o);const a=c(t,["avgLogprobs"]);a!=null&&h(e,["avgLogprobs"],a);const l=c(t,["groundingMetadata"]);l!=null&&h(e,["groundingMetadata"],l);const u=c(t,["index"]);u!=null&&h(e,["index"],u);const f=c(t,["logprobsResult"]);f!=null&&h(e,["logprobsResult"],f);const m=c(t,["safetyRatings"]);if(m!=null){let g=m;Array.isArray(g)&&(g=g.map(v=>v)),h(e,["safetyRatings"],g)}return e}function uD(t){const e={},n=c(t,["citationSources"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>i)),h(e,["citations"],r)}return e}function cD(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],Ge(t,r));const i=c(e,["contents"]);if(i!=null){let s=Wn(i);Array.isArray(s)&&(s=s.map(o=>o)),h(n,["contents"],s)}return n}function dD(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["tokensInfo"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>s)),h(e,["tokensInfo"],i)}return e}function hD(t){const e={},n=c(t,["values"]);n!=null&&h(e,["values"],n);const r=c(t,["statistics"]);return r!=null&&h(e,["statistics"],fD(r)),e}function fD(t){const e={},n=c(t,["truncated"]);n!=null&&h(e,["truncated"],n);const r=c(t,["token_count"]);return r!=null&&h(e,["tokenCount"],r),e}function qh(t){const e={},n=c(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>yb(s))),h(e,["parts"],i)}const r=c(t,["role"]);return r!=null&&h(e,["role"],r),e}function pD(t){const e={},n=c(t,["controlType"]);n!=null&&h(e,["controlType"],n);const r=c(t,["enableControlImageComputation"]);return r!=null&&h(e,["computeControl"],r),e}function mD(t){const e={};if(c(t,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(c(t,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(c(t,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function gD(t,e){const n={},r=c(t,["systemInstruction"]);e!==void 0&&r!=null&&h(e,["systemInstruction"],Xt(r));const i=c(t,["tools"]);if(e!==void 0&&i!=null){let o=i;Array.isArray(o)&&(o=o.map(a=>kC(a))),h(e,["tools"],o)}const s=c(t,["generationConfig"]);return e!==void 0&&s!=null&&h(e,["generationConfig"],sb(s)),n}function _D(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],Ge(t,r));const i=c(e,["contents"]);if(i!=null){let o=Wn(i);Array.isArray(o)&&(o=o.map(a=>qh(a))),h(n,["contents"],o)}const s=c(e,["config"]);return s!=null&&mD(s),n}function yD(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],Ge(t,r));const i=c(e,["contents"]);if(i!=null){let o=Wn(i);Array.isArray(o)&&(o=o.map(a=>a)),h(n,["contents"],o)}const s=c(e,["config"]);return s!=null&&gD(s,n),n}function vD(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["totalTokens"]);r!=null&&h(e,["totalTokens"],r);const i=c(t,["cachedContentTokenCount"]);return i!=null&&h(e,["cachedContentTokenCount"],i),e}function TD(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["totalTokens"]);return r!=null&&h(e,["totalTokens"],r),e}function ED(t,e){const n={},r=c(e,["model"]);return r!=null&&h(n,["_url","name"],Ge(t,r)),n}function ID(t,e){const n={},r=c(e,["model"]);return r!=null&&h(n,["_url","name"],Ge(t,r)),n}function wD(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&h(e,["sdkHttpResponse"],n),e}function SD(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&h(e,["sdkHttpResponse"],n),e}function CD(t,e){const n={},r=c(t,["outputGcsUri"]);e!==void 0&&r!=null&&h(e,["parameters","storageUri"],r);const i=c(t,["negativePrompt"]);e!==void 0&&i!=null&&h(e,["parameters","negativePrompt"],i);const s=c(t,["numberOfImages"]);e!==void 0&&s!=null&&h(e,["parameters","sampleCount"],s);const o=c(t,["aspectRatio"]);e!==void 0&&o!=null&&h(e,["parameters","aspectRatio"],o);const a=c(t,["guidanceScale"]);e!==void 0&&a!=null&&h(e,["parameters","guidanceScale"],a);const l=c(t,["seed"]);e!==void 0&&l!=null&&h(e,["parameters","seed"],l);const u=c(t,["safetyFilterLevel"]);e!==void 0&&u!=null&&h(e,["parameters","safetySetting"],u);const f=c(t,["personGeneration"]);e!==void 0&&f!=null&&h(e,["parameters","personGeneration"],f);const m=c(t,["includeSafetyAttributes"]);e!==void 0&&m!=null&&h(e,["parameters","includeSafetyAttributes"],m);const g=c(t,["includeRaiReason"]);e!==void 0&&g!=null&&h(e,["parameters","includeRaiReason"],g);const v=c(t,["language"]);e!==void 0&&v!=null&&h(e,["parameters","language"],v);const T=c(t,["outputMimeType"]);e!==void 0&&T!=null&&h(e,["parameters","outputOptions","mimeType"],T);const A=c(t,["outputCompressionQuality"]);e!==void 0&&A!=null&&h(e,["parameters","outputOptions","compressionQuality"],A);const D=c(t,["addWatermark"]);e!==void 0&&D!=null&&h(e,["parameters","addWatermark"],D);const S=c(t,["labels"]);e!==void 0&&S!=null&&h(e,["labels"],S);const I=c(t,["editMode"]);e!==void 0&&I!=null&&h(e,["parameters","editMode"],I);const P=c(t,["baseSteps"]);return e!==void 0&&P!=null&&h(e,["parameters","editConfig","baseSteps"],P),n}function AD(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],Ge(t,r));const i=c(e,["prompt"]);i!=null&&h(n,["instances[0]","prompt"],i);const s=c(e,["referenceImages"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>Sb(l))),h(n,["instances[0]","referenceImages"],a)}const o=c(e,["config"]);return o!=null&&CD(o,n),n}function xD(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>Gh(s))),h(e,["generatedImages"],i)}return e}function RD(t,e){const n={},r=c(t,["taskType"]);e!==void 0&&r!=null&&h(e,["requests[]","taskType"],r);const i=c(t,["title"]);e!==void 0&&i!=null&&h(e,["requests[]","title"],i);const s=c(t,["outputDimensionality"]);if(e!==void 0&&s!=null&&h(e,["requests[]","outputDimensionality"],s),c(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(c(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function PD(t,e){const n={},r=c(t,["taskType"]);e!==void 0&&r!=null&&h(e,["instances[]","task_type"],r);const i=c(t,["title"]);e!==void 0&&i!=null&&h(e,["instances[]","title"],i);const s=c(t,["outputDimensionality"]);e!==void 0&&s!=null&&h(e,["parameters","outputDimensionality"],s);const o=c(t,["mimeType"]);e!==void 0&&o!=null&&h(e,["instances[]","mimeType"],o);const a=c(t,["autoTruncate"]);return e!==void 0&&a!=null&&h(e,["parameters","autoTruncate"],a),n}function kD(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],Ge(t,r));const i=c(e,["contents"]);if(i!=null){let a=Xg(t,i);Array.isArray(a)&&(a=a.map(l=>l)),h(n,["requests[]","content"],a)}const s=c(e,["config"]);s!=null&&RD(s,n);const o=c(e,["model"]);return o!==void 0&&h(n,["requests[]","model"],Ge(t,o)),n}function ND(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],Ge(t,r));const i=c(e,["contents"]);if(i!=null){let o=Xg(t,i);Array.isArray(o)&&(o=o.map(a=>a)),h(n,["instances[]","content"],o)}const s=c(e,["config"]);return s!=null&&PD(s,n),n}function DD(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["embeddings"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>o)),h(e,["embeddings"],s)}const i=c(t,["metadata"]);return i!=null&&h(e,["metadata"],i),e}function bD(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["predictions[]","embeddings"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>hD(o))),h(e,["embeddings"],s)}const i=c(t,["metadata"]);return i!=null&&h(e,["metadata"],i),e}function MD(t){const e={},n=c(t,["endpoint"]);n!=null&&h(e,["name"],n);const r=c(t,["deployedModelId"]);return r!=null&&h(e,["deployedModelId"],r),e}function VD(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["fileUri"]);n!=null&&h(e,["fileUri"],n);const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function LD(t){const e={};if(c(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=c(t,["description"]);n!=null&&h(e,["description"],n);const r=c(t,["name"]);r!=null&&h(e,["name"],r);const i=c(t,["parameters"]);i!=null&&h(e,["parameters"],i);const s=c(t,["parametersJsonSchema"]);s!=null&&h(e,["parametersJsonSchema"],s);const o=c(t,["response"]);o!=null&&h(e,["response"],o);const a=c(t,["responseJsonSchema"]);return a!=null&&h(e,["responseJsonSchema"],a),e}function FD(t,e,n){const r={},i=c(e,["systemInstruction"]);n!==void 0&&i!=null&&h(n,["systemInstruction"],qh(Xt(i)));const s=c(e,["temperature"]);s!=null&&h(r,["temperature"],s);const o=c(e,["topP"]);o!=null&&h(r,["topP"],o);const a=c(e,["topK"]);a!=null&&h(r,["topK"],a);const l=c(e,["candidateCount"]);l!=null&&h(r,["candidateCount"],l);const u=c(e,["maxOutputTokens"]);u!=null&&h(r,["maxOutputTokens"],u);const f=c(e,["stopSequences"]);f!=null&&h(r,["stopSequences"],f);const m=c(e,["responseLogprobs"]);m!=null&&h(r,["responseLogprobs"],m);const g=c(e,["logprobs"]);g!=null&&h(r,["logprobs"],g);const v=c(e,["presencePenalty"]);v!=null&&h(r,["presencePenalty"],v);const T=c(e,["frequencyPenalty"]);T!=null&&h(r,["frequencyPenalty"],T);const A=c(e,["seed"]);A!=null&&h(r,["seed"],A);const D=c(e,["responseMimeType"]);D!=null&&h(r,["responseMimeType"],D);const S=c(e,["responseSchema"]);S!=null&&h(r,["responseSchema"],Zg(S));const I=c(e,["responseJsonSchema"]);if(I!=null&&h(r,["responseJsonSchema"],I),c(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(c(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const P=c(e,["safetySettings"]);if(n!==void 0&&P!=null){let L=P;Array.isArray(L)&&(L=L.map(N=>Cb(N))),h(n,["safetySettings"],L)}const V=c(e,["tools"]);if(n!==void 0&&V!=null){let L=Ma(V);Array.isArray(L)&&(L=L.map(N=>Nb(ba(N)))),h(n,["tools"],L)}const U=c(e,["toolConfig"]);if(n!==void 0&&U!=null&&h(n,["toolConfig"],U),c(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const O=c(e,["cachedContent"]);n!==void 0&&O!=null&&h(n,["cachedContent"],ei(t,O));const E=c(e,["responseModalities"]);E!=null&&h(r,["responseModalities"],E);const w=c(e,["mediaResolution"]);w!=null&&h(r,["mediaResolution"],w);const C=c(e,["speechConfig"]);if(C!=null&&h(r,["speechConfig"],e_(C)),c(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const k=c(e,["thinkingConfig"]);k!=null&&h(r,["thinkingConfig"],k);const b=c(e,["imageConfig"]);return b!=null&&h(r,["imageConfig"],b),r}function UD(t,e,n){const r={},i=c(e,["systemInstruction"]);n!==void 0&&i!=null&&h(n,["systemInstruction"],Xt(i));const s=c(e,["temperature"]);s!=null&&h(r,["temperature"],s);const o=c(e,["topP"]);o!=null&&h(r,["topP"],o);const a=c(e,["topK"]);a!=null&&h(r,["topK"],a);const l=c(e,["candidateCount"]);l!=null&&h(r,["candidateCount"],l);const u=c(e,["maxOutputTokens"]);u!=null&&h(r,["maxOutputTokens"],u);const f=c(e,["stopSequences"]);f!=null&&h(r,["stopSequences"],f);const m=c(e,["responseLogprobs"]);m!=null&&h(r,["responseLogprobs"],m);const g=c(e,["logprobs"]);g!=null&&h(r,["logprobs"],g);const v=c(e,["presencePenalty"]);v!=null&&h(r,["presencePenalty"],v);const T=c(e,["frequencyPenalty"]);T!=null&&h(r,["frequencyPenalty"],T);const A=c(e,["seed"]);A!=null&&h(r,["seed"],A);const D=c(e,["responseMimeType"]);D!=null&&h(r,["responseMimeType"],D);const S=c(e,["responseSchema"]);S!=null&&h(r,["responseSchema"],Zg(S));const I=c(e,["responseJsonSchema"]);I!=null&&h(r,["responseJsonSchema"],I);const P=c(e,["routingConfig"]);P!=null&&h(r,["routingConfig"],P);const V=c(e,["modelSelectionConfig"]);V!=null&&h(r,["modelConfig"],V);const U=c(e,["safetySettings"]);if(n!==void 0&&U!=null){let We=U;Array.isArray(We)&&(We=We.map(Ee=>Ee)),h(n,["safetySettings"],We)}const O=c(e,["tools"]);if(n!==void 0&&O!=null){let We=Ma(O);Array.isArray(We)&&(We=We.map(Ee=>kC(ba(Ee)))),h(n,["tools"],We)}const E=c(e,["toolConfig"]);n!==void 0&&E!=null&&h(n,["toolConfig"],E);const w=c(e,["labels"]);n!==void 0&&w!=null&&h(n,["labels"],w);const C=c(e,["cachedContent"]);n!==void 0&&C!=null&&h(n,["cachedContent"],ei(t,C));const k=c(e,["responseModalities"]);k!=null&&h(r,["responseModalities"],k);const b=c(e,["mediaResolution"]);b!=null&&h(r,["mediaResolution"],b);const L=c(e,["speechConfig"]);L!=null&&h(r,["speechConfig"],PC(e_(L)));const N=c(e,["audioTimestamp"]);N!=null&&h(r,["audioTimestamp"],N);const De=c(e,["thinkingConfig"]);De!=null&&h(r,["thinkingConfig"],De);const Fe=c(e,["imageConfig"]);return Fe!=null&&h(r,["imageConfig"],Fe),r}function VT(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],Ge(t,r));const i=c(e,["contents"]);if(i!=null){let o=Wn(i);Array.isArray(o)&&(o=o.map(a=>qh(a))),h(n,["contents"],o)}const s=c(e,["config"]);return s!=null&&h(n,["generationConfig"],FD(t,s,n)),n}function LT(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],Ge(t,r));const i=c(e,["contents"]);if(i!=null){let o=Wn(i);Array.isArray(o)&&(o=o.map(a=>a)),h(n,["contents"],o)}const s=c(e,["config"]);return s!=null&&h(n,["generationConfig"],UD(t,s,n)),n}function FT(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["candidates"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(u=>lD(u))),h(e,["candidates"],l)}const i=c(t,["modelVersion"]);i!=null&&h(e,["modelVersion"],i);const s=c(t,["promptFeedback"]);s!=null&&h(e,["promptFeedback"],s);const o=c(t,["responseId"]);o!=null&&h(e,["responseId"],o);const a=c(t,["usageMetadata"]);return a!=null&&h(e,["usageMetadata"],a),e}function UT(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["candidates"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(f=>f)),h(e,["candidates"],u)}const i=c(t,["createTime"]);i!=null&&h(e,["createTime"],i);const s=c(t,["modelVersion"]);s!=null&&h(e,["modelVersion"],s);const o=c(t,["promptFeedback"]);o!=null&&h(e,["promptFeedback"],o);const a=c(t,["responseId"]);a!=null&&h(e,["responseId"],a);const l=c(t,["usageMetadata"]);return l!=null&&h(e,["usageMetadata"],l),e}function OD(t,e){const n={};if(c(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(c(t,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const r=c(t,["numberOfImages"]);e!==void 0&&r!=null&&h(e,["parameters","sampleCount"],r);const i=c(t,["aspectRatio"]);e!==void 0&&i!=null&&h(e,["parameters","aspectRatio"],i);const s=c(t,["guidanceScale"]);if(e!==void 0&&s!=null&&h(e,["parameters","guidanceScale"],s),c(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=c(t,["safetyFilterLevel"]);e!==void 0&&o!=null&&h(e,["parameters","safetySetting"],o);const a=c(t,["personGeneration"]);e!==void 0&&a!=null&&h(e,["parameters","personGeneration"],a);const l=c(t,["includeSafetyAttributes"]);e!==void 0&&l!=null&&h(e,["parameters","includeSafetyAttributes"],l);const u=c(t,["includeRaiReason"]);e!==void 0&&u!=null&&h(e,["parameters","includeRaiReason"],u);const f=c(t,["language"]);e!==void 0&&f!=null&&h(e,["parameters","language"],f);const m=c(t,["outputMimeType"]);e!==void 0&&m!=null&&h(e,["parameters","outputOptions","mimeType"],m);const g=c(t,["outputCompressionQuality"]);if(e!==void 0&&g!=null&&h(e,["parameters","outputOptions","compressionQuality"],g),c(t,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(c(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const v=c(t,["imageSize"]);if(e!==void 0&&v!=null&&h(e,["parameters","sampleImageSize"],v),c(t,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function BD(t,e){const n={},r=c(t,["outputGcsUri"]);e!==void 0&&r!=null&&h(e,["parameters","storageUri"],r);const i=c(t,["negativePrompt"]);e!==void 0&&i!=null&&h(e,["parameters","negativePrompt"],i);const s=c(t,["numberOfImages"]);e!==void 0&&s!=null&&h(e,["parameters","sampleCount"],s);const o=c(t,["aspectRatio"]);e!==void 0&&o!=null&&h(e,["parameters","aspectRatio"],o);const a=c(t,["guidanceScale"]);e!==void 0&&a!=null&&h(e,["parameters","guidanceScale"],a);const l=c(t,["seed"]);e!==void 0&&l!=null&&h(e,["parameters","seed"],l);const u=c(t,["safetyFilterLevel"]);e!==void 0&&u!=null&&h(e,["parameters","safetySetting"],u);const f=c(t,["personGeneration"]);e!==void 0&&f!=null&&h(e,["parameters","personGeneration"],f);const m=c(t,["includeSafetyAttributes"]);e!==void 0&&m!=null&&h(e,["parameters","includeSafetyAttributes"],m);const g=c(t,["includeRaiReason"]);e!==void 0&&g!=null&&h(e,["parameters","includeRaiReason"],g);const v=c(t,["language"]);e!==void 0&&v!=null&&h(e,["parameters","language"],v);const T=c(t,["outputMimeType"]);e!==void 0&&T!=null&&h(e,["parameters","outputOptions","mimeType"],T);const A=c(t,["outputCompressionQuality"]);e!==void 0&&A!=null&&h(e,["parameters","outputOptions","compressionQuality"],A);const D=c(t,["addWatermark"]);e!==void 0&&D!=null&&h(e,["parameters","addWatermark"],D);const S=c(t,["labels"]);e!==void 0&&S!=null&&h(e,["labels"],S);const I=c(t,["imageSize"]);e!==void 0&&I!=null&&h(e,["parameters","sampleImageSize"],I);const P=c(t,["enhancePrompt"]);return e!==void 0&&P!=null&&h(e,["parameters","enhancePrompt"],P),n}function qD(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],Ge(t,r));const i=c(e,["prompt"]);i!=null&&h(n,["instances[0]","prompt"],i);const s=c(e,["config"]);return s!=null&&OD(s,n),n}function GD(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],Ge(t,r));const i=c(e,["prompt"]);i!=null&&h(n,["instances[0]","prompt"],i);const s=c(e,["config"]);return s!=null&&BD(s,n),n}function zD(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>tb(o))),h(e,["generatedImages"],s)}const i=c(t,["positivePromptSafetyAttributes"]);return i!=null&&h(e,["positivePromptSafetyAttributes"],xC(i)),e}function $D(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>Gh(o))),h(e,["generatedImages"],s)}const i=c(t,["positivePromptSafetyAttributes"]);return i!=null&&h(e,["positivePromptSafetyAttributes"],RC(i)),e}function HD(t,e){const n={},r=c(t,["numberOfVideos"]);if(e!==void 0&&r!=null&&h(e,["parameters","sampleCount"],r),c(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(c(t,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const i=c(t,["durationSeconds"]);if(e!==void 0&&i!=null&&h(e,["parameters","durationSeconds"],i),c(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const s=c(t,["aspectRatio"]);e!==void 0&&s!=null&&h(e,["parameters","aspectRatio"],s);const o=c(t,["resolution"]);e!==void 0&&o!=null&&h(e,["parameters","resolution"],o);const a=c(t,["personGeneration"]);if(e!==void 0&&a!=null&&h(e,["parameters","personGeneration"],a),c(t,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const l=c(t,["negativePrompt"]);e!==void 0&&l!=null&&h(e,["parameters","negativePrompt"],l);const u=c(t,["enhancePrompt"]);if(e!==void 0&&u!=null&&h(e,["parameters","enhancePrompt"],u),c(t,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const f=c(t,["lastFrame"]);e!==void 0&&f!=null&&h(e,["instances[0]","lastFrame"],zh(f));const m=c(t,["referenceImages"]);if(e!==void 0&&m!=null){let g=m;Array.isArray(g)&&(g=g.map(v=>$b(v))),h(e,["instances[0]","referenceImages"],g)}if(c(t,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(c(t,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return n}function WD(t,e){const n={},r=c(t,["numberOfVideos"]);e!==void 0&&r!=null&&h(e,["parameters","sampleCount"],r);const i=c(t,["outputGcsUri"]);e!==void 0&&i!=null&&h(e,["parameters","storageUri"],i);const s=c(t,["fps"]);e!==void 0&&s!=null&&h(e,["parameters","fps"],s);const o=c(t,["durationSeconds"]);e!==void 0&&o!=null&&h(e,["parameters","durationSeconds"],o);const a=c(t,["seed"]);e!==void 0&&a!=null&&h(e,["parameters","seed"],a);const l=c(t,["aspectRatio"]);e!==void 0&&l!=null&&h(e,["parameters","aspectRatio"],l);const u=c(t,["resolution"]);e!==void 0&&u!=null&&h(e,["parameters","resolution"],u);const f=c(t,["personGeneration"]);e!==void 0&&f!=null&&h(e,["parameters","personGeneration"],f);const m=c(t,["pubsubTopic"]);e!==void 0&&m!=null&&h(e,["parameters","pubsubTopic"],m);const g=c(t,["negativePrompt"]);e!==void 0&&g!=null&&h(e,["parameters","negativePrompt"],g);const v=c(t,["enhancePrompt"]);e!==void 0&&v!=null&&h(e,["parameters","enhancePrompt"],v);const T=c(t,["generateAudio"]);e!==void 0&&T!=null&&h(e,["parameters","generateAudio"],T);const A=c(t,["lastFrame"]);e!==void 0&&A!=null&&h(e,["instances[0]","lastFrame"],ur(A));const D=c(t,["referenceImages"]);if(e!==void 0&&D!=null){let P=D;Array.isArray(P)&&(P=P.map(V=>Hb(V))),h(e,["instances[0]","referenceImages"],P)}const S=c(t,["mask"]);e!==void 0&&S!=null&&h(e,["instances[0]","mask"],zb(S));const I=c(t,["compressionQuality"]);return e!==void 0&&I!=null&&h(e,["parameters","compressionQuality"],I),n}function KD(t){const e={},n=c(t,["name"]);n!=null&&h(e,["name"],n);const r=c(t,["metadata"]);r!=null&&h(e,["metadata"],r);const i=c(t,["done"]);i!=null&&h(e,["done"],i);const s=c(t,["error"]);s!=null&&h(e,["error"],s);const o=c(t,["response","generateVideoResponse"]);return o!=null&&h(e,["response"],YD(o)),e}function jD(t){const e={},n=c(t,["name"]);n!=null&&h(e,["name"],n);const r=c(t,["metadata"]);r!=null&&h(e,["metadata"],r);const i=c(t,["done"]);i!=null&&h(e,["done"],i);const s=c(t,["error"]);s!=null&&h(e,["error"],s);const o=c(t,["response"]);return o!=null&&h(e,["response"],XD(o)),e}function JD(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],Ge(t,r));const i=c(e,["prompt"]);i!=null&&h(n,["instances[0]","prompt"],i);const s=c(e,["image"]);s!=null&&h(n,["instances[0]","image"],zh(s));const o=c(e,["video"]);o!=null&&h(n,["instances[0]","video"],NC(o));const a=c(e,["source"]);a!=null&&ZD(a,n);const l=c(e,["config"]);return l!=null&&HD(l,n),n}function QD(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],Ge(t,r));const i=c(e,["prompt"]);i!=null&&h(n,["instances[0]","prompt"],i);const s=c(e,["image"]);s!=null&&h(n,["instances[0]","image"],ur(s));const o=c(e,["video"]);o!=null&&h(n,["instances[0]","video"],DC(o));const a=c(e,["source"]);a!=null&&eb(a,n);const l=c(e,["config"]);return l!=null&&WD(l,n),n}function YD(t){const e={},n=c(t,["generatedSamples"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>rb(o))),h(e,["generatedVideos"],s)}const r=c(t,["raiMediaFilteredCount"]);r!=null&&h(e,["raiMediaFilteredCount"],r);const i=c(t,["raiMediaFilteredReasons"]);return i!=null&&h(e,["raiMediaFilteredReasons"],i),e}function XD(t){const e={},n=c(t,["videos"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>ib(o))),h(e,["generatedVideos"],s)}const r=c(t,["raiMediaFilteredCount"]);r!=null&&h(e,["raiMediaFilteredCount"],r);const i=c(t,["raiMediaFilteredReasons"]);return i!=null&&h(e,["raiMediaFilteredReasons"],i),e}function ZD(t,e){const n={},r=c(t,["prompt"]);e!==void 0&&r!=null&&h(e,["instances[0]","prompt"],r);const i=c(t,["image"]);e!==void 0&&i!=null&&h(e,["instances[0]","image"],zh(i));const s=c(t,["video"]);return e!==void 0&&s!=null&&h(e,["instances[0]","video"],NC(s)),n}function eb(t,e){const n={},r=c(t,["prompt"]);e!==void 0&&r!=null&&h(e,["instances[0]","prompt"],r);const i=c(t,["image"]);e!==void 0&&i!=null&&h(e,["instances[0]","image"],ur(i));const s=c(t,["video"]);return e!==void 0&&s!=null&&h(e,["instances[0]","video"],DC(s)),n}function tb(t){const e={},n=c(t,["_self"]);n!=null&&h(e,["image"],cb(n));const r=c(t,["raiFilteredReason"]);r!=null&&h(e,["raiFilteredReason"],r);const i=c(t,["_self"]);return i!=null&&h(e,["safetyAttributes"],xC(i)),e}function Gh(t){const e={},n=c(t,["_self"]);n!=null&&h(e,["image"],AC(n));const r=c(t,["raiFilteredReason"]);r!=null&&h(e,["raiFilteredReason"],r);const i=c(t,["_self"]);i!=null&&h(e,["safetyAttributes"],RC(i));const s=c(t,["prompt"]);return s!=null&&h(e,["enhancedPrompt"],s),e}function nb(t){const e={},n=c(t,["_self"]);n!=null&&h(e,["mask"],AC(n));const r=c(t,["labels"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>s)),h(e,["labels"],i)}return e}function rb(t){const e={},n=c(t,["video"]);return n!=null&&h(e,["video"],qb(n)),e}function ib(t){const e={},n=c(t,["_self"]);return n!=null&&h(e,["video"],Gb(n)),e}function sb(t){const e={},n=c(t,["modelSelectionConfig"]);n!=null&&h(e,["modelConfig"],n);const r=c(t,["audioTimestamp"]);r!=null&&h(e,["audioTimestamp"],r);const i=c(t,["candidateCount"]);i!=null&&h(e,["candidateCount"],i);const s=c(t,["enableAffectiveDialog"]);s!=null&&h(e,["enableAffectiveDialog"],s);const o=c(t,["frequencyPenalty"]);o!=null&&h(e,["frequencyPenalty"],o);const a=c(t,["logprobs"]);a!=null&&h(e,["logprobs"],a);const l=c(t,["maxOutputTokens"]);l!=null&&h(e,["maxOutputTokens"],l);const u=c(t,["mediaResolution"]);u!=null&&h(e,["mediaResolution"],u);const f=c(t,["presencePenalty"]);f!=null&&h(e,["presencePenalty"],f);const m=c(t,["responseJsonSchema"]);m!=null&&h(e,["responseJsonSchema"],m);const g=c(t,["responseLogprobs"]);g!=null&&h(e,["responseLogprobs"],g);const v=c(t,["responseMimeType"]);v!=null&&h(e,["responseMimeType"],v);const T=c(t,["responseModalities"]);T!=null&&h(e,["responseModalities"],T);const A=c(t,["responseSchema"]);A!=null&&h(e,["responseSchema"],A);const D=c(t,["routingConfig"]);D!=null&&h(e,["routingConfig"],D);const S=c(t,["seed"]);S!=null&&h(e,["seed"],S);const I=c(t,["speechConfig"]);I!=null&&h(e,["speechConfig"],PC(I));const P=c(t,["stopSequences"]);P!=null&&h(e,["stopSequences"],P);const V=c(t,["temperature"]);V!=null&&h(e,["temperature"],V);const U=c(t,["thinkingConfig"]);U!=null&&h(e,["thinkingConfig"],U);const O=c(t,["topK"]);O!=null&&h(e,["topK"],O);const E=c(t,["topP"]);return E!=null&&h(e,["topP"],E),e}function ob(t,e){const n={},r=c(e,["model"]);return r!=null&&h(n,["_url","name"],Ge(t,r)),n}function ab(t,e){const n={},r=c(e,["model"]);return r!=null&&h(n,["_url","name"],Ge(t,r)),n}function lb(t){const e={};if(c(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=c(t,["enableWidget"]);return n!=null&&h(e,["enableWidget"],n),e}function ub(t){const e={},n=c(t,["timeRangeFilter"]);if(n!=null&&h(e,["timeRangeFilter"],n),c(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function cb(t){const e={},n=c(t,["bytesBase64Encoded"]);n!=null&&h(e,["imageBytes"],is(n));const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function AC(t){const e={},n=c(t,["gcsUri"]);n!=null&&h(e,["gcsUri"],n);const r=c(t,["bytesBase64Encoded"]);r!=null&&h(e,["imageBytes"],is(r));const i=c(t,["mimeType"]);return i!=null&&h(e,["mimeType"],i),e}function zh(t){const e={};if(c(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=c(t,["imageBytes"]);n!=null&&h(e,["bytesBase64Encoded"],is(n));const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function ur(t){const e={},n=c(t,["gcsUri"]);n!=null&&h(e,["gcsUri"],n);const r=c(t,["imageBytes"]);r!=null&&h(e,["bytesBase64Encoded"],is(r));const i=c(t,["mimeType"]);return i!=null&&h(e,["mimeType"],i),e}function db(t,e,n){const r={},i=c(e,["pageSize"]);n!==void 0&&i!=null&&h(n,["_query","pageSize"],i);const s=c(e,["pageToken"]);n!==void 0&&s!=null&&h(n,["_query","pageToken"],s);const o=c(e,["filter"]);n!==void 0&&o!=null&&h(n,["_query","filter"],o);const a=c(e,["queryBase"]);return n!==void 0&&a!=null&&h(n,["_url","models_url"],yC(t,a)),r}function hb(t,e,n){const r={},i=c(e,["pageSize"]);n!==void 0&&i!=null&&h(n,["_query","pageSize"],i);const s=c(e,["pageToken"]);n!==void 0&&s!=null&&h(n,["_query","pageToken"],s);const o=c(e,["filter"]);n!==void 0&&o!=null&&h(n,["_query","filter"],o);const a=c(e,["queryBase"]);return n!==void 0&&a!=null&&h(n,["_url","models_url"],yC(t,a)),r}function fb(t,e){const n={},r=c(e,["config"]);return r!=null&&db(t,r,n),n}function pb(t,e){const n={},r=c(e,["config"]);return r!=null&&hb(t,r,n),n}function mb(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=c(t,["_self"]);if(i!=null){let s=vC(i);Array.isArray(s)&&(s=s.map(o=>gm(o))),h(e,["models"],s)}return e}function gb(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=c(t,["_self"]);if(i!=null){let s=vC(i);Array.isArray(s)&&(s=s.map(o=>_m(o))),h(e,["models"],s)}return e}function _b(t){const e={},n=c(t,["maskMode"]);n!=null&&h(e,["maskMode"],n);const r=c(t,["segmentationClasses"]);r!=null&&h(e,["maskClasses"],r);const i=c(t,["maskDilation"]);return i!=null&&h(e,["dilation"],i),e}function gm(t){const e={},n=c(t,["name"]);n!=null&&h(e,["name"],n);const r=c(t,["displayName"]);r!=null&&h(e,["displayName"],r);const i=c(t,["description"]);i!=null&&h(e,["description"],i);const s=c(t,["version"]);s!=null&&h(e,["version"],s);const o=c(t,["_self"]);o!=null&&h(e,["tunedModelInfo"],Db(o));const a=c(t,["inputTokenLimit"]);a!=null&&h(e,["inputTokenLimit"],a);const l=c(t,["outputTokenLimit"]);l!=null&&h(e,["outputTokenLimit"],l);const u=c(t,["supportedGenerationMethods"]);return u!=null&&h(e,["supportedActions"],u),e}function _m(t){const e={},n=c(t,["name"]);n!=null&&h(e,["name"],n);const r=c(t,["displayName"]);r!=null&&h(e,["displayName"],r);const i=c(t,["description"]);i!=null&&h(e,["description"],i);const s=c(t,["versionId"]);s!=null&&h(e,["version"],s);const o=c(t,["deployedModels"]);if(o!=null){let m=o;Array.isArray(m)&&(m=m.map(g=>MD(g))),h(e,["endpoints"],m)}const a=c(t,["labels"]);a!=null&&h(e,["labels"],a);const l=c(t,["_self"]);l!=null&&h(e,["tunedModelInfo"],bb(l));const u=c(t,["defaultCheckpointId"]);u!=null&&h(e,["defaultCheckpointId"],u);const f=c(t,["checkpoints"]);if(f!=null){let m=f;Array.isArray(m)&&(m=m.map(g=>g)),h(e,["checkpoints"],m)}return e}function yb(t){const e={},n=c(t,["videoMetadata"]);n!=null&&h(e,["videoMetadata"],n);const r=c(t,["thought"]);r!=null&&h(e,["thought"],r);const i=c(t,["inlineData"]);i!=null&&h(e,["inlineData"],aD(i));const s=c(t,["fileData"]);s!=null&&h(e,["fileData"],VD(s));const o=c(t,["thoughtSignature"]);o!=null&&h(e,["thoughtSignature"],o);const a=c(t,["functionCall"]);a!=null&&h(e,["functionCall"],a);const l=c(t,["codeExecutionResult"]);l!=null&&h(e,["codeExecutionResult"],l);const u=c(t,["executableCode"]);u!=null&&h(e,["executableCode"],u);const f=c(t,["functionResponse"]);f!=null&&h(e,["functionResponse"],f);const m=c(t,["text"]);return m!=null&&h(e,["text"],m),e}function vb(t){const e={},n=c(t,["productImage"]);return n!=null&&h(e,["image"],ur(n)),e}function Tb(t,e){const n={},r=c(t,["numberOfImages"]);e!==void 0&&r!=null&&h(e,["parameters","sampleCount"],r);const i=c(t,["baseSteps"]);e!==void 0&&i!=null&&h(e,["parameters","editConfig","baseSteps"],i);const s=c(t,["outputGcsUri"]);e!==void 0&&s!=null&&h(e,["parameters","storageUri"],s);const o=c(t,["seed"]);e!==void 0&&o!=null&&h(e,["parameters","seed"],o);const a=c(t,["safetyFilterLevel"]);e!==void 0&&a!=null&&h(e,["parameters","safetySetting"],a);const l=c(t,["personGeneration"]);e!==void 0&&l!=null&&h(e,["parameters","personGeneration"],l);const u=c(t,["addWatermark"]);e!==void 0&&u!=null&&h(e,["parameters","addWatermark"],u);const f=c(t,["outputMimeType"]);e!==void 0&&f!=null&&h(e,["parameters","outputOptions","mimeType"],f);const m=c(t,["outputCompressionQuality"]);e!==void 0&&m!=null&&h(e,["parameters","outputOptions","compressionQuality"],m);const g=c(t,["enhancePrompt"]);e!==void 0&&g!=null&&h(e,["parameters","enhancePrompt"],g);const v=c(t,["labels"]);return e!==void 0&&v!=null&&h(e,["labels"],v),n}function Eb(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],Ge(t,r));const i=c(e,["source"]);i!=null&&wb(i,n);const s=c(e,["config"]);return s!=null&&Tb(s,n),n}function Ib(t){const e={},n=c(t,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>Gh(i))),h(e,["generatedImages"],r)}return e}function wb(t,e){const n={},r=c(t,["prompt"]);e!==void 0&&r!=null&&h(e,["instances[0]","prompt"],r);const i=c(t,["personImage"]);e!==void 0&&i!=null&&h(e,["instances[0]","personImage","image"],ur(i));const s=c(t,["productImages"]);if(e!==void 0&&s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>vb(a))),h(e,["instances[0]","productImages"],o)}return n}function Sb(t){const e={},n=c(t,["referenceImage"]);n!=null&&h(e,["referenceImage"],ur(n));const r=c(t,["referenceId"]);r!=null&&h(e,["referenceId"],r);const i=c(t,["referenceType"]);i!=null&&h(e,["referenceType"],i);const s=c(t,["maskImageConfig"]);s!=null&&h(e,["maskImageConfig"],_b(s));const o=c(t,["controlImageConfig"]);o!=null&&h(e,["controlImageConfig"],pD(o));const a=c(t,["styleImageConfig"]);a!=null&&h(e,["styleImageConfig"],a);const l=c(t,["subjectImageConfig"]);return l!=null&&h(e,["subjectImageConfig"],l),e}function xC(t){const e={},n=c(t,["safetyAttributes","categories"]);n!=null&&h(e,["categories"],n);const r=c(t,["safetyAttributes","scores"]);r!=null&&h(e,["scores"],r);const i=c(t,["contentType"]);return i!=null&&h(e,["contentType"],i),e}function RC(t){const e={},n=c(t,["safetyAttributes","categories"]);n!=null&&h(e,["categories"],n);const r=c(t,["safetyAttributes","scores"]);r!=null&&h(e,["scores"],r);const i=c(t,["contentType"]);return i!=null&&h(e,["contentType"],i),e}function Cb(t){const e={};if(c(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=c(t,["category"]);n!=null&&h(e,["category"],n);const r=c(t,["threshold"]);return r!=null&&h(e,["threshold"],r),e}function Ab(t){const e={},n=c(t,["image"]);return n!=null&&h(e,["image"],ur(n)),e}function xb(t,e){const n={},r=c(t,["mode"]);e!==void 0&&r!=null&&h(e,["parameters","mode"],r);const i=c(t,["maxPredictions"]);e!==void 0&&i!=null&&h(e,["parameters","maxPredictions"],i);const s=c(t,["confidenceThreshold"]);e!==void 0&&s!=null&&h(e,["parameters","confidenceThreshold"],s);const o=c(t,["maskDilation"]);e!==void 0&&o!=null&&h(e,["parameters","maskDilation"],o);const a=c(t,["binaryColorThreshold"]);e!==void 0&&a!=null&&h(e,["parameters","binaryColorThreshold"],a);const l=c(t,["labels"]);return e!==void 0&&l!=null&&h(e,["labels"],l),n}function Rb(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],Ge(t,r));const i=c(e,["source"]);i!=null&&kb(i,n);const s=c(e,["config"]);return s!=null&&xb(s,n),n}function Pb(t){const e={},n=c(t,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>nb(i))),h(e,["generatedMasks"],r)}return e}function kb(t,e){const n={},r=c(t,["prompt"]);e!==void 0&&r!=null&&h(e,["instances[0]","prompt"],r);const i=c(t,["image"]);e!==void 0&&i!=null&&h(e,["instances[0]","image"],ur(i));const s=c(t,["scribbleImage"]);return e!==void 0&&s!=null&&h(e,["instances[0]","scribble"],Ab(s)),n}function PC(t){const e={},n=c(t,["voiceConfig"]);if(n!=null&&h(e,["voiceConfig"],n),c(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const r=c(t,["languageCode"]);return r!=null&&h(e,["languageCode"],r),e}function Nb(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(f=>f)),h(e,["functionDeclarations"],u)}if(c(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=c(t,["googleSearch"]);r!=null&&h(e,["googleSearch"],ub(r));const i=c(t,["googleSearchRetrieval"]);if(i!=null&&h(e,["googleSearchRetrieval"],i),c(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=c(t,["googleMaps"]);s!=null&&h(e,["googleMaps"],lb(s));const o=c(t,["urlContext"]);o!=null&&h(e,["urlContext"],o);const a=c(t,["computerUse"]);a!=null&&h(e,["computerUse"],a);const l=c(t,["codeExecution"]);return l!=null&&h(e,["codeExecution"],l),e}function kC(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let m=n;Array.isArray(m)&&(m=m.map(g=>LD(g))),h(e,["functionDeclarations"],m)}const r=c(t,["retrieval"]);r!=null&&h(e,["retrieval"],r);const i=c(t,["googleSearch"]);i!=null&&h(e,["googleSearch"],i);const s=c(t,["googleSearchRetrieval"]);s!=null&&h(e,["googleSearchRetrieval"],s);const o=c(t,["enterpriseWebSearch"]);o!=null&&h(e,["enterpriseWebSearch"],o);const a=c(t,["googleMaps"]);a!=null&&h(e,["googleMaps"],a);const l=c(t,["urlContext"]);l!=null&&h(e,["urlContext"],l);const u=c(t,["computerUse"]);u!=null&&h(e,["computerUse"],u);const f=c(t,["codeExecution"]);return f!=null&&h(e,["codeExecution"],f),e}function Db(t){const e={},n=c(t,["baseModel"]);n!=null&&h(e,["baseModel"],n);const r=c(t,["createTime"]);r!=null&&h(e,["createTime"],r);const i=c(t,["updateTime"]);return i!=null&&h(e,["updateTime"],i),e}function bb(t){const e={},n=c(t,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&h(e,["baseModel"],n);const r=c(t,["createTime"]);r!=null&&h(e,["createTime"],r);const i=c(t,["updateTime"]);return i!=null&&h(e,["updateTime"],i),e}function Mb(t,e){const n={},r=c(t,["displayName"]);e!==void 0&&r!=null&&h(e,["displayName"],r);const i=c(t,["description"]);e!==void 0&&i!=null&&h(e,["description"],i);const s=c(t,["defaultCheckpointId"]);return e!==void 0&&s!=null&&h(e,["defaultCheckpointId"],s),n}function Vb(t,e){const n={},r=c(t,["displayName"]);e!==void 0&&r!=null&&h(e,["displayName"],r);const i=c(t,["description"]);e!==void 0&&i!=null&&h(e,["description"],i);const s=c(t,["defaultCheckpointId"]);return e!==void 0&&s!=null&&h(e,["defaultCheckpointId"],s),n}function Lb(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","name"],Ge(t,r));const i=c(e,["config"]);return i!=null&&Mb(i,n),n}function Fb(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],Ge(t,r));const i=c(e,["config"]);return i!=null&&Vb(i,n),n}function Ub(t,e){const n={},r=c(t,["outputGcsUri"]);e!==void 0&&r!=null&&h(e,["parameters","storageUri"],r);const i=c(t,["includeRaiReason"]);e!==void 0&&i!=null&&h(e,["parameters","includeRaiReason"],i);const s=c(t,["outputMimeType"]);e!==void 0&&s!=null&&h(e,["parameters","outputOptions","mimeType"],s);const o=c(t,["outputCompressionQuality"]);e!==void 0&&o!=null&&h(e,["parameters","outputOptions","compressionQuality"],o);const a=c(t,["enhanceInputImage"]);e!==void 0&&a!=null&&h(e,["parameters","upscaleConfig","enhanceInputImage"],a);const l=c(t,["imagePreservationFactor"]);e!==void 0&&l!=null&&h(e,["parameters","upscaleConfig","imagePreservationFactor"],l);const u=c(t,["labels"]);e!==void 0&&u!=null&&h(e,["labels"],u);const f=c(t,["numberOfImages"]);e!==void 0&&f!=null&&h(e,["parameters","sampleCount"],f);const m=c(t,["mode"]);return e!==void 0&&m!=null&&h(e,["parameters","mode"],m),n}function Ob(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],Ge(t,r));const i=c(e,["image"]);i!=null&&h(n,["instances[0]","image"],ur(i));const s=c(e,["upscaleFactor"]);s!=null&&h(n,["parameters","upscaleConfig","upscaleFactor"],s);const o=c(e,["config"]);return o!=null&&Ub(o,n),n}function Bb(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>Gh(s))),h(e,["generatedImages"],i)}return e}function qb(t){const e={},n=c(t,["uri"]);n!=null&&h(e,["uri"],n);const r=c(t,["encodedVideo"]);r!=null&&h(e,["videoBytes"],is(r));const i=c(t,["encoding"]);return i!=null&&h(e,["mimeType"],i),e}function Gb(t){const e={},n=c(t,["gcsUri"]);n!=null&&h(e,["uri"],n);const r=c(t,["bytesBase64Encoded"]);r!=null&&h(e,["videoBytes"],is(r));const i=c(t,["mimeType"]);return i!=null&&h(e,["mimeType"],i),e}function zb(t){const e={},n=c(t,["image"]);n!=null&&h(e,["_self"],ur(n));const r=c(t,["maskMode"]);return r!=null&&h(e,["maskMode"],r),e}function $b(t){const e={},n=c(t,["image"]);n!=null&&h(e,["image"],zh(n));const r=c(t,["referenceType"]);return r!=null&&h(e,["referenceType"],r),e}function Hb(t){const e={},n=c(t,["image"]);n!=null&&h(e,["image"],ur(n));const r=c(t,["referenceType"]);return r!=null&&h(e,["referenceType"],r),e}function NC(t){const e={},n=c(t,["uri"]);n!=null&&h(e,["uri"],n);const r=c(t,["videoBytes"]);r!=null&&h(e,["encodedVideo"],is(r));const i=c(t,["mimeType"]);return i!=null&&h(e,["encoding"],i),e}function DC(t){const e={},n=c(t,["uri"]);n!=null&&h(e,["gcsUri"],n);const r=c(t,["videoBytes"]);r!=null&&h(e,["bytesBase64Encoded"],is(r));const i=c(t,["mimeType"]);return i!=null&&h(e,["mimeType"],i),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Wb="Content-Type",Kb="X-Server-Timeout",jb="User-Agent",ym="x-goog-api-client",Jb="1.25.0",Qb=`google-genai-sdk/${Jb}`,Yb="v1beta1",Xb="v1beta",OT=/^\s*data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class Zb{constructor(e){var n,r;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const i={};this.clientOptions.vertexai?(i.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:Yb,i.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(i.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:Xb,i.baseUrl="https://generativelanguage.googleapis.com/"),i.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=i,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(i,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&r.push(e.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),n=new URL(e);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,n,r){const i=[this.getRequestUrlInternal(n)];return r&&i.push(this.getBaseResourcePath()),e!==""&&i.push(e),new URL(`${i.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,n,r);if(e.queryParams)for(const[o,a]of Object.entries(e.queryParams))i.searchParams.append(o,String(a));let s={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else s.body=e.body;return s=await this.includeExtraHttpOptionsToRequestInit(s,n,e.abortSignal),this.unaryApiCall(i,s,e.httpMethod)}patchHttpOptions(e,n){const r=JSON.parse(JSON.stringify(e));for(const[i,s]of Object.entries(n))typeof s=="object"?r[i]=Object.assign(Object.assign({},r[i]),s):s!==void 0&&(r[i]=s);return r}async requestStream(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,n,r);(!i.searchParams.has("alt")||i.searchParams.get("alt")!=="sse")&&i.searchParams.set("alt","sse");let s={};return s.body=e.body,s=await this.includeExtraHttpOptionsToRequestInit(s,n,e.abortSignal),this.streamApiCall(i,s,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,n,r){if(n&&n.timeout||r){const i=new AbortController,s=i.signal;if(n.timeout&&(n==null?void 0:n.timeout)>0){const o=setTimeout(()=>i.abort(),n.timeout);o&&typeof o.unref=="function"&&o.unref()}r&&r.addEventListener("abort",()=>{i.abort()}),e.signal=s}return n&&n.extraBody!==null&&eM(e,n.extraBody),e.headers=await this.getHeadersInternal(n),e}async unaryApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async i=>(await BT(i),new fm(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}async streamApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async i=>(await BT(i),this.processStreamResponse(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}processStreamResponse(e){var n;return ta(this,arguments,function*(){const i=(n=e==null?void 0:e.body)===null||n===void 0?void 0:n.getReader(),s=new TextDecoder("utf-8");if(!i)throw new Error("Response body is empty");try{let o="";for(;;){const{done:a,value:l}=yield nt(i.read());if(a){if(o.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const u=s.decode(l,{stream:!0});try{const m=JSON.parse(u);if("error"in m){const g=JSON.parse(JSON.stringify(m.error)),v=g.status,T=g.code,A=`got status: ${v}. ${JSON.stringify(m)}`;if(T>=400&&T<600)throw new Bh({message:A,status:T})}}catch(m){if(m.name==="ApiError")throw m}o+=u;let f=o.match(OT);for(;f;){const m=f[1];try{const g=new Response(m,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield nt(new fm(g)),o=o.slice(f[0].length),f=o.match(OT)}catch(g){throw new Error(`exception parsing stream chunk ${m}. ${g}`)}}}}finally{i.releaseLock()}})}async apiCall(e,n){return fetch(e,n).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const e={},n=Qb+" "+this.clientOptions.userAgentExtra;return e[jb]=n,e[ym]=n,e[Wb]="application/json",e}async getHeadersInternal(e){const n=new Headers;if(e&&e.headers){for(const[r,i]of Object.entries(e.headers))n.append(r,i);e.timeout&&e.timeout>0&&n.append(Kb,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(n),n}async uploadFile(e,n){var r;const i={};n!=null&&(i.mimeType=n.mimeType,i.name=n.name,i.displayName=n.displayName),i.name&&!i.name.startsWith("files/")&&(i.name=`files/${i.name}`);const s=this.clientOptions.uploader,o=await s.stat(e);i.sizeBytes=String(o.size);const a=(r=n==null?void 0:n.mimeType)!==null&&r!==void 0?r:o.type;if(a===void 0||a==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");i.mimeType=a;const l=await this.fetchUploadUrl(i,n);return s.upload(e,l,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,n){var r;let i={};n!=null&&n.httpOptions?i=n.httpOptions:i={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};const s={file:e},o=await this.request({path:de("upload/v1beta/files",s._url),body:JSON.stringify(s),httpMethod:"POST",httpOptions:i});if(!o||!(o!=null&&o.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const a=(r=o==null?void 0:o.headers)===null||r===void 0?void 0:r["x-goog-upload-url"];if(a===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return a}}async function BT(t){var e;if(t===void 0)throw new Error("response is undefined");if(!t.ok){const n=t.status;let r;!((e=t.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?r=await t.json():r={error:{message:await t.text(),code:t.status,status:t.statusText}};const i=JSON.stringify(r);throw n>=400&&n<600?new Bh({message:i,status:n}):new Error(i)}}function eM(t,e){if(!e||Object.keys(e).length===0)return;if(t.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let n={};if(typeof t.body=="string"&&t.body.length>0)try{const s=JSON.parse(t.body);if(typeof s=="object"&&s!==null&&!Array.isArray(s))n=s;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function r(s,o){const a=Object.assign({},s);for(const l in o)if(Object.prototype.hasOwnProperty.call(o,l)){const u=o[l],f=a[l];u&&typeof u=="object"&&!Array.isArray(u)&&f&&typeof f=="object"&&!Array.isArray(f)?a[l]=r(f,u):(f&&u&&typeof f!=typeof u&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${l}". Original type: ${typeof f}, New type: ${typeof u}. Overwriting.`),a[l]=u)}return a}const i=r(n,e);t.body=JSON.stringify(i)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const tM="mcp_used/unknown";let nM=!1;function bC(t){for(const e of t)if(rM(e)||typeof e=="object"&&"inputSchema"in e)return!0;return nM}function MC(t){var e;const n=(e=t[ym])!==null&&e!==void 0?e:"";t[ym]=(n+` ${tM}`).trimStart()}function rM(t){return t!==null&&typeof t=="object"&&t instanceof n_}function iM(t,e=100){return ta(this,arguments,function*(){let r,i=0;for(;i<e;){const s=yield nt(t.listTools({cursor:r}));for(const o of s.tools)yield yield nt(o),i++;if(!s.nextCursor)break;r=s.nextCursor}})}class n_{constructor(e=[],n){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=n}static create(e,n){return new n_(e,n)}async initialize(){var e,n,r,i;if(this.mcpTools.length>0)return;const s={},o=[];for(const f of this.mcpClients)try{for(var a=!0,l=(n=void 0,$l(iM(f))),u;u=await l.next(),e=u.done,!e;a=!0){i=u.value,a=!1;const m=i;o.push(m);const g=m.name;if(s[g])throw new Error(`Duplicate function name ${g} found in MCP tools. Please ensure function names are unique.`);s[g]=f}}catch(m){n={error:m}}finally{try{!a&&!e&&(r=l.return)&&await r.call(l)}finally{if(n)throw n.error}}this.mcpTools=o,this.functionNameToMcpClient=s}async tool(){return await this.initialize(),u1(this.mcpTools,this.config)}async callTool(e){await this.initialize();const n=[];for(const r of e)if(r.name in this.functionNameToMcpClient){const i=this.functionNameToMcpClient[r.name];let s;this.config.timeout&&(s={timeout:this.config.timeout});const o=await i.callTool({name:r.name,arguments:r.args},void 0,s);n.push({functionResponse:{name:r.name,response:o.isError?{error:o}:o}})}return n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function sM(t,e,n){const r=new t1;let i;n.data instanceof Blob?i=JSON.parse(await n.data.text()):i=JSON.parse(n.data),Object.assign(r,i),e(r)}class oM{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r}async connect(e){var n,r;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const i=this.apiClient.getWebsocketBaseUrl(),s=this.apiClient.getApiVersion(),o=uM(this.apiClient.getDefaultHeaders()),a=this.apiClient.getApiKey(),l=`${i}/ws/google.ai.generativelanguage.${s}.GenerativeService.BidiGenerateMusic?key=${a}`;let u=()=>{};const f=new Promise(P=>{u=P}),m=e.callbacks,g=function(){u({})},v=this.apiClient,T={onopen:g,onmessage:P=>{sM(v,m.onmessage,P)},onerror:(n=m==null?void 0:m.onerror)!==null&&n!==void 0?n:function(P){},onclose:(r=m==null?void 0:m.onclose)!==null&&r!==void 0?r:function(P){}},A=this.webSocketFactory.create(l,lM(o),T);A.connect(),await f;const I={setup:{model:Ge(this.apiClient,e.model)}};return A.send(JSON.stringify(I)),new aM(A,this.apiClient)}}class aM{constructor(e,n){this.conn=e,this.apiClient=n}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const n=XN(e);this.conn.send(JSON.stringify({clientContent:n}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const n=YN(e);this.conn.send(JSON.stringify(n))}sendPlaybackControl(e){const n={playbackControl:e};this.conn.send(JSON.stringify(n))}play(){this.sendPlaybackControl(Wo.PLAY)}pause(){this.sendPlaybackControl(Wo.PAUSE)}stop(){this.sendPlaybackControl(Wo.STOP)}resetContext(){this.sendPlaybackControl(Wo.RESET_CONTEXT)}close(){this.conn.close()}}function lM(t){const e={};return t.forEach((n,r)=>{e[r]=n}),e}function uM(t){const e=new Headers;for(const[n,r]of Object.entries(t))e.append(n,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const cM="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function dM(t,e,n){const r=new e1;let i;n.data instanceof Blob?i=await n.data.text():n.data instanceof ArrayBuffer?i=new TextDecoder().decode(n.data):i=n.data;const s=JSON.parse(i);if(t.isVertexAI()){const o=tD(s);Object.assign(r,o)}else Object.assign(r,s);e(r)}class hM{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r,this.music=new oM(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var n,r,i,s,o,a;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const l=this.apiClient.getWebsocketBaseUrl(),u=this.apiClient.getApiVersion();let f;const m=this.apiClient.getHeaders();e.config&&e.config.tools&&bC(e.config.tools)&&MC(m);const g=gM(m);if(this.apiClient.isVertexAI())f=`${l}/ws/google.cloud.aiplatform.${u}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(g);else{const C=this.apiClient.getApiKey();let k="BidiGenerateContent",b="key";C!=null&&C.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),u!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),k="BidiGenerateContentConstrained",b="access_token"),f=`${l}/ws/google.ai.generativelanguage.${u}.GenerativeService.${k}?${b}=${C}`}let v=()=>{};const T=new Promise(C=>{v=C}),A=e.callbacks,D=function(){var C;(C=A==null?void 0:A.onopen)===null||C===void 0||C.call(A),v({})},S=this.apiClient,I={onopen:D,onmessage:C=>{dM(S,A.onmessage,C)},onerror:(n=A==null?void 0:A.onerror)!==null&&n!==void 0?n:function(C){},onclose:(r=A==null?void 0:A.onclose)!==null&&r!==void 0?r:function(C){}},P=this.webSocketFactory.create(f,mM(g),I);P.connect(),await T;let V=Ge(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&V.startsWith("publishers/")){const C=this.apiClient.getProject(),k=this.apiClient.getLocation();V=`projects/${C}/locations/${k}/`+V}let U={};this.apiClient.isVertexAI()&&((i=e.config)===null||i===void 0?void 0:i.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[Jd.AUDIO]}:e.config.responseModalities=[Jd.AUDIO]),!((s=e.config)===null||s===void 0)&&s.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const O=(a=(o=e.config)===null||o===void 0?void 0:o.tools)!==null&&a!==void 0?a:[],E=[];for(const C of O)if(this.isCallableTool(C)){const k=C;E.push(await k.tool())}else E.push(C);E.length>0&&(e.config.tools=E);const w={model:V,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?U=QN(this.apiClient,w):U=JN(this.apiClient,w),delete U.config,P.send(JSON.stringify(U)),new pM(P,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const fM={turnComplete:!0};class pM{constructor(e,n){this.conn=e,this.apiClient=n}tLiveClientContent(e,n){if(n.turns!==null&&n.turns!==void 0){let r=[];try{r=Wn(n.turns),e.isVertexAI()||(r=r.map(i=>qh(i)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:r,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(e,n){let r=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?r=n.functionResponses:r=[n.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const s of r){if(typeof s!="object"||s===null||!("name"in s)||!("response"in s))throw new Error(`Could not parse function response, type '${typeof s}'.`);if(!e.isVertexAI()&&!("id"in s))throw new Error(cM)}return{toolResponse:{functionResponses:r}}}sendClientContent(e){e=Object.assign(Object.assign({},fM),e);const n=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(n))}sendRealtimeInput(e){let n={};this.apiClient.isVertexAI()?n={realtimeInput:eD(e)}:n={realtimeInput:ZN(e)},this.conn.send(JSON.stringify(n))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function mM(t){const e={};return t.forEach((n,r)=>{e[r]=n}),e}function gM(t){const e=new Headers;for(const[n,r]of Object.entries(t))e.append(n,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const qT=10;function GT(t){var e,n,r;if(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let i=!1;for(const o of(n=t==null?void 0:t.tools)!==null&&n!==void 0?n:[])if(na(o)){i=!0;break}if(!i)return!0;const s=(r=t==null?void 0:t.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls;return s&&(s<0||!Number.isInteger(s))||s==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",s),!0):!1}function na(t){return"callTool"in t&&typeof t.callTool=="function"}function _M(t){var e,n,r;return(r=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(i=>na(i)))!==null&&r!==void 0?r:!1}function yM(t){var e,n,r;return(r=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(i=>!na(i)))!==null&&r!==void 0?r:!1}function zT(t){var e;return!(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class vM extends lo{constructor(e){super(),this.apiClient=e,this.generateContent=async n=>{var r,i,s,o,a;const l=await this.processParamsMaybeAddMcpUsage(n);if(this.maybeMoveToResponseJsonSchem(n),!_M(n)||GT(n.config))return await this.generateContentInternal(l);if(yM(n))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");let u,f;const m=Wn(l.contents),g=(s=(i=(r=l.config)===null||r===void 0?void 0:r.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&s!==void 0?s:qT;let v=0;for(;v<g&&(u=await this.generateContentInternal(l),!(!u.functionCalls||u.functionCalls.length===0));){const T=u.candidates[0].content,A=[];for(const D of(a=(o=n.config)===null||o===void 0?void 0:o.tools)!==null&&a!==void 0?a:[])if(na(D)){const I=await D.callTool(u.functionCalls);A.push(...I)}v++,f={role:"user",parts:A},l.contents=Wn(l.contents),l.contents.push(T),l.contents.push(f),zT(l.config)&&(m.push(T),m.push(f))}return zT(l.config)&&(u.automaticFunctionCallingHistory=m),u},this.generateContentStream=async n=>{if(this.maybeMoveToResponseJsonSchem(n),GT(n.config)){const r=await this.processParamsMaybeAddMcpUsage(n);return await this.generateContentStreamInternal(r)}else return await this.processAfcStream(n)},this.generateImages=async n=>await this.generateImagesInternal(n).then(r=>{var i;let s;const o=[];if(r!=null&&r.generatedImages)for(const l of r.generatedImages)l&&(l!=null&&l.safetyAttributes)&&((i=l==null?void 0:l.safetyAttributes)===null||i===void 0?void 0:i.contentType)==="Positive Prompt"?s=l==null?void 0:l.safetyAttributes:o.push(l);let a;return s?a={generatedImages:o,positivePromptSafetyAttributes:s,sdkHttpResponse:r.sdkHttpResponse}:a={generatedImages:o,sdkHttpResponse:r.sdkHttpResponse},a}),this.list=async n=>{var r;const o={config:Object.assign(Object.assign({},{queryBase:!0}),n==null?void 0:n.config)};if(this.apiClient.isVertexAI()&&!o.config.queryBase){if(!((r=o.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");o.config.filter="labels.tune-type:*"}return new Ou(Ys.PAGED_ITEM_MODELS,a=>this.listInternal(a),await this.listInternal(o),o)},this.editImage=async n=>{const r={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(r.referenceImages=n.referenceImages.map(i=>i.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async n=>{let r={numberOfImages:1,mode:"upscale"};n.config&&(r=Object.assign(Object.assign({},r),n.config));const i={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:r};return await this.upscaleImageInternal(i)},this.generateVideos=async n=>{var r,i,s,o,a,l;if((n.prompt||n.image||n.video)&&n.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((r=n.video)===null||r===void 0)&&r.uri&&(!((i=n.video)===null||i===void 0)&&i.videoBytes)?n.video={uri:n.video.uri,mimeType:n.video.mimeType}:!((o=(s=n.source)===null||s===void 0?void 0:s.video)===null||o===void 0)&&o.uri&&(!((l=(a=n.source)===null||a===void 0?void 0:a.video)===null||l===void 0)&&l.videoBytes)&&(n.source.video={uri:n.source.video.uri,mimeType:n.source.video.mimeType})),await this.generateVideosInternal(n)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var n,r,i;const s=(n=e.config)===null||n===void 0?void 0:n.tools;if(!s)return e;const o=await Promise.all(s.map(async l=>na(l)?await l.tool():l)),a={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:o})};if(a.config.tools=o,e.config&&e.config.tools&&bC(e.config.tools)){const l=(i=(r=e.config.httpOptions)===null||r===void 0?void 0:r.headers)!==null&&i!==void 0?i:{};let u=Object.assign({},l);Object.keys(u).length===0&&(u=this.apiClient.getDefaultHeaders()),MC(u),a.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:u})}return a}async initAfcToolsMap(e){var n,r,i;const s=new Map;for(const o of(r=(n=e.config)===null||n===void 0?void 0:n.tools)!==null&&r!==void 0?r:[])if(na(o)){const a=o,l=await a.tool();for(const u of(i=l.functionDeclarations)!==null&&i!==void 0?i:[]){if(!u.name)throw new Error("Function declaration name is required.");if(s.has(u.name))throw new Error(`Duplicate tool declaration name: ${u.name}`);s.set(u.name,a)}}return s}async processAfcStream(e){var n,r,i;const s=(i=(r=(n=e.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&i!==void 0?i:qT;let o=!1,a=0;const l=await this.initAfcToolsMap(e);return function(u,f,m){var g,v;return ta(this,arguments,function*(){for(var T,A,D,S;a<s;){o&&(a++,o=!1);const U=yield nt(u.processParamsMaybeAddMcpUsage(m)),O=yield nt(u.generateContentStreamInternal(U)),E=[],w=[];try{for(var I=!0,P=(A=void 0,$l(O)),V;V=yield nt(P.next()),T=V.done,!T;I=!0){S=V.value,I=!1;const C=S;if(yield yield nt(C),C.candidates&&(!((g=C.candidates[0])===null||g===void 0)&&g.content)){w.push(C.candidates[0].content);for(const k of(v=C.candidates[0].content.parts)!==null&&v!==void 0?v:[])if(a<s&&k.functionCall){if(!k.functionCall.name)throw new Error("Function call name was not returned by the model.");if(f.has(k.functionCall.name)){const b=yield nt(f.get(k.functionCall.name).callTool([k.functionCall]));E.push(...b)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${f.keys()}, mising tool: ${k.functionCall.name}`)}}}}catch(C){A={error:C}}finally{try{!I&&!T&&(D=P.return)&&(yield nt(D.call(P)))}finally{if(A)throw A.error}}if(E.length>0){o=!0;const C=new vl;C.candidates=[{content:{role:"user",parts:E}}],yield yield nt(C);const k=[];k.push(...w),k.push({role:"user",parts:E});const b=Wn(m.contents).concat(k);m.contents=b}else break}})}(this,l,e)}async generateContentInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=LT(this.apiClient,e);return a=de("{model}:generateContent",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=UT(f),g=new vl;return Object.assign(g,m),g})}else{const u=VT(this.apiClient,e);return a=de("{model}:generateContent",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=FT(f),g=new vl;return Object.assign(g,m),g})}}async generateContentStreamInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=LT(this.apiClient,e);return a=de("{model}:streamGenerateContent?alt=sse",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.requestStream({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}),o.then(function(m){return ta(this,arguments,function*(){var g,v,T,A;try{for(var D=!0,S=$l(m),I;I=yield nt(S.next()),g=I.done,!g;D=!0){A=I.value,D=!1;const P=A,V=UT(yield nt(P.json()));V.sdkHttpResponse={headers:P.headers};const U=new vl;Object.assign(U,V),yield yield nt(U)}}catch(P){v={error:P}}finally{try{!D&&!g&&(T=S.return)&&(yield nt(T.call(S)))}finally{if(v)throw v.error}}})})}else{const u=VT(this.apiClient,e);return a=de("{model}:streamGenerateContent?alt=sse",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.requestStream({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}),o.then(function(m){return ta(this,arguments,function*(){var g,v,T,A;try{for(var D=!0,S=$l(m),I;I=yield nt(S.next()),g=I.done,!g;D=!0){A=I.value,D=!1;const P=A,V=FT(yield nt(P.json()));V.sdkHttpResponse={headers:P.headers};const U=new vl;Object.assign(U,V),yield yield nt(U)}}catch(P){v={error:P}}finally{try{!D&&!g&&(T=S.return)&&(yield nt(T.call(S)))}finally{if(v)throw v.error}}})})}}async embedContent(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=ND(this.apiClient,e);return a=de("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=bD(f),g=new vT;return Object.assign(g,m),g})}else{const u=kD(this.apiClient,e);return a=de("{model}:batchEmbedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=DD(f),g=new vT;return Object.assign(g,m),g})}}async generateImagesInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=GD(this.apiClient,e);return a=de("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=$D(f),g=new TT;return Object.assign(g,m),g})}else{const u=qD(this.apiClient,e);return a=de("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=zD(f),g=new TT;return Object.assign(g,m),g})}}async editImageInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=AD(this.apiClient,e);return s=de("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>{const u=xD(l),f=new Wk;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=Ob(this.apiClient,e);return s=de("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>{const u=Bb(l),f=new Kk;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=Eb(this.apiClient,e);return s=de("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=Ib(l),f=new jk;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=Rb(this.apiClient,e);return s=de("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=Pb(l),f=new Jk;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=ab(this.apiClient,e);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>_m(f))}else{const u=ob(this.apiClient,e);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>gm(f))}}async listInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=pb(this.apiClient,e);return a=de("{models_url}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=gb(f),g=new ET;return Object.assign(g,m),g})}else{const u=fb(this.apiClient,e);return a=de("{models_url}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=mb(f),g=new ET;return Object.assign(g,m),g})}}async update(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=Fb(this.apiClient,e);return a=de("{model}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>_m(f))}else{const u=Lb(this.apiClient,e);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>gm(f))}}async delete(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=ID(this.apiClient,e);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=SD(f),g=new IT;return Object.assign(g,m),g})}else{const u=ED(this.apiClient,e);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=wD(f),g=new IT;return Object.assign(g,m),g})}}async countTokens(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=yD(this.apiClient,e);return a=de("{model}:countTokens",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=TD(f),g=new wT;return Object.assign(g,m),g})}else{const u=_D(this.apiClient,e);return a=de("{model}:countTokens",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=vD(f),g=new wT;return Object.assign(g,m),g})}}async computeTokens(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=cD(this.apiClient,e);return s=de("{model}:computeTokens",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>{const u=dD(l),f=new Qk;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=QD(this.apiClient,e);return a=de("{model}:predictLongRunning",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>{const m=jD(f),g=new Qd;return Object.assign(g,m),g})}else{const u=JD(this.apiClient,e);return a=de("{model}:predictLongRunning",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>{const m=KD(f),g=new Qd;return Object.assign(g,m),g})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class TM extends lo{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const n=e.operation,r=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=n.name.split("/operations/")[0];let s;r&&"httpOptions"in r&&(s=r.httpOptions);const o=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:i,config:{httpOptions:s}});return n._fromAPIResponse({apiResponse:o,isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:i,isVertexAI:!1})}}async get(e){const n=e.operation,r=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=n.name.split("/operations/")[0];let s;r&&"httpOptions"in r&&(s=r.httpOptions);const o=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:i,config:{httpOptions:s}});return n._fromAPIResponse({apiResponse:o,isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:i,isVertexAI:!1})}}async getVideosOperationInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=zk(e);return a=de("{operationName}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o}else{const u=Gk(e);return a=de("{operationName}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o}}async fetchPredictVideosOperationInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=Vk(e);return s=de("{resourceName}:fetchPredictOperation",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function EM(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["data"]);n!=null&&h(e,["data"],n);const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function IM(t){const e={},n=c(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>kM(s))),h(e,["parts"],i)}const r=c(t,["role"]);return r!=null&&h(e,["role"],r),e}function wM(t,e,n){const r={},i=c(e,["expireTime"]);n!==void 0&&i!=null&&h(n,["expireTime"],i);const s=c(e,["newSessionExpireTime"]);n!==void 0&&s!=null&&h(n,["newSessionExpireTime"],s);const o=c(e,["uses"]);n!==void 0&&o!=null&&h(n,["uses"],o);const a=c(e,["liveConnectConstraints"]);n!==void 0&&a!=null&&h(n,["bidiGenerateContentSetup"],PM(t,a));const l=c(e,["lockAdditionalFields"]);return n!==void 0&&l!=null&&h(n,["fieldMask"],l),r}function SM(t,e){const n={},r=c(e,["config"]);return r!=null&&h(n,["config"],wM(t,r,n)),n}function CM(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["fileUri"]);n!=null&&h(e,["fileUri"],n);const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function AM(t){const e={};if(c(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=c(t,["enableWidget"]);return n!=null&&h(e,["enableWidget"],n),e}function xM(t){const e={},n=c(t,["timeRangeFilter"]);if(n!=null&&h(e,["timeRangeFilter"],n),c(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function RM(t,e){const n={},r=c(t,["generationConfig"]);e!==void 0&&r!=null&&h(e,["setup","generationConfig"],r);const i=c(t,["responseModalities"]);e!==void 0&&i!=null&&h(e,["setup","generationConfig","responseModalities"],i);const s=c(t,["temperature"]);e!==void 0&&s!=null&&h(e,["setup","generationConfig","temperature"],s);const o=c(t,["topP"]);e!==void 0&&o!=null&&h(e,["setup","generationConfig","topP"],o);const a=c(t,["topK"]);e!==void 0&&a!=null&&h(e,["setup","generationConfig","topK"],a);const l=c(t,["maxOutputTokens"]);e!==void 0&&l!=null&&h(e,["setup","generationConfig","maxOutputTokens"],l);const u=c(t,["mediaResolution"]);e!==void 0&&u!=null&&h(e,["setup","generationConfig","mediaResolution"],u);const f=c(t,["seed"]);e!==void 0&&f!=null&&h(e,["setup","generationConfig","seed"],f);const m=c(t,["speechConfig"]);e!==void 0&&m!=null&&h(e,["setup","generationConfig","speechConfig"],t_(m));const g=c(t,["thinkingConfig"]);e!==void 0&&g!=null&&h(e,["setup","generationConfig","thinkingConfig"],g);const v=c(t,["enableAffectiveDialog"]);e!==void 0&&v!=null&&h(e,["setup","generationConfig","enableAffectiveDialog"],v);const T=c(t,["systemInstruction"]);e!==void 0&&T!=null&&h(e,["setup","systemInstruction"],IM(Xt(T)));const A=c(t,["tools"]);if(e!==void 0&&A!=null){let O=Ma(A);Array.isArray(O)&&(O=O.map(E=>DM(ba(E)))),h(e,["setup","tools"],O)}const D=c(t,["sessionResumption"]);e!==void 0&&D!=null&&h(e,["setup","sessionResumption"],NM(D));const S=c(t,["inputAudioTranscription"]);e!==void 0&&S!=null&&h(e,["setup","inputAudioTranscription"],S);const I=c(t,["outputAudioTranscription"]);e!==void 0&&I!=null&&h(e,["setup","outputAudioTranscription"],I);const P=c(t,["realtimeInputConfig"]);e!==void 0&&P!=null&&h(e,["setup","realtimeInputConfig"],P);const V=c(t,["contextWindowCompression"]);e!==void 0&&V!=null&&h(e,["setup","contextWindowCompression"],V);const U=c(t,["proactivity"]);return e!==void 0&&U!=null&&h(e,["setup","proactivity"],U),n}function PM(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["setup","model"],Ge(t,r));const i=c(e,["config"]);return i!=null&&h(n,["config"],RM(i,n)),n}function kM(t){const e={},n=c(t,["videoMetadata"]);n!=null&&h(e,["videoMetadata"],n);const r=c(t,["thought"]);r!=null&&h(e,["thought"],r);const i=c(t,["inlineData"]);i!=null&&h(e,["inlineData"],EM(i));const s=c(t,["fileData"]);s!=null&&h(e,["fileData"],CM(s));const o=c(t,["thoughtSignature"]);o!=null&&h(e,["thoughtSignature"],o);const a=c(t,["functionCall"]);a!=null&&h(e,["functionCall"],a);const l=c(t,["codeExecutionResult"]);l!=null&&h(e,["codeExecutionResult"],l);const u=c(t,["executableCode"]);u!=null&&h(e,["executableCode"],u);const f=c(t,["functionResponse"]);f!=null&&h(e,["functionResponse"],f);const m=c(t,["text"]);return m!=null&&h(e,["text"],m),e}function NM(t){const e={},n=c(t,["handle"]);if(n!=null&&h(e,["handle"],n),c(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function DM(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(f=>f)),h(e,["functionDeclarations"],u)}if(c(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=c(t,["googleSearch"]);r!=null&&h(e,["googleSearch"],xM(r));const i=c(t,["googleSearchRetrieval"]);if(i!=null&&h(e,["googleSearchRetrieval"],i),c(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=c(t,["googleMaps"]);s!=null&&h(e,["googleMaps"],AM(s));const o=c(t,["urlContext"]);o!=null&&h(e,["urlContext"],o);const a=c(t,["computerUse"]);a!=null&&h(e,["computerUse"],a);const l=c(t,["codeExecution"]);return l!=null&&h(e,["codeExecution"],l),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function bM(t){const e=[];for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const r=t[n];if(typeof r=="object"&&r!=null&&Object.keys(r).length>0){const i=Object.keys(r).map(s=>`${n}.${s}`);e.push(...i)}else e.push(n)}return e.join(",")}function MM(t,e){let n=null;const r=t.bidiGenerateContentSetup;if(typeof r=="object"&&r!==null&&"setup"in r){const s=r.setup;typeof s=="object"&&s!==null?(t.bidiGenerateContentSetup=s,n=s):delete t.bidiGenerateContentSetup}else r!==void 0&&delete t.bidiGenerateContentSetup;const i=t.fieldMask;if(n){const s=bM(n);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)s?t.fieldMask=s:delete t.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&i!==null&&Array.isArray(i)&&i.length>0){const o=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let a=[];i.length>0&&(a=i.map(u=>o.includes(u)?`generationConfig.${u}`:u));const l=[];s&&l.push(s),a.length>0&&l.push(...a),l.length>0?t.fieldMask=l.join(","):delete t.fieldMask}else delete t.fieldMask}else i!==null&&Array.isArray(i)&&i.length>0?t.fieldMask=i.join(","):delete t.fieldMask;return t}class VM extends lo{constructor(e){super(),this.apiClient=e}async create(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const a=SM(this.apiClient,e);s=de("auth_tokens",a._url),o=a._query,delete a.config,delete a._url,delete a._query;const l=MM(a,e.config);return i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>u)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function LM(t){const e={},n=c(t,["name"]);return n!=null&&h(e,["_url","name"],n),e}function FM(t){const e={},n=c(t,["name"]);return n!=null&&h(e,["_url","name"],n),e}function UM(t,e){const n={};if(c(t,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const r=c(t,["tunedModelDisplayName"]);if(e!==void 0&&r!=null&&h(e,["displayName"],r),c(t,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const i=c(t,["epochCount"]);e!==void 0&&i!=null&&h(e,["tuningTask","hyperparameters","epochCount"],i);const s=c(t,["learningRateMultiplier"]);if(s!=null&&h(n,["tuningTask","hyperparameters","learningRateMultiplier"],s),c(t,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(c(t,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(c(t,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const o=c(t,["batchSize"]);e!==void 0&&o!=null&&h(e,["tuningTask","hyperparameters","batchSize"],o);const a=c(t,["learningRate"]);if(e!==void 0&&a!=null&&h(e,["tuningTask","hyperparameters","learningRate"],a),c(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");return n}function OM(t,e){const n={},r=c(t,["validationDataset"]);e!==void 0&&r!=null&&h(e,["supervisedTuningSpec"],e2(r,n));const i=c(t,["tunedModelDisplayName"]);e!==void 0&&i!=null&&h(e,["tunedModelDisplayName"],i);const s=c(t,["description"]);e!==void 0&&s!=null&&h(e,["description"],s);const o=c(t,["epochCount"]);e!==void 0&&o!=null&&h(e,["supervisedTuningSpec","hyperParameters","epochCount"],o);const a=c(t,["learningRateMultiplier"]);e!==void 0&&a!=null&&h(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],a);const l=c(t,["exportLastCheckpointOnly"]);e!==void 0&&l!=null&&h(e,["supervisedTuningSpec","exportLastCheckpointOnly"],l);const u=c(t,["adapterSize"]);if(e!==void 0&&u!=null&&h(e,["supervisedTuningSpec","hyperParameters","adapterSize"],u),c(t,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(c(t,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const f=c(t,["labels"]);return e!==void 0&&f!=null&&h(e,["labels"],f),n}function BM(t){const e={},n=c(t,["baseModel"]);n!=null&&h(e,["baseModel"],n);const r=c(t,["preTunedModel"]);r!=null&&h(e,["preTunedModel"],r);const i=c(t,["trainingDataset"]);i!=null&&h(e,["tuningTask","trainingData"],YM(i));const s=c(t,["config"]);return s!=null&&UM(s,e),e}function qM(t){const e={},n=c(t,["baseModel"]);n!=null&&h(e,["baseModel"],n);const r=c(t,["preTunedModel"]);r!=null&&h(e,["preTunedModel"],r);const i=c(t,["trainingDataset"]);i!=null&&h(e,["supervisedTuningSpec","trainingDatasetUri"],XM(i,e));const s=c(t,["config"]);return s!=null&&OM(s,e),e}function GM(t){const e={},n=c(t,["name"]);return n!=null&&h(e,["_url","name"],n),e}function zM(t){const e={},n=c(t,["name"]);return n!=null&&h(e,["_url","name"],n),e}function $M(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&h(e,["_query","pageSize"],r);const i=c(t,["pageToken"]);e!==void 0&&i!=null&&h(e,["_query","pageToken"],i);const s=c(t,["filter"]);return e!==void 0&&s!=null&&h(e,["_query","filter"],s),n}function HM(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&h(e,["_query","pageSize"],r);const i=c(t,["pageToken"]);e!==void 0&&i!=null&&h(e,["_query","pageToken"],i);const s=c(t,["filter"]);return e!==void 0&&s!=null&&h(e,["_query","filter"],s),n}function WM(t){const e={},n=c(t,["config"]);return n!=null&&$M(n,e),e}function KM(t){const e={},n=c(t,["config"]);return n!=null&&HM(n,e),e}function jM(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=c(t,["tunedModels"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>VC(o))),h(e,["tuningJobs"],s)}return e}function JM(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=c(t,["tuningJobs"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>vm(o))),h(e,["tuningJobs"],s)}return e}function QM(t){const e={},n=c(t,["name"]);n!=null&&h(e,["model"],n);const r=c(t,["name"]);return r!=null&&h(e,["endpoint"],r),e}function YM(t){const e={};if(c(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(c(t,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const n=c(t,["examples"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>i)),h(e,["examples","examples"],r)}return e}function XM(t,e){const n={},r=c(t,["gcsUri"]);e!==void 0&&r!=null&&h(e,["supervisedTuningSpec","trainingDatasetUri"],r);const i=c(t,["vertexDatasetResource"]);if(e!==void 0&&i!=null&&h(e,["supervisedTuningSpec","trainingDatasetUri"],i),c(t,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return n}function VC(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["name"]);r!=null&&h(e,["name"],r);const i=c(t,["state"]);i!=null&&h(e,["state"],gC(i));const s=c(t,["createTime"]);s!=null&&h(e,["createTime"],s);const o=c(t,["tuningTask","startTime"]);o!=null&&h(e,["startTime"],o);const a=c(t,["tuningTask","completeTime"]);a!=null&&h(e,["endTime"],a);const l=c(t,["updateTime"]);l!=null&&h(e,["updateTime"],l);const u=c(t,["description"]);u!=null&&h(e,["description"],u);const f=c(t,["baseModel"]);f!=null&&h(e,["baseModel"],f);const m=c(t,["_self"]);m!=null&&h(e,["tunedModel"],QM(m));const g=c(t,["customBaseModel"]);g!=null&&h(e,["customBaseModel"],g);const v=c(t,["experiment"]);v!=null&&h(e,["experiment"],v);const T=c(t,["labels"]);T!=null&&h(e,["labels"],T);const A=c(t,["outputUri"]);A!=null&&h(e,["outputUri"],A);const D=c(t,["pipelineJob"]);D!=null&&h(e,["pipelineJob"],D);const S=c(t,["serviceAccount"]);S!=null&&h(e,["serviceAccount"],S);const I=c(t,["tunedModelDisplayName"]);I!=null&&h(e,["tunedModelDisplayName"],I);const P=c(t,["veoTuningSpec"]);return P!=null&&h(e,["veoTuningSpec"],P),e}function vm(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["name"]);r!=null&&h(e,["name"],r);const i=c(t,["state"]);i!=null&&h(e,["state"],gC(i));const s=c(t,["createTime"]);s!=null&&h(e,["createTime"],s);const o=c(t,["startTime"]);o!=null&&h(e,["startTime"],o);const a=c(t,["endTime"]);a!=null&&h(e,["endTime"],a);const l=c(t,["updateTime"]);l!=null&&h(e,["updateTime"],l);const u=c(t,["error"]);u!=null&&h(e,["error"],u);const f=c(t,["description"]);f!=null&&h(e,["description"],f);const m=c(t,["baseModel"]);m!=null&&h(e,["baseModel"],m);const g=c(t,["tunedModel"]);g!=null&&h(e,["tunedModel"],g);const v=c(t,["preTunedModel"]);v!=null&&h(e,["preTunedModel"],v);const T=c(t,["supervisedTuningSpec"]);T!=null&&h(e,["supervisedTuningSpec"],T);const A=c(t,["tuningDataStats"]);A!=null&&h(e,["tuningDataStats"],A);const D=c(t,["encryptionSpec"]);D!=null&&h(e,["encryptionSpec"],D);const S=c(t,["partnerModelTuningSpec"]);S!=null&&h(e,["partnerModelTuningSpec"],S);const I=c(t,["customBaseModel"]);I!=null&&h(e,["customBaseModel"],I);const P=c(t,["experiment"]);P!=null&&h(e,["experiment"],P);const V=c(t,["labels"]);V!=null&&h(e,["labels"],V);const U=c(t,["outputUri"]);U!=null&&h(e,["outputUri"],U);const O=c(t,["pipelineJob"]);O!=null&&h(e,["pipelineJob"],O);const E=c(t,["serviceAccount"]);E!=null&&h(e,["serviceAccount"],E);const w=c(t,["tunedModelDisplayName"]);w!=null&&h(e,["tunedModelDisplayName"],w);const C=c(t,["veoTuningSpec"]);return C!=null&&h(e,["veoTuningSpec"],C),e}function ZM(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["name"]);r!=null&&h(e,["name"],r);const i=c(t,["metadata"]);i!=null&&h(e,["metadata"],i);const s=c(t,["done"]);s!=null&&h(e,["done"],s);const o=c(t,["error"]);return o!=null&&h(e,["error"],o),e}function e2(t,e){const n={},r=c(t,["gcsUri"]);r!=null&&h(n,["validationDatasetUri"],r);const i=c(t,["vertexDatasetResource"]);return e!==void 0&&i!=null&&h(e,["supervisedTuningSpec","trainingDatasetUri"],i),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class t2 extends lo{constructor(e){super(),this.apiClient=e,this.get=async n=>await this.getInternal(n),this.list=async(n={})=>new Ou(Ys.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(n),n),this.tune=async n=>{var r;if(this.apiClient.isVertexAI())if(n.baseModel.startsWith("projects/")){const i={tunedModelName:n.baseModel};!((r=n.config)===null||r===void 0)&&r.preTunedModelCheckpointId&&(i.checkpointId=n.config.preTunedModelCheckpointId);const s=Object.assign(Object.assign({},n),{preTunedModel:i});return s.baseModel=void 0,await this.tuneInternal(s)}else{const i=Object.assign({},n);return await this.tuneInternal(i)}else{const i=Object.assign({},n),s=await this.tuneMldevInternal(i);let o="";return s.metadata!==void 0&&s.metadata.tunedModel!==void 0?o=s.metadata.tunedModel:s.name!==void 0&&s.name.includes("/operations/")&&(o=s.name.split("/operations/")[0]),{name:o,state:hm.JOB_STATE_QUEUED}}}}async getInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=zM(e);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>vm(f))}else{const u=GM(e);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>VC(f))}}async listInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=KM(e);return a=de("tuningJobs",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=JM(f),g=new ST;return Object.assign(g,m),g})}else{const u=WM(e);return a=de("tunedModels",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=jM(f),g=new ST;return Object.assign(g,m),g})}}async cancel(e){var n,r,i,s;let o="",a={};if(this.apiClient.isVertexAI()){const l=FM(e);o=de("{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}else{const l=LM(e);o=de("{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal})}}async tuneInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=qM(e);return s=de("tuningJobs",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>vm(l))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=BM(e);return s=de("tunedModels",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>ZM(l))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class n2{async download(e,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const r2=1024*1024*8,i2=3,s2=1e3,o2=2,rp="x-goog-upload-status";async function a2(t,e,n){var r,i,s;let o=0,a=0,l=new fm(new Response),u="upload";for(o=t.size;a<o;){const m=Math.min(r2,o-a),g=t.slice(a,a+m);a+m>=o&&(u+=", finalize");let v=0,T=s2;for(;v<i2&&(l=await n.request({path:"",body:g,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":u,"X-Goog-Upload-Offset":String(a),"Content-Length":String(m)}}}),!(!((r=l==null?void 0:l.headers)===null||r===void 0)&&r[rp]));)v++,await u2(T),T=T*o2;if(a+=m,((i=l==null?void 0:l.headers)===null||i===void 0?void 0:i[rp])!=="active")break;if(o<=a)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const f=await(l==null?void 0:l.json());if(((s=l==null?void 0:l.headers)===null||s===void 0?void 0:s[rp])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return f.file}async function l2(t){return{size:t.size,type:t.type}}function u2(t){return new Promise(e=>setTimeout(e,t))}class c2{async upload(e,n,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await a2(e,n,r)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await l2(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class d2{create(e,n,r){return new h2(e,n,r)}}class h2{constructor(e,n,r){this.url=e,this.headers=n,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const $T="x-goog-api-key";class f2{constructor(e){this.apiKey=e}async addAuthHeaders(e){if(e.get($T)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append($T,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const p2="gl-node/";class m2{constructor(e){var n;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=e.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=e.apiKey;const r=bk(e.httpOptions,e.vertexai,void 0,void 0);r&&(e.httpOptions?e.httpOptions.baseUrl=r:e.httpOptions={baseUrl:r}),this.apiVersion=e.apiVersion;const i=new f2(this.apiKey);this.apiClient=new Zb({auth:i,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:p2+"web",uploader:new c2,downloader:new n2}),this.models=new vM(this.apiClient),this.live=new hM(this.apiClient,i,new d2),this.batches=new X1(this.apiClient),this.chats=new kN(this.models,this.apiClient),this.caches=new xN(this.apiClient),this.files=new BN(this.apiClient),this.operations=new TM(this.apiClient),this.authTokens=new VM(this.apiClient),this.tunings=new t2(this.apiClient)}}const g2=()=>{};var HT={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LC=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},_2=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],o=t[n++],a=t[n++],l=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},FC={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],o=i+1<t.length,a=o?t[i+1]:0,l=i+2<t.length,u=l?t[i+2]:0,f=s>>2,m=(s&3)<<4|a>>4;let g=(a&15)<<2|u>>6,v=u&63;l||(v=64,o||(g=64)),r.push(n[f],n[m],n[g],n[v])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(LC(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):_2(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0;++i;const u=i<t.length?n[t.charAt(i)]:64;++i;const m=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||a==null||u==null||m==null)throw new y2;const g=s<<2|a>>4;if(r.push(g),u!==64){const v=a<<4&240|u>>2;if(r.push(v),m!==64){const T=u<<6&192|m;r.push(T)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class y2 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const v2=function(t){const e=LC(t);return FC.encodeByteArray(e,!0)},Xd=function(t){return v2(t).replace(/\./g,"")},UC=function(t){try{return FC.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OC(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T2=()=>OC().__FIREBASE_DEFAULTS__,E2=()=>{if(typeof process>"u"||typeof HT>"u")return;const t=HT.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},I2=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&UC(t[1]);return e&&JSON.parse(e)},$h=()=>{try{return g2()||T2()||E2()||I2()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},BC=t=>{var e,n;return(n=(e=$h())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},w2=t=>{const e=BC(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},qC=()=>{var t;return(t=$h())==null?void 0:t.config},GC=t=>{var e;return(e=$h())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S2{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function La(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function zC(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C2(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...t};return[Xd(JSON.stringify(n)),Xd(JSON.stringify(o)),""].join(".")}const Hl={};function A2(){const t={prod:[],emulator:[]};for(const e of Object.keys(Hl))Hl[e]?t.emulator.push(e):t.prod.push(e);return t}function x2(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let WT=!1;function $C(t,e){if(typeof window>"u"||typeof document>"u"||!La(window.location.host)||Hl[t]===e||Hl[t]||WT)return;Hl[t]=e;function n(g){return`__firebase__banner__${g}`}const r="__firebase__banner",s=A2().prod.length>0;function o(){const g=document.getElementById(r);g&&g.remove()}function a(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function l(g,v){g.setAttribute("width","24"),g.setAttribute("id",v),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function u(){const g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{WT=!0,o()},g}function f(g,v){g.setAttribute("id",v),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function m(){const g=x2(r),v=n("text"),T=document.getElementById(v)||document.createElement("span"),A=n("learnmore"),D=document.getElementById(A)||document.createElement("a"),S=n("preprendIcon"),I=document.getElementById(S)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){const P=g.element;a(P),f(D,A);const V=u();l(I,S),P.append(I,T,D,V),document.body.appendChild(P)}s?(T.innerText="Preview backend disconnected.",I.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(I.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,T.innerText="Preview backend running in this workspace."),T.setAttribute("id",v)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",m):m()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function R2(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Nt())}function HC(){var e;const t=(e=$h())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function P2(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function k2(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function N2(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function D2(){const t=Nt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function WC(){return!HC()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function KC(){return!HC()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function jC(){try{return typeof indexedDB=="object"}catch{return!1}}function b2(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)==null?void 0:s.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M2="FirebaseError";class ti extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=M2,Object.setPrototypeOf(this,ti.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Bu.prototype.create)}}class Bu{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?V2(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new ti(i,a,r)}}function V2(t,e){return t.replace(L2,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const L2=/\{\$([^}]+)}/g;function F2(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Xs(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],o=e[i];if(KT(s)&&KT(o)){if(!Xs(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function KT(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qu(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function U2(t,e){const n=new O2(t,e);return n.subscribe.bind(n)}class O2{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");B2(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=ip),i.error===void 0&&(i.error=ip),i.complete===void 0&&(i.complete=ip);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function B2(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function ip(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dt(t){return t&&t._delegate?t._delegate:t}class Zs{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xs="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q2{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new S2;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(z2(e))try{this.getOrInitializeService({instanceIdentifier:xs})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=xs){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=xs){return this.instances.has(e)}getOptions(e=xs){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:G2(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=xs){return this.component?this.component.multipleInstances?e:xs:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function G2(t){return t===xs?void 0:t}function z2(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $2{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new q2(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ve;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ve||(Ve={}));const H2={debug:Ve.DEBUG,verbose:Ve.VERBOSE,info:Ve.INFO,warn:Ve.WARN,error:Ve.ERROR,silent:Ve.SILENT},W2=Ve.INFO,K2={[Ve.DEBUG]:"log",[Ve.VERBOSE]:"log",[Ve.INFO]:"info",[Ve.WARN]:"warn",[Ve.ERROR]:"error"},j2=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=K2[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class r_{constructor(e){this.name=e,this._logLevel=W2,this._logHandler=j2,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ve))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?H2[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ve.DEBUG,...e),this._logHandler(this,Ve.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ve.VERBOSE,...e),this._logHandler(this,Ve.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ve.INFO,...e),this._logHandler(this,Ve.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ve.WARN,...e),this._logHandler(this,Ve.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ve.ERROR,...e),this._logHandler(this,Ve.ERROR,...e)}}const J2=(t,e)=>e.some(n=>t instanceof n);let jT,JT;function Q2(){return jT||(jT=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Y2(){return JT||(JT=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const JC=new WeakMap,Tm=new WeakMap,QC=new WeakMap,sp=new WeakMap,i_=new WeakMap;function X2(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(Oi(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&JC.set(n,t)}).catch(()=>{}),i_.set(e,t),e}function Z2(t){if(Tm.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});Tm.set(t,e)}let Em={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Tm.get(t);if(e==="objectStoreNames")return t.objectStoreNames||QC.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Oi(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function eV(t){Em=t(Em)}function tV(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(op(this),e,...n);return QC.set(r,e.sort?e.sort():[e]),Oi(r)}:Y2().includes(t)?function(...e){return t.apply(op(this),e),Oi(JC.get(this))}:function(...e){return Oi(t.apply(op(this),e))}}function nV(t){return typeof t=="function"?tV(t):(t instanceof IDBTransaction&&Z2(t),J2(t,Q2())?new Proxy(t,Em):t)}function Oi(t){if(t instanceof IDBRequest)return X2(t);if(sp.has(t))return sp.get(t);const e=nV(t);return e!==t&&(sp.set(t,e),i_.set(e,t)),e}const op=t=>i_.get(t);function rV(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),a=Oi(o);return r&&o.addEventListener("upgradeneeded",l=>{r(Oi(o.result),l.oldVersion,l.newVersion,Oi(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}const iV=["get","getKey","getAll","getAllKeys","count"],sV=["put","add","delete","clear"],ap=new Map;function QT(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(ap.get(e))return ap.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=sV.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||iV.includes(n)))return;const s=async function(o,...a){const l=this.transaction(o,i?"readwrite":"readonly");let u=l.store;return r&&(u=u.index(a.shift())),(await Promise.all([u[n](...a),i&&l.done]))[0]};return ap.set(e,s),s}eV(t=>({...t,get:(e,n,r)=>QT(e,n)||t.get(e,n,r),has:(e,n)=>!!QT(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oV{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(aV(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function aV(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Im="@firebase/app",YT="0.14.4";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jr=new r_("@firebase/app"),lV="@firebase/app-compat",uV="@firebase/analytics-compat",cV="@firebase/analytics",dV="@firebase/app-check-compat",hV="@firebase/app-check",fV="@firebase/auth",pV="@firebase/auth-compat",mV="@firebase/database",gV="@firebase/data-connect",_V="@firebase/database-compat",yV="@firebase/functions",vV="@firebase/functions-compat",TV="@firebase/installations",EV="@firebase/installations-compat",IV="@firebase/messaging",wV="@firebase/messaging-compat",SV="@firebase/performance",CV="@firebase/performance-compat",AV="@firebase/remote-config",xV="@firebase/remote-config-compat",RV="@firebase/storage",PV="@firebase/storage-compat",kV="@firebase/firestore",NV="@firebase/ai",DV="@firebase/firestore-compat",bV="firebase",MV="12.4.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wm="[DEFAULT]",VV={[Im]:"fire-core",[lV]:"fire-core-compat",[cV]:"fire-analytics",[uV]:"fire-analytics-compat",[hV]:"fire-app-check",[dV]:"fire-app-check-compat",[fV]:"fire-auth",[pV]:"fire-auth-compat",[mV]:"fire-rtdb",[gV]:"fire-data-connect",[_V]:"fire-rtdb-compat",[yV]:"fire-fn",[vV]:"fire-fn-compat",[TV]:"fire-iid",[EV]:"fire-iid-compat",[IV]:"fire-fcm",[wV]:"fire-fcm-compat",[SV]:"fire-perf",[CV]:"fire-perf-compat",[AV]:"fire-rc",[xV]:"fire-rc-compat",[RV]:"fire-gcs",[PV]:"fire-gcs-compat",[kV]:"fire-fst",[DV]:"fire-fst-compat",[NV]:"fire-vertex","fire-js":"fire-js",[bV]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zd=new Map,LV=new Map,Sm=new Map;function XT(t,e){try{t.container.addComponent(e)}catch(n){Jr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function pa(t){const e=t.name;if(Sm.has(e))return Jr.debug(`There were multiple attempts to register component ${e}.`),!1;Sm.set(e,t);for(const n of Zd.values())XT(n,t);for(const n of LV.values())XT(n,t);return!0}function s_(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function tr(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FV={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Bi=new Bu("app","Firebase",FV);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UV{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Zs("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Bi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fa=MV;function YC(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:wm,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw Bi.create("bad-app-name",{appName:String(i)});if(n||(n=qC()),!n)throw Bi.create("no-options");const s=Zd.get(i);if(s){if(Xs(n,s.options)&&Xs(r,s.config))return s;throw Bi.create("duplicate-app",{appName:i})}const o=new $2(i);for(const l of Sm.values())o.addComponent(l);const a=new UV(n,r,o);return Zd.set(i,a),a}function XC(t=wm){const e=Zd.get(t);if(!e&&t===wm&&qC())return YC();if(!e)throw Bi.create("no-app",{appName:t});return e}function qi(t,e,n){let r=VV[t]??t;n&&(r+=`-${n}`);const i=r.match(/\s|\//),s=e.match(/\s|\//);if(i||s){const o=[`Unable to register library "${r}" with version "${e}":`];i&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Jr.warn(o.join(" "));return}pa(new Zs(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OV="firebase-heartbeat-database",BV=1,Tu="firebase-heartbeat-store";let lp=null;function ZC(){return lp||(lp=rV(OV,BV,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Tu)}catch(n){console.warn(n)}}}}).catch(t=>{throw Bi.create("idb-open",{originalErrorMessage:t.message})})),lp}async function qV(t){try{const n=(await ZC()).transaction(Tu),r=await n.objectStore(Tu).get(e0(t));return await n.done,r}catch(e){if(e instanceof ti)Jr.warn(e.message);else{const n=Bi.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Jr.warn(n.message)}}}async function ZT(t,e){try{const r=(await ZC()).transaction(Tu,"readwrite");await r.objectStore(Tu).put(e,e0(t)),await r.done}catch(n){if(n instanceof ti)Jr.warn(n.message);else{const r=Bi.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Jr.warn(r.message)}}}function e0(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GV=1024,zV=30;class $V{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new WV(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=eE();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>zV){const o=KV(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Jr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=eE(),{heartbeatsToSend:r,unsentEntries:i}=HV(this._heartbeatsCache.heartbeats),s=Xd(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return Jr.warn(n),""}}}function eE(){return new Date().toISOString().substring(0,10)}function HV(t,e=GV){const n=[];let r=t.slice();for(const i of t){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),tE(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),tE(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class WV{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return jC()?b2().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await qV(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return ZT(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return ZT(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function tE(t){return Xd(JSON.stringify({version:2,heartbeats:t})).length}function KV(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jV(t){pa(new Zs("platform-logger",e=>new oV(e),"PRIVATE")),pa(new Zs("heartbeat",e=>new $V(e),"PRIVATE")),qi(Im,YT,t),qi(Im,YT,"esm2020"),qi("fire-js","")}jV("");var JV="firebase",QV="12.4.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */qi(JV,QV,"app");function t0(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const YV=t0,n0=new Bu("auth","Firebase",t0());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eh=new r_("@firebase/auth");function XV(t,...e){eh.logLevel<=Ve.WARN&&eh.warn(`Auth (${Fa}): ${t}`,...e)}function cd(t,...e){eh.logLevel<=Ve.ERROR&&eh.error(`Auth (${Fa}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ar(t,...e){throw a_(t,...e)}function sr(t,...e){return a_(t,...e)}function o_(t,e,n){const r={...YV(),[e]:n};return new Bu("auth","Firebase",r).create(e,{appName:t.name})}function qs(t){return o_(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function ZV(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&Ar(t,"argument-error"),o_(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function a_(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return n0.create(t,...e)}function Ce(t,e,...n){if(!t)throw a_(e,...n)}function Br(t){const e="INTERNAL ASSERTION FAILED: "+t;throw cd(e),new Error(e)}function Qr(t,e){t||Br(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cm(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function eL(){return nE()==="http:"||nE()==="https:"}function nE(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tL(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(eL()||k2()||"connection"in navigator)?navigator.onLine:!0}function nL(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gu{constructor(e,n){this.shortDelay=e,this.longDelay=n,Qr(n>e,"Short delay should be less than long delay!"),this.isMobile=R2()||N2()}get(){return tL()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l_(t,e){Qr(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r0{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Br("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Br("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Br("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rL={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iL=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],sL=new Gu(3e4,6e4);function u_(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function Ua(t,e,n,r,i={}){return i0(t,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const a=qu({key:t.config.apiKey,...o}).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const u={method:e,headers:l,...s};return P2()||(u.referrerPolicy="no-referrer"),t.emulatorConfig&&La(t.emulatorConfig.host)&&(u.credentials="include"),r0.fetch()(await s0(t,t.config.apiHost,n,a),u)})}async function i0(t,e,n){t._canInitEmulator=!1;const r={...rL,...e};try{const i=new aL(t),s=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw Gc(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[l,u]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Gc(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw Gc(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw Gc(t,"user-disabled",o);const f=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw o_(t,f,u);Ar(t,f)}}catch(i){if(i instanceof ti)throw i;Ar(t,"network-request-failed",{message:String(i)})}}async function oL(t,e,n,r,i={}){const s=await Ua(t,e,n,r,i);return"mfaPendingCredential"in s&&Ar(t,"multi-factor-auth-required",{_serverResponse:s}),s}async function s0(t,e,n,r){const i=`${e}${n}?${r}`,s=t,o=s.config.emulator?l_(t.config,i):`${t.config.apiScheme}://${i}`;return iL.includes(n)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}class aL{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(sr(this.auth,"network-request-failed")),sL.get())})}}function Gc(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=sr(t,e,r);return i.customData._tokenResponse=n,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lL(t,e){return Ua(t,"POST","/v1/accounts:delete",e)}async function th(t,e){return Ua(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wl(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function uL(t,e=!1){const n=Dt(t),r=await n.getIdToken(e),i=c_(r);Ce(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:Wl(up(i.auth_time)),issuedAtTime:Wl(up(i.iat)),expirationTime:Wl(up(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function up(t){return Number(t)*1e3}function c_(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return cd("JWT malformed, contained fewer than 3 sections"),null;try{const i=UC(n);return i?JSON.parse(i):(cd("Failed to decode base64 JWT payload"),null)}catch(i){return cd("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function rE(t){const e=c_(t);return Ce(e,"internal-error"),Ce(typeof e.exp<"u","internal-error"),Ce(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Eu(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof ti&&cL(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function cL({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dL{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Am{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Wl(this.lastLoginAt),this.creationTime=Wl(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nh(t){var m;const e=t.auth,n=await t.getIdToken(),r=await Eu(t,th(e,{idToken:n}));Ce(r==null?void 0:r.users.length,e,"internal-error");const i=r.users[0];t._notifyReloadListener(i);const s=(m=i.providerUserInfo)!=null&&m.length?o0(i.providerUserInfo):[],o=fL(t.providerData,s),a=t.isAnonymous,l=!(t.email&&i.passwordHash)&&!(o!=null&&o.length),u=a?l:!1,f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new Am(i.createdAt,i.lastLoginAt),isAnonymous:u};Object.assign(t,f)}async function hL(t){const e=Dt(t);await nh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function fL(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function o0(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pL(t,e){const n=await i0(t,{},async()=>{const r=qu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,o=await s0(t,i,"/v1/token",`key=${s}`),a=await t._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:a,body:r};return t.emulatorConfig&&La(t.emulatorConfig.host)&&(l.credentials="include"),r0.fetch()(o,l)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function mL(t,e){return Ua(t,"POST","/v2/accounts:revokeToken",u_(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ra{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ce(e.idToken,"internal-error"),Ce(typeof e.idToken<"u","internal-error"),Ce(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):rE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Ce(e.length!==0,"internal-error");const n=rE(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Ce(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:s}=await pL(e,n);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:s}=n,o=new ra;return r&&(Ce(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(Ce(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(Ce(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ra,this.toJSON())}_performRefresh(){return Br("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hi(t,e){Ce(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class nr{constructor({uid:e,auth:n,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new dL(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Am(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await Eu(this,this.stsTokenManager.getToken(this.auth,e));return Ce(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return uL(this,e)}reload(){return hL(this)}_assign(e){this!==e&&(Ce(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new nr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){Ce(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await nh(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(tr(this.auth.app))return Promise.reject(qs(this.auth));const e=await this.getIdToken();return await Eu(this,lL(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,i=n.email??void 0,s=n.phoneNumber??void 0,o=n.photoURL??void 0,a=n.tenantId??void 0,l=n._redirectEventId??void 0,u=n.createdAt??void 0,f=n.lastLoginAt??void 0,{uid:m,emailVerified:g,isAnonymous:v,providerData:T,stsTokenManager:A}=n;Ce(m&&A,e,"internal-error");const D=ra.fromJSON(this.name,A);Ce(typeof m=="string",e,"internal-error"),hi(r,e.name),hi(i,e.name),Ce(typeof g=="boolean",e,"internal-error"),Ce(typeof v=="boolean",e,"internal-error"),hi(s,e.name),hi(o,e.name),hi(a,e.name),hi(l,e.name),hi(u,e.name),hi(f,e.name);const S=new nr({uid:m,auth:e,email:i,emailVerified:g,displayName:r,isAnonymous:v,photoURL:o,phoneNumber:s,tenantId:a,stsTokenManager:D,createdAt:u,lastLoginAt:f});return T&&Array.isArray(T)&&(S.providerData=T.map(I=>({...I}))),l&&(S._redirectEventId=l),S}static async _fromIdTokenResponse(e,n,r=!1){const i=new ra;i.updateFromServerResponse(n);const s=new nr({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await nh(s),s}static async _fromGetAccountInfoResponse(e,n,r){const i=n.users[0];Ce(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?o0(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),a=new ra;a.updateFromIdToken(r);const l=new nr({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Am(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(l,u),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iE=new Map;function qr(t){Qr(t instanceof Function,"Expected a class definition");let e=iE.get(t);return e?(Qr(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,iE.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a0{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}a0.type="NONE";const sE=a0;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dd(t,e,n){return`firebase:${t}:${e}:${n}`}class ia{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=dd(this.userKey,i.apiKey,s),this.fullPersistenceKey=dd("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await th(this.auth,{idToken:e}).catch(()=>{});return n?nr._fromGetAccountInfoResponse(this.auth,n,e):null}return nr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new ia(qr(sE),e,r);const i=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let s=i[0]||qr(sE);const o=dd(r,e.config.apiKey,e.name);let a=null;for(const u of n)try{const f=await u._get(o);if(f){let m;if(typeof f=="string"){const g=await th(e,{idToken:f}).catch(()=>{});if(!g)break;m=await nr._fromGetAccountInfoResponse(e,g,f)}else m=nr._fromJSON(e,f);u!==s&&(a=m),s=u;break}}catch{}const l=i.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new ia(s,e,r):(s=l[0],a&&await s._set(o,a.toJSON()),await Promise.all(n.map(async u=>{if(u!==s)try{await u._remove(o)}catch{}})),new ia(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oE(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(d0(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(l0(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(f0(e))return"Blackberry";if(p0(e))return"Webos";if(u0(e))return"Safari";if((e.includes("chrome/")||c0(e))&&!e.includes("edge/"))return"Chrome";if(h0(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function l0(t=Nt()){return/firefox\//i.test(t)}function u0(t=Nt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function c0(t=Nt()){return/crios\//i.test(t)}function d0(t=Nt()){return/iemobile/i.test(t)}function h0(t=Nt()){return/android/i.test(t)}function f0(t=Nt()){return/blackberry/i.test(t)}function p0(t=Nt()){return/webos/i.test(t)}function d_(t=Nt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function gL(t=Nt()){var e;return d_(t)&&!!((e=window.navigator)!=null&&e.standalone)}function _L(){return D2()&&document.documentMode===10}function m0(t=Nt()){return d_(t)||h0(t)||p0(t)||f0(t)||/windows phone/i.test(t)||d0(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g0(t,e=[]){let n;switch(t){case"Browser":n=oE(Nt());break;case"Worker":n=`${oE(Nt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Fa}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yL{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=s=>new Promise((o,a)=>{try{const l=e(s);o(l)}catch(l){a(l)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vL(t,e={}){return Ua(t,"GET","/v2/passwordPolicy",u_(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TL=6;class EL{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??TL,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IL{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new aE(this),this.idTokenSubscription=new aE(this),this.beforeStateQueue=new yL(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=n0,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=qr(n)),this._initializationPromise=this.queue(async()=>{var r,i,s;if(!this._deleted&&(this.persistenceManager=await ia.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((i=this._popupRedirectResolver)!=null&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)==null?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await th(this,{idToken:e}),r=await nr._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var s;if(tr(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(s=this.redirectUser)==null?void 0:s._redirectEventId,a=r==null?void 0:r._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(r=l.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Ce(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await nh(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=nL()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(tr(this.app))return Promise.reject(qs(this));const n=e?Dt(e):null;return n&&Ce(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Ce(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return tr(this.app)?Promise.reject(qs(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return tr(this.app)?Promise.reject(qs(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(qr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await vL(this),n=new EL(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Bu("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await mL(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&qr(e)||this._popupRedirectResolver;Ce(n,this,"argument-error"),this.redirectPersistenceManager=await ia.create(this,[qr(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ce(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,r,i);return()=>{o=!0,l()}}else{const l=e.addObserver(n);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ce(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=g0(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var i;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((i=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:i.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if(tr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&XV(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Hh(t){return Dt(t)}class aE{constructor(e){this.auth=e,this.observer=null,this.addObserver=U2(n=>this.observer=n)}get next(){return Ce(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let h_={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function wL(t){h_=t}function SL(t){return h_.loadJS(t)}function CL(){return h_.gapiScript}function AL(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xL(t,e){const n=s_(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),s=n.getOptions();if(Xs(s,e??{}))return i;Ar(i,"already-initialized")}return n.initialize({options:e})}function RL(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(qr);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function PL(t,e,n){const r=Hh(t);Ce(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,s=_0(e),{host:o,port:a}=kL(e),l=a===null?"":`:${a}`,u={url:`${s}//${o}${l}/`},f=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){Ce(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),Ce(Xs(u,r.config.emulator)&&Xs(f,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=u,r.emulatorConfig=f,r.settings.appVerificationDisabledForTesting=!0,La(o)?(zC(`${s}//${o}${l}`),$C("Auth",!0)):NL()}function _0(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function kL(t){const e=_0(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:lE(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:lE(o)}}}function lE(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function NL(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y0{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Br("not implemented")}_getIdTokenResponse(e){return Br("not implemented")}_linkToIdToken(e,n){return Br("not implemented")}_getReauthenticationResolver(e){return Br("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sa(t,e){return oL(t,"POST","/v1/accounts:signInWithIdp",u_(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DL="http://localhost";class eo extends y0{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new eo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Ar("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...s}=n;if(!r||!i)return null;const o=new eo(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return sa(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,sa(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,sa(e,n)}buildRequest(){const e={requestUri:DL,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=qu(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f_{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zu extends f_{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Si extends zu{constructor(){super("facebook.com")}static credential(e){return eo._fromParams({providerId:Si.PROVIDER_ID,signInMethod:Si.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Si.credentialFromTaggedObject(e)}static credentialFromError(e){return Si.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Si.credential(e.oauthAccessToken)}catch{return null}}}Si.FACEBOOK_SIGN_IN_METHOD="facebook.com";Si.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fr extends zu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return eo._fromParams({providerId:Fr.PROVIDER_ID,signInMethod:Fr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Fr.credentialFromTaggedObject(e)}static credentialFromError(e){return Fr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Fr.credential(n,r)}catch{return null}}}Fr.GOOGLE_SIGN_IN_METHOD="google.com";Fr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ci extends zu{constructor(){super("github.com")}static credential(e){return eo._fromParams({providerId:Ci.PROVIDER_ID,signInMethod:Ci.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ci.credentialFromTaggedObject(e)}static credentialFromError(e){return Ci.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ci.credential(e.oauthAccessToken)}catch{return null}}}Ci.GITHUB_SIGN_IN_METHOD="github.com";Ci.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ai extends zu{constructor(){super("twitter.com")}static credential(e,n){return eo._fromParams({providerId:Ai.PROVIDER_ID,signInMethod:Ai.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Ai.credentialFromTaggedObject(e)}static credentialFromError(e){return Ai.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Ai.credential(n,r)}catch{return null}}}Ai.TWITTER_SIGN_IN_METHOD="twitter.com";Ai.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ma{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const s=await nr._fromIdTokenResponse(e,r,i),o=uE(r);return new ma({user:s,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=uE(r);return new ma({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function uE(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rh extends ti{constructor(e,n,r,i){super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,rh.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new rh(e,n,r,i)}}function v0(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?rh._fromErrorAndOperation(t,s,e,r):s})}async function bL(t,e,n=!1){const r=await Eu(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return ma._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ML(t,e,n=!1){const{auth:r}=t;if(tr(r.app))return Promise.reject(qs(r));const i="reauthenticate";try{const s=await Eu(t,v0(r,i,e,t),n);Ce(s.idToken,r,"internal-error");const o=c_(s.idToken);Ce(o,r,"internal-error");const{sub:a}=o;return Ce(t.uid===a,r,"user-mismatch"),ma._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&Ar(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VL(t,e,n=!1){if(tr(t.app))return Promise.reject(qs(t));const r="signIn",i=await v0(t,r,e),s=await ma._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(s.user),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LL(t,e){return Dt(t).setPersistence(e)}function FL(t,e,n,r){return Dt(t).onIdTokenChanged(e,n,r)}function UL(t,e,n){return Dt(t).beforeAuthStateChanged(e,n)}function OL(t,e,n,r){return Dt(t).onAuthStateChanged(e,n,r)}function cE(t){return Dt(t).signOut()}const ih="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T0{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(ih,"1"),this.storage.removeItem(ih),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BL=1e3,qL=10;class E0 extends T0{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=m0(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;n?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);_L()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,qL):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},BL)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}E0.type="LOCAL";const I0=E0;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w0 extends T0{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}w0.type="SESSION";const S0=w0;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GL(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wh{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new Wh(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:s}=n.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const a=Array.from(o).map(async u=>u(n.origin,s)),l=await GL(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Wh.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p_(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zL{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,l)=>{const u=p_("",20);i.port1.start();const f=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(m){const g=m;if(g.data.eventId===u)switch(g.data.status){case"ack":clearTimeout(f),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(g.data.response);break;default:clearTimeout(f),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sr(){return window}function $L(t){Sr().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C0(){return typeof Sr().WorkerGlobalScope<"u"&&typeof Sr().importScripts=="function"}async function HL(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function WL(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function KL(){return C0()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A0="firebaseLocalStorageDb",jL=1,sh="firebaseLocalStorage",x0="fbase_key";class $u{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Kh(t,e){return t.transaction([sh],e?"readwrite":"readonly").objectStore(sh)}function JL(){const t=indexedDB.deleteDatabase(A0);return new $u(t).toPromise()}function xm(){const t=indexedDB.open(A0,jL);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(sh,{keyPath:x0})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(sh)?e(r):(r.close(),await JL(),e(await xm()))})})}async function dE(t,e,n){const r=Kh(t,!0).put({[x0]:e,value:n});return new $u(r).toPromise()}async function QL(t,e){const n=Kh(t,!1).get(e),r=await new $u(n).toPromise();return r===void 0?null:r.value}function hE(t,e){const n=Kh(t,!0).delete(e);return new $u(n).toPromise()}const YL=800,XL=3;class R0{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await xm(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>XL)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return C0()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Wh._getInstance(KL()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await HL(),!this.activeServiceWorker)return;this.sender=new zL(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||WL()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await xm();return await dE(e,ih,"1"),await hE(e,ih),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>dE(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>QL(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>hE(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=Kh(i,!1).getAll();return new $u(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),YL)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}R0.type="LOCAL";const ZL=R0;new Gu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P0(t,e){return e?qr(e):(Ce(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m_ extends y0{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return sa(e,this._buildIdpRequest())}_linkToIdToken(e,n){return sa(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return sa(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function eF(t){return VL(t.auth,new m_(t),t.bypassAuthState)}function tF(t){const{auth:e,user:n}=t;return Ce(n,e,"internal-error"),ML(n,new m_(t),t.bypassAuthState)}async function nF(t){const{auth:e,user:n}=t;return Ce(n,e,"internal-error"),bL(n,new m_(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k0{constructor(e,n,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return eF;case"linkViaPopup":case"linkViaRedirect":return nF;case"reauthViaPopup":case"reauthViaRedirect":return tF;default:Ar(this.auth,"internal-error")}}resolve(e){Qr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Qr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rF=new Gu(2e3,1e4);async function iF(t,e,n){if(tr(t.app))return Promise.reject(sr(t,"operation-not-supported-in-this-environment"));const r=Hh(t);ZV(t,e,f_);const i=P0(r,n);return new Fs(r,"signInViaPopup",e,i).executeNotNull()}class Fs extends k0{constructor(e,n,r,i,s){super(e,n,i,s),this.provider=r,this.authWindow=null,this.pollId=null,Fs.currentPopupAction&&Fs.currentPopupAction.cancel(),Fs.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ce(e,this.auth,"internal-error"),e}async onExecution(){Qr(this.filter.length===1,"Popup operations only handle one event");const e=p_();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(sr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(sr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Fs.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(sr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,rF.get())};e()}}Fs.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sF="pendingRedirect",hd=new Map;class oF extends k0{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=hd.get(this.auth._key());if(!e){try{const r=await aF(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}hd.set(this.auth._key(),e)}return this.bypassAuthState||hd.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function aF(t,e){const n=cF(e),r=uF(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}function lF(t,e){hd.set(t._key(),e)}function uF(t){return qr(t._redirectPersistence)}function cF(t){return dd(sF,t.config.apiKey,t.name)}async function dF(t,e,n=!1){if(tr(t.app))return Promise.reject(qs(t));const r=Hh(t),i=P0(r,e),o=await new oF(r,i,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hF=10*60*1e3;class fF{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!pF(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!N0(e)){const i=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(sr(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=hF&&this.cachedEventUids.clear(),this.cachedEventUids.has(fE(e))}saveEventToCache(e){this.cachedEventUids.add(fE(e)),this.lastProcessedEventTime=Date.now()}}function fE(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function N0({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function pF(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return N0(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mF(t,e={}){return Ua(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gF=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,_F=/^https?/;async function yF(t){if(t.config.emulator)return;const{authorizedDomains:e}=await mF(t);for(const n of e)try{if(vF(n))return}catch{}Ar(t,"unauthorized-domain")}function vF(t){const e=Cm(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!_F.test(n))return!1;if(gF.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TF=new Gu(3e4,6e4);function pE(){const t=Sr().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function EF(t){return new Promise((e,n)=>{var i,s,o;function r(){pE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{pE(),n(sr(t,"network-request-failed"))},timeout:TF.get()})}if((s=(i=Sr().gapi)==null?void 0:i.iframes)!=null&&s.Iframe)e(gapi.iframes.getContext());else if((o=Sr().gapi)!=null&&o.load)r();else{const a=AL("iframefcb");return Sr()[a]=()=>{gapi.load?r():n(sr(t,"network-request-failed"))},SL(`${CL()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw fd=null,e})}let fd=null;function IF(t){return fd=fd||EF(t),fd}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wF=new Gu(5e3,15e3),SF="__/auth/iframe",CF="emulator/auth/iframe",AF={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},xF=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function RF(t){const e=t.config;Ce(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?l_(e,CF):`https://${t.config.authDomain}/${SF}`,r={apiKey:e.apiKey,appName:t.name,v:Fa},i=xF.get(t.config.apiHost);i&&(r.eid=i);const s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${qu(r).slice(1)}`}async function PF(t){const e=await IF(t),n=Sr().gapi;return Ce(n,t,"internal-error"),e.open({where:document.body,url:RF(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:AF,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=sr(t,"network-request-failed"),a=Sr().setTimeout(()=>{s(o)},wF.get());function l(){Sr().clearTimeout(a),i(r)}r.ping(l).then(l,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kF={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},NF=500,DF=600,bF="_blank",MF="http://localhost";class mE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function VF(t,e,n,r=NF,i=DF){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l={...kF,width:r.toString(),height:i.toString(),top:s,left:o},u=Nt().toLowerCase();n&&(a=c0(u)?bF:n),l0(u)&&(e=e||MF,l.scrollbars="yes");const f=Object.entries(l).reduce((g,[v,T])=>`${g}${v}=${T},`,"");if(gL(u)&&a!=="_self")return LF(e||"",a),new mE(null);const m=window.open(e||"",a,f);Ce(m,t,"popup-blocked");try{m.focus()}catch{}return new mE(m)}function LF(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FF="__/auth/handler",UF="emulator/auth/handler",OF=encodeURIComponent("fac");async function gE(t,e,n,r,i,s){Ce(t.config.authDomain,t,"auth-domain-config-required"),Ce(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Fa,eventId:i};if(e instanceof f_){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",F2(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,m]of Object.entries({}))o[f]=m}if(e instanceof zu){const f=e.getScopes().filter(m=>m!=="");f.length>0&&(o.scopes=f.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const f of Object.keys(a))a[f]===void 0&&delete a[f];const l=await t._getAppCheckToken(),u=l?`#${OF}=${encodeURIComponent(l)}`:"";return`${BF(t)}?${qu(a).slice(1)}${u}`}function BF({config:t}){return t.emulator?l_(t,UF):`https://${t.authDomain}/${FF}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cp="webStorageSupport";class qF{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=S0,this._completeRedirectFn=dF,this._overrideRedirectResult=lF}async _openPopup(e,n,r,i){var o;Qr((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const s=await gE(e,n,r,Cm(),i);return VF(e,s,p_())}async _openRedirect(e,n,r,i){await this._originValidation(e);const s=await gE(e,n,r,Cm(),i);return $L(s),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:s}=this.eventManagers[n];return i?Promise.resolve(i):(Qr(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await PF(e),r=new fF(e);return n.register("authEvent",i=>(Ce(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(cp,{type:cp},i=>{var o;const s=(o=i==null?void 0:i[0])==null?void 0:o[cp];s!==void 0&&n(!!s),Ar(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=yF(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return m0()||u0()||d_()}}const GF=qF;var _E="@firebase/auth",yE="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zF{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Ce(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $F(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function HF(t){pa(new Zs("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;Ce(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:g0(t)},u=new IL(r,i,s,l);return RL(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),pa(new Zs("auth-internal",e=>{const n=Hh(e.getProvider("auth").getImmediate());return(r=>new zF(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),qi(_E,yE,$F(t)),qi(_E,yE,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WF=5*60,KF=GC("authIdTokenMaxAge")||WF;let vE=null;const jF=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>KF)return;const i=n==null?void 0:n.token;vE!==i&&(vE=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function JF(t=XC()){const e=s_(t,"auth");if(e.isInitialized())return e.getImmediate();const n=xL(t,{popupRedirectResolver:GF,persistence:[ZL,I0,S0]}),r=GC("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const o=jF(s.toString());UL(n,o,()=>o(n.currentUser)),FL(n,a=>o(a))}}const i=BC("auth");return i&&PL(n,`http://${i}`),n}function QF(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}wL({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const s=sr("internal-error");s.customData=i,n(s)},r.type="text/javascript",r.charset="UTF-8",QF().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});HF("Browser");var TE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Gi,D0;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(E,w){function C(){}C.prototype=w.prototype,E.F=w.prototype,E.prototype=new C,E.prototype.constructor=E,E.D=function(k,b,L){for(var N=Array(arguments.length-2),De=2;De<arguments.length;De++)N[De-2]=arguments[De];return w.prototype[b].apply(k,N)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(E,w,C){C||(C=0);const k=Array(16);if(typeof w=="string")for(var b=0;b<16;++b)k[b]=w.charCodeAt(C++)|w.charCodeAt(C++)<<8|w.charCodeAt(C++)<<16|w.charCodeAt(C++)<<24;else for(b=0;b<16;++b)k[b]=w[C++]|w[C++]<<8|w[C++]<<16|w[C++]<<24;w=E.g[0],C=E.g[1],b=E.g[2];let L=E.g[3],N;N=w+(L^C&(b^L))+k[0]+3614090360&4294967295,w=C+(N<<7&4294967295|N>>>25),N=L+(b^w&(C^b))+k[1]+3905402710&4294967295,L=w+(N<<12&4294967295|N>>>20),N=b+(C^L&(w^C))+k[2]+606105819&4294967295,b=L+(N<<17&4294967295|N>>>15),N=C+(w^b&(L^w))+k[3]+3250441966&4294967295,C=b+(N<<22&4294967295|N>>>10),N=w+(L^C&(b^L))+k[4]+4118548399&4294967295,w=C+(N<<7&4294967295|N>>>25),N=L+(b^w&(C^b))+k[5]+1200080426&4294967295,L=w+(N<<12&4294967295|N>>>20),N=b+(C^L&(w^C))+k[6]+2821735955&4294967295,b=L+(N<<17&4294967295|N>>>15),N=C+(w^b&(L^w))+k[7]+4249261313&4294967295,C=b+(N<<22&4294967295|N>>>10),N=w+(L^C&(b^L))+k[8]+1770035416&4294967295,w=C+(N<<7&4294967295|N>>>25),N=L+(b^w&(C^b))+k[9]+2336552879&4294967295,L=w+(N<<12&4294967295|N>>>20),N=b+(C^L&(w^C))+k[10]+4294925233&4294967295,b=L+(N<<17&4294967295|N>>>15),N=C+(w^b&(L^w))+k[11]+2304563134&4294967295,C=b+(N<<22&4294967295|N>>>10),N=w+(L^C&(b^L))+k[12]+1804603682&4294967295,w=C+(N<<7&4294967295|N>>>25),N=L+(b^w&(C^b))+k[13]+4254626195&4294967295,L=w+(N<<12&4294967295|N>>>20),N=b+(C^L&(w^C))+k[14]+2792965006&4294967295,b=L+(N<<17&4294967295|N>>>15),N=C+(w^b&(L^w))+k[15]+1236535329&4294967295,C=b+(N<<22&4294967295|N>>>10),N=w+(b^L&(C^b))+k[1]+4129170786&4294967295,w=C+(N<<5&4294967295|N>>>27),N=L+(C^b&(w^C))+k[6]+3225465664&4294967295,L=w+(N<<9&4294967295|N>>>23),N=b+(w^C&(L^w))+k[11]+643717713&4294967295,b=L+(N<<14&4294967295|N>>>18),N=C+(L^w&(b^L))+k[0]+3921069994&4294967295,C=b+(N<<20&4294967295|N>>>12),N=w+(b^L&(C^b))+k[5]+3593408605&4294967295,w=C+(N<<5&4294967295|N>>>27),N=L+(C^b&(w^C))+k[10]+38016083&4294967295,L=w+(N<<9&4294967295|N>>>23),N=b+(w^C&(L^w))+k[15]+3634488961&4294967295,b=L+(N<<14&4294967295|N>>>18),N=C+(L^w&(b^L))+k[4]+3889429448&4294967295,C=b+(N<<20&4294967295|N>>>12),N=w+(b^L&(C^b))+k[9]+568446438&4294967295,w=C+(N<<5&4294967295|N>>>27),N=L+(C^b&(w^C))+k[14]+3275163606&4294967295,L=w+(N<<9&4294967295|N>>>23),N=b+(w^C&(L^w))+k[3]+4107603335&4294967295,b=L+(N<<14&4294967295|N>>>18),N=C+(L^w&(b^L))+k[8]+1163531501&4294967295,C=b+(N<<20&4294967295|N>>>12),N=w+(b^L&(C^b))+k[13]+2850285829&4294967295,w=C+(N<<5&4294967295|N>>>27),N=L+(C^b&(w^C))+k[2]+4243563512&4294967295,L=w+(N<<9&4294967295|N>>>23),N=b+(w^C&(L^w))+k[7]+1735328473&4294967295,b=L+(N<<14&4294967295|N>>>18),N=C+(L^w&(b^L))+k[12]+2368359562&4294967295,C=b+(N<<20&4294967295|N>>>12),N=w+(C^b^L)+k[5]+4294588738&4294967295,w=C+(N<<4&4294967295|N>>>28),N=L+(w^C^b)+k[8]+2272392833&4294967295,L=w+(N<<11&4294967295|N>>>21),N=b+(L^w^C)+k[11]+1839030562&4294967295,b=L+(N<<16&4294967295|N>>>16),N=C+(b^L^w)+k[14]+4259657740&4294967295,C=b+(N<<23&4294967295|N>>>9),N=w+(C^b^L)+k[1]+2763975236&4294967295,w=C+(N<<4&4294967295|N>>>28),N=L+(w^C^b)+k[4]+1272893353&4294967295,L=w+(N<<11&4294967295|N>>>21),N=b+(L^w^C)+k[7]+4139469664&4294967295,b=L+(N<<16&4294967295|N>>>16),N=C+(b^L^w)+k[10]+3200236656&4294967295,C=b+(N<<23&4294967295|N>>>9),N=w+(C^b^L)+k[13]+681279174&4294967295,w=C+(N<<4&4294967295|N>>>28),N=L+(w^C^b)+k[0]+3936430074&4294967295,L=w+(N<<11&4294967295|N>>>21),N=b+(L^w^C)+k[3]+3572445317&4294967295,b=L+(N<<16&4294967295|N>>>16),N=C+(b^L^w)+k[6]+76029189&4294967295,C=b+(N<<23&4294967295|N>>>9),N=w+(C^b^L)+k[9]+3654602809&4294967295,w=C+(N<<4&4294967295|N>>>28),N=L+(w^C^b)+k[12]+3873151461&4294967295,L=w+(N<<11&4294967295|N>>>21),N=b+(L^w^C)+k[15]+530742520&4294967295,b=L+(N<<16&4294967295|N>>>16),N=C+(b^L^w)+k[2]+3299628645&4294967295,C=b+(N<<23&4294967295|N>>>9),N=w+(b^(C|~L))+k[0]+4096336452&4294967295,w=C+(N<<6&4294967295|N>>>26),N=L+(C^(w|~b))+k[7]+1126891415&4294967295,L=w+(N<<10&4294967295|N>>>22),N=b+(w^(L|~C))+k[14]+2878612391&4294967295,b=L+(N<<15&4294967295|N>>>17),N=C+(L^(b|~w))+k[5]+4237533241&4294967295,C=b+(N<<21&4294967295|N>>>11),N=w+(b^(C|~L))+k[12]+1700485571&4294967295,w=C+(N<<6&4294967295|N>>>26),N=L+(C^(w|~b))+k[3]+2399980690&4294967295,L=w+(N<<10&4294967295|N>>>22),N=b+(w^(L|~C))+k[10]+4293915773&4294967295,b=L+(N<<15&4294967295|N>>>17),N=C+(L^(b|~w))+k[1]+2240044497&4294967295,C=b+(N<<21&4294967295|N>>>11),N=w+(b^(C|~L))+k[8]+1873313359&4294967295,w=C+(N<<6&4294967295|N>>>26),N=L+(C^(w|~b))+k[15]+4264355552&4294967295,L=w+(N<<10&4294967295|N>>>22),N=b+(w^(L|~C))+k[6]+2734768916&4294967295,b=L+(N<<15&4294967295|N>>>17),N=C+(L^(b|~w))+k[13]+1309151649&4294967295,C=b+(N<<21&4294967295|N>>>11),N=w+(b^(C|~L))+k[4]+4149444226&4294967295,w=C+(N<<6&4294967295|N>>>26),N=L+(C^(w|~b))+k[11]+3174756917&4294967295,L=w+(N<<10&4294967295|N>>>22),N=b+(w^(L|~C))+k[2]+718787259&4294967295,b=L+(N<<15&4294967295|N>>>17),N=C+(L^(b|~w))+k[9]+3951481745&4294967295,E.g[0]=E.g[0]+w&4294967295,E.g[1]=E.g[1]+(b+(N<<21&4294967295|N>>>11))&4294967295,E.g[2]=E.g[2]+b&4294967295,E.g[3]=E.g[3]+L&4294967295}r.prototype.v=function(E,w){w===void 0&&(w=E.length);const C=w-this.blockSize,k=this.C;let b=this.h,L=0;for(;L<w;){if(b==0)for(;L<=C;)i(this,E,L),L+=this.blockSize;if(typeof E=="string"){for(;L<w;)if(k[b++]=E.charCodeAt(L++),b==this.blockSize){i(this,k),b=0;break}}else for(;L<w;)if(k[b++]=E[L++],b==this.blockSize){i(this,k),b=0;break}}this.h=b,this.o+=w},r.prototype.A=function(){var E=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);E[0]=128;for(var w=1;w<E.length-8;++w)E[w]=0;w=this.o*8;for(var C=E.length-8;C<E.length;++C)E[C]=w&255,w/=256;for(this.v(E),E=Array(16),w=0,C=0;C<4;++C)for(let k=0;k<32;k+=8)E[w++]=this.g[C]>>>k&255;return E};function s(E,w){var C=a;return Object.prototype.hasOwnProperty.call(C,E)?C[E]:C[E]=w(E)}function o(E,w){this.h=w;const C=[];let k=!0;for(let b=E.length-1;b>=0;b--){const L=E[b]|0;k&&L==w||(C[b]=L,k=!1)}this.g=C}var a={};function l(E){return-128<=E&&E<128?s(E,function(w){return new o([w|0],w<0?-1:0)}):new o([E|0],E<0?-1:0)}function u(E){if(isNaN(E)||!isFinite(E))return m;if(E<0)return D(u(-E));const w=[];let C=1;for(let k=0;E>=C;k++)w[k]=E/C|0,C*=4294967296;return new o(w,0)}function f(E,w){if(E.length==0)throw Error("number format error: empty string");if(w=w||10,w<2||36<w)throw Error("radix out of range: "+w);if(E.charAt(0)=="-")return D(f(E.substring(1),w));if(E.indexOf("-")>=0)throw Error('number format error: interior "-" character');const C=u(Math.pow(w,8));let k=m;for(let L=0;L<E.length;L+=8){var b=Math.min(8,E.length-L);const N=parseInt(E.substring(L,L+b),w);b<8?(b=u(Math.pow(w,b)),k=k.j(b).add(u(N))):(k=k.j(C),k=k.add(u(N)))}return k}var m=l(0),g=l(1),v=l(16777216);t=o.prototype,t.m=function(){if(A(this))return-D(this).m();let E=0,w=1;for(let C=0;C<this.g.length;C++){const k=this.i(C);E+=(k>=0?k:4294967296+k)*w,w*=4294967296}return E},t.toString=function(E){if(E=E||10,E<2||36<E)throw Error("radix out of range: "+E);if(T(this))return"0";if(A(this))return"-"+D(this).toString(E);const w=u(Math.pow(E,6));var C=this;let k="";for(;;){const b=V(C,w).g;C=S(C,b.j(w));let L=((C.g.length>0?C.g[0]:C.h)>>>0).toString(E);if(C=b,T(C))return L+k;for(;L.length<6;)L="0"+L;k=L+k}},t.i=function(E){return E<0?0:E<this.g.length?this.g[E]:this.h};function T(E){if(E.h!=0)return!1;for(let w=0;w<E.g.length;w++)if(E.g[w]!=0)return!1;return!0}function A(E){return E.h==-1}t.l=function(E){return E=S(this,E),A(E)?-1:T(E)?0:1};function D(E){const w=E.g.length,C=[];for(let k=0;k<w;k++)C[k]=~E.g[k];return new o(C,~E.h).add(g)}t.abs=function(){return A(this)?D(this):this},t.add=function(E){const w=Math.max(this.g.length,E.g.length),C=[];let k=0;for(let b=0;b<=w;b++){let L=k+(this.i(b)&65535)+(E.i(b)&65535),N=(L>>>16)+(this.i(b)>>>16)+(E.i(b)>>>16);k=N>>>16,L&=65535,N&=65535,C[b]=N<<16|L}return new o(C,C[C.length-1]&-2147483648?-1:0)};function S(E,w){return E.add(D(w))}t.j=function(E){if(T(this)||T(E))return m;if(A(this))return A(E)?D(this).j(D(E)):D(D(this).j(E));if(A(E))return D(this.j(D(E)));if(this.l(v)<0&&E.l(v)<0)return u(this.m()*E.m());const w=this.g.length+E.g.length,C=[];for(var k=0;k<2*w;k++)C[k]=0;for(k=0;k<this.g.length;k++)for(let b=0;b<E.g.length;b++){const L=this.i(k)>>>16,N=this.i(k)&65535,De=E.i(b)>>>16,Fe=E.i(b)&65535;C[2*k+2*b]+=N*Fe,I(C,2*k+2*b),C[2*k+2*b+1]+=L*Fe,I(C,2*k+2*b+1),C[2*k+2*b+1]+=N*De,I(C,2*k+2*b+1),C[2*k+2*b+2]+=L*De,I(C,2*k+2*b+2)}for(E=0;E<w;E++)C[E]=C[2*E+1]<<16|C[2*E];for(E=w;E<2*w;E++)C[E]=0;return new o(C,0)};function I(E,w){for(;(E[w]&65535)!=E[w];)E[w+1]+=E[w]>>>16,E[w]&=65535,w++}function P(E,w){this.g=E,this.h=w}function V(E,w){if(T(w))throw Error("division by zero");if(T(E))return new P(m,m);if(A(E))return w=V(D(E),w),new P(D(w.g),D(w.h));if(A(w))return w=V(E,D(w)),new P(D(w.g),w.h);if(E.g.length>30){if(A(E)||A(w))throw Error("slowDivide_ only works with positive integers.");for(var C=g,k=w;k.l(E)<=0;)C=U(C),k=U(k);var b=O(C,1),L=O(k,1);for(k=O(k,2),C=O(C,2);!T(k);){var N=L.add(k);N.l(E)<=0&&(b=b.add(C),L=N),k=O(k,1),C=O(C,1)}return w=S(E,b.j(w)),new P(b,w)}for(b=m;E.l(w)>=0;){for(C=Math.max(1,Math.floor(E.m()/w.m())),k=Math.ceil(Math.log(C)/Math.LN2),k=k<=48?1:Math.pow(2,k-48),L=u(C),N=L.j(w);A(N)||N.l(E)>0;)C-=k,L=u(C),N=L.j(w);T(L)&&(L=g),b=b.add(L),E=S(E,N)}return new P(b,E)}t.B=function(E){return V(this,E).h},t.and=function(E){const w=Math.max(this.g.length,E.g.length),C=[];for(let k=0;k<w;k++)C[k]=this.i(k)&E.i(k);return new o(C,this.h&E.h)},t.or=function(E){const w=Math.max(this.g.length,E.g.length),C=[];for(let k=0;k<w;k++)C[k]=this.i(k)|E.i(k);return new o(C,this.h|E.h)},t.xor=function(E){const w=Math.max(this.g.length,E.g.length),C=[];for(let k=0;k<w;k++)C[k]=this.i(k)^E.i(k);return new o(C,this.h^E.h)};function U(E){const w=E.g.length+1,C=[];for(let k=0;k<w;k++)C[k]=E.i(k)<<1|E.i(k-1)>>>31;return new o(C,E.h)}function O(E,w){const C=w>>5;w%=32;const k=E.g.length-C,b=[];for(let L=0;L<k;L++)b[L]=w>0?E.i(L+C)>>>w|E.i(L+C+1)<<32-w:E.i(L+C);return new o(b,E.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,D0=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=f,Gi=o}).apply(typeof TE<"u"?TE:typeof self<"u"?self:typeof window<"u"?window:{});var zc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var b0,Pl,M0,pd,Rm,V0,L0,F0;(function(){var t,e=Object.defineProperty;function n(d){d=[typeof globalThis=="object"&&globalThis,d,typeof window=="object"&&window,typeof self=="object"&&self,typeof zc=="object"&&zc];for(var _=0;_<d.length;++_){var y=d[_];if(y&&y.Math==Math)return y}throw Error("Cannot find global object")}var r=n(this);function i(d,_){if(_)e:{var y=r;d=d.split(".");for(var x=0;x<d.length-1;x++){var G=d[x];if(!(G in y))break e;y=y[G]}d=d[d.length-1],x=y[d],_=_(x),_!=x&&_!=null&&e(y,d,{configurable:!0,writable:!0,value:_})}}i("Symbol.dispose",function(d){return d||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(d){return d||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(d){return d||function(_){var y=[],x;for(x in _)Object.prototype.hasOwnProperty.call(_,x)&&y.push([x,_[x]]);return y}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var s=s||{},o=this||self;function a(d){var _=typeof d;return _=="object"&&d!=null||_=="function"}function l(d,_,y){return d.call.apply(d.bind,arguments)}function u(d,_,y){return u=l,u.apply(null,arguments)}function f(d,_){var y=Array.prototype.slice.call(arguments,1);return function(){var x=y.slice();return x.push.apply(x,arguments),d.apply(this,x)}}function m(d,_){function y(){}y.prototype=_.prototype,d.Z=_.prototype,d.prototype=new y,d.prototype.constructor=d,d.Ob=function(x,G,$){for(var ie=Array(arguments.length-2),ke=2;ke<arguments.length;ke++)ie[ke-2]=arguments[ke];return _.prototype[G].apply(x,ie)}}var g=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?d=>d&&AsyncContext.Snapshot.wrap(d):d=>d;function v(d){const _=d.length;if(_>0){const y=Array(_);for(let x=0;x<_;x++)y[x]=d[x];return y}return[]}function T(d,_){for(let x=1;x<arguments.length;x++){const G=arguments[x];var y=typeof G;if(y=y!="object"?y:G?Array.isArray(G)?"array":y:"null",y=="array"||y=="object"&&typeof G.length=="number"){y=d.length||0;const $=G.length||0;d.length=y+$;for(let ie=0;ie<$;ie++)d[y+ie]=G[ie]}else d.push(G)}}class A{constructor(_,y){this.i=_,this.j=y,this.h=0,this.g=null}get(){let _;return this.h>0?(this.h--,_=this.g,this.g=_.next,_.next=null):_=this.i(),_}}function D(d){o.setTimeout(()=>{throw d},0)}function S(){var d=E;let _=null;return d.g&&(_=d.g,d.g=d.g.next,d.g||(d.h=null),_.next=null),_}class I{constructor(){this.h=this.g=null}add(_,y){const x=P.get();x.set(_,y),this.h?this.h.next=x:this.g=x,this.h=x}}var P=new A(()=>new V,d=>d.reset());class V{constructor(){this.next=this.g=this.h=null}set(_,y){this.h=_,this.g=y,this.next=null}reset(){this.next=this.g=this.h=null}}let U,O=!1,E=new I,w=()=>{const d=Promise.resolve(void 0);U=()=>{d.then(C)}};function C(){for(var d;d=S();){try{d.h.call(d.g)}catch(y){D(y)}var _=P;_.j(d),_.h<100&&(_.h++,d.next=_.g,_.g=d)}O=!1}function k(){this.u=this.u,this.C=this.C}k.prototype.u=!1,k.prototype.dispose=function(){this.u||(this.u=!0,this.N())},k.prototype[Symbol.dispose]=function(){this.dispose()},k.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function b(d,_){this.type=d,this.g=this.target=_,this.defaultPrevented=!1}b.prototype.h=function(){this.defaultPrevented=!0};var L=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var d=!1,_=Object.defineProperty({},"passive",{get:function(){d=!0}});try{const y=()=>{};o.addEventListener("test",y,_),o.removeEventListener("test",y,_)}catch{}return d}();function N(d){return/^[\s\xa0]*$/.test(d)}function De(d,_){b.call(this,d?d.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,d&&this.init(d,_)}m(De,b),De.prototype.init=function(d,_){const y=this.type=d.type,x=d.changedTouches&&d.changedTouches.length?d.changedTouches[0]:null;this.target=d.target||d.srcElement,this.g=_,_=d.relatedTarget,_||(y=="mouseover"?_=d.fromElement:y=="mouseout"&&(_=d.toElement)),this.relatedTarget=_,x?(this.clientX=x.clientX!==void 0?x.clientX:x.pageX,this.clientY=x.clientY!==void 0?x.clientY:x.pageY,this.screenX=x.screenX||0,this.screenY=x.screenY||0):(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0),this.button=d.button,this.key=d.key||"",this.ctrlKey=d.ctrlKey,this.altKey=d.altKey,this.shiftKey=d.shiftKey,this.metaKey=d.metaKey,this.pointerId=d.pointerId||0,this.pointerType=d.pointerType,this.state=d.state,this.i=d,d.defaultPrevented&&De.Z.h.call(this)},De.prototype.h=function(){De.Z.h.call(this);const d=this.i;d.preventDefault?d.preventDefault():d.returnValue=!1};var Fe="closure_listenable_"+(Math.random()*1e6|0),We=0;function Ee(d,_,y,x,G){this.listener=d,this.proxy=null,this.src=_,this.type=y,this.capture=!!x,this.ha=G,this.key=++We,this.da=this.fa=!1}function ne(d){d.da=!0,d.listener=null,d.proxy=null,d.src=null,d.ha=null}function ce(d,_,y){for(const x in d)_.call(y,d[x],x,d)}function ye(d,_){for(const y in d)_.call(void 0,d[y],y,d)}function we(d){const _={};for(const y in d)_[y]=d[y];return _}const Pe="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function $e(d,_){let y,x;for(let G=1;G<arguments.length;G++){x=arguments[G];for(y in x)d[y]=x[y];for(let $=0;$<Pe.length;$++)y=Pe[$],Object.prototype.hasOwnProperty.call(x,y)&&(d[y]=x[y])}}function Ke(d){this.src=d,this.g={},this.h=0}Ke.prototype.add=function(d,_,y,x,G){const $=d.toString();d=this.g[$],d||(d=this.g[$]=[],this.h++);const ie=lt(d,_,x,G);return ie>-1?(_=d[ie],y||(_.fa=!1)):(_=new Ee(_,this.src,$,!!x,G),_.fa=y,d.push(_)),_};function Mt(d,_){const y=_.type;if(y in d.g){var x=d.g[y],G=Array.prototype.indexOf.call(x,_,void 0),$;($=G>=0)&&Array.prototype.splice.call(x,G,1),$&&(ne(_),d.g[y].length==0&&(delete d.g[y],d.h--))}}function lt(d,_,y,x){for(let G=0;G<d.length;++G){const $=d[G];if(!$.da&&$.listener==_&&$.capture==!!y&&$.ha==x)return G}return-1}var ge="closure_lm_"+(Math.random()*1e6|0),tn={};function Tn(d,_,y,x,G){if(Array.isArray(_)){for(let $=0;$<_.length;$++)Tn(d,_[$],y,x,G);return null}return y=ut(y),d&&d[Fe]?d.J(_,y,a(x)?!!x.capture:!1,G):Mn(d,_,y,!1,x,G)}function Mn(d,_,y,x,G,$){if(!_)throw Error("Invalid event type");const ie=a(G)?!!G.capture:!!G;let ke=At(d);if(ke||(d[ge]=ke=new Ke(d)),y=ke.add(_,y,x,ie,$),y.proxy)return y;if(x=cr(),y.proxy=x,x.src=d,x.listener=y,d.addEventListener)L||(G=ie),G===void 0&&(G=!1),d.addEventListener(_.toString(),x,G);else if(d.attachEvent)d.attachEvent(Pr(_.toString()),x);else if(d.addListener&&d.removeListener)d.addListener(x);else throw Error("addEventListener and attachEvent are unavailable.");return y}function cr(){function d(y){return _.call(d.src,d.listener,y)}const _=Me;return d}function dr(d,_,y,x,G){if(Array.isArray(_))for(var $=0;$<_.length;$++)dr(d,_[$],y,x,G);else x=a(x)?!!x.capture:!!x,y=ut(y),d&&d[Fe]?(d=d.i,$=String(_).toString(),$ in d.g&&(_=d.g[$],y=lt(_,y,x,G),y>-1&&(ne(_[y]),Array.prototype.splice.call(_,y,1),_.length==0&&(delete d.g[$],d.h--)))):d&&(d=At(d))&&(_=d.g[_.toString()],d=-1,_&&(d=lt(_,y,x,G)),(y=d>-1?_[d]:null)&&dn(y))}function dn(d){if(typeof d!="number"&&d&&!d.da){var _=d.src;if(_&&_[Fe])Mt(_.i,d);else{var y=d.type,x=d.proxy;_.removeEventListener?_.removeEventListener(y,x,d.capture):_.detachEvent?_.detachEvent(Pr(y),x):_.addListener&&_.removeListener&&_.removeListener(x),(y=At(_))?(Mt(y,d),y.h==0&&(y.src=null,_[ge]=null)):ne(d)}}}function Pr(d){return d in tn?tn[d]:tn[d]="on"+d}function Me(d,_){if(d.da)d=!0;else{_=new De(_,this);const y=d.listener,x=d.ha||d.src;d.fa&&dn(d),d=y.call(x,_)}return d}function At(d){return d=d[ge],d instanceof Ke?d:null}var qe="__closure_events_fn_"+(Math.random()*1e9>>>0);function ut(d){return typeof d=="function"?d:(d[qe]||(d[qe]=function(_){return d.handleEvent(_)}),d[qe])}function le(){k.call(this),this.i=new Ke(this),this.M=this,this.G=null}m(le,k),le.prototype[Fe]=!0,le.prototype.removeEventListener=function(d,_,y,x){dr(this,d,_,y,x)};function Vt(d,_){var y,x=d.G;if(x)for(y=[];x;x=x.G)y.push(x);if(d=d.M,x=_.type||_,typeof _=="string")_=new b(_,d);else if(_ instanceof b)_.target=_.target||d;else{var G=_;_=new b(x,d),$e(_,G)}G=!0;let $,ie;if(y)for(ie=y.length-1;ie>=0;ie--)$=_.g=y[ie],G=ii($,x,!0,_)&&G;if($=_.g=d,G=ii($,x,!0,_)&&G,G=ii($,x,!1,_)&&G,y)for(ie=0;ie<y.length;ie++)$=_.g=y[ie],G=ii($,x,!1,_)&&G}le.prototype.N=function(){if(le.Z.N.call(this),this.i){var d=this.i;for(const _ in d.g){const y=d.g[_];for(let x=0;x<y.length;x++)ne(y[x]);delete d.g[_],d.h--}}this.G=null},le.prototype.J=function(d,_,y,x){return this.i.add(String(d),_,!1,y,x)},le.prototype.K=function(d,_,y,x){return this.i.add(String(d),_,!0,y,x)};function ii(d,_,y,x){if(_=d.i.g[String(_)],!_)return!0;_=_.concat();let G=!0;for(let $=0;$<_.length;++$){const ie=_[$];if(ie&&!ie.da&&ie.capture==y){const ke=ie.listener,xt=ie.ha||ie.src;ie.fa&&Mt(d.i,ie),G=ke.call(xt,x)!==!1&&G}}return G&&!x.defaultPrevented}function ls(d,_){if(typeof d!="function")if(d&&typeof d.handleEvent=="function")d=u(d.handleEvent,d);else throw Error("Invalid listener argument");return Number(_)>2147483647?-1:o.setTimeout(d,_||0)}function us(d){d.g=ls(()=>{d.g=null,d.i&&(d.i=!1,us(d))},d.l);const _=d.h;d.h=null,d.m.apply(null,_)}class fo extends k{constructor(_,y){super(),this.m=_,this.l=y,this.h=null,this.i=!1,this.g=null}j(_){this.h=arguments,this.g?this.i=!0:us(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Re(d){k.call(this),this.h=d,this.g={}}m(Re,k);var oc=[];function kr(d){ce(d.g,function(_,y){this.g.hasOwnProperty(y)&&dn(_)},d),d.g={}}Re.prototype.N=function(){Re.Z.N.call(this),kr(this)},Re.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var cs=o.JSON.stringify,za=o.JSON.parse,ac=class{stringify(d){return o.JSON.stringify(d,void 0)}parse(d){return o.JSON.parse(d,void 0)}};function $a(){}function lc(){}var ds={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Ha(){b.call(this,"d")}m(Ha,b);function hs(){b.call(this,"c")}m(hs,b);var En={},fs=null;function po(){return fs=fs||new le}En.Ia="serverreachability";function Wa(d){b.call(this,En.Ia,d)}m(Wa,b);function Vn(d){const _=po();Vt(_,new Wa(_))}En.STAT_EVENT="statevent";function ps(d,_){b.call(this,En.STAT_EVENT,d),this.stat=_}m(ps,b);function yt(d){const _=po();Vt(_,new ps(_,d))}En.Ja="timingevent";function uc(d,_){b.call(this,En.Ja,d),this.size=_}m(uc,b);function hr(d,_){if(typeof d!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){d()},_)}function ms(){this.g=!0}ms.prototype.ua=function(){this.g=!1};function Y(d,_,y,x,G,$){d.info(function(){if(d.g)if($){var ie="",ke=$.split("&");for(let Xe=0;Xe<ke.length;Xe++){var xt=ke[Xe].split("=");if(xt.length>1){const Lt=xt[0];xt=xt[1];const mr=Lt.split("_");ie=mr.length>=2&&mr[1]=="type"?ie+(Lt+"="+xt+"&"):ie+(Lt+"=redacted&")}}}else ie=null;else ie=$;return"XMLHTTP REQ ("+x+") [attempt "+G+"]: "+_+`
`+y+`
`+ie})}function Ka(d,_,y,x,G,$,ie){d.info(function(){return"XMLHTTP RESP ("+x+") [ attempt "+G+"]: "+_+`
`+y+`
`+$+" "+ie})}function gs(d,_,y,x){d.info(function(){return"XMLHTTP TEXT ("+_+"): "+ly(d,y)+(x?" "+x:"")})}function ay(d,_){d.info(function(){return"TIMEOUT: "+_})}ms.prototype.info=function(){};function ly(d,_){if(!d.g)return _;if(!_)return null;try{const $=JSON.parse(_);if($){for(d=0;d<$.length;d++)if(Array.isArray($[d])){var y=$[d];if(!(y.length<2)){var x=y[1];if(Array.isArray(x)&&!(x.length<1)){var G=x[0];if(G!="noop"&&G!="stop"&&G!="close")for(let ie=1;ie<x.length;ie++)x[ie]=""}}}}return cs($)}catch{return _}}var ja={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},cc={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},mo;function Ja(){}m(Ja,$a),Ja.prototype.g=function(){return new XMLHttpRequest},mo=new Ja;function Nr(d){return encodeURIComponent(String(d))}function Qa(d){var _=1;d=d.split(":");const y=[];for(;_>0&&d.length;)y.push(d.shift()),_--;return d.length&&y.push(d.join(":")),y}function It(d,_,y,x){this.j=d,this.i=_,this.l=y,this.S=x||1,this.V=new Re(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new dc}function dc(){this.i=null,this.g="",this.h=!1}var Ya={},_s={};function Xa(d,_,y){d.M=1,d.A=yo(Fn(_)),d.u=y,d.R=!0,hc(d,null)}function hc(d,_){d.F=Date.now(),Dr(d),d.B=Fn(d.A);var y=d.B,x=d.S;Array.isArray(x)||(x=[String(x)]),Tc(y.i,"t",x),d.C=0,y=d.j.L,d.h=new dc,d.g=py(d.j,y?_:null,!d.u),d.P>0&&(d.O=new fo(u(d.Y,d,d.g),d.P)),_=d.V,y=d.g,x=d.ba;var G="readystatechange";Array.isArray(G)||(G&&(oc[0]=G.toString()),G=oc);for(let $=0;$<G.length;$++){const ie=Tn(y,G[$],x||_.handleEvent,!1,_.h||_);if(!ie)break;_.g[ie.key]=ie}_=d.J?we(d.J):{},d.u?(d.v||(d.v="POST"),_["Content-Type"]="application/x-www-form-urlencoded",d.g.ea(d.B,d.v,d.u,_)):(d.v="GET",d.g.ea(d.B,d.v,null,_)),Vn(),Y(d.i,d.v,d.B,d.l,d.S,d.u)}It.prototype.ba=function(d){d=d.target;const _=this.O;_&&Ze(d)==3?_.j():this.Y(d)},It.prototype.Y=function(d){try{if(d==this.g)e:{const ke=Ze(this.g),xt=this.g.ya(),Xe=this.g.ca();if(!(ke<3)&&(ke!=3||this.g&&(this.h.h||this.g.la()||ct(this.g)))){this.K||ke!=4||xt==7||(xt==8||Xe<=0?Vn(3):Vn(2)),el(this);var _=this.g.ca();this.X=_;var y=Za(this);if(this.o=_==200,Ka(this.i,this.v,this.B,this.l,this.S,ke,_),this.o){if(this.U&&!this.L){t:{if(this.g){var x,G=this.g;if((x=G.g?G.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!N(x)){var $=x;break t}}$=null}if(d=$)gs(this.i,this.l,d,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,tl(this,d);else{this.o=!1,this.m=3,yt(12),Ln(this),se(this);break e}}if(this.R){d=!0;let Lt;for(;!this.K&&this.C<y.length;)if(Lt=yf(this,y),Lt==_s){ke==4&&(this.m=4,yt(14),d=!1),gs(this.i,this.l,null,"[Incomplete Response]");break}else if(Lt==Ya){this.m=4,yt(15),gs(this.i,this.l,y,"[Invalid Chunk]"),d=!1;break}else gs(this.i,this.l,Lt,null),tl(this,Lt);if(fc(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ke!=4||y.length!=0||this.h.h||(this.m=1,yt(16),d=!1),this.o=this.o&&d,!d)gs(this.i,this.l,y,"[Invalid Chunked Response]"),Ln(this),se(this);else if(y.length>0&&!this.W){this.W=!0;var ie=this.j;ie.g==this&&ie.aa&&!ie.P&&(ie.j.info("Great, no buffering proxy detected. Bytes received: "+y.length),Pf(ie),ie.P=!0,yt(11))}}else gs(this.i,this.l,y,null),tl(this,y);ke==4&&Ln(this),this.o&&!this.K&&(ke==4?cy(this.j,this):(this.o=!1,Dr(this)))}else Es(this.g),_==400&&y.indexOf("Unknown SID")>0?(this.m=3,yt(12)):(this.m=0,yt(13)),Ln(this),se(this)}}}catch{}finally{}};function Za(d){if(!fc(d))return d.g.la();const _=ct(d.g);if(_==="")return"";let y="";const x=_.length,G=Ze(d.g)==4;if(!d.h.i){if(typeof TextDecoder>"u")return Ln(d),se(d),"";d.h.i=new o.TextDecoder}for(let $=0;$<x;$++)d.h.h=!0,y+=d.h.i.decode(_[$],{stream:!(G&&$==x-1)});return _.length=0,d.h.g+=y,d.C=0,d.h.g}function fc(d){return d.g?d.v=="GET"&&d.M!=2&&d.j.Aa:!1}function yf(d,_){var y=d.C,x=_.indexOf(`
`,y);return x==-1?_s:(y=Number(_.substring(y,x)),isNaN(y)?Ya:(x+=1,x+y>_.length?_s:(_=_.slice(x,x+y),d.C=x+y,_)))}It.prototype.cancel=function(){this.K=!0,Ln(this)};function Dr(d){d.T=Date.now()+d.H,go(d,d.H)}function go(d,_){if(d.D!=null)throw Error("WatchDog timer not null");d.D=hr(u(d.aa,d),_)}function el(d){d.D&&(o.clearTimeout(d.D),d.D=null)}It.prototype.aa=function(){this.D=null;const d=Date.now();d-this.T>=0?(ay(this.i,this.B),this.M!=2&&(Vn(),yt(17)),Ln(this),this.m=2,se(this)):go(this,this.T-d)};function se(d){d.j.I==0||d.K||cy(d.j,d)}function Ln(d){el(d);var _=d.O;_&&typeof _.dispose=="function"&&_.dispose(),d.O=null,kr(d.V),d.g&&(_=d.g,d.g=null,_.abort(),_.dispose())}function tl(d,_){try{var y=d.j;if(y.I!=0&&(y.g==d||rl(y.h,d))){if(!d.L&&rl(y.h,d)&&y.I==3){try{var x=y.Ba.g.parse(_)}catch{x=null}if(Array.isArray(x)&&x.length==3){var G=x;if(G[0]==0){e:if(!y.v){if(y.g)if(y.g.F+3e3<d.F)Ic(y),hn(y);else break e;Rf(y),yt(18)}}else y.xa=G[1],0<y.xa-y.K&&G[2]<37500&&y.F&&y.A==0&&!y.C&&(y.C=hr(u(y.Va,y),6e3));_o(y.h)<=1&&y.ta&&(y.ta=void 0)}else Is(y,11)}else if((d.L||y.g==d)&&Ic(y),!N(_))for(G=y.Ba.g.parse(_),_=0;_<G.length;_++){let Xe=G[_];const Lt=Xe[0];if(!(Lt<=y.K))if(y.K=Lt,Xe=Xe[1],y.I==2)if(Xe[0]=="c"){y.M=Xe[1],y.ba=Xe[2];const mr=Xe[3];mr!=null&&(y.ka=mr,y.j.info("VER="+y.ka));const ws=Xe[4];ws!=null&&(y.za=ws,y.j.info("SVER="+y.za));const ui=Xe[5];ui!=null&&typeof ui=="number"&&ui>0&&(x=1.5*ui,y.O=x,y.j.info("backChannelRequestTimeoutMs_="+x)),x=y;const ci=d.g;if(ci){const Sc=ci.g?ci.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Sc){var $=x.h;$.g||Sc.indexOf("spdy")==-1&&Sc.indexOf("quic")==-1&&Sc.indexOf("h2")==-1||($.j=$.l,$.g=new Set,$.h&&(il($,$.h),$.h=null))}if(x.G){const kf=ci.g?ci.g.getResponseHeader("X-HTTP-Session-Id"):null;kf&&(x.wa=kf,Ye(x.J,x.G,kf))}}y.I=3,y.l&&y.l.ra(),y.aa&&(y.T=Date.now()-d.F,y.j.info("Handshake RTT: "+y.T+"ms")),x=y;var ie=d;if(x.na=fy(x,x.L?x.ba:null,x.W),ie.L){sl(x.h,ie);var ke=ie,xt=x.O;xt&&(ke.H=xt),ke.D&&(el(ke),Dr(ke)),x.g=ie}else cl(x);y.i.length>0&&vo(y)}else Xe[0]!="stop"&&Xe[0]!="close"||Is(y,7);else y.I==3&&(Xe[0]=="stop"||Xe[0]=="close"?Xe[0]=="stop"?Is(y,7):pr(y):Xe[0]!="noop"&&y.l&&y.l.qa(Xe),y.A=0)}}Vn(4)}catch{}}var nl=class{constructor(d,_){this.g=d,this.map=_}};function pc(d){this.l=d||10,o.PerformanceNavigationTiming?(d=o.performance.getEntriesByType("navigation"),d=d.length>0&&(d[0].nextHopProtocol=="hq"||d[0].nextHopProtocol=="h2")):d=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=d?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function si(d){return d.h?!0:d.g?d.g.size>=d.j:!1}function _o(d){return d.h?1:d.g?d.g.size:0}function rl(d,_){return d.h?d.h==_:d.g?d.g.has(_):!1}function il(d,_){d.g?d.g.add(_):d.h=_}function sl(d,_){d.h&&d.h==_?d.h=null:d.g&&d.g.has(_)&&d.g.delete(_)}pc.prototype.cancel=function(){if(this.i=mc(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const d of this.g.values())d.cancel();this.g.clear()}};function mc(d){if(d.h!=null)return d.i.concat(d.h.G);if(d.g!=null&&d.g.size!==0){let _=d.i;for(const y of d.g.values())_=_.concat(y.G);return _}return v(d.i)}var gc=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ol(d,_){if(d){d=d.split("&");for(let y=0;y<d.length;y++){const x=d[y].indexOf("=");let G,$=null;x>=0?(G=d[y].substring(0,x),$=d[y].substring(x+1)):G=d[y],_(G,$?decodeURIComponent($.replace(/\+/g," ")):"")}}}function fr(d){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let _;d instanceof fr?(this.l=d.l,oi(this,d.j),this.o=d.o,this.g=d.g,ai(this,d.u),this.h=d.h,al(this,Ec(d.i)),this.m=d.m):d&&(_=String(d).match(gc))?(this.l=!1,oi(this,_[1]||"",!0),this.o=ys(_[2]||""),this.g=ys(_[3]||"",!0),ai(this,_[4]),this.h=ys(_[5]||"",!0),al(this,_[6]||"",!0),this.m=ys(_[7]||"")):(this.l=!1,this.i=new Ts(null,this.l))}fr.prototype.toString=function(){const d=[];var _=this.j;_&&d.push(vs(_,_c,!0),":");var y=this.g;return(y||_=="file")&&(d.push("//"),(_=this.o)&&d.push(vs(_,_c,!0),"@"),d.push(Nr(y).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y=this.u,y!=null&&d.push(":",String(y))),(y=this.h)&&(this.g&&y.charAt(0)!="/"&&d.push("/"),d.push(vs(y,y.charAt(0)=="/"?Ef:Tf,!0))),(y=this.i.toString())&&d.push("?",y),(y=this.m)&&d.push("#",vs(y,wf)),d.join("")},fr.prototype.resolve=function(d){const _=Fn(this);let y=!!d.j;y?oi(_,d.j):y=!!d.o,y?_.o=d.o:y=!!d.g,y?_.g=d.g:y=d.u!=null;var x=d.h;if(y)ai(_,d.u);else if(y=!!d.h){if(x.charAt(0)!="/")if(this.g&&!this.h)x="/"+x;else{var G=_.h.lastIndexOf("/");G!=-1&&(x=_.h.slice(0,G+1)+x)}if(G=x,G==".."||G==".")x="";else if(G.indexOf("./")!=-1||G.indexOf("/.")!=-1){x=G.lastIndexOf("/",0)==0,G=G.split("/");const $=[];for(let ie=0;ie<G.length;){const ke=G[ie++];ke=="."?x&&ie==G.length&&$.push(""):ke==".."?(($.length>1||$.length==1&&$[0]!="")&&$.pop(),x&&ie==G.length&&$.push("")):($.push(ke),x=!0)}x=$.join("/")}else x=G}return y?_.h=x:y=d.i.toString()!=="",y?al(_,Ec(d.i)):y=!!d.m,y&&(_.m=d.m),_};function Fn(d){return new fr(d)}function oi(d,_,y){d.j=y?ys(_,!0):_,d.j&&(d.j=d.j.replace(/:$/,""))}function ai(d,_){if(_){if(_=Number(_),isNaN(_)||_<0)throw Error("Bad port number "+_);d.u=_}else d.u=null}function al(d,_,y){_ instanceof Ts?(d.i=_,Sf(d.i,d.l)):(y||(_=vs(_,If)),d.i=new Ts(_,d.l))}function Ye(d,_,y){d.i.set(_,y)}function yo(d){return Ye(d,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),d}function ys(d,_){return d?_?decodeURI(d.replace(/%25/g,"%2525")):decodeURIComponent(d):""}function vs(d,_,y){return typeof d=="string"?(d=encodeURI(d).replace(_,vf),y&&(d=d.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d):null}function vf(d){return d=d.charCodeAt(0),"%"+(d>>4&15).toString(16)+(d&15).toString(16)}var _c=/[#\/\?@]/g,Tf=/[#\?:]/g,Ef=/[#\?]/g,If=/[#\?@]/g,wf=/#/g;function Ts(d,_){this.h=this.g=null,this.i=d||null,this.j=!!_}function br(d){d.g||(d.g=new Map,d.h=0,d.i&&ol(d.i,function(_,y){d.add(decodeURIComponent(_.replace(/\+/g," ")),y)}))}t=Ts.prototype,t.add=function(d,_){br(this),this.i=null,d=li(this,d);let y=this.g.get(d);return y||this.g.set(d,y=[]),y.push(_),this.h+=1,this};function yc(d,_){br(d),_=li(d,_),d.g.has(_)&&(d.i=null,d.h-=d.g.get(_).length,d.g.delete(_))}function ll(d,_){return br(d),_=li(d,_),d.g.has(_)}t.forEach=function(d,_){br(this),this.g.forEach(function(y,x){y.forEach(function(G){d.call(_,G,x,this)},this)},this)};function vc(d,_){br(d);let y=[];if(typeof _=="string")ll(d,_)&&(y=y.concat(d.g.get(li(d,_))));else for(d=Array.from(d.g.values()),_=0;_<d.length;_++)y=y.concat(d[_]);return y}t.set=function(d,_){return br(this),this.i=null,d=li(this,d),ll(this,d)&&(this.h-=this.g.get(d).length),this.g.set(d,[_]),this.h+=1,this},t.get=function(d,_){return d?(d=vc(this,d),d.length>0?String(d[0]):_):_};function Tc(d,_,y){yc(d,_),y.length>0&&(d.i=null,d.g.set(li(d,_),v(y)),d.h+=y.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const d=[],_=Array.from(this.g.keys());for(let x=0;x<_.length;x++){var y=_[x];const G=Nr(y);y=vc(this,y);for(let $=0;$<y.length;$++){let ie=G;y[$]!==""&&(ie+="="+Nr(y[$])),d.push(ie)}}return this.i=d.join("&")};function Ec(d){const _=new Ts;return _.i=d.i,d.g&&(_.g=new Map(d.g),_.h=d.h),_}function li(d,_){return _=String(_),d.j&&(_=_.toLowerCase()),_}function Sf(d,_){_&&!d.j&&(br(d),d.i=null,d.g.forEach(function(y,x){const G=x.toLowerCase();x!=G&&(yc(this,x),Tc(this,G,y))},d)),d.j=_}function Cf(d,_){const y=new ms;if(o.Image){const x=new Image;x.onload=f(R,y,"TestLoadImage: loaded",!0,_,x),x.onerror=f(R,y,"TestLoadImage: error",!1,_,x),x.onabort=f(R,y,"TestLoadImage: abort",!1,_,x),x.ontimeout=f(R,y,"TestLoadImage: timeout",!1,_,x),o.setTimeout(function(){x.ontimeout&&x.ontimeout()},1e4),x.src=d}else _(!1)}function Af(d,_){const y=new ms,x=new AbortController,G=setTimeout(()=>{x.abort(),R(y,"TestPingServer: timeout",!1,_)},1e4);fetch(d,{signal:x.signal}).then($=>{clearTimeout(G),$.ok?R(y,"TestPingServer: ok",!0,_):R(y,"TestPingServer: server error",!1,_)}).catch(()=>{clearTimeout(G),R(y,"TestPingServer: error",!1,_)})}function R(d,_,y,x,G){try{G&&(G.onload=null,G.onerror=null,G.onabort=null,G.ontimeout=null),x(y)}catch{}}function M(){this.g=new ac}function F(d){this.i=d.Sb||null,this.h=d.ab||!1}m(F,$a),F.prototype.g=function(){return new B(this.i,this.h)};function B(d,_){le.call(this),this.H=d,this.o=_,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}m(B,le),t=B.prototype,t.open=function(d,_){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=d,this.D=_,this.readyState=1,J(this)},t.send=function(d){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const _={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};d&&(_.body=d),(this.H||o).fetch(new Request(this.D,_)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Q(this)),this.readyState=0},t.Pa=function(d){if(this.g&&(this.l=d,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=d.headers,this.readyState=2,J(this)),this.g&&(this.readyState=3,J(this),this.g)))if(this.responseType==="arraybuffer")d.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in d){if(this.j=d.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;H(this)}else d.text().then(this.Oa.bind(this),this.ga.bind(this))};function H(d){d.j.read().then(d.Ma.bind(d)).catch(d.ga.bind(d))}t.Ma=function(d){if(this.g){if(this.o&&d.value)this.response.push(d.value);else if(!this.o){var _=d.value?d.value:new Uint8Array(0);(_=this.B.decode(_,{stream:!d.done}))&&(this.response=this.responseText+=_)}d.done?Q(this):J(this),this.readyState==3&&H(this)}},t.Oa=function(d){this.g&&(this.response=this.responseText=d,Q(this))},t.Na=function(d){this.g&&(this.response=d,Q(this))},t.ga=function(){this.g&&Q(this)};function Q(d){d.readyState=4,d.l=null,d.j=null,d.B=null,J(d)}t.setRequestHeader=function(d,_){this.A.append(d,_)},t.getResponseHeader=function(d){return this.h&&this.h.get(d.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const d=[],_=this.h.entries();for(var y=_.next();!y.done;)y=y.value,d.push(y[0]+": "+y[1]),y=_.next();return d.join(`\r
`)};function J(d){d.onreadystatechange&&d.onreadystatechange.call(d)}Object.defineProperty(B.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(d){this.m=d?"include":"same-origin"}});function Z(d){let _="";return ce(d,function(y,x){_+=x,_+=":",_+=y,_+=`\r
`}),_}function W(d,_,y){e:{for(x in y){var x=!1;break e}x=!0}x||(y=Z(y),typeof d=="string"?y!=null&&Nr(y):Ye(d,_,y))}function X(d){le.call(this),this.headers=new Map,this.L=d||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}m(X,le);var j=/^https?$/i,fe=["POST","PUT"];t=X.prototype,t.Fa=function(d){this.H=d},t.ea=function(d,_,y,x){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+d);_=_?_.toUpperCase():"GET",this.D=d,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():mo.g(),this.g.onreadystatechange=g(u(this.Ca,this));try{this.B=!0,this.g.open(_,String(d),!0),this.B=!1}catch($){Te(this,$);return}if(d=y||"",y=new Map(this.headers),x)if(Object.getPrototypeOf(x)===Object.prototype)for(var G in x)y.set(G,x[G]);else if(typeof x.keys=="function"&&typeof x.get=="function")for(const $ of x.keys())y.set($,x.get($));else throw Error("Unknown input type for opt_headers: "+String(x));x=Array.from(y.keys()).find($=>$.toLowerCase()=="content-type"),G=o.FormData&&d instanceof o.FormData,!(Array.prototype.indexOf.call(fe,_,void 0)>=0)||x||G||y.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[$,ie]of y)this.g.setRequestHeader($,ie);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(d),this.v=!1}catch($){Te(this,$)}};function Te(d,_){d.h=!1,d.g&&(d.j=!0,d.g.abort(),d.j=!1),d.l=_,d.o=5,me(d),Ie(d)}function me(d){d.A||(d.A=!0,Vt(d,"complete"),Vt(d,"error"))}t.abort=function(d){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=d||7,Vt(this,"complete"),Vt(this,"abort"),Ie(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ie(this,!0)),X.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?oe(this):this.Xa())},t.Xa=function(){oe(this)};function oe(d){if(d.h&&typeof s<"u"){if(d.v&&Ze(d)==4)setTimeout(d.Ca.bind(d),0);else if(Vt(d,"readystatechange"),Ze(d)==4){d.h=!1;try{const $=d.ca();e:switch($){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var _=!0;break e;default:_=!1}var y;if(!(y=_)){var x;if(x=$===0){let ie=String(d.D).match(gc)[1]||null;!ie&&o.self&&o.self.location&&(ie=o.self.location.protocol.slice(0,-1)),x=!j.test(ie?ie.toLowerCase():"")}y=x}if(y)Vt(d,"complete"),Vt(d,"success");else{d.o=6;try{var G=Ze(d)>2?d.g.statusText:""}catch{G=""}d.l=G+" ["+d.ca()+"]",me(d)}}finally{Ie(d)}}}}function Ie(d,_){if(d.g){d.m&&(clearTimeout(d.m),d.m=null);const y=d.g;d.g=null,_||Vt(d,"ready");try{y.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function Ze(d){return d.g?d.g.readyState:0}t.ca=function(){try{return Ze(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(d){if(this.g){var _=this.g.responseText;return d&&_.indexOf(d)==0&&(_=_.substring(d.length)),za(_)}};function ct(d){try{if(!d.g)return null;if("response"in d.g)return d.g.response;switch(d.F){case"":case"text":return d.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in d.g)return d.g.mozResponseArrayBuffer}return null}catch{return null}}function Es(d){const _={};d=(d.g&&Ze(d)>=2&&d.g.getAllResponseHeaders()||"").split(`\r
`);for(let x=0;x<d.length;x++){if(N(d[x]))continue;var y=Qa(d[x]);const G=y[0];if(y=y[1],typeof y!="string")continue;y=y.trim();const $=_[G]||[];_[G]=$,$.push(y)}ye(_,function(x){return x.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Un(d,_,y){return y&&y.internalChannelParams&&y.internalChannelParams[d]||_}function In(d){this.za=0,this.i=[],this.j=new ms,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Un("failFast",!1,d),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Un("baseRetryDelayMs",5e3,d),this.Za=Un("retryDelaySeedMs",1e4,d),this.Ta=Un("forwardChannelMaxRetries",2,d),this.va=Un("forwardChannelRequestTimeoutMs",2e4,d),this.ma=d&&d.xmlHttpFactory||void 0,this.Ua=d&&d.Rb||void 0,this.Aa=d&&d.useFetchStreams||!1,this.O=void 0,this.L=d&&d.supportsCrossDomainXhr||!1,this.M="",this.h=new pc(d&&d.concurrentRequestLimit),this.Ba=new M,this.S=d&&d.fastHandshake||!1,this.R=d&&d.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=d&&d.Pb||!1,d&&d.ua&&this.j.ua(),d&&d.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&d&&d.detectBufferingProxy||!1,this.ia=void 0,d&&d.longPollingTimeout&&d.longPollingTimeout>0&&(this.ia=d.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=In.prototype,t.ka=8,t.I=1,t.connect=function(d,_,y,x){yt(0),this.W=d,this.H=_||{},y&&x!==void 0&&(this.H.OSID=y,this.H.OAID=x),this.F=this.X,this.J=fy(this,null,this.W),vo(this)};function pr(d){if(fn(d),d.I==3){var _=d.V++,y=Fn(d.J);if(Ye(y,"SID",d.M),Ye(y,"RID",_),Ye(y,"TYPE","terminate"),On(d,y),_=new It(d,d.j,_),_.M=2,_.A=yo(Fn(y)),y=!1,o.navigator&&o.navigator.sendBeacon)try{y=o.navigator.sendBeacon(_.A.toString(),"")}catch{}!y&&o.Image&&(new Image().src=_.A,y=!0),y||(_.g=py(_.j,null),_.g.ea(_.A)),_.F=Date.now(),Dr(_)}hy(d)}function hn(d){d.g&&(Pf(d),d.g.cancel(),d.g=null)}function fn(d){hn(d),d.v&&(o.clearTimeout(d.v),d.v=null),Ic(d),d.h.cancel(),d.m&&(typeof d.m=="number"&&o.clearTimeout(d.m),d.m=null)}function vo(d){if(!si(d.h)&&!d.m){d.m=!0;var _=d.Ea;U||w(),O||(U(),O=!0),E.add(_,d),d.D=0}}function ul(d,_){return _o(d.h)>=d.h.j-(d.m?1:0)?!1:d.m?(d.i=_.G.concat(d.i),!0):d.I==1||d.I==2||d.D>=(d.Sa?0:d.Ta)?!1:(d.m=hr(u(d.Ea,d,_),dy(d,d.D)),d.D++,!0)}t.Ea=function(d){if(this.m)if(this.m=null,this.I==1){if(!d){this.V=Math.floor(Math.random()*1e5),d=this.V++;const G=new It(this,this.j,d);let $=this.o;if(this.U&&($?($=we($),$e($,this.U)):$=this.U),this.u!==null||this.R||(G.J=$,$=null),this.S)e:{for(var _=0,y=0;y<this.i.length;y++){t:{var x=this.i[y];if("__data__"in x.map&&(x=x.map.__data__,typeof x=="string")){x=x.length;break t}x=void 0}if(x===void 0)break;if(_+=x,_>4096){_=y;break e}if(_===4096||y===this.i.length-1){_=y+1;break e}}_=1e3}else _=1e3;_=To(this,G,_),y=Fn(this.J),Ye(y,"RID",d),Ye(y,"CVER",22),this.G&&Ye(y,"X-HTTP-Session-Id",this.G),On(this,y),$&&(this.R?_="headers="+Nr(Z($))+"&"+_:this.u&&W(y,this.u,$)),il(this.h,G),this.Ra&&Ye(y,"TYPE","init"),this.S?(Ye(y,"$req",_),Ye(y,"SID","null"),G.U=!0,Xa(G,y,null)):Xa(G,y,_),this.I=2}}else this.I==3&&(d?xf(this,d):this.i.length==0||si(this.h)||xf(this))};function xf(d,_){var y;_?y=_.l:y=d.V++;const x=Fn(d.J);Ye(x,"SID",d.M),Ye(x,"RID",y),Ye(x,"AID",d.K),On(d,x),d.u&&d.o&&W(x,d.u,d.o),y=new It(d,d.j,y,d.D+1),d.u===null&&(y.J=d.o),_&&(d.i=_.G.concat(d.i)),_=To(d,y,1e3),y.H=Math.round(d.va*.5)+Math.round(d.va*.5*Math.random()),il(d.h,y),Xa(y,x,_)}function On(d,_){d.H&&ce(d.H,function(y,x){Ye(_,x,y)}),d.l&&ce({},function(y,x){Ye(_,x,y)})}function To(d,_,y){y=Math.min(d.i.length,y);const x=d.l?u(d.l.Ka,d.l,d):null;e:{var G=d.i;let ke=-1;for(;;){const xt=["count="+y];ke==-1?y>0?(ke=G[0].g,xt.push("ofs="+ke)):ke=0:xt.push("ofs="+ke);let Xe=!0;for(let Lt=0;Lt<y;Lt++){var $=G[Lt].g;const mr=G[Lt].map;if($-=ke,$<0)ke=Math.max(0,G[Lt].g-100),Xe=!1;else try{$="req"+$+"_"||"";try{var ie=mr instanceof Map?mr:Object.entries(mr);for(const[ws,ui]of ie){let ci=ui;a(ui)&&(ci=cs(ui)),xt.push($+ws+"="+encodeURIComponent(ci))}}catch(ws){throw xt.push($+"type="+encodeURIComponent("_badmap")),ws}}catch{x&&x(mr)}}if(Xe){ie=xt.join("&");break e}}ie=void 0}return d=d.i.splice(0,y),_.G=d,ie}function cl(d){if(!d.g&&!d.v){d.Y=1;var _=d.Da;U||w(),O||(U(),O=!0),E.add(_,d),d.A=0}}function Rf(d){return d.g||d.v||d.A>=3?!1:(d.Y++,d.v=hr(u(d.Da,d),dy(d,d.A)),d.A++,!0)}t.Da=function(){if(this.v=null,uy(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var d=4*this.T;this.j.info("BP detection timer enabled: "+d),this.B=hr(u(this.Wa,this),d)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,yt(10),hn(this),uy(this))};function Pf(d){d.B!=null&&(o.clearTimeout(d.B),d.B=null)}function uy(d){d.g=new It(d,d.j,"rpc",d.Y),d.u===null&&(d.g.J=d.o),d.g.P=0;var _=Fn(d.na);Ye(_,"RID","rpc"),Ye(_,"SID",d.M),Ye(_,"AID",d.K),Ye(_,"CI",d.F?"0":"1"),!d.F&&d.ia&&Ye(_,"TO",d.ia),Ye(_,"TYPE","xmlhttp"),On(d,_),d.u&&d.o&&W(_,d.u,d.o),d.O&&(d.g.H=d.O);var y=d.g;d=d.ba,y.M=1,y.A=yo(Fn(_)),y.u=null,y.R=!0,hc(y,d)}t.Va=function(){this.C!=null&&(this.C=null,hn(this),Rf(this),yt(19))};function Ic(d){d.C!=null&&(o.clearTimeout(d.C),d.C=null)}function cy(d,_){var y=null;if(d.g==_){Ic(d),Pf(d),d.g=null;var x=2}else if(rl(d.h,_))y=_.G,sl(d.h,_),x=1;else return;if(d.I!=0){if(_.o)if(x==1){y=_.u?_.u.length:0,_=Date.now()-_.F;var G=d.D;x=po(),Vt(x,new uc(x,y)),vo(d)}else cl(d);else if(G=_.m,G==3||G==0&&_.X>0||!(x==1&&ul(d,_)||x==2&&Rf(d)))switch(y&&y.length>0&&(_=d.h,_.i=_.i.concat(y)),G){case 1:Is(d,5);break;case 4:Is(d,10);break;case 3:Is(d,6);break;default:Is(d,2)}}}function dy(d,_){let y=d.Qa+Math.floor(Math.random()*d.Za);return d.isActive()||(y*=2),y*_}function Is(d,_){if(d.j.info("Error code "+_),_==2){var y=u(d.bb,d),x=d.Ua;const G=!x;x=new fr(x||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||oi(x,"https"),yo(x),G?Cf(x.toString(),y):Af(x.toString(),y)}else yt(2);d.I=0,d.l&&d.l.pa(_),hy(d),fn(d)}t.bb=function(d){d?(this.j.info("Successfully pinged google.com"),yt(2)):(this.j.info("Failed to ping google.com"),yt(1))};function hy(d){if(d.I=0,d.ja=[],d.l){const _=mc(d.h);(_.length!=0||d.i.length!=0)&&(T(d.ja,_),T(d.ja,d.i),d.h.i.length=0,v(d.i),d.i.length=0),d.l.oa()}}function fy(d,_,y){var x=y instanceof fr?Fn(y):new fr(y);if(x.g!="")_&&(x.g=_+"."+x.g),ai(x,x.u);else{var G=o.location;x=G.protocol,_=_?_+"."+G.hostname:G.hostname,G=+G.port;const $=new fr(null);x&&oi($,x),_&&($.g=_),G&&ai($,G),y&&($.h=y),x=$}return y=d.G,_=d.wa,y&&_&&Ye(x,y,_),Ye(x,"VER",d.ka),On(d,x),x}function py(d,_,y){if(_&&!d.L)throw Error("Can't create secondary domain capable XhrIo object.");return _=d.Aa&&!d.ma?new X(new F({ab:y})):new X(d.ma),_.Fa(d.L),_}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function my(){}t=my.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function wc(){}wc.prototype.g=function(d,_){return new wn(d,_)};function wn(d,_){le.call(this),this.g=new In(_),this.l=d,this.h=_&&_.messageUrlParams||null,d=_&&_.messageHeaders||null,_&&_.clientProtocolHeaderRequired&&(d?d["X-Client-Protocol"]="webchannel":d={"X-Client-Protocol":"webchannel"}),this.g.o=d,d=_&&_.initMessageHeaders||null,_&&_.messageContentType&&(d?d["X-WebChannel-Content-Type"]=_.messageContentType:d={"X-WebChannel-Content-Type":_.messageContentType}),_&&_.sa&&(d?d["X-WebChannel-Client-Profile"]=_.sa:d={"X-WebChannel-Client-Profile":_.sa}),this.g.U=d,(d=_&&_.Qb)&&!N(d)&&(this.g.u=d),this.A=_&&_.supportsCrossDomainXhr||!1,this.v=_&&_.sendRawJson||!1,(_=_&&_.httpSessionIdParam)&&!N(_)&&(this.g.G=_,d=this.h,d!==null&&_ in d&&(d=this.h,_ in d&&delete d[_])),this.j=new Eo(this)}m(wn,le),wn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},wn.prototype.close=function(){pr(this.g)},wn.prototype.o=function(d){var _=this.g;if(typeof d=="string"){var y={};y.__data__=d,d=y}else this.v&&(y={},y.__data__=cs(d),d=y);_.i.push(new nl(_.Ya++,d)),_.I==3&&vo(_)},wn.prototype.N=function(){this.g.l=null,delete this.j,pr(this.g),delete this.g,wn.Z.N.call(this)};function gy(d){Ha.call(this),d.__headers__&&(this.headers=d.__headers__,this.statusCode=d.__status__,delete d.__headers__,delete d.__status__);var _=d.__sm__;if(_){e:{for(const y in _){d=y;break e}d=void 0}(this.i=d)&&(d=this.i,_=_!==null&&d in _?_[d]:void 0),this.data=_}else this.data=d}m(gy,Ha);function _y(){hs.call(this),this.status=1}m(_y,hs);function Eo(d){this.g=d}m(Eo,my),Eo.prototype.ra=function(){Vt(this.g,"a")},Eo.prototype.qa=function(d){Vt(this.g,new gy(d))},Eo.prototype.pa=function(d){Vt(this.g,new _y)},Eo.prototype.oa=function(){Vt(this.g,"b")},wc.prototype.createWebChannel=wc.prototype.g,wn.prototype.send=wn.prototype.o,wn.prototype.open=wn.prototype.m,wn.prototype.close=wn.prototype.close,F0=function(){return new wc},L0=function(){return po()},V0=En,Rm={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ja.NO_ERROR=0,ja.TIMEOUT=8,ja.HTTP_ERROR=6,pd=ja,cc.COMPLETE="complete",M0=cc,lc.EventType=ds,ds.OPEN="a",ds.CLOSE="b",ds.ERROR="c",ds.MESSAGE="d",le.prototype.listen=le.prototype.J,Pl=lc,X.prototype.listenOnce=X.prototype.K,X.prototype.getLastError=X.prototype.Ha,X.prototype.getLastErrorCode=X.prototype.ya,X.prototype.getStatus=X.prototype.ca,X.prototype.getResponseJson=X.prototype.La,X.prototype.getResponseText=X.prototype.la,X.prototype.send=X.prototype.ea,X.prototype.setWithCredentials=X.prototype.Fa,b0=X}).apply(typeof zc<"u"?zc:typeof self<"u"?self:typeof window<"u"?window:{});const EE="@firebase/firestore",IE="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Gt.UNAUTHENTICATED=new Gt(null),Gt.GOOGLE_CREDENTIALS=new Gt("google-credentials-uid"),Gt.FIRST_PARTY=new Gt("first-party-uid"),Gt.MOCK_USER=new Gt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Oa="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ji=new r_("@firebase/firestore");function Po(){return ji.logLevel}function U0(t){ji.setLogLevel(t)}function ee(t,...e){if(ji.logLevel<=Ve.DEBUG){const n=e.map(g_);ji.debug(`Firestore (${Oa}): ${t}`,...n)}}function rn(t,...e){if(ji.logLevel<=Ve.ERROR){const n=e.map(g_);ji.error(`Firestore (${Oa}): ${t}`,...n)}}function Ji(t,...e){if(ji.logLevel<=Ve.WARN){const n=e.map(g_);ji.warn(`Firestore (${Oa}): ${t}`,...n)}}function g_(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function he(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,O0(t,r,n)}function O0(t,e,n){let r=`FIRESTORE (${Oa}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw rn(r),new Error(r)}function _e(t,e,n,r){let i="Unexpected state";typeof n=="string"?i=n:r=n,t||O0(e,i,r)}function xe(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class re extends ti{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cr{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B0{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class q0{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Gt.UNAUTHENTICATED))}shutdown(){}}class YF{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class XF{constructor(e){this.t=e,this.currentUser=Gt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){_e(this.o===void 0,42304);let r=this.i;const i=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let s=new Cr;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Cr,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},a=l=>{ee("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(ee("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Cr)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(ee("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(_e(typeof r.accessToken=="string",31837,{l:r}),new B0(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return _e(e===null||typeof e=="string",2055,{h:e}),new Gt(e)}}class ZF{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=Gt.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class eU{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new ZF(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(Gt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class wE{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class tU{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,tr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){_e(this.o===void 0,3512);const r=s=>{s.error!=null&&ee("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,ee("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{ee("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):ee("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new wE(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(_e(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new wE(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nU(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jh{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=nU(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%62))}return r}}function Ae(t,e){return t<e?-1:t>e?1:0}function Pm(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const i=t.charAt(r),s=e.charAt(r);if(i!==s)return dp(i)===dp(s)?Ae(i,s):dp(i)?1:-1}return Ae(t.length,e.length)}const rU=55296,iU=57343;function dp(t){const e=t.charCodeAt(0);return e>=rU&&e<=iU}function ga(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function G0(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SE="__name__";class yr{constructor(e,n,r){n===void 0?n=0:n>e.length&&he(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&he(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return yr.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof yr?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=yr.compareSegments(e.get(i),n.get(i));if(s!==0)return s}return Ae(e.length,n.length)}static compareSegments(e,n){const r=yr.isNumericId(e),i=yr.isNumericId(n);return r&&!i?-1:!r&&i?1:r&&i?yr.extractNumericId(e).compare(yr.extractNumericId(n)):Pm(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Gi.fromString(e.substring(4,e.length-2))}}class ze extends yr{construct(e,n,r){return new ze(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new re(K.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new ze(n)}static emptyPath(){return new ze([])}}const sU=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ot extends yr{construct(e,n,r){return new ot(e,n,r)}static isValidIdentifier(e){return sU.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ot.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===SE}static keyField(){return new ot([SE])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new re(K.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new re(K.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new re(K.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new re(K.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ot(n)}static emptyPath(){return new ot([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ae{constructor(e){this.path=e}static fromPath(e){return new ae(ze.fromString(e))}static fromName(e){return new ae(ze.fromString(e).popFirst(5))}static empty(){return new ae(ze.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ze.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return ze.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ae(new ze(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z0(t,e,n){if(!n)throw new re(K.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function $0(t,e,n,r){if(e===!0&&r===!0)throw new re(K.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function CE(t){if(!ae.isDocumentKey(t))throw new re(K.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function AE(t){if(ae.isDocumentKey(t))throw new re(K.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function H0(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Jh(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":he(12329,{type:typeof t})}function an(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new re(K.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Jh(t);throw new re(K.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ct(t,e){const n={typeString:t};return e&&(n.value=e),n}function Hu(t,e){if(!H0(t))throw new re(K.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(i&&typeof o!==i){n=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&o!==s.value){n=`Expected '${r}' field to equal '${s.value}'`;break}}if(n)throw new re(K.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xE=-62135596800,RE=1e6;class He{static now(){return He.fromMillis(Date.now())}static fromDate(e){return He.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*RE);return new He(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new re(K.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new re(K.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<xE)throw new re(K.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new re(K.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/RE}_compareTo(e){return this.seconds===e.seconds?Ae(this.nanoseconds,e.nanoseconds):Ae(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:He._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Hu(e,He._jsonSchema))return new He(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-xE;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}He._jsonSchemaVersion="firestore/timestamp/1.0",He._jsonSchema={type:Ct("string",He._jsonSchemaVersion),seconds:Ct("number"),nanoseconds:Ct("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ve{static fromTimestamp(e){return new ve(e)}static min(){return new ve(new He(0,0))}static max(){return new ve(new He(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iu=-1;class oh{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}}function km(t){return t.fields.find(e=>e.kind===2)}function Rs(t){return t.fields.filter(e=>e.kind!==2)}oh.UNKNOWN_ID=-1;class md{constructor(e,n){this.fieldPath=e,this.kind=n}}class wu{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new wu(0,Nn.min())}}function oU(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=ve.fromTimestamp(r===1e9?new He(n+1,0):new He(n,r));return new Nn(i,ae.empty(),e)}function W0(t){return new Nn(t.readTime,t.key,Iu)}class Nn{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Nn(ve.min(),ae.empty(),Iu)}static max(){return new Nn(ve.max(),ae.empty(),Iu)}}function __(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=ae.comparator(t.documentKey,e.documentKey),n!==0?n:Ae(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K0="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class j0{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uo(t){if(t.code!==K.FAILED_PRECONDITION||t.message!==K0)throw t;ee("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&he(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new q((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof q?n:q.resolve(n)}catch(n){return q.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):q.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):q.reject(n)}static resolve(e){return new q((n,r)=>{n(e)})}static reject(e){return new q((n,r)=>{r(e)})}static waitFor(e){return new q((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},l=>r(l))}),o=!0,s===i&&n()})}static or(e){let n=q.resolve(!1);for(const r of e)n=n.next(i=>i?q.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new q((r,i)=>{const s=e.length,o=new Array(s);let a=0;for(let l=0;l<s;l++){const u=l;n(e[u]).next(f=>{o[u]=f,++a,a===s&&r(o)},f=>i(f))}})}static doWhile(e,n){return new q((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cn="SimpleDb";class Qh{static open(e,n,r,i){try{return new Qh(n,e.transaction(i,r))}catch(s){throw new Kl(n,s)}}constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.S=new Cr,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{n.error?this.S.reject(new Kl(e,n.error)):this.S.resolve()},this.transaction.onerror=r=>{const i=y_(r.target.error);this.S.reject(new Kl(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(ee(Cn,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new lU(n)}}class zi{static delete(e){return ee(Cn,"Removing database:",e),ks(OC().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!jC())return!1;if(zi.F())return!0;const e=Nt(),n=zi.M(e),r=0<n&&n<10,i=J0(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)==null?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)==="YES"}static O(e,n){return e.store(n)}static M(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,n,r){this.name=e,this.version=n,this.N=r,this.B=null,zi.M(Nt())===12.2&&rn("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(ee(Cn,"Opening database:",this.name),this.db=await new Promise((n,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const o=s.target.result;n(o)},i.onblocked=()=>{r(new Kl(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const o=s.target.error;o.name==="VersionError"?r(new re(K.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new re(K.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Kl(e,o))},i.onupgradeneeded=s=>{ee(Cn,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.N.k(o,i.transaction,s.oldVersion,this.version).next(()=>{ee(Cn,"Database upgrade to version "+this.version+" complete")})}})),this.q&&(this.db.onversionchange=n=>this.q(n)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,i){const s=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const a=Qh.open(this.db,e,s?"readonly":"readwrite",r),l=i(a).next(u=>(a.C(),u)).catch(u=>(a.abort(u),q.reject(u))).toPromise();return l.catch(()=>{}),await a.D,l}catch(a){const l=a,u=l.name!=="FirebaseError"&&o<3;if(ee(Cn,"Transaction failed with error:",l.message,"Retrying:",u),this.close(),!u)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function J0(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class aU{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return ks(this.U.delete())}}class Kl extends re{constructor(e,n){super(K.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function ss(t){return t.name==="IndexedDbTransactionError"}class lU{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(ee(Cn,"PUT",this.store.name,e,n),r=this.store.put(n,e)):(ee(Cn,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),ks(r)}add(e){return ee(Cn,"ADD",this.store.name,e,e),ks(this.store.add(e))}get(e){return ks(this.store.get(e)).next(n=>(n===void 0&&(n=null),ee(Cn,"GET",this.store.name,e,n),n))}delete(e){return ee(Cn,"DELETE",this.store.name,e),ks(this.store.delete(e))}count(){return ee(Cn,"COUNT",this.store.name),ks(this.store.count())}J(e,n){const r=this.options(e,n),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const s=i.getAll(r.range);return new q((o,a)=>{s.onerror=l=>{a(l.target.error)},s.onsuccess=l=>{o(l.target.result)}})}{const s=this.cursor(r),o=[];return this.H(s,(a,l)=>{o.push(l)}).next(()=>o)}}Y(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new q((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}Z(e,n){ee(Cn,"DELETE ALL",this.store.name);const r=this.options(e,n);r.X=!1;const i=this.cursor(r);return this.H(i,(s,o,a)=>a.delete())}ee(e,n){let r;n?r=e:(r={},n=e);const i=this.cursor(r);return this.H(i,n)}te(e){const n=this.cursor({});return new q((r,i)=>{n.onerror=s=>{const o=y_(s.target.error);i(o)},n.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}H(e,n){const r=[];return new q((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void i();const l=new aU(a),u=n(a.primaryKey,a.value,l);if(u instanceof q){const f=u.catch(m=>(l.done(),q.reject(m)));r.push(f)}l.isDone?i():l.G===null?a.continue():a.continue(l.G)}}).next(()=>q.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function ks(t){return new q((e,n)=>{t.onsuccess=r=>{const i=r.target.result;e(i)},t.onerror=r=>{const i=y_(r.target.error);n(i)}})}let PE=!1;function y_(t){const e=zi.M(Nt());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new re("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return PE||(PE=!0,setTimeout(()=>{throw r},0)),r}}return t}const jl="IndexBackfiller";class uU{constructor(e,n){this.asyncQueue=e,this.ne=n,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){ee(jl,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const n=await this.ne.ie();ee(jl,`Documents written: ${n}`)}catch(n){ss(n)?ee(jl,"Ignoring IndexedDB error during index backfill: ",n):await uo(n)}await this.re(6e4)})}}class cU{constructor(e,n){this.localStore=e,this.persistence=n}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.se(n,e))}se(e,n){const r=new Set;let i=n,s=!0;return q.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return ee(jl,`Processing collection: ${o}`),this.oe(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>n-i)}oe(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this._e(i,s)).next(a=>(ee(jl,`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}_e(e,n){let r=e;return n.changes.forEach((i,s)=>{const o=W0(s);__(o,r)>0&&(r=o)}),new Nn(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $n{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}$n.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gs=-1;function Yh(t){return t==null}function Su(t){return t===0&&1/t==-1/0}function dU(t){return typeof t=="number"&&Number.isInteger(t)&&!Su(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ah="";function Zt(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=kE(e)),e=hU(t.get(n),e);return kE(e)}function hU(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const s=t.charAt(i);switch(s){case"\0":n+="";break;case ah:n+="";break;default:n+=s}}return n}function kE(t){return t+ah+""}function Tr(t){const e=t.length;if(_e(e>=2,64408,{path:t}),e===2)return _e(t.charAt(0)===ah&&t.charAt(1)==="",56145,{path:t}),ze.emptyPath();const n=e-2,r=[];let i="";for(let s=0;s<e;){const o=t.indexOf(ah,s);switch((o<0||o>n)&&he(50515,{path:t}),t.charAt(o+1)){case"":const a=t.substring(s,o);let l;i.length===0?l=a:(i+=a,l=i,i=""),r.push(l);break;case"":i+=t.substring(s,o),i+="\0";break;case"":i+=t.substring(s,o+1);break;default:he(61167,{path:t})}s=o+2}return new ze(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ps="remoteDocuments",Wu="owner",wo="owner",Cu="mutationQueues",fU="userId",Zn="mutations",NE="batchId",Us="userMutationsIndex",DE=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gd(t,e){return[t,Zt(e)]}function Q0(t,e,n){return[t,Zt(e),n]}const pU={},_a="documentMutations",lh="remoteDocumentsV14",mU=["prefixPath","collectionGroup","readTime","documentId"],_d="documentKeyIndex",gU=["prefixPath","collectionGroup","documentId"],Y0="collectionGroupIndex",_U=["collectionGroup","readTime","prefixPath","documentId"],Au="remoteDocumentGlobal",Nm="remoteDocumentGlobalKey",ya="targets",X0="queryTargetsIndex",yU=["canonicalId","targetId"],va="targetDocuments",vU=["targetId","path"],v_="documentTargetsIndex",TU=["path","targetId"],uh="targetGlobalKey",zs="targetGlobal",xu="collectionParents",EU=["collectionId","parent"],Ta="clientMetadata",IU="clientId",Xh="bundles",wU="bundleId",Zh="namedQueries",SU="name",T_="indexConfiguration",CU="indexId",Dm="collectionGroupIndex",AU="collectionGroup",Jl="indexState",xU=["indexId","uid"],Z0="sequenceNumberIndex",RU=["uid","sequenceNumber"],Ql="indexEntries",PU=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],eA="documentKeyIndex",kU=["indexId","uid","orderedDocumentKey"],ef="documentOverlays",NU=["userId","collectionPath","documentId"],bm="collectionPathOverlayIndex",DU=["userId","collectionPath","largestBatchId"],tA="collectionGroupOverlayIndex",bU=["userId","collectionGroup","largestBatchId"],E_="globals",MU="name",nA=[Cu,Zn,_a,Ps,ya,Wu,zs,va,Ta,Au,xu,Xh,Zh],VU=[...nA,ef],rA=[Cu,Zn,_a,lh,ya,Wu,zs,va,Ta,Au,xu,Xh,Zh,ef],iA=rA,I_=[...iA,T_,Jl,Ql],LU=I_,sA=[...I_,E_],FU=sA;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mm extends j0{constructor(e,n){super(),this.le=e,this.currentSequenceNumber=n}}function bt(t,e){const n=xe(t);return zi.O(n.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bE(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function os(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function oA(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class at{constructor(e,n){this.comparator=e,this.root=n||zt.EMPTY}insert(e,n){return new at(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,zt.BLACK,null,null))}remove(e){return new at(this.comparator,this.root.remove(e,this.comparator).copy(null,null,zt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new $c(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new $c(this.root,e,this.comparator,!1)}getReverseIterator(){return new $c(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new $c(this.root,e,this.comparator,!0)}}class $c{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class zt{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??zt.RED,this.left=i??zt.EMPTY,this.right=s??zt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new zt(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return zt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return zt.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,zt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,zt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw he(43730,{key:this.key,value:this.value});if(this.right.isRed())throw he(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw he(27949);return e+(this.isRed()?0:1)}}zt.EMPTY=null,zt.RED=!0,zt.BLACK=!1;zt.EMPTY=new class{constructor(){this.size=0}get key(){throw he(57766)}get value(){throw he(16141)}get color(){throw he(16727)}get left(){throw he(29726)}get right(){throw he(36894)}copy(e,n,r,i,s){return this}insert(e,n,r){return new zt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qe{constructor(e){this.comparator=e,this.data=new at(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new ME(this.data.getIterator())}getIteratorFrom(e){return new ME(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Qe)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Qe(this.comparator);return n.data=e,n}}class ME{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function So(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gn{constructor(e){this.fields=e,e.sort(ot.comparator)}static empty(){return new gn([])}unionWith(e){let n=new Qe(ot.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new gn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return ga(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aA extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Et{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new aA("Invalid base64 string: "+s):s}}(e);return new Et(n)}static fromUint8Array(e){const n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new Et(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ae(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Et.EMPTY_BYTE_STRING=new Et("");const UU=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Yr(t){if(_e(!!t,39018),typeof t=="string"){let e=0;const n=UU.exec(t);if(_e(!!n,46558,{timestamp:t}),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:it(t.seconds),nanos:it(t.nanos)}}function it(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Xr(t){return typeof t=="string"?Et.fromBase64String(t):Et.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lA="server_timestamp",uA="__type__",cA="__previous_value__",dA="__local_write_time__";function w_(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[uA])==null?void 0:r.stringValue)===lA}function tf(t){const e=t.mapValue.fields[cA];return w_(e)?tf(e):e}function Ru(t){const e=Yr(t.mapValue.fields[dA].timestampValue);return new He(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OU{constructor(e,n,r,i,s,o,a,l,u,f){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=u,this.isUsingEmulator=f}}const ch="(default)";class Qi{constructor(e,n){this.projectId=e,this.database=n||ch}static empty(){return new Qi("","")}get isDefaultDatabase(){return this.database===ch}isEqual(e){return e instanceof Qi&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S_="__type__",hA="__max__",ki={mapValue:{fields:{__type__:{stringValue:hA}}}},C_="__vector__",Ea="value",yd={nullValue:"NULL_VALUE"};function Yi(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?w_(t)?4:fA(t)?9007199254740991:nf(t)?10:11:he(28295,{value:t})}function xr(t,e){if(t===e)return!0;const n=Yi(t);if(n!==Yi(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Ru(t).isEqual(Ru(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=Yr(i.timestampValue),a=Yr(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return Xr(i.bytesValue).isEqual(Xr(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return it(i.geoPointValue.latitude)===it(s.geoPointValue.latitude)&&it(i.geoPointValue.longitude)===it(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return it(i.integerValue)===it(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=it(i.doubleValue),a=it(s.doubleValue);return o===a?Su(o)===Su(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return ga(t.arrayValue.values||[],e.arrayValue.values||[],xr);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(bE(o)!==bE(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!xr(o[l],a[l])))return!1;return!0}(t,e);default:return he(52216,{left:t})}}function Pu(t,e){return(t.values||[]).find(n=>xr(n,e))!==void 0}function Xi(t,e){if(t===e)return 0;const n=Yi(t),r=Yi(e);if(n!==r)return Ae(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Ae(t.booleanValue,e.booleanValue);case 2:return function(s,o){const a=it(s.integerValue||s.doubleValue),l=it(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(t,e);case 3:return VE(t.timestampValue,e.timestampValue);case 4:return VE(Ru(t),Ru(e));case 5:return Pm(t.stringValue,e.stringValue);case 6:return function(s,o){const a=Xr(s),l=Xr(o);return a.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),l=o.split("/");for(let u=0;u<a.length&&u<l.length;u++){const f=Ae(a[u],l[u]);if(f!==0)return f}return Ae(a.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){const a=Ae(it(s.latitude),it(o.latitude));return a!==0?a:Ae(it(s.longitude),it(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return LE(t.arrayValue,e.arrayValue);case 10:return function(s,o){var g,v,T,A;const a=s.fields||{},l=o.fields||{},u=(g=a[Ea])==null?void 0:g.arrayValue,f=(v=l[Ea])==null?void 0:v.arrayValue,m=Ae(((T=u==null?void 0:u.values)==null?void 0:T.length)||0,((A=f==null?void 0:f.values)==null?void 0:A.length)||0);return m!==0?m:LE(u,f)}(t.mapValue,e.mapValue);case 11:return function(s,o){if(s===ki.mapValue&&o===ki.mapValue)return 0;if(s===ki.mapValue)return 1;if(o===ki.mapValue)return-1;const a=s.fields||{},l=Object.keys(a),u=o.fields||{},f=Object.keys(u);l.sort(),f.sort();for(let m=0;m<l.length&&m<f.length;++m){const g=Pm(l[m],f[m]);if(g!==0)return g;const v=Xi(a[l[m]],u[f[m]]);if(v!==0)return v}return Ae(l.length,f.length)}(t.mapValue,e.mapValue);default:throw he(23264,{he:n})}}function VE(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Ae(t,e);const n=Yr(t),r=Yr(e),i=Ae(n.seconds,r.seconds);return i!==0?i:Ae(n.nanos,r.nanos)}function LE(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const s=Xi(n[i],r[i]);if(s)return s}return Ae(n.length,r.length)}function Ia(t){return Vm(t)}function Vm(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Yr(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Xr(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return ae.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=Vm(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${Vm(n.fields[o])}`;return i+"}"}(t.mapValue):he(61005,{value:t})}function vd(t){switch(Yi(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=tf(t);return e?16+vd(e):16;case 5:return 2*t.stringValue.length;case 6:return Xr(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,s)=>i+vd(s),0)}(t.arrayValue);case 10:case 11:return function(r){let i=0;return os(r.fields,(s,o)=>{i+=s.length+vd(o)}),i}(t.mapValue);default:throw he(13486,{value:t})}}function ku(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Lm(t){return!!t&&"integerValue"in t}function Nu(t){return!!t&&"arrayValue"in t}function FE(t){return!!t&&"nullValue"in t}function UE(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Td(t){return!!t&&"mapValue"in t}function nf(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[S_])==null?void 0:r.stringValue)===C_}function Yl(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return os(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Yl(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Yl(t.arrayValue.values[n]);return e}return{...t}}function fA(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===hA}const pA={mapValue:{fields:{[S_]:{stringValue:C_},[Ea]:{arrayValue:{}}}}};function BU(t){return"nullValue"in t?yd:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?ku(Qi.empty(),ae.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?nf(t)?pA:{mapValue:{}}:he(35942,{value:t})}function qU(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?ku(Qi.empty(),ae.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?pA:"mapValue"in t?nf(t)?{mapValue:{}}:ki:he(61959,{value:t})}function OE(t,e){const n=Xi(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function BE(t,e){const n=Xi(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yt{constructor(e){this.value=e}static empty(){return new Yt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Td(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Yl(n)}setAll(e){let n=ot.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=Yl(o):i.push(a.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());Td(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return xr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];Td(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){os(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new Yt(Yl(this.value))}}function mA(t){const e=[];return os(t.fields,(n,r)=>{const i=new ot([n]);if(Td(r)){const s=mA(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new gn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _t{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new _t(e,0,ve.min(),ve.min(),ve.min(),Yt.empty(),0)}static newFoundDocument(e,n,r,i){return new _t(e,1,n,ve.min(),r,i,0)}static newNoDocument(e,n){return new _t(e,2,n,ve.min(),ve.min(),Yt.empty(),0)}static newUnknownDocument(e,n){return new _t(e,3,n,ve.min(),ve.min(),Yt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(ve.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Yt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Yt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ve.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof _t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new _t(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wa{constructor(e,n){this.position=e,this.inclusive=n}}function qE(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(s.field.isKeyField()?r=ae.comparator(ae.fromName(o.referenceValue),n.key):r=Xi(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function GE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!xr(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dh{constructor(e,n="asc"){this.field=e,this.dir=n}}function GU(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gA{}class Le extends gA{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new zU(e,n,r):n==="array-contains"?new WU(e,r):n==="in"?new IA(e,r):n==="not-in"?new KU(e,r):n==="array-contains-any"?new jU(e,r):new Le(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new $U(e,r):new HU(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Xi(n,this.value)):n!==null&&Yi(this.value)===Yi(n)&&this.matchesComparison(Xi(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return he(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class je extends gA{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new je(e,n)}matches(e){return Sa(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Sa(t){return t.op==="and"}function Fm(t){return t.op==="or"}function A_(t){return _A(t)&&Sa(t)}function _A(t){for(const e of t.filters)if(e instanceof je)return!1;return!0}function Um(t){if(t instanceof Le)return t.field.canonicalString()+t.op.toString()+Ia(t.value);if(A_(t))return t.filters.map(e=>Um(e)).join(",");{const e=t.filters.map(n=>Um(n)).join(",");return`${t.op}(${e})`}}function yA(t,e){return t instanceof Le?function(r,i){return i instanceof Le&&r.op===i.op&&r.field.isEqual(i.field)&&xr(r.value,i.value)}(t,e):t instanceof je?function(r,i){return i instanceof je&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&yA(o,i.filters[a]),!0):!1}(t,e):void he(19439)}function vA(t,e){const n=t.filters.concat(e);return je.create(n,t.op)}function TA(t){return t instanceof Le?function(n){return`${n.field.canonicalString()} ${n.op} ${Ia(n.value)}`}(t):t instanceof je?function(n){return n.op.toString()+" {"+n.getFilters().map(TA).join(" ,")+"}"}(t):"Filter"}class zU extends Le{constructor(e,n,r){super(e,n,r),this.key=ae.fromName(r.referenceValue)}matches(e){const n=ae.comparator(e.key,this.key);return this.matchesComparison(n)}}class $U extends Le{constructor(e,n){super(e,"in",n),this.keys=EA("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class HU extends Le{constructor(e,n){super(e,"not-in",n),this.keys=EA("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function EA(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(r=>ae.fromName(r.referenceValue))}class WU extends Le{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Nu(n)&&Pu(n.arrayValue,this.value)}}class IA extends Le{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Pu(this.value.arrayValue,n)}}class KU extends Le{constructor(e,n){super(e,"not-in",n)}matches(e){if(Pu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Pu(this.value.arrayValue,n)}}class jU extends Le{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Nu(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Pu(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JU{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.Te=null}}function Om(t,e=null,n=[],r=[],i=null,s=null,o=null){return new JU(t,e,n,r,i,s,o)}function to(t){const e=xe(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Um(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Yh(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Ia(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Ia(r)).join(",")),e.Te=n}return e.Te}function Ku(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!GU(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!yA(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!GE(t.startAt,e.startAt)&&GE(t.endAt,e.endAt)}function hh(t){return ae.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function fh(t,e){return t.filters.filter(n=>n instanceof Le&&n.field.isEqual(e))}function zE(t,e,n){let r=yd,i=!0;for(const s of fh(t,e)){let o=yd,a=!0;switch(s.op){case"<":case"<=":o=BU(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=yd}OE({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];OE({value:r,inclusive:i},{value:o,inclusive:n.inclusive})<0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}function $E(t,e,n){let r=ki,i=!0;for(const s of fh(t,e)){let o=ki,a=!0;switch(s.op){case">=":case">":o=qU(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=ki}BE({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];BE({value:r,inclusive:i},{value:o,inclusive:n.inclusive})>0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ju{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function QU(t,e,n,r,i,s,o,a){return new ju(t,e,n,r,i,s,o,a)}function Ju(t){return new ju(t)}function HE(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function wA(t){return t.collectionGroup!==null}function Xl(t){const e=xe(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Qe(ot.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(u=>{u.isInequality()&&(a=a.add(u.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new dh(s,r))}),n.has(ot.keyField().canonicalString())||e.Ie.push(new dh(ot.keyField(),r))}return e.Ie}function Kn(t){const e=xe(t);return e.Ee||(e.Ee=YU(e,Xl(t))),e.Ee}function YU(t,e){if(t.limitType==="F")return Om(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new dh(i.field,s)});const n=t.endAt?new wa(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new wa(t.startAt.position,t.startAt.inclusive):null;return Om(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Bm(t,e){const n=t.filters.concat([e]);return new ju(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function qm(t,e,n){return new ju(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function rf(t,e){return Ku(Kn(t),Kn(e))&&t.limitType===e.limitType}function SA(t){return`${to(Kn(t))}|lt:${t.limitType}`}function ko(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>TA(i)).join(", ")}]`),Yh(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>Ia(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>Ia(i)).join(",")),`Target(${r})`}(Kn(t))}; limitType=${t.limitType})`}function Qu(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):ae.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of Xl(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,a,l){const u=qE(o,a,l);return o.inclusive?u<=0:u<0}(r.startAt,Xl(r),i)||r.endAt&&!function(o,a,l){const u=qE(o,a,l);return o.inclusive?u>=0:u>0}(r.endAt,Xl(r),i))}(t,e)}function XU(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function CA(t){return(e,n)=>{let r=!1;for(const i of Xl(t)){const s=ZU(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function ZU(t,e,n){const r=t.field.isKeyField()?ae.comparator(e.key,n.key):function(s,o,a){const l=o.data.field(s),u=a.data.field(s);return l!==null&&u!==null?Xi(l,u):he(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return he(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ni{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){os(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return oA(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e4=new at(ae.comparator);function Rn(){return e4}const AA=new at(ae.comparator);function kl(...t){let e=AA;for(const n of t)e=e.insert(n.key,n);return e}function xA(t){let e=AA;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Er(){return Zl()}function RA(){return Zl()}function Zl(){return new ni(t=>t.toString(),(t,e)=>t.isEqual(e))}const t4=new at(ae.comparator),n4=new Qe(ae.comparator);function Ne(...t){let e=n4;for(const n of t)e=e.add(n);return e}const r4=new Qe(Ae);function i4(){return r4}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x_(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Su(e)?"-0":e}}function PA(t){return{integerValue:""+t}}function s4(t,e){return dU(e)?PA(e):x_(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sf{constructor(){this._=void 0}}function o4(t,e,n){return t instanceof Ca?function(i,s){const o={fields:{[uA]:{stringValue:lA},[dA]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&w_(s)&&(s=tf(s)),s&&(o.fields[cA]=s),{mapValue:o}}(n,e):t instanceof Aa?NA(t,e):t instanceof xa?DA(t,e):function(i,s){const o=kA(i,s),a=WE(o)+WE(i.Ae);return Lm(o)&&Lm(i.Ae)?PA(a):x_(i.serializer,a)}(t,e)}function a4(t,e,n){return t instanceof Aa?NA(t,e):t instanceof xa?DA(t,e):n}function kA(t,e){return t instanceof Du?function(r){return Lm(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class Ca extends sf{}class Aa extends sf{constructor(e){super(),this.elements=e}}function NA(t,e){const n=bA(e);for(const r of t.elements)n.some(i=>xr(i,r))||n.push(r);return{arrayValue:{values:n}}}class xa extends sf{constructor(e){super(),this.elements=e}}function DA(t,e){let n=bA(e);for(const r of t.elements)n=n.filter(i=>!xr(i,r));return{arrayValue:{values:n}}}class Du extends sf{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function WE(t){return it(t.integerValue||t.doubleValue)}function bA(t){return Nu(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MA{constructor(e,n){this.field=e,this.transform=n}}function l4(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof Aa&&i instanceof Aa||r instanceof xa&&i instanceof xa?ga(r.elements,i.elements,xr):r instanceof Du&&i instanceof Du?xr(r.Ae,i.Ae):r instanceof Ca&&i instanceof Ca}(t.transform,e.transform)}class u4{constructor(e,n){this.version=e,this.transformResults=n}}class sn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new sn}static exists(e){return new sn(void 0,e)}static updateTime(e){return new sn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ed(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class of{}function VA(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new af(t.key,sn.none()):new Ba(t.key,t.data,sn.none());{const n=t.data,r=Yt.empty();let i=new Qe(ot.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new ri(t.key,r,new gn(i.toArray()),sn.none())}}function c4(t,e,n){t instanceof Ba?function(i,s,o){const a=i.value.clone(),l=jE(i.fieldTransforms,s,o.transformResults);a.setAll(l),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof ri?function(i,s,o){if(!Ed(i.precondition,s))return void s.convertToUnknownDocument(o.version);const a=jE(i.fieldTransforms,s,o.transformResults),l=s.data;l.setAll(LA(i)),l.setAll(a),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function eu(t,e,n,r){return t instanceof Ba?function(s,o,a,l){if(!Ed(s.precondition,o))return a;const u=s.value.clone(),f=JE(s.fieldTransforms,l,o);return u.setAll(f),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,n,r):t instanceof ri?function(s,o,a,l){if(!Ed(s.precondition,o))return a;const u=JE(s.fieldTransforms,l,o),f=o.data;return f.setAll(LA(s)),f.setAll(u),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(m=>m.field))}(t,e,n,r):function(s,o,a){return Ed(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function d4(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=kA(r.transform,i||null);s!=null&&(n===null&&(n=Yt.empty()),n.set(r.field,s))}return n||null}function KE(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&ga(r,i,(s,o)=>l4(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Ba extends of{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class ri extends of{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function LA(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function jE(t,e,n){const r=new Map;_e(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,a4(o,a,n[i]))}return r}function JE(t,e,n){const r=new Map;for(const i of t){const s=i.transform,o=n.data.field(i.field);r.set(i.field,o4(s,o,e))}return r}class af extends of{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class FA extends of{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R_{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&c4(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=eu(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=eu(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=RA();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;const l=VA(o,a);l!==null&&r.set(i.key,l),o.isValidDocument()||o.convertToNoDocument(ve.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Ne())}isEqual(e){return this.batchId===e.batchId&&ga(this.mutations,e.mutations,(n,r)=>KE(n,r))&&ga(this.baseMutations,e.baseMutations,(n,r)=>KE(n,r))}}class P_{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){_e(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=function(){return t4}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new P_(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k_{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h4{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var wt,Ue;function f4(t){switch(t){case K.OK:return he(64938);case K.CANCELLED:case K.UNKNOWN:case K.DEADLINE_EXCEEDED:case K.RESOURCE_EXHAUSTED:case K.INTERNAL:case K.UNAVAILABLE:case K.UNAUTHENTICATED:return!1;case K.INVALID_ARGUMENT:case K.NOT_FOUND:case K.ALREADY_EXISTS:case K.PERMISSION_DENIED:case K.FAILED_PRECONDITION:case K.ABORTED:case K.OUT_OF_RANGE:case K.UNIMPLEMENTED:case K.DATA_LOSS:return!0;default:return he(15467,{code:t})}}function UA(t){if(t===void 0)return rn("GRPC error has no .code"),K.UNKNOWN;switch(t){case wt.OK:return K.OK;case wt.CANCELLED:return K.CANCELLED;case wt.UNKNOWN:return K.UNKNOWN;case wt.DEADLINE_EXCEEDED:return K.DEADLINE_EXCEEDED;case wt.RESOURCE_EXHAUSTED:return K.RESOURCE_EXHAUSTED;case wt.INTERNAL:return K.INTERNAL;case wt.UNAVAILABLE:return K.UNAVAILABLE;case wt.UNAUTHENTICATED:return K.UNAUTHENTICATED;case wt.INVALID_ARGUMENT:return K.INVALID_ARGUMENT;case wt.NOT_FOUND:return K.NOT_FOUND;case wt.ALREADY_EXISTS:return K.ALREADY_EXISTS;case wt.PERMISSION_DENIED:return K.PERMISSION_DENIED;case wt.FAILED_PRECONDITION:return K.FAILED_PRECONDITION;case wt.ABORTED:return K.ABORTED;case wt.OUT_OF_RANGE:return K.OUT_OF_RANGE;case wt.UNIMPLEMENTED:return K.UNIMPLEMENTED;case wt.DATA_LOSS:return K.DATA_LOSS;default:return he(39323,{code:t})}}(Ue=wt||(wt={}))[Ue.OK=0]="OK",Ue[Ue.CANCELLED=1]="CANCELLED",Ue[Ue.UNKNOWN=2]="UNKNOWN",Ue[Ue.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ue[Ue.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ue[Ue.NOT_FOUND=5]="NOT_FOUND",Ue[Ue.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ue[Ue.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ue[Ue.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ue[Ue.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ue[Ue.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ue[Ue.ABORTED=10]="ABORTED",Ue[Ue.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ue[Ue.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ue[Ue.INTERNAL=13]="INTERNAL",Ue[Ue.UNAVAILABLE=14]="UNAVAILABLE",Ue[Ue.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p4(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m4=new Gi([4294967295,4294967295],0);function QE(t){const e=p4().encode(t),n=new D0;return n.update(e),new Uint8Array(n.digest())}function YE(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Gi([n,r],0),new Gi([i,s],0)]}class N_{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Nl(`Invalid padding: ${n}`);if(r<0)throw new Nl(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Nl(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Nl(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=Gi.fromNumber(this.ge)}ye(e,n,r){let i=e.add(n.multiply(Gi.fromNumber(r)));return i.compare(m4)===1&&(i=new Gi([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=QE(e),[r,i]=YE(n);for(let s=0;s<this.hashCount;s++){const o=this.ye(r,i,s);if(!this.we(o))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new N_(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.ge===0)return;const n=QE(e),[r,i]=YE(n);for(let s=0;s<this.hashCount;s++){const o=this.ye(r,i,s);this.Se(o)}}Se(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Nl extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lf{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,Yu.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new lf(ve.min(),i,new at(Ae),Rn(),Ne())}}class Yu{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Yu(r,n,Ne(),Ne(),Ne())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Id{constructor(e,n,r,i){this.be=e,this.removedTargetIds=n,this.key=r,this.De=i}}class OA{constructor(e,n){this.targetId=e,this.Ce=n}}class BA{constructor(e,n,r=Et.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class XE{constructor(){this.ve=0,this.Fe=ZE(),this.Me=Et.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Ne(),n=Ne(),r=Ne();return this.Fe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:he(38017,{changeType:s})}}),new Yu(this.Me,this.xe,e,n,r)}qe(){this.Oe=!1,this.Fe=ZE()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,_e(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class g4{constructor(e){this.Ge=e,this.ze=new Map,this.je=Rn(),this.Je=Hc(),this.He=Hc(),this.Ye=new at(Ae)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:he(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((r,i)=>{this.rt(i)&&n(i)})}st(e){const n=e.targetId,r=e.Ce.count,i=this.ot(n);if(i){const s=i.target;if(hh(s))if(r===0){const o=new ae(s.path);this.et(n,o,_t.newNoDocument(o,ve.min()))}else _e(r===1,20013,{expectedCount:r});else{const o=this._t(n);if(o!==r){const a=this.ut(e),l=a?this.ct(a,e,o):1;if(l!==0){this.it(n);const u=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,u)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let o,a;try{o=Xr(r).toUint8Array()}catch(l){if(l instanceof aA)return Ji("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new N_(o,i,s)}catch(l){return Ji(l instanceof Nl?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.ge===0?null:a}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.et(n,s,null),i++)}),i}Tt(e){const n=new Map;this.ze.forEach((s,o)=>{const a=this.ot(o);if(a){if(s.current&&hh(a.target)){const l=new ae(a.target.path);this.It(l).has(o)||this.Et(o,l)||this.et(o,l,_t.newNoDocument(l,e))}s.Be&&(n.set(o,s.ke()),s.qe())}});let r=Ne();this.He.forEach((s,o)=>{let a=!0;o.forEachWhile(l=>{const u=this.ot(l);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.je.forEach((s,o)=>o.setReadTime(e));const i=new lf(e,n,this.Ye,this.je,r);return this.je=Rn(),this.Je=Hc(),this.He=Hc(),this.Ye=new at(Ae),i}Xe(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,r),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,n)?i.Qe(n,1):i.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new XE,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new Qe(Ae),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new Qe(Ae),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||ee("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new XE),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function Hc(){return new at(ae.comparator)}function ZE(){return new at(ae.comparator)}const _4={asc:"ASCENDING",desc:"DESCENDING"},y4={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},v4={and:"AND",or:"OR"};class T4{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Gm(t,e){return t.useProto3Json||Yh(e)?e:{value:e}}function Ra(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function qA(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function E4(t,e){return Ra(t,e.toTimestamp())}function ln(t){return _e(!!t,49232),ve.fromTimestamp(function(n){const r=Yr(n);return new He(r.seconds,r.nanos)}(t))}function D_(t,e){return zm(t,e).canonicalString()}function zm(t,e){const n=function(i){return new ze(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function GA(t){const e=ze.fromString(t);return _e(YA(e),10190,{key:e.toString()}),e}function ph(t,e){return D_(t.databaseId,e.path)}function $s(t,e){const n=GA(e);if(n.get(1)!==t.databaseId.projectId)throw new re(K.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new re(K.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new ae(HA(n))}function zA(t,e){return D_(t.databaseId,e)}function $A(t){const e=GA(t);return e.length===4?ze.emptyPath():HA(e)}function $m(t){return new ze(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function HA(t){return _e(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function eI(t,e,n){return{name:ph(t,e),fields:n.value.mapValue.fields}}function I4(t,e,n){const r=$s(t,e.name),i=ln(e.updateTime),s=e.createTime?ln(e.createTime):ve.min(),o=new Yt({mapValue:{fields:e.fields}}),a=_t.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function w4(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:he(39313,{state:u})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(u,f){return u.useProto3Json?(_e(f===void 0||typeof f=="string",58123),Et.fromBase64String(f||"")):(_e(f===void 0||f instanceof Buffer||f instanceof Uint8Array,16193),Et.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(u){const f=u.code===void 0?K.UNKNOWN:UA(u.code);return new re(f,u.message||"")}(o);n=new BA(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=$s(t,r.document.name),s=ln(r.document.updateTime),o=r.document.createTime?ln(r.document.createTime):ve.min(),a=new Yt({mapValue:{fields:r.document.fields}}),l=_t.newFoundDocument(i,s,o,a),u=r.targetIds||[],f=r.removedTargetIds||[];n=new Id(u,f,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=$s(t,r.document),s=r.readTime?ln(r.readTime):ve.min(),o=_t.newNoDocument(i,s),a=r.removedTargetIds||[];n=new Id([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=$s(t,r.document),s=r.removedTargetIds||[];n=new Id([],s,i,null)}else{if(!("filter"in e))return he(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new h4(i,s),a=r.targetId;n=new OA(a,o)}}return n}function mh(t,e){let n;if(e instanceof Ba)n={update:eI(t,e.key,e.value)};else if(e instanceof af)n={delete:ph(t,e.key)};else if(e instanceof ri)n={update:eI(t,e.key,e.data),updateMask:P4(e.fieldMask)};else{if(!(e instanceof FA))return he(16599,{Vt:e.type});n={verify:ph(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const a=o.transform;if(a instanceof Ca)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Aa)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof xa)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Du)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw he(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:E4(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:he(27497)}(t,e.precondition)),n}function Hm(t,e){const n=e.currentDocument?function(s){return s.updateTime!==void 0?sn.updateTime(ln(s.updateTime)):s.exists!==void 0?sn.exists(s.exists):sn.none()}(e.currentDocument):sn.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let l=null;if("setToServerValue"in a)_e(a.setToServerValue==="REQUEST_TIME",16630,{proto:a}),l=new Ca;else if("appendMissingElements"in a){const f=a.appendMissingElements.values||[];l=new Aa(f)}else if("removeAllFromArray"in a){const f=a.removeAllFromArray.values||[];l=new xa(f)}else"increment"in a?l=new Du(o,a.increment):he(16584,{proto:a});const u=ot.fromServerFormat(a.fieldPath);return new MA(u,l)}(t,i)):[];if(e.update){e.update.name;const i=$s(t,e.update.name),s=new Yt({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(l){const u=l.fieldPaths||[];return new gn(u.map(f=>ot.fromServerFormat(f)))}(e.updateMask);return new ri(i,s,o,n,r)}return new Ba(i,s,n,r)}if(e.delete){const i=$s(t,e.delete);return new af(i,n)}if(e.verify){const i=$s(t,e.verify);return new FA(i,n)}return he(1463,{proto:e})}function S4(t,e){return t&&t.length>0?(_e(e!==void 0,14353),t.map(n=>function(i,s){let o=i.updateTime?ln(i.updateTime):ln(s);return o.isEqual(ve.min())&&(o=ln(s)),new u4(o,i.transformResults||[])}(n,e))):[]}function WA(t,e){return{documents:[zA(t,e.path)]}}function KA(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=zA(t,i);const s=function(u){if(u.length!==0)return QA(je.create(u,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const o=function(u){if(u.length!==0)return u.map(f=>function(g){return{field:No(g.field),direction:A4(g.dir)}}(f))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=Gm(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{ft:n,parent:i}}function jA(t){let e=$A(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){_e(r===1,65062);const f=n.from[0];f.allDescendants?i=f.collectionId:e=e.child(f.collectionId)}let s=[];n.where&&(s=function(m){const g=JA(m);return g instanceof je&&A_(g)?g.getFilters():[g]}(n.where));let o=[];n.orderBy&&(o=function(m){return m.map(g=>function(T){return new dh(Do(T.field),function(D){switch(D){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(T.direction))}(g))}(n.orderBy));let a=null;n.limit&&(a=function(m){let g;return g=typeof m=="object"?m.value:m,Yh(g)?null:g}(n.limit));let l=null;n.startAt&&(l=function(m){const g=!!m.before,v=m.values||[];return new wa(v,g)}(n.startAt));let u=null;return n.endAt&&(u=function(m){const g=!m.before,v=m.values||[];return new wa(v,g)}(n.endAt)),QU(e,i,o,s,a,"F",l,u)}function C4(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return he(28987,{purpose:i})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function JA(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Do(n.unaryFilter.field);return Le.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Do(n.unaryFilter.field);return Le.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Do(n.unaryFilter.field);return Le.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Do(n.unaryFilter.field);return Le.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return he(61313);default:return he(60726)}}(t):t.fieldFilter!==void 0?function(n){return Le.create(Do(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return he(58110);default:return he(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return je.create(n.compositeFilter.filters.map(r=>JA(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return he(1026)}}(n.compositeFilter.op))}(t):he(30097,{filter:t})}function A4(t){return _4[t]}function x4(t){return y4[t]}function R4(t){return v4[t]}function No(t){return{fieldPath:t.canonicalString()}}function Do(t){return ot.fromServerFormat(t.fieldPath)}function QA(t){return t instanceof Le?function(n){if(n.op==="=="){if(UE(n.value))return{unaryFilter:{field:No(n.field),op:"IS_NAN"}};if(FE(n.value))return{unaryFilter:{field:No(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(UE(n.value))return{unaryFilter:{field:No(n.field),op:"IS_NOT_NAN"}};if(FE(n.value))return{unaryFilter:{field:No(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:No(n.field),op:x4(n.op),value:n.value}}}(t):t instanceof je?function(n){const r=n.getFilters().map(i=>QA(i));return r.length===1?r[0]:{compositeFilter:{op:R4(n.op),filters:r}}}(t):he(54877,{filter:t})}function P4(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function YA(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gr{constructor(e,n,r,i,s=ve.min(),o=ve.min(),a=Et.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new Gr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Gr(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Gr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Gr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XA{constructor(e){this.yt=e}}function k4(t,e){let n;if(e.document)n=I4(t.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=ae.fromSegments(e.noDocument.path),i=ro(e.noDocument.readTime);n=_t.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return he(56709);{const r=ae.fromSegments(e.unknownDocument.path),i=ro(e.unknownDocument.version);n=_t.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){const s=new He(i[0],i[1]);return ve.fromTimestamp(s)}(e.readTime)),n}function tI(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:gh(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:ph(s,o.key),fields:o.data.value.mapValue.fields,updateTime:Ra(s,o.version.toTimestamp()),createTime:Ra(s,o.createTime.toTimestamp())}}(t.yt,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:no(e.version)};else{if(!e.isUnknownDocument())return he(57904,{document:e});r.unknownDocument={path:n.path.toArray(),version:no(e.version)}}return r}function gh(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function no(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function ro(t){const e=new He(t.seconds,t.nanoseconds);return ve.fromTimestamp(e)}function Ns(t,e){const n=(e.baseMutations||[]).map(s=>Hm(t.yt,s));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map(s=>Hm(t.yt,s)),i=He.fromMillis(e.localWriteTimeMs);return new R_(e.batchId,i,n,r)}function Dl(t){const e=ro(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?ro(t.lastLimboFreeSnapshotVersion):ve.min();let r;return r=function(s){return s.documents!==void 0}(t.query)?function(s){const o=s.documents.length;return _e(o===1,1966,{count:o}),Kn(Ju($A(s.documents[0])))}(t.query):function(s){return Kn(jA(s))}(t.query),new Gr(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,Et.fromBase64String(t.resumeToken))}function ZA(t,e){const n=no(e.snapshotVersion),r=no(e.lastLimboFreeSnapshotVersion);let i;i=hh(e.target)?WA(t.yt,e.target):KA(t.yt,e.target).ft;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:to(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function ex(t){const e=jA({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?qm(e,e.limit,"L"):e}function hp(t,e){return new k_(e.largestBatchId,Hm(t.yt,e.overlayMutation))}function nI(t,e){const n=e.path.lastSegment();return[t,Zt(e.path.popLast()),n]}function rI(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:no(r.readTime),documentKey:Zt(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N4{getBundleMetadata(e,n){return iI(e).get(n).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:ro(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,n){return iI(e).put(function(i){return{bundleId:i.id,createTime:no(ln(i.createTime)),version:i.version}}(n))}getNamedQuery(e,n){return sI(e).get(n).next(r=>{if(r)return function(s){return{name:s.name,query:ex(s.bundledQuery),readTime:ro(s.readTime)}}(r)})}saveNamedQuery(e,n){return sI(e).put(function(i){return{name:i.name,readTime:no(ln(i.readTime)),bundledQuery:i.bundledQuery}}(n))}}function iI(t){return bt(t,Xh)}function sI(t){return bt(t,Zh)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uf{constructor(e,n){this.serializer=e,this.userId=n}static wt(e,n){const r=n.uid||"";return new uf(e,r)}getOverlay(e,n){return Tl(e).get(nI(this.userId,n)).next(r=>r?hp(this.serializer,r):null)}getOverlays(e,n){const r=Er();return q.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){const i=[];return r.forEach((s,o)=>{const a=new k_(n,o);i.push(this.St(e,a))}),q.waitFor(i)}removeOverlaysForBatchId(e,n,r){const i=new Set;n.forEach(o=>i.add(Zt(o.getCollectionPath())));const s=[];return i.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(Tl(e).Z(bm,a))}),q.waitFor(s)}getOverlaysForCollection(e,n,r){const i=Er(),s=Zt(n),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Tl(e).J(bm,o).next(a=>{for(const l of a){const u=hp(this.serializer,l);i.set(u.getKey(),u)}return i})}getOverlaysForCollectionGroup(e,n,r,i){const s=Er();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return Tl(e).ee({index:tA,range:a},(l,u,f)=>{const m=hp(this.serializer,u);s.size()<i||m.largestBatchId===o?(s.set(m.getKey(),m),o=m.largestBatchId):f.done()}).next(()=>s)}St(e,n){return Tl(e).put(function(i,s,o){const[a,l,u]=nI(s,o.mutation.key);return{userId:s,collectionPath:l,documentId:u,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:mh(i.yt,o.mutation)}}(this.serializer,this.userId,n))}}function Tl(t){return bt(t,ef)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D4{bt(e){return bt(e,E_)}getSessionToken(e){return this.bt(e).get("sessionToken").next(n=>{const r=n==null?void 0:n.value;return r?Et.fromUint8Array(r):Et.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.bt(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ds{constructor(){}Dt(e,n){this.Ct(e,n),n.vt()}Ct(e,n){if("nullValue"in e)this.Ft(n,5);else if("booleanValue"in e)this.Ft(n,10),n.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(n,15),n.Mt(it(e.integerValue));else if("doubleValue"in e){const r=it(e.doubleValue);isNaN(r)?this.Ft(n,13):(this.Ft(n,15),Su(r)?n.Mt(0):n.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(n,20),typeof r=="string"&&(r=Yr(r)),n.xt(`${r.seconds||""}`),n.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,n),this.Nt(n);else if("bytesValue"in e)this.Ft(n,30),n.Bt(Xr(e.bytesValue)),this.Nt(n);else if("referenceValue"in e)this.Lt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(n,45),n.Mt(r.latitude||0),n.Mt(r.longitude||0)}else"mapValue"in e?fA(e)?this.Ft(n,Number.MAX_SAFE_INTEGER):nf(e)?this.kt(e.mapValue,n):(this.qt(e.mapValue,n),this.Nt(n)):"arrayValue"in e?(this.Qt(e.arrayValue,n),this.Nt(n)):he(19022,{$t:e})}Ot(e,n){this.Ft(n,25),this.Ut(e,n)}Ut(e,n){n.xt(e)}qt(e,n){const r=e.fields||{};this.Ft(n,55);for(const i of Object.keys(r))this.Ot(i,n),this.Ct(r[i],n)}kt(e,n){var o,a;const r=e.fields||{};this.Ft(n,53);const i=Ea,s=((a=(o=r[i].arrayValue)==null?void 0:o.values)==null?void 0:a.length)||0;this.Ft(n,15),n.Mt(it(s)),this.Ot(i,n),this.Ct(r[i],n)}Qt(e,n){const r=e.values||[];this.Ft(n,50);for(const i of r)this.Ct(i,n)}Lt(e,n){this.Ft(n,37),ae.fromName(e).path.forEach(r=>{this.Ft(n,60),this.Ut(r,n)})}Ft(e,n){e.Mt(n)}Nt(e){e.Mt(2)}}Ds.Kt=new Ds;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Co=255;function b4(t){if(t===0)return 8;let e=0;return t>>4||(e+=4,t<<=4),t>>6||(e+=2,t<<=2),t>>7||(e+=1),e}function oI(t){const e=64-function(r){let i=0;for(let s=0;s<8;++s){const o=b4(255&r[s]);if(i+=o,o!==8)break}return i}(t);return Math.ceil(e/8)}class M4{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Gt(r.value),r=n.next();this.zt()}jt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Jt(r.value),r=n.next();this.Ht()}Yt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const i=n.codePointAt(0);this.Gt(240|i>>>18),this.Gt(128|63&i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i)}}this.zt()}Zt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const i=n.codePointAt(0);this.Jt(240|i>>>18),this.Jt(128|63&i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i)}}this.Ht()}Xt(e){const n=this.en(e),r=oI(n);this.tn(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}nn(e){const n=this.en(e),r=oI(n);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}rn(){this.sn(Co),this.sn(255)}_n(){this.an(Co),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const n=function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=!!(128&n[0]);n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Gt(e){const n=255&e;n===0?(this.sn(0),this.sn(255)):n===Co?(this.sn(Co),this.sn(0)):this.sn(n)}Jt(e){const n=255&e;n===0?(this.an(0),this.an(255)):n===Co?(this.an(Co),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class V4{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class L4{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class El{constructor(){this.cn=new M4,this.ln=new V4(this.cn),this.hn=new L4(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bs{constructor(e,n,r,i){this.Tn=e,this.In=n,this.En=r,this.dn=i}An(){const e=this.dn.length,n=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.dn,0),n!==e?r.set([0],this.dn.length):++r[r.length-1],new bs(this.Tn,this.In,this.En,r)}Rn(e,n,r){return{indexId:this.Tn,uid:e,arrayValue:wd(this.En),directionalValue:wd(this.dn),orderedDocumentKey:wd(n),documentKey:r.path.toArray()}}Vn(e,n,r){const i=this.Rn(e,n,r);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}}function fi(t,e){let n=t.Tn-e.Tn;return n!==0?n:(n=aI(t.En,e.En),n!==0?n:(n=aI(t.dn,e.dn),n!==0?n:ae.comparator(t.In,e.In)))}function aI(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}function wd(t){return KC()?function(n){let r="";for(let i=0;i<n.length;i++)r+=String.fromCharCode(n[i]);return r}(t):t}function lI(t){return typeof t!="string"?t:function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(t)}class uI{constructor(e){this.mn=new Qe((n,r)=>ot.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const n of e.filters){const r=n;r.isInequality()?this.mn=this.mn.add(r):this.gn.push(r)}}get pn(){return this.mn.size>1}yn(e){if(_e(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const n=km(e);if(n!==void 0&&!this.wn(n))return!1;const r=Rs(e);let i=new Set,s=0,o=0;for(;s<r.length&&this.wn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.mn.size>0){const a=this.mn.getIterator().getNext();if(!i.has(a.field.canonicalString())){const l=r[s];if(!this.Sn(a,l)||!this.bn(this.fn[o++],l))return!1}++s}for(;s<r.length;++s){const a=r[s];if(o>=this.fn.length||!this.bn(this.fn[o++],a))return!1}return!0}Dn(){if(this.pn)return null;let e=new Qe(ot.comparator);const n=[];for(const r of this.gn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new md(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new md(r.field,0))}for(const r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new md(r.field,r.dir==="asc"?0:1)));return new oh(oh.UNKNOWN_ID,this.collectionId,n,wu.empty())}wn(e){for(const n of this.gn)if(this.Sn(n,e))return!0;return!1}Sn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}bn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tx(t){var n,r;if(_e(t instanceof Le||t instanceof je,20012),t instanceof Le){if(t instanceof IA){const i=((r=(n=t.value.arrayValue)==null?void 0:n.values)==null?void 0:r.map(s=>Le.create(t.field,"==",s)))||[];return je.create(i,"or")}return t}const e=t.filters.map(i=>tx(i));return je.create(e,t.op)}function F4(t){if(t.getFilters().length===0)return[];const e=jm(tx(t));return _e(nx(e),7391),Wm(e)||Km(e)?[e]:e.getFilters()}function Wm(t){return t instanceof Le}function Km(t){return t instanceof je&&A_(t)}function nx(t){return Wm(t)||Km(t)||function(n){if(n instanceof je&&Fm(n)){for(const r of n.getFilters())if(!Wm(r)&&!Km(r))return!1;return!0}return!1}(t)}function jm(t){if(_e(t instanceof Le||t instanceof je,34018),t instanceof Le)return t;if(t.filters.length===1)return jm(t.filters[0]);const e=t.filters.map(r=>jm(r));let n=je.create(e,t.op);return n=_h(n),nx(n)?n:(_e(n instanceof je,64498),_e(Sa(n),40251),_e(n.filters.length>1,57927),n.filters.reduce((r,i)=>b_(r,i)))}function b_(t,e){let n;return _e(t instanceof Le||t instanceof je,38388),_e(e instanceof Le||e instanceof je,25473),n=t instanceof Le?e instanceof Le?function(i,s){return je.create([i,s],"and")}(t,e):cI(t,e):e instanceof Le?cI(e,t):function(i,s){if(_e(i.filters.length>0&&s.filters.length>0,48005),Sa(i)&&Sa(s))return vA(i,s.getFilters());const o=Fm(i)?i:s,a=Fm(i)?s:i,l=o.filters.map(u=>b_(u,a));return je.create(l,"or")}(t,e),_h(n)}function cI(t,e){if(Sa(e))return vA(e,t.getFilters());{const n=e.filters.map(r=>b_(t,r));return je.create(n,"or")}}function _h(t){if(_e(t instanceof Le||t instanceof je,11850),t instanceof Le)return t;const e=t.getFilters();if(e.length===1)return _h(e[0]);if(_A(t))return t;const n=e.map(i=>_h(i)),r=[];return n.forEach(i=>{i instanceof Le?r.push(i):i instanceof je&&(i.op===t.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:je.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U4{constructor(){this.Cn=new M_}addToCollectionParentIndex(e,n){return this.Cn.add(n),q.resolve()}getCollectionParents(e,n){return q.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return q.resolve()}deleteFieldIndex(e,n){return q.resolve()}deleteAllFieldIndexes(e){return q.resolve()}createTargetIndexes(e,n){return q.resolve()}getDocumentsMatchingTarget(e,n){return q.resolve(null)}getIndexType(e,n){return q.resolve(0)}getFieldIndexes(e,n){return q.resolve([])}getNextCollectionGroupToUpdate(e){return q.resolve(null)}getMinOffset(e,n){return q.resolve(Nn.min())}getMinOffsetFromCollectionGroup(e,n){return q.resolve(Nn.min())}updateCollectionGroup(e,n,r){return q.resolve()}updateIndexEntries(e,n){return q.resolve()}}class M_{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Qe(ze.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Qe(ze.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dI="IndexedDbIndexManager",Wc=new Uint8Array(0);class O4{constructor(e,n){this.databaseId=n,this.vn=new M_,this.Fn=new ni(r=>to(r),(r,i)=>Ku(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.vn.has(n)){const r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this.vn.add(n)});const s={collectionId:r,parent:Zt(i)};return hI(e).put(s)}return q.resolve()}getCollectionParents(e,n){const r=[],i=IDBKeyRange.bound([n,""],[G0(n),""],!1,!0);return hI(e).J(i).next(s=>{for(const o of s){if(o.collectionId!==n)break;r.push(Tr(o.parent))}return r})}addFieldIndex(e,n){const r=Il(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(l=>[l.fieldPath.canonicalString(),l.kind])}}(n);delete i.indexId;const s=r.add(i);if(n.indexState){const o=xo(e);return s.next(a=>{o.put(rI(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){const r=Il(e),i=xo(e),s=Ao(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=Il(e),r=Ao(e),i=xo(e);return n.Z().next(()=>r.Z()).next(()=>i.Z())}createTargetIndexes(e,n){return q.forEach(this.Mn(n),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){const s=new uI(r).Dn();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,n){const r=Ao(e);let i=!0;const s=new Map;return q.forEach(this.Mn(n),o=>this.xn(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=Ne();const a=[];return q.forEach(s,(l,u)=>{ee(dI,`Using index ${function(P){return`id=${P.indexId}|cg=${P.collectionGroup}|f=${P.fields.map(V=>`${V.fieldPath}:${V.kind}`).join(",")}`}(l)} to execute ${to(n)}`);const f=function(P,V){const U=km(V);if(U===void 0)return null;for(const O of fh(P,U.fieldPath))switch(O.op){case"array-contains-any":return O.value.arrayValue.values||[];case"array-contains":return[O.value]}return null}(u,l),m=function(P,V){const U=new Map;for(const O of Rs(V))for(const E of fh(P,O.fieldPath))switch(E.op){case"==":case"in":U.set(O.fieldPath.canonicalString(),E.value);break;case"not-in":case"!=":return U.set(O.fieldPath.canonicalString(),E.value),Array.from(U.values())}return null}(u,l),g=function(P,V){const U=[];let O=!0;for(const E of Rs(V)){const w=E.kind===0?zE(P,E.fieldPath,P.startAt):$E(P,E.fieldPath,P.startAt);U.push(w.value),O&&(O=w.inclusive)}return new wa(U,O)}(u,l),v=function(P,V){const U=[];let O=!0;for(const E of Rs(V)){const w=E.kind===0?$E(P,E.fieldPath,P.endAt):zE(P,E.fieldPath,P.endAt);U.push(w.value),O&&(O=w.inclusive)}return new wa(U,O)}(u,l),T=this.On(l,u,g),A=this.On(l,u,v),D=this.Nn(l,u,m),S=this.Bn(l.indexId,f,T,g.inclusive,A,v.inclusive,D);return q.forEach(S,I=>r.Y(I,n.limit).next(P=>{P.forEach(V=>{const U=ae.fromSegments(V.documentKey);o.has(U)||(o=o.add(U),a.push(U))})}))}).next(()=>a)}return q.resolve(null)})}Mn(e){let n=this.Fn.get(e);return n||(e.filters.length===0?n=[e]:n=F4(je.create(e.filters,"and")).map(r=>Om(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.Fn.set(e,n),n)}Bn(e,n,r,i,s,o,a){const l=(n!=null?n.length:1)*Math.max(r.length,s.length),u=l/(n!=null?n.length:1),f=[];for(let m=0;m<l;++m){const g=n?this.Ln(n[m/u]):Wc,v=this.kn(e,g,r[m%u],i),T=this.qn(e,g,s[m%u],o),A=a.map(D=>this.kn(e,g,D,!0));f.push(...this.createRange(v,T,A))}return f}kn(e,n,r,i){const s=new bs(e,ae.empty(),n,r);return i?s:s.An()}qn(e,n,r,i){const s=new bs(e,ae.empty(),n,r);return i?s.An():s}xn(e,n){const r=new uI(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(const a of s)r.yn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2;const i=this.Mn(n);return q.forEach(i,s=>this.xn(e,s).next(o=>{o?r!==0&&o.fields.length<function(l){let u=new Qe(ot.comparator),f=!1;for(const m of l.filters)for(const g of m.getFlattenedFilters())g.field.isKeyField()||(g.op==="array-contains"||g.op==="array-contains-any"?f=!0:u=u.add(g.field));for(const m of l.orderBy)m.field.isKeyField()||(u=u.add(m.field));return u.size+(f?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&i.length>1&&r===2?1:r)}Qn(e,n){const r=new El;for(const i of Rs(e)){const s=n.data.field(i.fieldPath);if(s==null)return null;const o=r.Pn(i.kind);Ds.Kt.Dt(s,o)}return r.un()}Ln(e){const n=new El;return Ds.Kt.Dt(e,n.Pn(0)),n.un()}$n(e,n){const r=new El;return Ds.Kt.Dt(ku(this.databaseId,n),r.Pn(function(s){const o=Rs(s);return o.length===0?0:o[o.length-1].kind}(e))),r.un()}Nn(e,n,r){if(r===null)return[];let i=[];i.push(new El);let s=0;for(const o of Rs(e)){const a=r[s++];for(const l of i)if(this.Un(n,o.fieldPath)&&Nu(a))i=this.Kn(i,o,a);else{const u=l.Pn(o.kind);Ds.Kt.Dt(a,u)}}return this.Wn(i)}On(e,n,r){return this.Nn(e,n,r.position)}Wn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].un();return n}Kn(e,n,r){const i=[...e],s=[];for(const o of r.arrayValue.values||[])for(const a of i){const l=new El;l.seed(a.un()),Ds.Kt.Dt(o,l.Pn(n.kind)),s.push(l)}return s}Un(e,n){return!!e.filters.find(r=>r instanceof Le&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=Il(e),i=xo(e);return(n?r.J(Dm,IDBKeyRange.bound(n,n)):r.J()).next(s=>{const o=[];return q.forEach(s,a=>i.get([a.indexId,this.uid]).next(l=>{o.push(function(f,m){const g=m?new wu(m.sequenceNumber,new Nn(ro(m.readTime),new ae(Tr(m.documentKey)),m.largestBatchId)):wu.empty(),v=f.fields.map(([T,A])=>new md(ot.fromServerFormat(T),A));return new oh(f.indexId,f.collectionGroup,v,g)}(a,l))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:Ae(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const i=Il(e),s=xo(e);return this.Gn(e).next(o=>i.J(Dm,IDBKeyRange.bound(n,n)).next(a=>q.forEach(a,l=>s.put(rI(l.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){const r=new Map;return q.forEach(n,(i,s)=>{const o=r.get(i.collectionGroup);return(o?q.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),q.forEach(a,l=>this.zn(e,i,l).next(u=>{const f=this.jn(s,l);return u.isEqual(f)?q.resolve():this.Jn(e,s,l,u,f)}))))})}Hn(e,n,r,i){return Ao(e).put(i.Rn(this.uid,this.$n(r,n.key),n.key))}Yn(e,n,r,i){return Ao(e).delete(i.Vn(this.uid,this.$n(r,n.key),n.key))}zn(e,n,r){const i=Ao(e);let s=new Qe(fi);return i.ee({index:eA,range:IDBKeyRange.only([r.indexId,this.uid,wd(this.$n(r,n))])},(o,a)=>{s=s.add(new bs(r.indexId,n,lI(a.arrayValue),lI(a.directionalValue)))}).next(()=>s)}jn(e,n){let r=new Qe(fi);const i=this.Qn(n,e);if(i==null)return r;const s=km(n);if(s!=null){const o=e.data.field(s.fieldPath);if(Nu(o))for(const a of o.arrayValue.values||[])r=r.add(new bs(n.indexId,e.key,this.Ln(a),i))}else r=r.add(new bs(n.indexId,e.key,Wc,i));return r}Jn(e,n,r,i,s){ee(dI,"Updating index entries for document '%s'",n.key);const o=[];return function(l,u,f,m,g){const v=l.getIterator(),T=u.getIterator();let A=So(v),D=So(T);for(;A||D;){let S=!1,I=!1;if(A&&D){const P=f(A,D);P<0?I=!0:P>0&&(S=!0)}else A!=null?I=!0:S=!0;S?(m(D),D=So(T)):I?(g(A),A=So(v)):(A=So(v),D=So(T))}}(i,s,fi,a=>{o.push(this.Hn(e,n,r,a))},a=>{o.push(this.Yn(e,n,r,a))}),q.waitFor(o)}Gn(e){let n=1;return xo(e).ee({index:Z0,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>fi(o,a)).filter((o,a,l)=>!a||fi(o,l[a-1])!==0);const i=[];i.push(e);for(const o of r){const a=fi(o,e),l=fi(o,n);if(a===0)i[0]=e.An();else if(a>0&&l<0)i.push(o),i.push(o.An());else if(l>0)break}i.push(n);const s=[];for(let o=0;o<i.length;o+=2){if(this.Zn(i[o],i[o+1]))return[];const a=i[o].Vn(this.uid,Wc,ae.empty()),l=i[o+1].Vn(this.uid,Wc,ae.empty());s.push(IDBKeyRange.bound(a,l))}return s}Zn(e,n){return fi(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(fI)}getMinOffset(e,n){return q.mapArray(this.Mn(n),r=>this.xn(e,r).next(i=>i||he(44426))).next(fI)}}function hI(t){return bt(t,xu)}function Ao(t){return bt(t,Ql)}function Il(t){return bt(t,T_)}function xo(t){return bt(t,Jl)}function fI(t){_e(t.length!==0,28825);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const i=t[r].indexState.offset;__(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new Nn(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pI={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},rx=41943040;class Jt{static withCacheSize(e){return new Jt(e,Jt.DEFAULT_COLLECTION_PERCENTILE,Jt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ix(t,e,n){const r=t.store(Zn),i=t.store(_a),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const l=r.ee({range:o},(f,m,g)=>(a++,g.delete()));s.push(l.next(()=>{_e(a===1,47070,{batchId:n.batchId})}));const u=[];for(const f of n.mutations){const m=Q0(e,f.key.path,n.batchId);s.push(i.delete(m)),u.push(f.key)}return q.waitFor(s).next(()=>u)}function yh(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw he(14731);e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Jt.DEFAULT_COLLECTION_PERCENTILE=10,Jt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Jt.DEFAULT=new Jt(rx,Jt.DEFAULT_COLLECTION_PERCENTILE,Jt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Jt.DISABLED=new Jt(-1,0,0);class cf{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Xn={}}static wt(e,n,r,i){_e(e.uid!=="",64387);const s=e.isAuthenticated()?e.uid:"";return new cf(s,n,r,i)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return pi(e).ee({index:Us,range:r},(i,s,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,i){const s=bo(e),o=pi(e);return o.add({}).next(a=>{_e(typeof a=="number",49019);const l=new R_(a,n,r,i),u=function(v,T,A){const D=A.baseMutations.map(I=>mh(v.yt,I)),S=A.mutations.map(I=>mh(v.yt,I));return{userId:T,batchId:A.batchId,localWriteTimeMs:A.localWriteTime.toMillis(),baseMutations:D,mutations:S}}(this.serializer,this.userId,l),f=[];let m=new Qe((g,v)=>Ae(g.canonicalString(),v.canonicalString()));for(const g of i){const v=Q0(this.userId,g.key.path,a);m=m.add(g.key.path.popLast()),f.push(o.put(u)),f.push(s.put(v,pU))}return m.forEach(g=>{f.push(this.indexManager.addToCollectionParentIndex(e,g))}),e.addOnCommittedListener(()=>{this.Xn[a]=l.keys()}),q.waitFor(f).next(()=>l)})}lookupMutationBatch(e,n){return pi(e).get(n).next(r=>r?(_e(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:n}),Ns(this.serializer,r)):null)}er(e,n){return this.Xn[n]?q.resolve(this.Xn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const i=r.keys();return this.Xn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return pi(e).ee({index:Us,range:i},(o,a,l)=>{a.userId===this.userId&&(_e(a.batchId>=r,47524,{tr:r}),s=Ns(this.serializer,a)),l.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=Gs;return pi(e).ee({index:Us,range:n,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,Gs],[this.userId,Number.POSITIVE_INFINITY]);return pi(e).J(Us,n).next(r=>r.map(i=>Ns(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=gd(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return bo(e).ee({range:i},(o,a,l)=>{const[u,f,m]=o,g=Tr(f);if(u===this.userId&&n.path.isEqual(g))return pi(e).get(m).next(v=>{if(!v)throw he(61480,{nr:o,batchId:m});_e(v.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:v.userId,batchId:m}),s.push(Ns(this.serializer,v))});l.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Qe(Ae);const i=[];return n.forEach(s=>{const o=gd(this.userId,s.path),a=IDBKeyRange.lowerBound(o),l=bo(e).ee({range:a},(u,f,m)=>{const[g,v,T]=u,A=Tr(v);g===this.userId&&s.path.isEqual(A)?r=r.add(T):m.done()});i.push(l)}),q.waitFor(i).next(()=>this.rr(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1,s=gd(this.userId,r),o=IDBKeyRange.lowerBound(s);let a=new Qe(Ae);return bo(e).ee({range:o},(l,u,f)=>{const[m,g,v]=l,T=Tr(g);m===this.userId&&r.isPrefixOf(T)?T.length===i&&(a=a.add(v)):f.done()}).next(()=>this.rr(e,a))}rr(e,n){const r=[],i=[];return n.forEach(s=>{i.push(pi(e).get(s).next(o=>{if(o===null)throw he(35274,{batchId:s});_e(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:s}),r.push(Ns(this.serializer,o))}))}),q.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return ix(e.le,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.ir(n.batchId)}),q.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return q.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return bo(e).ee({range:r},(s,o,a)=>{if(s[0]===this.userId){const l=Tr(s[1]);i.push(l)}else a.done()}).next(()=>{_e(i.length===0,56720,{sr:i.map(s=>s.canonicalString())})})})}containsKey(e,n){return sx(e,this.userId,n)}_r(e){return ox(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:Gs,lastStreamToken:""})}}function sx(t,e,n){const r=gd(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return bo(t).ee({range:s,X:!0},(a,l,u)=>{const[f,m,g]=a;f===e&&m===i&&(o=!0),u.done()}).next(()=>o)}function pi(t){return bt(t,Zn)}function bo(t){return bt(t,_a)}function ox(t){return bt(t,Cu)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class io{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new io(0)}static cr(){return new io(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B4{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.lr(e).next(n=>{const r=new io(n.highestTargetId);return n.highestTargetId=r.next(),this.hr(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.lr(e).next(n=>ve.fromTimestamp(new He(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.lr(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.lr(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.hr(e,i)))}addTargetData(e,n){return this.Pr(e,n).next(()=>this.lr(e).next(r=>(r.targetCount+=1,this.Tr(n,r),this.hr(e,r))))}updateTargetData(e,n){return this.Pr(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>Ro(e).delete(n.targetId)).next(()=>this.lr(e)).next(r=>(_e(r.targetCount>0,8065),r.targetCount-=1,this.hr(e,r)))}removeTargets(e,n,r){let i=0;const s=[];return Ro(e).ee((o,a)=>{const l=Dl(a);l.sequenceNumber<=n&&r.get(l.targetId)===null&&(i++,s.push(this.removeTargetData(e,l)))}).next(()=>q.waitFor(s)).next(()=>i)}forEachTarget(e,n){return Ro(e).ee((r,i)=>{const s=Dl(i);n(s)})}lr(e){return mI(e).get(uh).next(n=>(_e(n!==null,2888),n))}hr(e,n){return mI(e).put(uh,n)}Pr(e,n){return Ro(e).put(ZA(this.serializer,n))}Tr(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next(n=>n.targetCount)}getTargetData(e,n){const r=to(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return Ro(e).ee({range:i,index:X0},(o,a,l)=>{const u=Dl(a);Ku(n,u.target)&&(s=u,l.done())}).next(()=>s)}addMatchingKeys(e,n,r){const i=[],s=xi(e);return n.forEach(o=>{const a=Zt(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),q.waitFor(i)}removeMatchingKeys(e,n,r){const i=xi(e);return q.forEach(n,s=>{const o=Zt(s.path);return q.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){const r=xi(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),i=xi(e);let s=Ne();return i.ee({range:r,X:!0},(o,a,l)=>{const u=Tr(o[1]),f=new ae(u);s=s.add(f)}).next(()=>s)}containsKey(e,n){const r=Zt(n.path),i=IDBKeyRange.bound([r],[G0(r)],!1,!0);let s=0;return xi(e).ee({index:v_,X:!0,range:i},([o,a],l,u)=>{o!==0&&(s++,u.done())}).next(()=>s>0)}At(e,n){return Ro(e).get(n).next(r=>r?Dl(r):null)}}function Ro(t){return bt(t,ya)}function mI(t){return bt(t,zs)}function xi(t){return bt(t,va)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gI="LruGarbageCollector",q4=1048576;function _I([t,e],[n,r]){const i=Ae(t,n);return i===0?Ae(e,r):i}class G4{constructor(e){this.Ir=e,this.buffer=new Qe(_I),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();_I(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class ax{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){ee(gI,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){ss(n)?ee(gI,"Ignoring IndexedDB error during garbage collection: ",n):await uo(n)}await this.Vr(3e5)})}}class z4{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return q.resolve($n.ce);const r=new G4(n);return this.mr.forEachTarget(e,i=>r.Ar(i.sequenceNumber)).next(()=>this.mr.pr(e,i=>r.Ar(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.mr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(ee("LruGarbageCollector","Garbage collection skipped; disabled"),q.resolve(pI)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(ee("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),pI):this.yr(e,n))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let r,i,s,o,a,l,u;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(m=>(m>this.params.maximumSequenceNumbersToCollect?(ee("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),i=this.params.maximumSequenceNumbersToCollect):i=m,o=Date.now(),this.nthSequenceNumber(e,i))).next(m=>(r=m,a=Date.now(),this.removeTargets(e,r,n))).next(m=>(s=m,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(m=>(u=Date.now(),Po()<=Ve.DEBUG&&ee("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-f}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(l-a)+`ms
	Removed ${m} documents in `+(u-l)+`ms
Total Duration: ${u-f}ms`),q.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:m})))}}function lx(t,e){return new z4(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $4{constructor(e,n){this.db=e,this.garbageCollector=lx(this,n)}gr(e){const n=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}pr(e,n){return this.Sr(e,(r,i)=>n(i))}addReference(e,n,r){return Kc(e,r)}removeReference(e,n,r){return Kc(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return Kc(e,n)}br(e,n){return function(i,s){let o=!1;return ox(i).te(a=>sx(i,a,s).next(l=>(l&&(o=!0),q.resolve(!l)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Sr(e,(o,a)=>{if(a<=n){const l=this.br(e,o).next(u=>{if(!u)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,ve.min()),xi(e).delete(function(m){return[0,Zt(m.path)]}(o))))});i.push(l)}}).next(()=>q.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return Kc(e,n)}Sr(e,n){const r=xi(e);let i,s=$n.ce;return r.ee({index:v_},([o,a],{path:l,sequenceNumber:u})=>{o===0?(s!==$n.ce&&n(new ae(Tr(i)),s),s=u,i=l):s=$n.ce}).next(()=>{s!==$n.ce&&n(new ae(Tr(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Kc(t,e){return xi(t).put(function(r,i){return{targetId:0,path:Zt(r.path),sequenceNumber:i}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ux{constructor(){this.changes=new ni(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,_t.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?q.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H4{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return Ss(e).put(r)}removeEntry(e,n,r){return Ss(e).delete(function(s,o){const a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],gh(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.Dr(e,r)))}getEntry(e,n){let r=_t.newInvalidDocument(n);return Ss(e).ee({index:_d,range:IDBKeyRange.only(wl(n))},(i,s)=>{r=this.Cr(n,s)}).next(()=>r)}vr(e,n){let r={size:0,document:_t.newInvalidDocument(n)};return Ss(e).ee({index:_d,range:IDBKeyRange.only(wl(n))},(i,s)=>{r={document:this.Cr(n,s),size:yh(s)}}).next(()=>r)}getEntries(e,n){let r=Rn();return this.Fr(e,n,(i,s)=>{const o=this.Cr(i,s);r=r.insert(i,o)}).next(()=>r)}Mr(e,n){let r=Rn(),i=new at(ae.comparator);return this.Fr(e,n,(s,o)=>{const a=this.Cr(s,o);r=r.insert(s,a),i=i.insert(s,yh(o))}).next(()=>({documents:r,Or:i}))}Fr(e,n,r){if(n.isEmpty())return q.resolve();let i=new Qe(TI);n.forEach(l=>i=i.add(l));const s=IDBKeyRange.bound(wl(i.first()),wl(i.last())),o=i.getIterator();let a=o.getNext();return Ss(e).ee({index:_d,range:s},(l,u,f)=>{const m=ae.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;a&&TI(a,m)<0;)r(a,null),a=o.getNext();a&&a.isEqual(m)&&(r(a,u),a=o.hasNext()?o.getNext():null),a?f.j(wl(a)):f.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,s){const o=n.path,a=[o.popLast().toArray(),o.lastSegment(),gh(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Ss(e).J(IDBKeyRange.bound(a,l,!0)).next(u=>{s==null||s.incrementDocumentReadCount(u.length);let f=Rn();for(const m of u){const g=this.Cr(ae.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);g.isFoundDocument()&&(Qu(n,g)||i.has(g.key))&&(f=f.insert(g.key,g))}return f})}getAllFromCollectionGroup(e,n,r,i){let s=Rn();const o=vI(n,r),a=vI(n,Nn.max());return Ss(e).ee({index:Y0,range:IDBKeyRange.bound(o,a,!0)},(l,u,f)=>{const m=this.Cr(ae.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);s=s.insert(m.key,m),s.size===i&&f.done()}).next(()=>s)}newChangeBuffer(e){return new W4(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return yI(e).get(Nm).next(n=>(_e(!!n,20021),n))}Dr(e,n){return yI(e).put(Nm,n)}Cr(e,n){if(n){const r=k4(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(ve.min())))return r}return _t.newInvalidDocument(e)}}function cx(t){return new H4(t)}class W4 extends ux{constructor(e,n){super(),this.Nr=e,this.trackRemovals=n,this.Br=new ni(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const n=[];let r=0,i=new Qe((s,o)=>Ae(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const a=this.Br.get(s);if(n.push(this.Nr.removeEntry(e,s,a.readTime)),o.isValidDocument()){const l=tI(this.Nr.serializer,o);i=i.add(s.path.popLast());const u=yh(l);r+=u-a.size,n.push(this.Nr.addEntry(e,s,l))}else if(r-=a.size,this.trackRemovals){const l=tI(this.Nr.serializer,o.convertToNoDocument(ve.min()));n.push(this.Nr.addEntry(e,s,l))}}),i.forEach(s=>{n.push(this.Nr.indexManager.addToCollectionParentIndex(e,s))}),n.push(this.Nr.updateMetadata(e,r)),q.waitFor(n)}getFromCache(e,n){return this.Nr.vr(e,n).next(r=>(this.Br.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.Nr.Mr(e,n).next(({documents:r,Or:i})=>(i.forEach((s,o)=>{this.Br.set(s,{size:o,readTime:r.get(s).readTime})}),r))}}function yI(t){return bt(t,Au)}function Ss(t){return bt(t,lh)}function wl(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function vI(t,e){const n=e.documentKey.path.toArray();return[t,gh(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function TI(t,e){const n=t.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=Ae(n[s],r[s]),i)return i;return i=Ae(n.length,r.length),i||(i=Ae(n[n.length-2],r[r.length-2]),i||Ae(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K4{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dx{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&eu(r.mutation,i,gn.empty(),He.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Ne()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Ne()){const i=Er();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=kl();return s.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=Er();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Ne()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=Rn();const o=Zl(),a=function(){return Zl()}();return n.forEach((l,u)=>{const f=r.get(u.key);i.has(u.key)&&(f===void 0||f.mutation instanceof ri)?s=s.insert(u.key,u):f!==void 0?(o.set(u.key,f.mutation.getFieldMask()),eu(f.mutation,u,f.mutation.getFieldMask(),He.now())):o.set(u.key,gn.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((u,f)=>o.set(u,f)),n.forEach((u,f)=>a.set(u,new K4(f,o.get(u)??null))),a))}recalculateAndSaveOverlays(e,n){const r=Zl();let i=new at((o,a)=>o-a),s=Ne();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const u=n.get(l);if(u===null)return;let f=r.get(l)||gn.empty();f=a.applyToLocalView(u,f),r.set(l,f);const m=(i.get(a.batchId)||Ne()).add(l);i=i.insert(a.batchId,m)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),u=l.key,f=l.value,m=RA();f.forEach(g=>{if(!s.has(g)){const v=VA(n.get(g),r.get(g));v!==null&&m.set(g,v),s=s.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,m))}return q.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return ae.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):wA(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):q.resolve(Er());let a=Iu,l=s;return o.next(u=>q.forEach(u,(f,m)=>(a<m.largestBatchId&&(a=m.largestBatchId),s.get(f)?q.resolve():this.remoteDocumentCache.getEntry(e,f).next(g=>{l=l.insert(f,g)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,l,u,Ne())).next(f=>({batchId:a,changes:xA(f)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new ae(n)).next(r=>{let i=kl();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let o=kl();return this.indexManager.getCollectionParents(e,s).next(a=>q.forEach(a,l=>{const u=function(m,g){return new ju(g,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(n,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,r,i).next(f=>{f.forEach((m,g)=>{o=o.insert(m,g)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((l,u)=>{const f=u.getKey();o.get(f)===null&&(o=o.insert(f,_t.newInvalidDocument(f)))});let a=kl();return o.forEach((l,u)=>{const f=s.get(l);f!==void 0&&eu(f.mutation,u,gn.empty(),He.now()),Qu(n,u)&&(a=a.insert(l,u))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j4{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return q.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:ln(i.createTime)}}(n)),q.resolve()}getNamedQuery(e,n){return q.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,function(i){return{name:i.name,query:ex(i.bundledQuery),readTime:ln(i.readTime)}}(n)),q.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J4{constructor(){this.overlays=new at(ae.comparator),this.qr=new Map}getOverlay(e,n){return q.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Er();return q.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.St(e,n,s)}),q.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.qr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.qr.delete(r)),q.resolve()}getOverlaysForCollection(e,n,r){const i=Er(),s=n.length+1,o=new ae(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,u=l.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return q.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new at((u,f)=>u-f);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let f=s.get(u.largestBatchId);f===null&&(f=Er(),s=s.insert(u.largestBatchId,f)),f.set(u.getKey(),u)}}const a=Er(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((u,f)=>a.set(u,f)),!(a.size()>=i)););return q.resolve(a)}St(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new k_(n,r));let s=this.qr.get(n);s===void 0&&(s=Ne(),this.qr.set(n,s)),this.qr.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q4{constructor(){this.sessionToken=Et.EMPTY_BYTE_STRING}getSessionToken(e){return q.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,q.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V_{constructor(){this.Qr=new Qe(Ft.$r),this.Ur=new Qe(Ft.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const r=new Ft(e,n);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Gr(new Ft(e,n))}zr(e,n){e.forEach(r=>this.removeReference(r,n))}jr(e){const n=new ae(new ze([])),r=new Ft(n,e),i=new Ft(n,e+1),s=[];return this.Ur.forEachInRange([r,i],o=>{this.Gr(o),s.push(o.key)}),s}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new ae(new ze([])),r=new Ft(n,e),i=new Ft(n,e+1);let s=Ne();return this.Ur.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const n=new Ft(e,0),r=this.Qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Ft{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return ae.comparator(e.key,n.key)||Ae(e.Yr,n.Yr)}static Kr(e,n){return Ae(e.Yr,n.Yr)||ae.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y4{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new Qe(Ft.$r)}checkEmpty(e){return q.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new R_(s,n,r,i);this.mutationQueue.push(o);for(const a of i)this.Zr=this.Zr.add(new Ft(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return q.resolve(o)}lookupMutationBatch(e,n){return q.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.ei(r),s=i<0?0:i;return q.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return q.resolve(this.mutationQueue.length===0?Gs:this.tr-1)}getAllMutationBatches(e){return q.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Ft(n,0),i=new Ft(n,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([r,i],o=>{const a=this.Xr(o.Yr);s.push(a)}),q.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Qe(Ae);return n.forEach(i=>{const s=new Ft(i,0),o=new Ft(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,o],a=>{r=r.add(a.Yr)})}),q.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;ae.isDocumentKey(s)||(s=s.child(""));const o=new Ft(new ae(s),0);let a=new Qe(Ae);return this.Zr.forEachWhile(l=>{const u=l.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(a=a.add(l.Yr)),!0)},o),q.resolve(this.ti(a))}ti(e){const n=[];return e.forEach(r=>{const i=this.Xr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){_e(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return q.forEach(n.mutations,i=>{const s=new Ft(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,n){const r=new Ft(n,0),i=this.Zr.firstAfterOrEqual(r);return q.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,q.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X4{constructor(e){this.ri=e,this.docs=function(){return new at(ae.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.ri(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return q.resolve(r?r.document.mutableCopy():_t.newInvalidDocument(n))}getEntries(e,n){let r=Rn();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():_t.newInvalidDocument(i))}),q.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=Rn();const o=n.path,a=new ae(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:u,value:{document:f}}=l.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||__(W0(f),r)<=0||(i.has(f.key)||Qu(n,f))&&(s=s.insert(f.key,f.mutableCopy()))}return q.resolve(s)}getAllFromCollectionGroup(e,n,r,i){he(9500)}ii(e,n){return q.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new Z4(this)}getSize(e){return q.resolve(this.size)}}class Z4 extends ux{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)}),q.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eO{constructor(e){this.persistence=e,this.si=new ni(n=>to(n),Ku),this.lastRemoteSnapshotVersion=ve.min(),this.highestTargetId=0,this.oi=0,this._i=new V_,this.targetCount=0,this.ai=io.ur()}forEachTarget(e,n){return this.si.forEach((r,i)=>n(i)),q.resolve()}getLastRemoteSnapshotVersion(e){return q.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return q.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),q.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.oi&&(this.oi=n),q.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new io(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,q.resolve()}updateTargetData(e,n){return this.Pr(n),q.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,q.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.si.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.si.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),q.waitFor(s).next(()=>i)}getTargetCount(e){return q.resolve(this.targetCount)}getTargetData(e,n){const r=this.si.get(n)||null;return q.resolve(r)}addMatchingKeys(e,n,r){return this._i.Wr(n,r),q.resolve()}removeMatchingKeys(e,n,r){this._i.zr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),q.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),q.resolve()}getMatchingKeysForTargetId(e,n){const r=this._i.Hr(n);return q.resolve(r)}containsKey(e,n){return q.resolve(this._i.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L_{constructor(e,n){this.ui={},this.overlays={},this.ci=new $n(0),this.li=!1,this.li=!0,this.hi=new Q4,this.referenceDelegate=e(this),this.Pi=new eO(this),this.indexManager=new U4,this.remoteDocumentCache=function(i){return new X4(i)}(r=>this.referenceDelegate.Ti(r)),this.serializer=new XA(n),this.Ii=new j4(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new J4,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ui[e.toKey()];return r||(r=new Y4(n,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,r){ee("MemoryPersistence","Starting transaction:",e);const i=new tO(this.ci.next());return this.referenceDelegate.Ei(),r(i).next(s=>this.referenceDelegate.di(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ai(e,n){return q.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,n)))}}class tO extends j0{constructor(e){super(),this.currentSequenceNumber=e}}class df{constructor(e){this.persistence=e,this.Ri=new V_,this.Vi=null}static mi(e){return new df(e)}get fi(){if(this.Vi)return this.Vi;throw he(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.fi.delete(r.toString()),q.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.fi.add(r.toString()),q.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),q.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach(i=>this.fi.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.fi.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return q.forEach(this.fi,r=>{const i=ae.fromPath(r);return this.gi(e,i).next(s=>{s||n.removeEntry(i,ve.min())})}).next(()=>(this.Vi=null,n.apply(e)))}updateLimboDocument(e,n){return this.gi(e,n).next(r=>{r?this.fi.delete(n.toString()):this.fi.add(n.toString())})}Ti(e){return 0}gi(e,n){return q.or([()=>q.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class vh{constructor(e,n){this.persistence=e,this.pi=new ni(r=>Zt(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=lx(this,n)}static mi(e,n){return new vh(e,n)}Ei(){}di(e){return q.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}pr(e,n){return q.forEach(this.pi,(r,i)=>this.br(e,r,i).next(s=>s?q.resolve():n(i)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ii(e,o=>this.br(e,o,n).next(a=>{a||(r++,s.removeEntry(o,ve.min()))})).next(()=>s.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),q.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),q.resolve()}removeReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),q.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),q.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=vd(e.data.value)),n}br(e,n,r){return q.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const i=this.pi.get(n);return q.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nO{constructor(e){this.serializer=e}k(e,n,r,i){const s=new Qh("createOrUpgrade",n);r<1&&i>=1&&(function(l){l.createObjectStore(Wu)}(e),function(l){l.createObjectStore(Cu,{keyPath:fU}),l.createObjectStore(Zn,{keyPath:NE,autoIncrement:!0}).createIndex(Us,DE,{unique:!0}),l.createObjectStore(_a)}(e),EI(e),function(l){l.createObjectStore(Ps)}(e));let o=q.resolve();return r<3&&i>=3&&(r!==0&&(function(l){l.deleteObjectStore(va),l.deleteObjectStore(ya),l.deleteObjectStore(zs)}(e),EI(e)),o=o.next(()=>function(l){const u=l.store(zs),f={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:ve.min().toTimestamp(),targetCount:0};return u.put(uh,f)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(l,u){return u.store(Zn).J().next(m=>{l.deleteObjectStore(Zn),l.createObjectStore(Zn,{keyPath:NE,autoIncrement:!0}).createIndex(Us,DE,{unique:!0});const g=u.store(Zn),v=m.map(T=>g.put(T));return q.waitFor(v)})}(e,s))),o=o.next(()=>{(function(l){l.createObjectStore(Ta,{keyPath:IU})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.yi(s))),r<6&&i>=6&&(o=o.next(()=>(function(l){l.createObjectStore(Au)}(e),this.wi(s)))),r<7&&i>=7&&(o=o.next(()=>this.Si(s))),r<8&&i>=8&&(o=o.next(()=>this.bi(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.Di(s))),r<11&&i>=11&&(o=o.next(()=>{(function(l){l.createObjectStore(Xh,{keyPath:wU})})(e),function(l){l.createObjectStore(Zh,{keyPath:SU})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(l){const u=l.createObjectStore(ef,{keyPath:NU});u.createIndex(bm,DU,{unique:!1}),u.createIndex(tA,bU,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(l){const u=l.createObjectStore(lh,{keyPath:mU});u.createIndex(_d,gU),u.createIndex(Y0,_U)}(e)).next(()=>this.Ci(e,s)).next(()=>e.deleteObjectStore(Ps))),r<14&&i>=14&&(o=o.next(()=>this.Fi(e,s))),r<15&&i>=15&&(o=o.next(()=>function(l){l.createObjectStore(T_,{keyPath:CU,autoIncrement:!0}).createIndex(Dm,AU,{unique:!1}),l.createObjectStore(Jl,{keyPath:xU}).createIndex(Z0,RU,{unique:!1}),l.createObjectStore(Ql,{keyPath:PU}).createIndex(eA,kU,{unique:!1})}(e))),r<16&&i>=16&&(o=o.next(()=>{n.objectStore(Jl).clear()}).next(()=>{n.objectStore(Ql).clear()})),r<17&&i>=17&&(o=o.next(()=>{(function(l){l.createObjectStore(E_,{keyPath:MU})})(e)})),r<18&&i>=18&&KC()&&(o=o.next(()=>{n.objectStore(Jl).clear()}).next(()=>{n.objectStore(Ql).clear()})),o}wi(e){let n=0;return e.store(Ps).ee((r,i)=>{n+=yh(i)}).next(()=>{const r={byteSize:n};return e.store(Au).put(Nm,r)})}yi(e){const n=e.store(Cu),r=e.store(Zn);return n.J().next(i=>q.forEach(i,s=>{const o=IDBKeyRange.bound([s.userId,Gs],[s.userId,s.lastAcknowledgedBatchId]);return r.J(Us,o).next(a=>q.forEach(a,l=>{_e(l.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:l.batchId});const u=Ns(this.serializer,l);return ix(e,s.userId,u).next(()=>{})}))}))}Si(e){const n=e.store(va),r=e.store(Ps);return e.store(zs).get(uh).next(i=>{const s=[];return r.ee((o,a)=>{const l=new ze(o),u=function(m){return[0,Zt(m)]}(l);s.push(n.get(u).next(f=>f?q.resolve():(m=>n.put({targetId:0,path:Zt(m),sequenceNumber:i.highestListenSequenceNumber}))(l)))}).next(()=>q.waitFor(s))})}bi(e,n){e.createObjectStore(xu,{keyPath:EU});const r=n.store(xu),i=new M_,s=o=>{if(i.add(o)){const a=o.lastSegment(),l=o.popLast();return r.put({collectionId:a,parent:Zt(l)})}};return n.store(Ps).ee({X:!0},(o,a)=>{const l=new ze(o);return s(l.popLast())}).next(()=>n.store(_a).ee({X:!0},([o,a,l],u)=>{const f=Tr(a);return s(f.popLast())}))}Di(e){const n=e.store(ya);return n.ee((r,i)=>{const s=Dl(i),o=ZA(this.serializer,s);return n.put(o)})}Ci(e,n){const r=n.store(Ps),i=[];return r.ee((s,o)=>{const a=n.store(lh),l=function(m){return m.document?new ae(ze.fromString(m.document.name).popFirst(5)):m.noDocument?ae.fromSegments(m.noDocument.path):m.unknownDocument?ae.fromSegments(m.unknownDocument.path):he(36783)}(o).path.toArray(),u={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(u))}).next(()=>q.waitFor(i))}Fi(e,n){const r=n.store(Zn),i=cx(this.serializer),s=new L_(df.mi,this.serializer.yt);return r.J().next(o=>{const a=new Map;return o.forEach(l=>{let u=a.get(l.userId)??Ne();Ns(this.serializer,l).keys().forEach(f=>u=u.add(f)),a.set(l.userId,u)}),q.forEach(a,(l,u)=>{const f=new Gt(u),m=uf.wt(this.serializer,f),g=s.getIndexManager(f),v=cf.wt(f,this.serializer,g,s.referenceDelegate);return new dx(i,v,m,g).recalculateAndSaveOverlaysForDocumentKeys(new Mm(n,$n.ce),l).next()})})}}function EI(t){t.createObjectStore(va,{keyPath:vU}).createIndex(v_,TU,{unique:!0}),t.createObjectStore(ya,{keyPath:"targetId"}).createIndex(X0,yU,{unique:!0}),t.createObjectStore(zs)}const mi="IndexedDbPersistence",fp=18e5,pp=5e3,mp="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",rO="main";class F_{constructor(e,n,r,i,s,o,a,l,u,f,m=18){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Mi=s,this.window=o,this.document=a,this.xi=u,this.Oi=f,this.Ni=m,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=g=>Promise.resolve(),!F_.v())throw new re(K.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new $4(this,i),this.$i=n+rO,this.serializer=new XA(l),this.Ui=new zi(this.$i,this.Ni,new nO(this.serializer)),this.hi=new D4,this.Pi=new B4(this.referenceDelegate,this.serializer),this.remoteDocumentCache=cx(this.serializer),this.Ii=new N4,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,f===!1&&rn(mi,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new re(K.FAILED_PRECONDITION,mp);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Pi.getHighestSequenceNumber(e))}).then(e=>{this.ci=new $n(e,this.xi)}).then(()=>{this.li=!0}).catch(e=>(this.Ui&&this.Ui.close(),Promise.reject(e)))}Ji(e){return this.Qi=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget(async()=>{this.started&&await this.Wi()}))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>jc(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Hi(e).next(n=>{n||(this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)))})}).next(()=>this.Yi(e)).next(n=>this.isPrimary&&!n?this.Zi(e).next(()=>!1):!!n&&this.Xi(e).next(()=>!0))).catch(e=>{if(ss(e))return ee(mi,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return ee(mi,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable(()=>this.Qi(e)),this.isPrimary=e})}Hi(e){return Sl(e).get(wo).next(n=>q.resolve(this.es(n)))}ts(e){return jc(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,fp)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=bt(n,Ta);return r.J().next(i=>{const s=this.ss(i,fp),o=i.filter(a=>s.indexOf(a)===-1);return q.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Ki)for(const n of e)this.Ki.removeItem(this._s(n.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Wi().then(()=>this.ns()).then(()=>this.ji()))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?q.resolve(!0):Sl(e).get(wo).next(n=>{if(n!==null&&this.rs(n.leaseTimestampMs,pp)&&!this.us(n.ownerId)){if(this.es(n)&&this.networkEnabled)return!0;if(!this.es(n)){if(!n.allowTabSynchronization)throw new re(K.FAILED_PRECONDITION,mp);return!1}}return!(!this.networkEnabled||!this.inForeground)||jc(e).J().next(r=>this.ss(r,pp).find(i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&ee(mi,`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[Wu,Ta],e=>{const n=new Mm(e,$n.ce);return this.Zi(n).next(()=>this.ts(n))}),this.Ui.close(),this.Ps()}ss(e,n){return e.filter(r=>this.rs(r.updateTimeMs,n)&&!this.us(r.clientId))}Ts(){return this.runTransaction("getActiveClients","readonly",e=>jc(e).J().next(n=>this.ss(n,fp).map(r=>r.clientId)))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,n){return cf.wt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new O4(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return uf.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,n,r){ee(mi,"Starting transaction:",e);const i=n==="readonly"?"readonly":"readwrite",s=function(l){return l===18?FU:l===17?sA:l===16?LU:l===15?I_:l===14?iA:l===13?rA:l===12?VU:l===11?nA:void he(60245)}(this.Ni);let o;return this.Ui.runTransaction(e,i,s,a=>(o=new Mm(a,this.ci?this.ci.next():$n.ce),n==="readwrite-primary"?this.Hi(o).next(l=>!!l||this.Yi(o)).next(l=>{if(!l)throw rn(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)),new re(K.FAILED_PRECONDITION,K0);return r(o)}).next(l=>this.Xi(o).next(()=>l)):this.Is(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Is(e){return Sl(e).get(wo).next(n=>{if(n!==null&&this.rs(n.leaseTimestampMs,pp)&&!this.us(n.ownerId)&&!this.es(n)&&!(this.Oi||this.allowTabSynchronization&&n.allowTabSynchronization))throw new re(K.FAILED_PRECONDITION,mp)})}Xi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Sl(e).put(wo,n)}static v(){return zi.v()}Zi(e){const n=Sl(e);return n.get(wo).next(r=>this.es(r)?(ee(mi,"Releasing primary lease."),n.delete(wo)):q.resolve())}rs(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(rn(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi()))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){var e;typeof((e=this.window)==null?void 0:e.addEventListener)=="function"&&(this.Bi=()=>{this.cs();const n=/(?:Version|Mobile)\/1[456]/;WC()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){var n;try{const r=((n=this.Ki)==null?void 0:n.getItem(this._s(e)))!==null;return ee(mi,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return rn(mi,"Failed to get zombied client id.",r),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){rn("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Sl(t){return bt(t,Wu)}function jc(t){return bt(t,Ta)}function iO(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U_{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.Es=r,this.ds=i}static As(e,n){let r=Ne(),i=Ne();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new U_(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sO{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hx{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return WC()?8:J0(Nt())>0?6:4}()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.ys(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ws(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new sO;return this.Ss(e,n,o).next(a=>{if(s.result=a,this.Vs)return this.bs(e,n,o,a.size)})}).next(()=>s.result)}bs(e,n,r,i){return r.documentReadCount<this.fs?(Po()<=Ve.DEBUG&&ee("QueryEngine","SDK will not create cache indexes for query:",ko(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),q.resolve()):(Po()<=Ve.DEBUG&&ee("QueryEngine","Query:",ko(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?(Po()<=Ve.DEBUG&&ee("QueryEngine","The SDK decides to create cache indexes for query:",ko(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Kn(n))):q.resolve())}ys(e,n){if(HE(n))return q.resolve(null);let r=Kn(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=qm(n,null,"F"),r=Kn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=Ne(...s);return this.ps.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const u=this.Ds(n,a);return this.Cs(n,u,o,l.readTime)?this.ys(e,qm(n,null,"F")):this.vs(e,u,n,l)}))})))}ws(e,n,r,i){return HE(n)||i.isEqual(ve.min())?q.resolve(null):this.ps.getDocuments(e,r).next(s=>{const o=this.Ds(n,s);return this.Cs(n,o,r,i)?q.resolve(null):(Po()<=Ve.DEBUG&&ee("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),ko(n)),this.vs(e,o,n,oU(i,Iu)).next(a=>a))})}Ds(e,n){let r=new Qe(CA(e));return n.forEach((i,s)=>{Qu(e,s)&&(r=r.add(s))}),r}Cs(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ss(e,n,r){return Po()<=Ve.DEBUG&&ee("QueryEngine","Using full collection scan to execute query:",ko(n)),this.ps.getDocumentsMatchingQuery(e,n,Nn.min(),r)}vs(e,n,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O_="LocalStore",oO=3e8;class aO{constructor(e,n,r,i){this.persistence=e,this.Fs=n,this.serializer=i,this.Ms=new at(Ae),this.xs=new ni(s=>to(s),Ku),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new dx(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ms))}}function fx(t,e,n,r){return new aO(t,e,n,r)}async function px(t,e){const n=xe(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.Bs(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],a=[];let l=Ne();for(const u of i){o.push(u.batchId);for(const f of u.mutations)l=l.add(f.key)}for(const u of s){a.push(u.batchId);for(const f of u.mutations)l=l.add(f.key)}return n.localDocuments.getDocuments(r,l).next(u=>({Ls:u,removedBatchIds:o,addedBatchIds:a}))})})}function lO(t,e){const n=xe(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.Ns.newChangeBuffer({trackRemovals:!0});return function(a,l,u,f){const m=u.batch,g=m.keys();let v=q.resolve();return g.forEach(T=>{v=v.next(()=>f.getEntry(l,T)).next(A=>{const D=u.docVersions.get(T);_e(D!==null,48541),A.version.compareTo(D)<0&&(m.applyToRemoteDocument(A,u),A.isValidDocument()&&(A.setReadTime(u.commitVersion),f.addEntry(A)))})}),v.next(()=>a.mutationQueue.removeMutationBatch(l,m))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=Ne();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(l=l.add(a.batch.mutations[u].key));return l}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function mx(t){const e=xe(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Pi.getLastRemoteSnapshotVersion(n))}function uO(t,e){const n=xe(t),r=e.snapshotVersion;let i=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.Ns.newChangeBuffer({trackRemovals:!0});i=n.Ms;const a=[];e.targetChanges.forEach((f,m)=>{const g=i.get(m);if(!g)return;a.push(n.Pi.removeMatchingKeys(s,f.removedDocuments,m).next(()=>n.Pi.addMatchingKeys(s,f.addedDocuments,m)));let v=g.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(m)!==null?v=v.withResumeToken(Et.EMPTY_BYTE_STRING,ve.min()).withLastLimboFreeSnapshotVersion(ve.min()):f.resumeToken.approximateByteSize()>0&&(v=v.withResumeToken(f.resumeToken,r)),i=i.insert(m,v),function(A,D,S){return A.resumeToken.approximateByteSize()===0||D.snapshotVersion.toMicroseconds()-A.snapshotVersion.toMicroseconds()>=oO?!0:S.addedDocuments.size+S.modifiedDocuments.size+S.removedDocuments.size>0}(g,v,f)&&a.push(n.Pi.updateTargetData(s,v))});let l=Rn(),u=Ne();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,f))}),a.push(cO(s,o,e.documentUpdates).next(f=>{l=f.ks,u=f.qs})),!r.isEqual(ve.min())){const f=n.Pi.getLastRemoteSnapshotVersion(s).next(m=>n.Pi.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(f)}return q.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,l,u)).next(()=>l)}).then(s=>(n.Ms=i,s))}function cO(t,e,n){let r=Ne(),i=Ne();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=Rn();return n.forEach((a,l)=>{const u=s.get(a);l.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(a)),l.isNoDocument()&&l.version.isEqual(ve.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):ee(O_,"Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",l.version)}),{ks:o,qs:i}})}function dO(t,e){const n=xe(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=Gs),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function hO(t,e){const n=xe(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Pi.getTargetData(r,e).next(s=>s?(i=s,q.resolve(i)):n.Pi.allocateTargetId(r).next(o=>(i=new Gr(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Pi.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.Ms.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(r.targetId,r),n.xs.set(e,r.targetId)),r})}async function Jm(t,e,n){const r=xe(t),i=r.Ms.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!ss(o))throw o;ee(O_,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(i.target)}function II(t,e,n){const r=xe(t);let i=ve.min(),s=Ne();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,u,f){const m=xe(l),g=m.xs.get(f);return g!==void 0?q.resolve(m.Ms.get(g)):m.Pi.getTargetData(u,f)}(r,o,Kn(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,a.targetId).next(l=>{s=l})}).next(()=>r.Fs.getDocumentsMatchingQuery(o,e,n?i:ve.min(),n?s:Ne())).next(a=>(fO(r,XU(e),a),{documents:a,Qs:s})))}function fO(t,e,n){let r=t.Os.get(e)||ve.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.Os.set(e,r)}class wI{constructor(){this.activeTargetIds=i4()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class gx{constructor(){this.Mo=new wI,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,r){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new wI,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pO{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SI="ConnectivityMonitor";class CI{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){ee(SI,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){ee(SI,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Jc=null;function Qm(){return Jc===null?Jc=function(){return 268435456+Math.round(2147483648*Math.random())}():Jc++,"0x"+Jc.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gp="RestConnection",mO={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class gO{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===ch?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,n,r,i,s){const o=Qm(),a=this.zo(e,n.toUriEncodedString());ee(gp,`Sending RPC '${e}' ${o}:`,a,r);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,i,s);const{host:u}=new URL(a),f=La(u);return this.Jo(e,a,l,r,f).then(m=>(ee(gp,`Received RPC '${e}' ${o}: `,m),m),m=>{throw Ji(gp,`RPC '${e}' ${o} failed with error: `,m,"url: ",a,"request:",r),m})}Ho(e,n,r,i,s,o){return this.Go(e,n,r,i,s)}jo(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Oa}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((i,s)=>e[s]=i),r&&r.headers.forEach((i,s)=>e[s]=i)}zo(e,n){const r=mO[e];return`${this.Uo}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _O{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jt="WebChannelConnection";class yO extends gO{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,i,s){const o=Qm();return new Promise((a,l)=>{const u=new b0;u.setWithCredentials(!0),u.listenOnce(M0.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case pd.NO_ERROR:const m=u.getResponseJson();ee(jt,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(m)),a(m);break;case pd.TIMEOUT:ee(jt,`RPC '${e}' ${o} timed out`),l(new re(K.DEADLINE_EXCEEDED,"Request time out"));break;case pd.HTTP_ERROR:const g=u.getStatus();if(ee(jt,`RPC '${e}' ${o} failed with status:`,g,"response text:",u.getResponseText()),g>0){let v=u.getResponseJson();Array.isArray(v)&&(v=v[0]);const T=v==null?void 0:v.error;if(T&&T.status&&T.message){const A=function(S){const I=S.toLowerCase().replace(/_/g,"-");return Object.values(K).indexOf(I)>=0?I:K.UNKNOWN}(T.status);l(new re(A,T.message))}else l(new re(K.UNKNOWN,"Server responded with status "+u.getStatus()))}else l(new re(K.UNAVAILABLE,"Connection failed."));break;default:he(9055,{l_:e,streamId:o,h_:u.getLastErrorCode(),P_:u.getLastError()})}}finally{ee(jt,`RPC '${e}' ${o} completed.`)}});const f=JSON.stringify(i);ee(jt,`RPC '${e}' ${o} sending request:`,i),u.send(n,"POST",f,r,15)})}T_(e,n,r){const i=Qm(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=F0(),a=L0(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(l.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,n,r),l.encodeInitMessageHeaders=!0;const f=s.join("");ee(jt,`Creating RPC '${e}' stream ${i}: ${f}`,l);const m=o.createWebChannel(f,l);this.I_(m);let g=!1,v=!1;const T=new _O({Yo:D=>{v?ee(jt,`Not sending because RPC '${e}' stream ${i} is closed:`,D):(g||(ee(jt,`Opening RPC '${e}' stream ${i} transport.`),m.open(),g=!0),ee(jt,`RPC '${e}' stream ${i} sending:`,D),m.send(D))},Zo:()=>m.close()}),A=(D,S,I)=>{D.listen(S,P=>{try{I(P)}catch(V){setTimeout(()=>{throw V},0)}})};return A(m,Pl.EventType.OPEN,()=>{v||(ee(jt,`RPC '${e}' stream ${i} transport opened.`),T.o_())}),A(m,Pl.EventType.CLOSE,()=>{v||(v=!0,ee(jt,`RPC '${e}' stream ${i} transport closed`),T.a_(),this.E_(m))}),A(m,Pl.EventType.ERROR,D=>{v||(v=!0,Ji(jt,`RPC '${e}' stream ${i} transport errored. Name:`,D.name,"Message:",D.message),T.a_(new re(K.UNAVAILABLE,"The operation could not be completed")))}),A(m,Pl.EventType.MESSAGE,D=>{var S;if(!v){const I=D.data[0];_e(!!I,16349);const P=I,V=(P==null?void 0:P.error)||((S=P[0])==null?void 0:S.error);if(V){ee(jt,`RPC '${e}' stream ${i} received error:`,V);const U=V.status;let O=function(C){const k=wt[C];if(k!==void 0)return UA(k)}(U),E=V.message;O===void 0&&(O=K.INTERNAL,E="Unknown error status: "+U+" with message "+V.message),v=!0,T.a_(new re(O,E)),m.close()}else ee(jt,`RPC '${e}' stream ${i} received:`,I),T.u_(I)}}),A(a,V0.STAT_EVENT,D=>{D.stat===Rm.PROXY?ee(jt,`RPC '${e}' stream ${i} detected buffering proxy`):D.stat===Rm.NOPROXY&&ee(jt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{T.__()},0),T}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(n=>n===e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vO(){return typeof window<"u"?window:null}function Sd(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hf(t){return new T4(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _x{constructor(e,n,r=1e3,i=1.5,s=6e4){this.Mi=e,this.timerId=n,this.d_=r,this.A_=i,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,n-r);i>0&&ee("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AI="PersistentStream";class yx{constructor(e,n,r,i,s,o,a,l){this.Mi=e,this.S_=r,this.b_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new _x(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===K.RESOURCE_EXHAUSTED?(rn(n.toString()),rn("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===K.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.D_===n&&this.G_(r,i)},r=>{e(()=>{const i=new re(K.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)})})}G_(e,n){const r=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(i=>{r(()=>this.z_(i))}),this.stream.onMessage(i=>{r(()=>++this.F_==1?this.J_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return ee(AI,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget(()=>this.D_===e?n():(ee(AI,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class TO extends yx{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=w4(this.serializer,e),r=function(s){if(!("targetChange"in s))return ve.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?ve.min():o.readTime?ln(o.readTime):ve.min()}(e);return this.listener.H_(n,r)}Y_(e){const n={};n.database=$m(this.serializer),n.addTarget=function(s,o){let a;const l=o.target;if(a=hh(l)?{documents:WA(s,l)}:{query:KA(s,l).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=qA(s,o.resumeToken);const u=Gm(s,o.expectedCount);u!==null&&(a.expectedCount=u)}else if(o.snapshotVersion.compareTo(ve.min())>0){a.readTime=Ra(s,o.snapshotVersion.toTimestamp());const u=Gm(s,o.expectedCount);u!==null&&(a.expectedCount=u)}return a}(this.serializer,e);const r=C4(this.serializer,e);r&&(n.labels=r),this.q_(n)}Z_(e){const n={};n.database=$m(this.serializer),n.removeTarget=e,this.q_(n)}}class EO extends yx{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return _e(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,_e(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){_e(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=S4(e.writeResults,e.commitTime),r=ln(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=$m(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>mh(this.serializer,r))};this.q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IO{}class wO extends IO{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new re(K.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Go(e,zm(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===K.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new re(K.UNKNOWN,s.toString())})}Ho(e,n,r,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Ho(e,zm(n,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===K.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new re(K.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class SO{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(rn(n),this.aa=!1):ee("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const so="RemoteStore";class CO{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo(o=>{r.enqueueAndForget(async()=>{co(this)&&(ee(so,"Restarting streams for network reachability change."),await async function(l){const u=xe(l);u.Ea.add(4),await Xu(u),u.Ra.set("Unknown"),u.Ea.delete(4),await ff(u)}(this))})}),this.Ra=new SO(r,i)}}async function ff(t){if(co(t))for(const e of t.da)await e(!0)}async function Xu(t){for(const e of t.da)await e(!1)}function vx(t,e){const n=xe(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),z_(n)?G_(n):qa(n).O_()&&q_(n,e))}function B_(t,e){const n=xe(t),r=qa(n);n.Ia.delete(e),r.O_()&&Tx(n,e),n.Ia.size===0&&(r.O_()?r.L_():co(n)&&n.Ra.set("Unknown"))}function q_(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ve.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}qa(t).Y_(e)}function Tx(t,e){t.Va.Ue(e),qa(t).Z_(e)}function G_(t){t.Va=new g4({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),qa(t).start(),t.Ra.ua()}function z_(t){return co(t)&&!qa(t).x_()&&t.Ia.size>0}function co(t){return xe(t).Ea.size===0}function Ex(t){t.Va=void 0}async function AO(t){t.Ra.set("Online")}async function xO(t){t.Ia.forEach((e,n)=>{q_(t,e)})}async function RO(t,e){Ex(t),z_(t)?(t.Ra.ha(e),G_(t)):t.Ra.set("Unknown")}async function PO(t,e,n){if(t.Ra.set("Online"),e instanceof BA&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const a of s.targetIds)i.Ia.has(a)&&(await i.remoteSyncer.rejectListen(a,o),i.Ia.delete(a),i.Va.removeTarget(a))}(t,e)}catch(r){ee(so,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Th(t,r)}else if(e instanceof Id?t.Va.Ze(e):e instanceof OA?t.Va.st(e):t.Va.tt(e),!n.isEqual(ve.min()))try{const r=await mx(t.localStore);n.compareTo(r)>=0&&await function(s,o){const a=s.Va.Tt(o);return a.targetChanges.forEach((l,u)=>{if(l.resumeToken.approximateByteSize()>0){const f=s.Ia.get(u);f&&s.Ia.set(u,f.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,u)=>{const f=s.Ia.get(l);if(!f)return;s.Ia.set(l,f.withResumeToken(Et.EMPTY_BYTE_STRING,f.snapshotVersion)),Tx(s,l);const m=new Gr(f.target,l,u,f.sequenceNumber);q_(s,m)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){ee(so,"Failed to raise snapshot:",r),await Th(t,r)}}async function Th(t,e,n){if(!ss(e))throw e;t.Ea.add(1),await Xu(t),t.Ra.set("Offline"),n||(n=()=>mx(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{ee(so,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await ff(t)})}function Ix(t,e){return e().catch(n=>Th(t,n,e))}async function Zu(t){const e=xe(t),n=Zi(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Gs;for(;kO(e);)try{const i=await dO(e.localStore,r);if(i===null){e.Ta.length===0&&n.L_();break}r=i.batchId,NO(e,i)}catch(i){await Th(e,i)}wx(e)&&Sx(e)}function kO(t){return co(t)&&t.Ta.length<10}function NO(t,e){t.Ta.push(e);const n=Zi(t);n.O_()&&n.X_&&n.ea(e.mutations)}function wx(t){return co(t)&&!Zi(t).x_()&&t.Ta.length>0}function Sx(t){Zi(t).start()}async function DO(t){Zi(t).ra()}async function bO(t){const e=Zi(t);for(const n of t.Ta)e.ea(n.mutations)}async function MO(t,e,n){const r=t.Ta.shift(),i=P_.from(r,e,n);await Ix(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await Zu(t)}async function VO(t,e){e&&Zi(t).X_&&await async function(r,i){if(function(o){return f4(o)&&o!==K.ABORTED}(i.code)){const s=r.Ta.shift();Zi(r).B_(),await Ix(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await Zu(r)}}(t,e),wx(t)&&Sx(t)}async function xI(t,e){const n=xe(t);n.asyncQueue.verifyOperationInProgress(),ee(so,"RemoteStore received new credentials");const r=co(n);n.Ea.add(3),await Xu(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await ff(n)}async function LO(t,e){const n=xe(t);e?(n.Ea.delete(2),await ff(n)):e||(n.Ea.add(2),await Xu(n),n.Ra.set("Unknown"))}function qa(t){return t.ma||(t.ma=function(n,r,i){const s=xe(n);return s.sa(),new TO(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Xo:AO.bind(null,t),t_:xO.bind(null,t),r_:RO.bind(null,t),H_:PO.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),z_(t)?G_(t):t.Ra.set("Unknown")):(await t.ma.stop(),Ex(t))})),t.ma}function Zi(t){return t.fa||(t.fa=function(n,r,i){const s=xe(n);return s.sa(),new EO(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:DO.bind(null,t),r_:VO.bind(null,t),ta:bO.bind(null,t),na:MO.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await Zu(t)):(await t.fa.stop(),t.Ta.length>0&&(ee(so,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $_{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Cr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const o=Date.now()+r,a=new $_(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new re(K.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function H_(t,e){if(rn("AsyncQueue",`${e}: ${t}`),ss(t))return new re(K.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oa{static emptySet(e){return new oa(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||ae.comparator(n.key,r.key):(n,r)=>ae.comparator(n.key,r.key),this.keyedMap=kl(),this.sortedSet=new at(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof oa)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new oa;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RI{constructor(){this.ga=new at(ae.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):he(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,r)=>{e.push(r)}),e}}class Pa{constructor(e,n,r,i,s,o,a,l,u){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,n,r,i,s){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new Pa(e,n,oa.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&rf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FO{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class UO{constructor(){this.queries=PI(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const i=xe(n),s=i.queries;i.queries=PI(),s.forEach((o,a)=>{for(const l of a.Sa)l.onError(r)})})(this,new re(K.ABORTED,"Firestore shutting down"))}}function PI(){return new ni(t=>SA(t),rf)}async function W_(t,e){const n=xe(t);let r=3;const i=e.query;let s=n.queries.get(i);s?!s.ba()&&e.Da()&&(r=2):(s=new FO,r=e.Da()?0:1);try{switch(r){case 0:s.wa=await n.onListen(i,!0);break;case 1:s.wa=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(o){const a=H_(o,`Initialization of query '${ko(e.query)}' failed`);return void e.onError(a)}n.queries.set(i,s),s.Sa.push(e),e.va(n.onlineState),s.wa&&e.Fa(s.wa)&&j_(n)}async function K_(t,e){const n=xe(t),r=e.query;let i=3;const s=n.queries.get(r);if(s){const o=s.Sa.indexOf(e);o>=0&&(s.Sa.splice(o,1),s.Sa.length===0?i=e.Da()?0:1:!s.ba()&&e.Da()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function OO(t,e){const n=xe(t);let r=!1;for(const i of e){const s=i.query,o=n.queries.get(s);if(o){for(const a of o.Sa)a.Fa(i)&&(r=!0);o.wa=i}}r&&j_(n)}function BO(t,e,n){const r=xe(t),i=r.queries.get(e);if(i)for(const s of i.Sa)s.onError(n);r.queries.delete(e)}function j_(t){t.Ca.forEach(e=>{e.next()})}var Ym,kI;(kI=Ym||(Ym={})).Ma="default",kI.Cache="cache";class J_{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new Pa(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=Pa.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Ym.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cx{constructor(e){this.key=e}}class Ax{constructor(e){this.key=e}}class qO{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Ne(),this.mutatedKeys=Ne(),this.eu=CA(e),this.tu=new oa(this.eu)}get nu(){return this.Ya}ru(e,n){const r=n?n.iu:new RI,i=n?n.tu:this.tu;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((f,m)=>{const g=i.get(f),v=Qu(this.query,m)?m:null,T=!!g&&this.mutatedKeys.has(g.key),A=!!v&&(v.hasLocalMutations||this.mutatedKeys.has(v.key)&&v.hasCommittedMutations);let D=!1;g&&v?g.data.isEqual(v.data)?T!==A&&(r.track({type:3,doc:v}),D=!0):this.su(g,v)||(r.track({type:2,doc:v}),D=!0,(l&&this.eu(v,l)>0||u&&this.eu(v,u)<0)&&(a=!0)):!g&&v?(r.track({type:0,doc:v}),D=!0):g&&!v&&(r.track({type:1,doc:g}),D=!0,(l||u)&&(a=!0)),D&&(v?(o=o.add(v),s=A?s.add(f):s.delete(f)):(o=o.delete(f),s=s.delete(f)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const f=this.query.limitType==="F"?o.last():o.first();o=o.delete(f.key),s=s.delete(f.key),r.track({type:1,doc:f})}return{tu:o,iu:r,Cs:a,mutatedKeys:s}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((f,m)=>function(v,T){const A=D=>{switch(D){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return he(20277,{Rt:D})}};return A(v)-A(T)}(f.type,m.type)||this.eu(f.doc,m.doc)),this.ou(r),i=i??!1;const a=n&&!i?this._u():[],l=this.Xa.size===0&&this.current&&!i?1:0,u=l!==this.Za;return this.Za=l,o.length!==0||u?{snapshot:new Pa(this.query,e.tu,s,o,e.mutatedKeys,l===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new RI,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Ya=this.Ya.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ya=this.Ya.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Ne(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))});const n=[];return e.forEach(r=>{this.Xa.has(r)||n.push(new Ax(r))}),this.Xa.forEach(r=>{e.has(r)||n.push(new Cx(r))}),n}cu(e){this.Ya=e.Qs,this.Xa=Ne();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return Pa.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Q_="SyncEngine";class GO{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class zO{constructor(e){this.key=e,this.hu=!1}}class $O{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new ni(a=>SA(a),rf),this.Iu=new Map,this.Eu=new Set,this.du=new at(ae.comparator),this.Au=new Map,this.Ru=new V_,this.Vu={},this.mu=new Map,this.fu=io.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function HO(t,e,n=!0){const r=Dx(t);let i;const s=r.Tu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await xx(r,e,n,!0),i}async function WO(t,e){const n=Dx(t);await xx(n,e,!0,!1)}async function xx(t,e,n,r){const i=await hO(t.localStore,Kn(e)),s=i.targetId,o=t.sharedClientState.addLocalQueryTarget(s,n);let a;return r&&(a=await KO(t,e,s,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&vx(t.remoteStore,i),a}async function KO(t,e,n,r,i){t.pu=(m,g,v)=>async function(A,D,S,I){let P=D.view.ru(S);P.Cs&&(P=await II(A.localStore,D.query,!1).then(({documents:E})=>D.view.ru(E,P)));const V=I&&I.targetChanges.get(D.targetId),U=I&&I.targetMismatches.get(D.targetId)!=null,O=D.view.applyChanges(P,A.isPrimaryClient,V,U);return DI(A,D.targetId,O.au),O.snapshot}(t,m,g,v);const s=await II(t.localStore,e,!0),o=new qO(e,s.Qs),a=o.ru(s.documents),l=Yu.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),u=o.applyChanges(a,t.isPrimaryClient,l);DI(t,n,u.au);const f=new GO(e,n,o);return t.Tu.set(e,f),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),u.snapshot}async function jO(t,e,n){const r=xe(t),i=r.Tu.get(e),s=r.Iu.get(i.targetId);if(s.length>1)return r.Iu.set(i.targetId,s.filter(o=>!rf(o,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Jm(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&B_(r.remoteStore,i.targetId),Xm(r,i.targetId)}).catch(uo)):(Xm(r,i.targetId),await Jm(r.localStore,i.targetId,!0))}async function JO(t,e){const n=xe(t),r=n.Tu.get(e),i=n.Iu.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),B_(n.remoteStore,r.targetId))}async function QO(t,e,n){const r=bx(t);try{const i=await function(o,a){const l=xe(o),u=He.now(),f=a.reduce((v,T)=>v.add(T.key),Ne());let m,g;return l.persistence.runTransaction("Locally write mutations","readwrite",v=>{let T=Rn(),A=Ne();return l.Ns.getEntries(v,f).next(D=>{T=D,T.forEach((S,I)=>{I.isValidDocument()||(A=A.add(S))})}).next(()=>l.localDocuments.getOverlayedDocuments(v,T)).next(D=>{m=D;const S=[];for(const I of a){const P=d4(I,m.get(I.key).overlayedDocument);P!=null&&S.push(new ri(I.key,P,mA(P.value.mapValue),sn.exists(!0)))}return l.mutationQueue.addMutationBatch(v,u,S,a)}).next(D=>{g=D;const S=D.applyToLocalDocumentSet(m,A);return l.documentOverlayCache.saveOverlays(v,D.batchId,S)})}).then(()=>({batchId:g.batchId,changes:xA(m)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,l){let u=o.Vu[o.currentUser.toKey()];u||(u=new at(Ae)),u=u.insert(a,l),o.Vu[o.currentUser.toKey()]=u}(r,i.batchId,n),await ec(r,i.changes),await Zu(r.remoteStore)}catch(i){const s=H_(i,"Failed to persist write");n.reject(s)}}async function Rx(t,e){const n=xe(t);try{const r=await uO(n.localStore,e);e.targetChanges.forEach((i,s)=>{const o=n.Au.get(s);o&&(_e(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.hu=!0:i.modifiedDocuments.size>0?_e(o.hu,14607):i.removedDocuments.size>0&&(_e(o.hu,42227),o.hu=!1))}),await ec(n,r,e)}catch(r){await uo(r)}}function NI(t,e,n){const r=xe(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Tu.forEach((s,o)=>{const a=o.view.va(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){const l=xe(o);l.onlineState=a;let u=!1;l.queries.forEach((f,m)=>{for(const g of m.Sa)g.va(a)&&(u=!0)}),u&&j_(l)}(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function YO(t,e,n){const r=xe(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Au.get(e),s=i&&i.key;if(s){let o=new at(ae.comparator);o=o.insert(s,_t.newNoDocument(s,ve.min()));const a=Ne().add(s),l=new lf(ve.min(),new Map,new at(Ae),o,a);await Rx(r,l),r.du=r.du.remove(s),r.Au.delete(e),Y_(r)}else await Jm(r.localStore,e,!1).then(()=>Xm(r,e,n)).catch(uo)}async function XO(t,e){const n=xe(t),r=e.batch.batchId;try{const i=await lO(n.localStore,e);kx(n,r,null),Px(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await ec(n,i)}catch(i){await uo(i)}}async function ZO(t,e,n){const r=xe(t);try{const i=await function(o,a){const l=xe(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let f;return l.mutationQueue.lookupMutationBatch(u,a).next(m=>(_e(m!==null,37113),f=m.keys(),l.mutationQueue.removeMutationBatch(u,m))).next(()=>l.mutationQueue.performConsistencyCheck(u)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(u,f,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,f)).next(()=>l.localDocuments.getDocuments(u,f))})}(r.localStore,e);kx(r,e,n),Px(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await ec(r,i)}catch(i){await uo(i)}}function Px(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function kx(t,e,n){const r=xe(t);let i=r.Vu[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Vu[r.currentUser.toKey()]=i}}function Xm(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(r=>{t.Ru.containsKey(r)||Nx(t,r)})}function Nx(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(B_(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),Y_(t))}function DI(t,e,n){for(const r of n)r instanceof Cx?(t.Ru.addReference(r.key,e),e6(t,r)):r instanceof Ax?(ee(Q_,"Document no longer in limbo: "+r.key),t.Ru.removeReference(r.key,e),t.Ru.containsKey(r.key)||Nx(t,r.key)):he(19791,{wu:r})}function e6(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Eu.has(r)||(ee(Q_,"New document in limbo: "+n),t.Eu.add(r),Y_(t))}function Y_(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new ae(ze.fromString(e)),r=t.fu.next();t.Au.set(r,new zO(n)),t.du=t.du.insert(n,r),vx(t.remoteStore,new Gr(Kn(Ju(n.path)),r,"TargetPurposeLimboResolution",$n.ce))}}async function ec(t,e,n){const r=xe(t),i=[],s=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((a,l)=>{o.push(r.pu(l,e,n).then(u=>{var f;if((u||n)&&r.isPrimaryClient){const m=u?!u.fromCache:(f=n==null?void 0:n.targetChanges.get(l.targetId))==null?void 0:f.current;r.sharedClientState.updateQueryState(l.targetId,m?"current":"not-current")}if(u){i.push(u);const m=U_.As(l.targetId,u);s.push(m)}}))}),await Promise.all(o),r.Pu.H_(i),await async function(l,u){const f=xe(l);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>q.forEach(u,g=>q.forEach(g.Es,v=>f.persistence.referenceDelegate.addReference(m,g.targetId,v)).next(()=>q.forEach(g.ds,v=>f.persistence.referenceDelegate.removeReference(m,g.targetId,v)))))}catch(m){if(!ss(m))throw m;ee(O_,"Failed to update sequence numbers: "+m)}for(const m of u){const g=m.targetId;if(!m.fromCache){const v=f.Ms.get(g),T=v.snapshotVersion,A=v.withLastLimboFreeSnapshotVersion(T);f.Ms=f.Ms.insert(g,A)}}}(r.localStore,s))}async function t6(t,e){const n=xe(t);if(!n.currentUser.isEqual(e)){ee(Q_,"User change. New user:",e.toKey());const r=await px(n.localStore,e);n.currentUser=e,function(s,o){s.mu.forEach(a=>{a.forEach(l=>{l.reject(new re(K.CANCELLED,o))})}),s.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await ec(n,r.Ls)}}function n6(t,e){const n=xe(t),r=n.Au.get(e);if(r&&r.hu)return Ne().add(r.key);{let i=Ne();const s=n.Iu.get(e);if(!s)return i;for(const o of s){const a=n.Tu.get(o);i=i.unionWith(a.view.nu)}return i}}function Dx(t){const e=xe(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Rx.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=n6.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=YO.bind(null,e),e.Pu.H_=OO.bind(null,e.eventManager),e.Pu.yu=BO.bind(null,e.eventManager),e}function bx(t){const e=xe(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=XO.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=ZO.bind(null,e),e}class bu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=hf(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return fx(this.persistence,new hx,e.initialUser,this.serializer)}Cu(e){return new L_(df.mi,this.serializer)}Du(e){return new gx}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}bu.provider={build:()=>new bu};class r6 extends bu{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){_e(this.persistence.referenceDelegate instanceof vh,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new ax(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?Jt.withCacheSize(this.cacheSizeBytes):Jt.DEFAULT;return new L_(r=>vh.mi(r,n),this.serializer)}}class i6 extends bu{constructor(e,n,r){super(),this.xu=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await bx(this.xu.syncEngine),await Zu(this.xu.remoteStore),await this.persistence.Ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}vu(e){return fx(this.persistence,new hx,e.initialUser,this.serializer)}Fu(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new ax(r,e.asyncQueue,n)}Mu(e,n){const r=new cU(n,this.persistence);return new uU(e.asyncQueue,r)}Cu(e){const n=iO(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Jt.withCacheSize(this.cacheSizeBytes):Jt.DEFAULT;return new F_(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,vO(),Sd(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new gx}}class Eh{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>NI(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=t6.bind(null,this.syncEngine),await LO(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new UO}()}createDatastore(e){const n=hf(e.databaseInfo.databaseId),r=function(s){return new yO(s)}(e.databaseInfo);return function(s,o,a,l){return new wO(s,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,a){return new CO(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>NI(this.syncEngine,n,0),function(){return CI.v()?new CI:new pO}())}createSyncEngine(e,n){return function(i,s,o,a,l,u,f){const m=new $O(i,s,o,a,l,u);return f&&(m.gu=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(i){const s=xe(i);ee(so,"RemoteStore shutting down."),s.Ea.add(5),await Xu(s),s.Aa.shutdown(),s.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}Eh.provider={build:()=>new Eh};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X_{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):rn("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const es="FirestoreClient";class s6{constructor(e,n,r,i,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=Gt.UNAUTHENTICATED,this.clientId=jh.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{ee(es,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(ee(es,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Cr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=H_(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function _p(t,e){t.asyncQueue.verifyOperationInProgress(),ee(es,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await px(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function bI(t,e){t.asyncQueue.verifyOperationInProgress();const n=await o6(t);ee(es,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>xI(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>xI(e.remoteStore,i)),t._onlineComponents=e}async function o6(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){ee(es,"Using user provided OfflineComponentProvider");try{await _p(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(i){return i.name==="FirebaseError"?i.code===K.FAILED_PRECONDITION||i.code===K.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;Ji("Error using user provided cache. Falling back to memory cache: "+n),await _p(t,new bu)}}else ee(es,"Using default OfflineComponentProvider"),await _p(t,new r6(void 0));return t._offlineComponents}async function Mx(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(ee(es,"Using user provided OnlineComponentProvider"),await bI(t,t._uninitializedComponentsProvider._online)):(ee(es,"Using default OnlineComponentProvider"),await bI(t,new Eh))),t._onlineComponents}function a6(t){return Mx(t).then(e=>e.syncEngine)}async function Ih(t){const e=await Mx(t),n=e.eventManager;return n.onListen=HO.bind(null,e.syncEngine),n.onUnlisten=jO.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=WO.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=JO.bind(null,e.syncEngine),n}function l6(t,e,n={}){const r=new Cr;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,u){const f=new X_({next:g=>{f.Nu(),o.enqueueAndForget(()=>K_(s,m));const v=g.docs.has(a);!v&&g.fromCache?u.reject(new re(K.UNAVAILABLE,"Failed to get document because the client is offline.")):v&&g.fromCache&&l&&l.source==="server"?u.reject(new re(K.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(g)},error:g=>u.reject(g)}),m=new J_(Ju(a.path),f,{includeMetadataChanges:!0,qa:!0});return W_(s,m)}(await Ih(t),t.asyncQueue,e,n,r)),r.promise}function u6(t,e,n={}){const r=new Cr;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,u){const f=new X_({next:g=>{f.Nu(),o.enqueueAndForget(()=>K_(s,m)),g.fromCache&&l.source==="server"?u.reject(new re(K.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(g)},error:g=>u.reject(g)}),m=new J_(a,f,{includeMetadataChanges:!0,qa:!0});return W_(s,m)}(await Ih(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vx(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MI=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lx="firestore.googleapis.com",VI=!0;class LI{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new re(K.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Lx,this.ssl=VI}else this.host=e.host,this.ssl=e.ssl??VI;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=rx;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<q4)throw new re(K.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}$0("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Vx(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new re(K.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new re(K.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new re(K.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class pf{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new LI({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new re(K.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new re(K.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new LI(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new q0;switch(r.type){case"firstParty":return new eU(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new re(K.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=MI.get(n);r&&(ee("ComponentProvider","Removing Datastore"),MI.delete(n),r.terminate())}(this),Promise.resolve()}}function Fx(t,e,n,r={}){var u;t=an(t,pf);const i=La(e),s=t._getSettings(),o={...s,emulatorOptions:t._getEmulatorOptions()},a=`${e}:${n}`;i&&(zC(`https://${a}`),$C("Firestore",!0)),s.host!==Lx&&s.host!==a&&Ji("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...s,host:a,ssl:i,emulatorOptions:r};if(!Xs(l,o)&&(t._setSettings(l),r.mockUserToken)){let f,m;if(typeof r.mockUserToken=="string")f=r.mockUserToken,m=Gt.MOCK_USER;else{f=C2(r.mockUserToken,(u=t._app)==null?void 0:u.options.projectId);const g=r.mockUserToken.sub||r.mockUserToken.user_id;if(!g)throw new re(K.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");m=new Gt(g)}t._authCredentials=new YF(new B0(f,m))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class as{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new as(this.firestore,e,this._query)}}class ft{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new $r(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ft(this.firestore,e,this._key)}toJSON(){return{type:ft._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(Hu(n,ft._jsonSchema))return new ft(e,r||null,new ae(ze.fromString(n.referencePath)))}}ft._jsonSchemaVersion="firestore/documentReference/1.0",ft._jsonSchema={type:Ct("string",ft._jsonSchemaVersion),referencePath:Ct("string")};class $r extends as{constructor(e,n,r){super(e,n,Ju(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ft(this.firestore,null,new ae(e))}withConverter(e){return new $r(this.firestore,e,this._path)}}function dt(t,e,...n){if(t=Dt(t),z0("collection","path",e),t instanceof pf){const r=ze.fromString(e,...n);return AE(r),new $r(t,null,r)}{if(!(t instanceof ft||t instanceof $r))throw new re(K.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ze.fromString(e,...n));return AE(r),new $r(t.firestore,null,r)}}function Oe(t,e,...n){if(t=Dt(t),arguments.length===1&&(e=jh.newId()),z0("doc","path",e),t instanceof pf){const r=ze.fromString(e,...n);return CE(r),new ft(t,null,new ae(r))}{if(!(t instanceof ft||t instanceof $r))throw new re(K.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ze.fromString(e,...n));return CE(r),new ft(t.firestore,t instanceof $r?t.converter:null,new ae(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FI="AsyncQueue";class UI{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new _x(this,"async_queue_retry"),this._c=()=>{const r=Sd();r&&ee(FI,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=Sd();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=Sd();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new Cr;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!ss(e))throw e;ee(FI,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,rn("INTERNAL UNHANDLED ERROR: ",OI(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const i=$_.createAndSchedule(this,e,n,r,s=>this.hc(s));return this.tc.push(i),i}uc(){this.nc&&he(47125,{Pc:OI(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function OI(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BI(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const i=n;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}class Rr extends pf{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new UI,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new UI(e),this._firestoreClient=void 0,await e}}}function Ux(t,e){const n=typeof t=="object"?t:XC(),r=typeof t=="string"?t:ch,i=s_(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=w2("firestore");s&&Fx(i,...s)}return i}function tc(t){if(t._terminated)throw new re(K.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||Ox(t),t._firestoreClient}function Ox(t){var r,i,s;const e=t._freezeSettings(),n=function(a,l,u,f){return new OU(a,l,u,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,Vx(f.experimentalLongPollingOptions),f.useFetchStreams,f.isUsingEmulator)}(t._databaseId,((r=t._app)==null?void 0:r.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(i=e.localCache)!=null&&i._offlineComponentProvider&&((s=e.localCache)!=null&&s._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new s6(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(t._componentsProvider))}function Bx(t,e){Ji("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings();return c6(t,Eh.provider,{build:r=>new i6(r,n.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}function c6(t,e,n){if((t=an(t,Rr))._firestoreClient||t._terminated)throw new re(K.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new re(K.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:n},Ox(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class An{constructor(e){this._byteString=e}static fromBase64String(e){try{return new An(Et.fromBase64String(e))}catch(n){throw new re(K.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new An(Et.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:An._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Hu(e,An._jsonSchema))return An.fromBase64String(e.bytes)}}An._jsonSchemaVersion="firestore/bytes/1.0",An._jsonSchema={type:Ct("string",An._jsonSchemaVersion),bytes:Ct("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nc{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new re(K.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ot(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rc{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class or{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new re(K.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new re(K.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Ae(this._lat,e._lat)||Ae(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:or._jsonSchemaVersion}}static fromJSON(e){if(Hu(e,or._jsonSchema))return new or(e.latitude,e.longitude)}}or._jsonSchemaVersion="firestore/geoPoint/1.0",or._jsonSchema={type:Ct("string",or._jsonSchemaVersion),latitude:Ct("number"),longitude:Ct("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ar{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}toJSON(){return{type:ar._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Hu(e,ar._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new ar(e.vectorValues);throw new re(K.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ar._jsonSchemaVersion="firestore/vectorValue/1.0",ar._jsonSchema={type:Ct("string",ar._jsonSchemaVersion),vectorValues:Ct("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d6=/^__.*__$/;class h6{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new ri(e,this.data,this.fieldMask,n,this.fieldTransforms):new Ba(e,this.data,n,this.fieldTransforms)}}class qx{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new ri(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function Gx(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw he(40011,{Ac:t})}}class Z_{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Z_({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var i;const n=(i=this.path)==null?void 0:i.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){var i;const n=(i=this.path)==null?void 0:i.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return wh(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(Gx(this.Ac)&&d6.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class f6{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||hf(e)}Cc(e,n,r,i=!1){return new Z_({Ac:e,methodName:n,Dc:r,path:ot.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function ey(t){const e=t._freezeSettings(),n=hf(t._databaseId);return new f6(t._databaseId,!!e.ignoreUndefinedProperties,n)}function p6(t,e,n,r,i,s={}){const o=t.Cc(s.merge||s.mergeFields?2:0,e,n,i);ny("Data must be an object, but it was:",o,r);const a=zx(r,o);let l,u;if(s.merge)l=new gn(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const f=[];for(const m of s.mergeFields){const g=Zm(e,m,n);if(!o.contains(g))throw new re(K.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);Hx(f,g)||f.push(g)}l=new gn(f),u=o.fieldTransforms.filter(m=>l.covers(m.field))}else l=null,u=o.fieldTransforms;return new h6(new Yt(a),l,u)}class mf extends rc{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof mf}}class ty extends rc{_toFieldTransform(e){return new MA(e.path,new Ca)}isEqual(e){return e instanceof ty}}function m6(t,e,n,r){const i=t.Cc(1,e,n);ny("Data must be an object, but it was:",i,r);const s=[],o=Yt.empty();os(r,(l,u)=>{const f=ry(e,l,n);u=Dt(u);const m=i.yc(f);if(u instanceof mf)s.push(f);else{const g=ic(u,m);g!=null&&(s.push(f),o.set(f,g))}});const a=new gn(s);return new qx(o,a,i.fieldTransforms)}function g6(t,e,n,r,i,s){const o=t.Cc(1,e,n),a=[Zm(e,r,n)],l=[i];if(s.length%2!=0)throw new re(K.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<s.length;g+=2)a.push(Zm(e,s[g])),l.push(s[g+1]);const u=[],f=Yt.empty();for(let g=a.length-1;g>=0;--g)if(!Hx(u,a[g])){const v=a[g];let T=l[g];T=Dt(T);const A=o.yc(v);if(T instanceof mf)u.push(v);else{const D=ic(T,A);D!=null&&(u.push(v),f.set(v,D))}}const m=new gn(u);return new qx(f,m,o.fieldTransforms)}function _6(t,e,n,r=!1){return ic(n,t.Cc(r?4:3,e))}function ic(t,e){if($x(t=Dt(t)))return ny("Unsupported field value:",e,t),zx(t,e);if(t instanceof rc)return function(r,i){if(!Gx(i.Ac))throw i.Sc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const a of r){let l=ic(a,i.wc(o));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=Dt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return s4(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=He.fromDate(r);return{timestampValue:Ra(i.serializer,s)}}if(r instanceof He){const s=new He(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Ra(i.serializer,s)}}if(r instanceof or)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof An)return{bytesValue:qA(i.serializer,r._byteString)};if(r instanceof ft){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:D_(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof ar)return function(o,a){return{mapValue:{fields:{[S_]:{stringValue:C_},[Ea]:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw a.Sc("VectorValues must only contain numeric values.");return x_(a.serializer,u)})}}}}}}(r,i);throw i.Sc(`Unsupported field value: ${Jh(r)}`)}(t,e)}function zx(t,e){const n={};return oA(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):os(t,(r,i)=>{const s=ic(i,e.mc(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function $x(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof He||t instanceof or||t instanceof An||t instanceof ft||t instanceof rc||t instanceof ar)}function ny(t,e,n){if(!$x(n)||!H0(n)){const r=Jh(n);throw r==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+r)}}function Zm(t,e,n){if((e=Dt(e))instanceof nc)return e._internalPath;if(typeof e=="string")return ry(t,e);throw wh("Field path arguments must be of type string or ",t,!1,void 0,n)}const y6=new RegExp("[~\\*/\\[\\]]");function ry(t,e,n){if(e.search(y6)>=0)throw wh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new nc(...e.split("."))._internalPath}catch{throw wh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function wh(t,e,n,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new re(K.INVALID_ARGUMENT,a+t+l)}function Hx(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wx{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new ft(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new v6(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(iy("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class v6 extends Wx{data(){return super.data()}}function iy(t,e){return typeof e=="string"?ry(t,e):e instanceof nc?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kx(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new re(K.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class sy{}class jx extends sy{}function bl(t,e,...n){let r=[];e instanceof sy&&r.push(e),r=r.concat(n),function(s){const o=s.filter(l=>l instanceof gf).length,a=s.filter(l=>l instanceof sc).length;if(o>1||o>0&&a>0)throw new re(K.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class sc extends jx{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new sc(e,n,r)}_apply(e){const n=this._parse(e);return Jx(e._query,n),new as(e.firestore,e.converter,Bm(e._query,n))}_parse(e){const n=ey(e.firestore);return function(s,o,a,l,u,f,m){let g;if(u.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new re(K.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){GI(m,f);const T=[];for(const A of m)T.push(qI(l,s,A));g={arrayValue:{values:T}}}else g=qI(l,s,m)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||GI(m,f),g=_6(a,o,m,f==="in"||f==="not-in");return Le.create(u,f,g)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Ml(t,e,n){const r=e,i=iy("where",t);return sc._create(i,r,n)}class gf extends sy{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new gf(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:je.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i;const a=s.getFlattenedFilters();for(const l of a)Jx(o,l),o=Bm(o,l)}(e._query,n),new as(e.firestore,e.converter,Bm(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function qI(t,e,n){if(typeof(n=Dt(n))=="string"){if(n==="")throw new re(K.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!wA(e)&&n.indexOf("/")!==-1)throw new re(K.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(ze.fromString(n));if(!ae.isDocumentKey(r))throw new re(K.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return ku(t,new ae(r))}if(n instanceof ft)return ku(t,n._key);throw new re(K.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Jh(n)}.`)}function GI(t,e){if(!Array.isArray(t)||t.length===0)throw new re(K.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Jx(t,e){const n=function(i,s){for(const o of i)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new re(K.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new re(K.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class Qx{convertValue(e,n="none"){switch(Yi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return it(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Xr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw he(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return os(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertVectorValue(e){var r,i,s;const n=(s=(i=(r=e.fields)==null?void 0:r[Ea].arrayValue)==null?void 0:i.values)==null?void 0:s.map(o=>it(o.doubleValue));return new ar(n)}convertGeoPoint(e){return new or(it(e.latitude),it(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=tf(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Ru(e));default:return null}}convertTimestamp(e){const n=Yr(e);return new He(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=ze.fromString(e);_e(YA(r),9688,{name:e});const i=new Qi(r.get(1),r.get(3)),s=new ae(r.popFirst(5));return i.isEqual(n)||rn(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T6(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class Ko{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class $i extends Wx{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new tu(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(iy("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new re(K.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=$i._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}$i._jsonSchemaVersion="firestore/documentSnapshot/1.0",$i._jsonSchema={type:Ct("string",$i._jsonSchemaVersion),bundleSource:Ct("string","DocumentSnapshot"),bundleName:Ct("string"),bundle:Ct("string")};class tu extends $i{data(e={}){return super.data(e)}}class Hi{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new Ko(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new tu(this._firestore,this._userDataWriter,r.key,r,new Ko(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new re(K.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{const l=new tu(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Ko(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{const l=new tu(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Ko(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let u=-1,f=-1;return a.type!==0&&(u=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),f=o.indexOf(a.doc.key)),{type:E6(a.type),doc:l,oldIndex:u,newIndex:f}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new re(K.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Hi._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=jh.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],i=[];return this.docs.forEach(s=>{s._document!==null&&(n.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function E6(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return he(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eg(t){t=an(t,ft);const e=an(t.firestore,Rr);return l6(tc(e),t._key).then(n=>Yx(e,t,n))}Hi._jsonSchemaVersion="firestore/querySnapshot/1.0",Hi._jsonSchema={type:Ct("string",Hi._jsonSchemaVersion),bundleSource:Ct("string","QuerySnapshot"),bundleName:Ct("string"),bundle:Ct("string")};class oy extends Qx{constructor(e){super(),this.firestore=e}convertBytes(e){return new An(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new ft(this.firestore,null,n)}}function _i(t){t=an(t,as);const e=an(t.firestore,Rr),n=tc(e),r=new oy(e);return Kx(t._query),u6(n,t._query).then(i=>new Hi(e,r,t,i))}function vt(t,e,n){t=an(t,ft);const r=an(t.firestore,Rr),i=T6(t.converter,e,n);return _f(r,[p6(ey(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,sn.none())])}function tg(t,e,n,...r){t=an(t,ft);const i=an(t.firestore,Rr),s=ey(i);let o;return o=typeof(e=Dt(e))=="string"||e instanceof nc?g6(s,"updateDoc",t._key,e,n,r):m6(s,"updateDoc",t._key,e),_f(i,[o.toMutation(t._key,sn.exists(!0))])}function Bt(t){return _f(an(t.firestore,Rr),[new af(t._key,sn.none())])}function Mr(t,...e){var l,u,f;t=Dt(t);let n={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||BI(e[r])||(n=e[r++]);const i={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(BI(e[r])){const m=e[r];e[r]=(l=m.next)==null?void 0:l.bind(m),e[r+1]=(u=m.error)==null?void 0:u.bind(m),e[r+2]=(f=m.complete)==null?void 0:f.bind(m)}let s,o,a;if(t instanceof ft)o=an(t.firestore,Rr),a=Ju(t._key.path),s={next:m=>{e[r]&&e[r](Yx(o,t,m))},error:e[r+1],complete:e[r+2]};else{const m=an(t,as);o=an(m.firestore,Rr),a=m._query;const g=new oy(o);s={next:v=>{e[r]&&e[r](new Hi(o,g,m,v))},error:e[r+1],complete:e[r+2]},Kx(t._query)}return function(g,v,T,A){const D=new X_(A),S=new J_(v,D,T);return g.asyncQueue.enqueueAndForget(async()=>W_(await Ih(g),S)),()=>{D.Nu(),g.asyncQueue.enqueueAndForget(async()=>K_(await Ih(g),S))}}(tc(o),a,i,s)}function _f(t,e){return function(r,i){const s=new Cr;return r.asyncQueue.enqueueAndForget(async()=>QO(await a6(r),i,s)),s.promise}(tc(t),e)}function Yx(t,e,n){const r=n.docs.get(e._key),i=new oy(t);return new $i(t,i,e._key,r,new Ko(n.hasPendingWrites,n.fromCache),e.converter)}function I6(){return new ty("serverTimestamp")}(function(e,n=!0){(function(i){Oa=i})(Fa),pa(new Zs("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),a=new Rr(new XF(r.getProvider("auth-internal")),new tU(o,r.getProvider("app-check-internal")),function(u,f){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new re(K.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Qi(u.options.projectId,f)}(o,i),o);return s={useFetchStreams:n,...s},a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),qi(EE,IE,e),qi(EE,IE,"esm2020")})();const yi=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:Qx,Bytes:An,CollectionReference:$r,DocumentReference:ft,DocumentSnapshot:$i,FieldPath:nc,FieldValue:rc,Firestore:Rr,FirestoreError:re,GeoPoint:or,Query:as,QueryCompositeFilterConstraint:gf,QueryConstraint:jx,QueryDocumentSnapshot:tu,QueryFieldFilterConstraint:sc,QuerySnapshot:Hi,SnapshotMetadata:Ko,Timestamp:He,VectorValue:ar,_AutoId:jh,_ByteString:Et,_DatabaseId:Qi,_DocumentKey:ae,_EmptyAuthCredentialsProvider:q0,_FieldPath:ot,_cast:an,_logWarn:Ji,_validateIsNotUsedTogether:$0,collection:dt,connectFirestoreEmulator:Fx,deleteDoc:Bt,doc:Oe,enableIndexedDbPersistence:Bx,ensureFirestoreConfigured:tc,executeWrite:_f,getDoc:eg,getDocs:_i,getFirestore:Ux,onSnapshot:Mr,query:bl,serverTimestamp:I6,setDoc:vt,setLogLevel:U0,updateDoc:tg,where:Ml},Symbol.toStringTag,{value:"Module"}));U0("error");const w6={apiKey:"AIzaSyC1zhlBnbOxP_PCaHU6L-UsDOBRTjGgpfk",authDomain:"my-apss-da774.firebaseapp.com",projectId:"my-apss-da774",storageBucket:"my-apss-da774.firebasestorage.app",messagingSenderId:"528434940137",appId:"1:528434940137:web:56be66185a46f390b60878",measurementId:"G-WPGZGF4ZBG"},Xx=YC(w6),vi=JF(Xx);LL(vi,I0).catch(t=>console.error("Persistence error:",t));const Hs=new Fr;Hs.addScope("profile");Hs.addScope("email");Hs.setCustomParameters({prompt:"select_account",access_type:"offline"});if(typeof window<"u"){const t=navigator.userAgent.toLowerCase();t.includes("safari")&&!t.includes("chrome")&&!t.includes("firefox")&&Hs.setCustomParameters({prompt:"consent"})}const pe=Ux(Xx);Bx(pe).catch(t=>{t.code==="failed-precondition"?console.warn("Firestore: Multiple tabs open, persistence disabled"):t.code==="unimplemented"&&console.warn("Firestore: Browser does not support persistence")});const zI=()=>{const e=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Mobile|Tablet/i.test(navigator.userAgent),n=navigator.maxTouchPoints&&navigator.maxTouchPoints>2,r=window.innerWidth<=768;return console.log("Mobile detection:",{isUserAgentMobile:e,isTouchDevice:n,isSmallScreen:r,userAgent:navigator.userAgent}),e||n&&r},$I=()=>window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0,Rt=t=>{if(t==null)return;if(typeof t!="object")return t;if(Array.isArray(t)){const r=t.filter(i=>i!==void 0).map(i=>Rt(i)).filter(i=>i!==void 0);return r.length>0?r:void 0}if(t===null)return;let e;try{e=Object.entries(t)}catch(r){console.error("❌ Object.entries 실패:",r,t);return}const n={};for(const[r,i]of e){if(i===void 0||typeof i=="string"&&i.trim()===""){console.warn(`⚠️ 필드 제거됨: ${r} = ${i}`);continue}if(typeof i=="object"&&i!==null){const s=Rt(i);s!==void 0?n[r]=s:console.warn(`⚠️ 중첩 객체/배열 제거됨: ${r}`)}else n[r]=i}return Object.keys(n).length>0?n:void 0},HI=()=>window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",Zx=async()=>"Notification"in window?Notification.permission==="granted"?!0:Notification.permission!=="denied"?await Notification.requestPermission()==="granted":!1:(console.log("This browser does not support notifications"),!1),eR=async()=>{try{if(!("serviceWorker"in navigator)||!("PushManager"in window))return console.log("Push notifications not supported"),!1;const e=await(await navigator.serviceWorker.ready).pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:S6("BOEd9nQKXBj8LJXNM6LJt6Nua5MJMhF8cCQvMNJ-2NWoWsM0cGgNqDG3kNm-QMYbdMDYAXaJ55MFP_fPHqH7SFA")});return await C6(e),!0}catch(t){return console.error("Failed to subscribe to push notifications:",t),!1}},S6=t=>{const e="=".repeat((4-t.length%4)%4),n=(t+e).replace(/\-/g,"+").replace(/_/g,"/"),r=window.atob(n),i=new Uint8Array(r.length);for(let s=0;s<r.length;++s)i[s]=r.charCodeAt(s);return i},C6=async t=>{try{(await fetch("/api/subscribe",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({subscription:t.toJSON(),endpoint:t.endpoint})})).ok||console.error("Failed to send subscription to server")}catch(e){console.error("Error sending subscription to server:",e)}},A6=({onClose:t})=>{const[e,n]=z.useState(null),[r,i]=z.useState(!1);z.useEffect(()=>{const o=/iPad|iPhone|iPod/.test(navigator.userAgent);i(o);const a=l=>{l.preventDefault(),n(l)};return window.addEventListener("beforeinstallprompt",a),()=>{window.removeEventListener("beforeinstallprompt",a)}},[]);const s=async()=>{if(e){e.prompt();const{outcome:o}=await e.userChoice;o==="accepted"&&(n(null),t())}};return p.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:p.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-sm w-full",children:[p.jsxs("div",{className:"text-center mb-4",children:[p.jsx("div",{className:"w-16 h-16 bg-indigo-600 rounded-lg mx-auto mb-4 flex items-center justify-center",children:p.jsx("span",{className:"text-white text-2xl font-bold",children:"N"})}),p.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"앱으로 설치하기"}),p.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-sm",children:"Nova Beta를 홈 화면에 추가하여 더 편리하게 사용하세요."})]}),r?p.jsxs("div",{className:"mb-4",children:[p.jsx("div",{className:"bg-blue-50 dark:bg-blue-900 p-3 rounded-lg mb-3",children:p.jsx("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:"iOS에서 설치하는 방법:"})}),p.jsxs("ol",{className:"text-sm text-gray-600 dark:text-gray-300 space-y-2",children:[p.jsxs("li",{className:"flex items-center",children:[p.jsx("span",{className:"w-6 h-6 bg-indigo-600 text-white rounded-full flex items-center justify-center text-xs mr-2",children:"1"}),"하단의 공유 버튼 (□↗) 탭"]}),p.jsxs("li",{className:"flex items-center",children:[p.jsx("span",{className:"w-6 h-6 bg-indigo-600 text-white rounded-full flex items-center justify-center text-xs mr-2",children:"2"}),'"홈 화면에 추가" 선택']}),p.jsxs("li",{className:"flex items-center",children:[p.jsx("span",{className:"w-6 h-6 bg-indigo-600 text-white rounded-full flex items-center justify-center text-xs mr-2",children:"3"}),'"추가" 버튼 탭']})]})]}):p.jsx("div",{className:"mb-4",children:e?p.jsx("button",{onClick:s,className:"w-full bg-indigo-600 text-white py-2 px-4 rounded-lg hover:bg-indigo-700 transition-colors",children:"지금 설치하기"}):p.jsx("div",{className:"bg-gray-50 dark:bg-gray-700 p-3 rounded-lg",children:p.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:'브라우저 메뉴에서 "홈 화면에 추가" 또는 "앱 설치"를 선택하세요.'})})}),p.jsxs("div",{className:"flex space-x-2",children:[p.jsx("button",{onClick:t,className:"flex-1 bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-gray-200 py-2 px-4 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-500 transition-colors",children:"나중에"}),p.jsx("button",{onClick:()=>{localStorage.setItem("pwa-prompt-dismissed","true"),t()},className:"flex-1 bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-gray-200 py-2 px-4 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-500 transition-colors",children:"다시 보지 않기"})]})]})})},x6={ko:{language_selection_title:"언어",error_wish_required:"목표를 입력해주세요.",error_outcome_required:"결과를 입력해주세요.",error_obstacle_required:"장애물을 입력해주세요.",error_plan_required:"If-Then 계획을 입력해주세요.",error_deadline_required:"마감일을 선택해주세요.",error_day_required:"하나 이상의 요일을 선택해주세요.",my_goals_title:"나의 목표",all_goals_label:"나의 목표",sort_label_manual:"사용자화",sort_label_deadline:"마감일순",sort_label_newest:"최신순",sort_label_alphabetical:"이름순",sort_label_ai:"우선순위로 정렬",ai_sorting_button:"정렬 중...",add_new_goal_button_label:"새로운 목표 추가",filter_all:"나의 목표",filter_active:"진행중",filter_completed:"완료됨",filter_category:"카테고리",category_all:"모든 카테고리",category_school:"학교",category_work:"회사",category_personal:"개인",category_other:"기타",category_label:"카테고리 선택",empty_message_all:"+ 버튼으로 목표를 추가해보세요",empty_message_active:"진행중인 목표가 없습니다.",empty_message_completed:"아직 완료된 목표가 없습니다.",empty_encouragement_1:"새로운 여정의 첫 걸음을 내딛어보세요.",empty_encouragement_2:"작은 변화가 큰 성취로 이어집니다.",empty_encouragement_3:"오늘 하는 일이 내일을 만듭니다.",empty_encouragement_4:"당신의 목표가 현실이 되는 순간을 만나보세요.",delete_button:"삭제",edit_button_aria:"편집",info_button_aria:"정보",filter_title:"필터",sort_title:"정렬",filter_sort_button_aria:"필터 및 정렬",calendar_view_button_aria:"달력 보기",list_view_button_aria:"목록 보기",more_options_button_aria:"더보기",select_button_label:"선택",cancel_selection_button_label:"취소",delete_selected_button_label:"{count}개 삭제",select_all_button_label:"전체선택",delete_selected_confirm_title:"목표 삭제",delete_selected_confirm_message:"선택한 {count}개의 목표가 영구적으로 삭제됩니다. 이 작업은 되돌릴 수 없습니다.",days_left:"{count}일 남음",d_day:"오늘",days_overdue:"{count}일 지남",month_names:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],day_names_short:["일","월","화","수","목","금","토"],day_names_long:["일요일","월요일","화요일","수요일","목요일","금요일","토요일"],calendar_header_month_format:"{year}년 {month}",calendar_view_day3:"3일",calendar_view_week:"주",calendar_view_month:"월",settings_title:"설정",sort_alert_title:"정렬 실패",sort_alert_message:"우선순위 정렬을 사용하려면<br/>2개 이상의 목표가 필요합니다.",ai_sort_error_title:"정렬 오류",ai_sort_error_message:"서버에 연결할 수 없습니다. 나중에 다시 시도해주세요.",confirm_button:"확인",new_goal_modal_title:"새로운 목표",edit_goal_modal_title:"목표 편집",wish_label:"목표",outcome_label:"최상의 결과",obstacle_label:"장애물",plan_label:"If-Then 계획",deadline_label:"마감일",cancel_button:"취소",add_button:"추가",save_button:"저장",goal_details_modal_title:"목표 상세 정보",ai_coach_suggestion:"요약보기",ai_analyzing:"분석 중...",close_button:"닫기",ai_sort_reason_modal_title:"AI 정렬 재안",ai_sort_criteria:"AI 정렬 기준",delete_account_final_confirm_title:"모든 데이터 및 설정 지우기",delete_account_final_confirm_message:"모든 목표와 데이터가 영구적으로 삭제되며, 이 작업은 되돌릴 수 없습니다.",delete_all_data_button:"모든 데이터 및 설정 지우기",settings_done_button:"완료",settings_section_data:"데이터 관리",settings_section_account:"Nova Beta 계정",settings_sync_data:"지금 동기화",settings_load_data:"불러오기",settings_logout:"로그아웃",settings_export_data:"데이터 내보내기",settings_import_data:"데이터 가져오기",import_confirm_title:"데이터 가져오기",import_confirm_message:"현재 목표를 새로운 데이터로 교체합니다. 이 작업은 되돌릴 수 없습니다.",import_success_toast:"데이터를 성공적으로 가져왔습니다.",import_error_alert_title:"가져오기 실패",import_error_alert_message:"파일을 읽는 중 오류가 발생했거나 파일 형식이 올바르지 않습니다. 나중에 다시 시도히십시오.",settings_section_general:"일반",settings_section_info:"정보",settings_section_help:"사용방법",settings_theme_mode:"테마 모드",theme_mode_light:"라이트 모드",theme_mode_light_desc:"항상 밝은 테마 사용",theme_mode_dark:"다크 모드",theme_mode_dark_desc:"항상 어두운 테마 사용",theme_mode_system:"자동",theme_mode_system_desc:"기기의 설정에에 동기화 됩니다.",settings_dark_mode:"다크 모드",settings_language:"언어",settings_api_key:"Gemini AI 설정",settings_api_key_placeholder:"Gemini API 키 입력",settings_offline_mode:"오프라인 사용",settings_offline_mode_desc:"AI 기능 없이 기본 기능 사용",settings_notifications:"알림",settings_notifications_desc:"PWA 알림 설정",notification_settings_title:"어떤 알림을 받을까요?",reminder_add_title:"미리알림 추가",reminder_step_title:"{step}/5 단계",reminder_step1_title:"🔔 제목",reminder_step1_desc:"미리알림의 제목을 입력하세요",reminder_step2_title:"📅 기한 & ⏰ 시간",reminder_step2_desc:"기한 날짜와 시간을 설정하세요 (선택사항)",reminder_step2_date_toggle:"기한 설정",reminder_step2_time_toggle:"시간 설정",reminder_step3_title:"🔄 반복 설정",reminder_step3_desc:"반복 여부와 반복 주기를 선택하세요",reminder_step3_enable_recurring:"반복 설정",reminder_step4_title:"📝 설명",reminder_step4_desc:"추가 설명을 입력하세요 (선택사항)",reminder_step5_title:"✅ 활성화",reminder_step5_desc:"미리알림 활성화 여부를 선택하세요",reminder_next_button:"다음",reminder_back_button:"이전",reminder_submit_button:"추가",reminder_form_title:"제목",reminder_form_date:"기한",reminder_form_time:"시간",reminder_form_recurring:"반복",reminder_form_description:"설명",reminder_form_enabled:"활성화",recurring_type_none:"반복 없음",recurring_type_daily:"매일",recurring_type_weekly:"매주",recurring_type_monthly:"매월",notification_deadline:"마감일 임박 알림",notification_deadline_desc:"마감이 가까운 목표에 대해 알려줍니다.",notification_suggestion:"지금할일 제안",notification_suggestion_desc:"오늘 해야할 목표를 제안해줍니다.",notification_achievement:"목표 달성 축하",notification_achievement_desc:"목표를 달성했을 때 축하해줍니다.",notification_reminder:"일반 미리알림",notification_reminder_desc:"설정한 시간에 미리알림을 받습니다.",reminder_time_settings_title:"미리알림 시간 설정",reminder_start_time:"시작 시간",reminder_end_time:"종료 시간",language_name:"한국어 (대한민국)",language_modal_title:"언어",settings_section_background:"화면",settings_bg_default:"라이트",settings_bg_default_dark:"다크",settings_bg_pink:"핑크",settings_bg_cherry_noir:"다크 체리",settings_bg_blue:"블루",settings_bg_deep_ocean:"오션",settings_bg_green:"그린",settings_bg_forest_green:"포레스트 그린",settings_bg_purple:"퍼플",settings_bg_royal_purple:"딥 퍼플",settings_version:"버전",test_long_alert:"긴 알림 테스트",test_long_alert_desc:"긴 내용의 알림 팝업 테스트",folder_manage_title:"폴더 관리",folder_manage_info:"폴더 정보",folder_manage_collaborators:"협업자",folder_manage_settings:"설정",folder_name_edit:"폴더 이름 편집",folder_invite_new:"새 협업자 초대",folder_invite_email:"이메일 주소",folder_invite_role:"역할",folder_role_owner:"소유자",folder_role_editor:"편집자",folder_role_viewer:"뷰어",folder_invite_button:"초대하기",folder_leave:"폴더 나가기",folder_delete:"폴더 삭제",folder_share_link:"공유 링크",folder_share_link_desc:"이 링크로 다른 사용자를 초대할 수 있습니다",folder_copy_link:"링크 복사",folder_leave_confirm:"폴더에서 나가시겠습니까?",folder_delete_confirm:"폴더를 삭제하시겠습니까? 나의 목표로 이동됩니다.",settings_developer:"개발자",developer_name:"Kim Kyumin",settings_copyright:"저작권",copyright_notice:"© 2025 Kim Kyumin. All Rights Reserved.",build_number:"빌드 번호",settings_data_header:"데이터 관리",settings_data_header_desc:"목표 데이터를 파일로 내보내거나, 파일에서 가져옵니다.",settings_background_header:"배경화면",settings_background_header_desc:"앱의 배경화면 스타일을 변경하여 개성을 표현해 보세요.",data_importing:"가져오는 중...",data_exporting:"내보내는 중...",data_deleting:"삭제 중...",url_import_title:"URL에서 데이터 불러오기",url_import_message:"URL의 데이터로 현재 목표 목록을 병합하시겠습니까?",url_import_confirm:"불러오기",url_import_success:"URL에서 데이터를 성공적으로 가져왔습니다!",url_import_error:"URL의 데이터가 올바르지 않습니다.",settings_share_link_header:"링크로 공유",settings_generate_link:"공유 링크 생성",settings_copy_link:"복사",link_copied_toast:"링크가 클립보드에 복사되었습니다.",short_url_created:"📎 단축 URL이 생성되었습니다!",share_link_created:"🔗 공유 링크가 생성되었습니다!",short_url_failed:"⚠️ 단축 URL 생성에 실패하여 기본 링크를 사용합니다.",no_data_to_share:"공유할 목표가 없습니다.",usage_guide_tab:"사용방법",usage_guide_title:"사용 가이드",usage_basic_title:"목표 추가하기",usage_basic_desc:`1. 홈 화면에서 "목표 추가 및 편집" 버튼을 탭하세요.
2. 목표, 결과, 장애물, 계획을 차례로 입력하세요.
3. 마감일과 반복 요일을 선택하세요.
4. "저장" 버튼을 눌러 목표를 추가하세요.`,usage_ai_title:"Gemini AI 기능 사용하기",usage_ai_desc:`• 목표 작성 시 "요약보기" 버튼으로 Gemini AI의 개선된 목표를 받아보세요.
• 목표 목록에서 "우선순위 정렬" 버튼으로 중요도 순 정렬이 가능합니다.
• Gemini AI 분석을 통해 더 효과적인 목표 설정을 도와드립니다.

※ Gemini AI 기능 사용을 위해서는 API 키 설정이 필요합니다.`,usage_ai_setup_title:"Gemini AI 설정하기",usage_ai_setup_desc:`1. 설정 > 일반에서 "Gemini AI 설정" 항목을 찾으세요.
2. Google Gemini API 키를 입력하세요.
3. API 키 발급 방법은 다음 Google 지원 문서를 참조하세요:
   https://ai.google.dev/gemini-api/docs/api-key
4. 키 입력 후 Gemini AI 기능이 활성화됩니다.`,usage_share_title:"목표 공유하기",usage_share_desc:`1. 설정 > 공유에서 "목표 링크 생성" 버튼을 탭하세요.
2. 자동으로 생성된 단축 링크를 확인하세요.
3. "링크 복사" 버튼으로 클립보드에 복사하세요.
4. 메신저나 이메일로 링크를 공유하세요.`,usage_theme_title:"테마 변경하기",usage_theme_desc:`1. 설정 > 모양에서 다크 모드 토글을 사용하세요.
2. 배경 테마에서 원하는 색상을 선택하세요.
3. 기본, 핑크, 블루, 그린, 퍼플 테마 중 선택 가능합니다.
4. 변경 사항은 즉시 적용됩니다.`,usage_calendar_title:"캘린더 보기 사용하기",usage_calendar_desc:`1. 하단 탭에서 캘린더 아이콘을 탭하세요.
2. 3일/주간/월간 보기를 선택할 수 있습니다.
3. 날짜를 탭하여 해당 날의 목표를 확인하세요.
4. 좌우 화살표로 날짜를 이동할 수 있습니다.`,usage_offline_title:"오프라인 모드 사용하기",usage_offline_desc:`1. 설정 > 일반에서 "오프라인 모드" 토글을 켜세요.
2. API 키 없이도 목표 추가, 편집, 삭제가 가능합니다.
3. AI 기능은 사용할 수 없지만 모든 기본 기능은 정상 작동합니다.
4. 데이터는 브라우저에 안전하게 저장됩니다.`,goal_assistant_title:"새로운 목표",goal_assistant_mode_woop:"WOOP",goal_assistant_mode_automation:"장기 계획",automation_title:"장기 목표 만들기",automation_base_name_label:"목표 이름",automation_base_name_placeholder:"예: 영어 단어 학습",automation_total_units_label:"총 분량",automation_total_units_placeholder:"예: 30",automation_units_per_day_label:"일일 분량",automation_period_label:"기간",automation_start_date_label:"시작일",automation_end_date_label:"종료일",automation_generate_button:"{count}개 생성",automation_error_all_fields:"모든 필드를 올바르게 입력해주세요.",automation_error_start_after_end:"시작일은 종료일보다 빨라야 합니다.",automation_error_short_period:"기간이 너무 짧습니다. (1일 이상)",next_button:"다음",back_button:"이전",wish_tip:"측정 가능하고 구체적인, 도전적이면서도 현실적인 목표를 설정하세요.",wish_example:"예: 3개월 안에 5kg 감량하기, 이번 학기에 A+ 받기",outcome_tip:"목표 달성 시 얻게 될 가장 긍정적인 결과를 생생하게 상상해 보세요.",outcome_example:"예: 더 건강하고 자신감 있는 모습, 성적 장학금 수령",obstacle_tip:"목표 달성을 방해할 수 있는 내면의 장애물(습관, 감정 등)은 무엇인가요?",obstacle_example:"예: 퇴근 후 피곤해서 운동 가기 싫은 마음, 어려운 과제를 미루는 습관",plan_tip:"'만약 ~라면, ~하겠다' 형식으로 장애물에 대한 구체적인 대응 계획을 세워보세요.",plan_example:"예: 만약 퇴근 후 운동 가기 싫다면, 일단 운동복으로 갈아입고 10분만 스트레칭한다.",recurrence_label:"반복",recurrence_tip:"정해진 요일에 꾸준히 해야 하는 목표인가요? 반복으로 설정하여 연속 달성을 기록해 보세요.",recurrence_example:"예: 매주 월,수,금 헬스장 가기",recurrence_option_daily:"반복 목표",deadline_tip:"현실적인 마감일을 설정하여 동기를 부여하세요. 마감일이 없는 장기 목표도 좋습니다.",deadline_option_no_deadline:"마감일 없음",day_names_short_picker:["월","화","수","목","금","토","일"],settings_delete_account:"모든 데이터 삭제",delete_account_header:"데이터 삭제",delete_account_header_desc:"이 작업은 되돌릴 수 없으며, 모든 목표와 데이터가 영구적으로 삭제됩니다.",version_update_title:"새로운 기능",version_update_1_title:"Firebase 클라우드 동기화",version_update_1_desc:"Google 로그인으로 목표와 설정값을 클라우드에 저장하고 불러올 수 있습니다. 목표는 같은 Google 계정으로 로그인된 여러 기기에서 동기화됩니다.",version_update_2_title:"자동 설정 동기화",version_update_2_desc:"언어, 테마, 배경 색상 등 모든 설정값이 클라우드에 저장되어 다른 기기에서도 동일하게 적용됩니다.",version_update_3_title:"안전한 로그아웃",version_update_3_desc:"로그아웃 시 모든 데이터가 클라우드에 저장되고, 로컬 데이터는 완전히 삭제되며 홈으로 이동합니다.",version_update_4_title:"상태 표시 UI",version_update_4_desc:"로그인, 로그아웃, 동기화 등의 작업 중 버튼 상태가 변화하여 진행 상황을 명확히 보여줍니다."},en:{language_selection_title:"Language",error_wish_required:"Please enter your wish.",error_outcome_required:"Please enter the outcome.",error_obstacle_required:"Please enter the obstacle.",error_plan_required:"Please enter your If-Then plan.",error_deadline_required:"Please select a deadline.",error_day_required:"Please select at least one day.",my_goals_title:"My Goals",all_goals_label:"나의 목표",sort_label_manual:"Manual",sort_label_deadline:"Deadline",sort_label_newest:"Newest",sort_label_alphabetical:"Alphabetical",sort_label_ai:"Priority Order",ai_sorting_button:"Sorting...",add_new_goal_button_label:"Add New Goal",filter_all:"나의 목표",filter_active:"In Progress",filter_completed:"Completed",filter_category:"Category",category_all:"All Categories",category_school:"School",category_work:"Work",category_personal:"Personal",category_other:"Other",category_label:"Select Category",empty_message_all:"Add a goal with the + button",empty_message_active:"No goals in progress.",empty_message_completed:"No completed goals yet.",empty_encouragement_1:"Take the first step toward something amazing.",empty_encouragement_2:"Small changes lead to big achievements.",empty_encouragement_3:"What you do today shapes tomorrow.",empty_encouragement_4:"Your goals are waiting to become reality.",delete_button:"Delete",edit_button_aria:"Edit Goal",info_button_aria:"Details",filter_title:"Filter",sort_title:"Sort",filter_sort_button_aria:"Filter and Sort",calendar_view_button_aria:"Calendar View",list_view_button_aria:"List View",more_options_button_aria:"More",select_button_label:"Select",cancel_selection_button_label:"Cancel",delete_selected_button_label:"Delete {count}",select_all_button_label:"Select All",delete_selected_confirm_title:"Delete Goals",delete_selected_confirm_message:"The {count} selected goals will be permanently deleted.",days_left:"{count} days left",d_day:"D-DAY",days_overdue:"{count} days overdue",month_names:["January","February","March","April","May","June","July","August","September","October","November","December"],day_names_short:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],day_names_long:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],calendar_header_month_format:"{month} {year}",calendar_view_day3:"3-Day",calendar_view_week:"Week",calendar_view_month:"Month",settings_title:"Settings",sort_alert_title:"Unable to Sort",sort_alert_message:"Add at least two goals to use priority order.",ai_sort_error_title:"Unable to Sort",ai_sort_error_message:"Cannot connect to server. Please try again later.",confirm_button:"OK",new_goal_modal_title:"New Goal",edit_goal_modal_title:"Edit Goal",wish_label:"Wish",outcome_label:"Outcome",obstacle_label:"Obstacle",plan_label:"If-Then Plan",deadline_label:"Deadline",cancel_button:"Cancel",add_button:"Add",save_button:"Save",goal_details_modal_title:"Goal Details",ai_coach_suggestion:"View Summary",ai_analyzing:"Analyzing...",close_button:"Close",ai_sort_reason_modal_title:"Sort Reason",ai_sort_criteria:"🤖 Sort Criteria",delete_account_final_confirm_title:"Delete All Data",delete_account_final_confirm_message:"All your goals and data will be permanently deleted. This action cannot be undone.",delete_all_data_button:"Delete All Data",settings_done_button:"Done",settings_section_data:"Data Management",settings_export_data:"Export",settings_import_data:"Import",import_confirm_title:"Import Data",import_confirm_message:"This will replace your current goals with new data. This action cannot be undone.",import_success_toast:"Data imported successfully.",import_error_alert_title:"Import Failed",import_error_alert_message:"There was an error reading the file, or the file format is incorrect.",settings_section_general:"General",settings_section_info:"Information",settings_section_help:"How to Use",settings_theme_mode:"Theme Mode",theme_mode_light:"Light Mode",theme_mode_light_desc:"Use bright theme",theme_mode_dark:"Dark Mode",theme_mode_dark_desc:"Use dark theme",theme_mode_system:"Follow System Settings",theme_mode_system_desc:"Automatically adjust to device settings",settings_dark_mode:"Dark Mode",settings_language:"Language",settings_api_key:"Gemini AI Setup",settings_api_key_placeholder:"Enter Gemini API key",settings_offline_mode:"Offline Mode",settings_offline_mode_desc:"Use basic features without AI",settings_notifications:"Notifications",settings_notifications_desc:"PWA notification settings",notification_settings_title:"What notifications would you like?",notification_deadline:"Deadline Alerts",notification_deadline_desc:"Get notified when deadlines are approaching.",notification_suggestion:"Today's Suggestions",notification_suggestion_desc:"Get suggestions on what to do today.",notification_achievement:"Achievement Celebration",notification_achievement_desc:"Celebrate when you achieve a goal.",notification_reminder:"General Reminder",notification_reminder_desc:"Get reminded at scheduled times.",reminder_time_settings_title:"Reminder Time Settings",reminder_start_time:"Start Time",reminder_end_time:"End Time",reminder_add_title:"Add Reminder",reminder_step_title:"Step {step}/5",reminder_step1_title:"🔔 Title",reminder_step1_desc:"Enter the reminder title",reminder_step2_title:"📅 Date & ⏰ Time",reminder_step2_desc:"Set the reminder date and time (optional)",reminder_step2_date_toggle:"Set Date",reminder_step2_time_toggle:"Set Time",reminder_step3_title:"🔄 Recurring",reminder_step3_desc:"Choose recurrence settings",reminder_step3_enable_recurring:"Enable Recurring",reminder_step4_title:"📝 Description",reminder_step4_desc:"Add optional description",reminder_step5_title:"✅ Enable",reminder_step5_desc:"Choose whether to enable reminder",reminder_next_button:"Next",reminder_back_button:"Back",reminder_submit_button:"Add",reminder_form_title:"Title",reminder_form_date:"Date",reminder_form_time:"Time",reminder_form_recurring:"Recurring",reminder_form_description:"Description",reminder_form_enabled:"Enabled",recurring_type_none:"No Recurrence",recurring_type_daily:"Daily",recurring_type_weekly:"Weekly",recurring_type_monthly:"Monthly",language_name:"English (US)",language_modal_title:"Language",settings_section_background:"Appearance",settings_share_link_header:"Share via Link",settings_generate_link:"Generate Share Link",settings_bg_default:"Light",settings_bg_default_dark:"Dark",settings_bg_pink:"Pink",settings_bg_cherry_noir:"Cherry Noir",settings_bg_blue:"Blue",settings_bg_deep_ocean:"Ocean",settings_bg_green:"Green",settings_bg_forest_green:"Forest",settings_bg_purple:"Purple",settings_bg_royal_purple:"Royal Purple",settings_section_account:"Nova Beta Account",settings_sync_data:"Sync Data",settings_load_data:"Load Data",settings_logout:"Sign Out",settings_delete_account:"Delete All Data",delete_account_header:"Delete Data",delete_account_header_desc:"This action is irreversible and will permanently delete all your goals and data.",data_deleting:"Deleting...",settings_version:"Version",test_long_alert:"Test Long Alert",test_long_alert_desc:"Test alert popup with long content",settings_developer:"Developer",developer_name:"GimGyuMin",settings_copyright:"Copyright",copyright_notice:"© 2025 GimGyuMin. All Rights Reserved.",build_number:"Build Number",settings_data_header:"Data Management",settings_data_header_desc:"Export or import your goal data.",settings_background_header:"Background",settings_background_header_desc:"Change the app's background style to express your personality.",data_importing:"Importing...",data_exporting:"Exporting..."}},Se={add:p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),p.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),check:p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:p.jsx("polyline",{points:"20 6 9 17 4 12"})}),info:p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("circle",{cx:"12",cy:"12",r:"10"}),p.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),p.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),delete:p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("polyline",{points:"3 6 5 6 21 6"}),p.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}),p.jsx("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),p.jsx("line",{x1:"14",y1:"11",x2:"14",y2:"17"})]}),edit:p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),p.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),close:p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),p.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}),back:p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:p.jsx("polyline",{points:"15 18 9 12 15 6"})}),forward:p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:p.jsx("polyline",{points:"9 18 15 12 9 6"})}),calendar:p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),p.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),p.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),p.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),list:p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("line",{x1:"8",y1:"6",x2:"21",y2:"6"}),p.jsx("line",{x1:"8",y1:"12",x2:"21",y2:"12"}),p.jsx("line",{x1:"8",y1:"18",x2:"21",y2:"18"}),p.jsx("line",{x1:"3",y1:"6",x2:"3.01",y2:"6"}),p.jsx("line",{x1:"3",y1:"12",x2:"3.01",y2:"12"}),p.jsx("line",{x1:"3",y1:"18",x2:"3.01",y2:"18"})]}),settings:p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("circle",{cx:"12",cy:"12",r:"3"}),p.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]}),filter:p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:p.jsx("polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"})}),ai:p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("path",{d:"M12 3L14.34 8.66L20 11L14.34 13.34L12 19L9.66 13.34L4 11L9.66 8.66L12 3Z"}),p.jsx("path",{d:"M5 21L7 16"}),p.jsx("path",{d:"M19 21L17 16"})]}),flame:p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:p.jsx("path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"})}),data:p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83"}),p.jsx("path",{d:"M22 12A10 10 0 0 0 12 2v10z"})]}),background:p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),p.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),p.jsx("polyline",{points:"21 15 16 10 5 21"})]}),exclamation:p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 15c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1zm1-4h-2V7h2v6z"})})},nu=(t,e)=>{const n=new Date(t),r=new Date(e);return n.getFullYear()===r.getFullYear()&&n.getMonth()===r.getMonth()&&n.getDate()===r.getDate()},R6=(t,e)=>{if(!t)return null;const n=new Date;n.setHours(0,0,0,0);const r=new Date(t);r.setHours(0,0,0,0);const i=r.getTime()-n.getTime(),s=Math.ceil(i/(1e3*60*60*24));return s===0?e("d_day"):s>0?e("days_left").replace("{count}",String(s)):e("days_overdue").replace("{count}",String(Math.abs(s)))},WI=(t,e=1)=>{const n=new Date(t),r=n.getDay(),i=(r<e?7:0)+r-e;return n.setDate(n.getDate()-i),n.setHours(0,0,0,0),n},KI=t=>{try{const e=new TextEncoder().encode(t),n=Array.from(e).map(r=>String.fromCharCode(r)).join("");return btoa(n)}catch(e){return console.error("UTF-8 to Base64 encoding failed:",e),""}},jI=t=>{try{const e=atob(t),n=new Uint8Array(e.length);for(let r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return new TextDecoder().decode(n)}catch(e){return console.error("Base64 to UTF-8 decoding failed:",e),""}},JI=t=>{try{const n=JSON.stringify(t).replace(/\s+/g," ").trim();return KI(n)}catch(e){return console.error("Data compression failed:",e),KI(JSON.stringify(t))}},P6=async t=>{if(t.length<1500)return t;const e=[{name:"is.gd",createUrl:async n=>{const r=await fetch(`https://is.gd/create.php?format=simple&url=${encodeURIComponent(n)}`);if(!r.ok)throw new Error("is.gd API failed");const i=await r.text();if(i.includes("Error")||!i.startsWith("http"))throw new Error("Invalid response from is.gd");return i.trim()}},{name:"tinyurl",createUrl:async n=>new Promise((r,i)=>{const s=`tinyurl_${Date.now()}`,o=document.createElement("script"),a=setTimeout(()=>{l(),i(new Error("TinyURL timeout"))},5e3),l=()=>{clearTimeout(a),o.parentNode&&document.head.removeChild(o),delete window[s]};window[s]=u=>{l(),u&&typeof u=="string"&&!u.includes("Error")&&u.startsWith("http")?r(u.trim()):i(new Error("Invalid TinyURL response"))},o.onerror=()=>{l(),i(new Error("TinyURL script load failed"))},o.src=`https://tinyurl.com/api-create.php?url=${encodeURIComponent(n)}&callback=${s}`,document.head.appendChild(o)})},{name:"v.gd",createUrl:async n=>{const r=await fetch(`https://v.gd/create.php?format=simple&url=${encodeURIComponent(n)}`);if(!r.ok)throw new Error("v.gd API failed");const i=await r.text();if(i.includes("Error")||!i.startsWith("http"))throw new Error("Invalid response from v.gd");return i.trim()}}];for(const n of e)try{console.log(`Trying ${n.name} for URL shortening...`);const r=await n.createUrl(t);return console.log(`✅ ${n.name} success:`,r),r}catch(r){console.warn(`❌ ${n.name} failed:`,r);continue}return console.warn("All URL shortening services failed, using original URL"),t},ng=[{id:"default",lightThemeClass:"bg-solid-default",darkThemeClass:"bg-solid-default",lightNameKey:"settings_bg_default",darkNameKey:"settings_bg_default_dark"},{id:"pink",lightThemeClass:"bg-solid-pink",darkThemeClass:"bg-solid-pink",lightNameKey:"settings_bg_pink",darkNameKey:"settings_bg_cherry_noir"},{id:"blue",lightThemeClass:"bg-solid-blue",darkThemeClass:"bg-solid-blue",lightNameKey:"settings_bg_blue",darkNameKey:"settings_bg_deep_ocean"},{id:"green",lightThemeClass:"bg-solid-green",darkThemeClass:"bg-solid-green",lightNameKey:"settings_bg_green",darkNameKey:"settings_bg_forest_green"},{id:"purple",lightThemeClass:"bg-solid-purple",darkThemeClass:"bg-solid-purple",lightNameKey:"settings_bg_purple",darkNameKey:"settings_bg_royal_purple"}],k6=()=>{const[t,e]=z.useState("ko"),[n,r]=z.useState([]),[i,s]=z.useState([]),[o,a]=z.useState(null),[l,u]=z.useState("all"),[f,m]=z.useState("all"),[g,v]=z.useState("manual"),[T,A]=z.useState(["school","work","personal","other"]),[D,S]=z.useState(()=>HI()==="dark"),[I,P]=z.useState("system"),[V,U]=z.useState("default"),[O,E]=z.useState([]),[w,C]=z.useState({}),[k,b]=z.useState([]),[L,N]=z.useState(!1),[De,Fe]=z.useState(!1),[We,Ee]=z.useState(null),[ne,ce]=z.useState(!1),[ye,we]=z.useState(null),[Pe,$e]=z.useState(""),[Ke,Mt]=z.useState(""),[lt,ge]=z.useState("editor"),[tn,Tn]=z.useState(!1),[Mn,cr]=z.useState(null),[dr,dn]=z.useState(!1),[Pr,Me]=z.useState(!1),[At,qe]=z.useState(!1),[ut,le]=z.useState(null),[Vt,ii]=z.useState(!1),[ls,us]=z.useState(new Set),[fo,Re]=z.useState(""),[oc,kr]=z.useState("idle"),[cs,za]=z.useState(!1),[ac,$a]=z.useState(!1),[lc,ds]=z.useState(""),[Ha,hs]=z.useState(!1),[En,fs]=z.useState(void 0),[po,Wa]=z.useState(!1),[Vn,ps]=z.useState(""),[yt,uc]=z.useState(!1),[hr,ms]=z.useState(!0),[Y,Ka]=z.useState(null),[gs,ay]=z.useState(""),[ly,ja]=z.useState(!1),[cc,mo]=z.useState(!1),[Ja,Nr]=z.useState(!1),[Qa,It]=z.useState(!1),[dc,Ya]=z.useState(!1),[_s,Xa]=z.useState(!0);z.useEffect(()=>{let R=null,M=null,F=null,B=null,H=null,Q={};const J=OL(vi,async Z=>{if(Ka(Z),Xa(!1),Z){console.log("🔑 사용자 로그인 감지 - Firebase 데이터 로드 시작"),await go(Z),console.log("📡 실시간 데이터 동기화 리스너 설정 중...");const W=Oe(pe,"users",Z.uid,"data","todos");R=Mr(W,j=>{B&&clearTimeout(B),B=setTimeout(()=>{if(j.exists()){const Te=j.data().todos||[];r(me=>{const oe=me.filter(ct=>ct.isSharedTodo===!0),Ie=Te.map(ct=>({...ct,isSharedTodo:!1}));return Ie.length!==me.filter(ct=>!ct.isSharedTodo).length||Ie.some((ct,Es)=>{const Un=me.filter(In=>!In.isSharedTodo)[Es];return!Un||JSON.stringify(Un)!==JSON.stringify(ct)})?(console.log("🔄 개인 목표 데이터 실시간 업데이트:",Ie.length,"공유 목표 보존:",oe.length),[...Ie,...oe]):me})}},2e3)});const X=dt(pe,"users",Z.uid,"folders");M=Mr(X,async j=>{H&&clearTimeout(H),H=setTimeout(async()=>{const fe=[];j.forEach(me=>{const oe=me.data(),Ie={id:me.id,name:oe.name||"이름 없는 폴더",color:oe.color||"#007AFF",...oe,collaborators:oe.collaborators||[],ownerId:oe.ownerId||Z.uid};fe.push(Ie)});const Te=fe.filter(me=>me.isShared&&me.ownerId&&me.ownerId!==Z.uid);if(Te.length>0){console.log("📡 공유 폴더 실시간 동기화 설정:",Te.map(oe=>({id:oe.id,name:oe.name,ownerId:oe.ownerId}))),F&&F();const me=[];for(const oe of Te)if(oe.ownerId)try{const Ie=Oe(pe,"users",oe.ownerId,"folders",oe.id),Ze=Mr(Ie,In=>{if(In.exists()){const pr=In.data();s(hn=>hn.map(fn=>fn.id===oe.id?{...fn,name:pr.name||fn.name||"공유 폴더",color:pr.color||fn.color,updatedAt:pr.updatedAt||fn.updatedAt}:fn))}},In=>{console.error("❌ 공유 폴더 정보 동기화 오류:",In)});me.push(Ze);const ct=dt(pe,"users",oe.ownerId,"todos"),Es=bl(ct,Ml("folderId","==",oe.id));Q[oe.id]&&clearTimeout(Q[oe.id]);const Un=Mr(Es,In=>{Q[oe.id]&&clearTimeout(Q[oe.id]),Q[oe.id]=setTimeout(()=>{const pr=[];In.forEach(hn=>{const fn=hn.data();pr.push({id:parseInt(hn.id),...fn,isSharedTodo:!0})}),r(hn=>{const fn=hn.filter(On=>!(On.folderId===oe.id&&On.isSharedTodo===!0)),vo=pr.filter(On=>!fn.some(To=>To.id===On.id)),ul=[...fn,...vo];return ul.length!==hn.length||ul.some((On,To)=>{const cl=hn[To];return!cl||JSON.stringify(cl)!==JSON.stringify(On)})?ul:hn})},1500)},In=>{console.warn("⚠️ 공유 폴더 실시간 동기화 오류:",{folderId:oe.id,error:In.code})});me.push(Un)}catch(Ie){console.warn("⚠️ 공유 폴더 리스너 설정 실패:",{folderId:oe.id,error:Ie})}F=()=>{me.forEach(oe=>oe())}}s(me=>fe.length!==me.length||fe.some((Ie,Ze)=>{const ct=me[Ze];return!ct||JSON.stringify(ct)!==JSON.stringify(Ie)})?(console.log("🔄 폴더 데이터 실시간 업데이트:",fe.map(Ie=>({id:Ie.id,name:Ie.name}))),fe):me)},3e3)})}else console.log("🚪 사용자 로그아웃 감지 - 데이터 초기화"),R&&(R(),R=null),M&&(M(),M=null),F&&(F(),F=null),r([]),s([]),e("ko"),P("system"),U("default"),ps(""),A(["school","work","personal","other"])});return()=>{J(),R&&R(),M&&M(),F&&F(),B&&clearTimeout(B),H&&clearTimeout(H),Object.values(Q).forEach(Z=>clearTimeout(Z))}},[]);const hc=z.useCallback(()=>{console.log("🔍 Firebase 진단 시작..."),console.log("Firebase Auth:",vi),console.log("Firebase DB:",pe),console.log("Google Provider:",Hs),console.log("환경 변수 확인:"),console.log("- VITE_FIREBASE_API_KEY:","✅ 설정됨"),console.log("- VITE_FIREBASE_AUTH_DOMAIN:","✅ 설정됨"),console.log("- VITE_FIREBASE_PROJECT_ID:","✅ 설정됨"),console.log("브라우저 정보:"),console.log("- User Agent:",navigator.userAgent),console.log("- 쿠키 활성화:",navigator.cookieEnabled),console.log("- 로컬 스토리지 지원:",typeof Storage<"u"),console.log("네트워크 상태:",navigator.onLine?"✅ 온라인":"❌ 오프라인")},[]),Za=z.useCallback(async()=>{mo(!0);try{console.log("🔄 Google 로그인 시작..."),console.log("Auth 상태:",vi),console.log("Google Provider 설정:",Hs);const R=window.open("","_blank","width=1,height=1");if(!R||R.closed||typeof R.closed>"u")throw new Error("팝업이 차단되었습니다. 브라우저 설정에서 팝업을 허용해주세요.");R.close(),console.log("🔄 signInWithPopup 호출 중...");const M=await iF(vi,Hs);console.log("✅ 로그인 성공:",M.user.email),Ka(M.user),Re("✅ Google 로그인 성공!"),setTimeout(async()=>{var F;try{console.log("📥 사용자 데이터 로딩 시작...");const{doc:B,getDoc:H}=await gi(async()=>{const{doc:X,getDoc:j}=await Promise.resolve().then(()=>yi);return{doc:X,getDoc:j}},void 0),Q=B(pe,"users",M.user.uid,"data","todos"),J=await H(Q);if(J.exists()){const X=J.data();r(X.todos||[]),console.log("📥 목표 데이터 로드 완료:",((F=X.todos)==null?void 0:F.length)||0)}else console.log("📝 새 사용자 - 빈 목표 목록으로 시작"),r([]);const Z=B(pe,"users",M.user.uid,"data","settings"),W=await H(Z);if(W.exists()){const X=W.data();X.language&&e(X.language),X.themeMode&&P(X.themeMode),X.isDarkMode!==void 0&&S(X.isDarkMode),X.backgroundTheme&&U(X.backgroundTheme),X.apiKey&&ps(X.apiKey)}Re("✅ 로그인 완료! 데이터 로드됨")}catch(B){console.error("데이터 로드 실패:",B),Re("⚠️ 로그인은 성공했으나 데이터 로드 실패")}mo(!1),setTimeout(()=>Re(""),3e3)},500),setTimeout(()=>Re(""),3e3)}catch(R){console.error("❌ Google 로그인 오류:",R),console.error("오류 코드:",R.code),console.error("오류 메시지:",R.message);let M="로그인 중 오류가 발생했습니다.";switch(R.code){case"auth/popup-closed-by-user":M="로그인이 취소되었습니다.";break;case"auth/popup-blocked":M="팝업이 차단되었습니다. 브라우저 설정에서 팝업을 허용해주세요.";break;case"auth/cancelled-popup-request":M="다른 로그인 요청이 진행 중입니다.";break;case"auth/network-request-failed":M="네트워크 연결을 확인해주세요.";break;case"auth/too-many-requests":M="너무 많은 요청이 발생했습니다. 잠시 후 다시 시도해주세요.";break;case"auth/user-disabled":M="계정이 비활성화되었습니다.";break;case"auth/operation-not-allowed":M="Google 로그인이 활성화되지 않았습니다. 관리자에게 문의하세요.";break;default:M=`로그인 실패: ${R.message}`}R.code!=="auth/popup-closed-by-user"&&le({title:"로그인 실패",message:M,confirmText:"확인",onConfirm:()=>le(null)}),mo(!1)}},[]),fc=(R,M)=>{if(R===null)return;const F=i.map(B=>B.id===R?{...B,collaborators:M}:B);s(F),En&&En.id===R&&fs({...En,collaborators:M}),Re("✅ 폴더 협업자가 업데이트되었습니다"),setTimeout(()=>Re(""),3e3)},yf=z.useCallback(async()=>{Nr(!0);try{if(Y){Re("⏳ 데이터 저장 중...");const R=n.filter(X=>X!=null),{doc:M,setDoc:F,serverTimestamp:B}=await gi(async()=>{const{doc:X,setDoc:j,serverTimestamp:fe}=await Promise.resolve().then(()=>yi);return{doc:X,setDoc:j,serverTimestamp:fe}},void 0),H=R.map(X=>Rt(X)).filter(X=>X!==void 0),Q=M(pe,"users",Y.uid,"data","todos"),J={todos:H,lastSyncTime:B(),totalGoals:H.length,syncedAt:new Date().toISOString()},Z=Rt(J);Z?(await F(Q,Z),console.log("✅ Todos Firestore 저장 완료:",{count:H.length})):console.error("❌ Todos 데이터 정제 실패");const W=M(pe,"users",Y.uid,"data","settings");await F(W,{language:t,themeMode:I,isDarkMode:D,backgroundTheme:V,updatedAt:B()})}await cE(vi),Ka(null),r([]),e("ko"),U("default"),P("system"),S(HI()==="dark"),Ee(null),dn(!1),Fe(!1),Re("✅ 로그아웃 완료"),setTimeout(()=>Re(""),3e3),Nr(!1)}catch(R){console.error("로그아웃 오류:",R),le({title:"로그아웃 실패",message:"로그아웃 중 오류가 발생했습니다.",confirmText:"확인",onConfirm:()=>le(null)}),Nr(!1)}},[Y,n,t,I,D,V]),Dr=z.useCallback(async()=>{if(!Y){le({title:"로그인 필요",message:"먼저 로그인해주세요",confirmText:"확인",onConfirm:()=>le(null)});return}It(!0);try{const R=n.filter(j=>j!=null),{doc:M,setDoc:F,serverTimestamp:B}=await gi(async()=>{const{doc:j,setDoc:fe,serverTimestamp:Te}=await Promise.resolve().then(()=>yi);return{doc:j,setDoc:fe,serverTimestamp:Te}},void 0),H=R.map(j=>Rt(j)).filter(j=>j!==void 0),Q=M(pe,"users",Y.uid,"data","todos"),J={todos:H,lastSyncTime:B(),totalGoals:H.length,syncedAt:new Date().toISOString()},Z=Rt(J);if(Z)await F(Q,Z),console.log("✅ 백업 Todos Firestore 저장 완료:",{count:H.length});else throw new Error("Todos 데이터 정제 실패");const W=M(pe,"users",Y.uid,"data","settings"),X={language:t,themeMode:I,isDarkMode:D,backgroundTheme:V,apiKey:Vn,userCategories:T,updatedAt:B()};await F(W,X);for(const j of i)try{const fe=M(pe,"users",Y.uid,"folders",j.id),Te={...j,ownerId:j.ownerId||Y.uid,collaborators:j.collaborators||[],updatedAt:B()};await F(fe,Te),console.log(`✅ 폴더 ${j.id} 동기화 완료`)}catch(fe){console.error(`❌ 폴더 ${j.id} 동기화 실패:`,fe)}It(!1)}catch(R){console.error("동기화 오류:",R),le({title:"동기화 실패",message:R.message||"데이터 동기화 중 오류가 발생했습니다.",confirmText:"확인",onConfirm:()=>le(null)}),It(!1)}},[Y,n,t,I,D,V,Vn]),go=z.useCallback(async R=>{var M;try{const{doc:F,getDoc:B,collection:H,getDocs:Q}=await gi(async()=>{const{doc:j,getDoc:fe,collection:Te,getDocs:me}=await Promise.resolve().then(()=>yi);return{doc:j,getDoc:fe,collection:Te,getDocs:me}},void 0),J=F(pe,"users",R.uid,"data","todos"),Z=await B(J);if(Z.exists()){const fe=Z.data().todos||[];r(Te=>{const me=new Set(Te.map(Ze=>Ze.id)),oe=fe.filter(Ze=>!me.has(Ze.id)),Ie=[...Te,...oe];return console.log("🔄 목표 데이터 병합:",{기존:Te.length,로드됨:fe.length,새로추가:oe.length,전체:Ie.length}),Ie})}const W=F(pe,"users",R.uid,"data","settings"),X=await B(W);if(X.exists()){const j=X.data();j.language&&e(j.language),j.themeMode&&P(j.themeMode),j.isDarkMode!==void 0&&S(j.isDarkMode),j.backgroundTheme&&U(j.backgroundTheme),j.apiKey&&ps(j.apiKey),j.userCategories&&A(j.userCategories)}try{const j=H(pe,"users",R.uid,"folders"),fe=await Q(j),Te=[];fe.forEach(me=>{const oe=me.data(),Ie={id:me.id,...oe,collaborators:oe.collaborators||[],ownerId:oe.ownerId||R.uid};Te.push(Ie)}),s(me=>{const oe=new Set(me.map(ct=>ct.id)),Ie=Te.filter(ct=>!oe.has(ct.id)),Ze=[...me,...Ie];return console.log("🔄 폴더 데이터 병합:",{기존:me.length,로드됨:Te.length,새로추가:Ie.length,전체:Ze.length}),Ze}),console.log("✅ 폴더 로드 완료:",{count:Te.length})}catch(j){console.warn("⚠️ 폴더 로드 실패, 빈 배열로 설정:",j)}console.log("✅ 클라우드 데이터 로드 완료:",{todos:Z.exists()&&((M=Z.data().todos)==null?void 0:M.length)||0,folders:"로드됨",settings:X.exists()?"로드됨":"없음"})}catch(F){console.error("❌ 클라우드 데이터 로드 실패:",F)}},[]),el=z.useCallback(async()=>{if(!Y){le({title:"로그인 필요",message:"먼저 로그인해주세요",confirmText:"확인",onConfirm:()=>le(null)});return}Ya(!0);try{await go(Y),Re("✅ 클라우드 데이터 로드 완료!")}catch(R){console.error("로드 오류:",R),le({title:"로드 실패",message:R.message||"데이터 로드 중 오류가 발생했습니다.",confirmText:"확인",onConfirm:()=>le(null)})}finally{Ya(!1)}},[Y,go]),se=z.useCallback(R=>x6[t][R]||R,[t]),Ln=z.useCallback(R=>{const M=R||Vn;if(yt||!M)return null;try{return new m2({apiKey:M})}catch(F){return console.error("Failed to create AI instance:",F),null}},[Vn,yt]),tl=z.useCallback(R=>{P(R)},[]),nl=z.useMemo(()=>[se("empty_encouragement_1"),se("empty_encouragement_2"),se("empty_encouragement_3"),se("empty_encouragement_4")],[se]),pc=z.useMemo(()=>nl[Math.floor(Math.random()*nl.length)],[nl]);z.useEffect(()=>{console.log("🚀 클라우드 기반 앱 시작 - localStorage 사용 안 함")},[]),z.useEffect(()=>{(()=>{s(M=>{const F=M.filter(B=>{if(!B.collaborators||B.collaborators.length===0)return!0;const H=B.collaborators.find(Q=>Q.role==="owner");return!H||!H.userId||H.userId.startsWith("owner_")?(console.warn("🗑️ 잘못된 공유 폴더 제거:",B.name,H==null?void 0:H.userId),!1):!0});return F.length!==M.length&&console.log("✅ 잘못된 공유 폴더 정리 완료:",{제거됨:M.length-F.length,남은폴더:F.length}),F})})()},[]),z.useEffect(()=>{if(_s)return;const R=async()=>{const M=new URLSearchParams(window.location.search),F=M.get("data"),B=M.get("folder_share");if(B){try{const H=jI(B),Q=JSON.parse(H);if(Q.type==="folder_share"&&Q.folderId){if(Q.password){const Z=sessionStorage.getItem(`folder_${Q.folderId}_password`);if(!Z||Z!==Q.password){le({title:"암호 입력",message:"이 폴더는 암호로 보호되어 있습니다. 암호를 입력하세요.",confirmText:"확인",cancelText:"취소",onConfirm:()=>{const W=prompt("폴더 암호를 입력하세요:");W===Q.password?(sessionStorage.setItem(`folder_${Q.folderId}_password`,W),le(null),R()):W!==null&&le({title:"암호 오류",message:"암호가 일치하지 않습니다.",confirmText:"확인",onConfirm:()=>{window.history.replaceState({},document.title,window.location.pathname)}})},onCancel:()=>{window.history.replaceState({},document.title,window.location.pathname)}});return}}if(i.some(Z=>Z.id===Q.folderId))window.history.replaceState({},document.title,window.location.pathname);else{if(Q.ownerId&&!Y&&!_s){le({title:"로그인 필요",message:"이 공유 폴더는 소유자 기반 동기화를 위해 로그인이 필요합니다. 계속하려면 로그인하세요.",confirmText:"로그인",cancelText:"취소",onConfirm:async()=>{try{await Za()}catch(j){console.error("로그인 중 오류:",j)}},onCancel:()=>{window.history.replaceState({},document.title,window.location.pathname)}});return}const Z=Q.ownerId||null;if(!Z){console.error("❌ 공유 링크에 소유자 정보가 없습니다:",Q),le({title:"❌ 공유 링크 오류",message:`공유 링크에 소유자 정보가 없습니다.
폴더 소유자에게 다시 공유 링크를 요청해주세요.`,confirmText:"확인",onConfirm:()=>{le(null),window.history.replaceState({},document.title,window.location.pathname)}});return}const W={id:Q.folderId,name:Q.folderName,color:Q.folderColor||"#007AFF",ownerId:Z,collaborators:[{userId:Z,email:Q.sharedBy||"",role:"owner",addedAt:Q.sharedAt}],createdAt:Q.sharedAt,updatedAt:Q.sharedAt,isShared:!0};let X=W;if(Z&&Y)try{console.log("🔍 협업자 추가 시작:",{ownerUserId:Z,googleUserUid:Y.uid});const j=dt(pe,"users",Z,"folders"),fe=Oe(j,Q.folderId),Te=await eg(fe);if(console.log("📄 폴더 조회 결과:",{exists:Te.exists()}),Te.exists()){let me=Te.data().collaborators||[];console.log("👥 현재 협업자 목록:",me);const oe=me.some(Ie=>Ie.userId===Y.uid);if(console.log("🔎 협업자 여부:",{isCollaborator:oe}),oe)console.log("ℹ️ 이미 협업자임");else{const Ie={userId:Y.uid,email:Y.email||"",role:"editor",addedAt:new Date().toISOString()};me=[...me,Ie],console.log("📝 새로운 협업자 목록:",me);const Ze=Rt(me);Ze?(await vt(fe,{collaborators:Ze,updatedAt:new Date().toISOString()},{merge:!0}),console.log("✅ 협업자 Firestore 저장 완료:",Ie)):console.warn("⚠️ 협업자 정제 후 데이터가 없음")}X={...W,collaborators:me}}else console.warn("⚠️ 폴더가 존재하지 않음:",Q.folderId)}catch(j){console.error("❌ 협업자 목록 조회/추가 실패:",j)}else console.warn("⚠️ 협업자 추가 조건 미충족:",{ownerUserId:Z,hasGoogleUser:!!Y});if(s([...i,X]),Y)try{const{doc:j,setDoc:fe}=await gi(async()=>{const{doc:me,setDoc:oe}=await Promise.resolve().then(()=>yi);return{doc:me,setDoc:oe}},void 0),Te=j(pe,"users",Y.uid,"folders",X.id);await fe(Te,{name:X.name,color:X.color,ownerId:X.ownerId,createdAt:X.createdAt,updatedAt:X.updatedAt,isShared:X.isShared,collaborators:X.collaborators||[],collaborationSettings:X.collaborationSettings||{enabled:!0,showPresence:!0,showEditingState:!0,enableConflictDetection:!0,allowGuestView:!1,requireApproval:!1}}),console.log("✅ 공유 폴더 Firebase 저장 완료:",X.id)}catch(j){console.error("❌ 공유 폴더 Firebase 저장 실패:",j)}a(X.id),le({title:"공유 폴더 추가됨",message:`"${Q.folderName}" 폴더가 추가되었습니다. 잠시 후 목표들이 로드됩니다.`,confirmText:"확인",onConfirm:()=>{window.history.replaceState({},document.title,window.location.pathname)}})}}}catch(H){console.error("폴더 공유 데이터 파싱 실패:",H),window.history.replaceState({},document.title,window.location.pathname)}return}if(F)try{const H=jI(F),Q=JSON.parse(H);if(Array.isArray(Q)&&(Q.length===0||"wish"in Q[0]&&"id"in Q[0]))le({title:se("url_import_title"),message:se("url_import_message"),confirmText:se("url_import_confirm"),cancelText:se("cancel_button"),onConfirm:()=>{r(Q),Re(se("url_import_success")),window.history.replaceState({},document.title,window.location.pathname)},onCancel:()=>{window.history.replaceState({},document.title,window.location.pathname)}});else throw new Error("Invalid data format")}catch(H){console.error("Failed to parse data from URL",H),le({title:se("import_error_alert_title"),message:se("url_import_error")}),window.history.replaceState({},document.title,window.location.pathname)}};R()},[se,i,Y,Za,_s]),z.useEffect(()=>{if(!o||!Y)return;const R=i.find(W=>W.id===o);if(!R||!R.collaborators||R.collaborators.length===0)return;const M=R.collaborators.find(W=>W.role==="owner");if(!M)return;const F=M.userId;if(!F||F.startsWith("owner_")){console.warn("⚠️ Invalid owner UID:",M);return}const B=[],H=Oe(pe,"users",F,"folders",o),Q=Mr(H,W=>{if(W.exists()){const X=W.data();X.collaborators&&s(j=>j.map(fe=>fe.id===o?{...fe,collaborators:X.collaborators}:fe))}},W=>{console.warn("⚠️ 공유 폴더 메타데이터 접근 오류 (협업자 목록 업데이트 안 됨):",W.code)});B.push(Q);const J=dt(pe,"users",F,"todos");console.log("📊 Syncing todos from owner:",{ownerUid:F,currentFolderId:o});const Z=Mr(J,W=>{const X=[];W.forEach(j=>{const fe=j.data();fe.folderId===o&&X.push({id:parseInt(j.id),...fe})}),console.log("🎯 Owner todos received:",{count:X.length,ownerTodos:X}),r(j=>{const fe=j.filter(Ie=>Ie.folderId!==o),Te=j.filter(Ie=>Ie.folderId===o),me=[],oe=new Set;return X.forEach(Ie=>{me.push(Ie),oe.add(Ie.id)}),Te.forEach(Ie=>{oe.has(Ie.id)||me.push(Ie)}),[...fe,...me]})},W=>{console.error("❌ 실시간 동기화 실패:",W),W.code==="permission-denied"?(console.warn("⚠️ 권한 부족으로 실시간 동기화 실패 - 수동 동기화를 사용하세요"),Re("⚠️ 실시간 동기화 실패 - 🔄 버튼으로 수동 동기화하세요")):W.code==="not-found"?(console.warn("⚠️ 폴더를 찾을 수 없음 - 폴더가 삭제되었을 수 있습니다"),Re("⚠️ 공유 폴더를 찾을 수 없습니다")):(console.warn("⚠️ 네트워크 오류로 실시간 동기화 실패"),Re("⚠️ 네트워크 오류 - 🔄 버튼으로 재시도하세요"))});return B.push(Z),()=>{B.forEach(W=>W())}},[o,Y]),z.useEffect(()=>{var W,X;if(!o||!Y)return;const R=i.find(j=>j.id===o),M=((W=R==null?void 0:R.collaborationSettings)==null?void 0:W.enabled)||(R==null?void 0:R.isShared)||!1,F=((X=R==null?void 0:R.collaborationSettings)==null?void 0:X.showPresence)??!0;if(!M||!F){E([]);return}console.log("👥 실시간 접속 상태 추적 시작:",{folderId:o,showPresence:F});const B=dt(pe,"folderPresence",o,"users"),H=Oe(B,Y.uid);(async()=>{try{await vt(H,{userId:Y.uid,displayName:Y.displayName||"Anonymous",photoURL:Y.photoURL||null,isOnline:!0,lastSeen:new Date,currentFolder:o},{merge:!0}),console.log("✅ 내 접속 상태 등록:",Y.displayName)}catch(j){console.warn("presence set failed",j)}})();const J=setInterval(()=>{vt(H,{lastSeen:new Date,isOnline:!0},{merge:!0}).catch(()=>{})},3e4),Z=Mr(B,j=>{const Te=j.docs.map(me=>{const oe=me.data();return{userId:oe.userId||me.id,displayName:oe.displayName||"Anonymous",photoURL:oe.photoURL||void 0,isOnline:!!oe.isOnline,lastSeen:oe.lastSeen?oe.lastSeen.toDate?oe.lastSeen.toDate():new Date(oe.lastSeen):new Date,currentFolder:oe.currentFolder}}).filter(me=>!!me.userId&&me.isOnline);E(Te),console.log("👥 활성 사용자 업데이트:",Te.map(me=>me.displayName))},j=>console.warn("presence listen failed",j));return()=>{clearInterval(J),vt(H,{isOnline:!1,lastSeen:new Date},{merge:!0}).catch(()=>{}),Z()}},[o,Y,i]),z.useCallback(async R=>{var H,Q;if(!o||!Y)return;const M=i.find(J=>J.id===o),F=((H=M==null?void 0:M.collaborationSettings)==null?void 0:H.showEditingState)??!0;if(!(!((Q=M==null?void 0:M.collaborationSettings)!=null&&Q.enabled||M!=null&&M.isShared)||!F))try{const J=Oe(pe,"folderEditing",`${o}_${R}`);await vt(J,{todoId:R,userId:Y.uid,userName:Y.displayName||"Anonymous",startTime:new Date,folderId:o}),console.log("✏️ 편집 시작:",{todoId:R,user:Y.displayName})}catch(J){console.warn("start editing failed",J)}},[o,Y,i]),z.useCallback(async R=>{var H,Q;if(!o||!Y)return;const M=i.find(J=>J.id===o),F=((H=M==null?void 0:M.collaborationSettings)==null?void 0:H.showEditingState)??!0;if(!(!((Q=M==null?void 0:M.collaborationSettings)!=null&&Q.enabled||M!=null&&M.isShared)||!F))try{const J=Oe(pe,"folderEditing",`${o}_${R}`);await Bt(J),console.log("✅ 편집 종료:",{todoId:R,user:Y.displayName})}catch(J){console.warn("stop editing failed",J)}},[o,Y,i]),z.useEffect(()=>{var Q,J;if(!o)return;const R=i.find(Z=>Z.id===o),M=((Q=R==null?void 0:R.collaborationSettings)==null?void 0:Q.showEditingState)??!0;if(!(((J=R==null?void 0:R.collaborationSettings)==null?void 0:J.enabled)||(R==null?void 0:R.isShared)||!1)||!M){C({});return}console.log("✏️ 편집 상태 추적 시작:",{folderId:o});const B=bl(dt(pe,"folderEditing"),Ml("folderId","==",o)),H=Mr(B,Z=>{const W={};Z.docs.forEach(X=>{const j=X.data();j&&j.todoId&&(W[j.todoId]={todoId:j.todoId,userId:j.userId,userName:j.userName,startTime:j.startTime?j.startTime.toDate?j.startTime.toDate():new Date(j.startTime):new Date,folderId:j.folderId})}),C(W),console.log("✏️ 편집 상태 업데이트:",Object.keys(W).length+"개 항목")},Z=>console.warn("editing states listen failed",Z));return()=>H()},[o,i]),z.useCallback(async R=>{var M,F;try{const B=R.ownerId||(Y==null?void 0:Y.uid);if(!B)throw new Error("No owner UID");const H=i.find(X=>X.id===o),Q=((M=H==null?void 0:H.collaborationSettings)==null?void 0:M.enableConflictDetection)??!0,J=((F=H==null?void 0:H.collaborationSettings)==null?void 0:F.enabled)||(H==null?void 0:H.isShared)||!1,Z=Oe(pe,"users",B,"todos",R.id.toString());if(J&&Q){const X=await eg(Z),j=X.exists()?X.data():null,fe=(j==null?void 0:j.version)||0,Te=R.version||0;if(j&&fe>Te&&(b(oe=>[...oe,{todoId:R.id,conflictType:"version_mismatch",localVersion:R,serverVersion:j,lastModifiedBy:j.lastModifiedBy||"unknown",lastModifiedAt:j.lastModified?j.lastModified.toDate?j.lastModified.toDate():new Date(j.lastModified):new Date}]),console.warn("⚠️ 충돌 감지:",{todoId:R.id,localVersion:Te,serverVersion:fe,lastModifiedBy:j.lastModifiedBy}),!window.confirm("다른 사용자가 이 항목을 수정했습니다. 덮어쓰시겠습니까? (취소하면 변경이 중단됩니다)")))return!1}const W=Rt({...R,version:(R.version||0)+1,lastModified:new Date,lastModifiedBy:(Y==null?void 0:Y.uid)||"unknown"});return W&&(await vt(Z,W),console.log("✅ Todo 저장 완료:",{todoId:R.id,version:W.version})),!0}catch(B){return console.error("attemptSaveTodo failed",B),!1}},[Y,o,i]),z.useEffect(()=>{const R=window.matchMedia("(prefers-color-scheme: dark)"),M=F=>{I==="system"&&S(F.matches)};return S(I==="system"?R.matches:I==="dark"),R.addEventListener("change",M),()=>R.removeEventListener("change",M)},[I]),z.useEffect(()=>{const R=()=>{console.log("🌐 인터넷 연결됨"),Re("✅ 인터넷에 다시 연결되었습니다"),setTimeout(()=>Re(""),3e3)},M=()=>{console.log("📡 인터넷 연결 끊김"),Re("⚠️ 오프라인 모드 - 클라우드 동기화 불가"),setTimeout(()=>Re(""),5e3)};return navigator.onLine||console.log("📡 현재 오프라인 상태"),window.addEventListener("online",R),window.addEventListener("offline",M),()=>{window.removeEventListener("online",R),window.removeEventListener("offline",M)}},[]),z.useEffect(()=>{const R=localStorage.getItem("pwa-prompt-dismissed"),M=zI(),F=$I();console.log("PWA Check:",{isMobileDevice:M,isInStandalone:F,isDismissed:R,userAgent:navigator.userAgent}),M&&!F&&!R&&(console.log("Showing PWA prompt immediately"),Wa(!0))},[]),z.useEffect(()=>{"serviceWorker"in navigator&&navigator.serviceWorker.register("/Nova-AI-Planer/sw.js").then(R=>{console.log("SW registered: ",R);const M=$I(),F=zI();M&&F&&setTimeout(()=>{Zx().then(B=>{B&&eR()})},2e3)}).catch(R=>{console.log("SW registration failed: ",R)})},[]),z.useEffect(()=>{},[I,D]);const si=z.useRef(null);z.useEffect(()=>{if(!(!hr||!Y))return si.current&&clearTimeout(si.current),si.current=setTimeout(()=>{Dr()},5e3),()=>{si.current&&clearTimeout(si.current)}},[n,i,t,I,D,V,Vn,T,hr,Y]),z.useEffect(()=>{const R=ng.find(F=>F.id===V)||ng[0],M=D?R.darkThemeClass:R.lightThemeClass;document.body.className="",D&&document.body.classList.add("dark-mode"),M&&document.body.classList.add(M)},[V,D]),z.useEffect(()=>{if(fo){const R=setTimeout(()=>Re(""),3e3);return()=>clearTimeout(R)}},[fo]);const _o=z.useMemo(()=>{let R=[...n];if(o===null)R=R.filter(M=>{if(M.isSharedTodo===!0)return!1;const F=i.find(B=>B.id===M.folderId);return F?F.isShared!==!0:!0});else if(o!=="all"){const M=i.find(F=>F.id===o);M&&M.isShared?R=R.filter(F=>F.folderId===o):R=R.filter(F=>F.folderId===o)}return g==="deadline"?R.sort((M,F)=>!M.deadline&&!F.deadline?0:M.deadline?F.deadline?new Date(M.deadline).getTime()-new Date(F.deadline).getTime():-1:1):g==="newest"?R.sort((M,F)=>F.id-M.id):g==="alphabetical"&&R.sort((M,F)=>M.wish.localeCompare(F.wish)),l==="active"&&(R=R.filter(M=>!M.completed)),l==="completed"&&(R=R.filter(M=>M.completed)),f!=="all"&&(R=R.filter(M=>(M.category||"other")===f)),R},[n,l,g,f,o]),rl=async R=>{const M={...R,id:Date.now(),completed:!1,lastCompletedDate:null,streak:0,folderId:o==="all"||o===null?void 0:o};if(Y)try{const F=i.find(Z=>Z.id===o),B=(F==null?void 0:F.ownerId)||Y.uid,H=dt(pe,"users",B,"todos"),Q=Oe(H,M.id.toString()),J=Rt(M);J?(await vt(Q,J),console.log("✅ 목표 Firestore 저장:",{targetOwnerUid:B,newTodo:J})):console.warn("⚠️ 정제 후 저장할 데이터가 없음")}catch(F){console.error("❌ 목표 Firestore 저장 실패:",F)}r(F=>[M,...F]),Fe(!1)},il=async R=>{const M=R.map((F,B)=>({...F,id:Date.now()+B,completed:!1,lastCompletedDate:null,streak:0,folderId:o||void 0})).reverse();if(Y)try{const F=i.find(H=>H.id===o),B=(F==null?void 0:F.ownerId)||Y.uid;for(const H of M){const Q=dt(pe,"users",B,"todos"),J=Oe(Q,H.id.toString()),Z=Rt(H);Z?await vt(J,Z):console.warn("⚠️ 정제 후 저장할 데이터가 없음:",H.id)}console.log("✅ 여러 목표 Firestore 저장:",{targetOwnerUid:B,count:M.length})}catch(F){console.error("❌ 여러 목표 Firestore 저장 실패:",F)}r(F=>[...M,...F]),Fe(!1)},sl=async R=>{if(Y)try{const M=i.find(J=>J.id===R.folderId),F=(M==null?void 0:M.ownerId)||Y.uid,B=dt(pe,"users",F,"todos"),H=Oe(B,R.id.toString()),Q=Rt(R);Q?(await vt(H,Q),console.log("✅ 목표 업데이트 Firestore 저장:",{targetOwnerUid:F,updatedTodo:Q})):console.warn("⚠️ 정제 후 저장할 데이터가 없음")}catch(M){console.error("❌ 목표 업데이트 Firestore 저장 실패:",M)}r(n.map(M=>M.id===R.id?R:M)),Ee(null)},mc=async R=>{const M=n.find(B=>B.id===R),F=n.filter(B=>B.id!==R);if(r(F),Y&&M)try{const B=i.find(Z=>Z.id===M.folderId),H=(B==null?void 0:B.ownerId)||Y.uid,Q=dt(pe,"users",H,"todos"),J=Oe(Q,R.toString());await Bt(J),console.log("✅ 개별 목표 Firestore 삭제:",{targetOwnerUid:H,id:R});try{const Z=Oe(pe,"users",H,"data","todos");await vt(Z,{todos:F,lastUpdated:new Date().toISOString()},{merge:!0}),console.log("✅ 백업 데이터 업데이트 완료 - 삭제 반영")}catch(Z){console.warn("⚠️ 백업 데이터 업데이트 실패:",Z)}hr&&setTimeout(()=>{Dr()},1e3)}catch(B){console.error("❌ 목표 Firestore 삭제 실패:",B),M&&r(H=>[...H,M])}},gc=async R=>{var F;if(!R.trim()){le({title:"Error",message:"Folder name cannot be empty."});return}const M={id:Date.now().toString(),name:R,ownerId:((F=vi.currentUser)==null?void 0:F.uid)||"unknown",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),color:"#3b82f6",collaborationSettings:{enabled:!1,showPresence:!0,showEditingState:!0,enableConflictDetection:!0,allowGuestView:!1,requireApproval:!0},isShared:!1};if(s([...i,M]),Y)try{const{doc:B,setDoc:H}=await gi(async()=>{const{doc:J,setDoc:Z}=await Promise.resolve().then(()=>yi);return{doc:J,setDoc:Z}},void 0),Q=B(pe,"users",Y.uid,"folders",M.id);await H(Q,{name:M.name,color:M.color,ownerId:M.ownerId,createdAt:M.createdAt,updatedAt:M.updatedAt,isShared:M.isShared,collaborators:[],collaborationSettings:M.collaborationSettings}),console.log("✅ 폴더 Firebase 저장 완료:",M.id)}catch(B){console.error("❌ 폴더 Firebase 저장 실패:",B)}return console.log("📁 새 폴더 생성:",{name:R,collaborationEnabled:!1}),M},ol=z.useCallback(async(R,M)=>{try{if(s(F=>F.map(B=>{if(B.id===R){const H={...B.collaborationSettings,...M};return console.log("⚙️ 공동작업 설정 업데이트:",{folderId:R,settings:H}),{...B,collaborationSettings:H,updatedAt:new Date().toISOString()}}return B})),Y){const F=Oe(pe,"users",Y.uid,"folders",R);await tg(F,{collaborationSettings:{...M},updatedAt:new Date().toISOString()})}}catch(F){console.error("공동작업 설정 업데이트 실패:",F)}},[Y]),fr=z.useCallback(async(R,M)=>{await ol(R,{enabled:M}),M?(s(F=>F.map(B=>B.id===R?{...B,isShared:!0}:B)),console.log("🤝 폴더 공동작업 활성화:",R)):(E([]),C({}),console.log("🔒 폴더 공동작업 비활성화:",R))},[ol]);z.useCallback(()=>{if(!o)return null;const R=i.find(M=>M.id===o);return(R==null?void 0:R.collaborationSettings)||null},[o,i]);const Fn=(R,M)=>{if(!M.trim()){le({title:"Error",message:"Folder name cannot be empty."});return}s(i.map(F=>F.id===R?{...F,name:M,updatedAt:new Date().toISOString()}:F))},oi=async R=>{const M=i.find(B=>B.id===R);if(!M)return;const F=n.filter(B=>B.folderId===R);if(Y&&F.length>0)try{for(const B of F){const H={...B};delete H.folderId;const Q=M.ownerId||Y.uid,J=dt(pe,"users",Q,"todos"),Z=Oe(J,B.id.toString()),W=Rt(H);W&&await vt(Z,W)}}catch(B){console.error("❌ 폴더 삭제 시 목표 이동 실패:",B)}if(Y)try{const B=Oe(pe,"users",Y.uid,"folders",R);await Bt(B)}catch(B){console.error("❌ 폴더 Firebase 삭제 실패:",B)}r(B=>B.map(H=>{if(H.folderId===R){const Q={...H};return delete Q.folderId,Q}return H})),s(B=>B.filter(H=>H.id!==R)),o===R&&a(null)},ai=async R=>{if(!Pe.trim()||!Y){$e("");return}try{const M={...R,name:Pe.trim(),updatedAt:new Date().toISOString()},F=Oe(pe,"users",Y.uid,"folders",R.id),B=Rt(M);if(B)await vt(F,B),console.log("✅ 폴더 이름 변경 Firestore 저장 완료");else throw new Error("폴더 데이터 정제 실패");s(i.map(H=>H.id===R.id?M:H)),$e(""),console.log("✅ 폴더 이름 변경 완료:",Pe.trim())}catch(M){console.error("❌ 폴더 이름 변경 실패:",M),$e("")}},al=async R=>{var M;if(!(!Ke.trim()||!Y||tn)){Tn(!0);try{if(((M=R.sharedWith)==null?void 0:M.some(Z=>Z.email===Ke.trim()))||R.ownerEmail===Ke.trim()){alert("이미 초대된 사용자입니다."),Tn(!1);return}const B={email:Ke.trim(),userId:"",role:lt,addedAt:new Date().toISOString()},H={...R,sharedWith:[...R.sharedWith||[],B],updatedAt:new Date().toISOString()},Q=Oe(pe,"users",Y.uid,"folders",R.id),J=Rt(H);if(J)await vt(Q,J),console.log("✅ 협업자 초대 Firestore 저장 완료");else throw new Error("폴더 데이터 정제 실패");s(i.map(Z=>Z.id===R.id?{...H,sharedWith:Array.isArray(H.sharedWith)?H.sharedWith.filter(W=>W&&typeof W.role=="string"&&["owner","editor","viewer"].includes(W.role)).map(W=>({...W,role:W.role})):[]}:Z)),Mt(""),console.log("✅ 협업자 초대 완료:",B)}catch(F){console.error("❌ 협업자 초대 실패:",F)}finally{Tn(!1)}}},Ye=async(R,M,F)=>{var B;if(Y)try{const H={...R,sharedWith:(B=R.sharedWith)==null?void 0:B.map(Z=>Z.userId===M?{...Z,role:F}:Z),updatedAt:new Date().toISOString()},Q=Oe(pe,"users",Y.uid,"folders",R.id),J=Rt(H);if(J)await vt(Q,J);else throw new Error("폴더 데이터 정제 실패");s(i.map(Z=>Z.id===R.id?{...H,sharedWith:Array.isArray(H.sharedWith)?H.sharedWith.filter(W=>W&&typeof W.role=="string"&&["owner","editor","viewer"].includes(W.role)).map(W=>({...W,role:W.role})):[]}:Z)),console.log("✅ 협업자 역할 변경 완료:",{userId:M,newRole:F})}catch(H){console.error("❌ 협업자 역할 변경 실패:",H)}},yo=async(R,M)=>{var F;if(Y&&confirm("이 협업자를 제거하시겠습니까?"))try{const B={...R,sharedWith:(F=R.sharedWith)==null?void 0:F.filter(J=>J.userId!==M),updatedAt:new Date().toISOString()},H=Oe(pe,"users",Y.uid,"folders",R.id),Q=Rt(B);if(Q)await vt(H,Q);else throw new Error("폴더 데이터 정제 실패");s(i.map(J=>J.id===R.id?B:J)),console.log("✅ 협업자 제거 완료:",M)}catch(B){console.error("❌ 협업자 제거 실패:",B)}},ys=R=>{const M=`${window.location.origin}${window.location.pathname}?invite=${R.id}`;navigator.clipboard.writeText(M).then(()=>{alert("공유 링크가 복사되었습니다!")}).catch(()=>{alert("링크 복사에 실패했습니다.")})},vs=R=>{confirm(se("folder_leave_confirm"))&&vf(R)},vf=async R=>{var M;if(Y)try{const F={...R,sharedWith:(M=R.sharedWith)==null?void 0:M.filter(Q=>Q.userId!==Y.uid),updatedAt:new Date().toISOString()},B=Oe(pe,"users",R.ownerId,"folders",R.id),H=Rt(F);if(H)await vt(B,H);else throw new Error("폴더 데이터 정제 실패");s(i.filter(Q=>Q.id!==R.id)),o===R.id&&a(null),ce(!1),console.log("✅ 폴더 나가기 완료")}catch(F){console.error("❌ 폴더 나가기 실패:",F)}},_c=R=>{confirm(se("folder_delete_confirm"))&&(oi(R.id),ce(!1))},Tf=R=>{if(a(R),R&&Y){const M=i.find(F=>F.id===R);M!=null&&M.ownerId&&(async()=>{try{console.log("📥 Firestore에서 폴더 목표 로드:",{folderId:R,ownerUid:M.ownerId});const F=dt(pe,"users",M.ownerId,"todos"),B=bl(F,Ml("folderId","==",R)),H=await _i(B),Q=[];H.forEach(J=>{Q.push({id:parseInt(J.id),...J.data()})}),console.log("✅ 폴더 목표 로드 완료:",{count:Q.length,todos:Q}),r(J=>{const Z=J.filter(fe=>fe.folderId!==R),W=new Set(Z.map(fe=>fe.id)),X=Q.filter(fe=>!W.has(fe.id)),j=[...Z,...X];return console.log("🔄 목표 병합 완료:",{기존목표:Z.length,새로운목표:X.length,전체목표:j.length,중복제거됨:Q.length-X.length}),j})}catch(F){console.error("❌ 폴더 목표 로드 실패:",F)}})()}},Ef=async()=>{if(!o||!Y){Re("❌ 동기화할 폴더가 없습니다");return}It(!0);try{console.log("🔄 폴더 정보 재로딩 중...",o);const{doc:R,getDoc:M,collection:F,query:B,where:H,getDocs:Q}=await gi(async()=>{const{doc:oe,getDoc:Ie,collection:Ze,query:ct,where:Es,getDocs:Un}=await Promise.resolve().then(()=>yi);return{doc:oe,getDoc:Ie,collection:Ze,query:ct,where:Es,getDocs:Un}},void 0);let J=i.find(oe=>oe.id===o);if(!J||!J.collaborators||J.collaborators.length===0){console.log("⚠️ 로컬 폴더 정보가 불완전함, Firebase에서 재로딩...");const oe=R(pe,"users",Y.uid,"folders",o),Ie=await M(oe);if(Ie.exists())J={id:o,...Ie.data()},console.log("✅ 사용자 폴더에서 로드됨:",J);else{console.log("🔍 공유된 폴더 검색 중..."),le({title:"📡 폴더 정보 로딩 중",message:`폴더 정보를 불러오는 중입니다.
잠시 후 다시 시도하거나 새로고침해주세요.`,confirmText:"확인",onConfirm:()=>le(null)}),It(!1);return}}if(!J||!J.collaborators||J.collaborators.length===0){le({title:"❌ 협업 폴더 아님",message:`이것은 공유 폴더가 아닙니다.
개인 폴더는 개별적으로 동기화됩니다.`,confirmText:"확인",onConfirm:()=>le(null)}),It(!1);return}const Z=J.collaborators.find(oe=>oe.role==="owner");if(!Z||!Z.userId){le({title:"❌ 소유자 정보 오류",message:`폴더 소유자 정보가 없습니다.
폴더를 다시 공유받아주세요.`,confirmText:"확인",onConfirm:()=>le(null)}),It(!1);return}if(Z.userId.startsWith("owner_")){console.warn("⚠️ 임시 소유자 ID 발견:",Z.userId),le({title:"⚠️ 소유자 정보 오류",message:`폴더 소유자 정보에 문제가 있습니다.
폴더 소유자에게 새로운 공유 링크를 요청해주세요.`,confirmText:"확인",onConfirm:()=>le(null)}),It(!1);return}console.log("🔄 수동 동기화 시작:",{folderId:o,ownerUid:Z.userId});const W=n.filter(oe=>oe.folderId===o);console.log("📊 현재 로컬 목표 수:",W.length);const X=F(pe,"users",Z.userId,"todos"),j=B(X,H("folderId","==",o)),fe=await Q(j),Te=[];fe.forEach(oe=>{Te.push({id:parseInt(oe.id),...oe.data()})}),console.log("📊 서버 목표 수:",Te.length),W.length===Te.length?(console.log("✅ 실시간 동기화가 정상 작동 중입니다"),Re(`✅ 동기화 확인 완료 (${Te.length}개 항목 - 이미 최신 상태)`)):(console.log("⚠️ 로컬과 서버 데이터 불일치 감지:",{local:W.length,server:Te.length}),r(oe=>[...oe.filter(ct=>ct.folderId!==o),...Te]),Re(`🔄 동기화 완료 (${Te.length}개 항목 - ${Math.abs(Te.length-W.length)}개 차이 수정)`)),console.log("📡 실시간 리스너 상태:",o&&Y?"활성":"비활성")}catch(R){console.error("❌ 동기화 실패:",R),R instanceof Error?R.message.includes("permission-denied")?Re("❌ 동기화 실패: 폴더 접근 권한이 없습니다"):R.message.includes("not-found")?Re("❌ 동기화 실패: 폴더를 찾을 수 없습니다"):Re("❌ 동기화 실패: "+R.message):Re("❌ 동기화 실패: 알 수 없는 오류")}finally{It(!1)}},If=async()=>{It(!0);try{console.log("🔄 수동 동기화 시작..."),await Dr(),Re("✅ 데이터 동기화 완료"),console.log("✅ 수동 동기화 완료")}catch(R){console.error("❌ 수동 동기화 실패:",R),Re("❌ 동기화 실패")}finally{It(!1)}},wf=async(R,M)=>{const F=n.find(J=>J.id===R);if(!F)return;const B=i.find(J=>J.id===M),H=(B==null?void 0:B.isShared)===!0,Q={...F,folderId:M||void 0,isSharedTodo:H};if(Y)try{const J=i.find(fe=>fe.id===(M||F.folderId)),Z=(J==null?void 0:J.ownerId)||Y.uid,W=dt(pe,"users",Z,"todos"),X=Oe(W,R.toString()),j=Rt(Q);j?(await vt(X,j),console.log("✅ 목표 폴더 이동 Firestore 저장:",{targetOwnerUid:Z,goalId:R,folderId:M,isSharedTodo:Q.isSharedTodo})):console.warn("⚠️ 정제 후 저장할 데이터가 없음")}catch(J){console.error("❌ 목표 폴더 이동 Firestore 저장 실패:",J)}r(n.map(J=>J.id===R?Q:J)),Re("✅ 목표가 폴더로 이동되었습니다"),setTimeout(()=>Re(""),3e3)},Ts=async R=>{const M=new Date().toISOString(),F=(()=>{const B=n.find(J=>J.id===R);if(!B)return null;const H=!B.completed;let Q=B.streak;return B.isRecurring&&(H?(!B.lastCompletedDate||!nu(M,B.lastCompletedDate))&&(Q=(B.streak||0)+1):B.lastCompletedDate&&nu(M,B.lastCompletedDate)&&(Q=Math.max(0,(B.streak||1)-1))),{...B,completed:H,lastCompletedDate:H?M:B.lastCompletedDate,streak:Q}})();if(F){if(Y)try{const B=i.find(W=>W.id===F.folderId),H=(B==null?void 0:B.ownerId)||Y.uid,Q=dt(pe,"users",H,"todos"),J=Oe(Q,R.toString()),Z=Rt(F);Z?(await vt(J,Z),console.log("✅ 목표 완료 상태 Firestore 저장:",{targetOwnerUid:H,id:R,completed:F.completed})):console.warn("⚠️ 정제 후 저장할 데이터가 없음")}catch(B){console.error("❌ 목표 완료 상태 Firestore 저장 실패:",B)}r(n.map(B=>B.id===R?F:B))}},br=async R=>{if(R==="ai"){if(n.length<2){le({title:se("sort_alert_title"),message:se("sort_alert_message")});return}Me(!0);try{const M=Ln();if(!M){Re(yt?"오프라인 모드에서는 AI 정렬을 사용할 수 없습니다.":"AI 정렬을 사용하려면 설정에서 API 키를 입력해주세요."),Me(!1),v("manual");return}const F=`Here is a list of goals with their details (wish, outcome, obstacle, plan, deadline). Prioritize them based on urgency (closer deadline), importance (based on outcome), and feasibility (based on plan). Return a JSON object with "sorted_ids" array and "reasoning" string explaining your prioritization logic. Goals: ${JSON.stringify(n.map(({id:j,wish:fe,outcome:Te,obstacle:me,plan:oe,deadline:Ie})=>({id:j,wish:fe,outcome:Te,obstacle:me,plan:oe,deadline:Ie})))}`,B=await M.models.generateContent({model:"gemini-2.5-flash",contents:F,config:{responseMimeType:"application/json",responseSchema:{type:zn.OBJECT,properties:{sorted_ids:{type:zn.ARRAY,items:{type:zn.NUMBER}},reasoning:{type:zn.STRING}}}}}),H=JSON.parse(B.text),Q=H.sorted_ids.map(Number),J=new Map(n.map(j=>[Number(j.id),j])),Z=Q.map(j=>J.get(j)).filter(Boolean),W=n.filter(j=>!Q.includes(Number(j.id))),X=[...Z,...W].map(j=>({...j,id:Number(j.id)}));r(X),v("manual"),ds(H.reasoning||""),hs(!0)}catch(M){console.error("AI sort failed:",M),le({title:se("ai_sort_error_title"),message:se("ai_sort_error_message")})}finally{Me(!1)}}else v(R)},yc=R=>{const M=new Set(ls);M.has(R)?M.delete(R):M.add(R),us(M)},ll=()=>{ii(!1),us(new Set)},vc=()=>{const R=new Set(_o.map(M=>M.id));us(R)},Tc=()=>{const R=ls.size;le({title:se("delete_selected_confirm_title"),message:se("delete_selected_confirm_message").replace("{count}",String(R)),isDestructive:!0,confirmText:se("delete_selected_button_label").replace("{count}",String(R)),cancelText:se("cancel_button"),onConfirm:()=>{r(n.filter(M=>!ls.has(M.id))),ll()}})},Ec=()=>{kr("exporting");const R=JSON.stringify(n,null,2),M="data:application/json;charset=utf-8,"+encodeURIComponent(R),F="nova_goals.json",B=document.createElement("a");B.setAttribute("href",M),B.setAttribute("download",F),B.click(),setTimeout(()=>{kr("idle"),dn(!1)},1500)},li=R=>{var B;const M=(B=R.target.files)==null?void 0:B[0];if(!M)return;const F=new FileReader;F.onload=H=>{var Q;try{const J=(Q=H.target)==null?void 0:Q.result;if(typeof J!="string")throw new Error("File content is not a string");const Z=JSON.parse(J);if(Array.isArray(Z)&&Z.every(W=>"wish"in W&&"id"in W))le({title:se("import_confirm_title"),message:se("import_confirm_message"),confirmText:se("settings_import_data"),cancelText:se("cancel_button"),onConfirm:()=>{kr("importing"),setTimeout(()=>{r(Z),Re(se("import_success_toast")),kr("idle"),dn(!1)},1500)}});else throw new Error("Invalid file format")}catch{le({title:se("import_error_alert_title"),message:se("import_error_alert_message")})}},F.onerror=()=>le({title:se("import_error_alert_title"),message:se("import_error_alert_message")}),F.readAsText(M),R.target.value=""},Sf=()=>{le({title:"⚠️ 모든 데이터 삭제",message:`정말로 모든 데이터를 삭제하시겠습니까?

이 작업은 되돌릴 수 없습니다:

• 모든 목표와 폴더
• Firebase 클라우드 데이터
• 로컬 설정
• 공유 폴더 데이터
• 실시간 협업 정보`,confirmText:"삭제",cancelText:"취소",isDestructive:!0,onConfirm:()=>{le(null),Cf()},onCancel:()=>{le(null)}})},Cf=async()=>{console.log("🗑️ performDeleteAllData 함수 시작"),kr("deleting");try{if(Y){console.log("📧 사용자 정보:",{uid:Y.uid,email:Y.email}),console.log("🗑️ Firebase 데이터 삭제 시작...");try{const W=Oe(pe,"users",Y.uid,"data","todos");await Bt(W),console.log("✅ 백업 todos 데이터 삭제 완료")}catch(W){console.warn("⚠️ 백업 todos 데이터 삭제 실패:",W)}try{const W=Oe(pe,"users",Y.uid,"data","settings");await Bt(W),console.log("✅ 백업 settings 데이터 삭제 완료")}catch(W){console.warn("⚠️ 백업 settings 데이터 삭제 실패:",W)}const R=dt(pe,"users",Y.uid,"todos"),M=await _i(R);console.log("📊 삭제할 todos 개수:",M.size);const F=M.docs.map(W=>Bt(W.ref));await Promise.all(F),console.log("✅ 개별 todos 삭제 완료:",M.size,"개");const B=dt(pe,"users",Y.uid,"folders"),H=await _i(B);console.log("📊 삭제할 folders 개수:",H.size);const Q=H.docs.map(W=>Bt(W.ref));await Promise.all(Q),console.log("✅ folders 삭제 완료:",H.size,"개");const J=dt(pe,"sharedFolders"),Z=await _i(J);for(const W of Z.docs){const X=W.data();if(X.collaborators&&Array.isArray(X.collaborators)){const j=X.collaborators.filter(fe=>fe.userId!==Y.uid);j.length!==X.collaborators.length&&(await tg(W.ref,{collaborators:j}),console.log("✅ 공유 폴더에서 내 계정 제거:",W.id))}}try{for(const W of i)if(W.id){const X=Oe(pe,"folderPresence",W.id,"users",Y.uid);await Bt(X)}console.log("✅ presence 데이터 삭제 완료")}catch(W){console.warn("⚠️ presence 데이터 삭제 중 일부 오류:",W)}try{const W=bl(dt(pe,"folderEditing"),Ml("userId","==",Y.uid)),j=(await _i(W)).docs.map(fe=>Bt(fe.ref));await Promise.all(j),console.log("✅ editing states 삭제 완료")}catch(W){console.warn("⚠️ editing states 삭제 중 일부 오류:",W)}try{const W=Oe(pe,"users",Y.uid);await Bt(W),console.log("✅ 사용자 프로필 문서 삭제 완료")}catch(W){console.warn("⚠️ 사용자 프로필 문서 삭제 실패:",W)}try{const W=dt(pe,"notifications",Y.uid,"items"),j=(await _i(W)).docs.map(Te=>Bt(Te.ref));await Promise.all(j);const fe=Oe(pe,"notifications",Y.uid);await Bt(fe),console.log("✅ 알림 데이터 삭제 완료")}catch(W){console.warn("⚠️ 알림 데이터 삭제 중 일부 오류:",W)}try{const W=dt(pe,"userActivity",Y.uid,"logs"),j=(await _i(W)).docs.map(Te=>Bt(Te.ref));await Promise.all(j);const fe=Oe(pe,"userActivity",Y.uid);await Bt(fe),console.log("✅ 사용자 활동 로그 삭제 완료")}catch(W){console.warn("⚠️ 사용자 활동 로그 삭제 중 일부 오류:",W)}try{const W=Oe(pe,"userMetadata",Y.uid);await Bt(W),console.log("✅ 사용자 메타데이터 삭제 완료")}catch(W){console.warn("⚠️ 사용자 메타데이터 삭제 중 일부 오류:",W)}try{const W=Oe(pe,"userSessions",Y.uid);await Bt(W),console.log("✅ 사용자 세션 데이터 삭제 완료")}catch(W){console.warn("⚠️ 사용자 세션 데이터 삭제 중 일부 오류:",W)}console.log("🔥 모든 클라우드 데이터 삭제 완료 - 사용자 데이터가 완전히 제거되었습니다")}if(console.log("🔄 로컬 상태 초기화 시작..."),r([]),s([]),E([]),C({}),b([]),a(null),us(new Set),ii(!1),u("all"),m("all"),console.log("⚙️ 설정 초기화 시작..."),e("ko"),S(!0),U("default"),v("manual"),A(["school","work","personal","other"]),console.log("💾 localStorage 초기화 시작..."),localStorage.clear(),console.log("✅ localStorage 완전 삭제 완료"),Y){console.log("🚪 Firebase 로그아웃 처리...");try{await cE(vi),console.log("✅ 로그아웃 완료")}catch(R){console.warn("⚠️ 로그아웃 중 오류:",R)}}console.log("✅ 모든 데이터 삭제 완료"),Re("✅ 모든 데이터가 완전히 삭제되었습니다. 로그아웃됩니다."),setTimeout(()=>{console.log("🔄 페이지 새로고침으로 완전 초기화..."),window.location.reload()},1500)}catch(R){console.error("❌ 데이터 삭제 중 오류:",R);let M="❌ 삭제 실패",F="데이터 삭제 중 오류가 발생했습니다.";R instanceof Error&&(R.message.includes("permission-denied")||R.message.includes("insufficient permissions")?(M="❌ 권한 부족",F=`삭제 권한이 부족합니다.

잠시 후 다시 시도해주세요.
(Firebase 보안 규칙이 업데이트 중일 수 있습니다)`):R.message.includes("network-request-failed")?(M="❌ 네트워크 오류",F="인터넷 연결을 확인하고 다시 시도해주세요."):R.message.includes("unauthenticated")?(M="❌ 로그인 필요",F=`로그인이 만료되었습니다.
다시 로그인해주세요.`):F=`데이터 삭제 중 오류가 발생했습니다.

오류 내용: `+R.message),le({title:M,message:F,confirmText:"확인",onConfirm:()=>le(null)})}finally{kr("idle"),dn(!1)}},Af=De||!!We||!!Mn||dr||!!ut||cs||ac;return p.jsxs("div",{className:`main-page-layout ${At?"calendar-view-active":""}`,children:[p.jsxs("div",{className:`page-content ${Af?"modal-open":""}`,children:[p.jsx(N6,{folders:i,currentFolderId:o,onSetCurrentFolder:Tf,onCreateFolder:gc,onRenameFolder:Fn,onDeleteFolder:oi,onSetCollaboratingFolder:fs,todos:n,t:se,onManageFolder:R=>{we(R),ce(!0)},currentUserId:Y==null?void 0:Y.uid}),p.jsxs("div",{className:"container",children:[p.jsx(D6,{t:se,isSelectionMode:Vt,selectedCount:ls.size,totalVisibleCount:_o.length,onCancelSelection:ll,onDeleteSelected:Tc,onSelectAll:vc,isViewModeCalendar:At,onToggleViewMode:()=>qe(!At),isAiSorting:Pr,sortType:g,onSort:br,filter:l,onFilter:u,categoryFilter:f,onCategoryFilter:m,userCategories:T,onAddCategory:R=>A([...T,R]),onRemoveCategory:R=>A(T.filter(M=>M!==R)),onSetSelectionMode:()=>ii(!0),onOpenSettings:()=>dn(!0),onAddGoal:()=>Fe(!0),currentFolderId:o,folders:i,onSyncSharedFolder:Ef,isSyncing:Qa,isSyncingData:Qa,onManualSync:If,activeUsers:O,editingStates:w,onToggleCollaboration:fr,onUpdateCollaborationSettings:ol}),At?p.jsx(q6,{todos:n,t:se,onGoalClick:cr,language:t}):p.jsx(p.Fragment,{children:p.jsx(b6,{todos:_o,onToggleComplete:Ts,onDelete:mc,onEdit:Ee,onInfo:cr,t:se,filter:l,randomEncouragement:pc,isSelectionMode:Vt,selectedTodoIds:ls,onSelectTodo:yc,folders:i,onMoveToFolder:wf})})]})]}),De&&p.jsx(QI,{onClose:()=>Fe(!1),onAddTodo:rl,onAddMultipleTodos:il,t:se,language:t,createAI:Ln,userCategories:T}),We&&p.jsx(QI,{onClose:()=>Ee(null),onEditTodo:sl,existingTodo:We,t:se,language:t,createAI:Ln}),Mn&&p.jsx(F6,{todo:Mn,onClose:()=>cr(null),t:se,createAI:Ln,onOpenCollaboration:R=>{const M=i.find(F=>F.id===R.folderId)||(R.folderId===null||R.folderId===void 0?null:void 0);M!==void 0&&fs(M||null)},userCategories:T,onUpdateGoal:sl}),En!==void 0&&p.jsx(U6,{folder:En,onClose:()=>fs(void 0),t:se,googleUser:Y,onUpdateCollaborators:fc,setAlertConfig:le}),dr&&p.jsx(O6,{onClose:()=>dn(!1),isDarkMode:D,onToggleDarkMode:()=>S(!D),themeMode:I,onThemeChange:tl,backgroundTheme:V,onSetBackgroundTheme:U,onExportData:Ec,onImportData:li,setAlertConfig:le,onDeleteAllData:Sf,dataActionStatus:oc,language:t,onSetLanguage:e,t:se,todos:n,setToastMessage:Re,onOpenVersionInfo:()=>za(!0),onOpenUsageGuide:()=>$a(!0),apiKey:Vn,onSetApiKey:ps,isOfflineMode:yt,onToggleOfflineMode:()=>uc(!yt),googleUser:Y,onGoogleLogin:Za,onGoogleLogout:yf,onSyncDataToFirebase:Dr,onLoadDataFromFirebase:el,isGoogleLoggingIn:cc,isGoogleLoggingOut:Ja,isSyncingData:Qa,isLoadingData:dc,isAutoSyncEnabled:hr,setIsAutoSyncEnabled:ms,onDiagnoseFirebase:hc}),cs&&p.jsx(YI,{onClose:()=>za(!1),t:se}),ac&&p.jsx(B6,{onClose:()=>$a(!1),t:se}),Ha&&p.jsx(ho,{onClose:()=>hs(!1),isClosing:!1,className:"ai-sort-reason-modal",children:p.jsxs("div",{style:{padding:"24px"},children:[p.jsx("h2",{style:{marginBottom:"16px",fontSize:"1.3rem",fontWeight:600},children:se("ai_sort_reason_modal_title")}),p.jsx("div",{style:{marginBottom:"24px",padding:"16px",backgroundColor:"var(--card-bg-color)",borderRadius:"8px",border:"1px solid var(--border-color)",lineHeight:"1.6",color:"var(--text-secondary-color)"},children:lc}),p.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:p.jsx("button",{onClick:()=>hs(!1),className:"primary",children:se("close_button")})})]})}),cs&&p.jsx(YI,{onClose:()=>za(!1),t:se}),ut&&p.jsx(G6,{title:ut.title,message:ut.message,onConfirm:()=>{var R;(R=ut.onConfirm)==null||R.call(ut),le(null)},onCancel:ut.onCancel?()=>{var R;(R=ut.onCancel)==null||R.call(ut),le(null)}:void 0,confirmText:ut.confirmText,cancelText:ut.cancelText,isDestructive:ut.isDestructive,t:se}),fo&&p.jsx("div",{className:"toast-notification",children:fo}),po&&p.jsx(A6,{onClose:()=>Wa(!1)}),ne&&ye&&p.jsx("div",{className:"modal-backdrop",onClick:()=>ce(!1),children:p.jsxs("div",{className:"modal-content large-modal",onClick:R=>R.stopPropagation(),children:[p.jsxs("div",{className:"modal-header",children:[p.jsx("h3",{children:se("folder_manage_title")}),p.jsx("button",{onClick:()=>ce(!1),children:"✕"})]}),p.jsx("div",{className:"modal-body",children:(()=>{var B,H,Q;const R=i.find(J=>J.id===ye);if(!R)return null;const M=R.ownerId===(Y==null?void 0:Y.uid),F=M?"owner":((H=(B=R.sharedWith)==null?void 0:B.find(J=>J.userId===(Y==null?void 0:Y.uid)))==null?void 0:H.role)||"viewer";return p.jsxs("div",{className:"folder-manage-content",children:[p.jsxs("div",{className:"folder-info-section",children:[p.jsx("h4",{children:se("folder_manage_info")}),p.jsxs("div",{className:"folder-info-item",children:[p.jsxs("label",{children:[se("folder_name"),":"]}),Pe?p.jsxs("div",{className:"inline-edit",children:[p.jsx("input",{type:"text",value:Pe,onChange:J=>$e(J.target.value),onKeyPress:J=>{J.key==="Enter"&&ai(R)}}),p.jsx("button",{onClick:()=>ai(R),children:"✓"}),p.jsx("button",{onClick:()=>$e(""),children:"✕"})]}):p.jsxs("div",{className:"folder-name-display",children:[p.jsx("span",{children:R.name}),M&&p.jsx("button",{className:"edit-btn",onClick:()=>$e(R.name),children:"✏️"})]})]}),p.jsxs("div",{className:"folder-info-item",children:[p.jsxs("label",{children:[se("folder_owner"),":"]}),p.jsx("span",{children:R.ownerEmail||R.ownerId})]}),p.jsxs("div",{className:"folder-info-item",children:[p.jsxs("label",{children:[se("role"),":"]}),p.jsx("span",{children:se(F==="owner"?"folder_role_owner":F==="editor"?"folder_role_editor":"folder_role_viewer")})]}),p.jsxs("div",{className:"folder-info-item",children:[p.jsxs("label",{children:[se("created_date"),":"]}),p.jsx("span",{children:new Date(R.createdAt).toLocaleDateString()})]})]}),p.jsxs("div",{className:"collaborators-section",children:[p.jsx("h4",{children:se("folder_manage_collaborators")}),p.jsxs("div",{className:"collaborator-list",children:[p.jsx("div",{className:"collaborator-item owner",children:p.jsxs("div",{className:"collaborator-info",children:[p.jsx("span",{className:"email",children:R.ownerEmail||R.ownerId}),p.jsx("span",{className:"role owner-role",children:se("folder_role_owner")})]})}),((Q=R.sharedWith)==null?void 0:Q.map((J,Z)=>p.jsxs("div",{className:"collaborator-item",children:[p.jsxs("div",{className:"collaborator-info",children:[p.jsx("span",{className:"email",children:J.email||J.userId}),p.jsx("span",{className:`role ${J.role}`,children:J.role==="editor"?se("folder_role_editor"):se("folder_role_viewer")})]}),M&&p.jsxs("div",{className:"collaborator-actions",children:[p.jsxs("select",{value:J.role,onChange:W=>Ye(R,J.userId,W.target.value),children:[p.jsx("option",{value:"editor",children:se("folder_role_editor")}),p.jsx("option",{value:"viewer",children:se("folder_role_viewer")})]}),p.jsx("button",{className:"remove-btn",onClick:()=>yo(R,J.userId),children:"🗑️"})]})]},Z)))||[]]}),(M||F==="editor")&&p.jsxs("div",{className:"invite-section",children:[p.jsx("h5",{children:se("folder_invite_new")}),p.jsxs("div",{className:"invite-form",children:[p.jsx("input",{type:"email",placeholder:se("folder_invite_email"),value:Ke,onChange:J=>Mt(J.target.value)}),p.jsxs("select",{value:lt,onChange:J=>ge(J.target.value),children:[p.jsx("option",{value:"editor",children:se("folder_role_editor")}),p.jsx("option",{value:"viewer",children:se("folder_role_viewer")})]}),p.jsx("button",{onClick:()=>al(R),disabled:!Ke||tn,children:tn?"초대 중...":se("folder_invite_button")})]})]})]}),p.jsxs("div",{className:"folder-settings-section",children:[p.jsx("h4",{children:se("folder_manage_settings")}),p.jsxs("div",{className:"share-link-section",children:[p.jsx("label",{children:se("folder_share_link")}),p.jsx("p",{className:"share-link-desc",children:se("folder_share_link_desc")}),p.jsxs("div",{className:"share-link-input",children:[p.jsx("input",{type:"text",readOnly:!0,value:`${window.location.origin}${window.location.pathname}?invite=${R.id}`}),p.jsx("button",{onClick:()=>ys(R),children:se("folder_copy_link")})]})]}),p.jsxs("div",{className:"folder-actions",children:[!M&&p.jsx("button",{className:"leave-folder-btn",onClick:()=>vs(R),children:se("folder_leave")}),M&&p.jsx("button",{className:"delete-folder-btn",onClick:()=>_c(R),children:se("folder_delete")})]})]})]})})()})]})})]})},N6=({folders:t,currentFolderId:e,onSetCurrentFolder:n,onCreateFolder:r,onRenameFolder:i,onDeleteFolder:s,onSetCollaboratingFolder:o,todos:a,t:l,onManageFolder:u,currentUserId:f})=>{var O;const[m,g]=z.useState(!1),[v,T]=z.useState(""),[A,D]=z.useState(null),[S,I]=z.useState(""),[P,V]=z.useState(null),U=()=>{v.trim()&&(r(v),T(""),g(!1))};return p.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid var(--border-color)",overflowX:"auto",display:"flex",gap:"8px",alignItems:"center",backgroundColor:"var(--card-bg-color)"},children:[p.jsxs("button",{onClick:()=>n(null),style:{padding:"6px 12px",borderRadius:"8px",border:"none",backgroundColor:e===null?"var(--primary-color)":"transparent",color:e===null?"white":"var(--text-color)",cursor:"pointer",fontSize:"0.9rem",fontWeight:500,whiteSpace:"nowrap",transition:"all 0.2s",minWidth:"80px",textAlign:"center"},children:["📁 ",l("all_goals_label")||"All"]}),p.jsx("button",{onClick:()=>n("all"),style:{padding:"6px 12px",borderRadius:"8px",border:"none",backgroundColor:e==="all"?"#ff6b6b":"transparent",color:e==="all"?"white":"var(--text-color)",cursor:"pointer",fontSize:"0.9rem",fontWeight:500,whiteSpace:"nowrap",transition:"all 0.2s",minWidth:"80px",textAlign:"center"},children:"🌐 전체"}),t.length>0&&t.filter(E=>e===null?!E.isShared||E.isShared&&E.ownerId===f:!0).map(E=>{const w=a.filter(C=>C.folderId===E.id).length;return p.jsxs("div",{style:{position:"relative",display:"inline-flex",alignItems:"center",gap:"2px"},children:[p.jsxs("button",{onClick:()=>n(E.id),style:{padding:"6px 12px",borderRadius:"8px",border:"none",backgroundColor:e===E.id?E.color||"var(--primary-color)":`${E.color}20`||"transparent",color:e===E.id?"white":"var(--text-color)",cursor:"pointer",fontSize:"0.9rem",fontWeight:500,whiteSpace:"nowrap",transition:"all 0.2s",position:"relative"},title:E.isShared?"공유 폴더":"개인 폴더",children:[E.isShared?"👥":"📁"," ",E.name," (",w,")"]}),e===E.id&&p.jsxs("div",{style:{display:"flex",gap:"2px"},children:[p.jsx("button",{onClick:()=>o(E),style:{width:"24px",height:"24px",padding:"0",borderRadius:"4px",border:"none",backgroundColor:"var(--primary-color)",color:"white",cursor:"pointer",fontSize:"0.8rem",lineHeight:"1",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s"},title:"폴더 협업",children:"👥"}),p.jsx("button",{onClick:()=>u(E.id),style:{width:"24px",height:"24px",padding:"0",borderRadius:"4px",border:"none",backgroundColor:"var(--button-bg-color)",color:"var(--text-color)",cursor:"pointer",fontSize:"0.8rem",lineHeight:"1",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s"},title:"폴더 관리",children:"⚙️"}),p.jsx("button",{onClick:()=>{D(E.id),I(E.name)},style:{width:"24px",height:"24px",padding:"0",borderRadius:"4px",border:"none",backgroundColor:"var(--button-bg-color)",color:"var(--text-color)",cursor:"pointer",fontSize:"0.8rem",lineHeight:"1",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s"},title:"폴더 이름 변경",children:"✏"}),p.jsx("button",{onClick:()=>{V(E.id)},style:{width:"24px",height:"24px",padding:"0",borderRadius:"4px",border:"none",backgroundColor:"var(--danger-color)",color:"white",cursor:"pointer",fontSize:"0.8rem",lineHeight:"1",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s"},title:"폴더 삭제",children:"×"})]})]},E.id)}),m?p.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[p.jsx("input",{type:"text",value:v,onChange:E=>T(E.target.value),onKeyPress:E=>{E.key==="Enter"&&U(),E.key==="Escape"&&(g(!1),T(""))},placeholder:"폴더 이름...",autoFocus:!0,style:{padding:"6px 12px",borderRadius:"8px",border:"2px solid var(--primary-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontSize:"0.9rem",outline:"none",width:"120px"}}),p.jsx("button",{onClick:U,style:{padding:"4px 12px",borderRadius:"8px",border:"none",backgroundColor:"var(--primary-color)",color:"white",cursor:"pointer",fontSize:"0.85rem",fontWeight:600,transition:"all 0.2s"},children:"완료"}),p.jsx("button",{onClick:()=>{g(!1),T("")},style:{padding:"4px 12px",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"transparent",color:"var(--text-color)",cursor:"pointer",fontSize:"0.85rem",transition:"all 0.2s"},children:"취소"})]}):p.jsx("button",{onClick:()=>g(!0),style:{padding:"6px 12px",borderRadius:"8px",border:"2px solid var(--primary-color)",backgroundColor:"transparent",color:"var(--primary-color)",cursor:"pointer",fontSize:"0.9rem",fontWeight:500,whiteSpace:"nowrap",transition:"all 0.2s",display:"flex",alignItems:"center",gap:"4px"},children:"➕ 폴더"}),P&&p.jsx("div",{className:"modal-backdrop alert-backdrop",children:p.jsxs("div",{className:"modal-content alert-modal",children:[p.jsxs("div",{className:"alert-content",children:[p.jsx("h2",{children:"폴더 삭제"}),p.jsxs("p",{style:{fontSize:"0.9rem"},children:['"',(O=t.find(E=>E.id===P))==null?void 0:O.name,'" 폴더를 삭제하시겠습니까?',p.jsx("br",{}),'폴더 내 목표는 "나의 목표"로 이동됩니다.']})]}),p.jsxs("div",{className:"modal-buttons",children:[p.jsx("button",{onClick:()=>V(null),className:"secondary",children:"취소"}),p.jsx("button",{onClick:()=>{s(P),V(null)},className:"destructive",children:"삭제"})]})]})}),A&&p.jsx("div",{className:"modal-backdrop alert-backdrop",children:p.jsxs("div",{className:"modal-content alert-modal",children:[p.jsxs("div",{className:"alert-content",children:[p.jsx("h2",{children:"폴더 이름 변경"}),p.jsx("p",{style:{fontSize:"0.9rem",marginBottom:"16px"},children:"새로운 폴더 이름을 입력하세요"}),p.jsx("input",{type:"text",value:S,onChange:E=>I(E.target.value),onKeyPress:E=>{E.key==="Enter"&&S.trim()&&(i(A,S),D(null),I(""))},placeholder:"폴더 이름...",autoFocus:!0,style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontSize:"0.95rem",outline:"none",boxSizing:"border-box"}})]}),p.jsxs("div",{className:"modal-buttons",children:[p.jsx("button",{onClick:()=>{D(null),I("")},className:"secondary",children:"취소"}),p.jsx("button",{onClick:()=>{S.trim()&&(i(A,S),D(null),I(""))},className:"primary",children:"변경"})]})]})})]})},D6=({t,isSelectionMode:e,selectedCount:n,totalVisibleCount:r,onCancelSelection:i,onDeleteSelected:s,onSelectAll:o,isViewModeCalendar:a,onToggleViewMode:l,isAiSorting:u,sortType:f,onSort:m,filter:g,onFilter:v,categoryFilter:T,onCategoryFilter:A,userCategories:D,onAddCategory:S,onRemoveCategory:I,onSetSelectionMode:P,onOpenSettings:V,onAddGoal:U,currentFolderId:O,folders:E,onSyncSharedFolder:w,isSyncing:C,isSyncingData:k,onManualSync:b,activeUsers:L,editingStates:N,onToggleCollaboration:De,onUpdateCollaborationSettings:Fe})=>{var Mt,lt;const[We,Ee]=z.useState(!1),[ne,ce]=z.useState(!1),ye=O?E.find(ge=>ge.id===O):null,we=ye==null?void 0:ye.collaborationSettings,Pe=(we==null?void 0:we.enabled)||(ye==null?void 0:ye.isShared)||!1;z.useEffect(()=>{const ge=()=>{Ee(!1),ce(!1)};return document.addEventListener("click",ge),document.addEventListener("touchstart",ge),()=>{document.removeEventListener("click",ge),document.removeEventListener("touchstart",ge)}},[]);const $e=ge=>{ge.stopPropagation(),Ee(tn=>!tn)},Ke=ge=>{ge.stopPropagation()};return p.jsxs("header",{children:[p.jsx("div",{className:"header-left",children:e&&p.jsx("button",{onClick:i,className:"header-action-button",children:t("cancel_selection_button_label")})}),p.jsxs("div",{className:"header-title-group",children:[p.jsx("h1",{children:t("my_goals_title")}),!e&&p.jsxs("div",{className:"header-inline-actions",children:[p.jsx("button",{onClick:l,className:"header-icon-button","aria-label":t(a?"list_view_button_aria":"calendar_view_button_aria"),children:a?Se.list:Se.calendar}),p.jsxs("div",{className:"filter-sort-container",children:[p.jsx("button",{onClick:$e,onTouchStart:$e,className:"header-icon-button","aria-label":t("filter_sort_button_aria"),children:u?p.jsx("div",{className:"spinner"}):Se.filter}),We&&p.jsxs("div",{className:"profile-popover filter-sort-popover",onClick:Ke,onTouchStart:Ke,children:[p.jsx("div",{className:"popover-section",children:p.jsx("button",{onClick:()=>{P(),Ee(!1)},className:"popover-action-button",children:p.jsx("span",{children:t("select_button_label")})})}),p.jsxs("div",{className:"popover-section",children:[p.jsx("h4",{children:t("filter_title")}),p.jsxs("button",{onClick:()=>{v("all")},className:`popover-action-button ${g==="all"?"active":""}`,children:[p.jsx("span",{children:t("filter_all")}),g==="all"&&Se.check]}),p.jsxs("button",{onClick:()=>{v("active")},className:`popover-action-button ${g==="active"?"active":""}`,children:[p.jsx("span",{children:t("filter_active")}),g==="active"&&Se.check]}),p.jsxs("button",{onClick:()=>{v("completed")},className:`popover-action-button ${g==="completed"?"active":""}`,children:[p.jsx("span",{children:t("filter_completed")}),g==="completed"&&Se.check]})]}),p.jsxs("div",{className:"popover-section",children:[p.jsxs("h4",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[p.jsx("span",{children:t("filter_category")}),p.jsx("button",{onClick:()=>{const ge=prompt("새 카테고리 이름: (New category name:)");ge&&ge.trim()&&!D.includes(ge.trim())&&S(ge.trim())},style:{background:"none",border:"none",color:"var(--primary-color)",cursor:"pointer",fontSize:"1.2rem",padding:"0"},children:"+"})]}),p.jsxs("button",{onClick:()=>{A("all")},className:`popover-action-button ${T==="all"?"active":""}`,children:[p.jsx("span",{children:t("category_all")}),T==="all"&&Se.check]}),D.map(ge=>p.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[p.jsxs("button",{onClick:()=>{A(ge)},className:`popover-action-button ${T===ge?"active":""}`,style:{flex:1,justifyContent:"space-between"},children:[p.jsx("span",{children:ge}),T===ge&&Se.check]}),!["school","work","personal","other"].includes(ge)&&p.jsx("button",{onClick:()=>I(ge),style:{background:"rgba(255, 59, 48, 0.1)",border:"none",color:"var(--danger-color)",borderRadius:"4px",padding:"4px 8px",cursor:"pointer",fontSize:"0.8rem"},children:"✕"})]},ge))]}),p.jsxs("div",{className:"popover-section",children:[p.jsx("h4",{children:t("sort_title")}),p.jsxs("button",{onClick:()=>{m("manual")},className:`popover-action-button ${f==="manual"?"active":""}`,children:[p.jsx("span",{children:t("sort_label_manual")}),f==="manual"&&Se.check]}),p.jsxs("button",{onClick:()=>{m("deadline")},className:`popover-action-button ${f==="deadline"?"active":""}`,children:[p.jsx("span",{children:t("sort_label_deadline")}),f==="deadline"&&Se.check]}),p.jsxs("button",{onClick:()=>{m("newest")},className:`popover-action-button ${f==="newest"?"active":""}`,children:[p.jsx("span",{children:t("sort_label_newest")}),f==="newest"&&Se.check]}),p.jsxs("button",{onClick:()=>{m("alphabetical")},className:`popover-action-button ${f==="alphabetical"?"active":""}`,children:[p.jsx("span",{children:t("sort_label_alphabetical")}),f==="alphabetical"&&Se.check]}),p.jsxs("button",{onClick:()=>{m("ai")},className:"popover-action-button with-icon",children:[p.jsx("span",{className:"popover-button-icon",children:Se.ai}),p.jsx("span",{children:t(u?"ai_sorting_button":"sort_label_ai")})]}),p.jsx("button",{onClick:()=>{m("ai"),Ee(!1)},className:"popover-action-button",style:{backgroundColor:"rgba(88, 86, 214, 0.1)",marginTop:"8px",color:"var(--icon-color-indigo)"},children:p.jsx("span",{children:"💡 정렬 제안 보기"})})]})]})]}),O&&((Mt=E.find(ge=>ge.id===O))==null?void 0:Mt.isShared)&&p.jsxs("div",{className:"collaboration-settings",children:[p.jsx("button",{onClick:()=>ce(!ne),className:`main-action-button ${Pe?"collaboration-active":""}`,"aria-label":"공동작업 설정",title:"공동작업 설정",style:{borderRadius:"999px",padding:"8px 16px",fontWeight:500},children:Pe?"공동작업":"단독작업"}),ne&&O&&p.jsx("div",{className:"profile-popover collaboration-popover",style:{right:"60px",top:"50px"},children:p.jsxs("div",{className:"popover-section",children:[p.jsx("h4",{style:{marginBottom:"12px"},children:"공동작업 설정"}),p.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[p.jsx("span",{children:"공동작업 활성화"}),p.jsx("button",{onClick:()=>De(O,!Pe),style:{background:Pe?"var(--primary-color)":"#ccc",border:"none",borderRadius:"12px",width:"44px",height:"24px",position:"relative",cursor:"pointer",transition:"background 0.2s"},children:p.jsx("div",{style:{background:"white",borderRadius:"50%",width:"20px",height:"20px",position:"absolute",top:"2px",left:Pe?"22px":"2px",transition:"left 0.2s"}})})]}),Pe&&L.length>0&&p.jsxs("div",{style:{marginBottom:"16px"},children:[p.jsxs("h5",{style:{marginBottom:"8px",fontSize:"0.9rem"},children:["현재 접속자 (",L.length,"명)"]}),p.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:L.map(ge=>p.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",background:"rgba(var(--primary-color-rgb), 0.1)",padding:"4px 8px",borderRadius:"12px",fontSize:"0.8rem"},children:[ge.photoURL&&p.jsx("img",{src:ge.photoURL,alt:"",style:{width:"16px",height:"16px",borderRadius:"50%"}}),p.jsx("span",{children:ge.displayName}),p.jsx("div",{style:{width:"6px",height:"6px",background:ge.isOnline?"#34C759":"#ccc",borderRadius:"50%"}})]},ge.userId))})]}),Pe&&p.jsx(p.Fragment,{children:p.jsxs("div",{style:{borderTop:"1px solid #eee",paddingTop:"16px"},children:[p.jsx("h5",{style:{marginBottom:"8px",fontSize:"0.9rem"},children:"세부 설정"}),p.jsxs("label",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px",cursor:"pointer"},children:[p.jsx("span",{style:{fontSize:"0.8rem"},children:"접속자 표시"}),p.jsx("input",{type:"checkbox",checked:(we==null?void 0:we.showPresence)??!0,onChange:ge=>Fe(O,{showPresence:ge.target.checked})})]}),p.jsxs("label",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px",cursor:"pointer"},children:[p.jsx("span",{style:{fontSize:"0.8rem"},children:"편집 상태 표시"}),p.jsx("input",{type:"checkbox",checked:(we==null?void 0:we.showEditingState)??!0,onChange:ge=>Fe(O,{showEditingState:ge.target.checked})})]}),p.jsxs("label",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px",cursor:"pointer"},children:[p.jsx("span",{style:{fontSize:"0.8rem"},children:"충돌 감지"}),p.jsx("input",{type:"checkbox",checked:(we==null?void 0:we.enableConflictDetection)??!0,onChange:ge=>Fe(O,{enableConflictDetection:ge.target.checked})})]})]})})]})})]}),O&&((lt=E.find(ge=>ge.id===O))==null?void 0:lt.isShared)&&p.jsx("button",{onClick:w,disabled:C,className:"main-action-button","aria-label":"동기화",title:C?"동기화 중...":`공유 폴더 수동 동기화
실시간 동기화가 실패했을 때 사용하세요`,style:{borderRadius:"999px",padding:"8px 16px",fontWeight:500,marginLeft:8},children:C?p.jsx("div",{className:"spinner",style:{width:"20px",height:"20px"}}):"동기화"}),p.jsx("button",{className:"sync-status-indicator clickable",onClick:()=>{var ge;k||(O&&((ge=E.find(tn=>tn.id===O))!=null&&ge.isShared)?w():b())},disabled:k,title:k?"동기화 중...":"클릭하여 수동 동기화",children:k?p.jsx("span",{style:{fontSize:"12px"},children:"동기화중"}):p.jsx("span",{style:{fontSize:"12px"},children:"동기화"})}),p.jsx("button",{onClick:V,className:"header-icon-button","aria-label":t("settings_title"),children:Se.settings})]})]}),p.jsx("div",{className:"header-right",children:e?p.jsxs(p.Fragment,{children:[n===0?p.jsx("button",{onClick:o,className:"header-action-button",children:t("select_all_button_label")}):n===r?p.jsx("button",{onClick:i,className:"header-action-button",children:t("cancel_selection_button_label")}):p.jsxs(p.Fragment,{children:[p.jsx("button",{onClick:o,className:"header-action-button",children:t("select_all_button_label")}),p.jsx("button",{onClick:i,className:"header-action-button",children:t("cancel_selection_button_label")})]}),n>0&&p.jsx("button",{onClick:s,className:"header-action-button destructive",children:t("delete_selected_button_label").replace("{count}",String(n))})]}):p.jsx(p.Fragment,{children:p.jsx("button",{onClick:U,className:"header-icon-button","aria-label":t("add_new_goal_button_label"),children:Se.add})})})]})},b6=({todos:t,onToggleComplete:e,onDelete:n,onEdit:r,onInfo:i,t:s,filter:o,randomEncouragement:a,isSelectionMode:l,selectedTodoIds:u,onSelectTodo:f,folders:m,onMoveToFolder:g})=>{if(t.length===0){const v=`empty_message_${o}`;return p.jsx("div",{className:"empty-message",children:p.jsx("p",{children:s(v)})})}return p.jsx("ul",{children:t.map(v=>p.jsx(M6,{todo:v,onToggleComplete:e,onDelete:n,onEdit:r,onInfo:i,t:s,isSelectionMode:l,isSelected:u.has(v.id),onSelect:f,folders:m,onMoveToFolder:g},v.id))})},M6=lw.memo(({todo:t,onToggleComplete:e,onDelete:n,onEdit:r,onInfo:i,t:s,isSelectionMode:o,isSelected:a,onSelect:l,folders:u,onMoveToFolder:f})=>{var T;const m=()=>{o&&l(t.id)},g={school:"🎓",work:"💼",personal:"👤",other:"📌"},v=A=>A?{school:s("category_school"),work:s("category_work"),personal:s("category_personal"),other:s("category_other")}[A]||A:"";return p.jsx("li",{className:`${t.completed?"completed":""} ${o?"selection-mode":""} ${a?"selected":""}`,onClick:m,children:p.jsxs("div",{className:"swipeable-content",children:[p.jsxs("label",{className:"checkbox-container",onClick:A=>A.stopPropagation(),children:[p.jsx("input",{type:"checkbox",checked:t.completed,onChange:()=>e(t.id)}),p.jsx("span",{className:"checkmark"})]}),p.jsxs("div",{className:"todo-text-with-streak",children:[p.jsx("span",{className:"todo-text",children:t.wish}),t.isRecurring&&t.streak>0&&p.jsxs("div",{className:"streak-indicator",children:[Se.flame,p.jsx("span",{children:t.streak})]})]}),p.jsxs("div",{className:"todo-actions-and-meta",children:[p.jsxs("div",{className:"todo-meta-badges",children:[t.category&&p.jsxs("span",{style:{backgroundColor:"rgba(88, 86, 214, 0.1)",color:"var(--icon-color-indigo)",padding:"4px 8px",borderRadius:"4px",fontSize:"0.8rem",marginRight:"4px",display:"inline-flex",alignItems:"center",gap:"4px",whiteSpace:"nowrap"},children:[g[t.category]||"📌"," ",v(t.category)]}),t.deadline&&p.jsx("span",{className:"todo-deadline",children:R6(t.deadline,s)}),t.collaborators&&t.collaborators.length>0&&p.jsxs("span",{style:{backgroundColor:"rgba(52, 199, 89, 0.1)",color:"var(--success-color)",padding:"4px 8px",borderRadius:"4px",fontSize:"0.85rem",marginLeft:"4px",display:"inline-flex",alignItems:"center",gap:"4px"},children:["🤝 ",t.collaborators.length]}),t.folderId&&p.jsxs("span",{style:{backgroundColor:"rgba(100, 150, 200, 0.15)",color:"var(--primary-color)",padding:"4px 8px",borderRadius:"4px",fontSize:"0.8rem",marginLeft:"4px",display:"inline-flex",alignItems:"center",gap:"4px",whiteSpace:"nowrap"},children:["📁 ",((T=u.find(A=>A.id===t.folderId))==null?void 0:T.name)||"Unknown"]})]}),p.jsxs("div",{className:"todo-buttons",children:[p.jsxs("select",{onClick:A=>A.stopPropagation(),onChange:A=>{f(t.id,A.target.value==="root"?null:A.target.value)},defaultValue:t.folderId||"root",style:{padding:"4px 8px",borderRadius:"4px",border:"1px solid var(--border-color)",backgroundColor:"var(--card-bg-color)",color:"var(--text-color)",cursor:"pointer",fontSize:"0.85rem",fontFamily:"inherit"},title:"폴더 선택",children:[p.jsx("option",{value:"root",children:"📁 나의 목표"}),u.map(A=>p.jsx("option",{value:A.id,children:A.name},A.id))]}),p.jsx("button",{onClick:A=>{A.stopPropagation(),r(t)},className:"info-button edit-button","aria-label":s("edit_button_aria"),children:Se.edit}),p.jsx("button",{onClick:A=>{A.stopPropagation(),n(t.id)},className:"delete-button","aria-label":s("delete_button"),children:Se.delete}),p.jsx("button",{onClick:A=>{A.stopPropagation(),i(t)},className:"info-button","aria-label":s("info_button_aria"),children:Se.info})]})]})]})})}),ho=({onClose:t,children:e,className:n="",isClosing:r,size:i="large"})=>{const s={small:"modal-content-small",medium:"modal-content-medium",large:"modal-content-large"}[i];return p.jsx("div",{className:`modal-backdrop ${r?"is-closing":""}`,onClick:t,children:p.jsx("div",{className:`modal-content ${s} ${n} ${r?"is-closing":""}`,onClick:o=>o.stopPropagation(),children:e})})},Ga=t=>{const[e,n]=z.useState(!1);return[e,()=>{n(!0),setTimeout(t,500)}]},V6=({step:t,t:e,createAI:n,...r})=>{const{wish:i,setWish:s,outcome:o,setOutcome:a,obstacle:l,setObstacle:u,plan:f,setPlan:m,isRecurring:g,setIsRecurring:v,recurringDays:T,setRecurringDays:A,deadline:D,setDeadline:S,noDeadline:I,setNoDeadline:P,category:V,setCategory:U,userCategories:O,errors:E,language:w}=r,[C,k]=z.useState(!1),[b,L]=z.useState(""),[N,De]=z.useState(""),Fe=async(We,Ee)=>{if(Ee){k(!0),L(""),De("");try{const ne=n();if(!ne){De("AI 기능을 사용하려면 설정에서 API 키를 입력해주세요."),k(!1);return}const ce=`Provide concise, actionable feedback on this part of a WOOP goal: ${We} - "${Ee}". The feedback should be helpful and encouraging, in ${w==="ko"?"Korean":"English"}. Keep it to 1-2 sentences.`,ye=await ne.models.generateContent({model:"gemini-2.5-flash",contents:ce});L(ye.text)}catch(ne){console.error("AI Feedback Error:",ne),De("Failed to get AI feedback.")}finally{k(!1)}}};switch(t){case 1:return p.jsxs("div",{children:[p.jsx("h3",{children:e("wish_label")}),p.jsxs("div",{className:"step-guidance",children:[p.jsx("p",{className:"tip",children:e("wish_tip")}),p.jsx("p",{className:"example",children:e("wish_example")})]}),p.jsx("textarea",{value:i,onChange:Ee=>{s(Ee.target.value),L(""),De("")},placeholder:e("wish_label"),className:E.wish?"input-error":"",rows:3}),E.wish&&p.jsxs("p",{className:"field-error-message",children:[Se.exclamation," ",e("error_wish_required")]}),p.jsxs("div",{className:"ai-feedback-section",children:[p.jsxs("button",{onClick:()=>Fe("Wish",i),disabled:!i.trim()||C,className:"ai-feedback-button",children:[C?p.jsx("div",{className:"spinner-small"}):"🤖",p.jsx("span",{children:e(C?"ai_analyzing":"ai_coach_suggestion")})]}),b&&p.jsx("div",{className:"ai-feedback-bubble",children:b}),N&&p.jsx("div",{className:"ai-feedback-bubble error",children:N})]})]});case 2:return p.jsxs("div",{children:[p.jsx("h3",{children:e("outcome_label")}),p.jsxs("div",{className:"step-guidance",children:[p.jsx("p",{className:"tip",children:e("outcome_tip")}),p.jsx("p",{className:"example",children:e("outcome_example")})]}),p.jsx("textarea",{value:o,onChange:Ee=>{a(Ee.target.value),L(""),De("")},placeholder:e("outcome_label"),className:E.outcome?"input-error":"",rows:3}),E.outcome&&p.jsxs("p",{className:"field-error-message",children:[Se.exclamation," ",e("error_outcome_required")]}),p.jsxs("div",{className:"ai-feedback-section",children:[p.jsxs("button",{onClick:()=>Fe("Outcome",o),disabled:!o.trim()||C,className:"ai-feedback-button",children:[C?p.jsx("div",{className:"spinner-small"}):"🤖",p.jsx("span",{children:e(C?"ai_analyzing":"ai_coach_suggestion")})]}),b&&p.jsx("div",{className:"ai-feedback-bubble",children:b}),N&&p.jsx("div",{className:"ai-feedback-bubble error",children:N})]})]});case 3:return p.jsxs("div",{children:[p.jsx("h3",{children:e("obstacle_label")}),p.jsxs("div",{className:"step-guidance",children:[p.jsx("p",{className:"tip",children:e("obstacle_tip")}),p.jsx("p",{className:"example",children:e("obstacle_example")})]}),p.jsx("textarea",{value:l,onChange:Ee=>{u(Ee.target.value),L(""),De("")},placeholder:e("obstacle_label"),className:E.obstacle?"input-error":"",rows:3}),E.obstacle&&p.jsxs("p",{className:"field-error-message",children:[Se.exclamation," ",e("error_obstacle_required")]}),p.jsxs("div",{className:"ai-feedback-section",children:[p.jsxs("button",{onClick:()=>Fe("Obstacle",l),disabled:!l.trim()||C,className:"ai-feedback-button",children:[C?p.jsx("div",{className:"spinner-small"}):"🤖",p.jsx("span",{children:e(C?"ai_analyzing":"ai_coach_suggestion")})]}),b&&p.jsx("div",{className:"ai-feedback-bubble",children:b}),N&&p.jsx("div",{className:"ai-feedback-bubble error",children:N})]})]});case 4:return p.jsxs("div",{children:[p.jsx("h3",{children:e("plan_label")}),p.jsxs("div",{className:"step-guidance",children:[p.jsx("p",{className:"tip",children:e("plan_tip")}),p.jsx("p",{className:"example",children:e("plan_example")})]}),p.jsx("textarea",{value:f,onChange:Ee=>{m(Ee.target.value),L(""),De("")},placeholder:e("plan_label"),className:E.plan?"input-error":"",rows:3}),E.plan&&p.jsxs("p",{className:"field-error-message",children:[Se.exclamation," ",e("error_plan_required")]}),p.jsxs("div",{className:"ai-feedback-section",children:[p.jsxs("button",{onClick:()=>Fe("Plan",f),disabled:!f.trim()||C,className:"ai-feedback-button",children:[C?p.jsx("div",{className:"spinner-small"}):"🤖",p.jsx("span",{children:e(C?"ai_analyzing":"ai_coach_suggestion")})]}),b&&p.jsx("div",{className:"ai-feedback-bubble",children:b}),N&&p.jsx("div",{className:"ai-feedback-bubble error",children:N})]})]});case 5:const We=Ee=>{const ne=[...T],ce=ne.indexOf(Ee);ce>-1?ne.splice(ce,1):ne.push(Ee),A(ne)};return p.jsxs("div",{children:[p.jsxs("h3",{children:[e("recurrence_label")," & ",e("deadline_label")," & ",e("category_label")]}),p.jsxs("div",{className:"step-guidance",children:[p.jsx("p",{className:"tip",children:e("recurrence_tip")}),p.jsx("p",{className:"example",children:e("recurrence_example")})]}),p.jsxs("label",{className:"settings-item standalone-toggle",children:[p.jsx("span",{style:{fontWeight:500},children:e("recurrence_option_daily")}),p.jsxs("label",{className:"theme-toggle-switch",children:[p.jsx("input",{type:"checkbox",checked:g,onChange:Ee=>v(Ee.target.checked)}),p.jsx("span",{className:"slider round"})]})]}),g&&p.jsx("div",{className:"day-picker",children:e("day_names_short_picker").map((Ee,ne)=>p.jsx("button",{onClick:()=>We(ne),className:`day-button ${T.includes(ne)?"selected":""}`,children:Ee},ne))}),E.recurringDays&&p.jsxs("p",{className:"field-error-message",children:[Se.exclamation," ",e("error_day_required")]}),p.jsx("hr",{}),p.jsx("div",{className:"step-guidance",style:{marginTop:"16px"},children:p.jsx("p",{className:"tip",children:e("deadline_tip")})}),p.jsxs("label",{className:"settings-item standalone-toggle",children:[p.jsx("span",{style:{fontWeight:500},children:e("deadline_option_no_deadline")}),p.jsxs("label",{className:"theme-toggle-switch",children:[p.jsx("input",{type:"checkbox",checked:I,onChange:Ee=>P(Ee.target.checked)}),p.jsx("span",{className:"slider round"})]})]}),!I&&p.jsx("input",{type:"date",value:D,onChange:Ee=>S(Ee.target.value),className:E.deadline?"input-error":"",style:{marginTop:"12px"}}),E.deadline&&p.jsxs("p",{className:"field-error-message",children:[Se.exclamation," ",e("error_deadline_required")]}),p.jsx("hr",{}),p.jsx("div",{className:"step-guidance",style:{marginTop:"16px"},children:p.jsx("p",{className:"tip",children:e("category_label")})}),p.jsx("div",{style:{display:"grid",gridTemplateColumns:O&&O.length>2?"repeat(2, 1fr)":"repeat(1, 1fr)",gap:"8px",marginTop:"12px"},children:O&&O.map(Ee=>p.jsx("button",{onClick:()=>U(Ee),className:`category-button ${V===Ee?"active":""}`,children:Ee},Ee))})]});default:return null}},L6=({onGenerate:t,t:e})=>{const[n,r]=z.useState(""),[i,s]=z.useState(""),[o,a]=z.useState(""),[l,u]=z.useState(""),[f,m]=z.useState(""),{endDate:g,generatedCount:v}=z.useMemo(()=>{const A=parseInt(i,10),D=parseInt(o,10);if(!l||!A||A<=0||!D||D<=0)return{endDate:"",generatedCount:0};const S=Math.ceil(A/D),I=new Date(l),P=new Date(I);return P.setDate(I.getDate()+S-1),{endDate:P.toISOString().split("T")[0],generatedCount:S}},[i,o,l]),T=()=>{const A=parseInt(i,10),D=parseInt(o,10);if(!n.trim()||!l||!A||A<=0||!D||D<=0){m(e("automation_error_all_fields"));return}const S=[],I=Math.ceil(A/D),P=new Date(l);for(let V=0;V<I;V++){const U=new Date(P);U.setDate(P.getDate()+V);const O=V*D+1,E=Math.min((V+1)*D,A),w=`${n.trim()} ${O}`+(E>O?` - ${E}`:"");S.push({wish:w,outcome:"",obstacle:"",plan:"",isRecurring:!1,recurringDays:[],deadline:U.toISOString().split("T")[0],category:"personal"})}m(""),t(S)};return p.jsxs("div",{className:"automation-form-container",children:[p.jsx("h3",{children:e("automation_title")}),p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:e("automation_base_name_label")}),p.jsx("input",{type:"text",value:n,onChange:A=>r(A.target.value),placeholder:e("automation_base_name_placeholder")})]}),p.jsxs("div",{className:"automation-form-grid",children:[p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:e("automation_total_units_label")}),p.jsx("input",{type:"number",value:i,onChange:A=>s(A.target.value),placeholder:e("automation_total_units_placeholder")})]}),p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:e("automation_units_per_day_label")}),p.jsx("input",{type:"number",value:o,onChange:A=>a(A.target.value),placeholder:"예: 5"})]})]}),p.jsxs("div",{className:"automation-form-grid",children:[p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:e("automation_start_date_label")}),p.jsx("input",{type:"date",value:l,onChange:A=>u(A.target.value)})]}),p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:e("automation_end_date_label")}),p.jsx("input",{type:"date",value:g,readOnly:!0})]})]}),f&&p.jsxs("p",{className:"field-error-message",style:{justifyContent:"center"},children:[Se.exclamation," ",f]}),p.jsx("div",{className:"goal-assistant-nav",children:p.jsx("button",{onClick:T,className:"primary",disabled:v===0,children:e("automation_generate_button").replace("{count}",String(v))})})]})},QI=({onClose:t,onAddTodo:e,onAddMultipleTodos:n,onEditTodo:r,existingTodo:i,t:s,language:o,createAI:a,userCategories:l=["personal"]})=>{const[u,f]=Ga(t),[m,g]=z.useState("woop"),[v,T]=z.useState(1),[A,D]=z.useState("forward"),[S,I]=z.useState((i==null?void 0:i.wish)||""),[P,V]=z.useState((i==null?void 0:i.outcome)||""),[U,O]=z.useState((i==null?void 0:i.obstacle)||""),[E,w]=z.useState((i==null?void 0:i.plan)||""),[C,k]=z.useState((i==null?void 0:i.isRecurring)||!1),[b,L]=z.useState((i==null?void 0:i.recurringDays)||[]),[N,De]=z.useState((i==null?void 0:i.deadline)||""),[Fe,We]=z.useState(!(i!=null&&i.deadline)),[Ee,ne]=z.useState((i==null?void 0:i.category)||"personal"),[ce,ye]=z.useState({}),[we,Pe]=z.useState(""),[$e,Ke]=z.useState(""),[Mt,lt]=z.useState(""),[ge,tn]=z.useState("personal"),Tn=5,Mn=Me=>{const At={};return Me===1&&!S.trim()&&(At.wish=!0),Me===2&&!P.trim()&&(At.outcome=!0),Me===3&&!U.trim()&&(At.obstacle=!0),Me===4&&!E.trim()&&(At.plan=!0),Me===5&&(!Fe&&!N&&(At.deadline=!0),C&&b.length===0&&(At.recurringDays=!0)),ye(At),Object.keys(At).length===0},cr=()=>{Mn(v)&&(v<Tn?(D("forward"),T(Me=>Me+1)):dn())},dr=()=>{v>1&&(D("backward"),T(Me=>Me-1))},dn=()=>{if(!Mn(5))return;const Me={wish:S,outcome:P,obstacle:U,plan:E,isRecurring:C,recurringDays:b,deadline:Fe?"":N,category:Ee};i&&r?r({...i,...Me}):e&&e(Me)},Pr=()=>{we.trim()&&(e&&e({wish:we.trim(),outcome:we.trim(),obstacle:"",plan:"",isRecurring:!1,recurringDays:[],deadline:$e,category:ge}),Pe(""),Ke(""),lt(""),tn("personal"),f())};return p.jsxs(ho,{onClose:f,isClosing:u,className:"goal-assistant-modal",children:[p.jsxs("div",{className:"goal-assistant-header",children:[p.jsx("div",{className:"goal-assistant-header-left",children:v>1&&m==="woop"&&p.jsx("button",{onClick:dr,className:"settings-back-button",children:Se.back})}),p.jsx("h2",{children:m==="woop"?"새로운 목표":m==="quick"?"새로운 할일":m==="automation"?"새로운 계획":s("goal_assistant_title")}),p.jsx("div",{className:"goal-assistant-header-right",children:p.jsx("button",{onClick:f,className:"close-button",children:Se.close})})]}),!i&&p.jsx("div",{className:"modal-mode-switcher-container",children:p.jsxs("div",{className:"modal-mode-switcher",children:[p.jsx("button",{onClick:()=>g("woop"),className:m==="woop"?"active":"",children:s("goal_assistant_mode_woop")}),p.jsx("button",{onClick:()=>g("quick"),className:m==="quick"?"active":"",children:"새로운 할일"}),p.jsx("button",{onClick:()=>g("automation"),className:m==="automation"?"active":"",children:s("goal_assistant_mode_automation")})]})}),p.jsx("div",{className:"goal-assistant-body",children:m==="woop"?p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"progress-bar-container",children:p.jsx("div",{className:"progress-bar",style:{width:`${v/Tn*100}%`}})}),p.jsx("div",{className:`goal-assistant-step-content-animator ${A}`,children:p.jsx(V6,{step:v,t:s,createAI:a,wish:S,setWish:I,outcome:P,setOutcome:V,obstacle:U,setObstacle:O,plan:E,setPlan:w,isRecurring:C,setIsRecurring:k,recurringDays:b,setRecurringDays:L,deadline:N,setDeadline:De,noDeadline:Fe,setNoDeadline:We,category:Ee,setCategory:ne,userCategories:l,errors:ce,language:o})},v),p.jsxs("div",{className:"goal-assistant-nav",children:[v>1?p.jsx("button",{onClick:dr,className:"secondary",children:s("back_button")}):p.jsx("div",{}),p.jsx("button",{onClick:cr,className:"primary",children:s(v===Tn?i?"save_button":"add_button":"next_button")})]})]}):m==="quick"?p.jsxs("div",{style:{padding:"24px 16px"},children:[p.jsxs("div",{style:{marginBottom:"20px"},children:[p.jsx("h3",{style:{fontSize:"1rem",fontWeight:"600",marginBottom:"12px"},children:"새로운 할일"}),p.jsx("div",{className:"step-guidance",children:p.jsx("p",{className:"tip",children:"빠르게 할일을 추가하세요"})}),p.jsx("textarea",{value:we,onChange:Me=>Pe(Me.target.value),placeholder:"예: 선물 사기",rows:2,style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontSize:"14px",fontFamily:"inherit",resize:"none",marginTop:"12px"},onKeyPress:Me=>{Me.key==="Enter"&&Me.ctrlKey&&Pr()}})]}),p.jsx("hr",{}),p.jsxs("div",{style:{marginBottom:"20px"},children:[p.jsx("div",{className:"step-guidance",style:{marginTop:"16px"},children:p.jsx("p",{className:"tip",children:"마감일 설정 (선택)"})}),p.jsxs("label",{className:"settings-item standalone-toggle",style:{marginTop:"12px"},children:[p.jsx("span",{style:{fontWeight:"500"},children:"마감일 설정"}),p.jsxs("label",{className:"theme-toggle-switch",children:[p.jsx("input",{type:"checkbox",checked:!!$e,onChange:Me=>Ke(Me.target.checked?new Date().toISOString().split("T")[0]:"")}),p.jsx("span",{className:"slider round"})]})]}),$e&&p.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",marginTop:"12px"},children:[p.jsxs("div",{children:[p.jsx("label",{style:{fontSize:"12px",opacity:.7,display:"block",marginBottom:"4px"},children:"날짜"}),p.jsx("input",{type:"date",value:$e,onChange:Me=>Ke(Me.target.value),style:{width:"100%",padding:"10px",borderRadius:"6px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontSize:"13px"}})]}),p.jsxs("div",{children:[p.jsx("label",{style:{fontSize:"12px",opacity:.7,display:"block",marginBottom:"4px"},children:"시간 (선택)"}),p.jsx("input",{type:"time",value:Mt,onChange:Me=>lt(Me.target.value),style:{width:"100%",padding:"10px",borderRadius:"6px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontSize:"13px"}})]})]})]}),p.jsx("hr",{}),p.jsxs("div",{style:{marginBottom:"24px"},children:[p.jsx("div",{className:"step-guidance",style:{marginTop:"16px"},children:p.jsx("p",{className:"tip",children:s("category_label")})}),p.jsx("div",{style:{display:"grid",gridTemplateColumns:l&&l.length>2?"repeat(2, 1fr)":"repeat(1, 1fr)",gap:"8px",marginTop:"12px"},children:l&&l.map(Me=>p.jsx("button",{onClick:()=>tn(Me),className:`category-button ${ge===Me?"active":""}`,children:Me},Me))})]}),p.jsxs("div",{className:"goal-assistant-nav",children:[p.jsx("button",{onClick:f,className:"secondary",children:s("cancel_button")}),p.jsx("button",{onClick:Pr,className:"primary",disabled:!we.trim(),children:s("add_button")})]})]}):n&&p.jsx(L6,{onGenerate:n,t:s})})]})},F6=({todo:t,onClose:e,t:n,createAI:r,onOpenCollaboration:i,userCategories:s,onUpdateGoal:o})=>{const[a,l]=Ga(e),[u,f]=z.useState(""),[m,g]=z.useState(!1),[v,T]=z.useState(!1),A=async()=>{g(!0),f(""),T(!1);try{const D=r();if(!D){f("AI 기능을 사용하려면 설정에서 API 키를 입력해주세요."),g(!1);return}const S=`Based on the WOOP method, provide a concise and encouraging suggestion for the following goal: Wish: "${t.wish}", Best Outcome: "${t.outcome}", Obstacle: "${t.obstacle}", Plan: "${t.plan}". Focus on strengthening the plan or reframing the obstacle.`,I=await D.models.generateContent({model:"gemini-2.5-flash",contents:S});f(I.text)}catch(D){console.error(D),T(!0)}finally{g(!1)}};return p.jsxs(ho,{onClose:l,isClosing:a,className:"info-modal",children:[p.jsxs("div",{className:"info-modal-content",children:[p.jsx("h2",{children:n("goal_details_modal_title")}),p.jsxs("div",{className:"info-section",children:[p.jsx("h4",{children:n("wish_label")}),p.jsx("p",{children:t.wish})]}),p.jsxs("div",{className:"info-section",children:[p.jsx("h4",{children:n("outcome_label")}),p.jsx("p",{children:t.outcome})]}),p.jsxs("div",{className:"info-section",children:[p.jsx("h4",{children:n("obstacle_label")}),p.jsx("p",{children:t.obstacle})]}),p.jsxs("div",{className:"info-section",children:[p.jsx("h4",{children:n("plan_label")}),p.jsx("p",{children:t.plan})]}),s&&s.length>0&&o&&p.jsxs("div",{className:"info-section",style:{borderTop:"1px solid var(--border-color)",paddingTop:"16px",marginTop:"16px"},children:[p.jsx("h4",{style:{marginBottom:"12px"},children:n("category_label")}),p.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:s.map(D=>p.jsx("button",{onClick:()=>{o({...t,category:D}),l()},className:`category-button ${t.category===D?"active":""}`,style:{padding:"8px 16px",borderRadius:"20px",border:t.category===D?"2px solid var(--primary-color)":"2px solid var(--border-color)",backgroundColor:t.category===D?"var(--primary-color)":"transparent",color:t.category===D?"white":"var(--text-color)",cursor:"pointer",fontSize:"14px",fontWeight:t.category===D?"600":"500",transition:"all 0.25s ease",whiteSpace:"nowrap",display:"inline-block",boxShadow:t.category===D?"0 2px 8px rgba(88, 86, 214, 0.2)":"none"},children:D},D))})]}),p.jsxs("div",{className:"ai-analysis-section",children:[p.jsx("h4",{children:n("ai_coach_suggestion")}),m?p.jsx("p",{children:n("ai_analyzing")}):u?p.jsx("p",{children:u}):v?p.jsx("p",{className:"ai-error",children:n("ai_sort_error_message")}):p.jsx("button",{onClick:A,className:"feedback-button",children:n("ai_coach_suggestion")})]})]}),p.jsxs("div",{className:"modal-buttons",children:[i&&p.jsx("button",{onClick:()=>{i(t),l()},className:"secondary",children:"🤝 협업"}),p.jsx("button",{onClick:l,className:"primary",children:n("close_button")})]})]})},U6=({folder:t,onClose:e,t:n,googleUser:r,onUpdateCollaborators:i,setAlertConfig:s})=>{const[o,a]=Ga(e),[l,u]=z.useState(""),[f,m]=z.useState(!1),[g,v]=z.useState(""),[T,A]=z.useState(!1),D=async()=>{if(!(!t||!r)){m(!0);try{const V=`${t.id}-${Math.random().toString(36).substr(2,8)}`,U={folderId:t.id,ownerId:r.uid,createdAt:new Date().toISOString(),password:T?g:void 0},{doc:O,setDoc:E}=await gi(async()=>{const{doc:k,setDoc:b}=await Promise.resolve().then(()=>yi);return{doc:k,setDoc:b}},void 0),w=O(pe,"shared_links",V);await E(w,U);const C=window.location.origin;u(`${C}/share/${V}`)}catch(V){console.error("공유 링크 생성 실패:",V),s({title:"공유 링크 생성 실패",message:"공유 링크를 만드는 중 오류가 발생했어요.",confirmText:"확인",onConfirm:()=>{}})}finally{m(!1)}}},S=()=>{l&&(navigator.clipboard.writeText(l),s({title:"복사 완료",message:"링크가 클립보드에 복사됐어요!",confirmText:"확인",onConfirm:()=>{}}))};return t?p.jsxs(ho,{onClose:a,isClosing:o,className:"goal-assistant-modal",children:[p.jsxs("div",{className:"goal-assistant-header",children:[p.jsx("div",{className:"goal-assistant-header-left"}),p.jsxs("h2",{children:[t.name," 폴더 공유"]}),p.jsx("div",{className:"goal-assistant-header-right",children:p.jsx("button",{onClick:a,className:"close-button",children:Se.close})})]}),p.jsx("div",{className:"goal-assistant-body",children:p.jsxs("div",{style:{padding:"24px 16px"},children:[p.jsxs("div",{style:{marginBottom:"20px"},children:[p.jsx("h3",{style:{fontSize:"1rem",fontWeight:"600",marginBottom:"12px"},children:"현재 협업자"}),t.collaborators&&t.collaborators.length>0?p.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:t.collaborators.map(V=>p.jsxs("div",{className:"settings-item",style:{padding:"12px",backgroundColor:"var(--card-bg-color)",borderRadius:"8px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[p.jsxs("div",{style:{flex:1},children:[p.jsx("div",{style:{fontWeight:"500",fontSize:"0.95rem"},children:V.email}),V.role==="owner"?p.jsx("div",{style:{fontSize:"0.85rem",color:"var(--text-secondary-color)",marginTop:"2px"},children:"소유자"}):p.jsxs("select",{value:V.role,onChange:U=>P(V.userId,U.target.value),style:{fontSize:"0.85rem",padding:"4px 8px",marginTop:"4px",borderRadius:"4px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",cursor:"pointer"},children:[p.jsx("option",{value:"editor",children:"편집자"}),p.jsx("option",{value:"viewer",children:"뷰어"})]})]}),V.role!=="owner"&&p.jsx("button",{onClick:()=>I(V.userId),style:{padding:"4px 12px",backgroundColor:"var(--danger-color)",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"0.8rem",marginLeft:"12px",whiteSpace:"nowrap"},children:"제거"})]},V.userId))}):p.jsx("div",{className:"step-guidance",children:p.jsx("p",{className:"tip",children:"협업자가 없습니다. 공유 링크로 협업자를 추가하세요."})})]}),p.jsx("hr",{style:{margin:"20px 0",border:"none",borderTop:"1px solid var(--border-color)"}}),p.jsxs("div",{style:{marginBottom:"20px"},children:[p.jsx("h3",{style:{fontSize:"1rem",fontWeight:"600",marginBottom:"12px"},children:"공유 링크로 협업자 추가"}),p.jsx("div",{className:"step-guidance",children:p.jsx("p",{className:"tip",children:"공유 링크를 생성하고 협업자에게 전달하면, 그들이 해당 폴더에 접근할 수 있습니다."})}),l?p.jsxs("div",{style:{marginTop:"16px",display:"flex",flexDirection:"column",gap:"12px"},children:[p.jsx("div",{style:{padding:"12px",backgroundColor:"var(--card-bg-color)",borderRadius:"8px",border:"1px solid var(--border-color)"},children:p.jsx("input",{type:"text",readOnly:!0,value:l,onClick:V=>V.target.select(),style:{width:"100%",padding:"10px",border:"1px solid var(--border-color)",borderRadius:"6px",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontSize:"0.85rem",boxSizing:"border-box",fontFamily:"monospace"}})}),p.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[p.jsx("button",{onClick:S,className:"primary",children:"클립보드 복사"}),p.jsx("button",{onClick:()=>{u(""),v(""),A(!1)},className:"secondary",children:"새로 생성"})]})]}):p.jsxs("div",{style:{marginTop:"16px",display:"flex",flexDirection:"column",gap:"12px"},children:[p.jsxs("label",{className:"settings-item standalone-toggle",children:[p.jsx("span",{style:{fontWeight:"500"},children:"링크에 암호 설정"}),p.jsxs("label",{className:"theme-toggle-switch",children:[p.jsx("input",{type:"checkbox",checked:T,onChange:V=>{A(V.target.checked),V.target.checked||v("")}}),p.jsx("span",{className:"slider round"})]})]}),T&&p.jsx("input",{type:"password",placeholder:"암호 입력",value:g,onChange:V=>v(V.target.value),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontFamily:"inherit",fontSize:"14px",boxSizing:"border-box"}}),p.jsx("button",{onClick:D,disabled:f||T&&!g.trim(),className:"primary",style:{width:"100%",padding:"14px 0",backgroundColor:"var(--primary-color)",color:"white",border:"none",borderRadius:"24px",boxShadow:"0 2px 8px rgba(88,86,214,0.08)",fontWeight:700,fontSize:"16px",letterSpacing:"0.01em",cursor:f||T&&!g.trim()?"not-allowed":"pointer",opacity:f||T&&!g.trim()?.6:1,transition:"all 0.2s"},children:f?"링크 생성 중...":"공유 링크 생성"})]})]})]})}),p.jsxs("div",{className:"goal-assistant-nav",children:[p.jsx("div",{}),p.jsx("button",{onClick:a,className:"primary",children:"닫기"})]})]}):null},O6=({onClose:t,isDarkMode:e,onToggleDarkMode:n,themeMode:r,onThemeChange:i,backgroundTheme:s,onSetBackgroundTheme:o,onExportData:a,onImportData:l,setAlertConfig:u,onDeleteAllData:f,dataActionStatus:m,language:g,onSetLanguage:v,t:T,todos:A,setToastMessage:D,onOpenVersionInfo:S,onOpenUsageGuide:I,apiKey:P,onSetApiKey:V,isOfflineMode:U,onToggleOfflineMode:O,googleUser:E,onGoogleLogin:w,onGoogleLogout:C,onSyncDataToFirebase:k,onLoadDataFromFirebase:b,isGoogleLoggingIn:L=!1,isGoogleLoggingOut:N=!1,isSyncingData:De=!1,isLoadingData:Fe=!1,isAutoSyncEnabled:We,setIsAutoSyncEnabled:Ee,onDiagnoseFirebase:ne})=>{const[ce,ye]=Ga(t),[we,Pe]=z.useState("appearance"),[$e,Ke]=z.useState(""),[Mt,lt]=z.useState(!1),[ge,tn]=z.useState("medium"),[Tn,Mn]=z.useState(null),cr=z.useRef(null),dr=[{id:"appearance",label:T("settings_section_background"),icon:Se.background},{id:"notifications",label:T("settings_notifications"),icon:Se.settings},{id:"general",label:T("settings_section_general"),icon:Se.settings},{id:"data",label:T("settings_section_data"),icon:Se.data}],dn=()=>u({title:T("delete_account_header"),message:T("delete_account_header_desc"),isDestructive:!0,confirmText:T("delete_all_data_button"),cancelText:T("cancel_button"),onConfirm:f,onCancel:()=>{}}),Pr=async()=>{if(!A||A.length===0){Mn(T("no_data_to_share"));return}lt(!0);try{const qe=JI(A),ut=`${window.location.origin}${window.location.pathname}?data=${encodeURIComponent(qe)}`,le=await P6(ut);Ke(le),le!==ut&&le.length<ut.length?D(T("short_url_created")):D(T("share_link_created"))}catch(qe){console.error("Failed to create share link",qe);const ut=JI(A),le=`${window.location.origin}${window.location.pathname}?data=${encodeURIComponent(ut)}`;Ke(le),D(T("short_url_failed"))}finally{lt(!1)}},Me=()=>{$e&&navigator.clipboard.writeText($e).then(()=>{D(T("link_copied_toast"))})},At=()=>{switch(we){case"appearance":return p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"settings-section-header",children:T("settings_theme_mode")}),p.jsxs("div",{className:"settings-section-body",children:[p.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>i("light"),children:[p.jsxs("div",{children:[p.jsx("span",{children:T("theme_mode_light")}),p.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:T("theme_mode_light_desc")})]}),r==="light"&&Se.check]}),p.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>i("dark"),children:[p.jsxs("div",{children:[p.jsx("span",{children:T("theme_mode_dark")}),p.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:T("theme_mode_dark_desc")})]}),r==="dark"&&Se.check]}),p.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>i("system"),children:[p.jsxs("div",{children:[p.jsx("span",{children:T("theme_mode_system")}),p.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:T("theme_mode_system_desc")})]}),r==="system"&&Se.check]})]}),p.jsx("div",{className:"settings-section-header",children:T("settings_background_header")}),p.jsx("div",{className:"settings-section-body",children:ng.map(qe=>p.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>o(qe.id),children:[p.jsx("span",{children:T(e?qe.darkNameKey:qe.lightNameKey)}),s===qe.id&&Se.check]},qe.id))})]});case"notifications":return p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"settings-section-header",children:T("notification_settings_title")}),p.jsxs("div",{className:"settings-section-body",children:[p.jsxs("label",{className:"settings-item",children:[p.jsxs("div",{children:[p.jsx("span",{children:T("notification_deadline")}),p.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:T("notification_deadline_desc")})]}),p.jsxs("div",{className:"theme-toggle-switch",children:[p.jsx("input",{type:"checkbox",defaultChecked:!0,onChange:()=>{}}),p.jsx("span",{className:"slider round"})]})]}),p.jsxs("label",{className:"settings-item",children:[p.jsxs("div",{children:[p.jsx("span",{children:T("notification_suggestion")}),p.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:"지정된 시간에 할일을 제안합니다."})]}),p.jsxs("div",{className:"theme-toggle-switch",children:[p.jsx("input",{type:"checkbox",defaultChecked:!0,onChange:()=>{}}),p.jsx("span",{className:"slider round"})]})]})]}),p.jsx("div",{className:"settings-section-header",children:"알림 권한"}),p.jsxs("div",{className:"settings-section-body",children:[p.jsx("button",{className:"settings-item action-item",onClick:async()=>{await Zx()?(D("알림 권한이 허용되었습니다."),await eR()):D("알림 권한을 거부했습니다.")},children:p.jsx("span",{className:"action-text",children:"알림 권한 요청"})}),p.jsxs("div",{style:{fontSize:"12px",opacity:.7,padding:"12px",marginTop:"8px"},children:["현재 권한: ",Notification.permission==="granted"?"✓ 허용됨":Notification.permission==="denied"?"✗ 거부됨":"? 미정"]})]})]});case"general":return p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"settings-section-header",children:T("settings_language")}),p.jsxs("div",{className:"settings-section-body",children:[p.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>v("ko"),children:[p.jsx("span",{children:"한국어"}),g==="ko"&&Se.check]}),p.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>v("en"),children:[p.jsx("span",{children:"English"}),g==="en"&&Se.check]})]}),p.jsx("div",{className:"settings-section-header",children:T("settings_api_key")}),p.jsxs("div",{className:"settings-section-body",children:[p.jsx("div",{className:"settings-item",children:p.jsx("input",{type:"password",placeholder:T("settings_api_key_placeholder"),value:P,onChange:qe=>V(qe.target.value),style:{width:"100%",padding:"8px",border:"1px solid var(--border-color)",borderRadius:"4px",backgroundColor:"var(--input-bg)"}})}),p.jsxs("label",{className:"settings-item",children:[p.jsxs("div",{children:[p.jsx("span",{children:T("settings_offline_mode")}),p.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:T("settings_offline_mode_desc")})]}),p.jsxs("div",{className:"theme-toggle-switch",children:[p.jsx("input",{type:"checkbox",checked:U,onChange:O}),p.jsx("span",{className:"slider round"})]})]})]}),p.jsx("div",{className:"settings-section-header",children:T("settings_section_info")}),p.jsxs("div",{className:"settings-section-body",children:[p.jsxs("div",{className:"settings-item nav-indicator",onClick:S,children:[p.jsx("span",{children:T("settings_version")}),p.jsxs("div",{className:"settings-item-value-with-icon",children:[p.jsx("span",{children:"1.5"}),Se.forward]})]}),p.jsxs("div",{className:"settings-item nav-indicator",onClick:I,children:[p.jsx("span",{children:T("usage_guide_title")}),p.jsx("div",{className:"settings-item-value-with-icon",children:Se.forward})]}),p.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>{Mn(`이것은 매우 긴 알림 메시지입니다.

이 메시지는 여러 줄에 걸쳐 작성되었으며, 알림 팝업이 내용에 맞게 세로로 확장되는지 테스트하기 위한 목적으로 만들어졌습니다.

줄바꿈 문자도 포함되어 있고,
여러 문단으로 구성되어 있습니다.

이런 식으로 긴 에러 메시지나 안내 메시지가 표시될 때도 팝업이 적절하게 크기 조정이 되어야 합니다.

스크롤이 필요할 정도로 매우 긴 내용일 때는 스크롤바가 나타나야 하고, 버튼 영역은 항상 하단에 고정되어 있어야 합니다.`)},children:[p.jsx("span",{children:T("test_long_alert")}),p.jsxs("div",{className:"settings-item-value-with-icon",children:[p.jsx("span",{children:T("test_long_alert_desc")}),Se.forward]})]}),p.jsxs("div",{className:"settings-item",children:[p.jsx("span",{children:T("settings_developer")}),p.jsx("span",{className:"settings-item-value",children:T("developer_name")})]}),p.jsxs("div",{className:"settings-item",children:[p.jsx("span",{children:T("settings_copyright")}),p.jsx("span",{className:"settings-item-value",children:T("copyright_notice")})]})]})]});case"data":return p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"settings-section-header",children:"계정"}),p.jsx("div",{className:"settings-section-body",children:E?p.jsxs("div",{children:[p.jsxs("div",{className:"settings-item",children:[p.jsxs("div",{children:[p.jsx("span",{children:"Google 계정"}),p.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:E.email}),p.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:E.displayName})]}),p.jsx("span",{style:{color:"var(--success-color, #4CAF50)"},children:"✓"})]}),p.jsx("button",{className:"settings-item action-item",onClick:C,disabled:N,style:{opacity:N?.6:1},children:p.jsx("span",{className:"action-text",children:N?"⏳ 로그아웃 중...":"로그아웃"})})]}):p.jsxs("div",{children:[p.jsx("div",{style:{display:"flex",justifyContent:"center",padding:"12px 0"},children:p.jsxs("button",{onClick:w,disabled:L,style:{backgroundColor:L?"#E0E0E0":"white",border:"1px solid #D3D3D3",borderRadius:"24px",padding:"8px 20px",fontSize:"14px",fontWeight:"500",cursor:L?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"8px",color:L?"#999999":"#1F2937",transition:"all 0.2s",opacity:L?.6:1},children:[p.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",children:[p.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),p.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),p.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),p.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),L?"로그인 중...":"Google로 로그인"]})}),p.jsx("div",{style:{display:"flex",justifyContent:"center",padding:"8px 0"},children:p.jsx("button",{onClick:ne,style:{backgroundColor:"transparent",border:"1px solid #D3D3D3",borderRadius:"16px",padding:"4px 12px",fontSize:"12px",color:"#666",cursor:"pointer"},children:"🔍 로그인 문제 진단"})})]})}),E&&p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"settings-section-header",children:"클라우드 동기화"}),p.jsxs("div",{className:"settings-section-body",children:[p.jsx("button",{className:"settings-item action-item",onClick:k,disabled:De,children:p.jsx("span",{className:"action-text",children:De?"저장중...":"클라우드에 저장"})}),p.jsx("button",{className:"settings-item action-item",onClick:b,disabled:Fe,children:p.jsx("span",{className:"action-text",children:Fe?"로드중...":"클라우드에서 불러오기"})}),p.jsxs("label",{className:"settings-item",children:[p.jsxs("div",{children:[p.jsx("span",{children:"자동 동기화"}),p.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:"목표 변경 시 자동으로 저장"})]}),p.jsxs("div",{className:"theme-toggle-switch",children:[p.jsx("input",{type:"checkbox",checked:We,onChange:qe=>Ee(qe.target.checked)}),p.jsx("span",{className:"slider round"})]})]})]})]}),p.jsx("div",{className:"settings-section-header",children:T("settings_data_header")}),p.jsxs("div",{className:"settings-section-body",children:[p.jsx("div",{style:{fontSize:"12px",opacity:.7,marginBottom:"12px",padding:"8px",backgroundColor:"var(--bg-color-secondary)",borderRadius:"8px"},children:T("settings_data_header_desc")}),p.jsx("button",{className:"settings-item action-item",onClick:a,disabled:m!=="idle",children:p.jsx("span",{className:"action-text",children:T(m==="exporting"?"data_exporting":"settings_export_data")})}),p.jsxs("button",{className:"settings-item action-item",onClick:()=>{var qe;return(qe=cr.current)==null?void 0:qe.click()},disabled:m!=="idle",children:[p.jsx("span",{className:"action-text",children:T(m==="importing"?"data_importing":"settings_import_data")}),p.jsx("input",{type:"file",ref:cr,onChange:l,accept:".json",style:{display:"none"}})]})]}),A.length>0&&p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"settings-section-header",children:T("settings_share_link_header")}),p.jsxs("div",{className:"settings-section-body",children:[!$e&&p.jsx("button",{className:"settings-item action-item",onClick:Pr,disabled:Mt,children:p.jsx("span",{className:"action-text",children:Mt?"단축 URL 생성 중...":T("settings_generate_link")})}),$e&&p.jsxs("div",{className:"share-link-container",children:[p.jsxs("div",{style:{marginBottom:"8px",fontSize:"12px",opacity:.7},children:[$e.length<100?"단축 URL":"일반 링크"," (",$e.length,"자)"]}),p.jsx("input",{type:"text",readOnly:!0,value:$e,onClick:qe=>qe.target.select()}),p.jsx("button",{onClick:Me,children:T("settings_copy_link")})]})]})]}),p.jsx("div",{className:"settings-section-header",children:T("settings_section_info")}),p.jsxs("div",{className:"settings-section-body",children:[p.jsxs("div",{className:"settings-item nav-indicator",onClick:S,children:[p.jsx("span",{children:T("settings_version")}),p.jsxs("div",{className:"settings-item-value-with-icon",children:[p.jsx("span",{children:"1.5"}),Se.forward]})]}),p.jsxs("div",{className:"settings-item nav-indicator",onClick:I,children:[p.jsx("span",{children:T("usage_guide_title")}),p.jsx("div",{className:"settings-item-value-with-icon",children:Se.forward})]}),p.jsxs("div",{className:"settings-item",children:[p.jsx("span",{children:T("settings_developer")}),p.jsx("span",{className:"settings-item-value",children:T("developer_name")})]}),p.jsxs("div",{className:"settings-item",children:[p.jsx("span",{children:T("settings_copyright")}),p.jsx("span",{className:"settings-item-value",children:T("copyright_notice")})]})]}),p.jsx("div",{className:"settings-section-header",children:T("settings_delete_account")}),p.jsx("div",{className:"settings-section-body",children:p.jsx("button",{className:"settings-item action-item",onClick:dn,disabled:m!=="idle",children:p.jsx("span",{className:"action-text destructive",children:T(m==="deleting"?"data_deleting":"settings_delete_account")})})})]});default:return null}};return p.jsxs(ho,{onClose:ye,isClosing:ce,className:"settings-modal",size:ge,children:[p.jsxs("div",{className:"settings-modal-header",children:[p.jsx("h2",{children:T("settings_title")}),p.jsx("div",{className:"settings-modal-header-right",children:p.jsx("button",{onClick:ye,className:"close-button",children:Se.close})})]}),p.jsxs("div",{className:"settings-modal-body",children:[p.jsx("div",{className:"settings-tabs",children:dr.map(qe=>p.jsxs("button",{className:`settings-tab-button ${we===qe.id?"active":""}`,onClick:()=>Pe(qe.id),"aria-label":qe.label,children:[p.jsx("div",{className:"settings-tab-icon",children:qe.icon}),p.jsx("span",{children:qe.label})]},qe.id))}),p.jsx("div",{className:"settings-tab-content-container",children:p.jsx("div",{className:"settings-tab-content",children:At()},we)})]}),Tn&&p.jsx("div",{className:"modal-backdrop alert-backdrop",children:p.jsxs("div",{className:"modal-content alert-modal",children:[p.jsxs("div",{className:"alert-content",children:[p.jsx("h2",{children:"알림"}),p.jsx("p",{children:Tn})]}),p.jsx("div",{className:"modal-buttons",children:p.jsx("button",{onClick:()=>Mn(null),className:"primary",children:"확인"})})]})})]})},YI=({onClose:t,t:e})=>{const[n,r]=Ga(t),i="2.0.0 (25.10.24)",s=[{icon:"🔔",title:"미리알림 관리",desc:"Step-by-step 미리알림 추가. 제목, 기한(선택), 시간(선택), 반복 설정, 설명, 활성화 여부"},{icon:"📅",title:"유연한 날짜/시간 설정",desc:"기한 없음, 시간 없음 옵션으로 필요한 정보만 선택적 입력 가능"},{icon:"🎯",title:"WOOP 목표 설정",desc:"5단계 마법사 (Wish → Outcome → Obstacle → Plan → 기한/반복)로 구조화된 목표 계획"},{icon:"🤖",title:"AI 코치 피드백",desc:"Gemini API 기반 각 단계별 실시간 AI 피드백으로 목표 개선"},{icon:"🔐",title:"Google 로그인",desc:"Google OAuth 인증으로 보안 강화 및 계정 관리"},{icon:"☁️",title:"Firebase 클라우드 동기화",desc:"목표, 설정, 미리알림 등 모든 데이터 Firebase Firestore에 자동 저장"},{icon:"🔄",title:"자동 동기화 제어",desc:"켜고 끄기 옵션으로 클라우드 자동 동기화 제어 가능"},{icon:"🌙",title:"다크 모드 & 테마",desc:"시스템/라이트/다크 모드 자동 감지 및 8가지 배경 테마 지원"},{icon:"📱",title:"PWA & 오프라인",desc:"모바일 PWA 자동 설치 배너, 오프라인 모드, 푸시 알림 지원"},{icon:"🗓️",title:"달력 보기",desc:"3일/주간/월간 달력 뷰로 목표 스케줄링 및 시각화"},{icon:"📤",title:"데이터 내보내기/가져오기",desc:"JSON 형식으로 모든 데이터 로컬 저장 및 복원"},{icon:"🌍",title:"다국어 지원",desc:"한국어, 영어 등 다국어 인터페이스 지원"}];return p.jsxs(ho,{onClose:r,isClosing:n,className:"version-info-modal",children:[p.jsxs("div",{className:"version-info-header",children:[p.jsx("h2",{children:"🧪 Nova AI Planner v2.0 Beta"}),p.jsxs("p",{children:[e("build_number"),": ",i]})]}),p.jsx("div",{className:"version-info-body",children:s.map((o,a)=>p.jsxs("div",{className:"changelog-item",children:[p.jsx("div",{className:"changelog-icon",style:{"--icon-bg":"var(--primary-color)"},children:o.icon}),p.jsxs("div",{className:"changelog-text",children:[p.jsx("h3",{children:o.title}),p.jsx("p",{children:o.desc})]})]},a))}),p.jsx("div",{className:"modal-buttons",children:p.jsx("button",{onClick:r,className:"primary",children:e("settings_done_button")})})]})},B6=({onClose:t,t:e})=>{const[n,r]=Ga(t),i=o=>{const a=/(https?:\/\/[^\s]+)/g;return o.split(a).map((u,f)=>a.test(u)?p.jsx("a",{href:u,target:"_blank",rel:"noopener noreferrer",className:"guide-link",children:u},f):u)},s=[{titleKey:"usage_basic_title",descKey:"usage_basic_desc"},{titleKey:"usage_ai_setup_title",descKey:"usage_ai_setup_desc"},{titleKey:"usage_ai_use_title",descKey:"usage_ai_use_desc"},{titleKey:"usage_share_title",descKey:"usage_share_desc"},{titleKey:"usage_theme_title",descKey:"usage_theme_desc"},{titleKey:"usage_calendar_title",descKey:"usage_calendar_desc"},{titleKey:"usage_offline_title",descKey:"usage_offline_desc"}];return p.jsxs(ho,{onClose:r,isClosing:n,className:"usage-guide-modal",children:[p.jsx("div",{className:"version-info-header",children:p.jsx("h2",{children:e("usage_guide_title")})}),p.jsx("div",{className:"version-info-body",children:s.map((o,a)=>p.jsxs("div",{className:"usage-guide-item",children:[p.jsx("h3",{children:e(o.titleKey)}),p.jsx("p",{children:o.titleKey==="usage_ai_setup_title"?i(e(o.descKey)):e(o.descKey)})]},a))}),p.jsx("div",{className:"modal-buttons",children:p.jsx("button",{onClick:r,className:"primary",children:e("settings_done_button")})})]})},q6=({todos:t,t:e,onGoalClick:n,language:r})=>{const[i,s]=z.useState(new Date),[o,a]=z.useState("week"),l=g=>{const v=new Date(i);o==="month"?v.setMonth(v.getMonth()+g):o==="week"?v.setDate(v.getDate()+g*7):v.setDate(v.getDate()+g*3),s(v)},u=z.useMemo(()=>{const g=[];let v,T;if(o==="month"){const A=new Date(i.getFullYear(),i.getMonth(),1);v=WI(A,r==="ko"?1:0),T=42}else o==="week"?(v=WI(i,r==="ko"?1:0),T=7):(v=new Date(i),v.setDate(v.getDate()-1),T=3);for(let A=0;A<T;A++){const D=new Date(v);D.setDate(D.getDate()+A),g.push(D)}return g},[i,o,r]),f=z.useMemo(()=>{if(o==="month"){const g=i.getFullYear(),v=e("month_names")[i.getMonth()],T=e("calendar_header_month_format");return T&&typeof T=="string"&&T!=="calendar_header_month_format"?T.replace("{year}",String(g)).replace("{month}",v):`${v} ${g}`}return`${i.getFullYear()}.${i.getMonth()+1}`},[i,o,e]),m=z.useMemo(()=>{const g=e("day_names_short");if(r==="ko"&&Array.isArray(g)){const[v,...T]=g;return[...T,v]}return g},[r,e]);return p.jsxs("div",{className:"calendar-view-container",children:[p.jsxs("div",{className:"calendar-header",children:[p.jsx("button",{onClick:()=>l(-1),children:Se.back}),p.jsx("h2",{children:f}),p.jsx("button",{onClick:()=>l(1),children:Se.forward})]}),p.jsxs("div",{className:"calendar-view-mode-selector",children:[p.jsx("button",{onClick:()=>a("day3"),className:o==="day3"?"active":"",children:e("calendar_view_day3")}),p.jsx("button",{onClick:()=>a("week"),className:o==="week"?"active":"",children:e("calendar_view_week")}),p.jsx("button",{onClick:()=>a("month"),className:`calendar-view-button-month ${o==="month"?"active":""}`,children:e("calendar_view_month")})]}),(o==="week"||o==="month")&&p.jsx("div",{className:"calendar-days-of-week",children:Array.isArray(m)&&m.map(g=>p.jsx("div",{children:g},g))}),p.jsx("div",{className:`calendar-grid view-mode-${o}`,children:u.map(g=>{const T=nu(g,new Date),A=g.getMonth()===i.getMonth(),D=t.filter(S=>{if(S.isRecurring){const I=(g.getDay()+6)%7;return S.recurringDays.includes(I)}return S.deadline&&nu(g,S.deadline)});return p.jsxs("div",{className:`calendar-day ${!A&&o==="month"?"not-current-month":""} ${T?"is-today":""}`,"data-day-name":e("day_names_long")[g.getDay()],children:[p.jsx("div",{className:"day-header",children:p.jsx("span",{className:"day-number",children:g.getDate()})}),p.jsx("div",{className:"calendar-goals",children:D.map(S=>p.jsx("div",{className:`calendar-goal-item ${S.completed&&S.lastCompletedDate&&nu(g,S.lastCompletedDate)?"completed":""}`,onClick:()=>n(S),children:S.wish},S.id))})]},g.toISOString())})})]})},G6=({title:t,message:e,onConfirm:n,onCancel:r,confirmText:i,cancelText:s,isDestructive:o,t:a})=>{const l=typeof r=="function";return p.jsx("div",{className:"modal-backdrop alert-backdrop",children:p.jsxs("div",{className:"modal-content alert-modal",children:[p.jsxs("div",{className:"alert-content",children:[p.jsx("h2",{children:t}),p.jsx("p",{dangerouslySetInnerHTML:{__html:e}})]}),p.jsxs("div",{className:"modal-buttons",children:[l&&p.jsx("button",{onClick:r,className:"secondary",children:s||a("cancel_button")}),p.jsx("button",{onClick:n,className:o?"destructive":"primary",children:i||a("confirm_button")})]})]})})},z6=yp.createRoot(document.getElementById("root"));z6.render(p.jsx(lw.StrictMode,{children:p.jsx(k6,{})}));
