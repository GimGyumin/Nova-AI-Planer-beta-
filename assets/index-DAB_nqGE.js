(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();const nR="modulepreload",rR=function(t){return"/Nova-1.0/"+t},Iy={},Vs=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(n.map(l=>{if(l=rR(l),l in Iy)return;Iy[l]=!0;const u=l.endsWith(".css"),f=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${f}`))return;const m=document.createElement("link");if(m.rel=u?"stylesheet":nR,u||(m.as="script"),m.crossOrigin="",m.href=l,a&&m.setAttribute("nonce",a),document.head.appendChild(m),u)return new Promise((g,v)=>{m.addEventListener("load",g),m.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return i.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return e().catch(s)})};function iR(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var eI={exports:{}},Mh={},tI={exports:{}},be={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bu=Symbol.for("react.element"),sR=Symbol.for("react.portal"),oR=Symbol.for("react.fragment"),aR=Symbol.for("react.strict_mode"),lR=Symbol.for("react.profiler"),uR=Symbol.for("react.provider"),cR=Symbol.for("react.context"),dR=Symbol.for("react.forward_ref"),hR=Symbol.for("react.suspense"),fR=Symbol.for("react.memo"),pR=Symbol.for("react.lazy"),Sy=Symbol.iterator;function mR(t){return t===null||typeof t!="object"?null:(t=Sy&&t[Sy]||t["@@iterator"],typeof t=="function"?t:null)}var nI={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},rI=Object.assign,iI={};function ja(t,e,n){this.props=t,this.context=e,this.refs=iI,this.updater=n||nI}ja.prototype.isReactComponent={};ja.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};ja.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function sI(){}sI.prototype=ja.prototype;function yg(t,e,n){this.props=t,this.context=e,this.refs=iI,this.updater=n||nI}var vg=yg.prototype=new sI;vg.constructor=yg;rI(vg,ja.prototype);vg.isPureReactComponent=!0;var Cy=Array.isArray,oI=Object.prototype.hasOwnProperty,Tg={current:null},aI={key:!0,ref:!0,__self:!0,__source:!0};function lI(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)oI.call(e,r)&&!aI.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];i.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:Bu,type:t,key:s,ref:o,props:i,_owner:Tg.current}}function gR(t,e){return{$$typeof:Bu,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Eg(t){return typeof t=="object"&&t!==null&&t.$$typeof===Bu}function _R(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var xy=/\/+/g;function Gf(t,e){return typeof t=="object"&&t!==null&&t.key!=null?_R(""+t.key):e.toString(36)}function od(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Bu:case sR:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+Gf(o,0):r,Cy(i)?(n="",t!=null&&(n=t.replace(xy,"$&/")+"/"),od(i,e,n,"",function(u){return u})):i!=null&&(Eg(i)&&(i=gR(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(xy,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",Cy(t))for(var a=0;a<t.length;a++){s=t[a];var l=r+Gf(s,a);o+=od(s,e,n,l,i)}else if(l=mR(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=r+Gf(s,a++),o+=od(s,e,n,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Vc(t,e,n){if(t==null)return t;var r=[],i=0;return od(t,r,"","",function(s){return e.call(n,s,i++)}),r}function yR(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var dn={current:null},ad={transition:null},vR={ReactCurrentDispatcher:dn,ReactCurrentBatchConfig:ad,ReactCurrentOwner:Tg};function uI(){throw Error("act(...) is not supported in production builds of React.")}be.Children={map:Vc,forEach:function(t,e,n){Vc(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Vc(t,function(){e++}),e},toArray:function(t){return Vc(t,function(e){return e})||[]},only:function(t){if(!Eg(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};be.Component=ja;be.Fragment=oR;be.Profiler=lR;be.PureComponent=yg;be.StrictMode=aR;be.Suspense=hR;be.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=vR;be.act=uI;be.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=rI({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=Tg.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)oI.call(e,l)&&!aI.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];r.children=a}return{$$typeof:Bu,type:t.type,key:i,ref:s,props:r,_owner:o}};be.createContext=function(t){return t={$$typeof:cR,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:uR,_context:t},t.Consumer=t};be.createElement=lI;be.createFactory=function(t){var e=lI.bind(null,t);return e.type=t,e};be.createRef=function(){return{current:null}};be.forwardRef=function(t){return{$$typeof:dR,render:t}};be.isValidElement=Eg;be.lazy=function(t){return{$$typeof:pR,_payload:{_status:-1,_result:t},_init:yR}};be.memo=function(t,e){return{$$typeof:fR,type:t,compare:e===void 0?null:e}};be.startTransition=function(t){var e=ad.transition;ad.transition={};try{t()}finally{ad.transition=e}};be.unstable_act=uI;be.useCallback=function(t,e){return dn.current.useCallback(t,e)};be.useContext=function(t){return dn.current.useContext(t)};be.useDebugValue=function(){};be.useDeferredValue=function(t){return dn.current.useDeferredValue(t)};be.useEffect=function(t,e){return dn.current.useEffect(t,e)};be.useId=function(){return dn.current.useId()};be.useImperativeHandle=function(t,e,n){return dn.current.useImperativeHandle(t,e,n)};be.useInsertionEffect=function(t,e){return dn.current.useInsertionEffect(t,e)};be.useLayoutEffect=function(t,e){return dn.current.useLayoutEffect(t,e)};be.useMemo=function(t,e){return dn.current.useMemo(t,e)};be.useReducer=function(t,e,n){return dn.current.useReducer(t,e,n)};be.useRef=function(t){return dn.current.useRef(t)};be.useState=function(t){return dn.current.useState(t)};be.useSyncExternalStore=function(t,e,n){return dn.current.useSyncExternalStore(t,e,n)};be.useTransition=function(){return dn.current.useTransition()};be.version="18.3.1";tI.exports=be;var O=tI.exports;const cI=iR(O);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var TR=O,ER=Symbol.for("react.element"),wR=Symbol.for("react.fragment"),IR=Object.prototype.hasOwnProperty,SR=TR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,CR={key:!0,ref:!0,__self:!0,__source:!0};function dI(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)IR.call(e,r)&&!CR.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:ER,type:t,key:s,ref:o,props:i,_owner:SR.current}}Mh.Fragment=wR;Mh.jsx=dI;Mh.jsxs=dI;eI.exports=Mh;var p=eI.exports,Np={},hI={exports:{}},Dn={},fI={exports:{}},pI={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(ee,fe){var me=ee.length;ee.push(fe);e:for(;0<me;){var Pe=me-1>>>1,Oe=ee[Pe];if(0<i(Oe,fe))ee[Pe]=fe,ee[me]=Oe,me=Pe;else break e}}function n(ee){return ee.length===0?null:ee[0]}function r(ee){if(ee.length===0)return null;var fe=ee[0],me=ee.pop();if(me!==fe){ee[0]=me;e:for(var Pe=0,Oe=ee.length,Vt=Oe>>>1;Pe<Vt;){var Fe=2*(Pe+1)-1,Lt=ee[Fe],ke=Fe+1,ze=ee[ke];if(0>i(Lt,me))ke<Oe&&0>i(ze,Lt)?(ee[Pe]=ze,ee[ke]=me,Pe=ke):(ee[Pe]=Lt,ee[Fe]=me,Pe=Fe);else if(ke<Oe&&0>i(ze,me))ee[Pe]=ze,ee[ke]=me,Pe=ke;else break e}}return fe}function i(ee,fe){var me=ee.sortIndex-fe.sortIndex;return me!==0?me:ee.id-fe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],u=[],f=1,m=null,g=3,v=!1,T=!1,P=!1,M=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function A(ee){for(var fe=n(u);fe!==null;){if(fe.callback===null)r(u);else if(fe.startTime<=ee)r(u),fe.sortIndex=fe.expirationTime,e(l,fe);else break;fe=n(u)}}function V(ee){if(P=!1,A(ee),!T)if(n(l)!==null)T=!0,Ge(B);else{var fe=n(u);fe!==null&&Se(V,fe.startTime-ee)}}function B(ee,fe){T=!1,P&&(P=!1,x(S),S=-1),v=!0;var me=g;try{for(A(fe),m=n(l);m!==null&&(!(m.expirationTime>fe)||ee&&!D());){var Pe=m.callback;if(typeof Pe=="function"){m.callback=null,g=m.priorityLevel;var Oe=Pe(m.expirationTime<=fe);fe=t.unstable_now(),typeof Oe=="function"?m.callback=Oe:m===n(l)&&r(l),A(fe)}else r(l);m=n(l)}if(m!==null)var Vt=!0;else{var Fe=n(u);Fe!==null&&Se(V,Fe.startTime-fe),Vt=!1}return Vt}finally{m=null,g=me,v=!1}}var G=!1,I=null,S=-1,R=5,N=-1;function D(){return!(t.unstable_now()-N<R)}function L(){if(I!==null){var ee=t.unstable_now();N=ee;var fe=!0;try{fe=I(!0,ee)}finally{fe?b():(G=!1,I=null)}}else G=!1}var b;if(typeof E=="function")b=function(){E(L)};else if(typeof MessageChannel<"u"){var Re=new MessageChannel,Ze=Re.port2;Re.port1.onmessage=L,b=function(){Ze.postMessage(null)}}else b=function(){M(L,0)};function Ge(ee){I=ee,G||(G=!0,b())}function Se(ee,fe){S=M(function(){ee(t.unstable_now())},fe)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ee){ee.callback=null},t.unstable_continueExecution=function(){T||v||(T=!0,Ge(B))},t.unstable_forceFrameRate=function(ee){0>ee||125<ee?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<ee?Math.floor(1e3/ee):5},t.unstable_getCurrentPriorityLevel=function(){return g},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(ee){switch(g){case 1:case 2:case 3:var fe=3;break;default:fe=g}var me=g;g=fe;try{return ee()}finally{g=me}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(ee,fe){switch(ee){case 1:case 2:case 3:case 4:case 5:break;default:ee=3}var me=g;g=ee;try{return fe()}finally{g=me}},t.unstable_scheduleCallback=function(ee,fe,me){var Pe=t.unstable_now();switch(typeof me=="object"&&me!==null?(me=me.delay,me=typeof me=="number"&&0<me?Pe+me:Pe):me=Pe,ee){case 1:var Oe=-1;break;case 2:Oe=250;break;case 5:Oe=1073741823;break;case 4:Oe=1e4;break;default:Oe=5e3}return Oe=me+Oe,ee={id:f++,callback:fe,priorityLevel:ee,startTime:me,expirationTime:Oe,sortIndex:-1},me>Pe?(ee.sortIndex=me,e(u,ee),n(l)===null&&ee===n(u)&&(P?(x(S),S=-1):P=!0,Se(V,me-Pe))):(ee.sortIndex=Oe,e(l,ee),T||v||(T=!0,Ge(B))),ee},t.unstable_shouldYield=D,t.unstable_wrapCallback=function(ee){var fe=g;return function(){var me=g;g=fe;try{return ee.apply(this,arguments)}finally{g=me}}}})(pI);fI.exports=pI;var xR=fI.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var AR=O,Nn=xR;function ne(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var mI=new Set,uu={};function To(t,e){wa(t,e),wa(t+"Capture",e)}function wa(t,e){for(uu[t]=e,t=0;t<e.length;t++)mI.add(e[t])}var Zr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),bp=Object.prototype.hasOwnProperty,RR=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Ay={},Ry={};function PR(t){return bp.call(Ry,t)?!0:bp.call(Ay,t)?!1:RR.test(t)?Ry[t]=!0:(Ay[t]=!0,!1)}function kR(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function NR(t,e,n,r){if(e===null||typeof e>"u"||kR(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function hn(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Kt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Kt[t]=new hn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Kt[e]=new hn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Kt[t]=new hn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Kt[t]=new hn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Kt[t]=new hn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Kt[t]=new hn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Kt[t]=new hn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Kt[t]=new hn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Kt[t]=new hn(t,5,!1,t.toLowerCase(),null,!1,!1)});var wg=/[\-:]([a-z])/g;function Ig(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(wg,Ig);Kt[e]=new hn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(wg,Ig);Kt[e]=new hn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(wg,Ig);Kt[e]=new hn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Kt[t]=new hn(t,1,!1,t.toLowerCase(),null,!1,!1)});Kt.xlinkHref=new hn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Kt[t]=new hn(t,1,!1,t.toLowerCase(),null,!0,!0)});function Sg(t,e,n,r){var i=Kt.hasOwnProperty(e)?Kt[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(NR(e,n,i,r)&&(n=null),r||i===null?PR(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var ai=AR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Lc=Symbol.for("react.element"),Jo=Symbol.for("react.portal"),Qo=Symbol.for("react.fragment"),Cg=Symbol.for("react.strict_mode"),Dp=Symbol.for("react.profiler"),gI=Symbol.for("react.provider"),_I=Symbol.for("react.context"),xg=Symbol.for("react.forward_ref"),Mp=Symbol.for("react.suspense"),Vp=Symbol.for("react.suspense_list"),Ag=Symbol.for("react.memo"),ki=Symbol.for("react.lazy"),yI=Symbol.for("react.offscreen"),Py=Symbol.iterator;function _l(t){return t===null||typeof t!="object"?null:(t=Py&&t[Py]||t["@@iterator"],typeof t=="function"?t:null)}var gt=Object.assign,qf;function Nl(t){if(qf===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);qf=e&&e[1]||""}return`
`+qf+t}var zf=!1;function $f(t,e){if(!t||zf)return"";zf=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{zf=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Nl(t):""}function bR(t){switch(t.tag){case 5:return Nl(t.type);case 16:return Nl("Lazy");case 13:return Nl("Suspense");case 19:return Nl("SuspenseList");case 0:case 2:case 15:return t=$f(t.type,!1),t;case 11:return t=$f(t.type.render,!1),t;case 1:return t=$f(t.type,!0),t;default:return""}}function Lp(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Qo:return"Fragment";case Jo:return"Portal";case Dp:return"Profiler";case Cg:return"StrictMode";case Mp:return"Suspense";case Vp:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case _I:return(t.displayName||"Context")+".Consumer";case gI:return(t._context.displayName||"Context")+".Provider";case xg:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Ag:return e=t.displayName||null,e!==null?e:Lp(t.type)||"Memo";case ki:e=t._payload,t=t._init;try{return Lp(t(e))}catch{}}return null}function DR(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Lp(e);case 8:return e===Cg?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function ns(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function vI(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function MR(t){var e=vI(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Fc(t){t._valueTracker||(t._valueTracker=MR(t))}function TI(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=vI(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Vd(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Fp(t,e){var n=e.checked;return gt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function ky(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=ns(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function EI(t,e){e=e.checked,e!=null&&Sg(t,"checked",e,!1)}function Up(t,e){EI(t,e);var n=ns(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Op(t,e.type,n):e.hasOwnProperty("defaultValue")&&Op(t,e.type,ns(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Ny(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Op(t,e,n){(e!=="number"||Vd(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var bl=Array.isArray;function ua(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+ns(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Bp(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ne(91));return gt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function by(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(ne(92));if(bl(n)){if(1<n.length)throw Error(ne(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:ns(n)}}function wI(t,e){var n=ns(e.value),r=ns(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Dy(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function II(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Gp(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?II(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Uc,SI=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Uc=Uc||document.createElement("div"),Uc.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Uc.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function cu(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Gl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},VR=["Webkit","ms","Moz","O"];Object.keys(Gl).forEach(function(t){VR.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Gl[e]=Gl[t]})});function CI(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Gl.hasOwnProperty(t)&&Gl[t]?(""+e).trim():e+"px"}function xI(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=CI(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var LR=gt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function qp(t,e){if(e){if(LR[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ne(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ne(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ne(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ne(62))}}function zp(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var $p=null;function Rg(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Hp=null,ca=null,da=null;function My(t){if(t=zu(t)){if(typeof Hp!="function")throw Error(ne(280));var e=t.stateNode;e&&(e=Oh(e),Hp(t.stateNode,t.type,e))}}function AI(t){ca?da?da.push(t):da=[t]:ca=t}function RI(){if(ca){var t=ca,e=da;if(da=ca=null,My(t),e)for(t=0;t<e.length;t++)My(e[t])}}function PI(t,e){return t(e)}function kI(){}var Hf=!1;function NI(t,e,n){if(Hf)return t(e,n);Hf=!0;try{return PI(t,e,n)}finally{Hf=!1,(ca!==null||da!==null)&&(kI(),RI())}}function du(t,e){var n=t.stateNode;if(n===null)return null;var r=Oh(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(ne(231,e,typeof n));return n}var jp=!1;if(Zr)try{var yl={};Object.defineProperty(yl,"passive",{get:function(){jp=!0}}),window.addEventListener("test",yl,yl),window.removeEventListener("test",yl,yl)}catch{jp=!1}function FR(t,e,n,r,i,s,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(f){this.onError(f)}}var ql=!1,Ld=null,Fd=!1,Wp=null,UR={onError:function(t){ql=!0,Ld=t}};function OR(t,e,n,r,i,s,o,a,l){ql=!1,Ld=null,FR.apply(UR,arguments)}function BR(t,e,n,r,i,s,o,a,l){if(OR.apply(this,arguments),ql){if(ql){var u=Ld;ql=!1,Ld=null}else throw Error(ne(198));Fd||(Fd=!0,Wp=u)}}function Eo(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function bI(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Vy(t){if(Eo(t)!==t)throw Error(ne(188))}function GR(t){var e=t.alternate;if(!e){if(e=Eo(t),e===null)throw Error(ne(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return Vy(i),t;if(s===r)return Vy(i),e;s=s.sibling}throw Error(ne(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(ne(189))}}if(n.alternate!==r)throw Error(ne(190))}if(n.tag!==3)throw Error(ne(188));return n.stateNode.current===n?t:e}function DI(t){return t=GR(t),t!==null?MI(t):null}function MI(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=MI(t);if(e!==null)return e;t=t.sibling}return null}var VI=Nn.unstable_scheduleCallback,Ly=Nn.unstable_cancelCallback,qR=Nn.unstable_shouldYield,zR=Nn.unstable_requestPaint,wt=Nn.unstable_now,$R=Nn.unstable_getCurrentPriorityLevel,Pg=Nn.unstable_ImmediatePriority,LI=Nn.unstable_UserBlockingPriority,Ud=Nn.unstable_NormalPriority,HR=Nn.unstable_LowPriority,FI=Nn.unstable_IdlePriority,Vh=null,Ar=null;function jR(t){if(Ar&&typeof Ar.onCommitFiberRoot=="function")try{Ar.onCommitFiberRoot(Vh,t,void 0,(t.current.flags&128)===128)}catch{}}var or=Math.clz32?Math.clz32:JR,WR=Math.log,KR=Math.LN2;function JR(t){return t>>>=0,t===0?32:31-(WR(t)/KR|0)|0}var Oc=64,Bc=4194304;function Dl(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Od(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=Dl(a):(s&=o,s!==0&&(r=Dl(s)))}else o=n&~i,o!==0?r=Dl(o):s!==0&&(r=Dl(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-or(e),i=1<<n,r|=t[n],e&=~i;return r}function QR(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function YR(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-or(s),a=1<<o,l=i[o];l===-1?(!(a&n)||a&r)&&(i[o]=QR(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function Kp(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function UI(){var t=Oc;return Oc<<=1,!(Oc&4194240)&&(Oc=64),t}function jf(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Gu(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-or(e),t[e]=n}function XR(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-or(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function kg(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-or(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var Ye=0;function OI(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var BI,Ng,GI,qI,zI,Jp=!1,Gc=[],Gi=null,qi=null,zi=null,hu=new Map,fu=new Map,bi=[],ZR="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Fy(t,e){switch(t){case"focusin":case"focusout":Gi=null;break;case"dragenter":case"dragleave":qi=null;break;case"mouseover":case"mouseout":zi=null;break;case"pointerover":case"pointerout":hu.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":fu.delete(e.pointerId)}}function vl(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=zu(e),e!==null&&Ng(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function eP(t,e,n,r,i){switch(e){case"focusin":return Gi=vl(Gi,t,e,n,r,i),!0;case"dragenter":return qi=vl(qi,t,e,n,r,i),!0;case"mouseover":return zi=vl(zi,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return hu.set(s,vl(hu.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,fu.set(s,vl(fu.get(s)||null,t,e,n,r,i)),!0}return!1}function $I(t){var e=Ks(t.target);if(e!==null){var n=Eo(e);if(n!==null){if(e=n.tag,e===13){if(e=bI(n),e!==null){t.blockedOn=e,zI(t.priority,function(){GI(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function ld(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Qp(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);$p=r,n.target.dispatchEvent(r),$p=null}else return e=zu(n),e!==null&&Ng(e),t.blockedOn=n,!1;e.shift()}return!0}function Uy(t,e,n){ld(t)&&n.delete(e)}function tP(){Jp=!1,Gi!==null&&ld(Gi)&&(Gi=null),qi!==null&&ld(qi)&&(qi=null),zi!==null&&ld(zi)&&(zi=null),hu.forEach(Uy),fu.forEach(Uy)}function Tl(t,e){t.blockedOn===e&&(t.blockedOn=null,Jp||(Jp=!0,Nn.unstable_scheduleCallback(Nn.unstable_NormalPriority,tP)))}function pu(t){function e(i){return Tl(i,t)}if(0<Gc.length){Tl(Gc[0],t);for(var n=1;n<Gc.length;n++){var r=Gc[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Gi!==null&&Tl(Gi,t),qi!==null&&Tl(qi,t),zi!==null&&Tl(zi,t),hu.forEach(e),fu.forEach(e),n=0;n<bi.length;n++)r=bi[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<bi.length&&(n=bi[0],n.blockedOn===null);)$I(n),n.blockedOn===null&&bi.shift()}var ha=ai.ReactCurrentBatchConfig,Bd=!0;function nP(t,e,n,r){var i=Ye,s=ha.transition;ha.transition=null;try{Ye=1,bg(t,e,n,r)}finally{Ye=i,ha.transition=s}}function rP(t,e,n,r){var i=Ye,s=ha.transition;ha.transition=null;try{Ye=4,bg(t,e,n,r)}finally{Ye=i,ha.transition=s}}function bg(t,e,n,r){if(Bd){var i=Qp(t,e,n,r);if(i===null)np(t,e,r,Gd,n),Fy(t,r);else if(eP(i,t,e,n,r))r.stopPropagation();else if(Fy(t,r),e&4&&-1<ZR.indexOf(t)){for(;i!==null;){var s=zu(i);if(s!==null&&BI(s),s=Qp(t,e,n,r),s===null&&np(t,e,r,Gd,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else np(t,e,r,null,n)}}var Gd=null;function Qp(t,e,n,r){if(Gd=null,t=Rg(r),t=Ks(t),t!==null)if(e=Eo(t),e===null)t=null;else if(n=e.tag,n===13){if(t=bI(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Gd=t,null}function HI(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch($R()){case Pg:return 1;case LI:return 4;case Ud:case HR:return 16;case FI:return 536870912;default:return 16}default:return 16}}var Ui=null,Dg=null,ud=null;function jI(){if(ud)return ud;var t,e=Dg,n=e.length,r,i="value"in Ui?Ui.value:Ui.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return ud=i.slice(t,1<r?1-r:void 0)}function cd(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function qc(){return!0}function Oy(){return!1}function Mn(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?qc:Oy,this.isPropagationStopped=Oy,this}return gt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=qc)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=qc)},persist:function(){},isPersistent:qc}),e}var Wa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Mg=Mn(Wa),qu=gt({},Wa,{view:0,detail:0}),iP=Mn(qu),Wf,Kf,El,Lh=gt({},qu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Vg,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==El&&(El&&t.type==="mousemove"?(Wf=t.screenX-El.screenX,Kf=t.screenY-El.screenY):Kf=Wf=0,El=t),Wf)},movementY:function(t){return"movementY"in t?t.movementY:Kf}}),By=Mn(Lh),sP=gt({},Lh,{dataTransfer:0}),oP=Mn(sP),aP=gt({},qu,{relatedTarget:0}),Jf=Mn(aP),lP=gt({},Wa,{animationName:0,elapsedTime:0,pseudoElement:0}),uP=Mn(lP),cP=gt({},Wa,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),dP=Mn(cP),hP=gt({},Wa,{data:0}),Gy=Mn(hP),fP={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},pP={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},mP={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function gP(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=mP[t])?!!e[t]:!1}function Vg(){return gP}var _P=gt({},qu,{key:function(t){if(t.key){var e=fP[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=cd(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?pP[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Vg,charCode:function(t){return t.type==="keypress"?cd(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?cd(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),yP=Mn(_P),vP=gt({},Lh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),qy=Mn(vP),TP=gt({},qu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Vg}),EP=Mn(TP),wP=gt({},Wa,{propertyName:0,elapsedTime:0,pseudoElement:0}),IP=Mn(wP),SP=gt({},Lh,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),CP=Mn(SP),xP=[9,13,27,32],Lg=Zr&&"CompositionEvent"in window,zl=null;Zr&&"documentMode"in document&&(zl=document.documentMode);var AP=Zr&&"TextEvent"in window&&!zl,WI=Zr&&(!Lg||zl&&8<zl&&11>=zl),zy=" ",$y=!1;function KI(t,e){switch(t){case"keyup":return xP.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function JI(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Yo=!1;function RP(t,e){switch(t){case"compositionend":return JI(e);case"keypress":return e.which!==32?null:($y=!0,zy);case"textInput":return t=e.data,t===zy&&$y?null:t;default:return null}}function PP(t,e){if(Yo)return t==="compositionend"||!Lg&&KI(t,e)?(t=jI(),ud=Dg=Ui=null,Yo=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return WI&&e.locale!=="ko"?null:e.data;default:return null}}var kP={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hy(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!kP[t.type]:e==="textarea"}function QI(t,e,n,r){AI(r),e=qd(e,"onChange"),0<e.length&&(n=new Mg("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var $l=null,mu=null;function NP(t){aS(t,0)}function Fh(t){var e=ea(t);if(TI(e))return t}function bP(t,e){if(t==="change")return e}var YI=!1;if(Zr){var Qf;if(Zr){var Yf="oninput"in document;if(!Yf){var jy=document.createElement("div");jy.setAttribute("oninput","return;"),Yf=typeof jy.oninput=="function"}Qf=Yf}else Qf=!1;YI=Qf&&(!document.documentMode||9<document.documentMode)}function Wy(){$l&&($l.detachEvent("onpropertychange",XI),mu=$l=null)}function XI(t){if(t.propertyName==="value"&&Fh(mu)){var e=[];QI(e,mu,t,Rg(t)),NI(NP,e)}}function DP(t,e,n){t==="focusin"?(Wy(),$l=e,mu=n,$l.attachEvent("onpropertychange",XI)):t==="focusout"&&Wy()}function MP(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Fh(mu)}function VP(t,e){if(t==="click")return Fh(e)}function LP(t,e){if(t==="input"||t==="change")return Fh(e)}function FP(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var dr=typeof Object.is=="function"?Object.is:FP;function gu(t,e){if(dr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!bp.call(e,i)||!dr(t[i],e[i]))return!1}return!0}function Ky(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Jy(t,e){var n=Ky(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Ky(n)}}function ZI(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?ZI(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function eS(){for(var t=window,e=Vd();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Vd(t.document)}return e}function Fg(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function UP(t){var e=eS(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&ZI(n.ownerDocument.documentElement,n)){if(r!==null&&Fg(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=Jy(n,s);var o=Jy(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var OP=Zr&&"documentMode"in document&&11>=document.documentMode,Xo=null,Yp=null,Hl=null,Xp=!1;function Qy(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Xp||Xo==null||Xo!==Vd(r)||(r=Xo,"selectionStart"in r&&Fg(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Hl&&gu(Hl,r)||(Hl=r,r=qd(Yp,"onSelect"),0<r.length&&(e=new Mg("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Xo)))}function zc(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Zo={animationend:zc("Animation","AnimationEnd"),animationiteration:zc("Animation","AnimationIteration"),animationstart:zc("Animation","AnimationStart"),transitionend:zc("Transition","TransitionEnd")},Xf={},tS={};Zr&&(tS=document.createElement("div").style,"AnimationEvent"in window||(delete Zo.animationend.animation,delete Zo.animationiteration.animation,delete Zo.animationstart.animation),"TransitionEvent"in window||delete Zo.transitionend.transition);function Uh(t){if(Xf[t])return Xf[t];if(!Zo[t])return t;var e=Zo[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in tS)return Xf[t]=e[n];return t}var nS=Uh("animationend"),rS=Uh("animationiteration"),iS=Uh("animationstart"),sS=Uh("transitionend"),oS=new Map,Yy="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ds(t,e){oS.set(t,e),To(e,[t])}for(var Zf=0;Zf<Yy.length;Zf++){var ep=Yy[Zf],BP=ep.toLowerCase(),GP=ep[0].toUpperCase()+ep.slice(1);ds(BP,"on"+GP)}ds(nS,"onAnimationEnd");ds(rS,"onAnimationIteration");ds(iS,"onAnimationStart");ds("dblclick","onDoubleClick");ds("focusin","onFocus");ds("focusout","onBlur");ds(sS,"onTransitionEnd");wa("onMouseEnter",["mouseout","mouseover"]);wa("onMouseLeave",["mouseout","mouseover"]);wa("onPointerEnter",["pointerout","pointerover"]);wa("onPointerLeave",["pointerout","pointerover"]);To("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));To("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));To("onBeforeInput",["compositionend","keypress","textInput","paste"]);To("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));To("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));To("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ml="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),qP=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ml));function Xy(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,BR(r,e,void 0,t),t.currentTarget=null}function aS(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;Xy(i,a,u),s=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;Xy(i,a,u),s=l}}}if(Fd)throw t=Wp,Fd=!1,Wp=null,t}function st(t,e){var n=e[rm];n===void 0&&(n=e[rm]=new Set);var r=t+"__bubble";n.has(r)||(lS(e,t,2,!1),n.add(r))}function tp(t,e,n){var r=0;e&&(r|=4),lS(n,t,r,e)}var $c="_reactListening"+Math.random().toString(36).slice(2);function _u(t){if(!t[$c]){t[$c]=!0,mI.forEach(function(n){n!=="selectionchange"&&(qP.has(n)||tp(n,!1,t),tp(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[$c]||(e[$c]=!0,tp("selectionchange",!1,e))}}function lS(t,e,n,r){switch(HI(e)){case 1:var i=nP;break;case 4:i=rP;break;default:i=bg}n=i.bind(null,e,n,t),i=void 0,!jp||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function np(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=Ks(a),o===null)return;if(l=o.tag,l===5||l===6){r=s=o;continue e}a=a.parentNode}}r=r.return}NI(function(){var u=s,f=Rg(n),m=[];e:{var g=oS.get(t);if(g!==void 0){var v=Mg,T=t;switch(t){case"keypress":if(cd(n)===0)break e;case"keydown":case"keyup":v=yP;break;case"focusin":T="focus",v=Jf;break;case"focusout":T="blur",v=Jf;break;case"beforeblur":case"afterblur":v=Jf;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":v=By;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":v=oP;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":v=EP;break;case nS:case rS:case iS:v=uP;break;case sS:v=IP;break;case"scroll":v=iP;break;case"wheel":v=CP;break;case"copy":case"cut":case"paste":v=dP;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":v=qy}var P=(e&4)!==0,M=!P&&t==="scroll",x=P?g!==null?g+"Capture":null:g;P=[];for(var E=u,A;E!==null;){A=E;var V=A.stateNode;if(A.tag===5&&V!==null&&(A=V,x!==null&&(V=du(E,x),V!=null&&P.push(yu(E,V,A)))),M)break;E=E.return}0<P.length&&(g=new v(g,T,null,n,f),m.push({event:g,listeners:P}))}}if(!(e&7)){e:{if(g=t==="mouseover"||t==="pointerover",v=t==="mouseout"||t==="pointerout",g&&n!==$p&&(T=n.relatedTarget||n.fromElement)&&(Ks(T)||T[ei]))break e;if((v||g)&&(g=f.window===f?f:(g=f.ownerDocument)?g.defaultView||g.parentWindow:window,v?(T=n.relatedTarget||n.toElement,v=u,T=T?Ks(T):null,T!==null&&(M=Eo(T),T!==M||T.tag!==5&&T.tag!==6)&&(T=null)):(v=null,T=u),v!==T)){if(P=By,V="onMouseLeave",x="onMouseEnter",E="mouse",(t==="pointerout"||t==="pointerover")&&(P=qy,V="onPointerLeave",x="onPointerEnter",E="pointer"),M=v==null?g:ea(v),A=T==null?g:ea(T),g=new P(V,E+"leave",v,n,f),g.target=M,g.relatedTarget=A,V=null,Ks(f)===u&&(P=new P(x,E+"enter",T,n,f),P.target=A,P.relatedTarget=M,V=P),M=V,v&&T)t:{for(P=v,x=T,E=0,A=P;A;A=Fo(A))E++;for(A=0,V=x;V;V=Fo(V))A++;for(;0<E-A;)P=Fo(P),E--;for(;0<A-E;)x=Fo(x),A--;for(;E--;){if(P===x||x!==null&&P===x.alternate)break t;P=Fo(P),x=Fo(x)}P=null}else P=null;v!==null&&Zy(m,g,v,P,!1),T!==null&&M!==null&&Zy(m,M,T,P,!0)}}e:{if(g=u?ea(u):window,v=g.nodeName&&g.nodeName.toLowerCase(),v==="select"||v==="input"&&g.type==="file")var B=bP;else if(Hy(g))if(YI)B=LP;else{B=MP;var G=DP}else(v=g.nodeName)&&v.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(B=VP);if(B&&(B=B(t,u))){QI(m,B,n,f);break e}G&&G(t,g,u),t==="focusout"&&(G=g._wrapperState)&&G.controlled&&g.type==="number"&&Op(g,"number",g.value)}switch(G=u?ea(u):window,t){case"focusin":(Hy(G)||G.contentEditable==="true")&&(Xo=G,Yp=u,Hl=null);break;case"focusout":Hl=Yp=Xo=null;break;case"mousedown":Xp=!0;break;case"contextmenu":case"mouseup":case"dragend":Xp=!1,Qy(m,n,f);break;case"selectionchange":if(OP)break;case"keydown":case"keyup":Qy(m,n,f)}var I;if(Lg)e:{switch(t){case"compositionstart":var S="onCompositionStart";break e;case"compositionend":S="onCompositionEnd";break e;case"compositionupdate":S="onCompositionUpdate";break e}S=void 0}else Yo?KI(t,n)&&(S="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(S="onCompositionStart");S&&(WI&&n.locale!=="ko"&&(Yo||S!=="onCompositionStart"?S==="onCompositionEnd"&&Yo&&(I=jI()):(Ui=f,Dg="value"in Ui?Ui.value:Ui.textContent,Yo=!0)),G=qd(u,S),0<G.length&&(S=new Gy(S,t,null,n,f),m.push({event:S,listeners:G}),I?S.data=I:(I=JI(n),I!==null&&(S.data=I)))),(I=AP?RP(t,n):PP(t,n))&&(u=qd(u,"onBeforeInput"),0<u.length&&(f=new Gy("onBeforeInput","beforeinput",null,n,f),m.push({event:f,listeners:u}),f.data=I))}aS(m,e)})}function yu(t,e,n){return{instance:t,listener:e,currentTarget:n}}function qd(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=du(t,n),s!=null&&r.unshift(yu(t,s,i)),s=du(t,e),s!=null&&r.push(yu(t,s,i))),t=t.return}return r}function Fo(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Zy(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,u=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&u!==null&&(a=u,i?(l=du(n,s),l!=null&&o.unshift(yu(n,l,a))):i||(l=du(n,s),l!=null&&o.push(yu(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var zP=/\r\n?/g,$P=/\u0000|\uFFFD/g;function ev(t){return(typeof t=="string"?t:""+t).replace(zP,`
`).replace($P,"")}function Hc(t,e,n){if(e=ev(e),ev(t)!==e&&n)throw Error(ne(425))}function zd(){}var Zp=null,em=null;function tm(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var nm=typeof setTimeout=="function"?setTimeout:void 0,HP=typeof clearTimeout=="function"?clearTimeout:void 0,tv=typeof Promise=="function"?Promise:void 0,jP=typeof queueMicrotask=="function"?queueMicrotask:typeof tv<"u"?function(t){return tv.resolve(null).then(t).catch(WP)}:nm;function WP(t){setTimeout(function(){throw t})}function rp(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),pu(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);pu(e)}function $i(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function nv(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Ka=Math.random().toString(36).slice(2),Sr="__reactFiber$"+Ka,vu="__reactProps$"+Ka,ei="__reactContainer$"+Ka,rm="__reactEvents$"+Ka,KP="__reactListeners$"+Ka,JP="__reactHandles$"+Ka;function Ks(t){var e=t[Sr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[ei]||n[Sr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=nv(t);t!==null;){if(n=t[Sr])return n;t=nv(t)}return e}t=n,n=t.parentNode}return null}function zu(t){return t=t[Sr]||t[ei],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function ea(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ne(33))}function Oh(t){return t[vu]||null}var im=[],ta=-1;function hs(t){return{current:t}}function at(t){0>ta||(t.current=im[ta],im[ta]=null,ta--)}function nt(t,e){ta++,im[ta]=t.current,t.current=e}var rs={},rn=hs(rs),_n=hs(!1),so=rs;function Ia(t,e){var n=t.type.contextTypes;if(!n)return rs;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function yn(t){return t=t.childContextTypes,t!=null}function $d(){at(_n),at(rn)}function rv(t,e,n){if(rn.current!==rs)throw Error(ne(168));nt(rn,e),nt(_n,n)}function uS(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(ne(108,DR(t)||"Unknown",i));return gt({},n,r)}function Hd(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||rs,so=rn.current,nt(rn,t),nt(_n,_n.current),!0}function iv(t,e,n){var r=t.stateNode;if(!r)throw Error(ne(169));n?(t=uS(t,e,so),r.__reactInternalMemoizedMergedChildContext=t,at(_n),at(rn),nt(rn,t)):at(_n),nt(_n,n)}var $r=null,Bh=!1,ip=!1;function cS(t){$r===null?$r=[t]:$r.push(t)}function QP(t){Bh=!0,cS(t)}function fs(){if(!ip&&$r!==null){ip=!0;var t=0,e=Ye;try{var n=$r;for(Ye=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}$r=null,Bh=!1}catch(i){throw $r!==null&&($r=$r.slice(t+1)),VI(Pg,fs),i}finally{Ye=e,ip=!1}}return null}var na=[],ra=0,jd=null,Wd=0,Un=[],On=0,oo=null,jr=1,Wr="";function Us(t,e){na[ra++]=Wd,na[ra++]=jd,jd=t,Wd=e}function dS(t,e,n){Un[On++]=jr,Un[On++]=Wr,Un[On++]=oo,oo=t;var r=jr;t=Wr;var i=32-or(r)-1;r&=~(1<<i),n+=1;var s=32-or(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,jr=1<<32-or(e)+i|n<<i|r,Wr=s+t}else jr=1<<s|n<<i|r,Wr=t}function Ug(t){t.return!==null&&(Us(t,1),dS(t,1,0))}function Og(t){for(;t===jd;)jd=na[--ra],na[ra]=null,Wd=na[--ra],na[ra]=null;for(;t===oo;)oo=Un[--On],Un[On]=null,Wr=Un[--On],Un[On]=null,jr=Un[--On],Un[On]=null}var kn=null,Rn=null,ct=!1,rr=null;function hS(t,e){var n=Bn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function sv(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,kn=t,Rn=$i(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,kn=t,Rn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=oo!==null?{id:jr,overflow:Wr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Bn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,kn=t,Rn=null,!0):!1;default:return!1}}function sm(t){return(t.mode&1)!==0&&(t.flags&128)===0}function om(t){if(ct){var e=Rn;if(e){var n=e;if(!sv(t,e)){if(sm(t))throw Error(ne(418));e=$i(n.nextSibling);var r=kn;e&&sv(t,e)?hS(r,n):(t.flags=t.flags&-4097|2,ct=!1,kn=t)}}else{if(sm(t))throw Error(ne(418));t.flags=t.flags&-4097|2,ct=!1,kn=t}}}function ov(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;kn=t}function jc(t){if(t!==kn)return!1;if(!ct)return ov(t),ct=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!tm(t.type,t.memoizedProps)),e&&(e=Rn)){if(sm(t))throw fS(),Error(ne(418));for(;e;)hS(t,e),e=$i(e.nextSibling)}if(ov(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ne(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Rn=$i(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Rn=null}}else Rn=kn?$i(t.stateNode.nextSibling):null;return!0}function fS(){for(var t=Rn;t;)t=$i(t.nextSibling)}function Sa(){Rn=kn=null,ct=!1}function Bg(t){rr===null?rr=[t]:rr.push(t)}var YP=ai.ReactCurrentBatchConfig;function wl(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ne(309));var r=n.stateNode}if(!r)throw Error(ne(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(ne(284));if(!n._owner)throw Error(ne(290,t))}return t}function Wc(t,e){throw t=Object.prototype.toString.call(e),Error(ne(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function av(t){var e=t._init;return e(t._payload)}function pS(t){function e(x,E){if(t){var A=x.deletions;A===null?(x.deletions=[E],x.flags|=16):A.push(E)}}function n(x,E){if(!t)return null;for(;E!==null;)e(x,E),E=E.sibling;return null}function r(x,E){for(x=new Map;E!==null;)E.key!==null?x.set(E.key,E):x.set(E.index,E),E=E.sibling;return x}function i(x,E){return x=Ki(x,E),x.index=0,x.sibling=null,x}function s(x,E,A){return x.index=A,t?(A=x.alternate,A!==null?(A=A.index,A<E?(x.flags|=2,E):A):(x.flags|=2,E)):(x.flags|=1048576,E)}function o(x){return t&&x.alternate===null&&(x.flags|=2),x}function a(x,E,A,V){return E===null||E.tag!==6?(E=dp(A,x.mode,V),E.return=x,E):(E=i(E,A),E.return=x,E)}function l(x,E,A,V){var B=A.type;return B===Qo?f(x,E,A.props.children,V,A.key):E!==null&&(E.elementType===B||typeof B=="object"&&B!==null&&B.$$typeof===ki&&av(B)===E.type)?(V=i(E,A.props),V.ref=wl(x,E,A),V.return=x,V):(V=_d(A.type,A.key,A.props,null,x.mode,V),V.ref=wl(x,E,A),V.return=x,V)}function u(x,E,A,V){return E===null||E.tag!==4||E.stateNode.containerInfo!==A.containerInfo||E.stateNode.implementation!==A.implementation?(E=hp(A,x.mode,V),E.return=x,E):(E=i(E,A.children||[]),E.return=x,E)}function f(x,E,A,V,B){return E===null||E.tag!==7?(E=eo(A,x.mode,V,B),E.return=x,E):(E=i(E,A),E.return=x,E)}function m(x,E,A){if(typeof E=="string"&&E!==""||typeof E=="number")return E=dp(""+E,x.mode,A),E.return=x,E;if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Lc:return A=_d(E.type,E.key,E.props,null,x.mode,A),A.ref=wl(x,null,E),A.return=x,A;case Jo:return E=hp(E,x.mode,A),E.return=x,E;case ki:var V=E._init;return m(x,V(E._payload),A)}if(bl(E)||_l(E))return E=eo(E,x.mode,A,null),E.return=x,E;Wc(x,E)}return null}function g(x,E,A,V){var B=E!==null?E.key:null;if(typeof A=="string"&&A!==""||typeof A=="number")return B!==null?null:a(x,E,""+A,V);if(typeof A=="object"&&A!==null){switch(A.$$typeof){case Lc:return A.key===B?l(x,E,A,V):null;case Jo:return A.key===B?u(x,E,A,V):null;case ki:return B=A._init,g(x,E,B(A._payload),V)}if(bl(A)||_l(A))return B!==null?null:f(x,E,A,V,null);Wc(x,A)}return null}function v(x,E,A,V,B){if(typeof V=="string"&&V!==""||typeof V=="number")return x=x.get(A)||null,a(E,x,""+V,B);if(typeof V=="object"&&V!==null){switch(V.$$typeof){case Lc:return x=x.get(V.key===null?A:V.key)||null,l(E,x,V,B);case Jo:return x=x.get(V.key===null?A:V.key)||null,u(E,x,V,B);case ki:var G=V._init;return v(x,E,A,G(V._payload),B)}if(bl(V)||_l(V))return x=x.get(A)||null,f(E,x,V,B,null);Wc(E,V)}return null}function T(x,E,A,V){for(var B=null,G=null,I=E,S=E=0,R=null;I!==null&&S<A.length;S++){I.index>S?(R=I,I=null):R=I.sibling;var N=g(x,I,A[S],V);if(N===null){I===null&&(I=R);break}t&&I&&N.alternate===null&&e(x,I),E=s(N,E,S),G===null?B=N:G.sibling=N,G=N,I=R}if(S===A.length)return n(x,I),ct&&Us(x,S),B;if(I===null){for(;S<A.length;S++)I=m(x,A[S],V),I!==null&&(E=s(I,E,S),G===null?B=I:G.sibling=I,G=I);return ct&&Us(x,S),B}for(I=r(x,I);S<A.length;S++)R=v(I,x,S,A[S],V),R!==null&&(t&&R.alternate!==null&&I.delete(R.key===null?S:R.key),E=s(R,E,S),G===null?B=R:G.sibling=R,G=R);return t&&I.forEach(function(D){return e(x,D)}),ct&&Us(x,S),B}function P(x,E,A,V){var B=_l(A);if(typeof B!="function")throw Error(ne(150));if(A=B.call(A),A==null)throw Error(ne(151));for(var G=B=null,I=E,S=E=0,R=null,N=A.next();I!==null&&!N.done;S++,N=A.next()){I.index>S?(R=I,I=null):R=I.sibling;var D=g(x,I,N.value,V);if(D===null){I===null&&(I=R);break}t&&I&&D.alternate===null&&e(x,I),E=s(D,E,S),G===null?B=D:G.sibling=D,G=D,I=R}if(N.done)return n(x,I),ct&&Us(x,S),B;if(I===null){for(;!N.done;S++,N=A.next())N=m(x,N.value,V),N!==null&&(E=s(N,E,S),G===null?B=N:G.sibling=N,G=N);return ct&&Us(x,S),B}for(I=r(x,I);!N.done;S++,N=A.next())N=v(I,x,S,N.value,V),N!==null&&(t&&N.alternate!==null&&I.delete(N.key===null?S:N.key),E=s(N,E,S),G===null?B=N:G.sibling=N,G=N);return t&&I.forEach(function(L){return e(x,L)}),ct&&Us(x,S),B}function M(x,E,A,V){if(typeof A=="object"&&A!==null&&A.type===Qo&&A.key===null&&(A=A.props.children),typeof A=="object"&&A!==null){switch(A.$$typeof){case Lc:e:{for(var B=A.key,G=E;G!==null;){if(G.key===B){if(B=A.type,B===Qo){if(G.tag===7){n(x,G.sibling),E=i(G,A.props.children),E.return=x,x=E;break e}}else if(G.elementType===B||typeof B=="object"&&B!==null&&B.$$typeof===ki&&av(B)===G.type){n(x,G.sibling),E=i(G,A.props),E.ref=wl(x,G,A),E.return=x,x=E;break e}n(x,G);break}else e(x,G);G=G.sibling}A.type===Qo?(E=eo(A.props.children,x.mode,V,A.key),E.return=x,x=E):(V=_d(A.type,A.key,A.props,null,x.mode,V),V.ref=wl(x,E,A),V.return=x,x=V)}return o(x);case Jo:e:{for(G=A.key;E!==null;){if(E.key===G)if(E.tag===4&&E.stateNode.containerInfo===A.containerInfo&&E.stateNode.implementation===A.implementation){n(x,E.sibling),E=i(E,A.children||[]),E.return=x,x=E;break e}else{n(x,E);break}else e(x,E);E=E.sibling}E=hp(A,x.mode,V),E.return=x,x=E}return o(x);case ki:return G=A._init,M(x,E,G(A._payload),V)}if(bl(A))return T(x,E,A,V);if(_l(A))return P(x,E,A,V);Wc(x,A)}return typeof A=="string"&&A!==""||typeof A=="number"?(A=""+A,E!==null&&E.tag===6?(n(x,E.sibling),E=i(E,A),E.return=x,x=E):(n(x,E),E=dp(A,x.mode,V),E.return=x,x=E),o(x)):n(x,E)}return M}var Ca=pS(!0),mS=pS(!1),Kd=hs(null),Jd=null,ia=null,Gg=null;function qg(){Gg=ia=Jd=null}function zg(t){var e=Kd.current;at(Kd),t._currentValue=e}function am(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function fa(t,e){Jd=t,Gg=ia=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(mn=!0),t.firstContext=null)}function jn(t){var e=t._currentValue;if(Gg!==t)if(t={context:t,memoizedValue:e,next:null},ia===null){if(Jd===null)throw Error(ne(308));ia=t,Jd.dependencies={lanes:0,firstContext:t}}else ia=ia.next=t;return e}var Js=null;function $g(t){Js===null?Js=[t]:Js.push(t)}function gS(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,$g(e)):(n.next=i.next,i.next=n),e.interleaved=n,ti(t,r)}function ti(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Ni=!1;function Hg(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function _S(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Yr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Hi(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Be&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,ti(t,n)}return i=r.interleaved,i===null?(e.next=e,$g(r)):(e.next=i.next,i.next=e),r.interleaved=e,ti(t,n)}function dd(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,kg(t,n)}}function lv(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Qd(t,e,n,r){var i=t.updateQueue;Ni=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?s=u:o.next=u,o=l;var f=t.alternate;f!==null&&(f=f.updateQueue,a=f.lastBaseUpdate,a!==o&&(a===null?f.firstBaseUpdate=u:a.next=u,f.lastBaseUpdate=l))}if(s!==null){var m=i.baseState;o=0,f=u=l=null,a=s;do{var g=a.lane,v=a.eventTime;if((r&g)===g){f!==null&&(f=f.next={eventTime:v,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var T=t,P=a;switch(g=e,v=n,P.tag){case 1:if(T=P.payload,typeof T=="function"){m=T.call(v,m,g);break e}m=T;break e;case 3:T.flags=T.flags&-65537|128;case 0:if(T=P.payload,g=typeof T=="function"?T.call(v,m,g):T,g==null)break e;m=gt({},m,g);break e;case 2:Ni=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,g=i.effects,g===null?i.effects=[a]:g.push(a))}else v={eventTime:v,lane:g,tag:a.tag,payload:a.payload,callback:a.callback,next:null},f===null?(u=f=v,l=m):f=f.next=v,o|=g;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;g=a,a=g.next,g.next=null,i.lastBaseUpdate=g,i.shared.pending=null}}while(!0);if(f===null&&(l=m),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=f,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);lo|=o,t.lanes=o,t.memoizedState=m}}function uv(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(ne(191,i));i.call(r)}}}var $u={},Rr=hs($u),Tu=hs($u),Eu=hs($u);function Qs(t){if(t===$u)throw Error(ne(174));return t}function jg(t,e){switch(nt(Eu,e),nt(Tu,t),nt(Rr,$u),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Gp(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Gp(e,t)}at(Rr),nt(Rr,e)}function xa(){at(Rr),at(Tu),at(Eu)}function yS(t){Qs(Eu.current);var e=Qs(Rr.current),n=Gp(e,t.type);e!==n&&(nt(Tu,t),nt(Rr,n))}function Wg(t){Tu.current===t&&(at(Rr),at(Tu))}var ft=hs(0);function Yd(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var sp=[];function Kg(){for(var t=0;t<sp.length;t++)sp[t]._workInProgressVersionPrimary=null;sp.length=0}var hd=ai.ReactCurrentDispatcher,op=ai.ReactCurrentBatchConfig,ao=0,mt=null,kt=null,Ut=null,Xd=!1,jl=!1,wu=0,XP=0;function Jt(){throw Error(ne(321))}function Jg(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!dr(t[n],e[n]))return!1;return!0}function Qg(t,e,n,r,i,s){if(ao=s,mt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,hd.current=t===null||t.memoizedState===null?nk:rk,t=n(r,i),jl){s=0;do{if(jl=!1,wu=0,25<=s)throw Error(ne(301));s+=1,Ut=kt=null,e.updateQueue=null,hd.current=ik,t=n(r,i)}while(jl)}if(hd.current=Zd,e=kt!==null&&kt.next!==null,ao=0,Ut=kt=mt=null,Xd=!1,e)throw Error(ne(300));return t}function Yg(){var t=wu!==0;return wu=0,t}function wr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ut===null?mt.memoizedState=Ut=t:Ut=Ut.next=t,Ut}function Wn(){if(kt===null){var t=mt.alternate;t=t!==null?t.memoizedState:null}else t=kt.next;var e=Ut===null?mt.memoizedState:Ut.next;if(e!==null)Ut=e,kt=t;else{if(t===null)throw Error(ne(310));kt=t,t={memoizedState:kt.memoizedState,baseState:kt.baseState,baseQueue:kt.baseQueue,queue:kt.queue,next:null},Ut===null?mt.memoizedState=Ut=t:Ut=Ut.next=t}return Ut}function Iu(t,e){return typeof e=="function"?e(t):e}function ap(t){var e=Wn(),n=e.queue;if(n===null)throw Error(ne(311));n.lastRenderedReducer=t;var r=kt,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,l=null,u=s;do{var f=u.lane;if((ao&f)===f)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var m={lane:f,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=m,o=r):l=l.next=m,mt.lanes|=f,lo|=f}u=u.next}while(u!==null&&u!==s);l===null?o=r:l.next=a,dr(r,e.memoizedState)||(mn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,mt.lanes|=s,lo|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function lp(t){var e=Wn(),n=e.queue;if(n===null)throw Error(ne(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);dr(s,e.memoizedState)||(mn=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function vS(){}function TS(t,e){var n=mt,r=Wn(),i=e(),s=!dr(r.memoizedState,i);if(s&&(r.memoizedState=i,mn=!0),r=r.queue,Xg(IS.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||Ut!==null&&Ut.memoizedState.tag&1){if(n.flags|=2048,Su(9,wS.bind(null,n,r,i,e),void 0,null),Ot===null)throw Error(ne(349));ao&30||ES(n,e,i)}return i}function ES(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=mt.updateQueue,e===null?(e={lastEffect:null,stores:null},mt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function wS(t,e,n,r){e.value=n,e.getSnapshot=r,SS(e)&&CS(t)}function IS(t,e,n){return n(function(){SS(e)&&CS(t)})}function SS(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!dr(t,n)}catch{return!0}}function CS(t){var e=ti(t,1);e!==null&&ar(e,t,1,-1)}function cv(t){var e=wr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Iu,lastRenderedState:t},e.queue=t,t=t.dispatch=tk.bind(null,mt,t),[e.memoizedState,t]}function Su(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=mt.updateQueue,e===null?(e={lastEffect:null,stores:null},mt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function xS(){return Wn().memoizedState}function fd(t,e,n,r){var i=wr();mt.flags|=t,i.memoizedState=Su(1|e,n,void 0,r===void 0?null:r)}function Gh(t,e,n,r){var i=Wn();r=r===void 0?null:r;var s=void 0;if(kt!==null){var o=kt.memoizedState;if(s=o.destroy,r!==null&&Jg(r,o.deps)){i.memoizedState=Su(e,n,s,r);return}}mt.flags|=t,i.memoizedState=Su(1|e,n,s,r)}function dv(t,e){return fd(8390656,8,t,e)}function Xg(t,e){return Gh(2048,8,t,e)}function AS(t,e){return Gh(4,2,t,e)}function RS(t,e){return Gh(4,4,t,e)}function PS(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function kS(t,e,n){return n=n!=null?n.concat([t]):null,Gh(4,4,PS.bind(null,e,t),n)}function Zg(){}function NS(t,e){var n=Wn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Jg(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function bS(t,e){var n=Wn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Jg(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function DS(t,e,n){return ao&21?(dr(n,e)||(n=UI(),mt.lanes|=n,lo|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,mn=!0),t.memoizedState=n)}function ZP(t,e){var n=Ye;Ye=n!==0&&4>n?n:4,t(!0);var r=op.transition;op.transition={};try{t(!1),e()}finally{Ye=n,op.transition=r}}function MS(){return Wn().memoizedState}function ek(t,e,n){var r=Wi(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},VS(t))LS(e,n);else if(n=gS(t,e,n,r),n!==null){var i=ln();ar(n,t,r,i),FS(n,e,r)}}function tk(t,e,n){var r=Wi(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(VS(t))LS(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,dr(a,o)){var l=e.interleaved;l===null?(i.next=i,$g(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=gS(t,e,i,r),n!==null&&(i=ln(),ar(n,t,r,i),FS(n,e,r))}}function VS(t){var e=t.alternate;return t===mt||e!==null&&e===mt}function LS(t,e){jl=Xd=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function FS(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,kg(t,n)}}var Zd={readContext:jn,useCallback:Jt,useContext:Jt,useEffect:Jt,useImperativeHandle:Jt,useInsertionEffect:Jt,useLayoutEffect:Jt,useMemo:Jt,useReducer:Jt,useRef:Jt,useState:Jt,useDebugValue:Jt,useDeferredValue:Jt,useTransition:Jt,useMutableSource:Jt,useSyncExternalStore:Jt,useId:Jt,unstable_isNewReconciler:!1},nk={readContext:jn,useCallback:function(t,e){return wr().memoizedState=[t,e===void 0?null:e],t},useContext:jn,useEffect:dv,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,fd(4194308,4,PS.bind(null,e,t),n)},useLayoutEffect:function(t,e){return fd(4194308,4,t,e)},useInsertionEffect:function(t,e){return fd(4,2,t,e)},useMemo:function(t,e){var n=wr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=wr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=ek.bind(null,mt,t),[r.memoizedState,t]},useRef:function(t){var e=wr();return t={current:t},e.memoizedState=t},useState:cv,useDebugValue:Zg,useDeferredValue:function(t){return wr().memoizedState=t},useTransition:function(){var t=cv(!1),e=t[0];return t=ZP.bind(null,t[1]),wr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=mt,i=wr();if(ct){if(n===void 0)throw Error(ne(407));n=n()}else{if(n=e(),Ot===null)throw Error(ne(349));ao&30||ES(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,dv(IS.bind(null,r,s,t),[t]),r.flags|=2048,Su(9,wS.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=wr(),e=Ot.identifierPrefix;if(ct){var n=Wr,r=jr;n=(r&~(1<<32-or(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=wu++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=XP++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},rk={readContext:jn,useCallback:NS,useContext:jn,useEffect:Xg,useImperativeHandle:kS,useInsertionEffect:AS,useLayoutEffect:RS,useMemo:bS,useReducer:ap,useRef:xS,useState:function(){return ap(Iu)},useDebugValue:Zg,useDeferredValue:function(t){var e=Wn();return DS(e,kt.memoizedState,t)},useTransition:function(){var t=ap(Iu)[0],e=Wn().memoizedState;return[t,e]},useMutableSource:vS,useSyncExternalStore:TS,useId:MS,unstable_isNewReconciler:!1},ik={readContext:jn,useCallback:NS,useContext:jn,useEffect:Xg,useImperativeHandle:kS,useInsertionEffect:AS,useLayoutEffect:RS,useMemo:bS,useReducer:lp,useRef:xS,useState:function(){return lp(Iu)},useDebugValue:Zg,useDeferredValue:function(t){var e=Wn();return kt===null?e.memoizedState=t:DS(e,kt.memoizedState,t)},useTransition:function(){var t=lp(Iu)[0],e=Wn().memoizedState;return[t,e]},useMutableSource:vS,useSyncExternalStore:TS,useId:MS,unstable_isNewReconciler:!1};function er(t,e){if(t&&t.defaultProps){e=gt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function lm(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:gt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var qh={isMounted:function(t){return(t=t._reactInternals)?Eo(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=ln(),i=Wi(t),s=Yr(r,i);s.payload=e,n!=null&&(s.callback=n),e=Hi(t,s,i),e!==null&&(ar(e,t,i,r),dd(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=ln(),i=Wi(t),s=Yr(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=Hi(t,s,i),e!==null&&(ar(e,t,i,r),dd(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=ln(),r=Wi(t),i=Yr(n,r);i.tag=2,e!=null&&(i.callback=e),e=Hi(t,i,r),e!==null&&(ar(e,t,r,n),dd(e,t,r))}};function hv(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!gu(n,r)||!gu(i,s):!0}function US(t,e,n){var r=!1,i=rs,s=e.contextType;return typeof s=="object"&&s!==null?s=jn(s):(i=yn(e)?so:rn.current,r=e.contextTypes,s=(r=r!=null)?Ia(t,i):rs),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=qh,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function fv(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&qh.enqueueReplaceState(e,e.state,null)}function um(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},Hg(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=jn(s):(s=yn(e)?so:rn.current,i.context=Ia(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(lm(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&qh.enqueueReplaceState(i,i.state,null),Qd(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Aa(t,e){try{var n="",r=e;do n+=bR(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function up(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function cm(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var sk=typeof WeakMap=="function"?WeakMap:Map;function OS(t,e,n){n=Yr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){th||(th=!0,Tm=r),cm(t,e)},n}function BS(t,e,n){n=Yr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){cm(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){cm(t,e),typeof r!="function"&&(ji===null?ji=new Set([this]):ji.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function pv(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new sk;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=vk.bind(null,t,e,n),e.then(t,t))}function mv(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function gv(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Yr(-1,1),e.tag=2,Hi(n,e,1))),n.lanes|=1),t)}var ok=ai.ReactCurrentOwner,mn=!1;function sn(t,e,n,r){e.child=t===null?mS(e,null,n,r):Ca(e,t.child,n,r)}function _v(t,e,n,r,i){n=n.render;var s=e.ref;return fa(e,i),r=Qg(t,e,n,r,s,i),n=Yg(),t!==null&&!mn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,ni(t,e,i)):(ct&&n&&Ug(e),e.flags|=1,sn(t,e,r,i),e.child)}function yv(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!a_(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,GS(t,e,s,r,i)):(t=_d(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:gu,n(o,r)&&t.ref===e.ref)return ni(t,e,i)}return e.flags|=1,t=Ki(s,r),t.ref=e.ref,t.return=e,e.child=t}function GS(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(gu(s,r)&&t.ref===e.ref)if(mn=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(mn=!0);else return e.lanes=t.lanes,ni(t,e,i)}return dm(t,e,n,r,i)}function qS(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},nt(oa,Cn),Cn|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,nt(oa,Cn),Cn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,nt(oa,Cn),Cn|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,nt(oa,Cn),Cn|=r;return sn(t,e,i,n),e.child}function zS(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function dm(t,e,n,r,i){var s=yn(n)?so:rn.current;return s=Ia(e,s),fa(e,i),n=Qg(t,e,n,r,s,i),r=Yg(),t!==null&&!mn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,ni(t,e,i)):(ct&&r&&Ug(e),e.flags|=1,sn(t,e,n,i),e.child)}function vv(t,e,n,r,i){if(yn(n)){var s=!0;Hd(e)}else s=!1;if(fa(e,i),e.stateNode===null)pd(t,e),US(e,n,r),um(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=jn(u):(u=yn(n)?so:rn.current,u=Ia(e,u));var f=n.getDerivedStateFromProps,m=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function";m||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==u)&&fv(e,o,r,u),Ni=!1;var g=e.memoizedState;o.state=g,Qd(e,r,o,i),l=e.memoizedState,a!==r||g!==l||_n.current||Ni?(typeof f=="function"&&(lm(e,n,f,r),l=e.memoizedState),(a=Ni||hv(e,n,a,r,g,l,u))?(m||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=u,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,_S(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:er(e.type,a),o.props=u,m=e.pendingProps,g=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=jn(l):(l=yn(n)?so:rn.current,l=Ia(e,l));var v=n.getDerivedStateFromProps;(f=typeof v=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==m||g!==l)&&fv(e,o,r,l),Ni=!1,g=e.memoizedState,o.state=g,Qd(e,r,o,i);var T=e.memoizedState;a!==m||g!==T||_n.current||Ni?(typeof v=="function"&&(lm(e,n,v,r),T=e.memoizedState),(u=Ni||hv(e,n,u,r,g,T,l)||!1)?(f||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,T,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,T,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=T),o.props=r,o.state=T,o.context=l,r=u):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),r=!1)}return hm(t,e,n,r,s,i)}function hm(t,e,n,r,i,s){zS(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&iv(e,n,!1),ni(t,e,s);r=e.stateNode,ok.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Ca(e,t.child,null,s),e.child=Ca(e,null,a,s)):sn(t,e,a,s),e.memoizedState=r.state,i&&iv(e,n,!0),e.child}function $S(t){var e=t.stateNode;e.pendingContext?rv(t,e.pendingContext,e.pendingContext!==e.context):e.context&&rv(t,e.context,!1),jg(t,e.containerInfo)}function Tv(t,e,n,r,i){return Sa(),Bg(i),e.flags|=256,sn(t,e,n,r),e.child}var fm={dehydrated:null,treeContext:null,retryLane:0};function pm(t){return{baseLanes:t,cachePool:null,transitions:null}}function HS(t,e,n){var r=e.pendingProps,i=ft.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),nt(ft,i&1),t===null)return om(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=Hh(o,r,0,null),t=eo(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=pm(n),e.memoizedState=fm,t):e_(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return ak(t,e,o,r,a,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Ki(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=Ki(a,s):(s=eo(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?pm(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=fm,r}return s=t.child,t=s.sibling,r=Ki(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function e_(t,e){return e=Hh({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Kc(t,e,n,r){return r!==null&&Bg(r),Ca(e,t.child,null,n),t=e_(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function ak(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=up(Error(ne(422))),Kc(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=Hh({mode:"visible",children:r.children},i,0,null),s=eo(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&Ca(e,t.child,null,o),e.child.memoizedState=pm(o),e.memoizedState=fm,s);if(!(e.mode&1))return Kc(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(ne(419)),r=up(s,r,void 0),Kc(t,e,o,r)}if(a=(o&t.childLanes)!==0,mn||a){if(r=Ot,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,ti(t,i),ar(r,t,i,-1))}return o_(),r=up(Error(ne(421))),Kc(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=Tk.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Rn=$i(i.nextSibling),kn=e,ct=!0,rr=null,t!==null&&(Un[On++]=jr,Un[On++]=Wr,Un[On++]=oo,jr=t.id,Wr=t.overflow,oo=e),e=e_(e,r.children),e.flags|=4096,e)}function Ev(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),am(t.return,e,n)}function cp(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function jS(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(sn(t,e,r.children,n),r=ft.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Ev(t,n,e);else if(t.tag===19)Ev(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(nt(ft,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&Yd(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),cp(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Yd(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}cp(e,!0,n,null,s);break;case"together":cp(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function pd(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function ni(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),lo|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ne(153));if(e.child!==null){for(t=e.child,n=Ki(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Ki(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function lk(t,e,n){switch(e.tag){case 3:$S(e),Sa();break;case 5:yS(e);break;case 1:yn(e.type)&&Hd(e);break;case 4:jg(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;nt(Kd,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(nt(ft,ft.current&1),e.flags|=128,null):n&e.child.childLanes?HS(t,e,n):(nt(ft,ft.current&1),t=ni(t,e,n),t!==null?t.sibling:null);nt(ft,ft.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return jS(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),nt(ft,ft.current),r)break;return null;case 22:case 23:return e.lanes=0,qS(t,e,n)}return ni(t,e,n)}var WS,mm,KS,JS;WS=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};mm=function(){};KS=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Qs(Rr.current);var s=null;switch(n){case"input":i=Fp(t,i),r=Fp(t,r),s=[];break;case"select":i=gt({},i,{value:void 0}),r=gt({},r,{value:void 0}),s=[];break;case"textarea":i=Bp(t,i),r=Bp(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=zd)}qp(n,r);var o;n=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var a=i[u];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(uu.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var l=r[u];if(a=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(uu.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&st("scroll",t),s||a===l||(s=[])):(s=s||[]).push(u,l))}n&&(s=s||[]).push("style",n);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};JS=function(t,e,n,r){n!==r&&(e.flags|=4)};function Il(t,e){if(!ct)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Qt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function uk(t,e,n){var r=e.pendingProps;switch(Og(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qt(e),null;case 1:return yn(e.type)&&$d(),Qt(e),null;case 3:return r=e.stateNode,xa(),at(_n),at(rn),Kg(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(jc(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,rr!==null&&(Im(rr),rr=null))),mm(t,e),Qt(e),null;case 5:Wg(e);var i=Qs(Eu.current);if(n=e.type,t!==null&&e.stateNode!=null)KS(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(ne(166));return Qt(e),null}if(t=Qs(Rr.current),jc(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[Sr]=e,r[vu]=s,t=(e.mode&1)!==0,n){case"dialog":st("cancel",r),st("close",r);break;case"iframe":case"object":case"embed":st("load",r);break;case"video":case"audio":for(i=0;i<Ml.length;i++)st(Ml[i],r);break;case"source":st("error",r);break;case"img":case"image":case"link":st("error",r),st("load",r);break;case"details":st("toggle",r);break;case"input":ky(r,s),st("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},st("invalid",r);break;case"textarea":by(r,s),st("invalid",r)}qp(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&Hc(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Hc(r.textContent,a,t),i=["children",""+a]):uu.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&st("scroll",r)}switch(n){case"input":Fc(r),Ny(r,s,!0);break;case"textarea":Fc(r),Dy(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=zd)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=II(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Sr]=e,t[vu]=r,WS(t,e,!1,!1),e.stateNode=t;e:{switch(o=zp(n,r),n){case"dialog":st("cancel",t),st("close",t),i=r;break;case"iframe":case"object":case"embed":st("load",t),i=r;break;case"video":case"audio":for(i=0;i<Ml.length;i++)st(Ml[i],t);i=r;break;case"source":st("error",t),i=r;break;case"img":case"image":case"link":st("error",t),st("load",t),i=r;break;case"details":st("toggle",t),i=r;break;case"input":ky(t,r),i=Fp(t,r),st("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=gt({},r,{value:void 0}),st("invalid",t);break;case"textarea":by(t,r),i=Bp(t,r),st("invalid",t);break;default:i=r}qp(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?xI(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&SI(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&cu(t,l):typeof l=="number"&&cu(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(uu.hasOwnProperty(s)?l!=null&&s==="onScroll"&&st("scroll",t):l!=null&&Sg(t,s,l,o))}switch(n){case"input":Fc(t),Ny(t,r,!1);break;case"textarea":Fc(t),Dy(t);break;case"option":r.value!=null&&t.setAttribute("value",""+ns(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?ua(t,!!r.multiple,s,!1):r.defaultValue!=null&&ua(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=zd)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Qt(e),null;case 6:if(t&&e.stateNode!=null)JS(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(ne(166));if(n=Qs(Eu.current),Qs(Rr.current),jc(e)){if(r=e.stateNode,n=e.memoizedProps,r[Sr]=e,(s=r.nodeValue!==n)&&(t=kn,t!==null))switch(t.tag){case 3:Hc(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Hc(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Sr]=e,e.stateNode=r}return Qt(e),null;case 13:if(at(ft),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ct&&Rn!==null&&e.mode&1&&!(e.flags&128))fS(),Sa(),e.flags|=98560,s=!1;else if(s=jc(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(ne(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ne(317));s[Sr]=e}else Sa(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Qt(e),s=!1}else rr!==null&&(Im(rr),rr=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||ft.current&1?Nt===0&&(Nt=3):o_())),e.updateQueue!==null&&(e.flags|=4),Qt(e),null);case 4:return xa(),mm(t,e),t===null&&_u(e.stateNode.containerInfo),Qt(e),null;case 10:return zg(e.type._context),Qt(e),null;case 17:return yn(e.type)&&$d(),Qt(e),null;case 19:if(at(ft),s=e.memoizedState,s===null)return Qt(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)Il(s,!1);else{if(Nt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Yd(t),o!==null){for(e.flags|=128,Il(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return nt(ft,ft.current&1|2),e.child}t=t.sibling}s.tail!==null&&wt()>Ra&&(e.flags|=128,r=!0,Il(s,!1),e.lanes=4194304)}else{if(!r)if(t=Yd(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Il(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!ct)return Qt(e),null}else 2*wt()-s.renderingStartTime>Ra&&n!==1073741824&&(e.flags|=128,r=!0,Il(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=wt(),e.sibling=null,n=ft.current,nt(ft,r?n&1|2:n&1),e):(Qt(e),null);case 22:case 23:return s_(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Cn&1073741824&&(Qt(e),e.subtreeFlags&6&&(e.flags|=8192)):Qt(e),null;case 24:return null;case 25:return null}throw Error(ne(156,e.tag))}function ck(t,e){switch(Og(e),e.tag){case 1:return yn(e.type)&&$d(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return xa(),at(_n),at(rn),Kg(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Wg(e),null;case 13:if(at(ft),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ne(340));Sa()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return at(ft),null;case 4:return xa(),null;case 10:return zg(e.type._context),null;case 22:case 23:return s_(),null;case 24:return null;default:return null}}var Jc=!1,Zt=!1,dk=typeof WeakSet=="function"?WeakSet:Set,le=null;function sa(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){vt(t,e,r)}else n.current=null}function gm(t,e,n){try{n()}catch(r){vt(t,e,r)}}var wv=!1;function hk(t,e){if(Zp=Bd,t=eS(),Fg(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,u=0,f=0,m=t,g=null;t:for(;;){for(var v;m!==n||i!==0&&m.nodeType!==3||(a=o+i),m!==s||r!==0&&m.nodeType!==3||(l=o+r),m.nodeType===3&&(o+=m.nodeValue.length),(v=m.firstChild)!==null;)g=m,m=v;for(;;){if(m===t)break t;if(g===n&&++u===i&&(a=o),g===s&&++f===r&&(l=o),(v=m.nextSibling)!==null)break;m=g,g=m.parentNode}m=v}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(em={focusedElem:t,selectionRange:n},Bd=!1,le=e;le!==null;)if(e=le,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,le=t;else for(;le!==null;){e=le;try{var T=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(T!==null){var P=T.memoizedProps,M=T.memoizedState,x=e.stateNode,E=x.getSnapshotBeforeUpdate(e.elementType===e.type?P:er(e.type,P),M);x.__reactInternalSnapshotBeforeUpdate=E}break;case 3:var A=e.stateNode.containerInfo;A.nodeType===1?A.textContent="":A.nodeType===9&&A.documentElement&&A.removeChild(A.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ne(163))}}catch(V){vt(e,e.return,V)}if(t=e.sibling,t!==null){t.return=e.return,le=t;break}le=e.return}return T=wv,wv=!1,T}function Wl(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&gm(e,n,s)}i=i.next}while(i!==r)}}function zh(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function _m(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function QS(t){var e=t.alternate;e!==null&&(t.alternate=null,QS(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Sr],delete e[vu],delete e[rm],delete e[KP],delete e[JP])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function YS(t){return t.tag===5||t.tag===3||t.tag===4}function Iv(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||YS(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function ym(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=zd));else if(r!==4&&(t=t.child,t!==null))for(ym(t,e,n),t=t.sibling;t!==null;)ym(t,e,n),t=t.sibling}function vm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(vm(t,e,n),t=t.sibling;t!==null;)vm(t,e,n),t=t.sibling}var $t=null,tr=!1;function Si(t,e,n){for(n=n.child;n!==null;)XS(t,e,n),n=n.sibling}function XS(t,e,n){if(Ar&&typeof Ar.onCommitFiberUnmount=="function")try{Ar.onCommitFiberUnmount(Vh,n)}catch{}switch(n.tag){case 5:Zt||sa(n,e);case 6:var r=$t,i=tr;$t=null,Si(t,e,n),$t=r,tr=i,$t!==null&&(tr?(t=$t,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):$t.removeChild(n.stateNode));break;case 18:$t!==null&&(tr?(t=$t,n=n.stateNode,t.nodeType===8?rp(t.parentNode,n):t.nodeType===1&&rp(t,n),pu(t)):rp($t,n.stateNode));break;case 4:r=$t,i=tr,$t=n.stateNode.containerInfo,tr=!0,Si(t,e,n),$t=r,tr=i;break;case 0:case 11:case 14:case 15:if(!Zt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&gm(n,e,o),i=i.next}while(i!==r)}Si(t,e,n);break;case 1:if(!Zt&&(sa(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){vt(n,e,a)}Si(t,e,n);break;case 21:Si(t,e,n);break;case 22:n.mode&1?(Zt=(r=Zt)||n.memoizedState!==null,Si(t,e,n),Zt=r):Si(t,e,n);break;default:Si(t,e,n)}}function Sv(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new dk),e.forEach(function(r){var i=Ek.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Zn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:$t=a.stateNode,tr=!1;break e;case 3:$t=a.stateNode.containerInfo,tr=!0;break e;case 4:$t=a.stateNode.containerInfo,tr=!0;break e}a=a.return}if($t===null)throw Error(ne(160));XS(s,o,i),$t=null,tr=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){vt(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)ZS(e,t),e=e.sibling}function ZS(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Zn(e,t),Er(t),r&4){try{Wl(3,t,t.return),zh(3,t)}catch(P){vt(t,t.return,P)}try{Wl(5,t,t.return)}catch(P){vt(t,t.return,P)}}break;case 1:Zn(e,t),Er(t),r&512&&n!==null&&sa(n,n.return);break;case 5:if(Zn(e,t),Er(t),r&512&&n!==null&&sa(n,n.return),t.flags&32){var i=t.stateNode;try{cu(i,"")}catch(P){vt(t,t.return,P)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&EI(i,s),zp(a,o);var u=zp(a,s);for(o=0;o<l.length;o+=2){var f=l[o],m=l[o+1];f==="style"?xI(i,m):f==="dangerouslySetInnerHTML"?SI(i,m):f==="children"?cu(i,m):Sg(i,f,m,u)}switch(a){case"input":Up(i,s);break;case"textarea":wI(i,s);break;case"select":var g=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var v=s.value;v!=null?ua(i,!!s.multiple,v,!1):g!==!!s.multiple&&(s.defaultValue!=null?ua(i,!!s.multiple,s.defaultValue,!0):ua(i,!!s.multiple,s.multiple?[]:"",!1))}i[vu]=s}catch(P){vt(t,t.return,P)}}break;case 6:if(Zn(e,t),Er(t),r&4){if(t.stateNode===null)throw Error(ne(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(P){vt(t,t.return,P)}}break;case 3:if(Zn(e,t),Er(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{pu(e.containerInfo)}catch(P){vt(t,t.return,P)}break;case 4:Zn(e,t),Er(t);break;case 13:Zn(e,t),Er(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(r_=wt())),r&4&&Sv(t);break;case 22:if(f=n!==null&&n.memoizedState!==null,t.mode&1?(Zt=(u=Zt)||f,Zn(e,t),Zt=u):Zn(e,t),Er(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!f&&t.mode&1)for(le=t,f=t.child;f!==null;){for(m=le=f;le!==null;){switch(g=le,v=g.child,g.tag){case 0:case 11:case 14:case 15:Wl(4,g,g.return);break;case 1:sa(g,g.return);var T=g.stateNode;if(typeof T.componentWillUnmount=="function"){r=g,n=g.return;try{e=r,T.props=e.memoizedProps,T.state=e.memoizedState,T.componentWillUnmount()}catch(P){vt(r,n,P)}}break;case 5:sa(g,g.return);break;case 22:if(g.memoizedState!==null){xv(m);continue}}v!==null?(v.return=g,le=v):xv(m)}f=f.sibling}e:for(f=null,m=t;;){if(m.tag===5){if(f===null){f=m;try{i=m.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=m.stateNode,l=m.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=CI("display",o))}catch(P){vt(t,t.return,P)}}}else if(m.tag===6){if(f===null)try{m.stateNode.nodeValue=u?"":m.memoizedProps}catch(P){vt(t,t.return,P)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===t)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===t)break e;for(;m.sibling===null;){if(m.return===null||m.return===t)break e;f===m&&(f=null),m=m.return}f===m&&(f=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:Zn(e,t),Er(t),r&4&&Sv(t);break;case 21:break;default:Zn(e,t),Er(t)}}function Er(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(YS(n)){var r=n;break e}n=n.return}throw Error(ne(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(cu(i,""),r.flags&=-33);var s=Iv(t);vm(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=Iv(t);ym(t,a,o);break;default:throw Error(ne(161))}}catch(l){vt(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function fk(t,e,n){le=t,eC(t)}function eC(t,e,n){for(var r=(t.mode&1)!==0;le!==null;){var i=le,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||Jc;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||Zt;a=Jc;var u=Zt;if(Jc=o,(Zt=l)&&!u)for(le=i;le!==null;)o=le,l=o.child,o.tag===22&&o.memoizedState!==null?Av(i):l!==null?(l.return=o,le=l):Av(i);for(;s!==null;)le=s,eC(s),s=s.sibling;le=i,Jc=a,Zt=u}Cv(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,le=s):Cv(t)}}function Cv(t){for(;le!==null;){var e=le;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Zt||zh(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Zt)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:er(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&uv(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}uv(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var f=u.memoizedState;if(f!==null){var m=f.dehydrated;m!==null&&pu(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ne(163))}Zt||e.flags&512&&_m(e)}catch(g){vt(e,e.return,g)}}if(e===t){le=null;break}if(n=e.sibling,n!==null){n.return=e.return,le=n;break}le=e.return}}function xv(t){for(;le!==null;){var e=le;if(e===t){le=null;break}var n=e.sibling;if(n!==null){n.return=e.return,le=n;break}le=e.return}}function Av(t){for(;le!==null;){var e=le;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{zh(4,e)}catch(l){vt(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){vt(e,i,l)}}var s=e.return;try{_m(e)}catch(l){vt(e,s,l)}break;case 5:var o=e.return;try{_m(e)}catch(l){vt(e,o,l)}}}catch(l){vt(e,e.return,l)}if(e===t){le=null;break}var a=e.sibling;if(a!==null){a.return=e.return,le=a;break}le=e.return}}var pk=Math.ceil,eh=ai.ReactCurrentDispatcher,t_=ai.ReactCurrentOwner,zn=ai.ReactCurrentBatchConfig,Be=0,Ot=null,xt=null,Wt=0,Cn=0,oa=hs(0),Nt=0,Cu=null,lo=0,$h=0,n_=0,Kl=null,pn=null,r_=0,Ra=1/0,zr=null,th=!1,Tm=null,ji=null,Qc=!1,Oi=null,nh=0,Jl=0,Em=null,md=-1,gd=0;function ln(){return Be&6?wt():md!==-1?md:md=wt()}function Wi(t){return t.mode&1?Be&2&&Wt!==0?Wt&-Wt:YP.transition!==null?(gd===0&&(gd=UI()),gd):(t=Ye,t!==0||(t=window.event,t=t===void 0?16:HI(t.type)),t):1}function ar(t,e,n,r){if(50<Jl)throw Jl=0,Em=null,Error(ne(185));Gu(t,n,r),(!(Be&2)||t!==Ot)&&(t===Ot&&(!(Be&2)&&($h|=n),Nt===4&&Di(t,Wt)),vn(t,r),n===1&&Be===0&&!(e.mode&1)&&(Ra=wt()+500,Bh&&fs()))}function vn(t,e){var n=t.callbackNode;YR(t,e);var r=Od(t,t===Ot?Wt:0);if(r===0)n!==null&&Ly(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Ly(n),e===1)t.tag===0?QP(Rv.bind(null,t)):cS(Rv.bind(null,t)),jP(function(){!(Be&6)&&fs()}),n=null;else{switch(OI(r)){case 1:n=Pg;break;case 4:n=LI;break;case 16:n=Ud;break;case 536870912:n=FI;break;default:n=Ud}n=lC(n,tC.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function tC(t,e){if(md=-1,gd=0,Be&6)throw Error(ne(327));var n=t.callbackNode;if(pa()&&t.callbackNode!==n)return null;var r=Od(t,t===Ot?Wt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=rh(t,r);else{e=r;var i=Be;Be|=2;var s=rC();(Ot!==t||Wt!==e)&&(zr=null,Ra=wt()+500,Zs(t,e));do try{_k();break}catch(a){nC(t,a)}while(!0);qg(),eh.current=s,Be=i,xt!==null?e=0:(Ot=null,Wt=0,e=Nt)}if(e!==0){if(e===2&&(i=Kp(t),i!==0&&(r=i,e=wm(t,i))),e===1)throw n=Cu,Zs(t,0),Di(t,r),vn(t,wt()),n;if(e===6)Di(t,r);else{if(i=t.current.alternate,!(r&30)&&!mk(i)&&(e=rh(t,r),e===2&&(s=Kp(t),s!==0&&(r=s,e=wm(t,s))),e===1))throw n=Cu,Zs(t,0),Di(t,r),vn(t,wt()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(ne(345));case 2:Os(t,pn,zr);break;case 3:if(Di(t,r),(r&130023424)===r&&(e=r_+500-wt(),10<e)){if(Od(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){ln(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=nm(Os.bind(null,t,pn,zr),e);break}Os(t,pn,zr);break;case 4:if(Di(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-or(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=wt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*pk(r/1960))-r,10<r){t.timeoutHandle=nm(Os.bind(null,t,pn,zr),r);break}Os(t,pn,zr);break;case 5:Os(t,pn,zr);break;default:throw Error(ne(329))}}}return vn(t,wt()),t.callbackNode===n?tC.bind(null,t):null}function wm(t,e){var n=Kl;return t.current.memoizedState.isDehydrated&&(Zs(t,e).flags|=256),t=rh(t,e),t!==2&&(e=pn,pn=n,e!==null&&Im(e)),t}function Im(t){pn===null?pn=t:pn.push.apply(pn,t)}function mk(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!dr(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Di(t,e){for(e&=~n_,e&=~$h,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-or(e),r=1<<n;t[n]=-1,e&=~r}}function Rv(t){if(Be&6)throw Error(ne(327));pa();var e=Od(t,0);if(!(e&1))return vn(t,wt()),null;var n=rh(t,e);if(t.tag!==0&&n===2){var r=Kp(t);r!==0&&(e=r,n=wm(t,r))}if(n===1)throw n=Cu,Zs(t,0),Di(t,e),vn(t,wt()),n;if(n===6)throw Error(ne(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Os(t,pn,zr),vn(t,wt()),null}function i_(t,e){var n=Be;Be|=1;try{return t(e)}finally{Be=n,Be===0&&(Ra=wt()+500,Bh&&fs())}}function uo(t){Oi!==null&&Oi.tag===0&&!(Be&6)&&pa();var e=Be;Be|=1;var n=zn.transition,r=Ye;try{if(zn.transition=null,Ye=1,t)return t()}finally{Ye=r,zn.transition=n,Be=e,!(Be&6)&&fs()}}function s_(){Cn=oa.current,at(oa)}function Zs(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,HP(n)),xt!==null)for(n=xt.return;n!==null;){var r=n;switch(Og(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&$d();break;case 3:xa(),at(_n),at(rn),Kg();break;case 5:Wg(r);break;case 4:xa();break;case 13:at(ft);break;case 19:at(ft);break;case 10:zg(r.type._context);break;case 22:case 23:s_()}n=n.return}if(Ot=t,xt=t=Ki(t.current,null),Wt=Cn=e,Nt=0,Cu=null,n_=$h=lo=0,pn=Kl=null,Js!==null){for(e=0;e<Js.length;e++)if(n=Js[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}Js=null}return t}function nC(t,e){do{var n=xt;try{if(qg(),hd.current=Zd,Xd){for(var r=mt.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Xd=!1}if(ao=0,Ut=kt=mt=null,jl=!1,wu=0,t_.current=null,n===null||n.return===null){Nt=1,Cu=e,xt=null;break}e:{var s=t,o=n.return,a=n,l=e;if(e=Wt,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,f=a,m=f.tag;if(!(f.mode&1)&&(m===0||m===11||m===15)){var g=f.alternate;g?(f.updateQueue=g.updateQueue,f.memoizedState=g.memoizedState,f.lanes=g.lanes):(f.updateQueue=null,f.memoizedState=null)}var v=mv(o);if(v!==null){v.flags&=-257,gv(v,o,a,s,e),v.mode&1&&pv(s,u,e),e=v,l=u;var T=e.updateQueue;if(T===null){var P=new Set;P.add(l),e.updateQueue=P}else T.add(l);break e}else{if(!(e&1)){pv(s,u,e),o_();break e}l=Error(ne(426))}}else if(ct&&a.mode&1){var M=mv(o);if(M!==null){!(M.flags&65536)&&(M.flags|=256),gv(M,o,a,s,e),Bg(Aa(l,a));break e}}s=l=Aa(l,a),Nt!==4&&(Nt=2),Kl===null?Kl=[s]:Kl.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var x=OS(s,l,e);lv(s,x);break e;case 1:a=l;var E=s.type,A=s.stateNode;if(!(s.flags&128)&&(typeof E.getDerivedStateFromError=="function"||A!==null&&typeof A.componentDidCatch=="function"&&(ji===null||!ji.has(A)))){s.flags|=65536,e&=-e,s.lanes|=e;var V=BS(s,a,e);lv(s,V);break e}}s=s.return}while(s!==null)}sC(n)}catch(B){e=B,xt===n&&n!==null&&(xt=n=n.return);continue}break}while(!0)}function rC(){var t=eh.current;return eh.current=Zd,t===null?Zd:t}function o_(){(Nt===0||Nt===3||Nt===2)&&(Nt=4),Ot===null||!(lo&268435455)&&!($h&268435455)||Di(Ot,Wt)}function rh(t,e){var n=Be;Be|=2;var r=rC();(Ot!==t||Wt!==e)&&(zr=null,Zs(t,e));do try{gk();break}catch(i){nC(t,i)}while(!0);if(qg(),Be=n,eh.current=r,xt!==null)throw Error(ne(261));return Ot=null,Wt=0,Nt}function gk(){for(;xt!==null;)iC(xt)}function _k(){for(;xt!==null&&!qR();)iC(xt)}function iC(t){var e=aC(t.alternate,t,Cn);t.memoizedProps=t.pendingProps,e===null?sC(t):xt=e,t_.current=null}function sC(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=ck(n,e),n!==null){n.flags&=32767,xt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Nt=6,xt=null;return}}else if(n=uk(n,e,Cn),n!==null){xt=n;return}if(e=e.sibling,e!==null){xt=e;return}xt=e=t}while(e!==null);Nt===0&&(Nt=5)}function Os(t,e,n){var r=Ye,i=zn.transition;try{zn.transition=null,Ye=1,yk(t,e,n,r)}finally{zn.transition=i,Ye=r}return null}function yk(t,e,n,r){do pa();while(Oi!==null);if(Be&6)throw Error(ne(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(ne(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(XR(t,s),t===Ot&&(xt=Ot=null,Wt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Qc||(Qc=!0,lC(Ud,function(){return pa(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=zn.transition,zn.transition=null;var o=Ye;Ye=1;var a=Be;Be|=4,t_.current=null,hk(t,n),ZS(n,t),UP(em),Bd=!!Zp,em=Zp=null,t.current=n,fk(n),zR(),Be=a,Ye=o,zn.transition=s}else t.current=n;if(Qc&&(Qc=!1,Oi=t,nh=i),s=t.pendingLanes,s===0&&(ji=null),jR(n.stateNode),vn(t,wt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(th)throw th=!1,t=Tm,Tm=null,t;return nh&1&&t.tag!==0&&pa(),s=t.pendingLanes,s&1?t===Em?Jl++:(Jl=0,Em=t):Jl=0,fs(),null}function pa(){if(Oi!==null){var t=OI(nh),e=zn.transition,n=Ye;try{if(zn.transition=null,Ye=16>t?16:t,Oi===null)var r=!1;else{if(t=Oi,Oi=null,nh=0,Be&6)throw Error(ne(331));var i=Be;for(Be|=4,le=t.current;le!==null;){var s=le,o=s.child;if(le.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(le=u;le!==null;){var f=le;switch(f.tag){case 0:case 11:case 15:Wl(8,f,s)}var m=f.child;if(m!==null)m.return=f,le=m;else for(;le!==null;){f=le;var g=f.sibling,v=f.return;if(QS(f),f===u){le=null;break}if(g!==null){g.return=v,le=g;break}le=v}}}var T=s.alternate;if(T!==null){var P=T.child;if(P!==null){T.child=null;do{var M=P.sibling;P.sibling=null,P=M}while(P!==null)}}le=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,le=o;else e:for(;le!==null;){if(s=le,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Wl(9,s,s.return)}var x=s.sibling;if(x!==null){x.return=s.return,le=x;break e}le=s.return}}var E=t.current;for(le=E;le!==null;){o=le;var A=o.child;if(o.subtreeFlags&2064&&A!==null)A.return=o,le=A;else e:for(o=E;le!==null;){if(a=le,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:zh(9,a)}}catch(B){vt(a,a.return,B)}if(a===o){le=null;break e}var V=a.sibling;if(V!==null){V.return=a.return,le=V;break e}le=a.return}}if(Be=i,fs(),Ar&&typeof Ar.onPostCommitFiberRoot=="function")try{Ar.onPostCommitFiberRoot(Vh,t)}catch{}r=!0}return r}finally{Ye=n,zn.transition=e}}return!1}function Pv(t,e,n){e=Aa(n,e),e=OS(t,e,1),t=Hi(t,e,1),e=ln(),t!==null&&(Gu(t,1,e),vn(t,e))}function vt(t,e,n){if(t.tag===3)Pv(t,t,n);else for(;e!==null;){if(e.tag===3){Pv(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(ji===null||!ji.has(r))){t=Aa(n,t),t=BS(e,t,1),e=Hi(e,t,1),t=ln(),e!==null&&(Gu(e,1,t),vn(e,t));break}}e=e.return}}function vk(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=ln(),t.pingedLanes|=t.suspendedLanes&n,Ot===t&&(Wt&n)===n&&(Nt===4||Nt===3&&(Wt&130023424)===Wt&&500>wt()-r_?Zs(t,0):n_|=n),vn(t,e)}function oC(t,e){e===0&&(t.mode&1?(e=Bc,Bc<<=1,!(Bc&130023424)&&(Bc=4194304)):e=1);var n=ln();t=ti(t,e),t!==null&&(Gu(t,e,n),vn(t,n))}function Tk(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),oC(t,n)}function Ek(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(ne(314))}r!==null&&r.delete(e),oC(t,n)}var aC;aC=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||_n.current)mn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return mn=!1,lk(t,e,n);mn=!!(t.flags&131072)}else mn=!1,ct&&e.flags&1048576&&dS(e,Wd,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;pd(t,e),t=e.pendingProps;var i=Ia(e,rn.current);fa(e,n),i=Qg(null,e,r,t,i,n);var s=Yg();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,yn(r)?(s=!0,Hd(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Hg(e),i.updater=qh,e.stateNode=i,i._reactInternals=e,um(e,r,t,n),e=hm(null,e,r,!0,s,n)):(e.tag=0,ct&&s&&Ug(e),sn(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(pd(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=Ik(r),t=er(r,t),i){case 0:e=dm(null,e,r,t,n);break e;case 1:e=vv(null,e,r,t,n);break e;case 11:e=_v(null,e,r,t,n);break e;case 14:e=yv(null,e,r,er(r.type,t),n);break e}throw Error(ne(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:er(r,i),dm(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:er(r,i),vv(t,e,r,i,n);case 3:e:{if($S(e),t===null)throw Error(ne(387));r=e.pendingProps,s=e.memoizedState,i=s.element,_S(t,e),Qd(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Aa(Error(ne(423)),e),e=Tv(t,e,r,n,i);break e}else if(r!==i){i=Aa(Error(ne(424)),e),e=Tv(t,e,r,n,i);break e}else for(Rn=$i(e.stateNode.containerInfo.firstChild),kn=e,ct=!0,rr=null,n=mS(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Sa(),r===i){e=ni(t,e,n);break e}sn(t,e,r,n)}e=e.child}return e;case 5:return yS(e),t===null&&om(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,tm(r,i)?o=null:s!==null&&tm(r,s)&&(e.flags|=32),zS(t,e),sn(t,e,o,n),e.child;case 6:return t===null&&om(e),null;case 13:return HS(t,e,n);case 4:return jg(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Ca(e,null,r,n):sn(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:er(r,i),_v(t,e,r,i,n);case 7:return sn(t,e,e.pendingProps,n),e.child;case 8:return sn(t,e,e.pendingProps.children,n),e.child;case 12:return sn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,nt(Kd,r._currentValue),r._currentValue=o,s!==null)if(dr(s.value,o)){if(s.children===i.children&&!_n.current){e=ni(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=Yr(-1,n&-n),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var f=u.pending;f===null?l.next=l:(l.next=f.next,f.next=l),u.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),am(s.return,n,e),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(ne(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),am(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}sn(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,fa(e,n),i=jn(i),r=r(i),e.flags|=1,sn(t,e,r,n),e.child;case 14:return r=e.type,i=er(r,e.pendingProps),i=er(r.type,i),yv(t,e,r,i,n);case 15:return GS(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:er(r,i),pd(t,e),e.tag=1,yn(r)?(t=!0,Hd(e)):t=!1,fa(e,n),US(e,r,i),um(e,r,i,n),hm(null,e,r,!0,t,n);case 19:return jS(t,e,n);case 22:return qS(t,e,n)}throw Error(ne(156,e.tag))};function lC(t,e){return VI(t,e)}function wk(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bn(t,e,n,r){return new wk(t,e,n,r)}function a_(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Ik(t){if(typeof t=="function")return a_(t)?1:0;if(t!=null){if(t=t.$$typeof,t===xg)return 11;if(t===Ag)return 14}return 2}function Ki(t,e){var n=t.alternate;return n===null?(n=Bn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function _d(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")a_(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Qo:return eo(n.children,i,s,e);case Cg:o=8,i|=8;break;case Dp:return t=Bn(12,n,e,i|2),t.elementType=Dp,t.lanes=s,t;case Mp:return t=Bn(13,n,e,i),t.elementType=Mp,t.lanes=s,t;case Vp:return t=Bn(19,n,e,i),t.elementType=Vp,t.lanes=s,t;case yI:return Hh(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case gI:o=10;break e;case _I:o=9;break e;case xg:o=11;break e;case Ag:o=14;break e;case ki:o=16,r=null;break e}throw Error(ne(130,t==null?t:typeof t,""))}return e=Bn(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function eo(t,e,n,r){return t=Bn(7,t,r,e),t.lanes=n,t}function Hh(t,e,n,r){return t=Bn(22,t,r,e),t.elementType=yI,t.lanes=n,t.stateNode={isHidden:!1},t}function dp(t,e,n){return t=Bn(6,t,null,e),t.lanes=n,t}function hp(t,e,n){return e=Bn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Sk(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=jf(0),this.expirationTimes=jf(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=jf(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function l_(t,e,n,r,i,s,o,a,l){return t=new Sk(t,e,n,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Bn(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Hg(s),t}function Ck(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Jo,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function uC(t){if(!t)return rs;t=t._reactInternals;e:{if(Eo(t)!==t||t.tag!==1)throw Error(ne(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(yn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ne(171))}if(t.tag===1){var n=t.type;if(yn(n))return uS(t,n,e)}return e}function cC(t,e,n,r,i,s,o,a,l){return t=l_(n,r,!0,t,i,s,o,a,l),t.context=uC(null),n=t.current,r=ln(),i=Wi(n),s=Yr(r,i),s.callback=e??null,Hi(n,s,i),t.current.lanes=i,Gu(t,i,r),vn(t,r),t}function jh(t,e,n,r){var i=e.current,s=ln(),o=Wi(i);return n=uC(n),e.context===null?e.context=n:e.pendingContext=n,e=Yr(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Hi(i,e,o),t!==null&&(ar(t,i,o,s),dd(t,i,o)),o}function ih(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function kv(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function u_(t,e){kv(t,e),(t=t.alternate)&&kv(t,e)}function xk(){return null}var dC=typeof reportError=="function"?reportError:function(t){console.error(t)};function c_(t){this._internalRoot=t}Wh.prototype.render=c_.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ne(409));jh(t,e,null,null)};Wh.prototype.unmount=c_.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;uo(function(){jh(null,t,null,null)}),e[ei]=null}};function Wh(t){this._internalRoot=t}Wh.prototype.unstable_scheduleHydration=function(t){if(t){var e=qI();t={blockedOn:null,target:t,priority:e};for(var n=0;n<bi.length&&e!==0&&e<bi[n].priority;n++);bi.splice(n,0,t),n===0&&$I(t)}};function d_(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Kh(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Nv(){}function Ak(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var u=ih(o);s.call(u)}}var o=cC(e,r,t,0,null,!1,!1,"",Nv);return t._reactRootContainer=o,t[ei]=o.current,_u(t.nodeType===8?t.parentNode:t),uo(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var u=ih(l);a.call(u)}}var l=l_(t,0,!1,null,null,!1,!1,"",Nv);return t._reactRootContainer=l,t[ei]=l.current,_u(t.nodeType===8?t.parentNode:t),uo(function(){jh(e,l,n,r)}),l}function Jh(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=ih(o);a.call(l)}}jh(e,o,t,i)}else o=Ak(n,e,t,i,r);return ih(o)}BI=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Dl(e.pendingLanes);n!==0&&(kg(e,n|1),vn(e,wt()),!(Be&6)&&(Ra=wt()+500,fs()))}break;case 13:uo(function(){var r=ti(t,1);if(r!==null){var i=ln();ar(r,t,1,i)}}),u_(t,1)}};Ng=function(t){if(t.tag===13){var e=ti(t,134217728);if(e!==null){var n=ln();ar(e,t,134217728,n)}u_(t,134217728)}};GI=function(t){if(t.tag===13){var e=Wi(t),n=ti(t,e);if(n!==null){var r=ln();ar(n,t,e,r)}u_(t,e)}};qI=function(){return Ye};zI=function(t,e){var n=Ye;try{return Ye=t,e()}finally{Ye=n}};Hp=function(t,e,n){switch(e){case"input":if(Up(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=Oh(r);if(!i)throw Error(ne(90));TI(r),Up(r,i)}}}break;case"textarea":wI(t,n);break;case"select":e=n.value,e!=null&&ua(t,!!n.multiple,e,!1)}};PI=i_;kI=uo;var Rk={usingClientEntryPoint:!1,Events:[zu,ea,Oh,AI,RI,i_]},Sl={findFiberByHostInstance:Ks,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Pk={bundleType:Sl.bundleType,version:Sl.version,rendererPackageName:Sl.rendererPackageName,rendererConfig:Sl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ai.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=DI(t),t===null?null:t.stateNode},findFiberByHostInstance:Sl.findFiberByHostInstance||xk,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Yc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Yc.isDisabled&&Yc.supportsFiber)try{Vh=Yc.inject(Pk),Ar=Yc}catch{}}Dn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Rk;Dn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d_(e))throw Error(ne(200));return Ck(t,e,null,n)};Dn.createRoot=function(t,e){if(!d_(t))throw Error(ne(299));var n=!1,r="",i=dC;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=l_(t,1,!1,null,null,n,!1,r,i),t[ei]=e.current,_u(t.nodeType===8?t.parentNode:t),new c_(e)};Dn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ne(188)):(t=Object.keys(t).join(","),Error(ne(268,t)));return t=DI(e),t=t===null?null:t.stateNode,t};Dn.flushSync=function(t){return uo(t)};Dn.hydrate=function(t,e,n){if(!Kh(e))throw Error(ne(200));return Jh(null,t,e,!0,n)};Dn.hydrateRoot=function(t,e,n){if(!d_(t))throw Error(ne(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=dC;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=cC(e,null,t,1,n??null,i,!1,s,o),t[ei]=e.current,_u(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new Wh(e)};Dn.render=function(t,e,n){if(!Kh(e))throw Error(ne(200));return Jh(null,t,e,!1,n)};Dn.unmountComponentAtNode=function(t){if(!Kh(t))throw Error(ne(40));return t._reactRootContainer?(uo(function(){Jh(null,null,t,!1,function(){t._reactRootContainer=null,t[ei]=null})}),!0):!1};Dn.unstable_batchedUpdates=i_;Dn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Kh(n))throw Error(ne(200));if(t==null||t._reactInternals===void 0)throw Error(ne(38));return Jh(t,e,n,!1,r)};Dn.version="18.3.1-next-f1338f8080-20240426";function hC(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(hC)}catch(t){console.error(t)}}hC(),hI.exports=Dn;var kk=hI.exports,bv=kk;Np.createRoot=bv.createRoot,Np.hydrateRoot=bv.hydrateRoot;/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let Nk,bk;function Dk(){return{geminiUrl:Nk,vertexUrl:bk}}function Mk(t,e,n,r){var i,s;if(!(t!=null&&t.baseUrl)){const o=Dk();return e?(i=o.vertexUrl)!==null&&i!==void 0?i:n:(s=o.geminiUrl)!==null&&s!==void 0?s:r}return t.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class wo{}function de(t,e){const n=/\{([^}]+)\}/g;return t.replace(n,(r,i)=>{if(Object.prototype.hasOwnProperty.call(e,i)){const s=e[i];return s!=null?String(s):""}else throw new Error(`Key '${i}' not found in valueMap.`)})}function h(t,e,n){for(let s=0;s<e.length-1;s++){const o=e[s];if(o.endsWith("[]")){const a=o.slice(0,-2);if(!(a in t))if(Array.isArray(n))t[a]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${o}`);if(Array.isArray(t[a])){const l=t[a];if(Array.isArray(n))for(let u=0;u<l.length;u++){const f=l[u];h(f,e.slice(s+1),n[u])}else for(const u of l)h(u,e.slice(s+1),n)}return}else if(o.endsWith("[0]")){const a=o.slice(0,-3);a in t||(t[a]=[{}]);const l=t[a];h(l[0],e.slice(s+1),n);return}(!t[o]||typeof t[o]!="object")&&(t[o]={}),t=t[o]}const r=e[e.length-1],i=t[r];if(i!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===i)return;if(typeof i=="object"&&typeof n=="object"&&i!==null&&n!==null)Object.assign(i,n);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else r==="_self"&&typeof n=="object"&&n!==null&&!Array.isArray(n)?Object.assign(t,n):t[r]=n}function d(t,e,n=void 0){try{if(e.length===1&&e[0]==="_self")return t;for(let r=0;r<e.length;r++){if(typeof t!="object"||t===null)return n;const i=e[r];if(i.endsWith("[]")){const s=i.slice(0,-2);if(s in t){const o=t[s];return Array.isArray(o)?o.map(a=>d(a,e.slice(r+1),n)):n}else return n}else t=t[i]}return t}catch(r){if(r instanceof TypeError)return n;throw r}}function Vk(t,e){for(const[n,r]of Object.entries(e)){const i=n.split("."),s=r.split("."),o=new Set;let a=-1;for(let l=0;l<i.length;l++)if(i[l]==="*"){a=l;break}if(a!==-1&&s.length>a)for(let l=a;l<s.length;l++){const u=s[l];u!=="*"&&!u.endsWith("[]")&&!u.endsWith("[0]")&&o.add(u)}Sm(t,i,s,0,o)}}function Sm(t,e,n,r,i){if(r>=e.length||typeof t!="object"||t===null)return;const s=e[r];if(s.endsWith("[]")){const o=s.slice(0,-2),a=t;if(o in a&&Array.isArray(a[o]))for(const l of a[o])Sm(l,e,n,r+1,i)}else if(s==="*"){if(typeof t=="object"&&t!==null&&!Array.isArray(t)){const o=t,a=Object.keys(o).filter(u=>!u.startsWith("_")&&!i.has(u)),l={};for(const u of a)l[u]=o[u];for(const[u,f]of Object.entries(l)){const m=[];for(const g of n.slice(r))g==="*"?m.push(u):m.push(g);h(o,m,f)}for(const u of a)delete o[u]}}else{const o=t;s in o&&Sm(o[s],e,n,r+1,i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function h_(t){if(typeof t!="string")throw new Error("fromImageBytes must be a string");return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Lk(t){const e={},n=d(t,["operationName"]);n!=null&&h(e,["operationName"],n);const r=d(t,["resourceName"]);return r!=null&&h(e,["_url","resourceName"],r),e}function Fk(t){const e={},n=d(t,["name"]);n!=null&&h(e,["name"],n);const r=d(t,["metadata"]);r!=null&&h(e,["metadata"],r);const i=d(t,["done"]);i!=null&&h(e,["done"],i);const s=d(t,["error"]);s!=null&&h(e,["error"],s);const o=d(t,["response","generateVideoResponse"]);return o!=null&&h(e,["response"],Ok(o)),e}function Uk(t){const e={},n=d(t,["name"]);n!=null&&h(e,["name"],n);const r=d(t,["metadata"]);r!=null&&h(e,["metadata"],r);const i=d(t,["done"]);i!=null&&h(e,["done"],i);const s=d(t,["error"]);s!=null&&h(e,["error"],s);const o=d(t,["response"]);return o!=null&&h(e,["response"],Bk(o)),e}function Ok(t){const e={},n=d(t,["generatedSamples"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>Gk(o))),h(e,["generatedVideos"],s)}const r=d(t,["raiMediaFilteredCount"]);r!=null&&h(e,["raiMediaFilteredCount"],r);const i=d(t,["raiMediaFilteredReasons"]);return i!=null&&h(e,["raiMediaFilteredReasons"],i),e}function Bk(t){const e={},n=d(t,["videos"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>qk(o))),h(e,["generatedVideos"],s)}const r=d(t,["raiMediaFilteredCount"]);r!=null&&h(e,["raiMediaFilteredCount"],r);const i=d(t,["raiMediaFilteredReasons"]);return i!=null&&h(e,["raiMediaFilteredReasons"],i),e}function Gk(t){const e={},n=d(t,["video"]);return n!=null&&h(e,["video"],Hk(n)),e}function qk(t){const e={},n=d(t,["_self"]);return n!=null&&h(e,["video"],jk(n)),e}function zk(t){const e={},n=d(t,["operationName"]);return n!=null&&h(e,["_url","operationName"],n),e}function $k(t){const e={},n=d(t,["operationName"]);return n!=null&&h(e,["_url","operationName"],n),e}function Hk(t){const e={},n=d(t,["uri"]);n!=null&&h(e,["uri"],n);const r=d(t,["encodedVideo"]);r!=null&&h(e,["videoBytes"],h_(r));const i=d(t,["encoding"]);return i!=null&&h(e,["mimeType"],i),e}function jk(t){const e={},n=d(t,["gcsUri"]);n!=null&&h(e,["uri"],n);const r=d(t,["bytesBase64Encoded"]);r!=null&&h(e,["videoBytes"],h_(r));const i=d(t,["mimeType"]);return i!=null&&h(e,["mimeType"],i),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Dv;(function(t){t.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",t.OUTCOME_OK="OUTCOME_OK",t.OUTCOME_FAILED="OUTCOME_FAILED",t.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Dv||(Dv={}));var Mv;(function(t){t.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",t.PYTHON="PYTHON"})(Mv||(Mv={}));var Vv;(function(t){t.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",t.SILENT="SILENT",t.WHEN_IDLE="WHEN_IDLE",t.INTERRUPT="INTERRUPT"})(Vv||(Vv={}));var Gn;(function(t){t.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",t.STRING="STRING",t.NUMBER="NUMBER",t.INTEGER="INTEGER",t.BOOLEAN="BOOLEAN",t.ARRAY="ARRAY",t.OBJECT="OBJECT",t.NULL="NULL"})(Gn||(Gn={}));var Lv;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(Lv||(Lv={}));var Fv;(function(t){t.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",t.NO_AUTH="NO_AUTH",t.API_KEY_AUTH="API_KEY_AUTH",t.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",t.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",t.OAUTH="OAUTH",t.OIDC_AUTH="OIDC_AUTH"})(Fv||(Fv={}));var Uv;(function(t){t.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",t.SIMPLE_SEARCH="SIMPLE_SEARCH",t.ELASTIC_SEARCH="ELASTIC_SEARCH"})(Uv||(Uv={}));var Ov;(function(t){t.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",t.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",t.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",t.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",t.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",t.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",t.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",t.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",t.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(Ov||(Ov={}));var Bv;(function(t){t.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",t.SEVERITY="SEVERITY",t.PROBABILITY="PROBABILITY"})(Bv||(Bv={}));var Gv;(function(t){t.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE",t.OFF="OFF"})(Gv||(Gv={}));var qv;(function(t){t.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.LANGUAGE="LANGUAGE",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.SPII="SPII",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.IMAGE_SAFETY="IMAGE_SAFETY",t.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",t.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",t.NO_IMAGE="NO_IMAGE"})(qv||(qv={}));var zv;(function(t){t.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",t.NEGLIGIBLE="NEGLIGIBLE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH"})(zv||(zv={}));var $v;(function(t){t.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",t.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",t.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",t.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",t.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})($v||($v={}));var Hv;(function(t){t.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",t.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",t.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",t.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",t.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(Hv||(Hv={}));var jv;(function(t){t.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",t.SAFETY="SAFETY",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.IMAGE_SAFETY="IMAGE_SAFETY",t.MODEL_ARMOR="MODEL_ARMOR",t.JAILBREAK="JAILBREAK"})(jv||(jv={}));var Wv;(function(t){t.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",t.ON_DEMAND="ON_DEMAND",t.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(Wv||(Wv={}));var sh;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.AUDIO="AUDIO"})(sh||(sh={}));var Kv;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(Kv||(Kv={}));var Jv;(function(t){t.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",t.TUNING_MODE_FULL="TUNING_MODE_FULL",t.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(Jv||(Jv={}));var Qv;(function(t){t.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",t.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",t.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",t.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",t.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",t.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",t.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(Qv||(Qv={}));var Cm;(function(t){t.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",t.JOB_STATE_QUEUED="JOB_STATE_QUEUED",t.JOB_STATE_PENDING="JOB_STATE_PENDING",t.JOB_STATE_RUNNING="JOB_STATE_RUNNING",t.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",t.JOB_STATE_FAILED="JOB_STATE_FAILED",t.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",t.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",t.JOB_STATE_PAUSED="JOB_STATE_PAUSED",t.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",t.JOB_STATE_UPDATING="JOB_STATE_UPDATING",t.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Cm||(Cm={}));var Yv;(function(t){t.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",t.TUNING_TASK_I2V="TUNING_TASK_I2V",t.TUNING_TASK_T2V="TUNING_TASK_T2V"})(Yv||(Yv={}));var Xv;(function(t){t.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",t.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",t.BALANCED="BALANCED",t.PRIORITIZE_COST="PRIORITIZE_COST"})(Xv||(Xv={}));var Zv;(function(t){t.UNSPECIFIED="UNSPECIFIED",t.BLOCKING="BLOCKING",t.NON_BLOCKING="NON_BLOCKING"})(Zv||(Zv={}));var eT;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(eT||(eT={}));var tT;(function(t){t.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",t.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(tT||(tT={}));var nT;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.AUTO="AUTO",t.ANY="ANY",t.NONE="NONE",t.VALIDATED="VALIDATED"})(nT||(nT={}));var rT;(function(t){t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE"})(rT||(rT={}));var iT;(function(t){t.DONT_ALLOW="DONT_ALLOW",t.ALLOW_ADULT="ALLOW_ADULT",t.ALLOW_ALL="ALLOW_ALL"})(iT||(iT={}));var sT;(function(t){t.auto="auto",t.en="en",t.ja="ja",t.ko="ko",t.hi="hi",t.zh="zh",t.pt="pt",t.es="es"})(sT||(sT={}));var oT;(function(t){t.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",t.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",t.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",t.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",t.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(oT||(oT={}));var aT;(function(t){t.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",t.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",t.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",t.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(aT||(aT={}));var lT;(function(t){t.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",t.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",t.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",t.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(lT||(lT={}));var uT;(function(t){t.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",t.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",t.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",t.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",t.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",t.EDIT_MODE_STYLE="EDIT_MODE_STYLE",t.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",t.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(uT||(uT={}));var cT;(function(t){t.FOREGROUND="FOREGROUND",t.BACKGROUND="BACKGROUND",t.PROMPT="PROMPT",t.SEMANTIC="SEMANTIC",t.INTERACTIVE="INTERACTIVE"})(cT||(cT={}));var dT;(function(t){t.ASSET="ASSET",t.STYLE="STYLE"})(dT||(dT={}));var hT;(function(t){t.INSERT="INSERT",t.REMOVE="REMOVE",t.REMOVE_STATIC="REMOVE_STATIC",t.OUTPAINT="OUTPAINT"})(hT||(hT={}));var fT;(function(t){t.OPTIMIZED="OPTIMIZED",t.LOSSLESS="LOSSLESS"})(fT||(fT={}));var pT;(function(t){t.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",t.PREFERENCE_TUNING="PREFERENCE_TUNING"})(pT||(pT={}));var mT;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.PROCESSING="PROCESSING",t.ACTIVE="ACTIVE",t.FAILED="FAILED"})(mT||(mT={}));var gT;(function(t){t.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",t.UPLOADED="UPLOADED",t.GENERATED="GENERATED"})(gT||(gT={}));var _T;(function(t){t.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.RESPONSE_REJECTED="RESPONSE_REJECTED",t.NEED_MORE_INPUT="NEED_MORE_INPUT"})(_T||(_T={}));var yT;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.VIDEO="VIDEO",t.AUDIO="AUDIO",t.DOCUMENT="DOCUMENT"})(yT||(yT={}));var vT;(function(t){t.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",t.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",t.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(vT||(vT={}));var TT;(function(t){t.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",t.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",t.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(TT||(TT={}));var ET;(function(t){t.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",t.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",t.NO_INTERRUPTION="NO_INTERRUPTION"})(ET||(ET={}));var wT;(function(t){t.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",t.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",t.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(wT||(wT={}));var IT;(function(t){t.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",t.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",t.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",t.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",t.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",t.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",t.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",t.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",t.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",t.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",t.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",t.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",t.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(IT||(IT={}));var ST;(function(t){t.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",t.QUALITY="QUALITY",t.DIVERSITY="DIVERSITY",t.VOCALIZATION="VOCALIZATION"})(ST||(ST={}));var aa;(function(t){t.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",t.PLAY="PLAY",t.PAUSE="PAUSE",t.STOP="STOP",t.RESET_CONTEXT="RESET_CONTEXT"})(aa||(aa={}));class xm{constructor(e){const n={};for(const r of e.headers.entries())n[r[0]]=r[1];this.headers=n,this.responseInternal=e}json(){return this.responseInternal.json()}}class Cl{get text(){var e,n,r,i,s,o,a,l;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let u="",f=!1;const m=[];for(const g of(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)!==null&&l!==void 0?l:[]){for(const[v,T]of Object.entries(g))v!=="text"&&v!=="thought"&&(T!==null||T!==void 0)&&m.push(v);if(typeof g.text=="string"){if(typeof g.thought=="boolean"&&g.thought)continue;f=!0,u+=g.text}}return m.length>0&&console.warn(`there are non-text parts ${m} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),f?u:void 0}get data(){var e,n,r,i,s,o,a,l;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let u="";const f=[];for(const m of(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)!==null&&l!==void 0?l:[]){for(const[g,v]of Object.entries(m))g!=="inlineData"&&(v!==null||v!==void 0)&&f.push(g);m.inlineData&&typeof m.inlineData.data=="string"&&(u+=atob(m.inlineData.data))}return f.length>0&&console.warn(`there are non-data parts ${f} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),u.length>0?btoa(u):void 0}get functionCalls(){var e,n,r,i,s,o,a,l;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const u=(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(f=>f.functionCall).map(f=>f.functionCall).filter(f=>f!==void 0);if((u==null?void 0:u.length)!==0)return u}get executableCode(){var e,n,r,i,s,o,a,l,u;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const f=(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(m=>m.executableCode).map(m=>m.executableCode).filter(m=>m!==void 0);if((f==null?void 0:f.length)!==0)return(u=f==null?void 0:f[0])===null||u===void 0?void 0:u.code}get codeExecutionResult(){var e,n,r,i,s,o,a,l,u;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const f=(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(m=>m.codeExecutionResult).map(m=>m.codeExecutionResult).filter(m=>m!==void 0);if((f==null?void 0:f.length)!==0)return(u=f==null?void 0:f[0])===null||u===void 0?void 0:u.output}}class CT{}class xT{}class Wk{}class Kk{}class Jk{}class Qk{}class AT{}class RT{}class PT{}class Yk{}class oh{_fromAPIResponse({apiResponse:e,isVertexAI:n}){const r=new oh;let i;const s=e;return n?i=Uk(s):i=Fk(s),Object.assign(r,i),r}}class kT{}class NT{}class bT{}class Xk{}class Zk{}class eN{}class DT{}class tN{get text(){var e,n,r;let i="",s=!1;const o=[];for(const a of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[l,u]of Object.entries(a))l!=="text"&&l!=="thought"&&u!==null&&o.push(l);if(typeof a.text=="string"){if(typeof a.thought=="boolean"&&a.thought)continue;s=!0,i+=a.text}}return o.length>0&&console.warn(`there are non-text parts ${o} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),s?i:void 0}get data(){var e,n,r;let i="";const s=[];for(const o of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[a,l]of Object.entries(o))a!=="inlineData"&&l!==null&&s.push(a);o.inlineData&&typeof o.inlineData.data=="string"&&(i+=atob(o.inlineData.data))}return s.length>0&&console.warn(`there are non-data parts ${s} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),i.length>0?btoa(i):void 0}}class nN{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function qe(t,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(t.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const n=e.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function fC(t,e){const n=qe(t,e);return n?n.startsWith("publishers/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}`:n.startsWith("models/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/publishers/google/${n}`:n:""}function pC(t){return Array.isArray(t)?t.map(e=>ah(e)):[ah(t)]}function ah(t){if(typeof t=="object"&&t!==null)return t;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof t}`)}function mC(t){const e=ah(t);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function gC(t){const e=ah(t);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function MT(t){if(t==null)throw new Error("PartUnion is required");if(typeof t=="object")return t;if(typeof t=="string")return{text:t};throw new Error(`Unsupported part type: ${typeof t}`)}function _C(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("PartListUnion is required");return Array.isArray(t)?t.map(e=>MT(e)):[MT(t)]}function Am(t){return t!=null&&typeof t=="object"&&"parts"in t&&Array.isArray(t.parts)}function VT(t){return t!=null&&typeof t=="object"&&"functionCall"in t}function LT(t){return t!=null&&typeof t=="object"&&"functionResponse"in t}function tn(t){if(t==null)throw new Error("ContentUnion is required");return Am(t)?t:{role:"user",parts:_C(t)}}function f_(t,e){if(!e)return[];if(t.isVertexAI()&&Array.isArray(e))return e.flatMap(n=>{const r=tn(n);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(t.isVertexAI()){const n=tn(e);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(e)?e.map(n=>tn(n)):[tn(e)]}function $n(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("contents are required");if(!Array.isArray(t)){if(VT(t)||LT(t))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[tn(t)]}const e=[],n=[],r=Am(t[0]);for(const i of t){const s=Am(i);if(s!=r)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(s)e.push(i);else{if(VT(i)||LT(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(i)}}return r||e.push({role:"user",parts:_C(n)}),e}function rN(t,e){t.includes("null")&&(e.nullable=!0);const n=t.filter(r=>r!=="null");if(n.length===1)e.type=Object.values(Gn).includes(n[0].toUpperCase())?n[0].toUpperCase():Gn.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const r of n)e.anyOf.push({type:Object.values(Gn).includes(r.toUpperCase())?r.toUpperCase():Gn.TYPE_UNSPECIFIED})}}function ma(t){const e={},n=["items"],r=["anyOf"],i=["properties"];if(t.type&&t.anyOf)throw new Error("type and anyOf cannot be both populated.");const s=t.anyOf;s!=null&&s.length==2&&(s[0].type==="null"?(e.nullable=!0,t=s[1]):s[1].type==="null"&&(e.nullable=!0,t=s[0])),t.type instanceof Array&&rN(t.type,e);for(const[o,a]of Object.entries(t))if(a!=null)if(o=="type"){if(a==="null")throw new Error("type: null can not be the only possible type for the field.");if(a instanceof Array)continue;e.type=Object.values(Gn).includes(a.toUpperCase())?a.toUpperCase():Gn.TYPE_UNSPECIFIED}else if(n.includes(o))e[o]=ma(a);else if(r.includes(o)){const l=[];for(const u of a){if(u.type=="null"){e.nullable=!0;continue}l.push(ma(u))}e[o]=l}else if(i.includes(o)){const l={};for(const[u,f]of Object.entries(a))l[u]=ma(f);e[o]=l}else{if(o==="additionalProperties")continue;e[o]=a}return e}function p_(t){return ma(t)}function m_(t){if(typeof t=="object")return t;if(typeof t=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:t}}};throw new Error(`Unsupported speechConfig type: ${typeof t}`)}function g_(t){if("multiSpeakerVoiceConfig"in t)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return t}function Ja(t){if(t.functionDeclarations)for(const e of t.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=ma(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=ma(e.response));return t}function Qa(t){if(t==null)throw new Error("tools is required");if(!Array.isArray(t))throw new Error("tools is required and must be an array of Tools");const e=[];for(const n of t)e.push(n);return e}function iN(t,e,n,r=1){const i=!e.startsWith(`${n}/`)&&e.split("/").length===r;return t.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${t.getProject()}/${e}`:e.startsWith(`${n}/`)?`projects/${t.getProject()}/locations/${t.getLocation()}/${e}`:i?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}/${e}`:e:i?`${n}/${e}`:e}function li(t,e){if(typeof e!="string")throw new Error("name must be a string");return iN(t,e,"cachedContents")}function yC(t){switch(t){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return t}}function ps(t){return h_(t)}function sN(t){return t!=null&&typeof t=="object"&&"name"in t}function oN(t){return t!=null&&typeof t=="object"&&"video"in t}function aN(t){return t!=null&&typeof t=="object"&&"uri"in t}function vC(t){var e;let n;if(sN(t)&&(n=t.name),!(aN(t)&&(n=t.uri,n===void 0))&&!(oN(t)&&(n=(e=t.video)===null||e===void 0?void 0:e.uri,n===void 0))){if(typeof t=="string"&&(n=t),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const i=n.split("files/")[1].match(/[a-z0-9]+/);if(i===null)throw new Error(`Could not extract file name from URI ${n}`);n=i[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function TC(t,e){let n;return t.isVertexAI()?n=e?"publishers/google/models":"models":n=e?"models":"tunedModels",n}function EC(t){for(const e of["models","tunedModels","publisherModels"])if(lN(t,e))return t[e];return[]}function lN(t,e){return t!==null&&typeof t=="object"&&e in t}function uN(t,e={}){const n=t,r={name:n.name,description:n.description,parametersJsonSchema:n.inputSchema};return n.outputSchema&&(r.responseJsonSchema=n.outputSchema),e.behavior&&(r.behavior=e.behavior),{functionDeclarations:[r]}}function cN(t,e={}){const n=[],r=new Set;for(const i of t){const s=i.name;if(r.has(s))throw new Error(`Duplicate function name ${s} found in MCP tools. Please ensure function names are unique.`);r.add(s);const o=uN(i,e);o.functionDeclarations&&n.push(...o.functionDeclarations)}return{functionDeclarations:n}}function wC(t,e){let n;if(typeof e=="string")if(t.isVertexAI())if(e.startsWith("gs://"))n={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))n={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))n={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(t.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");n={inlinedRequests:e}}else n=e;const r=[n.gcsUri,n.bigqueryUri].filter(Boolean).length,i=[n.inlinedRequests,n.fileName].filter(Boolean).length;if(t.isVertexAI()){if(i>0||r!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(r>0||i!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return n}function dN(t){if(typeof t!="string")return t;const e=t;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function IC(t){if(typeof t!="object"||t===null)return{};const e=t,n=e.inlinedResponses;if(typeof n!="object"||n===null)return t;const i=n.inlinedResponses;if(!Array.isArray(i)||i.length===0)return t;let s=!1;for(const o of i){if(typeof o!="object"||o===null)continue;const l=o.response;if(typeof l!="object"||l===null)continue;if(l.embedding!==void 0){s=!0;break}}return s&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),t}function Ya(t,e){const n=e;if(!t.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error(`Invalid batch job name: ${n}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error(`Invalid batch job name: ${n}.`)}function SC(t){const e=t;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function hN(t){const e={},n=d(t,["responsesFile"]);n!=null&&h(e,["fileName"],n);const r=d(t,["inlinedResponses","inlinedResponses"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>zN(o))),h(e,["inlinedResponses"],s)}const i=d(t,["inlinedEmbedContentResponses","inlinedResponses"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),h(e,["inlinedEmbedContentResponses"],s)}return e}function fN(t){const e={},n=d(t,["predictionsFormat"]);n!=null&&h(e,["format"],n);const r=d(t,["gcsDestination","outputUriPrefix"]);r!=null&&h(e,["gcsUri"],r);const i=d(t,["bigqueryDestination","outputUri"]);return i!=null&&h(e,["bigqueryUri"],i),e}function pN(t){const e={},n=d(t,["format"]);n!=null&&h(e,["predictionsFormat"],n);const r=d(t,["gcsUri"]);r!=null&&h(e,["gcsDestination","outputUriPrefix"],r);const i=d(t,["bigqueryUri"]);if(i!=null&&h(e,["bigqueryDestination","outputUri"],i),d(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(d(t,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(d(t,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function yd(t){const e={},n=d(t,["name"]);n!=null&&h(e,["name"],n);const r=d(t,["metadata","displayName"]);r!=null&&h(e,["displayName"],r);const i=d(t,["metadata","state"]);i!=null&&h(e,["state"],SC(i));const s=d(t,["metadata","createTime"]);s!=null&&h(e,["createTime"],s);const o=d(t,["metadata","endTime"]);o!=null&&h(e,["endTime"],o);const a=d(t,["metadata","updateTime"]);a!=null&&h(e,["updateTime"],a);const l=d(t,["metadata","model"]);l!=null&&h(e,["model"],l);const u=d(t,["metadata","output"]);return u!=null&&h(e,["dest"],hN(IC(u))),e}function Rm(t){const e={},n=d(t,["name"]);n!=null&&h(e,["name"],n);const r=d(t,["displayName"]);r!=null&&h(e,["displayName"],r);const i=d(t,["state"]);i!=null&&h(e,["state"],SC(i));const s=d(t,["error"]);s!=null&&h(e,["error"],s);const o=d(t,["createTime"]);o!=null&&h(e,["createTime"],o);const a=d(t,["startTime"]);a!=null&&h(e,["startTime"],a);const l=d(t,["endTime"]);l!=null&&h(e,["endTime"],l);const u=d(t,["updateTime"]);u!=null&&h(e,["updateTime"],u);const f=d(t,["model"]);f!=null&&h(e,["model"],f);const m=d(t,["inputConfig"]);m!=null&&h(e,["src"],mN(m));const g=d(t,["outputConfig"]);return g!=null&&h(e,["dest"],fN(IC(g))),e}function mN(t){const e={},n=d(t,["instancesFormat"]);n!=null&&h(e,["format"],n);const r=d(t,["gcsSource","uris"]);r!=null&&h(e,["gcsUri"],r);const i=d(t,["bigquerySource","inputUri"]);return i!=null&&h(e,["bigqueryUri"],i),e}function gN(t,e){const n={};if(d(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(d(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(d(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const r=d(e,["fileName"]);r!=null&&h(n,["fileName"],r);const i=d(e,["inlinedRequests"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>qN(t,o))),h(n,["requests","requests"],s)}return n}function _N(t){const e={},n=d(t,["format"]);n!=null&&h(e,["instancesFormat"],n);const r=d(t,["gcsUri"]);r!=null&&h(e,["gcsSource","uris"],r);const i=d(t,["bigqueryUri"]);if(i!=null&&h(e,["bigquerySource","inputUri"],i),d(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(d(t,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function yN(t){const e={},n=d(t,["data"]);if(n!=null&&h(e,["data"],n),d(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=d(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function vN(t,e){const n={},r=d(e,["name"]);return r!=null&&h(n,["_url","name"],Ya(t,r)),n}function TN(t,e){const n={},r=d(e,["name"]);return r!=null&&h(n,["_url","name"],Ya(t,r)),n}function EN(t){const e={},n=d(t,["content"]);n!=null&&h(e,["content"],n);const r=d(t,["citationMetadata"]);r!=null&&h(e,["citationMetadata"],wN(r));const i=d(t,["tokenCount"]);i!=null&&h(e,["tokenCount"],i);const s=d(t,["finishReason"]);s!=null&&h(e,["finishReason"],s);const o=d(t,["avgLogprobs"]);o!=null&&h(e,["avgLogprobs"],o);const a=d(t,["groundingMetadata"]);a!=null&&h(e,["groundingMetadata"],a);const l=d(t,["index"]);l!=null&&h(e,["index"],l);const u=d(t,["logprobsResult"]);u!=null&&h(e,["logprobsResult"],u);const f=d(t,["safetyRatings"]);if(f!=null){let g=f;Array.isArray(g)&&(g=g.map(v=>v)),h(e,["safetyRatings"],g)}const m=d(t,["urlContextMetadata"]);return m!=null&&h(e,["urlContextMetadata"],m),e}function wN(t){const e={},n=d(t,["citationSources"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>i)),h(e,["citations"],r)}return e}function CC(t){const e={},n=d(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>QN(s))),h(e,["parts"],i)}const r=d(t,["role"]);return r!=null&&h(e,["role"],r),e}function IN(t,e){const n={},r=d(t,["displayName"]);if(e!==void 0&&r!=null&&h(e,["batch","displayName"],r),d(t,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return n}function SN(t,e){const n={},r=d(t,["displayName"]);e!==void 0&&r!=null&&h(e,["displayName"],r);const i=d(t,["dest"]);return e!==void 0&&i!=null&&h(e,["outputConfig"],pN(dN(i))),n}function FT(t,e){const n={},r=d(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=d(e,["src"]);i!=null&&h(n,["batch","inputConfig"],gN(t,wC(t,i)));const s=d(e,["config"]);return s!=null&&IN(s,n),n}function CN(t,e){const n={},r=d(e,["model"]);r!=null&&h(n,["model"],qe(t,r));const i=d(e,["src"]);i!=null&&h(n,["inputConfig"],_N(wC(t,i)));const s=d(e,["config"]);return s!=null&&SN(s,n),n}function xN(t,e){const n={},r=d(t,["displayName"]);return e!==void 0&&r!=null&&h(e,["batch","displayName"],r),n}function AN(t,e){const n={},r=d(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=d(e,["src"]);i!=null&&h(n,["batch","inputConfig"],MN(t,i));const s=d(e,["config"]);return s!=null&&xN(s,n),n}function RN(t,e){const n={},r=d(e,["name"]);return r!=null&&h(n,["_url","name"],Ya(t,r)),n}function PN(t,e){const n={},r=d(e,["name"]);return r!=null&&h(n,["_url","name"],Ya(t,r)),n}function kN(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=d(t,["name"]);r!=null&&h(e,["name"],r);const i=d(t,["done"]);i!=null&&h(e,["done"],i);const s=d(t,["error"]);return s!=null&&h(e,["error"],s),e}function NN(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=d(t,["name"]);r!=null&&h(e,["name"],r);const i=d(t,["done"]);i!=null&&h(e,["done"],i);const s=d(t,["error"]);return s!=null&&h(e,["error"],s),e}function bN(t,e){const n={},r=d(e,["contents"]);if(r!=null){let s=f_(t,r);Array.isArray(s)&&(s=s.map(o=>o)),h(n,["requests[]","request","content"],s)}const i=d(e,["config"]);return i!=null&&(h(n,["_self"],DN(i,n)),Vk(n,{"requests[].*":"requests[].request.*"})),n}function DN(t,e){const n={},r=d(t,["taskType"]);e!==void 0&&r!=null&&h(e,["requests[]","taskType"],r);const i=d(t,["title"]);e!==void 0&&i!=null&&h(e,["requests[]","title"],i);const s=d(t,["outputDimensionality"]);if(e!==void 0&&s!=null&&h(e,["requests[]","outputDimensionality"],s),d(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(d(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function MN(t,e){const n={},r=d(e,["fileName"]);r!=null&&h(n,["file_name"],r);const i=d(e,["inlinedRequests"]);return i!=null&&h(n,["requests"],bN(t,i)),n}function VN(t){const e={};if(d(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=d(t,["fileUri"]);n!=null&&h(e,["fileUri"],n);const r=d(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function LN(t,e,n){const r={},i=d(e,["systemInstruction"]);n!==void 0&&i!=null&&h(n,["systemInstruction"],CC(tn(i)));const s=d(e,["temperature"]);s!=null&&h(r,["temperature"],s);const o=d(e,["topP"]);o!=null&&h(r,["topP"],o);const a=d(e,["topK"]);a!=null&&h(r,["topK"],a);const l=d(e,["candidateCount"]);l!=null&&h(r,["candidateCount"],l);const u=d(e,["maxOutputTokens"]);u!=null&&h(r,["maxOutputTokens"],u);const f=d(e,["stopSequences"]);f!=null&&h(r,["stopSequences"],f);const m=d(e,["responseLogprobs"]);m!=null&&h(r,["responseLogprobs"],m);const g=d(e,["logprobs"]);g!=null&&h(r,["logprobs"],g);const v=d(e,["presencePenalty"]);v!=null&&h(r,["presencePenalty"],v);const T=d(e,["frequencyPenalty"]);T!=null&&h(r,["frequencyPenalty"],T);const P=d(e,["seed"]);P!=null&&h(r,["seed"],P);const M=d(e,["responseMimeType"]);M!=null&&h(r,["responseMimeType"],M);const x=d(e,["responseSchema"]);x!=null&&h(r,["responseSchema"],p_(x));const E=d(e,["responseJsonSchema"]);if(E!=null&&h(r,["responseJsonSchema"],E),d(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(d(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const A=d(e,["safetySettings"]);if(n!==void 0&&A!=null){let L=A;Array.isArray(L)&&(L=L.map(b=>YN(b))),h(n,["safetySettings"],L)}const V=d(e,["tools"]);if(n!==void 0&&V!=null){let L=Qa(V);Array.isArray(L)&&(L=L.map(b=>XN(Ja(b)))),h(n,["tools"],L)}const B=d(e,["toolConfig"]);if(n!==void 0&&B!=null&&h(n,["toolConfig"],B),d(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const G=d(e,["cachedContent"]);n!==void 0&&G!=null&&h(n,["cachedContent"],li(t,G));const I=d(e,["responseModalities"]);I!=null&&h(r,["responseModalities"],I);const S=d(e,["mediaResolution"]);S!=null&&h(r,["mediaResolution"],S);const R=d(e,["speechConfig"]);if(R!=null&&h(r,["speechConfig"],m_(R)),d(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const N=d(e,["thinkingConfig"]);N!=null&&h(r,["thinkingConfig"],N);const D=d(e,["imageConfig"]);return D!=null&&h(r,["imageConfig"],D),r}function FN(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=d(t,["candidates"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(u=>EN(u))),h(e,["candidates"],l)}const i=d(t,["modelVersion"]);i!=null&&h(e,["modelVersion"],i);const s=d(t,["promptFeedback"]);s!=null&&h(e,["promptFeedback"],s);const o=d(t,["responseId"]);o!=null&&h(e,["responseId"],o);const a=d(t,["usageMetadata"]);return a!=null&&h(e,["usageMetadata"],a),e}function UN(t,e){const n={},r=d(e,["name"]);return r!=null&&h(n,["_url","name"],Ya(t,r)),n}function ON(t,e){const n={},r=d(e,["name"]);return r!=null&&h(n,["_url","name"],Ya(t,r)),n}function BN(t){const e={};if(d(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=d(t,["enableWidget"]);return n!=null&&h(e,["enableWidget"],n),e}function GN(t){const e={};if(d(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");const n=d(t,["timeRangeFilter"]);return n!=null&&h(e,["timeRangeFilter"],n),e}function qN(t,e){const n={},r=d(e,["model"]);r!=null&&h(n,["request","model"],qe(t,r));const i=d(e,["contents"]);if(i!=null){let a=$n(i);Array.isArray(a)&&(a=a.map(l=>CC(l))),h(n,["request","contents"],a)}const s=d(e,["metadata"]);s!=null&&h(n,["metadata"],s);const o=d(e,["config"]);return o!=null&&h(n,["request","generationConfig"],LN(t,o,d(n,["request"],{}))),n}function zN(t){const e={},n=d(t,["response"]);n!=null&&h(e,["response"],FN(n));const r=d(t,["error"]);return r!=null&&h(e,["error"],r),e}function $N(t,e){const n={},r=d(t,["pageSize"]);e!==void 0&&r!=null&&h(e,["_query","pageSize"],r);const i=d(t,["pageToken"]);if(e!==void 0&&i!=null&&h(e,["_query","pageToken"],i),d(t,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return n}function HN(t,e){const n={},r=d(t,["pageSize"]);e!==void 0&&r!=null&&h(e,["_query","pageSize"],r);const i=d(t,["pageToken"]);e!==void 0&&i!=null&&h(e,["_query","pageToken"],i);const s=d(t,["filter"]);return e!==void 0&&s!=null&&h(e,["_query","filter"],s),n}function jN(t){const e={},n=d(t,["config"]);return n!=null&&$N(n,e),e}function WN(t){const e={},n=d(t,["config"]);return n!=null&&HN(n,e),e}function KN(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=d(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=d(t,["operations"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>yd(o))),h(e,["batchJobs"],s)}return e}function JN(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=d(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=d(t,["batchPredictionJobs"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>Rm(o))),h(e,["batchJobs"],s)}return e}function QN(t){const e={},n=d(t,["functionCall"]);n!=null&&h(e,["functionCall"],n);const r=d(t,["codeExecutionResult"]);r!=null&&h(e,["codeExecutionResult"],r);const i=d(t,["executableCode"]);i!=null&&h(e,["executableCode"],i);const s=d(t,["fileData"]);s!=null&&h(e,["fileData"],VN(s));const o=d(t,["functionResponse"]);o!=null&&h(e,["functionResponse"],o);const a=d(t,["inlineData"]);a!=null&&h(e,["inlineData"],yN(a));const l=d(t,["text"]);l!=null&&h(e,["text"],l);const u=d(t,["thought"]);u!=null&&h(e,["thought"],u);const f=d(t,["thoughtSignature"]);f!=null&&h(e,["thoughtSignature"],f);const m=d(t,["videoMetadata"]);return m!=null&&h(e,["videoMetadata"],m),e}function YN(t){const e={},n=d(t,["category"]);if(n!=null&&h(e,["category"],n),d(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=d(t,["threshold"]);return r!=null&&h(e,["threshold"],r),e}function XN(t){const e={},n=d(t,["functionDeclarations"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(f=>f)),h(e,["functionDeclarations"],u)}if(d(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=d(t,["googleSearchRetrieval"]);r!=null&&h(e,["googleSearchRetrieval"],r);const i=d(t,["googleMaps"]);i!=null&&h(e,["googleMaps"],BN(i));const s=d(t,["computerUse"]);s!=null&&h(e,["computerUse"],s);const o=d(t,["codeExecution"]);if(o!=null&&h(e,["codeExecution"],o),d(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=d(t,["googleSearch"]);a!=null&&h(e,["googleSearch"],GN(a));const l=d(t,["urlContext"]);return l!=null&&h(e,["urlContext"],l),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var co;(function(t){t.PAGED_ITEM_BATCH_JOBS="batchJobs",t.PAGED_ITEM_MODELS="models",t.PAGED_ITEM_TUNING_JOBS="tuningJobs",t.PAGED_ITEM_FILES="files",t.PAGED_ITEM_CACHED_CONTENTS="cachedContents",t.PAGED_ITEM_RAG_STORES="ragStores",t.PAGED_ITEM_DOCUMENTS="documents"})(co||(co={}));class Hu{constructor(e,n,r,i){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(e,r,i)}init(e,n,r){var i,s;this.nameInternal=e,this.pageInternal=n[this.nameInternal]||[],this.sdkHttpResponseInternal=n==null?void 0:n.sdkHttpResponse,this.idxInternal=0;let o={config:{}};!r||Object.keys(r).length===0?o={config:{}}:typeof r=="object"?o=Object.assign({},r):o=r,o.config&&(o.config.pageToken=n.nextPageToken),this.paramsInternal=o,this.pageInternalSize=(s=(i=o.config)===null||i===void 0?void 0:i.pageSize)!==null&&s!==void 0?s:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ZN extends wo{constructor(e){super(),this.apiClient=e,this.create=async n=>(this.apiClient.isVertexAI()&&(n.config=this.formatDestination(n.src,n.config)),this.createInternal(n)),this.createEmbeddings=async n=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(n)},this.list=async(n={})=>new Hu(co.PAGED_ITEM_BATCH_JOBS,r=>this.listInternal(r),await this.listInternal(n),n)}createInlinedGenerateContentRequest(e){const n=FT(this.apiClient,e),r=n._url,i=de("{model}:batchGenerateContent",r),a=n.batch.inputConfig.requests,l=a.requests,u=[];for(const f of l){const m=Object.assign({},f);if(m.systemInstruction){const g=m.systemInstruction;delete m.systemInstruction;const v=m.request;v.systemInstruction=g,m.request=v}u.push(m)}return a.requests=u,delete n.config,delete n._url,delete n._query,{path:i,body:n}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,n){const r=n?Object.assign({},n):{},i=Date.now().toString();if(r.displayName||(r.displayName=`genaiBatchJob_${i}`),r.dest===void 0){const s=this.getGcsUri(e),o=this.getBigqueryUri(e);if(s)s.endsWith(".jsonl")?r.dest=`${s.slice(0,-6)}/dest`:r.dest=`${s}_dest_${i}`;else if(o)r.dest=`${o}_dest_${i}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return r}async createInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=CN(this.apiClient,e);return a=de("batchPredictionJobs",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>Rm(f))}else{const u=FT(this.apiClient,e);return a=de("{model}:batchGenerateContent",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>yd(f))}}async createEmbeddingsInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=AN(this.apiClient,e);return s=de("{model}:asyncBatchEmbedContent",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>yd(l))}}async get(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=ON(this.apiClient,e);return a=de("batchPredictionJobs/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>Rm(f))}else{const u=UN(this.apiClient,e);return a=de("batches/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>yd(f))}}async cancel(e){var n,r,i,s;let o="",a={};if(this.apiClient.isVertexAI()){const l=TN(this.apiClient,e);o=de("batchPredictionJobs/{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}else{const l=vN(this.apiClient,e);o=de("batches/{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal})}}async listInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=WN(e);return a=de("batchPredictionJobs",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=JN(f),g=new DT;return Object.assign(g,m),g})}else{const u=jN(e);return a=de("batches",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=KN(f),g=new DT;return Object.assign(g,m),g})}}async delete(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=PN(this.apiClient,e);return a=de("batchPredictionJobs/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>NN(f))}else{const u=RN(this.apiClient,e);return a=de("batches/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>kN(f))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function e1(t){const e={},n=d(t,["data"]);if(n!=null&&h(e,["data"],n),d(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=d(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function UT(t){const e={},n=d(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>E1(s))),h(e,["parts"],i)}const r=d(t,["role"]);return r!=null&&h(e,["role"],r),e}function t1(t,e){const n={},r=d(t,["ttl"]);e!==void 0&&r!=null&&h(e,["ttl"],r);const i=d(t,["expireTime"]);e!==void 0&&i!=null&&h(e,["expireTime"],i);const s=d(t,["displayName"]);e!==void 0&&s!=null&&h(e,["displayName"],s);const o=d(t,["contents"]);if(e!==void 0&&o!=null){let f=$n(o);Array.isArray(f)&&(f=f.map(m=>UT(m))),h(e,["contents"],f)}const a=d(t,["systemInstruction"]);e!==void 0&&a!=null&&h(e,["systemInstruction"],UT(tn(a)));const l=d(t,["tools"]);if(e!==void 0&&l!=null){let f=l;Array.isArray(f)&&(f=f.map(m=>w1(m))),h(e,["tools"],f)}const u=d(t,["toolConfig"]);if(e!==void 0&&u!=null&&h(e,["toolConfig"],u),d(t,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function n1(t,e){const n={},r=d(t,["ttl"]);e!==void 0&&r!=null&&h(e,["ttl"],r);const i=d(t,["expireTime"]);e!==void 0&&i!=null&&h(e,["expireTime"],i);const s=d(t,["displayName"]);e!==void 0&&s!=null&&h(e,["displayName"],s);const o=d(t,["contents"]);if(e!==void 0&&o!=null){let m=$n(o);Array.isArray(m)&&(m=m.map(g=>g)),h(e,["contents"],m)}const a=d(t,["systemInstruction"]);e!==void 0&&a!=null&&h(e,["systemInstruction"],tn(a));const l=d(t,["tools"]);if(e!==void 0&&l!=null){let m=l;Array.isArray(m)&&(m=m.map(g=>I1(g))),h(e,["tools"],m)}const u=d(t,["toolConfig"]);e!==void 0&&u!=null&&h(e,["toolConfig"],u);const f=d(t,["kmsKeyName"]);return e!==void 0&&f!=null&&h(e,["encryption_spec","kmsKeyName"],f),n}function r1(t,e){const n={},r=d(e,["model"]);r!=null&&h(n,["model"],fC(t,r));const i=d(e,["config"]);return i!=null&&t1(i,n),n}function i1(t,e){const n={},r=d(e,["model"]);r!=null&&h(n,["model"],fC(t,r));const i=d(e,["config"]);return i!=null&&n1(i,n),n}function s1(t,e){const n={},r=d(e,["name"]);return r!=null&&h(n,["_url","name"],li(t,r)),n}function o1(t,e){const n={},r=d(e,["name"]);return r!=null&&h(n,["_url","name"],li(t,r)),n}function a1(t){const e={},n=d(t,["sdkHttpResponse"]);return n!=null&&h(e,["sdkHttpResponse"],n),e}function l1(t){const e={},n=d(t,["sdkHttpResponse"]);return n!=null&&h(e,["sdkHttpResponse"],n),e}function u1(t){const e={};if(d(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=d(t,["fileUri"]);n!=null&&h(e,["fileUri"],n);const r=d(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function c1(t){const e={};if(d(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=d(t,["description"]);n!=null&&h(e,["description"],n);const r=d(t,["name"]);r!=null&&h(e,["name"],r);const i=d(t,["parameters"]);i!=null&&h(e,["parameters"],i);const s=d(t,["parametersJsonSchema"]);s!=null&&h(e,["parametersJsonSchema"],s);const o=d(t,["response"]);o!=null&&h(e,["response"],o);const a=d(t,["responseJsonSchema"]);return a!=null&&h(e,["responseJsonSchema"],a),e}function d1(t,e){const n={},r=d(e,["name"]);return r!=null&&h(n,["_url","name"],li(t,r)),n}function h1(t,e){const n={},r=d(e,["name"]);return r!=null&&h(n,["_url","name"],li(t,r)),n}function f1(t){const e={};if(d(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=d(t,["enableWidget"]);return n!=null&&h(e,["enableWidget"],n),e}function p1(t){const e={};if(d(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");const n=d(t,["timeRangeFilter"]);return n!=null&&h(e,["timeRangeFilter"],n),e}function m1(t,e){const n={},r=d(t,["pageSize"]);e!==void 0&&r!=null&&h(e,["_query","pageSize"],r);const i=d(t,["pageToken"]);return e!==void 0&&i!=null&&h(e,["_query","pageToken"],i),n}function g1(t,e){const n={},r=d(t,["pageSize"]);e!==void 0&&r!=null&&h(e,["_query","pageSize"],r);const i=d(t,["pageToken"]);return e!==void 0&&i!=null&&h(e,["_query","pageToken"],i),n}function _1(t){const e={},n=d(t,["config"]);return n!=null&&m1(n,e),e}function y1(t){const e={},n=d(t,["config"]);return n!=null&&g1(n,e),e}function v1(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=d(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=d(t,["cachedContents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),h(e,["cachedContents"],s)}return e}function T1(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=d(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=d(t,["cachedContents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),h(e,["cachedContents"],s)}return e}function E1(t){const e={},n=d(t,["functionCall"]);n!=null&&h(e,["functionCall"],n);const r=d(t,["codeExecutionResult"]);r!=null&&h(e,["codeExecutionResult"],r);const i=d(t,["executableCode"]);i!=null&&h(e,["executableCode"],i);const s=d(t,["fileData"]);s!=null&&h(e,["fileData"],u1(s));const o=d(t,["functionResponse"]);o!=null&&h(e,["functionResponse"],o);const a=d(t,["inlineData"]);a!=null&&h(e,["inlineData"],e1(a));const l=d(t,["text"]);l!=null&&h(e,["text"],l);const u=d(t,["thought"]);u!=null&&h(e,["thought"],u);const f=d(t,["thoughtSignature"]);f!=null&&h(e,["thoughtSignature"],f);const m=d(t,["videoMetadata"]);return m!=null&&h(e,["videoMetadata"],m),e}function w1(t){const e={},n=d(t,["functionDeclarations"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(f=>f)),h(e,["functionDeclarations"],u)}if(d(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=d(t,["googleSearchRetrieval"]);r!=null&&h(e,["googleSearchRetrieval"],r);const i=d(t,["googleMaps"]);i!=null&&h(e,["googleMaps"],f1(i));const s=d(t,["computerUse"]);s!=null&&h(e,["computerUse"],s);const o=d(t,["codeExecution"]);if(o!=null&&h(e,["codeExecution"],o),d(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=d(t,["googleSearch"]);a!=null&&h(e,["googleSearch"],p1(a));const l=d(t,["urlContext"]);return l!=null&&h(e,["urlContext"],l),e}function I1(t){const e={},n=d(t,["functionDeclarations"]);if(n!=null){let m=n;Array.isArray(m)&&(m=m.map(g=>c1(g))),h(e,["functionDeclarations"],m)}const r=d(t,["retrieval"]);r!=null&&h(e,["retrieval"],r);const i=d(t,["googleSearchRetrieval"]);i!=null&&h(e,["googleSearchRetrieval"],i);const s=d(t,["googleMaps"]);s!=null&&h(e,["googleMaps"],s);const o=d(t,["computerUse"]);o!=null&&h(e,["computerUse"],o);const a=d(t,["codeExecution"]);a!=null&&h(e,["codeExecution"],a);const l=d(t,["enterpriseWebSearch"]);l!=null&&h(e,["enterpriseWebSearch"],l);const u=d(t,["googleSearch"]);u!=null&&h(e,["googleSearch"],u);const f=d(t,["urlContext"]);return f!=null&&h(e,["urlContext"],f),e}function S1(t,e){const n={},r=d(t,["ttl"]);e!==void 0&&r!=null&&h(e,["ttl"],r);const i=d(t,["expireTime"]);return e!==void 0&&i!=null&&h(e,["expireTime"],i),n}function C1(t,e){const n={},r=d(t,["ttl"]);e!==void 0&&r!=null&&h(e,["ttl"],r);const i=d(t,["expireTime"]);return e!==void 0&&i!=null&&h(e,["expireTime"],i),n}function x1(t,e){const n={},r=d(e,["name"]);r!=null&&h(n,["_url","name"],li(t,r));const i=d(e,["config"]);return i!=null&&S1(i,n),n}function A1(t,e){const n={},r=d(e,["name"]);r!=null&&h(n,["_url","name"],li(t,r));const i=d(e,["config"]);return i!=null&&C1(i,n),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class R1 extends wo{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new Hu(co.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(n),n)}async create(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=i1(this.apiClient,e);return a=de("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>f)}else{const u=r1(this.apiClient,e);return a=de("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>f)}}async get(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=h1(this.apiClient,e);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>f)}else{const u=d1(this.apiClient,e);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>f)}}async delete(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=o1(this.apiClient,e);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=l1(f),g=new NT;return Object.assign(g,m),g})}else{const u=s1(this.apiClient,e);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=a1(f),g=new NT;return Object.assign(g,m),g})}}async update(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=A1(this.apiClient,e);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>f)}else{const u=x1(this.apiClient,e);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>f)}}async listInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=y1(e);return a=de("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=T1(f),g=new bT;return Object.assign(g,m),g})}else{const u=_1(e);return a=de("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=v1(f),g=new bT;return Object.assign(g,m),g})}}}function OT(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ot(t){return this instanceof ot?(this.v=t,this):new ot(t)}function ga(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),i,s=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(v){return function(T){return Promise.resolve(T).then(v,m)}}function a(v,T){r[v]&&(i[v]=function(P){return new Promise(function(M,x){s.push([v,P,M,x])>1||l(v,P)})},T&&(i[v]=T(i[v])))}function l(v,T){try{u(r[v](T))}catch(P){g(s[0][3],P)}}function u(v){v.value instanceof ot?Promise.resolve(v.value.v).then(f,m):g(s[0][2],v)}function f(v){l("next",v)}function m(v){l("throw",v)}function g(v,T){v(T),s.shift(),s.length&&l(s[0][0],s[0][1])}}function Ql(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof OT=="function"?OT(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(s){n[s]=t[s]&&function(o){return new Promise(function(a,l){o=t[s](o),i(a,l,o.done,o.value)})}}function i(s,o,a,l){Promise.resolve(l).then(function(u){s({value:u,done:a})},o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function P1(t){var e;if(t.candidates==null||t.candidates.length===0)return!1;const n=(e=t.candidates[0])===null||e===void 0?void 0:e.content;return n===void 0?!1:xC(n)}function xC(t){if(t.parts===void 0||t.parts.length===0)return!1;for(const e of t.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function k1(t){if(t.length!==0){for(const e of t)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function BT(t){if(t===void 0||t.length===0)return[];const e=[],n=t.length;let r=0;for(;r<n;)if(t[r].role==="user")e.push(t[r]),r++;else{const i=[];let s=!0;for(;r<n&&t[r].role==="model";)i.push(t[r]),s&&!xC(t[r])&&(s=!1),r++;s?e.push(...i):e.pop()}return e}class N1{constructor(e,n){this.modelsModule=e,this.apiClient=n}create(e){return new b1(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class b1{constructor(e,n,r,i={},s=[]){this.apiClient=e,this.modelsModule=n,this.model=r,this.config=i,this.history=s,this.sendPromise=Promise.resolve(),k1(s)}async sendMessage(e){var n;await this.sendPromise;const r=tn(e.message),i=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var s,o,a;const l=await i,u=(o=(s=l.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content,f=l.automaticFunctionCallingHistory,m=this.getHistory(!0).length;let g=[];f!=null&&(g=(a=f.slice(m))!==null&&a!==void 0?a:[]);const v=u?[u]:[];this.recordHistory(r,v,g)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),i}async sendMessageStream(e){var n;await this.sendPromise;const r=tn(e.message),i=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});this.sendPromise=i.then(()=>{}).catch(()=>{});const s=await i;return this.processStreamResponse(s,r)}getHistory(e=!1){const n=e?BT(this.history):this.history;return structuredClone(n)}processStreamResponse(e,n){var r,i;return ga(this,arguments,function*(){var o,a,l,u;const f=[];try{for(var m=!0,g=Ql(e),v;v=yield ot(g.next()),o=v.done,!o;m=!0){u=v.value,m=!1;const T=u;if(P1(T)){const P=(i=(r=T.candidates)===null||r===void 0?void 0:r[0])===null||i===void 0?void 0:i.content;P!==void 0&&f.push(P)}yield yield ot(T)}}catch(T){a={error:T}}finally{try{!m&&!o&&(l=g.return)&&(yield ot(l.call(g)))}finally{if(a)throw a.error}}this.recordHistory(n,f)})}recordHistory(e,n,r){let i=[];n.length>0&&n.every(s=>s.role!==void 0)?i=n:i.push({role:"model",parts:[]}),r&&r.length>0?this.history.push(...BT(r)):this.history.push(e),this.history.push(...i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Qh extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,Qh.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function D1(t){const e={},n=d(t,["file"]);return n!=null&&h(e,["file"],n),e}function M1(t){const e={},n=d(t,["sdkHttpResponse"]);return n!=null&&h(e,["sdkHttpResponse"],n),e}function V1(t){const e={},n=d(t,["name"]);return n!=null&&h(e,["_url","file"],vC(n)),e}function L1(t){const e={},n=d(t,["sdkHttpResponse"]);return n!=null&&h(e,["sdkHttpResponse"],n),e}function F1(t){const e={},n=d(t,["name"]);return n!=null&&h(e,["_url","file"],vC(n)),e}function U1(t,e){const n={},r=d(t,["pageSize"]);e!==void 0&&r!=null&&h(e,["_query","pageSize"],r);const i=d(t,["pageToken"]);return e!==void 0&&i!=null&&h(e,["_query","pageToken"],i),n}function O1(t){const e={},n=d(t,["config"]);return n!=null&&U1(n,e),e}function B1(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=d(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=d(t,["files"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),h(e,["files"],s)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class G1 extends wo{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new Hu(co.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(n),n)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(n=>n)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=O1(e);return s=de("files",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>{const u=B1(l),f=new Xk;return Object.assign(f,u),f})}}async createInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=D1(e);return s=de("upload/v1beta/files",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=M1(l),f=new Zk;return Object.assign(f,u),f})}}async get(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=F1(e);return s=de("files/{file}",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>l)}}async delete(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=V1(e);return s=de("files/{file}",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>{const u=L1(l),f=new eN;return Object.assign(f,u),f})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function vd(t){const e={},n=d(t,["data"]);if(n!=null&&h(e,["data"],n),d(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=d(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function q1(t){const e={},n=d(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>rb(s))),h(e,["parts"],i)}const r=d(t,["role"]);return r!=null&&h(e,["role"],r),e}function z1(t){const e={};if(d(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=d(t,["fileUri"]);n!=null&&h(e,["fileUri"],n);const r=d(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function $1(t){const e={};if(d(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=d(t,["description"]);n!=null&&h(e,["description"],n);const r=d(t,["name"]);r!=null&&h(e,["name"],r);const i=d(t,["parameters"]);i!=null&&h(e,["parameters"],i);const s=d(t,["parametersJsonSchema"]);s!=null&&h(e,["parametersJsonSchema"],s);const o=d(t,["response"]);o!=null&&h(e,["response"],o);const a=d(t,["responseJsonSchema"]);return a!=null&&h(e,["responseJsonSchema"],a),e}function H1(t){const e={},n=d(t,["modelSelectionConfig"]);n!=null&&h(e,["modelConfig"],n);const r=d(t,["audioTimestamp"]);r!=null&&h(e,["audioTimestamp"],r);const i=d(t,["candidateCount"]);i!=null&&h(e,["candidateCount"],i);const s=d(t,["enableAffectiveDialog"]);s!=null&&h(e,["enableAffectiveDialog"],s);const o=d(t,["frequencyPenalty"]);o!=null&&h(e,["frequencyPenalty"],o);const a=d(t,["logprobs"]);a!=null&&h(e,["logprobs"],a);const l=d(t,["maxOutputTokens"]);l!=null&&h(e,["maxOutputTokens"],l);const u=d(t,["mediaResolution"]);u!=null&&h(e,["mediaResolution"],u);const f=d(t,["presencePenalty"]);f!=null&&h(e,["presencePenalty"],f);const m=d(t,["responseJsonSchema"]);m!=null&&h(e,["responseJsonSchema"],m);const g=d(t,["responseLogprobs"]);g!=null&&h(e,["responseLogprobs"],g);const v=d(t,["responseMimeType"]);v!=null&&h(e,["responseMimeType"],v);const T=d(t,["responseModalities"]);T!=null&&h(e,["responseModalities"],T);const P=d(t,["responseSchema"]);P!=null&&h(e,["responseSchema"],P);const M=d(t,["routingConfig"]);M!=null&&h(e,["routingConfig"],M);const x=d(t,["seed"]);x!=null&&h(e,["seed"],x);const E=d(t,["speechConfig"]);E!=null&&h(e,["speechConfig"],AC(E));const A=d(t,["stopSequences"]);A!=null&&h(e,["stopSequences"],A);const V=d(t,["temperature"]);V!=null&&h(e,["temperature"],V);const B=d(t,["thinkingConfig"]);B!=null&&h(e,["thinkingConfig"],B);const G=d(t,["topK"]);G!=null&&h(e,["topK"],G);const I=d(t,["topP"]);if(I!=null&&h(e,["topP"],I),d(t,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function j1(t){const e={};if(d(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=d(t,["enableWidget"]);return n!=null&&h(e,["enableWidget"],n),e}function W1(t){const e={};if(d(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");const n=d(t,["timeRangeFilter"]);return n!=null&&h(e,["timeRangeFilter"],n),e}function K1(t,e){const n={},r=d(t,["generationConfig"]);e!==void 0&&r!=null&&h(e,["setup","generationConfig"],r);const i=d(t,["responseModalities"]);e!==void 0&&i!=null&&h(e,["setup","generationConfig","responseModalities"],i);const s=d(t,["temperature"]);e!==void 0&&s!=null&&h(e,["setup","generationConfig","temperature"],s);const o=d(t,["topP"]);e!==void 0&&o!=null&&h(e,["setup","generationConfig","topP"],o);const a=d(t,["topK"]);e!==void 0&&a!=null&&h(e,["setup","generationConfig","topK"],a);const l=d(t,["maxOutputTokens"]);e!==void 0&&l!=null&&h(e,["setup","generationConfig","maxOutputTokens"],l);const u=d(t,["mediaResolution"]);e!==void 0&&u!=null&&h(e,["setup","generationConfig","mediaResolution"],u);const f=d(t,["seed"]);e!==void 0&&f!=null&&h(e,["setup","generationConfig","seed"],f);const m=d(t,["speechConfig"]);e!==void 0&&m!=null&&h(e,["setup","generationConfig","speechConfig"],g_(m));const g=d(t,["thinkingConfig"]);e!==void 0&&g!=null&&h(e,["setup","generationConfig","thinkingConfig"],g);const v=d(t,["enableAffectiveDialog"]);e!==void 0&&v!=null&&h(e,["setup","generationConfig","enableAffectiveDialog"],v);const T=d(t,["systemInstruction"]);e!==void 0&&T!=null&&h(e,["setup","systemInstruction"],q1(tn(T)));const P=d(t,["tools"]);if(e!==void 0&&P!=null){let G=Qa(P);Array.isArray(G)&&(G=G.map(I=>sb(Ja(I)))),h(e,["setup","tools"],G)}const M=d(t,["sessionResumption"]);e!==void 0&&M!=null&&h(e,["setup","sessionResumption"],ib(M));const x=d(t,["inputAudioTranscription"]);e!==void 0&&x!=null&&h(e,["setup","inputAudioTranscription"],x);const E=d(t,["outputAudioTranscription"]);e!==void 0&&E!=null&&h(e,["setup","outputAudioTranscription"],E);const A=d(t,["realtimeInputConfig"]);e!==void 0&&A!=null&&h(e,["setup","realtimeInputConfig"],A);const V=d(t,["contextWindowCompression"]);e!==void 0&&V!=null&&h(e,["setup","contextWindowCompression"],V);const B=d(t,["proactivity"]);return e!==void 0&&B!=null&&h(e,["setup","proactivity"],B),n}function J1(t,e){const n={},r=d(t,["generationConfig"]);e!==void 0&&r!=null&&h(e,["setup","generationConfig"],H1(r));const i=d(t,["responseModalities"]);e!==void 0&&i!=null&&h(e,["setup","generationConfig","responseModalities"],i);const s=d(t,["temperature"]);e!==void 0&&s!=null&&h(e,["setup","generationConfig","temperature"],s);const o=d(t,["topP"]);e!==void 0&&o!=null&&h(e,["setup","generationConfig","topP"],o);const a=d(t,["topK"]);e!==void 0&&a!=null&&h(e,["setup","generationConfig","topK"],a);const l=d(t,["maxOutputTokens"]);e!==void 0&&l!=null&&h(e,["setup","generationConfig","maxOutputTokens"],l);const u=d(t,["mediaResolution"]);e!==void 0&&u!=null&&h(e,["setup","generationConfig","mediaResolution"],u);const f=d(t,["seed"]);e!==void 0&&f!=null&&h(e,["setup","generationConfig","seed"],f);const m=d(t,["speechConfig"]);e!==void 0&&m!=null&&h(e,["setup","generationConfig","speechConfig"],AC(g_(m)));const g=d(t,["thinkingConfig"]);e!==void 0&&g!=null&&h(e,["setup","generationConfig","thinkingConfig"],g);const v=d(t,["enableAffectiveDialog"]);e!==void 0&&v!=null&&h(e,["setup","generationConfig","enableAffectiveDialog"],v);const T=d(t,["systemInstruction"]);e!==void 0&&T!=null&&h(e,["setup","systemInstruction"],tn(T));const P=d(t,["tools"]);if(e!==void 0&&P!=null){let G=Qa(P);Array.isArray(G)&&(G=G.map(I=>ob(Ja(I)))),h(e,["setup","tools"],G)}const M=d(t,["sessionResumption"]);e!==void 0&&M!=null&&h(e,["setup","sessionResumption"],M);const x=d(t,["inputAudioTranscription"]);e!==void 0&&x!=null&&h(e,["setup","inputAudioTranscription"],x);const E=d(t,["outputAudioTranscription"]);e!==void 0&&E!=null&&h(e,["setup","outputAudioTranscription"],E);const A=d(t,["realtimeInputConfig"]);e!==void 0&&A!=null&&h(e,["setup","realtimeInputConfig"],A);const V=d(t,["contextWindowCompression"]);e!==void 0&&V!=null&&h(e,["setup","contextWindowCompression"],V);const B=d(t,["proactivity"]);return e!==void 0&&B!=null&&h(e,["setup","proactivity"],B),n}function Q1(t,e){const n={},r=d(e,["model"]);r!=null&&h(n,["setup","model"],qe(t,r));const i=d(e,["config"]);return i!=null&&h(n,["config"],K1(i,n)),n}function Y1(t,e){const n={},r=d(e,["model"]);r!=null&&h(n,["setup","model"],qe(t,r));const i=d(e,["config"]);return i!=null&&h(n,["config"],J1(i,n)),n}function X1(t){const e={},n=d(t,["musicGenerationConfig"]);return n!=null&&h(e,["musicGenerationConfig"],n),e}function Z1(t){const e={},n=d(t,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>i)),h(e,["weightedPrompts"],r)}return e}function eb(t){const e={},n=d(t,["media"]);if(n!=null){let u=pC(n);Array.isArray(u)&&(u=u.map(f=>vd(f))),h(e,["mediaChunks"],u)}const r=d(t,["audio"]);r!=null&&h(e,["audio"],vd(gC(r)));const i=d(t,["audioStreamEnd"]);i!=null&&h(e,["audioStreamEnd"],i);const s=d(t,["video"]);s!=null&&h(e,["video"],vd(mC(s)));const o=d(t,["text"]);o!=null&&h(e,["text"],o);const a=d(t,["activityStart"]);a!=null&&h(e,["activityStart"],a);const l=d(t,["activityEnd"]);return l!=null&&h(e,["activityEnd"],l),e}function tb(t){const e={},n=d(t,["media"]);if(n!=null){let u=pC(n);Array.isArray(u)&&(u=u.map(f=>f)),h(e,["mediaChunks"],u)}const r=d(t,["audio"]);r!=null&&h(e,["audio"],gC(r));const i=d(t,["audioStreamEnd"]);i!=null&&h(e,["audioStreamEnd"],i);const s=d(t,["video"]);s!=null&&h(e,["video"],mC(s));const o=d(t,["text"]);o!=null&&h(e,["text"],o);const a=d(t,["activityStart"]);a!=null&&h(e,["activityStart"],a);const l=d(t,["activityEnd"]);return l!=null&&h(e,["activityEnd"],l),e}function nb(t){const e={},n=d(t,["setupComplete"]);n!=null&&h(e,["setupComplete"],n);const r=d(t,["serverContent"]);r!=null&&h(e,["serverContent"],r);const i=d(t,["toolCall"]);i!=null&&h(e,["toolCall"],i);const s=d(t,["toolCallCancellation"]);s!=null&&h(e,["toolCallCancellation"],s);const o=d(t,["usageMetadata"]);o!=null&&h(e,["usageMetadata"],ab(o));const a=d(t,["goAway"]);a!=null&&h(e,["goAway"],a);const l=d(t,["sessionResumptionUpdate"]);return l!=null&&h(e,["sessionResumptionUpdate"],l),e}function rb(t){const e={},n=d(t,["functionCall"]);n!=null&&h(e,["functionCall"],n);const r=d(t,["codeExecutionResult"]);r!=null&&h(e,["codeExecutionResult"],r);const i=d(t,["executableCode"]);i!=null&&h(e,["executableCode"],i);const s=d(t,["fileData"]);s!=null&&h(e,["fileData"],z1(s));const o=d(t,["functionResponse"]);o!=null&&h(e,["functionResponse"],o);const a=d(t,["inlineData"]);a!=null&&h(e,["inlineData"],vd(a));const l=d(t,["text"]);l!=null&&h(e,["text"],l);const u=d(t,["thought"]);u!=null&&h(e,["thought"],u);const f=d(t,["thoughtSignature"]);f!=null&&h(e,["thoughtSignature"],f);const m=d(t,["videoMetadata"]);return m!=null&&h(e,["videoMetadata"],m),e}function ib(t){const e={},n=d(t,["handle"]);if(n!=null&&h(e,["handle"],n),d(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function AC(t){const e={},n=d(t,["languageCode"]);n!=null&&h(e,["languageCode"],n);const r=d(t,["voiceConfig"]);if(r!=null&&h(e,["voiceConfig"],r),d(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return e}function sb(t){const e={},n=d(t,["functionDeclarations"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(f=>f)),h(e,["functionDeclarations"],u)}if(d(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=d(t,["googleSearchRetrieval"]);r!=null&&h(e,["googleSearchRetrieval"],r);const i=d(t,["googleMaps"]);i!=null&&h(e,["googleMaps"],j1(i));const s=d(t,["computerUse"]);s!=null&&h(e,["computerUse"],s);const o=d(t,["codeExecution"]);if(o!=null&&h(e,["codeExecution"],o),d(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=d(t,["googleSearch"]);a!=null&&h(e,["googleSearch"],W1(a));const l=d(t,["urlContext"]);return l!=null&&h(e,["urlContext"],l),e}function ob(t){const e={},n=d(t,["functionDeclarations"]);if(n!=null){let m=n;Array.isArray(m)&&(m=m.map(g=>$1(g))),h(e,["functionDeclarations"],m)}const r=d(t,["retrieval"]);r!=null&&h(e,["retrieval"],r);const i=d(t,["googleSearchRetrieval"]);i!=null&&h(e,["googleSearchRetrieval"],i);const s=d(t,["googleMaps"]);s!=null&&h(e,["googleMaps"],s);const o=d(t,["computerUse"]);o!=null&&h(e,["computerUse"],o);const a=d(t,["codeExecution"]);a!=null&&h(e,["codeExecution"],a);const l=d(t,["enterpriseWebSearch"]);l!=null&&h(e,["enterpriseWebSearch"],l);const u=d(t,["googleSearch"]);u!=null&&h(e,["googleSearch"],u);const f=d(t,["urlContext"]);return f!=null&&h(e,["urlContext"],f),e}function ab(t){const e={},n=d(t,["promptTokenCount"]);n!=null&&h(e,["promptTokenCount"],n);const r=d(t,["cachedContentTokenCount"]);r!=null&&h(e,["cachedContentTokenCount"],r);const i=d(t,["candidatesTokenCount"]);i!=null&&h(e,["responseTokenCount"],i);const s=d(t,["toolUsePromptTokenCount"]);s!=null&&h(e,["toolUsePromptTokenCount"],s);const o=d(t,["thoughtsTokenCount"]);o!=null&&h(e,["thoughtsTokenCount"],o);const a=d(t,["totalTokenCount"]);a!=null&&h(e,["totalTokenCount"],a);const l=d(t,["promptTokensDetails"]);if(l!=null){let v=l;Array.isArray(v)&&(v=v.map(T=>T)),h(e,["promptTokensDetails"],v)}const u=d(t,["cacheTokensDetails"]);if(u!=null){let v=u;Array.isArray(v)&&(v=v.map(T=>T)),h(e,["cacheTokensDetails"],v)}const f=d(t,["candidatesTokensDetails"]);if(f!=null){let v=f;Array.isArray(v)&&(v=v.map(T=>T)),h(e,["responseTokensDetails"],v)}const m=d(t,["toolUsePromptTokensDetails"]);if(m!=null){let v=m;Array.isArray(v)&&(v=v.map(T=>T)),h(e,["toolUsePromptTokensDetails"],v)}const g=d(t,["trafficType"]);return g!=null&&h(e,["trafficType"],g),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function lb(t){const e={},n=d(t,["data"]);if(n!=null&&h(e,["data"],n),d(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=d(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function ub(t){const e={},n=d(t,["content"]);n!=null&&h(e,["content"],n);const r=d(t,["citationMetadata"]);r!=null&&h(e,["citationMetadata"],cb(r));const i=d(t,["tokenCount"]);i!=null&&h(e,["tokenCount"],i);const s=d(t,["finishReason"]);s!=null&&h(e,["finishReason"],s);const o=d(t,["avgLogprobs"]);o!=null&&h(e,["avgLogprobs"],o);const a=d(t,["groundingMetadata"]);a!=null&&h(e,["groundingMetadata"],a);const l=d(t,["index"]);l!=null&&h(e,["index"],l);const u=d(t,["logprobsResult"]);u!=null&&h(e,["logprobsResult"],u);const f=d(t,["safetyRatings"]);if(f!=null){let g=f;Array.isArray(g)&&(g=g.map(v=>v)),h(e,["safetyRatings"],g)}const m=d(t,["urlContextMetadata"]);return m!=null&&h(e,["urlContextMetadata"],m),e}function cb(t){const e={},n=d(t,["citationSources"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>i)),h(e,["citations"],r)}return e}function db(t,e){const n={},r=d(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=d(e,["contents"]);if(i!=null){let s=$n(i);Array.isArray(s)&&(s=s.map(o=>o)),h(n,["contents"],s)}return n}function hb(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=d(t,["tokensInfo"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>s)),h(e,["tokensInfo"],i)}return e}function fb(t){const e={},n=d(t,["values"]);n!=null&&h(e,["values"],n);const r=d(t,["statistics"]);return r!=null&&h(e,["statistics"],pb(r)),e}function pb(t){const e={},n=d(t,["truncated"]);n!=null&&h(e,["truncated"],n);const r=d(t,["token_count"]);return r!=null&&h(e,["tokenCount"],r),e}function Yh(t){const e={},n=d(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>vD(s))),h(e,["parts"],i)}const r=d(t,["role"]);return r!=null&&h(e,["role"],r),e}function mb(t){const e={},n=d(t,["controlType"]);n!=null&&h(e,["controlType"],n);const r=d(t,["enableControlImageComputation"]);return r!=null&&h(e,["computeControl"],r),e}function gb(t){const e={};if(d(t,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(d(t,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(d(t,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function _b(t,e){const n={},r=d(t,["systemInstruction"]);e!==void 0&&r!=null&&h(e,["systemInstruction"],tn(r));const i=d(t,["tools"]);if(e!==void 0&&i!=null){let o=i;Array.isArray(o)&&(o=o.map(a=>bC(a))),h(e,["tools"],o)}const s=d(t,["generationConfig"]);return e!==void 0&&s!=null&&h(e,["generationConfig"],oD(s)),n}function yb(t,e){const n={},r=d(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=d(e,["contents"]);if(i!=null){let o=$n(i);Array.isArray(o)&&(o=o.map(a=>Yh(a))),h(n,["contents"],o)}const s=d(e,["config"]);return s!=null&&gb(s),n}function vb(t,e){const n={},r=d(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=d(e,["contents"]);if(i!=null){let o=$n(i);Array.isArray(o)&&(o=o.map(a=>a)),h(n,["contents"],o)}const s=d(e,["config"]);return s!=null&&_b(s,n),n}function Tb(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=d(t,["totalTokens"]);r!=null&&h(e,["totalTokens"],r);const i=d(t,["cachedContentTokenCount"]);return i!=null&&h(e,["cachedContentTokenCount"],i),e}function Eb(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=d(t,["totalTokens"]);return r!=null&&h(e,["totalTokens"],r),e}function wb(t,e){const n={},r=d(e,["model"]);return r!=null&&h(n,["_url","name"],qe(t,r)),n}function Ib(t,e){const n={},r=d(e,["model"]);return r!=null&&h(n,["_url","name"],qe(t,r)),n}function Sb(t){const e={},n=d(t,["sdkHttpResponse"]);return n!=null&&h(e,["sdkHttpResponse"],n),e}function Cb(t){const e={},n=d(t,["sdkHttpResponse"]);return n!=null&&h(e,["sdkHttpResponse"],n),e}function xb(t,e){const n={},r=d(t,["outputGcsUri"]);e!==void 0&&r!=null&&h(e,["parameters","storageUri"],r);const i=d(t,["negativePrompt"]);e!==void 0&&i!=null&&h(e,["parameters","negativePrompt"],i);const s=d(t,["numberOfImages"]);e!==void 0&&s!=null&&h(e,["parameters","sampleCount"],s);const o=d(t,["aspectRatio"]);e!==void 0&&o!=null&&h(e,["parameters","aspectRatio"],o);const a=d(t,["guidanceScale"]);e!==void 0&&a!=null&&h(e,["parameters","guidanceScale"],a);const l=d(t,["seed"]);e!==void 0&&l!=null&&h(e,["parameters","seed"],l);const u=d(t,["safetyFilterLevel"]);e!==void 0&&u!=null&&h(e,["parameters","safetySetting"],u);const f=d(t,["personGeneration"]);e!==void 0&&f!=null&&h(e,["parameters","personGeneration"],f);const m=d(t,["includeSafetyAttributes"]);e!==void 0&&m!=null&&h(e,["parameters","includeSafetyAttributes"],m);const g=d(t,["includeRaiReason"]);e!==void 0&&g!=null&&h(e,["parameters","includeRaiReason"],g);const v=d(t,["language"]);e!==void 0&&v!=null&&h(e,["parameters","language"],v);const T=d(t,["outputMimeType"]);e!==void 0&&T!=null&&h(e,["parameters","outputOptions","mimeType"],T);const P=d(t,["outputCompressionQuality"]);e!==void 0&&P!=null&&h(e,["parameters","outputOptions","compressionQuality"],P);const M=d(t,["addWatermark"]);e!==void 0&&M!=null&&h(e,["parameters","addWatermark"],M);const x=d(t,["labels"]);e!==void 0&&x!=null&&h(e,["labels"],x);const E=d(t,["editMode"]);e!==void 0&&E!=null&&h(e,["parameters","editMode"],E);const A=d(t,["baseSteps"]);return e!==void 0&&A!=null&&h(e,["parameters","editConfig","baseSteps"],A),n}function Ab(t,e){const n={},r=d(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=d(e,["prompt"]);i!=null&&h(n,["instances[0]","prompt"],i);const s=d(e,["referenceImages"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>CD(l))),h(n,["instances[0]","referenceImages"],a)}const o=d(e,["config"]);return o!=null&&xb(o,n),n}function Rb(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=d(t,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>Xh(s))),h(e,["generatedImages"],i)}return e}function Pb(t,e){const n={},r=d(t,["taskType"]);e!==void 0&&r!=null&&h(e,["requests[]","taskType"],r);const i=d(t,["title"]);e!==void 0&&i!=null&&h(e,["requests[]","title"],i);const s=d(t,["outputDimensionality"]);if(e!==void 0&&s!=null&&h(e,["requests[]","outputDimensionality"],s),d(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(d(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function kb(t,e){const n={},r=d(t,["taskType"]);e!==void 0&&r!=null&&h(e,["instances[]","task_type"],r);const i=d(t,["title"]);e!==void 0&&i!=null&&h(e,["instances[]","title"],i);const s=d(t,["outputDimensionality"]);e!==void 0&&s!=null&&h(e,["parameters","outputDimensionality"],s);const o=d(t,["mimeType"]);e!==void 0&&o!=null&&h(e,["instances[]","mimeType"],o);const a=d(t,["autoTruncate"]);return e!==void 0&&a!=null&&h(e,["parameters","autoTruncate"],a),n}function Nb(t,e){const n={},r=d(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=d(e,["contents"]);if(i!=null){let a=f_(t,i);Array.isArray(a)&&(a=a.map(l=>l)),h(n,["requests[]","content"],a)}const s=d(e,["config"]);s!=null&&Pb(s,n);const o=d(e,["model"]);return o!==void 0&&h(n,["requests[]","model"],qe(t,o)),n}function bb(t,e){const n={},r=d(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=d(e,["contents"]);if(i!=null){let o=f_(t,i);Array.isArray(o)&&(o=o.map(a=>a)),h(n,["instances[]","content"],o)}const s=d(e,["config"]);return s!=null&&kb(s,n),n}function Db(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=d(t,["embeddings"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>o)),h(e,["embeddings"],s)}const i=d(t,["metadata"]);return i!=null&&h(e,["metadata"],i),e}function Mb(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=d(t,["predictions[]","embeddings"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>fb(o))),h(e,["embeddings"],s)}const i=d(t,["metadata"]);return i!=null&&h(e,["metadata"],i),e}function Vb(t){const e={},n=d(t,["endpoint"]);n!=null&&h(e,["name"],n);const r=d(t,["deployedModelId"]);return r!=null&&h(e,["deployedModelId"],r),e}function Lb(t){const e={};if(d(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=d(t,["fileUri"]);n!=null&&h(e,["fileUri"],n);const r=d(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function Fb(t){const e={};if(d(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=d(t,["description"]);n!=null&&h(e,["description"],n);const r=d(t,["name"]);r!=null&&h(e,["name"],r);const i=d(t,["parameters"]);i!=null&&h(e,["parameters"],i);const s=d(t,["parametersJsonSchema"]);s!=null&&h(e,["parametersJsonSchema"],s);const o=d(t,["response"]);o!=null&&h(e,["response"],o);const a=d(t,["responseJsonSchema"]);return a!=null&&h(e,["responseJsonSchema"],a),e}function Ub(t,e,n){const r={},i=d(e,["systemInstruction"]);n!==void 0&&i!=null&&h(n,["systemInstruction"],Yh(tn(i)));const s=d(e,["temperature"]);s!=null&&h(r,["temperature"],s);const o=d(e,["topP"]);o!=null&&h(r,["topP"],o);const a=d(e,["topK"]);a!=null&&h(r,["topK"],a);const l=d(e,["candidateCount"]);l!=null&&h(r,["candidateCount"],l);const u=d(e,["maxOutputTokens"]);u!=null&&h(r,["maxOutputTokens"],u);const f=d(e,["stopSequences"]);f!=null&&h(r,["stopSequences"],f);const m=d(e,["responseLogprobs"]);m!=null&&h(r,["responseLogprobs"],m);const g=d(e,["logprobs"]);g!=null&&h(r,["logprobs"],g);const v=d(e,["presencePenalty"]);v!=null&&h(r,["presencePenalty"],v);const T=d(e,["frequencyPenalty"]);T!=null&&h(r,["frequencyPenalty"],T);const P=d(e,["seed"]);P!=null&&h(r,["seed"],P);const M=d(e,["responseMimeType"]);M!=null&&h(r,["responseMimeType"],M);const x=d(e,["responseSchema"]);x!=null&&h(r,["responseSchema"],p_(x));const E=d(e,["responseJsonSchema"]);if(E!=null&&h(r,["responseJsonSchema"],E),d(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(d(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const A=d(e,["safetySettings"]);if(n!==void 0&&A!=null){let L=A;Array.isArray(L)&&(L=L.map(b=>xD(b))),h(n,["safetySettings"],L)}const V=d(e,["tools"]);if(n!==void 0&&V!=null){let L=Qa(V);Array.isArray(L)&&(L=L.map(b=>bD(Ja(b)))),h(n,["tools"],L)}const B=d(e,["toolConfig"]);if(n!==void 0&&B!=null&&h(n,["toolConfig"],B),d(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const G=d(e,["cachedContent"]);n!==void 0&&G!=null&&h(n,["cachedContent"],li(t,G));const I=d(e,["responseModalities"]);I!=null&&h(r,["responseModalities"],I);const S=d(e,["mediaResolution"]);S!=null&&h(r,["mediaResolution"],S);const R=d(e,["speechConfig"]);if(R!=null&&h(r,["speechConfig"],m_(R)),d(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const N=d(e,["thinkingConfig"]);N!=null&&h(r,["thinkingConfig"],N);const D=d(e,["imageConfig"]);return D!=null&&h(r,["imageConfig"],D),r}function Ob(t,e,n){const r={},i=d(e,["systemInstruction"]);n!==void 0&&i!=null&&h(n,["systemInstruction"],tn(i));const s=d(e,["temperature"]);s!=null&&h(r,["temperature"],s);const o=d(e,["topP"]);o!=null&&h(r,["topP"],o);const a=d(e,["topK"]);a!=null&&h(r,["topK"],a);const l=d(e,["candidateCount"]);l!=null&&h(r,["candidateCount"],l);const u=d(e,["maxOutputTokens"]);u!=null&&h(r,["maxOutputTokens"],u);const f=d(e,["stopSequences"]);f!=null&&h(r,["stopSequences"],f);const m=d(e,["responseLogprobs"]);m!=null&&h(r,["responseLogprobs"],m);const g=d(e,["logprobs"]);g!=null&&h(r,["logprobs"],g);const v=d(e,["presencePenalty"]);v!=null&&h(r,["presencePenalty"],v);const T=d(e,["frequencyPenalty"]);T!=null&&h(r,["frequencyPenalty"],T);const P=d(e,["seed"]);P!=null&&h(r,["seed"],P);const M=d(e,["responseMimeType"]);M!=null&&h(r,["responseMimeType"],M);const x=d(e,["responseSchema"]);x!=null&&h(r,["responseSchema"],p_(x));const E=d(e,["responseJsonSchema"]);E!=null&&h(r,["responseJsonSchema"],E);const A=d(e,["routingConfig"]);A!=null&&h(r,["routingConfig"],A);const V=d(e,["modelSelectionConfig"]);V!=null&&h(r,["modelConfig"],V);const B=d(e,["safetySettings"]);if(n!==void 0&&B!=null){let Ge=B;Array.isArray(Ge)&&(Ge=Ge.map(Se=>Se)),h(n,["safetySettings"],Ge)}const G=d(e,["tools"]);if(n!==void 0&&G!=null){let Ge=Qa(G);Array.isArray(Ge)&&(Ge=Ge.map(Se=>bC(Ja(Se)))),h(n,["tools"],Ge)}const I=d(e,["toolConfig"]);n!==void 0&&I!=null&&h(n,["toolConfig"],I);const S=d(e,["labels"]);n!==void 0&&S!=null&&h(n,["labels"],S);const R=d(e,["cachedContent"]);n!==void 0&&R!=null&&h(n,["cachedContent"],li(t,R));const N=d(e,["responseModalities"]);N!=null&&h(r,["responseModalities"],N);const D=d(e,["mediaResolution"]);D!=null&&h(r,["mediaResolution"],D);const L=d(e,["speechConfig"]);L!=null&&h(r,["speechConfig"],NC(m_(L)));const b=d(e,["audioTimestamp"]);b!=null&&h(r,["audioTimestamp"],b);const Re=d(e,["thinkingConfig"]);Re!=null&&h(r,["thinkingConfig"],Re);const Ze=d(e,["imageConfig"]);return Ze!=null&&h(r,["imageConfig"],Ze),r}function GT(t,e){const n={},r=d(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=d(e,["contents"]);if(i!=null){let o=$n(i);Array.isArray(o)&&(o=o.map(a=>Yh(a))),h(n,["contents"],o)}const s=d(e,["config"]);return s!=null&&h(n,["generationConfig"],Ub(t,s,n)),n}function qT(t,e){const n={},r=d(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=d(e,["contents"]);if(i!=null){let o=$n(i);Array.isArray(o)&&(o=o.map(a=>a)),h(n,["contents"],o)}const s=d(e,["config"]);return s!=null&&h(n,["generationConfig"],Ob(t,s,n)),n}function zT(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=d(t,["candidates"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(u=>ub(u))),h(e,["candidates"],l)}const i=d(t,["modelVersion"]);i!=null&&h(e,["modelVersion"],i);const s=d(t,["promptFeedback"]);s!=null&&h(e,["promptFeedback"],s);const o=d(t,["responseId"]);o!=null&&h(e,["responseId"],o);const a=d(t,["usageMetadata"]);return a!=null&&h(e,["usageMetadata"],a),e}function $T(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=d(t,["candidates"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(f=>f)),h(e,["candidates"],u)}const i=d(t,["createTime"]);i!=null&&h(e,["createTime"],i);const s=d(t,["modelVersion"]);s!=null&&h(e,["modelVersion"],s);const o=d(t,["promptFeedback"]);o!=null&&h(e,["promptFeedback"],o);const a=d(t,["responseId"]);a!=null&&h(e,["responseId"],a);const l=d(t,["usageMetadata"]);return l!=null&&h(e,["usageMetadata"],l),e}function Bb(t,e){const n={};if(d(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(d(t,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const r=d(t,["numberOfImages"]);e!==void 0&&r!=null&&h(e,["parameters","sampleCount"],r);const i=d(t,["aspectRatio"]);e!==void 0&&i!=null&&h(e,["parameters","aspectRatio"],i);const s=d(t,["guidanceScale"]);if(e!==void 0&&s!=null&&h(e,["parameters","guidanceScale"],s),d(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=d(t,["safetyFilterLevel"]);e!==void 0&&o!=null&&h(e,["parameters","safetySetting"],o);const a=d(t,["personGeneration"]);e!==void 0&&a!=null&&h(e,["parameters","personGeneration"],a);const l=d(t,["includeSafetyAttributes"]);e!==void 0&&l!=null&&h(e,["parameters","includeSafetyAttributes"],l);const u=d(t,["includeRaiReason"]);e!==void 0&&u!=null&&h(e,["parameters","includeRaiReason"],u);const f=d(t,["language"]);e!==void 0&&f!=null&&h(e,["parameters","language"],f);const m=d(t,["outputMimeType"]);e!==void 0&&m!=null&&h(e,["parameters","outputOptions","mimeType"],m);const g=d(t,["outputCompressionQuality"]);if(e!==void 0&&g!=null&&h(e,["parameters","outputOptions","compressionQuality"],g),d(t,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(d(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const v=d(t,["imageSize"]);if(e!==void 0&&v!=null&&h(e,["parameters","sampleImageSize"],v),d(t,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function Gb(t,e){const n={},r=d(t,["outputGcsUri"]);e!==void 0&&r!=null&&h(e,["parameters","storageUri"],r);const i=d(t,["negativePrompt"]);e!==void 0&&i!=null&&h(e,["parameters","negativePrompt"],i);const s=d(t,["numberOfImages"]);e!==void 0&&s!=null&&h(e,["parameters","sampleCount"],s);const o=d(t,["aspectRatio"]);e!==void 0&&o!=null&&h(e,["parameters","aspectRatio"],o);const a=d(t,["guidanceScale"]);e!==void 0&&a!=null&&h(e,["parameters","guidanceScale"],a);const l=d(t,["seed"]);e!==void 0&&l!=null&&h(e,["parameters","seed"],l);const u=d(t,["safetyFilterLevel"]);e!==void 0&&u!=null&&h(e,["parameters","safetySetting"],u);const f=d(t,["personGeneration"]);e!==void 0&&f!=null&&h(e,["parameters","personGeneration"],f);const m=d(t,["includeSafetyAttributes"]);e!==void 0&&m!=null&&h(e,["parameters","includeSafetyAttributes"],m);const g=d(t,["includeRaiReason"]);e!==void 0&&g!=null&&h(e,["parameters","includeRaiReason"],g);const v=d(t,["language"]);e!==void 0&&v!=null&&h(e,["parameters","language"],v);const T=d(t,["outputMimeType"]);e!==void 0&&T!=null&&h(e,["parameters","outputOptions","mimeType"],T);const P=d(t,["outputCompressionQuality"]);e!==void 0&&P!=null&&h(e,["parameters","outputOptions","compressionQuality"],P);const M=d(t,["addWatermark"]);e!==void 0&&M!=null&&h(e,["parameters","addWatermark"],M);const x=d(t,["labels"]);e!==void 0&&x!=null&&h(e,["labels"],x);const E=d(t,["imageSize"]);e!==void 0&&E!=null&&h(e,["parameters","sampleImageSize"],E);const A=d(t,["enhancePrompt"]);return e!==void 0&&A!=null&&h(e,["parameters","enhancePrompt"],A),n}function qb(t,e){const n={},r=d(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=d(e,["prompt"]);i!=null&&h(n,["instances[0]","prompt"],i);const s=d(e,["config"]);return s!=null&&Bb(s,n),n}function zb(t,e){const n={},r=d(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=d(e,["prompt"]);i!=null&&h(n,["instances[0]","prompt"],i);const s=d(e,["config"]);return s!=null&&Gb(s,n),n}function $b(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=d(t,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>nD(o))),h(e,["generatedImages"],s)}const i=d(t,["positivePromptSafetyAttributes"]);return i!=null&&h(e,["positivePromptSafetyAttributes"],PC(i)),e}function Hb(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=d(t,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>Xh(o))),h(e,["generatedImages"],s)}const i=d(t,["positivePromptSafetyAttributes"]);return i!=null&&h(e,["positivePromptSafetyAttributes"],kC(i)),e}function jb(t,e){const n={},r=d(t,["numberOfVideos"]);if(e!==void 0&&r!=null&&h(e,["parameters","sampleCount"],r),d(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(d(t,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const i=d(t,["durationSeconds"]);if(e!==void 0&&i!=null&&h(e,["parameters","durationSeconds"],i),d(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const s=d(t,["aspectRatio"]);e!==void 0&&s!=null&&h(e,["parameters","aspectRatio"],s);const o=d(t,["resolution"]);e!==void 0&&o!=null&&h(e,["parameters","resolution"],o);const a=d(t,["personGeneration"]);if(e!==void 0&&a!=null&&h(e,["parameters","personGeneration"],a),d(t,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const l=d(t,["negativePrompt"]);e!==void 0&&l!=null&&h(e,["parameters","negativePrompt"],l);const u=d(t,["enhancePrompt"]);if(e!==void 0&&u!=null&&h(e,["parameters","enhancePrompt"],u),d(t,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const f=d(t,["lastFrame"]);e!==void 0&&f!=null&&h(e,["instances[0]","lastFrame"],Zh(f));const m=d(t,["referenceImages"]);if(e!==void 0&&m!=null){let g=m;Array.isArray(g)&&(g=g.map(v=>HD(v))),h(e,["instances[0]","referenceImages"],g)}if(d(t,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(d(t,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return n}function Wb(t,e){const n={},r=d(t,["numberOfVideos"]);e!==void 0&&r!=null&&h(e,["parameters","sampleCount"],r);const i=d(t,["outputGcsUri"]);e!==void 0&&i!=null&&h(e,["parameters","storageUri"],i);const s=d(t,["fps"]);e!==void 0&&s!=null&&h(e,["parameters","fps"],s);const o=d(t,["durationSeconds"]);e!==void 0&&o!=null&&h(e,["parameters","durationSeconds"],o);const a=d(t,["seed"]);e!==void 0&&a!=null&&h(e,["parameters","seed"],a);const l=d(t,["aspectRatio"]);e!==void 0&&l!=null&&h(e,["parameters","aspectRatio"],l);const u=d(t,["resolution"]);e!==void 0&&u!=null&&h(e,["parameters","resolution"],u);const f=d(t,["personGeneration"]);e!==void 0&&f!=null&&h(e,["parameters","personGeneration"],f);const m=d(t,["pubsubTopic"]);e!==void 0&&m!=null&&h(e,["parameters","pubsubTopic"],m);const g=d(t,["negativePrompt"]);e!==void 0&&g!=null&&h(e,["parameters","negativePrompt"],g);const v=d(t,["enhancePrompt"]);e!==void 0&&v!=null&&h(e,["parameters","enhancePrompt"],v);const T=d(t,["generateAudio"]);e!==void 0&&T!=null&&h(e,["parameters","generateAudio"],T);const P=d(t,["lastFrame"]);e!==void 0&&P!=null&&h(e,["instances[0]","lastFrame"],hr(P));const M=d(t,["referenceImages"]);if(e!==void 0&&M!=null){let A=M;Array.isArray(A)&&(A=A.map(V=>jD(V))),h(e,["instances[0]","referenceImages"],A)}const x=d(t,["mask"]);e!==void 0&&x!=null&&h(e,["instances[0]","mask"],$D(x));const E=d(t,["compressionQuality"]);return e!==void 0&&E!=null&&h(e,["parameters","compressionQuality"],E),n}function Kb(t){const e={},n=d(t,["name"]);n!=null&&h(e,["name"],n);const r=d(t,["metadata"]);r!=null&&h(e,["metadata"],r);const i=d(t,["done"]);i!=null&&h(e,["done"],i);const s=d(t,["error"]);s!=null&&h(e,["error"],s);const o=d(t,["response","generateVideoResponse"]);return o!=null&&h(e,["response"],Xb(o)),e}function Jb(t){const e={},n=d(t,["name"]);n!=null&&h(e,["name"],n);const r=d(t,["metadata"]);r!=null&&h(e,["metadata"],r);const i=d(t,["done"]);i!=null&&h(e,["done"],i);const s=d(t,["error"]);s!=null&&h(e,["error"],s);const o=d(t,["response"]);return o!=null&&h(e,["response"],Zb(o)),e}function Qb(t,e){const n={},r=d(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=d(e,["prompt"]);i!=null&&h(n,["instances[0]","prompt"],i);const s=d(e,["image"]);s!=null&&h(n,["instances[0]","image"],Zh(s));const o=d(e,["video"]);o!=null&&h(n,["instances[0]","video"],DC(o));const a=d(e,["source"]);a!=null&&eD(a,n);const l=d(e,["config"]);return l!=null&&jb(l,n),n}function Yb(t,e){const n={},r=d(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=d(e,["prompt"]);i!=null&&h(n,["instances[0]","prompt"],i);const s=d(e,["image"]);s!=null&&h(n,["instances[0]","image"],hr(s));const o=d(e,["video"]);o!=null&&h(n,["instances[0]","video"],MC(o));const a=d(e,["source"]);a!=null&&tD(a,n);const l=d(e,["config"]);return l!=null&&Wb(l,n),n}function Xb(t){const e={},n=d(t,["generatedSamples"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>iD(o))),h(e,["generatedVideos"],s)}const r=d(t,["raiMediaFilteredCount"]);r!=null&&h(e,["raiMediaFilteredCount"],r);const i=d(t,["raiMediaFilteredReasons"]);return i!=null&&h(e,["raiMediaFilteredReasons"],i),e}function Zb(t){const e={},n=d(t,["videos"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>sD(o))),h(e,["generatedVideos"],s)}const r=d(t,["raiMediaFilteredCount"]);r!=null&&h(e,["raiMediaFilteredCount"],r);const i=d(t,["raiMediaFilteredReasons"]);return i!=null&&h(e,["raiMediaFilteredReasons"],i),e}function eD(t,e){const n={},r=d(t,["prompt"]);e!==void 0&&r!=null&&h(e,["instances[0]","prompt"],r);const i=d(t,["image"]);e!==void 0&&i!=null&&h(e,["instances[0]","image"],Zh(i));const s=d(t,["video"]);return e!==void 0&&s!=null&&h(e,["instances[0]","video"],DC(s)),n}function tD(t,e){const n={},r=d(t,["prompt"]);e!==void 0&&r!=null&&h(e,["instances[0]","prompt"],r);const i=d(t,["image"]);e!==void 0&&i!=null&&h(e,["instances[0]","image"],hr(i));const s=d(t,["video"]);return e!==void 0&&s!=null&&h(e,["instances[0]","video"],MC(s)),n}function nD(t){const e={},n=d(t,["_self"]);n!=null&&h(e,["image"],dD(n));const r=d(t,["raiFilteredReason"]);r!=null&&h(e,["raiFilteredReason"],r);const i=d(t,["_self"]);return i!=null&&h(e,["safetyAttributes"],PC(i)),e}function Xh(t){const e={},n=d(t,["_self"]);n!=null&&h(e,["image"],RC(n));const r=d(t,["raiFilteredReason"]);r!=null&&h(e,["raiFilteredReason"],r);const i=d(t,["_self"]);i!=null&&h(e,["safetyAttributes"],kC(i));const s=d(t,["prompt"]);return s!=null&&h(e,["enhancedPrompt"],s),e}function rD(t){const e={},n=d(t,["_self"]);n!=null&&h(e,["mask"],RC(n));const r=d(t,["labels"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>s)),h(e,["labels"],i)}return e}function iD(t){const e={},n=d(t,["video"]);return n!=null&&h(e,["video"],qD(n)),e}function sD(t){const e={},n=d(t,["_self"]);return n!=null&&h(e,["video"],zD(n)),e}function oD(t){const e={},n=d(t,["modelSelectionConfig"]);n!=null&&h(e,["modelConfig"],n);const r=d(t,["audioTimestamp"]);r!=null&&h(e,["audioTimestamp"],r);const i=d(t,["candidateCount"]);i!=null&&h(e,["candidateCount"],i);const s=d(t,["enableAffectiveDialog"]);s!=null&&h(e,["enableAffectiveDialog"],s);const o=d(t,["frequencyPenalty"]);o!=null&&h(e,["frequencyPenalty"],o);const a=d(t,["logprobs"]);a!=null&&h(e,["logprobs"],a);const l=d(t,["maxOutputTokens"]);l!=null&&h(e,["maxOutputTokens"],l);const u=d(t,["mediaResolution"]);u!=null&&h(e,["mediaResolution"],u);const f=d(t,["presencePenalty"]);f!=null&&h(e,["presencePenalty"],f);const m=d(t,["responseJsonSchema"]);m!=null&&h(e,["responseJsonSchema"],m);const g=d(t,["responseLogprobs"]);g!=null&&h(e,["responseLogprobs"],g);const v=d(t,["responseMimeType"]);v!=null&&h(e,["responseMimeType"],v);const T=d(t,["responseModalities"]);T!=null&&h(e,["responseModalities"],T);const P=d(t,["responseSchema"]);P!=null&&h(e,["responseSchema"],P);const M=d(t,["routingConfig"]);M!=null&&h(e,["routingConfig"],M);const x=d(t,["seed"]);x!=null&&h(e,["seed"],x);const E=d(t,["speechConfig"]);E!=null&&h(e,["speechConfig"],NC(E));const A=d(t,["stopSequences"]);A!=null&&h(e,["stopSequences"],A);const V=d(t,["temperature"]);V!=null&&h(e,["temperature"],V);const B=d(t,["thinkingConfig"]);B!=null&&h(e,["thinkingConfig"],B);const G=d(t,["topK"]);G!=null&&h(e,["topK"],G);const I=d(t,["topP"]);if(I!=null&&h(e,["topP"],I),d(t,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function aD(t,e){const n={},r=d(e,["model"]);return r!=null&&h(n,["_url","name"],qe(t,r)),n}function lD(t,e){const n={},r=d(e,["model"]);return r!=null&&h(n,["_url","name"],qe(t,r)),n}function uD(t){const e={};if(d(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=d(t,["enableWidget"]);return n!=null&&h(e,["enableWidget"],n),e}function cD(t){const e={};if(d(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");const n=d(t,["timeRangeFilter"]);return n!=null&&h(e,["timeRangeFilter"],n),e}function dD(t){const e={},n=d(t,["bytesBase64Encoded"]);n!=null&&h(e,["imageBytes"],ps(n));const r=d(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function RC(t){const e={},n=d(t,["gcsUri"]);n!=null&&h(e,["gcsUri"],n);const r=d(t,["bytesBase64Encoded"]);r!=null&&h(e,["imageBytes"],ps(r));const i=d(t,["mimeType"]);return i!=null&&h(e,["mimeType"],i),e}function Zh(t){const e={};if(d(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=d(t,["imageBytes"]);n!=null&&h(e,["bytesBase64Encoded"],ps(n));const r=d(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function hr(t){const e={},n=d(t,["gcsUri"]);n!=null&&h(e,["gcsUri"],n);const r=d(t,["imageBytes"]);r!=null&&h(e,["bytesBase64Encoded"],ps(r));const i=d(t,["mimeType"]);return i!=null&&h(e,["mimeType"],i),e}function hD(t,e,n){const r={},i=d(e,["pageSize"]);n!==void 0&&i!=null&&h(n,["_query","pageSize"],i);const s=d(e,["pageToken"]);n!==void 0&&s!=null&&h(n,["_query","pageToken"],s);const o=d(e,["filter"]);n!==void 0&&o!=null&&h(n,["_query","filter"],o);const a=d(e,["queryBase"]);return n!==void 0&&a!=null&&h(n,["_url","models_url"],TC(t,a)),r}function fD(t,e,n){const r={},i=d(e,["pageSize"]);n!==void 0&&i!=null&&h(n,["_query","pageSize"],i);const s=d(e,["pageToken"]);n!==void 0&&s!=null&&h(n,["_query","pageToken"],s);const o=d(e,["filter"]);n!==void 0&&o!=null&&h(n,["_query","filter"],o);const a=d(e,["queryBase"]);return n!==void 0&&a!=null&&h(n,["_url","models_url"],TC(t,a)),r}function pD(t,e){const n={},r=d(e,["config"]);return r!=null&&hD(t,r,n),n}function mD(t,e){const n={},r=d(e,["config"]);return r!=null&&fD(t,r,n),n}function gD(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=d(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=d(t,["_self"]);if(i!=null){let s=EC(i);Array.isArray(s)&&(s=s.map(o=>Pm(o))),h(e,["models"],s)}return e}function _D(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=d(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=d(t,["_self"]);if(i!=null){let s=EC(i);Array.isArray(s)&&(s=s.map(o=>km(o))),h(e,["models"],s)}return e}function yD(t){const e={},n=d(t,["maskMode"]);n!=null&&h(e,["maskMode"],n);const r=d(t,["segmentationClasses"]);r!=null&&h(e,["maskClasses"],r);const i=d(t,["maskDilation"]);return i!=null&&h(e,["dilation"],i),e}function Pm(t){const e={},n=d(t,["name"]);n!=null&&h(e,["name"],n);const r=d(t,["displayName"]);r!=null&&h(e,["displayName"],r);const i=d(t,["description"]);i!=null&&h(e,["description"],i);const s=d(t,["version"]);s!=null&&h(e,["version"],s);const o=d(t,["_self"]);o!=null&&h(e,["tunedModelInfo"],DD(o));const a=d(t,["inputTokenLimit"]);a!=null&&h(e,["inputTokenLimit"],a);const l=d(t,["outputTokenLimit"]);l!=null&&h(e,["outputTokenLimit"],l);const u=d(t,["supportedGenerationMethods"]);return u!=null&&h(e,["supportedActions"],u),e}function km(t){const e={},n=d(t,["name"]);n!=null&&h(e,["name"],n);const r=d(t,["displayName"]);r!=null&&h(e,["displayName"],r);const i=d(t,["description"]);i!=null&&h(e,["description"],i);const s=d(t,["versionId"]);s!=null&&h(e,["version"],s);const o=d(t,["deployedModels"]);if(o!=null){let m=o;Array.isArray(m)&&(m=m.map(g=>Vb(g))),h(e,["endpoints"],m)}const a=d(t,["labels"]);a!=null&&h(e,["labels"],a);const l=d(t,["_self"]);l!=null&&h(e,["tunedModelInfo"],MD(l));const u=d(t,["defaultCheckpointId"]);u!=null&&h(e,["defaultCheckpointId"],u);const f=d(t,["checkpoints"]);if(f!=null){let m=f;Array.isArray(m)&&(m=m.map(g=>g)),h(e,["checkpoints"],m)}return e}function vD(t){const e={},n=d(t,["functionCall"]);n!=null&&h(e,["functionCall"],n);const r=d(t,["codeExecutionResult"]);r!=null&&h(e,["codeExecutionResult"],r);const i=d(t,["executableCode"]);i!=null&&h(e,["executableCode"],i);const s=d(t,["fileData"]);s!=null&&h(e,["fileData"],Lb(s));const o=d(t,["functionResponse"]);o!=null&&h(e,["functionResponse"],o);const a=d(t,["inlineData"]);a!=null&&h(e,["inlineData"],lb(a));const l=d(t,["text"]);l!=null&&h(e,["text"],l);const u=d(t,["thought"]);u!=null&&h(e,["thought"],u);const f=d(t,["thoughtSignature"]);f!=null&&h(e,["thoughtSignature"],f);const m=d(t,["videoMetadata"]);return m!=null&&h(e,["videoMetadata"],m),e}function TD(t){const e={},n=d(t,["productImage"]);return n!=null&&h(e,["image"],hr(n)),e}function ED(t,e){const n={},r=d(t,["numberOfImages"]);e!==void 0&&r!=null&&h(e,["parameters","sampleCount"],r);const i=d(t,["baseSteps"]);e!==void 0&&i!=null&&h(e,["parameters","editConfig","baseSteps"],i);const s=d(t,["outputGcsUri"]);e!==void 0&&s!=null&&h(e,["parameters","storageUri"],s);const o=d(t,["seed"]);e!==void 0&&o!=null&&h(e,["parameters","seed"],o);const a=d(t,["safetyFilterLevel"]);e!==void 0&&a!=null&&h(e,["parameters","safetySetting"],a);const l=d(t,["personGeneration"]);e!==void 0&&l!=null&&h(e,["parameters","personGeneration"],l);const u=d(t,["addWatermark"]);e!==void 0&&u!=null&&h(e,["parameters","addWatermark"],u);const f=d(t,["outputMimeType"]);e!==void 0&&f!=null&&h(e,["parameters","outputOptions","mimeType"],f);const m=d(t,["outputCompressionQuality"]);e!==void 0&&m!=null&&h(e,["parameters","outputOptions","compressionQuality"],m);const g=d(t,["enhancePrompt"]);e!==void 0&&g!=null&&h(e,["parameters","enhancePrompt"],g);const v=d(t,["labels"]);return e!==void 0&&v!=null&&h(e,["labels"],v),n}function wD(t,e){const n={},r=d(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=d(e,["source"]);i!=null&&SD(i,n);const s=d(e,["config"]);return s!=null&&ED(s,n),n}function ID(t){const e={},n=d(t,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>Xh(i))),h(e,["generatedImages"],r)}return e}function SD(t,e){const n={},r=d(t,["prompt"]);e!==void 0&&r!=null&&h(e,["instances[0]","prompt"],r);const i=d(t,["personImage"]);e!==void 0&&i!=null&&h(e,["instances[0]","personImage","image"],hr(i));const s=d(t,["productImages"]);if(e!==void 0&&s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>TD(a))),h(e,["instances[0]","productImages"],o)}return n}function CD(t){const e={},n=d(t,["referenceImage"]);n!=null&&h(e,["referenceImage"],hr(n));const r=d(t,["referenceId"]);r!=null&&h(e,["referenceId"],r);const i=d(t,["referenceType"]);i!=null&&h(e,["referenceType"],i);const s=d(t,["maskImageConfig"]);s!=null&&h(e,["maskImageConfig"],yD(s));const o=d(t,["controlImageConfig"]);o!=null&&h(e,["controlImageConfig"],mb(o));const a=d(t,["styleImageConfig"]);a!=null&&h(e,["styleImageConfig"],a);const l=d(t,["subjectImageConfig"]);return l!=null&&h(e,["subjectImageConfig"],l),e}function PC(t){const e={},n=d(t,["safetyAttributes","categories"]);n!=null&&h(e,["categories"],n);const r=d(t,["safetyAttributes","scores"]);r!=null&&h(e,["scores"],r);const i=d(t,["contentType"]);return i!=null&&h(e,["contentType"],i),e}function kC(t){const e={},n=d(t,["safetyAttributes","categories"]);n!=null&&h(e,["categories"],n);const r=d(t,["safetyAttributes","scores"]);r!=null&&h(e,["scores"],r);const i=d(t,["contentType"]);return i!=null&&h(e,["contentType"],i),e}function xD(t){const e={},n=d(t,["category"]);if(n!=null&&h(e,["category"],n),d(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=d(t,["threshold"]);return r!=null&&h(e,["threshold"],r),e}function AD(t){const e={},n=d(t,["image"]);return n!=null&&h(e,["image"],hr(n)),e}function RD(t,e){const n={},r=d(t,["mode"]);e!==void 0&&r!=null&&h(e,["parameters","mode"],r);const i=d(t,["maxPredictions"]);e!==void 0&&i!=null&&h(e,["parameters","maxPredictions"],i);const s=d(t,["confidenceThreshold"]);e!==void 0&&s!=null&&h(e,["parameters","confidenceThreshold"],s);const o=d(t,["maskDilation"]);e!==void 0&&o!=null&&h(e,["parameters","maskDilation"],o);const a=d(t,["binaryColorThreshold"]);e!==void 0&&a!=null&&h(e,["parameters","binaryColorThreshold"],a);const l=d(t,["labels"]);return e!==void 0&&l!=null&&h(e,["labels"],l),n}function PD(t,e){const n={},r=d(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=d(e,["source"]);i!=null&&ND(i,n);const s=d(e,["config"]);return s!=null&&RD(s,n),n}function kD(t){const e={},n=d(t,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>rD(i))),h(e,["generatedMasks"],r)}return e}function ND(t,e){const n={},r=d(t,["prompt"]);e!==void 0&&r!=null&&h(e,["instances[0]","prompt"],r);const i=d(t,["image"]);e!==void 0&&i!=null&&h(e,["instances[0]","image"],hr(i));const s=d(t,["scribbleImage"]);return e!==void 0&&s!=null&&h(e,["instances[0]","scribble"],AD(s)),n}function NC(t){const e={},n=d(t,["languageCode"]);n!=null&&h(e,["languageCode"],n);const r=d(t,["voiceConfig"]);if(r!=null&&h(e,["voiceConfig"],r),d(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return e}function bD(t){const e={},n=d(t,["functionDeclarations"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(f=>f)),h(e,["functionDeclarations"],u)}if(d(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=d(t,["googleSearchRetrieval"]);r!=null&&h(e,["googleSearchRetrieval"],r);const i=d(t,["googleMaps"]);i!=null&&h(e,["googleMaps"],uD(i));const s=d(t,["computerUse"]);s!=null&&h(e,["computerUse"],s);const o=d(t,["codeExecution"]);if(o!=null&&h(e,["codeExecution"],o),d(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=d(t,["googleSearch"]);a!=null&&h(e,["googleSearch"],cD(a));const l=d(t,["urlContext"]);return l!=null&&h(e,["urlContext"],l),e}function bC(t){const e={},n=d(t,["functionDeclarations"]);if(n!=null){let m=n;Array.isArray(m)&&(m=m.map(g=>Fb(g))),h(e,["functionDeclarations"],m)}const r=d(t,["retrieval"]);r!=null&&h(e,["retrieval"],r);const i=d(t,["googleSearchRetrieval"]);i!=null&&h(e,["googleSearchRetrieval"],i);const s=d(t,["googleMaps"]);s!=null&&h(e,["googleMaps"],s);const o=d(t,["computerUse"]);o!=null&&h(e,["computerUse"],o);const a=d(t,["codeExecution"]);a!=null&&h(e,["codeExecution"],a);const l=d(t,["enterpriseWebSearch"]);l!=null&&h(e,["enterpriseWebSearch"],l);const u=d(t,["googleSearch"]);u!=null&&h(e,["googleSearch"],u);const f=d(t,["urlContext"]);return f!=null&&h(e,["urlContext"],f),e}function DD(t){const e={},n=d(t,["baseModel"]);n!=null&&h(e,["baseModel"],n);const r=d(t,["createTime"]);r!=null&&h(e,["createTime"],r);const i=d(t,["updateTime"]);return i!=null&&h(e,["updateTime"],i),e}function MD(t){const e={},n=d(t,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&h(e,["baseModel"],n);const r=d(t,["createTime"]);r!=null&&h(e,["createTime"],r);const i=d(t,["updateTime"]);return i!=null&&h(e,["updateTime"],i),e}function VD(t,e){const n={},r=d(t,["displayName"]);e!==void 0&&r!=null&&h(e,["displayName"],r);const i=d(t,["description"]);e!==void 0&&i!=null&&h(e,["description"],i);const s=d(t,["defaultCheckpointId"]);return e!==void 0&&s!=null&&h(e,["defaultCheckpointId"],s),n}function LD(t,e){const n={},r=d(t,["displayName"]);e!==void 0&&r!=null&&h(e,["displayName"],r);const i=d(t,["description"]);e!==void 0&&i!=null&&h(e,["description"],i);const s=d(t,["defaultCheckpointId"]);return e!==void 0&&s!=null&&h(e,["defaultCheckpointId"],s),n}function FD(t,e){const n={},r=d(e,["model"]);r!=null&&h(n,["_url","name"],qe(t,r));const i=d(e,["config"]);return i!=null&&VD(i,n),n}function UD(t,e){const n={},r=d(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=d(e,["config"]);return i!=null&&LD(i,n),n}function OD(t,e){const n={},r=d(t,["outputGcsUri"]);e!==void 0&&r!=null&&h(e,["parameters","storageUri"],r);const i=d(t,["safetyFilterLevel"]);e!==void 0&&i!=null&&h(e,["parameters","safetySetting"],i);const s=d(t,["personGeneration"]);e!==void 0&&s!=null&&h(e,["parameters","personGeneration"],s);const o=d(t,["includeRaiReason"]);e!==void 0&&o!=null&&h(e,["parameters","includeRaiReason"],o);const a=d(t,["outputMimeType"]);e!==void 0&&a!=null&&h(e,["parameters","outputOptions","mimeType"],a);const l=d(t,["outputCompressionQuality"]);e!==void 0&&l!=null&&h(e,["parameters","outputOptions","compressionQuality"],l);const u=d(t,["enhanceInputImage"]);e!==void 0&&u!=null&&h(e,["parameters","upscaleConfig","enhanceInputImage"],u);const f=d(t,["imagePreservationFactor"]);e!==void 0&&f!=null&&h(e,["parameters","upscaleConfig","imagePreservationFactor"],f);const m=d(t,["labels"]);e!==void 0&&m!=null&&h(e,["labels"],m);const g=d(t,["numberOfImages"]);e!==void 0&&g!=null&&h(e,["parameters","sampleCount"],g);const v=d(t,["mode"]);return e!==void 0&&v!=null&&h(e,["parameters","mode"],v),n}function BD(t,e){const n={},r=d(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=d(e,["image"]);i!=null&&h(n,["instances[0]","image"],hr(i));const s=d(e,["upscaleFactor"]);s!=null&&h(n,["parameters","upscaleConfig","upscaleFactor"],s);const o=d(e,["config"]);return o!=null&&OD(o,n),n}function GD(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=d(t,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>Xh(s))),h(e,["generatedImages"],i)}return e}function qD(t){const e={},n=d(t,["uri"]);n!=null&&h(e,["uri"],n);const r=d(t,["encodedVideo"]);r!=null&&h(e,["videoBytes"],ps(r));const i=d(t,["encoding"]);return i!=null&&h(e,["mimeType"],i),e}function zD(t){const e={},n=d(t,["gcsUri"]);n!=null&&h(e,["uri"],n);const r=d(t,["bytesBase64Encoded"]);r!=null&&h(e,["videoBytes"],ps(r));const i=d(t,["mimeType"]);return i!=null&&h(e,["mimeType"],i),e}function $D(t){const e={},n=d(t,["image"]);n!=null&&h(e,["_self"],hr(n));const r=d(t,["maskMode"]);return r!=null&&h(e,["maskMode"],r),e}function HD(t){const e={},n=d(t,["image"]);n!=null&&h(e,["image"],Zh(n));const r=d(t,["referenceType"]);return r!=null&&h(e,["referenceType"],r),e}function jD(t){const e={},n=d(t,["image"]);n!=null&&h(e,["image"],hr(n));const r=d(t,["referenceType"]);return r!=null&&h(e,["referenceType"],r),e}function DC(t){const e={},n=d(t,["uri"]);n!=null&&h(e,["uri"],n);const r=d(t,["videoBytes"]);r!=null&&h(e,["encodedVideo"],ps(r));const i=d(t,["mimeType"]);return i!=null&&h(e,["encoding"],i),e}function MC(t){const e={},n=d(t,["uri"]);n!=null&&h(e,["gcsUri"],n);const r=d(t,["videoBytes"]);r!=null&&h(e,["bytesBase64Encoded"],ps(r));const i=d(t,["mimeType"]);return i!=null&&h(e,["mimeType"],i),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const WD="Content-Type",KD="X-Server-Timeout",JD="User-Agent",Nm="x-goog-api-client",QD="1.28.0",YD=`google-genai-sdk/${QD}`,XD="v1beta1",ZD="v1beta",HT=/^\s*data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class eM{constructor(e){var n,r;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const i={};this.clientOptions.vertexai?(i.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:XD,i.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(i.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:ZD,i.baseUrl="https://generativelanguage.googleapis.com/"),i.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=i,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(i,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&r.push(e.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),n=new URL(e);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,n,r){const i=[this.getRequestUrlInternal(n)];return r&&i.push(this.getBaseResourcePath()),e!==""&&i.push(e),new URL(`${i.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,n,r);if(e.queryParams)for(const[o,a]of Object.entries(e.queryParams))i.searchParams.append(o,String(a));let s={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else s.body=e.body;return s=await this.includeExtraHttpOptionsToRequestInit(s,n,i.toString(),e.abortSignal),this.unaryApiCall(i,s,e.httpMethod)}patchHttpOptions(e,n){const r=JSON.parse(JSON.stringify(e));for(const[i,s]of Object.entries(n))typeof s=="object"?r[i]=Object.assign(Object.assign({},r[i]),s):s!==void 0&&(r[i]=s);return r}async requestStream(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,n,r);(!i.searchParams.has("alt")||i.searchParams.get("alt")!=="sse")&&i.searchParams.set("alt","sse");let s={};return s.body=e.body,s=await this.includeExtraHttpOptionsToRequestInit(s,n,i.toString(),e.abortSignal),this.streamApiCall(i,s,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,n,r,i){if(n&&n.timeout||i){const s=new AbortController,o=s.signal;if(n.timeout&&(n==null?void 0:n.timeout)>0){const a=setTimeout(()=>s.abort(),n.timeout);a&&typeof a.unref=="function"&&a.unref()}i&&i.addEventListener("abort",()=>{s.abort()}),e.signal=o}return n&&n.extraBody!==null&&tM(e,n.extraBody),e.headers=await this.getHeadersInternal(n,r),e}async unaryApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async i=>(await jT(i),new xm(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}async streamApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async i=>(await jT(i),this.processStreamResponse(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}processStreamResponse(e){var n;return ga(this,arguments,function*(){const i=(n=e==null?void 0:e.body)===null||n===void 0?void 0:n.getReader(),s=new TextDecoder("utf-8");if(!i)throw new Error("Response body is empty");try{let o="";for(;;){const{done:a,value:l}=yield ot(i.read());if(a){if(o.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const u=s.decode(l,{stream:!0});try{const m=JSON.parse(u);if("error"in m){const g=JSON.parse(JSON.stringify(m.error)),v=g.status,T=g.code,P=`got status: ${v}. ${JSON.stringify(m)}`;if(T>=400&&T<600)throw new Qh({message:P,status:T})}}catch(m){if(m.name==="ApiError")throw m}o+=u;let f=o.match(HT);for(;f;){const m=f[1];try{const g=new Response(m,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield ot(new xm(g)),o=o.slice(f[0].length),f=o.match(HT)}catch(g){throw new Error(`exception parsing stream chunk ${m}. ${g}`)}}}}finally{i.releaseLock()}})}async apiCall(e,n){return fetch(e,n).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const e={},n=YD+" "+this.clientOptions.userAgentExtra;return e[JD]=n,e[Nm]=n,e[WD]="application/json",e}async getHeadersInternal(e,n){const r=new Headers;if(e&&e.headers){for(const[i,s]of Object.entries(e.headers))r.append(i,s);e.timeout&&e.timeout>0&&r.append(KD,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(r,n),r}async uploadFile(e,n){var r,i;const s={};n!=null&&(s.mimeType=n.mimeType,s.name=n.name,s.displayName=n.displayName),s.name&&!s.name.startsWith("files/")&&(s.name=`files/${s.name}`);const o=this.clientOptions.uploader,a=await o.stat(e);s.sizeBytes=String(a.size);const l=(r=n==null?void 0:n.mimeType)!==null&&r!==void 0?r:a.type;if(l===void 0||l==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");s.mimeType=l;let u="";typeof e=="string"&&(u=e.replace(/[/\\]+$/,""),u=(i=u.split(/[/\\]/).pop())!==null&&i!==void 0?i:"");const f=await this.fetchUploadUrl(s,u,n);return o.upload(e,f,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,n,r){var i;let s={};r!=null&&r.httpOptions?s=r.httpOptions:s={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`},n?{"X-Goog-Upload-File-Name":n}:{})};const o={file:e},a=await this.request({path:de("upload/v1beta/files",o._url),body:JSON.stringify(o),httpMethod:"POST",httpOptions:s});if(!a||!(a!=null&&a.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const l=(i=a==null?void 0:a.headers)===null||i===void 0?void 0:i["x-goog-upload-url"];if(l===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return l}}async function jT(t){var e;if(t===void 0)throw new Error("response is undefined");if(!t.ok){const n=t.status;let r;!((e=t.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?r=await t.json():r={error:{message:await t.text(),code:t.status,status:t.statusText}};const i=JSON.stringify(r);throw n>=400&&n<600?new Qh({message:i,status:n}):new Error(i)}}function tM(t,e){if(!e||Object.keys(e).length===0)return;if(t.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let n={};if(typeof t.body=="string"&&t.body.length>0)try{const s=JSON.parse(t.body);if(typeof s=="object"&&s!==null&&!Array.isArray(s))n=s;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function r(s,o){const a=Object.assign({},s);for(const l in o)if(Object.prototype.hasOwnProperty.call(o,l)){const u=o[l],f=a[l];u&&typeof u=="object"&&!Array.isArray(u)&&f&&typeof f=="object"&&!Array.isArray(f)?a[l]=r(f,u):(f&&u&&typeof f!=typeof u&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${l}". Original type: ${typeof f}, New type: ${typeof u}. Overwriting.`),a[l]=u)}return a}const i=r(n,e);t.body=JSON.stringify(i)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const nM="mcp_used/unknown";let rM=!1;function VC(t){for(const e of t)if(iM(e)||typeof e=="object"&&"inputSchema"in e)return!0;return rM}function LC(t){var e;const n=(e=t[Nm])!==null&&e!==void 0?e:"";t[Nm]=(n+` ${nM}`).trimStart()}function iM(t){return t!==null&&typeof t=="object"&&t instanceof __}function sM(t,e=100){return ga(this,arguments,function*(){let r,i=0;for(;i<e;){const s=yield ot(t.listTools({cursor:r}));for(const o of s.tools)yield yield ot(o),i++;if(!s.nextCursor)break;r=s.nextCursor}})}class __{constructor(e=[],n){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=n}static create(e,n){return new __(e,n)}async initialize(){var e,n,r,i;if(this.mcpTools.length>0)return;const s={},o=[];for(const f of this.mcpClients)try{for(var a=!0,l=(n=void 0,Ql(sM(f))),u;u=await l.next(),e=u.done,!e;a=!0){i=u.value,a=!1;const m=i;o.push(m);const g=m.name;if(s[g])throw new Error(`Duplicate function name ${g} found in MCP tools. Please ensure function names are unique.`);s[g]=f}}catch(m){n={error:m}}finally{try{!a&&!e&&(r=l.return)&&await r.call(l)}finally{if(n)throw n.error}}this.mcpTools=o,this.functionNameToMcpClient=s}async tool(){return await this.initialize(),cN(this.mcpTools,this.config)}async callTool(e){await this.initialize();const n=[];for(const r of e)if(r.name in this.functionNameToMcpClient){const i=this.functionNameToMcpClient[r.name];let s;this.config.timeout&&(s={timeout:this.config.timeout});const o=await i.callTool({name:r.name,arguments:r.args},void 0,s);n.push({functionResponse:{name:r.name,response:o.isError?{error:o}:o}})}return n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function oM(t,e,n){const r=new nN;let i;n.data instanceof Blob?i=JSON.parse(await n.data.text()):i=JSON.parse(n.data),Object.assign(r,i),e(r)}class aM{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r}async connect(e){var n,r;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const i=this.apiClient.getWebsocketBaseUrl(),s=this.apiClient.getApiVersion(),o=cM(this.apiClient.getDefaultHeaders()),a=this.apiClient.getApiKey(),l=`${i}/ws/google.ai.generativelanguage.${s}.GenerativeService.BidiGenerateMusic?key=${a}`;let u=()=>{};const f=new Promise(A=>{u=A}),m=e.callbacks,g=function(){u({})},v=this.apiClient,T={onopen:g,onmessage:A=>{oM(v,m.onmessage,A)},onerror:(n=m==null?void 0:m.onerror)!==null&&n!==void 0?n:function(A){},onclose:(r=m==null?void 0:m.onclose)!==null&&r!==void 0?r:function(A){}},P=this.webSocketFactory.create(l,uM(o),T);P.connect(),await f;const E={setup:{model:qe(this.apiClient,e.model)}};return P.send(JSON.stringify(E)),new lM(P,this.apiClient)}}class lM{constructor(e,n){this.conn=e,this.apiClient=n}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const n=Z1(e);this.conn.send(JSON.stringify({clientContent:n}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const n=X1(e);this.conn.send(JSON.stringify(n))}sendPlaybackControl(e){const n={playbackControl:e};this.conn.send(JSON.stringify(n))}play(){this.sendPlaybackControl(aa.PLAY)}pause(){this.sendPlaybackControl(aa.PAUSE)}stop(){this.sendPlaybackControl(aa.STOP)}resetContext(){this.sendPlaybackControl(aa.RESET_CONTEXT)}close(){this.conn.close()}}function uM(t){const e={};return t.forEach((n,r)=>{e[r]=n}),e}function cM(t){const e=new Headers;for(const[n,r]of Object.entries(t))e.append(n,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const dM="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function hM(t,e,n){const r=new tN;let i;n.data instanceof Blob?i=await n.data.text():n.data instanceof ArrayBuffer?i=new TextDecoder().decode(n.data):i=n.data;const s=JSON.parse(i);if(t.isVertexAI()){const o=nb(s);Object.assign(r,o)}else Object.assign(r,s);e(r)}class fM{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r,this.music=new aM(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var n,r,i,s,o,a;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const l=this.apiClient.getWebsocketBaseUrl(),u=this.apiClient.getApiVersion();let f;const m=this.apiClient.getHeaders();e.config&&e.config.tools&&VC(e.config.tools)&&LC(m);const g=_M(m);if(this.apiClient.isVertexAI())f=`${l}/ws/google.cloud.aiplatform.${u}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(g,f);else{const R=this.apiClient.getApiKey();let N="BidiGenerateContent",D="key";R!=null&&R.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),u!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),N="BidiGenerateContentConstrained",D="access_token"),f=`${l}/ws/google.ai.generativelanguage.${u}.GenerativeService.${N}?${D}=${R}`}let v=()=>{};const T=new Promise(R=>{v=R}),P=e.callbacks,M=function(){var R;(R=P==null?void 0:P.onopen)===null||R===void 0||R.call(P),v({})},x=this.apiClient,E={onopen:M,onmessage:R=>{hM(x,P.onmessage,R)},onerror:(n=P==null?void 0:P.onerror)!==null&&n!==void 0?n:function(R){},onclose:(r=P==null?void 0:P.onclose)!==null&&r!==void 0?r:function(R){}},A=this.webSocketFactory.create(f,gM(g),E);A.connect(),await T;let V=qe(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&V.startsWith("publishers/")){const R=this.apiClient.getProject(),N=this.apiClient.getLocation();V=`projects/${R}/locations/${N}/`+V}let B={};this.apiClient.isVertexAI()&&((i=e.config)===null||i===void 0?void 0:i.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[sh.AUDIO]}:e.config.responseModalities=[sh.AUDIO]),!((s=e.config)===null||s===void 0)&&s.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const G=(a=(o=e.config)===null||o===void 0?void 0:o.tools)!==null&&a!==void 0?a:[],I=[];for(const R of G)if(this.isCallableTool(R)){const N=R;I.push(await N.tool())}else I.push(R);I.length>0&&(e.config.tools=I);const S={model:V,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?B=Y1(this.apiClient,S):B=Q1(this.apiClient,S),delete B.config,A.send(JSON.stringify(B)),new mM(A,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const pM={turnComplete:!0};class mM{constructor(e,n){this.conn=e,this.apiClient=n}tLiveClientContent(e,n){if(n.turns!==null&&n.turns!==void 0){let r=[];try{r=$n(n.turns),e.isVertexAI()||(r=r.map(i=>Yh(i)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:r,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(e,n){let r=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?r=n.functionResponses:r=[n.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const s of r){if(typeof s!="object"||s===null||!("name"in s)||!("response"in s))throw new Error(`Could not parse function response, type '${typeof s}'.`);if(!e.isVertexAI()&&!("id"in s))throw new Error(dM)}return{toolResponse:{functionResponses:r}}}sendClientContent(e){e=Object.assign(Object.assign({},pM),e);const n=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(n))}sendRealtimeInput(e){let n={};this.apiClient.isVertexAI()?n={realtimeInput:tb(e)}:n={realtimeInput:eb(e)},this.conn.send(JSON.stringify(n))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function gM(t){const e={};return t.forEach((n,r)=>{e[r]=n}),e}function _M(t){const e=new Headers;for(const[n,r]of Object.entries(t))e.append(n,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const WT=10;function KT(t){var e,n,r;if(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let i=!1;for(const o of(n=t==null?void 0:t.tools)!==null&&n!==void 0?n:[])if(_a(o)){i=!0;break}if(!i)return!0;const s=(r=t==null?void 0:t.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls;return s&&(s<0||!Number.isInteger(s))||s==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",s),!0):!1}function _a(t){return"callTool"in t&&typeof t.callTool=="function"}function yM(t){var e,n,r;return(r=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(i=>_a(i)))!==null&&r!==void 0?r:!1}function vM(t){var e,n,r;return(r=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(i=>!_a(i)))!==null&&r!==void 0?r:!1}function JT(t){var e;return!(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class TM extends wo{constructor(e){super(),this.apiClient=e,this.generateContent=async n=>{var r,i,s,o,a;const l=await this.processParamsMaybeAddMcpUsage(n);if(this.maybeMoveToResponseJsonSchem(n),!yM(n)||KT(n.config))return await this.generateContentInternal(l);if(vM(n))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");let u,f;const m=$n(l.contents),g=(s=(i=(r=l.config)===null||r===void 0?void 0:r.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&s!==void 0?s:WT;let v=0;for(;v<g&&(u=await this.generateContentInternal(l),!(!u.functionCalls||u.functionCalls.length===0));){const T=u.candidates[0].content,P=[];for(const M of(a=(o=n.config)===null||o===void 0?void 0:o.tools)!==null&&a!==void 0?a:[])if(_a(M)){const E=await M.callTool(u.functionCalls);P.push(...E)}v++,f={role:"user",parts:P},l.contents=$n(l.contents),l.contents.push(T),l.contents.push(f),JT(l.config)&&(m.push(T),m.push(f))}return JT(l.config)&&(u.automaticFunctionCallingHistory=m),u},this.generateContentStream=async n=>{if(this.maybeMoveToResponseJsonSchem(n),KT(n.config)){const r=await this.processParamsMaybeAddMcpUsage(n);return await this.generateContentStreamInternal(r)}else return await this.processAfcStream(n)},this.generateImages=async n=>await this.generateImagesInternal(n).then(r=>{var i;let s;const o=[];if(r!=null&&r.generatedImages)for(const l of r.generatedImages)l&&(l!=null&&l.safetyAttributes)&&((i=l==null?void 0:l.safetyAttributes)===null||i===void 0?void 0:i.contentType)==="Positive Prompt"?s=l==null?void 0:l.safetyAttributes:o.push(l);let a;return s?a={generatedImages:o,positivePromptSafetyAttributes:s,sdkHttpResponse:r.sdkHttpResponse}:a={generatedImages:o,sdkHttpResponse:r.sdkHttpResponse},a}),this.list=async n=>{var r;const o={config:Object.assign(Object.assign({},{queryBase:!0}),n==null?void 0:n.config)};if(this.apiClient.isVertexAI()&&!o.config.queryBase){if(!((r=o.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");o.config.filter="labels.tune-type:*"}return new Hu(co.PAGED_ITEM_MODELS,a=>this.listInternal(a),await this.listInternal(o),o)},this.editImage=async n=>{const r={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(r.referenceImages=n.referenceImages.map(i=>i.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async n=>{let r={numberOfImages:1,mode:"upscale"};n.config&&(r=Object.assign(Object.assign({},r),n.config));const i={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:r};return await this.upscaleImageInternal(i)},this.generateVideos=async n=>{var r,i,s,o,a,l;if((n.prompt||n.image||n.video)&&n.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((r=n.video)===null||r===void 0)&&r.uri&&(!((i=n.video)===null||i===void 0)&&i.videoBytes)?n.video={uri:n.video.uri,mimeType:n.video.mimeType}:!((o=(s=n.source)===null||s===void 0?void 0:s.video)===null||o===void 0)&&o.uri&&(!((l=(a=n.source)===null||a===void 0?void 0:a.video)===null||l===void 0)&&l.videoBytes)&&(n.source.video={uri:n.source.video.uri,mimeType:n.source.video.mimeType})),await this.generateVideosInternal(n)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var n,r,i;const s=(n=e.config)===null||n===void 0?void 0:n.tools;if(!s)return e;const o=await Promise.all(s.map(async l=>_a(l)?await l.tool():l)),a={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:o})};if(a.config.tools=o,e.config&&e.config.tools&&VC(e.config.tools)){const l=(i=(r=e.config.httpOptions)===null||r===void 0?void 0:r.headers)!==null&&i!==void 0?i:{};let u=Object.assign({},l);Object.keys(u).length===0&&(u=this.apiClient.getDefaultHeaders()),LC(u),a.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:u})}return a}async initAfcToolsMap(e){var n,r,i;const s=new Map;for(const o of(r=(n=e.config)===null||n===void 0?void 0:n.tools)!==null&&r!==void 0?r:[])if(_a(o)){const a=o,l=await a.tool();for(const u of(i=l.functionDeclarations)!==null&&i!==void 0?i:[]){if(!u.name)throw new Error("Function declaration name is required.");if(s.has(u.name))throw new Error(`Duplicate tool declaration name: ${u.name}`);s.set(u.name,a)}}return s}async processAfcStream(e){var n,r,i;const s=(i=(r=(n=e.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&i!==void 0?i:WT;let o=!1,a=0;const l=await this.initAfcToolsMap(e);return function(u,f,m){var g,v;return ga(this,arguments,function*(){for(var T,P,M,x;a<s;){o&&(a++,o=!1);const B=yield ot(u.processParamsMaybeAddMcpUsage(m)),G=yield ot(u.generateContentStreamInternal(B)),I=[],S=[];try{for(var E=!0,A=(P=void 0,Ql(G)),V;V=yield ot(A.next()),T=V.done,!T;E=!0){x=V.value,E=!1;const R=x;if(yield yield ot(R),R.candidates&&(!((g=R.candidates[0])===null||g===void 0)&&g.content)){S.push(R.candidates[0].content);for(const N of(v=R.candidates[0].content.parts)!==null&&v!==void 0?v:[])if(a<s&&N.functionCall){if(!N.functionCall.name)throw new Error("Function call name was not returned by the model.");if(f.has(N.functionCall.name)){const D=yield ot(f.get(N.functionCall.name).callTool([N.functionCall]));I.push(...D)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${f.keys()}, mising tool: ${N.functionCall.name}`)}}}}catch(R){P={error:R}}finally{try{!E&&!T&&(M=A.return)&&(yield ot(M.call(A)))}finally{if(P)throw P.error}}if(I.length>0){o=!0;const R=new Cl;R.candidates=[{content:{role:"user",parts:I}}],yield yield ot(R);const N=[];N.push(...S),N.push({role:"user",parts:I});const D=$n(m.contents).concat(N);m.contents=D}else break}})}(this,l,e)}async generateContentInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=qT(this.apiClient,e);return a=de("{model}:generateContent",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=$T(f),g=new Cl;return Object.assign(g,m),g})}else{const u=GT(this.apiClient,e);return a=de("{model}:generateContent",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=zT(f),g=new Cl;return Object.assign(g,m),g})}}async generateContentStreamInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=qT(this.apiClient,e);return a=de("{model}:streamGenerateContent?alt=sse",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.requestStream({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}),o.then(function(m){return ga(this,arguments,function*(){var g,v,T,P;try{for(var M=!0,x=Ql(m),E;E=yield ot(x.next()),g=E.done,!g;M=!0){P=E.value,M=!1;const A=P,V=$T(yield ot(A.json()));V.sdkHttpResponse={headers:A.headers};const B=new Cl;Object.assign(B,V),yield yield ot(B)}}catch(A){v={error:A}}finally{try{!M&&!g&&(T=x.return)&&(yield ot(T.call(x)))}finally{if(v)throw v.error}}})})}else{const u=GT(this.apiClient,e);return a=de("{model}:streamGenerateContent?alt=sse",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.requestStream({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}),o.then(function(m){return ga(this,arguments,function*(){var g,v,T,P;try{for(var M=!0,x=Ql(m),E;E=yield ot(x.next()),g=E.done,!g;M=!0){P=E.value,M=!1;const A=P,V=zT(yield ot(A.json()));V.sdkHttpResponse={headers:A.headers};const B=new Cl;Object.assign(B,V),yield yield ot(B)}}catch(A){v={error:A}}finally{try{!M&&!g&&(T=x.return)&&(yield ot(T.call(x)))}finally{if(v)throw v.error}}})})}}async embedContent(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=bb(this.apiClient,e);return a=de("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=Mb(f),g=new CT;return Object.assign(g,m),g})}else{const u=Nb(this.apiClient,e);return a=de("{model}:batchEmbedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=Db(f),g=new CT;return Object.assign(g,m),g})}}async generateImagesInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=zb(this.apiClient,e);return a=de("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=Hb(f),g=new xT;return Object.assign(g,m),g})}else{const u=qb(this.apiClient,e);return a=de("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=$b(f),g=new xT;return Object.assign(g,m),g})}}async editImageInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=Ab(this.apiClient,e);return s=de("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>{const u=Rb(l),f=new Wk;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=BD(this.apiClient,e);return s=de("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>{const u=GD(l),f=new Kk;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=wD(this.apiClient,e);return s=de("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=ID(l),f=new Jk;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=PD(this.apiClient,e);return s=de("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=kD(l),f=new Qk;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=lD(this.apiClient,e);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>km(f))}else{const u=aD(this.apiClient,e);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>Pm(f))}}async listInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=mD(this.apiClient,e);return a=de("{models_url}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=_D(f),g=new AT;return Object.assign(g,m),g})}else{const u=pD(this.apiClient,e);return a=de("{models_url}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=gD(f),g=new AT;return Object.assign(g,m),g})}}async update(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=UD(this.apiClient,e);return a=de("{model}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>km(f))}else{const u=FD(this.apiClient,e);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>Pm(f))}}async delete(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=Ib(this.apiClient,e);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=Cb(f),g=new RT;return Object.assign(g,m),g})}else{const u=wb(this.apiClient,e);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=Sb(f),g=new RT;return Object.assign(g,m),g})}}async countTokens(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=vb(this.apiClient,e);return a=de("{model}:countTokens",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=Eb(f),g=new PT;return Object.assign(g,m),g})}else{const u=yb(this.apiClient,e);return a=de("{model}:countTokens",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=Tb(f),g=new PT;return Object.assign(g,m),g})}}async computeTokens(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=db(this.apiClient,e);return s=de("{model}:computeTokens",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>{const u=hb(l),f=new Yk;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=Yb(this.apiClient,e);return a=de("{model}:predictLongRunning",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>{const m=Jb(f),g=new oh;return Object.assign(g,m),g})}else{const u=Qb(this.apiClient,e);return a=de("{model}:predictLongRunning",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>{const m=Kb(f),g=new oh;return Object.assign(g,m),g})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class EM extends wo{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const n=e.operation,r=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=n.name.split("/operations/")[0];let s;r&&"httpOptions"in r&&(s=r.httpOptions);const o=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:i,config:{httpOptions:s}});return n._fromAPIResponse({apiResponse:o,isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:i,isVertexAI:!1})}}async get(e){const n=e.operation,r=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=n.name.split("/operations/")[0];let s;r&&"httpOptions"in r&&(s=r.httpOptions);const o=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:i,config:{httpOptions:s}});return n._fromAPIResponse({apiResponse:o,isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:i,isVertexAI:!1})}}async getVideosOperationInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=$k(e);return a=de("{operationName}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o}else{const u=zk(e);return a=de("{operationName}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o}}async fetchPredictVideosOperationInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=Lk(e);return s=de("{resourceName}:fetchPredictOperation",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function wM(t){const e={},n=d(t,["data"]);if(n!=null&&h(e,["data"],n),d(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=d(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function IM(t){const e={},n=d(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>NM(s))),h(e,["parts"],i)}const r=d(t,["role"]);return r!=null&&h(e,["role"],r),e}function SM(t,e,n){const r={},i=d(e,["expireTime"]);n!==void 0&&i!=null&&h(n,["expireTime"],i);const s=d(e,["newSessionExpireTime"]);n!==void 0&&s!=null&&h(n,["newSessionExpireTime"],s);const o=d(e,["uses"]);n!==void 0&&o!=null&&h(n,["uses"],o);const a=d(e,["liveConnectConstraints"]);n!==void 0&&a!=null&&h(n,["bidiGenerateContentSetup"],kM(t,a));const l=d(e,["lockAdditionalFields"]);return n!==void 0&&l!=null&&h(n,["fieldMask"],l),r}function CM(t,e){const n={},r=d(e,["config"]);return r!=null&&h(n,["config"],SM(t,r,n)),n}function xM(t){const e={};if(d(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=d(t,["fileUri"]);n!=null&&h(e,["fileUri"],n);const r=d(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function AM(t){const e={};if(d(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=d(t,["enableWidget"]);return n!=null&&h(e,["enableWidget"],n),e}function RM(t){const e={};if(d(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");const n=d(t,["timeRangeFilter"]);return n!=null&&h(e,["timeRangeFilter"],n),e}function PM(t,e){const n={},r=d(t,["generationConfig"]);e!==void 0&&r!=null&&h(e,["setup","generationConfig"],r);const i=d(t,["responseModalities"]);e!==void 0&&i!=null&&h(e,["setup","generationConfig","responseModalities"],i);const s=d(t,["temperature"]);e!==void 0&&s!=null&&h(e,["setup","generationConfig","temperature"],s);const o=d(t,["topP"]);e!==void 0&&o!=null&&h(e,["setup","generationConfig","topP"],o);const a=d(t,["topK"]);e!==void 0&&a!=null&&h(e,["setup","generationConfig","topK"],a);const l=d(t,["maxOutputTokens"]);e!==void 0&&l!=null&&h(e,["setup","generationConfig","maxOutputTokens"],l);const u=d(t,["mediaResolution"]);e!==void 0&&u!=null&&h(e,["setup","generationConfig","mediaResolution"],u);const f=d(t,["seed"]);e!==void 0&&f!=null&&h(e,["setup","generationConfig","seed"],f);const m=d(t,["speechConfig"]);e!==void 0&&m!=null&&h(e,["setup","generationConfig","speechConfig"],g_(m));const g=d(t,["thinkingConfig"]);e!==void 0&&g!=null&&h(e,["setup","generationConfig","thinkingConfig"],g);const v=d(t,["enableAffectiveDialog"]);e!==void 0&&v!=null&&h(e,["setup","generationConfig","enableAffectiveDialog"],v);const T=d(t,["systemInstruction"]);e!==void 0&&T!=null&&h(e,["setup","systemInstruction"],IM(tn(T)));const P=d(t,["tools"]);if(e!==void 0&&P!=null){let G=Qa(P);Array.isArray(G)&&(G=G.map(I=>DM(Ja(I)))),h(e,["setup","tools"],G)}const M=d(t,["sessionResumption"]);e!==void 0&&M!=null&&h(e,["setup","sessionResumption"],bM(M));const x=d(t,["inputAudioTranscription"]);e!==void 0&&x!=null&&h(e,["setup","inputAudioTranscription"],x);const E=d(t,["outputAudioTranscription"]);e!==void 0&&E!=null&&h(e,["setup","outputAudioTranscription"],E);const A=d(t,["realtimeInputConfig"]);e!==void 0&&A!=null&&h(e,["setup","realtimeInputConfig"],A);const V=d(t,["contextWindowCompression"]);e!==void 0&&V!=null&&h(e,["setup","contextWindowCompression"],V);const B=d(t,["proactivity"]);return e!==void 0&&B!=null&&h(e,["setup","proactivity"],B),n}function kM(t,e){const n={},r=d(e,["model"]);r!=null&&h(n,["setup","model"],qe(t,r));const i=d(e,["config"]);return i!=null&&h(n,["config"],PM(i,n)),n}function NM(t){const e={},n=d(t,["functionCall"]);n!=null&&h(e,["functionCall"],n);const r=d(t,["codeExecutionResult"]);r!=null&&h(e,["codeExecutionResult"],r);const i=d(t,["executableCode"]);i!=null&&h(e,["executableCode"],i);const s=d(t,["fileData"]);s!=null&&h(e,["fileData"],xM(s));const o=d(t,["functionResponse"]);o!=null&&h(e,["functionResponse"],o);const a=d(t,["inlineData"]);a!=null&&h(e,["inlineData"],wM(a));const l=d(t,["text"]);l!=null&&h(e,["text"],l);const u=d(t,["thought"]);u!=null&&h(e,["thought"],u);const f=d(t,["thoughtSignature"]);f!=null&&h(e,["thoughtSignature"],f);const m=d(t,["videoMetadata"]);return m!=null&&h(e,["videoMetadata"],m),e}function bM(t){const e={},n=d(t,["handle"]);if(n!=null&&h(e,["handle"],n),d(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function DM(t){const e={},n=d(t,["functionDeclarations"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(f=>f)),h(e,["functionDeclarations"],u)}if(d(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=d(t,["googleSearchRetrieval"]);r!=null&&h(e,["googleSearchRetrieval"],r);const i=d(t,["googleMaps"]);i!=null&&h(e,["googleMaps"],AM(i));const s=d(t,["computerUse"]);s!=null&&h(e,["computerUse"],s);const o=d(t,["codeExecution"]);if(o!=null&&h(e,["codeExecution"],o),d(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=d(t,["googleSearch"]);a!=null&&h(e,["googleSearch"],RM(a));const l=d(t,["urlContext"]);return l!=null&&h(e,["urlContext"],l),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function MM(t){const e=[];for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const r=t[n];if(typeof r=="object"&&r!=null&&Object.keys(r).length>0){const i=Object.keys(r).map(s=>`${n}.${s}`);e.push(...i)}else e.push(n)}return e.join(",")}function VM(t,e){let n=null;const r=t.bidiGenerateContentSetup;if(typeof r=="object"&&r!==null&&"setup"in r){const s=r.setup;typeof s=="object"&&s!==null?(t.bidiGenerateContentSetup=s,n=s):delete t.bidiGenerateContentSetup}else r!==void 0&&delete t.bidiGenerateContentSetup;const i=t.fieldMask;if(n){const s=MM(n);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)s?t.fieldMask=s:delete t.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&i!==null&&Array.isArray(i)&&i.length>0){const o=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let a=[];i.length>0&&(a=i.map(u=>o.includes(u)?`generationConfig.${u}`:u));const l=[];s&&l.push(s),a.length>0&&l.push(...a),l.length>0?t.fieldMask=l.join(","):delete t.fieldMask}else delete t.fieldMask}else i!==null&&Array.isArray(i)&&i.length>0?t.fieldMask=i.join(","):delete t.fieldMask;return t}class LM extends wo{constructor(e){super(),this.apiClient=e}async create(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const a=CM(this.apiClient,e);s=de("auth_tokens",a._url),o=a._query,delete a.config,delete a._url,delete a._query;const l=VM(a,e.config);return i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>u)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function FM(t,e){const n={},r=d(t,["name"]);return r!=null&&h(n,["_url","name"],r),n}function UM(t,e){const n={},r=d(t,["name"]);return r!=null&&h(n,["_url","name"],r),n}function OM(t,e,n){const r={};if(d(t,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const i=d(t,["tunedModelDisplayName"]);if(e!==void 0&&i!=null&&h(e,["displayName"],i),d(t,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const s=d(t,["epochCount"]);e!==void 0&&s!=null&&h(e,["tuningTask","hyperparameters","epochCount"],s);const o=d(t,["learningRateMultiplier"]);if(o!=null&&h(r,["tuningTask","hyperparameters","learningRateMultiplier"],o),d(t,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(d(t,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(d(t,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const a=d(t,["batchSize"]);e!==void 0&&a!=null&&h(e,["tuningTask","hyperparameters","batchSize"],a);const l=d(t,["learningRate"]);if(e!==void 0&&l!=null&&h(e,["tuningTask","hyperparameters","learningRate"],l),d(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(d(t,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return r}function BM(t,e,n){const r={};let i=d(n,["config","method"]);if(i===void 0&&(i="SUPERVISED_FINE_TUNING"),i==="SUPERVISED_FINE_TUNING"){const v=d(t,["validationDataset"]);e!==void 0&&v!=null&&h(e,["supervisedTuningSpec"],QT(v))}else if(i==="PREFERENCE_TUNING"){const v=d(t,["validationDataset"]);e!==void 0&&v!=null&&h(e,["preferenceOptimizationSpec"],QT(v))}const s=d(t,["tunedModelDisplayName"]);e!==void 0&&s!=null&&h(e,["tunedModelDisplayName"],s);const o=d(t,["description"]);e!==void 0&&o!=null&&h(e,["description"],o);let a=d(n,["config","method"]);if(a===void 0&&(a="SUPERVISED_FINE_TUNING"),a==="SUPERVISED_FINE_TUNING"){const v=d(t,["epochCount"]);e!==void 0&&v!=null&&h(e,["supervisedTuningSpec","hyperParameters","epochCount"],v)}else if(a==="PREFERENCE_TUNING"){const v=d(t,["epochCount"]);e!==void 0&&v!=null&&h(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],v)}let l=d(n,["config","method"]);if(l===void 0&&(l="SUPERVISED_FINE_TUNING"),l==="SUPERVISED_FINE_TUNING"){const v=d(t,["learningRateMultiplier"]);e!==void 0&&v!=null&&h(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],v)}else if(l==="PREFERENCE_TUNING"){const v=d(t,["learningRateMultiplier"]);e!==void 0&&v!=null&&h(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],v)}let u=d(n,["config","method"]);if(u===void 0&&(u="SUPERVISED_FINE_TUNING"),u==="SUPERVISED_FINE_TUNING"){const v=d(t,["exportLastCheckpointOnly"]);e!==void 0&&v!=null&&h(e,["supervisedTuningSpec","exportLastCheckpointOnly"],v)}else if(u==="PREFERENCE_TUNING"){const v=d(t,["exportLastCheckpointOnly"]);e!==void 0&&v!=null&&h(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],v)}let f=d(n,["config","method"]);if(f===void 0&&(f="SUPERVISED_FINE_TUNING"),f==="SUPERVISED_FINE_TUNING"){const v=d(t,["adapterSize"]);e!==void 0&&v!=null&&h(e,["supervisedTuningSpec","hyperParameters","adapterSize"],v)}else if(f==="PREFERENCE_TUNING"){const v=d(t,["adapterSize"]);e!==void 0&&v!=null&&h(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],v)}if(d(t,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(d(t,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const m=d(t,["labels"]);e!==void 0&&m!=null&&h(e,["labels"],m);const g=d(t,["beta"]);return e!==void 0&&g!=null&&h(e,["preferenceOptimizationSpec","hyperParameters","beta"],g),r}function GM(t,e){const n={},r=d(t,["baseModel"]);r!=null&&h(n,["baseModel"],r);const i=d(t,["preTunedModel"]);i!=null&&h(n,["preTunedModel"],i);const s=d(t,["trainingDataset"]);s!=null&&XM(s);const o=d(t,["config"]);return o!=null&&OM(o,n),n}function qM(t,e){const n={},r=d(t,["baseModel"]);r!=null&&h(n,["baseModel"],r);const i=d(t,["preTunedModel"]);i!=null&&h(n,["preTunedModel"],i);const s=d(t,["trainingDataset"]);s!=null&&ZM(s,n,e);const o=d(t,["config"]);return o!=null&&BM(o,n,e),n}function zM(t,e){const n={},r=d(t,["name"]);return r!=null&&h(n,["_url","name"],r),n}function $M(t,e){const n={},r=d(t,["name"]);return r!=null&&h(n,["_url","name"],r),n}function HM(t,e,n){const r={},i=d(t,["pageSize"]);e!==void 0&&i!=null&&h(e,["_query","pageSize"],i);const s=d(t,["pageToken"]);e!==void 0&&s!=null&&h(e,["_query","pageToken"],s);const o=d(t,["filter"]);return e!==void 0&&o!=null&&h(e,["_query","filter"],o),r}function jM(t,e,n){const r={},i=d(t,["pageSize"]);e!==void 0&&i!=null&&h(e,["_query","pageSize"],i);const s=d(t,["pageToken"]);e!==void 0&&s!=null&&h(e,["_query","pageToken"],s);const o=d(t,["filter"]);return e!==void 0&&o!=null&&h(e,["_query","filter"],o),r}function WM(t,e){const n={},r=d(t,["config"]);return r!=null&&HM(r,n),n}function KM(t,e){const n={},r=d(t,["config"]);return r!=null&&jM(r,n),n}function JM(t,e){const n={},r=d(t,["sdkHttpResponse"]);r!=null&&h(n,["sdkHttpResponse"],r);const i=d(t,["nextPageToken"]);i!=null&&h(n,["nextPageToken"],i);const s=d(t,["tunedModels"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>FC(a))),h(n,["tuningJobs"],o)}return n}function QM(t,e){const n={},r=d(t,["sdkHttpResponse"]);r!=null&&h(n,["sdkHttpResponse"],r);const i=d(t,["nextPageToken"]);i!=null&&h(n,["nextPageToken"],i);const s=d(t,["tuningJobs"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>bm(a))),h(n,["tuningJobs"],o)}return n}function YM(t,e){const n={},r=d(t,["name"]);r!=null&&h(n,["model"],r);const i=d(t,["name"]);return i!=null&&h(n,["endpoint"],i),n}function XM(t,e){const n={};if(d(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(d(t,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const r=d(t,["examples"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>s)),h(n,["examples","examples"],i)}return n}function ZM(t,e,n){const r={};let i=d(n,["config","method"]);if(i===void 0&&(i="SUPERVISED_FINE_TUNING"),i==="SUPERVISED_FINE_TUNING"){const o=d(t,["gcsUri"]);e!==void 0&&o!=null&&h(e,["supervisedTuningSpec","trainingDatasetUri"],o)}else if(i==="PREFERENCE_TUNING"){const o=d(t,["gcsUri"]);e!==void 0&&o!=null&&h(e,["preferenceOptimizationSpec","trainingDatasetUri"],o)}let s=d(n,["config","method"]);if(s===void 0&&(s="SUPERVISED_FINE_TUNING"),s==="SUPERVISED_FINE_TUNING"){const o=d(t,["vertexDatasetResource"]);e!==void 0&&o!=null&&h(e,["supervisedTuningSpec","trainingDatasetUri"],o)}else if(s==="PREFERENCE_TUNING"){const o=d(t,["vertexDatasetResource"]);e!==void 0&&o!=null&&h(e,["preferenceOptimizationSpec","trainingDatasetUri"],o)}if(d(t,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return r}function FC(t,e){const n={},r=d(t,["sdkHttpResponse"]);r!=null&&h(n,["sdkHttpResponse"],r);const i=d(t,["name"]);i!=null&&h(n,["name"],i);const s=d(t,["state"]);s!=null&&h(n,["state"],yC(s));const o=d(t,["createTime"]);o!=null&&h(n,["createTime"],o);const a=d(t,["tuningTask","startTime"]);a!=null&&h(n,["startTime"],a);const l=d(t,["tuningTask","completeTime"]);l!=null&&h(n,["endTime"],l);const u=d(t,["updateTime"]);u!=null&&h(n,["updateTime"],u);const f=d(t,["description"]);f!=null&&h(n,["description"],f);const m=d(t,["baseModel"]);m!=null&&h(n,["baseModel"],m);const g=d(t,["_self"]);return g!=null&&h(n,["tunedModel"],YM(g)),n}function bm(t,e){const n={},r=d(t,["sdkHttpResponse"]);r!=null&&h(n,["sdkHttpResponse"],r);const i=d(t,["name"]);i!=null&&h(n,["name"],i);const s=d(t,["state"]);s!=null&&h(n,["state"],yC(s));const o=d(t,["createTime"]);o!=null&&h(n,["createTime"],o);const a=d(t,["startTime"]);a!=null&&h(n,["startTime"],a);const l=d(t,["endTime"]);l!=null&&h(n,["endTime"],l);const u=d(t,["updateTime"]);u!=null&&h(n,["updateTime"],u);const f=d(t,["error"]);f!=null&&h(n,["error"],f);const m=d(t,["description"]);m!=null&&h(n,["description"],m);const g=d(t,["baseModel"]);g!=null&&h(n,["baseModel"],g);const v=d(t,["tunedModel"]);v!=null&&h(n,["tunedModel"],v);const T=d(t,["preTunedModel"]);T!=null&&h(n,["preTunedModel"],T);const P=d(t,["supervisedTuningSpec"]);P!=null&&h(n,["supervisedTuningSpec"],P);const M=d(t,["preferenceOptimizationSpec"]);M!=null&&h(n,["preferenceOptimizationSpec"],M);const x=d(t,["tuningDataStats"]);x!=null&&h(n,["tuningDataStats"],x);const E=d(t,["encryptionSpec"]);E!=null&&h(n,["encryptionSpec"],E);const A=d(t,["partnerModelTuningSpec"]);A!=null&&h(n,["partnerModelTuningSpec"],A);const V=d(t,["customBaseModel"]);V!=null&&h(n,["customBaseModel"],V);const B=d(t,["experiment"]);B!=null&&h(n,["experiment"],B);const G=d(t,["labels"]);G!=null&&h(n,["labels"],G);const I=d(t,["outputUri"]);I!=null&&h(n,["outputUri"],I);const S=d(t,["pipelineJob"]);S!=null&&h(n,["pipelineJob"],S);const R=d(t,["serviceAccount"]);R!=null&&h(n,["serviceAccount"],R);const N=d(t,["tunedModelDisplayName"]);N!=null&&h(n,["tunedModelDisplayName"],N);const D=d(t,["veoTuningSpec"]);return D!=null&&h(n,["veoTuningSpec"],D),n}function e2(t,e){const n={},r=d(t,["sdkHttpResponse"]);r!=null&&h(n,["sdkHttpResponse"],r);const i=d(t,["name"]);i!=null&&h(n,["name"],i);const s=d(t,["metadata"]);s!=null&&h(n,["metadata"],s);const o=d(t,["done"]);o!=null&&h(n,["done"],o);const a=d(t,["error"]);return a!=null&&h(n,["error"],a),n}function QT(t,e){const n={},r=d(t,["gcsUri"]);r!=null&&h(n,["validationDatasetUri"],r);const i=d(t,["vertexDatasetResource"]);return i!=null&&h(n,["validationDatasetUri"],i),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class t2 extends wo{constructor(e){super(),this.apiClient=e,this.get=async n=>await this.getInternal(n),this.list=async(n={})=>new Hu(co.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(n),n),this.tune=async n=>{var r;if(this.apiClient.isVertexAI())if(n.baseModel.startsWith("projects/")){const i={tunedModelName:n.baseModel};!((r=n.config)===null||r===void 0)&&r.preTunedModelCheckpointId&&(i.checkpointId=n.config.preTunedModelCheckpointId);const s=Object.assign(Object.assign({},n),{preTunedModel:i});return s.baseModel=void 0,await this.tuneInternal(s)}else{const i=Object.assign({},n);return await this.tuneInternal(i)}else{const i=Object.assign({},n),s=await this.tuneMldevInternal(i);let o="";return s.metadata!==void 0&&s.metadata.tunedModel!==void 0?o=s.metadata.tunedModel:s.name!==void 0&&s.name.includes("/operations/")&&(o=s.name.split("/operations/")[0]),{name:o,state:Cm.JOB_STATE_QUEUED}}}}async getInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=$M(e);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>bm(f))}else{const u=zM(e);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>FC(f))}}async listInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=KM(e);return a=de("tuningJobs",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=QM(f),g=new kT;return Object.assign(g,m),g})}else{const u=WM(e);return a=de("tunedModels",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const m=JM(f),g=new kT;return Object.assign(g,m),g})}}async cancel(e){var n,r,i,s;let o="",a={};if(this.apiClient.isVertexAI()){const l=UM(e);o=de("{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}else{const l=FM(e);o=de("{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal})}}async tuneInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=qM(e,e);return s=de("tuningJobs",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>bm(l))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=GM(e);return s=de("tunedModels",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>e2(l))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class n2{async download(e,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const r2=1024*1024*8,i2=3,s2=1e3,o2=2,fp="x-goog-upload-status";async function a2(t,e,n){var r,i,s;let o=0,a=0,l=new xm(new Response),u="upload";for(o=t.size;a<o;){const m=Math.min(r2,o-a),g=t.slice(a,a+m);a+m>=o&&(u+=", finalize");let v=0,T=s2;for(;v<i2&&(l=await n.request({path:"",body:g,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":u,"X-Goog-Upload-Offset":String(a),"Content-Length":String(m)}}}),!(!((r=l==null?void 0:l.headers)===null||r===void 0)&&r[fp]));)v++,await u2(T),T=T*o2;if(a+=m,((i=l==null?void 0:l.headers)===null||i===void 0?void 0:i[fp])!=="active")break;if(o<=a)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const f=await(l==null?void 0:l.json());if(((s=l==null?void 0:l.headers)===null||s===void 0?void 0:s[fp])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return f.file}async function l2(t){return{size:t.size,type:t.type}}function u2(t){return new Promise(e=>setTimeout(e,t))}class c2{async upload(e,n,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await a2(e,n,r)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await l2(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class d2{create(e,n,r){return new h2(e,n,r)}}class h2{constructor(e,n,r){this.url=e,this.headers=n,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const YT="x-goog-api-key";class f2{constructor(e){this.apiKey=e}async addAuthHeaders(e,n){if(e.get(YT)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(YT,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const p2="gl-node/";class m2{constructor(e){var n;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=e.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=e.apiKey;const r=Mk(e.httpOptions,e.vertexai,void 0,void 0);r&&(e.httpOptions?e.httpOptions.baseUrl=r:e.httpOptions={baseUrl:r}),this.apiVersion=e.apiVersion;const i=new f2(this.apiKey);this.apiClient=new eM({auth:i,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:p2+"web",uploader:new c2,downloader:new n2}),this.models=new TM(this.apiClient),this.live=new fM(this.apiClient,i,new d2),this.batches=new ZN(this.apiClient),this.chats=new N1(this.models,this.apiClient),this.caches=new R1(this.apiClient),this.files=new G1(this.apiClient),this.operations=new EM(this.apiClient),this.authTokens=new LM(this.apiClient),this.tunings=new t2(this.apiClient)}}const g2=()=>{};var XT={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UC=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},_2=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],o=t[n++],a=t[n++],l=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},OC={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],o=i+1<t.length,a=o?t[i+1]:0,l=i+2<t.length,u=l?t[i+2]:0,f=s>>2,m=(s&3)<<4|a>>4;let g=(a&15)<<2|u>>6,v=u&63;l||(v=64,o||(g=64)),r.push(n[f],n[m],n[g],n[v])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(UC(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):_2(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0;++i;const u=i<t.length?n[t.charAt(i)]:64;++i;const m=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||a==null||u==null||m==null)throw new y2;const g=s<<2|a>>4;if(r.push(g),u!==64){const v=a<<4&240|u>>2;if(r.push(v),m!==64){const T=u<<6&192|m;r.push(T)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class y2 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const v2=function(t){const e=UC(t);return OC.encodeByteArray(e,!0)},lh=function(t){return v2(t).replace(/\./g,"")},BC=function(t){try{return OC.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GC(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T2=()=>GC().__FIREBASE_DEFAULTS__,E2=()=>{if(typeof process>"u"||typeof XT>"u")return;const t=XT.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},w2=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&BC(t[1]);return e&&JSON.parse(e)},ef=()=>{try{return g2()||T2()||E2()||w2()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},qC=t=>{var e,n;return(n=(e=ef())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},I2=t=>{const e=qC(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},zC=()=>{var t;return(t=ef())==null?void 0:t.config},$C=t=>{var e;return(e=ef())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S2{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xa(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function HC(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C2(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...t};return[lh(JSON.stringify(n)),lh(JSON.stringify(o)),""].join(".")}const Yl={};function x2(){const t={prod:[],emulator:[]};for(const e of Object.keys(Yl))Yl[e]?t.emulator.push(e):t.prod.push(e);return t}function A2(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let ZT=!1;function jC(t,e){if(typeof window>"u"||typeof document>"u"||!Xa(window.location.host)||Yl[t]===e||Yl[t]||ZT)return;Yl[t]=e;function n(g){return`__firebase__banner__${g}`}const r="__firebase__banner",s=x2().prod.length>0;function o(){const g=document.getElementById(r);g&&g.remove()}function a(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function l(g,v){g.setAttribute("width","24"),g.setAttribute("id",v),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function u(){const g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{ZT=!0,o()},g}function f(g,v){g.setAttribute("id",v),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function m(){const g=A2(r),v=n("text"),T=document.getElementById(v)||document.createElement("span"),P=n("learnmore"),M=document.getElementById(P)||document.createElement("a"),x=n("preprendIcon"),E=document.getElementById(x)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){const A=g.element;a(A),f(M,P);const V=u();l(E,x),A.append(E,T,M,V),document.body.appendChild(A)}s?(T.innerText="Preview backend disconnected.",E.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(E.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,T.innerText="Preview backend running in this workspace."),T.setAttribute("id",v)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",m):m()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function R2(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(bt())}function WC(){var e;const t=(e=ef())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function P2(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function k2(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function N2(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function b2(){const t=bt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function KC(){return!WC()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function JC(){return!WC()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function QC(){try{return typeof indexedDB=="object"}catch{return!1}}function D2(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)==null?void 0:s.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M2="FirebaseError";class ui extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=M2,Object.setPrototypeOf(this,ui.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ju.prototype.create)}}class ju{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?V2(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new ui(i,a,r)}}function V2(t,e){return t.replace(L2,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const L2=/\{\$([^}]+)}/g;function F2(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function ho(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],o=e[i];if(eE(s)&&eE(o)){if(!ho(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function eE(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wu(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function U2(t,e){const n=new O2(t,e);return n.subscribe.bind(n)}class O2{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");B2(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=pp),i.error===void 0&&(i.error=pp),i.complete===void 0&&(i.complete=pp);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function B2(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function pp(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dt(t){return t&&t._delegate?t._delegate:t}class fo{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bs="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G2{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new S2;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(z2(e))try{this.getOrInitializeService({instanceIdentifier:Bs})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Bs){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Bs){return this.instances.has(e)}getOptions(e=Bs){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:q2(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Bs){return this.component?this.component.multipleInstances?e:Bs:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function q2(t){return t===Bs?void 0:t}function z2(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $2{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new G2(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Me;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Me||(Me={}));const H2={debug:Me.DEBUG,verbose:Me.VERBOSE,info:Me.INFO,warn:Me.WARN,error:Me.ERROR,silent:Me.SILENT},j2=Me.INFO,W2={[Me.DEBUG]:"log",[Me.VERBOSE]:"log",[Me.INFO]:"info",[Me.WARN]:"warn",[Me.ERROR]:"error"},K2=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=W2[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class y_{constructor(e){this.name=e,this._logLevel=j2,this._logHandler=K2,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Me))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?H2[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Me.DEBUG,...e),this._logHandler(this,Me.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Me.VERBOSE,...e),this._logHandler(this,Me.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Me.INFO,...e),this._logHandler(this,Me.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Me.WARN,...e),this._logHandler(this,Me.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Me.ERROR,...e),this._logHandler(this,Me.ERROR,...e)}}const J2=(t,e)=>e.some(n=>t instanceof n);let tE,nE;function Q2(){return tE||(tE=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Y2(){return nE||(nE=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const YC=new WeakMap,Dm=new WeakMap,XC=new WeakMap,mp=new WeakMap,v_=new WeakMap;function X2(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(Ji(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&YC.set(n,t)}).catch(()=>{}),v_.set(e,t),e}function Z2(t){if(Dm.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});Dm.set(t,e)}let Mm={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Dm.get(t);if(e==="objectStoreNames")return t.objectStoreNames||XC.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Ji(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function eV(t){Mm=t(Mm)}function tV(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(gp(this),e,...n);return XC.set(r,e.sort?e.sort():[e]),Ji(r)}:Y2().includes(t)?function(...e){return t.apply(gp(this),e),Ji(YC.get(this))}:function(...e){return Ji(t.apply(gp(this),e))}}function nV(t){return typeof t=="function"?tV(t):(t instanceof IDBTransaction&&Z2(t),J2(t,Q2())?new Proxy(t,Mm):t)}function Ji(t){if(t instanceof IDBRequest)return X2(t);if(mp.has(t))return mp.get(t);const e=nV(t);return e!==t&&(mp.set(t,e),v_.set(e,t)),e}const gp=t=>v_.get(t);function rV(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),a=Ji(o);return r&&o.addEventListener("upgradeneeded",l=>{r(Ji(o.result),l.oldVersion,l.newVersion,Ji(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}const iV=["get","getKey","getAll","getAllKeys","count"],sV=["put","add","delete","clear"],_p=new Map;function rE(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(_p.get(e))return _p.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=sV.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||iV.includes(n)))return;const s=async function(o,...a){const l=this.transaction(o,i?"readwrite":"readonly");let u=l.store;return r&&(u=u.index(a.shift())),(await Promise.all([u[n](...a),i&&l.done]))[0]};return _p.set(e,s),s}eV(t=>({...t,get:(e,n,r)=>rE(e,n)||t.get(e,n,r),has:(e,n)=>!!rE(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oV{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(aV(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function aV(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Vm="@firebase/app",iE="0.14.5";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ri=new y_("@firebase/app"),lV="@firebase/app-compat",uV="@firebase/analytics-compat",cV="@firebase/analytics",dV="@firebase/app-check-compat",hV="@firebase/app-check",fV="@firebase/auth",pV="@firebase/auth-compat",mV="@firebase/database",gV="@firebase/data-connect",_V="@firebase/database-compat",yV="@firebase/functions",vV="@firebase/functions-compat",TV="@firebase/installations",EV="@firebase/installations-compat",wV="@firebase/messaging",IV="@firebase/messaging-compat",SV="@firebase/performance",CV="@firebase/performance-compat",xV="@firebase/remote-config",AV="@firebase/remote-config-compat",RV="@firebase/storage",PV="@firebase/storage-compat",kV="@firebase/firestore",NV="@firebase/ai",bV="@firebase/firestore-compat",DV="firebase",MV="12.5.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lm="[DEFAULT]",VV={[Vm]:"fire-core",[lV]:"fire-core-compat",[cV]:"fire-analytics",[uV]:"fire-analytics-compat",[hV]:"fire-app-check",[dV]:"fire-app-check-compat",[fV]:"fire-auth",[pV]:"fire-auth-compat",[mV]:"fire-rtdb",[gV]:"fire-data-connect",[_V]:"fire-rtdb-compat",[yV]:"fire-fn",[vV]:"fire-fn-compat",[TV]:"fire-iid",[EV]:"fire-iid-compat",[wV]:"fire-fcm",[IV]:"fire-fcm-compat",[SV]:"fire-perf",[CV]:"fire-perf-compat",[xV]:"fire-rc",[AV]:"fire-rc-compat",[RV]:"fire-gcs",[PV]:"fire-gcs-compat",[kV]:"fire-fst",[bV]:"fire-fst-compat",[NV]:"fire-vertex","fire-js":"fire-js",[DV]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uh=new Map,LV=new Map,Fm=new Map;function sE(t,e){try{t.container.addComponent(e)}catch(n){ri.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Pa(t){const e=t.name;if(Fm.has(e))return ri.debug(`There were multiple attempts to register component ${e}.`),!1;Fm.set(e,t);for(const n of uh.values())sE(n,t);for(const n of LV.values())sE(n,t);return!0}function T_(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function ir(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FV={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Qi=new ju("app","Firebase",FV);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UV{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new fo("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Qi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Za=MV;function ZC(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:Lm,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw Qi.create("bad-app-name",{appName:String(i)});if(n||(n=zC()),!n)throw Qi.create("no-options");const s=uh.get(i);if(s){if(ho(n,s.options)&&ho(r,s.config))return s;throw Qi.create("duplicate-app",{appName:i})}const o=new $2(i);for(const l of Fm.values())o.addComponent(l);const a=new UV(n,r,o);return uh.set(i,a),a}function e0(t=Lm){const e=uh.get(t);if(!e&&t===Lm&&zC())return ZC();if(!e)throw Qi.create("no-app",{appName:t});return e}function Yi(t,e,n){let r=VV[t]??t;n&&(r+=`-${n}`);const i=r.match(/\s|\//),s=e.match(/\s|\//);if(i||s){const o=[`Unable to register library "${r}" with version "${e}":`];i&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ri.warn(o.join(" "));return}Pa(new fo(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OV="firebase-heartbeat-database",BV=1,xu="firebase-heartbeat-store";let yp=null;function t0(){return yp||(yp=rV(OV,BV,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(xu)}catch(n){console.warn(n)}}}}).catch(t=>{throw Qi.create("idb-open",{originalErrorMessage:t.message})})),yp}async function GV(t){try{const n=(await t0()).transaction(xu),r=await n.objectStore(xu).get(n0(t));return await n.done,r}catch(e){if(e instanceof ui)ri.warn(e.message);else{const n=Qi.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ri.warn(n.message)}}}async function oE(t,e){try{const r=(await t0()).transaction(xu,"readwrite");await r.objectStore(xu).put(e,n0(t)),await r.done}catch(n){if(n instanceof ui)ri.warn(n.message);else{const r=Qi.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});ri.warn(r.message)}}}function n0(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qV=1024,zV=30;class $V{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new jV(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=aE();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>zV){const o=WV(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){ri.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=aE(),{heartbeatsToSend:r,unsentEntries:i}=HV(this._heartbeatsCache.heartbeats),s=lh(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return ri.warn(n),""}}}function aE(){return new Date().toISOString().substring(0,10)}function HV(t,e=qV){const n=[];let r=t.slice();for(const i of t){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),lE(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),lE(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class jV{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return QC()?D2().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await GV(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return oE(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return oE(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function lE(t){return lh(JSON.stringify({version:2,heartbeats:t})).length}function WV(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KV(t){Pa(new fo("platform-logger",e=>new oV(e),"PRIVATE")),Pa(new fo("heartbeat",e=>new $V(e),"PRIVATE")),Yi(Vm,iE,t),Yi(Vm,iE,"esm2020"),Yi("fire-js","")}KV("");var JV="firebase",QV="12.5.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Yi(JV,QV,"app");function r0(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const YV=r0,i0=new ju("auth","Firebase",r0());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ch=new y_("@firebase/auth");function XV(t,...e){ch.logLevel<=Me.WARN&&ch.warn(`Auth (${Za}): ${t}`,...e)}function Td(t,...e){ch.logLevel<=Me.ERROR&&ch.error(`Auth (${Za}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nr(t,...e){throw w_(t,...e)}function lr(t,...e){return w_(t,...e)}function E_(t,e,n){const r={...YV(),[e]:n};return new ju("auth","Firebase",r).create(e,{appName:t.name})}function to(t){return E_(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function ZV(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&Nr(t,"argument-error"),E_(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function w_(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return i0.create(t,...e)}function Ee(t,e,...n){if(!t)throw w_(e,...n)}function Kr(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Td(e),new Error(e)}function ii(t,e){t||Kr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Um(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function eL(){return uE()==="http:"||uE()==="https:"}function uE(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tL(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(eL()||k2()||"connection"in navigator)?navigator.onLine:!0}function nL(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ku{constructor(e,n){this.shortDelay=e,this.longDelay=n,ii(n>e,"Short delay should be less than long delay!"),this.isMobile=R2()||N2()}get(){return tL()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I_(t,e){ii(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s0{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Kr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Kr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Kr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rL={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iL=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],sL=new Ku(3e4,6e4);function S_(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function el(t,e,n,r,i={}){return o0(t,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const a=Wu({key:t.config.apiKey,...o}).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const u={method:e,headers:l,...s};return P2()||(u.referrerPolicy="no-referrer"),t.emulatorConfig&&Xa(t.emulatorConfig.host)&&(u.credentials="include"),s0.fetch()(await a0(t,t.config.apiHost,n,a),u)})}async function o0(t,e,n){t._canInitEmulator=!1;const r={...rL,...e};try{const i=new aL(t),s=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw Xc(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[l,u]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Xc(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw Xc(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw Xc(t,"user-disabled",o);const f=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw E_(t,f,u);Nr(t,f)}}catch(i){if(i instanceof ui)throw i;Nr(t,"network-request-failed",{message:String(i)})}}async function oL(t,e,n,r,i={}){const s=await el(t,e,n,r,i);return"mfaPendingCredential"in s&&Nr(t,"multi-factor-auth-required",{_serverResponse:s}),s}async function a0(t,e,n,r){const i=`${e}${n}?${r}`,s=t,o=s.config.emulator?I_(t.config,i):`${t.config.apiScheme}://${i}`;return iL.includes(n)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}class aL{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(lr(this.auth,"network-request-failed")),sL.get())})}}function Xc(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=lr(t,e,r);return i.customData._tokenResponse=n,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lL(t,e){return el(t,"POST","/v1/accounts:delete",e)}async function dh(t,e){return el(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xl(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function uL(t,e=!1){const n=Dt(t),r=await n.getIdToken(e),i=C_(r);Ee(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:Xl(vp(i.auth_time)),issuedAtTime:Xl(vp(i.iat)),expirationTime:Xl(vp(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function vp(t){return Number(t)*1e3}function C_(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Td("JWT malformed, contained fewer than 3 sections"),null;try{const i=BC(n);return i?JSON.parse(i):(Td("Failed to decode base64 JWT payload"),null)}catch(i){return Td("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function cE(t){const e=C_(t);return Ee(e,"internal-error"),Ee(typeof e.exp<"u","internal-error"),Ee(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Au(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof ui&&cL(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function cL({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dL{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Om{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Xl(this.lastLoginAt),this.creationTime=Xl(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hh(t){var m;const e=t.auth,n=await t.getIdToken(),r=await Au(t,dh(e,{idToken:n}));Ee(r==null?void 0:r.users.length,e,"internal-error");const i=r.users[0];t._notifyReloadListener(i);const s=(m=i.providerUserInfo)!=null&&m.length?l0(i.providerUserInfo):[],o=fL(t.providerData,s),a=t.isAnonymous,l=!(t.email&&i.passwordHash)&&!(o!=null&&o.length),u=a?l:!1,f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new Om(i.createdAt,i.lastLoginAt),isAnonymous:u};Object.assign(t,f)}async function hL(t){const e=Dt(t);await hh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function fL(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function l0(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pL(t,e){const n=await o0(t,{},async()=>{const r=Wu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,o=await a0(t,i,"/v1/token",`key=${s}`),a=await t._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:a,body:r};return t.emulatorConfig&&Xa(t.emulatorConfig.host)&&(l.credentials="include"),s0.fetch()(o,l)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function mL(t,e){return el(t,"POST","/v2/accounts:revokeToken",S_(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ya{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ee(e.idToken,"internal-error"),Ee(typeof e.idToken<"u","internal-error"),Ee(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):cE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Ee(e.length!==0,"internal-error");const n=cE(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Ee(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:s}=await pL(e,n);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:s}=n,o=new ya;return r&&(Ee(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(Ee(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(Ee(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ya,this.toJSON())}_performRefresh(){return Kr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ci(t,e){Ee(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class sr{constructor({uid:e,auth:n,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new dL(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Om(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await Au(this,this.stsTokenManager.getToken(this.auth,e));return Ee(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return uL(this,e)}reload(){return hL(this)}_assign(e){this!==e&&(Ee(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new sr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){Ee(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await hh(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ir(this.auth.app))return Promise.reject(to(this.auth));const e=await this.getIdToken();return await Au(this,lL(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,i=n.email??void 0,s=n.phoneNumber??void 0,o=n.photoURL??void 0,a=n.tenantId??void 0,l=n._redirectEventId??void 0,u=n.createdAt??void 0,f=n.lastLoginAt??void 0,{uid:m,emailVerified:g,isAnonymous:v,providerData:T,stsTokenManager:P}=n;Ee(m&&P,e,"internal-error");const M=ya.fromJSON(this.name,P);Ee(typeof m=="string",e,"internal-error"),Ci(r,e.name),Ci(i,e.name),Ee(typeof g=="boolean",e,"internal-error"),Ee(typeof v=="boolean",e,"internal-error"),Ci(s,e.name),Ci(o,e.name),Ci(a,e.name),Ci(l,e.name),Ci(u,e.name),Ci(f,e.name);const x=new sr({uid:m,auth:e,email:i,emailVerified:g,displayName:r,isAnonymous:v,photoURL:o,phoneNumber:s,tenantId:a,stsTokenManager:M,createdAt:u,lastLoginAt:f});return T&&Array.isArray(T)&&(x.providerData=T.map(E=>({...E}))),l&&(x._redirectEventId=l),x}static async _fromIdTokenResponse(e,n,r=!1){const i=new ya;i.updateFromServerResponse(n);const s=new sr({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await hh(s),s}static async _fromGetAccountInfoResponse(e,n,r){const i=n.users[0];Ee(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?l0(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),a=new ya;a.updateFromIdToken(r);const l=new sr({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Om(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(l,u),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dE=new Map;function Jr(t){ii(t instanceof Function,"Expected a class definition");let e=dE.get(t);return e?(ii(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,dE.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u0{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}u0.type="NONE";const hE=u0;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ed(t,e,n){return`firebase:${t}:${e}:${n}`}class va{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=Ed(this.userKey,i.apiKey,s),this.fullPersistenceKey=Ed("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await dh(this.auth,{idToken:e}).catch(()=>{});return n?sr._fromGetAccountInfoResponse(this.auth,n,e):null}return sr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new va(Jr(hE),e,r);const i=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let s=i[0]||Jr(hE);const o=Ed(r,e.config.apiKey,e.name);let a=null;for(const u of n)try{const f=await u._get(o);if(f){let m;if(typeof f=="string"){const g=await dh(e,{idToken:f}).catch(()=>{});if(!g)break;m=await sr._fromGetAccountInfoResponse(e,g,f)}else m=sr._fromJSON(e,f);u!==s&&(a=m),s=u;break}}catch{}const l=i.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new va(s,e,r):(s=l[0],a&&await s._set(o,a.toJSON()),await Promise.all(n.map(async u=>{if(u!==s)try{await u._remove(o)}catch{}})),new va(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fE(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(f0(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(c0(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(m0(e))return"Blackberry";if(g0(e))return"Webos";if(d0(e))return"Safari";if((e.includes("chrome/")||h0(e))&&!e.includes("edge/"))return"Chrome";if(p0(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function c0(t=bt()){return/firefox\//i.test(t)}function d0(t=bt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function h0(t=bt()){return/crios\//i.test(t)}function f0(t=bt()){return/iemobile/i.test(t)}function p0(t=bt()){return/android/i.test(t)}function m0(t=bt()){return/blackberry/i.test(t)}function g0(t=bt()){return/webos/i.test(t)}function x_(t=bt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function gL(t=bt()){var e;return x_(t)&&!!((e=window.navigator)!=null&&e.standalone)}function _L(){return b2()&&document.documentMode===10}function _0(t=bt()){return x_(t)||p0(t)||g0(t)||m0(t)||/windows phone/i.test(t)||f0(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y0(t,e=[]){let n;switch(t){case"Browser":n=fE(bt());break;case"Worker":n=`${fE(bt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Za}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yL{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=s=>new Promise((o,a)=>{try{const l=e(s);o(l)}catch(l){a(l)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vL(t,e={}){return el(t,"GET","/v2/passwordPolicy",S_(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TL=6;class EL{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??TL,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wL{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new pE(this),this.idTokenSubscription=new pE(this),this.beforeStateQueue=new yL(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=i0,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Jr(n)),this._initializationPromise=this.queue(async()=>{var r,i,s;if(!this._deleted&&(this.persistenceManager=await va.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((i=this._popupRedirectResolver)!=null&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)==null?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await dh(this,{idToken:e}),r=await sr._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var s;if(ir(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(s=this.redirectUser)==null?void 0:s._redirectEventId,a=r==null?void 0:r._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(r=l.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Ee(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await hh(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=nL()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ir(this.app))return Promise.reject(to(this));const n=e?Dt(e):null;return n&&Ee(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Ee(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ir(this.app)?Promise.reject(to(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ir(this.app)?Promise.reject(to(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Jr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await vL(this),n=new EL(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new ju("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await mL(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Jr(e)||this._popupRedirectResolver;Ee(n,this,"argument-error"),this.redirectPersistenceManager=await va.create(this,[Jr(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ee(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,r,i);return()=>{o=!0,l()}}else{const l=e.addObserver(n);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ee(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=y0(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var i;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((i=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:i.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if(ir(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&XV(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function tf(t){return Dt(t)}class pE{constructor(e){this.auth=e,this.observer=null,this.addObserver=U2(n=>this.observer=n)}get next(){return Ee(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let A_={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function IL(t){A_=t}function SL(t){return A_.loadJS(t)}function CL(){return A_.gapiScript}function xL(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AL(t,e){const n=T_(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),s=n.getOptions();if(ho(s,e??{}))return i;Nr(i,"already-initialized")}return n.initialize({options:e})}function RL(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Jr);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function PL(t,e,n){const r=tf(t);Ee(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,s=v0(e),{host:o,port:a}=kL(e),l=a===null?"":`:${a}`,u={url:`${s}//${o}${l}/`},f=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){Ee(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),Ee(ho(u,r.config.emulator)&&ho(f,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=u,r.emulatorConfig=f,r.settings.appVerificationDisabledForTesting=!0,Xa(o)?(HC(`${s}//${o}${l}`),jC("Auth",!0)):NL()}function v0(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function kL(t){const e=v0(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:mE(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:mE(o)}}}function mE(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function NL(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T0{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Kr("not implemented")}_getIdTokenResponse(e){return Kr("not implemented")}_linkToIdToken(e,n){return Kr("not implemented")}_getReauthenticationResolver(e){return Kr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ta(t,e){return oL(t,"POST","/v1/accounts:signInWithIdp",S_(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bL="http://localhost";class po extends T0{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new po(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Nr("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...s}=n;if(!r||!i)return null;const o=new po(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Ta(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Ta(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Ta(e,n)}buildRequest(){const e={requestUri:bL,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Wu(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R_{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ju extends R_{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mi extends Ju{constructor(){super("facebook.com")}static credential(e){return po._fromParams({providerId:Mi.PROVIDER_ID,signInMethod:Mi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Mi.credentialFromTaggedObject(e)}static credentialFromError(e){return Mi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Mi.credential(e.oauthAccessToken)}catch{return null}}}Mi.FACEBOOK_SIGN_IN_METHOD="facebook.com";Mi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hr extends Ju{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return po._fromParams({providerId:Hr.PROVIDER_ID,signInMethod:Hr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Hr.credentialFromTaggedObject(e)}static credentialFromError(e){return Hr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Hr.credential(n,r)}catch{return null}}}Hr.GOOGLE_SIGN_IN_METHOD="google.com";Hr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vi extends Ju{constructor(){super("github.com")}static credential(e){return po._fromParams({providerId:Vi.PROVIDER_ID,signInMethod:Vi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Vi.credentialFromTaggedObject(e)}static credentialFromError(e){return Vi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Vi.credential(e.oauthAccessToken)}catch{return null}}}Vi.GITHUB_SIGN_IN_METHOD="github.com";Vi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Li extends Ju{constructor(){super("twitter.com")}static credential(e,n){return po._fromParams({providerId:Li.PROVIDER_ID,signInMethod:Li.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Li.credentialFromTaggedObject(e)}static credentialFromError(e){return Li.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Li.credential(n,r)}catch{return null}}}Li.TWITTER_SIGN_IN_METHOD="twitter.com";Li.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ka{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const s=await sr._fromIdTokenResponse(e,r,i),o=gE(r);return new ka({user:s,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=gE(r);return new ka({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function gE(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fh extends ui{constructor(e,n,r,i){super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,fh.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new fh(e,n,r,i)}}function E0(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?fh._fromErrorAndOperation(t,s,e,r):s})}async function DL(t,e,n=!1){const r=await Au(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return ka._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ML(t,e,n=!1){const{auth:r}=t;if(ir(r.app))return Promise.reject(to(r));const i="reauthenticate";try{const s=await Au(t,E0(r,i,e,t),n);Ee(s.idToken,r,"internal-error");const o=C_(s.idToken);Ee(o,r,"internal-error");const{sub:a}=o;return Ee(t.uid===a,r,"user-mismatch"),ka._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&Nr(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VL(t,e,n=!1){if(ir(t.app))return Promise.reject(to(t));const r="signIn",i=await E0(t,r,e),s=await ka._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(s.user),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LL(t,e){return Dt(t).setPersistence(e)}function FL(t,e,n,r){return Dt(t).onIdTokenChanged(e,n,r)}function UL(t,e,n){return Dt(t).beforeAuthStateChanged(e,n)}function OL(t,e,n,r){return Dt(t).onAuthStateChanged(e,n,r)}function _E(t){return Dt(t).signOut()}const ph="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w0{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(ph,"1"),this.storage.removeItem(ph),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BL=1e3,GL=10;class I0 extends w0{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=_0(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;n?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);_L()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,GL):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},BL)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}I0.type="LOCAL";const S0=I0;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C0 extends w0{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}C0.type="SESSION";const x0=C0;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qL(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new nf(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:s}=n.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const a=Array.from(o).map(async u=>u(n.origin,s)),l=await qL(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}nf.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P_(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zL{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,l)=>{const u=P_("",20);i.port1.start();const f=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(m){const g=m;if(g.data.eventId===u)switch(g.data.status){case"ack":clearTimeout(f),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(g.data.response);break;default:clearTimeout(f),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pr(){return window}function $L(t){Pr().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A0(){return typeof Pr().WorkerGlobalScope<"u"&&typeof Pr().importScripts=="function"}async function HL(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function jL(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function WL(){return A0()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R0="firebaseLocalStorageDb",KL=1,mh="firebaseLocalStorage",P0="fbase_key";class Qu{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function rf(t,e){return t.transaction([mh],e?"readwrite":"readonly").objectStore(mh)}function JL(){const t=indexedDB.deleteDatabase(R0);return new Qu(t).toPromise()}function Bm(){const t=indexedDB.open(R0,KL);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(mh,{keyPath:P0})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(mh)?e(r):(r.close(),await JL(),e(await Bm()))})})}async function yE(t,e,n){const r=rf(t,!0).put({[P0]:e,value:n});return new Qu(r).toPromise()}async function QL(t,e){const n=rf(t,!1).get(e),r=await new Qu(n).toPromise();return r===void 0?null:r.value}function vE(t,e){const n=rf(t,!0).delete(e);return new Qu(n).toPromise()}const YL=800,XL=3;class k0{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Bm(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>XL)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return A0()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=nf._getInstance(WL()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await HL(),!this.activeServiceWorker)return;this.sender=new zL(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||jL()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Bm();return await yE(e,ph,"1"),await vE(e,ph),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>yE(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>QL(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>vE(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=rf(i,!1).getAll();return new Qu(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),YL)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}k0.type="LOCAL";const ZL=k0;new Ku(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N0(t,e){return e?Jr(e):(Ee(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k_ extends T0{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ta(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Ta(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Ta(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function eF(t){return VL(t.auth,new k_(t),t.bypassAuthState)}function tF(t){const{auth:e,user:n}=t;return Ee(n,e,"internal-error"),ML(n,new k_(t),t.bypassAuthState)}async function nF(t){const{auth:e,user:n}=t;return Ee(n,e,"internal-error"),DL(n,new k_(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b0{constructor(e,n,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return eF;case"linkViaPopup":case"linkViaRedirect":return nF;case"reauthViaPopup":case"reauthViaRedirect":return tF;default:Nr(this.auth,"internal-error")}}resolve(e){ii(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ii(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rF=new Ku(2e3,1e4);async function iF(t,e,n){if(ir(t.app))return Promise.reject(lr(t,"operation-not-supported-in-this-environment"));const r=tf(t);ZV(t,e,R_);const i=N0(r,n);return new Ys(r,"signInViaPopup",e,i).executeNotNull()}class Ys extends b0{constructor(e,n,r,i,s){super(e,n,i,s),this.provider=r,this.authWindow=null,this.pollId=null,Ys.currentPopupAction&&Ys.currentPopupAction.cancel(),Ys.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ee(e,this.auth,"internal-error"),e}async onExecution(){ii(this.filter.length===1,"Popup operations only handle one event");const e=P_();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(lr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(lr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ys.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(lr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,rF.get())};e()}}Ys.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sF="pendingRedirect",wd=new Map;class oF extends b0{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=wd.get(this.auth._key());if(!e){try{const r=await aF(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}wd.set(this.auth._key(),e)}return this.bypassAuthState||wd.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function aF(t,e){const n=cF(e),r=uF(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}function lF(t,e){wd.set(t._key(),e)}function uF(t){return Jr(t._redirectPersistence)}function cF(t){return Ed(sF,t.config.apiKey,t.name)}async function dF(t,e,n=!1){if(ir(t.app))return Promise.reject(to(t));const r=tf(t),i=N0(r,e),o=await new oF(r,i,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hF=10*60*1e3;class fF{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!pF(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!D0(e)){const i=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(lr(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=hF&&this.cachedEventUids.clear(),this.cachedEventUids.has(TE(e))}saveEventToCache(e){this.cachedEventUids.add(TE(e)),this.lastProcessedEventTime=Date.now()}}function TE(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function D0({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function pF(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return D0(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mF(t,e={}){return el(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gF=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,_F=/^https?/;async function yF(t){if(t.config.emulator)return;const{authorizedDomains:e}=await mF(t);for(const n of e)try{if(vF(n))return}catch{}Nr(t,"unauthorized-domain")}function vF(t){const e=Um(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!_F.test(n))return!1;if(gF.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TF=new Ku(3e4,6e4);function EE(){const t=Pr().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function EF(t){return new Promise((e,n)=>{var i,s,o;function r(){EE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{EE(),n(lr(t,"network-request-failed"))},timeout:TF.get()})}if((s=(i=Pr().gapi)==null?void 0:i.iframes)!=null&&s.Iframe)e(gapi.iframes.getContext());else if((o=Pr().gapi)!=null&&o.load)r();else{const a=xL("iframefcb");return Pr()[a]=()=>{gapi.load?r():n(lr(t,"network-request-failed"))},SL(`${CL()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw Id=null,e})}let Id=null;function wF(t){return Id=Id||EF(t),Id}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IF=new Ku(5e3,15e3),SF="__/auth/iframe",CF="emulator/auth/iframe",xF={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},AF=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function RF(t){const e=t.config;Ee(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?I_(e,CF):`https://${t.config.authDomain}/${SF}`,r={apiKey:e.apiKey,appName:t.name,v:Za},i=AF.get(t.config.apiHost);i&&(r.eid=i);const s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${Wu(r).slice(1)}`}async function PF(t){const e=await wF(t),n=Pr().gapi;return Ee(n,t,"internal-error"),e.open({where:document.body,url:RF(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:xF,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=lr(t,"network-request-failed"),a=Pr().setTimeout(()=>{s(o)},IF.get());function l(){Pr().clearTimeout(a),i(r)}r.ping(l).then(l,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kF={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},NF=500,bF=600,DF="_blank",MF="http://localhost";class wE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function VF(t,e,n,r=NF,i=bF){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l={...kF,width:r.toString(),height:i.toString(),top:s,left:o},u=bt().toLowerCase();n&&(a=h0(u)?DF:n),c0(u)&&(e=e||MF,l.scrollbars="yes");const f=Object.entries(l).reduce((g,[v,T])=>`${g}${v}=${T},`,"");if(gL(u)&&a!=="_self")return LF(e||"",a),new wE(null);const m=window.open(e||"",a,f);Ee(m,t,"popup-blocked");try{m.focus()}catch{}return new wE(m)}function LF(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FF="__/auth/handler",UF="emulator/auth/handler",OF=encodeURIComponent("fac");async function IE(t,e,n,r,i,s){Ee(t.config.authDomain,t,"auth-domain-config-required"),Ee(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Za,eventId:i};if(e instanceof R_){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",F2(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,m]of Object.entries({}))o[f]=m}if(e instanceof Ju){const f=e.getScopes().filter(m=>m!=="");f.length>0&&(o.scopes=f.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const f of Object.keys(a))a[f]===void 0&&delete a[f];const l=await t._getAppCheckToken(),u=l?`#${OF}=${encodeURIComponent(l)}`:"";return`${BF(t)}?${Wu(a).slice(1)}${u}`}function BF({config:t}){return t.emulator?I_(t,UF):`https://${t.authDomain}/${FF}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tp="webStorageSupport";class GF{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=x0,this._completeRedirectFn=dF,this._overrideRedirectResult=lF}async _openPopup(e,n,r,i){var o;ii((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const s=await IE(e,n,r,Um(),i);return VF(e,s,P_())}async _openRedirect(e,n,r,i){await this._originValidation(e);const s=await IE(e,n,r,Um(),i);return $L(s),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:s}=this.eventManagers[n];return i?Promise.resolve(i):(ii(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await PF(e),r=new fF(e);return n.register("authEvent",i=>(Ee(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Tp,{type:Tp},i=>{var o;const s=(o=i==null?void 0:i[0])==null?void 0:o[Tp];s!==void 0&&n(!!s),Nr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=yF(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return _0()||d0()||x_()}}const qF=GF;var SE="@firebase/auth",CE="1.11.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zF{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Ee(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $F(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function HF(t){Pa(new fo("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;Ee(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:y0(t)},u=new wL(r,i,s,l);return RL(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Pa(new fo("auth-internal",e=>{const n=tf(e.getProvider("auth").getImmediate());return(r=>new zF(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Yi(SE,CE,$F(t)),Yi(SE,CE,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jF=5*60,WF=$C("authIdTokenMaxAge")||jF;let xE=null;const KF=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>WF)return;const i=n==null?void 0:n.token;xE!==i&&(xE=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function JF(t=e0()){const e=T_(t,"auth");if(e.isInitialized())return e.getImmediate();const n=AL(t,{popupRedirectResolver:qF,persistence:[ZL,S0,x0]}),r=$C("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const o=KF(s.toString());UL(n,o,()=>o(n.currentUser)),FL(n,a=>o(a))}}const i=qC("auth");return i&&PL(n,`http://${i}`),n}function QF(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}IL({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const s=lr("internal-error");s.customData=i,n(s)},r.type="text/javascript",r.charset="UTF-8",QF().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});HF("Browser");var AE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Xi,M0;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(I,S){function R(){}R.prototype=S.prototype,I.F=S.prototype,I.prototype=new R,I.prototype.constructor=I,I.D=function(N,D,L){for(var b=Array(arguments.length-2),Re=2;Re<arguments.length;Re++)b[Re-2]=arguments[Re];return S.prototype[D].apply(N,b)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(I,S,R){R||(R=0);const N=Array(16);if(typeof S=="string")for(var D=0;D<16;++D)N[D]=S.charCodeAt(R++)|S.charCodeAt(R++)<<8|S.charCodeAt(R++)<<16|S.charCodeAt(R++)<<24;else for(D=0;D<16;++D)N[D]=S[R++]|S[R++]<<8|S[R++]<<16|S[R++]<<24;S=I.g[0],R=I.g[1],D=I.g[2];let L=I.g[3],b;b=S+(L^R&(D^L))+N[0]+3614090360&4294967295,S=R+(b<<7&4294967295|b>>>25),b=L+(D^S&(R^D))+N[1]+3905402710&4294967295,L=S+(b<<12&4294967295|b>>>20),b=D+(R^L&(S^R))+N[2]+606105819&4294967295,D=L+(b<<17&4294967295|b>>>15),b=R+(S^D&(L^S))+N[3]+3250441966&4294967295,R=D+(b<<22&4294967295|b>>>10),b=S+(L^R&(D^L))+N[4]+4118548399&4294967295,S=R+(b<<7&4294967295|b>>>25),b=L+(D^S&(R^D))+N[5]+1200080426&4294967295,L=S+(b<<12&4294967295|b>>>20),b=D+(R^L&(S^R))+N[6]+2821735955&4294967295,D=L+(b<<17&4294967295|b>>>15),b=R+(S^D&(L^S))+N[7]+4249261313&4294967295,R=D+(b<<22&4294967295|b>>>10),b=S+(L^R&(D^L))+N[8]+1770035416&4294967295,S=R+(b<<7&4294967295|b>>>25),b=L+(D^S&(R^D))+N[9]+2336552879&4294967295,L=S+(b<<12&4294967295|b>>>20),b=D+(R^L&(S^R))+N[10]+4294925233&4294967295,D=L+(b<<17&4294967295|b>>>15),b=R+(S^D&(L^S))+N[11]+2304563134&4294967295,R=D+(b<<22&4294967295|b>>>10),b=S+(L^R&(D^L))+N[12]+1804603682&4294967295,S=R+(b<<7&4294967295|b>>>25),b=L+(D^S&(R^D))+N[13]+4254626195&4294967295,L=S+(b<<12&4294967295|b>>>20),b=D+(R^L&(S^R))+N[14]+2792965006&4294967295,D=L+(b<<17&4294967295|b>>>15),b=R+(S^D&(L^S))+N[15]+1236535329&4294967295,R=D+(b<<22&4294967295|b>>>10),b=S+(D^L&(R^D))+N[1]+4129170786&4294967295,S=R+(b<<5&4294967295|b>>>27),b=L+(R^D&(S^R))+N[6]+3225465664&4294967295,L=S+(b<<9&4294967295|b>>>23),b=D+(S^R&(L^S))+N[11]+643717713&4294967295,D=L+(b<<14&4294967295|b>>>18),b=R+(L^S&(D^L))+N[0]+3921069994&4294967295,R=D+(b<<20&4294967295|b>>>12),b=S+(D^L&(R^D))+N[5]+3593408605&4294967295,S=R+(b<<5&4294967295|b>>>27),b=L+(R^D&(S^R))+N[10]+38016083&4294967295,L=S+(b<<9&4294967295|b>>>23),b=D+(S^R&(L^S))+N[15]+3634488961&4294967295,D=L+(b<<14&4294967295|b>>>18),b=R+(L^S&(D^L))+N[4]+3889429448&4294967295,R=D+(b<<20&4294967295|b>>>12),b=S+(D^L&(R^D))+N[9]+568446438&4294967295,S=R+(b<<5&4294967295|b>>>27),b=L+(R^D&(S^R))+N[14]+3275163606&4294967295,L=S+(b<<9&4294967295|b>>>23),b=D+(S^R&(L^S))+N[3]+4107603335&4294967295,D=L+(b<<14&4294967295|b>>>18),b=R+(L^S&(D^L))+N[8]+1163531501&4294967295,R=D+(b<<20&4294967295|b>>>12),b=S+(D^L&(R^D))+N[13]+2850285829&4294967295,S=R+(b<<5&4294967295|b>>>27),b=L+(R^D&(S^R))+N[2]+4243563512&4294967295,L=S+(b<<9&4294967295|b>>>23),b=D+(S^R&(L^S))+N[7]+1735328473&4294967295,D=L+(b<<14&4294967295|b>>>18),b=R+(L^S&(D^L))+N[12]+2368359562&4294967295,R=D+(b<<20&4294967295|b>>>12),b=S+(R^D^L)+N[5]+4294588738&4294967295,S=R+(b<<4&4294967295|b>>>28),b=L+(S^R^D)+N[8]+2272392833&4294967295,L=S+(b<<11&4294967295|b>>>21),b=D+(L^S^R)+N[11]+1839030562&4294967295,D=L+(b<<16&4294967295|b>>>16),b=R+(D^L^S)+N[14]+4259657740&4294967295,R=D+(b<<23&4294967295|b>>>9),b=S+(R^D^L)+N[1]+2763975236&4294967295,S=R+(b<<4&4294967295|b>>>28),b=L+(S^R^D)+N[4]+1272893353&4294967295,L=S+(b<<11&4294967295|b>>>21),b=D+(L^S^R)+N[7]+4139469664&4294967295,D=L+(b<<16&4294967295|b>>>16),b=R+(D^L^S)+N[10]+3200236656&4294967295,R=D+(b<<23&4294967295|b>>>9),b=S+(R^D^L)+N[13]+681279174&4294967295,S=R+(b<<4&4294967295|b>>>28),b=L+(S^R^D)+N[0]+3936430074&4294967295,L=S+(b<<11&4294967295|b>>>21),b=D+(L^S^R)+N[3]+3572445317&4294967295,D=L+(b<<16&4294967295|b>>>16),b=R+(D^L^S)+N[6]+76029189&4294967295,R=D+(b<<23&4294967295|b>>>9),b=S+(R^D^L)+N[9]+3654602809&4294967295,S=R+(b<<4&4294967295|b>>>28),b=L+(S^R^D)+N[12]+3873151461&4294967295,L=S+(b<<11&4294967295|b>>>21),b=D+(L^S^R)+N[15]+530742520&4294967295,D=L+(b<<16&4294967295|b>>>16),b=R+(D^L^S)+N[2]+3299628645&4294967295,R=D+(b<<23&4294967295|b>>>9),b=S+(D^(R|~L))+N[0]+4096336452&4294967295,S=R+(b<<6&4294967295|b>>>26),b=L+(R^(S|~D))+N[7]+1126891415&4294967295,L=S+(b<<10&4294967295|b>>>22),b=D+(S^(L|~R))+N[14]+2878612391&4294967295,D=L+(b<<15&4294967295|b>>>17),b=R+(L^(D|~S))+N[5]+4237533241&4294967295,R=D+(b<<21&4294967295|b>>>11),b=S+(D^(R|~L))+N[12]+1700485571&4294967295,S=R+(b<<6&4294967295|b>>>26),b=L+(R^(S|~D))+N[3]+2399980690&4294967295,L=S+(b<<10&4294967295|b>>>22),b=D+(S^(L|~R))+N[10]+4293915773&4294967295,D=L+(b<<15&4294967295|b>>>17),b=R+(L^(D|~S))+N[1]+2240044497&4294967295,R=D+(b<<21&4294967295|b>>>11),b=S+(D^(R|~L))+N[8]+1873313359&4294967295,S=R+(b<<6&4294967295|b>>>26),b=L+(R^(S|~D))+N[15]+4264355552&4294967295,L=S+(b<<10&4294967295|b>>>22),b=D+(S^(L|~R))+N[6]+2734768916&4294967295,D=L+(b<<15&4294967295|b>>>17),b=R+(L^(D|~S))+N[13]+1309151649&4294967295,R=D+(b<<21&4294967295|b>>>11),b=S+(D^(R|~L))+N[4]+4149444226&4294967295,S=R+(b<<6&4294967295|b>>>26),b=L+(R^(S|~D))+N[11]+3174756917&4294967295,L=S+(b<<10&4294967295|b>>>22),b=D+(S^(L|~R))+N[2]+718787259&4294967295,D=L+(b<<15&4294967295|b>>>17),b=R+(L^(D|~S))+N[9]+3951481745&4294967295,I.g[0]=I.g[0]+S&4294967295,I.g[1]=I.g[1]+(D+(b<<21&4294967295|b>>>11))&4294967295,I.g[2]=I.g[2]+D&4294967295,I.g[3]=I.g[3]+L&4294967295}r.prototype.v=function(I,S){S===void 0&&(S=I.length);const R=S-this.blockSize,N=this.C;let D=this.h,L=0;for(;L<S;){if(D==0)for(;L<=R;)i(this,I,L),L+=this.blockSize;if(typeof I=="string"){for(;L<S;)if(N[D++]=I.charCodeAt(L++),D==this.blockSize){i(this,N),D=0;break}}else for(;L<S;)if(N[D++]=I[L++],D==this.blockSize){i(this,N),D=0;break}}this.h=D,this.o+=S},r.prototype.A=function(){var I=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);I[0]=128;for(var S=1;S<I.length-8;++S)I[S]=0;S=this.o*8;for(var R=I.length-8;R<I.length;++R)I[R]=S&255,S/=256;for(this.v(I),I=Array(16),S=0,R=0;R<4;++R)for(let N=0;N<32;N+=8)I[S++]=this.g[R]>>>N&255;return I};function s(I,S){var R=a;return Object.prototype.hasOwnProperty.call(R,I)?R[I]:R[I]=S(I)}function o(I,S){this.h=S;const R=[];let N=!0;for(let D=I.length-1;D>=0;D--){const L=I[D]|0;N&&L==S||(R[D]=L,N=!1)}this.g=R}var a={};function l(I){return-128<=I&&I<128?s(I,function(S){return new o([S|0],S<0?-1:0)}):new o([I|0],I<0?-1:0)}function u(I){if(isNaN(I)||!isFinite(I))return m;if(I<0)return M(u(-I));const S=[];let R=1;for(let N=0;I>=R;N++)S[N]=I/R|0,R*=4294967296;return new o(S,0)}function f(I,S){if(I.length==0)throw Error("number format error: empty string");if(S=S||10,S<2||36<S)throw Error("radix out of range: "+S);if(I.charAt(0)=="-")return M(f(I.substring(1),S));if(I.indexOf("-")>=0)throw Error('number format error: interior "-" character');const R=u(Math.pow(S,8));let N=m;for(let L=0;L<I.length;L+=8){var D=Math.min(8,I.length-L);const b=parseInt(I.substring(L,L+D),S);D<8?(D=u(Math.pow(S,D)),N=N.j(D).add(u(b))):(N=N.j(R),N=N.add(u(b)))}return N}var m=l(0),g=l(1),v=l(16777216);t=o.prototype,t.m=function(){if(P(this))return-M(this).m();let I=0,S=1;for(let R=0;R<this.g.length;R++){const N=this.i(R);I+=(N>=0?N:4294967296+N)*S,S*=4294967296}return I},t.toString=function(I){if(I=I||10,I<2||36<I)throw Error("radix out of range: "+I);if(T(this))return"0";if(P(this))return"-"+M(this).toString(I);const S=u(Math.pow(I,6));var R=this;let N="";for(;;){const D=V(R,S).g;R=x(R,D.j(S));let L=((R.g.length>0?R.g[0]:R.h)>>>0).toString(I);if(R=D,T(R))return L+N;for(;L.length<6;)L="0"+L;N=L+N}},t.i=function(I){return I<0?0:I<this.g.length?this.g[I]:this.h};function T(I){if(I.h!=0)return!1;for(let S=0;S<I.g.length;S++)if(I.g[S]!=0)return!1;return!0}function P(I){return I.h==-1}t.l=function(I){return I=x(this,I),P(I)?-1:T(I)?0:1};function M(I){const S=I.g.length,R=[];for(let N=0;N<S;N++)R[N]=~I.g[N];return new o(R,~I.h).add(g)}t.abs=function(){return P(this)?M(this):this},t.add=function(I){const S=Math.max(this.g.length,I.g.length),R=[];let N=0;for(let D=0;D<=S;D++){let L=N+(this.i(D)&65535)+(I.i(D)&65535),b=(L>>>16)+(this.i(D)>>>16)+(I.i(D)>>>16);N=b>>>16,L&=65535,b&=65535,R[D]=b<<16|L}return new o(R,R[R.length-1]&-2147483648?-1:0)};function x(I,S){return I.add(M(S))}t.j=function(I){if(T(this)||T(I))return m;if(P(this))return P(I)?M(this).j(M(I)):M(M(this).j(I));if(P(I))return M(this.j(M(I)));if(this.l(v)<0&&I.l(v)<0)return u(this.m()*I.m());const S=this.g.length+I.g.length,R=[];for(var N=0;N<2*S;N++)R[N]=0;for(N=0;N<this.g.length;N++)for(let D=0;D<I.g.length;D++){const L=this.i(N)>>>16,b=this.i(N)&65535,Re=I.i(D)>>>16,Ze=I.i(D)&65535;R[2*N+2*D]+=b*Ze,E(R,2*N+2*D),R[2*N+2*D+1]+=L*Ze,E(R,2*N+2*D+1),R[2*N+2*D+1]+=b*Re,E(R,2*N+2*D+1),R[2*N+2*D+2]+=L*Re,E(R,2*N+2*D+2)}for(I=0;I<S;I++)R[I]=R[2*I+1]<<16|R[2*I];for(I=S;I<2*S;I++)R[I]=0;return new o(R,0)};function E(I,S){for(;(I[S]&65535)!=I[S];)I[S+1]+=I[S]>>>16,I[S]&=65535,S++}function A(I,S){this.g=I,this.h=S}function V(I,S){if(T(S))throw Error("division by zero");if(T(I))return new A(m,m);if(P(I))return S=V(M(I),S),new A(M(S.g),M(S.h));if(P(S))return S=V(I,M(S)),new A(M(S.g),S.h);if(I.g.length>30){if(P(I)||P(S))throw Error("slowDivide_ only works with positive integers.");for(var R=g,N=S;N.l(I)<=0;)R=B(R),N=B(N);var D=G(R,1),L=G(N,1);for(N=G(N,2),R=G(R,2);!T(N);){var b=L.add(N);b.l(I)<=0&&(D=D.add(R),L=b),N=G(N,1),R=G(R,1)}return S=x(I,D.j(S)),new A(D,S)}for(D=m;I.l(S)>=0;){for(R=Math.max(1,Math.floor(I.m()/S.m())),N=Math.ceil(Math.log(R)/Math.LN2),N=N<=48?1:Math.pow(2,N-48),L=u(R),b=L.j(S);P(b)||b.l(I)>0;)R-=N,L=u(R),b=L.j(S);T(L)&&(L=g),D=D.add(L),I=x(I,b)}return new A(D,I)}t.B=function(I){return V(this,I).h},t.and=function(I){const S=Math.max(this.g.length,I.g.length),R=[];for(let N=0;N<S;N++)R[N]=this.i(N)&I.i(N);return new o(R,this.h&I.h)},t.or=function(I){const S=Math.max(this.g.length,I.g.length),R=[];for(let N=0;N<S;N++)R[N]=this.i(N)|I.i(N);return new o(R,this.h|I.h)},t.xor=function(I){const S=Math.max(this.g.length,I.g.length),R=[];for(let N=0;N<S;N++)R[N]=this.i(N)^I.i(N);return new o(R,this.h^I.h)};function B(I){const S=I.g.length+1,R=[];for(let N=0;N<S;N++)R[N]=I.i(N)<<1|I.i(N-1)>>>31;return new o(R,I.h)}function G(I,S){const R=S>>5;S%=32;const N=I.g.length-R,D=[];for(let L=0;L<N;L++)D[L]=S>0?I.i(L+R)>>>S|I.i(L+R+1)<<32-S:I.i(L+R);return new o(D,I.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,M0=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=f,Xi=o}).apply(typeof AE<"u"?AE:typeof self<"u"?self:typeof window<"u"?window:{});var Zc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var V0,Vl,L0,Sd,Gm,F0,U0,O0;(function(){var t,e=Object.defineProperty;function n(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof Zc=="object"&&Zc];for(var _=0;_<c.length;++_){var y=c[_];if(y&&y.Math==Math)return y}throw Error("Cannot find global object")}var r=n(this);function i(c,_){if(_)e:{var y=r;c=c.split(".");for(var C=0;C<c.length-1;C++){var q=c[C];if(!(q in y))break e;y=y[q]}c=c[c.length-1],C=y[c],_=_(C),_!=C&&_!=null&&e(y,c,{configurable:!0,writable:!0,value:_})}}i("Symbol.dispose",function(c){return c||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(c){return c||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(c){return c||function(_){var y=[],C;for(C in _)Object.prototype.hasOwnProperty.call(_,C)&&y.push([C,_[C]]);return y}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var s=s||{},o=this||self;function a(c){var _=typeof c;return _=="object"&&c!=null||_=="function"}function l(c,_,y){return c.call.apply(c.bind,arguments)}function u(c,_,y){return u=l,u.apply(null,arguments)}function f(c,_){var y=Array.prototype.slice.call(arguments,1);return function(){var C=y.slice();return C.push.apply(C,arguments),c.apply(this,C)}}function m(c,_){function y(){}y.prototype=_.prototype,c.Z=_.prototype,c.prototype=new y,c.prototype.constructor=c,c.Ob=function(C,q,$){for(var ie=Array(arguments.length-2),Te=2;Te<arguments.length;Te++)ie[Te-2]=arguments[Te];return _.prototype[q].apply(C,ie)}}var g=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?c=>c&&AsyncContext.Snapshot.wrap(c):c=>c;function v(c){const _=c.length;if(_>0){const y=Array(_);for(let C=0;C<_;C++)y[C]=c[C];return y}return[]}function T(c,_){for(let C=1;C<arguments.length;C++){const q=arguments[C];var y=typeof q;if(y=y!="object"?y:q?Array.isArray(q)?"array":y:"null",y=="array"||y=="object"&&typeof q.length=="number"){y=c.length||0;const $=q.length||0;c.length=y+$;for(let ie=0;ie<$;ie++)c[y+ie]=q[ie]}else c.push(q)}}class P{constructor(_,y){this.i=_,this.j=y,this.h=0,this.g=null}get(){let _;return this.h>0?(this.h--,_=this.g,this.g=_.next,_.next=null):_=this.i(),_}}function M(c){o.setTimeout(()=>{throw c},0)}function x(){var c=I;let _=null;return c.g&&(_=c.g,c.g=c.g.next,c.g||(c.h=null),_.next=null),_}class E{constructor(){this.h=this.g=null}add(_,y){const C=A.get();C.set(_,y),this.h?this.h.next=C:this.g=C,this.h=C}}var A=new P(()=>new V,c=>c.reset());class V{constructor(){this.next=this.g=this.h=null}set(_,y){this.h=_,this.g=y,this.next=null}reset(){this.next=this.g=this.h=null}}let B,G=!1,I=new E,S=()=>{const c=Promise.resolve(void 0);B=()=>{c.then(R)}};function R(){for(var c;c=x();){try{c.h.call(c.g)}catch(y){M(y)}var _=A;_.j(c),_.h<100&&(_.h++,c.next=_.g,_.g=c)}G=!1}function N(){this.u=this.u,this.C=this.C}N.prototype.u=!1,N.prototype.dispose=function(){this.u||(this.u=!0,this.N())},N.prototype[Symbol.dispose]=function(){this.dispose()},N.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function D(c,_){this.type=c,this.g=this.target=_,this.defaultPrevented=!1}D.prototype.h=function(){this.defaultPrevented=!0};var L=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var c=!1,_=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const y=()=>{};o.addEventListener("test",y,_),o.removeEventListener("test",y,_)}catch{}return c}();function b(c){return/^[\s\xa0]*$/.test(c)}function Re(c,_){D.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c&&this.init(c,_)}m(Re,D),Re.prototype.init=function(c,_){const y=this.type=c.type,C=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;this.target=c.target||c.srcElement,this.g=_,_=c.relatedTarget,_||(y=="mouseover"?_=c.fromElement:y=="mouseout"&&(_=c.toElement)),this.relatedTarget=_,C?(this.clientX=C.clientX!==void 0?C.clientX:C.pageX,this.clientY=C.clientY!==void 0?C.clientY:C.pageY,this.screenX=C.screenX||0,this.screenY=C.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=c.pointerType,this.state=c.state,this.i=c,c.defaultPrevented&&Re.Z.h.call(this)},Re.prototype.h=function(){Re.Z.h.call(this);const c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var Ze="closure_listenable_"+(Math.random()*1e6|0),Ge=0;function Se(c,_,y,C,q){this.listener=c,this.proxy=null,this.src=_,this.type=y,this.capture=!!C,this.ha=q,this.key=++Ge,this.da=this.fa=!1}function ee(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function fe(c,_,y){for(const C in c)_.call(y,c[C],C,c)}function me(c,_){for(const y in c)_.call(void 0,c[y],y,c)}function Pe(c){const _={};for(const y in c)_[y]=c[y];return _}const Oe="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Vt(c,_){let y,C;for(let q=1;q<arguments.length;q++){C=arguments[q];for(y in C)c[y]=C[y];for(let $=0;$<Oe.length;$++)y=Oe[$],Object.prototype.hasOwnProperty.call(C,y)&&(c[y]=C[y])}}function Fe(c){this.src=c,this.g={},this.h=0}Fe.prototype.add=function(c,_,y,C,q){const $=c.toString();c=this.g[$],c||(c=this.g[$]=[],this.h++);const ie=ke(c,_,C,q);return ie>-1?(_=c[ie],y||(_.fa=!1)):(_=new Se(_,this.src,$,!!C,q),_.fa=y,c.push(_)),_};function Lt(c,_){const y=_.type;if(y in c.g){var C=c.g[y],q=Array.prototype.indexOf.call(C,_,void 0),$;($=q>=0)&&Array.prototype.splice.call(C,q,1),$&&(ee(_),c.g[y].length==0&&(delete c.g[y],c.h--))}}function ke(c,_,y,C){for(let q=0;q<c.length;++q){const $=c[q];if(!$.da&&$.listener==_&&$.capture==!!y&&$.ha==C)return q}return-1}var ze="closure_lm_"+(Math.random()*1e6|0),Bt={};function Gt(c,_,y,C,q){if(Array.isArray(_)){for(let $=0;$<_.length;$++)Gt(c,_[$],y,C,q);return null}return y=Ne(y),c&&c[Ze]?c.J(_,y,a(C)?!!C.capture:!1,q):Tn(c,_,y,!1,C,q)}function Tn(c,_,y,C,q,$){if(!_)throw Error("Invalid event type");const ie=a(q)?!!q.capture:!!q;let Te=pr(c);if(Te||(c[ze]=Te=new Fe(c)),y=Te.add(_,y,C,ie,$),y.proxy)return y;if(C=Kn(),y.proxy=C,C.src=c,C.listener=y,c.addEventListener)L||(q=ie),q===void 0&&(q=!1),c.addEventListener(_.toString(),C,q);else if(c.attachEvent)c.attachEvent(rt(_.toString()),C);else if(c.addListener&&c.removeListener)c.addListener(C);else throw Error("addEventListener and attachEvent are unavailable.");return y}function Kn(){function c(y){return _.call(c.src,c.listener,y)}const _=fr;return c}function Rt(c,_,y,C,q){if(Array.isArray(_))for(var $=0;$<_.length;$++)Rt(c,_[$],y,C,q);else C=a(C)?!!C.capture:!!C,y=Ne(y),c&&c[Ze]?(c=c.i,$=String(_).toString(),$ in c.g&&(_=c.g[$],y=ke(_,y,C,q),y>-1&&(ee(_[y]),Array.prototype.splice.call(_,y,1),_.length==0&&(delete c.g[$],c.h--)))):c&&(c=pr(c))&&(_=c.g[_.toString()],c=-1,_&&(c=ke(_,y,C,q)),(y=c>-1?_[c]:null)&&ue(y))}function ue(c){if(typeof c!="number"&&c&&!c.da){var _=c.src;if(_&&_[Ze])Lt(_.i,c);else{var y=c.type,C=c.proxy;_.removeEventListener?_.removeEventListener(y,C,c.capture):_.detachEvent?_.detachEvent(rt(y),C):_.addListener&&_.removeListener&&_.removeListener(C),(y=pr(_))?(Lt(y,c),y.h==0&&(y.src=null,_[ze]=null)):ee(c)}}}function rt(c){return c in Bt?Bt[c]:Bt[c]="on"+c}function fr(c,_){if(c.da)c=!0;else{_=new Re(_,this);const y=c.listener,C=c.ha||c.src;c.fa&&ue(c),c=y.call(C,_)}return c}function pr(c){return c=c[ze],c instanceof Fe?c:null}var Jn="__closure_events_fn_"+(Math.random()*1e9>>>0);function Ne(c){return typeof c=="function"?c:(c[Jn]||(c[Jn]=function(_){return c.handleEvent(_)}),c[Jn])}function We(){N.call(this),this.i=new Fe(this),this.M=this,this.G=null}m(We,N),We.prototype[Ze]=!0,We.prototype.removeEventListener=function(c,_,y,C){Rt(this,c,_,y,C)};function $e(c,_){var y,C=c.G;if(C)for(y=[];C;C=C.G)y.push(C);if(c=c.M,C=_.type||_,typeof _=="string")_=new D(_,c);else if(_ instanceof D)_.target=_.target||c;else{var q=_;_=new D(C,c),Vt(_,q)}q=!0;let $,ie;if(y)for(ie=y.length-1;ie>=0;ie--)$=_.g=y[ie],q=fn($,C,!0,_)&&q;if($=_.g=c,q=fn($,C,!0,_)&&q,q=fn($,C,!1,_)&&q,y)for(ie=0;ie<y.length;ie++)$=_.g=y[ie],q=fn($,C,!1,_)&&q}We.prototype.N=function(){if(We.Z.N.call(this),this.i){var c=this.i;for(const _ in c.g){const y=c.g[_];for(let C=0;C<y.length;C++)ee(y[C]);delete c.g[_],c.h--}}this.G=null},We.prototype.J=function(c,_,y,C){return this.i.add(String(c),_,!1,y,C)},We.prototype.K=function(c,_,y,C){return this.i.add(String(c),_,!0,y,C)};function fn(c,_,y,C){if(_=c.i.g[String(_)],!_)return!0;_=_.concat();let q=!0;for(let $=0;$<_.length;++$){const ie=_[$];if(ie&&!ie.da&&ie.capture==y){const Te=ie.listener,Je=ie.ha||ie.src;ie.fa&&Lt(c.i,ie),q=Te.call(Je,C)!==!1&&q}}return q&&!C.defaultPrevented}function Mr(c,_){if(typeof c!="function")if(c&&typeof c.handleEvent=="function")c=u(c.handleEvent,c);else throw Error("Invalid listener argument");return Number(_)>2147483647?-1:o.setTimeout(c,_||0)}function En(c){c.g=Mr(()=>{c.g=null,c.i&&(c.i=!1,En(c))},c.l);const _=c.h;c.h=null,c.m.apply(null,_)}class Et extends N{constructor(_,y){super(),this.m=_,this.l=y,this.h=null,this.i=!1,this.g=null}j(_){this.h=arguments,this.g?this.i=!0:En(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function mr(c){N.call(this),this.h=c,this.g={}}m(mr,N);var Qn=[];function vs(c){fe(c.g,function(_,y){this.g.hasOwnProperty(y)&&ue(_)},c),c.g={}}mr.prototype.N=function(){mr.Z.N.call(this),vs(this)},mr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var _t=o.JSON.stringify,ve=o.JSON.parse,xo=class{stringify(c){return o.JSON.stringify(c,void 0)}parse(c){return o.JSON.parse(c,void 0)}};function hi(){}function wn(){}var Vn={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Ln(){D.call(this,"d")}m(Ln,D);function Ce(){D.call(this,"c")}m(Ce,D);var ce={},St=null;function Ts(){return St=St||new We}ce.Ia="serverreachability";function il(c){D.call(this,ce.Ia,c)}m(il,D);function fi(c){const _=Ts();$e(_,new il(_))}ce.STAT_EVENT="statevent";function sl(c,_){D.call(this,ce.STAT_EVENT,c),this.stat=_}m(sl,D);function qt(c){const _=Ts();$e(_,new sl(_,c))}ce.Ja="timingevent";function hc(c,_){D.call(this,ce.Ja,c),this.size=_}m(hc,D);function Es(c,_){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){c()},_)}function Vr(){this.g=!0}Vr.prototype.ua=function(){this.g=!1};function ws(c,_,y,C,q,$){c.info(function(){if(c.g)if($){var ie="",Te=$.split("&");for(let De=0;De<Te.length;De++){var Je=Te[De].split("=");if(Je.length>1){const He=Je[0];Je=Je[1];const In=He.split("_");ie=In.length>=2&&In[1]=="type"?ie+(He+"="+Je+"&"):ie+(He+"=redacted&")}}}else ie=null;else ie=$;return"XMLHTTP REQ ("+C+") [attempt "+q+"]: "+_+`
`+y+`
`+ie})}function ol(c,_,y,C,q,$,ie){c.info(function(){return"XMLHTTP RESP ("+C+") [ attempt "+q+"]: "+_+`
`+y+`
`+$+" "+ie})}function pi(c,_,y,C){c.info(function(){return"XMLHTTP TEXT ("+_+"): "+mi(c,y)+(C?" "+C:"")})}function fc(c,_){c.info(function(){return"TIMEOUT: "+_})}Vr.prototype.info=function(){};function mi(c,_){if(!c.g)return _;if(!_)return null;try{const $=JSON.parse(_);if($){for(c=0;c<$.length;c++)if(Array.isArray($[c])){var y=$[c];if(!(y.length<2)){var C=y[1];if(Array.isArray(C)&&!(C.length<1)){var q=C[0];if(q!="noop"&&q!="stop"&&q!="close")for(let ie=1;ie<C.length;ie++)C[ie]=""}}}}return _t($)}catch{return _}}var gr={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},gi={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},al;function _i(){}m(_i,hi),_i.prototype.g=function(){return new XMLHttpRequest},al=new _i;function yi(c){return encodeURIComponent(String(c))}function Rf(c){var _=1;c=c.split(":");const y=[];for(;_>0&&c.length;)y.push(c.shift()),_--;return c.length&&y.push(c.join(":")),y}function Yn(c,_,y,C){this.j=c,this.i=_,this.l=y,this.S=C||1,this.V=new mr(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Y}function Y(){this.i=null,this.g="",this.h=!1}var Is={},pc={};function mc(c,_,y){c.M=1,c.A=Ti(Xn(_)),c.u=y,c.R=!0,Pf(c,null)}function Pf(c,_){c.F=Date.now(),Ro(c),c.B=Xn(c.A);var y=c.B,C=c.S;Array.isArray(C)||(C=[String(C)]),dl(y.i,"t",C),c.C=0,y=c.j.L,c.h=new Y,c.g=W(c.j,y?_:null,!c.u),c.P>0&&(c.O=new Et(u(c.Y,c,c.g),c.P)),_=c.V,y=c.g,C=c.ba;var q="readystatechange";Array.isArray(q)||(q&&(Qn[0]=q.toString()),q=Qn);for(let $=0;$<q.length;$++){const ie=Gt(y,q[$],C||_.handleEvent,!1,_.h||_);if(!ie)break;_.g[ie.key]=ie}_=c.J?Pe(c.J):{},c.u?(c.v||(c.v="POST"),_["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.B,c.v,c.u,_)):(c.v="GET",c.g.ea(c.B,c.v,null,_)),fi(),ws(c.i,c.v,c.B,c.l,c.S,c.u)}Yn.prototype.ba=function(c){c=c.target;const _=this.O;_&&yr(c)==3?_.j():this.Y(c)},Yn.prototype.Y=function(c){try{if(c==this.g)e:{const Te=yr(this.g),Je=this.g.ya(),De=this.g.ca();if(!(Te<3)&&(Te!=3||this.g&&(this.h.h||this.g.la()||Ac(this.g)))){this.K||Te!=4||Je==7||(Je==8||De<=0?fi(3):fi(2)),Cs(this);var _=this.g.ca();this.X=_;var y=wy(this);if(this.o=_==200,ol(this.i,this.v,this.B,this.l,this.S,Te,_),this.o){if(this.U&&!this.L){t:{if(this.g){var C,q=this.g;if((C=q.g?q.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!b(C)){var $=C;break t}}$=null}if(c=$)pi(this.i,this.l,c,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,xs(this,c);else{this.o=!1,this.m=3,qt(12),Lr(this),et(this);break e}}if(this.R){c=!0;let He;for(;!this.K&&this.C<y.length;)if(He=Ao(this,y),He==pc){Te==4&&(this.m=4,qt(14),c=!1),pi(this.i,this.l,null,"[Incomplete Response]");break}else if(He==Is){this.m=4,qt(15),pi(this.i,this.l,y,"[Invalid Chunk]"),c=!1;break}else pi(this.i,this.l,He,null),xs(this,He);if(gc(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Te!=4||y.length!=0||this.h.h||(this.m=1,qt(16),c=!1),this.o=this.o&&c,!c)pi(this.i,this.l,y,"[Invalid Chunked Response]"),Lr(this),et(this);else if(y.length>0&&!this.W){this.W=!0;var ie=this.j;ie.g==this&&ie.aa&&!ie.P&&(ie.j.info("Great, no buffering proxy detected. Bytes received: "+y.length),gl(ie),ie.P=!0,qt(11))}}else pi(this.i,this.l,y,null),xs(this,y);Te==4&&Lr(this),this.o&&!this.K&&(Te==4?k(this.j,this):(this.o=!1,Ro(this)))}else Of(this.g),_==400&&y.indexOf("Unknown SID")>0?(this.m=3,qt(12)):(this.m=0,qt(13)),Lr(this),et(this)}}}catch{}finally{}};function wy(c){if(!gc(c))return c.g.la();const _=Ac(c.g);if(_==="")return"";let y="";const C=_.length,q=yr(c.g)==4;if(!c.h.i){if(typeof TextDecoder>"u")return Lr(c),et(c),"";c.h.i=new o.TextDecoder}for(let $=0;$<C;$++)c.h.h=!0,y+=c.h.i.decode(_[$],{stream:!(q&&$==C-1)});return _.length=0,c.h.g+=y,c.C=0,c.h.g}function gc(c){return c.g?c.v=="GET"&&c.M!=2&&c.j.Aa:!1}function Ao(c,_){var y=c.C,C=_.indexOf(`
`,y);return C==-1?pc:(y=Number(_.substring(y,C)),isNaN(y)?Is:(C+=1,C+y>_.length?pc:(_=_.slice(C,C+y),c.C=C+y,_)))}Yn.prototype.cancel=function(){this.K=!0,Lr(this)};function Ro(c){c.T=Date.now()+c.H,Ss(c,c.H)}function Ss(c,_){if(c.D!=null)throw Error("WatchDog timer not null");c.D=Es(u(c.aa,c),_)}function Cs(c){c.D&&(o.clearTimeout(c.D),c.D=null)}Yn.prototype.aa=function(){this.D=null;const c=Date.now();c-this.T>=0?(fc(this.i,this.B),this.M!=2&&(fi(),qt(17)),Lr(this),this.m=2,et(this)):Ss(this,this.T-c)};function et(c){c.j.I==0||c.K||k(c.j,c)}function Lr(c){Cs(c);var _=c.O;_&&typeof _.dispose=="function"&&_.dispose(),c.O=null,vs(c.V),c.g&&(_=c.g,c.g=null,_.abort(),_.dispose())}function xs(c,_){try{var y=c.j;if(y.I!=0&&(y.g==c||yc(y.h,c))){if(!c.L&&yc(y.h,c)&&y.I==3){try{var C=y.Ba.g.parse(_)}catch{C=null}if(Array.isArray(C)&&C.length==3){var q=C;if(q[0]==0){e:if(!y.v){if(y.g)if(y.g.F+3e3<c.F)w(y),Ds(y);else break e;ml(y),qt(18)}}else y.xa=q[1],0<y.xa-y.K&&q[2]<37500&&y.F&&y.A==0&&!y.C&&(y.C=Es(u(y.Va,y),6e3));Nf(y.h)<=1&&y.ta&&(y.ta=void 0)}else U(y,11)}else if((c.L||y.g==c)&&w(y),!b(_))for(q=y.Ba.g.parse(_),_=0;_<q.length;_++){let De=q[_];const He=De[0];if(!(He<=y.K))if(y.K=He,De=De[1],y.I==2)if(De[0]=="c"){y.M=De[1],y.ba=De[2];const In=De[3];In!=null&&(y.ka=In,y.j.info("VER="+y.ka));const vr=De[4];vr!=null&&(y.za=vr,y.j.info("SVER="+y.za));const Sn=De[5];Sn!=null&&typeof Sn=="number"&&Sn>0&&(C=1.5*Sn,y.O=C,y.j.info("backChannelRequestTimeoutMs_="+C)),C=y;const Tr=c.g;if(Tr){const Mc=Tr.g?Tr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Mc){var $=C.h;$.g||Mc.indexOf("spdy")==-1&&Mc.indexOf("quic")==-1&&Mc.indexOf("h2")==-1||($.j=$.l,$.g=new Set,$.h&&(ul($,$.h),$.h=null))}if(C.G){const Bf=Tr.g?Tr.g.getResponseHeader("X-HTTP-Session-Id"):null;Bf&&(C.wa=Bf,tt(C.J,C.G,Bf))}}y.I=3,y.l&&y.l.ra(),y.aa&&(y.T=Date.now()-c.F,y.j.info("Handshake RTT: "+y.T+"ms")),C=y;var ie=c;if(C.na=J(C,C.L?C.ba:null,C.W),ie.L){bf(C.h,ie);var Te=ie,Je=C.O;Je&&(Te.H=Je),Te.D&&(Cs(Te),Ro(Te)),C.g=ie}else Dc(C);y.i.length>0&&Vo(y)}else De[0]!="stop"&&De[0]!="close"||U(y,7);else y.I==3&&(De[0]=="stop"||De[0]=="close"?De[0]=="stop"?U(y,7):pl(y):De[0]!="noop"&&y.l&&y.l.qa(De),y.A=0)}}fi(4)}catch{}}var ll=class{constructor(c,_){this.g=c,this.map=_}};function _c(c){this.l=c||10,o.PerformanceNavigationTiming?(c=o.performance.getEntriesByType("navigation"),c=c.length>0&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function kf(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function Nf(c){return c.h?1:c.g?c.g.size:0}function yc(c,_){return c.h?c.h==_:c.g?c.g.has(_):!1}function ul(c,_){c.g?c.g.add(_):c.h=_}function bf(c,_){c.h&&c.h==_?c.h=null:c.g&&c.g.has(_)&&c.g.delete(_)}_c.prototype.cancel=function(){if(this.i=cl(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function cl(c){if(c.h!=null)return c.i.concat(c.h.G);if(c.g!=null&&c.g.size!==0){let _=c.i;for(const y of c.g.values())_=_.concat(y.G);return _}return v(c.i)}var Po=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Df(c,_){if(c){c=c.split("&");for(let y=0;y<c.length;y++){const C=c[y].indexOf("=");let q,$=null;C>=0?(q=c[y].substring(0,C),$=c[y].substring(C+1)):q=c[y],_(q,$?decodeURIComponent($.replace(/\+/g," ")):"")}}}function Fn(c){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let _;c instanceof Fn?(this.l=c.l,ko(this,c.j),this.o=c.o,this.g=c.g,vi(this,c.u),this.h=c.h,No(this,vc(c.i)),this.m=c.m):c&&(_=String(c).match(Po))?(this.l=!1,ko(this,_[1]||"",!0),this.o=As(_[2]||""),this.g=As(_[3]||"",!0),vi(this,_[4]),this.h=As(_[5]||"",!0),No(this,_[6]||"",!0),this.m=As(_[7]||"")):(this.l=!1,this.i=new Ur(null,this.l))}Fn.prototype.toString=function(){const c=[];var _=this.j;_&&c.push(Rs(_,bo,!0),":");var y=this.g;return(y||_=="file")&&(c.push("//"),(_=this.o)&&c.push(Rs(_,bo,!0),"@"),c.push(yi(y).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y=this.u,y!=null&&c.push(":",String(y))),(y=this.h)&&(this.g&&y.charAt(0)!="/"&&c.push("/"),c.push(Rs(y,y.charAt(0)=="/"?re:Mf,!0))),(y=this.i.toString())&&c.push("?",y),(y=this.m)&&c.push("#",Rs(y,Vf)),c.join("")},Fn.prototype.resolve=function(c){const _=Xn(this);let y=!!c.j;y?ko(_,c.j):y=!!c.o,y?_.o=c.o:y=!!c.g,y?_.g=c.g:y=c.u!=null;var C=c.h;if(y)vi(_,c.u);else if(y=!!c.h){if(C.charAt(0)!="/")if(this.g&&!this.h)C="/"+C;else{var q=_.h.lastIndexOf("/");q!=-1&&(C=_.h.slice(0,q+1)+C)}if(q=C,q==".."||q==".")C="";else if(q.indexOf("./")!=-1||q.indexOf("/.")!=-1){C=q.lastIndexOf("/",0)==0,q=q.split("/");const $=[];for(let ie=0;ie<q.length;){const Te=q[ie++];Te=="."?C&&ie==q.length&&$.push(""):Te==".."?(($.length>1||$.length==1&&$[0]!="")&&$.pop(),C&&ie==q.length&&$.push("")):($.push(Te),C=!0)}C=$.join("/")}else C=q}return y?_.h=C:y=c.i.toString()!=="",y?No(_,vc(c.i)):y=!!c.m,y&&(_.m=c.m),_};function Xn(c){return new Fn(c)}function ko(c,_,y){c.j=y?As(_,!0):_,c.j&&(c.j=c.j.replace(/:$/,""))}function vi(c,_){if(_){if(_=Number(_),isNaN(_)||_<0)throw Error("Bad port number "+_);c.u=_}else c.u=null}function No(c,_,y){_ instanceof Ur?(c.i=_,Lf(c.i,c.l)):(y||(_=Rs(_,Fr)),c.i=new Ur(_,c.l))}function tt(c,_,y){c.i.set(_,y)}function Ti(c){return tt(c,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),c}function As(c,_){return c?_?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function Rs(c,_,y){return typeof c=="string"?(c=encodeURI(c).replace(_,Ps),y&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function Ps(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var bo=/[#\/\?@]/g,Mf=/[#\?:]/g,re=/[#\?]/g,Fr=/[#\?@]/g,Vf=/#/g;function Ur(c,_){this.h=this.g=null,this.i=c||null,this.j=!!_}function Or(c){c.g||(c.g=new Map,c.h=0,c.i&&Df(c.i,function(_,y){c.add(decodeURIComponent(_.replace(/\+/g," ")),y)}))}t=Ur.prototype,t.add=function(c,_){Or(this),this.i=null,c=Br(this,c);let y=this.g.get(c);return y||this.g.set(c,y=[]),y.push(_),this.h+=1,this};function Ei(c,_){Or(c),_=Br(c,_),c.g.has(_)&&(c.i=null,c.h-=c.g.get(_).length,c.g.delete(_))}function wi(c,_){return Or(c),_=Br(c,_),c.g.has(_)}t.forEach=function(c,_){Or(this),this.g.forEach(function(y,C){y.forEach(function(q){c.call(_,q,C,this)},this)},this)};function ks(c,_){Or(c);let y=[];if(typeof _=="string")wi(c,_)&&(y=y.concat(c.g.get(Br(c,_))));else for(c=Array.from(c.g.values()),_=0;_<c.length;_++)y=y.concat(c[_]);return y}t.set=function(c,_){return Or(this),this.i=null,c=Br(this,c),wi(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[_]),this.h+=1,this},t.get=function(c,_){return c?(c=ks(this,c),c.length>0?String(c[0]):_):_};function dl(c,_,y){Ei(c,_),y.length>0&&(c.i=null,c.g.set(Br(c,_),v(y)),c.h+=y.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],_=Array.from(this.g.keys());for(let C=0;C<_.length;C++){var y=_[C];const q=yi(y);y=ks(this,y);for(let $=0;$<y.length;$++){let ie=q;y[$]!==""&&(ie+="="+yi(y[$])),c.push(ie)}}return this.i=c.join("&")};function vc(c){const _=new Ur;return _.i=c.i,c.g&&(_.g=new Map(c.g),_.h=c.h),_}function Br(c,_){return _=String(_),c.j&&(_=_.toLowerCase()),_}function Lf(c,_){_&&!c.j&&(Or(c),c.i=null,c.g.forEach(function(y,C){const q=C.toLowerCase();C!=q&&(Ei(this,C),dl(this,q,y))},c)),c.j=_}function Ff(c,_){const y=new Vr;if(o.Image){const C=new Image;C.onload=f(_r,y,"TestLoadImage: loaded",!0,_,C),C.onerror=f(_r,y,"TestLoadImage: error",!1,_,C),C.onabort=f(_r,y,"TestLoadImage: abort",!1,_,C),C.ontimeout=f(_r,y,"TestLoadImage: timeout",!1,_,C),o.setTimeout(function(){C.ontimeout&&C.ontimeout()},1e4),C.src=c}else _(!1)}function Tc(c,_){const y=new Vr,C=new AbortController,q=setTimeout(()=>{C.abort(),_r(y,"TestPingServer: timeout",!1,_)},1e4);fetch(c,{signal:C.signal}).then($=>{clearTimeout(q),$.ok?_r(y,"TestPingServer: ok",!0,_):_r(y,"TestPingServer: server error",!1,_)}).catch(()=>{clearTimeout(q),_r(y,"TestPingServer: error",!1,_)})}function _r(c,_,y,C,q){try{q&&(q.onload=null,q.onerror=null,q.onabort=null,q.ontimeout=null),C(y)}catch{}}function Ec(){this.g=new xo}function Do(c){this.i=c.Sb||null,this.h=c.ab||!1}m(Do,hi),Do.prototype.g=function(){return new Ii(this.i,this.h)};function Ii(c,_){We.call(this),this.H=c,this.o=_,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}m(Ii,We),t=Ii.prototype,t.open=function(c,_){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=c,this.D=_,this.readyState=1,Gr(this)},t.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const _={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};c&&(_.body=c),(this.H||o).fetch(new Request(this.D,_)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Ns(this)),this.readyState=0},t.Pa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,Gr(this)),this.g&&(this.readyState=3,Gr(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;hl(this)}else c.text().then(this.Oa.bind(this),this.ga.bind(this))};function hl(c){c.j.read().then(c.Ma.bind(c)).catch(c.ga.bind(c))}t.Ma=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var _=c.value?c.value:new Uint8Array(0);(_=this.B.decode(_,{stream:!c.done}))&&(this.response=this.responseText+=_)}c.done?Ns(this):Gr(this),this.readyState==3&&hl(this)}},t.Oa=function(c){this.g&&(this.response=this.responseText=c,Ns(this))},t.Na=function(c){this.g&&(this.response=c,Ns(this))},t.ga=function(){this.g&&Ns(this)};function Ns(c){c.readyState=4,c.l=null,c.j=null,c.B=null,Gr(c)}t.setRequestHeader=function(c,_){this.A.append(c,_)},t.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],_=this.h.entries();for(var y=_.next();!y.done;)y=y.value,c.push(y[0]+": "+y[1]),y=_.next();return c.join(`\r
`)};function Gr(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(Ii.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function wc(c){let _="";return fe(c,function(y,C){_+=C,_+=":",_+=y,_+=`\r
`}),_}function fl(c,_,y){e:{for(C in y){var C=!1;break e}C=!0}C||(y=wc(y),typeof c=="string"?y!=null&&yi(y):tt(c,_,y))}function it(c){We.call(this),this.headers=new Map,this.L=c||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}m(it,We);var Ic=/^https?$/i,Uf=["POST","PUT"];t=it.prototype,t.Fa=function(c){this.H=c},t.ea=function(c,_,y,C){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);_=_?_.toUpperCase():"GET",this.D=c,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():al.g(),this.g.onreadystatechange=g(u(this.Ca,this));try{this.B=!0,this.g.open(_,String(c),!0),this.B=!1}catch($){Sc(this,$);return}if(c=y||"",y=new Map(this.headers),C)if(Object.getPrototypeOf(C)===Object.prototype)for(var q in C)y.set(q,C[q]);else if(typeof C.keys=="function"&&typeof C.get=="function")for(const $ of C.keys())y.set($,C.get($));else throw Error("Unknown input type for opt_headers: "+String(C));C=Array.from(y.keys()).find($=>$.toLowerCase()=="content-type"),q=o.FormData&&c instanceof o.FormData,!(Array.prototype.indexOf.call(Uf,_,void 0)>=0)||C||q||y.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[$,ie]of y)this.g.setRequestHeader($,ie);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(c),this.v=!1}catch($){Sc(this,$)}};function Sc(c,_){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=_,c.o=5,Cc(c),Mo(c)}function Cc(c){c.A||(c.A=!0,$e(c,"complete"),$e(c,"error"))}t.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=c||7,$e(this,"complete"),$e(this,"abort"),Mo(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Mo(this,!0)),it.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?xc(this):this.Xa())},t.Xa=function(){xc(this)};function xc(c){if(c.h&&typeof s<"u"){if(c.v&&yr(c)==4)setTimeout(c.Ca.bind(c),0);else if($e(c,"readystatechange"),yr(c)==4){c.h=!1;try{const $=c.ca();e:switch($){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var _=!0;break e;default:_=!1}var y;if(!(y=_)){var C;if(C=$===0){let ie=String(c.D).match(Po)[1]||null;!ie&&o.self&&o.self.location&&(ie=o.self.location.protocol.slice(0,-1)),C=!Ic.test(ie?ie.toLowerCase():"")}y=C}if(y)$e(c,"complete"),$e(c,"success");else{c.o=6;try{var q=yr(c)>2?c.g.statusText:""}catch{q=""}c.l=q+" ["+c.ca()+"]",Cc(c)}}finally{Mo(c)}}}}function Mo(c,_){if(c.g){c.m&&(clearTimeout(c.m),c.m=null);const y=c.g;c.g=null,_||$e(c,"ready");try{y.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function yr(c){return c.g?c.g.readyState:0}t.ca=function(){try{return yr(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(c){if(this.g){var _=this.g.responseText;return c&&_.indexOf(c)==0&&(_=_.substring(c.length)),ve(_)}};function Ac(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.F){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function Of(c){const _={};c=(c.g&&yr(c)>=2&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let C=0;C<c.length;C++){if(b(c[C]))continue;var y=Rf(c[C]);const q=y[0];if(y=y[1],typeof y!="string")continue;y=y.trim();const $=_[q]||[];_[q]=$,$.push(y)}me(_,function(C){return C.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function bs(c,_,y){return y&&y.internalChannelParams&&y.internalChannelParams[c]||_}function Rc(c){this.za=0,this.i=[],this.j=new Vr,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=bs("failFast",!1,c),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=bs("baseRetryDelayMs",5e3,c),this.Za=bs("retryDelaySeedMs",1e4,c),this.Ta=bs("forwardChannelMaxRetries",2,c),this.va=bs("forwardChannelRequestTimeoutMs",2e4,c),this.ma=c&&c.xmlHttpFactory||void 0,this.Ua=c&&c.Rb||void 0,this.Aa=c&&c.useFetchStreams||!1,this.O=void 0,this.L=c&&c.supportsCrossDomainXhr||!1,this.M="",this.h=new _c(c&&c.concurrentRequestLimit),this.Ba=new Ec,this.S=c&&c.fastHandshake||!1,this.R=c&&c.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=c&&c.Pb||!1,c&&c.ua&&this.j.ua(),c&&c.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&c&&c.detectBufferingProxy||!1,this.ia=void 0,c&&c.longPollingTimeout&&c.longPollingTimeout>0&&(this.ia=c.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=Rc.prototype,t.ka=8,t.I=1,t.connect=function(c,_,y,C){qt(0),this.W=c,this.H=_||{},y&&C!==void 0&&(this.H.OSID=y,this.H.OAID=C),this.F=this.X,this.J=J(this,null,this.W),Vo(this)};function pl(c){if(Pc(c),c.I==3){var _=c.V++,y=Xn(c.J);if(tt(y,"SID",c.M),tt(y,"RID",_),tt(y,"TYPE","terminate"),Ms(c,y),_=new Yn(c,c.j,_),_.M=2,_.A=Ti(Xn(y)),y=!1,o.navigator&&o.navigator.sendBeacon)try{y=o.navigator.sendBeacon(_.A.toString(),"")}catch{}!y&&o.Image&&(new Image().src=_.A,y=!0),y||(_.g=W(_.j,null),_.g.ea(_.A)),_.F=Date.now(),Ro(_)}H(c)}function Ds(c){c.g&&(gl(c),c.g.cancel(),c.g=null)}function Pc(c){Ds(c),c.v&&(o.clearTimeout(c.v),c.v=null),w(c),c.h.cancel(),c.m&&(typeof c.m=="number"&&o.clearTimeout(c.m),c.m=null)}function Vo(c){if(!kf(c.h)&&!c.m){c.m=!0;var _=c.Ea;B||S(),G||(B(),G=!0),I.add(_,c),c.D=0}}function kc(c,_){return Nf(c.h)>=c.h.j-(c.m?1:0)?!1:c.m?(c.i=_.G.concat(c.i),!0):c.I==1||c.I==2||c.D>=(c.Sa?0:c.Ta)?!1:(c.m=Es(u(c.Ea,c,_),F(c,c.D)),c.D++,!0)}t.Ea=function(c){if(this.m)if(this.m=null,this.I==1){if(!c){this.V=Math.floor(Math.random()*1e5),c=this.V++;const q=new Yn(this,this.j,c);let $=this.o;if(this.U&&($?($=Pe($),Vt($,this.U)):$=this.U),this.u!==null||this.R||(q.J=$,$=null),this.S)e:{for(var _=0,y=0;y<this.i.length;y++){t:{var C=this.i[y];if("__data__"in C.map&&(C=C.map.__data__,typeof C=="string")){C=C.length;break t}C=void 0}if(C===void 0)break;if(_+=C,_>4096){_=y;break e}if(_===4096||y===this.i.length-1){_=y+1;break e}}_=1e3}else _=1e3;_=bc(this,q,_),y=Xn(this.J),tt(y,"RID",c),tt(y,"CVER",22),this.G&&tt(y,"X-HTTP-Session-Id",this.G),Ms(this,y),$&&(this.R?_="headers="+yi(wc($))+"&"+_:this.u&&fl(y,this.u,$)),ul(this.h,q),this.Ra&&tt(y,"TYPE","init"),this.S?(tt(y,"$req",_),tt(y,"SID","null"),q.U=!0,mc(q,y,null)):mc(q,y,_),this.I=2}}else this.I==3&&(c?Nc(this,c):this.i.length==0||kf(this.h)||Nc(this))};function Nc(c,_){var y;_?y=_.l:y=c.V++;const C=Xn(c.J);tt(C,"SID",c.M),tt(C,"RID",y),tt(C,"AID",c.K),Ms(c,C),c.u&&c.o&&fl(C,c.u,c.o),y=new Yn(c,c.j,y,c.D+1),c.u===null&&(y.J=c.o),_&&(c.i=_.G.concat(c.i)),_=bc(c,y,1e3),y.H=Math.round(c.va*.5)+Math.round(c.va*.5*Math.random()),ul(c.h,y),mc(y,C,_)}function Ms(c,_){c.H&&fe(c.H,function(y,C){tt(_,C,y)}),c.l&&fe({},function(y,C){tt(_,C,y)})}function bc(c,_,y){y=Math.min(c.i.length,y);const C=c.l?u(c.l.Ka,c.l,c):null;e:{var q=c.i;let Te=-1;for(;;){const Je=["count="+y];Te==-1?y>0?(Te=q[0].g,Je.push("ofs="+Te)):Te=0:Je.push("ofs="+Te);let De=!0;for(let He=0;He<y;He++){var $=q[He].g;const In=q[He].map;if($-=Te,$<0)Te=Math.max(0,q[He].g-100),De=!1;else try{$="req"+$+"_"||"";try{var ie=In instanceof Map?In:Object.entries(In);for(const[vr,Sn]of ie){let Tr=Sn;a(Sn)&&(Tr=_t(Sn)),Je.push($+vr+"="+encodeURIComponent(Tr))}}catch(vr){throw Je.push($+"type="+encodeURIComponent("_badmap")),vr}}catch{C&&C(In)}}if(De){ie=Je.join("&");break e}}ie=void 0}return c=c.i.splice(0,y),_.G=c,ie}function Dc(c){if(!c.g&&!c.v){c.Y=1;var _=c.Da;B||S(),G||(B(),G=!0),I.add(_,c),c.A=0}}function ml(c){return c.g||c.v||c.A>=3?!1:(c.Y++,c.v=Es(u(c.Da,c),F(c,c.A)),c.A++,!0)}t.Da=function(){if(this.v=null,Lo(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var c=4*this.T;this.j.info("BP detection timer enabled: "+c),this.B=Es(u(this.Wa,this),c)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,qt(10),Ds(this),Lo(this))};function gl(c){c.B!=null&&(o.clearTimeout(c.B),c.B=null)}function Lo(c){c.g=new Yn(c,c.j,"rpc",c.Y),c.u===null&&(c.g.J=c.o),c.g.P=0;var _=Xn(c.na);tt(_,"RID","rpc"),tt(_,"SID",c.M),tt(_,"AID",c.K),tt(_,"CI",c.F?"0":"1"),!c.F&&c.ia&&tt(_,"TO",c.ia),tt(_,"TYPE","xmlhttp"),Ms(c,_),c.u&&c.o&&fl(_,c.u,c.o),c.O&&(c.g.H=c.O);var y=c.g;c=c.ba,y.M=1,y.A=Ti(Xn(_)),y.u=null,y.R=!0,Pf(y,c)}t.Va=function(){this.C!=null&&(this.C=null,Ds(this),ml(this),qt(19))};function w(c){c.C!=null&&(o.clearTimeout(c.C),c.C=null)}function k(c,_){var y=null;if(c.g==_){w(c),gl(c),c.g=null;var C=2}else if(yc(c.h,_))y=_.G,bf(c.h,_),C=1;else return;if(c.I!=0){if(_.o)if(C==1){y=_.u?_.u.length:0,_=Date.now()-_.F;var q=c.D;C=Ts(),$e(C,new hc(C,y)),Vo(c)}else Dc(c);else if(q=_.m,q==3||q==0&&_.X>0||!(C==1&&kc(c,_)||C==2&&ml(c)))switch(y&&y.length>0&&(_=c.h,_.i=_.i.concat(y)),q){case 1:U(c,5);break;case 4:U(c,10);break;case 3:U(c,6);break;default:U(c,2)}}}function F(c,_){let y=c.Qa+Math.floor(Math.random()*c.Za);return c.isActive()||(y*=2),y*_}function U(c,_){if(c.j.info("Error code "+_),_==2){var y=u(c.bb,c),C=c.Ua;const q=!C;C=new Fn(C||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||ko(C,"https"),Ti(C),q?Ff(C.toString(),y):Tc(C.toString(),y)}else qt(2);c.I=0,c.l&&c.l.pa(_),H(c),Pc(c)}t.bb=function(c){c?(this.j.info("Successfully pinged google.com"),qt(2)):(this.j.info("Failed to ping google.com"),qt(1))};function H(c){if(c.I=0,c.ja=[],c.l){const _=cl(c.h);(_.length!=0||c.i.length!=0)&&(T(c.ja,_),T(c.ja,c.i),c.h.i.length=0,v(c.i),c.i.length=0),c.l.oa()}}function J(c,_,y){var C=y instanceof Fn?Xn(y):new Fn(y);if(C.g!="")_&&(C.g=_+"."+C.g),vi(C,C.u);else{var q=o.location;C=q.protocol,_=_?_+"."+q.hostname:q.hostname,q=+q.port;const $=new Fn(null);C&&ko($,C),_&&($.g=_),q&&vi($,q),y&&($.h=y),C=$}return y=c.G,_=c.wa,y&&_&&tt(C,y,_),tt(C,"VER",c.ka),Ms(c,C),C}function W(c,_,y){if(_&&!c.L)throw Error("Can't create secondary domain capable XhrIo object.");return _=c.Aa&&!c.ma?new it(new Do({ab:y})):new it(c.ma),_.Fa(c.L),_}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function X(){}t=X.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function j(){}j.prototype.g=function(c,_){return new Z(c,_)};function Z(c,_){We.call(this),this.g=new Rc(_),this.l=c,this.h=_&&_.messageUrlParams||null,c=_&&_.messageHeaders||null,_&&_.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=_&&_.initMessageHeaders||null,_&&_.messageContentType&&(c?c["X-WebChannel-Content-Type"]=_.messageContentType:c={"X-WebChannel-Content-Type":_.messageContentType}),_&&_.sa&&(c?c["X-WebChannel-Client-Profile"]=_.sa:c={"X-WebChannel-Client-Profile":_.sa}),this.g.U=c,(c=_&&_.Qb)&&!b(c)&&(this.g.u=c),this.A=_&&_.supportsCrossDomainXhr||!1,this.v=_&&_.sendRawJson||!1,(_=_&&_.httpSessionIdParam)&&!b(_)&&(this.g.G=_,c=this.h,c!==null&&_ in c&&(c=this.h,_ in c&&delete c[_])),this.j=new ae(this)}m(Z,We),Z.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Z.prototype.close=function(){pl(this.g)},Z.prototype.o=function(c){var _=this.g;if(typeof c=="string"){var y={};y.__data__=c,c=y}else this.v&&(y={},y.__data__=_t(c),c=y);_.i.push(new ll(_.Ya++,c)),_.I==3&&Vo(_)},Z.prototype.N=function(){this.g.l=null,delete this.j,pl(this.g),delete this.g,Z.Z.N.call(this)};function K(c){Ln.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var _=c.__sm__;if(_){e:{for(const y in _){c=y;break e}c=void 0}(this.i=c)&&(c=this.i,_=_!==null&&c in _?_[c]:void 0),this.data=_}else this.data=c}m(K,Ln);function pe(){Ce.call(this),this.status=1}m(pe,Ce);function ae(c){this.g=c}m(ae,X),ae.prototype.ra=function(){$e(this.g,"a")},ae.prototype.qa=function(c){$e(this.g,new K(c))},ae.prototype.pa=function(c){$e(this.g,new pe)},ae.prototype.oa=function(){$e(this.g,"b")},j.prototype.createWebChannel=j.prototype.g,Z.prototype.send=Z.prototype.o,Z.prototype.open=Z.prototype.m,Z.prototype.close=Z.prototype.close,O0=function(){return new j},U0=function(){return Ts()},F0=ce,Gm={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},gr.NO_ERROR=0,gr.TIMEOUT=8,gr.HTTP_ERROR=6,Sd=gr,gi.COMPLETE="complete",L0=gi,wn.EventType=Vn,Vn.OPEN="a",Vn.CLOSE="b",Vn.ERROR="c",Vn.MESSAGE="d",We.prototype.listen=We.prototype.J,Vl=wn,it.prototype.listenOnce=it.prototype.K,it.prototype.getLastError=it.prototype.Ha,it.prototype.getLastErrorCode=it.prototype.ya,it.prototype.getStatus=it.prototype.ca,it.prototype.getResponseJson=it.prototype.La,it.prototype.getResponseText=it.prototype.la,it.prototype.send=it.prototype.ea,it.prototype.setWithCredentials=it.prototype.Fa,V0=it}).apply(typeof Zc<"u"?Zc:typeof self<"u"?self:typeof window<"u"?window:{});const RE="@firebase/firestore",PE="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ht{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ht.UNAUTHENTICATED=new Ht(null),Ht.GOOGLE_CREDENTIALS=new Ht("google-credentials-uid"),Ht.FIRST_PARTY=new Ht("first-party-uid"),Ht.MOCK_USER=new Ht("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tl="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const is=new y_("@firebase/firestore");function $o(){return is.logLevel}function B0(t){is.setLogLevel(t)}function te(t,...e){if(is.logLevel<=Me.DEBUG){const n=e.map(N_);is.debug(`Firestore (${tl}): ${t}`,...n)}}function on(t,...e){if(is.logLevel<=Me.ERROR){const n=e.map(N_);is.error(`Firestore (${tl}): ${t}`,...n)}}function ss(t,...e){if(is.logLevel<=Me.WARN){const n=e.map(N_);is.warn(`Firestore (${tl}): ${t}`,...n)}}function N_(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function he(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,G0(t,r,n)}function G0(t,e,n){let r=`FIRESTORE (${tl}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw on(r),new Error(r)}function _e(t,e,n,r){let i="Unexpected state";typeof n=="string"?i=n:r=n,t||G0(e,i,r)}function Ie(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class se extends ui{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kr{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q0{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class z0{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Ht.UNAUTHENTICATED))}shutdown(){}}class YF{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class XF{constructor(e){this.t=e,this.currentUser=Ht.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){_e(this.o===void 0,42304);let r=this.i;const i=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let s=new kr;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new kr,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},a=l=>{te("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(te("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new kr)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(te("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(_e(typeof r.accessToken=="string",31837,{l:r}),new q0(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return _e(e===null||typeof e=="string",2055,{h:e}),new Ht(e)}}class ZF{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=Ht.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class eU{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new ZF(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(Ht.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class kE{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class tU{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,ir(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){_e(this.o===void 0,3512);const r=s=>{s.error!=null&&te("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,te("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{te("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):te("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new kE(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(_e(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new kE(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nU(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sf{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=nU(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%62))}return r}}function we(t,e){return t<e?-1:t>e?1:0}function qm(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const i=t.charAt(r),s=e.charAt(r);if(i!==s)return Ep(i)===Ep(s)?we(i,s):Ep(i)?1:-1}return we(t.length,e.length)}const rU=55296,iU=57343;function Ep(t){const e=t.charCodeAt(0);return e>=rU&&e<=iU}function Na(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function $0(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NE="__name__";class Ir{constructor(e,n,r){n===void 0?n=0:n>e.length&&he(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&he(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Ir.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Ir?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=Ir.compareSegments(e.get(i),n.get(i));if(s!==0)return s}return we(e.length,n.length)}static compareSegments(e,n){const r=Ir.isNumericId(e),i=Ir.isNumericId(n);return r&&!i?-1:!r&&i?1:r&&i?Ir.extractNumericId(e).compare(Ir.extractNumericId(n)):qm(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Xi.fromString(e.substring(4,e.length-2))}}class je extends Ir{construct(e,n,r){return new je(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new se(Q.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new je(n)}static emptyPath(){return new je([])}}const sU=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class dt extends Ir{construct(e,n,r){return new dt(e,n,r)}static isValidIdentifier(e){return sU.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),dt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===NE}static keyField(){return new dt([NE])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new se(Q.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new se(Q.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new se(Q.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new se(Q.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new dt(n)}static emptyPath(){return new dt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oe{constructor(e){this.path=e}static fromPath(e){return new oe(je.fromString(e))}static fromName(e){return new oe(je.fromString(e).popFirst(5))}static empty(){return new oe(je.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&je.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return je.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new oe(new je(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H0(t,e,n){if(!n)throw new se(Q.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function j0(t,e,n,r){if(e===!0&&r===!0)throw new se(Q.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function bE(t){if(!oe.isDocumentKey(t))throw new se(Q.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function DE(t){if(oe.isDocumentKey(t))throw new se(Q.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function W0(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function of(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":he(12329,{type:typeof t})}function un(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new se(Q.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=of(t);throw new se(Q.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function At(t,e){const n={typeString:t};return e&&(n.value=e),n}function Yu(t,e){if(!W0(t))throw new se(Q.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(i&&typeof o!==i){n=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&o!==s.value){n=`Expected '${r}' field to equal '${s.value}'`;break}}if(n)throw new se(Q.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ME=-62135596800,VE=1e6;class Ke{static now(){return Ke.fromMillis(Date.now())}static fromDate(e){return Ke.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*VE);return new Ke(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new se(Q.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new se(Q.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<ME)throw new se(Q.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new se(Q.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/VE}_compareTo(e){return this.seconds===e.seconds?we(this.nanoseconds,e.nanoseconds):we(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Ke._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Yu(e,Ke._jsonSchema))return new Ke(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-ME;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Ke._jsonSchemaVersion="firestore/timestamp/1.0",Ke._jsonSchema={type:At("string",Ke._jsonSchemaVersion),seconds:At("number"),nanoseconds:At("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ye{static fromTimestamp(e){return new ye(e)}static min(){return new ye(new Ke(0,0))}static max(){return new ye(new Ke(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ru=-1;class gh{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}}function zm(t){return t.fields.find(e=>e.kind===2)}function Gs(t){return t.fields.filter(e=>e.kind!==2)}gh.UNKNOWN_ID=-1;class Cd{constructor(e,n){this.fieldPath=e,this.kind=n}}class Pu{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new Pu(0,bn.min())}}function oU(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=ye.fromTimestamp(r===1e9?new Ke(n+1,0):new Ke(n,r));return new bn(i,oe.empty(),e)}function K0(t){return new bn(t.readTime,t.key,Ru)}class bn{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new bn(ye.min(),oe.empty(),Ru)}static max(){return new bn(ye.max(),oe.empty(),Ru)}}function b_(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=oe.comparator(t.documentKey,e.documentKey),n!==0?n:we(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J0="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Q0{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Io(t){if(t.code!==Q.FAILED_PRECONDITION||t.message!==J0)throw t;te("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&he(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new z((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof z?n:z.resolve(n)}catch(n){return z.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):z.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):z.reject(n)}static resolve(e){return new z((n,r)=>{n(e)})}static reject(e){return new z((n,r)=>{r(e)})}static waitFor(e){return new z((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},l=>r(l))}),o=!0,s===i&&n()})}static or(e){let n=z.resolve(!1);for(const r of e)n=n.next(i=>i?z.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new z((r,i)=>{const s=e.length,o=new Array(s);let a=0;for(let l=0;l<s;l++){const u=l;n(e[u]).next(f=>{o[u]=f,++a,a===s&&r(o)},f=>i(f))}})}static doWhile(e,n){return new z((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xn="SimpleDb";class af{static open(e,n,r,i){try{return new af(n,e.transaction(i,r))}catch(s){throw new Zl(n,s)}}constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.S=new kr,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{n.error?this.S.reject(new Zl(e,n.error)):this.S.resolve()},this.transaction.onerror=r=>{const i=D_(r.target.error);this.S.reject(new Zl(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(te(xn,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new lU(n)}}class Zi{static delete(e){return te(xn,"Removing database:",e),$s(GC().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!QC())return!1;if(Zi.F())return!0;const e=bt(),n=Zi.M(e),r=0<n&&n<10,i=Y0(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)==null?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)==="YES"}static O(e,n){return e.store(n)}static M(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,n,r){this.name=e,this.version=n,this.N=r,this.B=null,Zi.M(bt())===12.2&&on("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(te(xn,"Opening database:",this.name),this.db=await new Promise((n,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const o=s.target.result;n(o)},i.onblocked=()=>{r(new Zl(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const o=s.target.error;o.name==="VersionError"?r(new se(Q.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new se(Q.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Zl(e,o))},i.onupgradeneeded=s=>{te(xn,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.N.k(o,i.transaction,s.oldVersion,this.version).next(()=>{te(xn,"Database upgrade to version "+this.version+" complete")})}})),this.q&&(this.db.onversionchange=n=>this.q(n)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,i){const s=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const a=af.open(this.db,e,s?"readonly":"readwrite",r),l=i(a).next(u=>(a.C(),u)).catch(u=>(a.abort(u),z.reject(u))).toPromise();return l.catch(()=>{}),await a.D,l}catch(a){const l=a,u=l.name!=="FirebaseError"&&o<3;if(te(xn,"Transaction failed with error:",l.message,"Retrying:",u),this.close(),!u)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function Y0(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class aU{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return $s(this.U.delete())}}class Zl extends se{constructor(e,n){super(Q.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function ms(t){return t.name==="IndexedDbTransactionError"}class lU{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(te(xn,"PUT",this.store.name,e,n),r=this.store.put(n,e)):(te(xn,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),$s(r)}add(e){return te(xn,"ADD",this.store.name,e,e),$s(this.store.add(e))}get(e){return $s(this.store.get(e)).next(n=>(n===void 0&&(n=null),te(xn,"GET",this.store.name,e,n),n))}delete(e){return te(xn,"DELETE",this.store.name,e),$s(this.store.delete(e))}count(){return te(xn,"COUNT",this.store.name),$s(this.store.count())}J(e,n){const r=this.options(e,n),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const s=i.getAll(r.range);return new z((o,a)=>{s.onerror=l=>{a(l.target.error)},s.onsuccess=l=>{o(l.target.result)}})}{const s=this.cursor(r),o=[];return this.H(s,(a,l)=>{o.push(l)}).next(()=>o)}}Y(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new z((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}Z(e,n){te(xn,"DELETE ALL",this.store.name);const r=this.options(e,n);r.X=!1;const i=this.cursor(r);return this.H(i,(s,o,a)=>a.delete())}ee(e,n){let r;n?r=e:(r={},n=e);const i=this.cursor(r);return this.H(i,n)}te(e){const n=this.cursor({});return new z((r,i)=>{n.onerror=s=>{const o=D_(s.target.error);i(o)},n.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}H(e,n){const r=[];return new z((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void i();const l=new aU(a),u=n(a.primaryKey,a.value,l);if(u instanceof z){const f=u.catch(m=>(l.done(),z.reject(m)));r.push(f)}l.isDone?i():l.G===null?a.continue():a.continue(l.G)}}).next(()=>z.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function $s(t){return new z((e,n)=>{t.onsuccess=r=>{const i=r.target.result;e(i)},t.onerror=r=>{const i=D_(r.target.error);n(i)}})}let LE=!1;function D_(t){const e=Zi.M(bt());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new se("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return LE||(LE=!0,setTimeout(()=>{throw r},0)),r}}return t}const eu="IndexBackfiller";class uU{constructor(e,n){this.asyncQueue=e,this.ne=n,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){te(eu,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const n=await this.ne.ie();te(eu,`Documents written: ${n}`)}catch(n){ms(n)?te(eu,"Ignoring IndexedDB error during index backfill: ",n):await Io(n)}await this.re(6e4)})}}class cU{constructor(e,n){this.localStore=e,this.persistence=n}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.se(n,e))}se(e,n){const r=new Set;let i=n,s=!0;return z.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return te(eu,`Processing collection: ${o}`),this.oe(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>n-i)}oe(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this._e(i,s)).next(a=>(te(eu,`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}_e(e,n){let r=e;return n.changes.forEach((i,s)=>{const o=K0(s);b_(o,r)>0&&(r=o)}),new bn(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qn{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}qn.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const no=-1;function lf(t){return t==null}function ku(t){return t===0&&1/t==-1/0}function dU(t){return typeof t=="number"&&Number.isInteger(t)&&!ku(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _h="";function nn(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=FE(e)),e=hU(t.get(n),e);return FE(e)}function hU(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const s=t.charAt(i);switch(s){case"\0":n+="";break;case _h:n+="";break;default:n+=s}}return n}function FE(t){return t+_h+""}function Cr(t){const e=t.length;if(_e(e>=2,64408,{path:t}),e===2)return _e(t.charAt(0)===_h&&t.charAt(1)==="",56145,{path:t}),je.emptyPath();const n=e-2,r=[];let i="";for(let s=0;s<e;){const o=t.indexOf(_h,s);switch((o<0||o>n)&&he(50515,{path:t}),t.charAt(o+1)){case"":const a=t.substring(s,o);let l;i.length===0?l=a:(i+=a,l=i,i=""),r.push(l);break;case"":i+=t.substring(s,o),i+="\0";break;case"":i+=t.substring(s,o+1);break;default:he(61167,{path:t})}s=o+2}return new je(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qs="remoteDocuments",Xu="owner",Uo="owner",Nu="mutationQueues",fU="userId",nr="mutations",UE="batchId",Xs="userMutationsIndex",OE=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xd(t,e){return[t,nn(e)]}function X0(t,e,n){return[t,nn(e),n]}const pU={},ba="documentMutations",yh="remoteDocumentsV14",mU=["prefixPath","collectionGroup","readTime","documentId"],Ad="documentKeyIndex",gU=["prefixPath","collectionGroup","documentId"],Z0="collectionGroupIndex",_U=["collectionGroup","readTime","prefixPath","documentId"],bu="remoteDocumentGlobal",$m="remoteDocumentGlobalKey",Da="targets",ex="queryTargetsIndex",yU=["canonicalId","targetId"],Ma="targetDocuments",vU=["targetId","path"],M_="documentTargetsIndex",TU=["path","targetId"],vh="targetGlobalKey",ro="targetGlobal",Du="collectionParents",EU=["collectionId","parent"],Va="clientMetadata",wU="clientId",uf="bundles",IU="bundleId",cf="namedQueries",SU="name",V_="indexConfiguration",CU="indexId",Hm="collectionGroupIndex",xU="collectionGroup",tu="indexState",AU=["indexId","uid"],tx="sequenceNumberIndex",RU=["uid","sequenceNumber"],nu="indexEntries",PU=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],nx="documentKeyIndex",kU=["indexId","uid","orderedDocumentKey"],df="documentOverlays",NU=["userId","collectionPath","documentId"],jm="collectionPathOverlayIndex",bU=["userId","collectionPath","largestBatchId"],rx="collectionGroupOverlayIndex",DU=["userId","collectionGroup","largestBatchId"],L_="globals",MU="name",ix=[Nu,nr,ba,qs,Da,Xu,ro,Ma,Va,bu,Du,uf,cf],VU=[...ix,df],sx=[Nu,nr,ba,yh,Da,Xu,ro,Ma,Va,bu,Du,uf,cf,df],ox=sx,F_=[...ox,V_,tu,nu],LU=F_,ax=[...F_,L_],FU=ax;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wm extends Q0{constructor(e,n){super(),this.le=e,this.currentSequenceNumber=n}}function Mt(t,e){const n=Ie(t);return Zi.O(n.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BE(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function gs(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function lx(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ht{constructor(e,n){this.comparator=e,this.root=n||jt.EMPTY}insert(e,n){return new ht(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,jt.BLACK,null,null))}remove(e){return new ht(this.comparator,this.root.remove(e,this.comparator).copy(null,null,jt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ed(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ed(this.root,e,this.comparator,!1)}getReverseIterator(){return new ed(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ed(this.root,e,this.comparator,!0)}}class ed{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class jt{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??jt.RED,this.left=i??jt.EMPTY,this.right=s??jt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new jt(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return jt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return jt.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,jt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,jt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw he(43730,{key:this.key,value:this.value});if(this.right.isRed())throw he(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw he(27949);return e+(this.isRed()?0:1)}}jt.EMPTY=null,jt.RED=!0,jt.BLACK=!1;jt.EMPTY=new class{constructor(){this.size=0}get key(){throw he(57766)}get value(){throw he(16141)}get color(){throw he(16727)}get left(){throw he(29726)}get right(){throw he(36894)}copy(e,n,r,i,s){return this}insert(e,n,r){return new jt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xe{constructor(e){this.comparator=e,this.data=new ht(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new GE(this.data.getIterator())}getIteratorFrom(e){return new GE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Xe)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Xe(this.comparator);return n.data=e,n}}class GE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Oo(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gn{constructor(e){this.fields=e,e.sort(dt.comparator)}static empty(){return new gn([])}unionWith(e){let n=new Xe(dt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new gn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Na(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ux extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class It{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new ux("Invalid base64 string: "+s):s}}(e);return new It(n)}static fromUint8Array(e){const n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new It(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return we(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}It.EMPTY_BYTE_STRING=new It("");const UU=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function si(t){if(_e(!!t,39018),typeof t=="string"){let e=0;const n=UU.exec(t);if(_e(!!n,46558,{timestamp:t}),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ut(t.seconds),nanos:ut(t.nanos)}}function ut(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function oi(t){return typeof t=="string"?It.fromBase64String(t):It.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cx="server_timestamp",dx="__type__",hx="__previous_value__",fx="__local_write_time__";function U_(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[dx])==null?void 0:r.stringValue)===cx}function hf(t){const e=t.mapValue.fields[hx];return U_(e)?hf(e):e}function Mu(t){const e=si(t.mapValue.fields[fx].timestampValue);return new Ke(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OU{constructor(e,n,r,i,s,o,a,l,u,f){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=u,this.isUsingEmulator=f}}const Th="(default)";class os{constructor(e,n){this.projectId=e,this.database=n||Th}static empty(){return new os("","")}get isDefaultDatabase(){return this.database===Th}isEqual(e){return e instanceof os&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O_="__type__",px="__max__",Bi={mapValue:{fields:{__type__:{stringValue:px}}}},B_="__vector__",La="value",Rd={nullValue:"NULL_VALUE"};function as(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?U_(t)?4:mx(t)?9007199254740991:ff(t)?10:11:he(28295,{value:t})}function br(t,e){if(t===e)return!0;const n=as(t);if(n!==as(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Mu(t).isEqual(Mu(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=si(i.timestampValue),a=si(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return oi(i.bytesValue).isEqual(oi(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return ut(i.geoPointValue.latitude)===ut(s.geoPointValue.latitude)&&ut(i.geoPointValue.longitude)===ut(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return ut(i.integerValue)===ut(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=ut(i.doubleValue),a=ut(s.doubleValue);return o===a?ku(o)===ku(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return Na(t.arrayValue.values||[],e.arrayValue.values||[],br);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(BE(o)!==BE(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!br(o[l],a[l])))return!1;return!0}(t,e);default:return he(52216,{left:t})}}function Vu(t,e){return(t.values||[]).find(n=>br(n,e))!==void 0}function ls(t,e){if(t===e)return 0;const n=as(t),r=as(e);if(n!==r)return we(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return we(t.booleanValue,e.booleanValue);case 2:return function(s,o){const a=ut(s.integerValue||s.doubleValue),l=ut(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(t,e);case 3:return qE(t.timestampValue,e.timestampValue);case 4:return qE(Mu(t),Mu(e));case 5:return qm(t.stringValue,e.stringValue);case 6:return function(s,o){const a=oi(s),l=oi(o);return a.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),l=o.split("/");for(let u=0;u<a.length&&u<l.length;u++){const f=we(a[u],l[u]);if(f!==0)return f}return we(a.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){const a=we(ut(s.latitude),ut(o.latitude));return a!==0?a:we(ut(s.longitude),ut(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return zE(t.arrayValue,e.arrayValue);case 10:return function(s,o){var g,v,T,P;const a=s.fields||{},l=o.fields||{},u=(g=a[La])==null?void 0:g.arrayValue,f=(v=l[La])==null?void 0:v.arrayValue,m=we(((T=u==null?void 0:u.values)==null?void 0:T.length)||0,((P=f==null?void 0:f.values)==null?void 0:P.length)||0);return m!==0?m:zE(u,f)}(t.mapValue,e.mapValue);case 11:return function(s,o){if(s===Bi.mapValue&&o===Bi.mapValue)return 0;if(s===Bi.mapValue)return 1;if(o===Bi.mapValue)return-1;const a=s.fields||{},l=Object.keys(a),u=o.fields||{},f=Object.keys(u);l.sort(),f.sort();for(let m=0;m<l.length&&m<f.length;++m){const g=qm(l[m],f[m]);if(g!==0)return g;const v=ls(a[l[m]],u[f[m]]);if(v!==0)return v}return we(l.length,f.length)}(t.mapValue,e.mapValue);default:throw he(23264,{he:n})}}function qE(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return we(t,e);const n=si(t),r=si(e),i=we(n.seconds,r.seconds);return i!==0?i:we(n.nanos,r.nanos)}function zE(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const s=ls(n[i],r[i]);if(s)return s}return we(n.length,r.length)}function Fa(t){return Km(t)}function Km(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=si(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return oi(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return oe.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=Km(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${Km(n.fields[o])}`;return i+"}"}(t.mapValue):he(61005,{value:t})}function Pd(t){switch(as(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=hf(t);return e?16+Pd(e):16;case 5:return 2*t.stringValue.length;case 6:return oi(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,s)=>i+Pd(s),0)}(t.arrayValue);case 10:case 11:return function(r){let i=0;return gs(r.fields,(s,o)=>{i+=s.length+Pd(o)}),i}(t.mapValue);default:throw he(13486,{value:t})}}function Lu(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Jm(t){return!!t&&"integerValue"in t}function Fu(t){return!!t&&"arrayValue"in t}function $E(t){return!!t&&"nullValue"in t}function HE(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function kd(t){return!!t&&"mapValue"in t}function ff(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[O_])==null?void 0:r.stringValue)===B_}function ru(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return gs(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=ru(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=ru(t.arrayValue.values[n]);return e}return{...t}}function mx(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===px}const gx={mapValue:{fields:{[O_]:{stringValue:B_},[La]:{arrayValue:{}}}}};function BU(t){return"nullValue"in t?Rd:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?Lu(os.empty(),oe.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?ff(t)?gx:{mapValue:{}}:he(35942,{value:t})}function GU(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?Lu(os.empty(),oe.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?gx:"mapValue"in t?ff(t)?{mapValue:{}}:Bi:he(61959,{value:t})}function jE(t,e){const n=ls(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function WE(t,e){const n=ls(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class en{constructor(e){this.value=e}static empty(){return new en({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!kd(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=ru(n)}setAll(e){let n=dt.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=ru(o):i.push(a.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());kd(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return br(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];kd(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){gs(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new en(ru(this.value))}}function _x(t){const e=[];return gs(t.fields,(n,r)=>{const i=new dt([n]);if(kd(r)){const s=_x(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new gn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tt{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Tt(e,0,ye.min(),ye.min(),ye.min(),en.empty(),0)}static newFoundDocument(e,n,r,i){return new Tt(e,1,n,ye.min(),r,i,0)}static newNoDocument(e,n){return new Tt(e,2,n,ye.min(),ye.min(),en.empty(),0)}static newUnknownDocument(e,n){return new Tt(e,3,n,ye.min(),ye.min(),en.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(ye.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=en.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=en.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ye.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Tt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Tt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ua{constructor(e,n){this.position=e,this.inclusive=n}}function KE(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(s.field.isKeyField()?r=oe.comparator(oe.fromName(o.referenceValue),n.key):r=ls(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function JE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!br(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eh{constructor(e,n="asc"){this.field=e,this.dir=n}}function qU(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yx{}class Ve extends yx{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new zU(e,n,r):n==="array-contains"?new jU(e,r):n==="in"?new Sx(e,r):n==="not-in"?new WU(e,r):n==="array-contains-any"?new KU(e,r):new Ve(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new $U(e,r):new HU(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(ls(n,this.value)):n!==null&&as(this.value)===as(n)&&this.matchesComparison(ls(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return he(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Qe extends yx{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new Qe(e,n)}matches(e){return Oa(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Oa(t){return t.op==="and"}function Qm(t){return t.op==="or"}function G_(t){return vx(t)&&Oa(t)}function vx(t){for(const e of t.filters)if(e instanceof Qe)return!1;return!0}function Ym(t){if(t instanceof Ve)return t.field.canonicalString()+t.op.toString()+Fa(t.value);if(G_(t))return t.filters.map(e=>Ym(e)).join(",");{const e=t.filters.map(n=>Ym(n)).join(",");return`${t.op}(${e})`}}function Tx(t,e){return t instanceof Ve?function(r,i){return i instanceof Ve&&r.op===i.op&&r.field.isEqual(i.field)&&br(r.value,i.value)}(t,e):t instanceof Qe?function(r,i){return i instanceof Qe&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&Tx(o,i.filters[a]),!0):!1}(t,e):void he(19439)}function Ex(t,e){const n=t.filters.concat(e);return Qe.create(n,t.op)}function wx(t){return t instanceof Ve?function(n){return`${n.field.canonicalString()} ${n.op} ${Fa(n.value)}`}(t):t instanceof Qe?function(n){return n.op.toString()+" {"+n.getFilters().map(wx).join(" ,")+"}"}(t):"Filter"}class zU extends Ve{constructor(e,n,r){super(e,n,r),this.key=oe.fromName(r.referenceValue)}matches(e){const n=oe.comparator(e.key,this.key);return this.matchesComparison(n)}}class $U extends Ve{constructor(e,n){super(e,"in",n),this.keys=Ix("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class HU extends Ve{constructor(e,n){super(e,"not-in",n),this.keys=Ix("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function Ix(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(r=>oe.fromName(r.referenceValue))}class jU extends Ve{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Fu(n)&&Vu(n.arrayValue,this.value)}}class Sx extends Ve{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Vu(this.value.arrayValue,n)}}class WU extends Ve{constructor(e,n){super(e,"not-in",n)}matches(e){if(Vu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Vu(this.value.arrayValue,n)}}class KU extends Ve{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Fu(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Vu(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JU{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.Te=null}}function Xm(t,e=null,n=[],r=[],i=null,s=null,o=null){return new JU(t,e,n,r,i,s,o)}function mo(t){const e=Ie(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Ym(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),lf(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Fa(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Fa(r)).join(",")),e.Te=n}return e.Te}function Zu(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!qU(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!Tx(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!JE(t.startAt,e.startAt)&&JE(t.endAt,e.endAt)}function wh(t){return oe.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function Ih(t,e){return t.filters.filter(n=>n instanceof Ve&&n.field.isEqual(e))}function QE(t,e,n){let r=Rd,i=!0;for(const s of Ih(t,e)){let o=Rd,a=!0;switch(s.op){case"<":case"<=":o=BU(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=Rd}jE({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];jE({value:r,inclusive:i},{value:o,inclusive:n.inclusive})<0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}function YE(t,e,n){let r=Bi,i=!0;for(const s of Ih(t,e)){let o=Bi,a=!0;switch(s.op){case">=":case">":o=GU(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=Bi}WE({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];WE({value:r,inclusive:i},{value:o,inclusive:n.inclusive})>0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ec{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function QU(t,e,n,r,i,s,o,a){return new ec(t,e,n,r,i,s,o,a)}function tc(t){return new ec(t)}function XE(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Cx(t){return t.collectionGroup!==null}function iu(t){const e=Ie(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Xe(dt.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(u=>{u.isInequality()&&(a=a.add(u.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new Eh(s,r))}),n.has(dt.keyField().canonicalString())||e.Ie.push(new Eh(dt.keyField(),r))}return e.Ie}function Hn(t){const e=Ie(t);return e.Ee||(e.Ee=YU(e,iu(t))),e.Ee}function YU(t,e){if(t.limitType==="F")return Xm(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new Eh(i.field,s)});const n=t.endAt?new Ua(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Ua(t.startAt.position,t.startAt.inclusive):null;return Xm(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Zm(t,e){const n=t.filters.concat([e]);return new ec(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function eg(t,e,n){return new ec(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function pf(t,e){return Zu(Hn(t),Hn(e))&&t.limitType===e.limitType}function xx(t){return`${mo(Hn(t))}|lt:${t.limitType}`}function Ho(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>wx(i)).join(", ")}]`),lf(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>Fa(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>Fa(i)).join(",")),`Target(${r})`}(Hn(t))}; limitType=${t.limitType})`}function nc(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):oe.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of iu(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,a,l){const u=KE(o,a,l);return o.inclusive?u<=0:u<0}(r.startAt,iu(r),i)||r.endAt&&!function(o,a,l){const u=KE(o,a,l);return o.inclusive?u>=0:u>0}(r.endAt,iu(r),i))}(t,e)}function XU(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Ax(t){return(e,n)=>{let r=!1;for(const i of iu(t)){const s=ZU(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function ZU(t,e,n){const r=t.field.isKeyField()?oe.comparator(e.key,n.key):function(s,o,a){const l=o.data.field(s),u=a.data.field(s);return l!==null&&u!==null?ls(l,u):he(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return he(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ci{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){gs(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return lx(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e4=new ht(oe.comparator);function Pn(){return e4}const Rx=new ht(oe.comparator);function Ll(...t){let e=Rx;for(const n of t)e=e.insert(n.key,n);return e}function Px(t){let e=Rx;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function xr(){return su()}function kx(){return su()}function su(){return new ci(t=>t.toString(),(t,e)=>t.isEqual(e))}const t4=new ht(oe.comparator),n4=new Xe(oe.comparator);function Ae(...t){let e=n4;for(const n of t)e=e.add(n);return e}const r4=new Xe(we);function i4(){return r4}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q_(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ku(e)?"-0":e}}function Nx(t){return{integerValue:""+t}}function s4(t,e){return dU(e)?Nx(e):q_(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mf{constructor(){this._=void 0}}function o4(t,e,n){return t instanceof Ba?function(i,s){const o={fields:{[dx]:{stringValue:cx},[fx]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&U_(s)&&(s=hf(s)),s&&(o.fields[hx]=s),{mapValue:o}}(n,e):t instanceof Ga?Dx(t,e):t instanceof qa?Mx(t,e):function(i,s){const o=bx(i,s),a=ZE(o)+ZE(i.Ae);return Jm(o)&&Jm(i.Ae)?Nx(a):q_(i.serializer,a)}(t,e)}function a4(t,e,n){return t instanceof Ga?Dx(t,e):t instanceof qa?Mx(t,e):n}function bx(t,e){return t instanceof Uu?function(r){return Jm(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class Ba extends mf{}class Ga extends mf{constructor(e){super(),this.elements=e}}function Dx(t,e){const n=Vx(e);for(const r of t.elements)n.some(i=>br(i,r))||n.push(r);return{arrayValue:{values:n}}}class qa extends mf{constructor(e){super(),this.elements=e}}function Mx(t,e){let n=Vx(e);for(const r of t.elements)n=n.filter(i=>!br(i,r));return{arrayValue:{values:n}}}class Uu extends mf{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function ZE(t){return ut(t.integerValue||t.doubleValue)}function Vx(t){return Fu(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lx{constructor(e,n){this.field=e,this.transform=n}}function l4(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof Ga&&i instanceof Ga||r instanceof qa&&i instanceof qa?Na(r.elements,i.elements,br):r instanceof Uu&&i instanceof Uu?br(r.Ae,i.Ae):r instanceof Ba&&i instanceof Ba}(t.transform,e.transform)}class u4{constructor(e,n){this.version=e,this.transformResults=n}}class an{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new an}static exists(e){return new an(void 0,e)}static updateTime(e){return new an(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Nd(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class gf{}function Fx(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new _f(t.key,an.none()):new nl(t.key,t.data,an.none());{const n=t.data,r=en.empty();let i=new Xe(dt.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new di(t.key,r,new gn(i.toArray()),an.none())}}function c4(t,e,n){t instanceof nl?function(i,s,o){const a=i.value.clone(),l=tw(i.fieldTransforms,s,o.transformResults);a.setAll(l),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof di?function(i,s,o){if(!Nd(i.precondition,s))return void s.convertToUnknownDocument(o.version);const a=tw(i.fieldTransforms,s,o.transformResults),l=s.data;l.setAll(Ux(i)),l.setAll(a),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function ou(t,e,n,r){return t instanceof nl?function(s,o,a,l){if(!Nd(s.precondition,o))return a;const u=s.value.clone(),f=nw(s.fieldTransforms,l,o);return u.setAll(f),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,n,r):t instanceof di?function(s,o,a,l){if(!Nd(s.precondition,o))return a;const u=nw(s.fieldTransforms,l,o),f=o.data;return f.setAll(Ux(s)),f.setAll(u),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(m=>m.field))}(t,e,n,r):function(s,o,a){return Nd(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function d4(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=bx(r.transform,i||null);s!=null&&(n===null&&(n=en.empty()),n.set(r.field,s))}return n||null}function ew(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Na(r,i,(s,o)=>l4(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class nl extends gf{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class di extends gf{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function Ux(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function tw(t,e,n){const r=new Map;_e(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,a4(o,a,n[i]))}return r}function nw(t,e,n){const r=new Map;for(const i of t){const s=i.transform,o=n.data.field(i.field);r.set(i.field,o4(s,o,e))}return r}class _f extends gf{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Ox extends gf{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z_{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&c4(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=ou(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=ou(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=kx();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;const l=Fx(o,a);l!==null&&r.set(i.key,l),o.isValidDocument()||o.convertToNoDocument(ye.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Ae())}isEqual(e){return this.batchId===e.batchId&&Na(this.mutations,e.mutations,(n,r)=>ew(n,r))&&Na(this.baseMutations,e.baseMutations,(n,r)=>ew(n,r))}}class $_{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){_e(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=function(){return t4}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new $_(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H_{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h4{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ct,Ue;function f4(t){switch(t){case Q.OK:return he(64938);case Q.CANCELLED:case Q.UNKNOWN:case Q.DEADLINE_EXCEEDED:case Q.RESOURCE_EXHAUSTED:case Q.INTERNAL:case Q.UNAVAILABLE:case Q.UNAUTHENTICATED:return!1;case Q.INVALID_ARGUMENT:case Q.NOT_FOUND:case Q.ALREADY_EXISTS:case Q.PERMISSION_DENIED:case Q.FAILED_PRECONDITION:case Q.ABORTED:case Q.OUT_OF_RANGE:case Q.UNIMPLEMENTED:case Q.DATA_LOSS:return!0;default:return he(15467,{code:t})}}function Bx(t){if(t===void 0)return on("GRPC error has no .code"),Q.UNKNOWN;switch(t){case Ct.OK:return Q.OK;case Ct.CANCELLED:return Q.CANCELLED;case Ct.UNKNOWN:return Q.UNKNOWN;case Ct.DEADLINE_EXCEEDED:return Q.DEADLINE_EXCEEDED;case Ct.RESOURCE_EXHAUSTED:return Q.RESOURCE_EXHAUSTED;case Ct.INTERNAL:return Q.INTERNAL;case Ct.UNAVAILABLE:return Q.UNAVAILABLE;case Ct.UNAUTHENTICATED:return Q.UNAUTHENTICATED;case Ct.INVALID_ARGUMENT:return Q.INVALID_ARGUMENT;case Ct.NOT_FOUND:return Q.NOT_FOUND;case Ct.ALREADY_EXISTS:return Q.ALREADY_EXISTS;case Ct.PERMISSION_DENIED:return Q.PERMISSION_DENIED;case Ct.FAILED_PRECONDITION:return Q.FAILED_PRECONDITION;case Ct.ABORTED:return Q.ABORTED;case Ct.OUT_OF_RANGE:return Q.OUT_OF_RANGE;case Ct.UNIMPLEMENTED:return Q.UNIMPLEMENTED;case Ct.DATA_LOSS:return Q.DATA_LOSS;default:return he(39323,{code:t})}}(Ue=Ct||(Ct={}))[Ue.OK=0]="OK",Ue[Ue.CANCELLED=1]="CANCELLED",Ue[Ue.UNKNOWN=2]="UNKNOWN",Ue[Ue.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ue[Ue.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ue[Ue.NOT_FOUND=5]="NOT_FOUND",Ue[Ue.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ue[Ue.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ue[Ue.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ue[Ue.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ue[Ue.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ue[Ue.ABORTED=10]="ABORTED",Ue[Ue.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ue[Ue.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ue[Ue.INTERNAL=13]="INTERNAL",Ue[Ue.UNAVAILABLE=14]="UNAVAILABLE",Ue[Ue.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p4(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m4=new Xi([4294967295,4294967295],0);function rw(t){const e=p4().encode(t),n=new M0;return n.update(e),new Uint8Array(n.digest())}function iw(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Xi([n,r],0),new Xi([i,s],0)]}class j_{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Fl(`Invalid padding: ${n}`);if(r<0)throw new Fl(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Fl(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Fl(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=Xi.fromNumber(this.ge)}ye(e,n,r){let i=e.add(n.multiply(Xi.fromNumber(r)));return i.compare(m4)===1&&(i=new Xi([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=rw(e),[r,i]=iw(n);for(let s=0;s<this.hashCount;s++){const o=this.ye(r,i,s);if(!this.we(o))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new j_(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.ge===0)return;const n=rw(e),[r,i]=iw(n);for(let s=0;s<this.hashCount;s++){const o=this.ye(r,i,s);this.Se(o)}}Se(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Fl extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yf{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,rc.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new yf(ye.min(),i,new ht(we),Pn(),Ae())}}class rc{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new rc(r,n,Ae(),Ae(),Ae())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bd{constructor(e,n,r,i){this.be=e,this.removedTargetIds=n,this.key=r,this.De=i}}class Gx{constructor(e,n){this.targetId=e,this.Ce=n}}class qx{constructor(e,n,r=It.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class sw{constructor(){this.ve=0,this.Fe=ow(),this.Me=It.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Ae(),n=Ae(),r=Ae();return this.Fe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:he(38017,{changeType:s})}}),new rc(this.Me,this.xe,e,n,r)}qe(){this.Oe=!1,this.Fe=ow()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,_e(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class g4{constructor(e){this.Ge=e,this.ze=new Map,this.je=Pn(),this.Je=td(),this.He=td(),this.Ye=new ht(we)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:he(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((r,i)=>{this.rt(i)&&n(i)})}st(e){const n=e.targetId,r=e.Ce.count,i=this.ot(n);if(i){const s=i.target;if(wh(s))if(r===0){const o=new oe(s.path);this.et(n,o,Tt.newNoDocument(o,ye.min()))}else _e(r===1,20013,{expectedCount:r});else{const o=this._t(n);if(o!==r){const a=this.ut(e),l=a?this.ct(a,e,o):1;if(l!==0){this.it(n);const u=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,u)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let o,a;try{o=oi(r).toUint8Array()}catch(l){if(l instanceof ux)return ss("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new j_(o,i,s)}catch(l){return ss(l instanceof Fl?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.ge===0?null:a}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.et(n,s,null),i++)}),i}Tt(e){const n=new Map;this.ze.forEach((s,o)=>{const a=this.ot(o);if(a){if(s.current&&wh(a.target)){const l=new oe(a.target.path);this.It(l).has(o)||this.Et(o,l)||this.et(o,l,Tt.newNoDocument(l,e))}s.Be&&(n.set(o,s.ke()),s.qe())}});let r=Ae();this.He.forEach((s,o)=>{let a=!0;o.forEachWhile(l=>{const u=this.ot(l);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.je.forEach((s,o)=>o.setReadTime(e));const i=new yf(e,n,this.Ye,this.je,r);return this.je=Pn(),this.Je=td(),this.He=td(),this.Ye=new ht(we),i}Xe(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,r),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,n)?i.Qe(n,1):i.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new sw,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new Xe(we),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new Xe(we),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||te("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new sw),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function td(){return new ht(oe.comparator)}function ow(){return new ht(oe.comparator)}const _4={asc:"ASCENDING",desc:"DESCENDING"},y4={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},v4={and:"AND",or:"OR"};class T4{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function tg(t,e){return t.useProto3Json||lf(e)?e:{value:e}}function za(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function zx(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function E4(t,e){return za(t,e.toTimestamp())}function cn(t){return _e(!!t,49232),ye.fromTimestamp(function(n){const r=si(n);return new Ke(r.seconds,r.nanos)}(t))}function W_(t,e){return ng(t,e).canonicalString()}function ng(t,e){const n=function(i){return new je(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function $x(t){const e=je.fromString(t);return _e(Zx(e),10190,{key:e.toString()}),e}function Sh(t,e){return W_(t.databaseId,e.path)}function io(t,e){const n=$x(e);if(n.get(1)!==t.databaseId.projectId)throw new se(Q.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new se(Q.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new oe(Wx(n))}function Hx(t,e){return W_(t.databaseId,e)}function jx(t){const e=$x(t);return e.length===4?je.emptyPath():Wx(e)}function rg(t){return new je(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Wx(t){return _e(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function aw(t,e,n){return{name:Sh(t,e),fields:n.value.mapValue.fields}}function w4(t,e,n){const r=io(t,e.name),i=cn(e.updateTime),s=e.createTime?cn(e.createTime):ye.min(),o=new en({mapValue:{fields:e.fields}}),a=Tt.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function I4(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:he(39313,{state:u})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(u,f){return u.useProto3Json?(_e(f===void 0||typeof f=="string",58123),It.fromBase64String(f||"")):(_e(f===void 0||f instanceof Buffer||f instanceof Uint8Array,16193),It.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(u){const f=u.code===void 0?Q.UNKNOWN:Bx(u.code);return new se(f,u.message||"")}(o);n=new qx(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=io(t,r.document.name),s=cn(r.document.updateTime),o=r.document.createTime?cn(r.document.createTime):ye.min(),a=new en({mapValue:{fields:r.document.fields}}),l=Tt.newFoundDocument(i,s,o,a),u=r.targetIds||[],f=r.removedTargetIds||[];n=new bd(u,f,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=io(t,r.document),s=r.readTime?cn(r.readTime):ye.min(),o=Tt.newNoDocument(i,s),a=r.removedTargetIds||[];n=new bd([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=io(t,r.document),s=r.removedTargetIds||[];n=new bd([],s,i,null)}else{if(!("filter"in e))return he(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new h4(i,s),a=r.targetId;n=new Gx(a,o)}}return n}function Ch(t,e){let n;if(e instanceof nl)n={update:aw(t,e.key,e.value)};else if(e instanceof _f)n={delete:Sh(t,e.key)};else if(e instanceof di)n={update:aw(t,e.key,e.data),updateMask:P4(e.fieldMask)};else{if(!(e instanceof Ox))return he(16599,{Vt:e.type});n={verify:Sh(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const a=o.transform;if(a instanceof Ba)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Ga)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof qa)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Uu)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw he(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:E4(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:he(27497)}(t,e.precondition)),n}function ig(t,e){const n=e.currentDocument?function(s){return s.updateTime!==void 0?an.updateTime(cn(s.updateTime)):s.exists!==void 0?an.exists(s.exists):an.none()}(e.currentDocument):an.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let l=null;if("setToServerValue"in a)_e(a.setToServerValue==="REQUEST_TIME",16630,{proto:a}),l=new Ba;else if("appendMissingElements"in a){const f=a.appendMissingElements.values||[];l=new Ga(f)}else if("removeAllFromArray"in a){const f=a.removeAllFromArray.values||[];l=new qa(f)}else"increment"in a?l=new Uu(o,a.increment):he(16584,{proto:a});const u=dt.fromServerFormat(a.fieldPath);return new Lx(u,l)}(t,i)):[];if(e.update){e.update.name;const i=io(t,e.update.name),s=new en({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(l){const u=l.fieldPaths||[];return new gn(u.map(f=>dt.fromServerFormat(f)))}(e.updateMask);return new di(i,s,o,n,r)}return new nl(i,s,n,r)}if(e.delete){const i=io(t,e.delete);return new _f(i,n)}if(e.verify){const i=io(t,e.verify);return new Ox(i,n)}return he(1463,{proto:e})}function S4(t,e){return t&&t.length>0?(_e(e!==void 0,14353),t.map(n=>function(i,s){let o=i.updateTime?cn(i.updateTime):cn(s);return o.isEqual(ye.min())&&(o=cn(s)),new u4(o,i.transformResults||[])}(n,e))):[]}function Kx(t,e){return{documents:[Hx(t,e.path)]}}function Jx(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=Hx(t,i);const s=function(u){if(u.length!==0)return Xx(Qe.create(u,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const o=function(u){if(u.length!==0)return u.map(f=>function(g){return{field:jo(g.field),direction:x4(g.dir)}}(f))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=tg(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{ft:n,parent:i}}function Qx(t){let e=jx(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){_e(r===1,65062);const f=n.from[0];f.allDescendants?i=f.collectionId:e=e.child(f.collectionId)}let s=[];n.where&&(s=function(m){const g=Yx(m);return g instanceof Qe&&G_(g)?g.getFilters():[g]}(n.where));let o=[];n.orderBy&&(o=function(m){return m.map(g=>function(T){return new Eh(Wo(T.field),function(M){switch(M){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(T.direction))}(g))}(n.orderBy));let a=null;n.limit&&(a=function(m){let g;return g=typeof m=="object"?m.value:m,lf(g)?null:g}(n.limit));let l=null;n.startAt&&(l=function(m){const g=!!m.before,v=m.values||[];return new Ua(v,g)}(n.startAt));let u=null;return n.endAt&&(u=function(m){const g=!m.before,v=m.values||[];return new Ua(v,g)}(n.endAt)),QU(e,i,o,s,a,"F",l,u)}function C4(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return he(28987,{purpose:i})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function Yx(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Wo(n.unaryFilter.field);return Ve.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Wo(n.unaryFilter.field);return Ve.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Wo(n.unaryFilter.field);return Ve.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Wo(n.unaryFilter.field);return Ve.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return he(61313);default:return he(60726)}}(t):t.fieldFilter!==void 0?function(n){return Ve.create(Wo(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return he(58110);default:return he(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Qe.create(n.compositeFilter.filters.map(r=>Yx(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return he(1026)}}(n.compositeFilter.op))}(t):he(30097,{filter:t})}function x4(t){return _4[t]}function A4(t){return y4[t]}function R4(t){return v4[t]}function jo(t){return{fieldPath:t.canonicalString()}}function Wo(t){return dt.fromServerFormat(t.fieldPath)}function Xx(t){return t instanceof Ve?function(n){if(n.op==="=="){if(HE(n.value))return{unaryFilter:{field:jo(n.field),op:"IS_NAN"}};if($E(n.value))return{unaryFilter:{field:jo(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(HE(n.value))return{unaryFilter:{field:jo(n.field),op:"IS_NOT_NAN"}};if($E(n.value))return{unaryFilter:{field:jo(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:jo(n.field),op:A4(n.op),value:n.value}}}(t):t instanceof Qe?function(n){const r=n.getFilters().map(i=>Xx(i));return r.length===1?r[0]:{compositeFilter:{op:R4(n.op),filters:r}}}(t):he(54877,{filter:t})}function P4(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function Zx(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qr{constructor(e,n,r,i,s=ye.min(),o=ye.min(),a=It.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new Qr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Qr(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Qr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Qr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eA{constructor(e){this.yt=e}}function k4(t,e){let n;if(e.document)n=w4(t.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=oe.fromSegments(e.noDocument.path),i=_o(e.noDocument.readTime);n=Tt.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return he(56709);{const r=oe.fromSegments(e.unknownDocument.path),i=_o(e.unknownDocument.version);n=Tt.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){const s=new Ke(i[0],i[1]);return ye.fromTimestamp(s)}(e.readTime)),n}function lw(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:xh(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:Sh(s,o.key),fields:o.data.value.mapValue.fields,updateTime:za(s,o.version.toTimestamp()),createTime:za(s,o.createTime.toTimestamp())}}(t.yt,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:go(e.version)};else{if(!e.isUnknownDocument())return he(57904,{document:e});r.unknownDocument={path:n.path.toArray(),version:go(e.version)}}return r}function xh(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function go(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function _o(t){const e=new Ke(t.seconds,t.nanoseconds);return ye.fromTimestamp(e)}function Hs(t,e){const n=(e.baseMutations||[]).map(s=>ig(t.yt,s));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map(s=>ig(t.yt,s)),i=Ke.fromMillis(e.localWriteTimeMs);return new z_(e.batchId,i,n,r)}function Ul(t){const e=_o(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?_o(t.lastLimboFreeSnapshotVersion):ye.min();let r;return r=function(s){return s.documents!==void 0}(t.query)?function(s){const o=s.documents.length;return _e(o===1,1966,{count:o}),Hn(tc(jx(s.documents[0])))}(t.query):function(s){return Hn(Qx(s))}(t.query),new Qr(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,It.fromBase64String(t.resumeToken))}function tA(t,e){const n=go(e.snapshotVersion),r=go(e.lastLimboFreeSnapshotVersion);let i;i=wh(e.target)?Kx(t.yt,e.target):Jx(t.yt,e.target).ft;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:mo(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function nA(t){const e=Qx({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?eg(e,e.limit,"L"):e}function wp(t,e){return new H_(e.largestBatchId,ig(t.yt,e.overlayMutation))}function uw(t,e){const n=e.path.lastSegment();return[t,nn(e.path.popLast()),n]}function cw(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:go(r.readTime),documentKey:nn(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N4{getBundleMetadata(e,n){return dw(e).get(n).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:_o(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,n){return dw(e).put(function(i){return{bundleId:i.id,createTime:go(cn(i.createTime)),version:i.version}}(n))}getNamedQuery(e,n){return hw(e).get(n).next(r=>{if(r)return function(s){return{name:s.name,query:nA(s.bundledQuery),readTime:_o(s.readTime)}}(r)})}saveNamedQuery(e,n){return hw(e).put(function(i){return{name:i.name,readTime:go(cn(i.readTime)),bundledQuery:i.bundledQuery}}(n))}}function dw(t){return Mt(t,uf)}function hw(t){return Mt(t,cf)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vf{constructor(e,n){this.serializer=e,this.userId=n}static wt(e,n){const r=n.uid||"";return new vf(e,r)}getOverlay(e,n){return xl(e).get(uw(this.userId,n)).next(r=>r?wp(this.serializer,r):null)}getOverlays(e,n){const r=xr();return z.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){const i=[];return r.forEach((s,o)=>{const a=new H_(n,o);i.push(this.St(e,a))}),z.waitFor(i)}removeOverlaysForBatchId(e,n,r){const i=new Set;n.forEach(o=>i.add(nn(o.getCollectionPath())));const s=[];return i.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(xl(e).Z(jm,a))}),z.waitFor(s)}getOverlaysForCollection(e,n,r){const i=xr(),s=nn(n),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return xl(e).J(jm,o).next(a=>{for(const l of a){const u=wp(this.serializer,l);i.set(u.getKey(),u)}return i})}getOverlaysForCollectionGroup(e,n,r,i){const s=xr();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return xl(e).ee({index:rx,range:a},(l,u,f)=>{const m=wp(this.serializer,u);s.size()<i||m.largestBatchId===o?(s.set(m.getKey(),m),o=m.largestBatchId):f.done()}).next(()=>s)}St(e,n){return xl(e).put(function(i,s,o){const[a,l,u]=uw(s,o.mutation.key);return{userId:s,collectionPath:l,documentId:u,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Ch(i.yt,o.mutation)}}(this.serializer,this.userId,n))}}function xl(t){return Mt(t,df)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b4{bt(e){return Mt(e,L_)}getSessionToken(e){return this.bt(e).get("sessionToken").next(n=>{const r=n==null?void 0:n.value;return r?It.fromUint8Array(r):It.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.bt(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class js{constructor(){}Dt(e,n){this.Ct(e,n),n.vt()}Ct(e,n){if("nullValue"in e)this.Ft(n,5);else if("booleanValue"in e)this.Ft(n,10),n.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(n,15),n.Mt(ut(e.integerValue));else if("doubleValue"in e){const r=ut(e.doubleValue);isNaN(r)?this.Ft(n,13):(this.Ft(n,15),ku(r)?n.Mt(0):n.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(n,20),typeof r=="string"&&(r=si(r)),n.xt(`${r.seconds||""}`),n.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,n),this.Nt(n);else if("bytesValue"in e)this.Ft(n,30),n.Bt(oi(e.bytesValue)),this.Nt(n);else if("referenceValue"in e)this.Lt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(n,45),n.Mt(r.latitude||0),n.Mt(r.longitude||0)}else"mapValue"in e?mx(e)?this.Ft(n,Number.MAX_SAFE_INTEGER):ff(e)?this.kt(e.mapValue,n):(this.qt(e.mapValue,n),this.Nt(n)):"arrayValue"in e?(this.Qt(e.arrayValue,n),this.Nt(n)):he(19022,{$t:e})}Ot(e,n){this.Ft(n,25),this.Ut(e,n)}Ut(e,n){n.xt(e)}qt(e,n){const r=e.fields||{};this.Ft(n,55);for(const i of Object.keys(r))this.Ot(i,n),this.Ct(r[i],n)}kt(e,n){var o,a;const r=e.fields||{};this.Ft(n,53);const i=La,s=((a=(o=r[i].arrayValue)==null?void 0:o.values)==null?void 0:a.length)||0;this.Ft(n,15),n.Mt(ut(s)),this.Ot(i,n),this.Ct(r[i],n)}Qt(e,n){const r=e.values||[];this.Ft(n,50);for(const i of r)this.Ct(i,n)}Lt(e,n){this.Ft(n,37),oe.fromName(e).path.forEach(r=>{this.Ft(n,60),this.Ut(r,n)})}Ft(e,n){e.Mt(n)}Nt(e){e.Mt(2)}}js.Kt=new js;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bo=255;function D4(t){if(t===0)return 8;let e=0;return t>>4||(e+=4,t<<=4),t>>6||(e+=2,t<<=2),t>>7||(e+=1),e}function fw(t){const e=64-function(r){let i=0;for(let s=0;s<8;++s){const o=D4(255&r[s]);if(i+=o,o!==8)break}return i}(t);return Math.ceil(e/8)}class M4{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Gt(r.value),r=n.next();this.zt()}jt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Jt(r.value),r=n.next();this.Ht()}Yt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const i=n.codePointAt(0);this.Gt(240|i>>>18),this.Gt(128|63&i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i)}}this.zt()}Zt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const i=n.codePointAt(0);this.Jt(240|i>>>18),this.Jt(128|63&i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i)}}this.Ht()}Xt(e){const n=this.en(e),r=fw(n);this.tn(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}nn(e){const n=this.en(e),r=fw(n);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}rn(){this.sn(Bo),this.sn(255)}_n(){this.an(Bo),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const n=function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=!!(128&n[0]);n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Gt(e){const n=255&e;n===0?(this.sn(0),this.sn(255)):n===Bo?(this.sn(Bo),this.sn(0)):this.sn(n)}Jt(e){const n=255&e;n===0?(this.an(0),this.an(255)):n===Bo?(this.an(Bo),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class V4{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class L4{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class Al{constructor(){this.cn=new M4,this.ln=new V4(this.cn),this.hn=new L4(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ws{constructor(e,n,r,i){this.Tn=e,this.In=n,this.En=r,this.dn=i}An(){const e=this.dn.length,n=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.dn,0),n!==e?r.set([0],this.dn.length):++r[r.length-1],new Ws(this.Tn,this.In,this.En,r)}Rn(e,n,r){return{indexId:this.Tn,uid:e,arrayValue:Dd(this.En),directionalValue:Dd(this.dn),orderedDocumentKey:Dd(n),documentKey:r.path.toArray()}}Vn(e,n,r){const i=this.Rn(e,n,r);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}}function xi(t,e){let n=t.Tn-e.Tn;return n!==0?n:(n=pw(t.En,e.En),n!==0?n:(n=pw(t.dn,e.dn),n!==0?n:oe.comparator(t.In,e.In)))}function pw(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}function Dd(t){return JC()?function(n){let r="";for(let i=0;i<n.length;i++)r+=String.fromCharCode(n[i]);return r}(t):t}function mw(t){return typeof t!="string"?t:function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(t)}class gw{constructor(e){this.mn=new Xe((n,r)=>dt.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const n of e.filters){const r=n;r.isInequality()?this.mn=this.mn.add(r):this.gn.push(r)}}get pn(){return this.mn.size>1}yn(e){if(_e(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const n=zm(e);if(n!==void 0&&!this.wn(n))return!1;const r=Gs(e);let i=new Set,s=0,o=0;for(;s<r.length&&this.wn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.mn.size>0){const a=this.mn.getIterator().getNext();if(!i.has(a.field.canonicalString())){const l=r[s];if(!this.Sn(a,l)||!this.bn(this.fn[o++],l))return!1}++s}for(;s<r.length;++s){const a=r[s];if(o>=this.fn.length||!this.bn(this.fn[o++],a))return!1}return!0}Dn(){if(this.pn)return null;let e=new Xe(dt.comparator);const n=[];for(const r of this.gn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new Cd(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new Cd(r.field,0))}for(const r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new Cd(r.field,r.dir==="asc"?0:1)));return new gh(gh.UNKNOWN_ID,this.collectionId,n,Pu.empty())}wn(e){for(const n of this.gn)if(this.Sn(n,e))return!0;return!1}Sn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}bn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rA(t){var n,r;if(_e(t instanceof Ve||t instanceof Qe,20012),t instanceof Ve){if(t instanceof Sx){const i=((r=(n=t.value.arrayValue)==null?void 0:n.values)==null?void 0:r.map(s=>Ve.create(t.field,"==",s)))||[];return Qe.create(i,"or")}return t}const e=t.filters.map(i=>rA(i));return Qe.create(e,t.op)}function F4(t){if(t.getFilters().length===0)return[];const e=ag(rA(t));return _e(iA(e),7391),sg(e)||og(e)?[e]:e.getFilters()}function sg(t){return t instanceof Ve}function og(t){return t instanceof Qe&&G_(t)}function iA(t){return sg(t)||og(t)||function(n){if(n instanceof Qe&&Qm(n)){for(const r of n.getFilters())if(!sg(r)&&!og(r))return!1;return!0}return!1}(t)}function ag(t){if(_e(t instanceof Ve||t instanceof Qe,34018),t instanceof Ve)return t;if(t.filters.length===1)return ag(t.filters[0]);const e=t.filters.map(r=>ag(r));let n=Qe.create(e,t.op);return n=Ah(n),iA(n)?n:(_e(n instanceof Qe,64498),_e(Oa(n),40251),_e(n.filters.length>1,57927),n.filters.reduce((r,i)=>K_(r,i)))}function K_(t,e){let n;return _e(t instanceof Ve||t instanceof Qe,38388),_e(e instanceof Ve||e instanceof Qe,25473),n=t instanceof Ve?e instanceof Ve?function(i,s){return Qe.create([i,s],"and")}(t,e):_w(t,e):e instanceof Ve?_w(e,t):function(i,s){if(_e(i.filters.length>0&&s.filters.length>0,48005),Oa(i)&&Oa(s))return Ex(i,s.getFilters());const o=Qm(i)?i:s,a=Qm(i)?s:i,l=o.filters.map(u=>K_(u,a));return Qe.create(l,"or")}(t,e),Ah(n)}function _w(t,e){if(Oa(e))return Ex(e,t.getFilters());{const n=e.filters.map(r=>K_(t,r));return Qe.create(n,"or")}}function Ah(t){if(_e(t instanceof Ve||t instanceof Qe,11850),t instanceof Ve)return t;const e=t.getFilters();if(e.length===1)return Ah(e[0]);if(vx(t))return t;const n=e.map(i=>Ah(i)),r=[];return n.forEach(i=>{i instanceof Ve?r.push(i):i instanceof Qe&&(i.op===t.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:Qe.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U4{constructor(){this.Cn=new J_}addToCollectionParentIndex(e,n){return this.Cn.add(n),z.resolve()}getCollectionParents(e,n){return z.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return z.resolve()}deleteFieldIndex(e,n){return z.resolve()}deleteAllFieldIndexes(e){return z.resolve()}createTargetIndexes(e,n){return z.resolve()}getDocumentsMatchingTarget(e,n){return z.resolve(null)}getIndexType(e,n){return z.resolve(0)}getFieldIndexes(e,n){return z.resolve([])}getNextCollectionGroupToUpdate(e){return z.resolve(null)}getMinOffset(e,n){return z.resolve(bn.min())}getMinOffsetFromCollectionGroup(e,n){return z.resolve(bn.min())}updateCollectionGroup(e,n,r){return z.resolve()}updateIndexEntries(e,n){return z.resolve()}}class J_{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Xe(je.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Xe(je.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yw="IndexedDbIndexManager",nd=new Uint8Array(0);class O4{constructor(e,n){this.databaseId=n,this.vn=new J_,this.Fn=new ci(r=>mo(r),(r,i)=>Zu(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.vn.has(n)){const r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this.vn.add(n)});const s={collectionId:r,parent:nn(i)};return vw(e).put(s)}return z.resolve()}getCollectionParents(e,n){const r=[],i=IDBKeyRange.bound([n,""],[$0(n),""],!1,!0);return vw(e).J(i).next(s=>{for(const o of s){if(o.collectionId!==n)break;r.push(Cr(o.parent))}return r})}addFieldIndex(e,n){const r=Rl(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(l=>[l.fieldPath.canonicalString(),l.kind])}}(n);delete i.indexId;const s=r.add(i);if(n.indexState){const o=qo(e);return s.next(a=>{o.put(cw(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){const r=Rl(e),i=qo(e),s=Go(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=Rl(e),r=Go(e),i=qo(e);return n.Z().next(()=>r.Z()).next(()=>i.Z())}createTargetIndexes(e,n){return z.forEach(this.Mn(n),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){const s=new gw(r).Dn();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,n){const r=Go(e);let i=!0;const s=new Map;return z.forEach(this.Mn(n),o=>this.xn(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=Ae();const a=[];return z.forEach(s,(l,u)=>{te(yw,`Using index ${function(A){return`id=${A.indexId}|cg=${A.collectionGroup}|f=${A.fields.map(V=>`${V.fieldPath}:${V.kind}`).join(",")}`}(l)} to execute ${mo(n)}`);const f=function(A,V){const B=zm(V);if(B===void 0)return null;for(const G of Ih(A,B.fieldPath))switch(G.op){case"array-contains-any":return G.value.arrayValue.values||[];case"array-contains":return[G.value]}return null}(u,l),m=function(A,V){const B=new Map;for(const G of Gs(V))for(const I of Ih(A,G.fieldPath))switch(I.op){case"==":case"in":B.set(G.fieldPath.canonicalString(),I.value);break;case"not-in":case"!=":return B.set(G.fieldPath.canonicalString(),I.value),Array.from(B.values())}return null}(u,l),g=function(A,V){const B=[];let G=!0;for(const I of Gs(V)){const S=I.kind===0?QE(A,I.fieldPath,A.startAt):YE(A,I.fieldPath,A.startAt);B.push(S.value),G&&(G=S.inclusive)}return new Ua(B,G)}(u,l),v=function(A,V){const B=[];let G=!0;for(const I of Gs(V)){const S=I.kind===0?YE(A,I.fieldPath,A.endAt):QE(A,I.fieldPath,A.endAt);B.push(S.value),G&&(G=S.inclusive)}return new Ua(B,G)}(u,l),T=this.On(l,u,g),P=this.On(l,u,v),M=this.Nn(l,u,m),x=this.Bn(l.indexId,f,T,g.inclusive,P,v.inclusive,M);return z.forEach(x,E=>r.Y(E,n.limit).next(A=>{A.forEach(V=>{const B=oe.fromSegments(V.documentKey);o.has(B)||(o=o.add(B),a.push(B))})}))}).next(()=>a)}return z.resolve(null)})}Mn(e){let n=this.Fn.get(e);return n||(e.filters.length===0?n=[e]:n=F4(Qe.create(e.filters,"and")).map(r=>Xm(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.Fn.set(e,n),n)}Bn(e,n,r,i,s,o,a){const l=(n!=null?n.length:1)*Math.max(r.length,s.length),u=l/(n!=null?n.length:1),f=[];for(let m=0;m<l;++m){const g=n?this.Ln(n[m/u]):nd,v=this.kn(e,g,r[m%u],i),T=this.qn(e,g,s[m%u],o),P=a.map(M=>this.kn(e,g,M,!0));f.push(...this.createRange(v,T,P))}return f}kn(e,n,r,i){const s=new Ws(e,oe.empty(),n,r);return i?s:s.An()}qn(e,n,r,i){const s=new Ws(e,oe.empty(),n,r);return i?s.An():s}xn(e,n){const r=new gw(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(const a of s)r.yn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2;const i=this.Mn(n);return z.forEach(i,s=>this.xn(e,s).next(o=>{o?r!==0&&o.fields.length<function(l){let u=new Xe(dt.comparator),f=!1;for(const m of l.filters)for(const g of m.getFlattenedFilters())g.field.isKeyField()||(g.op==="array-contains"||g.op==="array-contains-any"?f=!0:u=u.add(g.field));for(const m of l.orderBy)m.field.isKeyField()||(u=u.add(m.field));return u.size+(f?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&i.length>1&&r===2?1:r)}Qn(e,n){const r=new Al;for(const i of Gs(e)){const s=n.data.field(i.fieldPath);if(s==null)return null;const o=r.Pn(i.kind);js.Kt.Dt(s,o)}return r.un()}Ln(e){const n=new Al;return js.Kt.Dt(e,n.Pn(0)),n.un()}$n(e,n){const r=new Al;return js.Kt.Dt(Lu(this.databaseId,n),r.Pn(function(s){const o=Gs(s);return o.length===0?0:o[o.length-1].kind}(e))),r.un()}Nn(e,n,r){if(r===null)return[];let i=[];i.push(new Al);let s=0;for(const o of Gs(e)){const a=r[s++];for(const l of i)if(this.Un(n,o.fieldPath)&&Fu(a))i=this.Kn(i,o,a);else{const u=l.Pn(o.kind);js.Kt.Dt(a,u)}}return this.Wn(i)}On(e,n,r){return this.Nn(e,n,r.position)}Wn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].un();return n}Kn(e,n,r){const i=[...e],s=[];for(const o of r.arrayValue.values||[])for(const a of i){const l=new Al;l.seed(a.un()),js.Kt.Dt(o,l.Pn(n.kind)),s.push(l)}return s}Un(e,n){return!!e.filters.find(r=>r instanceof Ve&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=Rl(e),i=qo(e);return(n?r.J(Hm,IDBKeyRange.bound(n,n)):r.J()).next(s=>{const o=[];return z.forEach(s,a=>i.get([a.indexId,this.uid]).next(l=>{o.push(function(f,m){const g=m?new Pu(m.sequenceNumber,new bn(_o(m.readTime),new oe(Cr(m.documentKey)),m.largestBatchId)):Pu.empty(),v=f.fields.map(([T,P])=>new Cd(dt.fromServerFormat(T),P));return new gh(f.indexId,f.collectionGroup,v,g)}(a,l))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:we(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const i=Rl(e),s=qo(e);return this.Gn(e).next(o=>i.J(Hm,IDBKeyRange.bound(n,n)).next(a=>z.forEach(a,l=>s.put(cw(l.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){const r=new Map;return z.forEach(n,(i,s)=>{const o=r.get(i.collectionGroup);return(o?z.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),z.forEach(a,l=>this.zn(e,i,l).next(u=>{const f=this.jn(s,l);return u.isEqual(f)?z.resolve():this.Jn(e,s,l,u,f)}))))})}Hn(e,n,r,i){return Go(e).put(i.Rn(this.uid,this.$n(r,n.key),n.key))}Yn(e,n,r,i){return Go(e).delete(i.Vn(this.uid,this.$n(r,n.key),n.key))}zn(e,n,r){const i=Go(e);let s=new Xe(xi);return i.ee({index:nx,range:IDBKeyRange.only([r.indexId,this.uid,Dd(this.$n(r,n))])},(o,a)=>{s=s.add(new Ws(r.indexId,n,mw(a.arrayValue),mw(a.directionalValue)))}).next(()=>s)}jn(e,n){let r=new Xe(xi);const i=this.Qn(n,e);if(i==null)return r;const s=zm(n);if(s!=null){const o=e.data.field(s.fieldPath);if(Fu(o))for(const a of o.arrayValue.values||[])r=r.add(new Ws(n.indexId,e.key,this.Ln(a),i))}else r=r.add(new Ws(n.indexId,e.key,nd,i));return r}Jn(e,n,r,i,s){te(yw,"Updating index entries for document '%s'",n.key);const o=[];return function(l,u,f,m,g){const v=l.getIterator(),T=u.getIterator();let P=Oo(v),M=Oo(T);for(;P||M;){let x=!1,E=!1;if(P&&M){const A=f(P,M);A<0?E=!0:A>0&&(x=!0)}else P!=null?E=!0:x=!0;x?(m(M),M=Oo(T)):E?(g(P),P=Oo(v)):(P=Oo(v),M=Oo(T))}}(i,s,xi,a=>{o.push(this.Hn(e,n,r,a))},a=>{o.push(this.Yn(e,n,r,a))}),z.waitFor(o)}Gn(e){let n=1;return qo(e).ee({index:tx,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>xi(o,a)).filter((o,a,l)=>!a||xi(o,l[a-1])!==0);const i=[];i.push(e);for(const o of r){const a=xi(o,e),l=xi(o,n);if(a===0)i[0]=e.An();else if(a>0&&l<0)i.push(o),i.push(o.An());else if(l>0)break}i.push(n);const s=[];for(let o=0;o<i.length;o+=2){if(this.Zn(i[o],i[o+1]))return[];const a=i[o].Vn(this.uid,nd,oe.empty()),l=i[o+1].Vn(this.uid,nd,oe.empty());s.push(IDBKeyRange.bound(a,l))}return s}Zn(e,n){return xi(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(Tw)}getMinOffset(e,n){return z.mapArray(this.Mn(n),r=>this.xn(e,r).next(i=>i||he(44426))).next(Tw)}}function vw(t){return Mt(t,Du)}function Go(t){return Mt(t,nu)}function Rl(t){return Mt(t,V_)}function qo(t){return Mt(t,tu)}function Tw(t){_e(t.length!==0,28825);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const i=t[r].indexState.offset;b_(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new bn(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ew={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},sA=41943040;class Xt{static withCacheSize(e){return new Xt(e,Xt.DEFAULT_COLLECTION_PERCENTILE,Xt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oA(t,e,n){const r=t.store(nr),i=t.store(ba),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const l=r.ee({range:o},(f,m,g)=>(a++,g.delete()));s.push(l.next(()=>{_e(a===1,47070,{batchId:n.batchId})}));const u=[];for(const f of n.mutations){const m=X0(e,f.key.path,n.batchId);s.push(i.delete(m)),u.push(f.key)}return z.waitFor(s).next(()=>u)}function Rh(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw he(14731);e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Xt.DEFAULT_COLLECTION_PERCENTILE=10,Xt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Xt.DEFAULT=new Xt(sA,Xt.DEFAULT_COLLECTION_PERCENTILE,Xt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Xt.DISABLED=new Xt(-1,0,0);class Tf{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Xn={}}static wt(e,n,r,i){_e(e.uid!=="",64387);const s=e.isAuthenticated()?e.uid:"";return new Tf(s,n,r,i)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ai(e).ee({index:Xs,range:r},(i,s,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,i){const s=Ko(e),o=Ai(e);return o.add({}).next(a=>{_e(typeof a=="number",49019);const l=new z_(a,n,r,i),u=function(v,T,P){const M=P.baseMutations.map(E=>Ch(v.yt,E)),x=P.mutations.map(E=>Ch(v.yt,E));return{userId:T,batchId:P.batchId,localWriteTimeMs:P.localWriteTime.toMillis(),baseMutations:M,mutations:x}}(this.serializer,this.userId,l),f=[];let m=new Xe((g,v)=>we(g.canonicalString(),v.canonicalString()));for(const g of i){const v=X0(this.userId,g.key.path,a);m=m.add(g.key.path.popLast()),f.push(o.put(u)),f.push(s.put(v,pU))}return m.forEach(g=>{f.push(this.indexManager.addToCollectionParentIndex(e,g))}),e.addOnCommittedListener(()=>{this.Xn[a]=l.keys()}),z.waitFor(f).next(()=>l)})}lookupMutationBatch(e,n){return Ai(e).get(n).next(r=>r?(_e(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:n}),Hs(this.serializer,r)):null)}er(e,n){return this.Xn[n]?z.resolve(this.Xn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const i=r.keys();return this.Xn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return Ai(e).ee({index:Xs,range:i},(o,a,l)=>{a.userId===this.userId&&(_e(a.batchId>=r,47524,{tr:r}),s=Hs(this.serializer,a)),l.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=no;return Ai(e).ee({index:Xs,range:n,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,no],[this.userId,Number.POSITIVE_INFINITY]);return Ai(e).J(Xs,n).next(r=>r.map(i=>Hs(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=xd(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return Ko(e).ee({range:i},(o,a,l)=>{const[u,f,m]=o,g=Cr(f);if(u===this.userId&&n.path.isEqual(g))return Ai(e).get(m).next(v=>{if(!v)throw he(61480,{nr:o,batchId:m});_e(v.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:v.userId,batchId:m}),s.push(Hs(this.serializer,v))});l.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Xe(we);const i=[];return n.forEach(s=>{const o=xd(this.userId,s.path),a=IDBKeyRange.lowerBound(o),l=Ko(e).ee({range:a},(u,f,m)=>{const[g,v,T]=u,P=Cr(v);g===this.userId&&s.path.isEqual(P)?r=r.add(T):m.done()});i.push(l)}),z.waitFor(i).next(()=>this.rr(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1,s=xd(this.userId,r),o=IDBKeyRange.lowerBound(s);let a=new Xe(we);return Ko(e).ee({range:o},(l,u,f)=>{const[m,g,v]=l,T=Cr(g);m===this.userId&&r.isPrefixOf(T)?T.length===i&&(a=a.add(v)):f.done()}).next(()=>this.rr(e,a))}rr(e,n){const r=[],i=[];return n.forEach(s=>{i.push(Ai(e).get(s).next(o=>{if(o===null)throw he(35274,{batchId:s});_e(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:s}),r.push(Hs(this.serializer,o))}))}),z.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return oA(e.le,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.ir(n.batchId)}),z.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return z.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return Ko(e).ee({range:r},(s,o,a)=>{if(s[0]===this.userId){const l=Cr(s[1]);i.push(l)}else a.done()}).next(()=>{_e(i.length===0,56720,{sr:i.map(s=>s.canonicalString())})})})}containsKey(e,n){return aA(e,this.userId,n)}_r(e){return lA(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:no,lastStreamToken:""})}}function aA(t,e,n){const r=xd(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return Ko(t).ee({range:s,X:!0},(a,l,u)=>{const[f,m,g]=a;f===e&&m===i&&(o=!0),u.done()}).next(()=>o)}function Ai(t){return Mt(t,nr)}function Ko(t){return Mt(t,ba)}function lA(t){return Mt(t,Nu)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yo{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new yo(0)}static cr(){return new yo(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B4{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.lr(e).next(n=>{const r=new yo(n.highestTargetId);return n.highestTargetId=r.next(),this.hr(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.lr(e).next(n=>ye.fromTimestamp(new Ke(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.lr(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.lr(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.hr(e,i)))}addTargetData(e,n){return this.Pr(e,n).next(()=>this.lr(e).next(r=>(r.targetCount+=1,this.Tr(n,r),this.hr(e,r))))}updateTargetData(e,n){return this.Pr(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>zo(e).delete(n.targetId)).next(()=>this.lr(e)).next(r=>(_e(r.targetCount>0,8065),r.targetCount-=1,this.hr(e,r)))}removeTargets(e,n,r){let i=0;const s=[];return zo(e).ee((o,a)=>{const l=Ul(a);l.sequenceNumber<=n&&r.get(l.targetId)===null&&(i++,s.push(this.removeTargetData(e,l)))}).next(()=>z.waitFor(s)).next(()=>i)}forEachTarget(e,n){return zo(e).ee((r,i)=>{const s=Ul(i);n(s)})}lr(e){return ww(e).get(vh).next(n=>(_e(n!==null,2888),n))}hr(e,n){return ww(e).put(vh,n)}Pr(e,n){return zo(e).put(tA(this.serializer,n))}Tr(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next(n=>n.targetCount)}getTargetData(e,n){const r=mo(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return zo(e).ee({range:i,index:ex},(o,a,l)=>{const u=Ul(a);Zu(n,u.target)&&(s=u,l.done())}).next(()=>s)}addMatchingKeys(e,n,r){const i=[],s=Fi(e);return n.forEach(o=>{const a=nn(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),z.waitFor(i)}removeMatchingKeys(e,n,r){const i=Fi(e);return z.forEach(n,s=>{const o=nn(s.path);return z.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){const r=Fi(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),i=Fi(e);let s=Ae();return i.ee({range:r,X:!0},(o,a,l)=>{const u=Cr(o[1]),f=new oe(u);s=s.add(f)}).next(()=>s)}containsKey(e,n){const r=nn(n.path),i=IDBKeyRange.bound([r],[$0(r)],!1,!0);let s=0;return Fi(e).ee({index:M_,X:!0,range:i},([o,a],l,u)=>{o!==0&&(s++,u.done())}).next(()=>s>0)}At(e,n){return zo(e).get(n).next(r=>r?Ul(r):null)}}function zo(t){return Mt(t,Da)}function ww(t){return Mt(t,ro)}function Fi(t){return Mt(t,Ma)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iw="LruGarbageCollector",G4=1048576;function Sw([t,e],[n,r]){const i=we(t,n);return i===0?we(e,r):i}class q4{constructor(e){this.Ir=e,this.buffer=new Xe(Sw),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();Sw(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class uA{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){te(Iw,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){ms(n)?te(Iw,"Ignoring IndexedDB error during garbage collection: ",n):await Io(n)}await this.Vr(3e5)})}}class z4{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return z.resolve(qn.ce);const r=new q4(n);return this.mr.forEachTarget(e,i=>r.Ar(i.sequenceNumber)).next(()=>this.mr.pr(e,i=>r.Ar(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.mr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(te("LruGarbageCollector","Garbage collection skipped; disabled"),z.resolve(Ew)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(te("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Ew):this.yr(e,n))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let r,i,s,o,a,l,u;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(m=>(m>this.params.maximumSequenceNumbersToCollect?(te("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),i=this.params.maximumSequenceNumbersToCollect):i=m,o=Date.now(),this.nthSequenceNumber(e,i))).next(m=>(r=m,a=Date.now(),this.removeTargets(e,r,n))).next(m=>(s=m,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(m=>(u=Date.now(),$o()<=Me.DEBUG&&te("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-f}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(l-a)+`ms
	Removed ${m} documents in `+(u-l)+`ms
Total Duration: ${u-f}ms`),z.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:m})))}}function cA(t,e){return new z4(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $4{constructor(e,n){this.db=e,this.garbageCollector=cA(this,n)}gr(e){const n=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}pr(e,n){return this.Sr(e,(r,i)=>n(i))}addReference(e,n,r){return rd(e,r)}removeReference(e,n,r){return rd(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return rd(e,n)}br(e,n){return function(i,s){let o=!1;return lA(i).te(a=>aA(i,a,s).next(l=>(l&&(o=!0),z.resolve(!l)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Sr(e,(o,a)=>{if(a<=n){const l=this.br(e,o).next(u=>{if(!u)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,ye.min()),Fi(e).delete(function(m){return[0,nn(m.path)]}(o))))});i.push(l)}}).next(()=>z.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return rd(e,n)}Sr(e,n){const r=Fi(e);let i,s=qn.ce;return r.ee({index:M_},([o,a],{path:l,sequenceNumber:u})=>{o===0?(s!==qn.ce&&n(new oe(Cr(i)),s),s=u,i=l):s=qn.ce}).next(()=>{s!==qn.ce&&n(new oe(Cr(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function rd(t,e){return Fi(t).put(function(r,i){return{targetId:0,path:nn(r.path),sequenceNumber:i}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dA{constructor(){this.changes=new ci(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Tt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?z.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H4{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return Ls(e).put(r)}removeEntry(e,n,r){return Ls(e).delete(function(s,o){const a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],xh(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.Dr(e,r)))}getEntry(e,n){let r=Tt.newInvalidDocument(n);return Ls(e).ee({index:Ad,range:IDBKeyRange.only(Pl(n))},(i,s)=>{r=this.Cr(n,s)}).next(()=>r)}vr(e,n){let r={size:0,document:Tt.newInvalidDocument(n)};return Ls(e).ee({index:Ad,range:IDBKeyRange.only(Pl(n))},(i,s)=>{r={document:this.Cr(n,s),size:Rh(s)}}).next(()=>r)}getEntries(e,n){let r=Pn();return this.Fr(e,n,(i,s)=>{const o=this.Cr(i,s);r=r.insert(i,o)}).next(()=>r)}Mr(e,n){let r=Pn(),i=new ht(oe.comparator);return this.Fr(e,n,(s,o)=>{const a=this.Cr(s,o);r=r.insert(s,a),i=i.insert(s,Rh(o))}).next(()=>({documents:r,Or:i}))}Fr(e,n,r){if(n.isEmpty())return z.resolve();let i=new Xe(Aw);n.forEach(l=>i=i.add(l));const s=IDBKeyRange.bound(Pl(i.first()),Pl(i.last())),o=i.getIterator();let a=o.getNext();return Ls(e).ee({index:Ad,range:s},(l,u,f)=>{const m=oe.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;a&&Aw(a,m)<0;)r(a,null),a=o.getNext();a&&a.isEqual(m)&&(r(a,u),a=o.hasNext()?o.getNext():null),a?f.j(Pl(a)):f.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,s){const o=n.path,a=[o.popLast().toArray(),o.lastSegment(),xh(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Ls(e).J(IDBKeyRange.bound(a,l,!0)).next(u=>{s==null||s.incrementDocumentReadCount(u.length);let f=Pn();for(const m of u){const g=this.Cr(oe.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);g.isFoundDocument()&&(nc(n,g)||i.has(g.key))&&(f=f.insert(g.key,g))}return f})}getAllFromCollectionGroup(e,n,r,i){let s=Pn();const o=xw(n,r),a=xw(n,bn.max());return Ls(e).ee({index:Z0,range:IDBKeyRange.bound(o,a,!0)},(l,u,f)=>{const m=this.Cr(oe.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);s=s.insert(m.key,m),s.size===i&&f.done()}).next(()=>s)}newChangeBuffer(e){return new j4(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return Cw(e).get($m).next(n=>(_e(!!n,20021),n))}Dr(e,n){return Cw(e).put($m,n)}Cr(e,n){if(n){const r=k4(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(ye.min())))return r}return Tt.newInvalidDocument(e)}}function hA(t){return new H4(t)}class j4 extends dA{constructor(e,n){super(),this.Nr=e,this.trackRemovals=n,this.Br=new ci(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const n=[];let r=0,i=new Xe((s,o)=>we(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const a=this.Br.get(s);if(n.push(this.Nr.removeEntry(e,s,a.readTime)),o.isValidDocument()){const l=lw(this.Nr.serializer,o);i=i.add(s.path.popLast());const u=Rh(l);r+=u-a.size,n.push(this.Nr.addEntry(e,s,l))}else if(r-=a.size,this.trackRemovals){const l=lw(this.Nr.serializer,o.convertToNoDocument(ye.min()));n.push(this.Nr.addEntry(e,s,l))}}),i.forEach(s=>{n.push(this.Nr.indexManager.addToCollectionParentIndex(e,s))}),n.push(this.Nr.updateMetadata(e,r)),z.waitFor(n)}getFromCache(e,n){return this.Nr.vr(e,n).next(r=>(this.Br.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.Nr.Mr(e,n).next(({documents:r,Or:i})=>(i.forEach((s,o)=>{this.Br.set(s,{size:o,readTime:r.get(s).readTime})}),r))}}function Cw(t){return Mt(t,bu)}function Ls(t){return Mt(t,yh)}function Pl(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function xw(t,e){const n=e.documentKey.path.toArray();return[t,xh(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function Aw(t,e){const n=t.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=we(n[s],r[s]),i)return i;return i=we(n.length,r.length),i||(i=we(n[n.length-2],r[r.length-2]),i||we(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W4{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fA{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&ou(r.mutation,i,gn.empty(),Ke.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Ae()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Ae()){const i=xr();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=Ll();return s.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=xr();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Ae()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=Pn();const o=su(),a=function(){return su()}();return n.forEach((l,u)=>{const f=r.get(u.key);i.has(u.key)&&(f===void 0||f.mutation instanceof di)?s=s.insert(u.key,u):f!==void 0?(o.set(u.key,f.mutation.getFieldMask()),ou(f.mutation,u,f.mutation.getFieldMask(),Ke.now())):o.set(u.key,gn.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((u,f)=>o.set(u,f)),n.forEach((u,f)=>a.set(u,new W4(f,o.get(u)??null))),a))}recalculateAndSaveOverlays(e,n){const r=su();let i=new ht((o,a)=>o-a),s=Ae();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const u=n.get(l);if(u===null)return;let f=r.get(l)||gn.empty();f=a.applyToLocalView(u,f),r.set(l,f);const m=(i.get(a.batchId)||Ae()).add(l);i=i.insert(a.batchId,m)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),u=l.key,f=l.value,m=kx();f.forEach(g=>{if(!s.has(g)){const v=Fx(n.get(g),r.get(g));v!==null&&m.set(g,v),s=s.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,m))}return z.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return oe.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):Cx(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):z.resolve(xr());let a=Ru,l=s;return o.next(u=>z.forEach(u,(f,m)=>(a<m.largestBatchId&&(a=m.largestBatchId),s.get(f)?z.resolve():this.remoteDocumentCache.getEntry(e,f).next(g=>{l=l.insert(f,g)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,l,u,Ae())).next(f=>({batchId:a,changes:Px(f)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new oe(n)).next(r=>{let i=Ll();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let o=Ll();return this.indexManager.getCollectionParents(e,s).next(a=>z.forEach(a,l=>{const u=function(m,g){return new ec(g,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(n,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,r,i).next(f=>{f.forEach((m,g)=>{o=o.insert(m,g)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((l,u)=>{const f=u.getKey();o.get(f)===null&&(o=o.insert(f,Tt.newInvalidDocument(f)))});let a=Ll();return o.forEach((l,u)=>{const f=s.get(l);f!==void 0&&ou(f.mutation,u,gn.empty(),Ke.now()),nc(n,u)&&(a=a.insert(l,u))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K4{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return z.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:cn(i.createTime)}}(n)),z.resolve()}getNamedQuery(e,n){return z.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,function(i){return{name:i.name,query:nA(i.bundledQuery),readTime:cn(i.readTime)}}(n)),z.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J4{constructor(){this.overlays=new ht(oe.comparator),this.qr=new Map}getOverlay(e,n){return z.resolve(this.overlays.get(n))}getOverlays(e,n){const r=xr();return z.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.St(e,n,s)}),z.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.qr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.qr.delete(r)),z.resolve()}getOverlaysForCollection(e,n,r){const i=xr(),s=n.length+1,o=new oe(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,u=l.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return z.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new ht((u,f)=>u-f);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let f=s.get(u.largestBatchId);f===null&&(f=xr(),s=s.insert(u.largestBatchId,f)),f.set(u.getKey(),u)}}const a=xr(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((u,f)=>a.set(u,f)),!(a.size()>=i)););return z.resolve(a)}St(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new H_(n,r));let s=this.qr.get(n);s===void 0&&(s=Ae(),this.qr.set(n,s)),this.qr.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q4{constructor(){this.sessionToken=It.EMPTY_BYTE_STRING}getSessionToken(e){return z.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,z.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q_{constructor(){this.Qr=new Xe(Ft.$r),this.Ur=new Xe(Ft.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const r=new Ft(e,n);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Gr(new Ft(e,n))}zr(e,n){e.forEach(r=>this.removeReference(r,n))}jr(e){const n=new oe(new je([])),r=new Ft(n,e),i=new Ft(n,e+1),s=[];return this.Ur.forEachInRange([r,i],o=>{this.Gr(o),s.push(o.key)}),s}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new oe(new je([])),r=new Ft(n,e),i=new Ft(n,e+1);let s=Ae();return this.Ur.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const n=new Ft(e,0),r=this.Qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Ft{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return oe.comparator(e.key,n.key)||we(e.Yr,n.Yr)}static Kr(e,n){return we(e.Yr,n.Yr)||oe.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y4{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new Xe(Ft.$r)}checkEmpty(e){return z.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new z_(s,n,r,i);this.mutationQueue.push(o);for(const a of i)this.Zr=this.Zr.add(new Ft(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return z.resolve(o)}lookupMutationBatch(e,n){return z.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.ei(r),s=i<0?0:i;return z.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return z.resolve(this.mutationQueue.length===0?no:this.tr-1)}getAllMutationBatches(e){return z.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Ft(n,0),i=new Ft(n,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([r,i],o=>{const a=this.Xr(o.Yr);s.push(a)}),z.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Xe(we);return n.forEach(i=>{const s=new Ft(i,0),o=new Ft(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,o],a=>{r=r.add(a.Yr)})}),z.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;oe.isDocumentKey(s)||(s=s.child(""));const o=new Ft(new oe(s),0);let a=new Xe(we);return this.Zr.forEachWhile(l=>{const u=l.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(a=a.add(l.Yr)),!0)},o),z.resolve(this.ti(a))}ti(e){const n=[];return e.forEach(r=>{const i=this.Xr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){_e(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return z.forEach(n.mutations,i=>{const s=new Ft(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,n){const r=new Ft(n,0),i=this.Zr.firstAfterOrEqual(r);return z.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,z.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X4{constructor(e){this.ri=e,this.docs=function(){return new ht(oe.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.ri(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return z.resolve(r?r.document.mutableCopy():Tt.newInvalidDocument(n))}getEntries(e,n){let r=Pn();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Tt.newInvalidDocument(i))}),z.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=Pn();const o=n.path,a=new oe(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:u,value:{document:f}}=l.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||b_(K0(f),r)<=0||(i.has(f.key)||nc(n,f))&&(s=s.insert(f.key,f.mutableCopy()))}return z.resolve(s)}getAllFromCollectionGroup(e,n,r,i){he(9500)}ii(e,n){return z.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new Z4(this)}getSize(e){return z.resolve(this.size)}}class Z4 extends dA{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)}),z.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eO{constructor(e){this.persistence=e,this.si=new ci(n=>mo(n),Zu),this.lastRemoteSnapshotVersion=ye.min(),this.highestTargetId=0,this.oi=0,this._i=new Q_,this.targetCount=0,this.ai=yo.ur()}forEachTarget(e,n){return this.si.forEach((r,i)=>n(i)),z.resolve()}getLastRemoteSnapshotVersion(e){return z.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return z.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),z.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.oi&&(this.oi=n),z.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new yo(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,z.resolve()}updateTargetData(e,n){return this.Pr(n),z.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,z.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.si.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.si.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),z.waitFor(s).next(()=>i)}getTargetCount(e){return z.resolve(this.targetCount)}getTargetData(e,n){const r=this.si.get(n)||null;return z.resolve(r)}addMatchingKeys(e,n,r){return this._i.Wr(n,r),z.resolve()}removeMatchingKeys(e,n,r){this._i.zr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),z.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),z.resolve()}getMatchingKeysForTargetId(e,n){const r=this._i.Hr(n);return z.resolve(r)}containsKey(e,n){return z.resolve(this._i.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y_{constructor(e,n){this.ui={},this.overlays={},this.ci=new qn(0),this.li=!1,this.li=!0,this.hi=new Q4,this.referenceDelegate=e(this),this.Pi=new eO(this),this.indexManager=new U4,this.remoteDocumentCache=function(i){return new X4(i)}(r=>this.referenceDelegate.Ti(r)),this.serializer=new eA(n),this.Ii=new K4(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new J4,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ui[e.toKey()];return r||(r=new Y4(n,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,r){te("MemoryPersistence","Starting transaction:",e);const i=new tO(this.ci.next());return this.referenceDelegate.Ei(),r(i).next(s=>this.referenceDelegate.di(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ai(e,n){return z.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,n)))}}class tO extends Q0{constructor(e){super(),this.currentSequenceNumber=e}}class Ef{constructor(e){this.persistence=e,this.Ri=new Q_,this.Vi=null}static mi(e){return new Ef(e)}get fi(){if(this.Vi)return this.Vi;throw he(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.fi.delete(r.toString()),z.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.fi.add(r.toString()),z.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),z.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach(i=>this.fi.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.fi.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return z.forEach(this.fi,r=>{const i=oe.fromPath(r);return this.gi(e,i).next(s=>{s||n.removeEntry(i,ye.min())})}).next(()=>(this.Vi=null,n.apply(e)))}updateLimboDocument(e,n){return this.gi(e,n).next(r=>{r?this.fi.delete(n.toString()):this.fi.add(n.toString())})}Ti(e){return 0}gi(e,n){return z.or([()=>z.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class Ph{constructor(e,n){this.persistence=e,this.pi=new ci(r=>nn(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=cA(this,n)}static mi(e,n){return new Ph(e,n)}Ei(){}di(e){return z.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}pr(e,n){return z.forEach(this.pi,(r,i)=>this.br(e,r,i).next(s=>s?z.resolve():n(i)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ii(e,o=>this.br(e,o,n).next(a=>{a||(r++,s.removeEntry(o,ye.min()))})).next(()=>s.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),z.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),z.resolve()}removeReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),z.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),z.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=Pd(e.data.value)),n}br(e,n,r){return z.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const i=this.pi.get(n);return z.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nO{constructor(e){this.serializer=e}k(e,n,r,i){const s=new af("createOrUpgrade",n);r<1&&i>=1&&(function(l){l.createObjectStore(Xu)}(e),function(l){l.createObjectStore(Nu,{keyPath:fU}),l.createObjectStore(nr,{keyPath:UE,autoIncrement:!0}).createIndex(Xs,OE,{unique:!0}),l.createObjectStore(ba)}(e),Rw(e),function(l){l.createObjectStore(qs)}(e));let o=z.resolve();return r<3&&i>=3&&(r!==0&&(function(l){l.deleteObjectStore(Ma),l.deleteObjectStore(Da),l.deleteObjectStore(ro)}(e),Rw(e)),o=o.next(()=>function(l){const u=l.store(ro),f={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:ye.min().toTimestamp(),targetCount:0};return u.put(vh,f)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(l,u){return u.store(nr).J().next(m=>{l.deleteObjectStore(nr),l.createObjectStore(nr,{keyPath:UE,autoIncrement:!0}).createIndex(Xs,OE,{unique:!0});const g=u.store(nr),v=m.map(T=>g.put(T));return z.waitFor(v)})}(e,s))),o=o.next(()=>{(function(l){l.createObjectStore(Va,{keyPath:wU})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.yi(s))),r<6&&i>=6&&(o=o.next(()=>(function(l){l.createObjectStore(bu)}(e),this.wi(s)))),r<7&&i>=7&&(o=o.next(()=>this.Si(s))),r<8&&i>=8&&(o=o.next(()=>this.bi(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.Di(s))),r<11&&i>=11&&(o=o.next(()=>{(function(l){l.createObjectStore(uf,{keyPath:IU})})(e),function(l){l.createObjectStore(cf,{keyPath:SU})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(l){const u=l.createObjectStore(df,{keyPath:NU});u.createIndex(jm,bU,{unique:!1}),u.createIndex(rx,DU,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(l){const u=l.createObjectStore(yh,{keyPath:mU});u.createIndex(Ad,gU),u.createIndex(Z0,_U)}(e)).next(()=>this.Ci(e,s)).next(()=>e.deleteObjectStore(qs))),r<14&&i>=14&&(o=o.next(()=>this.Fi(e,s))),r<15&&i>=15&&(o=o.next(()=>function(l){l.createObjectStore(V_,{keyPath:CU,autoIncrement:!0}).createIndex(Hm,xU,{unique:!1}),l.createObjectStore(tu,{keyPath:AU}).createIndex(tx,RU,{unique:!1}),l.createObjectStore(nu,{keyPath:PU}).createIndex(nx,kU,{unique:!1})}(e))),r<16&&i>=16&&(o=o.next(()=>{n.objectStore(tu).clear()}).next(()=>{n.objectStore(nu).clear()})),r<17&&i>=17&&(o=o.next(()=>{(function(l){l.createObjectStore(L_,{keyPath:MU})})(e)})),r<18&&i>=18&&JC()&&(o=o.next(()=>{n.objectStore(tu).clear()}).next(()=>{n.objectStore(nu).clear()})),o}wi(e){let n=0;return e.store(qs).ee((r,i)=>{n+=Rh(i)}).next(()=>{const r={byteSize:n};return e.store(bu).put($m,r)})}yi(e){const n=e.store(Nu),r=e.store(nr);return n.J().next(i=>z.forEach(i,s=>{const o=IDBKeyRange.bound([s.userId,no],[s.userId,s.lastAcknowledgedBatchId]);return r.J(Xs,o).next(a=>z.forEach(a,l=>{_e(l.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:l.batchId});const u=Hs(this.serializer,l);return oA(e,s.userId,u).next(()=>{})}))}))}Si(e){const n=e.store(Ma),r=e.store(qs);return e.store(ro).get(vh).next(i=>{const s=[];return r.ee((o,a)=>{const l=new je(o),u=function(m){return[0,nn(m)]}(l);s.push(n.get(u).next(f=>f?z.resolve():(m=>n.put({targetId:0,path:nn(m),sequenceNumber:i.highestListenSequenceNumber}))(l)))}).next(()=>z.waitFor(s))})}bi(e,n){e.createObjectStore(Du,{keyPath:EU});const r=n.store(Du),i=new J_,s=o=>{if(i.add(o)){const a=o.lastSegment(),l=o.popLast();return r.put({collectionId:a,parent:nn(l)})}};return n.store(qs).ee({X:!0},(o,a)=>{const l=new je(o);return s(l.popLast())}).next(()=>n.store(ba).ee({X:!0},([o,a,l],u)=>{const f=Cr(a);return s(f.popLast())}))}Di(e){const n=e.store(Da);return n.ee((r,i)=>{const s=Ul(i),o=tA(this.serializer,s);return n.put(o)})}Ci(e,n){const r=n.store(qs),i=[];return r.ee((s,o)=>{const a=n.store(yh),l=function(m){return m.document?new oe(je.fromString(m.document.name).popFirst(5)):m.noDocument?oe.fromSegments(m.noDocument.path):m.unknownDocument?oe.fromSegments(m.unknownDocument.path):he(36783)}(o).path.toArray(),u={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(u))}).next(()=>z.waitFor(i))}Fi(e,n){const r=n.store(nr),i=hA(this.serializer),s=new Y_(Ef.mi,this.serializer.yt);return r.J().next(o=>{const a=new Map;return o.forEach(l=>{let u=a.get(l.userId)??Ae();Hs(this.serializer,l).keys().forEach(f=>u=u.add(f)),a.set(l.userId,u)}),z.forEach(a,(l,u)=>{const f=new Ht(u),m=vf.wt(this.serializer,f),g=s.getIndexManager(f),v=Tf.wt(f,this.serializer,g,s.referenceDelegate);return new fA(i,v,m,g).recalculateAndSaveOverlaysForDocumentKeys(new Wm(n,qn.ce),l).next()})})}}function Rw(t){t.createObjectStore(Ma,{keyPath:vU}).createIndex(M_,TU,{unique:!0}),t.createObjectStore(Da,{keyPath:"targetId"}).createIndex(ex,yU,{unique:!0}),t.createObjectStore(ro)}const Ri="IndexedDbPersistence",Ip=18e5,Sp=5e3,Cp="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",rO="main";class X_{constructor(e,n,r,i,s,o,a,l,u,f,m=18){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Mi=s,this.window=o,this.document=a,this.xi=u,this.Oi=f,this.Ni=m,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=g=>Promise.resolve(),!X_.v())throw new se(Q.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new $4(this,i),this.$i=n+rO,this.serializer=new eA(l),this.Ui=new Zi(this.$i,this.Ni,new nO(this.serializer)),this.hi=new b4,this.Pi=new B4(this.referenceDelegate,this.serializer),this.remoteDocumentCache=hA(this.serializer),this.Ii=new N4,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,f===!1&&on(Ri,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new se(Q.FAILED_PRECONDITION,Cp);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Pi.getHighestSequenceNumber(e))}).then(e=>{this.ci=new qn(e,this.xi)}).then(()=>{this.li=!0}).catch(e=>(this.Ui&&this.Ui.close(),Promise.reject(e)))}Ji(e){return this.Qi=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget(async()=>{this.started&&await this.Wi()}))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>id(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Hi(e).next(n=>{n||(this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)))})}).next(()=>this.Yi(e)).next(n=>this.isPrimary&&!n?this.Zi(e).next(()=>!1):!!n&&this.Xi(e).next(()=>!0))).catch(e=>{if(ms(e))return te(Ri,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return te(Ri,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable(()=>this.Qi(e)),this.isPrimary=e})}Hi(e){return kl(e).get(Uo).next(n=>z.resolve(this.es(n)))}ts(e){return id(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,Ip)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=Mt(n,Va);return r.J().next(i=>{const s=this.ss(i,Ip),o=i.filter(a=>s.indexOf(a)===-1);return z.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Ki)for(const n of e)this.Ki.removeItem(this._s(n.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Wi().then(()=>this.ns()).then(()=>this.ji()))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?z.resolve(!0):kl(e).get(Uo).next(n=>{if(n!==null&&this.rs(n.leaseTimestampMs,Sp)&&!this.us(n.ownerId)){if(this.es(n)&&this.networkEnabled)return!0;if(!this.es(n)){if(!n.allowTabSynchronization)throw new se(Q.FAILED_PRECONDITION,Cp);return!1}}return!(!this.networkEnabled||!this.inForeground)||id(e).J().next(r=>this.ss(r,Sp).find(i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&te(Ri,`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[Xu,Va],e=>{const n=new Wm(e,qn.ce);return this.Zi(n).next(()=>this.ts(n))}),this.Ui.close(),this.Ps()}ss(e,n){return e.filter(r=>this.rs(r.updateTimeMs,n)&&!this.us(r.clientId))}Ts(){return this.runTransaction("getActiveClients","readonly",e=>id(e).J().next(n=>this.ss(n,Ip).map(r=>r.clientId)))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,n){return Tf.wt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new O4(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return vf.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,n,r){te(Ri,"Starting transaction:",e);const i=n==="readonly"?"readonly":"readwrite",s=function(l){return l===18?FU:l===17?ax:l===16?LU:l===15?F_:l===14?ox:l===13?sx:l===12?VU:l===11?ix:void he(60245)}(this.Ni);let o;return this.Ui.runTransaction(e,i,s,a=>(o=new Wm(a,this.ci?this.ci.next():qn.ce),n==="readwrite-primary"?this.Hi(o).next(l=>!!l||this.Yi(o)).next(l=>{if(!l)throw on(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)),new se(Q.FAILED_PRECONDITION,J0);return r(o)}).next(l=>this.Xi(o).next(()=>l)):this.Is(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Is(e){return kl(e).get(Uo).next(n=>{if(n!==null&&this.rs(n.leaseTimestampMs,Sp)&&!this.us(n.ownerId)&&!this.es(n)&&!(this.Oi||this.allowTabSynchronization&&n.allowTabSynchronization))throw new se(Q.FAILED_PRECONDITION,Cp)})}Xi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return kl(e).put(Uo,n)}static v(){return Zi.v()}Zi(e){const n=kl(e);return n.get(Uo).next(r=>this.es(r)?(te(Ri,"Releasing primary lease."),n.delete(Uo)):z.resolve())}rs(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(on(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi()))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){var e;typeof((e=this.window)==null?void 0:e.addEventListener)=="function"&&(this.Bi=()=>{this.cs();const n=/(?:Version|Mobile)\/1[456]/;KC()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){var n;try{const r=((n=this.Ki)==null?void 0:n.getItem(this._s(e)))!==null;return te(Ri,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return on(Ri,"Failed to get zombied client id.",r),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){on("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function kl(t){return Mt(t,Xu)}function id(t){return Mt(t,Va)}function iO(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z_{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.Es=r,this.ds=i}static As(e,n){let r=Ae(),i=Ae();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new Z_(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sO{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pA{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return KC()?8:Y0(bt())>0?6:4}()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.ys(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ws(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new sO;return this.Ss(e,n,o).next(a=>{if(s.result=a,this.Vs)return this.bs(e,n,o,a.size)})}).next(()=>s.result)}bs(e,n,r,i){return r.documentReadCount<this.fs?($o()<=Me.DEBUG&&te("QueryEngine","SDK will not create cache indexes for query:",Ho(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),z.resolve()):($o()<=Me.DEBUG&&te("QueryEngine","Query:",Ho(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?($o()<=Me.DEBUG&&te("QueryEngine","The SDK decides to create cache indexes for query:",Ho(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Hn(n))):z.resolve())}ys(e,n){if(XE(n))return z.resolve(null);let r=Hn(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=eg(n,null,"F"),r=Hn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=Ae(...s);return this.ps.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const u=this.Ds(n,a);return this.Cs(n,u,o,l.readTime)?this.ys(e,eg(n,null,"F")):this.vs(e,u,n,l)}))})))}ws(e,n,r,i){return XE(n)||i.isEqual(ye.min())?z.resolve(null):this.ps.getDocuments(e,r).next(s=>{const o=this.Ds(n,s);return this.Cs(n,o,r,i)?z.resolve(null):($o()<=Me.DEBUG&&te("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Ho(n)),this.vs(e,o,n,oU(i,Ru)).next(a=>a))})}Ds(e,n){let r=new Xe(Ax(e));return n.forEach((i,s)=>{nc(e,s)&&(r=r.add(s))}),r}Cs(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ss(e,n,r){return $o()<=Me.DEBUG&&te("QueryEngine","Using full collection scan to execute query:",Ho(n)),this.ps.getDocumentsMatchingQuery(e,n,bn.min(),r)}vs(e,n,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ey="LocalStore",oO=3e8;class aO{constructor(e,n,r,i){this.persistence=e,this.Fs=n,this.serializer=i,this.Ms=new ht(we),this.xs=new ci(s=>mo(s),Zu),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new fA(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ms))}}function mA(t,e,n,r){return new aO(t,e,n,r)}async function gA(t,e){const n=Ie(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.Bs(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],a=[];let l=Ae();for(const u of i){o.push(u.batchId);for(const f of u.mutations)l=l.add(f.key)}for(const u of s){a.push(u.batchId);for(const f of u.mutations)l=l.add(f.key)}return n.localDocuments.getDocuments(r,l).next(u=>({Ls:u,removedBatchIds:o,addedBatchIds:a}))})})}function lO(t,e){const n=Ie(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.Ns.newChangeBuffer({trackRemovals:!0});return function(a,l,u,f){const m=u.batch,g=m.keys();let v=z.resolve();return g.forEach(T=>{v=v.next(()=>f.getEntry(l,T)).next(P=>{const M=u.docVersions.get(T);_e(M!==null,48541),P.version.compareTo(M)<0&&(m.applyToRemoteDocument(P,u),P.isValidDocument()&&(P.setReadTime(u.commitVersion),f.addEntry(P)))})}),v.next(()=>a.mutationQueue.removeMutationBatch(l,m))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=Ae();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(l=l.add(a.batch.mutations[u].key));return l}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function _A(t){const e=Ie(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Pi.getLastRemoteSnapshotVersion(n))}function uO(t,e){const n=Ie(t),r=e.snapshotVersion;let i=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.Ns.newChangeBuffer({trackRemovals:!0});i=n.Ms;const a=[];e.targetChanges.forEach((f,m)=>{const g=i.get(m);if(!g)return;a.push(n.Pi.removeMatchingKeys(s,f.removedDocuments,m).next(()=>n.Pi.addMatchingKeys(s,f.addedDocuments,m)));let v=g.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(m)!==null?v=v.withResumeToken(It.EMPTY_BYTE_STRING,ye.min()).withLastLimboFreeSnapshotVersion(ye.min()):f.resumeToken.approximateByteSize()>0&&(v=v.withResumeToken(f.resumeToken,r)),i=i.insert(m,v),function(P,M,x){return P.resumeToken.approximateByteSize()===0||M.snapshotVersion.toMicroseconds()-P.snapshotVersion.toMicroseconds()>=oO?!0:x.addedDocuments.size+x.modifiedDocuments.size+x.removedDocuments.size>0}(g,v,f)&&a.push(n.Pi.updateTargetData(s,v))});let l=Pn(),u=Ae();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,f))}),a.push(cO(s,o,e.documentUpdates).next(f=>{l=f.ks,u=f.qs})),!r.isEqual(ye.min())){const f=n.Pi.getLastRemoteSnapshotVersion(s).next(m=>n.Pi.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(f)}return z.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,l,u)).next(()=>l)}).then(s=>(n.Ms=i,s))}function cO(t,e,n){let r=Ae(),i=Ae();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=Pn();return n.forEach((a,l)=>{const u=s.get(a);l.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(a)),l.isNoDocument()&&l.version.isEqual(ye.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):te(ey,"Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",l.version)}),{ks:o,qs:i}})}function dO(t,e){const n=Ie(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=no),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function hO(t,e){const n=Ie(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Pi.getTargetData(r,e).next(s=>s?(i=s,z.resolve(i)):n.Pi.allocateTargetId(r).next(o=>(i=new Qr(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Pi.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.Ms.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(r.targetId,r),n.xs.set(e,r.targetId)),r})}async function lg(t,e,n){const r=Ie(t),i=r.Ms.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!ms(o))throw o;te(ey,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(i.target)}function Pw(t,e,n){const r=Ie(t);let i=ye.min(),s=Ae();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,u,f){const m=Ie(l),g=m.xs.get(f);return g!==void 0?z.resolve(m.Ms.get(g)):m.Pi.getTargetData(u,f)}(r,o,Hn(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,a.targetId).next(l=>{s=l})}).next(()=>r.Fs.getDocumentsMatchingQuery(o,e,n?i:ye.min(),n?s:Ae())).next(a=>(fO(r,XU(e),a),{documents:a,Qs:s})))}function fO(t,e,n){let r=t.Os.get(e)||ye.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.Os.set(e,r)}class kw{constructor(){this.activeTargetIds=i4()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class yA{constructor(){this.Mo=new kw,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,r){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new kw,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pO{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nw="ConnectivityMonitor";class bw{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){te(Nw,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){te(Nw,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let sd=null;function ug(){return sd===null?sd=function(){return 268435456+Math.round(2147483648*Math.random())}():sd++,"0x"+sd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xp="RestConnection",mO={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class gO{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===Th?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,n,r,i,s){const o=ug(),a=this.zo(e,n.toUriEncodedString());te(xp,`Sending RPC '${e}' ${o}:`,a,r);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,i,s);const{host:u}=new URL(a),f=Xa(u);return this.Jo(e,a,l,r,f).then(m=>(te(xp,`Received RPC '${e}' ${o}: `,m),m),m=>{throw ss(xp,`RPC '${e}' ${o} failed with error: `,m,"url: ",a,"request:",r),m})}Ho(e,n,r,i,s,o){return this.Go(e,n,r,i,s)}jo(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+tl}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((i,s)=>e[s]=i),r&&r.headers.forEach((i,s)=>e[s]=i)}zo(e,n){const r=mO[e];return`${this.Uo}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _O{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yt="WebChannelConnection";class yO extends gO{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,i,s){const o=ug();return new Promise((a,l)=>{const u=new V0;u.setWithCredentials(!0),u.listenOnce(L0.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case Sd.NO_ERROR:const m=u.getResponseJson();te(Yt,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(m)),a(m);break;case Sd.TIMEOUT:te(Yt,`RPC '${e}' ${o} timed out`),l(new se(Q.DEADLINE_EXCEEDED,"Request time out"));break;case Sd.HTTP_ERROR:const g=u.getStatus();if(te(Yt,`RPC '${e}' ${o} failed with status:`,g,"response text:",u.getResponseText()),g>0){let v=u.getResponseJson();Array.isArray(v)&&(v=v[0]);const T=v==null?void 0:v.error;if(T&&T.status&&T.message){const P=function(x){const E=x.toLowerCase().replace(/_/g,"-");return Object.values(Q).indexOf(E)>=0?E:Q.UNKNOWN}(T.status);l(new se(P,T.message))}else l(new se(Q.UNKNOWN,"Server responded with status "+u.getStatus()))}else l(new se(Q.UNAVAILABLE,"Connection failed."));break;default:he(9055,{l_:e,streamId:o,h_:u.getLastErrorCode(),P_:u.getLastError()})}}finally{te(Yt,`RPC '${e}' ${o} completed.`)}});const f=JSON.stringify(i);te(Yt,`RPC '${e}' ${o} sending request:`,i),u.send(n,"POST",f,r,15)})}T_(e,n,r){const i=ug(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=O0(),a=U0(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(l.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,n,r),l.encodeInitMessageHeaders=!0;const f=s.join("");te(Yt,`Creating RPC '${e}' stream ${i}: ${f}`,l);const m=o.createWebChannel(f,l);this.I_(m);let g=!1,v=!1;const T=new _O({Yo:M=>{v?te(Yt,`Not sending because RPC '${e}' stream ${i} is closed:`,M):(g||(te(Yt,`Opening RPC '${e}' stream ${i} transport.`),m.open(),g=!0),te(Yt,`RPC '${e}' stream ${i} sending:`,M),m.send(M))},Zo:()=>m.close()}),P=(M,x,E)=>{M.listen(x,A=>{try{E(A)}catch(V){setTimeout(()=>{throw V},0)}})};return P(m,Vl.EventType.OPEN,()=>{v||(te(Yt,`RPC '${e}' stream ${i} transport opened.`),T.o_())}),P(m,Vl.EventType.CLOSE,()=>{v||(v=!0,te(Yt,`RPC '${e}' stream ${i} transport closed`),T.a_(),this.E_(m))}),P(m,Vl.EventType.ERROR,M=>{v||(v=!0,ss(Yt,`RPC '${e}' stream ${i} transport errored. Name:`,M.name,"Message:",M.message),T.a_(new se(Q.UNAVAILABLE,"The operation could not be completed")))}),P(m,Vl.EventType.MESSAGE,M=>{var x;if(!v){const E=M.data[0];_e(!!E,16349);const A=E,V=(A==null?void 0:A.error)||((x=A[0])==null?void 0:x.error);if(V){te(Yt,`RPC '${e}' stream ${i} received error:`,V);const B=V.status;let G=function(R){const N=Ct[R];if(N!==void 0)return Bx(N)}(B),I=V.message;G===void 0&&(G=Q.INTERNAL,I="Unknown error status: "+B+" with message "+V.message),v=!0,T.a_(new se(G,I)),m.close()}else te(Yt,`RPC '${e}' stream ${i} received:`,E),T.u_(E)}}),P(a,F0.STAT_EVENT,M=>{M.stat===Gm.PROXY?te(Yt,`RPC '${e}' stream ${i} detected buffering proxy`):M.stat===Gm.NOPROXY&&te(Yt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{T.__()},0),T}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(n=>n===e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vO(){return typeof window<"u"?window:null}function Md(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wf(t){return new T4(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vA{constructor(e,n,r=1e3,i=1.5,s=6e4){this.Mi=e,this.timerId=n,this.d_=r,this.A_=i,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,n-r);i>0&&te("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dw="PersistentStream";class TA{constructor(e,n,r,i,s,o,a,l){this.Mi=e,this.S_=r,this.b_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new vA(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===Q.RESOURCE_EXHAUSTED?(on(n.toString()),on("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===Q.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.D_===n&&this.G_(r,i)},r=>{e(()=>{const i=new se(Q.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)})})}G_(e,n){const r=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(i=>{r(()=>this.z_(i))}),this.stream.onMessage(i=>{r(()=>++this.F_==1?this.J_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return te(Dw,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget(()=>this.D_===e?n():(te(Dw,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class TO extends TA{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=I4(this.serializer,e),r=function(s){if(!("targetChange"in s))return ye.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?ye.min():o.readTime?cn(o.readTime):ye.min()}(e);return this.listener.H_(n,r)}Y_(e){const n={};n.database=rg(this.serializer),n.addTarget=function(s,o){let a;const l=o.target;if(a=wh(l)?{documents:Kx(s,l)}:{query:Jx(s,l).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=zx(s,o.resumeToken);const u=tg(s,o.expectedCount);u!==null&&(a.expectedCount=u)}else if(o.snapshotVersion.compareTo(ye.min())>0){a.readTime=za(s,o.snapshotVersion.toTimestamp());const u=tg(s,o.expectedCount);u!==null&&(a.expectedCount=u)}return a}(this.serializer,e);const r=C4(this.serializer,e);r&&(n.labels=r),this.q_(n)}Z_(e){const n={};n.database=rg(this.serializer),n.removeTarget=e,this.q_(n)}}class EO extends TA{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return _e(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,_e(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){_e(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=S4(e.writeResults,e.commitTime),r=cn(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=rg(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>Ch(this.serializer,r))};this.q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wO{}class IO extends wO{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new se(Q.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Go(e,ng(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===Q.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new se(Q.UNKNOWN,s.toString())})}Ho(e,n,r,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Ho(e,ng(n,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===Q.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new se(Q.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class SO{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(on(n),this.aa=!1):te("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vo="RemoteStore";class CO{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo(o=>{r.enqueueAndForget(async()=>{So(this)&&(te(vo,"Restarting streams for network reachability change."),await async function(l){const u=Ie(l);u.Ea.add(4),await ic(u),u.Ra.set("Unknown"),u.Ea.delete(4),await If(u)}(this))})}),this.Ra=new SO(r,i)}}async function If(t){if(So(t))for(const e of t.da)await e(!0)}async function ic(t){for(const e of t.da)await e(!1)}function EA(t,e){const n=Ie(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),iy(n)?ry(n):rl(n).O_()&&ny(n,e))}function ty(t,e){const n=Ie(t),r=rl(n);n.Ia.delete(e),r.O_()&&wA(n,e),n.Ia.size===0&&(r.O_()?r.L_():So(n)&&n.Ra.set("Unknown"))}function ny(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ye.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}rl(t).Y_(e)}function wA(t,e){t.Va.Ue(e),rl(t).Z_(e)}function ry(t){t.Va=new g4({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),rl(t).start(),t.Ra.ua()}function iy(t){return So(t)&&!rl(t).x_()&&t.Ia.size>0}function So(t){return Ie(t).Ea.size===0}function IA(t){t.Va=void 0}async function xO(t){t.Ra.set("Online")}async function AO(t){t.Ia.forEach((e,n)=>{ny(t,e)})}async function RO(t,e){IA(t),iy(t)?(t.Ra.ha(e),ry(t)):t.Ra.set("Unknown")}async function PO(t,e,n){if(t.Ra.set("Online"),e instanceof qx&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const a of s.targetIds)i.Ia.has(a)&&(await i.remoteSyncer.rejectListen(a,o),i.Ia.delete(a),i.Va.removeTarget(a))}(t,e)}catch(r){te(vo,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await kh(t,r)}else if(e instanceof bd?t.Va.Ze(e):e instanceof Gx?t.Va.st(e):t.Va.tt(e),!n.isEqual(ye.min()))try{const r=await _A(t.localStore);n.compareTo(r)>=0&&await function(s,o){const a=s.Va.Tt(o);return a.targetChanges.forEach((l,u)=>{if(l.resumeToken.approximateByteSize()>0){const f=s.Ia.get(u);f&&s.Ia.set(u,f.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,u)=>{const f=s.Ia.get(l);if(!f)return;s.Ia.set(l,f.withResumeToken(It.EMPTY_BYTE_STRING,f.snapshotVersion)),wA(s,l);const m=new Qr(f.target,l,u,f.sequenceNumber);ny(s,m)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){te(vo,"Failed to raise snapshot:",r),await kh(t,r)}}async function kh(t,e,n){if(!ms(e))throw e;t.Ea.add(1),await ic(t),t.Ra.set("Offline"),n||(n=()=>_A(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{te(vo,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await If(t)})}function SA(t,e){return e().catch(n=>kh(t,n,e))}async function sc(t){const e=Ie(t),n=us(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:no;for(;kO(e);)try{const i=await dO(e.localStore,r);if(i===null){e.Ta.length===0&&n.L_();break}r=i.batchId,NO(e,i)}catch(i){await kh(e,i)}CA(e)&&xA(e)}function kO(t){return So(t)&&t.Ta.length<10}function NO(t,e){t.Ta.push(e);const n=us(t);n.O_()&&n.X_&&n.ea(e.mutations)}function CA(t){return So(t)&&!us(t).x_()&&t.Ta.length>0}function xA(t){us(t).start()}async function bO(t){us(t).ra()}async function DO(t){const e=us(t);for(const n of t.Ta)e.ea(n.mutations)}async function MO(t,e,n){const r=t.Ta.shift(),i=$_.from(r,e,n);await SA(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await sc(t)}async function VO(t,e){e&&us(t).X_&&await async function(r,i){if(function(o){return f4(o)&&o!==Q.ABORTED}(i.code)){const s=r.Ta.shift();us(r).B_(),await SA(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await sc(r)}}(t,e),CA(t)&&xA(t)}async function Mw(t,e){const n=Ie(t);n.asyncQueue.verifyOperationInProgress(),te(vo,"RemoteStore received new credentials");const r=So(n);n.Ea.add(3),await ic(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await If(n)}async function LO(t,e){const n=Ie(t);e?(n.Ea.delete(2),await If(n)):e||(n.Ea.add(2),await ic(n),n.Ra.set("Unknown"))}function rl(t){return t.ma||(t.ma=function(n,r,i){const s=Ie(n);return s.sa(),new TO(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Xo:xO.bind(null,t),t_:AO.bind(null,t),r_:RO.bind(null,t),H_:PO.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),iy(t)?ry(t):t.Ra.set("Unknown")):(await t.ma.stop(),IA(t))})),t.ma}function us(t){return t.fa||(t.fa=function(n,r,i){const s=Ie(n);return s.sa(),new EO(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:bO.bind(null,t),r_:VO.bind(null,t),ta:DO.bind(null,t),na:MO.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await sc(t)):(await t.fa.stop(),t.Ta.length>0&&(te(vo,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sy{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new kr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const o=Date.now()+r,a=new sy(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new se(Q.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function oy(t,e){if(on("AsyncQueue",`${e}: ${t}`),ms(t))return new se(Q.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ea{static emptySet(e){return new Ea(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||oe.comparator(n.key,r.key):(n,r)=>oe.comparator(n.key,r.key),this.keyedMap=Ll(),this.sortedSet=new ht(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Ea)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Ea;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vw{constructor(){this.ga=new ht(oe.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):he(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,r)=>{e.push(r)}),e}}class $a{constructor(e,n,r,i,s,o,a,l,u){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,n,r,i,s){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new $a(e,n,Ea.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&pf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FO{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class UO{constructor(){this.queries=Lw(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const i=Ie(n),s=i.queries;i.queries=Lw(),s.forEach((o,a)=>{for(const l of a.Sa)l.onError(r)})})(this,new se(Q.ABORTED,"Firestore shutting down"))}}function Lw(){return new ci(t=>xx(t),pf)}async function ay(t,e){const n=Ie(t);let r=3;const i=e.query;let s=n.queries.get(i);s?!s.ba()&&e.Da()&&(r=2):(s=new FO,r=e.Da()?0:1);try{switch(r){case 0:s.wa=await n.onListen(i,!0);break;case 1:s.wa=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(o){const a=oy(o,`Initialization of query '${Ho(e.query)}' failed`);return void e.onError(a)}n.queries.set(i,s),s.Sa.push(e),e.va(n.onlineState),s.wa&&e.Fa(s.wa)&&uy(n)}async function ly(t,e){const n=Ie(t),r=e.query;let i=3;const s=n.queries.get(r);if(s){const o=s.Sa.indexOf(e);o>=0&&(s.Sa.splice(o,1),s.Sa.length===0?i=e.Da()?0:1:!s.ba()&&e.Da()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function OO(t,e){const n=Ie(t);let r=!1;for(const i of e){const s=i.query,o=n.queries.get(s);if(o){for(const a of o.Sa)a.Fa(i)&&(r=!0);o.wa=i}}r&&uy(n)}function BO(t,e,n){const r=Ie(t),i=r.queries.get(e);if(i)for(const s of i.Sa)s.onError(n);r.queries.delete(e)}function uy(t){t.Ca.forEach(e=>{e.next()})}var cg,Fw;(Fw=cg||(cg={})).Ma="default",Fw.Cache="cache";class cy{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new $a(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=$a.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==cg.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AA{constructor(e){this.key=e}}class RA{constructor(e){this.key=e}}class GO{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Ae(),this.mutatedKeys=Ae(),this.eu=Ax(e),this.tu=new Ea(this.eu)}get nu(){return this.Ya}ru(e,n){const r=n?n.iu:new Vw,i=n?n.tu:this.tu;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((f,m)=>{const g=i.get(f),v=nc(this.query,m)?m:null,T=!!g&&this.mutatedKeys.has(g.key),P=!!v&&(v.hasLocalMutations||this.mutatedKeys.has(v.key)&&v.hasCommittedMutations);let M=!1;g&&v?g.data.isEqual(v.data)?T!==P&&(r.track({type:3,doc:v}),M=!0):this.su(g,v)||(r.track({type:2,doc:v}),M=!0,(l&&this.eu(v,l)>0||u&&this.eu(v,u)<0)&&(a=!0)):!g&&v?(r.track({type:0,doc:v}),M=!0):g&&!v&&(r.track({type:1,doc:g}),M=!0,(l||u)&&(a=!0)),M&&(v?(o=o.add(v),s=P?s.add(f):s.delete(f)):(o=o.delete(f),s=s.delete(f)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const f=this.query.limitType==="F"?o.last():o.first();o=o.delete(f.key),s=s.delete(f.key),r.track({type:1,doc:f})}return{tu:o,iu:r,Cs:a,mutatedKeys:s}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((f,m)=>function(v,T){const P=M=>{switch(M){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return he(20277,{Rt:M})}};return P(v)-P(T)}(f.type,m.type)||this.eu(f.doc,m.doc)),this.ou(r),i=i??!1;const a=n&&!i?this._u():[],l=this.Xa.size===0&&this.current&&!i?1:0,u=l!==this.Za;return this.Za=l,o.length!==0||u?{snapshot:new $a(this.query,e.tu,s,o,e.mutatedKeys,l===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Vw,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Ya=this.Ya.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ya=this.Ya.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Ae(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))});const n=[];return e.forEach(r=>{this.Xa.has(r)||n.push(new RA(r))}),this.Xa.forEach(r=>{e.has(r)||n.push(new AA(r))}),n}cu(e){this.Ya=e.Qs,this.Xa=Ae();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return $a.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const dy="SyncEngine";class qO{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class zO{constructor(e){this.key=e,this.hu=!1}}class $O{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new ci(a=>xx(a),pf),this.Iu=new Map,this.Eu=new Set,this.du=new ht(oe.comparator),this.Au=new Map,this.Ru=new Q_,this.Vu={},this.mu=new Map,this.fu=yo.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function HO(t,e,n=!0){const r=MA(t);let i;const s=r.Tu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await PA(r,e,n,!0),i}async function jO(t,e){const n=MA(t);await PA(n,e,!0,!1)}async function PA(t,e,n,r){const i=await hO(t.localStore,Hn(e)),s=i.targetId,o=t.sharedClientState.addLocalQueryTarget(s,n);let a;return r&&(a=await WO(t,e,s,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&EA(t.remoteStore,i),a}async function WO(t,e,n,r,i){t.pu=(m,g,v)=>async function(P,M,x,E){let A=M.view.ru(x);A.Cs&&(A=await Pw(P.localStore,M.query,!1).then(({documents:I})=>M.view.ru(I,A)));const V=E&&E.targetChanges.get(M.targetId),B=E&&E.targetMismatches.get(M.targetId)!=null,G=M.view.applyChanges(A,P.isPrimaryClient,V,B);return Ow(P,M.targetId,G.au),G.snapshot}(t,m,g,v);const s=await Pw(t.localStore,e,!0),o=new GO(e,s.Qs),a=o.ru(s.documents),l=rc.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),u=o.applyChanges(a,t.isPrimaryClient,l);Ow(t,n,u.au);const f=new qO(e,n,o);return t.Tu.set(e,f),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),u.snapshot}async function KO(t,e,n){const r=Ie(t),i=r.Tu.get(e),s=r.Iu.get(i.targetId);if(s.length>1)return r.Iu.set(i.targetId,s.filter(o=>!pf(o,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await lg(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&ty(r.remoteStore,i.targetId),dg(r,i.targetId)}).catch(Io)):(dg(r,i.targetId),await lg(r.localStore,i.targetId,!0))}async function JO(t,e){const n=Ie(t),r=n.Tu.get(e),i=n.Iu.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),ty(n.remoteStore,r.targetId))}async function QO(t,e,n){const r=VA(t);try{const i=await function(o,a){const l=Ie(o),u=Ke.now(),f=a.reduce((v,T)=>v.add(T.key),Ae());let m,g;return l.persistence.runTransaction("Locally write mutations","readwrite",v=>{let T=Pn(),P=Ae();return l.Ns.getEntries(v,f).next(M=>{T=M,T.forEach((x,E)=>{E.isValidDocument()||(P=P.add(x))})}).next(()=>l.localDocuments.getOverlayedDocuments(v,T)).next(M=>{m=M;const x=[];for(const E of a){const A=d4(E,m.get(E.key).overlayedDocument);A!=null&&x.push(new di(E.key,A,_x(A.value.mapValue),an.exists(!0)))}return l.mutationQueue.addMutationBatch(v,u,x,a)}).next(M=>{g=M;const x=M.applyToLocalDocumentSet(m,P);return l.documentOverlayCache.saveOverlays(v,M.batchId,x)})}).then(()=>({batchId:g.batchId,changes:Px(m)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,l){let u=o.Vu[o.currentUser.toKey()];u||(u=new ht(we)),u=u.insert(a,l),o.Vu[o.currentUser.toKey()]=u}(r,i.batchId,n),await oc(r,i.changes),await sc(r.remoteStore)}catch(i){const s=oy(i,"Failed to persist write");n.reject(s)}}async function kA(t,e){const n=Ie(t);try{const r=await uO(n.localStore,e);e.targetChanges.forEach((i,s)=>{const o=n.Au.get(s);o&&(_e(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.hu=!0:i.modifiedDocuments.size>0?_e(o.hu,14607):i.removedDocuments.size>0&&(_e(o.hu,42227),o.hu=!1))}),await oc(n,r,e)}catch(r){await Io(r)}}function Uw(t,e,n){const r=Ie(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Tu.forEach((s,o)=>{const a=o.view.va(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){const l=Ie(o);l.onlineState=a;let u=!1;l.queries.forEach((f,m)=>{for(const g of m.Sa)g.va(a)&&(u=!0)}),u&&uy(l)}(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function YO(t,e,n){const r=Ie(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Au.get(e),s=i&&i.key;if(s){let o=new ht(oe.comparator);o=o.insert(s,Tt.newNoDocument(s,ye.min()));const a=Ae().add(s),l=new yf(ye.min(),new Map,new ht(we),o,a);await kA(r,l),r.du=r.du.remove(s),r.Au.delete(e),hy(r)}else await lg(r.localStore,e,!1).then(()=>dg(r,e,n)).catch(Io)}async function XO(t,e){const n=Ie(t),r=e.batch.batchId;try{const i=await lO(n.localStore,e);bA(n,r,null),NA(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await oc(n,i)}catch(i){await Io(i)}}async function ZO(t,e,n){const r=Ie(t);try{const i=await function(o,a){const l=Ie(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let f;return l.mutationQueue.lookupMutationBatch(u,a).next(m=>(_e(m!==null,37113),f=m.keys(),l.mutationQueue.removeMutationBatch(u,m))).next(()=>l.mutationQueue.performConsistencyCheck(u)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(u,f,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,f)).next(()=>l.localDocuments.getDocuments(u,f))})}(r.localStore,e);bA(r,e,n),NA(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await oc(r,i)}catch(i){await Io(i)}}function NA(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function bA(t,e,n){const r=Ie(t);let i=r.Vu[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Vu[r.currentUser.toKey()]=i}}function dg(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(r=>{t.Ru.containsKey(r)||DA(t,r)})}function DA(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(ty(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),hy(t))}function Ow(t,e,n){for(const r of n)r instanceof AA?(t.Ru.addReference(r.key,e),e6(t,r)):r instanceof RA?(te(dy,"Document no longer in limbo: "+r.key),t.Ru.removeReference(r.key,e),t.Ru.containsKey(r.key)||DA(t,r.key)):he(19791,{wu:r})}function e6(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Eu.has(r)||(te(dy,"New document in limbo: "+n),t.Eu.add(r),hy(t))}function hy(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new oe(je.fromString(e)),r=t.fu.next();t.Au.set(r,new zO(n)),t.du=t.du.insert(n,r),EA(t.remoteStore,new Qr(Hn(tc(n.path)),r,"TargetPurposeLimboResolution",qn.ce))}}async function oc(t,e,n){const r=Ie(t),i=[],s=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((a,l)=>{o.push(r.pu(l,e,n).then(u=>{var f;if((u||n)&&r.isPrimaryClient){const m=u?!u.fromCache:(f=n==null?void 0:n.targetChanges.get(l.targetId))==null?void 0:f.current;r.sharedClientState.updateQueryState(l.targetId,m?"current":"not-current")}if(u){i.push(u);const m=Z_.As(l.targetId,u);s.push(m)}}))}),await Promise.all(o),r.Pu.H_(i),await async function(l,u){const f=Ie(l);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>z.forEach(u,g=>z.forEach(g.Es,v=>f.persistence.referenceDelegate.addReference(m,g.targetId,v)).next(()=>z.forEach(g.ds,v=>f.persistence.referenceDelegate.removeReference(m,g.targetId,v)))))}catch(m){if(!ms(m))throw m;te(ey,"Failed to update sequence numbers: "+m)}for(const m of u){const g=m.targetId;if(!m.fromCache){const v=f.Ms.get(g),T=v.snapshotVersion,P=v.withLastLimboFreeSnapshotVersion(T);f.Ms=f.Ms.insert(g,P)}}}(r.localStore,s))}async function t6(t,e){const n=Ie(t);if(!n.currentUser.isEqual(e)){te(dy,"User change. New user:",e.toKey());const r=await gA(n.localStore,e);n.currentUser=e,function(s,o){s.mu.forEach(a=>{a.forEach(l=>{l.reject(new se(Q.CANCELLED,o))})}),s.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await oc(n,r.Ls)}}function n6(t,e){const n=Ie(t),r=n.Au.get(e);if(r&&r.hu)return Ae().add(r.key);{let i=Ae();const s=n.Iu.get(e);if(!s)return i;for(const o of s){const a=n.Tu.get(o);i=i.unionWith(a.view.nu)}return i}}function MA(t){const e=Ie(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=kA.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=n6.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=YO.bind(null,e),e.Pu.H_=OO.bind(null,e.eventManager),e.Pu.yu=BO.bind(null,e.eventManager),e}function VA(t){const e=Ie(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=XO.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=ZO.bind(null,e),e}class Ou{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=wf(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return mA(this.persistence,new pA,e.initialUser,this.serializer)}Cu(e){return new Y_(Ef.mi,this.serializer)}Du(e){return new yA}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ou.provider={build:()=>new Ou};class r6 extends Ou{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){_e(this.persistence.referenceDelegate instanceof Ph,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new uA(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?Xt.withCacheSize(this.cacheSizeBytes):Xt.DEFAULT;return new Y_(r=>Ph.mi(r,n),this.serializer)}}class i6 extends Ou{constructor(e,n,r){super(),this.xu=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await VA(this.xu.syncEngine),await sc(this.xu.remoteStore),await this.persistence.Ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}vu(e){return mA(this.persistence,new pA,e.initialUser,this.serializer)}Fu(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new uA(r,e.asyncQueue,n)}Mu(e,n){const r=new cU(n,this.persistence);return new uU(e.asyncQueue,r)}Cu(e){const n=iO(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Xt.withCacheSize(this.cacheSizeBytes):Xt.DEFAULT;return new X_(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,vO(),Md(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new yA}}class Nh{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Uw(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=t6.bind(null,this.syncEngine),await LO(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new UO}()}createDatastore(e){const n=wf(e.databaseInfo.databaseId),r=function(s){return new yO(s)}(e.databaseInfo);return function(s,o,a,l){return new IO(s,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,a){return new CO(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>Uw(this.syncEngine,n,0),function(){return bw.v()?new bw:new pO}())}createSyncEngine(e,n){return function(i,s,o,a,l,u,f){const m=new $O(i,s,o,a,l,u);return f&&(m.gu=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(i){const s=Ie(i);te(vo,"RemoteStore shutting down."),s.Ea.add(5),await ic(s),s.Aa.shutdown(),s.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}Nh.provider={build:()=>new Nh};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fy{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):on("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cs="FirestoreClient";class s6{constructor(e,n,r,i,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=Ht.UNAUTHENTICATED,this.clientId=sf.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{te(cs,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(te(cs,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new kr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=oy(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Ap(t,e){t.asyncQueue.verifyOperationInProgress(),te(cs,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await gA(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Bw(t,e){t.asyncQueue.verifyOperationInProgress();const n=await o6(t);te(cs,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>Mw(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>Mw(e.remoteStore,i)),t._onlineComponents=e}async function o6(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){te(cs,"Using user provided OfflineComponentProvider");try{await Ap(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(i){return i.name==="FirebaseError"?i.code===Q.FAILED_PRECONDITION||i.code===Q.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;ss("Error using user provided cache. Falling back to memory cache: "+n),await Ap(t,new Ou)}}else te(cs,"Using default OfflineComponentProvider"),await Ap(t,new r6(void 0));return t._offlineComponents}async function LA(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(te(cs,"Using user provided OnlineComponentProvider"),await Bw(t,t._uninitializedComponentsProvider._online)):(te(cs,"Using default OnlineComponentProvider"),await Bw(t,new Nh))),t._onlineComponents}function a6(t){return LA(t).then(e=>e.syncEngine)}async function bh(t){const e=await LA(t),n=e.eventManager;return n.onListen=HO.bind(null,e.syncEngine),n.onUnlisten=KO.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=jO.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=JO.bind(null,e.syncEngine),n}function l6(t,e,n={}){const r=new kr;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,u){const f=new fy({next:g=>{f.Nu(),o.enqueueAndForget(()=>ly(s,m));const v=g.docs.has(a);!v&&g.fromCache?u.reject(new se(Q.UNAVAILABLE,"Failed to get document because the client is offline.")):v&&g.fromCache&&l&&l.source==="server"?u.reject(new se(Q.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(g)},error:g=>u.reject(g)}),m=new cy(tc(a.path),f,{includeMetadataChanges:!0,qa:!0});return ay(s,m)}(await bh(t),t.asyncQueue,e,n,r)),r.promise}function u6(t,e,n={}){const r=new kr;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,u){const f=new fy({next:g=>{f.Nu(),o.enqueueAndForget(()=>ly(s,m)),g.fromCache&&l.source==="server"?u.reject(new se(Q.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(g)},error:g=>u.reject(g)}),m=new cy(a,f,{includeMetadataChanges:!0,qa:!0});return ay(s,m)}(await bh(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FA(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gw=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UA="firestore.googleapis.com",qw=!0;class zw{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new se(Q.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=UA,this.ssl=qw}else this.host=e.host,this.ssl=e.ssl??qw;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=sA;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<G4)throw new se(Q.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}j0("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=FA(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new se(Q.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new se(Q.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new se(Q.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Sf{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new zw({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new se(Q.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new se(Q.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new zw(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new z0;switch(r.type){case"firstParty":return new eU(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new se(Q.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=Gw.get(n);r&&(te("ComponentProvider","Removing Datastore"),Gw.delete(n),r.terminate())}(this),Promise.resolve()}}function OA(t,e,n,r={}){var u;t=un(t,Sf);const i=Xa(e),s=t._getSettings(),o={...s,emulatorOptions:t._getEmulatorOptions()},a=`${e}:${n}`;i&&(HC(`https://${a}`),jC("Firestore",!0)),s.host!==UA&&s.host!==a&&ss("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...s,host:a,ssl:i,emulatorOptions:r};if(!ho(l,o)&&(t._setSettings(l),r.mockUserToken)){let f,m;if(typeof r.mockUserToken=="string")f=r.mockUserToken,m=Ht.MOCK_USER;else{f=C2(r.mockUserToken,(u=t._app)==null?void 0:u.options.projectId);const g=r.mockUserToken.sub||r.mockUserToken.user_id;if(!g)throw new se(Q.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");m=new Ht(g)}t._authCredentials=new YF(new q0(f,m))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _s{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new _s(this.firestore,e,this._query)}}class pt{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Xr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new pt(this.firestore,e,this._key)}toJSON(){return{type:pt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(Yu(n,pt._jsonSchema))return new pt(e,r||null,new oe(je.fromString(n.referencePath)))}}pt._jsonSchemaVersion="firestore/documentReference/1.0",pt._jsonSchema={type:At("string",pt._jsonSchemaVersion),referencePath:At("string")};class Xr extends _s{constructor(e,n,r){super(e,n,tc(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new pt(this.firestore,null,new oe(e))}withConverter(e){return new Xr(this.firestore,e,this._path)}}function lt(t,e,...n){if(t=Dt(t),H0("collection","path",e),t instanceof Sf){const r=je.fromString(e,...n);return DE(r),new Xr(t,null,r)}{if(!(t instanceof pt||t instanceof Xr))throw new se(Q.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(je.fromString(e,...n));return DE(r),new Xr(t.firestore,null,r)}}function Le(t,e,...n){if(t=Dt(t),arguments.length===1&&(e=sf.newId()),H0("doc","path",e),t instanceof Sf){const r=je.fromString(e,...n);return bE(r),new pt(t,null,new oe(r))}{if(!(t instanceof pt||t instanceof Xr))throw new se(Q.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(je.fromString(e,...n));return bE(r),new pt(t.firestore,t instanceof Xr?t.converter:null,new oe(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $w="AsyncQueue";class Hw{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new vA(this,"async_queue_retry"),this._c=()=>{const r=Md();r&&te($w,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=Md();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=Md();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new kr;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!ms(e))throw e;te($w,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,on("INTERNAL UNHANDLED ERROR: ",jw(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const i=sy.createAndSchedule(this,e,n,r,s=>this.hc(s));return this.tc.push(i),i}uc(){this.nc&&he(47125,{Pc:jw(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function jw(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ww(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const i=n;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}class Dr extends Sf{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new Hw,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Hw(e),this._firestoreClient=void 0,await e}}}function BA(t,e){const n=typeof t=="object"?t:e0(),r=typeof t=="string"?t:Th,i=T_(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=I2("firestore");s&&OA(i,...s)}return i}function ac(t){if(t._terminated)throw new se(Q.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||GA(t),t._firestoreClient}function GA(t){var r,i,s;const e=t._freezeSettings(),n=function(a,l,u,f){return new OU(a,l,u,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,FA(f.experimentalLongPollingOptions),f.useFetchStreams,f.isUsingEmulator)}(t._databaseId,((r=t._app)==null?void 0:r.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(i=e.localCache)!=null&&i._offlineComponentProvider&&((s=e.localCache)!=null&&s._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new s6(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(t._componentsProvider))}function qA(t,e){ss("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings();return c6(t,Nh.provider,{build:r=>new i6(r,n.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}function c6(t,e,n){if((t=un(t,Dr))._firestoreClient||t._terminated)throw new se(Q.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new se(Q.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:n},GA(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class An{constructor(e){this._byteString=e}static fromBase64String(e){try{return new An(It.fromBase64String(e))}catch(n){throw new se(Q.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new An(It.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:An._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Yu(e,An._jsonSchema))return An.fromBase64String(e.bytes)}}An._jsonSchemaVersion="firestore/bytes/1.0",An._jsonSchema={type:At("string",An._jsonSchemaVersion),bytes:At("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lc{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new se(Q.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new dt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uc{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ur{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new se(Q.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new se(Q.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return we(this._lat,e._lat)||we(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:ur._jsonSchemaVersion}}static fromJSON(e){if(Yu(e,ur._jsonSchema))return new ur(e.latitude,e.longitude)}}ur._jsonSchemaVersion="firestore/geoPoint/1.0",ur._jsonSchema={type:At("string",ur._jsonSchemaVersion),latitude:At("number"),longitude:At("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cr{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}toJSON(){return{type:cr._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Yu(e,cr._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new cr(e.vectorValues);throw new se(Q.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}cr._jsonSchemaVersion="firestore/vectorValue/1.0",cr._jsonSchema={type:At("string",cr._jsonSchemaVersion),vectorValues:At("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d6=/^__.*__$/;class h6{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new di(e,this.data,this.fieldMask,n,this.fieldTransforms):new nl(e,this.data,n,this.fieldTransforms)}}class zA{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new di(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function $A(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw he(40011,{Ac:t})}}class py{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new py({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var i;const n=(i=this.path)==null?void 0:i.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){var i;const n=(i=this.path)==null?void 0:i.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Dh(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if($A(this.Ac)&&d6.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class f6{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||wf(e)}Cc(e,n,r,i=!1){return new py({Ac:e,methodName:n,Dc:r,path:dt.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function my(t){const e=t._freezeSettings(),n=wf(t._databaseId);return new f6(t._databaseId,!!e.ignoreUndefinedProperties,n)}function p6(t,e,n,r,i,s={}){const o=t.Cc(s.merge||s.mergeFields?2:0,e,n,i);_y("Data must be an object, but it was:",o,r);const a=HA(r,o);let l,u;if(s.merge)l=new gn(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const f=[];for(const m of s.mergeFields){const g=hg(e,m,n);if(!o.contains(g))throw new se(Q.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);WA(f,g)||f.push(g)}l=new gn(f),u=o.fieldTransforms.filter(m=>l.covers(m.field))}else l=null,u=o.fieldTransforms;return new h6(new en(a),l,u)}class Cf extends uc{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Cf}}class gy extends uc{_toFieldTransform(e){return new Lx(e.path,new Ba)}isEqual(e){return e instanceof gy}}function m6(t,e,n,r){const i=t.Cc(1,e,n);_y("Data must be an object, but it was:",i,r);const s=[],o=en.empty();gs(r,(l,u)=>{const f=yy(e,l,n);u=Dt(u);const m=i.yc(f);if(u instanceof Cf)s.push(f);else{const g=cc(u,m);g!=null&&(s.push(f),o.set(f,g))}});const a=new gn(s);return new zA(o,a,i.fieldTransforms)}function g6(t,e,n,r,i,s){const o=t.Cc(1,e,n),a=[hg(e,r,n)],l=[i];if(s.length%2!=0)throw new se(Q.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<s.length;g+=2)a.push(hg(e,s[g])),l.push(s[g+1]);const u=[],f=en.empty();for(let g=a.length-1;g>=0;--g)if(!WA(u,a[g])){const v=a[g];let T=l[g];T=Dt(T);const P=o.yc(v);if(T instanceof Cf)u.push(v);else{const M=cc(T,P);M!=null&&(u.push(v),f.set(v,M))}}const m=new gn(u);return new zA(f,m,o.fieldTransforms)}function _6(t,e,n,r=!1){return cc(n,t.Cc(r?4:3,e))}function cc(t,e){if(jA(t=Dt(t)))return _y("Unsupported field value:",e,t),HA(t,e);if(t instanceof uc)return function(r,i){if(!$A(i.Ac))throw i.Sc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const a of r){let l=cc(a,i.wc(o));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=Dt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return s4(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=Ke.fromDate(r);return{timestampValue:za(i.serializer,s)}}if(r instanceof Ke){const s=new Ke(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:za(i.serializer,s)}}if(r instanceof ur)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof An)return{bytesValue:zx(i.serializer,r._byteString)};if(r instanceof pt){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:W_(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof cr)return function(o,a){return{mapValue:{fields:{[O_]:{stringValue:B_},[La]:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw a.Sc("VectorValues must only contain numeric values.");return q_(a.serializer,u)})}}}}}}(r,i);throw i.Sc(`Unsupported field value: ${of(r)}`)}(t,e)}function HA(t,e){const n={};return lx(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):gs(t,(r,i)=>{const s=cc(i,e.mc(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function jA(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Ke||t instanceof ur||t instanceof An||t instanceof pt||t instanceof uc||t instanceof cr)}function _y(t,e,n){if(!jA(n)||!W0(n)){const r=of(n);throw r==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+r)}}function hg(t,e,n){if((e=Dt(e))instanceof lc)return e._internalPath;if(typeof e=="string")return yy(t,e);throw Dh("Field path arguments must be of type string or ",t,!1,void 0,n)}const y6=new RegExp("[~\\*/\\[\\]]");function yy(t,e,n){if(e.search(y6)>=0)throw Dh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new lc(...e.split("."))._internalPath}catch{throw Dh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Dh(t,e,n,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new se(Q.INVALID_ARGUMENT,a+t+l)}function WA(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KA{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new pt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new v6(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(vy("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class v6 extends KA{data(){return super.data()}}function vy(t,e){return typeof e=="string"?yy(t,e):e instanceof lc?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JA(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new se(Q.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Ty{}class QA extends Ty{}function Ol(t,e,...n){let r=[];e instanceof Ty&&r.push(e),r=r.concat(n),function(s){const o=s.filter(l=>l instanceof xf).length,a=s.filter(l=>l instanceof dc).length;if(o>1||o>0&&a>0)throw new se(Q.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class dc extends QA{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new dc(e,n,r)}_apply(e){const n=this._parse(e);return YA(e._query,n),new _s(e.firestore,e.converter,Zm(e._query,n))}_parse(e){const n=my(e.firestore);return function(s,o,a,l,u,f,m){let g;if(u.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new se(Q.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){Jw(m,f);const T=[];for(const P of m)T.push(Kw(l,s,P));g={arrayValue:{values:T}}}else g=Kw(l,s,m)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||Jw(m,f),g=_6(a,o,m,f==="in"||f==="not-in");return Ve.create(u,f,g)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Bl(t,e,n){const r=e,i=vy("where",t);return dc._create(i,r,n)}class xf extends Ty{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new xf(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Qe.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i;const a=s.getFlattenedFilters();for(const l of a)YA(o,l),o=Zm(o,l)}(e._query,n),new _s(e.firestore,e.converter,Zm(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function Kw(t,e,n){if(typeof(n=Dt(n))=="string"){if(n==="")throw new se(Q.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Cx(e)&&n.indexOf("/")!==-1)throw new se(Q.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(je.fromString(n));if(!oe.isDocumentKey(r))throw new se(Q.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Lu(t,new oe(r))}if(n instanceof pt)return Lu(t,n._key);throw new se(Q.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${of(n)}.`)}function Jw(t,e){if(!Array.isArray(t)||t.length===0)throw new se(Q.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function YA(t,e){const n=function(i,s){for(const o of i)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new se(Q.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new se(Q.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class XA{convertValue(e,n="none"){switch(as(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ut(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(oi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw he(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return gs(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertVectorValue(e){var r,i,s;const n=(s=(i=(r=e.fields)==null?void 0:r[La].arrayValue)==null?void 0:i.values)==null?void 0:s.map(o=>ut(o.doubleValue));return new cr(n)}convertGeoPoint(e){return new ur(ut(e.latitude),ut(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=hf(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Mu(e));default:return null}}convertTimestamp(e){const n=si(e);return new Ke(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=je.fromString(e);_e(Zx(r),9688,{name:e});const i=new os(r.get(1),r.get(3)),s=new oe(r.popFirst(5));return i.isEqual(n)||on(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T6(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class la{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class es extends KA{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new au(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(vy("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new se(Q.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=es._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}es._jsonSchemaVersion="firestore/documentSnapshot/1.0",es._jsonSchema={type:At("string",es._jsonSchemaVersion),bundleSource:At("string","DocumentSnapshot"),bundleName:At("string"),bundle:At("string")};class au extends es{data(e={}){return super.data(e)}}class ts{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new la(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new au(this._firestore,this._userDataWriter,r.key,r,new la(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new se(Q.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{const l=new au(i._firestore,i._userDataWriter,a.doc.key,a.doc,new la(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{const l=new au(i._firestore,i._userDataWriter,a.doc.key,a.doc,new la(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let u=-1,f=-1;return a.type!==0&&(u=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),f=o.indexOf(a.doc.key)),{type:E6(a.type),doc:l,oldIndex:u,newIndex:f}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new se(Q.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=ts._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=sf.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],i=[];return this.docs.forEach(s=>{s._document!==null&&(n.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function E6(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return he(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fg(t){t=un(t,pt);const e=un(t.firestore,Dr);return l6(ac(e),t._key).then(n=>ZA(e,t,n))}ts._jsonSchemaVersion="firestore/querySnapshot/1.0",ts._jsonSchema={type:At("string",ts._jsonSchemaVersion),bundleSource:At("string","QuerySnapshot"),bundleName:At("string"),bundle:At("string")};class Ey extends XA{constructor(e){super(),this.firestore=e}convertBytes(e){return new An(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new pt(this.firestore,null,n)}}function Pi(t){t=un(t,_s);const e=un(t.firestore,Dr),n=ac(e),r=new Ey(e);return JA(t._query),u6(n,t._query).then(i=>new ts(e,r,t,i))}function yt(t,e,n){t=un(t,pt);const r=un(t.firestore,Dr),i=T6(t.converter,e,n);return Af(r,[p6(my(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,an.none())])}function pg(t,e,n,...r){t=un(t,pt);const i=un(t.firestore,Dr),s=my(i);let o;return o=typeof(e=Dt(e))=="string"||e instanceof lc?g6(s,"updateDoc",t._key,e,n,r):m6(s,"updateDoc",t._key,e),Af(i,[o.toMutation(t._key,an.exists(!0))])}function zt(t){return Af(un(t.firestore,Dr),[new _f(t._key,an.none())])}function qr(t,...e){var l,u,f;t=Dt(t);let n={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||Ww(e[r])||(n=e[r++]);const i={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(Ww(e[r])){const m=e[r];e[r]=(l=m.next)==null?void 0:l.bind(m),e[r+1]=(u=m.error)==null?void 0:u.bind(m),e[r+2]=(f=m.complete)==null?void 0:f.bind(m)}let s,o,a;if(t instanceof pt)o=un(t.firestore,Dr),a=tc(t._key.path),s={next:m=>{e[r]&&e[r](ZA(o,t,m))},error:e[r+1],complete:e[r+2]};else{const m=un(t,_s);o=un(m.firestore,Dr),a=m._query;const g=new Ey(o);s={next:v=>{e[r]&&e[r](new ts(o,g,m,v))},error:e[r+1],complete:e[r+2]},JA(t._query)}return function(g,v,T,P){const M=new fy(P),x=new cy(v,M,T);return g.asyncQueue.enqueueAndForget(async()=>ay(await bh(g),x)),()=>{M.Nu(),g.asyncQueue.enqueueAndForget(async()=>ly(await bh(g),x))}}(ac(o),a,i,s)}function Af(t,e){return function(r,i){const s=new kr;return r.asyncQueue.enqueueAndForget(async()=>QO(await a6(r),i,s)),s.promise}(ac(t),e)}function ZA(t,e,n){const r=n.docs.get(e._key),i=new Ey(t);return new es(t,i,e._key,r,new la(n.hasPendingWrites,n.fromCache),e.converter)}function w6(){return new gy("serverTimestamp")}(function(e,n=!0){(function(i){tl=i})(Za),Pa(new fo("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),a=new Dr(new XF(r.getProvider("auth-internal")),new tU(o,r.getProvider("app-check-internal")),function(u,f){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new se(Q.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new os(u.options.projectId,f)}(o,i),o);return s={useFetchStreams:n,...s},a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),Yi(RE,PE,e),Yi(RE,PE,"esm2020")})();const Fs=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:XA,Bytes:An,CollectionReference:Xr,DocumentReference:pt,DocumentSnapshot:es,FieldPath:lc,FieldValue:uc,Firestore:Dr,FirestoreError:se,GeoPoint:ur,Query:_s,QueryCompositeFilterConstraint:xf,QueryConstraint:QA,QueryDocumentSnapshot:au,QueryFieldFilterConstraint:dc,QuerySnapshot:ts,SnapshotMetadata:la,Timestamp:Ke,VectorValue:cr,_AutoId:sf,_ByteString:It,_DatabaseId:os,_DocumentKey:oe,_EmptyAuthCredentialsProvider:z0,_FieldPath:dt,_cast:un,_logWarn:ss,_validateIsNotUsedTogether:j0,collection:lt,connectFirestoreEmulator:OA,deleteDoc:zt,doc:Le,enableIndexedDbPersistence:qA,ensureFirestoreConfigured:ac,executeWrite:Af,getDoc:fg,getDocs:Pi,getFirestore:BA,onSnapshot:qr,query:Ol,serverTimestamp:w6,setDoc:yt,setLogLevel:B0,updateDoc:pg,where:Bl},Symbol.toStringTag,{value:"Module"}));B0("error");const I6={apiKey:"AIzaSyC1zhlBnbOxP_PCaHU6L-UsDOBRTjGgpfk",authDomain:"my-apss-da774.firebaseapp.com",projectId:"my-apss-da774",storageBucket:"my-apss-da774.firebasestorage.app",messagingSenderId:"528434940137",appId:"1:528434940137:web:56be66185a46f390b60878",measurementId:"G-WPGZGF4ZBG"},eR=ZC(I6),zs=JF(eR);LL(zs,S0).catch(t=>console.error("Persistence error:",t));const Ha=new Hr;Ha.addScope("profile");Ha.addScope("email");Ha.setCustomParameters({prompt:"select_account",access_type:"offline"});if(typeof window<"u"){const t=navigator.userAgent.toLowerCase();t.includes("safari")&&!t.includes("chrome")&&!t.includes("firefox")&&Ha.setCustomParameters({prompt:"consent"})}const ge=BA(eR);qA(ge).catch(t=>{t.code==="failed-precondition"?console.warn("Firestore: Multiple tabs open, persistence disabled"):t.code==="unimplemented"&&console.warn("Firestore: Browser does not support persistence")});const Pt=t=>{if(t==null)return;if(typeof t!="object")return t;if(Array.isArray(t)){const r=t.filter(i=>i!==void 0).map(i=>Pt(i)).filter(i=>i!==void 0);return r.length>0?r:void 0}let e;try{e=Object.entries(t)}catch(r){console.error("sanitizeFirestoreData: failed to enumerate object",r,t);return}const n={};for(const[r,i]of e)if(!(i===void 0||typeof i=="string"&&i.trim()===""))if(typeof i=="object"&&i!==null){const s=Pt(i);s!==void 0&&(n[r]=s)}else n[r]=i;return Object.keys(n).length>0?n:void 0},S6=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Mobile|Tablet/i,Rp=()=>{const t=S6.test(navigator.userAgent),e=navigator.maxTouchPoints&&navigator.maxTouchPoints>2,n=window.innerWidth<=768;return t||e&&n},Qw=()=>window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0,Pp=()=>window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",C6=({onClose:t})=>{const[e,n]=O.useState(null),[r,i]=O.useState(!1),[s,o]=O.useState(!1);O.useEffect(()=>{const l=/iPad|iPhone|iPod/.test(navigator.userAgent),f=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Mobile|Tablet/i.test(navigator.userAgent);i(l),o(f);const m=g=>{g.preventDefault(),n(g)};return window.addEventListener("beforeinstallprompt",m),()=>{window.removeEventListener("beforeinstallprompt",m)}},[]);const a=async()=>{if(e){e.prompt();const{outcome:l}=await e.userChoice;l==="accepted"&&(n(null),t())}};return s?p.jsx("div",{className:"pwa-fullscreen-prompt",children:p.jsxs("div",{className:"pwa-fullscreen-content",children:[p.jsxs("div",{className:"pwa-fullscreen-header",children:[p.jsx("div",{className:"w-20 h-20 bg-indigo-600 rounded-lg mx-auto mb-6 flex items-center justify-center",children:p.jsx("span",{className:"text-white text-4xl font-bold",children:"N"})}),p.jsx("h2",{className:"text-3xl font-bold text-white mb-3",children:"Nova  "}),p.jsx("p",{className:"text-lg text-gray-200 mb-4",children:"     "})]}),p.jsx("div",{className:"pwa-fullscreen-body",children:r?p.jsxs("div",{children:[p.jsx("div",{className:"pwa-instruction-box mb-6",children:p.jsx("p",{className:"text-white font-semibold mb-4",children:"iOS  :"})}),p.jsxs("ol",{className:"pwa-instruction-steps",children:[p.jsxs("li",{className:"pwa-instruction-step",children:[p.jsx("div",{className:"step-number",children:"1"}),p.jsxs("div",{className:"step-content",children:[p.jsx("p",{className:"font-semibold",children:"   "}),p.jsx("p",{className:"text-sm",children:"    () "})]})]}),p.jsxs("li",{className:"pwa-instruction-step",children:[p.jsx("div",{className:"step-number",children:"2"}),p.jsxs("div",{className:"step-content",children:[p.jsx("p",{className:"font-semibold",children:"   "}),p.jsx("p",{className:"text-sm",children:'   "  " '})]})]}),p.jsxs("li",{className:"pwa-instruction-step",children:[p.jsx("div",{className:"step-number",children:"3"}),p.jsxs("div",{className:"step-content",children:[p.jsx("p",{className:"font-semibold",children:"  "}),p.jsx("p",{className:"text-sm",children:'  ""    '})]})]})]})]}):p.jsxs("div",{children:[p.jsx("div",{className:"pwa-instruction-box mb-6",children:p.jsx("p",{className:"text-white font-semibold mb-4",children:"Android  :"})}),p.jsxs("ol",{className:"pwa-instruction-steps",children:[p.jsxs("li",{className:"pwa-instruction-step",children:[p.jsx("div",{className:"step-number",children:"1"}),p.jsxs("div",{className:"step-content",children:[p.jsx("p",{className:"font-semibold",children:"  "}),p.jsx("p",{className:"text-sm",children:"    ()    "})]})]}),p.jsxs("li",{className:"pwa-instruction-step",children:[p.jsx("div",{className:"step-number",children:"2"}),p.jsxs("div",{className:"step-content",children:[p.jsx("p",{className:"font-semibold",children:"  "}),p.jsx("p",{className:"text-sm",children:'"  "  " "  '})]})]}),p.jsxs("li",{className:"pwa-instruction-step",children:[p.jsx("div",{className:"step-number",children:"3"}),p.jsxs("div",{className:"step-content",children:[p.jsx("p",{className:"font-semibold",children:" "}),p.jsx("p",{className:"text-sm",children:'  ""   '})]})]})]}),e&&p.jsx("button",{onClick:a,className:"pwa-install-button mt-6",children:" "})]})}),p.jsx("div",{className:"pwa-fullscreen-footer",children:p.jsx("p",{className:"text-gray-300 text-sm mb-4",children:"       "})})]})}):p.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:p.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-sm w-full",children:[p.jsxs("div",{className:"text-center mb-4",children:[p.jsx("div",{className:"w-16 h-16 bg-indigo-600 rounded-lg mx-auto mb-4 flex items-center justify-center",children:p.jsx("span",{className:"text-white text-2xl font-bold",children:"N"})}),p.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:" "}),p.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-sm",children:"Nova AI Planner      ."})]}),r?p.jsxs("div",{className:"mb-4",children:[p.jsx("div",{className:"bg-blue-50 dark:bg-blue-900 p-3 rounded-lg mb-3",children:p.jsx("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:"iOS  :"})}),p.jsxs("ol",{className:"text-sm text-gray-600 dark:text-gray-300 space-y-2",children:[p.jsxs("li",{className:"flex items-center",children:[p.jsx("span",{className:"w-6 h-6 bg-indigo-600 text-white rounded-full flex items-center justify-center text-xs mr-2",children:"1"}),"   () "]}),p.jsxs("li",{className:"flex items-center",children:[p.jsx("span",{className:"w-6 h-6 bg-indigo-600 text-white rounded-full flex items-center justify-center text-xs mr-2",children:"2"}),'"  " ']}),p.jsxs("li",{className:"flex items-center",children:[p.jsx("span",{className:"w-6 h-6 bg-indigo-600 text-white rounded-full flex items-center justify-center text-xs mr-2",children:"3"}),'""  ']})]})]}):p.jsx("div",{className:"mb-4",children:e?p.jsx("button",{onClick:a,className:"w-full bg-indigo-600 text-white py-2 px-4 rounded-lg hover:bg-indigo-700 transition-colors",children:" "}):p.jsx("div",{className:"bg-gray-50 dark:bg-gray-700 p-3 rounded-lg",children:p.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:'  "  "  " " .'})})}),p.jsxs("div",{className:"flex space-x-2",children:[p.jsx("button",{onClick:t,className:"flex-1 bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-gray-200 py-2 px-4 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-500 transition-colors",children:""}),p.jsx("button",{onClick:()=>{localStorage.setItem("pwa-prompt-dismissed","true"),t()},className:"flex-1 bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-gray-200 py-2 px-4 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-500 transition-colors",children:"  "})]})]})})},x6=({todos:t,onEditTodo:e,t:n})=>{const r=O.useMemo(()=>t.filter(i=>i.wish&&i.wish.trim()||i.outcome&&i.outcome.trim()||i.obstacle&&i.obstacle.trim()||i.plan&&i.plan.trim()),[t]);return r.length===0?null:p.jsxs("div",{className:"woop-section",children:[p.jsx("div",{className:"woop-title",children:"WOOP "}),p.jsx("div",{className:"woop-cards-container",children:r.map(i=>p.jsxs("div",{className:"woop-card-item",onClick:()=>e(i),style:{cursor:"pointer"},children:[p.jsxs("div",{className:"woop-field",children:[p.jsx("div",{className:"woop-field-label",children:" Wish ()"}),p.jsx("div",{className:"woop-field-content",children:i.wish?p.jsx("div",{style:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis"},children:i.wish}):p.jsx("span",{className:"woop-empty",children:n("woop_not_set")})})]}),p.jsxs("div",{className:"woop-field",children:[p.jsx("div",{className:"woop-field-label",children:"Outcome ()"}),p.jsx("div",{className:"woop-field-content",children:i.outcome?p.jsx("div",{style:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis"},children:i.outcome}):p.jsx("span",{className:"woop-empty",children:n("woop_not_set")})})]}),p.jsxs("div",{className:"woop-field",children:[p.jsx("div",{className:"woop-field-label",children:"Obstacle ()"}),p.jsx("div",{className:"woop-field-content",children:i.obstacle?p.jsx("div",{style:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis"},children:i.obstacle}):p.jsx("span",{className:"woop-empty",children:n("woop_not_set")})})]}),p.jsxs("div",{className:"woop-field",children:[p.jsx("div",{className:"woop-field-label",children:"plan ()"}),p.jsx("div",{className:"woop-field-content",children:i.plan?p.jsx("div",{style:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis"},children:i.plan}):p.jsx("span",{className:"woop-empty",children:n("woop_not_set")})})]}),p.jsx("button",{className:"woop-card-btn",onClick:s=>{s.stopPropagation(),e(i)},style:{marginTop:"auto",width:"100%"},children:""})]},i.id))})]})},A6={ko:{language_selection_title:"",error_wish_required:" ",error_outcome_required:" ",error_obstacle_required:" ",error_plan_required:" ",error_deadline_required:" ",error_day_required:" ",my_goals_title:"",all_goals_label:" ",all_goals_button:"",sort_label_manual:"",sort_label_deadline:"",sort_label_newest:"",sort_label_alphabetical:"",sort_label_ai:"",ai_sorting_button:" ",add_new_goal_button_label:" ",filter_all:" ",filter_active:" ",filter_completed:"",filter_category:"",category_all:" ",category_school:"",category_work:"",category_personal:"",category_other:"",category_label:"",empty_message_all:"  ",empty_message_active:"   ",empty_message_completed:"  ",empty_encouragement_1:"  ",empty_encouragement_2:"    ",empty_encouragement_3:"   ",empty_encouragement_4:"  ",delete_button:"",edit_button_aria:"",info_button_aria:"",filter_title:"",sort_title:"",filter_sort_button_aria:"  ",category_filter_button_aria:" ",calendar_view_button_aria:"",list_view_button_aria:"",more_options_button_aria:"",select_button_label:"",cancel_selection_button_label:"",delete_selected_button_label:"{count} ",selection_summary_label:"{count}/{total} ",select_all_button_label:" ",delete_selected_confirm_title:" ",delete_selected_confirm_message:"{count}  .     .",days_left:"{count} ",d_day:"",days_overdue:"{count} ",month_names:["1","2","3","4","5","6","7","8","9","10","11","12"],day_names_short:["","","","","","",""],day_names_long:["","","","","","",""],calendar_header_month_format:"{year} {month}",calendar_view_day3:"3",calendar_view_week:"",calendar_view_month:"",settings_title:"",sort_alert_title:"  ",sort_alert_message:"2   ",ai_sort_error_title:" ",ai_sort_error_message:"  .  .",confirm_button:"",new_goal_modal_title:" ",edit_goal_modal_title:" ",wish_label:"",outcome_label:"",obstacle_label:"",plan_label:"",deadline_label:"",cancel_button:"",add_button:"",save_button:"",goal_details_modal_title:" ",todo_details_title:" ",task_title_label:"",due_date_label:"",time_label:"",completion_status_label:" ",completed:"",pending:" ",ai_coach_suggestion:" ",ai_analyzing:" ",close_button:"",ai_sort_reason_modal_title:"AI ",ai_sort_criteria:" ",delete_account_final_confirm_title:"  ",delete_account_final_confirm_message:"   .     .",delete_all_data_button:"  ",settings_done_button:"",settings_section_data:"",settings_section_account:"",settings_sync_data:" ",settings_syncing:" ",settings_save_to_cloud:"Google ",settings_loading:" ",settings_load_from_cloud:" ",settings_auto_sync:" ",settings_auto_sync_desc:"  ",settings_cloud_sync_header:"Google ",woop_not_set:"",settings_logout:"",settings_export_data:"",settings_import_data:"",import_confirm_title:" ",import_confirm_message:"    .   .",import_success_toast:" ",import_error_alert_title:" ",import_error_alert_message:"   .  .",settings_section_general:"",settings_section_info:"",settings_section_help:"",settings_theme_mode:"",theme_mode_light:"",theme_mode_light_desc:" ",theme_mode_dark:"",theme_mode_dark_desc:" ",theme_mode_system:"",theme_mode_system_desc:"  ",settings_dark_mode:" ",settings_language:"",settings_api_key:"AI ",settings_api_key_placeholder:"API  ",settings_offline_mode:" ",settings_offline_mode_desc:"AI  ",settings_notifications:"",settings_notifications_desc:" ",notification_settings_title:" ",notification_permission_denied:" ",notification_permission_denied_desc:"     ",notification_permission_request:"  ",reminder_add_title:" ",reminder_step_title:"{step}/5 ",reminder_step1_title:" ",reminder_step1_desc:"  ",reminder_step2_title:"  &  ",reminder_step2_desc:"    ()",reminder_step2_date_toggle:" ",reminder_step2_time_toggle:" ",reminder_step3_title:"  ",reminder_step3_desc:"    ",reminder_step3_enable_recurring:" ",reminder_step4_title:" ",reminder_step4_desc:"   ()",reminder_step5_title:" ",reminder_step5_desc:"   ",reminder_next_button:"",reminder_back_button:"",reminder_submit_button:"",reminder_form_title:"",reminder_form_date:"",reminder_form_time:"",reminder_form_recurring:"",reminder_form_description:"",reminder_form_enabled:"",recurring_type_none:" ",recurring_type_daily:"",recurring_type_weekly:"",recurring_type_monthly:"",notification_deadline:"  ",notification_deadline_desc:"     .",notification_suggestion:" ",notification_suggestion_desc:"   .",notification_achievement:"  ",notification_achievement_desc:"    .",notification_reminder:" ",notification_reminder_desc:"    .",reminder_time_settings_title:"  ",reminder_start_time:" ",reminder_end_time:" ",language_name:" ()",language_modal_title:"",settings_section_background:"",settings_bg_default:"",settings_bg_default_dark:"",settings_bg_pink:"",settings_bg_cherry_noir:" ",settings_bg_blue:"",settings_bg_deep_ocean:"",settings_bg_green:"",settings_bg_forest_green:" ",settings_bg_purple:"",settings_bg_royal_purple:" ",settings_version:"",folder_manage_title:" ",folder_manage_info:" ",folder_manage_collaborators:"",folder_manage_settings:"",folder_name_edit:"  ",folder_invite_new:"  ",assignment_management:" ",add_assignment:" ",assignment_name:"",subject:"",estimated_time:" ()",difficulty:"",due_date:" ",today_schedule:"   ",minutes:"",difficulty_level:" ",auto_allocated:" ",ai_analysis:"AI ",ai_estimate_time:" AI ",ai_estimate_difficulty:" AI ",ai_optimize_schedule:" AI ",ai_suggestion:"AI ",assignment_description:" ",assignment_description_placeholder:"    (AI     )",folder_invite_email:"   ",folder_invite_role:"",folder_role_owner:"",folder_role_editor:"",folder_role_viewer:"",folder_invite_button:"",folder_leave:" ",folder_delete:" ",folder_share_link:" ",folder_share_link_desc:"      ",folder_copy_link:" ",folder_leave_confirm:" ?",folder_delete_confirm:" ?       .",settings_developer:"",developer_name:"Kim Kyumin",settings_copyright:"",copyright_notice:" 2025 Kim Kyumin. All Rights Reserved.",build_number:" ",settings_data_header:" ",settings_data_header_desc:"   ,  .",settings_background_header:"",settings_background_header_desc:"     .",data_importing:" ...",data_exporting:" ...",data_deleting:" ...",url_import_title:"URL  ",url_import_message:"URL     ?",url_import_confirm:"",url_import_success:"URL   !",url_import_error:"URL   .",settings_share_link_header:" ",settings_generate_link:"  ",settings_copy_link:"",link_copied_toast:" .",short_url_created:"URL !",share_link_created:"URL ",short_url_failed:"URL     .",no_data_to_share:"  .",usage_guide_tab:"",usage_guide_title:" ",usage_basic_title:" ",usage_basic_desc:`1.   "   "  .
2. , , ,   .
3.    .
4. ""    .`,usage_ai_title:"Gemini AI  ",usage_ai_desc:`    ""  Gemini AI   .
   " "     .
 Gemini AI       .

 Gemini AI    API   .`,usage_ai_setup_title:"Gemini AI ",usage_ai_setup_desc:`1.  >  "Gemini AI "  .
2. Google Gemini API  .
3. API     Google   :
   https://ai.google.dev/gemini-api/docs/api-key
4.    Gemini AI  .`,usage_share_title:" ",usage_share_desc:`1.  >  "  "  .
2.     .
3. " "   .
4.    .`,usage_theme_title:" ",usage_theme_desc:`1.  >     .
2.     .
3. , , , ,     .
4.    .`,usage_calendar_title:"  ",usage_calendar_desc:`1.     .
2. 3//    .
3.      .
4.      .`,usage_offline_title:"  ",usage_offline_desc:`1.  >  " "  .
2. API    , ,  .
3. AI         .
4.    .`,goal_assistant_title:" ",goal_assistant_mode_woop:"WOOP",goal_assistant_mode_automation:" ",automation_title:"  ",automation_base_name_label:" ",automation_base_name_placeholder:":   ",automation_total_units_label:" ",automation_total_units_placeholder:": 30",automation_units_per_day_label:" ",automation_period_label:"",automation_start_date_label:"",automation_end_date_label:"",automation_generate_button:"{count} ",automation_error_all_fields:"   .",automation_error_start_after_end:"   .",automation_error_short_period:"  . (1 )",next_button:"",back_button:"",wish_tip:"  ,    .",wish_example:": 3  5kg ,   90  ",outcome_tip:"          .",outcome_example:":     ,   ",obstacle_tip:"      (,  ) ?",obstacle_example:":       ,    ",plan_tip:"' ~, ~'       .",plan_example:":      ,    10 .",recurrence_label:"",recurrence_tip:"     ?      .",recurrence_example:":  ,,  ",recurrence_option_daily:" ",deadline_tip:"    .     .",deadline_option_no_deadline:" ",day_names_short_picker:["","","","","","",""],settings_delete_account:"   ",edit_todo_title:" ",todo_title_label:" ",todo_title_placeholder:" ",recurring_label:" ",recurring_days_label:" ",delete_account_header:" ",delete_account_header_desc:"    ,     .",version_update_title:" ",version_update_1_title:"Firebase  ",version_update_1_desc:"Google        .   Google     .",version_update_2_title:"  ",version_update_2_desc:", ,           .",version_update_3_title:" ",version_update_3_desc:"     ,      .",version_update_4_title:"  UI",version_update_4_desc:", ,           ."},en:{language_selection_title:"Language",error_wish_required:"Enter your goal",error_outcome_required:"Enter the outcome",error_obstacle_required:"Enter the obstacle",error_plan_required:"Enter your plan",error_deadline_required:"Select a date",error_day_required:"Select a day",my_goals_title:"Goals",all_goals_label:"All",all_goals_button:"All",sort_label_manual:"Manual",sort_label_deadline:"By Date",sort_label_newest:"Recent",sort_label_alphabetical:"Name",sort_label_ai:"Priority",ai_sorting_button:"Sorting",add_new_goal_button_label:"Add Goal",filter_all:"All Goals",filter_active:"In Progress",filter_completed:"Complete",filter_category:"Category",category_all:"All Categories",category_school:"School",category_work:"Work",category_personal:"Personal",category_other:"Other",category_label:"Category",empty_message_all:"Add your first goal",empty_message_active:"No goals in progress",empty_message_completed:"No completed goals",empty_encouragement_1:"Take the first step",empty_encouragement_2:"Small changes lead to big achievements",empty_encouragement_3:"Today is the perfect day to start",empty_encouragement_4:"Turn your goals into reality",delete_button:"Delete",edit_button_aria:"Edit",info_button_aria:"Info",filter_title:"Filter",sort_title:"Sort",filter_sort_button_aria:"Filter & Sort",category_filter_button_aria:"Category Filter",calendar_view_button_aria:"Calendar",list_view_button_aria:"List",more_options_button_aria:"More",select_button_label:"Select",cancel_selection_button_label:"Cancel",delete_selected_button_label:"Delete {count}",selection_summary_label:"{count} of {total} selected",select_all_button_label:"Select All",delete_selected_confirm_title:"Delete Goals",delete_selected_confirm_message:"{count} goals will be deleted. This cannot be undone.",days_left:"{count} days left",d_day:"Due Today",days_overdue:"{count} days overdue",month_names:["January","February","March","April","May","June","July","August","September","October","November","December"],day_names_short:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],day_names_long:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],calendar_header_month_format:"{month} {year}",calendar_view_day3:"3-Day",calendar_view_week:"Week",calendar_view_month:"Month",settings_title:"Settings",sort_alert_title:"Unable to Sort",sort_alert_message:"Add at least two goals to use priority order.",ai_sort_error_title:"Unable to Sort",ai_sort_error_message:"Cannot connect to server. Please try again later.",confirm_button:"OK",new_goal_modal_title:"New Goal",edit_goal_modal_title:"Edit Goal",wish_label:"Wish",outcome_label:"Outcome",obstacle_label:"Obstacle",plan_label:"If-Then Plan",deadline_label:"Deadline",cancel_button:"Cancel",add_button:"Add",save_button:"Save",goal_details_modal_title:"Goal Details",todo_details_title:"Task Details",task_title_label:"Task",due_date_label:"Due Date",time_label:"Time",completion_status_label:"Status",completed:"Completed",pending:"In Progress",ai_coach_suggestion:"View Summary",ai_analyzing:"Analyzing...",close_button:"Close",ai_sort_reason_modal_title:"Sort Reason",ai_sort_criteria:" Sort Criteria",delete_account_final_confirm_title:"Delete All Data",delete_account_final_confirm_message:"All your goals and data will be permanently deleted. This action cannot be undone.",delete_all_data_button:"Delete All Data",settings_done_button:"Done",settings_section_data:"Data Management",settings_export_data:"Export",settings_import_data:"Import",import_confirm_title:"Import Data",import_confirm_message:"This will replace your current goals with new data. This action cannot be undone.",import_success_toast:"Data imported successfully.",import_error_alert_title:"Import Failed",import_error_alert_message:"There was an error reading the file, or the file format is incorrect.",settings_section_general:"General",settings_section_info:"Information",settings_section_help:"How to Use",settings_theme_mode:"Theme Mode",theme_mode_light:"Light Mode",theme_mode_light_desc:"Use bright theme",theme_mode_dark:"Dark Mode",theme_mode_dark_desc:"Use dark theme",theme_mode_system:"Follow System Settings",theme_mode_system_desc:"Automatically adjust to device settings",settings_dark_mode:"Dark Mode",settings_language:"Language",settings_api_key:"Gemini AI Setup",settings_api_key_placeholder:"Enter Gemini API key",settings_offline_mode:"Offline Mode",settings_offline_mode_desc:"Use basic features without AI",settings_notifications:"Notifications",settings_notifications_desc:"PWA notification settings",notification_settings_title:"What notifications would you like?",notification_permission_denied:"Notifications Blocked",notification_permission_denied_desc:"Enable notifications in settings to use this feature",notification_permission_request:"Request Permission",notification_deadline:"Deadline Alerts",notification_deadline_desc:"Get notified when deadlines are approaching.",notification_suggestion:"Today's Suggestions",notification_suggestion_desc:"Get suggestions on what to do today.",notification_achievement:"Achievement Celebration",notification_achievement_desc:"Celebrate when you achieve a goal.",notification_reminder:"General Todo",notification_reminder_desc:"Get notified at scheduled times.",reminder_time_settings_title:"Todo Time Settings",reminder_start_time:"Start Time",reminder_end_time:"End Time",reminder_add_title:"Add Todo",reminder_step_title:"Step {step}/5",reminder_step1_title:" Title",reminder_step1_desc:"Enter the todo title",reminder_step2_title:" Date &  Time",reminder_step2_desc:"Set the todo date and time (optional)",reminder_step2_date_toggle:"Set Date",reminder_step2_time_toggle:"Set Time",reminder_step3_title:" Recurring",reminder_step3_desc:"Choose recurrence settings",reminder_step3_enable_recurring:"Enable Recurring",reminder_step4_title:" Description",reminder_step4_desc:"Add optional description",reminder_step5_title:" Enable",reminder_step5_desc:"Choose whether to enable todo",reminder_next_button:"Next",reminder_back_button:"Back",reminder_submit_button:"Add",reminder_form_title:"Title",reminder_form_date:"Date",reminder_form_time:"Time",reminder_form_recurring:"Recurring",reminder_form_description:"Description",reminder_form_enabled:"Enabled",recurring_type_none:"No Recurrence",recurring_type_daily:"Daily",recurring_type_weekly:"Weekly",recurring_type_monthly:"Monthly",language_name:"English (US)",language_modal_title:"Language",settings_section_background:"Appearance",settings_share_link_header:"Share via Link",settings_generate_link:"Generate Share Link",settings_bg_default:"Light",settings_bg_default_dark:"Dark",settings_bg_pink:"Pink",settings_bg_cherry_noir:"Cherry Noir",settings_bg_blue:"Blue",settings_bg_deep_ocean:"Ocean",settings_bg_green:"Green",settings_bg_forest_green:"Forest",settings_bg_purple:"Purple",settings_bg_royal_purple:"Royal Purple",settings_section_account:"Nova AI Planner Account",settings_sync_data:"Sync Data",settings_syncing:"Saving...",settings_save_to_cloud:"Save to Cloud",settings_loading:"Loading...",settings_load_from_cloud:"Load from Cloud",settings_auto_sync:"Auto Sync",settings_auto_sync_desc:"Automatically save when goals change",settings_cloud_sync_header:"Cloud Sync",woop_not_set:"Not Set",settings_logout:"Sign Out",settings_delete_account:"Delete My Data",edit_todo_title:"Edit Todo",todo_title_label:"Todo Title",todo_title_placeholder:"Enter your todo",recurring_label:"Recurring",recurring_days_label:"Recurring Days",delete_account_header:"Delete Data",delete_account_header_desc:"This action is irreversible and will permanently delete all your goals and data.",data_deleting:"Deleting...",settings_version:"Version",settings_developer:"Developer",developer_name:"GimGyuMin",settings_copyright:"Copyright",copyright_notice:" 2025 GimGyuMin. All Rights Reserved.",build_number:"Build Number",settings_data_header:"Data Management",settings_data_header_desc:"Export or import your goal data.",settings_background_header:"Background",settings_background_header_desc:"Change the app's background style to express your personality.",data_importing:"Importing...",data_exporting:"Exporting..."}},xe={add:p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),p.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),check:p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:p.jsx("polyline",{points:"20 6 9 17 4 12"})}),info:p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("circle",{cx:"12",cy:"12",r:"10"}),p.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),p.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),delete:p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("polyline",{points:"3 6 5 6 21 6"}),p.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}),p.jsx("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),p.jsx("line",{x1:"14",y1:"11",x2:"14",y2:"17"})]}),edit:p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),p.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),close:p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),p.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}),back:p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:p.jsx("polyline",{points:"15 18 9 12 15 6"})}),forward:p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:p.jsx("polyline",{points:"9 18 15 12 9 6"})}),calendar:p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),p.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),p.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),p.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),list:p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("line",{x1:"8",y1:"6",x2:"21",y2:"6"}),p.jsx("line",{x1:"8",y1:"12",x2:"21",y2:"12"}),p.jsx("line",{x1:"8",y1:"18",x2:"21",y2:"18"}),p.jsx("line",{x1:"3",y1:"6",x2:"3.01",y2:"6"}),p.jsx("line",{x1:"3",y1:"12",x2:"3.01",y2:"12"}),p.jsx("line",{x1:"3",y1:"18",x2:"3.01",y2:"18"})]}),settings:p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("circle",{cx:"12",cy:"12",r:"3"}),p.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]}),filter:p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:p.jsx("polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"})}),ai:p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("path",{d:"M12 3L14.34 8.66L20 11L14.34 13.34L12 19L9.66 13.34L4 11L9.66 8.66L12 3Z"}),p.jsx("path",{d:"M5 21L7 16"}),p.jsx("path",{d:"M19 21L17 16"})]}),flame:p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:p.jsx("path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"})}),data:p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83"}),p.jsx("path",{d:"M22 12A10 10 0 0 0 12 2v10z"})]}),background:p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),p.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),p.jsx("polyline",{points:"21 15 16 10 5 21"})]}),exclamation:p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 15c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1zm1-4h-2V7h2v6z"})})},lu=(t,e)=>{const n=new Date(t),r=new Date(e);return n.getFullYear()===r.getFullYear()&&n.getMonth()===r.getMonth()&&n.getDate()===r.getDate()},R6=(t,e)=>{if(!t)return null;const n=new Date;n.setHours(0,0,0,0);const r=new Date(t);r.setHours(0,0,0,0);const i=r.getTime()-n.getTime(),s=Math.ceil(i/(1e3*60*60*24));return s===0?e("d_day"):s>0?e("days_left").replace("{count}",String(s)):e("days_overdue").replace("{count}",String(Math.abs(s)))},Yw=(t,e=1)=>{const n=new Date(t),r=n.getDay(),i=(r<e?7:0)+r-e;return n.setDate(n.getDate()-i),n.setHours(0,0,0,0),n},mg=t=>!!(t.wish||t.outcome||t.obstacle||t.plan),gg=t=>{try{const e=new TextEncoder().encode(t),n=Array.from(e).map(r=>String.fromCharCode(r)).join("");return btoa(n)}catch(e){return console.error("UTF-8 to Base64 encoding failed:",e),""}},Xw=t=>{try{const e=atob(t),n=new Uint8Array(e.length);for(let r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return new TextDecoder().decode(n)}catch(e){return console.error("Base64 to UTF-8 decoding failed:",e),""}},Zw=t=>{try{const n=JSON.stringify(t).replace(/\s+/g," ").trim();return gg(n)}catch(e){return console.error("Data compression failed:",e),gg(JSON.stringify(t))}},tR=async t=>{if(t.length<1500)return t;const e=[{name:"is.gd",createUrl:async n=>{const r=await fetch(`https://is.gd/create.php?format=simple&url=${encodeURIComponent(n)}`);if(!r.ok)throw new Error("is.gd API failed");const i=await r.text();if(i.includes("Error")||!i.startsWith("http"))throw new Error("Invalid response from is.gd");return i.trim()}},{name:"tinyurl",createUrl:async n=>new Promise((r,i)=>{const s=`tinyurl_${Date.now()}`,o=document.createElement("script"),a=setTimeout(()=>{l(),i(new Error("TinyURL timeout"))},5e3),l=()=>{clearTimeout(a),o.parentNode&&document.head.removeChild(o),delete window[s]};window[s]=u=>{l(),u&&typeof u=="string"&&!u.includes("Error")&&u.startsWith("http")?r(u.trim()):i(new Error("Invalid TinyURL response"))},o.onerror=()=>{l(),i(new Error("TinyURL script load failed"))},o.src=`https://tinyurl.com/api-create.php?url=${encodeURIComponent(n)}&callback=${s}`,document.head.appendChild(o)})},{name:"v.gd",createUrl:async n=>{const r=await fetch(`https://v.gd/create.php?format=simple&url=${encodeURIComponent(n)}`);if(!r.ok)throw new Error("v.gd API failed");const i=await r.text();if(i.includes("Error")||!i.startsWith("http"))throw new Error("Invalid response from v.gd");return i.trim()}}];for(const n of e)try{console.log(`Trying ${n.name} for URL shortening...`);const r=await n.createUrl(t);return console.log(` ${n.name} success:`,r),r}catch(r){console.warn(` ${n.name} failed:`,r);continue}return console.warn("All URL shortening services failed, using original URL"),t},_g=[{id:"default",lightThemeClass:"bg-solid-default",darkThemeClass:"bg-solid-default",lightNameKey:"settings_bg_default",darkNameKey:"settings_bg_default_dark"},{id:"pink",lightThemeClass:"bg-solid-pink",darkThemeClass:"bg-solid-pink",lightNameKey:"settings_bg_pink",darkNameKey:"settings_bg_cherry_noir"},{id:"blue",lightThemeClass:"bg-solid-blue",darkThemeClass:"bg-solid-blue",lightNameKey:"settings_bg_blue",darkNameKey:"settings_bg_deep_ocean"},{id:"green",lightThemeClass:"bg-solid-green",darkThemeClass:"bg-solid-green",lightNameKey:"settings_bg_green",darkNameKey:"settings_bg_forest_green"},{id:"purple",lightThemeClass:"bg-solid-purple",darkThemeClass:"bg-solid-purple",lightNameKey:"settings_bg_purple",darkNameKey:"settings_bg_royal_purple"}],P6=()=>{const[t,e]=O.useState("ko"),[n,r]=O.useState([]),[i,s]=O.useState([]),[o,a]=O.useState([]),[l,u]=O.useState([]),[f,m]=O.useState("my-goals"),[g,v]=O.useState("all"),[T,P]=O.useState("all"),[M,x]=O.useState("manual"),[E,A]=O.useState(["school","work","personal","other"]),[V,B]=O.useState(()=>Pp()==="dark"),[G,I]=O.useState("system"),[S,R]=O.useState("default"),[N,D]=O.useState([]),[L,b]=O.useState({}),[Re,Ze]=O.useState([]),[Ge,Se]=O.useState(!1),[ee,fe]=O.useState(!1),[me,Pe]=O.useState(null),[Oe,Vt]=O.useState(!1),[Fe,Lt]=O.useState(!1),[ke,ze]=O.useState(""),[Bt,Gt]=O.useState(!1),[Tn,Kn]=O.useState(null),[Rt,ue]=O.useState(""),[rt,fr]=O.useState(""),[pr,Jn]=O.useState("editor"),[Ne,We]=O.useState(!1),[$e,fn]=O.useState(null),[Mr,En]=O.useState(!1),[Et,mr]=O.useState(!1),[Qn,vs]=O.useState(!1),[_t,ve]=O.useState(null),[xo,hi]=O.useState(!1),[wn,Vn]=O.useState(new Set),[Ln,Ce]=O.useState(""),[ce,St]=O.useState("idle"),[Ts,il]=O.useState(!1),[fi,sl]=O.useState(!1),[qt,hc]=O.useState(""),[Es,Vr]=O.useState(!1),[ws,ol]=O.useState(void 0),[pi,fc]=O.useState(!1),[mi,gr]=O.useState(""),[gi,al]=O.useState(!1),[_i,yi]=O.useState(!0),[Rf,Yn]=O.useState("default"),[Y,Is]=O.useState(null),[pc,mc]=O.useState(""),[Pf,wy]=O.useState(!1),[gc,Ao]=O.useState(!1),[Ro,Ss]=O.useState(!1),[Cs,et]=O.useState(!1),[Lr,xs]=O.useState(!1),[ll,_c]=O.useState(!0),[kf,Nf]=O.useState(!1),[yc,ul]=O.useState(0),[bf,cl]=O.useState("activity-based"),[Po,Df]=O.useState(null),[Fn,Xn]=O.useState(3e3),[ko,vi]=O.useState(!1),[No,tt]=O.useState(!1);O.useEffect(()=>{const w=()=>{"Notification"in window&&Yn(Notification.permission)};w();const k=()=>{w()};return window.addEventListener("focus",k),()=>window.removeEventListener("focus",k)},[]),O.useEffect(()=>{let w=null,k=null,F=null;const U=OL(zs,async H=>{if(Is(H),_c(!1),H){console.log("    - Firebase   "),await bo(H),console.log("      ...");let J=null,W=null;const X=Le(ge,"users",H.uid,"data","todos");w=qr(X,Z=>{J&&clearTimeout(J),J=setTimeout(()=>{if(Z.exists()){const pe=Z.data().todos||[];r(ae=>{const c=ae.filter(C=>C.isSharedTodo===!0),_=pe.map(C=>({...C,isSharedTodo:!1}));return JSON.stringify(ae.filter(C=>!C.isSharedTodo))!==JSON.stringify(_)?(console.log("     :",_.length,"  :",c.length),[..._,...c]):ae})}},2e3)});const j=lt(ge,"users",H.uid,"folders");k=qr(j,async Z=>{W&&clearTimeout(W),W=setTimeout(async()=>{const K=[];Z.forEach(ae=>{const c=ae.data(),_={id:ae.id,name:c.name||"  ",color:c.color||"#007AFF",...c,collaborators:c.collaborators||[],ownerId:c.ownerId||H.uid};K.push(_)});const pe=K.filter(ae=>ae.isShared&&ae.ownerId&&ae.ownerId!==H.uid);if(pe.length>0){console.log("     :",pe.map(c=>({id:c.id,name:c.name,ownerId:c.ownerId}))),F&&F();const ae=[];for(const c of pe)if(c.ownerId)try{const _=Le(ge,"users",c.ownerId,"folders",c.id),y=qr(_,Te=>{if(Te.exists()){const Je=Te.data();console.log("     :",{folderId:c.id,name:Je.name,color:Je.color}),u(De=>De.map(He=>He.id===c.id?{...He,name:Je.name||He.name||" ",color:Je.color||He.color,updatedAt:Je.updatedAt||He.updatedAt}:He))}},Te=>{console.error("     :",Te)});ae.push(y);const C=lt(ge,"users",c.ownerId,"todos"),q=Ol(C,Bl("folderId","==",c.id));let $=null;const ie=qr(q,Te=>{$&&clearTimeout($),$=setTimeout(()=>{const Je=[];Te.forEach(De=>{const He=De.data();Je.push({id:parseInt(De.id),...He,isSharedTodo:!0})}),console.log("     :",{folderId:c.id,count:Je.length}),r(De=>{const He=De.filter(Sn=>!(Sn.folderId===c.id&&Sn.isSharedTodo===!0)),In=Je.filter(Sn=>!He.some(Tr=>Tr.id===Sn.id)),vr=[...He,...In];return console.log("   :",{:De.length,:De.length-He.length,:In.length,:vr.length}),vr})},1500)},Te=>{console.warn("     :",{folderId:c.id,error:Te.code})});ae.push(ie)}catch(_){console.warn("     :",{folderId:c.id,error:_})}F=()=>{ae.forEach(c=>c())}}u(ae=>JSON.stringify(ae)!==JSON.stringify(K)?(console.log("    :",K.map(_=>({id:_.id,name:_.name}))),K):ae)},3e3)})}else console.log("    -  "),w&&(w(),w=null),k&&(k(),k=null),F&&(F(),F=null),r([]),u([]),e("ko"),I("system"),R("default"),gr(""),A(["school","work","personal","other"])});return()=>{U(),w&&w(),k&&k(),F&&F()}},[]);const Ti=O.useCallback(async()=>{Ao(!0);try{console.log(" Google  ..."),console.log("Auth :",zs),console.log("Google Provider :",Ha);const w=window.open("","_blank","width=1,height=1");if(!w||w.closed||typeof w.closed>"u")throw new Error(" .    .");w.close(),console.log(" signInWithPopup  ...");const k=await iF(zs,Ha);console.log("  :",k.user.email),Is(k.user),Ce(" Google  !"),setTimeout(async()=>{var F;try{console.log("    ...");const{doc:U,getDoc:H}=await Vs(async()=>{const{doc:Z,getDoc:K}=await Promise.resolve().then(()=>Fs);return{doc:Z,getDoc:K}},void 0),J=U(ge,"users",k.user.uid,"data","todos"),W=await H(J);if(W.exists()){const Z=W.data();r(Z.todos||[]),console.log("    :",((F=Z.todos)==null?void 0:F.length)||0)}else console.log("   -    "),r([]);const X=U(ge,"users",k.user.uid,"data","settings"),j=await H(X);if(j.exists()){const Z=j.data();Z.language&&e(Z.language),Z.themeMode&&I(Z.themeMode),Z.isDarkMode!==void 0&&B(Z.isDarkMode),Z.backgroundTheme&&R(Z.backgroundTheme),Z.apiKey&&gr(Z.apiKey)}Ce("  !  ")}catch(U){console.error("  :",U),Ce("     ")}Ao(!1),setTimeout(()=>Ce(""),3e3)},500),setTimeout(()=>Ce(""),3e3)}catch(w){console.error(" Google  :",w),console.error(" :",w.code),console.error(" :",w.message);let k="   .";switch(w.code){case"auth/popup-closed-by-user":k=" .";break;case"auth/popup-blocked":k=" .    .";break;case"auth/cancelled-popup-request":k="    .";break;case"auth/network-request-failed":k="  .";break;case"auth/too-many-requests":k="   .    .";break;case"auth/user-disabled":k=" .";break;case"auth/operation-not-allowed":k="Google   .  .";break;default:k=` : ${w.message}`}w.code!=="auth/popup-closed-by-user"&&ve({title:" ",message:k,confirmText:"",onConfirm:()=>ve(null)}),Ao(!1)}},[]),As=(w,k)=>{if(w===null)return;const F=l.map(U=>U.id===w?{...U,collaborators:k}:U);u(F),ws&&ws.id===w&&ol({...ws,collaborators:k}),Ce("   "),setTimeout(()=>Ce(""),3e3)},Rs=O.useCallback(async()=>{Ss(!0);try{if(Y){Ce("   ...");const w=n.filter(Z=>Z!=null),{doc:k,setDoc:F,serverTimestamp:U}=await Vs(async()=>{const{doc:Z,setDoc:K,serverTimestamp:pe}=await Promise.resolve().then(()=>Fs);return{doc:Z,setDoc:K,serverTimestamp:pe}},void 0),H=w.map(Z=>Pt(Z)).filter(Z=>Z!==void 0),J=k(ge,"users",Y.uid,"data","todos"),W={todos:H,lastSyncTime:U(),totalGoals:H.length,syncedAt:new Date().toISOString()},X=Pt(W);X?(await F(J,X),console.log(" Todos Firestore  :",{count:H.length})):console.error(" Todos   ");const j=k(ge,"users",Y.uid,"data","settings");await F(j,{language:t,themeMode:G,isDarkMode:V,backgroundTheme:S,updatedAt:U()})}await _E(zs),Is(null),r([]),e("ko"),R("default"),I("system"),B(Pp()==="dark"),Pe(null),En(!1),fe(!1),Ce("  "),setTimeout(()=>Ce(""),3e3),Ss(!1)}catch(w){console.error(" :",w),ve({title:" ",message:"   .",confirmText:"",onConfirm:()=>ve(null)}),Ss(!1)}},[Y,n,t,G,V,S]),Ps=O.useCallback(async()=>{if(!Y){ve({title:" ",message:" ",confirmText:"",onConfirm:()=>ve(null)});return}et(!0);try{const w=n.filter(K=>K!=null),{doc:k,setDoc:F,serverTimestamp:U}=await Vs(async()=>{const{doc:K,setDoc:pe,serverTimestamp:ae}=await Promise.resolve().then(()=>Fs);return{doc:K,setDoc:pe,serverTimestamp:ae}},void 0),H=w.map(K=>Pt(K)).filter(K=>K!==void 0),J=k(ge,"users",Y.uid,"data","todos"),W={todos:H,lastSyncTime:U(),totalGoals:H.length,syncedAt:new Date().toISOString()},X=Pt(W);if(X)await F(J,X),console.log("  Todos Firestore  :",{count:H.length});else throw new Error("Todos   ");const j=k(ge,"users",Y.uid,"data","settings"),Z={language:t,themeMode:G,isDarkMode:V,backgroundTheme:S,apiKey:mi,userCategories:E,updatedAt:U()};await F(j,Z);for(const K of l)try{const pe=k(ge,"users",Y.uid,"folders",K.id),ae={...K,ownerId:K.ownerId||Y.uid,collaborators:K.collaborators||[],updatedAt:U()};await F(pe,ae),console.log(`  ${K.id}  `)}catch(pe){console.error(`  ${K.id}  :`,pe)}et(!1)}catch(w){console.error(" :",w),ve({title:" ",message:w.message||"    .",confirmText:"",onConfirm:()=>ve(null)}),et(!1)}},[Y,n,t,G,V,S,mi]),bo=O.useCallback(async w=>{var k;try{const{doc:F,getDoc:U,collection:H,getDocs:J}=await Vs(async()=>{const{doc:K,getDoc:pe,collection:ae,getDocs:c}=await Promise.resolve().then(()=>Fs);return{doc:K,getDoc:pe,collection:ae,getDocs:c}},void 0),W=F(ge,"users",w.uid,"data","todos"),X=await U(W);if(X.exists()){const pe=X.data().todos||[];r(ae=>{const c=new Set(ae.map(C=>C.id)),_=pe.filter(C=>!c.has(C.id)),y=[...ae,..._];return console.log("   :",{:ae.length,:pe.length,:_.length,:y.length}),y})}const j=F(ge,"users",w.uid,"data","settings"),Z=await U(j);if(Z.exists()){const K=Z.data();K.language&&e(K.language),K.themeMode&&I(K.themeMode),K.isDarkMode!==void 0&&B(K.isDarkMode),K.backgroundTheme&&R(K.backgroundTheme),K.apiKey&&gr(K.apiKey),K.userCategories&&A(K.userCategories)}try{const K=H(ge,"users",w.uid,"folders"),pe=await J(K),ae=[];pe.forEach(c=>{const _=c.data(),y={id:c.id,..._,collaborators:_.collaborators||[],ownerId:_.ownerId||w.uid};ae.push(y)}),u(c=>{const _=new Set(c.map(q=>q.id)),y=ae.filter(q=>!_.has(q.id)),C=[...c,...y];return console.log("   :",{:c.length,:ae.length,:y.length,:C.length}),C}),console.log("   :",{count:ae.length})}catch(K){console.warn("   ,   :",K)}console.log("    :",{todos:X.exists()&&((k=X.data().todos)==null?void 0:k.length)||0,folders:"",settings:Z.exists()?"":""})}catch(F){console.error("    :",F)}},[]),Mf=O.useCallback(async()=>{if(!Y){ve({title:" ",message:" ",confirmText:"",onConfirm:()=>ve(null)});return}xs(!0);try{await bo(Y),Ce("    !")}catch(w){console.error(" :",w),ve({title:" ",message:w.message||"    .",confirmText:"",onConfirm:()=>ve(null)})}finally{xs(!1)}},[Y,bo]),re=O.useCallback(w=>A6[t][w]||w,[t]),Fr=O.useCallback(w=>{let k=w||mi;if(gi||!k)return null;try{return k=k.trim(),/^[\x00-\x7F]*$/.test(k)?k.length===0?(console.warn(" API  ."),null):new m2({apiKey:k}):(console.error(" API      . ASCII  ."),null)}catch(F){return console.error(" AI   :",F),null}},[mi,gi]),Vf=O.useCallback(w=>{I(w)},[]),Ur=O.useMemo(()=>[re("empty_encouragement_1"),re("empty_encouragement_2"),re("empty_encouragement_3"),re("empty_encouragement_4")],[re]),Or=O.useMemo(()=>Ur[Math.floor(Math.random()*Ur.length)],[Ur]);O.useEffect(()=>{console.log("     - localStorage   ")},[]),O.useEffect(()=>{const w=G==="dark"||G==="system"&&Pp()==="dark";w?document.documentElement.classList.add("dark-mode"):document.documentElement.classList.remove("dark-mode"),document.documentElement.setAttribute("data-bg-theme",S),console.log("  :",{themeMode:G,backgroundTheme:S,isDark:w})},[G,S]),O.useEffect(()=>{(()=>{u(k=>{const F=k.filter(U=>{if(!U.collaborators||U.collaborators.length===0)return!0;const H=U.collaborators.find(J=>J.role==="owner");return!H||!H.userId||H.userId.startsWith("owner_")?(console.warn("    :",U.name,H==null?void 0:H.userId),!1):!0});return F.length!==k.length&&console.log("     :",{:k.length-F.length,:F.length}),F})})()},[]),O.useEffect(()=>{if(ll)return;const w=async()=>{const k=new URLSearchParams(window.location.search),F=k.get("data"),U=k.get("folder_share");if(U){try{const H=Xw(U),J=JSON.parse(H);if(J.type==="folder_share"&&J.folderId){if(J.password){const X=sessionStorage.getItem(`folder_${J.folderId}_password`);if(!X||X!==J.password){ve({title:" ",message:"    .  .",confirmText:"",cancelText:"",onConfirm:()=>{const j=prompt("  :");j===J.password?(sessionStorage.setItem(`folder_${J.folderId}_password`,j),ve(null),w()):j!==null&&ve({title:" ",message:"  .",confirmText:"",onConfirm:()=>{window.history.replaceState({},document.title,window.location.pathname)}})},onCancel:()=>{window.history.replaceState({},document.title,window.location.pathname)}});return}}if(l.some(X=>X.id===J.folderId))window.history.replaceState({},document.title,window.location.pathname);else{if(J.ownerId&&!Y&&!ll){ve({title:" ",message:"        .  .",confirmText:"",cancelText:"",onConfirm:async()=>{try{await Ti()}catch(K){console.error("  :",K)}},onCancel:()=>{window.history.replaceState({},document.title,window.location.pathname)}});return}const X=J.ownerId||null;if(!X){console.error("     :",J),ve({title:"   ",message:`    .
     .`,confirmText:"",onConfirm:()=>{ve(null),window.history.replaceState({},document.title,window.location.pathname)}});return}const j={id:J.folderId,name:J.folderName,color:J.folderColor||"#007AFF",ownerId:X,collaborators:[{userId:X,email:J.sharedBy||"",role:"owner",addedAt:J.sharedAt}],createdAt:J.sharedAt,updatedAt:J.sharedAt,isShared:!0};let Z=j;if(X&&Y)try{console.log("   :",{ownerUserId:X,googleUserUid:Y.uid});const K=lt(ge,"users",X,"folders"),pe=Le(K,J.folderId),ae=await fg(pe);if(console.log("   :",{exists:ae.exists()}),ae.exists()){let c=ae.data().collaborators||[];console.log("   :",c);const _=c.some(y=>y.userId===Y.uid);if(console.log("  :",{isCollaborator:_}),_)console.log("  ");else{const y={userId:Y.uid,email:Y.email||"",role:"editor",addedAt:new Date().toISOString()};c=[...c,y],console.log("   :",c);const C=Pt(c);C?(await yt(pe,{collaborators:C,updatedAt:new Date().toISOString()},{merge:!0}),console.log("  Firestore  :",y)):console.warn("     ")}Z={...j,collaborators:c}}else console.warn("   :",J.folderId)}catch(K){console.error("   / :",K)}else console.warn("    :",{ownerUserId:X,hasGoogleUser:!!Y});if(u([...l,Z]),Y)try{const{doc:K,setDoc:pe}=await Vs(async()=>{const{doc:c,setDoc:_}=await Promise.resolve().then(()=>Fs);return{doc:c,setDoc:_}},void 0),ae=K(ge,"users",Y.uid,"folders",Z.id);await pe(ae,{name:Z.name,color:Z.color,ownerId:Z.ownerId,createdAt:Z.createdAt,updatedAt:Z.updatedAt,isShared:Z.isShared,collaborators:Z.collaborators||[],collaborationSettings:Z.collaborationSettings||{enabled:!0,showPresence:!0,showEditingState:!0,enableConflictDetection:!0,allowGuestView:!1,requireApproval:!1}}),console.log("   Firebase  :",Z.id)}catch(K){console.error("   Firebase  :",K)}m(Z.id),ve({title:"  ",message:`"${J.folderName}"  .    .`,confirmText:"",onConfirm:()=>{window.history.replaceState({},document.title,window.location.pathname)}})}}}catch(H){console.error("    :",H),window.history.replaceState({},document.title,window.location.pathname)}return}if(F)try{const H=Xw(F),J=JSON.parse(H);if(Array.isArray(J)&&(J.length===0||"wish"in J[0]&&"id"in J[0]))ve({title:re("url_import_title"),message:re("url_import_message"),confirmText:re("url_import_confirm"),cancelText:re("cancel_button"),onConfirm:()=>{r(J),Ce(re("url_import_success")),window.history.replaceState({},document.title,window.location.pathname)},onCancel:()=>{window.history.replaceState({},document.title,window.location.pathname)}});else throw new Error("Invalid data format")}catch(H){console.error("Failed to parse data from URL",H),ve({title:re("import_error_alert_title"),message:re("url_import_error")}),window.history.replaceState({},document.title,window.location.pathname)}};w()},[re,l,Y,Ti,ll]),O.useEffect(()=>{if(!f||!Y)return;const w=l.find(j=>j.id===f);if(!w||!w.collaborators||w.collaborators.length===0)return;const k=w.collaborators.find(j=>j.role==="owner");if(!k)return;const F=k.userId;if(!F||F.startsWith("owner_")){console.warn(" Invalid owner UID:",k);return}const U=[],H=Le(ge,"users",F,"folders",f),J=qr(H,j=>{if(j.exists()){const Z=j.data();Z.collaborators&&u(K=>K.map(pe=>pe.id===f?{...pe,collaborators:Z.collaborators}:pe))}},j=>{console.warn("      (    ):",j.code)});U.push(J);const W=lt(ge,"users",F,"todos");console.log(" Syncing todos from owner:",{ownerUid:F,currentFolderId:f});const X=qr(W,j=>{const Z=[];j.forEach(K=>{const pe=K.data();pe.folderId===f&&Z.push({id:parseInt(K.id),...pe})}),console.log(" Owner todos received:",{count:Z.length,ownerTodos:Z}),r(K=>{const pe=K.filter(y=>y.folderId!==f),ae=K.filter(y=>y.folderId===f),c=[],_=new Set;return Z.forEach(y=>{c.push(y),_.add(y.id)}),ae.forEach(y=>{_.has(y.id)||c.push(y)}),[...pe,...c]})},j=>{console.error("   :",j),j.code==="permission-denied"?(console.warn("      -   "),Ce("    -    ")):j.code==="not-found"?(console.warn("     -    "),Ce("     ")):(console.warn("     "),Ce("   -   "))});return U.push(X),()=>{U.forEach(j=>j())}},[f,Y]),O.useEffect(()=>{var j,Z;if(!f||!Y)return;const w=l.find(K=>K.id===f),k=((j=w==null?void 0:w.collaborationSettings)==null?void 0:j.enabled)||(w==null?void 0:w.isShared)||!1,F=((Z=w==null?void 0:w.collaborationSettings)==null?void 0:Z.showPresence)??!0;if(!k||!F){D([]);return}console.log("     :",{folderId:f,showPresence:F});const U=lt(ge,"folderPresence",f,"users"),H=Le(U,Y.uid);(async()=>{try{await yt(H,{userId:Y.uid,displayName:Y.displayName||"Anonymous",photoURL:Y.photoURL||null,isOnline:!0,lastSeen:new Date,currentFolder:f},{merge:!0}),console.log("    :",Y.displayName)}catch(K){console.warn("presence set failed",K)}})();const W=setInterval(()=>{yt(H,{lastSeen:new Date,isOnline:!0},{merge:!0}).catch(()=>{})},3e4),X=qr(U,K=>{const ae=K.docs.map(c=>{const _=c.data();return{userId:_.userId||c.id,displayName:_.displayName||"Anonymous",photoURL:_.photoURL||void 0,isOnline:!!_.isOnline,lastSeen:_.lastSeen?_.lastSeen.toDate?_.lastSeen.toDate():new Date(_.lastSeen):new Date,currentFolder:_.currentFolder}}).filter(c=>!!c.userId&&c.isOnline);D(ae),console.log("   :",ae.map(c=>c.displayName))},K=>console.warn("presence listen failed",K));return()=>{clearInterval(W),yt(H,{isOnline:!1,lastSeen:new Date},{merge:!0}).catch(()=>{}),X()}},[f,Y,l]),O.useCallback(async w=>{var H,J;if(!f||!Y)return;const k=l.find(W=>W.id===f),F=((H=k==null?void 0:k.collaborationSettings)==null?void 0:H.showEditingState)??!0;if(!(!((J=k==null?void 0:k.collaborationSettings)!=null&&J.enabled||k!=null&&k.isShared)||!F))try{const W=Le(ge,"folderEditing",`${f}_${w}`);await yt(W,{todoId:w,userId:Y.uid,userName:Y.displayName||"Anonymous",startTime:new Date,folderId:f}),console.log("  :",{todoId:w,user:Y.displayName})}catch(W){console.warn("start editing failed",W)}},[f,Y,l]),O.useCallback(async w=>{var H,J;if(!f||!Y)return;const k=l.find(W=>W.id===f),F=((H=k==null?void 0:k.collaborationSettings)==null?void 0:H.showEditingState)??!0;if(!(!((J=k==null?void 0:k.collaborationSettings)!=null&&J.enabled||k!=null&&k.isShared)||!F))try{const W=Le(ge,"folderEditing",`${f}_${w}`);await zt(W),console.log("  :",{todoId:w,user:Y.displayName})}catch(W){console.warn("stop editing failed",W)}},[f,Y,l]),O.useEffect(()=>{var J,W;if(!f)return;const w=l.find(X=>X.id===f),k=((J=w==null?void 0:w.collaborationSettings)==null?void 0:J.showEditingState)??!0;if(!(((W=w==null?void 0:w.collaborationSettings)==null?void 0:W.enabled)||(w==null?void 0:w.isShared)||!1)||!k){b({});return}console.log("    :",{folderId:f});const U=Ol(lt(ge,"folderEditing"),Bl("folderId","==",f)),H=qr(U,X=>{const j={};X.docs.forEach(Z=>{const K=Z.data();K&&K.todoId&&(j[K.todoId]={todoId:K.todoId,userId:K.userId,userName:K.userName,startTime:K.startTime?K.startTime.toDate?K.startTime.toDate():new Date(K.startTime):new Date,folderId:K.folderId})}),b(j),console.log("   :",Object.keys(j).length+" ")},X=>console.warn("editing states listen failed",X));return()=>H()},[f,l]),O.useCallback(async w=>{var k,F;try{const U=w.ownerId||(Y==null?void 0:Y.uid);if(!U)throw new Error("No owner UID");const H=l.find(Z=>Z.id===f),J=((k=H==null?void 0:H.collaborationSettings)==null?void 0:k.enableConflictDetection)??!0,W=((F=H==null?void 0:H.collaborationSettings)==null?void 0:F.enabled)||(H==null?void 0:H.isShared)||!1,X=Le(ge,"users",U,"todos",w.id.toString());if(W&&J){const Z=await fg(X),K=Z.exists()?Z.data():null,pe=(K==null?void 0:K.version)||0,ae=w.version||0;if(K&&pe>ae&&(Ze(_=>[..._,{todoId:w.id,conflictType:"version_mismatch",localVersion:w,serverVersion:K,lastModifiedBy:K.lastModifiedBy||"unknown",lastModifiedAt:K.lastModified?K.lastModified.toDate?K.lastModified.toDate():new Date(K.lastModified):new Date}]),console.warn("  :",{todoId:w.id,localVersion:ae,serverVersion:pe,lastModifiedBy:K.lastModifiedBy}),!window.confirm("    . ? (  )")))return!1}const j=Pt({...w,version:(w.version||0)+1,lastModified:new Date,lastModifiedBy:(Y==null?void 0:Y.uid)||"unknown"});return j&&(await yt(X,j),console.log(" Todo  :",{todoId:w.id,version:j.version})),!0}catch(U){return console.error("attemptSaveTodo failed",U),!1}},[Y,f,l]),O.useEffect(()=>{const w=window.matchMedia("(prefers-color-scheme: dark)"),k=F=>{G==="system"&&B(F.matches)};return B(G==="system"?w.matches:G==="dark"),w.addEventListener("change",k),()=>w.removeEventListener("change",k)},[G]),O.useEffect(()=>{const w=()=>{console.log("  "),Ce("   "),setTimeout(()=>Ce(""),3e3)},k=()=>{console.log("   "),Ce("   -   "),setTimeout(()=>Ce(""),5e3)};return navigator.onLine||console.log("   "),window.addEventListener("online",w),window.addEventListener("offline",k),()=>{window.removeEventListener("online",w),window.removeEventListener("offline",k)}},[]),O.useEffect(()=>{const w=localStorage.getItem("pwa-prompt-dismissed"),k=Rp(),F=Qw();console.log("PWA Check:",{isMobileDevice:k,isInStandalone:F,isDismissed:w,userAgent:navigator.userAgent}),k&&!F&&!w&&(console.log("Showing PWA prompt immediately"),fc(!0))},[]),O.useEffect(()=>{"serviceWorker"in navigator&&navigator.serviceWorker.register("/Nova-AI-Planer/sw.js").then(w=>{console.log("SW registered: ",w),Qw()}).catch(w=>{console.log("SW registration failed: ",w)})},[]),O.useEffect(()=>{},[G,V]);const Ei=O.useRef(null);O.useEffect(()=>{if(!(!_i||!Y))return Ei.current&&clearTimeout(Ei.current),Ei.current=setTimeout(()=>{Ps()},5e3),()=>{Ei.current&&clearTimeout(Ei.current)}},[n,l,t,G,V,S,mi,E,_i,Y]),O.useEffect(()=>{const w=_g.find(F=>F.id===S)||_g[0],k=V?w.darkThemeClass:w.lightThemeClass;document.body.className="",V&&document.body.classList.add("dark-mode"),k&&document.body.classList.add(k)},[S,V]),O.useEffect(()=>{if(Ln){const w=setTimeout(()=>Ce(""),3e3);return()=>clearTimeout(w)}},[Ln]);const wi=O.useMemo(()=>{let w=[...n];return console.log("   :",{totalTodos:n.length,currentFolderId:f,filter:g,categoryFilter:T,sortType:M}),f===null?w=w.filter(k=>{if(k.isSharedTodo===!0)return!1;const F=l.find(U=>U.id===k.folderId);return F?F.isShared!==!0:!0}):f==="my-goals"?w=w.filter(k=>{const F=l.find(U=>U.id===k.folderId);return F?F.isShared!==!0:!0}):f==="all"?w=w:w=w.filter(k=>k.folderId===f),M==="deadline"?w.sort((k,F)=>!k.deadline&&!F.deadline?0:k.deadline?F.deadline?new Date(k.deadline).getTime()-new Date(F.deadline).getTime():-1:1):M==="newest"?w.sort((k,F)=>F.id-k.id):M==="alphabetical"&&w.sort((k,F)=>{const U=k.title||k.wish||"",H=F.title||F.wish||"";return U.localeCompare(H)}),g==="active"&&(w=w.filter(k=>!k.completed)),g==="completed"&&(w=w.filter(k=>k.completed)),T!=="all"&&(w=w.filter(k=>(k.category||"other")===T)),console.log("   :",{finalCount:w.length,todos:w.map(k=>({id:k.id,wish:k.wish,folderId:k.folderId,completed:k.completed}))}),w},[n,g,M,T,f]),ks=O.useCallback(()=>{const w=Date.now();ul(w),Po&&clearTimeout(Po);const k=setTimeout(async()=>{if(console.log("    -    (  "+Fn/1e3+")"),!No&&Y)try{console.log("   : activity-based "),await Ps()}catch(F){console.error("   :",F)}},Fn);Df(k)},[Po,Fn,No,Y]);O.useEffect(()=>{const w=l.find(F=>F.id===f),k=(w==null?void 0:w.isShared)&&(w==null?void 0:w.ownerId)&&(w==null?void 0:w.ownerId)!==(Y==null?void 0:Y.uid);tt(k||!1),k?(cl("realtime"),vi(!0),console.log("     ( )")):(cl("activity-based"),vi(!1),console.log("     ( )"))},[f,l,Y==null?void 0:Y.uid]);const dl=w=>{const k={...w,id:Date.now(),createdAt:new Date().toISOString()};s(F=>[...F,k]),vc(k)},vc=w=>{const k=new Date,F=new Date(w.dueDate),U=Math.max(1,Math.ceil((F.getTime()-k.getTime())/(1e3*60*60*24))),H=Math.ceil(w.estimatedMinutes/U),J=[];let W=w.estimatedMinutes;for(let X=0;X<U;X++){const j=new Date;j.setDate(k.getDate()+X);const Z=Math.min(H,W);if(J.push({assignmentId:w.id,date:j.toISOString().split("T")[0],allocatedMinutes:Z,completed:!1}),W-=Z,W<=0)break}a(X=>[...X,...J])},Br=async(w,k,F)=>{try{const U=Fr();if(!U)return console.warn("AI instance not available"),null;const H=`  :
: ${w}
: ${k}
: ${F||" "}

  JSON :
{
  "estimatedMinutes": (, ),
  "difficulty": (1-5, ),
  "optimizedSchedule": "   ",
  "studyTips": " "
}`;console.log(" AI  ...");const W=(await U.models.generateContent({model:"gemini-1.5-flash",contents:H})).text.trim();console.log(" AI  :",W);const X=W.match(/\{[\s\S]*\}/);return X?JSON.parse(X[0]):null}catch(U){return console.error("AI  :",U),null}},Lf=async w=>{try{const k=Fr();if(!k)return null;const U=`    :

${w.map(J=>`${J.name} (${J.subject}, ${J.estimatedMinutes}, ${J.difficulty}, : ${J.dueDate})`).join(`
`)}

     :
-  
-    
-   
-   

   .`;console.log("   AI ...");const H=await k.models.generateContent({model:"gemini-1.5-flash",contents:U});return console.log(" AI   :",H.text),H.text}catch(k){return console.error(" AI   :",k),null}},Ff=async()=>{Lt(!0);try{const w=await Lf(i);w&&ze(w)}catch(w){console.error("AI  :",w)}finally{Lt(!1)}},Tc=()=>{const w=new Date().toISOString().split("T")[0];return o.filter(k=>k.date===w).map(k=>{const F=i.find(U=>U.id===k.assignmentId);return F?{...k,assignment:F}:null}).filter(Boolean)},_r=(w,k)=>{a(F=>F.map(U=>U.assignmentId===w&&U.date===k?{...U,completed:!U.completed}:U))},Ec=async w=>{try{ks();const k={...w,id:Date.now(),completed:!1,lastCompletedDate:null,streak:0,folderId:f==="all"||f===null?void 0:f};if(r(F=>[k,...F]),Y){et(!0);try{const F=l.find(X=>X.id===f),U=(F==null?void 0:F.ownerId)||Y.uid,H=lt(ge,"users",U,"todos"),J=Le(H,k.id.toString()),W=Pt(k);W?(await yt(J,W),console.log("  Firestore :",{targetOwnerUid:U,newTodo:W})):console.warn("     ")}catch(F){console.error("  Firestore  :",F)}finally{et(!1)}}fe(!1)}catch(k){console.error("   :",k),et(!1)}},Do=async w=>{try{const k=w.map((F,U)=>({...F,id:Date.now()+U,completed:!1,lastCompletedDate:null,streak:0,folderId:f||void 0})).reverse();if(Y){et(!0);try{const F=l.find(H=>H.id===f),U=(F==null?void 0:F.ownerId)||Y.uid;for(const H of k){const J=lt(ge,"users",U,"todos"),W=Le(J,H.id.toString()),X=Pt(H);X?await yt(W,X):console.warn("     :",H.id)}console.log("   Firestore :",{targetOwnerUid:U,count:k.length})}catch(F){console.error("   Firestore  :",F)}finally{et(!1)}}r(F=>[...k,...F]),fe(!1)}catch(k){console.error("    :",k),et(!1)}},Ii=async w=>{try{if(ks(),Y){et(!0);try{const k=l.find(W=>W.id===w.folderId),F=(k==null?void 0:k.ownerId)||Y.uid,U=lt(ge,"users",F,"todos"),H=Le(U,w.id.toString()),J=Pt(w);J?(await yt(H,J),console.log("   Firestore :",{targetOwnerUid:F,updatedTodo:J})):console.warn("     ")}catch(k){console.error("   Firestore  :",k)}finally{et(!1)}}r(n.map(k=>k.id===w.id?w:k)),Pe(null)}catch(k){console.error("   :",k),et(!1)}},hl=async w=>{ks();const k=n.find(U=>U.id===w),F=n.filter(U=>U.id!==w);if(r(F),Y&&k)try{const U=l.find(X=>X.id===k.folderId),H=(U==null?void 0:U.ownerId)||Y.uid,J=lt(ge,"users",H,"todos"),W=Le(J,w.toString());await zt(W),console.log("   Firestore :",{targetOwnerUid:H,id:w});try{const X=Le(ge,"users",H,"data","todos");await yt(X,{todos:F,lastUpdated:new Date().toISOString()},{merge:!0}),console.log("     -  ")}catch(X){console.warn("    :",X)}_i&&setTimeout(()=>{Ps()},1e3)}catch(U){console.error("  Firestore  :",U),k&&r(H=>[...H,k])}},Ns=async w=>{var F;if(!w.trim()){ve({title:"Error",message:"Folder name cannot be empty."});return}const k={id:Date.now().toString(),name:w,ownerId:((F=zs.currentUser)==null?void 0:F.uid)||"unknown",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),color:"#3b82f6",collaborationSettings:{enabled:!1,showPresence:!0,showEditingState:!0,enableConflictDetection:!0,allowGuestView:!1,requireApproval:!0},isShared:!1};if(u([...l,k]),Y)try{const{doc:U,setDoc:H}=await Vs(async()=>{const{doc:W,setDoc:X}=await Promise.resolve().then(()=>Fs);return{doc:W,setDoc:X}},void 0),J=U(ge,"users",Y.uid,"folders",k.id);await H(J,{name:k.name,color:k.color,ownerId:k.ownerId,createdAt:k.createdAt,updatedAt:k.updatedAt,isShared:k.isShared,collaborators:[],collaborationSettings:k.collaborationSettings}),console.log("  Firebase  :",k.id)}catch(U){console.error("  Firebase  :",U)}return console.log("   :",{name:w,collaborationEnabled:!1}),k},Gr=O.useCallback(async(w,k)=>{try{if(u(F=>F.map(U=>{if(U.id===w){const H={...U.collaborationSettings,...k};return console.log("   :",{folderId:w,settings:H}),{...U,collaborationSettings:H,updatedAt:new Date().toISOString()}}return U})),Y){const F=Le(ge,"users",Y.uid,"folders",w);await pg(F,{collaborationSettings:{...k},updatedAt:new Date().toISOString()})}}catch(F){console.error("   :",F)}},[Y]),wc=O.useCallback(async(w,k)=>{await Gr(w,{enabled:k}),k?(u(F=>F.map(U=>U.id===w?{...U,isShared:!0}:U)),console.log("   :",w)):(D([]),b({}),console.log("   :",w))},[Gr]);O.useCallback(()=>{if(!f)return null;const w=l.find(k=>k.id===f);return(w==null?void 0:w.collaborationSettings)||null},[f,l]);const fl=(w,k)=>{if(!k.trim()){ve({title:"Error",message:"Folder name cannot be empty."});return}u(l.map(F=>F.id===w?{...F,name:k,updatedAt:new Date().toISOString()}:F))},it=async w=>{const k=l.find(U=>U.id===w);if(!k)return;const F=n.filter(U=>U.folderId===w);if(Y&&F.length>0)try{for(const U of F){const H={...U};delete H.folderId;const J=k.ownerId||Y.uid,W=lt(ge,"users",J,"todos"),X=Le(W,U.id.toString()),j=Pt(H);j?(await yt(X,j),console.log(`  ${U.id} Firebase   `)):console.warn(`  ${U.id}   `)}console.log("     Firebase  :",{count:F.length})}catch(U){console.error("      :",U)}if(Y)try{const U=Le(ge,"users",Y.uid,"folders",w);await zt(U),console.log("  Firebase  :",w)}catch(U){console.error("  Firebase  :",U)}r(n.map(U=>{if(U.folderId===w){const H={...U};return delete H.folderId,H}return U})),u(l.filter(U=>U.id!==w)),f===w&&m(null)},Ic=async w=>{if(!Rt.trim()||!Y){ue("");return}try{const k={...w,name:Rt.trim(),updatedAt:new Date().toISOString()},F=Le(ge,"users",Y.uid,"folders",w.id),U=Pt(k);if(U)await yt(F,U),console.log("    Firestore  ");else throw new Error("   ");u(l.map(H=>H.id===w.id?k:H)),ue(""),console.log("    :",Rt.trim())}catch(k){console.error("    :",k),ue("")}},Uf=async w=>{var k;if(!(!rt.trim()||!Y||Ne)){We(!0);try{if(((k=w.sharedWith)==null?void 0:k.some(X=>X.email===rt.trim()))||w.ownerEmail===rt.trim()){alert("  ."),We(!1);return}const U={email:rt.trim(),userId:"",role:pr,addedAt:new Date().toISOString()},H={...w,sharedWith:[...w.sharedWith||[],U],updatedAt:new Date().toISOString()},J=Le(ge,"users",Y.uid,"folders",w.id),W=Pt(H);if(W)await yt(J,W),console.log("   Firestore  ");else throw new Error("   ");u(l.map(X=>X.id===w.id?{...H,sharedWith:Array.isArray(H.sharedWith)?H.sharedWith.filter(j=>j&&typeof j.role=="string"&&["owner","editor","viewer"].includes(j.role)).map(j=>({...j,role:j.role})):[]}:X)),fr(""),console.log("   :",U)}catch(F){console.error("   :",F)}finally{We(!1)}}},Sc=async(w,k,F)=>{var U;if(Y)try{const H={...w,sharedWith:(U=w.sharedWith)==null?void 0:U.map(X=>X.userId===k?{...X,role:F}:X),updatedAt:new Date().toISOString()},J=Le(ge,"users",Y.uid,"folders",w.id),W=Pt(H);if(W)await yt(J,W);else throw new Error("   ");u(l.map(X=>X.id===w.id?{...H,sharedWith:Array.isArray(H.sharedWith)?H.sharedWith.filter(j=>j&&typeof j.role=="string"&&["owner","editor","viewer"].includes(j.role)).map(j=>({...j,role:j.role})):[]}:X)),console.log("    :",{userId:k,newRole:F})}catch(H){console.error("    :",H)}},Cc=async(w,k)=>{var F;if(Y&&confirm("  ?"))try{const U={...w,sharedWith:(F=w.sharedWith)==null?void 0:F.filter(W=>W.userId!==k),updatedAt:new Date().toISOString()},H=Le(ge,"users",Y.uid,"folders",w.id),J=Pt(U);if(J)await yt(H,J);else throw new Error("   ");u(l.map(W=>W.id===w.id?U:W)),console.log("   :",k)}catch(U){console.error("   :",U)}},xc=w=>{const k=`${window.location.origin}${window.location.pathname}?invite=${w.id}`;navigator.clipboard.writeText(k).then(()=>{alert("  !")}).catch(()=>{alert("  .")})},Mo=w=>{confirm(re("folder_leave_confirm"))&&yr(w)},yr=async w=>{var k;if(Y)try{const F={...w,sharedWith:(k=w.sharedWith)==null?void 0:k.filter(J=>J.userId!==Y.uid),updatedAt:new Date().toISOString()},U=Le(ge,"users",w.ownerId,"folders",w.id),H=Pt(F);if(H)await yt(U,H);else throw new Error("   ");u(l.filter(J=>J.id!==w.id)),f===w.id&&m(null),Gt(!1),console.log("   ")}catch(F){console.error("   :",F)}},Ac=w=>{confirm(re("folder_delete_confirm"))&&(it(w.id),Gt(!1))},Of=w=>{if(m(w),w&&Y){const k=l.find(F=>F.id===w);k!=null&&k.ownerId&&(async()=>{try{console.log(" Firestore   :",{folderId:w,ownerUid:k.ownerId});const F=lt(ge,"users",k.ownerId,"todos"),U=Ol(F,Bl("folderId","==",w)),H=await Pi(U),J=[];H.forEach(W=>{J.push({id:parseInt(W.id),...W.data()})}),console.log("    :",{count:J.length,todos:J}),r(W=>{const X=W.filter(pe=>pe.folderId!==w),j=new Set(X.map(pe=>pe.id)),Z=J.filter(pe=>!j.has(pe.id)),K=[...X,...Z];return console.log("   :",{:X.length,:Z.length,:K.length,:J.length-Z.length}),K})}catch(F){console.error("    :",F)}})()}},bs=async()=>{if(!f||!Y){Ce("   ");return}et(!0);try{console.log("    ...",f);const{doc:w,getDoc:k,collection:F,query:U,where:H,getDocs:J}=await Vs(async()=>{const{doc:_,getDoc:y,collection:C,query:q,where:$,getDocs:ie}=await Promise.resolve().then(()=>Fs);return{doc:_,getDoc:y,collection:C,query:q,where:$,getDocs:ie}},void 0);let W=l.find(_=>_.id===f);if(!W||!W.collaborators||W.collaborators.length===0){console.log("    , Firebase ...");const _=w(ge,"users",Y.uid,"folders",f),y=await k(_);if(y.exists())W={id:f,...y.data()},console.log("   :",W);else{console.log("    ..."),ve({title:"    ",message:`   .
    .`,confirmText:"",onConfirm:()=>ve(null)}),et(!1);return}}if(!W||!W.collaborators||W.collaborators.length===0){ve({title:"   ",message:`   .
   .`,confirmText:"",onConfirm:()=>ve(null)}),et(!1);return}const X=W.collaborators.find(_=>_.role==="owner");if(!X||!X.userId){ve({title:"   ",message:`   .
  .`,confirmText:"",onConfirm:()=>ve(null)}),et(!1);return}if(X.userId.startsWith("owner_")){console.warn("   ID :",X.userId),ve({title:"   ",message:`    .
     .`,confirmText:"",onConfirm:()=>ve(null)}),et(!1);return}console.log("   :",{folderId:f,ownerUid:X.userId});const j=n.filter(_=>_.folderId===f);console.log("    :",j.length);const Z=F(ge,"users",X.userId,"todos"),K=U(Z,H("folderId","==",f)),pe=await J(K),ae=[];pe.forEach(_=>{ae.push({id:parseInt(_.id),..._.data()})}),console.log("   :",ae.length),j.length===ae.length?(console.log("     "),Ce(`    (${ae.length}  -   )`)):(console.log("     :",{local:j.length,server:ae.length}),r(_=>[..._.filter(q=>q.folderId!==f),...ae]),Ce(`   (${ae.length}  - ${Math.abs(ae.length-j.length)}  )`)),console.log("   :",f&&Y?"":"")}catch(w){console.error("  :",w),w instanceof Error?w.message.includes("permission-denied")?Ce("  :    "):w.message.includes("not-found")?Ce("  :    "):Ce("  : "+w.message):Ce("  :    ")}finally{et(!1)}},Rc=async()=>{et(!0);try{console.log("   ..."),await Ps(),Ce("   "),console.log("   ")}catch(w){console.error("   :",w),Ce("  ")}finally{et(!1)}},pl=async(w,k)=>{const F=n.find(W=>W.id===w);if(!F)return;const U=l.find(W=>W.id===k),H=(U==null?void 0:U.isShared)===!0,J={...F,folderId:k||void 0,isSharedTodo:H};if(!F.wish&&!F.outcome&&!F.obstacle&&!F.plan&&(delete J.wish,delete J.outcome,delete J.obstacle,delete J.plan),Y)try{const W=l.find(pe=>pe.id===(k||F.folderId)),X=(W==null?void 0:W.ownerId)||Y.uid,j=lt(ge,"users",X,"todos"),Z=Le(j,w.toString()),K=Pt(J);K?(await yt(Z,K),console.log("    Firestore :",{targetOwnerUid:X,goalId:w,folderId:k,isSharedTodo:J.isSharedTodo})):console.warn("     ")}catch(W){console.error("    Firestore  :",W)}r(n.map(W=>W.id===w?J:W)),Ce("   "),setTimeout(()=>Ce(""),3e3)},Ds=async w=>{ks();const k=new Date().toISOString(),F=(()=>{const U=n.find(W=>W.id===w);if(!U)return null;const H=!U.completed;let J=U.streak;return U.isRecurring&&(H?(!U.lastCompletedDate||!lu(k,U.lastCompletedDate))&&(J=(U.streak||0)+1):U.lastCompletedDate&&lu(k,U.lastCompletedDate)&&(J=Math.max(0,(U.streak||1)-1))),{...U,completed:H,lastCompletedDate:H?k:U.lastCompletedDate,streak:J}})();if(F){if(Y)try{const U=l.find(j=>j.id===F.folderId),H=(U==null?void 0:U.ownerId)||Y.uid,J=lt(ge,"users",H,"todos"),W=Le(J,w.toString()),X=Pt(F);X?(await yt(W,X),console.log("    Firestore :",{targetOwnerUid:H,id:w,completed:F.completed})):console.warn("     ")}catch(U){console.error("    Firestore  :",U)}r(n.map(U=>U.id===w?F:U))}},Pc=async w=>{if(w==="ai"){if(n.length<2){ve({title:re("sort_alert_title"),message:re("sort_alert_message")});return}mr(!0);try{const k=Fr();if(!k){Ce(gi?"  AI    .":"AI    API  ."),mr(!1),x("manual");return}const F=`Here is a list of goals with their details (wish, outcome, obstacle, plan, deadline). Prioritize them based on urgency (closer deadline), importance (based on outcome), and feasibility (based on plan). Return a JSON object with "sorted_ids" array and "reasoning" string explaining your prioritization logic. Goals: ${JSON.stringify(n.map(({id:K,wish:pe,outcome:ae,obstacle:c,plan:_,deadline:y})=>({id:K,wish:pe,outcome:ae,obstacle:c,plan:_,deadline:y})))}`,U=await k.models.generateContent({model:"gemini-1.5-flash",contents:F,config:{responseMimeType:"application/json",responseSchema:{type:Gn.OBJECT,properties:{sorted_ids:{type:Gn.ARRAY,items:{type:Gn.NUMBER}},reasoning:{type:Gn.STRING}}}}}),H=JSON.parse(U.text),J=H.sorted_ids.map(Number),W=new Map(n.map(K=>[Number(K.id),K])),X=J.map(K=>W.get(K)).filter(Boolean),j=n.filter(K=>!J.includes(Number(K.id))),Z=[...X,...j].map(K=>({...K,id:Number(K.id)}));r(Z),x("manual"),hc(H.reasoning||""),Vr(!0)}catch(k){console.error("AI sort failed:",k),ve({title:re("ai_sort_error_title"),message:re("ai_sort_error_message")})}finally{mr(!1)}}else x(w)},Vo=w=>{const k=new Set(wn);k.has(w)?k.delete(w):k.add(w),Vn(k)},kc=()=>{hi(!1),Vn(new Set)},Nc=()=>{const w=new Set(wi.map(k=>k.id));Vn(w)},Ms=()=>{const w=wn.size;ve({title:re("delete_selected_confirm_title"),message:re("delete_selected_confirm_message").replace("{count}",String(w)),isDestructive:!0,confirmText:re("delete_selected_button_label").replace("{count}",String(w)),cancelText:re("cancel_button"),onConfirm:()=>{r(n.filter(k=>!wn.has(k.id))),kc()}})},bc=()=>{St("exporting");const w=JSON.stringify(n,null,2),k="data:application/json;charset=utf-8,"+encodeURIComponent(w),F="nova_goals.json",U=document.createElement("a");U.setAttribute("href",k),U.setAttribute("download",F),U.click(),setTimeout(()=>{St("idle"),En(!1)},1500)},Dc=w=>{var U;const k=(U=w.target.files)==null?void 0:U[0];if(!k)return;const F=new FileReader;F.onload=H=>{var J;try{const W=(J=H.target)==null?void 0:J.result;if(typeof W!="string")throw new Error("File content is not a string");const X=JSON.parse(W);if(Array.isArray(X)&&X.every(j=>"wish"in j&&"id"in j))ve({title:re("import_confirm_title"),message:re("import_confirm_message"),confirmText:re("settings_import_data"),cancelText:re("cancel_button"),onConfirm:()=>{St("importing"),setTimeout(()=>{r(X),Ce(re("import_success_toast")),St("idle"),En(!1)},1500)}});else throw new Error("Invalid file format")}catch{ve({title:re("import_error_alert_title"),message:re("import_error_alert_message")})}},F.onerror=()=>ve({title:re("import_error_alert_title"),message:re("import_error_alert_message")}),F.readAsText(k),w.target.value=""},ml=()=>{ve({title:"   ",message:`   ?

    :

   
 Firebase  
  
   
   `,confirmText:"",cancelText:"",isDestructive:!0,onConfirm:()=>{ve(null),gl()},onCancel:()=>{ve(null)}})},gl=async()=>{console.log(" performDeleteAllData  "),St("deleting");try{if(Y){console.log("  :",{uid:Y.uid,email:Y.email}),console.log(" Firebase   ...");try{const j=Le(ge,"users",Y.uid,"data","todos");await zt(j),console.log("  todos   ")}catch(j){console.warn("  todos   :",j)}try{const j=Le(ge,"users",Y.uid,"data","settings");await zt(j),console.log("  settings   ")}catch(j){console.warn("  settings   :",j)}const w=lt(ge,"users",Y.uid,"todos"),k=await Pi(w);console.log("  todos :",k.size);const F=k.docs.map(j=>zt(j.ref));await Promise.all(F),console.log("  todos  :",k.size,"");const U=lt(ge,"users",Y.uid,"folders"),H=await Pi(U);console.log("  folders :",H.size);const J=H.docs.map(j=>zt(j.ref));await Promise.all(J),console.log(" folders  :",H.size,"");const W=lt(ge,"sharedFolders"),X=await Pi(W);for(const j of X.docs){const Z=j.data();if(Z.collaborators&&Array.isArray(Z.collaborators)){const K=Z.collaborators.filter(pe=>pe.userId!==Y.uid);K.length!==Z.collaborators.length&&(await pg(j.ref,{collaborators:K}),console.log("     :",j.id))}}try{for(const j of l)if(j.id){const Z=Le(ge,"folderPresence",j.id,"users",Y.uid);await zt(Z)}console.log(" presence   ")}catch(j){console.warn(" presence     :",j)}try{const j=Ol(lt(ge,"folderEditing"),Bl("userId","==",Y.uid)),K=(await Pi(j)).docs.map(pe=>zt(pe.ref));await Promise.all(K),console.log(" editing states  ")}catch(j){console.warn(" editing states    :",j)}try{const j=Le(ge,"users",Y.uid);await zt(j),console.log("     ")}catch(j){console.warn("     :",j)}try{const j=lt(ge,"notifications",Y.uid,"items"),K=(await Pi(j)).docs.map(ae=>zt(ae.ref));await Promise.all(K);const pe=Le(ge,"notifications",Y.uid);await zt(pe),console.log("    ")}catch(j){console.warn("      :",j)}try{const j=lt(ge,"userActivity",Y.uid,"logs"),K=(await Pi(j)).docs.map(ae=>zt(ae.ref));await Promise.all(K);const pe=Le(ge,"userActivity",Y.uid);await zt(pe),console.log("     ")}catch(j){console.warn("       :",j)}try{const j=Le(ge,"userMetadata",Y.uid);await zt(j),console.log("    ")}catch(j){console.warn("      :",j)}try{const j=Le(ge,"userSessions",Y.uid);await zt(j),console.log("     ")}catch(j){console.warn("       :",j)}console.log("      -    ")}console.log("    ..."),r([]),u([]),D([]),b({}),Ze([]),m(null),Vn(new Set),hi(!1),v("all"),P("all"),console.log("   ..."),e("ko"),B(!0),R("default"),x("manual"),A(["school","work","personal","other"]),gr(""),al(!1),yi(!0),console.log(" localStorage  ...");try{const w=Object.keys(localStorage);console.log("  localStorage :",w),w.forEach(k=>{localStorage.removeItem(k),console.log(`  : ${k}`)}),localStorage.clear(),sessionStorage.clear(),console.log(" localStorage  sessionStorage   ")}catch(w){console.error(" localStorage   :",w)}if(Y){console.log(" Firebase  ...");try{await _E(zs),console.log(" Firebase  ")}catch(w){console.warn("   :",w)}}console.log("   ..."),Is(null),Ao(!1),Ss(!1),et(!1),xs(!1),console.log("    "),Ce("    .    ."),En(!1),setTimeout(()=>{console.log("    ..."),window.location.reload()},2500)}catch(w){console.error("    :",w);let k="  ",F="    .";w instanceof Error&&(w.message.includes("permission-denied")||w.message.includes("insufficient permissions")?(k="  ",F=`  .

   .
(Firebase      )`):w.message.includes("network-request-failed")?(k="  ",F="    ."):w.message.includes("unauthenticated")?(k="  ",F=` .
 .`):F=`    .

 : `+w.message),ve({title:k,message:F,confirmText:"",onConfirm:()=>ve(null)}),St("idle")}},Lo=ee||!!me||!!$e||Mr||!!_t||Ts||fi;return O.useEffect(()=>{if(Rp()&&Lo)return document.body.classList.add("modal-open"),()=>{document.body.classList.remove("modal-open")};document.body.classList.remove("modal-open")},[Lo]),p.jsxs("div",{className:`main-page-layout ${Qn?"calendar-view-active":""}`,children:[p.jsxs("div",{className:`page-content ${Lo?"modal-open":""}`,children:[p.jsx(k6,{folders:l,currentFolderId:f,onSetCurrentFolder:Of,onCreateFolder:Ns,onRenameFolder:fl,onDeleteFolder:it,onSetCollaboratingFolder:ol,todos:n,t:re,onManageFolder:w=>{Kn(w),Gt(!0)},currentUserId:Y==null?void 0:Y.uid}),p.jsxs("div",{className:"content-with-sidebar",children:[p.jsx(b6,{t:re,isSelectionMode:xo,selectedCount:wn.size,totalVisibleCount:wi.length,onCancelSelection:kc,onDeleteSelected:Ms,onSelectAll:Nc,onSetSelectionMode:()=>hi(!0),isViewModeCalendar:Qn,onToggleViewMode:()=>vs(!Qn),isAiSorting:Et,sortType:M,onSort:Pc,filter:g,onFilter:v,onOpenSettings:()=>En(!0),onAddGoal:()=>fe(!0),currentFolderId:f,folders:l,onSyncSharedFolder:bs,isSyncing:Cs,isSyncingData:Cs,onManualSync:Rc,activeUsers:N,onToggleCollaboration:wc,onUpdateCollaborationSettings:Gr,categoryFilter:T,onCategoryFilter:P,userCategories:E,onAddCategory:w=>A([...E,w]),onRemoveCategory:w=>A(E.filter(k=>k!==w))}),p.jsxs("div",{className:"container",children:[p.jsx(N6,{t:re,categoryFilter:T,onCategoryFilter:P,userCategories:E,onAddCategory:w=>A([...E,w]),onRemoveCategory:w=>A(E.filter(k=>k!==w))}),Qn?p.jsx(q6,{todos:n,t:re,onGoalClick:fn,language:t}):p.jsxs(p.Fragment,{children:[Tc().length>0&&p.jsxs("div",{className:"today-assignments",style:{marginBottom:"24px",padding:"20px",backgroundColor:"var(--bg-secondary-color)",borderRadius:"16px",border:"1px solid var(--border-color)"},children:[p.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[p.jsxs("h3",{style:{margin:0,fontSize:"1.2rem",fontWeight:"600"},children:[" ",re("today_schedule")]}),i.length>0&&p.jsx("button",{onClick:Ff,disabled:Fe,style:{padding:"6px 12px",borderRadius:"6px",border:"1px solid var(--primary-color)",backgroundColor:"transparent",color:"var(--primary-color)",cursor:Fe?"not-allowed":"pointer",fontSize:"0.8rem",fontWeight:"500",opacity:Fe?.6:1},children:Fe?" ...":" "+re("ai_optimize_schedule")})]}),p.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:Tc().map(w=>p.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",padding:"12px 16px",backgroundColor:"var(--card-bg-color, rgba(255, 255, 255, 0.05))",borderRadius:"12px",border:"1px solid var(--border-color)",opacity:w.completed?.6:1},children:[p.jsxs("label",{className:"checkbox-container",children:[p.jsx("input",{type:"checkbox",checked:w.completed,onChange:()=>_r(w.assignmentId,w.date)}),p.jsx("span",{className:"checkmark"})]}),p.jsxs("div",{style:{flex:1},children:[p.jsxs("div",{style:{fontWeight:"500",textDecoration:w.completed?"line-through":"none"},children:[w.assignment.name," (",w.assignment.subject,")"]}),p.jsxs("div",{style:{fontSize:"0.85rem",color:"var(--text-secondary-color)",marginTop:"4px"},children:[re("auto_allocated"),": ",w.allocatedMinutes,re("minutes"),"  ",re("difficulty_level"),w.assignment.difficulty]})]}),p.jsxs("div",{style:{fontSize:"0.8rem",color:"var(--text-secondary-color)"},children:[Math.ceil((new Date(w.assignment.dueDate).getTime()-new Date().getTime())/(1e3*60*60*24)),re("days_left")]})]},`${w.assignmentId}-${w.date}`))}),ke&&p.jsxs("div",{style:{marginTop:"16px",padding:"16px",backgroundColor:"var(--card-bg-color, rgba(255, 255, 255, 0.05))",borderRadius:"12px",border:"1px solid var(--border-color)"},children:[p.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"},children:[p.jsx("h4",{style:{margin:0,fontSize:"1rem",fontWeight:"600"},children:" AI   "}),p.jsx("button",{onClick:()=>ze(""),style:{background:"none",border:"none",color:"var(--text-secondary-color)",cursor:"pointer",fontSize:"1.2rem"},children:""})]}),p.jsx("div",{style:{fontSize:"0.9rem",lineHeight:1.6,whiteSpace:"pre-wrap"},children:ke})]})]}),p.jsxs("div",{className:"goals-split-layout",children:[p.jsx("div",{className:"woop-section",children:p.jsx(x6,{todos:wi,onEditTodo:Pe,t:re})}),p.jsxs("div",{className:"todos-section",children:[wi.length>0&&p.jsx("div",{className:"section-title",style:{fontSize:"18px",fontWeight:"600",marginBottom:"16px",color:"var(--text-color)",borderBottom:"2px solid var(--primary-color)",paddingBottom:"8px",display:"inline-block",position:"relative"},children:""}),p.jsx(D6,{todos:wi,onToggleComplete:Ds,onDelete:hl,onEdit:Pe,onInfo:fn,t:re,filter:g,randomEncouragement:Or,isSelectionMode:xo,selectedTodoIds:wn,onSelectTodo:Vo,folders:l,onMoveToFolder:pl})]})]})]})]})]}),Rp()&&!Qn&&p.jsx("button",{onClick:()=>fe(!0),className:"mobile-fab-button","aria-label":re("add_new_goal_button_label"),title:re("add_new_goal_button_label"),children:xe.add})]}),ee&&p.jsx(kp,{onClose:()=>fe(!1),onAddTodo:Ec,onAddMultipleTodos:Do,onAddAssignment:dl,analyzeAssignmentWithAI:Br,t:re,language:t,createAI:Fr,userCategories:E}),me&&mg(me)&&p.jsx(kp,{onClose:()=>Pe(null),onEditTodo:Ii,existingTodo:me,t:re,language:t,createAI:Fr}),me&&!mg(me)&&p.jsx(z6,{todo:me,onClose:()=>Pe(null),onSave:Ii,t:re}),$e&&p.jsx(F6,{todo:$e,onClose:()=>fn(null),t:re,createAI:Fr,onDeleteGoal:w=>{fn(null),hl(w)},userCategories:E,onUpdateGoal:Ii,onToggleComplete:w=>{fn(null),Ds(w)}}),Oe&&p.jsx(kp,{onClose:()=>Vt(!1),onAddTodo:Ec,onAddMultipleTodos:Do,onAddAssignment:dl,analyzeAssignmentWithAI:Br,t:re,language:t,createAI:Fr,userCategories:E,initialMode:"assignment"}),ws!==void 0&&p.jsx(U6,{folder:ws,onClose:()=>ol(void 0),t:re,googleUser:Y,onUpdateCollaborators:As,setAlertConfig:ve}),Mr&&p.jsx(O6,{onClose:()=>En(!1),isDarkMode:V,onToggleDarkMode:()=>B(!V),themeMode:G,onThemeChange:Vf,backgroundTheme:S,onSetBackgroundTheme:R,onExportData:bc,onImportData:Dc,setAlertConfig:ve,onDeleteAllData:ml,dataActionStatus:ce,language:t,onSetLanguage:e,t:re,todos:n,setToastMessage:Ce,onOpenVersionInfo:()=>il(!0),onOpenUsageGuide:()=>sl(!0),apiKey:mi,onSetApiKey:gr,isOfflineMode:gi,onToggleOfflineMode:()=>al(!gi),googleUser:Y,onGoogleLogin:Ti,onGoogleLogout:Rs,onSyncDataToFirebase:Ps,onLoadDataFromFirebase:Mf,isGoogleLoggingIn:gc,isGoogleLoggingOut:Ro,isSyncingData:Cs,isLoadingData:Lr,isAutoSyncEnabled:_i,setIsAutoSyncEnabled:yi,notificationPermission:Rf,setNotificationPermission:Yn}),Ts&&p.jsx(B6,{onClose:()=>il(!1),t:re}),fi&&p.jsx(G6,{onClose:()=>sl(!1),t:re}),Es&&p.jsx(ys,{onClose:()=>Vr(!1),isClosing:!1,className:"ai-sort-reason-modal",children:p.jsxs("div",{style:{padding:"24px"},children:[p.jsx("h2",{style:{marginBottom:"16px",fontSize:"1.3rem",fontWeight:600},children:re("ai_sort_reason_modal_title")}),p.jsx("div",{style:{marginBottom:"24px",padding:"16px",backgroundColor:"var(--card-bg-color)",borderRadius:"8px",border:"1px solid var(--border-color)",lineHeight:"1.6",color:"var(--text-secondary-color)"},children:qt}),p.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:p.jsx("button",{onClick:()=>Vr(!1),className:"primary",children:re("close_button")})})]})}),_t&&p.jsx($6,{title:_t.title,message:_t.message,onConfirm:()=>{var w;(w=_t.onConfirm)==null||w.call(_t),ve(null)},onCancel:_t.onCancel?()=>{var w;(w=_t.onCancel)==null||w.call(_t),ve(null)}:void 0,confirmText:_t.confirmText,cancelText:_t.cancelText,isDestructive:_t.isDestructive,t:re}),Ln&&p.jsx("div",{className:"toast-notification",children:Ln}),pi&&p.jsx(C6,{onClose:()=>fc(!1)}),Bt&&Tn&&p.jsx("div",{className:"modal-backdrop",onClick:()=>Gt(!1),children:p.jsxs("div",{className:"modal-content large-modal",onClick:w=>w.stopPropagation(),children:[p.jsxs("div",{className:"modal-header",children:[p.jsx("h3",{children:re("folder_manage_title")}),p.jsx("button",{onClick:()=>Gt(!1),children:""})]}),p.jsx("div",{className:"modal-body",children:(()=>{var U,H,J;const w=l.find(W=>W.id===Tn);if(!w)return null;const k=w.ownerId===(Y==null?void 0:Y.uid),F=k?"owner":((H=(U=w.sharedWith)==null?void 0:U.find(W=>W.userId===(Y==null?void 0:Y.uid)))==null?void 0:H.role)||"viewer";return p.jsxs("div",{className:"folder-manage-content",children:[p.jsxs("div",{className:"folder-info-section",children:[p.jsx("h4",{children:re("folder_manage_info")}),p.jsxs("div",{className:"folder-info-item",children:[p.jsxs("label",{children:[re("folder_name"),":"]}),Rt?p.jsxs("div",{className:"inline-edit",children:[p.jsx("input",{type:"text",value:Rt,onChange:W=>ue(W.target.value),onKeyPress:W=>{W.key==="Enter"&&Ic(w)}}),p.jsx("button",{onClick:()=>Ic(w),children:""}),p.jsx("button",{onClick:()=>ue(""),children:""})]}):p.jsxs("div",{className:"folder-name-display",children:[p.jsx("span",{children:w.name}),k&&p.jsx("button",{className:"edit-btn",onClick:()=>ue(w.name),children:""})]})]}),p.jsxs("div",{className:"folder-info-item",children:[p.jsxs("label",{children:[re("folder_owner"),":"]}),p.jsx("span",{children:w.ownerEmail||w.ownerId})]}),p.jsxs("div",{className:"folder-info-item",children:[p.jsxs("label",{children:[re("role"),":"]}),p.jsx("span",{children:re(F==="owner"?"folder_role_owner":F==="editor"?"folder_role_editor":"folder_role_viewer")})]}),p.jsxs("div",{className:"folder-info-item",children:[p.jsxs("label",{children:[re("created_date"),":"]}),p.jsx("span",{children:new Date(w.createdAt).toLocaleDateString()})]})]}),p.jsxs("div",{className:"collaborators-section",children:[p.jsx("h4",{children:re("folder_manage_collaborators")}),p.jsxs("div",{className:"collaborator-list",children:[p.jsx("div",{className:"collaborator-item owner",children:p.jsxs("div",{className:"collaborator-info",children:[p.jsx("span",{className:"email",children:w.ownerEmail||w.ownerId}),p.jsx("span",{className:"role owner-role",children:re("folder_role_owner")})]})}),((J=w.sharedWith)==null?void 0:J.map((W,X)=>p.jsxs("div",{className:"collaborator-item",children:[p.jsxs("div",{className:"collaborator-info",children:[p.jsx("span",{className:"email",children:W.email||W.userId}),p.jsx("span",{className:`role ${W.role}`,children:W.role==="editor"?re("folder_role_editor"):re("folder_role_viewer")})]}),k&&p.jsxs("div",{className:"collaborator-actions",children:[p.jsxs("select",{value:W.role,onChange:j=>Sc(w,W.userId,j.target.value),children:[p.jsx("option",{value:"editor",children:re("folder_role_editor")}),p.jsx("option",{value:"viewer",children:re("folder_role_viewer")})]}),p.jsx("button",{className:"remove-btn",onClick:()=>Cc(w,W.userId),children:""})]})]},X)))||[]]}),(k||F==="editor")&&p.jsxs("div",{className:"invite-section",children:[p.jsx("h5",{children:re("folder_invite_new")}),p.jsxs("div",{className:"invite-form",children:[p.jsx("input",{type:"email",placeholder:re("folder_invite_email"),value:rt,onChange:W=>fr(W.target.value)}),p.jsxs("select",{value:pr,onChange:W=>Jn(W.target.value),children:[p.jsx("option",{value:"editor",children:re("folder_role_editor")}),p.jsx("option",{value:"viewer",children:re("folder_role_viewer")})]}),p.jsx("button",{onClick:()=>Uf(w),disabled:!rt||Ne,children:Ne?" ...":re("folder_invite_button")})]})]})]}),p.jsxs("div",{className:"folder-settings-section",children:[p.jsx("h4",{children:re("folder_manage_settings")}),p.jsxs("div",{className:"share-link-section",children:[p.jsx("label",{children:re("folder_share_link")}),p.jsx("p",{className:"share-link-desc",children:re("folder_share_link_desc")}),p.jsxs("div",{className:"share-link-input",children:[p.jsx("input",{type:"text",readOnly:!0,value:`${window.location.origin}${window.location.pathname}?invite=${w.id}`}),p.jsx("button",{onClick:()=>xc(w),children:re("folder_copy_link")})]})]}),p.jsxs("div",{className:"folder-actions",children:[!k&&p.jsx("button",{className:"leave-folder-btn",onClick:()=>Mo(w),children:re("folder_leave")}),k&&p.jsx("button",{className:"delete-folder-btn",onClick:()=>Ac(w),children:re("folder_delete")})]})]})]})})()})]})})]})},k6=({folders:t,currentFolderId:e,onSetCurrentFolder:n,onCreateFolder:r,onRenameFolder:i,onDeleteFolder:s,onSetCollaboratingFolder:o,todos:a,t:l,onManageFolder:u,currentUserId:f})=>{var G;const[m,g]=O.useState(!1),[v,T]=O.useState(""),[P,M]=O.useState(null),[x,E]=O.useState(""),[A,V]=O.useState(null),B=()=>{v.trim()&&(r(v),T(""),g(!1))};return p.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid var(--border-color)",overflowX:"auto",display:"flex",gap:"8px",alignItems:"center",backgroundColor:"var(--card-bg-color)"},children:[p.jsxs("button",{onClick:()=>n("my-goals"),style:{padding:"6px 12px",borderRadius:"8px",border:"none",backgroundColor:e==="my-goals"?"var(--primary-color)":"transparent",color:e==="my-goals"?"white":"var(--text-color)",cursor:"pointer",fontSize:"0.9rem",fontWeight:500,whiteSpace:"nowrap",transition:"all 0.2s",minWidth:"80px",textAlign:"center"},children:[" ",l("all_goals_label")||"All"]}),p.jsx("button",{onClick:()=>n("all"),style:{padding:"6px 12px",borderRadius:"8px",border:"none",backgroundColor:e==="all"?"#ff6b6b":"transparent",color:e==="all"?"white":"var(--text-color)",cursor:"pointer",fontSize:"0.9rem",fontWeight:500,whiteSpace:"nowrap",transition:"all 0.2s",minWidth:"80px",textAlign:"center"},children:l("all_goals_button")}),t.length>0&&t.filter(I=>e===null?!I.isShared||I.isShared&&I.ownerId===f:!0).map(I=>{const S=a.filter(R=>R.folderId===I.id).length;return p.jsxs("div",{style:{position:"relative",display:"inline-flex",alignItems:"center",gap:"2px"},children:[p.jsxs("button",{onClick:()=>n(I.id),style:{padding:"6px 12px",borderRadius:"8px",border:"none",backgroundColor:e===I.id?I.color||"var(--primary-color)":`${I.color}20`||"transparent",color:e===I.id?"white":"var(--text-color)",cursor:"pointer",fontSize:"0.9rem",fontWeight:500,whiteSpace:"nowrap",transition:"all 0.2s",position:"relative"},title:I.isShared?" ":" ",children:[I.isShared?"":""," ",I.name," (",S,")"]}),e===I.id&&p.jsxs("div",{style:{display:"flex",gap:"2px"},children:[p.jsx("button",{onClick:()=>o(I),style:{width:"24px",height:"24px",padding:"0",borderRadius:"4px",border:"none",backgroundColor:"var(--primary-color)",color:"white",cursor:"pointer",fontSize:"0.8rem",lineHeight:"1",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s"},title:" ",children:""}),p.jsx("button",{onClick:()=>u(I.id),style:{width:"24px",height:"24px",padding:"0",borderRadius:"4px",border:"none",backgroundColor:"var(--button-bg-color)",color:"var(--text-color)",cursor:"pointer",fontSize:"0.8rem",lineHeight:"1",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s"},title:" ",children:""}),p.jsx("button",{onClick:()=>{M(I.id),E(I.name)},style:{width:"24px",height:"24px",padding:"0",borderRadius:"4px",border:"none",backgroundColor:"var(--button-bg-color)",color:"var(--text-color)",cursor:"pointer",fontSize:"0.8rem",lineHeight:"1",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s"},title:"  ",children:""}),p.jsx("button",{onClick:()=>{V(I.id)},style:{width:"24px",height:"24px",padding:"0",borderRadius:"4px",border:"none",backgroundColor:"var(--danger-color)",color:"white",cursor:"pointer",fontSize:"0.8rem",lineHeight:"1",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s"},title:" ",children:""})]})]},I.id)}),m?p.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[p.jsx("input",{type:"text",value:v,onChange:I=>T(I.target.value),onKeyPress:I=>{I.key==="Enter"&&B(),I.key==="Escape"&&(g(!1),T(""))},placeholder:" ...",autoFocus:!0,style:{padding:"6px 12px",borderRadius:"8px",border:"2px solid var(--primary-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontSize:"0.9rem",outline:"none",width:"120px"}}),p.jsx("button",{onClick:B,style:{padding:"4px 12px",borderRadius:"8px",border:"none",backgroundColor:"var(--primary-color)",color:"white",cursor:"pointer",fontSize:"0.85rem",fontWeight:600,transition:"all 0.2s"},children:""}),p.jsx("button",{onClick:()=>{g(!1),T("")},style:{padding:"4px 12px",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"transparent",color:"var(--text-color)",cursor:"pointer",fontSize:"0.85rem",transition:"all 0.2s"},children:""})]}):p.jsx("button",{onClick:()=>g(!0),style:{padding:"6px 12px",borderRadius:"8px",border:"2px solid var(--primary-color)",backgroundColor:"transparent",color:"var(--primary-color)",cursor:"pointer",fontSize:"0.9rem",fontWeight:500,whiteSpace:"nowrap",transition:"all 0.2s",display:"flex",alignItems:"center",gap:"4px"},children:" "}),A&&p.jsx("div",{className:"modal-backdrop alert-backdrop",children:p.jsxs("div",{className:"modal-content alert-modal",children:[p.jsxs("div",{className:"alert-content",children:[p.jsx("h2",{children:l("folder_delete")}),p.jsxs("p",{style:{fontSize:"0.9rem"},children:['"',(G=t.find(I=>I.id===A))==null?void 0:G.name,'" ',l("folder_delete_confirm")]})]}),p.jsxs("div",{className:"modal-buttons",children:[p.jsx("button",{onClick:()=>V(null),className:"secondary",children:l("cancel_button")}),p.jsx("button",{onClick:()=>{s(A),V(null)},className:"destructive",children:""})]})]})}),P&&p.jsx("div",{className:"modal-backdrop alert-backdrop",children:p.jsxs("div",{className:"modal-content alert-modal",children:[p.jsxs("div",{className:"alert-content",children:[p.jsx("h2",{children:"  "}),p.jsx("p",{style:{fontSize:"0.9rem",marginBottom:"16px"},children:"   "}),p.jsx("input",{type:"text",value:x,onChange:I=>E(I.target.value),onKeyPress:I=>{I.key==="Enter"&&x.trim()&&(i(P,x),M(null),E(""))},placeholder:" ...",autoFocus:!0,style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontSize:"0.95rem",outline:"none",boxSizing:"border-box"}})]}),p.jsxs("div",{className:"modal-buttons",children:[p.jsx("button",{onClick:()=>{M(null),E("")},className:"secondary",children:""}),p.jsx("button",{onClick:()=>{x.trim()&&(i(P,x),M(null),E(""))},className:"primary",children:""})]})]})})]})},N6=({t,categoryFilter:e,onCategoryFilter:n,userCategories:r,onAddCategory:i,onRemoveCategory:s})=>{const[o,a]=O.useState(!1),[l,u]=O.useState(!1),[f,m]=O.useState(""),g=O.useRef(null);O.useEffect(()=>{const P=M=>{g.current&&!g.current.contains(M.target)&&a(!1)};return document.addEventListener("click",P),document.addEventListener("touchstart",P),()=>{document.removeEventListener("click",P),document.removeEventListener("touchstart",P)}},[]);const v=()=>{const P=f.trim();P&&!r.includes(P)&&(i(P),m(""),u(!1))},T=()=>{m(""),u(!1)};return p.jsxs(p.Fragment,{children:[p.jsx("header",{className:"goals-header",children:p.jsx("div",{className:"header-title-group",children:p.jsx("h1",{children:t("my_goals_title")})})}),l&&p.jsx("div",{className:"modal-backdrop alert-backdrop",children:p.jsxs("div",{className:"modal-content alert-modal",children:[p.jsxs("div",{className:"alert-content",children:[p.jsx("h2",{children:"  "}),p.jsx("input",{type:"text",value:f,onChange:P=>m(P.target.value),placeholder:"  ",style:{width:"100%",padding:"12px",border:"1px solid var(--border-color)",borderRadius:"8px",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontSize:"16px",marginTop:"16px"},onKeyPress:P=>{P.key==="Enter"&&v()},autoFocus:!0})]}),p.jsxs("div",{className:"modal-buttons",children:[p.jsx("button",{onClick:T,className:"secondary",children:""}),p.jsx("button",{onClick:v,className:"primary",disabled:!f.trim()||r.includes(f.trim()),children:""})]})]})})]})},b6=({t,isSelectionMode:e,selectedCount:n,totalVisibleCount:r,onCancelSelection:i,onDeleteSelected:s,onSelectAll:o,onSetSelectionMode:a,isViewModeCalendar:l,onToggleViewMode:u,isAiSorting:f,sortType:m,onSort:g,filter:v,onFilter:T,onOpenSettings:P,onAddGoal:M,currentFolderId:x,folders:E,onSyncSharedFolder:A,isSyncing:V,isSyncingData:B,onManualSync:G,activeUsers:I,onToggleCollaboration:S,onUpdateCollaborationSettings:R,categoryFilter:N,onCategoryFilter:D,userCategories:L,onAddCategory:b,onRemoveCategory:Re})=>{const[Ze,Ge]=O.useState(!1),[Se,ee]=O.useState(!1),[fe,me]=O.useState(!1),[Pe,Oe]=O.useState(!1),[Vt,Fe]=O.useState(""),Lt=O.useRef(null),ke=x?E.find(ue=>ue.id===x):null,ze=ke==null?void 0:ke.collaborationSettings,Bt=(ze==null?void 0:ze.enabled)||(ke==null?void 0:ke.isShared)||!1;O.useEffect(()=>{const ue=()=>{Ge(!1),ee(!1)};return document.addEventListener("click",ue),document.addEventListener("touchstart",ue),()=>{document.removeEventListener("click",ue),document.removeEventListener("touchstart",ue)}},[]);const Gt=ue=>{ue.stopPropagation()},Tn=()=>{const ue=Vt.trim();ue&&!L.includes(ue)&&(b(ue),Fe(""),Oe(!1))},Kn=()=>{Fe(""),Oe(!1)},Rt=(t("selection_summary_label")||"{count}/{total}").replace("{count}",String(n)).replace("{total}",String(r));return p.jsxs("aside",{className:"app-sidebar",children:[e?p.jsxs("div",{className:"sidebar-card",children:[p.jsx("p",{className:"sidebar-section-title",children:Rt}),p.jsxs("div",{className:"sidebar-selection-buttons",children:[p.jsx("button",{onClick:o,className:"sidebar-button",children:t("select_all_button_label")}),p.jsx("button",{onClick:i,className:"sidebar-button",children:t("cancel_selection_button_label")}),n>0&&p.jsx("button",{onClick:s,className:"sidebar-button destructive",children:t("delete_selected_button_label").replace("{count}",String(n))})]})]}):p.jsxs(p.Fragment,{children:[p.jsxs("button",{onClick:M,className:"sidebar-primary-button","aria-label":t("add_new_goal_button_label"),children:[xe.add,p.jsx("span",{children:t("add_new_goal_button_label")})]}),p.jsxs("div",{className:"sidebar-card",children:[p.jsx("p",{className:"sidebar-section-title",children:t(l?"list_view_button_aria":"calendar_view_button_aria")}),p.jsxs("button",{onClick:u,className:"sidebar-button","aria-label":t(l?"list_view_button_aria":"calendar_view_button_aria"),children:[l?xe.list:xe.calendar,p.jsx("span",{children:t(l?"list_view_button_aria":"calendar_view_button_aria")})]})]}),p.jsxs("div",{className:"sidebar-card",children:[p.jsx("p",{className:"sidebar-section-title",children:t("filter_sort_button_aria")}),p.jsxs("div",{className:"filter-sort-container",children:[p.jsxs("button",{onClick:ue=>{ue.stopPropagation(),Ge(rt=>!rt)},onTouchStart:ue=>{ue.stopPropagation(),Ge(rt=>!rt)},className:"sidebar-button","aria-label":t("filter_sort_button_aria"),children:[f?p.jsx("div",{className:"spinner"}):xe.filter,p.jsx("span",{children:t("filter_sort_button_aria")})]}),Ze&&p.jsxs("div",{className:"profile-popover filter-sort-popover",onClick:Gt,onTouchStart:Gt,children:[p.jsx("div",{className:"popover-section",children:p.jsx("button",{onClick:()=>{a(),Ge(!1)},className:"popover-action-button",children:p.jsx("span",{children:t("select_button_label")})})}),p.jsxs("div",{className:"popover-section",children:[p.jsx("h4",{children:t("filter_title")}),p.jsxs("button",{onClick:()=>{T("all")},className:`popover-action-button ${v==="all"?"active":""}`,children:[p.jsx("span",{children:t("filter_all")}),v==="all"&&xe.check]}),p.jsxs("button",{onClick:()=>{T("active")},className:`popover-action-button ${v==="active"?"active":""}`,children:[p.jsx("span",{children:t("filter_active")}),v==="active"&&xe.check]}),p.jsxs("button",{onClick:()=>{T("completed")},className:`popover-action-button ${v==="completed"?"active":""}`,children:[p.jsx("span",{children:t("filter_completed")}),v==="completed"&&xe.check]})]}),p.jsxs("div",{className:"popover-section",children:[p.jsx("h4",{children:t("sort_title")}),p.jsxs("button",{onClick:()=>{g("manual")},className:`popover-action-button ${m==="manual"?"active":""}`,children:[p.jsx("span",{children:t("sort_label_manual")}),m==="manual"&&xe.check]}),p.jsxs("button",{onClick:()=>{g("deadline")},className:`popover-action-button ${m==="deadline"?"active":""}`,children:[p.jsx("span",{children:t("sort_label_deadline")}),m==="deadline"&&xe.check]}),p.jsxs("button",{onClick:()=>{g("newest")},className:`popover-action-button ${m==="newest"?"active":""}`,children:[p.jsx("span",{children:t("sort_label_newest")}),m==="newest"&&xe.check]}),p.jsxs("button",{onClick:()=>{g("alphabetical")},className:`popover-action-button ${m==="alphabetical"?"active":""}`,children:[p.jsx("span",{children:t("sort_label_alphabetical")}),m==="alphabetical"&&xe.check]}),p.jsxs("button",{onClick:()=>{g("ai")},className:"popover-action-button with-icon",children:[p.jsx("span",{className:"popover-button-icon",children:xe.ai}),p.jsx("span",{children:t(f?"ai_sorting_button":"sort_label_ai")})]}),p.jsx("button",{onClick:()=>{g("ai"),Ge(!1)},className:"popover-action-button",style:{backgroundColor:"rgba(88, 86, 214, 0.1)",marginTop:"8px",color:"var(--icon-color-indigo)"},children:p.jsx("span",{children:"   "})})]})]})]})]}),x&&(ke==null?void 0:ke.isShared)&&p.jsxs("div",{className:"sidebar-card",children:[p.jsx("p",{className:"sidebar-section-title",children:""}),p.jsxs("div",{className:"collaboration-settings",children:[p.jsx("button",{onClick:ue=>{ue.stopPropagation(),ee(rt=>!rt)},className:`sidebar-button ${Bt?"collaboration-active":""}`,"aria-label":" ",children:Bt?"":""}),Se&&x&&p.jsx("div",{className:"profile-popover collaboration-popover",onClick:Gt,onTouchStart:Gt,children:p.jsxs("div",{className:"popover-section",children:[p.jsx("h4",{style:{marginBottom:"12px"},children:" "}),p.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[p.jsx("span",{children:" "}),p.jsx("button",{onClick:()=>S(x,!Bt),style:{background:Bt?"var(--primary-color)":"#ccc",border:"none",borderRadius:"12px",width:"44px",height:"24px",position:"relative",cursor:"pointer",transition:"background 0.2s"},children:p.jsx("div",{style:{background:"white",borderRadius:"50%",width:"20px",height:"20px",position:"absolute",top:"2px",left:Bt?"22px":"2px",transition:"left 0.2s"}})})]}),Bt&&I.length>0&&p.jsxs("div",{style:{marginBottom:"16px"},children:[p.jsxs("h5",{style:{marginBottom:"8px",fontSize:"0.9rem"},children:["  (",I.length,")"]}),p.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:I.map(ue=>p.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",background:"rgba(var(--primary-color-rgb), 0.1)",padding:"4px 8px",borderRadius:"12px",fontSize:"0.8rem"},children:[ue.photoURL&&p.jsx("img",{src:ue.photoURL,alt:"",style:{width:"16px",height:"16px",borderRadius:"50%"}}),p.jsx("span",{children:ue.displayName}),p.jsx("div",{style:{width:"6px",height:"6px",background:ue.isOnline?"#34C759":"#ccc",borderRadius:"50%"}})]},ue.userId))})]}),Bt&&p.jsxs("div",{style:{borderTop:"1px solid #eee",paddingTop:"16px"},children:[p.jsx("h5",{style:{marginBottom:"8px",fontSize:"0.9rem"},children:" "}),p.jsxs("label",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px",cursor:"pointer"},children:[p.jsx("span",{style:{fontSize:"0.8rem"},children:" "}),p.jsx("input",{type:"checkbox",checked:(ze==null?void 0:ze.showPresence)??!0,onChange:ue=>R(x,{showPresence:ue.target.checked})})]}),p.jsxs("label",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px",cursor:"pointer"},children:[p.jsx("span",{style:{fontSize:"0.8rem"},children:"  "}),p.jsx("input",{type:"checkbox",checked:(ze==null?void 0:ze.showEditingState)??!0,onChange:ue=>R(x,{showEditingState:ue.target.checked})})]}),p.jsxs("label",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px",cursor:"pointer"},children:[p.jsx("span",{style:{fontSize:"0.8rem"},children:" "}),p.jsx("input",{type:"checkbox",checked:(ze==null?void 0:ze.enableConflictDetection)??!0,onChange:ue=>R(x,{enableConflictDetection:ue.target.checked})})]})]})]})})]})]}),p.jsxs("div",{className:"sidebar-card",children:[p.jsx("p",{className:"sidebar-section-title",children:""}),x&&(ke==null?void 0:ke.isShared)&&p.jsx("button",{onClick:A,disabled:V,className:"sidebar-button","aria-label":"",children:V?p.jsx("div",{className:"spinner",style:{width:"20px",height:"20px"}}):"  "}),p.jsx("button",{className:"sync-status-indicator clickable",onClick:()=>{B||(x&&(ke!=null&&ke.isShared)?A():G())},disabled:B,title:B?" ...":"  ",children:B?p.jsx("span",{style:{fontSize:"12px"},children:""}):p.jsx("span",{style:{fontSize:"12px"},children:""})})]}),p.jsxs("div",{className:"sidebar-card",children:[p.jsx("p",{className:"sidebar-section-title",children:" "}),p.jsxs("div",{className:"category-dropdown-container",ref:Lt,children:[p.jsxs("button",{onClick:ue=>{ue.stopPropagation(),me(rt=>!rt)},className:"category-dropdown-button",style:{width:"100%",justifyContent:"space-between"},"aria-label":t("category_filter_button_aria"),children:[p.jsx("span",{children:N==="all"?t("category_all"):N}),p.jsx("span",{className:"dropdown-arrow",children:""})]}),fe&&p.jsxs("div",{className:"category-dropdown-menu",onClick:ue=>ue.stopPropagation(),children:[p.jsxs("div",{className:"dropdown-header",children:[p.jsx("span",{children:t("filter_category")}),p.jsx("button",{onClick:ue=>{ue.stopPropagation(),Oe(!0),me(!1)},className:"add-category-button",title:"  ",children:"+"})]}),p.jsxs("div",{className:"dropdown-items",children:[p.jsxs("button",{onClick:()=>{D("all"),me(!1)},className:`dropdown-item ${N==="all"?"active":""}`,children:[p.jsx("span",{children:t("category_all")}),N==="all"&&p.jsx("span",{className:"check-icon",children:""})]}),L.map(ue=>p.jsxs("div",{className:"dropdown-item-container",children:[p.jsxs("button",{onClick:()=>{D(ue),me(!1)},className:`dropdown-item ${N===ue?"active":""}`,children:[p.jsx("span",{children:ue}),N===ue&&p.jsx("span",{className:"check-icon",children:""})]}),!["school","work","personal","other"].includes(ue)&&p.jsx("button",{onClick:()=>Re(ue),className:"remove-category-button",title:" ",children:""})]},ue))]})]})]})]}),p.jsxs("div",{className:"sidebar-card",children:[p.jsx("p",{className:"sidebar-section-title",children:t("settings_title")}),p.jsxs("button",{onClick:P,className:"sidebar-button","aria-label":t("settings_title"),children:[xe.settings,p.jsx("span",{children:t("settings_title")})]})]})]}),Pe&&p.jsx("div",{className:"modal-backdrop alert-backdrop",children:p.jsxs("div",{className:"modal-content alert-modal",children:[p.jsxs("div",{className:"alert-content",children:[p.jsx("h2",{children:"  "}),p.jsx("input",{type:"text",value:Vt,onChange:ue=>Fe(ue.target.value),placeholder:"  ",style:{width:"100%",padding:"12px",border:"1px solid var(--border-color)",borderRadius:"8px",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontSize:"16px",marginTop:"16px"},onKeyPress:ue=>{ue.key==="Enter"&&Tn()},autoFocus:!0})]}),p.jsxs("div",{className:"modal-buttons",children:[p.jsx("button",{onClick:Kn,className:"secondary",children:""}),p.jsx("button",{onClick:Tn,className:"primary",disabled:!Vt.trim()||L.includes(Vt.trim()),children:""})]})]})})]})},D6=({todos:t,onToggleComplete:e,onDelete:n,onEdit:r,onInfo:i,t:s,filter:o,randomEncouragement:a,isSelectionMode:l,selectedTodoIds:u,onSelectTodo:f,folders:m,onMoveToFolder:g})=>{if(t.length===0){const v=`empty_message_${o}`;return p.jsx("div",{className:"empty-message",children:p.jsx("p",{children:s(v)})})}return p.jsx("ul",{children:t.map(v=>p.jsx(M6,{todo:v,onToggleComplete:e,onDelete:n,onEdit:r,onInfo:i,t:s,isSelectionMode:l,isSelected:u.has(v.id),onSelect:f,folders:m,onMoveToFolder:g},v.id))})},M6=cI.memo(({todo:t,onToggleComplete:e,onDelete:n,onEdit:r,onInfo:i,t:s,isSelectionMode:o,isSelected:a,onSelect:l,folders:u,onMoveToFolder:f})=>{var T;const m=()=>{o&&l(t.id)},g={school:"",work:"",personal:"",other:""},v=P=>P?{school:s("category_school"),work:s("category_work"),personal:s("category_personal"),other:s("category_other")}[P]||P:"";return p.jsx("li",{className:`${t.completed?"completed":""} ${o?"selection-mode":""} ${a?"selected":""}`,onClick:m,children:p.jsxs("div",{className:"swipeable-content",children:[p.jsxs("label",{className:"checkbox-container",onClick:P=>P.stopPropagation(),children:[p.jsx("input",{type:"checkbox",checked:t.completed,onChange:()=>e(t.id)}),p.jsx("span",{className:"checkmark"})]}),p.jsxs("div",{className:"todo-text-with-streak",children:[p.jsx("span",{className:"todo-text",children:t.title||t.wish}),t.isRecurring&&t.streak>0&&p.jsxs("div",{className:"streak-indicator",children:[xe.flame,p.jsx("span",{children:t.streak})]})]}),p.jsxs("div",{className:"todo-actions-and-meta",children:[p.jsxs("div",{className:"todo-meta-badges",children:[t.category&&p.jsxs("span",{style:{backgroundColor:"rgba(88, 86, 214, 0.1)",color:"var(--icon-color-indigo)",padding:"4px 8px",borderRadius:"4px",fontSize:"0.8rem",marginRight:"4px",display:"inline-flex",alignItems:"center",gap:"4px",whiteSpace:"nowrap"},children:[g[t.category]||""," ",v(t.category)]}),t.deadline&&p.jsx("span",{className:"todo-deadline",children:R6(t.deadline,s)}),t.collaborators&&t.collaborators.length>0&&p.jsxs("span",{style:{backgroundColor:"rgba(52, 199, 89, 0.1)",color:"var(--success-color)",padding:"4px 8px",borderRadius:"4px",fontSize:"0.85rem",marginLeft:"4px",display:"inline-flex",alignItems:"center",gap:"4px"},children:[" ",t.collaborators.length]}),t.folderId&&p.jsxs("span",{style:{backgroundColor:"rgba(100, 150, 200, 0.15)",color:"var(--primary-color)",padding:"4px 8px",borderRadius:"4px",fontSize:"0.8rem",marginLeft:"4px",display:"inline-flex",alignItems:"center",gap:"4px",whiteSpace:"nowrap"},children:[" ",((T=u.find(P=>P.id===t.folderId))==null?void 0:T.name)||"Unknown"]})]}),p.jsxs("div",{className:"todo-buttons",children:[p.jsxs("select",{onClick:P=>P.stopPropagation(),onChange:P=>{f(t.id,P.target.value==="root"?null:P.target.value)},defaultValue:t.folderId||"root",style:{padding:"4px 8px",borderRadius:"4px",border:"1px solid var(--border-color)",backgroundColor:"var(--card-bg-color)",color:"var(--text-color)",cursor:"pointer",fontSize:"0.85rem",fontFamily:"inherit"},title:" ",children:[p.jsx("option",{value:"root",children:"  "}),u.map(P=>p.jsx("option",{value:P.id,children:P.name},P.id))]}),p.jsx("button",{onClick:P=>{P.stopPropagation(),r(t)},className:"info-button edit-button","aria-label":s("edit_button_aria"),children:xe.edit}),p.jsx("button",{onClick:P=>{P.stopPropagation(),n(t.id)},className:"delete-button","aria-label":s("delete_button"),children:xe.delete}),p.jsx("button",{onClick:P=>{P.stopPropagation(),i(t)},className:"info-button","aria-label":s("info_button_aria"),children:xe.info})]})]})]})})}),ys=({onClose:t,children:e,className:n="",isClosing:r,size:i="large"})=>{const s={small:"modal-content-small",medium:"modal-content-medium",large:"modal-content-large"}[i];return p.jsx("div",{className:`modal-backdrop ${r?"is-closing":""}`,onClick:t,children:p.jsx("div",{className:`modal-content ${s} ${n} ${r?"is-closing":""}`,onClick:o=>o.stopPropagation(),children:e})})},Co=t=>{const[e,n]=O.useState(!1);return[e,()=>{n(!0),setTimeout(t,500)}]},V6=({step:t,t:e,createAI:n,...r})=>{const{wish:i,setWish:s,outcome:o,setOutcome:a,obstacle:l,setObstacle:u,plan:f,setPlan:m,isRecurring:g,setIsRecurring:v,recurringDays:T,setRecurringDays:P,deadline:M,setDeadline:x,noDeadline:E,setNoDeadline:A,category:V,setCategory:B,userCategories:G,errors:I,language:S}=r,[R,N]=O.useState(!1),[D,L]=O.useState(""),[b,Re]=O.useState(""),Ze=async(Ge,Se)=>{if(Se){N(!0),L(""),Re("");try{const ee=n();if(!ee){Re("AI    API  ."),N(!1);return}const fe=`Provide concise, actionable feedback on this part of a WOOP goal: ${Ge} - "${Se}". The feedback should be helpful and encouraging, in ${S==="ko"?"Korean":"English"}. Keep it to 1-2 sentences.`,me=await ee.models.generateContent({model:"gemini-1.5-flash",contents:fe});L(me.text)}catch(ee){console.error("AI Feedback Error:",ee),Re("Failed to get AI feedback.")}finally{N(!1)}}};switch(t){case 1:return p.jsxs("div",{children:[p.jsx("h3",{children:e("wish_label")}),p.jsxs("div",{className:"step-guidance",children:[p.jsx("p",{className:"tip",children:e("wish_tip")}),p.jsx("p",{className:"example",children:e("wish_example")})]}),p.jsx("textarea",{value:i,onChange:Se=>{s(Se.target.value),L(""),Re("")},placeholder:e("wish_label"),className:I.wish?"input-error":"",rows:3}),I.wish&&p.jsxs("p",{className:"field-error-message",children:[xe.exclamation," ",e("error_wish_required")]}),p.jsxs("div",{className:"ai-feedback-section",children:[p.jsxs("button",{onClick:()=>Ze("Wish",i),disabled:!i.trim()||R,className:"ai-feedback-button",children:[R?p.jsx("div",{className:"spinner-small"}):"",p.jsx("span",{children:e(R?"ai_analyzing":"ai_coach_suggestion")})]}),D&&p.jsx("div",{className:"ai-feedback-bubble",children:D}),b&&p.jsx("div",{className:"ai-feedback-bubble error",children:b})]})]});case 2:return p.jsxs("div",{children:[p.jsx("h3",{children:e("outcome_label")}),p.jsxs("div",{className:"step-guidance",children:[p.jsx("p",{className:"tip",children:e("outcome_tip")}),p.jsx("p",{className:"example",children:e("outcome_example")})]}),p.jsx("textarea",{value:o,onChange:Se=>{a(Se.target.value),L(""),Re("")},placeholder:e("outcome_label"),className:I.outcome?"input-error":"",rows:3}),I.outcome&&p.jsxs("p",{className:"field-error-message",children:[xe.exclamation," ",e("error_outcome_required")]}),p.jsxs("div",{className:"ai-feedback-section",children:[p.jsxs("button",{onClick:()=>Ze("Outcome",o),disabled:!o.trim()||R,className:"ai-feedback-button",children:[R?p.jsx("div",{className:"spinner-small"}):"",p.jsx("span",{children:e(R?"ai_analyzing":"ai_coach_suggestion")})]}),D&&p.jsx("div",{className:"ai-feedback-bubble",children:D}),b&&p.jsx("div",{className:"ai-feedback-bubble error",children:b})]})]});case 3:return p.jsxs("div",{children:[p.jsx("h3",{children:e("obstacle_label")}),p.jsxs("div",{className:"step-guidance",children:[p.jsx("p",{className:"tip",children:e("obstacle_tip")}),p.jsx("p",{className:"example",children:e("obstacle_example")})]}),p.jsx("textarea",{value:l,onChange:Se=>{u(Se.target.value),L(""),Re("")},placeholder:e("obstacle_label"),className:I.obstacle?"input-error":"",rows:3}),I.obstacle&&p.jsxs("p",{className:"field-error-message",children:[xe.exclamation," ",e("error_obstacle_required")]}),p.jsxs("div",{className:"ai-feedback-section",children:[p.jsxs("button",{onClick:()=>Ze("Obstacle",l),disabled:!l.trim()||R,className:"ai-feedback-button",children:[R?p.jsx("div",{className:"spinner-small"}):"",p.jsx("span",{children:e(R?"ai_analyzing":"ai_coach_suggestion")})]}),D&&p.jsx("div",{className:"ai-feedback-bubble",children:D}),b&&p.jsx("div",{className:"ai-feedback-bubble error",children:b})]})]});case 4:return p.jsxs("div",{children:[p.jsx("h3",{children:e("plan_label")}),p.jsxs("div",{className:"step-guidance",children:[p.jsx("p",{className:"tip",children:e("plan_tip")}),p.jsx("p",{className:"example",children:e("plan_example")})]}),p.jsx("textarea",{value:f,onChange:Se=>{m(Se.target.value),L(""),Re("")},placeholder:e("plan_label"),className:I.plan?"input-error":"",rows:3}),I.plan&&p.jsxs("p",{className:"field-error-message",children:[xe.exclamation," ",e("error_plan_required")]}),p.jsxs("div",{className:"ai-feedback-section",children:[p.jsxs("button",{onClick:()=>Ze("Plan",f),disabled:!f.trim()||R,className:"ai-feedback-button",children:[R?p.jsx("div",{className:"spinner-small"}):"",p.jsx("span",{children:e(R?"ai_analyzing":"ai_coach_suggestion")})]}),D&&p.jsx("div",{className:"ai-feedback-bubble",children:D}),b&&p.jsx("div",{className:"ai-feedback-bubble error",children:b})]})]});case 5:const Ge=Se=>{const ee=[...T],fe=ee.indexOf(Se);fe>-1?ee.splice(fe,1):ee.push(Se),P(ee)};return p.jsxs("div",{children:[p.jsxs("h3",{children:[e("recurrence_label")," & ",e("deadline_label")," & ",e("category_label")]}),p.jsxs("div",{className:"step-guidance",children:[p.jsx("p",{className:"tip",children:e("recurrence_tip")}),p.jsx("p",{className:"example",children:e("recurrence_example")})]}),p.jsxs("label",{className:"settings-item standalone-toggle",children:[p.jsx("span",{style:{fontWeight:500},children:e("recurrence_option_daily")}),p.jsxs("label",{className:"theme-toggle-switch",children:[p.jsx("input",{type:"checkbox",checked:g,onChange:Se=>v(Se.target.checked)}),p.jsx("span",{className:"slider round"})]})]}),g&&p.jsx("div",{className:"day-picker",children:e("day_names_short_picker").map((Se,ee)=>p.jsx("button",{onClick:()=>Ge(ee),className:`day-button ${T.includes(ee)?"selected":""}`,children:Se},ee))}),I.recurringDays&&p.jsxs("p",{className:"field-error-message",children:[xe.exclamation," ",e("error_day_required")]}),p.jsx("hr",{}),p.jsx("div",{className:"step-guidance",style:{marginTop:"16px"},children:p.jsx("p",{className:"tip",children:e("deadline_tip")})}),p.jsxs("label",{className:"settings-item standalone-toggle",children:[p.jsx("span",{style:{fontWeight:500},children:e("deadline_option_no_deadline")}),p.jsxs("label",{className:"theme-toggle-switch",children:[p.jsx("input",{type:"checkbox",checked:E,onChange:Se=>A(Se.target.checked)}),p.jsx("span",{className:"slider round"})]})]}),!E&&p.jsx("input",{type:"date",value:M,onChange:Se=>x(Se.target.value),className:I.deadline?"input-error":"",style:{marginTop:"12px"}}),I.deadline&&p.jsxs("p",{className:"field-error-message",children:[xe.exclamation," ",e("error_deadline_required")]}),p.jsx("hr",{}),p.jsx("div",{className:"step-guidance",style:{marginTop:"16px"},children:p.jsx("p",{className:"tip",children:e("category_label")})}),p.jsx("div",{style:{display:"grid",gridTemplateColumns:G&&G.length>2?"repeat(2, 1fr)":"repeat(1, 1fr)",gap:"8px",marginTop:"12px"},children:G&&G.map(Se=>p.jsx("button",{onClick:()=>B(Se),className:`category-button ${V===Se?"active":""}`,children:Se},Se))})]});default:return null}},L6=({onGenerate:t,t:e,onCancel:n})=>{const[r,i]=O.useState(""),[s,o]=O.useState(""),[a,l]=O.useState(""),[u,f]=O.useState(""),[m,g]=O.useState(""),{endDate:v,generatedCount:T}=O.useMemo(()=>{const M=parseInt(s,10),x=parseInt(a,10);if(!u||!M||M<=0||!x||x<=0)return{endDate:"",generatedCount:0};const E=Math.ceil(M/x),A=new Date(u),V=new Date(A);return V.setDate(A.getDate()+E-1),{endDate:V.toISOString().split("T")[0],generatedCount:E}},[s,a,u]),P=()=>{const M=parseInt(s,10),x=parseInt(a,10);if(!r.trim()||!u||!M||M<=0||!x||x<=0){g(e("automation_error_all_fields"));return}const E=[],A=Math.ceil(M/x),V=new Date(u);for(let B=0;B<A;B++){const G=new Date(V);G.setDate(V.getDate()+B);const I=B*x+1,S=Math.min((B+1)*x,M),R=`${r.trim()} ${I}`+(S>I?` - ${S}`:"");E.push({wish:R,outcome:"",obstacle:"",plan:"",isRecurring:!1,recurringDays:[],deadline:G.toISOString().split("T")[0],category:"personal"})}g(""),t(E)};return p.jsxs("div",{className:"automation-form-container",children:[p.jsx("h3",{children:e("automation_title")}),p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:e("automation_base_name_label")}),p.jsx("input",{type:"text",value:r,onChange:M=>i(M.target.value),placeholder:e("automation_base_name_placeholder")})]}),p.jsxs("div",{className:"automation-form-grid",children:[p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:e("automation_total_units_label")}),p.jsx("input",{type:"number",value:s,onChange:M=>o(M.target.value),placeholder:e("automation_total_units_placeholder")})]}),p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:e("automation_units_per_day_label")}),p.jsx("input",{type:"number",value:a,onChange:M=>l(M.target.value),placeholder:": 5"})]})]}),p.jsxs("div",{className:"automation-form-grid",children:[p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:e("automation_start_date_label")}),p.jsx("input",{type:"date",value:u,onChange:M=>f(M.target.value)})]}),p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:e("automation_end_date_label")}),p.jsx("input",{type:"date",value:v,readOnly:!0})]})]}),m&&p.jsxs("p",{className:"field-error-message",style:{justifyContent:"center"},children:[xe.exclamation," ",m]}),p.jsxs("div",{className:"goal-assistant-nav",children:[p.jsx("button",{onClick:n,className:"secondary",children:e("cancel_button")}),p.jsx("button",{onClick:P,className:"primary",disabled:T===0,children:T>0?`${T} `:e("automation_generate_button").replace("{count}",String(T))})]})]})},kp=({onClose:t,onAddTodo:e,onAddMultipleTodos:n,onEditTodo:r,existingTodo:i,t:s,language:o,createAI:a,userCategories:l=["personal"],onAddAssignment:u,analyzeAssignmentWithAI:f,initialMode:m="woop"})=>{const[g,v]=Co(t),[T,P]=O.useState(m),[M,x]=O.useState(1),[E,A]=O.useState("forward"),[V,B]=O.useState((i==null?void 0:i.wish)||""),[G,I]=O.useState((i==null?void 0:i.outcome)||""),[S,R]=O.useState((i==null?void 0:i.obstacle)||""),[N,D]=O.useState((i==null?void 0:i.plan)||""),[L,b]=O.useState((i==null?void 0:i.isRecurring)||!1),[Re,Ze]=O.useState((i==null?void 0:i.recurringDays)||[]),[Ge,Se]=O.useState((i==null?void 0:i.deadline)||""),[ee,fe]=O.useState(!(i!=null&&i.deadline)),[me,Pe]=O.useState((i==null?void 0:i.category)||"personal"),[Oe,Vt]=O.useState({}),[Fe,Lt]=O.useState(""),[ke,ze]=O.useState(""),[Bt,Gt]=O.useState(""),[Tn,Kn]=O.useState("personal"),[Rt,ue]=O.useState(""),[rt,fr]=O.useState(""),[pr,Jn]=O.useState(""),[Ne,We]=O.useState(""),[$e,fn]=O.useState(3),[Mr,En]=O.useState(""),[Et,mr]=O.useState(!1),[Qn,vs]=O.useState(""),_t=5,ve=ce=>{const St={};return ce===1&&!V.trim()&&(St.wish=!0),ce===2&&!G.trim()&&(St.outcome=!0),ce===3&&!S.trim()&&(St.obstacle=!0),ce===4&&!N.trim()&&(St.plan=!0),ce===5&&(!ee&&!Ge&&(St.deadline=!0),L&&Re.length===0&&(St.recurringDays=!0)),Vt(St),Object.keys(St).length===0},xo=()=>{ve(M)&&(M<_t?(A("forward"),x(ce=>ce+1)):Vn())},hi=()=>{M>1&&(A("backward"),x(ce=>ce-1))},wn=ce=>{ce==="quick"&&(B(""),I(""),R(""),D("")),ce==="assignment"&&(ue(""),fr(""),Jn(""),We(""),fn(3),En(""),vs("")),P(ce)},Vn=async()=>{if(T==="quick"){console.log("    handleSubmit  - handleQuickTaskSubmit "),Ln();return}if(!ve(5))return;const ce={wish:V,outcome:G,obstacle:S,plan:N,isRecurring:L,recurringDays:Re,deadline:ee?"":Ge,category:me};console.log(" WOOP  :",ce);try{i&&r?await r({...i,...ce}):e&&await e(ce)}catch(St){console.error("   :",St)}v()},Ln=()=>{if(Fe.trim()){if(e){const ce={title:Fe.trim(),wish:"",outcome:"",obstacle:"",plan:"",isRecurring:!1,recurringDays:[],deadline:ke,category:Tn};console.log("   :",ce),e(ce)}Lt(""),ze(""),Gt(""),Kn("personal"),v()}},Ce=()=>{!Rt.trim()||!rt.trim()||!Ne||!Mr||(u&&u({name:Rt.trim(),subject:rt.trim(),estimatedMinutes:parseInt(Ne),difficulty:$e,dueDate:Mr,completed:!1}),ue(""),fr(""),Jn(""),We(""),fn(3),En(""),vs(""),v())};return p.jsxs(ys,{onClose:v,isClosing:g,className:"goal-assistant-modal",children:[p.jsxs("div",{className:"goal-assistant-header",children:[p.jsx("div",{className:"goal-assistant-header-left"}),p.jsx("h2",{children:T==="woop"?" ":T==="quick"?" ":T==="assignment"?"  ":T==="automation"?" ":s("goal_assistant_title")}),p.jsx("div",{className:"goal-assistant-header-right",style:{width:"40px"}})]}),!i&&p.jsx("div",{className:"modal-mode-switcher-container",children:p.jsxs("div",{className:"modal-mode-switcher",children:[p.jsx("button",{onClick:()=>wn("woop"),className:T==="woop"?"active":"",children:s("goal_assistant_mode_woop")}),p.jsx("button",{onClick:()=>wn("quick"),className:T==="quick"?"active":"",children:" "}),u&&p.jsx("button",{onClick:()=>wn("assignment"),className:T==="assignment"?"active":"",children:" "}),p.jsx("button",{onClick:()=>wn("automation"),className:T==="automation"?"active":"",children:s("goal_assistant_mode_automation")})]})}),"            ",p.jsx("div",{className:"goal-assistant-body",children:T==="woop"?p.jsxs(p.Fragment,{children:[p.jsxs("div",{style:{padding:"24px 16px",flex:1,overflowY:"auto"},children:[p.jsx("div",{className:"progress-bar-container",children:p.jsx("div",{className:"progress-bar",style:{width:`${M/_t*100}%`}})}),p.jsx("div",{className:`goal-assistant-step-content-animator ${E}`,children:p.jsx(V6,{step:M,t:s,createAI:a,wish:V,setWish:B,outcome:G,setOutcome:I,obstacle:S,setObstacle:R,plan:N,setPlan:D,isRecurring:L,setIsRecurring:b,recurringDays:Re,setRecurringDays:Ze,deadline:Ge,setDeadline:Se,noDeadline:ee,setNoDeadline:fe,category:me,setCategory:Pe,userCategories:l,errors:Oe,language:o})},M)]}),p.jsxs("div",{className:"goal-assistant-nav",children:[M>1?p.jsx("button",{onClick:hi,className:"secondary",children:s("back_button")}):p.jsx("button",{onClick:v,className:"secondary",children:s("cancel_button")}),p.jsx("button",{onClick:xo,className:"primary",children:s(M===_t?i?"save_button":"add_button":"next_button")})]})]}):T==="quick"?p.jsxs(p.Fragment,{children:[p.jsxs("div",{style:{padding:"24px 16px",flex:1,overflowY:"auto"},children:[p.jsxs("div",{style:{marginBottom:"20px"},children:[p.jsx("h3",{style:{fontSize:"1rem",fontWeight:"600",marginBottom:"12px"},children:" "}),p.jsx("div",{className:"step-guidance",children:p.jsx("p",{className:"tip",children:"  "})}),p.jsx("textarea",{value:Fe,onChange:ce=>Lt(ce.target.value),placeholder:":  ",rows:2,style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontSize:"14px",fontFamily:"inherit",resize:"none",marginTop:"12px"},onKeyPress:ce=>{ce.key==="Enter"&&ce.ctrlKey&&Ln()}})]}),p.jsx("hr",{}),p.jsxs("div",{style:{marginBottom:"20px"},children:[p.jsx("div",{className:"step-guidance",style:{marginTop:"16px"},children:p.jsx("p",{className:"tip",children:"  ()"})}),p.jsxs("label",{className:"settings-item standalone-toggle",style:{marginTop:"12px"},children:[p.jsx("span",{style:{fontWeight:"500"},children:" "}),p.jsxs("label",{className:"theme-toggle-switch",children:[p.jsx("input",{type:"checkbox",checked:!!ke,onChange:ce=>ze(ce.target.checked?new Date().toISOString().split("T")[0]:"")}),p.jsx("span",{className:"slider round"})]})]}),ke&&p.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",marginTop:"12px"},children:[p.jsxs("div",{children:[p.jsx("label",{style:{fontSize:"12px",opacity:.7,display:"block",marginBottom:"4px"},children:""}),p.jsx("input",{type:"date",value:ke,onChange:ce=>ze(ce.target.value),style:{width:"100%",padding:"10px",borderRadius:"6px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontSize:"13px"}})]}),p.jsxs("div",{children:[p.jsx("label",{style:{fontSize:"12px",opacity:.7,display:"block",marginBottom:"4px"},children:" ()"}),p.jsx("input",{type:"time",value:Bt,onChange:ce=>Gt(ce.target.value),style:{width:"100%",padding:"10px",borderRadius:"6px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontSize:"13px"}})]})]})]}),p.jsx("hr",{}),p.jsxs("div",{style:{marginBottom:"24px"},children:[p.jsx("div",{className:"step-guidance",style:{marginTop:"16px"},children:p.jsx("p",{className:"tip",children:s("category_label")})}),p.jsx("div",{style:{display:"grid",gridTemplateColumns:l&&l.length>2?"repeat(2, 1fr)":"repeat(1, 1fr)",gap:"8px",marginTop:"12px"},children:l&&l.map(ce=>p.jsx("button",{onClick:()=>Kn(ce),className:`category-button ${Tn===ce?"active":""}`,children:ce},ce))})]})]}),p.jsxs("div",{className:"goal-assistant-nav",children:[p.jsx("button",{onClick:v,className:"secondary",children:s("cancel_button")}),p.jsx("button",{onClick:Ln,className:"primary",disabled:!Fe.trim(),children:s("add_button")})]})]}):T==="assignment"?p.jsxs(p.Fragment,{children:[p.jsxs("div",{className:"goal-assistant-step-content",children:[p.jsxs("div",{className:"info-section",children:[p.jsx("h4",{children:s("assignment_name")}),p.jsx("input",{type:"text",value:Rt,onChange:ce=>ue(ce.target.value),placeholder:":   3",disabled:Et,style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",opacity:Et?.6:1,cursor:Et?"not-allowed":"text"}})]}),p.jsxs("div",{className:"info-section",children:[p.jsx("h4",{children:s("subject")}),p.jsx("input",{type:"text",value:rt,onChange:ce=>fr(ce.target.value),placeholder:": ",disabled:Et,style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",opacity:Et?.6:1,cursor:Et?"not-allowed":"text"}})]}),p.jsxs("div",{className:"info-section",children:[p.jsxs("h4",{children:[s("assignment_description")," ()"]}),p.jsx("textarea",{value:pr,onChange:ce=>Jn(ce.target.value),placeholder:s("assignment_description_placeholder"),rows:3,disabled:Et,style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",resize:"vertical",opacity:Et?.6:1,cursor:Et?"not-allowed":"text"}})]}),Rt.trim()&&rt.trim()&&Et&&p.jsx("div",{style:{padding:"16px",backgroundColor:"var(--bg-secondary-color)",borderRadius:"12px",border:"1px solid var(--primary-color)",marginBottom:"16px",textAlign:"center"},children:p.jsxs("p",{style:{fontSize:"0.95rem",color:"var(--primary-color)",margin:0},children:[" ",s("ai_analyzing"),"..."]})}),Qn&&p.jsxs("div",{style:{padding:"16px",backgroundColor:"var(--bg-secondary-color)",borderRadius:"12px",border:"1px solid var(--border-color)",marginBottom:"16px"},children:[p.jsxs("h4",{style:{marginBottom:"8px",fontSize:"0.9rem"},children:[" ",s("ai_suggestion")]}),p.jsx("p",{style:{fontSize:"0.9rem",lineHeight:"1.5",color:"var(--text-secondary-color)",margin:0},children:Qn})]}),p.jsxs("div",{className:"info-section",children:[p.jsx("h4",{children:s("estimated_time")}),p.jsx("input",{type:"number",value:Ne,onChange:ce=>We(ce.target.value),placeholder:"",min:"1",disabled:Et,style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",opacity:Et?.6:1,cursor:Et?"not-allowed":"text"}})]}),p.jsxs("div",{className:"info-section",children:[p.jsx("h4",{children:s("difficulty")}),p.jsx("div",{style:{display:"flex",gap:"8px",justifyContent:"space-between"},children:[1,2,3,4,5].map(ce=>p.jsx("button",{onClick:()=>!Et&&fn(ce),disabled:Et,style:{flex:1,padding:"12px",borderRadius:"8px",border:$e===ce?"2px solid var(--primary-color)":"1px solid var(--border-color)",backgroundColor:$e===ce?"var(--primary-color)":"var(--bg-secondary-color)",color:$e===ce?"white":"var(--text-color)",cursor:Et?"not-allowed":"pointer",fontSize:"0.9rem",fontWeight:$e===ce?"600":"500",opacity:Et?.6:1},children:ce},ce))})]}),p.jsxs("div",{className:"info-section",children:[p.jsx("h4",{children:s("due_date")}),p.jsx("input",{type:"date",value:Mr,onChange:ce=>En(ce.target.value),min:new Date().toISOString().split("T")[0],style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)"}})]})]}),p.jsxs("div",{className:"goal-assistant-nav",children:[p.jsx("button",{onClick:v,className:"secondary",children:s("cancel_button")}),p.jsx("button",{onClick:Ce,className:"primary",disabled:!Rt.trim()||!rt.trim()||!Ne||!Mr,children:s("add_assignment")})]})]}):n&&p.jsx(L6,{onGenerate:n,t:s,onCancel:v})})]})},F6=({todo:t,onClose:e,t:n,createAI:r,onDeleteGoal:i,userCategories:s,onUpdateGoal:o,onToggleComplete:a})=>{const[l,u]=Co(e),[f,m]=O.useState(""),[g,v]=O.useState(!1),[T,P]=O.useState(!1),M=async()=>{v(!0),m(""),P(!1);try{const E=r();if(!E){m("AI    API  ."),v(!1);return}const A=`Based on the WOOP method, provide a concise and encouraging suggestion for the following goal: Wish: "${t.wish}", Best Outcome: "${t.outcome}", Obstacle: "${t.obstacle}", Plan: "${t.plan}". Focus on strengthening the plan or reframing the obstacle.`,V=await E.models.generateContent({model:"gemini-1.5-flash",contents:A});m(V.text)}catch(E){console.error(E),P(!0)}finally{v(!1)}},x=mg(t);return p.jsxs(ys,{onClose:u,isClosing:l,className:"info-modal",children:[p.jsxs("div",{className:"info-modal-content",children:[p.jsx("h2",{children:n(x?"goal_details_modal_title":"todo_details_title")}),x?p.jsxs(p.Fragment,{children:[p.jsxs("div",{className:"info-section",children:[p.jsx("h4",{children:n("wish_label")}),p.jsx("p",{children:t.wish})]}),p.jsxs("div",{className:"info-section",children:[p.jsx("h4",{children:n("outcome_label")}),p.jsx("p",{children:t.outcome})]}),p.jsxs("div",{className:"info-section",children:[p.jsx("h4",{children:n("obstacle_label")}),p.jsx("p",{children:t.obstacle})]}),p.jsxs("div",{className:"info-section",children:[p.jsx("h4",{children:n("plan_label")}),p.jsx("p",{children:t.plan})]})]}):p.jsxs(p.Fragment,{children:[p.jsxs("div",{className:"info-section",children:[p.jsx("h4",{children:n("task_title_label")}),p.jsx("p",{children:t.title})]}),t.date&&p.jsxs("div",{className:"info-section",children:[p.jsx("h4",{children:n("due_date_label")}),p.jsx("p",{children:new Date(t.date).toLocaleDateString()})]}),t.time&&p.jsxs("div",{className:"info-section",children:[p.jsx("h4",{children:n("time_label")}),p.jsx("p",{children:t.time})]}),p.jsxs("div",{className:"info-section",children:[p.jsx("h4",{children:n("completion_status_label")}),p.jsx("p",{children:t.completed?n("completed"):n("pending")})]})]}),s&&s.length>0&&o&&p.jsxs("div",{className:"info-section",style:{borderTop:"1px solid var(--border-color)",paddingTop:"16px",marginTop:"16px"},children:[p.jsx("h4",{style:{marginBottom:"12px"},children:n("category_label")}),p.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:s.map(E=>p.jsx("button",{onClick:()=>{o({...t,category:E}),u()},className:`category-button ${t.category===E?"active":""}`,style:{padding:"8px 16px",borderRadius:"20px",border:t.category===E?"2px solid var(--primary-color)":"2px solid var(--border-color)",backgroundColor:t.category===E?"var(--primary-color)":"transparent",color:t.category===E?"white":"var(--text-color)",cursor:"pointer",fontSize:"14px",fontWeight:t.category===E?"600":"500",transition:"all 0.25s ease",whiteSpace:"nowrap",display:"inline-block",boxShadow:t.category===E?"0 2px 8px rgba(88, 86, 214, 0.2)":"none"},children:E},E))})]}),x&&p.jsxs("div",{className:"ai-analysis-section",children:[p.jsx("h4",{children:n("ai_coach_suggestion")}),g?p.jsx("p",{children:n("ai_analyzing")}):f?p.jsx("p",{children:f}):T?p.jsx("p",{className:"ai-error",children:n("ai_sort_error_message")}):p.jsx("button",{onClick:M,className:"feedback-button",children:n("ai_coach_suggestion")})]})]}),p.jsxs("div",{className:"modal-buttons",children:[a&&p.jsx("button",{onClick:()=>{a(t.id),u()},className:`secondary ${t.completed?"destructive":""}`,children:t.completed?"  ":"  "}),i&&p.jsxs("button",{onClick:()=>{i(t.id)},className:"secondary destructive",children:[" ",n("delete_button")]}),p.jsx("button",{onClick:u,className:"primary",children:n("close_button")})]})]})},U6=({folder:t,onClose:e,t:n,googleUser:r,onUpdateCollaborators:i,setAlertConfig:s})=>{const[o,a]=Co(e),[l,u]=O.useState(""),[f,m]=O.useState(!1),[g,v]=O.useState(""),[T,P]=O.useState(!1),M=async()=>{if(!(!t||!r)){m(!0);try{if(!g||g.trim().length===0){s({title:"  ",message:"      .",confirmText:"",onConfirm:()=>{}}),m(!1);return}const V={type:"folder_share",folderId:t.id,folderName:t.name,folderColor:t.color,goals:[],sharedBy:r==null?void 0:r.email,ownerId:r==null?void 0:r.uid,sharedAt:new Date().toISOString(),password:g},B=lt(ge,"users",r.uid,"folders"),G=Le(B,t.id),I=t.collaborators||[];await yt(G,{collaborators:I,shareInfo:{password:g,createdAt:new Date().toISOString()},updatedAt:new Date().toISOString()},{merge:!0});const S=gg(JSON.stringify(V)),R=`${window.location.origin}${window.location.pathname}?folder_share=${encodeURIComponent(S)}`,N=await tR(R);u(N),s({title:"   ",message:" .  !",confirmText:"",onConfirm:()=>{navigator.clipboard.writeText(N)}})}catch(V){console.error("   :",V),s({title:" ",message:"   .  .",confirmText:"",onConfirm:()=>{}})}finally{m(!1)}}},x=()=>{l&&navigator.clipboard.writeText(l).then(()=>{s({title:" ",message:"  .",confirmText:"",onConfirm:()=>{}})})},E=async V=>{if(!(!t||!r))try{const B=lt(ge,"users",r.uid,"folders"),G=Le(B,t.id),I=(t.collaborators||[]).filter(S=>S.userId!==V);await yt(G,{collaborators:I,updatedAt:new Date().toISOString()},{merge:!0}),i(t.id,I),s({title:" ",message:" .",confirmText:"",onConfirm:()=>{}})}catch(B){console.error("  :",B),s({title:" ",message:"  .",confirmText:"",onConfirm:()=>{}})}},A=async(V,B)=>{if(!(!t||!r))try{const G=lt(ge,"users",r.uid,"folders"),I=Le(G,t.id),S=(t.collaborators||[]).map(R=>R.userId===V?{...R,role:B}:R);await yt(I,{collaborators:S,updatedAt:new Date().toISOString()},{merge:!0}),i(t.id,S),s({title:"  ",message:`  ${B==="editor"?"":""} .`,confirmText:"",onConfirm:()=>{}})}catch(G){console.error("  :",G)}};return t?p.jsxs(ys,{onClose:a,isClosing:o,className:"goal-assistant-modal",children:[p.jsxs("div",{className:"goal-assistant-header",children:[p.jsx("div",{className:"goal-assistant-header-left"}),p.jsxs("h2",{children:[t.name,"  "]}),p.jsx("div",{className:"goal-assistant-header-right",children:p.jsx("button",{onClick:a,className:"close-button",children:xe.close})})]}),p.jsx("div",{className:"goal-assistant-body",children:p.jsxs("div",{style:{padding:"24px 16px"},children:[p.jsxs("div",{style:{marginBottom:"20px"},children:[p.jsx("h3",{style:{fontSize:"1rem",fontWeight:"600",marginBottom:"12px"},children:" "}),t.collaborators&&t.collaborators.length>0?p.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:t.collaborators.map(V=>p.jsxs("div",{className:"settings-item",style:{padding:"12px",backgroundColor:"var(--card-bg-color)",borderRadius:"8px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[p.jsxs("div",{style:{flex:1},children:[p.jsx("div",{style:{fontWeight:"500",fontSize:"0.95rem"},children:V.email}),V.role==="owner"?p.jsx("div",{style:{fontSize:"0.85rem",color:"var(--text-secondary-color)",marginTop:"2px"},children:""}):p.jsxs("select",{value:V.role,onChange:B=>A(V.userId,B.target.value),style:{fontSize:"0.85rem",padding:"4px 8px",marginTop:"4px",borderRadius:"4px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",cursor:"pointer"},children:[p.jsx("option",{value:"editor",children:""}),p.jsx("option",{value:"viewer",children:""})]})]}),V.role!=="owner"&&p.jsx("button",{onClick:()=>E(V.userId),style:{padding:"4px 12px",backgroundColor:"var(--danger-color)",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"0.8rem",marginLeft:"12px",whiteSpace:"nowrap"},children:""})]},V.userId))}):p.jsx("div",{className:"step-guidance",children:p.jsx("p",{className:"tip",children:" .    ."})})]}),p.jsx("hr",{style:{margin:"20px 0",border:"none",borderTop:"1px solid var(--border-color)"}}),p.jsxs("div",{style:{marginBottom:"20px"},children:[p.jsx("h3",{style:{fontSize:"1rem",fontWeight:"600",marginBottom:"12px"},children:"   "}),p.jsx("div",{className:"step-guidance",children:p.jsx("p",{className:"tip",children:"    ,      ."})}),l?p.jsxs("div",{style:{marginTop:"16px",display:"flex",flexDirection:"column",gap:"12px"},children:[p.jsx("div",{style:{padding:"12px",backgroundColor:"var(--card-bg-color)",borderRadius:"8px",border:"1px solid var(--border-color)"},children:p.jsx("input",{type:"text",readOnly:!0,value:l,onClick:V=>V.target.select(),style:{width:"100%",padding:"10px",border:"1px solid var(--border-color)",borderRadius:"6px",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontSize:"0.85rem",boxSizing:"border-box",fontFamily:"monospace"}})}),p.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[p.jsx("button",{onClick:x,className:"primary",children:" "}),p.jsx("button",{onClick:()=>{u(""),v(""),P(!1)},className:"secondary",children:" "})]})]}):p.jsxs("div",{style:{marginTop:"16px",display:"flex",flexDirection:"column",gap:"12px"},children:[p.jsxs("label",{className:"settings-item standalone-toggle",children:[p.jsx("span",{style:{fontWeight:"500"},children:"  "}),p.jsxs("label",{className:"theme-toggle-switch",children:[p.jsx("input",{type:"checkbox",checked:T,onChange:V=>{P(V.target.checked),V.target.checked||v("")}}),p.jsx("span",{className:"slider round"})]})]}),T&&p.jsx("input",{type:"password",placeholder:" ",value:g,onChange:V=>v(V.target.value),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontFamily:"inherit",fontSize:"14px",boxSizing:"border-box"}}),p.jsx("button",{onClick:M,disabled:f||!g.trim(),className:"primary",style:{width:"100%",padding:"14px 0",backgroundColor:"var(--primary-color)",color:"white",border:"none",borderRadius:"24px",boxShadow:"0 2px 8px rgba(88,86,214,0.08)",fontWeight:700,fontSize:"16px",letterSpacing:"0.01em",cursor:f||!g.trim()?"not-allowed":"pointer",opacity:f||!g.trim()?.6:1,transition:"all 0.2s"},children:f?"  ...":"  "})]})]})]})}),p.jsxs("div",{className:"goal-assistant-nav",children:[p.jsx("div",{}),p.jsx("button",{onClick:a,className:"primary",children:""})]})]}):null},O6=({onClose:t,isDarkMode:e,onToggleDarkMode:n,themeMode:r,onThemeChange:i,backgroundTheme:s,onSetBackgroundTheme:o,onExportData:a,onImportData:l,setAlertConfig:u,onDeleteAllData:f,dataActionStatus:m,language:g,onSetLanguage:v,t:T,todos:P,setToastMessage:M,onOpenVersionInfo:x,onOpenUsageGuide:E,apiKey:A,onSetApiKey:V,isOfflineMode:B,onToggleOfflineMode:G,googleUser:I,onGoogleLogin:S,onGoogleLogout:R,onSyncDataToFirebase:N,onLoadDataFromFirebase:D,isGoogleLoggingIn:L=!1,isGoogleLoggingOut:b=!1,isSyncingData:Re=!1,isLoadingData:Ze=!1,isAutoSyncEnabled:Ge,setIsAutoSyncEnabled:Se,notificationPermission:ee,setNotificationPermission:fe})=>{const[me,Pe]=Co(t),[Oe,Vt]=O.useState("appearance"),[Fe,Lt]=O.useState(""),[ke,ze]=O.useState(!1),[Bt,Gt]=O.useState("medium"),[Tn,Kn]=O.useState(null),Rt=O.useRef(null),ue=[{id:"appearance",label:T("settings_section_background"),icon:xe.background},{id:"general",label:T("settings_section_general"),icon:xe.settings},{id:"data",label:T("settings_section_data"),icon:xe.data}],rt=()=>u({title:T("delete_account_header"),message:T("delete_account_header_desc"),isDestructive:!0,confirmText:T("delete_all_data_button"),cancelText:T("cancel_button"),onConfirm:f,onCancel:()=>{}}),fr=async()=>{if(!P||P.length===0){Kn(T("no_data_to_share"));return}ze(!0);try{const Ne=Zw(P),We=`${window.location.origin}${window.location.pathname}?data=${encodeURIComponent(Ne)}`,$e=await tR(We);Lt($e),$e!==We&&$e.length<We.length?M(T("short_url_created")):M(T("share_link_created"))}catch(Ne){console.error("Failed to create share link",Ne);const We=Zw(P),$e=`${window.location.origin}${window.location.pathname}?data=${encodeURIComponent(We)}`;Lt($e),M(T("short_url_failed"))}finally{ze(!1)}},pr=()=>{Fe&&navigator.clipboard.writeText(Fe).then(()=>{M(T("link_copied_toast"))})},Jn=()=>{switch(Oe){case"appearance":return p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"settings-section-header",children:T("settings_theme_mode")}),p.jsxs("div",{className:"settings-section-body",children:[p.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>i("light"),children:[p.jsxs("div",{children:[p.jsx("span",{children:T("theme_mode_light")}),p.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:T("theme_mode_light_desc")})]}),r==="light"&&xe.check]}),p.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>i("dark"),children:[p.jsxs("div",{children:[p.jsx("span",{children:T("theme_mode_dark")}),p.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:T("theme_mode_dark_desc")})]}),r==="dark"&&xe.check]}),p.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>i("system"),children:[p.jsxs("div",{children:[p.jsx("span",{children:T("theme_mode_system")}),p.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:T("theme_mode_system_desc")})]}),r==="system"&&xe.check]})]}),p.jsx("div",{className:"settings-section-header",children:T("settings_background_header")}),p.jsx("div",{className:"settings-section-body",children:_g.map(Ne=>p.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>o(Ne.id),children:[p.jsx("span",{children:T(e?Ne.darkNameKey:Ne.lightNameKey)}),s===Ne.id&&xe.check]},Ne.id))})]});case"general":return p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"settings-section-header",children:T("settings_language")}),p.jsxs("div",{className:"settings-section-body",children:[p.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>v("ko"),children:[p.jsx("span",{children:""}),g==="ko"&&xe.check]}),p.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>v("en"),children:[p.jsx("span",{children:"English"}),g==="en"&&xe.check]})]}),p.jsx("div",{className:"settings-section-header",children:T("settings_api_key")}),p.jsxs("div",{className:"settings-section-body",children:[p.jsx("div",{className:"settings-item",children:p.jsx("input",{type:"password",placeholder:T("settings_api_key_placeholder"),value:A,onChange:Ne=>V(Ne.target.value),style:{width:"100%",padding:"8px",border:"1px solid var(--border-color)",borderRadius:"4px",backgroundColor:"var(--input-bg)"}})}),p.jsxs("label",{className:"settings-item",children:[p.jsxs("div",{children:[p.jsx("span",{children:T("settings_offline_mode")}),p.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:T("settings_offline_mode_desc")})]}),p.jsxs("div",{className:"theme-toggle-switch",children:[p.jsx("input",{type:"checkbox",checked:B,onChange:G}),p.jsx("span",{className:"slider round"})]})]})]}),p.jsx("div",{className:"settings-section-header",children:T("settings_section_info")}),p.jsxs("div",{className:"settings-section-body",children:[p.jsxs("div",{className:"settings-item nav-indicator",onClick:x,children:[p.jsx("span",{children:T("settings_version")}),p.jsxs("div",{className:"settings-item-value-with-icon",children:[p.jsx("span",{children:"2.0"}),xe.forward]})]}),p.jsxs("div",{className:"settings-item nav-indicator",onClick:E,children:[p.jsx("span",{children:T("usage_guide_title")}),p.jsx("div",{className:"settings-item-value-with-icon",children:xe.forward})]}),p.jsxs("div",{className:"settings-item",children:[p.jsx("span",{children:T("settings_developer")}),p.jsx("span",{className:"settings-item-value",children:T("developer_name")})]}),p.jsxs("div",{className:"settings-item",children:[p.jsx("span",{children:T("settings_copyright")}),p.jsx("span",{className:"settings-item-value",children:T("copyright_notice")})]})]})]});case"data":return p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"settings-section-header",children:""}),p.jsx("div",{className:"settings-section-body",children:I?p.jsxs("div",{children:[p.jsxs("div",{className:"settings-item",children:[p.jsxs("div",{children:[p.jsx("span",{children:"Google "}),p.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:I.email}),p.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:I.displayName})]}),p.jsx("span",{style:{color:"var(--success-color, #4CAF50)"},children:""})]}),p.jsx("button",{className:"settings-item action-item",onClick:R,disabled:b,style:{opacity:b?.6:1},children:p.jsx("span",{className:"action-text",children:b?"  ...":""})})]}):p.jsx("div",{children:p.jsx("div",{style:{display:"flex",justifyContent:"center",padding:"12px 0"},children:p.jsxs("button",{onClick:S,disabled:L,style:{backgroundColor:L?e?"#2A2A2A":"#E0E0E0":e?"#1F1F1F":"white",border:`1px solid ${e?"#404040":"#D3D3D3"}`,borderRadius:"24px",padding:"8px 20px",fontSize:"14px",fontWeight:"500",cursor:L?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"8px",color:L?e?"#666":"#999999":e?"#E0E0E0":"#1F2937",transition:"all 0.2s",opacity:L?.6:1},children:[e?p.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",children:[p.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),p.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),p.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),p.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}):p.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",children:[p.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),p.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),p.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),p.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),L?" ...":"Google "]})})})}),I&&p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"settings-section-header",children:T("settings_cloud_sync_header")}),p.jsxs("div",{className:"settings-section-body",children:[p.jsx("button",{className:"settings-item action-item",onClick:N,disabled:Re,children:p.jsx("span",{className:"action-text",children:T(Re?"settings_syncing":"settings_sync_data")})}),p.jsx("button",{className:"settings-item action-item",onClick:D,disabled:Ze,children:p.jsx("span",{className:"action-text",children:T(Ze?"settings_loading":"settings_load_from_cloud")})}),p.jsxs("label",{className:"settings-item",children:[p.jsxs("div",{children:[p.jsx("span",{children:T("settings_auto_sync")}),p.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:T("settings_auto_sync_desc")})]}),p.jsxs("div",{className:"theme-toggle-switch",children:[p.jsx("input",{type:"checkbox",checked:Ge,onChange:Ne=>Se(Ne.target.checked)}),p.jsx("span",{className:"slider round"})]})]})]})]}),p.jsx("div",{className:"settings-section-header",children:T("settings_data_header")}),p.jsxs("div",{className:"settings-section-body",children:[p.jsx("div",{style:{fontSize:"12px",opacity:.7,marginBottom:"12px",padding:"8px",backgroundColor:"var(--bg-color-secondary)",borderRadius:"8px"},children:T("settings_data_header_desc")}),p.jsx("button",{className:"settings-item action-item",onClick:a,disabled:m!=="idle",children:p.jsx("span",{className:"action-text",children:T(m==="exporting"?"data_exporting":"settings_export_data")})}),p.jsxs("button",{className:"settings-item action-item",onClick:()=>{var Ne;return(Ne=Rt.current)==null?void 0:Ne.click()},disabled:m!=="idle",children:[p.jsx("span",{className:"action-text",children:T(m==="importing"?"data_importing":"settings_import_data")}),p.jsx("input",{type:"file",ref:Rt,onChange:l,accept:".json",style:{display:"none"}})]})]}),P.length>0&&p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"settings-section-header",children:T("settings_share_link_header")}),p.jsxs("div",{className:"settings-section-body",children:[!Fe&&p.jsx("button",{className:"settings-item action-item",onClick:fr,disabled:ke,children:p.jsx("span",{className:"action-text",children:ke?" URL  ...":T("settings_generate_link")})}),Fe&&p.jsxs("div",{className:"share-link-container",children:[p.jsxs("div",{style:{marginBottom:"8px",fontSize:"12px",opacity:.7},children:[Fe.length<100?" URL":" "," (",Fe.length,")"]}),p.jsx("input",{type:"text",readOnly:!0,value:Fe,onClick:Ne=>Ne.target.select()}),p.jsx("button",{onClick:pr,children:T("settings_copy_link")})]})]})]}),p.jsx("div",{className:"settings-section-header",children:T("settings_delete_account")}),p.jsxs("div",{className:"settings-section-body",children:[p.jsx("div",{style:{fontSize:"12px",opacity:.7,marginBottom:"12px",padding:"8px",backgroundColor:"var(--bg-color-secondary)",borderRadius:"8px"},children:I?"         .     .":"    ."}),p.jsx("button",{className:"settings-item action-item",onClick:rt,disabled:m!=="idle",children:p.jsx("span",{className:"action-text destructive",children:T(m==="deleting"?"data_deleting":"settings_delete_account")})})]})]});default:return null}};return p.jsxs(ys,{onClose:Pe,isClosing:me,className:"settings-modal",size:Bt,children:[p.jsxs("div",{className:"settings-modal-header",children:[p.jsx("div",{style:{width:"40px"}}),p.jsx("h2",{children:T("settings_title")}),p.jsx("div",{className:"settings-modal-header-right",style:{width:"40px"}})]}),p.jsxs("div",{className:"settings-modal-body",children:[p.jsx("div",{className:"settings-tabs",children:ue.map(Ne=>p.jsxs("button",{className:`settings-tab-button ${Oe===Ne.id?"active":""}`,onClick:()=>Vt(Ne.id),"aria-label":Ne.label,children:[p.jsx("div",{className:"settings-tab-icon",children:Ne.icon}),p.jsx("span",{children:Ne.label})]},Ne.id))}),p.jsx("div",{className:"settings-tab-content-container",children:p.jsx("div",{className:"settings-tab-content",children:Jn()},Oe)}),p.jsxs("div",{className:"goal-assistant-nav",style:{padding:"16px 24px",borderTop:"1px solid var(--border-color)"},children:[p.jsx("div",{style:{width:"1px"}}),p.jsx("button",{onClick:Pe,className:"primary",style:{minWidth:"120px"},children:T("settings_done_button")})]})]}),Tn&&p.jsx("div",{className:"modal-backdrop alert-backdrop",children:p.jsxs("div",{className:"modal-content alert-modal",children:[p.jsxs("div",{className:"alert-content",children:[p.jsx("h2",{children:""}),p.jsx("p",{children:Tn})]}),p.jsx("div",{className:"modal-buttons",children:p.jsx("button",{onClick:()=>Kn(null),className:"primary",children:""})})]})})]})},B6=({onClose:t,t:e})=>{const[n,r]=Co(t),i="2.0.0 (25.10.24)",s=[{icon:"",title:" ",desc:"Step-by-step  . , (), (),  , ,  "},{icon:"",title:" / ",desc:" ,        "},{icon:"",title:"WOOP  ",desc:"5  (Wish  Outcome  Obstacle  Plan  /)   "},{icon:"",title:"AI  ",desc:"Gemini API     AI   "},{icon:"",title:"Google ",desc:"Google OAuth      "},{icon:"",title:"Firebase  ",desc:", ,     Firebase Firestore  "},{icon:"",title:"  ",desc:"       "},{icon:"",title:"  & ",desc:"//     8   "},{icon:"",title:"PWA & ",desc:" PWA   ,  ,   "},{icon:"",title:" ",desc:"3//      "},{icon:"",title:" /",desc:"JSON       "},{icon:"",title:" ",desc:",     "}];return p.jsxs(ys,{onClose:r,isClosing:n,className:"version-info-modal",children:[p.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%",overflow:"hidden"},children:[p.jsxs("div",{className:"version-info-header",style:{flexShrink:0,paddingBottom:"16px",borderBottom:"1px solid var(--border-color)"},children:[p.jsx("h2",{children:" Nova AI Planner v2.0"}),p.jsxs("p",{children:[e("build_number"),": ",i]})]}),p.jsx("div",{className:"version-info-body",children:s.map((o,a)=>p.jsxs("div",{className:"changelog-item",children:[p.jsx("div",{className:"changelog-icon",style:{"--icon-bg":"var(--primary-color)"},children:o.icon}),p.jsxs("div",{className:"changelog-text",children:[p.jsx("h3",{children:o.title}),p.jsx("p",{children:o.desc})]})]},a))})]}),p.jsx("div",{className:"modal-buttons",children:p.jsx("button",{onClick:r,className:"primary",children:e("settings_done_button")})})]})},G6=({onClose:t,t:e})=>{const[n,r]=Co(t),i=o=>{const a=/(https?:\/\/[^\s]+)/g;return o.split(a).map((u,f)=>a.test(u)?p.jsx("a",{href:u,target:"_blank",rel:"noopener noreferrer",className:"guide-link",children:u},f):u)},s=[{titleKey:"usage_basic_title",descKey:"usage_basic_desc"},{titleKey:"usage_ai_setup_title",descKey:"usage_ai_setup_desc"},{titleKey:"usage_ai_use_title",descKey:"usage_ai_use_desc"},{titleKey:"usage_share_title",descKey:"usage_share_desc"},{titleKey:"usage_theme_title",descKey:"usage_theme_desc"},{titleKey:"usage_calendar_title",descKey:"usage_calendar_desc"},{titleKey:"usage_offline_title",descKey:"usage_offline_desc"}];return p.jsxs(ys,{onClose:r,isClosing:n,className:"usage-guide-modal",children:[p.jsx("div",{className:"version-info-header",children:p.jsx("h2",{children:e("usage_guide_title")})}),p.jsx("div",{className:"version-info-body",children:s.map((o,a)=>p.jsxs("div",{className:"usage-guide-item",children:[p.jsx("h3",{children:e(o.titleKey)}),p.jsx("p",{children:o.titleKey==="usage_ai_setup_title"?i(e(o.descKey)):e(o.descKey)})]},a))}),p.jsx("div",{className:"modal-buttons",children:p.jsx("button",{onClick:r,className:"primary",children:e("settings_done_button")})})]})},q6=({todos:t,t:e,onGoalClick:n,language:r})=>{const[i,s]=O.useState(new Date),[o,a]=O.useState("week"),l=g=>{const v=new Date(i);o==="month"?v.setMonth(v.getMonth()+g):o==="week"?v.setDate(v.getDate()+g*7):v.setDate(v.getDate()+g*3),s(v)},u=O.useMemo(()=>{const g=[];let v,T;if(o==="month"){const P=new Date(i.getFullYear(),i.getMonth(),1);v=Yw(P,r==="ko"?1:0),T=42}else o==="week"?(v=Yw(i,r==="ko"?1:0),T=7):(v=new Date(i),v.setDate(v.getDate()-1),T=3);for(let P=0;P<T;P++){const M=new Date(v);M.setDate(M.getDate()+P),g.push(M)}return g},[i,o,r]),f=O.useMemo(()=>{if(o==="month"){const g=i.getFullYear(),v=e("month_names")[i.getMonth()],T=e("calendar_header_month_format");return T&&typeof T=="string"&&T!=="calendar_header_month_format"?T.replace("{year}",String(g)).replace("{month}",v):`${v} ${g}`}return`${i.getFullYear()}.${i.getMonth()+1}`},[i,o,e]),m=O.useMemo(()=>{const g=e("day_names_short");if(r==="ko"&&Array.isArray(g)){const[v,...T]=g;return[...T,v]}return g},[r,e]);return p.jsxs("div",{className:"calendar-view-container",children:[p.jsxs("div",{className:"calendar-header",children:[p.jsx("button",{onClick:()=>l(-1),children:xe.back}),p.jsx("h2",{children:f}),p.jsx("button",{onClick:()=>l(1),children:xe.forward})]}),p.jsxs("div",{className:"calendar-view-mode-selector",children:[p.jsx("button",{onClick:()=>a("day3"),className:o==="day3"?"active":"",children:e("calendar_view_day3")}),p.jsx("button",{onClick:()=>a("week"),className:o==="week"?"active":"",children:e("calendar_view_week")}),p.jsx("button",{onClick:()=>a("month"),className:`calendar-view-button-month ${o==="month"?"active":""}`,children:e("calendar_view_month")})]}),(o==="week"||o==="month")&&p.jsx("div",{className:"calendar-days-of-week",children:Array.isArray(m)&&m.map(g=>p.jsx("div",{children:g},g))}),p.jsx("div",{className:`calendar-grid view-mode-${o}`,children:u.map(g=>{const T=lu(g,new Date),P=g.getMonth()===i.getMonth(),M=t.filter(x=>{if(x.isRecurring){const E=(g.getDay()+6)%7;return x.recurringDays.includes(E)}return x.deadline&&lu(g,x.deadline)});return p.jsxs("div",{className:`calendar-day ${!P&&o==="month"?"not-current-month":""} ${T?"is-today":""}`,"data-day-name":e("day_names_long")[g.getDay()],children:[p.jsx("div",{className:"day-header",children:p.jsx("span",{className:"day-number",children:g.getDate()})}),p.jsx("div",{className:"calendar-goals",children:M.map(x=>p.jsx("div",{className:`calendar-goal-item ${x.completed&&x.lastCompletedDate&&lu(g,x.lastCompletedDate)?"completed":""}`,onClick:()=>n(x),children:x.title||x.wish},x.id))})]},g.toISOString())})})]})},z6=({todo:t,onClose:e,onSave:n,t:r})=>{const[i,s]=Co(e),[o,a]=O.useState(t.title||""),[l,u]=O.useState(t.deadline||""),[f,m]=O.useState(t.isRecurring||!1),[g,v]=O.useState(t.recurringDays||[]),[T,P]=O.useState(!t.deadline),M=()=>{const E={...t,title:o.trim(),deadline:T?"":l,isRecurring:f,recurringDays:g};n(E),s()},x=E=>{v(A=>A.includes(E)?A.filter(V=>V!==E):[...A,E].sort())};return p.jsxs(ys,{onClose:s,isClosing:i,className:"goal-assistant-modal",children:[p.jsxs("div",{className:"modal-header",children:[p.jsx("h2",{children:r("edit_todo_title")}),p.jsx("button",{onClick:s,className:"close-button","aria-label":r("close_button"),children:""})]}),p.jsxs("div",{className:"goal-assistant-body",children:[p.jsxs("div",{style:{padding:"24px 16px",flex:1,overflowY:"auto"},children:[p.jsxs("div",{style:{marginBottom:"20px"},children:[p.jsx("div",{className:"step-guidance",children:p.jsx("p",{className:"tip",children:r("todo_title_label")})}),p.jsx("textarea",{value:o,onChange:E=>a(E.target.value),placeholder:r("todo_title_placeholder"),rows:2,style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontSize:"14px",fontFamily:"inherit",resize:"none",marginTop:"12px"},autoFocus:!0})]}),p.jsx("hr",{}),p.jsxs("div",{style:{marginBottom:"20px"},children:[p.jsx("div",{className:"step-guidance",style:{marginTop:"16px"},children:p.jsxs("p",{className:"tip",children:[r("deadline_label")," ()"]})}),p.jsxs("label",{className:"settings-item standalone-toggle",style:{marginTop:"12px"},children:[p.jsx("span",{style:{fontWeight:"500"},children:" "}),p.jsxs("label",{className:"theme-toggle-switch",children:[p.jsx("input",{type:"checkbox",checked:!T,onChange:E=>{P(!E.target.checked),E.target.checked&&!l&&u(new Date().toISOString().split("T")[0])}}),p.jsx("span",{className:"slider round"})]})]}),!T&&p.jsx("div",{style:{marginTop:"12px"},children:p.jsx("input",{type:"date",value:l,onChange:E=>u(E.target.value),style:{width:"100%",padding:"10px",borderRadius:"6px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontSize:"13px"}})})]}),p.jsx("hr",{}),p.jsxs("div",{style:{marginBottom:"20px"},children:[p.jsx("div",{className:"step-guidance",style:{marginTop:"16px"},children:p.jsx("p",{className:"tip",children:r("recurring_label")})}),p.jsxs("label",{className:"settings-item standalone-toggle",style:{marginTop:"12px"},children:[p.jsx("span",{style:{fontWeight:"500"},children:" "}),p.jsxs("label",{className:"theme-toggle-switch",children:[p.jsx("input",{type:"checkbox",checked:f,onChange:E=>m(E.target.checked)}),p.jsx("span",{className:"slider round"})]})]}),f&&p.jsxs("div",{style:{marginTop:"12px"},children:[p.jsx("label",{style:{fontSize:"12px",opacity:.7,display:"block",marginBottom:"8px"},children:r("recurring_days_label")}),p.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:"8px"},children:["","","","","","",""].map((E,A)=>p.jsx("button",{type:"button",onClick:()=>x(A),style:{padding:"8px 4px",borderRadius:"6px",border:g.includes(A)?"2px solid var(--primary-color)":"2px solid var(--border-color)",backgroundColor:g.includes(A)?"var(--primary-color)":"transparent",color:g.includes(A)?"white":"var(--text-color)",fontSize:"12px",fontWeight:"500",cursor:"pointer",transition:"all 0.2s ease"},children:E},A))})]})]})]}),p.jsxs("div",{className:"goal-assistant-nav",children:[p.jsx("button",{onClick:s,className:"secondary",children:r("cancel_button")}),p.jsx("button",{onClick:M,className:"primary",disabled:!o.trim(),children:r("save_button")})]})]})]})},$6=({title:t,message:e,onConfirm:n,onCancel:r,confirmText:i,cancelText:s,isDestructive:o,t:a})=>{const l=typeof r=="function";return p.jsx("div",{className:"modal-backdrop alert-backdrop",children:p.jsxs("div",{className:"modal-content alert-modal",children:[p.jsxs("div",{className:"alert-content",children:[p.jsx("h2",{children:t}),p.jsx("p",{dangerouslySetInnerHTML:{__html:e}})]}),p.jsxs("div",{className:"modal-buttons",children:[l&&p.jsx("button",{onClick:r,className:"secondary",children:s||a("cancel_button")}),p.jsx("button",{onClick:n,className:o?"destructive":"primary",children:i||a("confirm_button")})]})]})})},H6=Np.createRoot(document.getElementById("root"));H6.render(p.jsx(cI.StrictMode,{children:p.jsx(P6,{})}));
