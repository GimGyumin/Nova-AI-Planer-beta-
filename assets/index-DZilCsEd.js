(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();function XI(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var ZI={exports:{}},kh={},ew={exports:{}},ke={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qu=Symbol.for("react.element"),iR=Symbol.for("react.portal"),sR=Symbol.for("react.fragment"),oR=Symbol.for("react.strict_mode"),aR=Symbol.for("react.profiler"),lR=Symbol.for("react.provider"),uR=Symbol.for("react.context"),cR=Symbol.for("react.forward_ref"),dR=Symbol.for("react.suspense"),hR=Symbol.for("react.memo"),fR=Symbol.for("react.lazy"),Ey=Symbol.iterator;function pR(t){return t===null||typeof t!="object"?null:(t=Ey&&t[Ey]||t["@@iterator"],typeof t=="function"?t:null)}var tw={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},nw=Object.assign,rw={};function $a(t,e,n){this.props=t,this.context=e,this.refs=rw,this.updater=n||tw}$a.prototype.isReactComponent={};$a.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};$a.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function iw(){}iw.prototype=$a.prototype;function hg(t,e,n){this.props=t,this.context=e,this.refs=rw,this.updater=n||tw}var fg=hg.prototype=new iw;fg.constructor=hg;nw(fg,$a.prototype);fg.isPureReactComponent=!0;var Iy=Array.isArray,sw=Object.prototype.hasOwnProperty,pg={current:null},ow={key:!0,ref:!0,__self:!0,__source:!0};function aw(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)sw.call(e,r)&&!ow.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];i.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:qu,type:t,key:s,ref:o,props:i,_owner:pg.current}}function mR(t,e){return{$$typeof:qu,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function mg(t){return typeof t=="object"&&t!==null&&t.$$typeof===qu}function gR(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var wy=/\/+/g;function Uf(t,e){return typeof t=="object"&&t!==null&&t.key!=null?gR(""+t.key):e.toString(36)}function nd(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case qu:case iR:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+Uf(o,0):r,Iy(i)?(n="",t!=null&&(n=t.replace(wy,"$&/")+"/"),nd(i,e,n,"",function(u){return u})):i!=null&&(mg(i)&&(i=mR(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(wy,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",Iy(t))for(var a=0;a<t.length;a++){s=t[a];var l=r+Uf(s,a);o+=nd(s,e,n,l,i)}else if(l=pR(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=r+Uf(s,a++),o+=nd(s,e,n,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Nc(t,e,n){if(t==null)return t;var r=[],i=0;return nd(t,r,"","",function(s){return e.call(n,s,i++)}),r}function _R(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var ln={current:null},rd={transition:null},yR={ReactCurrentDispatcher:ln,ReactCurrentBatchConfig:rd,ReactCurrentOwner:pg};function lw(){throw Error("act(...) is not supported in production builds of React.")}ke.Children={map:Nc,forEach:function(t,e,n){Nc(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Nc(t,function(){e++}),e},toArray:function(t){return Nc(t,function(e){return e})||[]},only:function(t){if(!mg(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ke.Component=$a;ke.Fragment=sR;ke.Profiler=aR;ke.PureComponent=hg;ke.StrictMode=oR;ke.Suspense=dR;ke.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=yR;ke.act=lw;ke.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=nw({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=pg.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)sw.call(e,l)&&!ow.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];r.children=a}return{$$typeof:qu,type:t.type,key:i,ref:s,props:r,_owner:o}};ke.createContext=function(t){return t={$$typeof:uR,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:lR,_context:t},t.Consumer=t};ke.createElement=aw;ke.createFactory=function(t){var e=aw.bind(null,t);return e.type=t,e};ke.createRef=function(){return{current:null}};ke.forwardRef=function(t){return{$$typeof:cR,render:t}};ke.isValidElement=mg;ke.lazy=function(t){return{$$typeof:fR,_payload:{_status:-1,_result:t},_init:_R}};ke.memo=function(t,e){return{$$typeof:hR,type:t,compare:e===void 0?null:e}};ke.startTransition=function(t){var e=rd.transition;rd.transition={};try{t()}finally{rd.transition=e}};ke.unstable_act=lw;ke.useCallback=function(t,e){return ln.current.useCallback(t,e)};ke.useContext=function(t){return ln.current.useContext(t)};ke.useDebugValue=function(){};ke.useDeferredValue=function(t){return ln.current.useDeferredValue(t)};ke.useEffect=function(t,e){return ln.current.useEffect(t,e)};ke.useId=function(){return ln.current.useId()};ke.useImperativeHandle=function(t,e,n){return ln.current.useImperativeHandle(t,e,n)};ke.useInsertionEffect=function(t,e){return ln.current.useInsertionEffect(t,e)};ke.useLayoutEffect=function(t,e){return ln.current.useLayoutEffect(t,e)};ke.useMemo=function(t,e){return ln.current.useMemo(t,e)};ke.useReducer=function(t,e,n){return ln.current.useReducer(t,e,n)};ke.useRef=function(t){return ln.current.useRef(t)};ke.useState=function(t){return ln.current.useState(t)};ke.useSyncExternalStore=function(t,e,n){return ln.current.useSyncExternalStore(t,e,n)};ke.useTransition=function(){return ln.current.useTransition()};ke.version="18.3.1";ew.exports=ke;var z=ew.exports;const uw=XI(z);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vR=z,TR=Symbol.for("react.element"),ER=Symbol.for("react.fragment"),IR=Object.prototype.hasOwnProperty,wR=vR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,SR={key:!0,ref:!0,__self:!0,__source:!0};function cw(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)IR.call(e,r)&&!SR.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:TR,type:t,key:s,ref:o,props:i,_owner:wR.current}}kh.Fragment=ER;kh.jsx=cw;kh.jsxs=cw;ZI.exports=kh;var m=ZI.exports,Ap={},dw={exports:{}},Rn={},hw={exports:{}},fw={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(Z,fe){var ve=Z.length;Z.push(fe);e:for(;0<ve;){var Ee=ve-1>>>1,Oe=Z[Ee];if(0<i(Oe,fe))Z[Ee]=fe,Z[ve]=Oe,ve=Ee;else break e}}function n(Z){return Z.length===0?null:Z[0]}function r(Z){if(Z.length===0)return null;var fe=Z[0],ve=Z.pop();if(ve!==fe){Z[0]=ve;e:for(var Ee=0,Oe=Z.length,rt=Oe>>>1;Ee<rt;){var Je=2*(Ee+1)-1,Ae=Z[Je],Qe=Je+1,zt=Z[Qe];if(0>i(Ae,ve))Qe<Oe&&0>i(zt,Ae)?(Z[Ee]=zt,Z[Qe]=ve,Ee=Qe):(Z[Ee]=Ae,Z[Je]=ve,Ee=Je);else if(Qe<Oe&&0>i(zt,ve))Z[Ee]=zt,Z[Qe]=ve,Ee=Qe;else break e}}return fe}function i(Z,fe){var ve=Z.sortIndex-fe.sortIndex;return ve!==0?ve:Z.id-fe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],u=[],f=1,p=null,g=3,v=!1,E=!1,R=!1,M=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,I=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function C(Z){for(var fe=n(u);fe!==null;){if(fe.callback===null)r(u);else if(fe.startTime<=Z)r(u),fe.sortIndex=fe.expirationTime,e(l,fe);else break;fe=n(u)}}function V(Z){if(R=!1,C(Z),!E)if(n(l)!==null)E=!0,je(F);else{var fe=n(u);fe!==null&&ye(V,fe.startTime-Z)}}function F(Z,fe){E=!1,R&&(R=!1,A(w),w=-1),v=!0;var ve=g;try{for(C(fe),p=n(l);p!==null&&(!(p.expirationTime>fe)||Z&&!D());){var Ee=p.callback;if(typeof Ee=="function"){p.callback=null,g=p.priorityLevel;var Oe=Ee(p.expirationTime<=fe);fe=t.unstable_now(),typeof Oe=="function"?p.callback=Oe:p===n(l)&&r(l),C(fe)}else r(l);p=n(l)}if(p!==null)var rt=!0;else{var Je=n(u);Je!==null&&ye(V,Je.startTime-fe),rt=!1}return rt}finally{p=null,g=ve,v=!1}}var B=!1,T=null,w=-1,x=5,k=-1;function D(){return!(t.unstable_now()-k<x)}function L(){if(T!==null){var Z=t.unstable_now();k=Z;var fe=!0;try{fe=T(!0,Z)}finally{fe?N():(B=!1,T=null)}}else B=!1}var N;if(typeof I=="function")N=function(){I(L)};else if(typeof MessageChannel<"u"){var Me=new MessageChannel,et=Me.port2;Me.port1.onmessage=L,N=function(){et.postMessage(null)}}else N=function(){M(L,0)};function je(Z){T=Z,B||(B=!0,N())}function ye(Z,fe){w=M(function(){Z(t.unstable_now())},fe)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Z){Z.callback=null},t.unstable_continueExecution=function(){E||v||(E=!0,je(F))},t.unstable_forceFrameRate=function(Z){0>Z||125<Z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):x=0<Z?Math.floor(1e3/Z):5},t.unstable_getCurrentPriorityLevel=function(){return g},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(Z){switch(g){case 1:case 2:case 3:var fe=3;break;default:fe=g}var ve=g;g=fe;try{return Z()}finally{g=ve}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Z,fe){switch(Z){case 1:case 2:case 3:case 4:case 5:break;default:Z=3}var ve=g;g=Z;try{return fe()}finally{g=ve}},t.unstable_scheduleCallback=function(Z,fe,ve){var Ee=t.unstable_now();switch(typeof ve=="object"&&ve!==null?(ve=ve.delay,ve=typeof ve=="number"&&0<ve?Ee+ve:Ee):ve=Ee,Z){case 1:var Oe=-1;break;case 2:Oe=250;break;case 5:Oe=1073741823;break;case 4:Oe=1e4;break;default:Oe=5e3}return Oe=ve+Oe,Z={id:f++,callback:fe,priorityLevel:Z,startTime:ve,expirationTime:Oe,sortIndex:-1},ve>Ee?(Z.sortIndex=ve,e(u,Z),n(l)===null&&Z===n(u)&&(R?(A(w),w=-1):R=!0,ye(V,ve-Ee))):(Z.sortIndex=Oe,e(l,Z),E||v||(E=!0,je(F))),Z},t.unstable_shouldYield=D,t.unstable_wrapCallback=function(Z){var fe=g;return function(){var ve=g;g=fe;try{return Z.apply(this,arguments)}finally{g=ve}}}})(fw);hw.exports=fw;var CR=hw.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var AR=z,An=CR;function te(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var pw=new Set,cu={};function vo(t,e){Ea(t,e),Ea(t+"Capture",e)}function Ea(t,e){for(cu[t]=e,t=0;t<e.length;t++)pw.add(e[t])}var Jr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),xp=Object.prototype.hasOwnProperty,xR=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Sy={},Cy={};function RR(t){return xp.call(Cy,t)?!0:xp.call(Sy,t)?!1:xR.test(t)?Cy[t]=!0:(Sy[t]=!0,!1)}function PR(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function kR(t,e,n,r){if(e===null||typeof e>"u"||PR(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function un(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Gt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Gt[t]=new un(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Gt[e]=new un(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Gt[t]=new un(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Gt[t]=new un(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Gt[t]=new un(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Gt[t]=new un(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Gt[t]=new un(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Gt[t]=new un(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Gt[t]=new un(t,5,!1,t.toLowerCase(),null,!1,!1)});var gg=/[\-:]([a-z])/g;function _g(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(gg,_g);Gt[e]=new un(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(gg,_g);Gt[e]=new un(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(gg,_g);Gt[e]=new un(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Gt[t]=new un(t,1,!1,t.toLowerCase(),null,!1,!1)});Gt.xlinkHref=new un("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Gt[t]=new un(t,1,!1,t.toLowerCase(),null,!0,!0)});function yg(t,e,n,r){var i=Gt.hasOwnProperty(e)?Gt[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(kR(e,n,i,r)&&(n=null),r||i===null?RR(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var ri=AR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Dc=Symbol.for("react.element"),jo=Symbol.for("react.portal"),Jo=Symbol.for("react.fragment"),vg=Symbol.for("react.strict_mode"),Rp=Symbol.for("react.profiler"),mw=Symbol.for("react.provider"),gw=Symbol.for("react.context"),Tg=Symbol.for("react.forward_ref"),Pp=Symbol.for("react.suspense"),kp=Symbol.for("react.suspense_list"),Eg=Symbol.for("react.memo"),Ci=Symbol.for("react.lazy"),_w=Symbol.for("react.offscreen"),Ay=Symbol.iterator;function _l(t){return t===null||typeof t!="object"?null:(t=Ay&&t[Ay]||t["@@iterator"],typeof t=="function"?t:null)}var gt=Object.assign,Of;function Dl(t){if(Of===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Of=e&&e[1]||""}return`
`+Of+t}var Bf=!1;function qf(t,e){if(!t||Bf)return"";Bf=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{Bf=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Dl(t):""}function NR(t){switch(t.tag){case 5:return Dl(t.type);case 16:return Dl("Lazy");case 13:return Dl("Suspense");case 19:return Dl("SuspenseList");case 0:case 2:case 15:return t=qf(t.type,!1),t;case 11:return t=qf(t.type.render,!1),t;case 1:return t=qf(t.type,!0),t;default:return""}}function Np(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Jo:return"Fragment";case jo:return"Portal";case Rp:return"Profiler";case vg:return"StrictMode";case Pp:return"Suspense";case kp:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case gw:return(t.displayName||"Context")+".Consumer";case mw:return(t._context.displayName||"Context")+".Provider";case Tg:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Eg:return e=t.displayName||null,e!==null?e:Np(t.type)||"Memo";case Ci:e=t._payload,t=t._init;try{return Np(t(e))}catch{}}return null}function DR(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Np(e);case 8:return e===vg?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Yi(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function yw(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function bR(t){var e=yw(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function bc(t){t._valueTracker||(t._valueTracker=bR(t))}function vw(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=yw(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Nd(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Dp(t,e){var n=e.checked;return gt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function xy(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Yi(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Tw(t,e){e=e.checked,e!=null&&yg(t,"checked",e,!1)}function bp(t,e){Tw(t,e);var n=Yi(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Mp(t,e.type,n):e.hasOwnProperty("defaultValue")&&Mp(t,e.type,Yi(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Ry(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Mp(t,e,n){(e!=="number"||Nd(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var bl=Array.isArray;function la(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Yi(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Vp(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(te(91));return gt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Py(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(te(92));if(bl(n)){if(1<n.length)throw Error(te(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Yi(n)}}function Ew(t,e){var n=Yi(e.value),r=Yi(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function ky(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Iw(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Lp(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Iw(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Mc,ww=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Mc=Mc||document.createElement("div"),Mc.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Mc.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function du(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Gl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},MR=["Webkit","ms","Moz","O"];Object.keys(Gl).forEach(function(t){MR.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Gl[e]=Gl[t]})});function Sw(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Gl.hasOwnProperty(t)&&Gl[t]?(""+e).trim():e+"px"}function Cw(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=Sw(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var VR=gt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Fp(t,e){if(e){if(VR[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(te(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(te(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(te(61))}if(e.style!=null&&typeof e.style!="object")throw Error(te(62))}}function Up(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Op=null;function Ig(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Bp=null,ua=null,ca=null;function Ny(t){if(t=$u(t)){if(typeof Bp!="function")throw Error(te(280));var e=t.stateNode;e&&(e=Vh(e),Bp(t.stateNode,t.type,e))}}function Aw(t){ua?ca?ca.push(t):ca=[t]:ua=t}function xw(){if(ua){var t=ua,e=ca;if(ca=ua=null,Ny(t),e)for(t=0;t<e.length;t++)Ny(e[t])}}function Rw(t,e){return t(e)}function Pw(){}var Gf=!1;function kw(t,e,n){if(Gf)return t(e,n);Gf=!0;try{return Rw(t,e,n)}finally{Gf=!1,(ua!==null||ca!==null)&&(Pw(),xw())}}function hu(t,e){var n=t.stateNode;if(n===null)return null;var r=Vh(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(te(231,e,typeof n));return n}var qp=!1;if(Jr)try{var yl={};Object.defineProperty(yl,"passive",{get:function(){qp=!0}}),window.addEventListener("test",yl,yl),window.removeEventListener("test",yl,yl)}catch{qp=!1}function LR(t,e,n,r,i,s,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(f){this.onError(f)}}var zl=!1,Dd=null,bd=!1,Gp=null,FR={onError:function(t){zl=!0,Dd=t}};function UR(t,e,n,r,i,s,o,a,l){zl=!1,Dd=null,LR.apply(FR,arguments)}function OR(t,e,n,r,i,s,o,a,l){if(UR.apply(this,arguments),zl){if(zl){var u=Dd;zl=!1,Dd=null}else throw Error(te(198));bd||(bd=!0,Gp=u)}}function To(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Nw(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Dy(t){if(To(t)!==t)throw Error(te(188))}function BR(t){var e=t.alternate;if(!e){if(e=To(t),e===null)throw Error(te(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return Dy(i),t;if(s===r)return Dy(i),e;s=s.sibling}throw Error(te(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(te(189))}}if(n.alternate!==r)throw Error(te(190))}if(n.tag!==3)throw Error(te(188));return n.stateNode.current===n?t:e}function Dw(t){return t=BR(t),t!==null?bw(t):null}function bw(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=bw(t);if(e!==null)return e;t=t.sibling}return null}var Mw=An.unstable_scheduleCallback,by=An.unstable_cancelCallback,qR=An.unstable_shouldYield,GR=An.unstable_requestPaint,Tt=An.unstable_now,zR=An.unstable_getCurrentPriorityLevel,wg=An.unstable_ImmediatePriority,Vw=An.unstable_UserBlockingPriority,Md=An.unstable_NormalPriority,$R=An.unstable_LowPriority,Lw=An.unstable_IdlePriority,Nh=null,Rr=null;function HR(t){if(Rr&&typeof Rr.onCommitFiberRoot=="function")try{Rr.onCommitFiberRoot(Nh,t,void 0,(t.current.flags&128)===128)}catch{}}var sr=Math.clz32?Math.clz32:jR,WR=Math.log,KR=Math.LN2;function jR(t){return t>>>=0,t===0?32:31-(WR(t)/KR|0)|0}var Vc=64,Lc=4194304;function Ml(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Vd(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=Ml(a):(s&=o,s!==0&&(r=Ml(s)))}else o=n&~i,o!==0?r=Ml(o):s!==0&&(r=Ml(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-sr(e),i=1<<n,r|=t[n],e&=~i;return r}function JR(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function QR(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-sr(s),a=1<<o,l=i[o];l===-1?(!(a&n)||a&r)&&(i[o]=JR(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function zp(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Fw(){var t=Vc;return Vc<<=1,!(Vc&4194240)&&(Vc=64),t}function zf(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Gu(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-sr(e),t[e]=n}function YR(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-sr(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function Sg(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-sr(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var We=0;function Uw(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Ow,Cg,Bw,qw,Gw,$p=!1,Fc=[],Li=null,Fi=null,Ui=null,fu=new Map,pu=new Map,xi=[],XR="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function My(t,e){switch(t){case"focusin":case"focusout":Li=null;break;case"dragenter":case"dragleave":Fi=null;break;case"mouseover":case"mouseout":Ui=null;break;case"pointerover":case"pointerout":fu.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":pu.delete(e.pointerId)}}function vl(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=$u(e),e!==null&&Cg(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function ZR(t,e,n,r,i){switch(e){case"focusin":return Li=vl(Li,t,e,n,r,i),!0;case"dragenter":return Fi=vl(Fi,t,e,n,r,i),!0;case"mouseover":return Ui=vl(Ui,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return fu.set(s,vl(fu.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,pu.set(s,vl(pu.get(s)||null,t,e,n,r,i)),!0}return!1}function zw(t){var e=Ws(t.target);if(e!==null){var n=To(e);if(n!==null){if(e=n.tag,e===13){if(e=Nw(n),e!==null){t.blockedOn=e,Gw(t.priority,function(){Bw(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function id(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Hp(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Op=r,n.target.dispatchEvent(r),Op=null}else return e=$u(n),e!==null&&Cg(e),t.blockedOn=n,!1;e.shift()}return!0}function Vy(t,e,n){id(t)&&n.delete(e)}function eP(){$p=!1,Li!==null&&id(Li)&&(Li=null),Fi!==null&&id(Fi)&&(Fi=null),Ui!==null&&id(Ui)&&(Ui=null),fu.forEach(Vy),pu.forEach(Vy)}function Tl(t,e){t.blockedOn===e&&(t.blockedOn=null,$p||($p=!0,An.unstable_scheduleCallback(An.unstable_NormalPriority,eP)))}function mu(t){function e(i){return Tl(i,t)}if(0<Fc.length){Tl(Fc[0],t);for(var n=1;n<Fc.length;n++){var r=Fc[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Li!==null&&Tl(Li,t),Fi!==null&&Tl(Fi,t),Ui!==null&&Tl(Ui,t),fu.forEach(e),pu.forEach(e),n=0;n<xi.length;n++)r=xi[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<xi.length&&(n=xi[0],n.blockedOn===null);)zw(n),n.blockedOn===null&&xi.shift()}var da=ri.ReactCurrentBatchConfig,Ld=!0;function tP(t,e,n,r){var i=We,s=da.transition;da.transition=null;try{We=1,Ag(t,e,n,r)}finally{We=i,da.transition=s}}function nP(t,e,n,r){var i=We,s=da.transition;da.transition=null;try{We=4,Ag(t,e,n,r)}finally{We=i,da.transition=s}}function Ag(t,e,n,r){if(Ld){var i=Hp(t,e,n,r);if(i===null)Zf(t,e,r,Fd,n),My(t,r);else if(ZR(i,t,e,n,r))r.stopPropagation();else if(My(t,r),e&4&&-1<XR.indexOf(t)){for(;i!==null;){var s=$u(i);if(s!==null&&Ow(s),s=Hp(t,e,n,r),s===null&&Zf(t,e,r,Fd,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else Zf(t,e,r,null,n)}}var Fd=null;function Hp(t,e,n,r){if(Fd=null,t=Ig(r),t=Ws(t),t!==null)if(e=To(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Nw(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Fd=t,null}function $w(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(zR()){case wg:return 1;case Vw:return 4;case Md:case $R:return 16;case Lw:return 536870912;default:return 16}default:return 16}}var bi=null,xg=null,sd=null;function Hw(){if(sd)return sd;var t,e=xg,n=e.length,r,i="value"in bi?bi.value:bi.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return sd=i.slice(t,1<r?1-r:void 0)}function od(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Uc(){return!0}function Ly(){return!1}function Pn(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Uc:Ly,this.isPropagationStopped=Ly,this}return gt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Uc)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Uc)},persist:function(){},isPersistent:Uc}),e}var Ha={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Rg=Pn(Ha),zu=gt({},Ha,{view:0,detail:0}),rP=Pn(zu),$f,Hf,El,Dh=gt({},zu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Pg,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==El&&(El&&t.type==="mousemove"?($f=t.screenX-El.screenX,Hf=t.screenY-El.screenY):Hf=$f=0,El=t),$f)},movementY:function(t){return"movementY"in t?t.movementY:Hf}}),Fy=Pn(Dh),iP=gt({},Dh,{dataTransfer:0}),sP=Pn(iP),oP=gt({},zu,{relatedTarget:0}),Wf=Pn(oP),aP=gt({},Ha,{animationName:0,elapsedTime:0,pseudoElement:0}),lP=Pn(aP),uP=gt({},Ha,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),cP=Pn(uP),dP=gt({},Ha,{data:0}),Uy=Pn(dP),hP={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fP={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},pP={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function mP(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=pP[t])?!!e[t]:!1}function Pg(){return mP}var gP=gt({},zu,{key:function(t){if(t.key){var e=hP[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=od(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?fP[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Pg,charCode:function(t){return t.type==="keypress"?od(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?od(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),_P=Pn(gP),yP=gt({},Dh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Oy=Pn(yP),vP=gt({},zu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Pg}),TP=Pn(vP),EP=gt({},Ha,{propertyName:0,elapsedTime:0,pseudoElement:0}),IP=Pn(EP),wP=gt({},Dh,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),SP=Pn(wP),CP=[9,13,27,32],kg=Jr&&"CompositionEvent"in window,$l=null;Jr&&"documentMode"in document&&($l=document.documentMode);var AP=Jr&&"TextEvent"in window&&!$l,Ww=Jr&&(!kg||$l&&8<$l&&11>=$l),By=" ",qy=!1;function Kw(t,e){switch(t){case"keyup":return CP.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function jw(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Qo=!1;function xP(t,e){switch(t){case"compositionend":return jw(e);case"keypress":return e.which!==32?null:(qy=!0,By);case"textInput":return t=e.data,t===By&&qy?null:t;default:return null}}function RP(t,e){if(Qo)return t==="compositionend"||!kg&&Kw(t,e)?(t=Hw(),sd=xg=bi=null,Qo=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Ww&&e.locale!=="ko"?null:e.data;default:return null}}var PP={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Gy(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!PP[t.type]:e==="textarea"}function Jw(t,e,n,r){Aw(r),e=Ud(e,"onChange"),0<e.length&&(n=new Rg("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Hl=null,gu=null;function kP(t){oS(t,0)}function bh(t){var e=Zo(t);if(vw(e))return t}function NP(t,e){if(t==="change")return e}var Qw=!1;if(Jr){var Kf;if(Jr){var jf="oninput"in document;if(!jf){var zy=document.createElement("div");zy.setAttribute("oninput","return;"),jf=typeof zy.oninput=="function"}Kf=jf}else Kf=!1;Qw=Kf&&(!document.documentMode||9<document.documentMode)}function $y(){Hl&&(Hl.detachEvent("onpropertychange",Yw),gu=Hl=null)}function Yw(t){if(t.propertyName==="value"&&bh(gu)){var e=[];Jw(e,gu,t,Ig(t)),kw(kP,e)}}function DP(t,e,n){t==="focusin"?($y(),Hl=e,gu=n,Hl.attachEvent("onpropertychange",Yw)):t==="focusout"&&$y()}function bP(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return bh(gu)}function MP(t,e){if(t==="click")return bh(e)}function VP(t,e){if(t==="input"||t==="change")return bh(e)}function LP(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var cr=typeof Object.is=="function"?Object.is:LP;function _u(t,e){if(cr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!xp.call(e,i)||!cr(t[i],e[i]))return!1}return!0}function Hy(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Wy(t,e){var n=Hy(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Hy(n)}}function Xw(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Xw(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Zw(){for(var t=window,e=Nd();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Nd(t.document)}return e}function Ng(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function FP(t){var e=Zw(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Xw(n.ownerDocument.documentElement,n)){if(r!==null&&Ng(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=Wy(n,s);var o=Wy(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var UP=Jr&&"documentMode"in document&&11>=document.documentMode,Yo=null,Wp=null,Wl=null,Kp=!1;function Ky(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Kp||Yo==null||Yo!==Nd(r)||(r=Yo,"selectionStart"in r&&Ng(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Wl&&_u(Wl,r)||(Wl=r,r=Ud(Wp,"onSelect"),0<r.length&&(e=new Rg("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Yo)))}function Oc(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Xo={animationend:Oc("Animation","AnimationEnd"),animationiteration:Oc("Animation","AnimationIteration"),animationstart:Oc("Animation","AnimationStart"),transitionend:Oc("Transition","TransitionEnd")},Jf={},eS={};Jr&&(eS=document.createElement("div").style,"AnimationEvent"in window||(delete Xo.animationend.animation,delete Xo.animationiteration.animation,delete Xo.animationstart.animation),"TransitionEvent"in window||delete Xo.transitionend.transition);function Mh(t){if(Jf[t])return Jf[t];if(!Xo[t])return t;var e=Xo[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in eS)return Jf[t]=e[n];return t}var tS=Mh("animationend"),nS=Mh("animationiteration"),rS=Mh("animationstart"),iS=Mh("transitionend"),sS=new Map,jy="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function os(t,e){sS.set(t,e),vo(e,[t])}for(var Qf=0;Qf<jy.length;Qf++){var Yf=jy[Qf],OP=Yf.toLowerCase(),BP=Yf[0].toUpperCase()+Yf.slice(1);os(OP,"on"+BP)}os(tS,"onAnimationEnd");os(nS,"onAnimationIteration");os(rS,"onAnimationStart");os("dblclick","onDoubleClick");os("focusin","onFocus");os("focusout","onBlur");os(iS,"onTransitionEnd");Ea("onMouseEnter",["mouseout","mouseover"]);Ea("onMouseLeave",["mouseout","mouseover"]);Ea("onPointerEnter",["pointerout","pointerover"]);Ea("onPointerLeave",["pointerout","pointerover"]);vo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));vo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));vo("onBeforeInput",["compositionend","keypress","textInput","paste"]);vo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));vo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));vo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Vl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),qP=new Set("cancel close invalid load scroll toggle".split(" ").concat(Vl));function Jy(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,OR(r,e,void 0,t),t.currentTarget=null}function oS(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;Jy(i,a,u),s=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;Jy(i,a,u),s=l}}}if(bd)throw t=Gp,bd=!1,Gp=null,t}function it(t,e){var n=e[Xp];n===void 0&&(n=e[Xp]=new Set);var r=t+"__bubble";n.has(r)||(aS(e,t,2,!1),n.add(r))}function Xf(t,e,n){var r=0;e&&(r|=4),aS(n,t,r,e)}var Bc="_reactListening"+Math.random().toString(36).slice(2);function yu(t){if(!t[Bc]){t[Bc]=!0,pw.forEach(function(n){n!=="selectionchange"&&(qP.has(n)||Xf(n,!1,t),Xf(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Bc]||(e[Bc]=!0,Xf("selectionchange",!1,e))}}function aS(t,e,n,r){switch($w(e)){case 1:var i=tP;break;case 4:i=nP;break;default:i=Ag}n=i.bind(null,e,n,t),i=void 0,!qp||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function Zf(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=Ws(a),o===null)return;if(l=o.tag,l===5||l===6){r=s=o;continue e}a=a.parentNode}}r=r.return}kw(function(){var u=s,f=Ig(n),p=[];e:{var g=sS.get(t);if(g!==void 0){var v=Rg,E=t;switch(t){case"keypress":if(od(n)===0)break e;case"keydown":case"keyup":v=_P;break;case"focusin":E="focus",v=Wf;break;case"focusout":E="blur",v=Wf;break;case"beforeblur":case"afterblur":v=Wf;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":v=Fy;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":v=sP;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":v=TP;break;case tS:case nS:case rS:v=lP;break;case iS:v=IP;break;case"scroll":v=rP;break;case"wheel":v=SP;break;case"copy":case"cut":case"paste":v=cP;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":v=Oy}var R=(e&4)!==0,M=!R&&t==="scroll",A=R?g!==null?g+"Capture":null:g;R=[];for(var I=u,C;I!==null;){C=I;var V=C.stateNode;if(C.tag===5&&V!==null&&(C=V,A!==null&&(V=hu(I,A),V!=null&&R.push(vu(I,V,C)))),M)break;I=I.return}0<R.length&&(g=new v(g,E,null,n,f),p.push({event:g,listeners:R}))}}if(!(e&7)){e:{if(g=t==="mouseover"||t==="pointerover",v=t==="mouseout"||t==="pointerout",g&&n!==Op&&(E=n.relatedTarget||n.fromElement)&&(Ws(E)||E[Qr]))break e;if((v||g)&&(g=f.window===f?f:(g=f.ownerDocument)?g.defaultView||g.parentWindow:window,v?(E=n.relatedTarget||n.toElement,v=u,E=E?Ws(E):null,E!==null&&(M=To(E),E!==M||E.tag!==5&&E.tag!==6)&&(E=null)):(v=null,E=u),v!==E)){if(R=Fy,V="onMouseLeave",A="onMouseEnter",I="mouse",(t==="pointerout"||t==="pointerover")&&(R=Oy,V="onPointerLeave",A="onPointerEnter",I="pointer"),M=v==null?g:Zo(v),C=E==null?g:Zo(E),g=new R(V,I+"leave",v,n,f),g.target=M,g.relatedTarget=C,V=null,Ws(f)===u&&(R=new R(A,I+"enter",E,n,f),R.target=C,R.relatedTarget=M,V=R),M=V,v&&E)t:{for(R=v,A=E,I=0,C=R;C;C=Lo(C))I++;for(C=0,V=A;V;V=Lo(V))C++;for(;0<I-C;)R=Lo(R),I--;for(;0<C-I;)A=Lo(A),C--;for(;I--;){if(R===A||A!==null&&R===A.alternate)break t;R=Lo(R),A=Lo(A)}R=null}else R=null;v!==null&&Qy(p,g,v,R,!1),E!==null&&M!==null&&Qy(p,M,E,R,!0)}}e:{if(g=u?Zo(u):window,v=g.nodeName&&g.nodeName.toLowerCase(),v==="select"||v==="input"&&g.type==="file")var F=NP;else if(Gy(g))if(Qw)F=VP;else{F=bP;var B=DP}else(v=g.nodeName)&&v.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(F=MP);if(F&&(F=F(t,u))){Jw(p,F,n,f);break e}B&&B(t,g,u),t==="focusout"&&(B=g._wrapperState)&&B.controlled&&g.type==="number"&&Mp(g,"number",g.value)}switch(B=u?Zo(u):window,t){case"focusin":(Gy(B)||B.contentEditable==="true")&&(Yo=B,Wp=u,Wl=null);break;case"focusout":Wl=Wp=Yo=null;break;case"mousedown":Kp=!0;break;case"contextmenu":case"mouseup":case"dragend":Kp=!1,Ky(p,n,f);break;case"selectionchange":if(UP)break;case"keydown":case"keyup":Ky(p,n,f)}var T;if(kg)e:{switch(t){case"compositionstart":var w="onCompositionStart";break e;case"compositionend":w="onCompositionEnd";break e;case"compositionupdate":w="onCompositionUpdate";break e}w=void 0}else Qo?Kw(t,n)&&(w="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(w="onCompositionStart");w&&(Ww&&n.locale!=="ko"&&(Qo||w!=="onCompositionStart"?w==="onCompositionEnd"&&Qo&&(T=Hw()):(bi=f,xg="value"in bi?bi.value:bi.textContent,Qo=!0)),B=Ud(u,w),0<B.length&&(w=new Uy(w,t,null,n,f),p.push({event:w,listeners:B}),T?w.data=T:(T=jw(n),T!==null&&(w.data=T)))),(T=AP?xP(t,n):RP(t,n))&&(u=Ud(u,"onBeforeInput"),0<u.length&&(f=new Uy("onBeforeInput","beforeinput",null,n,f),p.push({event:f,listeners:u}),f.data=T))}oS(p,e)})}function vu(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Ud(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=hu(t,n),s!=null&&r.unshift(vu(t,s,i)),s=hu(t,e),s!=null&&r.push(vu(t,s,i))),t=t.return}return r}function Lo(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Qy(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,u=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&u!==null&&(a=u,i?(l=hu(n,s),l!=null&&o.unshift(vu(n,l,a))):i||(l=hu(n,s),l!=null&&o.push(vu(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var GP=/\r\n?/g,zP=/\u0000|\uFFFD/g;function Yy(t){return(typeof t=="string"?t:""+t).replace(GP,`
`).replace(zP,"")}function qc(t,e,n){if(e=Yy(e),Yy(t)!==e&&n)throw Error(te(425))}function Od(){}var jp=null,Jp=null;function Qp(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Yp=typeof setTimeout=="function"?setTimeout:void 0,$P=typeof clearTimeout=="function"?clearTimeout:void 0,Xy=typeof Promise=="function"?Promise:void 0,HP=typeof queueMicrotask=="function"?queueMicrotask:typeof Xy<"u"?function(t){return Xy.resolve(null).then(t).catch(WP)}:Yp;function WP(t){setTimeout(function(){throw t})}function ep(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),mu(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);mu(e)}function Oi(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Zy(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Wa=Math.random().toString(36).slice(2),Cr="__reactFiber$"+Wa,Tu="__reactProps$"+Wa,Qr="__reactContainer$"+Wa,Xp="__reactEvents$"+Wa,KP="__reactListeners$"+Wa,jP="__reactHandles$"+Wa;function Ws(t){var e=t[Cr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Qr]||n[Cr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Zy(t);t!==null;){if(n=t[Cr])return n;t=Zy(t)}return e}t=n,n=t.parentNode}return null}function $u(t){return t=t[Cr]||t[Qr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Zo(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(te(33))}function Vh(t){return t[Tu]||null}var Zp=[],ea=-1;function as(t){return{current:t}}function ot(t){0>ea||(t.current=Zp[ea],Zp[ea]=null,ea--)}function nt(t,e){ea++,Zp[ea]=t.current,t.current=e}var Xi={},Zt=as(Xi),pn=as(!1),io=Xi;function Ia(t,e){var n=t.type.contextTypes;if(!n)return Xi;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function mn(t){return t=t.childContextTypes,t!=null}function Bd(){ot(pn),ot(Zt)}function ev(t,e,n){if(Zt.current!==Xi)throw Error(te(168));nt(Zt,e),nt(pn,n)}function lS(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(te(108,DR(t)||"Unknown",i));return gt({},n,r)}function qd(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Xi,io=Zt.current,nt(Zt,t),nt(pn,pn.current),!0}function tv(t,e,n){var r=t.stateNode;if(!r)throw Error(te(169));n?(t=lS(t,e,io),r.__reactInternalMemoizedMergedChildContext=t,ot(pn),ot(Zt),nt(Zt,t)):ot(pn),nt(pn,n)}var Br=null,Lh=!1,tp=!1;function uS(t){Br===null?Br=[t]:Br.push(t)}function JP(t){Lh=!0,uS(t)}function ls(){if(!tp&&Br!==null){tp=!0;var t=0,e=We;try{var n=Br;for(We=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Br=null,Lh=!1}catch(i){throw Br!==null&&(Br=Br.slice(t+1)),Mw(wg,ls),i}finally{We=e,tp=!1}}return null}var ta=[],na=0,Gd=null,zd=0,Ln=[],Fn=0,so=null,Gr=1,zr="";function Fs(t,e){ta[na++]=zd,ta[na++]=Gd,Gd=t,zd=e}function cS(t,e,n){Ln[Fn++]=Gr,Ln[Fn++]=zr,Ln[Fn++]=so,so=t;var r=Gr;t=zr;var i=32-sr(r)-1;r&=~(1<<i),n+=1;var s=32-sr(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Gr=1<<32-sr(e)+i|n<<i|r,zr=s+t}else Gr=1<<s|n<<i|r,zr=t}function Dg(t){t.return!==null&&(Fs(t,1),cS(t,1,0))}function bg(t){for(;t===Gd;)Gd=ta[--na],ta[na]=null,zd=ta[--na],ta[na]=null;for(;t===so;)so=Ln[--Fn],Ln[Fn]=null,zr=Ln[--Fn],Ln[Fn]=null,Gr=Ln[--Fn],Ln[Fn]=null}var Cn=null,wn=null,ct=!1,nr=null;function dS(t,e){var n=Un(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function nv(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Cn=t,wn=Oi(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Cn=t,wn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=so!==null?{id:Gr,overflow:zr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Un(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Cn=t,wn=null,!0):!1;default:return!1}}function em(t){return(t.mode&1)!==0&&(t.flags&128)===0}function tm(t){if(ct){var e=wn;if(e){var n=e;if(!nv(t,e)){if(em(t))throw Error(te(418));e=Oi(n.nextSibling);var r=Cn;e&&nv(t,e)?dS(r,n):(t.flags=t.flags&-4097|2,ct=!1,Cn=t)}}else{if(em(t))throw Error(te(418));t.flags=t.flags&-4097|2,ct=!1,Cn=t}}}function rv(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Cn=t}function Gc(t){if(t!==Cn)return!1;if(!ct)return rv(t),ct=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Qp(t.type,t.memoizedProps)),e&&(e=wn)){if(em(t))throw hS(),Error(te(418));for(;e;)dS(t,e),e=Oi(e.nextSibling)}if(rv(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(te(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){wn=Oi(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}wn=null}}else wn=Cn?Oi(t.stateNode.nextSibling):null;return!0}function hS(){for(var t=wn;t;)t=Oi(t.nextSibling)}function wa(){wn=Cn=null,ct=!1}function Mg(t){nr===null?nr=[t]:nr.push(t)}var QP=ri.ReactCurrentBatchConfig;function Il(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(te(309));var r=n.stateNode}if(!r)throw Error(te(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(te(284));if(!n._owner)throw Error(te(290,t))}return t}function zc(t,e){throw t=Object.prototype.toString.call(e),Error(te(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function iv(t){var e=t._init;return e(t._payload)}function fS(t){function e(A,I){if(t){var C=A.deletions;C===null?(A.deletions=[I],A.flags|=16):C.push(I)}}function n(A,I){if(!t)return null;for(;I!==null;)e(A,I),I=I.sibling;return null}function r(A,I){for(A=new Map;I!==null;)I.key!==null?A.set(I.key,I):A.set(I.index,I),I=I.sibling;return A}function i(A,I){return A=zi(A,I),A.index=0,A.sibling=null,A}function s(A,I,C){return A.index=C,t?(C=A.alternate,C!==null?(C=C.index,C<I?(A.flags|=2,I):C):(A.flags|=2,I)):(A.flags|=1048576,I)}function o(A){return t&&A.alternate===null&&(A.flags|=2),A}function a(A,I,C,V){return I===null||I.tag!==6?(I=lp(C,A.mode,V),I.return=A,I):(I=i(I,C),I.return=A,I)}function l(A,I,C,V){var F=C.type;return F===Jo?f(A,I,C.props.children,V,C.key):I!==null&&(I.elementType===F||typeof F=="object"&&F!==null&&F.$$typeof===Ci&&iv(F)===I.type)?(V=i(I,C.props),V.ref=Il(A,I,C),V.return=A,V):(V=fd(C.type,C.key,C.props,null,A.mode,V),V.ref=Il(A,I,C),V.return=A,V)}function u(A,I,C,V){return I===null||I.tag!==4||I.stateNode.containerInfo!==C.containerInfo||I.stateNode.implementation!==C.implementation?(I=up(C,A.mode,V),I.return=A,I):(I=i(I,C.children||[]),I.return=A,I)}function f(A,I,C,V,F){return I===null||I.tag!==7?(I=Xs(C,A.mode,V,F),I.return=A,I):(I=i(I,C),I.return=A,I)}function p(A,I,C){if(typeof I=="string"&&I!==""||typeof I=="number")return I=lp(""+I,A.mode,C),I.return=A,I;if(typeof I=="object"&&I!==null){switch(I.$$typeof){case Dc:return C=fd(I.type,I.key,I.props,null,A.mode,C),C.ref=Il(A,null,I),C.return=A,C;case jo:return I=up(I,A.mode,C),I.return=A,I;case Ci:var V=I._init;return p(A,V(I._payload),C)}if(bl(I)||_l(I))return I=Xs(I,A.mode,C,null),I.return=A,I;zc(A,I)}return null}function g(A,I,C,V){var F=I!==null?I.key:null;if(typeof C=="string"&&C!==""||typeof C=="number")return F!==null?null:a(A,I,""+C,V);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case Dc:return C.key===F?l(A,I,C,V):null;case jo:return C.key===F?u(A,I,C,V):null;case Ci:return F=C._init,g(A,I,F(C._payload),V)}if(bl(C)||_l(C))return F!==null?null:f(A,I,C,V,null);zc(A,C)}return null}function v(A,I,C,V,F){if(typeof V=="string"&&V!==""||typeof V=="number")return A=A.get(C)||null,a(I,A,""+V,F);if(typeof V=="object"&&V!==null){switch(V.$$typeof){case Dc:return A=A.get(V.key===null?C:V.key)||null,l(I,A,V,F);case jo:return A=A.get(V.key===null?C:V.key)||null,u(I,A,V,F);case Ci:var B=V._init;return v(A,I,C,B(V._payload),F)}if(bl(V)||_l(V))return A=A.get(C)||null,f(I,A,V,F,null);zc(I,V)}return null}function E(A,I,C,V){for(var F=null,B=null,T=I,w=I=0,x=null;T!==null&&w<C.length;w++){T.index>w?(x=T,T=null):x=T.sibling;var k=g(A,T,C[w],V);if(k===null){T===null&&(T=x);break}t&&T&&k.alternate===null&&e(A,T),I=s(k,I,w),B===null?F=k:B.sibling=k,B=k,T=x}if(w===C.length)return n(A,T),ct&&Fs(A,w),F;if(T===null){for(;w<C.length;w++)T=p(A,C[w],V),T!==null&&(I=s(T,I,w),B===null?F=T:B.sibling=T,B=T);return ct&&Fs(A,w),F}for(T=r(A,T);w<C.length;w++)x=v(T,A,w,C[w],V),x!==null&&(t&&x.alternate!==null&&T.delete(x.key===null?w:x.key),I=s(x,I,w),B===null?F=x:B.sibling=x,B=x);return t&&T.forEach(function(D){return e(A,D)}),ct&&Fs(A,w),F}function R(A,I,C,V){var F=_l(C);if(typeof F!="function")throw Error(te(150));if(C=F.call(C),C==null)throw Error(te(151));for(var B=F=null,T=I,w=I=0,x=null,k=C.next();T!==null&&!k.done;w++,k=C.next()){T.index>w?(x=T,T=null):x=T.sibling;var D=g(A,T,k.value,V);if(D===null){T===null&&(T=x);break}t&&T&&D.alternate===null&&e(A,T),I=s(D,I,w),B===null?F=D:B.sibling=D,B=D,T=x}if(k.done)return n(A,T),ct&&Fs(A,w),F;if(T===null){for(;!k.done;w++,k=C.next())k=p(A,k.value,V),k!==null&&(I=s(k,I,w),B===null?F=k:B.sibling=k,B=k);return ct&&Fs(A,w),F}for(T=r(A,T);!k.done;w++,k=C.next())k=v(T,A,w,k.value,V),k!==null&&(t&&k.alternate!==null&&T.delete(k.key===null?w:k.key),I=s(k,I,w),B===null?F=k:B.sibling=k,B=k);return t&&T.forEach(function(L){return e(A,L)}),ct&&Fs(A,w),F}function M(A,I,C,V){if(typeof C=="object"&&C!==null&&C.type===Jo&&C.key===null&&(C=C.props.children),typeof C=="object"&&C!==null){switch(C.$$typeof){case Dc:e:{for(var F=C.key,B=I;B!==null;){if(B.key===F){if(F=C.type,F===Jo){if(B.tag===7){n(A,B.sibling),I=i(B,C.props.children),I.return=A,A=I;break e}}else if(B.elementType===F||typeof F=="object"&&F!==null&&F.$$typeof===Ci&&iv(F)===B.type){n(A,B.sibling),I=i(B,C.props),I.ref=Il(A,B,C),I.return=A,A=I;break e}n(A,B);break}else e(A,B);B=B.sibling}C.type===Jo?(I=Xs(C.props.children,A.mode,V,C.key),I.return=A,A=I):(V=fd(C.type,C.key,C.props,null,A.mode,V),V.ref=Il(A,I,C),V.return=A,A=V)}return o(A);case jo:e:{for(B=C.key;I!==null;){if(I.key===B)if(I.tag===4&&I.stateNode.containerInfo===C.containerInfo&&I.stateNode.implementation===C.implementation){n(A,I.sibling),I=i(I,C.children||[]),I.return=A,A=I;break e}else{n(A,I);break}else e(A,I);I=I.sibling}I=up(C,A.mode,V),I.return=A,A=I}return o(A);case Ci:return B=C._init,M(A,I,B(C._payload),V)}if(bl(C))return E(A,I,C,V);if(_l(C))return R(A,I,C,V);zc(A,C)}return typeof C=="string"&&C!==""||typeof C=="number"?(C=""+C,I!==null&&I.tag===6?(n(A,I.sibling),I=i(I,C),I.return=A,A=I):(n(A,I),I=lp(C,A.mode,V),I.return=A,A=I),o(A)):n(A,I)}return M}var Sa=fS(!0),pS=fS(!1),$d=as(null),Hd=null,ra=null,Vg=null;function Lg(){Vg=ra=Hd=null}function Fg(t){var e=$d.current;ot($d),t._currentValue=e}function nm(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function ha(t,e){Hd=t,Vg=ra=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(hn=!0),t.firstContext=null)}function $n(t){var e=t._currentValue;if(Vg!==t)if(t={context:t,memoizedValue:e,next:null},ra===null){if(Hd===null)throw Error(te(308));ra=t,Hd.dependencies={lanes:0,firstContext:t}}else ra=ra.next=t;return e}var Ks=null;function Ug(t){Ks===null?Ks=[t]:Ks.push(t)}function mS(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,Ug(e)):(n.next=i.next,i.next=n),e.interleaved=n,Yr(t,r)}function Yr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Ai=!1;function Og(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function gS(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Kr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Bi(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Be&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Yr(t,n)}return i=r.interleaved,i===null?(e.next=e,Ug(r)):(e.next=i.next,i.next=e),r.interleaved=e,Yr(t,n)}function ad(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Sg(t,n)}}function sv(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Wd(t,e,n,r){var i=t.updateQueue;Ai=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?s=u:o.next=u,o=l;var f=t.alternate;f!==null&&(f=f.updateQueue,a=f.lastBaseUpdate,a!==o&&(a===null?f.firstBaseUpdate=u:a.next=u,f.lastBaseUpdate=l))}if(s!==null){var p=i.baseState;o=0,f=u=l=null,a=s;do{var g=a.lane,v=a.eventTime;if((r&g)===g){f!==null&&(f=f.next={eventTime:v,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var E=t,R=a;switch(g=e,v=n,R.tag){case 1:if(E=R.payload,typeof E=="function"){p=E.call(v,p,g);break e}p=E;break e;case 3:E.flags=E.flags&-65537|128;case 0:if(E=R.payload,g=typeof E=="function"?E.call(v,p,g):E,g==null)break e;p=gt({},p,g);break e;case 2:Ai=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,g=i.effects,g===null?i.effects=[a]:g.push(a))}else v={eventTime:v,lane:g,tag:a.tag,payload:a.payload,callback:a.callback,next:null},f===null?(u=f=v,l=p):f=f.next=v,o|=g;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;g=a,a=g.next,g.next=null,i.lastBaseUpdate=g,i.shared.pending=null}}while(!0);if(f===null&&(l=p),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=f,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);ao|=o,t.lanes=o,t.memoizedState=p}}function ov(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(te(191,i));i.call(r)}}}var Hu={},Pr=as(Hu),Eu=as(Hu),Iu=as(Hu);function js(t){if(t===Hu)throw Error(te(174));return t}function Bg(t,e){switch(nt(Iu,e),nt(Eu,t),nt(Pr,Hu),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Lp(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Lp(e,t)}ot(Pr),nt(Pr,e)}function Ca(){ot(Pr),ot(Eu),ot(Iu)}function _S(t){js(Iu.current);var e=js(Pr.current),n=Lp(e,t.type);e!==n&&(nt(Eu,t),nt(Pr,n))}function qg(t){Eu.current===t&&(ot(Pr),ot(Eu))}var ft=as(0);function Kd(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var np=[];function Gg(){for(var t=0;t<np.length;t++)np[t]._workInProgressVersionPrimary=null;np.length=0}var ld=ri.ReactCurrentDispatcher,rp=ri.ReactCurrentBatchConfig,oo=0,mt=null,At=null,bt=null,jd=!1,Kl=!1,wu=0,YP=0;function Ht(){throw Error(te(321))}function zg(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!cr(t[n],e[n]))return!1;return!0}function $g(t,e,n,r,i,s){if(oo=s,mt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,ld.current=t===null||t.memoizedState===null?tk:nk,t=n(r,i),Kl){s=0;do{if(Kl=!1,wu=0,25<=s)throw Error(te(301));s+=1,bt=At=null,e.updateQueue=null,ld.current=rk,t=n(r,i)}while(Kl)}if(ld.current=Jd,e=At!==null&&At.next!==null,oo=0,bt=At=mt=null,jd=!1,e)throw Error(te(300));return t}function Hg(){var t=wu!==0;return wu=0,t}function wr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return bt===null?mt.memoizedState=bt=t:bt=bt.next=t,bt}function Hn(){if(At===null){var t=mt.alternate;t=t!==null?t.memoizedState:null}else t=At.next;var e=bt===null?mt.memoizedState:bt.next;if(e!==null)bt=e,At=t;else{if(t===null)throw Error(te(310));At=t,t={memoizedState:At.memoizedState,baseState:At.baseState,baseQueue:At.baseQueue,queue:At.queue,next:null},bt===null?mt.memoizedState=bt=t:bt=bt.next=t}return bt}function Su(t,e){return typeof e=="function"?e(t):e}function ip(t){var e=Hn(),n=e.queue;if(n===null)throw Error(te(311));n.lastRenderedReducer=t;var r=At,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,l=null,u=s;do{var f=u.lane;if((oo&f)===f)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var p={lane:f,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=p,o=r):l=l.next=p,mt.lanes|=f,ao|=f}u=u.next}while(u!==null&&u!==s);l===null?o=r:l.next=a,cr(r,e.memoizedState)||(hn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,mt.lanes|=s,ao|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function sp(t){var e=Hn(),n=e.queue;if(n===null)throw Error(te(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);cr(s,e.memoizedState)||(hn=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function yS(){}function vS(t,e){var n=mt,r=Hn(),i=e(),s=!cr(r.memoizedState,i);if(s&&(r.memoizedState=i,hn=!0),r=r.queue,Wg(IS.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||bt!==null&&bt.memoizedState.tag&1){if(n.flags|=2048,Cu(9,ES.bind(null,n,r,i,e),void 0,null),Mt===null)throw Error(te(349));oo&30||TS(n,e,i)}return i}function TS(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=mt.updateQueue,e===null?(e={lastEffect:null,stores:null},mt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function ES(t,e,n,r){e.value=n,e.getSnapshot=r,wS(e)&&SS(t)}function IS(t,e,n){return n(function(){wS(e)&&SS(t)})}function wS(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!cr(t,n)}catch{return!0}}function SS(t){var e=Yr(t,1);e!==null&&or(e,t,1,-1)}function av(t){var e=wr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Su,lastRenderedState:t},e.queue=t,t=t.dispatch=ek.bind(null,mt,t),[e.memoizedState,t]}function Cu(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=mt.updateQueue,e===null?(e={lastEffect:null,stores:null},mt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function CS(){return Hn().memoizedState}function ud(t,e,n,r){var i=wr();mt.flags|=t,i.memoizedState=Cu(1|e,n,void 0,r===void 0?null:r)}function Fh(t,e,n,r){var i=Hn();r=r===void 0?null:r;var s=void 0;if(At!==null){var o=At.memoizedState;if(s=o.destroy,r!==null&&zg(r,o.deps)){i.memoizedState=Cu(e,n,s,r);return}}mt.flags|=t,i.memoizedState=Cu(1|e,n,s,r)}function lv(t,e){return ud(8390656,8,t,e)}function Wg(t,e){return Fh(2048,8,t,e)}function AS(t,e){return Fh(4,2,t,e)}function xS(t,e){return Fh(4,4,t,e)}function RS(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function PS(t,e,n){return n=n!=null?n.concat([t]):null,Fh(4,4,RS.bind(null,e,t),n)}function Kg(){}function kS(t,e){var n=Hn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&zg(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function NS(t,e){var n=Hn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&zg(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function DS(t,e,n){return oo&21?(cr(n,e)||(n=Fw(),mt.lanes|=n,ao|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,hn=!0),t.memoizedState=n)}function XP(t,e){var n=We;We=n!==0&&4>n?n:4,t(!0);var r=rp.transition;rp.transition={};try{t(!1),e()}finally{We=n,rp.transition=r}}function bS(){return Hn().memoizedState}function ZP(t,e,n){var r=Gi(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},MS(t))VS(e,n);else if(n=mS(t,e,n,r),n!==null){var i=sn();or(n,t,r,i),LS(n,e,r)}}function ek(t,e,n){var r=Gi(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(MS(t))VS(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,cr(a,o)){var l=e.interleaved;l===null?(i.next=i,Ug(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=mS(t,e,i,r),n!==null&&(i=sn(),or(n,t,r,i),LS(n,e,r))}}function MS(t){var e=t.alternate;return t===mt||e!==null&&e===mt}function VS(t,e){Kl=jd=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function LS(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Sg(t,n)}}var Jd={readContext:$n,useCallback:Ht,useContext:Ht,useEffect:Ht,useImperativeHandle:Ht,useInsertionEffect:Ht,useLayoutEffect:Ht,useMemo:Ht,useReducer:Ht,useRef:Ht,useState:Ht,useDebugValue:Ht,useDeferredValue:Ht,useTransition:Ht,useMutableSource:Ht,useSyncExternalStore:Ht,useId:Ht,unstable_isNewReconciler:!1},tk={readContext:$n,useCallback:function(t,e){return wr().memoizedState=[t,e===void 0?null:e],t},useContext:$n,useEffect:lv,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,ud(4194308,4,RS.bind(null,e,t),n)},useLayoutEffect:function(t,e){return ud(4194308,4,t,e)},useInsertionEffect:function(t,e){return ud(4,2,t,e)},useMemo:function(t,e){var n=wr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=wr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=ZP.bind(null,mt,t),[r.memoizedState,t]},useRef:function(t){var e=wr();return t={current:t},e.memoizedState=t},useState:av,useDebugValue:Kg,useDeferredValue:function(t){return wr().memoizedState=t},useTransition:function(){var t=av(!1),e=t[0];return t=XP.bind(null,t[1]),wr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=mt,i=wr();if(ct){if(n===void 0)throw Error(te(407));n=n()}else{if(n=e(),Mt===null)throw Error(te(349));oo&30||TS(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,lv(IS.bind(null,r,s,t),[t]),r.flags|=2048,Cu(9,ES.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=wr(),e=Mt.identifierPrefix;if(ct){var n=zr,r=Gr;n=(r&~(1<<32-sr(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=wu++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=YP++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},nk={readContext:$n,useCallback:kS,useContext:$n,useEffect:Wg,useImperativeHandle:PS,useInsertionEffect:AS,useLayoutEffect:xS,useMemo:NS,useReducer:ip,useRef:CS,useState:function(){return ip(Su)},useDebugValue:Kg,useDeferredValue:function(t){var e=Hn();return DS(e,At.memoizedState,t)},useTransition:function(){var t=ip(Su)[0],e=Hn().memoizedState;return[t,e]},useMutableSource:yS,useSyncExternalStore:vS,useId:bS,unstable_isNewReconciler:!1},rk={readContext:$n,useCallback:kS,useContext:$n,useEffect:Wg,useImperativeHandle:PS,useInsertionEffect:AS,useLayoutEffect:xS,useMemo:NS,useReducer:sp,useRef:CS,useState:function(){return sp(Su)},useDebugValue:Kg,useDeferredValue:function(t){var e=Hn();return At===null?e.memoizedState=t:DS(e,At.memoizedState,t)},useTransition:function(){var t=sp(Su)[0],e=Hn().memoizedState;return[t,e]},useMutableSource:yS,useSyncExternalStore:vS,useId:bS,unstable_isNewReconciler:!1};function Zn(t,e){if(t&&t.defaultProps){e=gt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function rm(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:gt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Uh={isMounted:function(t){return(t=t._reactInternals)?To(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=sn(),i=Gi(t),s=Kr(r,i);s.payload=e,n!=null&&(s.callback=n),e=Bi(t,s,i),e!==null&&(or(e,t,i,r),ad(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=sn(),i=Gi(t),s=Kr(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=Bi(t,s,i),e!==null&&(or(e,t,i,r),ad(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=sn(),r=Gi(t),i=Kr(n,r);i.tag=2,e!=null&&(i.callback=e),e=Bi(t,i,r),e!==null&&(or(e,t,r,n),ad(e,t,r))}};function uv(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!_u(n,r)||!_u(i,s):!0}function FS(t,e,n){var r=!1,i=Xi,s=e.contextType;return typeof s=="object"&&s!==null?s=$n(s):(i=mn(e)?io:Zt.current,r=e.contextTypes,s=(r=r!=null)?Ia(t,i):Xi),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Uh,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function cv(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Uh.enqueueReplaceState(e,e.state,null)}function im(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},Og(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=$n(s):(s=mn(e)?io:Zt.current,i.context=Ia(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(rm(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Uh.enqueueReplaceState(i,i.state,null),Wd(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Aa(t,e){try{var n="",r=e;do n+=NR(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function op(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function sm(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var ik=typeof WeakMap=="function"?WeakMap:Map;function US(t,e,n){n=Kr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Yd||(Yd=!0,mm=r),sm(t,e)},n}function OS(t,e,n){n=Kr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){sm(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){sm(t,e),typeof r!="function"&&(qi===null?qi=new Set([this]):qi.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function dv(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new ik;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=yk.bind(null,t,e,n),e.then(t,t))}function hv(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function fv(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Kr(-1,1),e.tag=2,Bi(n,e,1))),n.lanes|=1),t)}var sk=ri.ReactCurrentOwner,hn=!1;function tn(t,e,n,r){e.child=t===null?pS(e,null,n,r):Sa(e,t.child,n,r)}function pv(t,e,n,r,i){n=n.render;var s=e.ref;return ha(e,i),r=$g(t,e,n,r,s,i),n=Hg(),t!==null&&!hn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Xr(t,e,i)):(ct&&n&&Dg(e),e.flags|=1,tn(t,e,r,i),e.child)}function mv(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!t_(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,BS(t,e,s,r,i)):(t=fd(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:_u,n(o,r)&&t.ref===e.ref)return Xr(t,e,i)}return e.flags|=1,t=zi(s,r),t.ref=e.ref,t.return=e,e.child=t}function BS(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(_u(s,r)&&t.ref===e.ref)if(hn=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(hn=!0);else return e.lanes=t.lanes,Xr(t,e,i)}return om(t,e,n,r,i)}function qS(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},nt(sa,Tn),Tn|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,nt(sa,Tn),Tn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,nt(sa,Tn),Tn|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,nt(sa,Tn),Tn|=r;return tn(t,e,i,n),e.child}function GS(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function om(t,e,n,r,i){var s=mn(n)?io:Zt.current;return s=Ia(e,s),ha(e,i),n=$g(t,e,n,r,s,i),r=Hg(),t!==null&&!hn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Xr(t,e,i)):(ct&&r&&Dg(e),e.flags|=1,tn(t,e,n,i),e.child)}function gv(t,e,n,r,i){if(mn(n)){var s=!0;qd(e)}else s=!1;if(ha(e,i),e.stateNode===null)cd(t,e),FS(e,n,r),im(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=$n(u):(u=mn(n)?io:Zt.current,u=Ia(e,u));var f=n.getDerivedStateFromProps,p=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function";p||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==u)&&cv(e,o,r,u),Ai=!1;var g=e.memoizedState;o.state=g,Wd(e,r,o,i),l=e.memoizedState,a!==r||g!==l||pn.current||Ai?(typeof f=="function"&&(rm(e,n,f,r),l=e.memoizedState),(a=Ai||uv(e,n,a,r,g,l,u))?(p||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=u,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,gS(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:Zn(e.type,a),o.props=u,p=e.pendingProps,g=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=$n(l):(l=mn(n)?io:Zt.current,l=Ia(e,l));var v=n.getDerivedStateFromProps;(f=typeof v=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==p||g!==l)&&cv(e,o,r,l),Ai=!1,g=e.memoizedState,o.state=g,Wd(e,r,o,i);var E=e.memoizedState;a!==p||g!==E||pn.current||Ai?(typeof v=="function"&&(rm(e,n,v,r),E=e.memoizedState),(u=Ai||uv(e,n,u,r,g,E,l)||!1)?(f||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,E,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,E,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=E),o.props=r,o.state=E,o.context=l,r=u):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),r=!1)}return am(t,e,n,r,s,i)}function am(t,e,n,r,i,s){GS(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&tv(e,n,!1),Xr(t,e,s);r=e.stateNode,sk.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Sa(e,t.child,null,s),e.child=Sa(e,null,a,s)):tn(t,e,a,s),e.memoizedState=r.state,i&&tv(e,n,!0),e.child}function zS(t){var e=t.stateNode;e.pendingContext?ev(t,e.pendingContext,e.pendingContext!==e.context):e.context&&ev(t,e.context,!1),Bg(t,e.containerInfo)}function _v(t,e,n,r,i){return wa(),Mg(i),e.flags|=256,tn(t,e,n,r),e.child}var lm={dehydrated:null,treeContext:null,retryLane:0};function um(t){return{baseLanes:t,cachePool:null,transitions:null}}function $S(t,e,n){var r=e.pendingProps,i=ft.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),nt(ft,i&1),t===null)return tm(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=qh(o,r,0,null),t=Xs(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=um(n),e.memoizedState=lm,t):jg(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return ok(t,e,o,r,a,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=zi(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=zi(a,s):(s=Xs(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?um(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=lm,r}return s=t.child,t=s.sibling,r=zi(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function jg(t,e){return e=qh({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function $c(t,e,n,r){return r!==null&&Mg(r),Sa(e,t.child,null,n),t=jg(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function ok(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=op(Error(te(422))),$c(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=qh({mode:"visible",children:r.children},i,0,null),s=Xs(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&Sa(e,t.child,null,o),e.child.memoizedState=um(o),e.memoizedState=lm,s);if(!(e.mode&1))return $c(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(te(419)),r=op(s,r,void 0),$c(t,e,o,r)}if(a=(o&t.childLanes)!==0,hn||a){if(r=Mt,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Yr(t,i),or(r,t,i,-1))}return e_(),r=op(Error(te(421))),$c(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=vk.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,wn=Oi(i.nextSibling),Cn=e,ct=!0,nr=null,t!==null&&(Ln[Fn++]=Gr,Ln[Fn++]=zr,Ln[Fn++]=so,Gr=t.id,zr=t.overflow,so=e),e=jg(e,r.children),e.flags|=4096,e)}function yv(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),nm(t.return,e,n)}function ap(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function HS(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(tn(t,e,r.children,n),r=ft.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&yv(t,n,e);else if(t.tag===19)yv(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(nt(ft,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&Kd(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),ap(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Kd(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}ap(e,!0,n,null,s);break;case"together":ap(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function cd(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Xr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),ao|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(te(153));if(e.child!==null){for(t=e.child,n=zi(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=zi(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function ak(t,e,n){switch(e.tag){case 3:zS(e),wa();break;case 5:_S(e);break;case 1:mn(e.type)&&qd(e);break;case 4:Bg(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;nt($d,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(nt(ft,ft.current&1),e.flags|=128,null):n&e.child.childLanes?$S(t,e,n):(nt(ft,ft.current&1),t=Xr(t,e,n),t!==null?t.sibling:null);nt(ft,ft.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return HS(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),nt(ft,ft.current),r)break;return null;case 22:case 23:return e.lanes=0,qS(t,e,n)}return Xr(t,e,n)}var WS,cm,KS,jS;WS=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};cm=function(){};KS=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,js(Pr.current);var s=null;switch(n){case"input":i=Dp(t,i),r=Dp(t,r),s=[];break;case"select":i=gt({},i,{value:void 0}),r=gt({},r,{value:void 0}),s=[];break;case"textarea":i=Vp(t,i),r=Vp(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Od)}Fp(n,r);var o;n=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var a=i[u];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(cu.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var l=r[u];if(a=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(cu.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&it("scroll",t),s||a===l||(s=[])):(s=s||[]).push(u,l))}n&&(s=s||[]).push("style",n);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};jS=function(t,e,n,r){n!==r&&(e.flags|=4)};function wl(t,e){if(!ct)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Wt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function lk(t,e,n){var r=e.pendingProps;switch(bg(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Wt(e),null;case 1:return mn(e.type)&&Bd(),Wt(e),null;case 3:return r=e.stateNode,Ca(),ot(pn),ot(Zt),Gg(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Gc(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,nr!==null&&(ym(nr),nr=null))),cm(t,e),Wt(e),null;case 5:qg(e);var i=js(Iu.current);if(n=e.type,t!==null&&e.stateNode!=null)KS(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(te(166));return Wt(e),null}if(t=js(Pr.current),Gc(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[Cr]=e,r[Tu]=s,t=(e.mode&1)!==0,n){case"dialog":it("cancel",r),it("close",r);break;case"iframe":case"object":case"embed":it("load",r);break;case"video":case"audio":for(i=0;i<Vl.length;i++)it(Vl[i],r);break;case"source":it("error",r);break;case"img":case"image":case"link":it("error",r),it("load",r);break;case"details":it("toggle",r);break;case"input":xy(r,s),it("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},it("invalid",r);break;case"textarea":Py(r,s),it("invalid",r)}Fp(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&qc(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&qc(r.textContent,a,t),i=["children",""+a]):cu.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&it("scroll",r)}switch(n){case"input":bc(r),Ry(r,s,!0);break;case"textarea":bc(r),ky(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=Od)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Iw(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Cr]=e,t[Tu]=r,WS(t,e,!1,!1),e.stateNode=t;e:{switch(o=Up(n,r),n){case"dialog":it("cancel",t),it("close",t),i=r;break;case"iframe":case"object":case"embed":it("load",t),i=r;break;case"video":case"audio":for(i=0;i<Vl.length;i++)it(Vl[i],t);i=r;break;case"source":it("error",t),i=r;break;case"img":case"image":case"link":it("error",t),it("load",t),i=r;break;case"details":it("toggle",t),i=r;break;case"input":xy(t,r),i=Dp(t,r),it("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=gt({},r,{value:void 0}),it("invalid",t);break;case"textarea":Py(t,r),i=Vp(t,r),it("invalid",t);break;default:i=r}Fp(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?Cw(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&ww(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&du(t,l):typeof l=="number"&&du(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(cu.hasOwnProperty(s)?l!=null&&s==="onScroll"&&it("scroll",t):l!=null&&yg(t,s,l,o))}switch(n){case"input":bc(t),Ry(t,r,!1);break;case"textarea":bc(t),ky(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Yi(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?la(t,!!r.multiple,s,!1):r.defaultValue!=null&&la(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Od)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Wt(e),null;case 6:if(t&&e.stateNode!=null)jS(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(te(166));if(n=js(Iu.current),js(Pr.current),Gc(e)){if(r=e.stateNode,n=e.memoizedProps,r[Cr]=e,(s=r.nodeValue!==n)&&(t=Cn,t!==null))switch(t.tag){case 3:qc(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&qc(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Cr]=e,e.stateNode=r}return Wt(e),null;case 13:if(ot(ft),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ct&&wn!==null&&e.mode&1&&!(e.flags&128))hS(),wa(),e.flags|=98560,s=!1;else if(s=Gc(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(te(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(te(317));s[Cr]=e}else wa(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Wt(e),s=!1}else nr!==null&&(ym(nr),nr=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||ft.current&1?xt===0&&(xt=3):e_())),e.updateQueue!==null&&(e.flags|=4),Wt(e),null);case 4:return Ca(),cm(t,e),t===null&&yu(e.stateNode.containerInfo),Wt(e),null;case 10:return Fg(e.type._context),Wt(e),null;case 17:return mn(e.type)&&Bd(),Wt(e),null;case 19:if(ot(ft),s=e.memoizedState,s===null)return Wt(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)wl(s,!1);else{if(xt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Kd(t),o!==null){for(e.flags|=128,wl(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return nt(ft,ft.current&1|2),e.child}t=t.sibling}s.tail!==null&&Tt()>xa&&(e.flags|=128,r=!0,wl(s,!1),e.lanes=4194304)}else{if(!r)if(t=Kd(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),wl(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!ct)return Wt(e),null}else 2*Tt()-s.renderingStartTime>xa&&n!==1073741824&&(e.flags|=128,r=!0,wl(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Tt(),e.sibling=null,n=ft.current,nt(ft,r?n&1|2:n&1),e):(Wt(e),null);case 22:case 23:return Zg(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Tn&1073741824&&(Wt(e),e.subtreeFlags&6&&(e.flags|=8192)):Wt(e),null;case 24:return null;case 25:return null}throw Error(te(156,e.tag))}function uk(t,e){switch(bg(e),e.tag){case 1:return mn(e.type)&&Bd(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Ca(),ot(pn),ot(Zt),Gg(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return qg(e),null;case 13:if(ot(ft),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(te(340));wa()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return ot(ft),null;case 4:return Ca(),null;case 10:return Fg(e.type._context),null;case 22:case 23:return Zg(),null;case 24:return null;default:return null}}var Hc=!1,Jt=!1,ck=typeof WeakSet=="function"?WeakSet:Set,le=null;function ia(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){yt(t,e,r)}else n.current=null}function dm(t,e,n){try{n()}catch(r){yt(t,e,r)}}var vv=!1;function dk(t,e){if(jp=Ld,t=Zw(),Ng(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,u=0,f=0,p=t,g=null;t:for(;;){for(var v;p!==n||i!==0&&p.nodeType!==3||(a=o+i),p!==s||r!==0&&p.nodeType!==3||(l=o+r),p.nodeType===3&&(o+=p.nodeValue.length),(v=p.firstChild)!==null;)g=p,p=v;for(;;){if(p===t)break t;if(g===n&&++u===i&&(a=o),g===s&&++f===r&&(l=o),(v=p.nextSibling)!==null)break;p=g,g=p.parentNode}p=v}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(Jp={focusedElem:t,selectionRange:n},Ld=!1,le=e;le!==null;)if(e=le,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,le=t;else for(;le!==null;){e=le;try{var E=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(E!==null){var R=E.memoizedProps,M=E.memoizedState,A=e.stateNode,I=A.getSnapshotBeforeUpdate(e.elementType===e.type?R:Zn(e.type,R),M);A.__reactInternalSnapshotBeforeUpdate=I}break;case 3:var C=e.stateNode.containerInfo;C.nodeType===1?C.textContent="":C.nodeType===9&&C.documentElement&&C.removeChild(C.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(te(163))}}catch(V){yt(e,e.return,V)}if(t=e.sibling,t!==null){t.return=e.return,le=t;break}le=e.return}return E=vv,vv=!1,E}function jl(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&dm(e,n,s)}i=i.next}while(i!==r)}}function Oh(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function hm(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function JS(t){var e=t.alternate;e!==null&&(t.alternate=null,JS(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Cr],delete e[Tu],delete e[Xp],delete e[KP],delete e[jP])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function QS(t){return t.tag===5||t.tag===3||t.tag===4}function Tv(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||QS(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function fm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Od));else if(r!==4&&(t=t.child,t!==null))for(fm(t,e,n),t=t.sibling;t!==null;)fm(t,e,n),t=t.sibling}function pm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(pm(t,e,n),t=t.sibling;t!==null;)pm(t,e,n),t=t.sibling}var Ut=null,er=!1;function yi(t,e,n){for(n=n.child;n!==null;)YS(t,e,n),n=n.sibling}function YS(t,e,n){if(Rr&&typeof Rr.onCommitFiberUnmount=="function")try{Rr.onCommitFiberUnmount(Nh,n)}catch{}switch(n.tag){case 5:Jt||ia(n,e);case 6:var r=Ut,i=er;Ut=null,yi(t,e,n),Ut=r,er=i,Ut!==null&&(er?(t=Ut,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Ut.removeChild(n.stateNode));break;case 18:Ut!==null&&(er?(t=Ut,n=n.stateNode,t.nodeType===8?ep(t.parentNode,n):t.nodeType===1&&ep(t,n),mu(t)):ep(Ut,n.stateNode));break;case 4:r=Ut,i=er,Ut=n.stateNode.containerInfo,er=!0,yi(t,e,n),Ut=r,er=i;break;case 0:case 11:case 14:case 15:if(!Jt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&dm(n,e,o),i=i.next}while(i!==r)}yi(t,e,n);break;case 1:if(!Jt&&(ia(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){yt(n,e,a)}yi(t,e,n);break;case 21:yi(t,e,n);break;case 22:n.mode&1?(Jt=(r=Jt)||n.memoizedState!==null,yi(t,e,n),Jt=r):yi(t,e,n);break;default:yi(t,e,n)}}function Ev(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new ck),e.forEach(function(r){var i=Tk.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Xn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Ut=a.stateNode,er=!1;break e;case 3:Ut=a.stateNode.containerInfo,er=!0;break e;case 4:Ut=a.stateNode.containerInfo,er=!0;break e}a=a.return}if(Ut===null)throw Error(te(160));YS(s,o,i),Ut=null,er=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){yt(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)XS(e,t),e=e.sibling}function XS(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Xn(e,t),Ir(t),r&4){try{jl(3,t,t.return),Oh(3,t)}catch(R){yt(t,t.return,R)}try{jl(5,t,t.return)}catch(R){yt(t,t.return,R)}}break;case 1:Xn(e,t),Ir(t),r&512&&n!==null&&ia(n,n.return);break;case 5:if(Xn(e,t),Ir(t),r&512&&n!==null&&ia(n,n.return),t.flags&32){var i=t.stateNode;try{du(i,"")}catch(R){yt(t,t.return,R)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&Tw(i,s),Up(a,o);var u=Up(a,s);for(o=0;o<l.length;o+=2){var f=l[o],p=l[o+1];f==="style"?Cw(i,p):f==="dangerouslySetInnerHTML"?ww(i,p):f==="children"?du(i,p):yg(i,f,p,u)}switch(a){case"input":bp(i,s);break;case"textarea":Ew(i,s);break;case"select":var g=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var v=s.value;v!=null?la(i,!!s.multiple,v,!1):g!==!!s.multiple&&(s.defaultValue!=null?la(i,!!s.multiple,s.defaultValue,!0):la(i,!!s.multiple,s.multiple?[]:"",!1))}i[Tu]=s}catch(R){yt(t,t.return,R)}}break;case 6:if(Xn(e,t),Ir(t),r&4){if(t.stateNode===null)throw Error(te(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(R){yt(t,t.return,R)}}break;case 3:if(Xn(e,t),Ir(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{mu(e.containerInfo)}catch(R){yt(t,t.return,R)}break;case 4:Xn(e,t),Ir(t);break;case 13:Xn(e,t),Ir(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Yg=Tt())),r&4&&Ev(t);break;case 22:if(f=n!==null&&n.memoizedState!==null,t.mode&1?(Jt=(u=Jt)||f,Xn(e,t),Jt=u):Xn(e,t),Ir(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!f&&t.mode&1)for(le=t,f=t.child;f!==null;){for(p=le=f;le!==null;){switch(g=le,v=g.child,g.tag){case 0:case 11:case 14:case 15:jl(4,g,g.return);break;case 1:ia(g,g.return);var E=g.stateNode;if(typeof E.componentWillUnmount=="function"){r=g,n=g.return;try{e=r,E.props=e.memoizedProps,E.state=e.memoizedState,E.componentWillUnmount()}catch(R){yt(r,n,R)}}break;case 5:ia(g,g.return);break;case 22:if(g.memoizedState!==null){wv(p);continue}}v!==null?(v.return=g,le=v):wv(p)}f=f.sibling}e:for(f=null,p=t;;){if(p.tag===5){if(f===null){f=p;try{i=p.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=p.stateNode,l=p.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=Sw("display",o))}catch(R){yt(t,t.return,R)}}}else if(p.tag===6){if(f===null)try{p.stateNode.nodeValue=u?"":p.memoizedProps}catch(R){yt(t,t.return,R)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===t)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===t)break e;for(;p.sibling===null;){if(p.return===null||p.return===t)break e;f===p&&(f=null),p=p.return}f===p&&(f=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:Xn(e,t),Ir(t),r&4&&Ev(t);break;case 21:break;default:Xn(e,t),Ir(t)}}function Ir(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(QS(n)){var r=n;break e}n=n.return}throw Error(te(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(du(i,""),r.flags&=-33);var s=Tv(t);pm(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=Tv(t);fm(t,a,o);break;default:throw Error(te(161))}}catch(l){yt(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function hk(t,e,n){le=t,ZS(t)}function ZS(t,e,n){for(var r=(t.mode&1)!==0;le!==null;){var i=le,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||Hc;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||Jt;a=Hc;var u=Jt;if(Hc=o,(Jt=l)&&!u)for(le=i;le!==null;)o=le,l=o.child,o.tag===22&&o.memoizedState!==null?Sv(i):l!==null?(l.return=o,le=l):Sv(i);for(;s!==null;)le=s,ZS(s),s=s.sibling;le=i,Hc=a,Jt=u}Iv(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,le=s):Iv(t)}}function Iv(t){for(;le!==null;){var e=le;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Jt||Oh(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Jt)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Zn(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&ov(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}ov(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var f=u.memoizedState;if(f!==null){var p=f.dehydrated;p!==null&&mu(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(te(163))}Jt||e.flags&512&&hm(e)}catch(g){yt(e,e.return,g)}}if(e===t){le=null;break}if(n=e.sibling,n!==null){n.return=e.return,le=n;break}le=e.return}}function wv(t){for(;le!==null;){var e=le;if(e===t){le=null;break}var n=e.sibling;if(n!==null){n.return=e.return,le=n;break}le=e.return}}function Sv(t){for(;le!==null;){var e=le;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Oh(4,e)}catch(l){yt(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){yt(e,i,l)}}var s=e.return;try{hm(e)}catch(l){yt(e,s,l)}break;case 5:var o=e.return;try{hm(e)}catch(l){yt(e,o,l)}}}catch(l){yt(e,e.return,l)}if(e===t){le=null;break}var a=e.sibling;if(a!==null){a.return=e.return,le=a;break}le=e.return}}var fk=Math.ceil,Qd=ri.ReactCurrentDispatcher,Jg=ri.ReactCurrentOwner,qn=ri.ReactCurrentBatchConfig,Be=0,Mt=null,wt=null,qt=0,Tn=0,sa=as(0),xt=0,Au=null,ao=0,Bh=0,Qg=0,Jl=null,dn=null,Yg=0,xa=1/0,Or=null,Yd=!1,mm=null,qi=null,Wc=!1,Mi=null,Xd=0,Ql=0,gm=null,dd=-1,hd=0;function sn(){return Be&6?Tt():dd!==-1?dd:dd=Tt()}function Gi(t){return t.mode&1?Be&2&&qt!==0?qt&-qt:QP.transition!==null?(hd===0&&(hd=Fw()),hd):(t=We,t!==0||(t=window.event,t=t===void 0?16:$w(t.type)),t):1}function or(t,e,n,r){if(50<Ql)throw Ql=0,gm=null,Error(te(185));Gu(t,n,r),(!(Be&2)||t!==Mt)&&(t===Mt&&(!(Be&2)&&(Bh|=n),xt===4&&Ri(t,qt)),gn(t,r),n===1&&Be===0&&!(e.mode&1)&&(xa=Tt()+500,Lh&&ls()))}function gn(t,e){var n=t.callbackNode;QR(t,e);var r=Vd(t,t===Mt?qt:0);if(r===0)n!==null&&by(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&by(n),e===1)t.tag===0?JP(Cv.bind(null,t)):uS(Cv.bind(null,t)),HP(function(){!(Be&6)&&ls()}),n=null;else{switch(Uw(r)){case 1:n=wg;break;case 4:n=Vw;break;case 16:n=Md;break;case 536870912:n=Lw;break;default:n=Md}n=aC(n,eC.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function eC(t,e){if(dd=-1,hd=0,Be&6)throw Error(te(327));var n=t.callbackNode;if(fa()&&t.callbackNode!==n)return null;var r=Vd(t,t===Mt?qt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Zd(t,r);else{e=r;var i=Be;Be|=2;var s=nC();(Mt!==t||qt!==e)&&(Or=null,xa=Tt()+500,Ys(t,e));do try{gk();break}catch(a){tC(t,a)}while(!0);Lg(),Qd.current=s,Be=i,wt!==null?e=0:(Mt=null,qt=0,e=xt)}if(e!==0){if(e===2&&(i=zp(t),i!==0&&(r=i,e=_m(t,i))),e===1)throw n=Au,Ys(t,0),Ri(t,r),gn(t,Tt()),n;if(e===6)Ri(t,r);else{if(i=t.current.alternate,!(r&30)&&!pk(i)&&(e=Zd(t,r),e===2&&(s=zp(t),s!==0&&(r=s,e=_m(t,s))),e===1))throw n=Au,Ys(t,0),Ri(t,r),gn(t,Tt()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(te(345));case 2:Us(t,dn,Or);break;case 3:if(Ri(t,r),(r&130023424)===r&&(e=Yg+500-Tt(),10<e)){if(Vd(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){sn(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Yp(Us.bind(null,t,dn,Or),e);break}Us(t,dn,Or);break;case 4:if(Ri(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-sr(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=Tt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*fk(r/1960))-r,10<r){t.timeoutHandle=Yp(Us.bind(null,t,dn,Or),r);break}Us(t,dn,Or);break;case 5:Us(t,dn,Or);break;default:throw Error(te(329))}}}return gn(t,Tt()),t.callbackNode===n?eC.bind(null,t):null}function _m(t,e){var n=Jl;return t.current.memoizedState.isDehydrated&&(Ys(t,e).flags|=256),t=Zd(t,e),t!==2&&(e=dn,dn=n,e!==null&&ym(e)),t}function ym(t){dn===null?dn=t:dn.push.apply(dn,t)}function pk(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!cr(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Ri(t,e){for(e&=~Qg,e&=~Bh,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-sr(e),r=1<<n;t[n]=-1,e&=~r}}function Cv(t){if(Be&6)throw Error(te(327));fa();var e=Vd(t,0);if(!(e&1))return gn(t,Tt()),null;var n=Zd(t,e);if(t.tag!==0&&n===2){var r=zp(t);r!==0&&(e=r,n=_m(t,r))}if(n===1)throw n=Au,Ys(t,0),Ri(t,e),gn(t,Tt()),n;if(n===6)throw Error(te(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Us(t,dn,Or),gn(t,Tt()),null}function Xg(t,e){var n=Be;Be|=1;try{return t(e)}finally{Be=n,Be===0&&(xa=Tt()+500,Lh&&ls())}}function lo(t){Mi!==null&&Mi.tag===0&&!(Be&6)&&fa();var e=Be;Be|=1;var n=qn.transition,r=We;try{if(qn.transition=null,We=1,t)return t()}finally{We=r,qn.transition=n,Be=e,!(Be&6)&&ls()}}function Zg(){Tn=sa.current,ot(sa)}function Ys(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,$P(n)),wt!==null)for(n=wt.return;n!==null;){var r=n;switch(bg(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Bd();break;case 3:Ca(),ot(pn),ot(Zt),Gg();break;case 5:qg(r);break;case 4:Ca();break;case 13:ot(ft);break;case 19:ot(ft);break;case 10:Fg(r.type._context);break;case 22:case 23:Zg()}n=n.return}if(Mt=t,wt=t=zi(t.current,null),qt=Tn=e,xt=0,Au=null,Qg=Bh=ao=0,dn=Jl=null,Ks!==null){for(e=0;e<Ks.length;e++)if(n=Ks[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}Ks=null}return t}function tC(t,e){do{var n=wt;try{if(Lg(),ld.current=Jd,jd){for(var r=mt.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}jd=!1}if(oo=0,bt=At=mt=null,Kl=!1,wu=0,Jg.current=null,n===null||n.return===null){xt=1,Au=e,wt=null;break}e:{var s=t,o=n.return,a=n,l=e;if(e=qt,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,f=a,p=f.tag;if(!(f.mode&1)&&(p===0||p===11||p===15)){var g=f.alternate;g?(f.updateQueue=g.updateQueue,f.memoizedState=g.memoizedState,f.lanes=g.lanes):(f.updateQueue=null,f.memoizedState=null)}var v=hv(o);if(v!==null){v.flags&=-257,fv(v,o,a,s,e),v.mode&1&&dv(s,u,e),e=v,l=u;var E=e.updateQueue;if(E===null){var R=new Set;R.add(l),e.updateQueue=R}else E.add(l);break e}else{if(!(e&1)){dv(s,u,e),e_();break e}l=Error(te(426))}}else if(ct&&a.mode&1){var M=hv(o);if(M!==null){!(M.flags&65536)&&(M.flags|=256),fv(M,o,a,s,e),Mg(Aa(l,a));break e}}s=l=Aa(l,a),xt!==4&&(xt=2),Jl===null?Jl=[s]:Jl.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var A=US(s,l,e);sv(s,A);break e;case 1:a=l;var I=s.type,C=s.stateNode;if(!(s.flags&128)&&(typeof I.getDerivedStateFromError=="function"||C!==null&&typeof C.componentDidCatch=="function"&&(qi===null||!qi.has(C)))){s.flags|=65536,e&=-e,s.lanes|=e;var V=OS(s,a,e);sv(s,V);break e}}s=s.return}while(s!==null)}iC(n)}catch(F){e=F,wt===n&&n!==null&&(wt=n=n.return);continue}break}while(!0)}function nC(){var t=Qd.current;return Qd.current=Jd,t===null?Jd:t}function e_(){(xt===0||xt===3||xt===2)&&(xt=4),Mt===null||!(ao&268435455)&&!(Bh&268435455)||Ri(Mt,qt)}function Zd(t,e){var n=Be;Be|=2;var r=nC();(Mt!==t||qt!==e)&&(Or=null,Ys(t,e));do try{mk();break}catch(i){tC(t,i)}while(!0);if(Lg(),Be=n,Qd.current=r,wt!==null)throw Error(te(261));return Mt=null,qt=0,xt}function mk(){for(;wt!==null;)rC(wt)}function gk(){for(;wt!==null&&!qR();)rC(wt)}function rC(t){var e=oC(t.alternate,t,Tn);t.memoizedProps=t.pendingProps,e===null?iC(t):wt=e,Jg.current=null}function iC(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=uk(n,e),n!==null){n.flags&=32767,wt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{xt=6,wt=null;return}}else if(n=lk(n,e,Tn),n!==null){wt=n;return}if(e=e.sibling,e!==null){wt=e;return}wt=e=t}while(e!==null);xt===0&&(xt=5)}function Us(t,e,n){var r=We,i=qn.transition;try{qn.transition=null,We=1,_k(t,e,n,r)}finally{qn.transition=i,We=r}return null}function _k(t,e,n,r){do fa();while(Mi!==null);if(Be&6)throw Error(te(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(te(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(YR(t,s),t===Mt&&(wt=Mt=null,qt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Wc||(Wc=!0,aC(Md,function(){return fa(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=qn.transition,qn.transition=null;var o=We;We=1;var a=Be;Be|=4,Jg.current=null,dk(t,n),XS(n,t),FP(Jp),Ld=!!jp,Jp=jp=null,t.current=n,hk(n),GR(),Be=a,We=o,qn.transition=s}else t.current=n;if(Wc&&(Wc=!1,Mi=t,Xd=i),s=t.pendingLanes,s===0&&(qi=null),HR(n.stateNode),gn(t,Tt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Yd)throw Yd=!1,t=mm,mm=null,t;return Xd&1&&t.tag!==0&&fa(),s=t.pendingLanes,s&1?t===gm?Ql++:(Ql=0,gm=t):Ql=0,ls(),null}function fa(){if(Mi!==null){var t=Uw(Xd),e=qn.transition,n=We;try{if(qn.transition=null,We=16>t?16:t,Mi===null)var r=!1;else{if(t=Mi,Mi=null,Xd=0,Be&6)throw Error(te(331));var i=Be;for(Be|=4,le=t.current;le!==null;){var s=le,o=s.child;if(le.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(le=u;le!==null;){var f=le;switch(f.tag){case 0:case 11:case 15:jl(8,f,s)}var p=f.child;if(p!==null)p.return=f,le=p;else for(;le!==null;){f=le;var g=f.sibling,v=f.return;if(JS(f),f===u){le=null;break}if(g!==null){g.return=v,le=g;break}le=v}}}var E=s.alternate;if(E!==null){var R=E.child;if(R!==null){E.child=null;do{var M=R.sibling;R.sibling=null,R=M}while(R!==null)}}le=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,le=o;else e:for(;le!==null;){if(s=le,s.flags&2048)switch(s.tag){case 0:case 11:case 15:jl(9,s,s.return)}var A=s.sibling;if(A!==null){A.return=s.return,le=A;break e}le=s.return}}var I=t.current;for(le=I;le!==null;){o=le;var C=o.child;if(o.subtreeFlags&2064&&C!==null)C.return=o,le=C;else e:for(o=I;le!==null;){if(a=le,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Oh(9,a)}}catch(F){yt(a,a.return,F)}if(a===o){le=null;break e}var V=a.sibling;if(V!==null){V.return=a.return,le=V;break e}le=a.return}}if(Be=i,ls(),Rr&&typeof Rr.onPostCommitFiberRoot=="function")try{Rr.onPostCommitFiberRoot(Nh,t)}catch{}r=!0}return r}finally{We=n,qn.transition=e}}return!1}function Av(t,e,n){e=Aa(n,e),e=US(t,e,1),t=Bi(t,e,1),e=sn(),t!==null&&(Gu(t,1,e),gn(t,e))}function yt(t,e,n){if(t.tag===3)Av(t,t,n);else for(;e!==null;){if(e.tag===3){Av(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(qi===null||!qi.has(r))){t=Aa(n,t),t=OS(e,t,1),e=Bi(e,t,1),t=sn(),e!==null&&(Gu(e,1,t),gn(e,t));break}}e=e.return}}function yk(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=sn(),t.pingedLanes|=t.suspendedLanes&n,Mt===t&&(qt&n)===n&&(xt===4||xt===3&&(qt&130023424)===qt&&500>Tt()-Yg?Ys(t,0):Qg|=n),gn(t,e)}function sC(t,e){e===0&&(t.mode&1?(e=Lc,Lc<<=1,!(Lc&130023424)&&(Lc=4194304)):e=1);var n=sn();t=Yr(t,e),t!==null&&(Gu(t,e,n),gn(t,n))}function vk(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),sC(t,n)}function Tk(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(te(314))}r!==null&&r.delete(e),sC(t,n)}var oC;oC=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||pn.current)hn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return hn=!1,ak(t,e,n);hn=!!(t.flags&131072)}else hn=!1,ct&&e.flags&1048576&&cS(e,zd,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;cd(t,e),t=e.pendingProps;var i=Ia(e,Zt.current);ha(e,n),i=$g(null,e,r,t,i,n);var s=Hg();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,mn(r)?(s=!0,qd(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Og(e),i.updater=Uh,e.stateNode=i,i._reactInternals=e,im(e,r,t,n),e=am(null,e,r,!0,s,n)):(e.tag=0,ct&&s&&Dg(e),tn(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(cd(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=Ik(r),t=Zn(r,t),i){case 0:e=om(null,e,r,t,n);break e;case 1:e=gv(null,e,r,t,n);break e;case 11:e=pv(null,e,r,t,n);break e;case 14:e=mv(null,e,r,Zn(r.type,t),n);break e}throw Error(te(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Zn(r,i),om(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Zn(r,i),gv(t,e,r,i,n);case 3:e:{if(zS(e),t===null)throw Error(te(387));r=e.pendingProps,s=e.memoizedState,i=s.element,gS(t,e),Wd(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Aa(Error(te(423)),e),e=_v(t,e,r,n,i);break e}else if(r!==i){i=Aa(Error(te(424)),e),e=_v(t,e,r,n,i);break e}else for(wn=Oi(e.stateNode.containerInfo.firstChild),Cn=e,ct=!0,nr=null,n=pS(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(wa(),r===i){e=Xr(t,e,n);break e}tn(t,e,r,n)}e=e.child}return e;case 5:return _S(e),t===null&&tm(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,Qp(r,i)?o=null:s!==null&&Qp(r,s)&&(e.flags|=32),GS(t,e),tn(t,e,o,n),e.child;case 6:return t===null&&tm(e),null;case 13:return $S(t,e,n);case 4:return Bg(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Sa(e,null,r,n):tn(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Zn(r,i),pv(t,e,r,i,n);case 7:return tn(t,e,e.pendingProps,n),e.child;case 8:return tn(t,e,e.pendingProps.children,n),e.child;case 12:return tn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,nt($d,r._currentValue),r._currentValue=o,s!==null)if(cr(s.value,o)){if(s.children===i.children&&!pn.current){e=Xr(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=Kr(-1,n&-n),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var f=u.pending;f===null?l.next=l:(l.next=f.next,f.next=l),u.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),nm(s.return,n,e),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(te(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),nm(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}tn(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,ha(e,n),i=$n(i),r=r(i),e.flags|=1,tn(t,e,r,n),e.child;case 14:return r=e.type,i=Zn(r,e.pendingProps),i=Zn(r.type,i),mv(t,e,r,i,n);case 15:return BS(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Zn(r,i),cd(t,e),e.tag=1,mn(r)?(t=!0,qd(e)):t=!1,ha(e,n),FS(e,r,i),im(e,r,i,n),am(null,e,r,!0,t,n);case 19:return HS(t,e,n);case 22:return qS(t,e,n)}throw Error(te(156,e.tag))};function aC(t,e){return Mw(t,e)}function Ek(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Un(t,e,n,r){return new Ek(t,e,n,r)}function t_(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Ik(t){if(typeof t=="function")return t_(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Tg)return 11;if(t===Eg)return 14}return 2}function zi(t,e){var n=t.alternate;return n===null?(n=Un(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function fd(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")t_(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Jo:return Xs(n.children,i,s,e);case vg:o=8,i|=8;break;case Rp:return t=Un(12,n,e,i|2),t.elementType=Rp,t.lanes=s,t;case Pp:return t=Un(13,n,e,i),t.elementType=Pp,t.lanes=s,t;case kp:return t=Un(19,n,e,i),t.elementType=kp,t.lanes=s,t;case _w:return qh(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case mw:o=10;break e;case gw:o=9;break e;case Tg:o=11;break e;case Eg:o=14;break e;case Ci:o=16,r=null;break e}throw Error(te(130,t==null?t:typeof t,""))}return e=Un(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function Xs(t,e,n,r){return t=Un(7,t,r,e),t.lanes=n,t}function qh(t,e,n,r){return t=Un(22,t,r,e),t.elementType=_w,t.lanes=n,t.stateNode={isHidden:!1},t}function lp(t,e,n){return t=Un(6,t,null,e),t.lanes=n,t}function up(t,e,n){return e=Un(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function wk(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zf(0),this.expirationTimes=zf(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zf(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function n_(t,e,n,r,i,s,o,a,l){return t=new wk(t,e,n,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Un(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Og(s),t}function Sk(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:jo,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function lC(t){if(!t)return Xi;t=t._reactInternals;e:{if(To(t)!==t||t.tag!==1)throw Error(te(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(mn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(te(171))}if(t.tag===1){var n=t.type;if(mn(n))return lS(t,n,e)}return e}function uC(t,e,n,r,i,s,o,a,l){return t=n_(n,r,!0,t,i,s,o,a,l),t.context=lC(null),n=t.current,r=sn(),i=Gi(n),s=Kr(r,i),s.callback=e??null,Bi(n,s,i),t.current.lanes=i,Gu(t,i,r),gn(t,r),t}function Gh(t,e,n,r){var i=e.current,s=sn(),o=Gi(i);return n=lC(n),e.context===null?e.context=n:e.pendingContext=n,e=Kr(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Bi(i,e,o),t!==null&&(or(t,i,o,s),ad(t,i,o)),o}function eh(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function xv(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function r_(t,e){xv(t,e),(t=t.alternate)&&xv(t,e)}function Ck(){return null}var cC=typeof reportError=="function"?reportError:function(t){console.error(t)};function i_(t){this._internalRoot=t}zh.prototype.render=i_.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(te(409));Gh(t,e,null,null)};zh.prototype.unmount=i_.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;lo(function(){Gh(null,t,null,null)}),e[Qr]=null}};function zh(t){this._internalRoot=t}zh.prototype.unstable_scheduleHydration=function(t){if(t){var e=qw();t={blockedOn:null,target:t,priority:e};for(var n=0;n<xi.length&&e!==0&&e<xi[n].priority;n++);xi.splice(n,0,t),n===0&&zw(t)}};function s_(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function $h(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Rv(){}function Ak(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var u=eh(o);s.call(u)}}var o=uC(e,r,t,0,null,!1,!1,"",Rv);return t._reactRootContainer=o,t[Qr]=o.current,yu(t.nodeType===8?t.parentNode:t),lo(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var u=eh(l);a.call(u)}}var l=n_(t,0,!1,null,null,!1,!1,"",Rv);return t._reactRootContainer=l,t[Qr]=l.current,yu(t.nodeType===8?t.parentNode:t),lo(function(){Gh(e,l,n,r)}),l}function Hh(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=eh(o);a.call(l)}}Gh(e,o,t,i)}else o=Ak(n,e,t,i,r);return eh(o)}Ow=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Ml(e.pendingLanes);n!==0&&(Sg(e,n|1),gn(e,Tt()),!(Be&6)&&(xa=Tt()+500,ls()))}break;case 13:lo(function(){var r=Yr(t,1);if(r!==null){var i=sn();or(r,t,1,i)}}),r_(t,1)}};Cg=function(t){if(t.tag===13){var e=Yr(t,134217728);if(e!==null){var n=sn();or(e,t,134217728,n)}r_(t,134217728)}};Bw=function(t){if(t.tag===13){var e=Gi(t),n=Yr(t,e);if(n!==null){var r=sn();or(n,t,e,r)}r_(t,e)}};qw=function(){return We};Gw=function(t,e){var n=We;try{return We=t,e()}finally{We=n}};Bp=function(t,e,n){switch(e){case"input":if(bp(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=Vh(r);if(!i)throw Error(te(90));vw(r),bp(r,i)}}}break;case"textarea":Ew(t,n);break;case"select":e=n.value,e!=null&&la(t,!!n.multiple,e,!1)}};Rw=Xg;Pw=lo;var xk={usingClientEntryPoint:!1,Events:[$u,Zo,Vh,Aw,xw,Xg]},Sl={findFiberByHostInstance:Ws,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Rk={bundleType:Sl.bundleType,version:Sl.version,rendererPackageName:Sl.rendererPackageName,rendererConfig:Sl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ri.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Dw(t),t===null?null:t.stateNode},findFiberByHostInstance:Sl.findFiberByHostInstance||Ck,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Kc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Kc.isDisabled&&Kc.supportsFiber)try{Nh=Kc.inject(Rk),Rr=Kc}catch{}}Rn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xk;Rn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!s_(e))throw Error(te(200));return Sk(t,e,null,n)};Rn.createRoot=function(t,e){if(!s_(t))throw Error(te(299));var n=!1,r="",i=cC;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=n_(t,1,!1,null,null,n,!1,r,i),t[Qr]=e.current,yu(t.nodeType===8?t.parentNode:t),new i_(e)};Rn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(te(188)):(t=Object.keys(t).join(","),Error(te(268,t)));return t=Dw(e),t=t===null?null:t.stateNode,t};Rn.flushSync=function(t){return lo(t)};Rn.hydrate=function(t,e,n){if(!$h(e))throw Error(te(200));return Hh(null,t,e,!0,n)};Rn.hydrateRoot=function(t,e,n){if(!s_(t))throw Error(te(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=cC;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=uC(e,null,t,1,n??null,i,!1,s,o),t[Qr]=e.current,yu(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new zh(e)};Rn.render=function(t,e,n){if(!$h(e))throw Error(te(200));return Hh(null,t,e,!1,n)};Rn.unmountComponentAtNode=function(t){if(!$h(t))throw Error(te(40));return t._reactRootContainer?(lo(function(){Hh(null,null,t,!1,function(){t._reactRootContainer=null,t[Qr]=null})}),!0):!1};Rn.unstable_batchedUpdates=Xg;Rn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!$h(n))throw Error(te(200));if(t==null||t._reactInternals===void 0)throw Error(te(38));return Hh(t,e,n,!1,r)};Rn.version="18.3.1-next-f1338f8080-20240426";function dC(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(dC)}catch(t){console.error(t)}}dC(),dw.exports=Rn;var hC=dw.exports;const Pk=XI(hC);var Pv=hC;Ap.createRoot=Pv.createRoot,Ap.hydrateRoot=Pv.hydrateRoot;const kk="modulepreload",Nk=function(t){return"/Nova-AI-Planer-beta-/"+t},kv={},Ms=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(n.map(l=>{if(l=Nk(l),l in kv)return;kv[l]=!0;const u=l.endsWith(".css"),f=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${f}`))return;const p=document.createElement("link");if(p.rel=u?"stylesheet":kk,u||(p.as="script"),p.crossOrigin="",p.href=l,a&&p.setAttribute("nonce",a),document.head.appendChild(p),u)return new Promise((g,v)=>{p.addEventListener("load",g),p.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return i.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return e().catch(s)})};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let Dk,bk;function Mk(){return{geminiUrl:Dk,vertexUrl:bk}}function Vk(t,e,n,r){var i,s;if(!(t!=null&&t.baseUrl)){const o=Mk();return e?(i=o.vertexUrl)!==null&&i!==void 0?i:n:(s=o.geminiUrl)!==null&&s!==void 0?s:r}return t.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Eo{}function ce(t,e){const n=/\{([^}]+)\}/g;return t.replace(n,(r,i)=>{if(Object.prototype.hasOwnProperty.call(e,i)){const s=e[i];return s!=null?String(s):""}else throw new Error(`Key '${i}' not found in valueMap.`)})}function h(t,e,n){for(let s=0;s<e.length-1;s++){const o=e[s];if(o.endsWith("[]")){const a=o.slice(0,-2);if(!(a in t))if(Array.isArray(n))t[a]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${o}`);if(Array.isArray(t[a])){const l=t[a];if(Array.isArray(n))for(let u=0;u<l.length;u++){const f=l[u];h(f,e.slice(s+1),n[u])}else for(const u of l)h(u,e.slice(s+1),n)}return}else if(o.endsWith("[0]")){const a=o.slice(0,-3);a in t||(t[a]=[{}]);const l=t[a];h(l[0],e.slice(s+1),n);return}(!t[o]||typeof t[o]!="object")&&(t[o]={}),t=t[o]}const r=e[e.length-1],i=t[r];if(i!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===i)return;if(typeof i=="object"&&typeof n=="object"&&i!==null&&n!==null)Object.assign(i,n);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else r==="_self"&&typeof n=="object"&&n!==null&&!Array.isArray(n)?Object.assign(t,n):t[r]=n}function c(t,e,n=void 0){try{if(e.length===1&&e[0]==="_self")return t;for(let r=0;r<e.length;r++){if(typeof t!="object"||t===null)return n;const i=e[r];if(i.endsWith("[]")){const s=i.slice(0,-2);if(s in t){const o=t[s];return Array.isArray(o)?o.map(a=>c(a,e.slice(r+1),n)):n}else return n}else t=t[i]}return t}catch(r){if(r instanceof TypeError)return n;throw r}}function Lk(t,e){for(const[n,r]of Object.entries(e)){const i=n.split("."),s=r.split("."),o=new Set;let a=-1;for(let l=0;l<i.length;l++)if(i[l]==="*"){a=l;break}if(a!==-1&&s.length>a)for(let l=a;l<s.length;l++){const u=s[l];u!=="*"&&!u.endsWith("[]")&&!u.endsWith("[0]")&&o.add(u)}vm(t,i,s,0,o)}}function vm(t,e,n,r,i){if(r>=e.length||typeof t!="object"||t===null)return;const s=e[r];if(s.endsWith("[]")){const o=s.slice(0,-2),a=t;if(o in a&&Array.isArray(a[o]))for(const l of a[o])vm(l,e,n,r+1,i)}else if(s==="*"){if(typeof t=="object"&&t!==null&&!Array.isArray(t)){const o=t,a=Object.keys(o).filter(u=>!u.startsWith("_")&&!i.has(u)),l={};for(const u of a)l[u]=o[u];for(const[u,f]of Object.entries(l)){const p=[];for(const g of n.slice(r))g==="*"?p.push(u):p.push(g);h(o,p,f)}for(const u of a)delete o[u]}}else{const o=t;s in o&&vm(o[s],e,n,r+1,i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function o_(t){if(typeof t!="string")throw new Error("fromImageBytes must be a string");return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Fk(t){const e={},n=c(t,["operationName"]);n!=null&&h(e,["operationName"],n);const r=c(t,["resourceName"]);return r!=null&&h(e,["_url","resourceName"],r),e}function Uk(t){const e={},n=c(t,["name"]);n!=null&&h(e,["name"],n);const r=c(t,["metadata"]);r!=null&&h(e,["metadata"],r);const i=c(t,["done"]);i!=null&&h(e,["done"],i);const s=c(t,["error"]);s!=null&&h(e,["error"],s);const o=c(t,["response","generateVideoResponse"]);return o!=null&&h(e,["response"],Bk(o)),e}function Ok(t){const e={},n=c(t,["name"]);n!=null&&h(e,["name"],n);const r=c(t,["metadata"]);r!=null&&h(e,["metadata"],r);const i=c(t,["done"]);i!=null&&h(e,["done"],i);const s=c(t,["error"]);s!=null&&h(e,["error"],s);const o=c(t,["response"]);return o!=null&&h(e,["response"],qk(o)),e}function Bk(t){const e={},n=c(t,["generatedSamples"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>Gk(o))),h(e,["generatedVideos"],s)}const r=c(t,["raiMediaFilteredCount"]);r!=null&&h(e,["raiMediaFilteredCount"],r);const i=c(t,["raiMediaFilteredReasons"]);return i!=null&&h(e,["raiMediaFilteredReasons"],i),e}function qk(t){const e={},n=c(t,["videos"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>zk(o))),h(e,["generatedVideos"],s)}const r=c(t,["raiMediaFilteredCount"]);r!=null&&h(e,["raiMediaFilteredCount"],r);const i=c(t,["raiMediaFilteredReasons"]);return i!=null&&h(e,["raiMediaFilteredReasons"],i),e}function Gk(t){const e={},n=c(t,["video"]);return n!=null&&h(e,["video"],Wk(n)),e}function zk(t){const e={},n=c(t,["_self"]);return n!=null&&h(e,["video"],Kk(n)),e}function $k(t){const e={},n=c(t,["operationName"]);return n!=null&&h(e,["_url","operationName"],n),e}function Hk(t){const e={},n=c(t,["operationName"]);return n!=null&&h(e,["_url","operationName"],n),e}function Wk(t){const e={},n=c(t,["uri"]);n!=null&&h(e,["uri"],n);const r=c(t,["encodedVideo"]);r!=null&&h(e,["videoBytes"],o_(r));const i=c(t,["encoding"]);return i!=null&&h(e,["mimeType"],i),e}function Kk(t){const e={},n=c(t,["gcsUri"]);n!=null&&h(e,["uri"],n);const r=c(t,["bytesBase64Encoded"]);r!=null&&h(e,["videoBytes"],o_(r));const i=c(t,["mimeType"]);return i!=null&&h(e,["mimeType"],i),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Nv;(function(t){t.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",t.OUTCOME_OK="OUTCOME_OK",t.OUTCOME_FAILED="OUTCOME_FAILED",t.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Nv||(Nv={}));var Dv;(function(t){t.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",t.PYTHON="PYTHON"})(Dv||(Dv={}));var On;(function(t){t.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",t.STRING="STRING",t.NUMBER="NUMBER",t.INTEGER="INTEGER",t.BOOLEAN="BOOLEAN",t.ARRAY="ARRAY",t.OBJECT="OBJECT",t.NULL="NULL"})(On||(On={}));var bv;(function(t){t.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",t.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",t.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",t.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",t.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",t.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",t.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",t.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",t.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT"})(bv||(bv={}));var Mv;(function(t){t.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",t.SEVERITY="SEVERITY",t.PROBABILITY="PROBABILITY"})(Mv||(Mv={}));var Vv;(function(t){t.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE",t.OFF="OFF"})(Vv||(Vv={}));var Lv;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(Lv||(Lv={}));var Fv;(function(t){t.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",t.NO_AUTH="NO_AUTH",t.API_KEY_AUTH="API_KEY_AUTH",t.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",t.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",t.OAUTH="OAUTH",t.OIDC_AUTH="OIDC_AUTH"})(Fv||(Fv={}));var Uv;(function(t){t.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",t.SIMPLE_SEARCH="SIMPLE_SEARCH",t.ELASTIC_SEARCH="ELASTIC_SEARCH"})(Uv||(Uv={}));var Ov;(function(t){t.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",t.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",t.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",t.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",t.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(Ov||(Ov={}));var Bv;(function(t){t.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.LANGUAGE="LANGUAGE",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.SPII="SPII",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.IMAGE_SAFETY="IMAGE_SAFETY",t.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",t.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",t.NO_IMAGE="NO_IMAGE"})(Bv||(Bv={}));var qv;(function(t){t.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",t.NEGLIGIBLE="NEGLIGIBLE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH"})(qv||(qv={}));var Gv;(function(t){t.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",t.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",t.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",t.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",t.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(Gv||(Gv={}));var zv;(function(t){t.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",t.SAFETY="SAFETY",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.IMAGE_SAFETY="IMAGE_SAFETY"})(zv||(zv={}));var $v;(function(t){t.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",t.ON_DEMAND="ON_DEMAND",t.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})($v||($v={}));var th;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.AUDIO="AUDIO"})(th||(th={}));var Hv;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(Hv||(Hv={}));var Tm;(function(t){t.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",t.JOB_STATE_QUEUED="JOB_STATE_QUEUED",t.JOB_STATE_PENDING="JOB_STATE_PENDING",t.JOB_STATE_RUNNING="JOB_STATE_RUNNING",t.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",t.JOB_STATE_FAILED="JOB_STATE_FAILED",t.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",t.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",t.JOB_STATE_PAUSED="JOB_STATE_PAUSED",t.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",t.JOB_STATE_UPDATING="JOB_STATE_UPDATING",t.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Tm||(Tm={}));var Wv;(function(t){t.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",t.TUNING_MODE_FULL="TUNING_MODE_FULL",t.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(Wv||(Wv={}));var Kv;(function(t){t.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",t.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",t.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",t.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",t.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",t.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",t.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(Kv||(Kv={}));var jv;(function(t){t.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",t.TUNING_TASK_I2V="TUNING_TASK_I2V",t.TUNING_TASK_T2V="TUNING_TASK_T2V"})(jv||(jv={}));var Jv;(function(t){t.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",t.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",t.BALANCED="BALANCED",t.PRIORITIZE_COST="PRIORITIZE_COST"})(Jv||(Jv={}));var Qv;(function(t){t.UNSPECIFIED="UNSPECIFIED",t.BLOCKING="BLOCKING",t.NON_BLOCKING="NON_BLOCKING"})(Qv||(Qv={}));var Yv;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(Yv||(Yv={}));var Xv;(function(t){t.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",t.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(Xv||(Xv={}));var Zv;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.AUTO="AUTO",t.ANY="ANY",t.NONE="NONE",t.VALIDATED="VALIDATED"})(Zv||(Zv={}));var eT;(function(t){t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE"})(eT||(eT={}));var tT;(function(t){t.DONT_ALLOW="DONT_ALLOW",t.ALLOW_ADULT="ALLOW_ADULT",t.ALLOW_ALL="ALLOW_ALL"})(tT||(tT={}));var nT;(function(t){t.auto="auto",t.en="en",t.ja="ja",t.ko="ko",t.hi="hi",t.zh="zh",t.pt="pt",t.es="es"})(nT||(nT={}));var rT;(function(t){t.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",t.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",t.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",t.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",t.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(rT||(rT={}));var iT;(function(t){t.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",t.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",t.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",t.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(iT||(iT={}));var sT;(function(t){t.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",t.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",t.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",t.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(sT||(sT={}));var oT;(function(t){t.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",t.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",t.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",t.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",t.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",t.EDIT_MODE_STYLE="EDIT_MODE_STYLE",t.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",t.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(oT||(oT={}));var aT;(function(t){t.FOREGROUND="FOREGROUND",t.BACKGROUND="BACKGROUND",t.PROMPT="PROMPT",t.SEMANTIC="SEMANTIC",t.INTERACTIVE="INTERACTIVE"})(aT||(aT={}));var lT;(function(t){t.ASSET="ASSET",t.STYLE="STYLE"})(lT||(lT={}));var uT;(function(t){t.INSERT="INSERT",t.REMOVE="REMOVE",t.REMOVE_STATIC="REMOVE_STATIC",t.OUTPAINT="OUTPAINT"})(uT||(uT={}));var cT;(function(t){t.OPTIMIZED="OPTIMIZED",t.LOSSLESS="LOSSLESS"})(cT||(cT={}));var dT;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.PROCESSING="PROCESSING",t.ACTIVE="ACTIVE",t.FAILED="FAILED"})(dT||(dT={}));var hT;(function(t){t.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",t.UPLOADED="UPLOADED",t.GENERATED="GENERATED"})(hT||(hT={}));var fT;(function(t){t.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.RESPONSE_REJECTED="RESPONSE_REJECTED",t.NEED_MORE_INPUT="NEED_MORE_INPUT"})(fT||(fT={}));var pT;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.VIDEO="VIDEO",t.AUDIO="AUDIO",t.DOCUMENT="DOCUMENT"})(pT||(pT={}));var mT;(function(t){t.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",t.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",t.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(mT||(mT={}));var gT;(function(t){t.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",t.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",t.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(gT||(gT={}));var _T;(function(t){t.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",t.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",t.NO_INTERRUPTION="NO_INTERRUPTION"})(_T||(_T={}));var yT;(function(t){t.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",t.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",t.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(yT||(yT={}));var vT;(function(t){t.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",t.SILENT="SILENT",t.WHEN_IDLE="WHEN_IDLE",t.INTERRUPT="INTERRUPT"})(vT||(vT={}));var TT;(function(t){t.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",t.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",t.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",t.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",t.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",t.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",t.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",t.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",t.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",t.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",t.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",t.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",t.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(TT||(TT={}));var ET;(function(t){t.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",t.QUALITY="QUALITY",t.DIVERSITY="DIVERSITY",t.VOCALIZATION="VOCALIZATION"})(ET||(ET={}));var oa;(function(t){t.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",t.PLAY="PLAY",t.PAUSE="PAUSE",t.STOP="STOP",t.RESET_CONTEXT="RESET_CONTEXT"})(oa||(oa={}));class Em{constructor(e){const n={};for(const r of e.headers.entries())n[r[0]]=r[1];this.headers=n,this.responseInternal=e}json(){return this.responseInternal.json()}}class Cl{get text(){var e,n,r,i,s,o,a,l;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let u="",f=!1;const p=[];for(const g of(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)!==null&&l!==void 0?l:[]){for(const[v,E]of Object.entries(g))v!=="text"&&v!=="thought"&&(E!==null||E!==void 0)&&p.push(v);if(typeof g.text=="string"){if(typeof g.thought=="boolean"&&g.thought)continue;f=!0,u+=g.text}}return p.length>0&&console.warn(`there are non-text parts ${p} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),f?u:void 0}get data(){var e,n,r,i,s,o,a,l;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let u="";const f=[];for(const p of(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)!==null&&l!==void 0?l:[]){for(const[g,v]of Object.entries(p))g!=="inlineData"&&(v!==null||v!==void 0)&&f.push(g);p.inlineData&&typeof p.inlineData.data=="string"&&(u+=atob(p.inlineData.data))}return f.length>0&&console.warn(`there are non-data parts ${f} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),u.length>0?btoa(u):void 0}get functionCalls(){var e,n,r,i,s,o,a,l;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const u=(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(f=>f.functionCall).map(f=>f.functionCall).filter(f=>f!==void 0);if((u==null?void 0:u.length)!==0)return u}get executableCode(){var e,n,r,i,s,o,a,l,u;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const f=(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(p=>p.executableCode).map(p=>p.executableCode).filter(p=>p!==void 0);if((f==null?void 0:f.length)!==0)return(u=f==null?void 0:f[0])===null||u===void 0?void 0:u.code}get codeExecutionResult(){var e,n,r,i,s,o,a,l,u;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const f=(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(p=>p.codeExecutionResult).map(p=>p.codeExecutionResult).filter(p=>p!==void 0);if((f==null?void 0:f.length)!==0)return(u=f==null?void 0:f[0])===null||u===void 0?void 0:u.output}}class IT{}class wT{}class jk{}class Jk{}class Qk{}class Yk{}class ST{}class CT{}class AT{}class Xk{}class nh{_fromAPIResponse({apiResponse:e,isVertexAI:n}){const r=new nh;let i;const s=e;return n?i=Ok(s):i=Uk(s),Object.assign(r,i),r}}class xT{}class RT{}class PT{}class Zk{}class e1{}class t1{}class kT{}class n1{get text(){var e,n,r;let i="",s=!1;const o=[];for(const a of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[l,u]of Object.entries(a))l!=="text"&&l!=="thought"&&u!==null&&o.push(l);if(typeof a.text=="string"){if(typeof a.thought=="boolean"&&a.thought)continue;s=!0,i+=a.text}}return o.length>0&&console.warn(`there are non-text parts ${o} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),s?i:void 0}get data(){var e,n,r;let i="";const s=[];for(const o of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[a,l]of Object.entries(o))a!=="inlineData"&&l!==null&&s.push(a);o.inlineData&&typeof o.inlineData.data=="string"&&(i+=atob(o.inlineData.data))}return s.length>0&&console.warn(`there are non-data parts ${s} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),i.length>0?btoa(i):void 0}}class r1{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function qe(t,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(t.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const n=e.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function fC(t,e){const n=qe(t,e);return n?n.startsWith("publishers/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}`:n.startsWith("models/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/publishers/google/${n}`:n:""}function pC(t){return Array.isArray(t)?t.map(e=>rh(e)):[rh(t)]}function rh(t){if(typeof t=="object"&&t!==null)return t;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof t}`)}function mC(t){const e=rh(t);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function gC(t){const e=rh(t);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function NT(t){if(t==null)throw new Error("PartUnion is required");if(typeof t=="object")return t;if(typeof t=="string")return{text:t};throw new Error(`Unsupported part type: ${typeof t}`)}function _C(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("PartListUnion is required");return Array.isArray(t)?t.map(e=>NT(e)):[NT(t)]}function Im(t){return t!=null&&typeof t=="object"&&"parts"in t&&Array.isArray(t.parts)}function DT(t){return t!=null&&typeof t=="object"&&"functionCall"in t}function bT(t){return t!=null&&typeof t=="object"&&"functionResponse"in t}function Yt(t){if(t==null)throw new Error("ContentUnion is required");return Im(t)?t:{role:"user",parts:_C(t)}}function a_(t,e){if(!e)return[];if(t.isVertexAI()&&Array.isArray(e))return e.flatMap(n=>{const r=Yt(n);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(t.isVertexAI()){const n=Yt(e);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(e)?e.map(n=>Yt(n)):[Yt(e)]}function Gn(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("contents are required");if(!Array.isArray(t)){if(DT(t)||bT(t))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Yt(t)]}const e=[],n=[],r=Im(t[0]);for(const i of t){const s=Im(i);if(s!=r)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(s)e.push(i);else{if(DT(i)||bT(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(i)}}return r||e.push({role:"user",parts:_C(n)}),e}function i1(t,e){t.includes("null")&&(e.nullable=!0);const n=t.filter(r=>r!=="null");if(n.length===1)e.type=Object.values(On).includes(n[0].toUpperCase())?n[0].toUpperCase():On.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const r of n)e.anyOf.push({type:Object.values(On).includes(r.toUpperCase())?r.toUpperCase():On.TYPE_UNSPECIFIED})}}function pa(t){const e={},n=["items"],r=["anyOf"],i=["properties"];if(t.type&&t.anyOf)throw new Error("type and anyOf cannot be both populated.");const s=t.anyOf;s!=null&&s.length==2&&(s[0].type==="null"?(e.nullable=!0,t=s[1]):s[1].type==="null"&&(e.nullable=!0,t=s[0])),t.type instanceof Array&&i1(t.type,e);for(const[o,a]of Object.entries(t))if(a!=null)if(o=="type"){if(a==="null")throw new Error("type: null can not be the only possible type for the field.");if(a instanceof Array)continue;e.type=Object.values(On).includes(a.toUpperCase())?a.toUpperCase():On.TYPE_UNSPECIFIED}else if(n.includes(o))e[o]=pa(a);else if(r.includes(o)){const l=[];for(const u of a){if(u.type=="null"){e.nullable=!0;continue}l.push(pa(u))}e[o]=l}else if(i.includes(o)){const l={};for(const[u,f]of Object.entries(a))l[u]=pa(f);e[o]=l}else{if(o==="additionalProperties")continue;e[o]=a}return e}function l_(t){return pa(t)}function u_(t){if(typeof t=="object")return t;if(typeof t=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:t}}};throw new Error(`Unsupported speechConfig type: ${typeof t}`)}function c_(t){if("multiSpeakerVoiceConfig"in t)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return t}function Ka(t){if(t.functionDeclarations)for(const e of t.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=pa(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=pa(e.response));return t}function ja(t){if(t==null)throw new Error("tools is required");if(!Array.isArray(t))throw new Error("tools is required and must be an array of Tools");const e=[];for(const n of t)e.push(n);return e}function s1(t,e,n,r=1){const i=!e.startsWith(`${n}/`)&&e.split("/").length===r;return t.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${t.getProject()}/${e}`:e.startsWith(`${n}/`)?`projects/${t.getProject()}/locations/${t.getLocation()}/${e}`:i?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}/${e}`:e:i?`${n}/${e}`:e}function ii(t,e){if(typeof e!="string")throw new Error("name must be a string");return s1(t,e,"cachedContents")}function yC(t){switch(t){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return t}}function us(t){return o_(t)}function o1(t){return t!=null&&typeof t=="object"&&"name"in t}function a1(t){return t!=null&&typeof t=="object"&&"video"in t}function l1(t){return t!=null&&typeof t=="object"&&"uri"in t}function vC(t){var e;let n;if(o1(t)&&(n=t.name),!(l1(t)&&(n=t.uri,n===void 0))&&!(a1(t)&&(n=(e=t.video)===null||e===void 0?void 0:e.uri,n===void 0))){if(typeof t=="string"&&(n=t),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const i=n.split("files/")[1].match(/[a-z0-9]+/);if(i===null)throw new Error(`Could not extract file name from URI ${n}`);n=i[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function TC(t,e){let n;return t.isVertexAI()?n=e?"publishers/google/models":"models":n=e?"models":"tunedModels",n}function EC(t){for(const e of["models","tunedModels","publisherModels"])if(u1(t,e))return t[e];return[]}function u1(t,e){return t!==null&&typeof t=="object"&&e in t}function c1(t,e={}){const n=t,r={name:n.name,description:n.description,parametersJsonSchema:n.inputSchema};return n.outputSchema&&(r.responseJsonSchema=n.outputSchema),e.behavior&&(r.behavior=e.behavior),{functionDeclarations:[r]}}function d1(t,e={}){const n=[],r=new Set;for(const i of t){const s=i.name;if(r.has(s))throw new Error(`Duplicate function name ${s} found in MCP tools. Please ensure function names are unique.`);r.add(s);const o=c1(i,e);o.functionDeclarations&&n.push(...o.functionDeclarations)}return{functionDeclarations:n}}function IC(t,e){let n;if(typeof e=="string")if(t.isVertexAI())if(e.startsWith("gs://"))n={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))n={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))n={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(t.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");n={inlinedRequests:e}}else n=e;const r=[n.gcsUri,n.bigqueryUri].filter(Boolean).length,i=[n.inlinedRequests,n.fileName].filter(Boolean).length;if(t.isVertexAI()){if(i>0||r!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(r>0||i!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return n}function h1(t){if(typeof t!="string")return t;const e=t;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function wC(t){if(typeof t!="object"||t===null)return{};const e=t,n=e.inlinedResponses;if(typeof n!="object"||n===null)return t;const i=n.inlinedResponses;if(!Array.isArray(i)||i.length===0)return t;let s=!1;for(const o of i){if(typeof o!="object"||o===null)continue;const l=o.response;if(typeof l!="object"||l===null)continue;if(l.embedding!==void 0){s=!0;break}}return s&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),t}function Ja(t,e){const n=e;if(!t.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error(`Invalid batch job name: ${n}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error(`Invalid batch job name: ${n}.`)}function SC(t){const e=t;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function f1(t){const e={},n=c(t,["responsesFile"]);n!=null&&h(e,["fileName"],n);const r=c(t,["inlinedResponses","inlinedResponses"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>$1(o))),h(e,["inlinedResponses"],s)}const i=c(t,["inlinedEmbedContentResponses","inlinedResponses"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),h(e,["inlinedEmbedContentResponses"],s)}return e}function p1(t){const e={},n=c(t,["predictionsFormat"]);n!=null&&h(e,["format"],n);const r=c(t,["gcsDestination","outputUriPrefix"]);r!=null&&h(e,["gcsUri"],r);const i=c(t,["bigqueryDestination","outputUri"]);return i!=null&&h(e,["bigqueryUri"],i),e}function m1(t){const e={},n=c(t,["format"]);n!=null&&h(e,["predictionsFormat"],n);const r=c(t,["gcsUri"]);r!=null&&h(e,["gcsDestination","outputUriPrefix"],r);const i=c(t,["bigqueryUri"]);if(i!=null&&h(e,["bigqueryDestination","outputUri"],i),c(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(c(t,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(c(t,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function pd(t){const e={},n=c(t,["name"]);n!=null&&h(e,["name"],n);const r=c(t,["metadata","displayName"]);r!=null&&h(e,["displayName"],r);const i=c(t,["metadata","state"]);i!=null&&h(e,["state"],SC(i));const s=c(t,["metadata","createTime"]);s!=null&&h(e,["createTime"],s);const o=c(t,["metadata","endTime"]);o!=null&&h(e,["endTime"],o);const a=c(t,["metadata","updateTime"]);a!=null&&h(e,["updateTime"],a);const l=c(t,["metadata","model"]);l!=null&&h(e,["model"],l);const u=c(t,["metadata","output"]);return u!=null&&h(e,["dest"],f1(wC(u))),e}function wm(t){const e={},n=c(t,["name"]);n!=null&&h(e,["name"],n);const r=c(t,["displayName"]);r!=null&&h(e,["displayName"],r);const i=c(t,["state"]);i!=null&&h(e,["state"],SC(i));const s=c(t,["error"]);s!=null&&h(e,["error"],s);const o=c(t,["createTime"]);o!=null&&h(e,["createTime"],o);const a=c(t,["startTime"]);a!=null&&h(e,["startTime"],a);const l=c(t,["endTime"]);l!=null&&h(e,["endTime"],l);const u=c(t,["updateTime"]);u!=null&&h(e,["updateTime"],u);const f=c(t,["model"]);f!=null&&h(e,["model"],f);const p=c(t,["inputConfig"]);p!=null&&h(e,["src"],g1(p));const g=c(t,["outputConfig"]);return g!=null&&h(e,["dest"],p1(wC(g))),e}function g1(t){const e={},n=c(t,["instancesFormat"]);n!=null&&h(e,["format"],n);const r=c(t,["gcsSource","uris"]);r!=null&&h(e,["gcsUri"],r);const i=c(t,["bigquerySource","inputUri"]);return i!=null&&h(e,["bigqueryUri"],i),e}function _1(t,e){const n={};if(c(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(c(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(c(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const r=c(e,["fileName"]);r!=null&&h(n,["fileName"],r);const i=c(e,["inlinedRequests"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>z1(t,o))),h(n,["requests","requests"],s)}return n}function y1(t){const e={},n=c(t,["format"]);n!=null&&h(e,["instancesFormat"],n);const r=c(t,["gcsUri"]);r!=null&&h(e,["gcsSource","uris"],r);const i=c(t,["bigqueryUri"]);if(i!=null&&h(e,["bigquerySource","inputUri"],i),c(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(c(t,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function v1(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["data"]);n!=null&&h(e,["data"],n);const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function T1(t,e){const n={},r=c(e,["name"]);return r!=null&&h(n,["_url","name"],Ja(t,r)),n}function E1(t,e){const n={},r=c(e,["name"]);return r!=null&&h(n,["_url","name"],Ja(t,r)),n}function I1(t){const e={},n=c(t,["content"]);n!=null&&h(e,["content"],n);const r=c(t,["citationMetadata"]);r!=null&&h(e,["citationMetadata"],w1(r));const i=c(t,["tokenCount"]);i!=null&&h(e,["tokenCount"],i);const s=c(t,["finishReason"]);s!=null&&h(e,["finishReason"],s);const o=c(t,["urlContextMetadata"]);o!=null&&h(e,["urlContextMetadata"],o);const a=c(t,["avgLogprobs"]);a!=null&&h(e,["avgLogprobs"],a);const l=c(t,["groundingMetadata"]);l!=null&&h(e,["groundingMetadata"],l);const u=c(t,["index"]);u!=null&&h(e,["index"],u);const f=c(t,["logprobsResult"]);f!=null&&h(e,["logprobsResult"],f);const p=c(t,["safetyRatings"]);if(p!=null){let g=p;Array.isArray(g)&&(g=g.map(v=>v)),h(e,["safetyRatings"],g)}return e}function w1(t){const e={},n=c(t,["citationSources"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>i)),h(e,["citations"],r)}return e}function CC(t){const e={},n=c(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>Y1(s))),h(e,["parts"],i)}const r=c(t,["role"]);return r!=null&&h(e,["role"],r),e}function S1(t,e){const n={},r=c(t,["displayName"]);if(e!==void 0&&r!=null&&h(e,["batch","displayName"],r),c(t,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return n}function C1(t,e){const n={},r=c(t,["displayName"]);e!==void 0&&r!=null&&h(e,["displayName"],r);const i=c(t,["dest"]);return e!==void 0&&i!=null&&h(e,["outputConfig"],m1(h1(i))),n}function MT(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=c(e,["src"]);i!=null&&h(n,["batch","inputConfig"],_1(t,IC(t,i)));const s=c(e,["config"]);return s!=null&&S1(s,n),n}function A1(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["model"],qe(t,r));const i=c(e,["src"]);i!=null&&h(n,["inputConfig"],y1(IC(t,i)));const s=c(e,["config"]);return s!=null&&C1(s,n),n}function x1(t,e){const n={},r=c(t,["displayName"]);return e!==void 0&&r!=null&&h(e,["batch","displayName"],r),n}function R1(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=c(e,["src"]);i!=null&&h(n,["batch","inputConfig"],V1(t,i));const s=c(e,["config"]);return s!=null&&x1(s,n),n}function P1(t,e){const n={},r=c(e,["name"]);return r!=null&&h(n,["_url","name"],Ja(t,r)),n}function k1(t,e){const n={},r=c(e,["name"]);return r!=null&&h(n,["_url","name"],Ja(t,r)),n}function N1(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["name"]);r!=null&&h(e,["name"],r);const i=c(t,["done"]);i!=null&&h(e,["done"],i);const s=c(t,["error"]);return s!=null&&h(e,["error"],s),e}function D1(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["name"]);r!=null&&h(e,["name"],r);const i=c(t,["done"]);i!=null&&h(e,["done"],i);const s=c(t,["error"]);return s!=null&&h(e,["error"],s),e}function b1(t,e){const n={},r=c(e,["contents"]);if(r!=null){let s=a_(t,r);Array.isArray(s)&&(s=s.map(o=>o)),h(n,["requests[]","request","content"],s)}const i=c(e,["config"]);return i!=null&&(h(n,["_self"],M1(i,n)),Lk(n,{"requests[].*":"requests[].request.*"})),n}function M1(t,e){const n={},r=c(t,["taskType"]);e!==void 0&&r!=null&&h(e,["requests[]","taskType"],r);const i=c(t,["title"]);e!==void 0&&i!=null&&h(e,["requests[]","title"],i);const s=c(t,["outputDimensionality"]);if(e!==void 0&&s!=null&&h(e,["requests[]","outputDimensionality"],s),c(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(c(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function V1(t,e){const n={},r=c(e,["fileName"]);r!=null&&h(n,["file_name"],r);const i=c(e,["inlinedRequests"]);return i!=null&&h(n,["requests"],b1(t,i)),n}function L1(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["fileUri"]);n!=null&&h(e,["fileUri"],n);const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function F1(t,e,n){const r={},i=c(e,["systemInstruction"]);n!==void 0&&i!=null&&h(n,["systemInstruction"],CC(Yt(i)));const s=c(e,["temperature"]);s!=null&&h(r,["temperature"],s);const o=c(e,["topP"]);o!=null&&h(r,["topP"],o);const a=c(e,["topK"]);a!=null&&h(r,["topK"],a);const l=c(e,["candidateCount"]);l!=null&&h(r,["candidateCount"],l);const u=c(e,["maxOutputTokens"]);u!=null&&h(r,["maxOutputTokens"],u);const f=c(e,["stopSequences"]);f!=null&&h(r,["stopSequences"],f);const p=c(e,["responseLogprobs"]);p!=null&&h(r,["responseLogprobs"],p);const g=c(e,["logprobs"]);g!=null&&h(r,["logprobs"],g);const v=c(e,["presencePenalty"]);v!=null&&h(r,["presencePenalty"],v);const E=c(e,["frequencyPenalty"]);E!=null&&h(r,["frequencyPenalty"],E);const R=c(e,["seed"]);R!=null&&h(r,["seed"],R);const M=c(e,["responseMimeType"]);M!=null&&h(r,["responseMimeType"],M);const A=c(e,["responseSchema"]);A!=null&&h(r,["responseSchema"],l_(A));const I=c(e,["responseJsonSchema"]);if(I!=null&&h(r,["responseJsonSchema"],I),c(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(c(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const C=c(e,["safetySettings"]);if(n!==void 0&&C!=null){let L=C;Array.isArray(L)&&(L=L.map(N=>X1(N))),h(n,["safetySettings"],L)}const V=c(e,["tools"]);if(n!==void 0&&V!=null){let L=ja(V);Array.isArray(L)&&(L=L.map(N=>Z1(Ka(N)))),h(n,["tools"],L)}const F=c(e,["toolConfig"]);if(n!==void 0&&F!=null&&h(n,["toolConfig"],F),c(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const B=c(e,["cachedContent"]);n!==void 0&&B!=null&&h(n,["cachedContent"],ii(t,B));const T=c(e,["responseModalities"]);T!=null&&h(r,["responseModalities"],T);const w=c(e,["mediaResolution"]);w!=null&&h(r,["mediaResolution"],w);const x=c(e,["speechConfig"]);if(x!=null&&h(r,["speechConfig"],u_(x)),c(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const k=c(e,["thinkingConfig"]);k!=null&&h(r,["thinkingConfig"],k);const D=c(e,["imageConfig"]);return D!=null&&h(r,["imageConfig"],D),r}function U1(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["candidates"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(u=>I1(u))),h(e,["candidates"],l)}const i=c(t,["modelVersion"]);i!=null&&h(e,["modelVersion"],i);const s=c(t,["promptFeedback"]);s!=null&&h(e,["promptFeedback"],s);const o=c(t,["responseId"]);o!=null&&h(e,["responseId"],o);const a=c(t,["usageMetadata"]);return a!=null&&h(e,["usageMetadata"],a),e}function O1(t,e){const n={},r=c(e,["name"]);return r!=null&&h(n,["_url","name"],Ja(t,r)),n}function B1(t,e){const n={},r=c(e,["name"]);return r!=null&&h(n,["_url","name"],Ja(t,r)),n}function q1(t){const e={};if(c(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=c(t,["enableWidget"]);return n!=null&&h(e,["enableWidget"],n),e}function G1(t){const e={},n=c(t,["timeRangeFilter"]);if(n!=null&&h(e,["timeRangeFilter"],n),c(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function z1(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["request","model"],qe(t,r));const i=c(e,["contents"]);if(i!=null){let a=Gn(i);Array.isArray(a)&&(a=a.map(l=>CC(l))),h(n,["request","contents"],a)}const s=c(e,["metadata"]);s!=null&&h(n,["metadata"],s);const o=c(e,["config"]);return o!=null&&h(n,["request","generationConfig"],F1(t,o,c(n,["request"],{}))),n}function $1(t){const e={},n=c(t,["response"]);n!=null&&h(e,["response"],U1(n));const r=c(t,["error"]);return r!=null&&h(e,["error"],r),e}function H1(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&h(e,["_query","pageSize"],r);const i=c(t,["pageToken"]);if(e!==void 0&&i!=null&&h(e,["_query","pageToken"],i),c(t,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return n}function W1(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&h(e,["_query","pageSize"],r);const i=c(t,["pageToken"]);e!==void 0&&i!=null&&h(e,["_query","pageToken"],i);const s=c(t,["filter"]);return e!==void 0&&s!=null&&h(e,["_query","filter"],s),n}function K1(t){const e={},n=c(t,["config"]);return n!=null&&H1(n,e),e}function j1(t){const e={},n=c(t,["config"]);return n!=null&&W1(n,e),e}function J1(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=c(t,["operations"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>pd(o))),h(e,["batchJobs"],s)}return e}function Q1(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=c(t,["batchPredictionJobs"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>wm(o))),h(e,["batchJobs"],s)}return e}function Y1(t){const e={},n=c(t,["videoMetadata"]);n!=null&&h(e,["videoMetadata"],n);const r=c(t,["thought"]);r!=null&&h(e,["thought"],r);const i=c(t,["inlineData"]);i!=null&&h(e,["inlineData"],v1(i));const s=c(t,["fileData"]);s!=null&&h(e,["fileData"],L1(s));const o=c(t,["thoughtSignature"]);o!=null&&h(e,["thoughtSignature"],o);const a=c(t,["functionCall"]);a!=null&&h(e,["functionCall"],a);const l=c(t,["codeExecutionResult"]);l!=null&&h(e,["codeExecutionResult"],l);const u=c(t,["executableCode"]);u!=null&&h(e,["executableCode"],u);const f=c(t,["functionResponse"]);f!=null&&h(e,["functionResponse"],f);const p=c(t,["text"]);return p!=null&&h(e,["text"],p),e}function X1(t){const e={};if(c(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=c(t,["category"]);n!=null&&h(e,["category"],n);const r=c(t,["threshold"]);return r!=null&&h(e,["threshold"],r),e}function Z1(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(f=>f)),h(e,["functionDeclarations"],u)}if(c(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=c(t,["googleSearch"]);r!=null&&h(e,["googleSearch"],G1(r));const i=c(t,["googleSearchRetrieval"]);if(i!=null&&h(e,["googleSearchRetrieval"],i),c(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=c(t,["googleMaps"]);s!=null&&h(e,["googleMaps"],q1(s));const o=c(t,["urlContext"]);o!=null&&h(e,["urlContext"],o);const a=c(t,["computerUse"]);a!=null&&h(e,["computerUse"],a);const l=c(t,["codeExecution"]);return l!=null&&h(e,["codeExecution"],l),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var uo;(function(t){t.PAGED_ITEM_BATCH_JOBS="batchJobs",t.PAGED_ITEM_MODELS="models",t.PAGED_ITEM_TUNING_JOBS="tuningJobs",t.PAGED_ITEM_FILES="files",t.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(uo||(uo={}));class Wu{constructor(e,n,r,i){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(e,r,i)}init(e,n,r){var i,s;this.nameInternal=e,this.pageInternal=n[this.nameInternal]||[],this.sdkHttpResponseInternal=n==null?void 0:n.sdkHttpResponse,this.idxInternal=0;let o={config:{}};!r||Object.keys(r).length===0?o={config:{}}:typeof r=="object"?o=Object.assign({},r):o=r,o.config&&(o.config.pageToken=n.nextPageToken),this.paramsInternal=o,this.pageInternalSize=(s=(i=o.config)===null||i===void 0?void 0:i.pageSize)!==null&&s!==void 0?s:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class eN extends Eo{constructor(e){super(),this.apiClient=e,this.create=async n=>(this.apiClient.isVertexAI()&&(n.config=this.formatDestination(n.src,n.config)),this.createInternal(n)),this.createEmbeddings=async n=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(n)},this.list=async(n={})=>new Wu(uo.PAGED_ITEM_BATCH_JOBS,r=>this.listInternal(r),await this.listInternal(n),n)}createInlinedGenerateContentRequest(e){const n=MT(this.apiClient,e),r=n._url,i=ce("{model}:batchGenerateContent",r),a=n.batch.inputConfig.requests,l=a.requests,u=[];for(const f of l){const p=Object.assign({},f);if(p.systemInstruction){const g=p.systemInstruction;delete p.systemInstruction;const v=p.request;v.systemInstruction=g,p.request=v}u.push(p)}return a.requests=u,delete n.config,delete n._url,delete n._query,{path:i,body:n}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,n){const r=n?Object.assign({},n):{},i=Date.now().toString();if(r.displayName||(r.displayName=`genaiBatchJob_${i}`),r.dest===void 0){const s=this.getGcsUri(e),o=this.getBigqueryUri(e);if(s)s.endsWith(".jsonl")?r.dest=`${s.slice(0,-6)}/dest`:r.dest=`${s}_dest_${i}`;else if(o)r.dest=`${o}_dest_${i}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return r}async createInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=A1(this.apiClient,e);return a=ce("batchPredictionJobs",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>wm(f))}else{const u=MT(this.apiClient,e);return a=ce("{model}:batchGenerateContent",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>pd(f))}}async createEmbeddingsInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=R1(this.apiClient,e);return s=ce("{model}:asyncBatchEmbedContent",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>pd(l))}}async get(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=B1(this.apiClient,e);return a=ce("batchPredictionJobs/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>wm(f))}else{const u=O1(this.apiClient,e);return a=ce("batches/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>pd(f))}}async cancel(e){var n,r,i,s;let o="",a={};if(this.apiClient.isVertexAI()){const l=E1(this.apiClient,e);o=ce("batchPredictionJobs/{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}else{const l=T1(this.apiClient,e);o=ce("batches/{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal})}}async listInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=j1(e);return a=ce("batchPredictionJobs",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const p=Q1(f),g=new kT;return Object.assign(g,p),g})}else{const u=K1(e);return a=ce("batches",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const p=J1(f),g=new kT;return Object.assign(g,p),g})}}async delete(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=k1(this.apiClient,e);return a=ce("batchPredictionJobs/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>D1(f))}else{const u=P1(this.apiClient,e);return a=ce("batches/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>N1(f))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function tN(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["data"]);n!=null&&h(e,["data"],n);const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function VT(t){const e={},n=c(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>IN(s))),h(e,["parts"],i)}const r=c(t,["role"]);return r!=null&&h(e,["role"],r),e}function nN(t,e){const n={},r=c(t,["ttl"]);e!==void 0&&r!=null&&h(e,["ttl"],r);const i=c(t,["expireTime"]);e!==void 0&&i!=null&&h(e,["expireTime"],i);const s=c(t,["displayName"]);e!==void 0&&s!=null&&h(e,["displayName"],s);const o=c(t,["contents"]);if(e!==void 0&&o!=null){let f=Gn(o);Array.isArray(f)&&(f=f.map(p=>VT(p))),h(e,["contents"],f)}const a=c(t,["systemInstruction"]);e!==void 0&&a!=null&&h(e,["systemInstruction"],VT(Yt(a)));const l=c(t,["tools"]);if(e!==void 0&&l!=null){let f=l;Array.isArray(f)&&(f=f.map(p=>wN(p))),h(e,["tools"],f)}const u=c(t,["toolConfig"]);if(e!==void 0&&u!=null&&h(e,["toolConfig"],u),c(t,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function rN(t,e){const n={},r=c(t,["ttl"]);e!==void 0&&r!=null&&h(e,["ttl"],r);const i=c(t,["expireTime"]);e!==void 0&&i!=null&&h(e,["expireTime"],i);const s=c(t,["displayName"]);e!==void 0&&s!=null&&h(e,["displayName"],s);const o=c(t,["contents"]);if(e!==void 0&&o!=null){let p=Gn(o);Array.isArray(p)&&(p=p.map(g=>g)),h(e,["contents"],p)}const a=c(t,["systemInstruction"]);e!==void 0&&a!=null&&h(e,["systemInstruction"],Yt(a));const l=c(t,["tools"]);if(e!==void 0&&l!=null){let p=l;Array.isArray(p)&&(p=p.map(g=>SN(g))),h(e,["tools"],p)}const u=c(t,["toolConfig"]);e!==void 0&&u!=null&&h(e,["toolConfig"],u);const f=c(t,["kmsKeyName"]);return e!==void 0&&f!=null&&h(e,["encryption_spec","kmsKeyName"],f),n}function iN(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["model"],fC(t,r));const i=c(e,["config"]);return i!=null&&nN(i,n),n}function sN(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["model"],fC(t,r));const i=c(e,["config"]);return i!=null&&rN(i,n),n}function oN(t,e){const n={},r=c(e,["name"]);return r!=null&&h(n,["_url","name"],ii(t,r)),n}function aN(t,e){const n={},r=c(e,["name"]);return r!=null&&h(n,["_url","name"],ii(t,r)),n}function lN(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&h(e,["sdkHttpResponse"],n),e}function uN(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&h(e,["sdkHttpResponse"],n),e}function cN(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["fileUri"]);n!=null&&h(e,["fileUri"],n);const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function dN(t){const e={};if(c(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=c(t,["description"]);n!=null&&h(e,["description"],n);const r=c(t,["name"]);r!=null&&h(e,["name"],r);const i=c(t,["parameters"]);i!=null&&h(e,["parameters"],i);const s=c(t,["parametersJsonSchema"]);s!=null&&h(e,["parametersJsonSchema"],s);const o=c(t,["response"]);o!=null&&h(e,["response"],o);const a=c(t,["responseJsonSchema"]);return a!=null&&h(e,["responseJsonSchema"],a),e}function hN(t,e){const n={},r=c(e,["name"]);return r!=null&&h(n,["_url","name"],ii(t,r)),n}function fN(t,e){const n={},r=c(e,["name"]);return r!=null&&h(n,["_url","name"],ii(t,r)),n}function pN(t){const e={};if(c(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=c(t,["enableWidget"]);return n!=null&&h(e,["enableWidget"],n),e}function mN(t){const e={},n=c(t,["timeRangeFilter"]);if(n!=null&&h(e,["timeRangeFilter"],n),c(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function gN(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&h(e,["_query","pageSize"],r);const i=c(t,["pageToken"]);return e!==void 0&&i!=null&&h(e,["_query","pageToken"],i),n}function _N(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&h(e,["_query","pageSize"],r);const i=c(t,["pageToken"]);return e!==void 0&&i!=null&&h(e,["_query","pageToken"],i),n}function yN(t){const e={},n=c(t,["config"]);return n!=null&&gN(n,e),e}function vN(t){const e={},n=c(t,["config"]);return n!=null&&_N(n,e),e}function TN(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=c(t,["cachedContents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),h(e,["cachedContents"],s)}return e}function EN(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=c(t,["cachedContents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),h(e,["cachedContents"],s)}return e}function IN(t){const e={},n=c(t,["videoMetadata"]);n!=null&&h(e,["videoMetadata"],n);const r=c(t,["thought"]);r!=null&&h(e,["thought"],r);const i=c(t,["inlineData"]);i!=null&&h(e,["inlineData"],tN(i));const s=c(t,["fileData"]);s!=null&&h(e,["fileData"],cN(s));const o=c(t,["thoughtSignature"]);o!=null&&h(e,["thoughtSignature"],o);const a=c(t,["functionCall"]);a!=null&&h(e,["functionCall"],a);const l=c(t,["codeExecutionResult"]);l!=null&&h(e,["codeExecutionResult"],l);const u=c(t,["executableCode"]);u!=null&&h(e,["executableCode"],u);const f=c(t,["functionResponse"]);f!=null&&h(e,["functionResponse"],f);const p=c(t,["text"]);return p!=null&&h(e,["text"],p),e}function wN(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(f=>f)),h(e,["functionDeclarations"],u)}if(c(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=c(t,["googleSearch"]);r!=null&&h(e,["googleSearch"],mN(r));const i=c(t,["googleSearchRetrieval"]);if(i!=null&&h(e,["googleSearchRetrieval"],i),c(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=c(t,["googleMaps"]);s!=null&&h(e,["googleMaps"],pN(s));const o=c(t,["urlContext"]);o!=null&&h(e,["urlContext"],o);const a=c(t,["computerUse"]);a!=null&&h(e,["computerUse"],a);const l=c(t,["codeExecution"]);return l!=null&&h(e,["codeExecution"],l),e}function SN(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let p=n;Array.isArray(p)&&(p=p.map(g=>dN(g))),h(e,["functionDeclarations"],p)}const r=c(t,["retrieval"]);r!=null&&h(e,["retrieval"],r);const i=c(t,["googleSearch"]);i!=null&&h(e,["googleSearch"],i);const s=c(t,["googleSearchRetrieval"]);s!=null&&h(e,["googleSearchRetrieval"],s);const o=c(t,["enterpriseWebSearch"]);o!=null&&h(e,["enterpriseWebSearch"],o);const a=c(t,["googleMaps"]);a!=null&&h(e,["googleMaps"],a);const l=c(t,["urlContext"]);l!=null&&h(e,["urlContext"],l);const u=c(t,["computerUse"]);u!=null&&h(e,["computerUse"],u);const f=c(t,["codeExecution"]);return f!=null&&h(e,["codeExecution"],f),e}function CN(t,e){const n={},r=c(t,["ttl"]);e!==void 0&&r!=null&&h(e,["ttl"],r);const i=c(t,["expireTime"]);return e!==void 0&&i!=null&&h(e,["expireTime"],i),n}function AN(t,e){const n={},r=c(t,["ttl"]);e!==void 0&&r!=null&&h(e,["ttl"],r);const i=c(t,["expireTime"]);return e!==void 0&&i!=null&&h(e,["expireTime"],i),n}function xN(t,e){const n={},r=c(e,["name"]);r!=null&&h(n,["_url","name"],ii(t,r));const i=c(e,["config"]);return i!=null&&CN(i,n),n}function RN(t,e){const n={},r=c(e,["name"]);r!=null&&h(n,["_url","name"],ii(t,r));const i=c(e,["config"]);return i!=null&&AN(i,n),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class PN extends Eo{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new Wu(uo.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(n),n)}async create(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=sN(this.apiClient,e);return a=ce("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>f)}else{const u=iN(this.apiClient,e);return a=ce("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>f)}}async get(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=fN(this.apiClient,e);return a=ce("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>f)}else{const u=hN(this.apiClient,e);return a=ce("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>f)}}async delete(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=aN(this.apiClient,e);return a=ce("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const p=uN(f),g=new RT;return Object.assign(g,p),g})}else{const u=oN(this.apiClient,e);return a=ce("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const p=lN(f),g=new RT;return Object.assign(g,p),g})}}async update(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=RN(this.apiClient,e);return a=ce("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>f)}else{const u=xN(this.apiClient,e);return a=ce("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>f)}}async listInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=vN(e);return a=ce("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const p=EN(f),g=new PT;return Object.assign(g,p),g})}else{const u=yN(e);return a=ce("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const p=TN(f),g=new PT;return Object.assign(g,p),g})}}}function LT(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function st(t){return this instanceof st?(this.v=t,this):new st(t)}function ma(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),i,s=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(v){return function(E){return Promise.resolve(E).then(v,p)}}function a(v,E){r[v]&&(i[v]=function(R){return new Promise(function(M,A){s.push([v,R,M,A])>1||l(v,R)})},E&&(i[v]=E(i[v])))}function l(v,E){try{u(r[v](E))}catch(R){g(s[0][3],R)}}function u(v){v.value instanceof st?Promise.resolve(v.value.v).then(f,p):g(s[0][2],v)}function f(v){l("next",v)}function p(v){l("throw",v)}function g(v,E){v(E),s.shift(),s.length&&l(s[0][0],s[0][1])}}function Yl(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof LT=="function"?LT(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(s){n[s]=t[s]&&function(o){return new Promise(function(a,l){o=t[s](o),i(a,l,o.done,o.value)})}}function i(s,o,a,l){Promise.resolve(l).then(function(u){s({value:u,done:a})},o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function kN(t){var e;if(t.candidates==null||t.candidates.length===0)return!1;const n=(e=t.candidates[0])===null||e===void 0?void 0:e.content;return n===void 0?!1:AC(n)}function AC(t){if(t.parts===void 0||t.parts.length===0)return!1;for(const e of t.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function NN(t){if(t.length!==0){for(const e of t)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function FT(t){if(t===void 0||t.length===0)return[];const e=[],n=t.length;let r=0;for(;r<n;)if(t[r].role==="user")e.push(t[r]),r++;else{const i=[];let s=!0;for(;r<n&&t[r].role==="model";)i.push(t[r]),s&&!AC(t[r])&&(s=!1),r++;s?e.push(...i):e.pop()}return e}class DN{constructor(e,n){this.modelsModule=e,this.apiClient=n}create(e){return new bN(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class bN{constructor(e,n,r,i={},s=[]){this.apiClient=e,this.modelsModule=n,this.model=r,this.config=i,this.history=s,this.sendPromise=Promise.resolve(),NN(s)}async sendMessage(e){var n;await this.sendPromise;const r=Yt(e.message),i=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var s,o,a;const l=await i,u=(o=(s=l.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content,f=l.automaticFunctionCallingHistory,p=this.getHistory(!0).length;let g=[];f!=null&&(g=(a=f.slice(p))!==null&&a!==void 0?a:[]);const v=u?[u]:[];this.recordHistory(r,v,g)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),i}async sendMessageStream(e){var n;await this.sendPromise;const r=Yt(e.message),i=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});this.sendPromise=i.then(()=>{}).catch(()=>{});const s=await i;return this.processStreamResponse(s,r)}getHistory(e=!1){const n=e?FT(this.history):this.history;return structuredClone(n)}processStreamResponse(e,n){var r,i;return ma(this,arguments,function*(){var o,a,l,u;const f=[];try{for(var p=!0,g=Yl(e),v;v=yield st(g.next()),o=v.done,!o;p=!0){u=v.value,p=!1;const E=u;if(kN(E)){const R=(i=(r=E.candidates)===null||r===void 0?void 0:r[0])===null||i===void 0?void 0:i.content;R!==void 0&&f.push(R)}yield yield st(E)}}catch(E){a={error:E}}finally{try{!p&&!o&&(l=g.return)&&(yield st(l.call(g)))}finally{if(a)throw a.error}}this.recordHistory(n,f)})}recordHistory(e,n,r){let i=[];n.length>0&&n.every(s=>s.role!==void 0)?i=n:i.push({role:"model",parts:[]}),r&&r.length>0?this.history.push(...FT(r)):this.history.push(e),this.history.push(...i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Wh extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,Wh.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function MN(t){const e={},n=c(t,["file"]);return n!=null&&h(e,["file"],n),e}function VN(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&h(e,["sdkHttpResponse"],n),e}function LN(t){const e={},n=c(t,["name"]);return n!=null&&h(e,["_url","file"],vC(n)),e}function FN(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&h(e,["sdkHttpResponse"],n),e}function UN(t){const e={},n=c(t,["name"]);return n!=null&&h(e,["_url","file"],vC(n)),e}function ON(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&h(e,["_query","pageSize"],r);const i=c(t,["pageToken"]);return e!==void 0&&i!=null&&h(e,["_query","pageToken"],i),n}function BN(t){const e={},n=c(t,["config"]);return n!=null&&ON(n,e),e}function qN(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=c(t,["files"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),h(e,["files"],s)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class GN extends Eo{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new Wu(uo.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(n),n)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(n=>n)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=BN(e);return s=ce("files",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>{const u=qN(l),f=new Zk;return Object.assign(f,u),f})}}async createInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=MN(e);return s=ce("upload/v1beta/files",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=VN(l),f=new e1;return Object.assign(f,u),f})}}async get(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=UN(e);return s=ce("files/{file}",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>l)}}async delete(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=LN(e);return s=ce("files/{file}",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>{const u=FN(l),f=new t1;return Object.assign(f,u),f})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function md(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["data"]);n!=null&&h(e,["data"],n);const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function zN(t){const e={},n=c(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>iD(s))),h(e,["parts"],i)}const r=c(t,["role"]);return r!=null&&h(e,["role"],r),e}function $N(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["fileUri"]);n!=null&&h(e,["fileUri"],n);const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function HN(t){const e={};if(c(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=c(t,["description"]);n!=null&&h(e,["description"],n);const r=c(t,["name"]);r!=null&&h(e,["name"],r);const i=c(t,["parameters"]);i!=null&&h(e,["parameters"],i);const s=c(t,["parametersJsonSchema"]);s!=null&&h(e,["parametersJsonSchema"],s);const o=c(t,["response"]);o!=null&&h(e,["response"],o);const a=c(t,["responseJsonSchema"]);return a!=null&&h(e,["responseJsonSchema"],a),e}function WN(t){const e={},n=c(t,["modelSelectionConfig"]);n!=null&&h(e,["modelConfig"],n);const r=c(t,["audioTimestamp"]);r!=null&&h(e,["audioTimestamp"],r);const i=c(t,["candidateCount"]);i!=null&&h(e,["candidateCount"],i);const s=c(t,["enableAffectiveDialog"]);s!=null&&h(e,["enableAffectiveDialog"],s);const o=c(t,["frequencyPenalty"]);o!=null&&h(e,["frequencyPenalty"],o);const a=c(t,["logprobs"]);a!=null&&h(e,["logprobs"],a);const l=c(t,["maxOutputTokens"]);l!=null&&h(e,["maxOutputTokens"],l);const u=c(t,["mediaResolution"]);u!=null&&h(e,["mediaResolution"],u);const f=c(t,["presencePenalty"]);f!=null&&h(e,["presencePenalty"],f);const p=c(t,["responseJsonSchema"]);p!=null&&h(e,["responseJsonSchema"],p);const g=c(t,["responseLogprobs"]);g!=null&&h(e,["responseLogprobs"],g);const v=c(t,["responseMimeType"]);v!=null&&h(e,["responseMimeType"],v);const E=c(t,["responseModalities"]);E!=null&&h(e,["responseModalities"],E);const R=c(t,["responseSchema"]);R!=null&&h(e,["responseSchema"],R);const M=c(t,["routingConfig"]);M!=null&&h(e,["routingConfig"],M);const A=c(t,["seed"]);A!=null&&h(e,["seed"],A);const I=c(t,["speechConfig"]);I!=null&&h(e,["speechConfig"],xC(I));const C=c(t,["stopSequences"]);C!=null&&h(e,["stopSequences"],C);const V=c(t,["temperature"]);V!=null&&h(e,["temperature"],V);const F=c(t,["thinkingConfig"]);F!=null&&h(e,["thinkingConfig"],F);const B=c(t,["topK"]);B!=null&&h(e,["topK"],B);const T=c(t,["topP"]);return T!=null&&h(e,["topP"],T),e}function KN(t){const e={};if(c(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=c(t,["enableWidget"]);return n!=null&&h(e,["enableWidget"],n),e}function jN(t){const e={},n=c(t,["timeRangeFilter"]);if(n!=null&&h(e,["timeRangeFilter"],n),c(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function JN(t,e){const n={},r=c(t,["generationConfig"]);e!==void 0&&r!=null&&h(e,["setup","generationConfig"],r);const i=c(t,["responseModalities"]);e!==void 0&&i!=null&&h(e,["setup","generationConfig","responseModalities"],i);const s=c(t,["temperature"]);e!==void 0&&s!=null&&h(e,["setup","generationConfig","temperature"],s);const o=c(t,["topP"]);e!==void 0&&o!=null&&h(e,["setup","generationConfig","topP"],o);const a=c(t,["topK"]);e!==void 0&&a!=null&&h(e,["setup","generationConfig","topK"],a);const l=c(t,["maxOutputTokens"]);e!==void 0&&l!=null&&h(e,["setup","generationConfig","maxOutputTokens"],l);const u=c(t,["mediaResolution"]);e!==void 0&&u!=null&&h(e,["setup","generationConfig","mediaResolution"],u);const f=c(t,["seed"]);e!==void 0&&f!=null&&h(e,["setup","generationConfig","seed"],f);const p=c(t,["speechConfig"]);e!==void 0&&p!=null&&h(e,["setup","generationConfig","speechConfig"],c_(p));const g=c(t,["thinkingConfig"]);e!==void 0&&g!=null&&h(e,["setup","generationConfig","thinkingConfig"],g);const v=c(t,["enableAffectiveDialog"]);e!==void 0&&v!=null&&h(e,["setup","generationConfig","enableAffectiveDialog"],v);const E=c(t,["systemInstruction"]);e!==void 0&&E!=null&&h(e,["setup","systemInstruction"],zN(Yt(E)));const R=c(t,["tools"]);if(e!==void 0&&R!=null){let B=ja(R);Array.isArray(B)&&(B=B.map(T=>oD(Ka(T)))),h(e,["setup","tools"],B)}const M=c(t,["sessionResumption"]);e!==void 0&&M!=null&&h(e,["setup","sessionResumption"],sD(M));const A=c(t,["inputAudioTranscription"]);e!==void 0&&A!=null&&h(e,["setup","inputAudioTranscription"],A);const I=c(t,["outputAudioTranscription"]);e!==void 0&&I!=null&&h(e,["setup","outputAudioTranscription"],I);const C=c(t,["realtimeInputConfig"]);e!==void 0&&C!=null&&h(e,["setup","realtimeInputConfig"],C);const V=c(t,["contextWindowCompression"]);e!==void 0&&V!=null&&h(e,["setup","contextWindowCompression"],V);const F=c(t,["proactivity"]);return e!==void 0&&F!=null&&h(e,["setup","proactivity"],F),n}function QN(t,e){const n={},r=c(t,["generationConfig"]);e!==void 0&&r!=null&&h(e,["setup","generationConfig"],WN(r));const i=c(t,["responseModalities"]);e!==void 0&&i!=null&&h(e,["setup","generationConfig","responseModalities"],i);const s=c(t,["temperature"]);e!==void 0&&s!=null&&h(e,["setup","generationConfig","temperature"],s);const o=c(t,["topP"]);e!==void 0&&o!=null&&h(e,["setup","generationConfig","topP"],o);const a=c(t,["topK"]);e!==void 0&&a!=null&&h(e,["setup","generationConfig","topK"],a);const l=c(t,["maxOutputTokens"]);e!==void 0&&l!=null&&h(e,["setup","generationConfig","maxOutputTokens"],l);const u=c(t,["mediaResolution"]);e!==void 0&&u!=null&&h(e,["setup","generationConfig","mediaResolution"],u);const f=c(t,["seed"]);e!==void 0&&f!=null&&h(e,["setup","generationConfig","seed"],f);const p=c(t,["speechConfig"]);e!==void 0&&p!=null&&h(e,["setup","generationConfig","speechConfig"],xC(c_(p)));const g=c(t,["thinkingConfig"]);e!==void 0&&g!=null&&h(e,["setup","generationConfig","thinkingConfig"],g);const v=c(t,["enableAffectiveDialog"]);e!==void 0&&v!=null&&h(e,["setup","generationConfig","enableAffectiveDialog"],v);const E=c(t,["systemInstruction"]);e!==void 0&&E!=null&&h(e,["setup","systemInstruction"],Yt(E));const R=c(t,["tools"]);if(e!==void 0&&R!=null){let B=ja(R);Array.isArray(B)&&(B=B.map(T=>aD(Ka(T)))),h(e,["setup","tools"],B)}const M=c(t,["sessionResumption"]);e!==void 0&&M!=null&&h(e,["setup","sessionResumption"],M);const A=c(t,["inputAudioTranscription"]);e!==void 0&&A!=null&&h(e,["setup","inputAudioTranscription"],A);const I=c(t,["outputAudioTranscription"]);e!==void 0&&I!=null&&h(e,["setup","outputAudioTranscription"],I);const C=c(t,["realtimeInputConfig"]);e!==void 0&&C!=null&&h(e,["setup","realtimeInputConfig"],C);const V=c(t,["contextWindowCompression"]);e!==void 0&&V!=null&&h(e,["setup","contextWindowCompression"],V);const F=c(t,["proactivity"]);return e!==void 0&&F!=null&&h(e,["setup","proactivity"],F),n}function YN(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["setup","model"],qe(t,r));const i=c(e,["config"]);return i!=null&&h(n,["config"],JN(i,n)),n}function XN(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["setup","model"],qe(t,r));const i=c(e,["config"]);return i!=null&&h(n,["config"],QN(i,n)),n}function ZN(t){const e={},n=c(t,["musicGenerationConfig"]);return n!=null&&h(e,["musicGenerationConfig"],n),e}function eD(t){const e={},n=c(t,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>i)),h(e,["weightedPrompts"],r)}return e}function tD(t){const e={},n=c(t,["media"]);if(n!=null){let u=pC(n);Array.isArray(u)&&(u=u.map(f=>md(f))),h(e,["mediaChunks"],u)}const r=c(t,["audio"]);r!=null&&h(e,["audio"],md(gC(r)));const i=c(t,["audioStreamEnd"]);i!=null&&h(e,["audioStreamEnd"],i);const s=c(t,["video"]);s!=null&&h(e,["video"],md(mC(s)));const o=c(t,["text"]);o!=null&&h(e,["text"],o);const a=c(t,["activityStart"]);a!=null&&h(e,["activityStart"],a);const l=c(t,["activityEnd"]);return l!=null&&h(e,["activityEnd"],l),e}function nD(t){const e={},n=c(t,["media"]);if(n!=null){let u=pC(n);Array.isArray(u)&&(u=u.map(f=>f)),h(e,["mediaChunks"],u)}const r=c(t,["audio"]);r!=null&&h(e,["audio"],gC(r));const i=c(t,["audioStreamEnd"]);i!=null&&h(e,["audioStreamEnd"],i);const s=c(t,["video"]);s!=null&&h(e,["video"],mC(s));const o=c(t,["text"]);o!=null&&h(e,["text"],o);const a=c(t,["activityStart"]);a!=null&&h(e,["activityStart"],a);const l=c(t,["activityEnd"]);return l!=null&&h(e,["activityEnd"],l),e}function rD(t){const e={},n=c(t,["setupComplete"]);n!=null&&h(e,["setupComplete"],n);const r=c(t,["serverContent"]);r!=null&&h(e,["serverContent"],r);const i=c(t,["toolCall"]);i!=null&&h(e,["toolCall"],i);const s=c(t,["toolCallCancellation"]);s!=null&&h(e,["toolCallCancellation"],s);const o=c(t,["usageMetadata"]);o!=null&&h(e,["usageMetadata"],lD(o));const a=c(t,["goAway"]);a!=null&&h(e,["goAway"],a);const l=c(t,["sessionResumptionUpdate"]);return l!=null&&h(e,["sessionResumptionUpdate"],l),e}function iD(t){const e={},n=c(t,["videoMetadata"]);n!=null&&h(e,["videoMetadata"],n);const r=c(t,["thought"]);r!=null&&h(e,["thought"],r);const i=c(t,["inlineData"]);i!=null&&h(e,["inlineData"],md(i));const s=c(t,["fileData"]);s!=null&&h(e,["fileData"],$N(s));const o=c(t,["thoughtSignature"]);o!=null&&h(e,["thoughtSignature"],o);const a=c(t,["functionCall"]);a!=null&&h(e,["functionCall"],a);const l=c(t,["codeExecutionResult"]);l!=null&&h(e,["codeExecutionResult"],l);const u=c(t,["executableCode"]);u!=null&&h(e,["executableCode"],u);const f=c(t,["functionResponse"]);f!=null&&h(e,["functionResponse"],f);const p=c(t,["text"]);return p!=null&&h(e,["text"],p),e}function sD(t){const e={},n=c(t,["handle"]);if(n!=null&&h(e,["handle"],n),c(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function xC(t){const e={},n=c(t,["voiceConfig"]);if(n!=null&&h(e,["voiceConfig"],n),c(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const r=c(t,["languageCode"]);return r!=null&&h(e,["languageCode"],r),e}function oD(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(f=>f)),h(e,["functionDeclarations"],u)}if(c(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=c(t,["googleSearch"]);r!=null&&h(e,["googleSearch"],jN(r));const i=c(t,["googleSearchRetrieval"]);if(i!=null&&h(e,["googleSearchRetrieval"],i),c(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=c(t,["googleMaps"]);s!=null&&h(e,["googleMaps"],KN(s));const o=c(t,["urlContext"]);o!=null&&h(e,["urlContext"],o);const a=c(t,["computerUse"]);a!=null&&h(e,["computerUse"],a);const l=c(t,["codeExecution"]);return l!=null&&h(e,["codeExecution"],l),e}function aD(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let p=n;Array.isArray(p)&&(p=p.map(g=>HN(g))),h(e,["functionDeclarations"],p)}const r=c(t,["retrieval"]);r!=null&&h(e,["retrieval"],r);const i=c(t,["googleSearch"]);i!=null&&h(e,["googleSearch"],i);const s=c(t,["googleSearchRetrieval"]);s!=null&&h(e,["googleSearchRetrieval"],s);const o=c(t,["enterpriseWebSearch"]);o!=null&&h(e,["enterpriseWebSearch"],o);const a=c(t,["googleMaps"]);a!=null&&h(e,["googleMaps"],a);const l=c(t,["urlContext"]);l!=null&&h(e,["urlContext"],l);const u=c(t,["computerUse"]);u!=null&&h(e,["computerUse"],u);const f=c(t,["codeExecution"]);return f!=null&&h(e,["codeExecution"],f),e}function lD(t){const e={},n=c(t,["promptTokenCount"]);n!=null&&h(e,["promptTokenCount"],n);const r=c(t,["cachedContentTokenCount"]);r!=null&&h(e,["cachedContentTokenCount"],r);const i=c(t,["candidatesTokenCount"]);i!=null&&h(e,["responseTokenCount"],i);const s=c(t,["toolUsePromptTokenCount"]);s!=null&&h(e,["toolUsePromptTokenCount"],s);const o=c(t,["thoughtsTokenCount"]);o!=null&&h(e,["thoughtsTokenCount"],o);const a=c(t,["totalTokenCount"]);a!=null&&h(e,["totalTokenCount"],a);const l=c(t,["promptTokensDetails"]);if(l!=null){let v=l;Array.isArray(v)&&(v=v.map(E=>E)),h(e,["promptTokensDetails"],v)}const u=c(t,["cacheTokensDetails"]);if(u!=null){let v=u;Array.isArray(v)&&(v=v.map(E=>E)),h(e,["cacheTokensDetails"],v)}const f=c(t,["candidatesTokensDetails"]);if(f!=null){let v=f;Array.isArray(v)&&(v=v.map(E=>E)),h(e,["responseTokensDetails"],v)}const p=c(t,["toolUsePromptTokensDetails"]);if(p!=null){let v=p;Array.isArray(v)&&(v=v.map(E=>E)),h(e,["toolUsePromptTokensDetails"],v)}const g=c(t,["trafficType"]);return g!=null&&h(e,["trafficType"],g),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function uD(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["data"]);n!=null&&h(e,["data"],n);const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function cD(t){const e={},n=c(t,["content"]);n!=null&&h(e,["content"],n);const r=c(t,["citationMetadata"]);r!=null&&h(e,["citationMetadata"],dD(r));const i=c(t,["tokenCount"]);i!=null&&h(e,["tokenCount"],i);const s=c(t,["finishReason"]);s!=null&&h(e,["finishReason"],s);const o=c(t,["urlContextMetadata"]);o!=null&&h(e,["urlContextMetadata"],o);const a=c(t,["avgLogprobs"]);a!=null&&h(e,["avgLogprobs"],a);const l=c(t,["groundingMetadata"]);l!=null&&h(e,["groundingMetadata"],l);const u=c(t,["index"]);u!=null&&h(e,["index"],u);const f=c(t,["logprobsResult"]);f!=null&&h(e,["logprobsResult"],f);const p=c(t,["safetyRatings"]);if(p!=null){let g=p;Array.isArray(g)&&(g=g.map(v=>v)),h(e,["safetyRatings"],g)}return e}function dD(t){const e={},n=c(t,["citationSources"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>i)),h(e,["citations"],r)}return e}function hD(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=c(e,["contents"]);if(i!=null){let s=Gn(i);Array.isArray(s)&&(s=s.map(o=>o)),h(n,["contents"],s)}return n}function fD(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["tokensInfo"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>s)),h(e,["tokensInfo"],i)}return e}function pD(t){const e={},n=c(t,["values"]);n!=null&&h(e,["values"],n);const r=c(t,["statistics"]);return r!=null&&h(e,["statistics"],mD(r)),e}function mD(t){const e={},n=c(t,["truncated"]);n!=null&&h(e,["truncated"],n);const r=c(t,["token_count"]);return r!=null&&h(e,["tokenCount"],r),e}function Kh(t){const e={},n=c(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>Tb(s))),h(e,["parts"],i)}const r=c(t,["role"]);return r!=null&&h(e,["role"],r),e}function gD(t){const e={},n=c(t,["controlType"]);n!=null&&h(e,["controlType"],n);const r=c(t,["enableControlImageComputation"]);return r!=null&&h(e,["computeControl"],r),e}function _D(t){const e={};if(c(t,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(c(t,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(c(t,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function yD(t,e){const n={},r=c(t,["systemInstruction"]);e!==void 0&&r!=null&&h(e,["systemInstruction"],Yt(r));const i=c(t,["tools"]);if(e!==void 0&&i!=null){let o=i;Array.isArray(o)&&(o=o.map(a=>DC(a))),h(e,["tools"],o)}const s=c(t,["generationConfig"]);return e!==void 0&&s!=null&&h(e,["generationConfig"],ab(s)),n}function vD(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=c(e,["contents"]);if(i!=null){let o=Gn(i);Array.isArray(o)&&(o=o.map(a=>Kh(a))),h(n,["contents"],o)}const s=c(e,["config"]);return s!=null&&_D(s),n}function TD(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=c(e,["contents"]);if(i!=null){let o=Gn(i);Array.isArray(o)&&(o=o.map(a=>a)),h(n,["contents"],o)}const s=c(e,["config"]);return s!=null&&yD(s,n),n}function ED(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["totalTokens"]);r!=null&&h(e,["totalTokens"],r);const i=c(t,["cachedContentTokenCount"]);return i!=null&&h(e,["cachedContentTokenCount"],i),e}function ID(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["totalTokens"]);return r!=null&&h(e,["totalTokens"],r),e}function wD(t,e){const n={},r=c(e,["model"]);return r!=null&&h(n,["_url","name"],qe(t,r)),n}function SD(t,e){const n={},r=c(e,["model"]);return r!=null&&h(n,["_url","name"],qe(t,r)),n}function CD(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&h(e,["sdkHttpResponse"],n),e}function AD(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&h(e,["sdkHttpResponse"],n),e}function xD(t,e){const n={},r=c(t,["outputGcsUri"]);e!==void 0&&r!=null&&h(e,["parameters","storageUri"],r);const i=c(t,["negativePrompt"]);e!==void 0&&i!=null&&h(e,["parameters","negativePrompt"],i);const s=c(t,["numberOfImages"]);e!==void 0&&s!=null&&h(e,["parameters","sampleCount"],s);const o=c(t,["aspectRatio"]);e!==void 0&&o!=null&&h(e,["parameters","aspectRatio"],o);const a=c(t,["guidanceScale"]);e!==void 0&&a!=null&&h(e,["parameters","guidanceScale"],a);const l=c(t,["seed"]);e!==void 0&&l!=null&&h(e,["parameters","seed"],l);const u=c(t,["safetyFilterLevel"]);e!==void 0&&u!=null&&h(e,["parameters","safetySetting"],u);const f=c(t,["personGeneration"]);e!==void 0&&f!=null&&h(e,["parameters","personGeneration"],f);const p=c(t,["includeSafetyAttributes"]);e!==void 0&&p!=null&&h(e,["parameters","includeSafetyAttributes"],p);const g=c(t,["includeRaiReason"]);e!==void 0&&g!=null&&h(e,["parameters","includeRaiReason"],g);const v=c(t,["language"]);e!==void 0&&v!=null&&h(e,["parameters","language"],v);const E=c(t,["outputMimeType"]);e!==void 0&&E!=null&&h(e,["parameters","outputOptions","mimeType"],E);const R=c(t,["outputCompressionQuality"]);e!==void 0&&R!=null&&h(e,["parameters","outputOptions","compressionQuality"],R);const M=c(t,["addWatermark"]);e!==void 0&&M!=null&&h(e,["parameters","addWatermark"],M);const A=c(t,["labels"]);e!==void 0&&A!=null&&h(e,["labels"],A);const I=c(t,["editMode"]);e!==void 0&&I!=null&&h(e,["parameters","editMode"],I);const C=c(t,["baseSteps"]);return e!==void 0&&C!=null&&h(e,["parameters","editConfig","baseSteps"],C),n}function RD(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=c(e,["prompt"]);i!=null&&h(n,["instances[0]","prompt"],i);const s=c(e,["referenceImages"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>Ab(l))),h(n,["instances[0]","referenceImages"],a)}const o=c(e,["config"]);return o!=null&&xD(o,n),n}function PD(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>jh(s))),h(e,["generatedImages"],i)}return e}function kD(t,e){const n={},r=c(t,["taskType"]);e!==void 0&&r!=null&&h(e,["requests[]","taskType"],r);const i=c(t,["title"]);e!==void 0&&i!=null&&h(e,["requests[]","title"],i);const s=c(t,["outputDimensionality"]);if(e!==void 0&&s!=null&&h(e,["requests[]","outputDimensionality"],s),c(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(c(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function ND(t,e){const n={},r=c(t,["taskType"]);e!==void 0&&r!=null&&h(e,["instances[]","task_type"],r);const i=c(t,["title"]);e!==void 0&&i!=null&&h(e,["instances[]","title"],i);const s=c(t,["outputDimensionality"]);e!==void 0&&s!=null&&h(e,["parameters","outputDimensionality"],s);const o=c(t,["mimeType"]);e!==void 0&&o!=null&&h(e,["instances[]","mimeType"],o);const a=c(t,["autoTruncate"]);return e!==void 0&&a!=null&&h(e,["parameters","autoTruncate"],a),n}function DD(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=c(e,["contents"]);if(i!=null){let a=a_(t,i);Array.isArray(a)&&(a=a.map(l=>l)),h(n,["requests[]","content"],a)}const s=c(e,["config"]);s!=null&&kD(s,n);const o=c(e,["model"]);return o!==void 0&&h(n,["requests[]","model"],qe(t,o)),n}function bD(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=c(e,["contents"]);if(i!=null){let o=a_(t,i);Array.isArray(o)&&(o=o.map(a=>a)),h(n,["instances[]","content"],o)}const s=c(e,["config"]);return s!=null&&ND(s,n),n}function MD(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["embeddings"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>o)),h(e,["embeddings"],s)}const i=c(t,["metadata"]);return i!=null&&h(e,["metadata"],i),e}function VD(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["predictions[]","embeddings"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>pD(o))),h(e,["embeddings"],s)}const i=c(t,["metadata"]);return i!=null&&h(e,["metadata"],i),e}function LD(t){const e={},n=c(t,["endpoint"]);n!=null&&h(e,["name"],n);const r=c(t,["deployedModelId"]);return r!=null&&h(e,["deployedModelId"],r),e}function FD(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["fileUri"]);n!=null&&h(e,["fileUri"],n);const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function UD(t){const e={};if(c(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=c(t,["description"]);n!=null&&h(e,["description"],n);const r=c(t,["name"]);r!=null&&h(e,["name"],r);const i=c(t,["parameters"]);i!=null&&h(e,["parameters"],i);const s=c(t,["parametersJsonSchema"]);s!=null&&h(e,["parametersJsonSchema"],s);const o=c(t,["response"]);o!=null&&h(e,["response"],o);const a=c(t,["responseJsonSchema"]);return a!=null&&h(e,["responseJsonSchema"],a),e}function OD(t,e,n){const r={},i=c(e,["systemInstruction"]);n!==void 0&&i!=null&&h(n,["systemInstruction"],Kh(Yt(i)));const s=c(e,["temperature"]);s!=null&&h(r,["temperature"],s);const o=c(e,["topP"]);o!=null&&h(r,["topP"],o);const a=c(e,["topK"]);a!=null&&h(r,["topK"],a);const l=c(e,["candidateCount"]);l!=null&&h(r,["candidateCount"],l);const u=c(e,["maxOutputTokens"]);u!=null&&h(r,["maxOutputTokens"],u);const f=c(e,["stopSequences"]);f!=null&&h(r,["stopSequences"],f);const p=c(e,["responseLogprobs"]);p!=null&&h(r,["responseLogprobs"],p);const g=c(e,["logprobs"]);g!=null&&h(r,["logprobs"],g);const v=c(e,["presencePenalty"]);v!=null&&h(r,["presencePenalty"],v);const E=c(e,["frequencyPenalty"]);E!=null&&h(r,["frequencyPenalty"],E);const R=c(e,["seed"]);R!=null&&h(r,["seed"],R);const M=c(e,["responseMimeType"]);M!=null&&h(r,["responseMimeType"],M);const A=c(e,["responseSchema"]);A!=null&&h(r,["responseSchema"],l_(A));const I=c(e,["responseJsonSchema"]);if(I!=null&&h(r,["responseJsonSchema"],I),c(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(c(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const C=c(e,["safetySettings"]);if(n!==void 0&&C!=null){let L=C;Array.isArray(L)&&(L=L.map(N=>xb(N))),h(n,["safetySettings"],L)}const V=c(e,["tools"]);if(n!==void 0&&V!=null){let L=ja(V);Array.isArray(L)&&(L=L.map(N=>bb(Ka(N)))),h(n,["tools"],L)}const F=c(e,["toolConfig"]);if(n!==void 0&&F!=null&&h(n,["toolConfig"],F),c(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const B=c(e,["cachedContent"]);n!==void 0&&B!=null&&h(n,["cachedContent"],ii(t,B));const T=c(e,["responseModalities"]);T!=null&&h(r,["responseModalities"],T);const w=c(e,["mediaResolution"]);w!=null&&h(r,["mediaResolution"],w);const x=c(e,["speechConfig"]);if(x!=null&&h(r,["speechConfig"],u_(x)),c(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const k=c(e,["thinkingConfig"]);k!=null&&h(r,["thinkingConfig"],k);const D=c(e,["imageConfig"]);return D!=null&&h(r,["imageConfig"],D),r}function BD(t,e,n){const r={},i=c(e,["systemInstruction"]);n!==void 0&&i!=null&&h(n,["systemInstruction"],Yt(i));const s=c(e,["temperature"]);s!=null&&h(r,["temperature"],s);const o=c(e,["topP"]);o!=null&&h(r,["topP"],o);const a=c(e,["topK"]);a!=null&&h(r,["topK"],a);const l=c(e,["candidateCount"]);l!=null&&h(r,["candidateCount"],l);const u=c(e,["maxOutputTokens"]);u!=null&&h(r,["maxOutputTokens"],u);const f=c(e,["stopSequences"]);f!=null&&h(r,["stopSequences"],f);const p=c(e,["responseLogprobs"]);p!=null&&h(r,["responseLogprobs"],p);const g=c(e,["logprobs"]);g!=null&&h(r,["logprobs"],g);const v=c(e,["presencePenalty"]);v!=null&&h(r,["presencePenalty"],v);const E=c(e,["frequencyPenalty"]);E!=null&&h(r,["frequencyPenalty"],E);const R=c(e,["seed"]);R!=null&&h(r,["seed"],R);const M=c(e,["responseMimeType"]);M!=null&&h(r,["responseMimeType"],M);const A=c(e,["responseSchema"]);A!=null&&h(r,["responseSchema"],l_(A));const I=c(e,["responseJsonSchema"]);I!=null&&h(r,["responseJsonSchema"],I);const C=c(e,["routingConfig"]);C!=null&&h(r,["routingConfig"],C);const V=c(e,["modelSelectionConfig"]);V!=null&&h(r,["modelConfig"],V);const F=c(e,["safetySettings"]);if(n!==void 0&&F!=null){let je=F;Array.isArray(je)&&(je=je.map(ye=>ye)),h(n,["safetySettings"],je)}const B=c(e,["tools"]);if(n!==void 0&&B!=null){let je=ja(B);Array.isArray(je)&&(je=je.map(ye=>DC(Ka(ye)))),h(n,["tools"],je)}const T=c(e,["toolConfig"]);n!==void 0&&T!=null&&h(n,["toolConfig"],T);const w=c(e,["labels"]);n!==void 0&&w!=null&&h(n,["labels"],w);const x=c(e,["cachedContent"]);n!==void 0&&x!=null&&h(n,["cachedContent"],ii(t,x));const k=c(e,["responseModalities"]);k!=null&&h(r,["responseModalities"],k);const D=c(e,["mediaResolution"]);D!=null&&h(r,["mediaResolution"],D);const L=c(e,["speechConfig"]);L!=null&&h(r,["speechConfig"],NC(u_(L)));const N=c(e,["audioTimestamp"]);N!=null&&h(r,["audioTimestamp"],N);const Me=c(e,["thinkingConfig"]);Me!=null&&h(r,["thinkingConfig"],Me);const et=c(e,["imageConfig"]);return et!=null&&h(r,["imageConfig"],et),r}function UT(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=c(e,["contents"]);if(i!=null){let o=Gn(i);Array.isArray(o)&&(o=o.map(a=>Kh(a))),h(n,["contents"],o)}const s=c(e,["config"]);return s!=null&&h(n,["generationConfig"],OD(t,s,n)),n}function OT(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=c(e,["contents"]);if(i!=null){let o=Gn(i);Array.isArray(o)&&(o=o.map(a=>a)),h(n,["contents"],o)}const s=c(e,["config"]);return s!=null&&h(n,["generationConfig"],BD(t,s,n)),n}function BT(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["candidates"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(u=>cD(u))),h(e,["candidates"],l)}const i=c(t,["modelVersion"]);i!=null&&h(e,["modelVersion"],i);const s=c(t,["promptFeedback"]);s!=null&&h(e,["promptFeedback"],s);const o=c(t,["responseId"]);o!=null&&h(e,["responseId"],o);const a=c(t,["usageMetadata"]);return a!=null&&h(e,["usageMetadata"],a),e}function qT(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["candidates"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(f=>f)),h(e,["candidates"],u)}const i=c(t,["createTime"]);i!=null&&h(e,["createTime"],i);const s=c(t,["modelVersion"]);s!=null&&h(e,["modelVersion"],s);const o=c(t,["promptFeedback"]);o!=null&&h(e,["promptFeedback"],o);const a=c(t,["responseId"]);a!=null&&h(e,["responseId"],a);const l=c(t,["usageMetadata"]);return l!=null&&h(e,["usageMetadata"],l),e}function qD(t,e){const n={};if(c(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(c(t,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const r=c(t,["numberOfImages"]);e!==void 0&&r!=null&&h(e,["parameters","sampleCount"],r);const i=c(t,["aspectRatio"]);e!==void 0&&i!=null&&h(e,["parameters","aspectRatio"],i);const s=c(t,["guidanceScale"]);if(e!==void 0&&s!=null&&h(e,["parameters","guidanceScale"],s),c(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=c(t,["safetyFilterLevel"]);e!==void 0&&o!=null&&h(e,["parameters","safetySetting"],o);const a=c(t,["personGeneration"]);e!==void 0&&a!=null&&h(e,["parameters","personGeneration"],a);const l=c(t,["includeSafetyAttributes"]);e!==void 0&&l!=null&&h(e,["parameters","includeSafetyAttributes"],l);const u=c(t,["includeRaiReason"]);e!==void 0&&u!=null&&h(e,["parameters","includeRaiReason"],u);const f=c(t,["language"]);e!==void 0&&f!=null&&h(e,["parameters","language"],f);const p=c(t,["outputMimeType"]);e!==void 0&&p!=null&&h(e,["parameters","outputOptions","mimeType"],p);const g=c(t,["outputCompressionQuality"]);if(e!==void 0&&g!=null&&h(e,["parameters","outputOptions","compressionQuality"],g),c(t,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(c(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const v=c(t,["imageSize"]);if(e!==void 0&&v!=null&&h(e,["parameters","sampleImageSize"],v),c(t,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function GD(t,e){const n={},r=c(t,["outputGcsUri"]);e!==void 0&&r!=null&&h(e,["parameters","storageUri"],r);const i=c(t,["negativePrompt"]);e!==void 0&&i!=null&&h(e,["parameters","negativePrompt"],i);const s=c(t,["numberOfImages"]);e!==void 0&&s!=null&&h(e,["parameters","sampleCount"],s);const o=c(t,["aspectRatio"]);e!==void 0&&o!=null&&h(e,["parameters","aspectRatio"],o);const a=c(t,["guidanceScale"]);e!==void 0&&a!=null&&h(e,["parameters","guidanceScale"],a);const l=c(t,["seed"]);e!==void 0&&l!=null&&h(e,["parameters","seed"],l);const u=c(t,["safetyFilterLevel"]);e!==void 0&&u!=null&&h(e,["parameters","safetySetting"],u);const f=c(t,["personGeneration"]);e!==void 0&&f!=null&&h(e,["parameters","personGeneration"],f);const p=c(t,["includeSafetyAttributes"]);e!==void 0&&p!=null&&h(e,["parameters","includeSafetyAttributes"],p);const g=c(t,["includeRaiReason"]);e!==void 0&&g!=null&&h(e,["parameters","includeRaiReason"],g);const v=c(t,["language"]);e!==void 0&&v!=null&&h(e,["parameters","language"],v);const E=c(t,["outputMimeType"]);e!==void 0&&E!=null&&h(e,["parameters","outputOptions","mimeType"],E);const R=c(t,["outputCompressionQuality"]);e!==void 0&&R!=null&&h(e,["parameters","outputOptions","compressionQuality"],R);const M=c(t,["addWatermark"]);e!==void 0&&M!=null&&h(e,["parameters","addWatermark"],M);const A=c(t,["labels"]);e!==void 0&&A!=null&&h(e,["labels"],A);const I=c(t,["imageSize"]);e!==void 0&&I!=null&&h(e,["parameters","sampleImageSize"],I);const C=c(t,["enhancePrompt"]);return e!==void 0&&C!=null&&h(e,["parameters","enhancePrompt"],C),n}function zD(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=c(e,["prompt"]);i!=null&&h(n,["instances[0]","prompt"],i);const s=c(e,["config"]);return s!=null&&qD(s,n),n}function $D(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=c(e,["prompt"]);i!=null&&h(n,["instances[0]","prompt"],i);const s=c(e,["config"]);return s!=null&&GD(s,n),n}function HD(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>rb(o))),h(e,["generatedImages"],s)}const i=c(t,["positivePromptSafetyAttributes"]);return i!=null&&h(e,["positivePromptSafetyAttributes"],PC(i)),e}function WD(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>jh(o))),h(e,["generatedImages"],s)}const i=c(t,["positivePromptSafetyAttributes"]);return i!=null&&h(e,["positivePromptSafetyAttributes"],kC(i)),e}function KD(t,e){const n={},r=c(t,["numberOfVideos"]);if(e!==void 0&&r!=null&&h(e,["parameters","sampleCount"],r),c(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(c(t,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const i=c(t,["durationSeconds"]);if(e!==void 0&&i!=null&&h(e,["parameters","durationSeconds"],i),c(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const s=c(t,["aspectRatio"]);e!==void 0&&s!=null&&h(e,["parameters","aspectRatio"],s);const o=c(t,["resolution"]);e!==void 0&&o!=null&&h(e,["parameters","resolution"],o);const a=c(t,["personGeneration"]);if(e!==void 0&&a!=null&&h(e,["parameters","personGeneration"],a),c(t,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const l=c(t,["negativePrompt"]);e!==void 0&&l!=null&&h(e,["parameters","negativePrompt"],l);const u=c(t,["enhancePrompt"]);if(e!==void 0&&u!=null&&h(e,["parameters","enhancePrompt"],u),c(t,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const f=c(t,["lastFrame"]);e!==void 0&&f!=null&&h(e,["instances[0]","lastFrame"],Jh(f));const p=c(t,["referenceImages"]);if(e!==void 0&&p!=null){let g=p;Array.isArray(g)&&(g=g.map(v=>Wb(v))),h(e,["instances[0]","referenceImages"],g)}if(c(t,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(c(t,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return n}function jD(t,e){const n={},r=c(t,["numberOfVideos"]);e!==void 0&&r!=null&&h(e,["parameters","sampleCount"],r);const i=c(t,["outputGcsUri"]);e!==void 0&&i!=null&&h(e,["parameters","storageUri"],i);const s=c(t,["fps"]);e!==void 0&&s!=null&&h(e,["parameters","fps"],s);const o=c(t,["durationSeconds"]);e!==void 0&&o!=null&&h(e,["parameters","durationSeconds"],o);const a=c(t,["seed"]);e!==void 0&&a!=null&&h(e,["parameters","seed"],a);const l=c(t,["aspectRatio"]);e!==void 0&&l!=null&&h(e,["parameters","aspectRatio"],l);const u=c(t,["resolution"]);e!==void 0&&u!=null&&h(e,["parameters","resolution"],u);const f=c(t,["personGeneration"]);e!==void 0&&f!=null&&h(e,["parameters","personGeneration"],f);const p=c(t,["pubsubTopic"]);e!==void 0&&p!=null&&h(e,["parameters","pubsubTopic"],p);const g=c(t,["negativePrompt"]);e!==void 0&&g!=null&&h(e,["parameters","negativePrompt"],g);const v=c(t,["enhancePrompt"]);e!==void 0&&v!=null&&h(e,["parameters","enhancePrompt"],v);const E=c(t,["generateAudio"]);e!==void 0&&E!=null&&h(e,["parameters","generateAudio"],E);const R=c(t,["lastFrame"]);e!==void 0&&R!=null&&h(e,["instances[0]","lastFrame"],dr(R));const M=c(t,["referenceImages"]);if(e!==void 0&&M!=null){let C=M;Array.isArray(C)&&(C=C.map(V=>Kb(V))),h(e,["instances[0]","referenceImages"],C)}const A=c(t,["mask"]);e!==void 0&&A!=null&&h(e,["instances[0]","mask"],Hb(A));const I=c(t,["compressionQuality"]);return e!==void 0&&I!=null&&h(e,["parameters","compressionQuality"],I),n}function JD(t){const e={},n=c(t,["name"]);n!=null&&h(e,["name"],n);const r=c(t,["metadata"]);r!=null&&h(e,["metadata"],r);const i=c(t,["done"]);i!=null&&h(e,["done"],i);const s=c(t,["error"]);s!=null&&h(e,["error"],s);const o=c(t,["response","generateVideoResponse"]);return o!=null&&h(e,["response"],ZD(o)),e}function QD(t){const e={},n=c(t,["name"]);n!=null&&h(e,["name"],n);const r=c(t,["metadata"]);r!=null&&h(e,["metadata"],r);const i=c(t,["done"]);i!=null&&h(e,["done"],i);const s=c(t,["error"]);s!=null&&h(e,["error"],s);const o=c(t,["response"]);return o!=null&&h(e,["response"],eb(o)),e}function YD(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=c(e,["prompt"]);i!=null&&h(n,["instances[0]","prompt"],i);const s=c(e,["image"]);s!=null&&h(n,["instances[0]","image"],Jh(s));const o=c(e,["video"]);o!=null&&h(n,["instances[0]","video"],bC(o));const a=c(e,["source"]);a!=null&&tb(a,n);const l=c(e,["config"]);return l!=null&&KD(l,n),n}function XD(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=c(e,["prompt"]);i!=null&&h(n,["instances[0]","prompt"],i);const s=c(e,["image"]);s!=null&&h(n,["instances[0]","image"],dr(s));const o=c(e,["video"]);o!=null&&h(n,["instances[0]","video"],MC(o));const a=c(e,["source"]);a!=null&&nb(a,n);const l=c(e,["config"]);return l!=null&&jD(l,n),n}function ZD(t){const e={},n=c(t,["generatedSamples"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>sb(o))),h(e,["generatedVideos"],s)}const r=c(t,["raiMediaFilteredCount"]);r!=null&&h(e,["raiMediaFilteredCount"],r);const i=c(t,["raiMediaFilteredReasons"]);return i!=null&&h(e,["raiMediaFilteredReasons"],i),e}function eb(t){const e={},n=c(t,["videos"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>ob(o))),h(e,["generatedVideos"],s)}const r=c(t,["raiMediaFilteredCount"]);r!=null&&h(e,["raiMediaFilteredCount"],r);const i=c(t,["raiMediaFilteredReasons"]);return i!=null&&h(e,["raiMediaFilteredReasons"],i),e}function tb(t,e){const n={},r=c(t,["prompt"]);e!==void 0&&r!=null&&h(e,["instances[0]","prompt"],r);const i=c(t,["image"]);e!==void 0&&i!=null&&h(e,["instances[0]","image"],Jh(i));const s=c(t,["video"]);return e!==void 0&&s!=null&&h(e,["instances[0]","video"],bC(s)),n}function nb(t,e){const n={},r=c(t,["prompt"]);e!==void 0&&r!=null&&h(e,["instances[0]","prompt"],r);const i=c(t,["image"]);e!==void 0&&i!=null&&h(e,["instances[0]","image"],dr(i));const s=c(t,["video"]);return e!==void 0&&s!=null&&h(e,["instances[0]","video"],MC(s)),n}function rb(t){const e={},n=c(t,["_self"]);n!=null&&h(e,["image"],hb(n));const r=c(t,["raiFilteredReason"]);r!=null&&h(e,["raiFilteredReason"],r);const i=c(t,["_self"]);return i!=null&&h(e,["safetyAttributes"],PC(i)),e}function jh(t){const e={},n=c(t,["_self"]);n!=null&&h(e,["image"],RC(n));const r=c(t,["raiFilteredReason"]);r!=null&&h(e,["raiFilteredReason"],r);const i=c(t,["_self"]);i!=null&&h(e,["safetyAttributes"],kC(i));const s=c(t,["prompt"]);return s!=null&&h(e,["enhancedPrompt"],s),e}function ib(t){const e={},n=c(t,["_self"]);n!=null&&h(e,["mask"],RC(n));const r=c(t,["labels"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>s)),h(e,["labels"],i)}return e}function sb(t){const e={},n=c(t,["video"]);return n!=null&&h(e,["video"],zb(n)),e}function ob(t){const e={},n=c(t,["_self"]);return n!=null&&h(e,["video"],$b(n)),e}function ab(t){const e={},n=c(t,["modelSelectionConfig"]);n!=null&&h(e,["modelConfig"],n);const r=c(t,["audioTimestamp"]);r!=null&&h(e,["audioTimestamp"],r);const i=c(t,["candidateCount"]);i!=null&&h(e,["candidateCount"],i);const s=c(t,["enableAffectiveDialog"]);s!=null&&h(e,["enableAffectiveDialog"],s);const o=c(t,["frequencyPenalty"]);o!=null&&h(e,["frequencyPenalty"],o);const a=c(t,["logprobs"]);a!=null&&h(e,["logprobs"],a);const l=c(t,["maxOutputTokens"]);l!=null&&h(e,["maxOutputTokens"],l);const u=c(t,["mediaResolution"]);u!=null&&h(e,["mediaResolution"],u);const f=c(t,["presencePenalty"]);f!=null&&h(e,["presencePenalty"],f);const p=c(t,["responseJsonSchema"]);p!=null&&h(e,["responseJsonSchema"],p);const g=c(t,["responseLogprobs"]);g!=null&&h(e,["responseLogprobs"],g);const v=c(t,["responseMimeType"]);v!=null&&h(e,["responseMimeType"],v);const E=c(t,["responseModalities"]);E!=null&&h(e,["responseModalities"],E);const R=c(t,["responseSchema"]);R!=null&&h(e,["responseSchema"],R);const M=c(t,["routingConfig"]);M!=null&&h(e,["routingConfig"],M);const A=c(t,["seed"]);A!=null&&h(e,["seed"],A);const I=c(t,["speechConfig"]);I!=null&&h(e,["speechConfig"],NC(I));const C=c(t,["stopSequences"]);C!=null&&h(e,["stopSequences"],C);const V=c(t,["temperature"]);V!=null&&h(e,["temperature"],V);const F=c(t,["thinkingConfig"]);F!=null&&h(e,["thinkingConfig"],F);const B=c(t,["topK"]);B!=null&&h(e,["topK"],B);const T=c(t,["topP"]);return T!=null&&h(e,["topP"],T),e}function lb(t,e){const n={},r=c(e,["model"]);return r!=null&&h(n,["_url","name"],qe(t,r)),n}function ub(t,e){const n={},r=c(e,["model"]);return r!=null&&h(n,["_url","name"],qe(t,r)),n}function cb(t){const e={};if(c(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=c(t,["enableWidget"]);return n!=null&&h(e,["enableWidget"],n),e}function db(t){const e={},n=c(t,["timeRangeFilter"]);if(n!=null&&h(e,["timeRangeFilter"],n),c(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function hb(t){const e={},n=c(t,["bytesBase64Encoded"]);n!=null&&h(e,["imageBytes"],us(n));const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function RC(t){const e={},n=c(t,["gcsUri"]);n!=null&&h(e,["gcsUri"],n);const r=c(t,["bytesBase64Encoded"]);r!=null&&h(e,["imageBytes"],us(r));const i=c(t,["mimeType"]);return i!=null&&h(e,["mimeType"],i),e}function Jh(t){const e={};if(c(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=c(t,["imageBytes"]);n!=null&&h(e,["bytesBase64Encoded"],us(n));const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function dr(t){const e={},n=c(t,["gcsUri"]);n!=null&&h(e,["gcsUri"],n);const r=c(t,["imageBytes"]);r!=null&&h(e,["bytesBase64Encoded"],us(r));const i=c(t,["mimeType"]);return i!=null&&h(e,["mimeType"],i),e}function fb(t,e,n){const r={},i=c(e,["pageSize"]);n!==void 0&&i!=null&&h(n,["_query","pageSize"],i);const s=c(e,["pageToken"]);n!==void 0&&s!=null&&h(n,["_query","pageToken"],s);const o=c(e,["filter"]);n!==void 0&&o!=null&&h(n,["_query","filter"],o);const a=c(e,["queryBase"]);return n!==void 0&&a!=null&&h(n,["_url","models_url"],TC(t,a)),r}function pb(t,e,n){const r={},i=c(e,["pageSize"]);n!==void 0&&i!=null&&h(n,["_query","pageSize"],i);const s=c(e,["pageToken"]);n!==void 0&&s!=null&&h(n,["_query","pageToken"],s);const o=c(e,["filter"]);n!==void 0&&o!=null&&h(n,["_query","filter"],o);const a=c(e,["queryBase"]);return n!==void 0&&a!=null&&h(n,["_url","models_url"],TC(t,a)),r}function mb(t,e){const n={},r=c(e,["config"]);return r!=null&&fb(t,r,n),n}function gb(t,e){const n={},r=c(e,["config"]);return r!=null&&pb(t,r,n),n}function _b(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=c(t,["_self"]);if(i!=null){let s=EC(i);Array.isArray(s)&&(s=s.map(o=>Sm(o))),h(e,["models"],s)}return e}function yb(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=c(t,["_self"]);if(i!=null){let s=EC(i);Array.isArray(s)&&(s=s.map(o=>Cm(o))),h(e,["models"],s)}return e}function vb(t){const e={},n=c(t,["maskMode"]);n!=null&&h(e,["maskMode"],n);const r=c(t,["segmentationClasses"]);r!=null&&h(e,["maskClasses"],r);const i=c(t,["maskDilation"]);return i!=null&&h(e,["dilation"],i),e}function Sm(t){const e={},n=c(t,["name"]);n!=null&&h(e,["name"],n);const r=c(t,["displayName"]);r!=null&&h(e,["displayName"],r);const i=c(t,["description"]);i!=null&&h(e,["description"],i);const s=c(t,["version"]);s!=null&&h(e,["version"],s);const o=c(t,["_self"]);o!=null&&h(e,["tunedModelInfo"],Mb(o));const a=c(t,["inputTokenLimit"]);a!=null&&h(e,["inputTokenLimit"],a);const l=c(t,["outputTokenLimit"]);l!=null&&h(e,["outputTokenLimit"],l);const u=c(t,["supportedGenerationMethods"]);return u!=null&&h(e,["supportedActions"],u),e}function Cm(t){const e={},n=c(t,["name"]);n!=null&&h(e,["name"],n);const r=c(t,["displayName"]);r!=null&&h(e,["displayName"],r);const i=c(t,["description"]);i!=null&&h(e,["description"],i);const s=c(t,["versionId"]);s!=null&&h(e,["version"],s);const o=c(t,["deployedModels"]);if(o!=null){let p=o;Array.isArray(p)&&(p=p.map(g=>LD(g))),h(e,["endpoints"],p)}const a=c(t,["labels"]);a!=null&&h(e,["labels"],a);const l=c(t,["_self"]);l!=null&&h(e,["tunedModelInfo"],Vb(l));const u=c(t,["defaultCheckpointId"]);u!=null&&h(e,["defaultCheckpointId"],u);const f=c(t,["checkpoints"]);if(f!=null){let p=f;Array.isArray(p)&&(p=p.map(g=>g)),h(e,["checkpoints"],p)}return e}function Tb(t){const e={},n=c(t,["videoMetadata"]);n!=null&&h(e,["videoMetadata"],n);const r=c(t,["thought"]);r!=null&&h(e,["thought"],r);const i=c(t,["inlineData"]);i!=null&&h(e,["inlineData"],uD(i));const s=c(t,["fileData"]);s!=null&&h(e,["fileData"],FD(s));const o=c(t,["thoughtSignature"]);o!=null&&h(e,["thoughtSignature"],o);const a=c(t,["functionCall"]);a!=null&&h(e,["functionCall"],a);const l=c(t,["codeExecutionResult"]);l!=null&&h(e,["codeExecutionResult"],l);const u=c(t,["executableCode"]);u!=null&&h(e,["executableCode"],u);const f=c(t,["functionResponse"]);f!=null&&h(e,["functionResponse"],f);const p=c(t,["text"]);return p!=null&&h(e,["text"],p),e}function Eb(t){const e={},n=c(t,["productImage"]);return n!=null&&h(e,["image"],dr(n)),e}function Ib(t,e){const n={},r=c(t,["numberOfImages"]);e!==void 0&&r!=null&&h(e,["parameters","sampleCount"],r);const i=c(t,["baseSteps"]);e!==void 0&&i!=null&&h(e,["parameters","editConfig","baseSteps"],i);const s=c(t,["outputGcsUri"]);e!==void 0&&s!=null&&h(e,["parameters","storageUri"],s);const o=c(t,["seed"]);e!==void 0&&o!=null&&h(e,["parameters","seed"],o);const a=c(t,["safetyFilterLevel"]);e!==void 0&&a!=null&&h(e,["parameters","safetySetting"],a);const l=c(t,["personGeneration"]);e!==void 0&&l!=null&&h(e,["parameters","personGeneration"],l);const u=c(t,["addWatermark"]);e!==void 0&&u!=null&&h(e,["parameters","addWatermark"],u);const f=c(t,["outputMimeType"]);e!==void 0&&f!=null&&h(e,["parameters","outputOptions","mimeType"],f);const p=c(t,["outputCompressionQuality"]);e!==void 0&&p!=null&&h(e,["parameters","outputOptions","compressionQuality"],p);const g=c(t,["enhancePrompt"]);e!==void 0&&g!=null&&h(e,["parameters","enhancePrompt"],g);const v=c(t,["labels"]);return e!==void 0&&v!=null&&h(e,["labels"],v),n}function wb(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=c(e,["source"]);i!=null&&Cb(i,n);const s=c(e,["config"]);return s!=null&&Ib(s,n),n}function Sb(t){const e={},n=c(t,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>jh(i))),h(e,["generatedImages"],r)}return e}function Cb(t,e){const n={},r=c(t,["prompt"]);e!==void 0&&r!=null&&h(e,["instances[0]","prompt"],r);const i=c(t,["personImage"]);e!==void 0&&i!=null&&h(e,["instances[0]","personImage","image"],dr(i));const s=c(t,["productImages"]);if(e!==void 0&&s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>Eb(a))),h(e,["instances[0]","productImages"],o)}return n}function Ab(t){const e={},n=c(t,["referenceImage"]);n!=null&&h(e,["referenceImage"],dr(n));const r=c(t,["referenceId"]);r!=null&&h(e,["referenceId"],r);const i=c(t,["referenceType"]);i!=null&&h(e,["referenceType"],i);const s=c(t,["maskImageConfig"]);s!=null&&h(e,["maskImageConfig"],vb(s));const o=c(t,["controlImageConfig"]);o!=null&&h(e,["controlImageConfig"],gD(o));const a=c(t,["styleImageConfig"]);a!=null&&h(e,["styleImageConfig"],a);const l=c(t,["subjectImageConfig"]);return l!=null&&h(e,["subjectImageConfig"],l),e}function PC(t){const e={},n=c(t,["safetyAttributes","categories"]);n!=null&&h(e,["categories"],n);const r=c(t,["safetyAttributes","scores"]);r!=null&&h(e,["scores"],r);const i=c(t,["contentType"]);return i!=null&&h(e,["contentType"],i),e}function kC(t){const e={},n=c(t,["safetyAttributes","categories"]);n!=null&&h(e,["categories"],n);const r=c(t,["safetyAttributes","scores"]);r!=null&&h(e,["scores"],r);const i=c(t,["contentType"]);return i!=null&&h(e,["contentType"],i),e}function xb(t){const e={};if(c(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=c(t,["category"]);n!=null&&h(e,["category"],n);const r=c(t,["threshold"]);return r!=null&&h(e,["threshold"],r),e}function Rb(t){const e={},n=c(t,["image"]);return n!=null&&h(e,["image"],dr(n)),e}function Pb(t,e){const n={},r=c(t,["mode"]);e!==void 0&&r!=null&&h(e,["parameters","mode"],r);const i=c(t,["maxPredictions"]);e!==void 0&&i!=null&&h(e,["parameters","maxPredictions"],i);const s=c(t,["confidenceThreshold"]);e!==void 0&&s!=null&&h(e,["parameters","confidenceThreshold"],s);const o=c(t,["maskDilation"]);e!==void 0&&o!=null&&h(e,["parameters","maskDilation"],o);const a=c(t,["binaryColorThreshold"]);e!==void 0&&a!=null&&h(e,["parameters","binaryColorThreshold"],a);const l=c(t,["labels"]);return e!==void 0&&l!=null&&h(e,["labels"],l),n}function kb(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=c(e,["source"]);i!=null&&Db(i,n);const s=c(e,["config"]);return s!=null&&Pb(s,n),n}function Nb(t){const e={},n=c(t,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>ib(i))),h(e,["generatedMasks"],r)}return e}function Db(t,e){const n={},r=c(t,["prompt"]);e!==void 0&&r!=null&&h(e,["instances[0]","prompt"],r);const i=c(t,["image"]);e!==void 0&&i!=null&&h(e,["instances[0]","image"],dr(i));const s=c(t,["scribbleImage"]);return e!==void 0&&s!=null&&h(e,["instances[0]","scribble"],Rb(s)),n}function NC(t){const e={},n=c(t,["voiceConfig"]);if(n!=null&&h(e,["voiceConfig"],n),c(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const r=c(t,["languageCode"]);return r!=null&&h(e,["languageCode"],r),e}function bb(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(f=>f)),h(e,["functionDeclarations"],u)}if(c(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=c(t,["googleSearch"]);r!=null&&h(e,["googleSearch"],db(r));const i=c(t,["googleSearchRetrieval"]);if(i!=null&&h(e,["googleSearchRetrieval"],i),c(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=c(t,["googleMaps"]);s!=null&&h(e,["googleMaps"],cb(s));const o=c(t,["urlContext"]);o!=null&&h(e,["urlContext"],o);const a=c(t,["computerUse"]);a!=null&&h(e,["computerUse"],a);const l=c(t,["codeExecution"]);return l!=null&&h(e,["codeExecution"],l),e}function DC(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let p=n;Array.isArray(p)&&(p=p.map(g=>UD(g))),h(e,["functionDeclarations"],p)}const r=c(t,["retrieval"]);r!=null&&h(e,["retrieval"],r);const i=c(t,["googleSearch"]);i!=null&&h(e,["googleSearch"],i);const s=c(t,["googleSearchRetrieval"]);s!=null&&h(e,["googleSearchRetrieval"],s);const o=c(t,["enterpriseWebSearch"]);o!=null&&h(e,["enterpriseWebSearch"],o);const a=c(t,["googleMaps"]);a!=null&&h(e,["googleMaps"],a);const l=c(t,["urlContext"]);l!=null&&h(e,["urlContext"],l);const u=c(t,["computerUse"]);u!=null&&h(e,["computerUse"],u);const f=c(t,["codeExecution"]);return f!=null&&h(e,["codeExecution"],f),e}function Mb(t){const e={},n=c(t,["baseModel"]);n!=null&&h(e,["baseModel"],n);const r=c(t,["createTime"]);r!=null&&h(e,["createTime"],r);const i=c(t,["updateTime"]);return i!=null&&h(e,["updateTime"],i),e}function Vb(t){const e={},n=c(t,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&h(e,["baseModel"],n);const r=c(t,["createTime"]);r!=null&&h(e,["createTime"],r);const i=c(t,["updateTime"]);return i!=null&&h(e,["updateTime"],i),e}function Lb(t,e){const n={},r=c(t,["displayName"]);e!==void 0&&r!=null&&h(e,["displayName"],r);const i=c(t,["description"]);e!==void 0&&i!=null&&h(e,["description"],i);const s=c(t,["defaultCheckpointId"]);return e!==void 0&&s!=null&&h(e,["defaultCheckpointId"],s),n}function Fb(t,e){const n={},r=c(t,["displayName"]);e!==void 0&&r!=null&&h(e,["displayName"],r);const i=c(t,["description"]);e!==void 0&&i!=null&&h(e,["description"],i);const s=c(t,["defaultCheckpointId"]);return e!==void 0&&s!=null&&h(e,["defaultCheckpointId"],s),n}function Ub(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","name"],qe(t,r));const i=c(e,["config"]);return i!=null&&Lb(i,n),n}function Ob(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=c(e,["config"]);return i!=null&&Fb(i,n),n}function Bb(t,e){const n={},r=c(t,["outputGcsUri"]);e!==void 0&&r!=null&&h(e,["parameters","storageUri"],r);const i=c(t,["includeRaiReason"]);e!==void 0&&i!=null&&h(e,["parameters","includeRaiReason"],i);const s=c(t,["outputMimeType"]);e!==void 0&&s!=null&&h(e,["parameters","outputOptions","mimeType"],s);const o=c(t,["outputCompressionQuality"]);e!==void 0&&o!=null&&h(e,["parameters","outputOptions","compressionQuality"],o);const a=c(t,["enhanceInputImage"]);e!==void 0&&a!=null&&h(e,["parameters","upscaleConfig","enhanceInputImage"],a);const l=c(t,["imagePreservationFactor"]);e!==void 0&&l!=null&&h(e,["parameters","upscaleConfig","imagePreservationFactor"],l);const u=c(t,["labels"]);e!==void 0&&u!=null&&h(e,["labels"],u);const f=c(t,["numberOfImages"]);e!==void 0&&f!=null&&h(e,["parameters","sampleCount"],f);const p=c(t,["mode"]);return e!==void 0&&p!=null&&h(e,["parameters","mode"],p),n}function qb(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=c(e,["image"]);i!=null&&h(n,["instances[0]","image"],dr(i));const s=c(e,["upscaleFactor"]);s!=null&&h(n,["parameters","upscaleConfig","upscaleFactor"],s);const o=c(e,["config"]);return o!=null&&Bb(o,n),n}function Gb(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>jh(s))),h(e,["generatedImages"],i)}return e}function zb(t){const e={},n=c(t,["uri"]);n!=null&&h(e,["uri"],n);const r=c(t,["encodedVideo"]);r!=null&&h(e,["videoBytes"],us(r));const i=c(t,["encoding"]);return i!=null&&h(e,["mimeType"],i),e}function $b(t){const e={},n=c(t,["gcsUri"]);n!=null&&h(e,["uri"],n);const r=c(t,["bytesBase64Encoded"]);r!=null&&h(e,["videoBytes"],us(r));const i=c(t,["mimeType"]);return i!=null&&h(e,["mimeType"],i),e}function Hb(t){const e={},n=c(t,["image"]);n!=null&&h(e,["_self"],dr(n));const r=c(t,["maskMode"]);return r!=null&&h(e,["maskMode"],r),e}function Wb(t){const e={},n=c(t,["image"]);n!=null&&h(e,["image"],Jh(n));const r=c(t,["referenceType"]);return r!=null&&h(e,["referenceType"],r),e}function Kb(t){const e={},n=c(t,["image"]);n!=null&&h(e,["image"],dr(n));const r=c(t,["referenceType"]);return r!=null&&h(e,["referenceType"],r),e}function bC(t){const e={},n=c(t,["uri"]);n!=null&&h(e,["uri"],n);const r=c(t,["videoBytes"]);r!=null&&h(e,["encodedVideo"],us(r));const i=c(t,["mimeType"]);return i!=null&&h(e,["encoding"],i),e}function MC(t){const e={},n=c(t,["uri"]);n!=null&&h(e,["gcsUri"],n);const r=c(t,["videoBytes"]);r!=null&&h(e,["bytesBase64Encoded"],us(r));const i=c(t,["mimeType"]);return i!=null&&h(e,["mimeType"],i),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const jb="Content-Type",Jb="X-Server-Timeout",Qb="User-Agent",Am="x-goog-api-client",Yb="1.25.0",Xb=`google-genai-sdk/${Yb}`,Zb="v1beta1",eM="v1beta",GT=/^\s*data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class tM{constructor(e){var n,r;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const i={};this.clientOptions.vertexai?(i.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:Zb,i.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(i.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:eM,i.baseUrl="https://generativelanguage.googleapis.com/"),i.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=i,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(i,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&r.push(e.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),n=new URL(e);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,n,r){const i=[this.getRequestUrlInternal(n)];return r&&i.push(this.getBaseResourcePath()),e!==""&&i.push(e),new URL(`${i.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,n,r);if(e.queryParams)for(const[o,a]of Object.entries(e.queryParams))i.searchParams.append(o,String(a));let s={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else s.body=e.body;return s=await this.includeExtraHttpOptionsToRequestInit(s,n,e.abortSignal),this.unaryApiCall(i,s,e.httpMethod)}patchHttpOptions(e,n){const r=JSON.parse(JSON.stringify(e));for(const[i,s]of Object.entries(n))typeof s=="object"?r[i]=Object.assign(Object.assign({},r[i]),s):s!==void 0&&(r[i]=s);return r}async requestStream(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,n,r);(!i.searchParams.has("alt")||i.searchParams.get("alt")!=="sse")&&i.searchParams.set("alt","sse");let s={};return s.body=e.body,s=await this.includeExtraHttpOptionsToRequestInit(s,n,e.abortSignal),this.streamApiCall(i,s,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,n,r){if(n&&n.timeout||r){const i=new AbortController,s=i.signal;if(n.timeout&&(n==null?void 0:n.timeout)>0){const o=setTimeout(()=>i.abort(),n.timeout);o&&typeof o.unref=="function"&&o.unref()}r&&r.addEventListener("abort",()=>{i.abort()}),e.signal=s}return n&&n.extraBody!==null&&nM(e,n.extraBody),e.headers=await this.getHeadersInternal(n),e}async unaryApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async i=>(await zT(i),new Em(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}async streamApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async i=>(await zT(i),this.processStreamResponse(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}processStreamResponse(e){var n;return ma(this,arguments,function*(){const i=(n=e==null?void 0:e.body)===null||n===void 0?void 0:n.getReader(),s=new TextDecoder("utf-8");if(!i)throw new Error("Response body is empty");try{let o="";for(;;){const{done:a,value:l}=yield st(i.read());if(a){if(o.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const u=s.decode(l,{stream:!0});try{const p=JSON.parse(u);if("error"in p){const g=JSON.parse(JSON.stringify(p.error)),v=g.status,E=g.code,R=`got status: ${v}. ${JSON.stringify(p)}`;if(E>=400&&E<600)throw new Wh({message:R,status:E})}}catch(p){if(p.name==="ApiError")throw p}o+=u;let f=o.match(GT);for(;f;){const p=f[1];try{const g=new Response(p,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield st(new Em(g)),o=o.slice(f[0].length),f=o.match(GT)}catch(g){throw new Error(`exception parsing stream chunk ${p}. ${g}`)}}}}finally{i.releaseLock()}})}async apiCall(e,n){return fetch(e,n).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const e={},n=Xb+" "+this.clientOptions.userAgentExtra;return e[Qb]=n,e[Am]=n,e[jb]="application/json",e}async getHeadersInternal(e){const n=new Headers;if(e&&e.headers){for(const[r,i]of Object.entries(e.headers))n.append(r,i);e.timeout&&e.timeout>0&&n.append(Jb,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(n),n}async uploadFile(e,n){var r;const i={};n!=null&&(i.mimeType=n.mimeType,i.name=n.name,i.displayName=n.displayName),i.name&&!i.name.startsWith("files/")&&(i.name=`files/${i.name}`);const s=this.clientOptions.uploader,o=await s.stat(e);i.sizeBytes=String(o.size);const a=(r=n==null?void 0:n.mimeType)!==null&&r!==void 0?r:o.type;if(a===void 0||a==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");i.mimeType=a;const l=await this.fetchUploadUrl(i,n);return s.upload(e,l,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,n){var r;let i={};n!=null&&n.httpOptions?i=n.httpOptions:i={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};const s={file:e},o=await this.request({path:ce("upload/v1beta/files",s._url),body:JSON.stringify(s),httpMethod:"POST",httpOptions:i});if(!o||!(o!=null&&o.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const a=(r=o==null?void 0:o.headers)===null||r===void 0?void 0:r["x-goog-upload-url"];if(a===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return a}}async function zT(t){var e;if(t===void 0)throw new Error("response is undefined");if(!t.ok){const n=t.status;let r;!((e=t.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?r=await t.json():r={error:{message:await t.text(),code:t.status,status:t.statusText}};const i=JSON.stringify(r);throw n>=400&&n<600?new Wh({message:i,status:n}):new Error(i)}}function nM(t,e){if(!e||Object.keys(e).length===0)return;if(t.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let n={};if(typeof t.body=="string"&&t.body.length>0)try{const s=JSON.parse(t.body);if(typeof s=="object"&&s!==null&&!Array.isArray(s))n=s;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function r(s,o){const a=Object.assign({},s);for(const l in o)if(Object.prototype.hasOwnProperty.call(o,l)){const u=o[l],f=a[l];u&&typeof u=="object"&&!Array.isArray(u)&&f&&typeof f=="object"&&!Array.isArray(f)?a[l]=r(f,u):(f&&u&&typeof f!=typeof u&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${l}". Original type: ${typeof f}, New type: ${typeof u}. Overwriting.`),a[l]=u)}return a}const i=r(n,e);t.body=JSON.stringify(i)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const rM="mcp_used/unknown";let iM=!1;function VC(t){for(const e of t)if(sM(e)||typeof e=="object"&&"inputSchema"in e)return!0;return iM}function LC(t){var e;const n=(e=t[Am])!==null&&e!==void 0?e:"";t[Am]=(n+` ${rM}`).trimStart()}function sM(t){return t!==null&&typeof t=="object"&&t instanceof d_}function oM(t,e=100){return ma(this,arguments,function*(){let r,i=0;for(;i<e;){const s=yield st(t.listTools({cursor:r}));for(const o of s.tools)yield yield st(o),i++;if(!s.nextCursor)break;r=s.nextCursor}})}class d_{constructor(e=[],n){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=n}static create(e,n){return new d_(e,n)}async initialize(){var e,n,r,i;if(this.mcpTools.length>0)return;const s={},o=[];for(const f of this.mcpClients)try{for(var a=!0,l=(n=void 0,Yl(oM(f))),u;u=await l.next(),e=u.done,!e;a=!0){i=u.value,a=!1;const p=i;o.push(p);const g=p.name;if(s[g])throw new Error(`Duplicate function name ${g} found in MCP tools. Please ensure function names are unique.`);s[g]=f}}catch(p){n={error:p}}finally{try{!a&&!e&&(r=l.return)&&await r.call(l)}finally{if(n)throw n.error}}this.mcpTools=o,this.functionNameToMcpClient=s}async tool(){return await this.initialize(),d1(this.mcpTools,this.config)}async callTool(e){await this.initialize();const n=[];for(const r of e)if(r.name in this.functionNameToMcpClient){const i=this.functionNameToMcpClient[r.name];let s;this.config.timeout&&(s={timeout:this.config.timeout});const o=await i.callTool({name:r.name,arguments:r.args},void 0,s);n.push({functionResponse:{name:r.name,response:o.isError?{error:o}:o}})}return n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function aM(t,e,n){const r=new r1;let i;n.data instanceof Blob?i=JSON.parse(await n.data.text()):i=JSON.parse(n.data),Object.assign(r,i),e(r)}class lM{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r}async connect(e){var n,r;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const i=this.apiClient.getWebsocketBaseUrl(),s=this.apiClient.getApiVersion(),o=dM(this.apiClient.getDefaultHeaders()),a=this.apiClient.getApiKey(),l=`${i}/ws/google.ai.generativelanguage.${s}.GenerativeService.BidiGenerateMusic?key=${a}`;let u=()=>{};const f=new Promise(C=>{u=C}),p=e.callbacks,g=function(){u({})},v=this.apiClient,E={onopen:g,onmessage:C=>{aM(v,p.onmessage,C)},onerror:(n=p==null?void 0:p.onerror)!==null&&n!==void 0?n:function(C){},onclose:(r=p==null?void 0:p.onclose)!==null&&r!==void 0?r:function(C){}},R=this.webSocketFactory.create(l,cM(o),E);R.connect(),await f;const I={setup:{model:qe(this.apiClient,e.model)}};return R.send(JSON.stringify(I)),new uM(R,this.apiClient)}}class uM{constructor(e,n){this.conn=e,this.apiClient=n}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const n=eD(e);this.conn.send(JSON.stringify({clientContent:n}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const n=ZN(e);this.conn.send(JSON.stringify(n))}sendPlaybackControl(e){const n={playbackControl:e};this.conn.send(JSON.stringify(n))}play(){this.sendPlaybackControl(oa.PLAY)}pause(){this.sendPlaybackControl(oa.PAUSE)}stop(){this.sendPlaybackControl(oa.STOP)}resetContext(){this.sendPlaybackControl(oa.RESET_CONTEXT)}close(){this.conn.close()}}function cM(t){const e={};return t.forEach((n,r)=>{e[r]=n}),e}function dM(t){const e=new Headers;for(const[n,r]of Object.entries(t))e.append(n,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const hM="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function fM(t,e,n){const r=new n1;let i;n.data instanceof Blob?i=await n.data.text():n.data instanceof ArrayBuffer?i=new TextDecoder().decode(n.data):i=n.data;const s=JSON.parse(i);if(t.isVertexAI()){const o=rD(s);Object.assign(r,o)}else Object.assign(r,s);e(r)}class pM{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r,this.music=new lM(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var n,r,i,s,o,a;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const l=this.apiClient.getWebsocketBaseUrl(),u=this.apiClient.getApiVersion();let f;const p=this.apiClient.getHeaders();e.config&&e.config.tools&&VC(e.config.tools)&&LC(p);const g=yM(p);if(this.apiClient.isVertexAI())f=`${l}/ws/google.cloud.aiplatform.${u}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(g);else{const x=this.apiClient.getApiKey();let k="BidiGenerateContent",D="key";x!=null&&x.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),u!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),k="BidiGenerateContentConstrained",D="access_token"),f=`${l}/ws/google.ai.generativelanguage.${u}.GenerativeService.${k}?${D}=${x}`}let v=()=>{};const E=new Promise(x=>{v=x}),R=e.callbacks,M=function(){var x;(x=R==null?void 0:R.onopen)===null||x===void 0||x.call(R),v({})},A=this.apiClient,I={onopen:M,onmessage:x=>{fM(A,R.onmessage,x)},onerror:(n=R==null?void 0:R.onerror)!==null&&n!==void 0?n:function(x){},onclose:(r=R==null?void 0:R.onclose)!==null&&r!==void 0?r:function(x){}},C=this.webSocketFactory.create(f,_M(g),I);C.connect(),await E;let V=qe(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&V.startsWith("publishers/")){const x=this.apiClient.getProject(),k=this.apiClient.getLocation();V=`projects/${x}/locations/${k}/`+V}let F={};this.apiClient.isVertexAI()&&((i=e.config)===null||i===void 0?void 0:i.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[th.AUDIO]}:e.config.responseModalities=[th.AUDIO]),!((s=e.config)===null||s===void 0)&&s.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const B=(a=(o=e.config)===null||o===void 0?void 0:o.tools)!==null&&a!==void 0?a:[],T=[];for(const x of B)if(this.isCallableTool(x)){const k=x;T.push(await k.tool())}else T.push(x);T.length>0&&(e.config.tools=T);const w={model:V,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?F=XN(this.apiClient,w):F=YN(this.apiClient,w),delete F.config,C.send(JSON.stringify(F)),new gM(C,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const mM={turnComplete:!0};class gM{constructor(e,n){this.conn=e,this.apiClient=n}tLiveClientContent(e,n){if(n.turns!==null&&n.turns!==void 0){let r=[];try{r=Gn(n.turns),e.isVertexAI()||(r=r.map(i=>Kh(i)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:r,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(e,n){let r=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?r=n.functionResponses:r=[n.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const s of r){if(typeof s!="object"||s===null||!("name"in s)||!("response"in s))throw new Error(`Could not parse function response, type '${typeof s}'.`);if(!e.isVertexAI()&&!("id"in s))throw new Error(hM)}return{toolResponse:{functionResponses:r}}}sendClientContent(e){e=Object.assign(Object.assign({},mM),e);const n=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(n))}sendRealtimeInput(e){let n={};this.apiClient.isVertexAI()?n={realtimeInput:nD(e)}:n={realtimeInput:tD(e)},this.conn.send(JSON.stringify(n))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function _M(t){const e={};return t.forEach((n,r)=>{e[r]=n}),e}function yM(t){const e=new Headers;for(const[n,r]of Object.entries(t))e.append(n,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const $T=10;function HT(t){var e,n,r;if(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let i=!1;for(const o of(n=t==null?void 0:t.tools)!==null&&n!==void 0?n:[])if(ga(o)){i=!0;break}if(!i)return!0;const s=(r=t==null?void 0:t.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls;return s&&(s<0||!Number.isInteger(s))||s==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",s),!0):!1}function ga(t){return"callTool"in t&&typeof t.callTool=="function"}function vM(t){var e,n,r;return(r=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(i=>ga(i)))!==null&&r!==void 0?r:!1}function TM(t){var e,n,r;return(r=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(i=>!ga(i)))!==null&&r!==void 0?r:!1}function WT(t){var e;return!(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class EM extends Eo{constructor(e){super(),this.apiClient=e,this.generateContent=async n=>{var r,i,s,o,a;const l=await this.processParamsMaybeAddMcpUsage(n);if(this.maybeMoveToResponseJsonSchem(n),!vM(n)||HT(n.config))return await this.generateContentInternal(l);if(TM(n))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");let u,f;const p=Gn(l.contents),g=(s=(i=(r=l.config)===null||r===void 0?void 0:r.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&s!==void 0?s:$T;let v=0;for(;v<g&&(u=await this.generateContentInternal(l),!(!u.functionCalls||u.functionCalls.length===0));){const E=u.candidates[0].content,R=[];for(const M of(a=(o=n.config)===null||o===void 0?void 0:o.tools)!==null&&a!==void 0?a:[])if(ga(M)){const I=await M.callTool(u.functionCalls);R.push(...I)}v++,f={role:"user",parts:R},l.contents=Gn(l.contents),l.contents.push(E),l.contents.push(f),WT(l.config)&&(p.push(E),p.push(f))}return WT(l.config)&&(u.automaticFunctionCallingHistory=p),u},this.generateContentStream=async n=>{if(this.maybeMoveToResponseJsonSchem(n),HT(n.config)){const r=await this.processParamsMaybeAddMcpUsage(n);return await this.generateContentStreamInternal(r)}else return await this.processAfcStream(n)},this.generateImages=async n=>await this.generateImagesInternal(n).then(r=>{var i;let s;const o=[];if(r!=null&&r.generatedImages)for(const l of r.generatedImages)l&&(l!=null&&l.safetyAttributes)&&((i=l==null?void 0:l.safetyAttributes)===null||i===void 0?void 0:i.contentType)==="Positive Prompt"?s=l==null?void 0:l.safetyAttributes:o.push(l);let a;return s?a={generatedImages:o,positivePromptSafetyAttributes:s,sdkHttpResponse:r.sdkHttpResponse}:a={generatedImages:o,sdkHttpResponse:r.sdkHttpResponse},a}),this.list=async n=>{var r;const o={config:Object.assign(Object.assign({},{queryBase:!0}),n==null?void 0:n.config)};if(this.apiClient.isVertexAI()&&!o.config.queryBase){if(!((r=o.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");o.config.filter="labels.tune-type:*"}return new Wu(uo.PAGED_ITEM_MODELS,a=>this.listInternal(a),await this.listInternal(o),o)},this.editImage=async n=>{const r={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(r.referenceImages=n.referenceImages.map(i=>i.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async n=>{let r={numberOfImages:1,mode:"upscale"};n.config&&(r=Object.assign(Object.assign({},r),n.config));const i={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:r};return await this.upscaleImageInternal(i)},this.generateVideos=async n=>{var r,i,s,o,a,l;if((n.prompt||n.image||n.video)&&n.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((r=n.video)===null||r===void 0)&&r.uri&&(!((i=n.video)===null||i===void 0)&&i.videoBytes)?n.video={uri:n.video.uri,mimeType:n.video.mimeType}:!((o=(s=n.source)===null||s===void 0?void 0:s.video)===null||o===void 0)&&o.uri&&(!((l=(a=n.source)===null||a===void 0?void 0:a.video)===null||l===void 0)&&l.videoBytes)&&(n.source.video={uri:n.source.video.uri,mimeType:n.source.video.mimeType})),await this.generateVideosInternal(n)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var n,r,i;const s=(n=e.config)===null||n===void 0?void 0:n.tools;if(!s)return e;const o=await Promise.all(s.map(async l=>ga(l)?await l.tool():l)),a={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:o})};if(a.config.tools=o,e.config&&e.config.tools&&VC(e.config.tools)){const l=(i=(r=e.config.httpOptions)===null||r===void 0?void 0:r.headers)!==null&&i!==void 0?i:{};let u=Object.assign({},l);Object.keys(u).length===0&&(u=this.apiClient.getDefaultHeaders()),LC(u),a.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:u})}return a}async initAfcToolsMap(e){var n,r,i;const s=new Map;for(const o of(r=(n=e.config)===null||n===void 0?void 0:n.tools)!==null&&r!==void 0?r:[])if(ga(o)){const a=o,l=await a.tool();for(const u of(i=l.functionDeclarations)!==null&&i!==void 0?i:[]){if(!u.name)throw new Error("Function declaration name is required.");if(s.has(u.name))throw new Error(`Duplicate tool declaration name: ${u.name}`);s.set(u.name,a)}}return s}async processAfcStream(e){var n,r,i;const s=(i=(r=(n=e.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&i!==void 0?i:$T;let o=!1,a=0;const l=await this.initAfcToolsMap(e);return function(u,f,p){var g,v;return ma(this,arguments,function*(){for(var E,R,M,A;a<s;){o&&(a++,o=!1);const F=yield st(u.processParamsMaybeAddMcpUsage(p)),B=yield st(u.generateContentStreamInternal(F)),T=[],w=[];try{for(var I=!0,C=(R=void 0,Yl(B)),V;V=yield st(C.next()),E=V.done,!E;I=!0){A=V.value,I=!1;const x=A;if(yield yield st(x),x.candidates&&(!((g=x.candidates[0])===null||g===void 0)&&g.content)){w.push(x.candidates[0].content);for(const k of(v=x.candidates[0].content.parts)!==null&&v!==void 0?v:[])if(a<s&&k.functionCall){if(!k.functionCall.name)throw new Error("Function call name was not returned by the model.");if(f.has(k.functionCall.name)){const D=yield st(f.get(k.functionCall.name).callTool([k.functionCall]));T.push(...D)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${f.keys()}, mising tool: ${k.functionCall.name}`)}}}}catch(x){R={error:x}}finally{try{!I&&!E&&(M=C.return)&&(yield st(M.call(C)))}finally{if(R)throw R.error}}if(T.length>0){o=!0;const x=new Cl;x.candidates=[{content:{role:"user",parts:T}}],yield yield st(x);const k=[];k.push(...w),k.push({role:"user",parts:T});const D=Gn(p.contents).concat(k);p.contents=D}else break}})}(this,l,e)}async generateContentInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=OT(this.apiClient,e);return a=ce("{model}:generateContent",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const p=qT(f),g=new Cl;return Object.assign(g,p),g})}else{const u=UT(this.apiClient,e);return a=ce("{model}:generateContent",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const p=BT(f),g=new Cl;return Object.assign(g,p),g})}}async generateContentStreamInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=OT(this.apiClient,e);return a=ce("{model}:streamGenerateContent?alt=sse",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.requestStream({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}),o.then(function(p){return ma(this,arguments,function*(){var g,v,E,R;try{for(var M=!0,A=Yl(p),I;I=yield st(A.next()),g=I.done,!g;M=!0){R=I.value,M=!1;const C=R,V=qT(yield st(C.json()));V.sdkHttpResponse={headers:C.headers};const F=new Cl;Object.assign(F,V),yield yield st(F)}}catch(C){v={error:C}}finally{try{!M&&!g&&(E=A.return)&&(yield st(E.call(A)))}finally{if(v)throw v.error}}})})}else{const u=UT(this.apiClient,e);return a=ce("{model}:streamGenerateContent?alt=sse",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.requestStream({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}),o.then(function(p){return ma(this,arguments,function*(){var g,v,E,R;try{for(var M=!0,A=Yl(p),I;I=yield st(A.next()),g=I.done,!g;M=!0){R=I.value,M=!1;const C=R,V=BT(yield st(C.json()));V.sdkHttpResponse={headers:C.headers};const F=new Cl;Object.assign(F,V),yield yield st(F)}}catch(C){v={error:C}}finally{try{!M&&!g&&(E=A.return)&&(yield st(E.call(A)))}finally{if(v)throw v.error}}})})}}async embedContent(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=bD(this.apiClient,e);return a=ce("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const p=VD(f),g=new IT;return Object.assign(g,p),g})}else{const u=DD(this.apiClient,e);return a=ce("{model}:batchEmbedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const p=MD(f),g=new IT;return Object.assign(g,p),g})}}async generateImagesInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=$D(this.apiClient,e);return a=ce("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const p=WD(f),g=new wT;return Object.assign(g,p),g})}else{const u=zD(this.apiClient,e);return a=ce("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const p=HD(f),g=new wT;return Object.assign(g,p),g})}}async editImageInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=RD(this.apiClient,e);return s=ce("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>{const u=PD(l),f=new jk;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=qb(this.apiClient,e);return s=ce("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>{const u=Gb(l),f=new Jk;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=wb(this.apiClient,e);return s=ce("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=Sb(l),f=new Qk;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=kb(this.apiClient,e);return s=ce("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=Nb(l),f=new Yk;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=ub(this.apiClient,e);return a=ce("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>Cm(f))}else{const u=lb(this.apiClient,e);return a=ce("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>Sm(f))}}async listInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=gb(this.apiClient,e);return a=ce("{models_url}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const p=yb(f),g=new ST;return Object.assign(g,p),g})}else{const u=mb(this.apiClient,e);return a=ce("{models_url}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const p=_b(f),g=new ST;return Object.assign(g,p),g})}}async update(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=Ob(this.apiClient,e);return a=ce("{model}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>Cm(f))}else{const u=Ub(this.apiClient,e);return a=ce("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>Sm(f))}}async delete(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=SD(this.apiClient,e);return a=ce("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const p=AD(f),g=new CT;return Object.assign(g,p),g})}else{const u=wD(this.apiClient,e);return a=ce("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const p=CD(f),g=new CT;return Object.assign(g,p),g})}}async countTokens(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=TD(this.apiClient,e);return a=ce("{model}:countTokens",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const p=ID(f),g=new AT;return Object.assign(g,p),g})}else{const u=vD(this.apiClient,e);return a=ce("{model}:countTokens",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const p=ED(f),g=new AT;return Object.assign(g,p),g})}}async computeTokens(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=hD(this.apiClient,e);return s=ce("{model}:computeTokens",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>{const u=fD(l),f=new Xk;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=XD(this.apiClient,e);return a=ce("{model}:predictLongRunning",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>{const p=QD(f),g=new nh;return Object.assign(g,p),g})}else{const u=YD(this.apiClient,e);return a=ce("{model}:predictLongRunning",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>{const p=JD(f),g=new nh;return Object.assign(g,p),g})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class IM extends Eo{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const n=e.operation,r=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=n.name.split("/operations/")[0];let s;r&&"httpOptions"in r&&(s=r.httpOptions);const o=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:i,config:{httpOptions:s}});return n._fromAPIResponse({apiResponse:o,isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:i,isVertexAI:!1})}}async get(e){const n=e.operation,r=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=n.name.split("/operations/")[0];let s;r&&"httpOptions"in r&&(s=r.httpOptions);const o=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:i,config:{httpOptions:s}});return n._fromAPIResponse({apiResponse:o,isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:i,isVertexAI:!1})}}async getVideosOperationInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=Hk(e);return a=ce("{operationName}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o}else{const u=$k(e);return a=ce("{operationName}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o}}async fetchPredictVideosOperationInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=Fk(e);return s=ce("{resourceName}:fetchPredictOperation",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function wM(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["data"]);n!=null&&h(e,["data"],n);const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function SM(t){const e={},n=c(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>DM(s))),h(e,["parts"],i)}const r=c(t,["role"]);return r!=null&&h(e,["role"],r),e}function CM(t,e,n){const r={},i=c(e,["expireTime"]);n!==void 0&&i!=null&&h(n,["expireTime"],i);const s=c(e,["newSessionExpireTime"]);n!==void 0&&s!=null&&h(n,["newSessionExpireTime"],s);const o=c(e,["uses"]);n!==void 0&&o!=null&&h(n,["uses"],o);const a=c(e,["liveConnectConstraints"]);n!==void 0&&a!=null&&h(n,["bidiGenerateContentSetup"],NM(t,a));const l=c(e,["lockAdditionalFields"]);return n!==void 0&&l!=null&&h(n,["fieldMask"],l),r}function AM(t,e){const n={},r=c(e,["config"]);return r!=null&&h(n,["config"],CM(t,r,n)),n}function xM(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["fileUri"]);n!=null&&h(e,["fileUri"],n);const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function RM(t){const e={};if(c(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=c(t,["enableWidget"]);return n!=null&&h(e,["enableWidget"],n),e}function PM(t){const e={},n=c(t,["timeRangeFilter"]);if(n!=null&&h(e,["timeRangeFilter"],n),c(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function kM(t,e){const n={},r=c(t,["generationConfig"]);e!==void 0&&r!=null&&h(e,["setup","generationConfig"],r);const i=c(t,["responseModalities"]);e!==void 0&&i!=null&&h(e,["setup","generationConfig","responseModalities"],i);const s=c(t,["temperature"]);e!==void 0&&s!=null&&h(e,["setup","generationConfig","temperature"],s);const o=c(t,["topP"]);e!==void 0&&o!=null&&h(e,["setup","generationConfig","topP"],o);const a=c(t,["topK"]);e!==void 0&&a!=null&&h(e,["setup","generationConfig","topK"],a);const l=c(t,["maxOutputTokens"]);e!==void 0&&l!=null&&h(e,["setup","generationConfig","maxOutputTokens"],l);const u=c(t,["mediaResolution"]);e!==void 0&&u!=null&&h(e,["setup","generationConfig","mediaResolution"],u);const f=c(t,["seed"]);e!==void 0&&f!=null&&h(e,["setup","generationConfig","seed"],f);const p=c(t,["speechConfig"]);e!==void 0&&p!=null&&h(e,["setup","generationConfig","speechConfig"],c_(p));const g=c(t,["thinkingConfig"]);e!==void 0&&g!=null&&h(e,["setup","generationConfig","thinkingConfig"],g);const v=c(t,["enableAffectiveDialog"]);e!==void 0&&v!=null&&h(e,["setup","generationConfig","enableAffectiveDialog"],v);const E=c(t,["systemInstruction"]);e!==void 0&&E!=null&&h(e,["setup","systemInstruction"],SM(Yt(E)));const R=c(t,["tools"]);if(e!==void 0&&R!=null){let B=ja(R);Array.isArray(B)&&(B=B.map(T=>MM(Ka(T)))),h(e,["setup","tools"],B)}const M=c(t,["sessionResumption"]);e!==void 0&&M!=null&&h(e,["setup","sessionResumption"],bM(M));const A=c(t,["inputAudioTranscription"]);e!==void 0&&A!=null&&h(e,["setup","inputAudioTranscription"],A);const I=c(t,["outputAudioTranscription"]);e!==void 0&&I!=null&&h(e,["setup","outputAudioTranscription"],I);const C=c(t,["realtimeInputConfig"]);e!==void 0&&C!=null&&h(e,["setup","realtimeInputConfig"],C);const V=c(t,["contextWindowCompression"]);e!==void 0&&V!=null&&h(e,["setup","contextWindowCompression"],V);const F=c(t,["proactivity"]);return e!==void 0&&F!=null&&h(e,["setup","proactivity"],F),n}function NM(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["setup","model"],qe(t,r));const i=c(e,["config"]);return i!=null&&h(n,["config"],kM(i,n)),n}function DM(t){const e={},n=c(t,["videoMetadata"]);n!=null&&h(e,["videoMetadata"],n);const r=c(t,["thought"]);r!=null&&h(e,["thought"],r);const i=c(t,["inlineData"]);i!=null&&h(e,["inlineData"],wM(i));const s=c(t,["fileData"]);s!=null&&h(e,["fileData"],xM(s));const o=c(t,["thoughtSignature"]);o!=null&&h(e,["thoughtSignature"],o);const a=c(t,["functionCall"]);a!=null&&h(e,["functionCall"],a);const l=c(t,["codeExecutionResult"]);l!=null&&h(e,["codeExecutionResult"],l);const u=c(t,["executableCode"]);u!=null&&h(e,["executableCode"],u);const f=c(t,["functionResponse"]);f!=null&&h(e,["functionResponse"],f);const p=c(t,["text"]);return p!=null&&h(e,["text"],p),e}function bM(t){const e={},n=c(t,["handle"]);if(n!=null&&h(e,["handle"],n),c(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function MM(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(f=>f)),h(e,["functionDeclarations"],u)}if(c(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=c(t,["googleSearch"]);r!=null&&h(e,["googleSearch"],PM(r));const i=c(t,["googleSearchRetrieval"]);if(i!=null&&h(e,["googleSearchRetrieval"],i),c(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=c(t,["googleMaps"]);s!=null&&h(e,["googleMaps"],RM(s));const o=c(t,["urlContext"]);o!=null&&h(e,["urlContext"],o);const a=c(t,["computerUse"]);a!=null&&h(e,["computerUse"],a);const l=c(t,["codeExecution"]);return l!=null&&h(e,["codeExecution"],l),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function VM(t){const e=[];for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const r=t[n];if(typeof r=="object"&&r!=null&&Object.keys(r).length>0){const i=Object.keys(r).map(s=>`${n}.${s}`);e.push(...i)}else e.push(n)}return e.join(",")}function LM(t,e){let n=null;const r=t.bidiGenerateContentSetup;if(typeof r=="object"&&r!==null&&"setup"in r){const s=r.setup;typeof s=="object"&&s!==null?(t.bidiGenerateContentSetup=s,n=s):delete t.bidiGenerateContentSetup}else r!==void 0&&delete t.bidiGenerateContentSetup;const i=t.fieldMask;if(n){const s=VM(n);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)s?t.fieldMask=s:delete t.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&i!==null&&Array.isArray(i)&&i.length>0){const o=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let a=[];i.length>0&&(a=i.map(u=>o.includes(u)?`generationConfig.${u}`:u));const l=[];s&&l.push(s),a.length>0&&l.push(...a),l.length>0?t.fieldMask=l.join(","):delete t.fieldMask}else delete t.fieldMask}else i!==null&&Array.isArray(i)&&i.length>0?t.fieldMask=i.join(","):delete t.fieldMask;return t}class FM extends Eo{constructor(e){super(),this.apiClient=e}async create(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const a=AM(this.apiClient,e);s=ce("auth_tokens",a._url),o=a._query,delete a.config,delete a._url,delete a._query;const l=LM(a,e.config);return i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>u)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function UM(t){const e={},n=c(t,["name"]);return n!=null&&h(e,["_url","name"],n),e}function OM(t){const e={},n=c(t,["name"]);return n!=null&&h(e,["_url","name"],n),e}function BM(t,e){const n={};if(c(t,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const r=c(t,["tunedModelDisplayName"]);if(e!==void 0&&r!=null&&h(e,["displayName"],r),c(t,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const i=c(t,["epochCount"]);e!==void 0&&i!=null&&h(e,["tuningTask","hyperparameters","epochCount"],i);const s=c(t,["learningRateMultiplier"]);if(s!=null&&h(n,["tuningTask","hyperparameters","learningRateMultiplier"],s),c(t,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(c(t,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(c(t,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const o=c(t,["batchSize"]);e!==void 0&&o!=null&&h(e,["tuningTask","hyperparameters","batchSize"],o);const a=c(t,["learningRate"]);if(e!==void 0&&a!=null&&h(e,["tuningTask","hyperparameters","learningRate"],a),c(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");return n}function qM(t,e){const n={},r=c(t,["validationDataset"]);e!==void 0&&r!=null&&h(e,["supervisedTuningSpec"],n2(r,n));const i=c(t,["tunedModelDisplayName"]);e!==void 0&&i!=null&&h(e,["tunedModelDisplayName"],i);const s=c(t,["description"]);e!==void 0&&s!=null&&h(e,["description"],s);const o=c(t,["epochCount"]);e!==void 0&&o!=null&&h(e,["supervisedTuningSpec","hyperParameters","epochCount"],o);const a=c(t,["learningRateMultiplier"]);e!==void 0&&a!=null&&h(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],a);const l=c(t,["exportLastCheckpointOnly"]);e!==void 0&&l!=null&&h(e,["supervisedTuningSpec","exportLastCheckpointOnly"],l);const u=c(t,["adapterSize"]);if(e!==void 0&&u!=null&&h(e,["supervisedTuningSpec","hyperParameters","adapterSize"],u),c(t,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(c(t,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const f=c(t,["labels"]);return e!==void 0&&f!=null&&h(e,["labels"],f),n}function GM(t){const e={},n=c(t,["baseModel"]);n!=null&&h(e,["baseModel"],n);const r=c(t,["preTunedModel"]);r!=null&&h(e,["preTunedModel"],r);const i=c(t,["trainingDataset"]);i!=null&&h(e,["tuningTask","trainingData"],ZM(i));const s=c(t,["config"]);return s!=null&&BM(s,e),e}function zM(t){const e={},n=c(t,["baseModel"]);n!=null&&h(e,["baseModel"],n);const r=c(t,["preTunedModel"]);r!=null&&h(e,["preTunedModel"],r);const i=c(t,["trainingDataset"]);i!=null&&h(e,["supervisedTuningSpec","trainingDatasetUri"],e2(i,e));const s=c(t,["config"]);return s!=null&&qM(s,e),e}function $M(t){const e={},n=c(t,["name"]);return n!=null&&h(e,["_url","name"],n),e}function HM(t){const e={},n=c(t,["name"]);return n!=null&&h(e,["_url","name"],n),e}function WM(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&h(e,["_query","pageSize"],r);const i=c(t,["pageToken"]);e!==void 0&&i!=null&&h(e,["_query","pageToken"],i);const s=c(t,["filter"]);return e!==void 0&&s!=null&&h(e,["_query","filter"],s),n}function KM(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&h(e,["_query","pageSize"],r);const i=c(t,["pageToken"]);e!==void 0&&i!=null&&h(e,["_query","pageToken"],i);const s=c(t,["filter"]);return e!==void 0&&s!=null&&h(e,["_query","filter"],s),n}function jM(t){const e={},n=c(t,["config"]);return n!=null&&WM(n,e),e}function JM(t){const e={},n=c(t,["config"]);return n!=null&&KM(n,e),e}function QM(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=c(t,["tunedModels"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>FC(o))),h(e,["tuningJobs"],s)}return e}function YM(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=c(t,["tuningJobs"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>xm(o))),h(e,["tuningJobs"],s)}return e}function XM(t){const e={},n=c(t,["name"]);n!=null&&h(e,["model"],n);const r=c(t,["name"]);return r!=null&&h(e,["endpoint"],r),e}function ZM(t){const e={};if(c(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(c(t,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const n=c(t,["examples"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>i)),h(e,["examples","examples"],r)}return e}function e2(t,e){const n={},r=c(t,["gcsUri"]);e!==void 0&&r!=null&&h(e,["supervisedTuningSpec","trainingDatasetUri"],r);const i=c(t,["vertexDatasetResource"]);if(e!==void 0&&i!=null&&h(e,["supervisedTuningSpec","trainingDatasetUri"],i),c(t,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return n}function FC(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["name"]);r!=null&&h(e,["name"],r);const i=c(t,["state"]);i!=null&&h(e,["state"],yC(i));const s=c(t,["createTime"]);s!=null&&h(e,["createTime"],s);const o=c(t,["tuningTask","startTime"]);o!=null&&h(e,["startTime"],o);const a=c(t,["tuningTask","completeTime"]);a!=null&&h(e,["endTime"],a);const l=c(t,["updateTime"]);l!=null&&h(e,["updateTime"],l);const u=c(t,["description"]);u!=null&&h(e,["description"],u);const f=c(t,["baseModel"]);f!=null&&h(e,["baseModel"],f);const p=c(t,["_self"]);p!=null&&h(e,["tunedModel"],XM(p));const g=c(t,["customBaseModel"]);g!=null&&h(e,["customBaseModel"],g);const v=c(t,["experiment"]);v!=null&&h(e,["experiment"],v);const E=c(t,["labels"]);E!=null&&h(e,["labels"],E);const R=c(t,["outputUri"]);R!=null&&h(e,["outputUri"],R);const M=c(t,["pipelineJob"]);M!=null&&h(e,["pipelineJob"],M);const A=c(t,["serviceAccount"]);A!=null&&h(e,["serviceAccount"],A);const I=c(t,["tunedModelDisplayName"]);I!=null&&h(e,["tunedModelDisplayName"],I);const C=c(t,["veoTuningSpec"]);return C!=null&&h(e,["veoTuningSpec"],C),e}function xm(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["name"]);r!=null&&h(e,["name"],r);const i=c(t,["state"]);i!=null&&h(e,["state"],yC(i));const s=c(t,["createTime"]);s!=null&&h(e,["createTime"],s);const o=c(t,["startTime"]);o!=null&&h(e,["startTime"],o);const a=c(t,["endTime"]);a!=null&&h(e,["endTime"],a);const l=c(t,["updateTime"]);l!=null&&h(e,["updateTime"],l);const u=c(t,["error"]);u!=null&&h(e,["error"],u);const f=c(t,["description"]);f!=null&&h(e,["description"],f);const p=c(t,["baseModel"]);p!=null&&h(e,["baseModel"],p);const g=c(t,["tunedModel"]);g!=null&&h(e,["tunedModel"],g);const v=c(t,["preTunedModel"]);v!=null&&h(e,["preTunedModel"],v);const E=c(t,["supervisedTuningSpec"]);E!=null&&h(e,["supervisedTuningSpec"],E);const R=c(t,["tuningDataStats"]);R!=null&&h(e,["tuningDataStats"],R);const M=c(t,["encryptionSpec"]);M!=null&&h(e,["encryptionSpec"],M);const A=c(t,["partnerModelTuningSpec"]);A!=null&&h(e,["partnerModelTuningSpec"],A);const I=c(t,["customBaseModel"]);I!=null&&h(e,["customBaseModel"],I);const C=c(t,["experiment"]);C!=null&&h(e,["experiment"],C);const V=c(t,["labels"]);V!=null&&h(e,["labels"],V);const F=c(t,["outputUri"]);F!=null&&h(e,["outputUri"],F);const B=c(t,["pipelineJob"]);B!=null&&h(e,["pipelineJob"],B);const T=c(t,["serviceAccount"]);T!=null&&h(e,["serviceAccount"],T);const w=c(t,["tunedModelDisplayName"]);w!=null&&h(e,["tunedModelDisplayName"],w);const x=c(t,["veoTuningSpec"]);return x!=null&&h(e,["veoTuningSpec"],x),e}function t2(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["name"]);r!=null&&h(e,["name"],r);const i=c(t,["metadata"]);i!=null&&h(e,["metadata"],i);const s=c(t,["done"]);s!=null&&h(e,["done"],s);const o=c(t,["error"]);return o!=null&&h(e,["error"],o),e}function n2(t,e){const n={},r=c(t,["gcsUri"]);r!=null&&h(n,["validationDatasetUri"],r);const i=c(t,["vertexDatasetResource"]);return e!==void 0&&i!=null&&h(e,["supervisedTuningSpec","trainingDatasetUri"],i),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class r2 extends Eo{constructor(e){super(),this.apiClient=e,this.get=async n=>await this.getInternal(n),this.list=async(n={})=>new Wu(uo.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(n),n),this.tune=async n=>{var r;if(this.apiClient.isVertexAI())if(n.baseModel.startsWith("projects/")){const i={tunedModelName:n.baseModel};!((r=n.config)===null||r===void 0)&&r.preTunedModelCheckpointId&&(i.checkpointId=n.config.preTunedModelCheckpointId);const s=Object.assign(Object.assign({},n),{preTunedModel:i});return s.baseModel=void 0,await this.tuneInternal(s)}else{const i=Object.assign({},n);return await this.tuneInternal(i)}else{const i=Object.assign({},n),s=await this.tuneMldevInternal(i);let o="";return s.metadata!==void 0&&s.metadata.tunedModel!==void 0?o=s.metadata.tunedModel:s.name!==void 0&&s.name.includes("/operations/")&&(o=s.name.split("/operations/")[0]),{name:o,state:Tm.JOB_STATE_QUEUED}}}}async getInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=HM(e);return a=ce("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>xm(f))}else{const u=$M(e);return a=ce("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>FC(f))}}async listInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=JM(e);return a=ce("tuningJobs",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const p=YM(f),g=new xT;return Object.assign(g,p),g})}else{const u=jM(e);return a=ce("tunedModels",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const p=QM(f),g=new xT;return Object.assign(g,p),g})}}async cancel(e){var n,r,i,s;let o="",a={};if(this.apiClient.isVertexAI()){const l=OM(e);o=ce("{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}else{const l=UM(e);o=ce("{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal})}}async tuneInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=zM(e);return s=ce("tuningJobs",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>xm(l))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=GM(e);return s=ce("tunedModels",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>t2(l))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class i2{async download(e,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const s2=1024*1024*8,o2=3,a2=1e3,l2=2,cp="x-goog-upload-status";async function u2(t,e,n){var r,i,s;let o=0,a=0,l=new Em(new Response),u="upload";for(o=t.size;a<o;){const p=Math.min(s2,o-a),g=t.slice(a,a+p);a+p>=o&&(u+=", finalize");let v=0,E=a2;for(;v<o2&&(l=await n.request({path:"",body:g,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":u,"X-Goog-Upload-Offset":String(a),"Content-Length":String(p)}}}),!(!((r=l==null?void 0:l.headers)===null||r===void 0)&&r[cp]));)v++,await d2(E),E=E*l2;if(a+=p,((i=l==null?void 0:l.headers)===null||i===void 0?void 0:i[cp])!=="active")break;if(o<=a)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const f=await(l==null?void 0:l.json());if(((s=l==null?void 0:l.headers)===null||s===void 0?void 0:s[cp])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return f.file}async function c2(t){return{size:t.size,type:t.type}}function d2(t){return new Promise(e=>setTimeout(e,t))}class h2{async upload(e,n,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await u2(e,n,r)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await c2(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class f2{create(e,n,r){return new p2(e,n,r)}}class p2{constructor(e,n,r){this.url=e,this.headers=n,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const KT="x-goog-api-key";class m2{constructor(e){this.apiKey=e}async addAuthHeaders(e){if(e.get(KT)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(KT,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const g2="gl-node/";class _2{constructor(e){var n;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=e.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=e.apiKey;const r=Vk(e.httpOptions,e.vertexai,void 0,void 0);r&&(e.httpOptions?e.httpOptions.baseUrl=r:e.httpOptions={baseUrl:r}),this.apiVersion=e.apiVersion;const i=new m2(this.apiKey);this.apiClient=new tM({auth:i,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:g2+"web",uploader:new h2,downloader:new i2}),this.models=new EM(this.apiClient),this.live=new pM(this.apiClient,i,new f2),this.batches=new eN(this.apiClient),this.chats=new DN(this.models,this.apiClient),this.caches=new PN(this.apiClient),this.files=new GN(this.apiClient),this.operations=new IM(this.apiClient),this.authTokens=new FM(this.apiClient),this.tunings=new r2(this.apiClient)}}const y2=()=>{};var jT={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UC=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},v2=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],o=t[n++],a=t[n++],l=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},OC={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],o=i+1<t.length,a=o?t[i+1]:0,l=i+2<t.length,u=l?t[i+2]:0,f=s>>2,p=(s&3)<<4|a>>4;let g=(a&15)<<2|u>>6,v=u&63;l||(v=64,o||(g=64)),r.push(n[f],n[p],n[g],n[v])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(UC(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):v2(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0;++i;const u=i<t.length?n[t.charAt(i)]:64;++i;const p=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||a==null||u==null||p==null)throw new T2;const g=s<<2|a>>4;if(r.push(g),u!==64){const v=a<<4&240|u>>2;if(r.push(v),p!==64){const E=u<<6&192|p;r.push(E)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class T2 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const E2=function(t){const e=UC(t);return OC.encodeByteArray(e,!0)},ih=function(t){return E2(t).replace(/\./g,"")},BC=function(t){try{return OC.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qC(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I2=()=>qC().__FIREBASE_DEFAULTS__,w2=()=>{if(typeof process>"u"||typeof jT>"u")return;const t=jT.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},S2=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&BC(t[1]);return e&&JSON.parse(e)},Qh=()=>{try{return y2()||I2()||w2()||S2()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},GC=t=>{var e,n;return(n=(e=Qh())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},C2=t=>{const e=GC(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},zC=()=>{var t;return(t=Qh())==null?void 0:t.config},$C=t=>{var e;return(e=Qh())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A2{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qa(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function HC(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x2(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...t};return[ih(JSON.stringify(n)),ih(JSON.stringify(o)),""].join(".")}const Xl={};function R2(){const t={prod:[],emulator:[]};for(const e of Object.keys(Xl))Xl[e]?t.emulator.push(e):t.prod.push(e);return t}function P2(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let JT=!1;function WC(t,e){if(typeof window>"u"||typeof document>"u"||!Qa(window.location.host)||Xl[t]===e||Xl[t]||JT)return;Xl[t]=e;function n(g){return`__firebase__banner__${g}`}const r="__firebase__banner",s=R2().prod.length>0;function o(){const g=document.getElementById(r);g&&g.remove()}function a(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function l(g,v){g.setAttribute("width","24"),g.setAttribute("id",v),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function u(){const g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{JT=!0,o()},g}function f(g,v){g.setAttribute("id",v),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function p(){const g=P2(r),v=n("text"),E=document.getElementById(v)||document.createElement("span"),R=n("learnmore"),M=document.getElementById(R)||document.createElement("a"),A=n("preprendIcon"),I=document.getElementById(A)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){const C=g.element;a(C),f(M,R);const V=u();l(I,A),C.append(I,E,M,V),document.body.appendChild(C)}s?(E.innerText="Preview backend disconnected.",I.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(I.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,E.innerText="Preview backend running in this workspace."),E.setAttribute("id",v)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",p):p()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function k2(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Rt())}function KC(){var e;const t=(e=Qh())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function N2(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function D2(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function b2(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function M2(){const t=Rt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function jC(){return!KC()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function JC(){return!KC()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function QC(){try{return typeof indexedDB=="object"}catch{return!1}}function V2(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)==null?void 0:s.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L2="FirebaseError";class si extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=L2,Object.setPrototypeOf(this,si.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ku.prototype.create)}}class Ku{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?F2(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new si(i,a,r)}}function F2(t,e){return t.replace(U2,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const U2=/\{\$([^}]+)}/g;function O2(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function co(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],o=e[i];if(QT(s)&&QT(o)){if(!co(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function QT(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ju(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function B2(t,e){const n=new q2(t,e);return n.subscribe.bind(n)}class q2{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");G2(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=dp),i.error===void 0&&(i.error=dp),i.complete===void 0&&(i.complete=dp);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function G2(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function dp(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pt(t){return t&&t._delegate?t._delegate:t}class ho{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Os="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z2{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new A2;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(H2(e))try{this.getOrInitializeService({instanceIdentifier:Os})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Os){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Os){return this.instances.has(e)}getOptions(e=Os){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:$2(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Os){return this.component?this.component.multipleInstances?e:Os:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function $2(t){return t===Os?void 0:t}function H2(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W2{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new z2(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var De;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(De||(De={}));const K2={debug:De.DEBUG,verbose:De.VERBOSE,info:De.INFO,warn:De.WARN,error:De.ERROR,silent:De.SILENT},j2=De.INFO,J2={[De.DEBUG]:"log",[De.VERBOSE]:"log",[De.INFO]:"info",[De.WARN]:"warn",[De.ERROR]:"error"},Q2=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=J2[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class h_{constructor(e){this.name=e,this._logLevel=j2,this._logHandler=Q2,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in De))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?K2[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,De.DEBUG,...e),this._logHandler(this,De.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,De.VERBOSE,...e),this._logHandler(this,De.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,De.INFO,...e),this._logHandler(this,De.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,De.WARN,...e),this._logHandler(this,De.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,De.ERROR,...e),this._logHandler(this,De.ERROR,...e)}}const Y2=(t,e)=>e.some(n=>t instanceof n);let YT,XT;function X2(){return YT||(YT=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Z2(){return XT||(XT=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const YC=new WeakMap,Rm=new WeakMap,XC=new WeakMap,hp=new WeakMap,f_=new WeakMap;function eV(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n($i(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&YC.set(n,t)}).catch(()=>{}),f_.set(e,t),e}function tV(t){if(Rm.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});Rm.set(t,e)}let Pm={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Rm.get(t);if(e==="objectStoreNames")return t.objectStoreNames||XC.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return $i(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function nV(t){Pm=t(Pm)}function rV(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(fp(this),e,...n);return XC.set(r,e.sort?e.sort():[e]),$i(r)}:Z2().includes(t)?function(...e){return t.apply(fp(this),e),$i(YC.get(this))}:function(...e){return $i(t.apply(fp(this),e))}}function iV(t){return typeof t=="function"?rV(t):(t instanceof IDBTransaction&&tV(t),Y2(t,X2())?new Proxy(t,Pm):t)}function $i(t){if(t instanceof IDBRequest)return eV(t);if(hp.has(t))return hp.get(t);const e=iV(t);return e!==t&&(hp.set(t,e),f_.set(e,t)),e}const fp=t=>f_.get(t);function sV(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),a=$i(o);return r&&o.addEventListener("upgradeneeded",l=>{r($i(o.result),l.oldVersion,l.newVersion,$i(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}const oV=["get","getKey","getAll","getAllKeys","count"],aV=["put","add","delete","clear"],pp=new Map;function ZT(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(pp.get(e))return pp.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=aV.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||oV.includes(n)))return;const s=async function(o,...a){const l=this.transaction(o,i?"readwrite":"readonly");let u=l.store;return r&&(u=u.index(a.shift())),(await Promise.all([u[n](...a),i&&l.done]))[0]};return pp.set(e,s),s}nV(t=>({...t,get:(e,n,r)=>ZT(e,n)||t.get(e,n,r),has:(e,n)=>!!ZT(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lV{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(uV(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function uV(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const km="@firebase/app",eE="0.14.4";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zr=new h_("@firebase/app"),cV="@firebase/app-compat",dV="@firebase/analytics-compat",hV="@firebase/analytics",fV="@firebase/app-check-compat",pV="@firebase/app-check",mV="@firebase/auth",gV="@firebase/auth-compat",_V="@firebase/database",yV="@firebase/data-connect",vV="@firebase/database-compat",TV="@firebase/functions",EV="@firebase/functions-compat",IV="@firebase/installations",wV="@firebase/installations-compat",SV="@firebase/messaging",CV="@firebase/messaging-compat",AV="@firebase/performance",xV="@firebase/performance-compat",RV="@firebase/remote-config",PV="@firebase/remote-config-compat",kV="@firebase/storage",NV="@firebase/storage-compat",DV="@firebase/firestore",bV="@firebase/ai",MV="@firebase/firestore-compat",VV="firebase",LV="12.4.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nm="[DEFAULT]",FV={[km]:"fire-core",[cV]:"fire-core-compat",[hV]:"fire-analytics",[dV]:"fire-analytics-compat",[pV]:"fire-app-check",[fV]:"fire-app-check-compat",[mV]:"fire-auth",[gV]:"fire-auth-compat",[_V]:"fire-rtdb",[yV]:"fire-data-connect",[vV]:"fire-rtdb-compat",[TV]:"fire-fn",[EV]:"fire-fn-compat",[IV]:"fire-iid",[wV]:"fire-iid-compat",[SV]:"fire-fcm",[CV]:"fire-fcm-compat",[AV]:"fire-perf",[xV]:"fire-perf-compat",[RV]:"fire-rc",[PV]:"fire-rc-compat",[kV]:"fire-gcs",[NV]:"fire-gcs-compat",[DV]:"fire-fst",[MV]:"fire-fst-compat",[bV]:"fire-vertex","fire-js":"fire-js",[VV]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sh=new Map,UV=new Map,Dm=new Map;function tE(t,e){try{t.container.addComponent(e)}catch(n){Zr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Ra(t){const e=t.name;if(Dm.has(e))return Zr.debug(`There were multiple attempts to register component ${e}.`),!1;Dm.set(e,t);for(const n of sh.values())tE(n,t);for(const n of UV.values())tE(n,t);return!0}function p_(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function rr(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OV={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Hi=new Ku("app","Firebase",OV);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BV{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new ho("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Hi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ya=LV;function ZC(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:Nm,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw Hi.create("bad-app-name",{appName:String(i)});if(n||(n=zC()),!n)throw Hi.create("no-options");const s=sh.get(i);if(s){if(co(n,s.options)&&co(r,s.config))return s;throw Hi.create("duplicate-app",{appName:i})}const o=new W2(i);for(const l of Dm.values())o.addComponent(l);const a=new BV(n,r,o);return sh.set(i,a),a}function e0(t=Nm){const e=sh.get(t);if(!e&&t===Nm&&zC())return ZC();if(!e)throw Hi.create("no-app",{appName:t});return e}function Wi(t,e,n){let r=FV[t]??t;n&&(r+=`-${n}`);const i=r.match(/\s|\//),s=e.match(/\s|\//);if(i||s){const o=[`Unable to register library "${r}" with version "${e}":`];i&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Zr.warn(o.join(" "));return}Ra(new ho(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qV="firebase-heartbeat-database",GV=1,xu="firebase-heartbeat-store";let mp=null;function t0(){return mp||(mp=sV(qV,GV,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(xu)}catch(n){console.warn(n)}}}}).catch(t=>{throw Hi.create("idb-open",{originalErrorMessage:t.message})})),mp}async function zV(t){try{const n=(await t0()).transaction(xu),r=await n.objectStore(xu).get(n0(t));return await n.done,r}catch(e){if(e instanceof si)Zr.warn(e.message);else{const n=Hi.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Zr.warn(n.message)}}}async function nE(t,e){try{const r=(await t0()).transaction(xu,"readwrite");await r.objectStore(xu).put(e,n0(t)),await r.done}catch(n){if(n instanceof si)Zr.warn(n.message);else{const r=Hi.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Zr.warn(r.message)}}}function n0(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $V=1024,HV=30;class WV{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new jV(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=rE();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>HV){const o=JV(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Zr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=rE(),{heartbeatsToSend:r,unsentEntries:i}=KV(this._heartbeatsCache.heartbeats),s=ih(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return Zr.warn(n),""}}}function rE(){return new Date().toISOString().substring(0,10)}function KV(t,e=$V){const n=[];let r=t.slice();for(const i of t){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),iE(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),iE(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class jV{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return QC()?V2().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await zV(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return nE(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return nE(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function iE(t){return ih(JSON.stringify({version:2,heartbeats:t})).length}function JV(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QV(t){Ra(new ho("platform-logger",e=>new lV(e),"PRIVATE")),Ra(new ho("heartbeat",e=>new WV(e),"PRIVATE")),Wi(km,eE,t),Wi(km,eE,"esm2020"),Wi("fire-js","")}QV("");var YV="firebase",XV="12.4.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Wi(YV,XV,"app");function r0(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const ZV=r0,i0=new Ku("auth","Firebase",r0());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oh=new h_("@firebase/auth");function eL(t,...e){oh.logLevel<=De.WARN&&oh.warn(`Auth (${Ya}): ${t}`,...e)}function gd(t,...e){oh.logLevel<=De.ERROR&&oh.error(`Auth (${Ya}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dr(t,...e){throw g_(t,...e)}function ar(t,...e){return g_(t,...e)}function m_(t,e,n){const r={...ZV(),[e]:n};return new Ku("auth","Firebase",r).create(e,{appName:t.name})}function Zs(t){return m_(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function tL(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&Dr(t,"argument-error"),m_(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function g_(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return i0.create(t,...e)}function Ie(t,e,...n){if(!t)throw g_(e,...n)}function $r(t){const e="INTERNAL ASSERTION FAILED: "+t;throw gd(e),new Error(e)}function ei(t,e){t||$r(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bm(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function nL(){return sE()==="http:"||sE()==="https:"}function sE(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rL(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(nL()||D2()||"connection"in navigator)?navigator.onLine:!0}function iL(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ju{constructor(e,n){this.shortDelay=e,this.longDelay=n,ei(n>e,"Short delay should be less than long delay!"),this.isMobile=k2()||b2()}get(){return rL()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __(t,e){ei(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s0{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;$r("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;$r("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;$r("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sL={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oL=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],aL=new Ju(3e4,6e4);function y_(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function Xa(t,e,n,r,i={}){return o0(t,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const a=ju({key:t.config.apiKey,...o}).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const u={method:e,headers:l,...s};return N2()||(u.referrerPolicy="no-referrer"),t.emulatorConfig&&Qa(t.emulatorConfig.host)&&(u.credentials="include"),s0.fetch()(await a0(t,t.config.apiHost,n,a),u)})}async function o0(t,e,n){t._canInitEmulator=!1;const r={...sL,...e};try{const i=new uL(t),s=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw jc(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[l,u]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw jc(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw jc(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw jc(t,"user-disabled",o);const f=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw m_(t,f,u);Dr(t,f)}}catch(i){if(i instanceof si)throw i;Dr(t,"network-request-failed",{message:String(i)})}}async function lL(t,e,n,r,i={}){const s=await Xa(t,e,n,r,i);return"mfaPendingCredential"in s&&Dr(t,"multi-factor-auth-required",{_serverResponse:s}),s}async function a0(t,e,n,r){const i=`${e}${n}?${r}`,s=t,o=s.config.emulator?__(t.config,i):`${t.config.apiScheme}://${i}`;return oL.includes(n)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}class uL{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(ar(this.auth,"network-request-failed")),aL.get())})}}function jc(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=ar(t,e,r);return i.customData._tokenResponse=n,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cL(t,e){return Xa(t,"POST","/v1/accounts:delete",e)}async function ah(t,e){return Xa(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zl(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function dL(t,e=!1){const n=Pt(t),r=await n.getIdToken(e),i=v_(r);Ie(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:Zl(gp(i.auth_time)),issuedAtTime:Zl(gp(i.iat)),expirationTime:Zl(gp(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function gp(t){return Number(t)*1e3}function v_(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return gd("JWT malformed, contained fewer than 3 sections"),null;try{const i=BC(n);return i?JSON.parse(i):(gd("Failed to decode base64 JWT payload"),null)}catch(i){return gd("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function oE(t){const e=v_(t);return Ie(e,"internal-error"),Ie(typeof e.exp<"u","internal-error"),Ie(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ru(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof si&&hL(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function hL({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fL{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mm{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Zl(this.lastLoginAt),this.creationTime=Zl(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lh(t){var p;const e=t.auth,n=await t.getIdToken(),r=await Ru(t,ah(e,{idToken:n}));Ie(r==null?void 0:r.users.length,e,"internal-error");const i=r.users[0];t._notifyReloadListener(i);const s=(p=i.providerUserInfo)!=null&&p.length?l0(i.providerUserInfo):[],o=mL(t.providerData,s),a=t.isAnonymous,l=!(t.email&&i.passwordHash)&&!(o!=null&&o.length),u=a?l:!1,f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new Mm(i.createdAt,i.lastLoginAt),isAnonymous:u};Object.assign(t,f)}async function pL(t){const e=Pt(t);await lh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function mL(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function l0(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gL(t,e){const n=await o0(t,{},async()=>{const r=ju({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,o=await a0(t,i,"/v1/token",`key=${s}`),a=await t._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:a,body:r};return t.emulatorConfig&&Qa(t.emulatorConfig.host)&&(l.credentials="include"),s0.fetch()(o,l)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function _L(t,e){return Xa(t,"POST","/v2/accounts:revokeToken",y_(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _a{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ie(e.idToken,"internal-error"),Ie(typeof e.idToken<"u","internal-error"),Ie(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):oE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Ie(e.length!==0,"internal-error");const n=oE(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Ie(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:s}=await gL(e,n);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:s}=n,o=new _a;return r&&(Ie(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(Ie(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(Ie(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new _a,this.toJSON())}_performRefresh(){return $r("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vi(t,e){Ie(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class ir{constructor({uid:e,auth:n,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new fL(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Mm(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await Ru(this,this.stsTokenManager.getToken(this.auth,e));return Ie(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return dL(this,e)}reload(){return pL(this)}_assign(e){this!==e&&(Ie(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new ir({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){Ie(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await lh(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(rr(this.auth.app))return Promise.reject(Zs(this.auth));const e=await this.getIdToken();return await Ru(this,cL(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,i=n.email??void 0,s=n.phoneNumber??void 0,o=n.photoURL??void 0,a=n.tenantId??void 0,l=n._redirectEventId??void 0,u=n.createdAt??void 0,f=n.lastLoginAt??void 0,{uid:p,emailVerified:g,isAnonymous:v,providerData:E,stsTokenManager:R}=n;Ie(p&&R,e,"internal-error");const M=_a.fromJSON(this.name,R);Ie(typeof p=="string",e,"internal-error"),vi(r,e.name),vi(i,e.name),Ie(typeof g=="boolean",e,"internal-error"),Ie(typeof v=="boolean",e,"internal-error"),vi(s,e.name),vi(o,e.name),vi(a,e.name),vi(l,e.name),vi(u,e.name),vi(f,e.name);const A=new ir({uid:p,auth:e,email:i,emailVerified:g,displayName:r,isAnonymous:v,photoURL:o,phoneNumber:s,tenantId:a,stsTokenManager:M,createdAt:u,lastLoginAt:f});return E&&Array.isArray(E)&&(A.providerData=E.map(I=>({...I}))),l&&(A._redirectEventId=l),A}static async _fromIdTokenResponse(e,n,r=!1){const i=new _a;i.updateFromServerResponse(n);const s=new ir({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await lh(s),s}static async _fromGetAccountInfoResponse(e,n,r){const i=n.users[0];Ie(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?l0(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),a=new _a;a.updateFromIdToken(r);const l=new ir({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Mm(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(l,u),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aE=new Map;function Hr(t){ei(t instanceof Function,"Expected a class definition");let e=aE.get(t);return e?(ei(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,aE.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u0{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}u0.type="NONE";const lE=u0;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _d(t,e,n){return`firebase:${t}:${e}:${n}`}class ya{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=_d(this.userKey,i.apiKey,s),this.fullPersistenceKey=_d("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await ah(this.auth,{idToken:e}).catch(()=>{});return n?ir._fromGetAccountInfoResponse(this.auth,n,e):null}return ir._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new ya(Hr(lE),e,r);const i=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let s=i[0]||Hr(lE);const o=_d(r,e.config.apiKey,e.name);let a=null;for(const u of n)try{const f=await u._get(o);if(f){let p;if(typeof f=="string"){const g=await ah(e,{idToken:f}).catch(()=>{});if(!g)break;p=await ir._fromGetAccountInfoResponse(e,g,f)}else p=ir._fromJSON(e,f);u!==s&&(a=p),s=u;break}}catch{}const l=i.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new ya(s,e,r):(s=l[0],a&&await s._set(o,a.toJSON()),await Promise.all(n.map(async u=>{if(u!==s)try{await u._remove(o)}catch{}})),new ya(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uE(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(f0(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(c0(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(m0(e))return"Blackberry";if(g0(e))return"Webos";if(d0(e))return"Safari";if((e.includes("chrome/")||h0(e))&&!e.includes("edge/"))return"Chrome";if(p0(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function c0(t=Rt()){return/firefox\//i.test(t)}function d0(t=Rt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function h0(t=Rt()){return/crios\//i.test(t)}function f0(t=Rt()){return/iemobile/i.test(t)}function p0(t=Rt()){return/android/i.test(t)}function m0(t=Rt()){return/blackberry/i.test(t)}function g0(t=Rt()){return/webos/i.test(t)}function T_(t=Rt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function yL(t=Rt()){var e;return T_(t)&&!!((e=window.navigator)!=null&&e.standalone)}function vL(){return M2()&&document.documentMode===10}function _0(t=Rt()){return T_(t)||p0(t)||g0(t)||m0(t)||/windows phone/i.test(t)||f0(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y0(t,e=[]){let n;switch(t){case"Browser":n=uE(Rt());break;case"Worker":n=`${uE(Rt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Ya}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TL{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=s=>new Promise((o,a)=>{try{const l=e(s);o(l)}catch(l){a(l)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function EL(t,e={}){return Xa(t,"GET","/v2/passwordPolicy",y_(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IL=6;class wL{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??IL,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SL{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new cE(this),this.idTokenSubscription=new cE(this),this.beforeStateQueue=new TL(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=i0,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Hr(n)),this._initializationPromise=this.queue(async()=>{var r,i,s;if(!this._deleted&&(this.persistenceManager=await ya.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((i=this._popupRedirectResolver)!=null&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)==null?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await ah(this,{idToken:e}),r=await ir._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var s;if(rr(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(s=this.redirectUser)==null?void 0:s._redirectEventId,a=r==null?void 0:r._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(r=l.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Ie(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await lh(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=iL()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(rr(this.app))return Promise.reject(Zs(this));const n=e?Pt(e):null;return n&&Ie(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Ie(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return rr(this.app)?Promise.reject(Zs(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return rr(this.app)?Promise.reject(Zs(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Hr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await EL(this),n=new wL(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Ku("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await _L(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Hr(e)||this._popupRedirectResolver;Ie(n,this,"argument-error"),this.redirectPersistenceManager=await ya.create(this,[Hr(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ie(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,r,i);return()=>{o=!0,l()}}else{const l=e.addObserver(n);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ie(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=y0(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var i;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((i=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:i.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if(rr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&eL(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Yh(t){return Pt(t)}class cE{constructor(e){this.auth=e,this.observer=null,this.addObserver=B2(n=>this.observer=n)}get next(){return Ie(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let E_={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function CL(t){E_=t}function AL(t){return E_.loadJS(t)}function xL(){return E_.gapiScript}function RL(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PL(t,e){const n=p_(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),s=n.getOptions();if(co(s,e??{}))return i;Dr(i,"already-initialized")}return n.initialize({options:e})}function kL(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Hr);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function NL(t,e,n){const r=Yh(t);Ie(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,s=v0(e),{host:o,port:a}=DL(e),l=a===null?"":`:${a}`,u={url:`${s}//${o}${l}/`},f=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){Ie(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),Ie(co(u,r.config.emulator)&&co(f,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=u,r.emulatorConfig=f,r.settings.appVerificationDisabledForTesting=!0,Qa(o)?(HC(`${s}//${o}${l}`),WC("Auth",!0)):bL()}function v0(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function DL(t){const e=v0(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:dE(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:dE(o)}}}function dE(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function bL(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T0{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return $r("not implemented")}_getIdTokenResponse(e){return $r("not implemented")}_linkToIdToken(e,n){return $r("not implemented")}_getReauthenticationResolver(e){return $r("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function va(t,e){return lL(t,"POST","/v1/accounts:signInWithIdp",y_(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ML="http://localhost";class fo extends T0{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new fo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Dr("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...s}=n;if(!r||!i)return null;const o=new fo(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return va(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,va(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,va(e,n)}buildRequest(){const e={requestUri:ML,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=ju(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I_{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qu extends I_{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pi extends Qu{constructor(){super("facebook.com")}static credential(e){return fo._fromParams({providerId:Pi.PROVIDER_ID,signInMethod:Pi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Pi.credentialFromTaggedObject(e)}static credentialFromError(e){return Pi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Pi.credential(e.oauthAccessToken)}catch{return null}}}Pi.FACEBOOK_SIGN_IN_METHOD="facebook.com";Pi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qr extends Qu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return fo._fromParams({providerId:qr.PROVIDER_ID,signInMethod:qr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return qr.credentialFromTaggedObject(e)}static credentialFromError(e){return qr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return qr.credential(n,r)}catch{return null}}}qr.GOOGLE_SIGN_IN_METHOD="google.com";qr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ki extends Qu{constructor(){super("github.com")}static credential(e){return fo._fromParams({providerId:ki.PROVIDER_ID,signInMethod:ki.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ki.credentialFromTaggedObject(e)}static credentialFromError(e){return ki.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ki.credential(e.oauthAccessToken)}catch{return null}}}ki.GITHUB_SIGN_IN_METHOD="github.com";ki.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ni extends Qu{constructor(){super("twitter.com")}static credential(e,n){return fo._fromParams({providerId:Ni.PROVIDER_ID,signInMethod:Ni.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Ni.credentialFromTaggedObject(e)}static credentialFromError(e){return Ni.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Ni.credential(n,r)}catch{return null}}}Ni.TWITTER_SIGN_IN_METHOD="twitter.com";Ni.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pa{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const s=await ir._fromIdTokenResponse(e,r,i),o=hE(r);return new Pa({user:s,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=hE(r);return new Pa({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function hE(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uh extends si{constructor(e,n,r,i){super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,uh.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new uh(e,n,r,i)}}function E0(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?uh._fromErrorAndOperation(t,s,e,r):s})}async function VL(t,e,n=!1){const r=await Ru(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Pa._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LL(t,e,n=!1){const{auth:r}=t;if(rr(r.app))return Promise.reject(Zs(r));const i="reauthenticate";try{const s=await Ru(t,E0(r,i,e,t),n);Ie(s.idToken,r,"internal-error");const o=v_(s.idToken);Ie(o,r,"internal-error");const{sub:a}=o;return Ie(t.uid===a,r,"user-mismatch"),Pa._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&Dr(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function FL(t,e,n=!1){if(rr(t.app))return Promise.reject(Zs(t));const r="signIn",i=await E0(t,r,e),s=await Pa._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(s.user),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UL(t,e){return Pt(t).setPersistence(e)}function OL(t,e,n,r){return Pt(t).onIdTokenChanged(e,n,r)}function BL(t,e,n){return Pt(t).beforeAuthStateChanged(e,n)}function qL(t,e,n,r){return Pt(t).onAuthStateChanged(e,n,r)}function fE(t){return Pt(t).signOut()}const ch="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I0{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(ch,"1"),this.storage.removeItem(ch),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GL=1e3,zL=10;class w0 extends I0{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=_0(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;n?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);vL()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,zL):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},GL)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}w0.type="LOCAL";const S0=w0;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C0 extends I0{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}C0.type="SESSION";const A0=C0;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $L(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xh{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new Xh(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:s}=n.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const a=Array.from(o).map(async u=>u(n.origin,s)),l=await $L(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Xh.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w_(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HL{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,l)=>{const u=w_("",20);i.port1.start();const f=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(p){const g=p;if(g.data.eventId===u)switch(g.data.status){case"ack":clearTimeout(f),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(g.data.response);break;default:clearTimeout(f),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kr(){return window}function WL(t){kr().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x0(){return typeof kr().WorkerGlobalScope<"u"&&typeof kr().importScripts=="function"}async function KL(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function jL(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function JL(){return x0()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R0="firebaseLocalStorageDb",QL=1,dh="firebaseLocalStorage",P0="fbase_key";class Yu{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Zh(t,e){return t.transaction([dh],e?"readwrite":"readonly").objectStore(dh)}function YL(){const t=indexedDB.deleteDatabase(R0);return new Yu(t).toPromise()}function Vm(){const t=indexedDB.open(R0,QL);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(dh,{keyPath:P0})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(dh)?e(r):(r.close(),await YL(),e(await Vm()))})})}async function pE(t,e,n){const r=Zh(t,!0).put({[P0]:e,value:n});return new Yu(r).toPromise()}async function XL(t,e){const n=Zh(t,!1).get(e),r=await new Yu(n).toPromise();return r===void 0?null:r.value}function mE(t,e){const n=Zh(t,!0).delete(e);return new Yu(n).toPromise()}const ZL=800,eF=3;class k0{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Vm(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>eF)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return x0()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Xh._getInstance(JL()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await KL(),!this.activeServiceWorker)return;this.sender=new HL(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||jL()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Vm();return await pE(e,ch,"1"),await mE(e,ch),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>pE(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>XL(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>mE(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=Zh(i,!1).getAll();return new Yu(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),ZL)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}k0.type="LOCAL";const tF=k0;new Ju(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N0(t,e){return e?Hr(e):(Ie(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S_ extends T0{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return va(e,this._buildIdpRequest())}_linkToIdToken(e,n){return va(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return va(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function nF(t){return FL(t.auth,new S_(t),t.bypassAuthState)}function rF(t){const{auth:e,user:n}=t;return Ie(n,e,"internal-error"),LL(n,new S_(t),t.bypassAuthState)}async function iF(t){const{auth:e,user:n}=t;return Ie(n,e,"internal-error"),VL(n,new S_(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D0{constructor(e,n,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return nF;case"linkViaPopup":case"linkViaRedirect":return iF;case"reauthViaPopup":case"reauthViaRedirect":return rF;default:Dr(this.auth,"internal-error")}}resolve(e){ei(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ei(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sF=new Ju(2e3,1e4);async function oF(t,e,n){if(rr(t.app))return Promise.reject(ar(t,"operation-not-supported-in-this-environment"));const r=Yh(t);tL(t,e,I_);const i=N0(r,n);return new Js(r,"signInViaPopup",e,i).executeNotNull()}class Js extends D0{constructor(e,n,r,i,s){super(e,n,i,s),this.provider=r,this.authWindow=null,this.pollId=null,Js.currentPopupAction&&Js.currentPopupAction.cancel(),Js.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ie(e,this.auth,"internal-error"),e}async onExecution(){ei(this.filter.length===1,"Popup operations only handle one event");const e=w_();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(ar(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(ar(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Js.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ar(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,sF.get())};e()}}Js.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aF="pendingRedirect",yd=new Map;class lF extends D0{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=yd.get(this.auth._key());if(!e){try{const r=await uF(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}yd.set(this.auth._key(),e)}return this.bypassAuthState||yd.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function uF(t,e){const n=hF(e),r=dF(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}function cF(t,e){yd.set(t._key(),e)}function dF(t){return Hr(t._redirectPersistence)}function hF(t){return _d(aF,t.config.apiKey,t.name)}async function fF(t,e,n=!1){if(rr(t.app))return Promise.reject(Zs(t));const r=Yh(t),i=N0(r,e),o=await new lF(r,i,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pF=10*60*1e3;class mF{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!gF(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!b0(e)){const i=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(ar(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=pF&&this.cachedEventUids.clear(),this.cachedEventUids.has(gE(e))}saveEventToCache(e){this.cachedEventUids.add(gE(e)),this.lastProcessedEventTime=Date.now()}}function gE(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function b0({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function gF(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return b0(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _F(t,e={}){return Xa(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yF=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,vF=/^https?/;async function TF(t){if(t.config.emulator)return;const{authorizedDomains:e}=await _F(t);for(const n of e)try{if(EF(n))return}catch{}Dr(t,"unauthorized-domain")}function EF(t){const e=bm(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!vF.test(n))return!1;if(yF.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IF=new Ju(3e4,6e4);function _E(){const t=kr().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function wF(t){return new Promise((e,n)=>{var i,s,o;function r(){_E(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{_E(),n(ar(t,"network-request-failed"))},timeout:IF.get()})}if((s=(i=kr().gapi)==null?void 0:i.iframes)!=null&&s.Iframe)e(gapi.iframes.getContext());else if((o=kr().gapi)!=null&&o.load)r();else{const a=RL("iframefcb");return kr()[a]=()=>{gapi.load?r():n(ar(t,"network-request-failed"))},AL(`${xL()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw vd=null,e})}let vd=null;function SF(t){return vd=vd||wF(t),vd}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CF=new Ju(5e3,15e3),AF="__/auth/iframe",xF="emulator/auth/iframe",RF={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},PF=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function kF(t){const e=t.config;Ie(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?__(e,xF):`https://${t.config.authDomain}/${AF}`,r={apiKey:e.apiKey,appName:t.name,v:Ya},i=PF.get(t.config.apiHost);i&&(r.eid=i);const s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${ju(r).slice(1)}`}async function NF(t){const e=await SF(t),n=kr().gapi;return Ie(n,t,"internal-error"),e.open({where:document.body,url:kF(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:RF,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=ar(t,"network-request-failed"),a=kr().setTimeout(()=>{s(o)},CF.get());function l(){kr().clearTimeout(a),i(r)}r.ping(l).then(l,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DF={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},bF=500,MF=600,VF="_blank",LF="http://localhost";class yE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function FF(t,e,n,r=bF,i=MF){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l={...DF,width:r.toString(),height:i.toString(),top:s,left:o},u=Rt().toLowerCase();n&&(a=h0(u)?VF:n),c0(u)&&(e=e||LF,l.scrollbars="yes");const f=Object.entries(l).reduce((g,[v,E])=>`${g}${v}=${E},`,"");if(yL(u)&&a!=="_self")return UF(e||"",a),new yE(null);const p=window.open(e||"",a,f);Ie(p,t,"popup-blocked");try{p.focus()}catch{}return new yE(p)}function UF(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OF="__/auth/handler",BF="emulator/auth/handler",qF=encodeURIComponent("fac");async function vE(t,e,n,r,i,s){Ie(t.config.authDomain,t,"auth-domain-config-required"),Ie(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Ya,eventId:i};if(e instanceof I_){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",O2(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,p]of Object.entries({}))o[f]=p}if(e instanceof Qu){const f=e.getScopes().filter(p=>p!=="");f.length>0&&(o.scopes=f.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const f of Object.keys(a))a[f]===void 0&&delete a[f];const l=await t._getAppCheckToken(),u=l?`#${qF}=${encodeURIComponent(l)}`:"";return`${GF(t)}?${ju(a).slice(1)}${u}`}function GF({config:t}){return t.emulator?__(t,BF):`https://${t.authDomain}/${OF}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _p="webStorageSupport";class zF{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=A0,this._completeRedirectFn=fF,this._overrideRedirectResult=cF}async _openPopup(e,n,r,i){var o;ei((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const s=await vE(e,n,r,bm(),i);return FF(e,s,w_())}async _openRedirect(e,n,r,i){await this._originValidation(e);const s=await vE(e,n,r,bm(),i);return WL(s),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:s}=this.eventManagers[n];return i?Promise.resolve(i):(ei(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await NF(e),r=new mF(e);return n.register("authEvent",i=>(Ie(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(_p,{type:_p},i=>{var o;const s=(o=i==null?void 0:i[0])==null?void 0:o[_p];s!==void 0&&n(!!s),Dr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=TF(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return _0()||d0()||T_()}}const $F=zF;var TE="@firebase/auth",EE="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HF{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Ie(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WF(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function KF(t){Ra(new ho("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;Ie(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:y0(t)},u=new SL(r,i,s,l);return kL(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Ra(new ho("auth-internal",e=>{const n=Yh(e.getProvider("auth").getImmediate());return(r=>new HF(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Wi(TE,EE,WF(t)),Wi(TE,EE,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jF=5*60,JF=$C("authIdTokenMaxAge")||jF;let IE=null;const QF=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>JF)return;const i=n==null?void 0:n.token;IE!==i&&(IE=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function YF(t=e0()){const e=p_(t,"auth");if(e.isInitialized())return e.getImmediate();const n=PL(t,{popupRedirectResolver:$F,persistence:[tF,S0,A0]}),r=$C("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const o=QF(s.toString());BL(n,o,()=>o(n.currentUser)),OL(n,a=>o(a))}}const i=GC("auth");return i&&NL(n,`http://${i}`),n}function XF(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}CL({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const s=ar("internal-error");s.customData=i,n(s)},r.type="text/javascript",r.charset="UTF-8",XF().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});KF("Browser");var wE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ki,M0;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(T,w){function x(){}x.prototype=w.prototype,T.F=w.prototype,T.prototype=new x,T.prototype.constructor=T,T.D=function(k,D,L){for(var N=Array(arguments.length-2),Me=2;Me<arguments.length;Me++)N[Me-2]=arguments[Me];return w.prototype[D].apply(k,N)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(T,w,x){x||(x=0);const k=Array(16);if(typeof w=="string")for(var D=0;D<16;++D)k[D]=w.charCodeAt(x++)|w.charCodeAt(x++)<<8|w.charCodeAt(x++)<<16|w.charCodeAt(x++)<<24;else for(D=0;D<16;++D)k[D]=w[x++]|w[x++]<<8|w[x++]<<16|w[x++]<<24;w=T.g[0],x=T.g[1],D=T.g[2];let L=T.g[3],N;N=w+(L^x&(D^L))+k[0]+3614090360&4294967295,w=x+(N<<7&4294967295|N>>>25),N=L+(D^w&(x^D))+k[1]+3905402710&4294967295,L=w+(N<<12&4294967295|N>>>20),N=D+(x^L&(w^x))+k[2]+606105819&4294967295,D=L+(N<<17&4294967295|N>>>15),N=x+(w^D&(L^w))+k[3]+3250441966&4294967295,x=D+(N<<22&4294967295|N>>>10),N=w+(L^x&(D^L))+k[4]+4118548399&4294967295,w=x+(N<<7&4294967295|N>>>25),N=L+(D^w&(x^D))+k[5]+1200080426&4294967295,L=w+(N<<12&4294967295|N>>>20),N=D+(x^L&(w^x))+k[6]+2821735955&4294967295,D=L+(N<<17&4294967295|N>>>15),N=x+(w^D&(L^w))+k[7]+4249261313&4294967295,x=D+(N<<22&4294967295|N>>>10),N=w+(L^x&(D^L))+k[8]+1770035416&4294967295,w=x+(N<<7&4294967295|N>>>25),N=L+(D^w&(x^D))+k[9]+2336552879&4294967295,L=w+(N<<12&4294967295|N>>>20),N=D+(x^L&(w^x))+k[10]+4294925233&4294967295,D=L+(N<<17&4294967295|N>>>15),N=x+(w^D&(L^w))+k[11]+2304563134&4294967295,x=D+(N<<22&4294967295|N>>>10),N=w+(L^x&(D^L))+k[12]+1804603682&4294967295,w=x+(N<<7&4294967295|N>>>25),N=L+(D^w&(x^D))+k[13]+4254626195&4294967295,L=w+(N<<12&4294967295|N>>>20),N=D+(x^L&(w^x))+k[14]+2792965006&4294967295,D=L+(N<<17&4294967295|N>>>15),N=x+(w^D&(L^w))+k[15]+1236535329&4294967295,x=D+(N<<22&4294967295|N>>>10),N=w+(D^L&(x^D))+k[1]+4129170786&4294967295,w=x+(N<<5&4294967295|N>>>27),N=L+(x^D&(w^x))+k[6]+3225465664&4294967295,L=w+(N<<9&4294967295|N>>>23),N=D+(w^x&(L^w))+k[11]+643717713&4294967295,D=L+(N<<14&4294967295|N>>>18),N=x+(L^w&(D^L))+k[0]+3921069994&4294967295,x=D+(N<<20&4294967295|N>>>12),N=w+(D^L&(x^D))+k[5]+3593408605&4294967295,w=x+(N<<5&4294967295|N>>>27),N=L+(x^D&(w^x))+k[10]+38016083&4294967295,L=w+(N<<9&4294967295|N>>>23),N=D+(w^x&(L^w))+k[15]+3634488961&4294967295,D=L+(N<<14&4294967295|N>>>18),N=x+(L^w&(D^L))+k[4]+3889429448&4294967295,x=D+(N<<20&4294967295|N>>>12),N=w+(D^L&(x^D))+k[9]+568446438&4294967295,w=x+(N<<5&4294967295|N>>>27),N=L+(x^D&(w^x))+k[14]+3275163606&4294967295,L=w+(N<<9&4294967295|N>>>23),N=D+(w^x&(L^w))+k[3]+4107603335&4294967295,D=L+(N<<14&4294967295|N>>>18),N=x+(L^w&(D^L))+k[8]+1163531501&4294967295,x=D+(N<<20&4294967295|N>>>12),N=w+(D^L&(x^D))+k[13]+2850285829&4294967295,w=x+(N<<5&4294967295|N>>>27),N=L+(x^D&(w^x))+k[2]+4243563512&4294967295,L=w+(N<<9&4294967295|N>>>23),N=D+(w^x&(L^w))+k[7]+1735328473&4294967295,D=L+(N<<14&4294967295|N>>>18),N=x+(L^w&(D^L))+k[12]+2368359562&4294967295,x=D+(N<<20&4294967295|N>>>12),N=w+(x^D^L)+k[5]+4294588738&4294967295,w=x+(N<<4&4294967295|N>>>28),N=L+(w^x^D)+k[8]+2272392833&4294967295,L=w+(N<<11&4294967295|N>>>21),N=D+(L^w^x)+k[11]+1839030562&4294967295,D=L+(N<<16&4294967295|N>>>16),N=x+(D^L^w)+k[14]+4259657740&4294967295,x=D+(N<<23&4294967295|N>>>9),N=w+(x^D^L)+k[1]+2763975236&4294967295,w=x+(N<<4&4294967295|N>>>28),N=L+(w^x^D)+k[4]+1272893353&4294967295,L=w+(N<<11&4294967295|N>>>21),N=D+(L^w^x)+k[7]+4139469664&4294967295,D=L+(N<<16&4294967295|N>>>16),N=x+(D^L^w)+k[10]+3200236656&4294967295,x=D+(N<<23&4294967295|N>>>9),N=w+(x^D^L)+k[13]+681279174&4294967295,w=x+(N<<4&4294967295|N>>>28),N=L+(w^x^D)+k[0]+3936430074&4294967295,L=w+(N<<11&4294967295|N>>>21),N=D+(L^w^x)+k[3]+3572445317&4294967295,D=L+(N<<16&4294967295|N>>>16),N=x+(D^L^w)+k[6]+76029189&4294967295,x=D+(N<<23&4294967295|N>>>9),N=w+(x^D^L)+k[9]+3654602809&4294967295,w=x+(N<<4&4294967295|N>>>28),N=L+(w^x^D)+k[12]+3873151461&4294967295,L=w+(N<<11&4294967295|N>>>21),N=D+(L^w^x)+k[15]+530742520&4294967295,D=L+(N<<16&4294967295|N>>>16),N=x+(D^L^w)+k[2]+3299628645&4294967295,x=D+(N<<23&4294967295|N>>>9),N=w+(D^(x|~L))+k[0]+4096336452&4294967295,w=x+(N<<6&4294967295|N>>>26),N=L+(x^(w|~D))+k[7]+1126891415&4294967295,L=w+(N<<10&4294967295|N>>>22),N=D+(w^(L|~x))+k[14]+2878612391&4294967295,D=L+(N<<15&4294967295|N>>>17),N=x+(L^(D|~w))+k[5]+4237533241&4294967295,x=D+(N<<21&4294967295|N>>>11),N=w+(D^(x|~L))+k[12]+1700485571&4294967295,w=x+(N<<6&4294967295|N>>>26),N=L+(x^(w|~D))+k[3]+2399980690&4294967295,L=w+(N<<10&4294967295|N>>>22),N=D+(w^(L|~x))+k[10]+4293915773&4294967295,D=L+(N<<15&4294967295|N>>>17),N=x+(L^(D|~w))+k[1]+2240044497&4294967295,x=D+(N<<21&4294967295|N>>>11),N=w+(D^(x|~L))+k[8]+1873313359&4294967295,w=x+(N<<6&4294967295|N>>>26),N=L+(x^(w|~D))+k[15]+4264355552&4294967295,L=w+(N<<10&4294967295|N>>>22),N=D+(w^(L|~x))+k[6]+2734768916&4294967295,D=L+(N<<15&4294967295|N>>>17),N=x+(L^(D|~w))+k[13]+1309151649&4294967295,x=D+(N<<21&4294967295|N>>>11),N=w+(D^(x|~L))+k[4]+4149444226&4294967295,w=x+(N<<6&4294967295|N>>>26),N=L+(x^(w|~D))+k[11]+3174756917&4294967295,L=w+(N<<10&4294967295|N>>>22),N=D+(w^(L|~x))+k[2]+718787259&4294967295,D=L+(N<<15&4294967295|N>>>17),N=x+(L^(D|~w))+k[9]+3951481745&4294967295,T.g[0]=T.g[0]+w&4294967295,T.g[1]=T.g[1]+(D+(N<<21&4294967295|N>>>11))&4294967295,T.g[2]=T.g[2]+D&4294967295,T.g[3]=T.g[3]+L&4294967295}r.prototype.v=function(T,w){w===void 0&&(w=T.length);const x=w-this.blockSize,k=this.C;let D=this.h,L=0;for(;L<w;){if(D==0)for(;L<=x;)i(this,T,L),L+=this.blockSize;if(typeof T=="string"){for(;L<w;)if(k[D++]=T.charCodeAt(L++),D==this.blockSize){i(this,k),D=0;break}}else for(;L<w;)if(k[D++]=T[L++],D==this.blockSize){i(this,k),D=0;break}}this.h=D,this.o+=w},r.prototype.A=function(){var T=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);T[0]=128;for(var w=1;w<T.length-8;++w)T[w]=0;w=this.o*8;for(var x=T.length-8;x<T.length;++x)T[x]=w&255,w/=256;for(this.v(T),T=Array(16),w=0,x=0;x<4;++x)for(let k=0;k<32;k+=8)T[w++]=this.g[x]>>>k&255;return T};function s(T,w){var x=a;return Object.prototype.hasOwnProperty.call(x,T)?x[T]:x[T]=w(T)}function o(T,w){this.h=w;const x=[];let k=!0;for(let D=T.length-1;D>=0;D--){const L=T[D]|0;k&&L==w||(x[D]=L,k=!1)}this.g=x}var a={};function l(T){return-128<=T&&T<128?s(T,function(w){return new o([w|0],w<0?-1:0)}):new o([T|0],T<0?-1:0)}function u(T){if(isNaN(T)||!isFinite(T))return p;if(T<0)return M(u(-T));const w=[];let x=1;for(let k=0;T>=x;k++)w[k]=T/x|0,x*=4294967296;return new o(w,0)}function f(T,w){if(T.length==0)throw Error("number format error: empty string");if(w=w||10,w<2||36<w)throw Error("radix out of range: "+w);if(T.charAt(0)=="-")return M(f(T.substring(1),w));if(T.indexOf("-")>=0)throw Error('number format error: interior "-" character');const x=u(Math.pow(w,8));let k=p;for(let L=0;L<T.length;L+=8){var D=Math.min(8,T.length-L);const N=parseInt(T.substring(L,L+D),w);D<8?(D=u(Math.pow(w,D)),k=k.j(D).add(u(N))):(k=k.j(x),k=k.add(u(N)))}return k}var p=l(0),g=l(1),v=l(16777216);t=o.prototype,t.m=function(){if(R(this))return-M(this).m();let T=0,w=1;for(let x=0;x<this.g.length;x++){const k=this.i(x);T+=(k>=0?k:4294967296+k)*w,w*=4294967296}return T},t.toString=function(T){if(T=T||10,T<2||36<T)throw Error("radix out of range: "+T);if(E(this))return"0";if(R(this))return"-"+M(this).toString(T);const w=u(Math.pow(T,6));var x=this;let k="";for(;;){const D=V(x,w).g;x=A(x,D.j(w));let L=((x.g.length>0?x.g[0]:x.h)>>>0).toString(T);if(x=D,E(x))return L+k;for(;L.length<6;)L="0"+L;k=L+k}},t.i=function(T){return T<0?0:T<this.g.length?this.g[T]:this.h};function E(T){if(T.h!=0)return!1;for(let w=0;w<T.g.length;w++)if(T.g[w]!=0)return!1;return!0}function R(T){return T.h==-1}t.l=function(T){return T=A(this,T),R(T)?-1:E(T)?0:1};function M(T){const w=T.g.length,x=[];for(let k=0;k<w;k++)x[k]=~T.g[k];return new o(x,~T.h).add(g)}t.abs=function(){return R(this)?M(this):this},t.add=function(T){const w=Math.max(this.g.length,T.g.length),x=[];let k=0;for(let D=0;D<=w;D++){let L=k+(this.i(D)&65535)+(T.i(D)&65535),N=(L>>>16)+(this.i(D)>>>16)+(T.i(D)>>>16);k=N>>>16,L&=65535,N&=65535,x[D]=N<<16|L}return new o(x,x[x.length-1]&-2147483648?-1:0)};function A(T,w){return T.add(M(w))}t.j=function(T){if(E(this)||E(T))return p;if(R(this))return R(T)?M(this).j(M(T)):M(M(this).j(T));if(R(T))return M(this.j(M(T)));if(this.l(v)<0&&T.l(v)<0)return u(this.m()*T.m());const w=this.g.length+T.g.length,x=[];for(var k=0;k<2*w;k++)x[k]=0;for(k=0;k<this.g.length;k++)for(let D=0;D<T.g.length;D++){const L=this.i(k)>>>16,N=this.i(k)&65535,Me=T.i(D)>>>16,et=T.i(D)&65535;x[2*k+2*D]+=N*et,I(x,2*k+2*D),x[2*k+2*D+1]+=L*et,I(x,2*k+2*D+1),x[2*k+2*D+1]+=N*Me,I(x,2*k+2*D+1),x[2*k+2*D+2]+=L*Me,I(x,2*k+2*D+2)}for(T=0;T<w;T++)x[T]=x[2*T+1]<<16|x[2*T];for(T=w;T<2*w;T++)x[T]=0;return new o(x,0)};function I(T,w){for(;(T[w]&65535)!=T[w];)T[w+1]+=T[w]>>>16,T[w]&=65535,w++}function C(T,w){this.g=T,this.h=w}function V(T,w){if(E(w))throw Error("division by zero");if(E(T))return new C(p,p);if(R(T))return w=V(M(T),w),new C(M(w.g),M(w.h));if(R(w))return w=V(T,M(w)),new C(M(w.g),w.h);if(T.g.length>30){if(R(T)||R(w))throw Error("slowDivide_ only works with positive integers.");for(var x=g,k=w;k.l(T)<=0;)x=F(x),k=F(k);var D=B(x,1),L=B(k,1);for(k=B(k,2),x=B(x,2);!E(k);){var N=L.add(k);N.l(T)<=0&&(D=D.add(x),L=N),k=B(k,1),x=B(x,1)}return w=A(T,D.j(w)),new C(D,w)}for(D=p;T.l(w)>=0;){for(x=Math.max(1,Math.floor(T.m()/w.m())),k=Math.ceil(Math.log(x)/Math.LN2),k=k<=48?1:Math.pow(2,k-48),L=u(x),N=L.j(w);R(N)||N.l(T)>0;)x-=k,L=u(x),N=L.j(w);E(L)&&(L=g),D=D.add(L),T=A(T,N)}return new C(D,T)}t.B=function(T){return V(this,T).h},t.and=function(T){const w=Math.max(this.g.length,T.g.length),x=[];for(let k=0;k<w;k++)x[k]=this.i(k)&T.i(k);return new o(x,this.h&T.h)},t.or=function(T){const w=Math.max(this.g.length,T.g.length),x=[];for(let k=0;k<w;k++)x[k]=this.i(k)|T.i(k);return new o(x,this.h|T.h)},t.xor=function(T){const w=Math.max(this.g.length,T.g.length),x=[];for(let k=0;k<w;k++)x[k]=this.i(k)^T.i(k);return new o(x,this.h^T.h)};function F(T){const w=T.g.length+1,x=[];for(let k=0;k<w;k++)x[k]=T.i(k)<<1|T.i(k-1)>>>31;return new o(x,T.h)}function B(T,w){const x=w>>5;w%=32;const k=T.g.length-x,D=[];for(let L=0;L<k;L++)D[L]=w>0?T.i(L+x)>>>w|T.i(L+x+1)<<32-w:T.i(L+x);return new o(D,T.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,M0=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=f,Ki=o}).apply(typeof wE<"u"?wE:typeof self<"u"?self:typeof window<"u"?window:{});var Jc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var V0,Ll,L0,Td,Lm,F0,U0,O0;(function(){var t,e=Object.defineProperty;function n(d){d=[typeof globalThis=="object"&&globalThis,d,typeof window=="object"&&window,typeof self=="object"&&self,typeof Jc=="object"&&Jc];for(var _=0;_<d.length;++_){var y=d[_];if(y&&y.Math==Math)return y}throw Error("Cannot find global object")}var r=n(this);function i(d,_){if(_)e:{var y=r;d=d.split(".");for(var P=0;P<d.length-1;P++){var G=d[P];if(!(G in y))break e;y=y[G]}d=d[d.length-1],P=y[d],_=_(P),_!=P&&_!=null&&e(y,d,{configurable:!0,writable:!0,value:_})}}i("Symbol.dispose",function(d){return d||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(d){return d||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(d){return d||function(_){var y=[],P;for(P in _)Object.prototype.hasOwnProperty.call(_,P)&&y.push([P,_[P]]);return y}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var s=s||{},o=this||self;function a(d){var _=typeof d;return _=="object"&&d!=null||_=="function"}function l(d,_,y){return d.call.apply(d.bind,arguments)}function u(d,_,y){return u=l,u.apply(null,arguments)}function f(d,_){var y=Array.prototype.slice.call(arguments,1);return function(){var P=y.slice();return P.push.apply(P,arguments),d.apply(this,P)}}function p(d,_){function y(){}y.prototype=_.prototype,d.Z=_.prototype,d.prototype=new y,d.prototype.constructor=d,d.Ob=function(P,G,H){for(var ie=Array(arguments.length-2),Ce=2;Ce<arguments.length;Ce++)ie[Ce-2]=arguments[Ce];return _.prototype[G].apply(P,ie)}}var g=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?d=>d&&AsyncContext.Snapshot.wrap(d):d=>d;function v(d){const _=d.length;if(_>0){const y=Array(_);for(let P=0;P<_;P++)y[P]=d[P];return y}return[]}function E(d,_){for(let P=1;P<arguments.length;P++){const G=arguments[P];var y=typeof G;if(y=y!="object"?y:G?Array.isArray(G)?"array":y:"null",y=="array"||y=="object"&&typeof G.length=="number"){y=d.length||0;const H=G.length||0;d.length=y+H;for(let ie=0;ie<H;ie++)d[y+ie]=G[ie]}else d.push(G)}}class R{constructor(_,y){this.i=_,this.j=y,this.h=0,this.g=null}get(){let _;return this.h>0?(this.h--,_=this.g,this.g=_.next,_.next=null):_=this.i(),_}}function M(d){o.setTimeout(()=>{throw d},0)}function A(){var d=T;let _=null;return d.g&&(_=d.g,d.g=d.g.next,d.g||(d.h=null),_.next=null),_}class I{constructor(){this.h=this.g=null}add(_,y){const P=C.get();P.set(_,y),this.h?this.h.next=P:this.g=P,this.h=P}}var C=new R(()=>new V,d=>d.reset());class V{constructor(){this.next=this.g=this.h=null}set(_,y){this.h=_,this.g=y,this.next=null}reset(){this.next=this.g=this.h=null}}let F,B=!1,T=new I,w=()=>{const d=Promise.resolve(void 0);F=()=>{d.then(x)}};function x(){for(var d;d=A();){try{d.h.call(d.g)}catch(y){M(y)}var _=C;_.j(d),_.h<100&&(_.h++,d.next=_.g,_.g=d)}B=!1}function k(){this.u=this.u,this.C=this.C}k.prototype.u=!1,k.prototype.dispose=function(){this.u||(this.u=!0,this.N())},k.prototype[Symbol.dispose]=function(){this.dispose()},k.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function D(d,_){this.type=d,this.g=this.target=_,this.defaultPrevented=!1}D.prototype.h=function(){this.defaultPrevented=!0};var L=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var d=!1,_=Object.defineProperty({},"passive",{get:function(){d=!0}});try{const y=()=>{};o.addEventListener("test",y,_),o.removeEventListener("test",y,_)}catch{}return d}();function N(d){return/^[\s\xa0]*$/.test(d)}function Me(d,_){D.call(this,d?d.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,d&&this.init(d,_)}p(Me,D),Me.prototype.init=function(d,_){const y=this.type=d.type,P=d.changedTouches&&d.changedTouches.length?d.changedTouches[0]:null;this.target=d.target||d.srcElement,this.g=_,_=d.relatedTarget,_||(y=="mouseover"?_=d.fromElement:y=="mouseout"&&(_=d.toElement)),this.relatedTarget=_,P?(this.clientX=P.clientX!==void 0?P.clientX:P.pageX,this.clientY=P.clientY!==void 0?P.clientY:P.pageY,this.screenX=P.screenX||0,this.screenY=P.screenY||0):(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0),this.button=d.button,this.key=d.key||"",this.ctrlKey=d.ctrlKey,this.altKey=d.altKey,this.shiftKey=d.shiftKey,this.metaKey=d.metaKey,this.pointerId=d.pointerId||0,this.pointerType=d.pointerType,this.state=d.state,this.i=d,d.defaultPrevented&&Me.Z.h.call(this)},Me.prototype.h=function(){Me.Z.h.call(this);const d=this.i;d.preventDefault?d.preventDefault():d.returnValue=!1};var et="closure_listenable_"+(Math.random()*1e6|0),je=0;function ye(d,_,y,P,G){this.listener=d,this.proxy=null,this.src=_,this.type=y,this.capture=!!P,this.ha=G,this.key=++je,this.da=this.fa=!1}function Z(d){d.da=!0,d.listener=null,d.proxy=null,d.src=null,d.ha=null}function fe(d,_,y){for(const P in d)_.call(y,d[P],P,d)}function ve(d,_){for(const y in d)_.call(void 0,d[y],y,d)}function Ee(d){const _={};for(const y in d)_[y]=d[y];return _}const Oe="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function rt(d,_){let y,P;for(let G=1;G<arguments.length;G++){P=arguments[G];for(y in P)d[y]=P[y];for(let H=0;H<Oe.length;H++)y=Oe[H],Object.prototype.hasOwnProperty.call(P,y)&&(d[y]=P[y])}}function Je(d){this.src=d,this.g={},this.h=0}Je.prototype.add=function(d,_,y,P,G){const H=d.toString();d=this.g[H],d||(d=this.g[H]=[],this.h++);const ie=Qe(d,_,P,G);return ie>-1?(_=d[ie],y||(_.fa=!1)):(_=new ye(_,this.src,H,!!P,G),_.fa=y,d.push(_)),_};function Ae(d,_){const y=_.type;if(y in d.g){var P=d.g[y],G=Array.prototype.indexOf.call(P,_,void 0),H;(H=G>=0)&&Array.prototype.splice.call(P,G,1),H&&(Z(_),d.g[y].length==0&&(delete d.g[y],d.h--))}}function Qe(d,_,y,P){for(let G=0;G<d.length;++G){const H=d[G];if(!H.da&&H.listener==_&&H.capture==!!y&&H.ha==P)return G}return-1}var zt="closure_lm_"+(Math.random()*1e6|0),hr={};function Wn(d,_,y,P,G){if(Array.isArray(_)){for(let H=0;H<_.length;H++)Wn(d,_[H],y,P,G);return null}return y=_n(y),d&&d[et]?d.J(_,y,a(P)?!!P.capture:!1,G):kn(d,_,y,!1,P,G)}function kn(d,_,y,P,G,H){if(!_)throw Error("Invalid event type");const ie=a(G)?!!G.capture:!!G;let Ce=$t(d);if(Ce||(d[zt]=Ce=new Je(d)),y=Ce.add(_,y,P,ie,H),y.proxy)return y;if(P=fr(),y.proxy=P,P.src=d,P.listener=y,d.addEventListener)L||(G=ie),G===void 0&&(G=!1),d.addEventListener(_.toString(),P,G);else if(d.attachEvent)d.attachEvent(pr(_.toString()),P);else if(d.addListener&&d.removeListener)d.addListener(P);else throw Error("addEventListener and attachEvent are unavailable.");return y}function fr(){function d(y){return _.call(d.src,d.listener,y)}const _=xe;return d}function Kn(d,_,y,P,G){if(Array.isArray(_))for(var H=0;H<_.length;H++)Kn(d,_[H],y,P,G);else P=a(P)?!!P.capture:!!P,y=_n(y),d&&d[et]?(d=d.i,H=String(_).toString(),H in d.g&&(_=d.g[H],y=Qe(_,y,P,G),y>-1&&(Z(_[y]),Array.prototype.splice.call(_,y,1),_.length==0&&(delete d.g[H],d.h--)))):d&&(d=$t(d))&&(_=d.g[_.toString()],d=-1,_&&(d=Qe(_,y,P,G)),(y=d>-1?_[d]:null)&&jn(y))}function jn(d){if(typeof d!="number"&&d&&!d.da){var _=d.src;if(_&&_[et])Ae(_.i,d);else{var y=d.type,P=d.proxy;_.removeEventListener?_.removeEventListener(y,P,d.capture):_.detachEvent?_.detachEvent(pr(y),P):_.addListener&&_.removeListener&&_.removeListener(P),(y=$t(_))?(Ae(y,d),y.h==0&&(y.src=null,_[zt]=null)):Z(d)}}}function pr(d){return d in hr?hr[d]:hr[d]="on"+d}function xe(d,_){if(d.da)d=!0;else{_=new Me(_,this);const y=d.listener,P=d.ha||d.src;d.fa&&jn(d),d=y.call(P,_)}return d}function $t(d){return d=d[zt],d instanceof Je?d:null}var Fe="__closure_events_fn_"+(Math.random()*1e9>>>0);function _n(d){return typeof d=="function"?d:(d[Fe]||(d[Fe]=function(_){return d.handleEvent(_)}),d[Fe])}function at(){k.call(this),this.i=new Je(this),this.M=this,this.G=null}p(at,k),at.prototype[et]=!0,at.prototype.removeEventListener=function(d,_,y,P){Kn(this,d,_,y,P)};function ze(d,_){var y,P=d.G;if(P)for(y=[];P;P=P.G)y.push(P);if(d=d.M,P=_.type||_,typeof _=="string")_=new D(_,d);else if(_ instanceof D)_.target=_.target||d;else{var G=_;_=new D(P,d),rt(_,G)}G=!0;let H,ie;if(y)for(ie=y.length-1;ie>=0;ie--)H=_.g=y[ie],G=Te(H,P,!0,_)&&G;if(H=_.g=d,G=Te(H,P,!0,_)&&G,G=Te(H,P,!1,_)&&G,y)for(ie=0;ie<y.length;ie++)H=_.g=y[ie],G=Te(H,P,!1,_)&&G}at.prototype.N=function(){if(at.Z.N.call(this),this.i){var d=this.i;for(const _ in d.g){const y=d.g[_];for(let P=0;P<y.length;P++)Z(y[P]);delete d.g[_],d.h--}}this.G=null},at.prototype.J=function(d,_,y,P){return this.i.add(String(d),_,!1,y,P)},at.prototype.K=function(d,_,y,P){return this.i.add(String(d),_,!0,y,P)};function Te(d,_,y,P){if(_=d.i.g[String(_)],!_)return!0;_=_.concat();let G=!0;for(let H=0;H<_.length;++H){const ie=_[H];if(ie&&!ie.da&&ie.capture==y){const Ce=ie.listener,Ct=ie.ha||ie.src;ie.fa&&Ae(d.i,ie),G=Ce.call(Ct,P)!==!1&&G}}return G&&!P.defaultPrevented}function fc(d,_){if(typeof d!="function")if(d&&typeof d.handleEvent=="function")d=u(d.handleEvent,d);else throw Error("Invalid listener argument");return Number(_)>2147483647?-1:o.setTimeout(d,_||0)}function Co(d){d.g=fc(()=>{d.g=null,d.i&&(d.i=!1,Co(d))},d.l);const _=d.h;d.h=null,d.m.apply(null,_)}class fs extends k{constructor(_,y){super(),this.m=_,this.l=y,this.h=null,this.i=!1,this.g=null}j(_){this.h=arguments,this.g?this.i=!0:Co(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function mr(d){k.call(this),this.h=d,this.g={}}p(mr,k);var ps=[];function Pe(d){fe(d.g,function(_,y){this.g.hasOwnProperty(y)&&jn(_)},d),d.g={}}mr.prototype.N=function(){mr.Z.N.call(this),Pe(this)},mr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var rl=o.JSON.stringify,li=o.JSON.parse,il=class{stringify(d){return o.JSON.stringify(d,void 0)}parse(d){return o.JSON.parse(d,void 0)}};function Ao(){}function sl(){}var ui={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function ol(){D.call(this,"d")}p(ol,D);function al(){D.call(this,"c")}p(al,D);var gr={},xo=null;function Jn(){return xo=xo||new at}gr.Ia="serverreachability";function ms(d){D.call(this,gr.Ia,d)}p(ms,D);function gs(d){const _=Jn();ze(_,new ms(_))}gr.STAT_EVENT="statevent";function Ro(d,_){D.call(this,gr.STAT_EVENT,d),this.stat=_}p(Ro,D);function Vt(d){const _=Jn();ze(_,new Ro(_,d))}gr.Ja="timingevent";function _s(d,_){D.call(this,gr.Ja,d),this.size=_}p(_s,D);function ys(d,_){if(typeof d!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){d()},_)}function _r(){this.g=!0}_r.prototype.ua=function(){this.g=!1};function ll(d,_,y,P,G,H){d.info(function(){if(d.g)if(H){var ie="",Ce=H.split("&");for(let Ze=0;Ze<Ce.length;Ze++){var Ct=Ce[Ze].split("=");if(Ct.length>1){const Nt=Ct[0];Ct=Ct[1];const Er=Nt.split("_");ie=Er.length>=2&&Er[1]=="type"?ie+(Nt+"="+Ct+"&"):ie+(Nt+"=redacted&")}}}else ie=null;else ie=H;return"XMLHTTP REQ ("+P+") [attempt "+G+"]: "+_+`
`+y+`
`+ie})}function ci(d,_,y,P,G,H,ie){d.info(function(){return"XMLHTTP RESP ("+P+") [ attempt "+G+"]: "+_+`
`+y+`
`+H+" "+ie})}function Qn(d,_,y,P){d.info(function(){return"XMLHTTP TEXT ("+_+"): "+Sf(d,y)+(P?" "+P:"")})}function vs(d,_){d.info(function(){return"TIMEOUT: "+_})}_r.prototype.info=function(){};function Sf(d,_){if(!d.g)return _;if(!_)return null;try{const H=JSON.parse(_);if(H){for(d=0;d<H.length;d++)if(Array.isArray(H[d])){var y=H[d];if(!(y.length<2)){var P=y[1];if(Array.isArray(P)&&!(P.length<1)){var G=P[0];if(G!="noop"&&G!="stop"&&G!="close")for(let ie=1;ie<P.length;ie++)P[ie]=""}}}}return rl(H)}catch{return _}}var Vr={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},pc={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Y;function Ts(){}p(Ts,Ao),Ts.prototype.g=function(){return new XMLHttpRequest},Y=new Ts;function Po(d){return encodeURIComponent(String(d))}function gy(d){var _=1;d=d.split(":");const y=[];for(;_>0&&d.length;)y.push(d.shift()),_--;return d.length&&y.push(d.join(":")),y}function Lr(d,_,y,P){this.j=d,this.i=_,this.l=y,this.S=P||1,this.V=new mr(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Cf}function Cf(){this.i=null,this.g="",this.h=!1}var mc={},Es={};function ul(d,_,y){d.M=1,d.A=fi(Dn(_)),d.u=y,d.R=!0,ko(d,null)}function ko(d,_){d.F=Date.now(),Is(d),d.B=Dn(d.A);var y=d.B,P=d.S;Array.isArray(P)||(P=[String(P)]),wc(y.i,"t",P),d.C=0,y=d.j.L,d.h=new Cf,d.g=_y(d.j,y?_:null,!d.u),d.P>0&&(d.O=new fs(u(d.Y,d,d.g),d.P)),_=d.V,y=d.g,P=d.ba;var G="readystatechange";Array.isArray(G)||(G&&(ps[0]=G.toString()),G=ps);for(let H=0;H<G.length;H++){const ie=Wn(y,G[H],P||_.handleEvent,!1,_.h||_);if(!ie)break;_.g[ie.key]=ie}_=d.J?Ee(d.J):{},d.u?(d.v||(d.v="POST"),_["Content-Type"]="application/x-www-form-urlencoded",d.g.ea(d.B,d.v,d.u,_)):(d.v="GET",d.g.ea(d.B,d.v,null,_)),gs(),ll(d.i,d.v,d.B,d.l,d.S,d.u)}Lr.prototype.ba=function(d){d=d.target;const _=this.O;_&&Q(d)==3?_.j():this.Y(d)},Lr.prototype.Y=function(d){try{if(d==this.g)e:{const Ce=Q(this.g),Ct=this.g.ya(),Ze=this.g.ca();if(!(Ce<3)&&(Ce!=3||this.g&&(this.h.h||this.g.la()||J(this.g)))){this.K||Ce!=4||Ct==7||(Ct==8||Ze<=0?gs(3):gs(2)),dl(this);var _=this.g.ca();this.X=_;var y=cl(this);if(this.o=_==200,ci(this.i,this.v,this.B,this.l,this.S,Ce,_),this.o){if(this.U&&!this.L){t:{if(this.g){var P,G=this.g;if((P=G.g?G.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!N(P)){var H=P;break t}}H=null}if(d=H)Qn(this.i,this.l,d,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,hl(this,d);else{this.o=!1,this.m=3,Vt(12),Yn(this),ws(this);break e}}if(this.R){d=!0;let Nt;for(;!this.K&&this.C<y.length;)if(Nt=Af(this,y),Nt==Es){Ce==4&&(this.m=4,Vt(14),d=!1),Qn(this.i,this.l,null,"[Incomplete Response]");break}else if(Nt==mc){this.m=4,Vt(15),Qn(this.i,this.l,y,"[Invalid Chunk]"),d=!1;break}else Qn(this.i,this.l,Nt,null),hl(this,Nt);if(cn(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ce!=4||y.length!=0||this.h.h||(this.m=1,Vt(16),d=!1),this.o=this.o&&d,!d)Qn(this.i,this.l,y,"[Invalid Chunked Response]"),Yn(this),ws(this);else if(y.length>0&&!this.W){this.W=!0;var ie=this.j;ie.g==this&&ie.aa&&!ie.P&&(ie.j.info("Great, no buffering proxy detected. Bytes received: "+y.length),Mn(ie),ie.P=!0,Vt(11))}}else Qn(this.i,this.l,y,null),hl(this,y);Ce==4&&Yn(this),this.o&&!this.K&&(Ce==4?en(this.j,this):(this.o=!1,Is(this)))}else X(this.g),_==400&&y.indexOf("Unknown SID")>0?(this.m=3,Vt(12)):(this.m=0,Vt(13)),Yn(this),ws(this)}}}catch{}finally{}};function cl(d){if(!cn(d))return d.g.la();const _=J(d.g);if(_==="")return"";let y="";const P=_.length,G=Q(d.g)==4;if(!d.h.i){if(typeof TextDecoder>"u")return Yn(d),ws(d),"";d.h.i=new o.TextDecoder}for(let H=0;H<P;H++)d.h.h=!0,y+=d.h.i.decode(_[H],{stream:!(G&&H==P-1)});return _.length=0,d.h.g+=y,d.C=0,d.h.g}function cn(d){return d.g?d.v=="GET"&&d.M!=2&&d.j.Aa:!1}function Af(d,_){var y=d.C,P=_.indexOf(`
`,y);return P==-1?Es:(y=Number(_.substring(y,P)),isNaN(y)?mc:(P+=1,P+y>_.length?Es:(_=_.slice(P,P+y),d.C=P+y,_)))}Lr.prototype.cancel=function(){this.K=!0,Yn(this)};function Is(d){d.T=Date.now()+d.H,No(d,d.H)}function No(d,_){if(d.D!=null)throw Error("WatchDog timer not null");d.D=ys(u(d.aa,d),_)}function dl(d){d.D&&(o.clearTimeout(d.D),d.D=null)}Lr.prototype.aa=function(){this.D=null;const d=Date.now();d-this.T>=0?(vs(this.i,this.B),this.M!=2&&(gs(),Vt(17)),Yn(this),this.m=2,ws(this)):No(this,this.T-d)};function ws(d){d.j.I==0||d.K||en(d.j,d)}function Yn(d){dl(d);var _=d.O;_&&typeof _.dispose=="function"&&_.dispose(),d.O=null,Pe(d.V),d.g&&(_=d.g,d.g=null,_.abort(),_.dispose())}function hl(d,_){try{var y=d.j;if(y.I!=0&&(y.g==d||oe(y.h,d))){if(!d.L&&oe(y.h,d)&&y.I==3){try{var P=y.Ba.g.parse(_)}catch{P=null}if(Array.isArray(P)&&P.length==3){var G=P;if(G[0]==0){e:if(!y.v){if(y.g)if(y.g.F+3e3<d.F)yn(y),he(y);else break e;Ns(y),Vt(18)}}else y.xa=G[1],0<y.xa-y.K&&G[2]<37500&&y.F&&y.A==0&&!y.C&&(y.C=ys(u(y.Va,y),6e3));gc(y.h)<=1&&y.ta&&(y.ta=void 0)}else Tr(y,11)}else if((d.L||y.g==d)&&yn(y),!N(_))for(G=y.Ba.g.parse(_),_=0;_<G.length;_++){let Ze=G[_];const Nt=Ze[0];if(!(Nt<=y.K))if(y.K=Nt,Ze=Ze[1],y.I==2)if(Ze[0]=="c"){y.M=Ze[1],y.ba=Ze[2];const Er=Ze[3];Er!=null&&(y.ka=Er,y.j.info("VER="+y.ka));const bs=Ze[4];bs!=null&&(y.za=bs,y.j.info("SVER="+y.za));const gi=Ze[5];gi!=null&&typeof gi=="number"&&gi>0&&(P=1.5*gi,y.O=P,y.j.info("backChannelRequestTimeoutMs_="+P)),P=y;const _i=d.g;if(_i){const kc=_i.g?_i.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(kc){var H=P.h;H.g||kc.indexOf("spdy")==-1&&kc.indexOf("quic")==-1&&kc.indexOf("h2")==-1||(H.j=H.l,H.g=new Set,H.h&&(di(H,H.h),H.h=null))}if(P.G){const Ff=_i.g?_i.g.getResponseHeader("X-HTTP-Session-Id"):null;Ff&&(P.wa=Ff,Ye(P.J,P.G,Ff))}}y.I=3,y.l&&y.l.ra(),y.aa&&(y.T=Date.now()-d.F,y.j.info("Handshake RTT: "+y.T+"ms")),P=y;var ie=d;if(P.na=Rc(P,P.L?P.ba:null,P.W),ie.L){_c(P.h,ie);var Ce=ie,Ct=P.O;Ct&&(Ce.H=Ct),Ce.D&&(dl(Ce),Is(Ce)),P.g=ie}else mi(P);y.i.length>0&&ae(y)}else Ze[0]!="stop"&&Ze[0]!="close"||Tr(y,7);else y.I==3&&(Ze[0]=="stop"||Ze[0]=="close"?Ze[0]=="stop"?Tr(y,7):K(y):Ze[0]!="noop"&&y.l&&y.l.qa(Ze),y.A=0)}}gs(4)}catch{}}var xf=class{constructor(d,_){this.g=d,this.map=_}};function Ss(d){this.l=d||10,o.PerformanceNavigationTiming?(d=o.performance.getEntriesByType("navigation"),d=d.length>0&&(d[0].nextHopProtocol=="hq"||d[0].nextHopProtocol=="h2")):d=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=d?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Do(d){return d.h?!0:d.g?d.g.size>=d.j:!1}function gc(d){return d.h?1:d.g?d.g.size:0}function oe(d,_){return d.h?d.h==_:d.g?d.g.has(_):!1}function di(d,_){d.g?d.g.add(_):d.h=_}function _c(d,_){d.h&&d.h==_?d.h=null:d.g&&d.g.has(_)&&d.g.delete(_)}Ss.prototype.cancel=function(){if(this.i=bo(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const d of this.g.values())d.cancel();this.g.clear()}};function bo(d){if(d.h!=null)return d.i.concat(d.h.G);if(d.g!=null&&d.g.size!==0){let _=d.i;for(const y of d.g.values())_=_.concat(y.G);return _}return v(d.i)}var yc=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Cs(d,_){if(d){d=d.split("&");for(let y=0;y<d.length;y++){const P=d[y].indexOf("=");let G,H=null;P>=0?(G=d[y].substring(0,P),H=d[y].substring(P+1)):G=d[y],_(G,H?decodeURIComponent(H.replace(/\+/g," ")):"")}}}function Nn(d){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let _;d instanceof Nn?(this.l=d.l,As(this,d.j),this.o=d.o,this.g=d.g,hi(this,d.u),this.h=d.h,fl(this,Sc(d.i)),this.m=d.m):d&&(_=String(d).match(yc))?(this.l=!1,As(this,_[1]||"",!0),this.o=xs(_[2]||""),this.g=xs(_[3]||"",!0),hi(this,_[4]),this.h=xs(_[5]||"",!0),fl(this,_[6]||"",!0),this.m=xs(_[7]||"")):(this.l=!1,this.i=new Ps(null,this.l))}Nn.prototype.toString=function(){const d=[];var _=this.j;_&&d.push(Rs(_,pl,!0),":");var y=this.g;return(y||_=="file")&&(d.push("//"),(_=this.o)&&d.push(Rs(_,pl,!0),"@"),d.push(Po(y).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y=this.u,y!=null&&d.push(":",String(y))),(y=this.h)&&(this.g&&y.charAt(0)!="/"&&d.push("/"),d.push(Rs(y,y.charAt(0)=="/"?Pf:Rf,!0))),(y=this.i.toString())&&d.push("?",y),(y=this.m)&&d.push("#",Rs(y,Nf)),d.join("")},Nn.prototype.resolve=function(d){const _=Dn(this);let y=!!d.j;y?As(_,d.j):y=!!d.o,y?_.o=d.o:y=!!d.g,y?_.g=d.g:y=d.u!=null;var P=d.h;if(y)hi(_,d.u);else if(y=!!d.h){if(P.charAt(0)!="/")if(this.g&&!this.h)P="/"+P;else{var G=_.h.lastIndexOf("/");G!=-1&&(P=_.h.slice(0,G+1)+P)}if(G=P,G==".."||G==".")P="";else if(G.indexOf("./")!=-1||G.indexOf("/.")!=-1){P=G.lastIndexOf("/",0)==0,G=G.split("/");const H=[];for(let ie=0;ie<G.length;){const Ce=G[ie++];Ce=="."?P&&ie==G.length&&H.push(""):Ce==".."?((H.length>1||H.length==1&&H[0]!="")&&H.pop(),P&&ie==G.length&&H.push("")):(H.push(Ce),P=!0)}P=H.join("/")}else P=G}return y?_.h=P:y=d.i.toString()!=="",y?fl(_,Sc(d.i)):y=!!d.m,y&&(_.m=d.m),_};function Dn(d){return new Nn(d)}function As(d,_,y){d.j=y?xs(_,!0):_,d.j&&(d.j=d.j.replace(/:$/,""))}function hi(d,_){if(_){if(_=Number(_),isNaN(_)||_<0)throw Error("Bad port number "+_);d.u=_}else d.u=null}function fl(d,_,y){_ instanceof Ps?(d.i=_,Df(d.i,d.l)):(y||(_=Rs(_,kf)),d.i=new Ps(_,d.l))}function Ye(d,_,y){d.i.set(_,y)}function fi(d){return Ye(d,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),d}function xs(d,_){return d?_?decodeURI(d.replace(/%25/g,"%2525")):decodeURIComponent(d):""}function Rs(d,_,y){return typeof d=="string"?(d=encodeURI(d).replace(_,vc),y&&(d=d.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d):null}function vc(d){return d=d.charCodeAt(0),"%"+(d>>4&15).toString(16)+(d&15).toString(16)}var pl=/[#\/\?@]/g,Rf=/[#\?:]/g,Pf=/[#\?]/g,kf=/[#\?@]/g,Nf=/#/g;function Ps(d,_){this.h=this.g=null,this.i=d||null,this.j=!!_}function Fr(d){d.g||(d.g=new Map,d.h=0,d.i&&Cs(d.i,function(_,y){d.add(decodeURIComponent(_.replace(/\+/g," ")),y)}))}t=Ps.prototype,t.add=function(d,_){Fr(this),this.i=null,d=pi(this,d);let y=this.g.get(d);return y||this.g.set(d,y=[]),y.push(_),this.h+=1,this};function Tc(d,_){Fr(d),_=pi(d,_),d.g.has(_)&&(d.i=null,d.h-=d.g.get(_).length,d.g.delete(_))}function Ec(d,_){return Fr(d),_=pi(d,_),d.g.has(_)}t.forEach=function(d,_){Fr(this),this.g.forEach(function(y,P){y.forEach(function(G){d.call(_,G,P,this)},this)},this)};function Ic(d,_){Fr(d);let y=[];if(typeof _=="string")Ec(d,_)&&(y=y.concat(d.g.get(pi(d,_))));else for(d=Array.from(d.g.values()),_=0;_<d.length;_++)y=y.concat(d[_]);return y}t.set=function(d,_){return Fr(this),this.i=null,d=pi(this,d),Ec(this,d)&&(this.h-=this.g.get(d).length),this.g.set(d,[_]),this.h+=1,this},t.get=function(d,_){return d?(d=Ic(this,d),d.length>0?String(d[0]):_):_};function wc(d,_,y){Tc(d,_),y.length>0&&(d.i=null,d.g.set(pi(d,_),v(y)),d.h+=y.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const d=[],_=Array.from(this.g.keys());for(let P=0;P<_.length;P++){var y=_[P];const G=Po(y);y=Ic(this,y);for(let H=0;H<y.length;H++){let ie=G;y[H]!==""&&(ie+="="+Po(y[H])),d.push(ie)}}return this.i=d.join("&")};function Sc(d){const _=new Ps;return _.i=d.i,d.g&&(_.g=new Map(d.g),_.h=d.h),_}function pi(d,_){return _=String(_),d.j&&(_=_.toLowerCase()),_}function Df(d,_){_&&!d.j&&(Fr(d),d.i=null,d.g.forEach(function(y,P){const G=P.toLowerCase();P!=G&&(Tc(this,P),wc(this,G,y))},d)),d.j=_}function bf(d,_){const y=new _r;if(o.Image){const P=new Image;P.onload=f(yr,y,"TestLoadImage: loaded",!0,_,P),P.onerror=f(yr,y,"TestLoadImage: error",!1,_,P),P.onabort=f(yr,y,"TestLoadImage: abort",!1,_,P),P.ontimeout=f(yr,y,"TestLoadImage: timeout",!1,_,P),o.setTimeout(function(){P.ontimeout&&P.ontimeout()},1e4),P.src=d}else _(!1)}function Cc(d,_){const y=new _r,P=new AbortController,G=setTimeout(()=>{P.abort(),yr(y,"TestPingServer: timeout",!1,_)},1e4);fetch(d,{signal:P.signal}).then(H=>{clearTimeout(G),H.ok?yr(y,"TestPingServer: ok",!0,_):yr(y,"TestPingServer: server error",!1,_)}).catch(()=>{clearTimeout(G),yr(y,"TestPingServer: error",!1,_)})}function yr(d,_,y,P,G){try{G&&(G.onload=null,G.onerror=null,G.onabort=null,G.ontimeout=null),P(y)}catch{}}function Mf(){this.g=new il}function ml(d){this.i=d.Sb||null,this.h=d.ab||!1}p(ml,Ao),ml.prototype.g=function(){return new Mo(this.i,this.h)};function Mo(d,_){at.call(this),this.H=d,this.o=_,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}p(Mo,at),t=Mo.prototype,t.open=function(d,_){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=d,this.D=_,this.readyState=1,vr(this)},t.send=function(d){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const _={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};d&&(_.body=d),(this.H||o).fetch(new Request(this.D,_)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,ks(this)),this.readyState=0},t.Pa=function(d){if(this.g&&(this.l=d,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=d.headers,this.readyState=2,vr(this)),this.g&&(this.readyState=3,vr(this),this.g)))if(this.responseType==="arraybuffer")d.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in d){if(this.j=d.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Ac(this)}else d.text().then(this.Oa.bind(this),this.ga.bind(this))};function Ac(d){d.j.read().then(d.Ma.bind(d)).catch(d.ga.bind(d))}t.Ma=function(d){if(this.g){if(this.o&&d.value)this.response.push(d.value);else if(!this.o){var _=d.value?d.value:new Uint8Array(0);(_=this.B.decode(_,{stream:!d.done}))&&(this.response=this.responseText+=_)}d.done?ks(this):vr(this),this.readyState==3&&Ac(this)}},t.Oa=function(d){this.g&&(this.response=this.responseText=d,ks(this))},t.Na=function(d){this.g&&(this.response=d,ks(this))},t.ga=function(){this.g&&ks(this)};function ks(d){d.readyState=4,d.l=null,d.j=null,d.B=null,vr(d)}t.setRequestHeader=function(d,_){this.A.append(d,_)},t.getResponseHeader=function(d){return this.h&&this.h.get(d.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const d=[],_=this.h.entries();for(var y=_.next();!y.done;)y=y.value,d.push(y[0]+": "+y[1]),y=_.next();return d.join(`\r
`)};function vr(d){d.onreadystatechange&&d.onreadystatechange.call(d)}Object.defineProperty(Mo.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(d){this.m=d?"include":"same-origin"}});function Vf(d){let _="";return fe(d,function(y,P){_+=P,_+=":",_+=y,_+=`\r
`}),_}function xc(d,_,y){e:{for(P in y){var P=!1;break e}P=!0}P||(y=Vf(y),typeof d=="string"?y!=null&&Po(y):Ye(d,_,y))}function Xe(d){at.call(this),this.headers=new Map,this.L=d||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}p(Xe,at);var Lf=/^https?$/i,S=["POST","PUT"];t=Xe.prototype,t.Fa=function(d){this.H=d},t.ea=function(d,_,y,P){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+d);_=_?_.toUpperCase():"GET",this.D=d,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Y.g(),this.g.onreadystatechange=g(u(this.Ca,this));try{this.B=!0,this.g.open(_,String(d),!0),this.B=!1}catch(H){b(this,H);return}if(d=y||"",y=new Map(this.headers),P)if(Object.getPrototypeOf(P)===Object.prototype)for(var G in P)y.set(G,P[G]);else if(typeof P.keys=="function"&&typeof P.get=="function")for(const H of P.keys())y.set(H,P.get(H));else throw Error("Unknown input type for opt_headers: "+String(P));P=Array.from(y.keys()).find(H=>H.toLowerCase()=="content-type"),G=o.FormData&&d instanceof o.FormData,!(Array.prototype.indexOf.call(S,_,void 0)>=0)||P||G||y.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[H,ie]of y)this.g.setRequestHeader(H,ie);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(d),this.v=!1}catch(H){b(this,H)}};function b(d,_){d.h=!1,d.g&&(d.j=!0,d.g.abort(),d.j=!1),d.l=_,d.o=5,U(d),$(d)}function U(d){d.A||(d.A=!0,ze(d,"complete"),ze(d,"error"))}t.abort=function(d){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=d||7,ze(this,"complete"),ze(this,"abort"),$(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),$(this,!0)),Xe.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?O(this):this.Xa())},t.Xa=function(){O(this)};function O(d){if(d.h&&typeof s<"u"){if(d.v&&Q(d)==4)setTimeout(d.Ca.bind(d),0);else if(ze(d,"readystatechange"),Q(d)==4){d.h=!1;try{const H=d.ca();e:switch(H){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var _=!0;break e;default:_=!1}var y;if(!(y=_)){var P;if(P=H===0){let ie=String(d.D).match(yc)[1]||null;!ie&&o.self&&o.self.location&&(ie=o.self.location.protocol.slice(0,-1)),P=!Lf.test(ie?ie.toLowerCase():"")}y=P}if(y)ze(d,"complete"),ze(d,"success");else{d.o=6;try{var G=Q(d)>2?d.g.statusText:""}catch{G=""}d.l=G+" ["+d.ca()+"]",U(d)}}finally{$(d)}}}}function $(d,_){if(d.g){d.m&&(clearTimeout(d.m),d.m=null);const y=d.g;d.g=null,_||ze(d,"ready");try{y.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function Q(d){return d.g?d.g.readyState:0}t.ca=function(){try{return Q(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(d){if(this.g){var _=this.g.responseText;return d&&_.indexOf(d)==0&&(_=_.substring(d.length)),li(_)}};function J(d){try{if(!d.g)return null;if("response"in d.g)return d.g.response;switch(d.F){case"":case"text":return d.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in d.g)return d.g.mozResponseArrayBuffer}return null}catch{return null}}function X(d){const _={};d=(d.g&&Q(d)>=2&&d.g.getAllResponseHeaders()||"").split(`\r
`);for(let P=0;P<d.length;P++){if(N(d[P]))continue;var y=gy(d[P]);const G=y[0];if(y=y[1],typeof y!="string")continue;y=y.trim();const H=_[G]||[];_[G]=H,H.push(y)}ve(_,function(P){return P.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function W(d,_,y){return y&&y.internalChannelParams&&y.internalChannelParams[d]||_}function ne(d){this.za=0,this.i=[],this.j=new _r,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=W("failFast",!1,d),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=W("baseRetryDelayMs",5e3,d),this.Za=W("retryDelaySeedMs",1e4,d),this.Ta=W("forwardChannelMaxRetries",2,d),this.va=W("forwardChannelRequestTimeoutMs",2e4,d),this.ma=d&&d.xmlHttpFactory||void 0,this.Ua=d&&d.Rb||void 0,this.Aa=d&&d.useFetchStreams||!1,this.O=void 0,this.L=d&&d.supportsCrossDomainXhr||!1,this.M="",this.h=new Ss(d&&d.concurrentRequestLimit),this.Ba=new Mf,this.S=d&&d.fastHandshake||!1,this.R=d&&d.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=d&&d.Pb||!1,d&&d.ua&&this.j.ua(),d&&d.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&d&&d.detectBufferingProxy||!1,this.ia=void 0,d&&d.longPollingTimeout&&d.longPollingTimeout>0&&(this.ia=d.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=ne.prototype,t.ka=8,t.I=1,t.connect=function(d,_,y,P){Vt(0),this.W=d,this.H=_||{},y&&P!==void 0&&(this.H.OSID=y,this.H.OAID=P),this.F=this.X,this.J=Rc(this,null,this.W),ae(this)};function K(d){if(ue(d),d.I==3){var _=d.V++,y=Dn(d.J);if(Ye(y,"SID",d.M),Ye(y,"RID",_),Ye(y,"TYPE","terminate"),tt(d,y),_=new Lr(d,d.j,_),_.M=2,_.A=fi(Dn(y)),y=!1,o.navigator&&o.navigator.sendBeacon)try{y=o.navigator.sendBeacon(_.A.toString(),"")}catch{}!y&&o.Image&&(new Image().src=_.A,y=!0),y||(_.g=_y(_.j,null),_.g.ea(_.A)),_.F=Date.now(),Is(_)}Ds(d)}function he(d){d.g&&(Mn(d),d.g.cancel(),d.g=null)}function ue(d){he(d),d.v&&(o.clearTimeout(d.v),d.v=null),yn(d),d.h.cancel(),d.m&&(typeof d.m=="number"&&o.clearTimeout(d.m),d.m=null)}function ae(d){if(!Do(d.h)&&!d.m){d.m=!0;var _=d.Ea;F||w(),B||(F(),B=!0),T.add(_,d),d.D=0}}function me(d,_){return gc(d.h)>=d.h.j-(d.m?1:0)?!1:d.m?(d.i=_.G.concat(d.i),!0):d.I==1||d.I==2||d.D>=(d.Sa?0:d.Ta)?!1:(d.m=ys(u(d.Ea,d,_),gl(d,d.D)),d.D++,!0)}t.Ea=function(d){if(this.m)if(this.m=null,this.I==1){if(!d){this.V=Math.floor(Math.random()*1e5),d=this.V++;const G=new Lr(this,this.j,d);let H=this.o;if(this.U&&(H?(H=Ee(H),rt(H,this.U)):H=this.U),this.u!==null||this.R||(G.J=H,H=null),this.S)e:{for(var _=0,y=0;y<this.i.length;y++){t:{var P=this.i[y];if("__data__"in P.map&&(P=P.map.__data__,typeof P=="string")){P=P.length;break t}P=void 0}if(P===void 0)break;if(_+=P,_>4096){_=y;break e}if(_===4096||y===this.i.length-1){_=y+1;break e}}_=1e3}else _=1e3;_=bn(this,G,_),y=Dn(this.J),Ye(y,"RID",d),Ye(y,"CVER",22),this.G&&Ye(y,"X-HTTP-Session-Id",this.G),tt(this,y),H&&(this.R?_="headers="+Po(Vf(H))+"&"+_:this.u&&xc(y,this.u,H)),di(this.h,G),this.Ra&&Ye(y,"TYPE","init"),this.S?(Ye(y,"$req",_),Ye(y,"SID","null"),G.U=!0,ul(G,y,null)):ul(G,y,_),this.I=2}}else this.I==3&&(d?Ne(this,d):this.i.length==0||Do(this.h)||Ne(this))};function Ne(d,_){var y;_?y=_.l:y=d.V++;const P=Dn(d.J);Ye(P,"SID",d.M),Ye(P,"RID",y),Ye(P,"AID",d.K),tt(d,P),d.u&&d.o&&xc(P,d.u,d.o),y=new Lr(d,d.j,y,d.D+1),d.u===null&&(y.J=d.o),_&&(d.i=_.G.concat(d.i)),_=bn(d,y,1e3),y.H=Math.round(d.va*.5)+Math.round(d.va*.5*Math.random()),di(d.h,y),ul(y,P,_)}function tt(d,_){d.H&&fe(d.H,function(y,P){Ye(_,P,y)}),d.l&&fe({},function(y,P){Ye(_,P,y)})}function bn(d,_,y){y=Math.min(d.i.length,y);const P=d.l?u(d.l.Ka,d.l,d):null;e:{var G=d.i;let Ce=-1;for(;;){const Ct=["count="+y];Ce==-1?y>0?(Ce=G[0].g,Ct.push("ofs="+Ce)):Ce=0:Ct.push("ofs="+Ce);let Ze=!0;for(let Nt=0;Nt<y;Nt++){var H=G[Nt].g;const Er=G[Nt].map;if(H-=Ce,H<0)Ce=Math.max(0,G[Nt].g-100),Ze=!1;else try{H="req"+H+"_"||"";try{var ie=Er instanceof Map?Er:Object.entries(Er);for(const[bs,gi]of ie){let _i=gi;a(gi)&&(_i=rl(gi)),Ct.push(H+bs+"="+encodeURIComponent(_i))}}catch(bs){throw Ct.push(H+"type="+encodeURIComponent("_badmap")),bs}}catch{P&&P(Er)}}if(Ze){ie=Ct.join("&");break e}}ie=void 0}return d=d.i.splice(0,y),_.G=d,ie}function mi(d){if(!d.g&&!d.v){d.Y=1;var _=d.Da;F||w(),B||(F(),B=!0),T.add(_,d),d.A=0}}function Ns(d){return d.g||d.v||d.A>=3?!1:(d.Y++,d.v=ys(u(d.Da,d),gl(d,d.A)),d.A++,!0)}t.Da=function(){if(this.v=null,Vn(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var d=4*this.T;this.j.info("BP detection timer enabled: "+d),this.B=ys(u(this.Wa,this),d)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Vt(10),he(this),Vn(this))};function Mn(d){d.B!=null&&(o.clearTimeout(d.B),d.B=null)}function Vn(d){d.g=new Lr(d,d.j,"rpc",d.Y),d.u===null&&(d.g.J=d.o),d.g.P=0;var _=Dn(d.na);Ye(_,"RID","rpc"),Ye(_,"SID",d.M),Ye(_,"AID",d.K),Ye(_,"CI",d.F?"0":"1"),!d.F&&d.ia&&Ye(_,"TO",d.ia),Ye(_,"TYPE","xmlhttp"),tt(d,_),d.u&&d.o&&xc(_,d.u,d.o),d.O&&(d.g.H=d.O);var y=d.g;d=d.ba,y.M=1,y.A=fi(Dn(_)),y.u=null,y.R=!0,ko(y,d)}t.Va=function(){this.C!=null&&(this.C=null,he(this),Ns(this),Vt(19))};function yn(d){d.C!=null&&(o.clearTimeout(d.C),d.C=null)}function en(d,_){var y=null;if(d.g==_){yn(d),Mn(d),d.g=null;var P=2}else if(oe(d.h,_))y=_.G,_c(d.h,_),P=1;else return;if(d.I!=0){if(_.o)if(P==1){y=_.u?_.u.length:0,_=Date.now()-_.F;var G=d.D;P=Jn(),ze(P,new _s(P,y)),ae(d)}else mi(d);else if(G=_.m,G==3||G==0&&_.X>0||!(P==1&&me(d,_)||P==2&&Ns(d)))switch(y&&y.length>0&&(_=d.h,_.i=_.i.concat(y)),G){case 1:Tr(d,5);break;case 4:Tr(d,10);break;case 3:Tr(d,6);break;default:Tr(d,2)}}}function gl(d,_){let y=d.Qa+Math.floor(Math.random()*d.Za);return d.isActive()||(y*=2),y*_}function Tr(d,_){if(d.j.info("Error code "+_),_==2){var y=u(d.bb,d),P=d.Ua;const G=!P;P=new Nn(P||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||As(P,"https"),fi(P),G?bf(P.toString(),y):Cc(P.toString(),y)}else Vt(2);d.I=0,d.l&&d.l.pa(_),Ds(d),ue(d)}t.bb=function(d){d?(this.j.info("Successfully pinged google.com"),Vt(2)):(this.j.info("Failed to ping google.com"),Vt(1))};function Ds(d){if(d.I=0,d.ja=[],d.l){const _=bo(d.h);(_.length!=0||d.i.length!=0)&&(E(d.ja,_),E(d.ja,d.i),d.h.i.length=0,v(d.i),d.i.length=0),d.l.oa()}}function Rc(d,_,y){var P=y instanceof Nn?Dn(y):new Nn(y);if(P.g!="")_&&(P.g=_+"."+P.g),hi(P,P.u);else{var G=o.location;P=G.protocol,_=_?_+"."+G.hostname:G.hostname,G=+G.port;const H=new Nn(null);P&&As(H,P),_&&(H.g=_),G&&hi(H,G),y&&(H.h=y),P=H}return y=d.G,_=d.wa,y&&_&&Ye(P,y,_),Ye(P,"VER",d.ka),tt(d,P),P}function _y(d,_,y){if(_&&!d.L)throw Error("Can't create secondary domain capable XhrIo object.");return _=d.Aa&&!d.ma?new Xe(new ml({ab:y})):new Xe(d.ma),_.Fa(d.L),_}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function yy(){}t=yy.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function Pc(){}Pc.prototype.g=function(d,_){return new vn(d,_)};function vn(d,_){at.call(this),this.g=new ne(_),this.l=d,this.h=_&&_.messageUrlParams||null,d=_&&_.messageHeaders||null,_&&_.clientProtocolHeaderRequired&&(d?d["X-Client-Protocol"]="webchannel":d={"X-Client-Protocol":"webchannel"}),this.g.o=d,d=_&&_.initMessageHeaders||null,_&&_.messageContentType&&(d?d["X-WebChannel-Content-Type"]=_.messageContentType:d={"X-WebChannel-Content-Type":_.messageContentType}),_&&_.sa&&(d?d["X-WebChannel-Client-Profile"]=_.sa:d={"X-WebChannel-Client-Profile":_.sa}),this.g.U=d,(d=_&&_.Qb)&&!N(d)&&(this.g.u=d),this.A=_&&_.supportsCrossDomainXhr||!1,this.v=_&&_.sendRawJson||!1,(_=_&&_.httpSessionIdParam)&&!N(_)&&(this.g.G=_,d=this.h,d!==null&&_ in d&&(d=this.h,_ in d&&delete d[_])),this.j=new Vo(this)}p(vn,at),vn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},vn.prototype.close=function(){K(this.g)},vn.prototype.o=function(d){var _=this.g;if(typeof d=="string"){var y={};y.__data__=d,d=y}else this.v&&(y={},y.__data__=rl(d),d=y);_.i.push(new xf(_.Ya++,d)),_.I==3&&ae(_)},vn.prototype.N=function(){this.g.l=null,delete this.j,K(this.g),delete this.g,vn.Z.N.call(this)};function vy(d){ol.call(this),d.__headers__&&(this.headers=d.__headers__,this.statusCode=d.__status__,delete d.__headers__,delete d.__status__);var _=d.__sm__;if(_){e:{for(const y in _){d=y;break e}d=void 0}(this.i=d)&&(d=this.i,_=_!==null&&d in _?_[d]:void 0),this.data=_}else this.data=d}p(vy,ol);function Ty(){al.call(this),this.status=1}p(Ty,al);function Vo(d){this.g=d}p(Vo,yy),Vo.prototype.ra=function(){ze(this.g,"a")},Vo.prototype.qa=function(d){ze(this.g,new vy(d))},Vo.prototype.pa=function(d){ze(this.g,new Ty)},Vo.prototype.oa=function(){ze(this.g,"b")},Pc.prototype.createWebChannel=Pc.prototype.g,vn.prototype.send=vn.prototype.o,vn.prototype.open=vn.prototype.m,vn.prototype.close=vn.prototype.close,O0=function(){return new Pc},U0=function(){return Jn()},F0=gr,Lm={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Vr.NO_ERROR=0,Vr.TIMEOUT=8,Vr.HTTP_ERROR=6,Td=Vr,pc.COMPLETE="complete",L0=pc,sl.EventType=ui,ui.OPEN="a",ui.CLOSE="b",ui.ERROR="c",ui.MESSAGE="d",at.prototype.listen=at.prototype.J,Ll=sl,Xe.prototype.listenOnce=Xe.prototype.K,Xe.prototype.getLastError=Xe.prototype.Ha,Xe.prototype.getLastErrorCode=Xe.prototype.ya,Xe.prototype.getStatus=Xe.prototype.ca,Xe.prototype.getResponseJson=Xe.prototype.La,Xe.prototype.getResponseText=Xe.prototype.la,Xe.prototype.send=Xe.prototype.ea,Xe.prototype.setWithCredentials=Xe.prototype.Fa,V0=Xe}).apply(typeof Jc<"u"?Jc:typeof self<"u"?self:typeof window<"u"?window:{});const SE="@firebase/firestore",CE="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ot{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ot.UNAUTHENTICATED=new Ot(null),Ot.GOOGLE_CREDENTIALS=new Ot("google-credentials-uid"),Ot.FIRST_PARTY=new Ot("first-party-uid"),Ot.MOCK_USER=new Ot("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Za="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zi=new h_("@firebase/firestore");function zo(){return Zi.logLevel}function B0(t){Zi.setLogLevel(t)}function ee(t,...e){if(Zi.logLevel<=De.DEBUG){const n=e.map(C_);Zi.debug(`Firestore (${Za}): ${t}`,...n)}}function nn(t,...e){if(Zi.logLevel<=De.ERROR){const n=e.map(C_);Zi.error(`Firestore (${Za}): ${t}`,...n)}}function es(t,...e){if(Zi.logLevel<=De.WARN){const n=e.map(C_);Zi.warn(`Firestore (${Za}): ${t}`,...n)}}function C_(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function de(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,q0(t,r,n)}function q0(t,e,n){let r=`FIRESTORE (${Za}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw nn(r),new Error(r)}function ge(t,e,n,r){let i="Unexpected state";typeof n=="string"?i=n:r=n,t||q0(e,i,r)}function Se(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class re extends si{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nr{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G0{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class z0{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Ot.UNAUTHENTICATED))}shutdown(){}}class ZF{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class eU{constructor(e){this.t=e,this.currentUser=Ot.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){ge(this.o===void 0,42304);let r=this.i;const i=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let s=new Nr;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Nr,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},a=l=>{ee("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(ee("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Nr)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(ee("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ge(typeof r.accessToken=="string",31837,{l:r}),new G0(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ge(e===null||typeof e=="string",2055,{h:e}),new Ot(e)}}class tU{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=Ot.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class nU{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new tU(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(Ot.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class AE{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class rU{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,rr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){ge(this.o===void 0,3512);const r=s=>{s.error!=null&&ee("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,ee("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{ee("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):ee("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new AE(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(ge(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new AE(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iU(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ef{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=iU(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%62))}return r}}function we(t,e){return t<e?-1:t>e?1:0}function Fm(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const i=t.charAt(r),s=e.charAt(r);if(i!==s)return yp(i)===yp(s)?we(i,s):yp(i)?1:-1}return we(t.length,e.length)}const sU=55296,oU=57343;function yp(t){const e=t.charCodeAt(0);return e>=sU&&e<=oU}function ka(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function $0(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xE="__name__";class Sr{constructor(e,n,r){n===void 0?n=0:n>e.length&&de(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&de(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Sr.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Sr?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=Sr.compareSegments(e.get(i),n.get(i));if(s!==0)return s}return we(e.length,n.length)}static compareSegments(e,n){const r=Sr.isNumericId(e),i=Sr.isNumericId(n);return r&&!i?-1:!r&&i?1:r&&i?Sr.extractNumericId(e).compare(Sr.extractNumericId(n)):Fm(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ki.fromString(e.substring(4,e.length-2))}}class Ge extends Sr{construct(e,n,r){return new Ge(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new re(j.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new Ge(n)}static emptyPath(){return new Ge([])}}const aU=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class dt extends Sr{construct(e,n,r){return new dt(e,n,r)}static isValidIdentifier(e){return aU.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),dt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===xE}static keyField(){return new dt([xE])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new re(j.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new re(j.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new re(j.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new re(j.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new dt(n)}static emptyPath(){return new dt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class se{constructor(e){this.path=e}static fromPath(e){return new se(Ge.fromString(e))}static fromName(e){return new se(Ge.fromString(e).popFirst(5))}static empty(){return new se(Ge.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ge.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Ge.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new se(new Ge(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H0(t,e,n){if(!n)throw new re(j.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function W0(t,e,n,r){if(e===!0&&r===!0)throw new re(j.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function RE(t){if(!se.isDocumentKey(t))throw new re(j.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function PE(t){if(se.isDocumentKey(t))throw new re(j.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function K0(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function tf(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":de(12329,{type:typeof t})}function on(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new re(j.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=tf(t);throw new re(j.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function St(t,e){const n={typeString:t};return e&&(n.value=e),n}function Xu(t,e){if(!K0(t))throw new re(j.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(i&&typeof o!==i){n=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&o!==s.value){n=`Expected '${r}' field to equal '${s.value}'`;break}}if(n)throw new re(j.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kE=-62135596800,NE=1e6;class $e{static now(){return $e.fromMillis(Date.now())}static fromDate(e){return $e.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*NE);return new $e(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new re(j.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new re(j.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<kE)throw new re(j.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new re(j.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/NE}_compareTo(e){return this.seconds===e.seconds?we(this.nanoseconds,e.nanoseconds):we(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:$e._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Xu(e,$e._jsonSchema))return new $e(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-kE;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}$e._jsonSchemaVersion="firestore/timestamp/1.0",$e._jsonSchema={type:St("string",$e._jsonSchemaVersion),seconds:St("number"),nanoseconds:St("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _e{static fromTimestamp(e){return new _e(e)}static min(){return new _e(new $e(0,0))}static max(){return new _e(new $e(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pu=-1;class hh{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}}function Um(t){return t.fields.find(e=>e.kind===2)}function Bs(t){return t.fields.filter(e=>e.kind!==2)}hh.UNKNOWN_ID=-1;class Ed{constructor(e,n){this.fieldPath=e,this.kind=n}}class ku{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new ku(0,xn.min())}}function lU(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=_e.fromTimestamp(r===1e9?new $e(n+1,0):new $e(n,r));return new xn(i,se.empty(),e)}function j0(t){return new xn(t.readTime,t.key,Pu)}class xn{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new xn(_e.min(),se.empty(),Pu)}static max(){return new xn(_e.max(),se.empty(),Pu)}}function A_(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=se.comparator(t.documentKey,e.documentKey),n!==0?n:we(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J0="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Q0{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Io(t){if(t.code!==j.FAILED_PRECONDITION||t.message!==J0)throw t;ee("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&de(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new q((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof q?n:q.resolve(n)}catch(n){return q.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):q.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):q.reject(n)}static resolve(e){return new q((n,r)=>{n(e)})}static reject(e){return new q((n,r)=>{r(e)})}static waitFor(e){return new q((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},l=>r(l))}),o=!0,s===i&&n()})}static or(e){let n=q.resolve(!1);for(const r of e)n=n.next(i=>i?q.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new q((r,i)=>{const s=e.length,o=new Array(s);let a=0;for(let l=0;l<s;l++){const u=l;n(e[u]).next(f=>{o[u]=f,++a,a===s&&r(o)},f=>i(f))}})}static doWhile(e,n){return new q((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const En="SimpleDb";class nf{static open(e,n,r,i){try{return new nf(n,e.transaction(i,r))}catch(s){throw new eu(n,s)}}constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.S=new Nr,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{n.error?this.S.reject(new eu(e,n.error)):this.S.resolve()},this.transaction.onerror=r=>{const i=x_(r.target.error);this.S.reject(new eu(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(ee(En,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new cU(n)}}class ji{static delete(e){return ee(En,"Removing database:",e),Gs(qC().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!QC())return!1;if(ji.F())return!0;const e=Rt(),n=ji.M(e),r=0<n&&n<10,i=Y0(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)==null?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)==="YES"}static O(e,n){return e.store(n)}static M(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,n,r){this.name=e,this.version=n,this.N=r,this.B=null,ji.M(Rt())===12.2&&nn("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(ee(En,"Opening database:",this.name),this.db=await new Promise((n,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const o=s.target.result;n(o)},i.onblocked=()=>{r(new eu(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const o=s.target.error;o.name==="VersionError"?r(new re(j.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new re(j.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new eu(e,o))},i.onupgradeneeded=s=>{ee(En,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.N.k(o,i.transaction,s.oldVersion,this.version).next(()=>{ee(En,"Database upgrade to version "+this.version+" complete")})}})),this.q&&(this.db.onversionchange=n=>this.q(n)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,i){const s=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const a=nf.open(this.db,e,s?"readonly":"readwrite",r),l=i(a).next(u=>(a.C(),u)).catch(u=>(a.abort(u),q.reject(u))).toPromise();return l.catch(()=>{}),await a.D,l}catch(a){const l=a,u=l.name!=="FirebaseError"&&o<3;if(ee(En,"Transaction failed with error:",l.message,"Retrying:",u),this.close(),!u)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function Y0(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class uU{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return Gs(this.U.delete())}}class eu extends re{constructor(e,n){super(j.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function cs(t){return t.name==="IndexedDbTransactionError"}class cU{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(ee(En,"PUT",this.store.name,e,n),r=this.store.put(n,e)):(ee(En,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Gs(r)}add(e){return ee(En,"ADD",this.store.name,e,e),Gs(this.store.add(e))}get(e){return Gs(this.store.get(e)).next(n=>(n===void 0&&(n=null),ee(En,"GET",this.store.name,e,n),n))}delete(e){return ee(En,"DELETE",this.store.name,e),Gs(this.store.delete(e))}count(){return ee(En,"COUNT",this.store.name),Gs(this.store.count())}J(e,n){const r=this.options(e,n),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const s=i.getAll(r.range);return new q((o,a)=>{s.onerror=l=>{a(l.target.error)},s.onsuccess=l=>{o(l.target.result)}})}{const s=this.cursor(r),o=[];return this.H(s,(a,l)=>{o.push(l)}).next(()=>o)}}Y(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new q((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}Z(e,n){ee(En,"DELETE ALL",this.store.name);const r=this.options(e,n);r.X=!1;const i=this.cursor(r);return this.H(i,(s,o,a)=>a.delete())}ee(e,n){let r;n?r=e:(r={},n=e);const i=this.cursor(r);return this.H(i,n)}te(e){const n=this.cursor({});return new q((r,i)=>{n.onerror=s=>{const o=x_(s.target.error);i(o)},n.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}H(e,n){const r=[];return new q((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void i();const l=new uU(a),u=n(a.primaryKey,a.value,l);if(u instanceof q){const f=u.catch(p=>(l.done(),q.reject(p)));r.push(f)}l.isDone?i():l.G===null?a.continue():a.continue(l.G)}}).next(()=>q.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function Gs(t){return new q((e,n)=>{t.onsuccess=r=>{const i=r.target.result;e(i)},t.onerror=r=>{const i=x_(r.target.error);n(i)}})}let DE=!1;function x_(t){const e=ji.M(Rt());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new re("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return DE||(DE=!0,setTimeout(()=>{throw r},0)),r}}return t}const tu="IndexBackfiller";class dU{constructor(e,n){this.asyncQueue=e,this.ne=n,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){ee(tu,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const n=await this.ne.ie();ee(tu,`Documents written: ${n}`)}catch(n){cs(n)?ee(tu,"Ignoring IndexedDB error during index backfill: ",n):await Io(n)}await this.re(6e4)})}}class hU{constructor(e,n){this.localStore=e,this.persistence=n}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.se(n,e))}se(e,n){const r=new Set;let i=n,s=!0;return q.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return ee(tu,`Processing collection: ${o}`),this.oe(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>n-i)}oe(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this._e(i,s)).next(a=>(ee(tu,`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}_e(e,n){let r=e;return n.changes.forEach((i,s)=>{const o=j0(s);A_(o,r)>0&&(r=o)}),new xn(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bn{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Bn.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eo=-1;function rf(t){return t==null}function Nu(t){return t===0&&1/t==-1/0}function fU(t){return typeof t=="number"&&Number.isInteger(t)&&!Nu(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fh="";function Xt(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=bE(e)),e=pU(t.get(n),e);return bE(e)}function pU(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const s=t.charAt(i);switch(s){case"\0":n+="";break;case fh:n+="";break;default:n+=s}}return n}function bE(t){return t+fh+""}function Ar(t){const e=t.length;if(ge(e>=2,64408,{path:t}),e===2)return ge(t.charAt(0)===fh&&t.charAt(1)==="",56145,{path:t}),Ge.emptyPath();const n=e-2,r=[];let i="";for(let s=0;s<e;){const o=t.indexOf(fh,s);switch((o<0||o>n)&&de(50515,{path:t}),t.charAt(o+1)){case"":const a=t.substring(s,o);let l;i.length===0?l=a:(i+=a,l=i,i=""),r.push(l);break;case"":i+=t.substring(s,o),i+="\0";break;case"":i+=t.substring(s,o+1);break;default:de(61167,{path:t})}s=o+2}return new Ge(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qs="remoteDocuments",Zu="owner",Fo="owner",Du="mutationQueues",mU="userId",tr="mutations",ME="batchId",Qs="userMutationsIndex",VE=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Id(t,e){return[t,Xt(e)]}function X0(t,e,n){return[t,Xt(e),n]}const gU={},Na="documentMutations",ph="remoteDocumentsV14",_U=["prefixPath","collectionGroup","readTime","documentId"],wd="documentKeyIndex",yU=["prefixPath","collectionGroup","documentId"],Z0="collectionGroupIndex",vU=["collectionGroup","readTime","prefixPath","documentId"],bu="remoteDocumentGlobal",Om="remoteDocumentGlobalKey",Da="targets",eA="queryTargetsIndex",TU=["canonicalId","targetId"],ba="targetDocuments",EU=["targetId","path"],R_="documentTargetsIndex",IU=["path","targetId"],mh="targetGlobalKey",to="targetGlobal",Mu="collectionParents",wU=["collectionId","parent"],Ma="clientMetadata",SU="clientId",sf="bundles",CU="bundleId",of="namedQueries",AU="name",P_="indexConfiguration",xU="indexId",Bm="collectionGroupIndex",RU="collectionGroup",nu="indexState",PU=["indexId","uid"],tA="sequenceNumberIndex",kU=["uid","sequenceNumber"],ru="indexEntries",NU=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],nA="documentKeyIndex",DU=["indexId","uid","orderedDocumentKey"],af="documentOverlays",bU=["userId","collectionPath","documentId"],qm="collectionPathOverlayIndex",MU=["userId","collectionPath","largestBatchId"],rA="collectionGroupOverlayIndex",VU=["userId","collectionGroup","largestBatchId"],k_="globals",LU="name",iA=[Du,tr,Na,qs,Da,Zu,to,ba,Ma,bu,Mu,sf,of],FU=[...iA,af],sA=[Du,tr,Na,ph,Da,Zu,to,ba,Ma,bu,Mu,sf,of,af],oA=sA,N_=[...oA,P_,nu,ru],UU=N_,aA=[...N_,k_],OU=aA;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gm extends Q0{constructor(e,n){super(),this.le=e,this.currentSequenceNumber=n}}function kt(t,e){const n=Se(t);return ji.O(n.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LE(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ds(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function lA(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ht{constructor(e,n){this.comparator=e,this.root=n||Bt.EMPTY}insert(e,n){return new ht(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Bt.BLACK,null,null))}remove(e){return new ht(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Bt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Qc(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Qc(this.root,e,this.comparator,!1)}getReverseIterator(){return new Qc(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Qc(this.root,e,this.comparator,!0)}}class Qc{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Bt{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??Bt.RED,this.left=i??Bt.EMPTY,this.right=s??Bt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new Bt(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Bt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return Bt.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Bt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Bt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw de(43730,{key:this.key,value:this.value});if(this.right.isRed())throw de(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw de(27949);return e+(this.isRed()?0:1)}}Bt.EMPTY=null,Bt.RED=!0,Bt.BLACK=!1;Bt.EMPTY=new class{constructor(){this.size=0}get key(){throw de(57766)}get value(){throw de(16141)}get color(){throw de(16727)}get left(){throw de(29726)}get right(){throw de(36894)}copy(e,n,r,i,s){return this}insert(e,n,r){return new Bt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ke{constructor(e){this.comparator=e,this.data=new ht(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new FE(this.data.getIterator())}getIteratorFrom(e){return new FE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Ke)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Ke(this.comparator);return n.data=e,n}}class FE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Uo(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fn{constructor(e){this.fields=e,e.sort(dt.comparator)}static empty(){return new fn([])}unionWith(e){let n=new Ke(dt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new fn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return ka(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uA extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Et{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new uA("Invalid base64 string: "+s):s}}(e);return new Et(n)}static fromUint8Array(e){const n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new Et(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return we(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Et.EMPTY_BYTE_STRING=new Et("");const BU=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ti(t){if(ge(!!t,39018),typeof t=="string"){let e=0;const n=BU.exec(t);if(ge(!!n,46558,{timestamp:t}),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ut(t.seconds),nanos:ut(t.nanos)}}function ut(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function ni(t){return typeof t=="string"?Et.fromBase64String(t):Et.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cA="server_timestamp",dA="__type__",hA="__previous_value__",fA="__local_write_time__";function D_(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[dA])==null?void 0:r.stringValue)===cA}function lf(t){const e=t.mapValue.fields[hA];return D_(e)?lf(e):e}function Vu(t){const e=ti(t.mapValue.fields[fA].timestampValue);return new $e(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qU{constructor(e,n,r,i,s,o,a,l,u,f){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=u,this.isUsingEmulator=f}}const gh="(default)";class ts{constructor(e,n){this.projectId=e,this.database=n||gh}static empty(){return new ts("","")}get isDefaultDatabase(){return this.database===gh}isEqual(e){return e instanceof ts&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b_="__type__",pA="__max__",Vi={mapValue:{fields:{__type__:{stringValue:pA}}}},M_="__vector__",Va="value",Sd={nullValue:"NULL_VALUE"};function ns(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?D_(t)?4:mA(t)?9007199254740991:uf(t)?10:11:de(28295,{value:t})}function br(t,e){if(t===e)return!0;const n=ns(t);if(n!==ns(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Vu(t).isEqual(Vu(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=ti(i.timestampValue),a=ti(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return ni(i.bytesValue).isEqual(ni(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return ut(i.geoPointValue.latitude)===ut(s.geoPointValue.latitude)&&ut(i.geoPointValue.longitude)===ut(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return ut(i.integerValue)===ut(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=ut(i.doubleValue),a=ut(s.doubleValue);return o===a?Nu(o)===Nu(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return ka(t.arrayValue.values||[],e.arrayValue.values||[],br);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(LE(o)!==LE(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!br(o[l],a[l])))return!1;return!0}(t,e);default:return de(52216,{left:t})}}function Lu(t,e){return(t.values||[]).find(n=>br(n,e))!==void 0}function rs(t,e){if(t===e)return 0;const n=ns(t),r=ns(e);if(n!==r)return we(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return we(t.booleanValue,e.booleanValue);case 2:return function(s,o){const a=ut(s.integerValue||s.doubleValue),l=ut(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(t,e);case 3:return UE(t.timestampValue,e.timestampValue);case 4:return UE(Vu(t),Vu(e));case 5:return Fm(t.stringValue,e.stringValue);case 6:return function(s,o){const a=ni(s),l=ni(o);return a.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),l=o.split("/");for(let u=0;u<a.length&&u<l.length;u++){const f=we(a[u],l[u]);if(f!==0)return f}return we(a.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){const a=we(ut(s.latitude),ut(o.latitude));return a!==0?a:we(ut(s.longitude),ut(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return OE(t.arrayValue,e.arrayValue);case 10:return function(s,o){var g,v,E,R;const a=s.fields||{},l=o.fields||{},u=(g=a[Va])==null?void 0:g.arrayValue,f=(v=l[Va])==null?void 0:v.arrayValue,p=we(((E=u==null?void 0:u.values)==null?void 0:E.length)||0,((R=f==null?void 0:f.values)==null?void 0:R.length)||0);return p!==0?p:OE(u,f)}(t.mapValue,e.mapValue);case 11:return function(s,o){if(s===Vi.mapValue&&o===Vi.mapValue)return 0;if(s===Vi.mapValue)return 1;if(o===Vi.mapValue)return-1;const a=s.fields||{},l=Object.keys(a),u=o.fields||{},f=Object.keys(u);l.sort(),f.sort();for(let p=0;p<l.length&&p<f.length;++p){const g=Fm(l[p],f[p]);if(g!==0)return g;const v=rs(a[l[p]],u[f[p]]);if(v!==0)return v}return we(l.length,f.length)}(t.mapValue,e.mapValue);default:throw de(23264,{he:n})}}function UE(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return we(t,e);const n=ti(t),r=ti(e),i=we(n.seconds,r.seconds);return i!==0?i:we(n.nanos,r.nanos)}function OE(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const s=rs(n[i],r[i]);if(s)return s}return we(n.length,r.length)}function La(t){return zm(t)}function zm(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=ti(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return ni(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return se.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=zm(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${zm(n.fields[o])}`;return i+"}"}(t.mapValue):de(61005,{value:t})}function Cd(t){switch(ns(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=lf(t);return e?16+Cd(e):16;case 5:return 2*t.stringValue.length;case 6:return ni(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,s)=>i+Cd(s),0)}(t.arrayValue);case 10:case 11:return function(r){let i=0;return ds(r.fields,(s,o)=>{i+=s.length+Cd(o)}),i}(t.mapValue);default:throw de(13486,{value:t})}}function Fu(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function $m(t){return!!t&&"integerValue"in t}function Uu(t){return!!t&&"arrayValue"in t}function BE(t){return!!t&&"nullValue"in t}function qE(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Ad(t){return!!t&&"mapValue"in t}function uf(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[b_])==null?void 0:r.stringValue)===M_}function iu(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return ds(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=iu(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=iu(t.arrayValue.values[n]);return e}return{...t}}function mA(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===pA}const gA={mapValue:{fields:{[b_]:{stringValue:M_},[Va]:{arrayValue:{}}}}};function GU(t){return"nullValue"in t?Sd:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?Fu(ts.empty(),se.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?uf(t)?gA:{mapValue:{}}:de(35942,{value:t})}function zU(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?Fu(ts.empty(),se.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?gA:"mapValue"in t?uf(t)?{mapValue:{}}:Vi:de(61959,{value:t})}function GE(t,e){const n=rs(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function zE(t,e){const n=rs(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qt{constructor(e){this.value=e}static empty(){return new Qt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Ad(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=iu(n)}setAll(e){let n=dt.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=iu(o):i.push(a.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());Ad(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return br(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];Ad(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){ds(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new Qt(iu(this.value))}}function _A(t){const e=[];return ds(t.fields,(n,r)=>{const i=new dt([n]);if(Ad(r)){const s=_A(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new fn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vt{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new vt(e,0,_e.min(),_e.min(),_e.min(),Qt.empty(),0)}static newFoundDocument(e,n,r,i){return new vt(e,1,n,_e.min(),r,i,0)}static newNoDocument(e,n){return new vt(e,2,n,_e.min(),_e.min(),Qt.empty(),0)}static newUnknownDocument(e,n){return new vt(e,3,n,_e.min(),_e.min(),Qt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(_e.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Qt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Qt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=_e.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof vt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new vt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fa{constructor(e,n){this.position=e,this.inclusive=n}}function $E(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(s.field.isKeyField()?r=se.comparator(se.fromName(o.referenceValue),n.key):r=rs(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function HE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!br(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _h{constructor(e,n="asc"){this.field=e,this.dir=n}}function $U(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yA{}class be extends yA{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new HU(e,n,r):n==="array-contains"?new jU(e,r):n==="in"?new SA(e,r):n==="not-in"?new JU(e,r):n==="array-contains-any"?new QU(e,r):new be(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new WU(e,r):new KU(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(rs(n,this.value)):n!==null&&ns(this.value)===ns(n)&&this.matchesComparison(rs(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return de(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class He extends yA{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new He(e,n)}matches(e){return Ua(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Ua(t){return t.op==="and"}function Hm(t){return t.op==="or"}function V_(t){return vA(t)&&Ua(t)}function vA(t){for(const e of t.filters)if(e instanceof He)return!1;return!0}function Wm(t){if(t instanceof be)return t.field.canonicalString()+t.op.toString()+La(t.value);if(V_(t))return t.filters.map(e=>Wm(e)).join(",");{const e=t.filters.map(n=>Wm(n)).join(",");return`${t.op}(${e})`}}function TA(t,e){return t instanceof be?function(r,i){return i instanceof be&&r.op===i.op&&r.field.isEqual(i.field)&&br(r.value,i.value)}(t,e):t instanceof He?function(r,i){return i instanceof He&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&TA(o,i.filters[a]),!0):!1}(t,e):void de(19439)}function EA(t,e){const n=t.filters.concat(e);return He.create(n,t.op)}function IA(t){return t instanceof be?function(n){return`${n.field.canonicalString()} ${n.op} ${La(n.value)}`}(t):t instanceof He?function(n){return n.op.toString()+" {"+n.getFilters().map(IA).join(" ,")+"}"}(t):"Filter"}class HU extends be{constructor(e,n,r){super(e,n,r),this.key=se.fromName(r.referenceValue)}matches(e){const n=se.comparator(e.key,this.key);return this.matchesComparison(n)}}class WU extends be{constructor(e,n){super(e,"in",n),this.keys=wA("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class KU extends be{constructor(e,n){super(e,"not-in",n),this.keys=wA("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function wA(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(r=>se.fromName(r.referenceValue))}class jU extends be{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Uu(n)&&Lu(n.arrayValue,this.value)}}class SA extends be{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Lu(this.value.arrayValue,n)}}class JU extends be{constructor(e,n){super(e,"not-in",n)}matches(e){if(Lu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Lu(this.value.arrayValue,n)}}class QU extends be{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Uu(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Lu(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YU{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.Te=null}}function Km(t,e=null,n=[],r=[],i=null,s=null,o=null){return new YU(t,e,n,r,i,s,o)}function po(t){const e=Se(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Wm(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),rf(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>La(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>La(r)).join(",")),e.Te=n}return e.Te}function ec(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!$U(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!TA(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!HE(t.startAt,e.startAt)&&HE(t.endAt,e.endAt)}function yh(t){return se.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function vh(t,e){return t.filters.filter(n=>n instanceof be&&n.field.isEqual(e))}function WE(t,e,n){let r=Sd,i=!0;for(const s of vh(t,e)){let o=Sd,a=!0;switch(s.op){case"<":case"<=":o=GU(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=Sd}GE({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];GE({value:r,inclusive:i},{value:o,inclusive:n.inclusive})<0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}function KE(t,e,n){let r=Vi,i=!0;for(const s of vh(t,e)){let o=Vi,a=!0;switch(s.op){case">=":case">":o=zU(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=Vi}zE({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];zE({value:r,inclusive:i},{value:o,inclusive:n.inclusive})>0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tc{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function XU(t,e,n,r,i,s,o,a){return new tc(t,e,n,r,i,s,o,a)}function nc(t){return new tc(t)}function jE(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function CA(t){return t.collectionGroup!==null}function su(t){const e=Se(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Ke(dt.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(u=>{u.isInequality()&&(a=a.add(u.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new _h(s,r))}),n.has(dt.keyField().canonicalString())||e.Ie.push(new _h(dt.keyField(),r))}return e.Ie}function zn(t){const e=Se(t);return e.Ee||(e.Ee=ZU(e,su(t))),e.Ee}function ZU(t,e){if(t.limitType==="F")return Km(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new _h(i.field,s)});const n=t.endAt?new Fa(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Fa(t.startAt.position,t.startAt.inclusive):null;return Km(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function jm(t,e){const n=t.filters.concat([e]);return new tc(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Jm(t,e,n){return new tc(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function cf(t,e){return ec(zn(t),zn(e))&&t.limitType===e.limitType}function AA(t){return`${po(zn(t))}|lt:${t.limitType}`}function $o(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>IA(i)).join(", ")}]`),rf(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>La(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>La(i)).join(",")),`Target(${r})`}(zn(t))}; limitType=${t.limitType})`}function rc(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):se.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of su(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,a,l){const u=$E(o,a,l);return o.inclusive?u<=0:u<0}(r.startAt,su(r),i)||r.endAt&&!function(o,a,l){const u=$E(o,a,l);return o.inclusive?u>=0:u>0}(r.endAt,su(r),i))}(t,e)}function e4(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function xA(t){return(e,n)=>{let r=!1;for(const i of su(t)){const s=t4(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function t4(t,e,n){const r=t.field.isKeyField()?se.comparator(e.key,n.key):function(s,o,a){const l=o.data.field(s),u=a.data.field(s);return l!==null&&u!==null?rs(l,u):de(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return de(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oi{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){ds(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return lA(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n4=new ht(se.comparator);function Sn(){return n4}const RA=new ht(se.comparator);function Fl(...t){let e=RA;for(const n of t)e=e.insert(n.key,n);return e}function PA(t){let e=RA;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function xr(){return ou()}function kA(){return ou()}function ou(){return new oi(t=>t.toString(),(t,e)=>t.isEqual(e))}const r4=new ht(se.comparator),i4=new Ke(se.comparator);function Re(...t){let e=i4;for(const n of t)e=e.add(n);return e}const s4=new Ke(we);function o4(){return s4}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L_(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Nu(e)?"-0":e}}function NA(t){return{integerValue:""+t}}function a4(t,e){return fU(e)?NA(e):L_(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class df{constructor(){this._=void 0}}function l4(t,e,n){return t instanceof Oa?function(i,s){const o={fields:{[dA]:{stringValue:cA},[fA]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&D_(s)&&(s=lf(s)),s&&(o.fields[hA]=s),{mapValue:o}}(n,e):t instanceof Ba?bA(t,e):t instanceof qa?MA(t,e):function(i,s){const o=DA(i,s),a=JE(o)+JE(i.Ae);return $m(o)&&$m(i.Ae)?NA(a):L_(i.serializer,a)}(t,e)}function u4(t,e,n){return t instanceof Ba?bA(t,e):t instanceof qa?MA(t,e):n}function DA(t,e){return t instanceof Ou?function(r){return $m(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class Oa extends df{}class Ba extends df{constructor(e){super(),this.elements=e}}function bA(t,e){const n=VA(e);for(const r of t.elements)n.some(i=>br(i,r))||n.push(r);return{arrayValue:{values:n}}}class qa extends df{constructor(e){super(),this.elements=e}}function MA(t,e){let n=VA(e);for(const r of t.elements)n=n.filter(i=>!br(i,r));return{arrayValue:{values:n}}}class Ou extends df{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function JE(t){return ut(t.integerValue||t.doubleValue)}function VA(t){return Uu(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LA{constructor(e,n){this.field=e,this.transform=n}}function c4(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof Ba&&i instanceof Ba||r instanceof qa&&i instanceof qa?ka(r.elements,i.elements,br):r instanceof Ou&&i instanceof Ou?br(r.Ae,i.Ae):r instanceof Oa&&i instanceof Oa}(t.transform,e.transform)}class d4{constructor(e,n){this.version=e,this.transformResults=n}}class rn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new rn}static exists(e){return new rn(void 0,e)}static updateTime(e){return new rn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function xd(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class hf{}function FA(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new ff(t.key,rn.none()):new el(t.key,t.data,rn.none());{const n=t.data,r=Qt.empty();let i=new Ke(dt.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new ai(t.key,r,new fn(i.toArray()),rn.none())}}function h4(t,e,n){t instanceof el?function(i,s,o){const a=i.value.clone(),l=YE(i.fieldTransforms,s,o.transformResults);a.setAll(l),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof ai?function(i,s,o){if(!xd(i.precondition,s))return void s.convertToUnknownDocument(o.version);const a=YE(i.fieldTransforms,s,o.transformResults),l=s.data;l.setAll(UA(i)),l.setAll(a),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function au(t,e,n,r){return t instanceof el?function(s,o,a,l){if(!xd(s.precondition,o))return a;const u=s.value.clone(),f=XE(s.fieldTransforms,l,o);return u.setAll(f),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,n,r):t instanceof ai?function(s,o,a,l){if(!xd(s.precondition,o))return a;const u=XE(s.fieldTransforms,l,o),f=o.data;return f.setAll(UA(s)),f.setAll(u),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(p=>p.field))}(t,e,n,r):function(s,o,a){return xd(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function f4(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=DA(r.transform,i||null);s!=null&&(n===null&&(n=Qt.empty()),n.set(r.field,s))}return n||null}function QE(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&ka(r,i,(s,o)=>c4(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class el extends hf{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class ai extends hf{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function UA(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function YE(t,e,n){const r=new Map;ge(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,u4(o,a,n[i]))}return r}function XE(t,e,n){const r=new Map;for(const i of t){const s=i.transform,o=n.data.field(i.field);r.set(i.field,l4(s,o,e))}return r}class ff extends hf{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class OA extends hf{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F_{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&h4(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=au(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=au(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=kA();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;const l=FA(o,a);l!==null&&r.set(i.key,l),o.isValidDocument()||o.convertToNoDocument(_e.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Re())}isEqual(e){return this.batchId===e.batchId&&ka(this.mutations,e.mutations,(n,r)=>QE(n,r))&&ka(this.baseMutations,e.baseMutations,(n,r)=>QE(n,r))}}class U_{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){ge(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=function(){return r4}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new U_(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O_{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p4{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var It,Ue;function m4(t){switch(t){case j.OK:return de(64938);case j.CANCELLED:case j.UNKNOWN:case j.DEADLINE_EXCEEDED:case j.RESOURCE_EXHAUSTED:case j.INTERNAL:case j.UNAVAILABLE:case j.UNAUTHENTICATED:return!1;case j.INVALID_ARGUMENT:case j.NOT_FOUND:case j.ALREADY_EXISTS:case j.PERMISSION_DENIED:case j.FAILED_PRECONDITION:case j.ABORTED:case j.OUT_OF_RANGE:case j.UNIMPLEMENTED:case j.DATA_LOSS:return!0;default:return de(15467,{code:t})}}function BA(t){if(t===void 0)return nn("GRPC error has no .code"),j.UNKNOWN;switch(t){case It.OK:return j.OK;case It.CANCELLED:return j.CANCELLED;case It.UNKNOWN:return j.UNKNOWN;case It.DEADLINE_EXCEEDED:return j.DEADLINE_EXCEEDED;case It.RESOURCE_EXHAUSTED:return j.RESOURCE_EXHAUSTED;case It.INTERNAL:return j.INTERNAL;case It.UNAVAILABLE:return j.UNAVAILABLE;case It.UNAUTHENTICATED:return j.UNAUTHENTICATED;case It.INVALID_ARGUMENT:return j.INVALID_ARGUMENT;case It.NOT_FOUND:return j.NOT_FOUND;case It.ALREADY_EXISTS:return j.ALREADY_EXISTS;case It.PERMISSION_DENIED:return j.PERMISSION_DENIED;case It.FAILED_PRECONDITION:return j.FAILED_PRECONDITION;case It.ABORTED:return j.ABORTED;case It.OUT_OF_RANGE:return j.OUT_OF_RANGE;case It.UNIMPLEMENTED:return j.UNIMPLEMENTED;case It.DATA_LOSS:return j.DATA_LOSS;default:return de(39323,{code:t})}}(Ue=It||(It={}))[Ue.OK=0]="OK",Ue[Ue.CANCELLED=1]="CANCELLED",Ue[Ue.UNKNOWN=2]="UNKNOWN",Ue[Ue.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ue[Ue.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ue[Ue.NOT_FOUND=5]="NOT_FOUND",Ue[Ue.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ue[Ue.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ue[Ue.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ue[Ue.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ue[Ue.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ue[Ue.ABORTED=10]="ABORTED",Ue[Ue.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ue[Ue.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ue[Ue.INTERNAL=13]="INTERNAL",Ue[Ue.UNAVAILABLE=14]="UNAVAILABLE",Ue[Ue.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g4(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _4=new Ki([4294967295,4294967295],0);function ZE(t){const e=g4().encode(t),n=new M0;return n.update(e),new Uint8Array(n.digest())}function eI(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Ki([n,r],0),new Ki([i,s],0)]}class B_{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Ul(`Invalid padding: ${n}`);if(r<0)throw new Ul(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Ul(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Ul(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=Ki.fromNumber(this.ge)}ye(e,n,r){let i=e.add(n.multiply(Ki.fromNumber(r)));return i.compare(_4)===1&&(i=new Ki([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=ZE(e),[r,i]=eI(n);for(let s=0;s<this.hashCount;s++){const o=this.ye(r,i,s);if(!this.we(o))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new B_(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.ge===0)return;const n=ZE(e),[r,i]=eI(n);for(let s=0;s<this.hashCount;s++){const o=this.ye(r,i,s);this.Se(o)}}Se(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Ul extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pf{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,ic.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new pf(_e.min(),i,new ht(we),Sn(),Re())}}class ic{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new ic(r,n,Re(),Re(),Re())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rd{constructor(e,n,r,i){this.be=e,this.removedTargetIds=n,this.key=r,this.De=i}}class qA{constructor(e,n){this.targetId=e,this.Ce=n}}class GA{constructor(e,n,r=Et.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class tI{constructor(){this.ve=0,this.Fe=nI(),this.Me=Et.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Re(),n=Re(),r=Re();return this.Fe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:de(38017,{changeType:s})}}),new ic(this.Me,this.xe,e,n,r)}qe(){this.Oe=!1,this.Fe=nI()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,ge(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class y4{constructor(e){this.Ge=e,this.ze=new Map,this.je=Sn(),this.Je=Yc(),this.He=Yc(),this.Ye=new ht(we)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:de(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((r,i)=>{this.rt(i)&&n(i)})}st(e){const n=e.targetId,r=e.Ce.count,i=this.ot(n);if(i){const s=i.target;if(yh(s))if(r===0){const o=new se(s.path);this.et(n,o,vt.newNoDocument(o,_e.min()))}else ge(r===1,20013,{expectedCount:r});else{const o=this._t(n);if(o!==r){const a=this.ut(e),l=a?this.ct(a,e,o):1;if(l!==0){this.it(n);const u=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,u)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let o,a;try{o=ni(r).toUint8Array()}catch(l){if(l instanceof uA)return es("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new B_(o,i,s)}catch(l){return es(l instanceof Ul?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.ge===0?null:a}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.et(n,s,null),i++)}),i}Tt(e){const n=new Map;this.ze.forEach((s,o)=>{const a=this.ot(o);if(a){if(s.current&&yh(a.target)){const l=new se(a.target.path);this.It(l).has(o)||this.Et(o,l)||this.et(o,l,vt.newNoDocument(l,e))}s.Be&&(n.set(o,s.ke()),s.qe())}});let r=Re();this.He.forEach((s,o)=>{let a=!0;o.forEachWhile(l=>{const u=this.ot(l);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.je.forEach((s,o)=>o.setReadTime(e));const i=new pf(e,n,this.Ye,this.je,r);return this.je=Sn(),this.Je=Yc(),this.He=Yc(),this.Ye=new ht(we),i}Xe(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,r),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,n)?i.Qe(n,1):i.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new tI,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new Ke(we),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new Ke(we),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||ee("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new tI),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function Yc(){return new ht(se.comparator)}function nI(){return new ht(se.comparator)}const v4={asc:"ASCENDING",desc:"DESCENDING"},T4={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},E4={and:"AND",or:"OR"};class I4{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Qm(t,e){return t.useProto3Json||rf(e)?e:{value:e}}function Ga(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function zA(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function w4(t,e){return Ga(t,e.toTimestamp())}function an(t){return ge(!!t,49232),_e.fromTimestamp(function(n){const r=ti(n);return new $e(r.seconds,r.nanos)}(t))}function q_(t,e){return Ym(t,e).canonicalString()}function Ym(t,e){const n=function(i){return new Ge(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function $A(t){const e=Ge.fromString(t);return ge(ZA(e),10190,{key:e.toString()}),e}function Th(t,e){return q_(t.databaseId,e.path)}function no(t,e){const n=$A(e);if(n.get(1)!==t.databaseId.projectId)throw new re(j.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new re(j.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new se(KA(n))}function HA(t,e){return q_(t.databaseId,e)}function WA(t){const e=$A(t);return e.length===4?Ge.emptyPath():KA(e)}function Xm(t){return new Ge(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function KA(t){return ge(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function rI(t,e,n){return{name:Th(t,e),fields:n.value.mapValue.fields}}function S4(t,e,n){const r=no(t,e.name),i=an(e.updateTime),s=e.createTime?an(e.createTime):_e.min(),o=new Qt({mapValue:{fields:e.fields}}),a=vt.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function C4(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:de(39313,{state:u})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(u,f){return u.useProto3Json?(ge(f===void 0||typeof f=="string",58123),Et.fromBase64String(f||"")):(ge(f===void 0||f instanceof Buffer||f instanceof Uint8Array,16193),Et.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(u){const f=u.code===void 0?j.UNKNOWN:BA(u.code);return new re(f,u.message||"")}(o);n=new GA(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=no(t,r.document.name),s=an(r.document.updateTime),o=r.document.createTime?an(r.document.createTime):_e.min(),a=new Qt({mapValue:{fields:r.document.fields}}),l=vt.newFoundDocument(i,s,o,a),u=r.targetIds||[],f=r.removedTargetIds||[];n=new Rd(u,f,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=no(t,r.document),s=r.readTime?an(r.readTime):_e.min(),o=vt.newNoDocument(i,s),a=r.removedTargetIds||[];n=new Rd([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=no(t,r.document),s=r.removedTargetIds||[];n=new Rd([],s,i,null)}else{if(!("filter"in e))return de(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new p4(i,s),a=r.targetId;n=new qA(a,o)}}return n}function Eh(t,e){let n;if(e instanceof el)n={update:rI(t,e.key,e.value)};else if(e instanceof ff)n={delete:Th(t,e.key)};else if(e instanceof ai)n={update:rI(t,e.key,e.data),updateMask:N4(e.fieldMask)};else{if(!(e instanceof OA))return de(16599,{Vt:e.type});n={verify:Th(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const a=o.transform;if(a instanceof Oa)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Ba)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof qa)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Ou)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw de(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:w4(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:de(27497)}(t,e.precondition)),n}function Zm(t,e){const n=e.currentDocument?function(s){return s.updateTime!==void 0?rn.updateTime(an(s.updateTime)):s.exists!==void 0?rn.exists(s.exists):rn.none()}(e.currentDocument):rn.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let l=null;if("setToServerValue"in a)ge(a.setToServerValue==="REQUEST_TIME",16630,{proto:a}),l=new Oa;else if("appendMissingElements"in a){const f=a.appendMissingElements.values||[];l=new Ba(f)}else if("removeAllFromArray"in a){const f=a.removeAllFromArray.values||[];l=new qa(f)}else"increment"in a?l=new Ou(o,a.increment):de(16584,{proto:a});const u=dt.fromServerFormat(a.fieldPath);return new LA(u,l)}(t,i)):[];if(e.update){e.update.name;const i=no(t,e.update.name),s=new Qt({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(l){const u=l.fieldPaths||[];return new fn(u.map(f=>dt.fromServerFormat(f)))}(e.updateMask);return new ai(i,s,o,n,r)}return new el(i,s,n,r)}if(e.delete){const i=no(t,e.delete);return new ff(i,n)}if(e.verify){const i=no(t,e.verify);return new OA(i,n)}return de(1463,{proto:e})}function A4(t,e){return t&&t.length>0?(ge(e!==void 0,14353),t.map(n=>function(i,s){let o=i.updateTime?an(i.updateTime):an(s);return o.isEqual(_e.min())&&(o=an(s)),new d4(o,i.transformResults||[])}(n,e))):[]}function jA(t,e){return{documents:[HA(t,e.path)]}}function JA(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=HA(t,i);const s=function(u){if(u.length!==0)return XA(He.create(u,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const o=function(u){if(u.length!==0)return u.map(f=>function(g){return{field:Ho(g.field),direction:R4(g.dir)}}(f))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=Qm(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{ft:n,parent:i}}function QA(t){let e=WA(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){ge(r===1,65062);const f=n.from[0];f.allDescendants?i=f.collectionId:e=e.child(f.collectionId)}let s=[];n.where&&(s=function(p){const g=YA(p);return g instanceof He&&V_(g)?g.getFilters():[g]}(n.where));let o=[];n.orderBy&&(o=function(p){return p.map(g=>function(E){return new _h(Wo(E.field),function(M){switch(M){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(E.direction))}(g))}(n.orderBy));let a=null;n.limit&&(a=function(p){let g;return g=typeof p=="object"?p.value:p,rf(g)?null:g}(n.limit));let l=null;n.startAt&&(l=function(p){const g=!!p.before,v=p.values||[];return new Fa(v,g)}(n.startAt));let u=null;return n.endAt&&(u=function(p){const g=!p.before,v=p.values||[];return new Fa(v,g)}(n.endAt)),XU(e,i,o,s,a,"F",l,u)}function x4(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return de(28987,{purpose:i})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function YA(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Wo(n.unaryFilter.field);return be.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Wo(n.unaryFilter.field);return be.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Wo(n.unaryFilter.field);return be.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Wo(n.unaryFilter.field);return be.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return de(61313);default:return de(60726)}}(t):t.fieldFilter!==void 0?function(n){return be.create(Wo(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return de(58110);default:return de(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return He.create(n.compositeFilter.filters.map(r=>YA(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return de(1026)}}(n.compositeFilter.op))}(t):de(30097,{filter:t})}function R4(t){return v4[t]}function P4(t){return T4[t]}function k4(t){return E4[t]}function Ho(t){return{fieldPath:t.canonicalString()}}function Wo(t){return dt.fromServerFormat(t.fieldPath)}function XA(t){return t instanceof be?function(n){if(n.op==="=="){if(qE(n.value))return{unaryFilter:{field:Ho(n.field),op:"IS_NAN"}};if(BE(n.value))return{unaryFilter:{field:Ho(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(qE(n.value))return{unaryFilter:{field:Ho(n.field),op:"IS_NOT_NAN"}};if(BE(n.value))return{unaryFilter:{field:Ho(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ho(n.field),op:P4(n.op),value:n.value}}}(t):t instanceof He?function(n){const r=n.getFilters().map(i=>XA(i));return r.length===1?r[0]:{compositeFilter:{op:k4(n.op),filters:r}}}(t):de(54877,{filter:t})}function N4(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function ZA(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wr{constructor(e,n,r,i,s=_e.min(),o=_e.min(),a=Et.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new Wr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Wr(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Wr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Wr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ex{constructor(e){this.yt=e}}function D4(t,e){let n;if(e.document)n=S4(t.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=se.fromSegments(e.noDocument.path),i=go(e.noDocument.readTime);n=vt.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return de(56709);{const r=se.fromSegments(e.unknownDocument.path),i=go(e.unknownDocument.version);n=vt.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){const s=new $e(i[0],i[1]);return _e.fromTimestamp(s)}(e.readTime)),n}function iI(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Ih(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:Th(s,o.key),fields:o.data.value.mapValue.fields,updateTime:Ga(s,o.version.toTimestamp()),createTime:Ga(s,o.createTime.toTimestamp())}}(t.yt,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:mo(e.version)};else{if(!e.isUnknownDocument())return de(57904,{document:e});r.unknownDocument={path:n.path.toArray(),version:mo(e.version)}}return r}function Ih(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function mo(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function go(t){const e=new $e(t.seconds,t.nanoseconds);return _e.fromTimestamp(e)}function zs(t,e){const n=(e.baseMutations||[]).map(s=>Zm(t.yt,s));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map(s=>Zm(t.yt,s)),i=$e.fromMillis(e.localWriteTimeMs);return new F_(e.batchId,i,n,r)}function Ol(t){const e=go(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?go(t.lastLimboFreeSnapshotVersion):_e.min();let r;return r=function(s){return s.documents!==void 0}(t.query)?function(s){const o=s.documents.length;return ge(o===1,1966,{count:o}),zn(nc(WA(s.documents[0])))}(t.query):function(s){return zn(QA(s))}(t.query),new Wr(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,Et.fromBase64String(t.resumeToken))}function tx(t,e){const n=mo(e.snapshotVersion),r=mo(e.lastLimboFreeSnapshotVersion);let i;i=yh(e.target)?jA(t.yt,e.target):JA(t.yt,e.target).ft;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:po(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function nx(t){const e=QA({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Jm(e,e.limit,"L"):e}function vp(t,e){return new O_(e.largestBatchId,Zm(t.yt,e.overlayMutation))}function sI(t,e){const n=e.path.lastSegment();return[t,Xt(e.path.popLast()),n]}function oI(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:mo(r.readTime),documentKey:Xt(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b4{getBundleMetadata(e,n){return aI(e).get(n).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:go(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,n){return aI(e).put(function(i){return{bundleId:i.id,createTime:mo(an(i.createTime)),version:i.version}}(n))}getNamedQuery(e,n){return lI(e).get(n).next(r=>{if(r)return function(s){return{name:s.name,query:nx(s.bundledQuery),readTime:go(s.readTime)}}(r)})}saveNamedQuery(e,n){return lI(e).put(function(i){return{name:i.name,readTime:mo(an(i.readTime)),bundledQuery:i.bundledQuery}}(n))}}function aI(t){return kt(t,sf)}function lI(t){return kt(t,of)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mf{constructor(e,n){this.serializer=e,this.userId=n}static wt(e,n){const r=n.uid||"";return new mf(e,r)}getOverlay(e,n){return Al(e).get(sI(this.userId,n)).next(r=>r?vp(this.serializer,r):null)}getOverlays(e,n){const r=xr();return q.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){const i=[];return r.forEach((s,o)=>{const a=new O_(n,o);i.push(this.St(e,a))}),q.waitFor(i)}removeOverlaysForBatchId(e,n,r){const i=new Set;n.forEach(o=>i.add(Xt(o.getCollectionPath())));const s=[];return i.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(Al(e).Z(qm,a))}),q.waitFor(s)}getOverlaysForCollection(e,n,r){const i=xr(),s=Xt(n),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Al(e).J(qm,o).next(a=>{for(const l of a){const u=vp(this.serializer,l);i.set(u.getKey(),u)}return i})}getOverlaysForCollectionGroup(e,n,r,i){const s=xr();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return Al(e).ee({index:rA,range:a},(l,u,f)=>{const p=vp(this.serializer,u);s.size()<i||p.largestBatchId===o?(s.set(p.getKey(),p),o=p.largestBatchId):f.done()}).next(()=>s)}St(e,n){return Al(e).put(function(i,s,o){const[a,l,u]=sI(s,o.mutation.key);return{userId:s,collectionPath:l,documentId:u,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Eh(i.yt,o.mutation)}}(this.serializer,this.userId,n))}}function Al(t){return kt(t,af)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M4{bt(e){return kt(e,k_)}getSessionToken(e){return this.bt(e).get("sessionToken").next(n=>{const r=n==null?void 0:n.value;return r?Et.fromUint8Array(r):Et.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.bt(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $s{constructor(){}Dt(e,n){this.Ct(e,n),n.vt()}Ct(e,n){if("nullValue"in e)this.Ft(n,5);else if("booleanValue"in e)this.Ft(n,10),n.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(n,15),n.Mt(ut(e.integerValue));else if("doubleValue"in e){const r=ut(e.doubleValue);isNaN(r)?this.Ft(n,13):(this.Ft(n,15),Nu(r)?n.Mt(0):n.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(n,20),typeof r=="string"&&(r=ti(r)),n.xt(`${r.seconds||""}`),n.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,n),this.Nt(n);else if("bytesValue"in e)this.Ft(n,30),n.Bt(ni(e.bytesValue)),this.Nt(n);else if("referenceValue"in e)this.Lt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(n,45),n.Mt(r.latitude||0),n.Mt(r.longitude||0)}else"mapValue"in e?mA(e)?this.Ft(n,Number.MAX_SAFE_INTEGER):uf(e)?this.kt(e.mapValue,n):(this.qt(e.mapValue,n),this.Nt(n)):"arrayValue"in e?(this.Qt(e.arrayValue,n),this.Nt(n)):de(19022,{$t:e})}Ot(e,n){this.Ft(n,25),this.Ut(e,n)}Ut(e,n){n.xt(e)}qt(e,n){const r=e.fields||{};this.Ft(n,55);for(const i of Object.keys(r))this.Ot(i,n),this.Ct(r[i],n)}kt(e,n){var o,a;const r=e.fields||{};this.Ft(n,53);const i=Va,s=((a=(o=r[i].arrayValue)==null?void 0:o.values)==null?void 0:a.length)||0;this.Ft(n,15),n.Mt(ut(s)),this.Ot(i,n),this.Ct(r[i],n)}Qt(e,n){const r=e.values||[];this.Ft(n,50);for(const i of r)this.Ct(i,n)}Lt(e,n){this.Ft(n,37),se.fromName(e).path.forEach(r=>{this.Ft(n,60),this.Ut(r,n)})}Ft(e,n){e.Mt(n)}Nt(e){e.Mt(2)}}$s.Kt=new $s;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oo=255;function V4(t){if(t===0)return 8;let e=0;return t>>4||(e+=4,t<<=4),t>>6||(e+=2,t<<=2),t>>7||(e+=1),e}function uI(t){const e=64-function(r){let i=0;for(let s=0;s<8;++s){const o=V4(255&r[s]);if(i+=o,o!==8)break}return i}(t);return Math.ceil(e/8)}class L4{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Gt(r.value),r=n.next();this.zt()}jt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Jt(r.value),r=n.next();this.Ht()}Yt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const i=n.codePointAt(0);this.Gt(240|i>>>18),this.Gt(128|63&i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i)}}this.zt()}Zt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const i=n.codePointAt(0);this.Jt(240|i>>>18),this.Jt(128|63&i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i)}}this.Ht()}Xt(e){const n=this.en(e),r=uI(n);this.tn(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}nn(e){const n=this.en(e),r=uI(n);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}rn(){this.sn(Oo),this.sn(255)}_n(){this.an(Oo),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const n=function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=!!(128&n[0]);n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Gt(e){const n=255&e;n===0?(this.sn(0),this.sn(255)):n===Oo?(this.sn(Oo),this.sn(0)):this.sn(n)}Jt(e){const n=255&e;n===0?(this.an(0),this.an(255)):n===Oo?(this.an(Oo),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class F4{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class U4{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class xl{constructor(){this.cn=new L4,this.ln=new F4(this.cn),this.hn=new U4(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hs{constructor(e,n,r,i){this.Tn=e,this.In=n,this.En=r,this.dn=i}An(){const e=this.dn.length,n=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.dn,0),n!==e?r.set([0],this.dn.length):++r[r.length-1],new Hs(this.Tn,this.In,this.En,r)}Rn(e,n,r){return{indexId:this.Tn,uid:e,arrayValue:Pd(this.En),directionalValue:Pd(this.dn),orderedDocumentKey:Pd(n),documentKey:r.path.toArray()}}Vn(e,n,r){const i=this.Rn(e,n,r);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}}function Ti(t,e){let n=t.Tn-e.Tn;return n!==0?n:(n=cI(t.En,e.En),n!==0?n:(n=cI(t.dn,e.dn),n!==0?n:se.comparator(t.In,e.In)))}function cI(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}function Pd(t){return JC()?function(n){let r="";for(let i=0;i<n.length;i++)r+=String.fromCharCode(n[i]);return r}(t):t}function dI(t){return typeof t!="string"?t:function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(t)}class hI{constructor(e){this.mn=new Ke((n,r)=>dt.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const n of e.filters){const r=n;r.isInequality()?this.mn=this.mn.add(r):this.gn.push(r)}}get pn(){return this.mn.size>1}yn(e){if(ge(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const n=Um(e);if(n!==void 0&&!this.wn(n))return!1;const r=Bs(e);let i=new Set,s=0,o=0;for(;s<r.length&&this.wn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.mn.size>0){const a=this.mn.getIterator().getNext();if(!i.has(a.field.canonicalString())){const l=r[s];if(!this.Sn(a,l)||!this.bn(this.fn[o++],l))return!1}++s}for(;s<r.length;++s){const a=r[s];if(o>=this.fn.length||!this.bn(this.fn[o++],a))return!1}return!0}Dn(){if(this.pn)return null;let e=new Ke(dt.comparator);const n=[];for(const r of this.gn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new Ed(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new Ed(r.field,0))}for(const r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new Ed(r.field,r.dir==="asc"?0:1)));return new hh(hh.UNKNOWN_ID,this.collectionId,n,ku.empty())}wn(e){for(const n of this.gn)if(this.Sn(n,e))return!0;return!1}Sn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}bn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rx(t){var n,r;if(ge(t instanceof be||t instanceof He,20012),t instanceof be){if(t instanceof SA){const i=((r=(n=t.value.arrayValue)==null?void 0:n.values)==null?void 0:r.map(s=>be.create(t.field,"==",s)))||[];return He.create(i,"or")}return t}const e=t.filters.map(i=>rx(i));return He.create(e,t.op)}function O4(t){if(t.getFilters().length===0)return[];const e=ng(rx(t));return ge(ix(e),7391),eg(e)||tg(e)?[e]:e.getFilters()}function eg(t){return t instanceof be}function tg(t){return t instanceof He&&V_(t)}function ix(t){return eg(t)||tg(t)||function(n){if(n instanceof He&&Hm(n)){for(const r of n.getFilters())if(!eg(r)&&!tg(r))return!1;return!0}return!1}(t)}function ng(t){if(ge(t instanceof be||t instanceof He,34018),t instanceof be)return t;if(t.filters.length===1)return ng(t.filters[0]);const e=t.filters.map(r=>ng(r));let n=He.create(e,t.op);return n=wh(n),ix(n)?n:(ge(n instanceof He,64498),ge(Ua(n),40251),ge(n.filters.length>1,57927),n.filters.reduce((r,i)=>G_(r,i)))}function G_(t,e){let n;return ge(t instanceof be||t instanceof He,38388),ge(e instanceof be||e instanceof He,25473),n=t instanceof be?e instanceof be?function(i,s){return He.create([i,s],"and")}(t,e):fI(t,e):e instanceof be?fI(e,t):function(i,s){if(ge(i.filters.length>0&&s.filters.length>0,48005),Ua(i)&&Ua(s))return EA(i,s.getFilters());const o=Hm(i)?i:s,a=Hm(i)?s:i,l=o.filters.map(u=>G_(u,a));return He.create(l,"or")}(t,e),wh(n)}function fI(t,e){if(Ua(e))return EA(e,t.getFilters());{const n=e.filters.map(r=>G_(t,r));return He.create(n,"or")}}function wh(t){if(ge(t instanceof be||t instanceof He,11850),t instanceof be)return t;const e=t.getFilters();if(e.length===1)return wh(e[0]);if(vA(t))return t;const n=e.map(i=>wh(i)),r=[];return n.forEach(i=>{i instanceof be?r.push(i):i instanceof He&&(i.op===t.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:He.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B4{constructor(){this.Cn=new z_}addToCollectionParentIndex(e,n){return this.Cn.add(n),q.resolve()}getCollectionParents(e,n){return q.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return q.resolve()}deleteFieldIndex(e,n){return q.resolve()}deleteAllFieldIndexes(e){return q.resolve()}createTargetIndexes(e,n){return q.resolve()}getDocumentsMatchingTarget(e,n){return q.resolve(null)}getIndexType(e,n){return q.resolve(0)}getFieldIndexes(e,n){return q.resolve([])}getNextCollectionGroupToUpdate(e){return q.resolve(null)}getMinOffset(e,n){return q.resolve(xn.min())}getMinOffsetFromCollectionGroup(e,n){return q.resolve(xn.min())}updateCollectionGroup(e,n,r){return q.resolve()}updateIndexEntries(e,n){return q.resolve()}}class z_{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Ke(Ge.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Ke(Ge.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pI="IndexedDbIndexManager",Xc=new Uint8Array(0);class q4{constructor(e,n){this.databaseId=n,this.vn=new z_,this.Fn=new oi(r=>po(r),(r,i)=>ec(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.vn.has(n)){const r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this.vn.add(n)});const s={collectionId:r,parent:Xt(i)};return mI(e).put(s)}return q.resolve()}getCollectionParents(e,n){const r=[],i=IDBKeyRange.bound([n,""],[$0(n),""],!1,!0);return mI(e).J(i).next(s=>{for(const o of s){if(o.collectionId!==n)break;r.push(Ar(o.parent))}return r})}addFieldIndex(e,n){const r=Rl(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(l=>[l.fieldPath.canonicalString(),l.kind])}}(n);delete i.indexId;const s=r.add(i);if(n.indexState){const o=qo(e);return s.next(a=>{o.put(oI(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){const r=Rl(e),i=qo(e),s=Bo(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=Rl(e),r=Bo(e),i=qo(e);return n.Z().next(()=>r.Z()).next(()=>i.Z())}createTargetIndexes(e,n){return q.forEach(this.Mn(n),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){const s=new hI(r).Dn();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,n){const r=Bo(e);let i=!0;const s=new Map;return q.forEach(this.Mn(n),o=>this.xn(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=Re();const a=[];return q.forEach(s,(l,u)=>{ee(pI,`Using index ${function(C){return`id=${C.indexId}|cg=${C.collectionGroup}|f=${C.fields.map(V=>`${V.fieldPath}:${V.kind}`).join(",")}`}(l)} to execute ${po(n)}`);const f=function(C,V){const F=Um(V);if(F===void 0)return null;for(const B of vh(C,F.fieldPath))switch(B.op){case"array-contains-any":return B.value.arrayValue.values||[];case"array-contains":return[B.value]}return null}(u,l),p=function(C,V){const F=new Map;for(const B of Bs(V))for(const T of vh(C,B.fieldPath))switch(T.op){case"==":case"in":F.set(B.fieldPath.canonicalString(),T.value);break;case"not-in":case"!=":return F.set(B.fieldPath.canonicalString(),T.value),Array.from(F.values())}return null}(u,l),g=function(C,V){const F=[];let B=!0;for(const T of Bs(V)){const w=T.kind===0?WE(C,T.fieldPath,C.startAt):KE(C,T.fieldPath,C.startAt);F.push(w.value),B&&(B=w.inclusive)}return new Fa(F,B)}(u,l),v=function(C,V){const F=[];let B=!0;for(const T of Bs(V)){const w=T.kind===0?KE(C,T.fieldPath,C.endAt):WE(C,T.fieldPath,C.endAt);F.push(w.value),B&&(B=w.inclusive)}return new Fa(F,B)}(u,l),E=this.On(l,u,g),R=this.On(l,u,v),M=this.Nn(l,u,p),A=this.Bn(l.indexId,f,E,g.inclusive,R,v.inclusive,M);return q.forEach(A,I=>r.Y(I,n.limit).next(C=>{C.forEach(V=>{const F=se.fromSegments(V.documentKey);o.has(F)||(o=o.add(F),a.push(F))})}))}).next(()=>a)}return q.resolve(null)})}Mn(e){let n=this.Fn.get(e);return n||(e.filters.length===0?n=[e]:n=O4(He.create(e.filters,"and")).map(r=>Km(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.Fn.set(e,n),n)}Bn(e,n,r,i,s,o,a){const l=(n!=null?n.length:1)*Math.max(r.length,s.length),u=l/(n!=null?n.length:1),f=[];for(let p=0;p<l;++p){const g=n?this.Ln(n[p/u]):Xc,v=this.kn(e,g,r[p%u],i),E=this.qn(e,g,s[p%u],o),R=a.map(M=>this.kn(e,g,M,!0));f.push(...this.createRange(v,E,R))}return f}kn(e,n,r,i){const s=new Hs(e,se.empty(),n,r);return i?s:s.An()}qn(e,n,r,i){const s=new Hs(e,se.empty(),n,r);return i?s.An():s}xn(e,n){const r=new hI(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(const a of s)r.yn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2;const i=this.Mn(n);return q.forEach(i,s=>this.xn(e,s).next(o=>{o?r!==0&&o.fields.length<function(l){let u=new Ke(dt.comparator),f=!1;for(const p of l.filters)for(const g of p.getFlattenedFilters())g.field.isKeyField()||(g.op==="array-contains"||g.op==="array-contains-any"?f=!0:u=u.add(g.field));for(const p of l.orderBy)p.field.isKeyField()||(u=u.add(p.field));return u.size+(f?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&i.length>1&&r===2?1:r)}Qn(e,n){const r=new xl;for(const i of Bs(e)){const s=n.data.field(i.fieldPath);if(s==null)return null;const o=r.Pn(i.kind);$s.Kt.Dt(s,o)}return r.un()}Ln(e){const n=new xl;return $s.Kt.Dt(e,n.Pn(0)),n.un()}$n(e,n){const r=new xl;return $s.Kt.Dt(Fu(this.databaseId,n),r.Pn(function(s){const o=Bs(s);return o.length===0?0:o[o.length-1].kind}(e))),r.un()}Nn(e,n,r){if(r===null)return[];let i=[];i.push(new xl);let s=0;for(const o of Bs(e)){const a=r[s++];for(const l of i)if(this.Un(n,o.fieldPath)&&Uu(a))i=this.Kn(i,o,a);else{const u=l.Pn(o.kind);$s.Kt.Dt(a,u)}}return this.Wn(i)}On(e,n,r){return this.Nn(e,n,r.position)}Wn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].un();return n}Kn(e,n,r){const i=[...e],s=[];for(const o of r.arrayValue.values||[])for(const a of i){const l=new xl;l.seed(a.un()),$s.Kt.Dt(o,l.Pn(n.kind)),s.push(l)}return s}Un(e,n){return!!e.filters.find(r=>r instanceof be&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=Rl(e),i=qo(e);return(n?r.J(Bm,IDBKeyRange.bound(n,n)):r.J()).next(s=>{const o=[];return q.forEach(s,a=>i.get([a.indexId,this.uid]).next(l=>{o.push(function(f,p){const g=p?new ku(p.sequenceNumber,new xn(go(p.readTime),new se(Ar(p.documentKey)),p.largestBatchId)):ku.empty(),v=f.fields.map(([E,R])=>new Ed(dt.fromServerFormat(E),R));return new hh(f.indexId,f.collectionGroup,v,g)}(a,l))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:we(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const i=Rl(e),s=qo(e);return this.Gn(e).next(o=>i.J(Bm,IDBKeyRange.bound(n,n)).next(a=>q.forEach(a,l=>s.put(oI(l.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){const r=new Map;return q.forEach(n,(i,s)=>{const o=r.get(i.collectionGroup);return(o?q.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),q.forEach(a,l=>this.zn(e,i,l).next(u=>{const f=this.jn(s,l);return u.isEqual(f)?q.resolve():this.Jn(e,s,l,u,f)}))))})}Hn(e,n,r,i){return Bo(e).put(i.Rn(this.uid,this.$n(r,n.key),n.key))}Yn(e,n,r,i){return Bo(e).delete(i.Vn(this.uid,this.$n(r,n.key),n.key))}zn(e,n,r){const i=Bo(e);let s=new Ke(Ti);return i.ee({index:nA,range:IDBKeyRange.only([r.indexId,this.uid,Pd(this.$n(r,n))])},(o,a)=>{s=s.add(new Hs(r.indexId,n,dI(a.arrayValue),dI(a.directionalValue)))}).next(()=>s)}jn(e,n){let r=new Ke(Ti);const i=this.Qn(n,e);if(i==null)return r;const s=Um(n);if(s!=null){const o=e.data.field(s.fieldPath);if(Uu(o))for(const a of o.arrayValue.values||[])r=r.add(new Hs(n.indexId,e.key,this.Ln(a),i))}else r=r.add(new Hs(n.indexId,e.key,Xc,i));return r}Jn(e,n,r,i,s){ee(pI,"Updating index entries for document '%s'",n.key);const o=[];return function(l,u,f,p,g){const v=l.getIterator(),E=u.getIterator();let R=Uo(v),M=Uo(E);for(;R||M;){let A=!1,I=!1;if(R&&M){const C=f(R,M);C<0?I=!0:C>0&&(A=!0)}else R!=null?I=!0:A=!0;A?(p(M),M=Uo(E)):I?(g(R),R=Uo(v)):(R=Uo(v),M=Uo(E))}}(i,s,Ti,a=>{o.push(this.Hn(e,n,r,a))},a=>{o.push(this.Yn(e,n,r,a))}),q.waitFor(o)}Gn(e){let n=1;return qo(e).ee({index:tA,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>Ti(o,a)).filter((o,a,l)=>!a||Ti(o,l[a-1])!==0);const i=[];i.push(e);for(const o of r){const a=Ti(o,e),l=Ti(o,n);if(a===0)i[0]=e.An();else if(a>0&&l<0)i.push(o),i.push(o.An());else if(l>0)break}i.push(n);const s=[];for(let o=0;o<i.length;o+=2){if(this.Zn(i[o],i[o+1]))return[];const a=i[o].Vn(this.uid,Xc,se.empty()),l=i[o+1].Vn(this.uid,Xc,se.empty());s.push(IDBKeyRange.bound(a,l))}return s}Zn(e,n){return Ti(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(gI)}getMinOffset(e,n){return q.mapArray(this.Mn(n),r=>this.xn(e,r).next(i=>i||de(44426))).next(gI)}}function mI(t){return kt(t,Mu)}function Bo(t){return kt(t,ru)}function Rl(t){return kt(t,P_)}function qo(t){return kt(t,nu)}function gI(t){ge(t.length!==0,28825);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const i=t[r].indexState.offset;A_(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new xn(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _I={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},sx=41943040;class jt{static withCacheSize(e){return new jt(e,jt.DEFAULT_COLLECTION_PERCENTILE,jt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ox(t,e,n){const r=t.store(tr),i=t.store(Na),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const l=r.ee({range:o},(f,p,g)=>(a++,g.delete()));s.push(l.next(()=>{ge(a===1,47070,{batchId:n.batchId})}));const u=[];for(const f of n.mutations){const p=X0(e,f.key.path,n.batchId);s.push(i.delete(p)),u.push(f.key)}return q.waitFor(s).next(()=>u)}function Sh(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw de(14731);e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */jt.DEFAULT_COLLECTION_PERCENTILE=10,jt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,jt.DEFAULT=new jt(sx,jt.DEFAULT_COLLECTION_PERCENTILE,jt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),jt.DISABLED=new jt(-1,0,0);class gf{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Xn={}}static wt(e,n,r,i){ge(e.uid!=="",64387);const s=e.isAuthenticated()?e.uid:"";return new gf(s,n,r,i)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ei(e).ee({index:Qs,range:r},(i,s,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,i){const s=Ko(e),o=Ei(e);return o.add({}).next(a=>{ge(typeof a=="number",49019);const l=new F_(a,n,r,i),u=function(v,E,R){const M=R.baseMutations.map(I=>Eh(v.yt,I)),A=R.mutations.map(I=>Eh(v.yt,I));return{userId:E,batchId:R.batchId,localWriteTimeMs:R.localWriteTime.toMillis(),baseMutations:M,mutations:A}}(this.serializer,this.userId,l),f=[];let p=new Ke((g,v)=>we(g.canonicalString(),v.canonicalString()));for(const g of i){const v=X0(this.userId,g.key.path,a);p=p.add(g.key.path.popLast()),f.push(o.put(u)),f.push(s.put(v,gU))}return p.forEach(g=>{f.push(this.indexManager.addToCollectionParentIndex(e,g))}),e.addOnCommittedListener(()=>{this.Xn[a]=l.keys()}),q.waitFor(f).next(()=>l)})}lookupMutationBatch(e,n){return Ei(e).get(n).next(r=>r?(ge(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:n}),zs(this.serializer,r)):null)}er(e,n){return this.Xn[n]?q.resolve(this.Xn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const i=r.keys();return this.Xn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return Ei(e).ee({index:Qs,range:i},(o,a,l)=>{a.userId===this.userId&&(ge(a.batchId>=r,47524,{tr:r}),s=zs(this.serializer,a)),l.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=eo;return Ei(e).ee({index:Qs,range:n,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,eo],[this.userId,Number.POSITIVE_INFINITY]);return Ei(e).J(Qs,n).next(r=>r.map(i=>zs(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=Id(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return Ko(e).ee({range:i},(o,a,l)=>{const[u,f,p]=o,g=Ar(f);if(u===this.userId&&n.path.isEqual(g))return Ei(e).get(p).next(v=>{if(!v)throw de(61480,{nr:o,batchId:p});ge(v.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:v.userId,batchId:p}),s.push(zs(this.serializer,v))});l.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ke(we);const i=[];return n.forEach(s=>{const o=Id(this.userId,s.path),a=IDBKeyRange.lowerBound(o),l=Ko(e).ee({range:a},(u,f,p)=>{const[g,v,E]=u,R=Ar(v);g===this.userId&&s.path.isEqual(R)?r=r.add(E):p.done()});i.push(l)}),q.waitFor(i).next(()=>this.rr(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1,s=Id(this.userId,r),o=IDBKeyRange.lowerBound(s);let a=new Ke(we);return Ko(e).ee({range:o},(l,u,f)=>{const[p,g,v]=l,E=Ar(g);p===this.userId&&r.isPrefixOf(E)?E.length===i&&(a=a.add(v)):f.done()}).next(()=>this.rr(e,a))}rr(e,n){const r=[],i=[];return n.forEach(s=>{i.push(Ei(e).get(s).next(o=>{if(o===null)throw de(35274,{batchId:s});ge(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:s}),r.push(zs(this.serializer,o))}))}),q.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return ox(e.le,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.ir(n.batchId)}),q.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return q.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return Ko(e).ee({range:r},(s,o,a)=>{if(s[0]===this.userId){const l=Ar(s[1]);i.push(l)}else a.done()}).next(()=>{ge(i.length===0,56720,{sr:i.map(s=>s.canonicalString())})})})}containsKey(e,n){return ax(e,this.userId,n)}_r(e){return lx(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:eo,lastStreamToken:""})}}function ax(t,e,n){const r=Id(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return Ko(t).ee({range:s,X:!0},(a,l,u)=>{const[f,p,g]=a;f===e&&p===i&&(o=!0),u.done()}).next(()=>o)}function Ei(t){return kt(t,tr)}function Ko(t){return kt(t,Na)}function lx(t){return kt(t,Du)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _o{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new _o(0)}static cr(){return new _o(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G4{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.lr(e).next(n=>{const r=new _o(n.highestTargetId);return n.highestTargetId=r.next(),this.hr(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.lr(e).next(n=>_e.fromTimestamp(new $e(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.lr(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.lr(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.hr(e,i)))}addTargetData(e,n){return this.Pr(e,n).next(()=>this.lr(e).next(r=>(r.targetCount+=1,this.Tr(n,r),this.hr(e,r))))}updateTargetData(e,n){return this.Pr(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>Go(e).delete(n.targetId)).next(()=>this.lr(e)).next(r=>(ge(r.targetCount>0,8065),r.targetCount-=1,this.hr(e,r)))}removeTargets(e,n,r){let i=0;const s=[];return Go(e).ee((o,a)=>{const l=Ol(a);l.sequenceNumber<=n&&r.get(l.targetId)===null&&(i++,s.push(this.removeTargetData(e,l)))}).next(()=>q.waitFor(s)).next(()=>i)}forEachTarget(e,n){return Go(e).ee((r,i)=>{const s=Ol(i);n(s)})}lr(e){return yI(e).get(mh).next(n=>(ge(n!==null,2888),n))}hr(e,n){return yI(e).put(mh,n)}Pr(e,n){return Go(e).put(tx(this.serializer,n))}Tr(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next(n=>n.targetCount)}getTargetData(e,n){const r=po(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return Go(e).ee({range:i,index:eA},(o,a,l)=>{const u=Ol(a);ec(n,u.target)&&(s=u,l.done())}).next(()=>s)}addMatchingKeys(e,n,r){const i=[],s=Di(e);return n.forEach(o=>{const a=Xt(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),q.waitFor(i)}removeMatchingKeys(e,n,r){const i=Di(e);return q.forEach(n,s=>{const o=Xt(s.path);return q.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){const r=Di(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),i=Di(e);let s=Re();return i.ee({range:r,X:!0},(o,a,l)=>{const u=Ar(o[1]),f=new se(u);s=s.add(f)}).next(()=>s)}containsKey(e,n){const r=Xt(n.path),i=IDBKeyRange.bound([r],[$0(r)],!1,!0);let s=0;return Di(e).ee({index:R_,X:!0,range:i},([o,a],l,u)=>{o!==0&&(s++,u.done())}).next(()=>s>0)}At(e,n){return Go(e).get(n).next(r=>r?Ol(r):null)}}function Go(t){return kt(t,Da)}function yI(t){return kt(t,to)}function Di(t){return kt(t,ba)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vI="LruGarbageCollector",z4=1048576;function TI([t,e],[n,r]){const i=we(t,n);return i===0?we(e,r):i}class $4{constructor(e){this.Ir=e,this.buffer=new Ke(TI),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();TI(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class ux{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){ee(vI,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){cs(n)?ee(vI,"Ignoring IndexedDB error during garbage collection: ",n):await Io(n)}await this.Vr(3e5)})}}class H4{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return q.resolve(Bn.ce);const r=new $4(n);return this.mr.forEachTarget(e,i=>r.Ar(i.sequenceNumber)).next(()=>this.mr.pr(e,i=>r.Ar(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.mr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(ee("LruGarbageCollector","Garbage collection skipped; disabled"),q.resolve(_I)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(ee("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),_I):this.yr(e,n))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let r,i,s,o,a,l,u;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(p=>(p>this.params.maximumSequenceNumbersToCollect?(ee("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),i=this.params.maximumSequenceNumbersToCollect):i=p,o=Date.now(),this.nthSequenceNumber(e,i))).next(p=>(r=p,a=Date.now(),this.removeTargets(e,r,n))).next(p=>(s=p,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(p=>(u=Date.now(),zo()<=De.DEBUG&&ee("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-f}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(l-a)+`ms
	Removed ${p} documents in `+(u-l)+`ms
Total Duration: ${u-f}ms`),q.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:p})))}}function cx(t,e){return new H4(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W4{constructor(e,n){this.db=e,this.garbageCollector=cx(this,n)}gr(e){const n=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}pr(e,n){return this.Sr(e,(r,i)=>n(i))}addReference(e,n,r){return Zc(e,r)}removeReference(e,n,r){return Zc(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return Zc(e,n)}br(e,n){return function(i,s){let o=!1;return lx(i).te(a=>ax(i,a,s).next(l=>(l&&(o=!0),q.resolve(!l)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Sr(e,(o,a)=>{if(a<=n){const l=this.br(e,o).next(u=>{if(!u)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,_e.min()),Di(e).delete(function(p){return[0,Xt(p.path)]}(o))))});i.push(l)}}).next(()=>q.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return Zc(e,n)}Sr(e,n){const r=Di(e);let i,s=Bn.ce;return r.ee({index:R_},([o,a],{path:l,sequenceNumber:u})=>{o===0?(s!==Bn.ce&&n(new se(Ar(i)),s),s=u,i=l):s=Bn.ce}).next(()=>{s!==Bn.ce&&n(new se(Ar(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Zc(t,e){return Di(t).put(function(r,i){return{targetId:0,path:Xt(r.path),sequenceNumber:i}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dx{constructor(){this.changes=new oi(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,vt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?q.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K4{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return Vs(e).put(r)}removeEntry(e,n,r){return Vs(e).delete(function(s,o){const a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Ih(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.Dr(e,r)))}getEntry(e,n){let r=vt.newInvalidDocument(n);return Vs(e).ee({index:wd,range:IDBKeyRange.only(Pl(n))},(i,s)=>{r=this.Cr(n,s)}).next(()=>r)}vr(e,n){let r={size:0,document:vt.newInvalidDocument(n)};return Vs(e).ee({index:wd,range:IDBKeyRange.only(Pl(n))},(i,s)=>{r={document:this.Cr(n,s),size:Sh(s)}}).next(()=>r)}getEntries(e,n){let r=Sn();return this.Fr(e,n,(i,s)=>{const o=this.Cr(i,s);r=r.insert(i,o)}).next(()=>r)}Mr(e,n){let r=Sn(),i=new ht(se.comparator);return this.Fr(e,n,(s,o)=>{const a=this.Cr(s,o);r=r.insert(s,a),i=i.insert(s,Sh(o))}).next(()=>({documents:r,Or:i}))}Fr(e,n,r){if(n.isEmpty())return q.resolve();let i=new Ke(wI);n.forEach(l=>i=i.add(l));const s=IDBKeyRange.bound(Pl(i.first()),Pl(i.last())),o=i.getIterator();let a=o.getNext();return Vs(e).ee({index:wd,range:s},(l,u,f)=>{const p=se.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;a&&wI(a,p)<0;)r(a,null),a=o.getNext();a&&a.isEqual(p)&&(r(a,u),a=o.hasNext()?o.getNext():null),a?f.j(Pl(a)):f.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,s){const o=n.path,a=[o.popLast().toArray(),o.lastSegment(),Ih(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Vs(e).J(IDBKeyRange.bound(a,l,!0)).next(u=>{s==null||s.incrementDocumentReadCount(u.length);let f=Sn();for(const p of u){const g=this.Cr(se.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);g.isFoundDocument()&&(rc(n,g)||i.has(g.key))&&(f=f.insert(g.key,g))}return f})}getAllFromCollectionGroup(e,n,r,i){let s=Sn();const o=II(n,r),a=II(n,xn.max());return Vs(e).ee({index:Z0,range:IDBKeyRange.bound(o,a,!0)},(l,u,f)=>{const p=this.Cr(se.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);s=s.insert(p.key,p),s.size===i&&f.done()}).next(()=>s)}newChangeBuffer(e){return new j4(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return EI(e).get(Om).next(n=>(ge(!!n,20021),n))}Dr(e,n){return EI(e).put(Om,n)}Cr(e,n){if(n){const r=D4(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(_e.min())))return r}return vt.newInvalidDocument(e)}}function hx(t){return new K4(t)}class j4 extends dx{constructor(e,n){super(),this.Nr=e,this.trackRemovals=n,this.Br=new oi(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const n=[];let r=0,i=new Ke((s,o)=>we(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const a=this.Br.get(s);if(n.push(this.Nr.removeEntry(e,s,a.readTime)),o.isValidDocument()){const l=iI(this.Nr.serializer,o);i=i.add(s.path.popLast());const u=Sh(l);r+=u-a.size,n.push(this.Nr.addEntry(e,s,l))}else if(r-=a.size,this.trackRemovals){const l=iI(this.Nr.serializer,o.convertToNoDocument(_e.min()));n.push(this.Nr.addEntry(e,s,l))}}),i.forEach(s=>{n.push(this.Nr.indexManager.addToCollectionParentIndex(e,s))}),n.push(this.Nr.updateMetadata(e,r)),q.waitFor(n)}getFromCache(e,n){return this.Nr.vr(e,n).next(r=>(this.Br.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.Nr.Mr(e,n).next(({documents:r,Or:i})=>(i.forEach((s,o)=>{this.Br.set(s,{size:o,readTime:r.get(s).readTime})}),r))}}function EI(t){return kt(t,bu)}function Vs(t){return kt(t,ph)}function Pl(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function II(t,e){const n=e.documentKey.path.toArray();return[t,Ih(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function wI(t,e){const n=t.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=we(n[s],r[s]),i)return i;return i=we(n.length,r.length),i||(i=we(n[n.length-2],r[r.length-2]),i||we(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J4{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fx{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&au(r.mutation,i,fn.empty(),$e.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Re()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Re()){const i=xr();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=Fl();return s.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=xr();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Re()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=Sn();const o=ou(),a=function(){return ou()}();return n.forEach((l,u)=>{const f=r.get(u.key);i.has(u.key)&&(f===void 0||f.mutation instanceof ai)?s=s.insert(u.key,u):f!==void 0?(o.set(u.key,f.mutation.getFieldMask()),au(f.mutation,u,f.mutation.getFieldMask(),$e.now())):o.set(u.key,fn.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((u,f)=>o.set(u,f)),n.forEach((u,f)=>a.set(u,new J4(f,o.get(u)??null))),a))}recalculateAndSaveOverlays(e,n){const r=ou();let i=new ht((o,a)=>o-a),s=Re();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const u=n.get(l);if(u===null)return;let f=r.get(l)||fn.empty();f=a.applyToLocalView(u,f),r.set(l,f);const p=(i.get(a.batchId)||Re()).add(l);i=i.insert(a.batchId,p)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),u=l.key,f=l.value,p=kA();f.forEach(g=>{if(!s.has(g)){const v=FA(n.get(g),r.get(g));v!==null&&p.set(g,v),s=s.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,p))}return q.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return se.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):CA(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):q.resolve(xr());let a=Pu,l=s;return o.next(u=>q.forEach(u,(f,p)=>(a<p.largestBatchId&&(a=p.largestBatchId),s.get(f)?q.resolve():this.remoteDocumentCache.getEntry(e,f).next(g=>{l=l.insert(f,g)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,l,u,Re())).next(f=>({batchId:a,changes:PA(f)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new se(n)).next(r=>{let i=Fl();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let o=Fl();return this.indexManager.getCollectionParents(e,s).next(a=>q.forEach(a,l=>{const u=function(p,g){return new tc(g,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(n,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,r,i).next(f=>{f.forEach((p,g)=>{o=o.insert(p,g)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((l,u)=>{const f=u.getKey();o.get(f)===null&&(o=o.insert(f,vt.newInvalidDocument(f)))});let a=Fl();return o.forEach((l,u)=>{const f=s.get(l);f!==void 0&&au(f.mutation,u,fn.empty(),$e.now()),rc(n,u)&&(a=a.insert(l,u))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q4{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return q.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:an(i.createTime)}}(n)),q.resolve()}getNamedQuery(e,n){return q.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,function(i){return{name:i.name,query:nx(i.bundledQuery),readTime:an(i.readTime)}}(n)),q.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y4{constructor(){this.overlays=new ht(se.comparator),this.qr=new Map}getOverlay(e,n){return q.resolve(this.overlays.get(n))}getOverlays(e,n){const r=xr();return q.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.St(e,n,s)}),q.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.qr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.qr.delete(r)),q.resolve()}getOverlaysForCollection(e,n,r){const i=xr(),s=n.length+1,o=new se(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,u=l.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return q.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new ht((u,f)=>u-f);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let f=s.get(u.largestBatchId);f===null&&(f=xr(),s=s.insert(u.largestBatchId,f)),f.set(u.getKey(),u)}}const a=xr(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((u,f)=>a.set(u,f)),!(a.size()>=i)););return q.resolve(a)}St(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new O_(n,r));let s=this.qr.get(n);s===void 0&&(s=Re(),this.qr.set(n,s)),this.qr.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X4{constructor(){this.sessionToken=Et.EMPTY_BYTE_STRING}getSessionToken(e){return q.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,q.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $_{constructor(){this.Qr=new Ke(Dt.$r),this.Ur=new Ke(Dt.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const r=new Dt(e,n);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Gr(new Dt(e,n))}zr(e,n){e.forEach(r=>this.removeReference(r,n))}jr(e){const n=new se(new Ge([])),r=new Dt(n,e),i=new Dt(n,e+1),s=[];return this.Ur.forEachInRange([r,i],o=>{this.Gr(o),s.push(o.key)}),s}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new se(new Ge([])),r=new Dt(n,e),i=new Dt(n,e+1);let s=Re();return this.Ur.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const n=new Dt(e,0),r=this.Qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Dt{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return se.comparator(e.key,n.key)||we(e.Yr,n.Yr)}static Kr(e,n){return we(e.Yr,n.Yr)||se.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z4{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new Ke(Dt.$r)}checkEmpty(e){return q.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new F_(s,n,r,i);this.mutationQueue.push(o);for(const a of i)this.Zr=this.Zr.add(new Dt(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return q.resolve(o)}lookupMutationBatch(e,n){return q.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.ei(r),s=i<0?0:i;return q.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return q.resolve(this.mutationQueue.length===0?eo:this.tr-1)}getAllMutationBatches(e){return q.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Dt(n,0),i=new Dt(n,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([r,i],o=>{const a=this.Xr(o.Yr);s.push(a)}),q.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ke(we);return n.forEach(i=>{const s=new Dt(i,0),o=new Dt(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,o],a=>{r=r.add(a.Yr)})}),q.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;se.isDocumentKey(s)||(s=s.child(""));const o=new Dt(new se(s),0);let a=new Ke(we);return this.Zr.forEachWhile(l=>{const u=l.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(a=a.add(l.Yr)),!0)},o),q.resolve(this.ti(a))}ti(e){const n=[];return e.forEach(r=>{const i=this.Xr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){ge(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return q.forEach(n.mutations,i=>{const s=new Dt(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,n){const r=new Dt(n,0),i=this.Zr.firstAfterOrEqual(r);return q.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,q.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eO{constructor(e){this.ri=e,this.docs=function(){return new ht(se.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.ri(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return q.resolve(r?r.document.mutableCopy():vt.newInvalidDocument(n))}getEntries(e,n){let r=Sn();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():vt.newInvalidDocument(i))}),q.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=Sn();const o=n.path,a=new se(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:u,value:{document:f}}=l.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||A_(j0(f),r)<=0||(i.has(f.key)||rc(n,f))&&(s=s.insert(f.key,f.mutableCopy()))}return q.resolve(s)}getAllFromCollectionGroup(e,n,r,i){de(9500)}ii(e,n){return q.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new tO(this)}getSize(e){return q.resolve(this.size)}}class tO extends dx{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)}),q.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nO{constructor(e){this.persistence=e,this.si=new oi(n=>po(n),ec),this.lastRemoteSnapshotVersion=_e.min(),this.highestTargetId=0,this.oi=0,this._i=new $_,this.targetCount=0,this.ai=_o.ur()}forEachTarget(e,n){return this.si.forEach((r,i)=>n(i)),q.resolve()}getLastRemoteSnapshotVersion(e){return q.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return q.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),q.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.oi&&(this.oi=n),q.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new _o(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,q.resolve()}updateTargetData(e,n){return this.Pr(n),q.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,q.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.si.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.si.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),q.waitFor(s).next(()=>i)}getTargetCount(e){return q.resolve(this.targetCount)}getTargetData(e,n){const r=this.si.get(n)||null;return q.resolve(r)}addMatchingKeys(e,n,r){return this._i.Wr(n,r),q.resolve()}removeMatchingKeys(e,n,r){this._i.zr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),q.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),q.resolve()}getMatchingKeysForTargetId(e,n){const r=this._i.Hr(n);return q.resolve(r)}containsKey(e,n){return q.resolve(this._i.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H_{constructor(e,n){this.ui={},this.overlays={},this.ci=new Bn(0),this.li=!1,this.li=!0,this.hi=new X4,this.referenceDelegate=e(this),this.Pi=new nO(this),this.indexManager=new B4,this.remoteDocumentCache=function(i){return new eO(i)}(r=>this.referenceDelegate.Ti(r)),this.serializer=new ex(n),this.Ii=new Q4(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new Y4,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ui[e.toKey()];return r||(r=new Z4(n,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,r){ee("MemoryPersistence","Starting transaction:",e);const i=new rO(this.ci.next());return this.referenceDelegate.Ei(),r(i).next(s=>this.referenceDelegate.di(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ai(e,n){return q.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,n)))}}class rO extends Q0{constructor(e){super(),this.currentSequenceNumber=e}}class _f{constructor(e){this.persistence=e,this.Ri=new $_,this.Vi=null}static mi(e){return new _f(e)}get fi(){if(this.Vi)return this.Vi;throw de(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.fi.delete(r.toString()),q.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.fi.add(r.toString()),q.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),q.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach(i=>this.fi.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.fi.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return q.forEach(this.fi,r=>{const i=se.fromPath(r);return this.gi(e,i).next(s=>{s||n.removeEntry(i,_e.min())})}).next(()=>(this.Vi=null,n.apply(e)))}updateLimboDocument(e,n){return this.gi(e,n).next(r=>{r?this.fi.delete(n.toString()):this.fi.add(n.toString())})}Ti(e){return 0}gi(e,n){return q.or([()=>q.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class Ch{constructor(e,n){this.persistence=e,this.pi=new oi(r=>Xt(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=cx(this,n)}static mi(e,n){return new Ch(e,n)}Ei(){}di(e){return q.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}pr(e,n){return q.forEach(this.pi,(r,i)=>this.br(e,r,i).next(s=>s?q.resolve():n(i)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ii(e,o=>this.br(e,o,n).next(a=>{a||(r++,s.removeEntry(o,_e.min()))})).next(()=>s.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),q.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),q.resolve()}removeReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),q.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),q.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=Cd(e.data.value)),n}br(e,n,r){return q.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const i=this.pi.get(n);return q.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iO{constructor(e){this.serializer=e}k(e,n,r,i){const s=new nf("createOrUpgrade",n);r<1&&i>=1&&(function(l){l.createObjectStore(Zu)}(e),function(l){l.createObjectStore(Du,{keyPath:mU}),l.createObjectStore(tr,{keyPath:ME,autoIncrement:!0}).createIndex(Qs,VE,{unique:!0}),l.createObjectStore(Na)}(e),SI(e),function(l){l.createObjectStore(qs)}(e));let o=q.resolve();return r<3&&i>=3&&(r!==0&&(function(l){l.deleteObjectStore(ba),l.deleteObjectStore(Da),l.deleteObjectStore(to)}(e),SI(e)),o=o.next(()=>function(l){const u=l.store(to),f={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:_e.min().toTimestamp(),targetCount:0};return u.put(mh,f)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(l,u){return u.store(tr).J().next(p=>{l.deleteObjectStore(tr),l.createObjectStore(tr,{keyPath:ME,autoIncrement:!0}).createIndex(Qs,VE,{unique:!0});const g=u.store(tr),v=p.map(E=>g.put(E));return q.waitFor(v)})}(e,s))),o=o.next(()=>{(function(l){l.createObjectStore(Ma,{keyPath:SU})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.yi(s))),r<6&&i>=6&&(o=o.next(()=>(function(l){l.createObjectStore(bu)}(e),this.wi(s)))),r<7&&i>=7&&(o=o.next(()=>this.Si(s))),r<8&&i>=8&&(o=o.next(()=>this.bi(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.Di(s))),r<11&&i>=11&&(o=o.next(()=>{(function(l){l.createObjectStore(sf,{keyPath:CU})})(e),function(l){l.createObjectStore(of,{keyPath:AU})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(l){const u=l.createObjectStore(af,{keyPath:bU});u.createIndex(qm,MU,{unique:!1}),u.createIndex(rA,VU,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(l){const u=l.createObjectStore(ph,{keyPath:_U});u.createIndex(wd,yU),u.createIndex(Z0,vU)}(e)).next(()=>this.Ci(e,s)).next(()=>e.deleteObjectStore(qs))),r<14&&i>=14&&(o=o.next(()=>this.Fi(e,s))),r<15&&i>=15&&(o=o.next(()=>function(l){l.createObjectStore(P_,{keyPath:xU,autoIncrement:!0}).createIndex(Bm,RU,{unique:!1}),l.createObjectStore(nu,{keyPath:PU}).createIndex(tA,kU,{unique:!1}),l.createObjectStore(ru,{keyPath:NU}).createIndex(nA,DU,{unique:!1})}(e))),r<16&&i>=16&&(o=o.next(()=>{n.objectStore(nu).clear()}).next(()=>{n.objectStore(ru).clear()})),r<17&&i>=17&&(o=o.next(()=>{(function(l){l.createObjectStore(k_,{keyPath:LU})})(e)})),r<18&&i>=18&&JC()&&(o=o.next(()=>{n.objectStore(nu).clear()}).next(()=>{n.objectStore(ru).clear()})),o}wi(e){let n=0;return e.store(qs).ee((r,i)=>{n+=Sh(i)}).next(()=>{const r={byteSize:n};return e.store(bu).put(Om,r)})}yi(e){const n=e.store(Du),r=e.store(tr);return n.J().next(i=>q.forEach(i,s=>{const o=IDBKeyRange.bound([s.userId,eo],[s.userId,s.lastAcknowledgedBatchId]);return r.J(Qs,o).next(a=>q.forEach(a,l=>{ge(l.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:l.batchId});const u=zs(this.serializer,l);return ox(e,s.userId,u).next(()=>{})}))}))}Si(e){const n=e.store(ba),r=e.store(qs);return e.store(to).get(mh).next(i=>{const s=[];return r.ee((o,a)=>{const l=new Ge(o),u=function(p){return[0,Xt(p)]}(l);s.push(n.get(u).next(f=>f?q.resolve():(p=>n.put({targetId:0,path:Xt(p),sequenceNumber:i.highestListenSequenceNumber}))(l)))}).next(()=>q.waitFor(s))})}bi(e,n){e.createObjectStore(Mu,{keyPath:wU});const r=n.store(Mu),i=new z_,s=o=>{if(i.add(o)){const a=o.lastSegment(),l=o.popLast();return r.put({collectionId:a,parent:Xt(l)})}};return n.store(qs).ee({X:!0},(o,a)=>{const l=new Ge(o);return s(l.popLast())}).next(()=>n.store(Na).ee({X:!0},([o,a,l],u)=>{const f=Ar(a);return s(f.popLast())}))}Di(e){const n=e.store(Da);return n.ee((r,i)=>{const s=Ol(i),o=tx(this.serializer,s);return n.put(o)})}Ci(e,n){const r=n.store(qs),i=[];return r.ee((s,o)=>{const a=n.store(ph),l=function(p){return p.document?new se(Ge.fromString(p.document.name).popFirst(5)):p.noDocument?se.fromSegments(p.noDocument.path):p.unknownDocument?se.fromSegments(p.unknownDocument.path):de(36783)}(o).path.toArray(),u={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(u))}).next(()=>q.waitFor(i))}Fi(e,n){const r=n.store(tr),i=hx(this.serializer),s=new H_(_f.mi,this.serializer.yt);return r.J().next(o=>{const a=new Map;return o.forEach(l=>{let u=a.get(l.userId)??Re();zs(this.serializer,l).keys().forEach(f=>u=u.add(f)),a.set(l.userId,u)}),q.forEach(a,(l,u)=>{const f=new Ot(u),p=mf.wt(this.serializer,f),g=s.getIndexManager(f),v=gf.wt(f,this.serializer,g,s.referenceDelegate);return new fx(i,v,p,g).recalculateAndSaveOverlaysForDocumentKeys(new Gm(n,Bn.ce),l).next()})})}}function SI(t){t.createObjectStore(ba,{keyPath:EU}).createIndex(R_,IU,{unique:!0}),t.createObjectStore(Da,{keyPath:"targetId"}).createIndex(eA,TU,{unique:!0}),t.createObjectStore(to)}const Ii="IndexedDbPersistence",Tp=18e5,Ep=5e3,Ip="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",sO="main";class W_{constructor(e,n,r,i,s,o,a,l,u,f,p=18){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Mi=s,this.window=o,this.document=a,this.xi=u,this.Oi=f,this.Ni=p,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=g=>Promise.resolve(),!W_.v())throw new re(j.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new W4(this,i),this.$i=n+sO,this.serializer=new ex(l),this.Ui=new ji(this.$i,this.Ni,new iO(this.serializer)),this.hi=new M4,this.Pi=new G4(this.referenceDelegate,this.serializer),this.remoteDocumentCache=hx(this.serializer),this.Ii=new b4,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,f===!1&&nn(Ii,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new re(j.FAILED_PRECONDITION,Ip);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Pi.getHighestSequenceNumber(e))}).then(e=>{this.ci=new Bn(e,this.xi)}).then(()=>{this.li=!0}).catch(e=>(this.Ui&&this.Ui.close(),Promise.reject(e)))}Ji(e){return this.Qi=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget(async()=>{this.started&&await this.Wi()}))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>ed(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Hi(e).next(n=>{n||(this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)))})}).next(()=>this.Yi(e)).next(n=>this.isPrimary&&!n?this.Zi(e).next(()=>!1):!!n&&this.Xi(e).next(()=>!0))).catch(e=>{if(cs(e))return ee(Ii,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return ee(Ii,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable(()=>this.Qi(e)),this.isPrimary=e})}Hi(e){return kl(e).get(Fo).next(n=>q.resolve(this.es(n)))}ts(e){return ed(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,Tp)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=kt(n,Ma);return r.J().next(i=>{const s=this.ss(i,Tp),o=i.filter(a=>s.indexOf(a)===-1);return q.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Ki)for(const n of e)this.Ki.removeItem(this._s(n.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Wi().then(()=>this.ns()).then(()=>this.ji()))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?q.resolve(!0):kl(e).get(Fo).next(n=>{if(n!==null&&this.rs(n.leaseTimestampMs,Ep)&&!this.us(n.ownerId)){if(this.es(n)&&this.networkEnabled)return!0;if(!this.es(n)){if(!n.allowTabSynchronization)throw new re(j.FAILED_PRECONDITION,Ip);return!1}}return!(!this.networkEnabled||!this.inForeground)||ed(e).J().next(r=>this.ss(r,Ep).find(i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&ee(Ii,`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[Zu,Ma],e=>{const n=new Gm(e,Bn.ce);return this.Zi(n).next(()=>this.ts(n))}),this.Ui.close(),this.Ps()}ss(e,n){return e.filter(r=>this.rs(r.updateTimeMs,n)&&!this.us(r.clientId))}Ts(){return this.runTransaction("getActiveClients","readonly",e=>ed(e).J().next(n=>this.ss(n,Tp).map(r=>r.clientId)))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,n){return gf.wt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new q4(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return mf.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,n,r){ee(Ii,"Starting transaction:",e);const i=n==="readonly"?"readonly":"readwrite",s=function(l){return l===18?OU:l===17?aA:l===16?UU:l===15?N_:l===14?oA:l===13?sA:l===12?FU:l===11?iA:void de(60245)}(this.Ni);let o;return this.Ui.runTransaction(e,i,s,a=>(o=new Gm(a,this.ci?this.ci.next():Bn.ce),n==="readwrite-primary"?this.Hi(o).next(l=>!!l||this.Yi(o)).next(l=>{if(!l)throw nn(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)),new re(j.FAILED_PRECONDITION,J0);return r(o)}).next(l=>this.Xi(o).next(()=>l)):this.Is(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Is(e){return kl(e).get(Fo).next(n=>{if(n!==null&&this.rs(n.leaseTimestampMs,Ep)&&!this.us(n.ownerId)&&!this.es(n)&&!(this.Oi||this.allowTabSynchronization&&n.allowTabSynchronization))throw new re(j.FAILED_PRECONDITION,Ip)})}Xi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return kl(e).put(Fo,n)}static v(){return ji.v()}Zi(e){const n=kl(e);return n.get(Fo).next(r=>this.es(r)?(ee(Ii,"Releasing primary lease."),n.delete(Fo)):q.resolve())}rs(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(nn(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi()))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){var e;typeof((e=this.window)==null?void 0:e.addEventListener)=="function"&&(this.Bi=()=>{this.cs();const n=/(?:Version|Mobile)\/1[456]/;jC()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){var n;try{const r=((n=this.Ki)==null?void 0:n.getItem(this._s(e)))!==null;return ee(Ii,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return nn(Ii,"Failed to get zombied client id.",r),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){nn("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function kl(t){return kt(t,Zu)}function ed(t){return kt(t,Ma)}function oO(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K_{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.Es=r,this.ds=i}static As(e,n){let r=Re(),i=Re();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new K_(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aO{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class px{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return jC()?8:Y0(Rt())>0?6:4}()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.ys(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ws(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new aO;return this.Ss(e,n,o).next(a=>{if(s.result=a,this.Vs)return this.bs(e,n,o,a.size)})}).next(()=>s.result)}bs(e,n,r,i){return r.documentReadCount<this.fs?(zo()<=De.DEBUG&&ee("QueryEngine","SDK will not create cache indexes for query:",$o(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),q.resolve()):(zo()<=De.DEBUG&&ee("QueryEngine","Query:",$o(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?(zo()<=De.DEBUG&&ee("QueryEngine","The SDK decides to create cache indexes for query:",$o(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,zn(n))):q.resolve())}ys(e,n){if(jE(n))return q.resolve(null);let r=zn(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=Jm(n,null,"F"),r=zn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=Re(...s);return this.ps.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const u=this.Ds(n,a);return this.Cs(n,u,o,l.readTime)?this.ys(e,Jm(n,null,"F")):this.vs(e,u,n,l)}))})))}ws(e,n,r,i){return jE(n)||i.isEqual(_e.min())?q.resolve(null):this.ps.getDocuments(e,r).next(s=>{const o=this.Ds(n,s);return this.Cs(n,o,r,i)?q.resolve(null):(zo()<=De.DEBUG&&ee("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),$o(n)),this.vs(e,o,n,lU(i,Pu)).next(a=>a))})}Ds(e,n){let r=new Ke(xA(e));return n.forEach((i,s)=>{rc(e,s)&&(r=r.add(s))}),r}Cs(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ss(e,n,r){return zo()<=De.DEBUG&&ee("QueryEngine","Using full collection scan to execute query:",$o(n)),this.ps.getDocumentsMatchingQuery(e,n,xn.min(),r)}vs(e,n,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j_="LocalStore",lO=3e8;class uO{constructor(e,n,r,i){this.persistence=e,this.Fs=n,this.serializer=i,this.Ms=new ht(we),this.xs=new oi(s=>po(s),ec),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new fx(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ms))}}function mx(t,e,n,r){return new uO(t,e,n,r)}async function gx(t,e){const n=Se(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.Bs(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],a=[];let l=Re();for(const u of i){o.push(u.batchId);for(const f of u.mutations)l=l.add(f.key)}for(const u of s){a.push(u.batchId);for(const f of u.mutations)l=l.add(f.key)}return n.localDocuments.getDocuments(r,l).next(u=>({Ls:u,removedBatchIds:o,addedBatchIds:a}))})})}function cO(t,e){const n=Se(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.Ns.newChangeBuffer({trackRemovals:!0});return function(a,l,u,f){const p=u.batch,g=p.keys();let v=q.resolve();return g.forEach(E=>{v=v.next(()=>f.getEntry(l,E)).next(R=>{const M=u.docVersions.get(E);ge(M!==null,48541),R.version.compareTo(M)<0&&(p.applyToRemoteDocument(R,u),R.isValidDocument()&&(R.setReadTime(u.commitVersion),f.addEntry(R)))})}),v.next(()=>a.mutationQueue.removeMutationBatch(l,p))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=Re();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(l=l.add(a.batch.mutations[u].key));return l}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function _x(t){const e=Se(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Pi.getLastRemoteSnapshotVersion(n))}function dO(t,e){const n=Se(t),r=e.snapshotVersion;let i=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.Ns.newChangeBuffer({trackRemovals:!0});i=n.Ms;const a=[];e.targetChanges.forEach((f,p)=>{const g=i.get(p);if(!g)return;a.push(n.Pi.removeMatchingKeys(s,f.removedDocuments,p).next(()=>n.Pi.addMatchingKeys(s,f.addedDocuments,p)));let v=g.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(p)!==null?v=v.withResumeToken(Et.EMPTY_BYTE_STRING,_e.min()).withLastLimboFreeSnapshotVersion(_e.min()):f.resumeToken.approximateByteSize()>0&&(v=v.withResumeToken(f.resumeToken,r)),i=i.insert(p,v),function(R,M,A){return R.resumeToken.approximateByteSize()===0||M.snapshotVersion.toMicroseconds()-R.snapshotVersion.toMicroseconds()>=lO?!0:A.addedDocuments.size+A.modifiedDocuments.size+A.removedDocuments.size>0}(g,v,f)&&a.push(n.Pi.updateTargetData(s,v))});let l=Sn(),u=Re();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,f))}),a.push(hO(s,o,e.documentUpdates).next(f=>{l=f.ks,u=f.qs})),!r.isEqual(_e.min())){const f=n.Pi.getLastRemoteSnapshotVersion(s).next(p=>n.Pi.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(f)}return q.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,l,u)).next(()=>l)}).then(s=>(n.Ms=i,s))}function hO(t,e,n){let r=Re(),i=Re();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=Sn();return n.forEach((a,l)=>{const u=s.get(a);l.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(a)),l.isNoDocument()&&l.version.isEqual(_e.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):ee(j_,"Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",l.version)}),{ks:o,qs:i}})}function fO(t,e){const n=Se(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=eo),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function pO(t,e){const n=Se(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Pi.getTargetData(r,e).next(s=>s?(i=s,q.resolve(i)):n.Pi.allocateTargetId(r).next(o=>(i=new Wr(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Pi.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.Ms.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(r.targetId,r),n.xs.set(e,r.targetId)),r})}async function rg(t,e,n){const r=Se(t),i=r.Ms.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!cs(o))throw o;ee(j_,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(i.target)}function CI(t,e,n){const r=Se(t);let i=_e.min(),s=Re();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,u,f){const p=Se(l),g=p.xs.get(f);return g!==void 0?q.resolve(p.Ms.get(g)):p.Pi.getTargetData(u,f)}(r,o,zn(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,a.targetId).next(l=>{s=l})}).next(()=>r.Fs.getDocumentsMatchingQuery(o,e,n?i:_e.min(),n?s:Re())).next(a=>(mO(r,e4(e),a),{documents:a,Qs:s})))}function mO(t,e,n){let r=t.Os.get(e)||_e.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.Os.set(e,r)}class AI{constructor(){this.activeTargetIds=o4()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class yx{constructor(){this.Mo=new AI,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,r){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new AI,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gO{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xI="ConnectivityMonitor";class RI{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){ee(xI,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){ee(xI,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let td=null;function ig(){return td===null?td=function(){return 268435456+Math.round(2147483648*Math.random())}():td++,"0x"+td.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wp="RestConnection",_O={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class yO{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===gh?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,n,r,i,s){const o=ig(),a=this.zo(e,n.toUriEncodedString());ee(wp,`Sending RPC '${e}' ${o}:`,a,r);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,i,s);const{host:u}=new URL(a),f=Qa(u);return this.Jo(e,a,l,r,f).then(p=>(ee(wp,`Received RPC '${e}' ${o}: `,p),p),p=>{throw es(wp,`RPC '${e}' ${o} failed with error: `,p,"url: ",a,"request:",r),p})}Ho(e,n,r,i,s,o){return this.Go(e,n,r,i,s)}jo(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Za}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((i,s)=>e[s]=i),r&&r.headers.forEach((i,s)=>e[s]=i)}zo(e,n){const r=_O[e];return`${this.Uo}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vO{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kt="WebChannelConnection";class TO extends yO{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,i,s){const o=ig();return new Promise((a,l)=>{const u=new V0;u.setWithCredentials(!0),u.listenOnce(L0.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case Td.NO_ERROR:const p=u.getResponseJson();ee(Kt,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(p)),a(p);break;case Td.TIMEOUT:ee(Kt,`RPC '${e}' ${o} timed out`),l(new re(j.DEADLINE_EXCEEDED,"Request time out"));break;case Td.HTTP_ERROR:const g=u.getStatus();if(ee(Kt,`RPC '${e}' ${o} failed with status:`,g,"response text:",u.getResponseText()),g>0){let v=u.getResponseJson();Array.isArray(v)&&(v=v[0]);const E=v==null?void 0:v.error;if(E&&E.status&&E.message){const R=function(A){const I=A.toLowerCase().replace(/_/g,"-");return Object.values(j).indexOf(I)>=0?I:j.UNKNOWN}(E.status);l(new re(R,E.message))}else l(new re(j.UNKNOWN,"Server responded with status "+u.getStatus()))}else l(new re(j.UNAVAILABLE,"Connection failed."));break;default:de(9055,{l_:e,streamId:o,h_:u.getLastErrorCode(),P_:u.getLastError()})}}finally{ee(Kt,`RPC '${e}' ${o} completed.`)}});const f=JSON.stringify(i);ee(Kt,`RPC '${e}' ${o} sending request:`,i),u.send(n,"POST",f,r,15)})}T_(e,n,r){const i=ig(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=O0(),a=U0(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(l.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,n,r),l.encodeInitMessageHeaders=!0;const f=s.join("");ee(Kt,`Creating RPC '${e}' stream ${i}: ${f}`,l);const p=o.createWebChannel(f,l);this.I_(p);let g=!1,v=!1;const E=new vO({Yo:M=>{v?ee(Kt,`Not sending because RPC '${e}' stream ${i} is closed:`,M):(g||(ee(Kt,`Opening RPC '${e}' stream ${i} transport.`),p.open(),g=!0),ee(Kt,`RPC '${e}' stream ${i} sending:`,M),p.send(M))},Zo:()=>p.close()}),R=(M,A,I)=>{M.listen(A,C=>{try{I(C)}catch(V){setTimeout(()=>{throw V},0)}})};return R(p,Ll.EventType.OPEN,()=>{v||(ee(Kt,`RPC '${e}' stream ${i} transport opened.`),E.o_())}),R(p,Ll.EventType.CLOSE,()=>{v||(v=!0,ee(Kt,`RPC '${e}' stream ${i} transport closed`),E.a_(),this.E_(p))}),R(p,Ll.EventType.ERROR,M=>{v||(v=!0,es(Kt,`RPC '${e}' stream ${i} transport errored. Name:`,M.name,"Message:",M.message),E.a_(new re(j.UNAVAILABLE,"The operation could not be completed")))}),R(p,Ll.EventType.MESSAGE,M=>{var A;if(!v){const I=M.data[0];ge(!!I,16349);const C=I,V=(C==null?void 0:C.error)||((A=C[0])==null?void 0:A.error);if(V){ee(Kt,`RPC '${e}' stream ${i} received error:`,V);const F=V.status;let B=function(x){const k=It[x];if(k!==void 0)return BA(k)}(F),T=V.message;B===void 0&&(B=j.INTERNAL,T="Unknown error status: "+F+" with message "+V.message),v=!0,E.a_(new re(B,T)),p.close()}else ee(Kt,`RPC '${e}' stream ${i} received:`,I),E.u_(I)}}),R(a,F0.STAT_EVENT,M=>{M.stat===Lm.PROXY?ee(Kt,`RPC '${e}' stream ${i} detected buffering proxy`):M.stat===Lm.NOPROXY&&ee(Kt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{E.__()},0),E}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(n=>n===e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EO(){return typeof window<"u"?window:null}function kd(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yf(t){return new I4(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vx{constructor(e,n,r=1e3,i=1.5,s=6e4){this.Mi=e,this.timerId=n,this.d_=r,this.A_=i,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,n-r);i>0&&ee("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PI="PersistentStream";class Tx{constructor(e,n,r,i,s,o,a,l){this.Mi=e,this.S_=r,this.b_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new vx(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===j.RESOURCE_EXHAUSTED?(nn(n.toString()),nn("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===j.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.D_===n&&this.G_(r,i)},r=>{e(()=>{const i=new re(j.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)})})}G_(e,n){const r=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(i=>{r(()=>this.z_(i))}),this.stream.onMessage(i=>{r(()=>++this.F_==1?this.J_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return ee(PI,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget(()=>this.D_===e?n():(ee(PI,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class IO extends Tx{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=C4(this.serializer,e),r=function(s){if(!("targetChange"in s))return _e.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?_e.min():o.readTime?an(o.readTime):_e.min()}(e);return this.listener.H_(n,r)}Y_(e){const n={};n.database=Xm(this.serializer),n.addTarget=function(s,o){let a;const l=o.target;if(a=yh(l)?{documents:jA(s,l)}:{query:JA(s,l).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=zA(s,o.resumeToken);const u=Qm(s,o.expectedCount);u!==null&&(a.expectedCount=u)}else if(o.snapshotVersion.compareTo(_e.min())>0){a.readTime=Ga(s,o.snapshotVersion.toTimestamp());const u=Qm(s,o.expectedCount);u!==null&&(a.expectedCount=u)}return a}(this.serializer,e);const r=x4(this.serializer,e);r&&(n.labels=r),this.q_(n)}Z_(e){const n={};n.database=Xm(this.serializer),n.removeTarget=e,this.q_(n)}}class wO extends Tx{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return ge(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,ge(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){ge(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=A4(e.writeResults,e.commitTime),r=an(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=Xm(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>Eh(this.serializer,r))};this.q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SO{}class CO extends SO{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new re(j.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Go(e,Ym(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===j.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new re(j.UNKNOWN,s.toString())})}Ho(e,n,r,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Ho(e,Ym(n,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===j.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new re(j.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class AO{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(nn(n),this.aa=!1):ee("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yo="RemoteStore";class xO{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo(o=>{r.enqueueAndForget(async()=>{wo(this)&&(ee(yo,"Restarting streams for network reachability change."),await async function(l){const u=Se(l);u.Ea.add(4),await sc(u),u.Ra.set("Unknown"),u.Ea.delete(4),await vf(u)}(this))})}),this.Ra=new AO(r,i)}}async function vf(t){if(wo(t))for(const e of t.da)await e(!0)}async function sc(t){for(const e of t.da)await e(!1)}function Ex(t,e){const n=Se(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),X_(n)?Y_(n):tl(n).O_()&&Q_(n,e))}function J_(t,e){const n=Se(t),r=tl(n);n.Ia.delete(e),r.O_()&&Ix(n,e),n.Ia.size===0&&(r.O_()?r.L_():wo(n)&&n.Ra.set("Unknown"))}function Q_(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(_e.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}tl(t).Y_(e)}function Ix(t,e){t.Va.Ue(e),tl(t).Z_(e)}function Y_(t){t.Va=new y4({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),tl(t).start(),t.Ra.ua()}function X_(t){return wo(t)&&!tl(t).x_()&&t.Ia.size>0}function wo(t){return Se(t).Ea.size===0}function wx(t){t.Va=void 0}async function RO(t){t.Ra.set("Online")}async function PO(t){t.Ia.forEach((e,n)=>{Q_(t,e)})}async function kO(t,e){wx(t),X_(t)?(t.Ra.ha(e),Y_(t)):t.Ra.set("Unknown")}async function NO(t,e,n){if(t.Ra.set("Online"),e instanceof GA&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const a of s.targetIds)i.Ia.has(a)&&(await i.remoteSyncer.rejectListen(a,o),i.Ia.delete(a),i.Va.removeTarget(a))}(t,e)}catch(r){ee(yo,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Ah(t,r)}else if(e instanceof Rd?t.Va.Ze(e):e instanceof qA?t.Va.st(e):t.Va.tt(e),!n.isEqual(_e.min()))try{const r=await _x(t.localStore);n.compareTo(r)>=0&&await function(s,o){const a=s.Va.Tt(o);return a.targetChanges.forEach((l,u)=>{if(l.resumeToken.approximateByteSize()>0){const f=s.Ia.get(u);f&&s.Ia.set(u,f.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,u)=>{const f=s.Ia.get(l);if(!f)return;s.Ia.set(l,f.withResumeToken(Et.EMPTY_BYTE_STRING,f.snapshotVersion)),Ix(s,l);const p=new Wr(f.target,l,u,f.sequenceNumber);Q_(s,p)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){ee(yo,"Failed to raise snapshot:",r),await Ah(t,r)}}async function Ah(t,e,n){if(!cs(e))throw e;t.Ea.add(1),await sc(t),t.Ra.set("Offline"),n||(n=()=>_x(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{ee(yo,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await vf(t)})}function Sx(t,e){return e().catch(n=>Ah(t,n,e))}async function oc(t){const e=Se(t),n=is(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:eo;for(;DO(e);)try{const i=await fO(e.localStore,r);if(i===null){e.Ta.length===0&&n.L_();break}r=i.batchId,bO(e,i)}catch(i){await Ah(e,i)}Cx(e)&&Ax(e)}function DO(t){return wo(t)&&t.Ta.length<10}function bO(t,e){t.Ta.push(e);const n=is(t);n.O_()&&n.X_&&n.ea(e.mutations)}function Cx(t){return wo(t)&&!is(t).x_()&&t.Ta.length>0}function Ax(t){is(t).start()}async function MO(t){is(t).ra()}async function VO(t){const e=is(t);for(const n of t.Ta)e.ea(n.mutations)}async function LO(t,e,n){const r=t.Ta.shift(),i=U_.from(r,e,n);await Sx(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await oc(t)}async function FO(t,e){e&&is(t).X_&&await async function(r,i){if(function(o){return m4(o)&&o!==j.ABORTED}(i.code)){const s=r.Ta.shift();is(r).B_(),await Sx(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await oc(r)}}(t,e),Cx(t)&&Ax(t)}async function kI(t,e){const n=Se(t);n.asyncQueue.verifyOperationInProgress(),ee(yo,"RemoteStore received new credentials");const r=wo(n);n.Ea.add(3),await sc(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await vf(n)}async function UO(t,e){const n=Se(t);e?(n.Ea.delete(2),await vf(n)):e||(n.Ea.add(2),await sc(n),n.Ra.set("Unknown"))}function tl(t){return t.ma||(t.ma=function(n,r,i){const s=Se(n);return s.sa(),new IO(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Xo:RO.bind(null,t),t_:PO.bind(null,t),r_:kO.bind(null,t),H_:NO.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),X_(t)?Y_(t):t.Ra.set("Unknown")):(await t.ma.stop(),wx(t))})),t.ma}function is(t){return t.fa||(t.fa=function(n,r,i){const s=Se(n);return s.sa(),new wO(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:MO.bind(null,t),r_:FO.bind(null,t),ta:VO.bind(null,t),na:LO.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await oc(t)):(await t.fa.stop(),t.Ta.length>0&&(ee(yo,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z_{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Nr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const o=Date.now()+r,a=new Z_(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new re(j.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function ey(t,e){if(nn("AsyncQueue",`${e}: ${t}`),cs(t))return new re(j.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ta{static emptySet(e){return new Ta(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||se.comparator(n.key,r.key):(n,r)=>se.comparator(n.key,r.key),this.keyedMap=Fl(),this.sortedSet=new ht(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Ta)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Ta;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NI{constructor(){this.ga=new ht(se.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):de(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,r)=>{e.push(r)}),e}}class za{constructor(e,n,r,i,s,o,a,l,u){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,n,r,i,s){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new za(e,n,Ta.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&cf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OO{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class BO{constructor(){this.queries=DI(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const i=Se(n),s=i.queries;i.queries=DI(),s.forEach((o,a)=>{for(const l of a.Sa)l.onError(r)})})(this,new re(j.ABORTED,"Firestore shutting down"))}}function DI(){return new oi(t=>AA(t),cf)}async function ty(t,e){const n=Se(t);let r=3;const i=e.query;let s=n.queries.get(i);s?!s.ba()&&e.Da()&&(r=2):(s=new OO,r=e.Da()?0:1);try{switch(r){case 0:s.wa=await n.onListen(i,!0);break;case 1:s.wa=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(o){const a=ey(o,`Initialization of query '${$o(e.query)}' failed`);return void e.onError(a)}n.queries.set(i,s),s.Sa.push(e),e.va(n.onlineState),s.wa&&e.Fa(s.wa)&&ry(n)}async function ny(t,e){const n=Se(t),r=e.query;let i=3;const s=n.queries.get(r);if(s){const o=s.Sa.indexOf(e);o>=0&&(s.Sa.splice(o,1),s.Sa.length===0?i=e.Da()?0:1:!s.ba()&&e.Da()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function qO(t,e){const n=Se(t);let r=!1;for(const i of e){const s=i.query,o=n.queries.get(s);if(o){for(const a of o.Sa)a.Fa(i)&&(r=!0);o.wa=i}}r&&ry(n)}function GO(t,e,n){const r=Se(t),i=r.queries.get(e);if(i)for(const s of i.Sa)s.onError(n);r.queries.delete(e)}function ry(t){t.Ca.forEach(e=>{e.next()})}var sg,bI;(bI=sg||(sg={})).Ma="default",bI.Cache="cache";class iy{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new za(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=za.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==sg.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xx{constructor(e){this.key=e}}class Rx{constructor(e){this.key=e}}class zO{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Re(),this.mutatedKeys=Re(),this.eu=xA(e),this.tu=new Ta(this.eu)}get nu(){return this.Ya}ru(e,n){const r=n?n.iu:new NI,i=n?n.tu:this.tu;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((f,p)=>{const g=i.get(f),v=rc(this.query,p)?p:null,E=!!g&&this.mutatedKeys.has(g.key),R=!!v&&(v.hasLocalMutations||this.mutatedKeys.has(v.key)&&v.hasCommittedMutations);let M=!1;g&&v?g.data.isEqual(v.data)?E!==R&&(r.track({type:3,doc:v}),M=!0):this.su(g,v)||(r.track({type:2,doc:v}),M=!0,(l&&this.eu(v,l)>0||u&&this.eu(v,u)<0)&&(a=!0)):!g&&v?(r.track({type:0,doc:v}),M=!0):g&&!v&&(r.track({type:1,doc:g}),M=!0,(l||u)&&(a=!0)),M&&(v?(o=o.add(v),s=R?s.add(f):s.delete(f)):(o=o.delete(f),s=s.delete(f)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const f=this.query.limitType==="F"?o.last():o.first();o=o.delete(f.key),s=s.delete(f.key),r.track({type:1,doc:f})}return{tu:o,iu:r,Cs:a,mutatedKeys:s}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((f,p)=>function(v,E){const R=M=>{switch(M){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return de(20277,{Rt:M})}};return R(v)-R(E)}(f.type,p.type)||this.eu(f.doc,p.doc)),this.ou(r),i=i??!1;const a=n&&!i?this._u():[],l=this.Xa.size===0&&this.current&&!i?1:0,u=l!==this.Za;return this.Za=l,o.length!==0||u?{snapshot:new za(this.query,e.tu,s,o,e.mutatedKeys,l===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new NI,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Ya=this.Ya.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ya=this.Ya.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Re(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))});const n=[];return e.forEach(r=>{this.Xa.has(r)||n.push(new Rx(r))}),this.Xa.forEach(r=>{e.has(r)||n.push(new xx(r))}),n}cu(e){this.Ya=e.Qs,this.Xa=Re();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return za.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const sy="SyncEngine";class $O{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class HO{constructor(e){this.key=e,this.hu=!1}}class WO{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new oi(a=>AA(a),cf),this.Iu=new Map,this.Eu=new Set,this.du=new ht(se.comparator),this.Au=new Map,this.Ru=new $_,this.Vu={},this.mu=new Map,this.fu=_o.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function KO(t,e,n=!0){const r=Mx(t);let i;const s=r.Tu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await Px(r,e,n,!0),i}async function jO(t,e){const n=Mx(t);await Px(n,e,!0,!1)}async function Px(t,e,n,r){const i=await pO(t.localStore,zn(e)),s=i.targetId,o=t.sharedClientState.addLocalQueryTarget(s,n);let a;return r&&(a=await JO(t,e,s,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&Ex(t.remoteStore,i),a}async function JO(t,e,n,r,i){t.pu=(p,g,v)=>async function(R,M,A,I){let C=M.view.ru(A);C.Cs&&(C=await CI(R.localStore,M.query,!1).then(({documents:T})=>M.view.ru(T,C)));const V=I&&I.targetChanges.get(M.targetId),F=I&&I.targetMismatches.get(M.targetId)!=null,B=M.view.applyChanges(C,R.isPrimaryClient,V,F);return VI(R,M.targetId,B.au),B.snapshot}(t,p,g,v);const s=await CI(t.localStore,e,!0),o=new zO(e,s.Qs),a=o.ru(s.documents),l=ic.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),u=o.applyChanges(a,t.isPrimaryClient,l);VI(t,n,u.au);const f=new $O(e,n,o);return t.Tu.set(e,f),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),u.snapshot}async function QO(t,e,n){const r=Se(t),i=r.Tu.get(e),s=r.Iu.get(i.targetId);if(s.length>1)return r.Iu.set(i.targetId,s.filter(o=>!cf(o,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await rg(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&J_(r.remoteStore,i.targetId),og(r,i.targetId)}).catch(Io)):(og(r,i.targetId),await rg(r.localStore,i.targetId,!0))}async function YO(t,e){const n=Se(t),r=n.Tu.get(e),i=n.Iu.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),J_(n.remoteStore,r.targetId))}async function XO(t,e,n){const r=Vx(t);try{const i=await function(o,a){const l=Se(o),u=$e.now(),f=a.reduce((v,E)=>v.add(E.key),Re());let p,g;return l.persistence.runTransaction("Locally write mutations","readwrite",v=>{let E=Sn(),R=Re();return l.Ns.getEntries(v,f).next(M=>{E=M,E.forEach((A,I)=>{I.isValidDocument()||(R=R.add(A))})}).next(()=>l.localDocuments.getOverlayedDocuments(v,E)).next(M=>{p=M;const A=[];for(const I of a){const C=f4(I,p.get(I.key).overlayedDocument);C!=null&&A.push(new ai(I.key,C,_A(C.value.mapValue),rn.exists(!0)))}return l.mutationQueue.addMutationBatch(v,u,A,a)}).next(M=>{g=M;const A=M.applyToLocalDocumentSet(p,R);return l.documentOverlayCache.saveOverlays(v,M.batchId,A)})}).then(()=>({batchId:g.batchId,changes:PA(p)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,l){let u=o.Vu[o.currentUser.toKey()];u||(u=new ht(we)),u=u.insert(a,l),o.Vu[o.currentUser.toKey()]=u}(r,i.batchId,n),await ac(r,i.changes),await oc(r.remoteStore)}catch(i){const s=ey(i,"Failed to persist write");n.reject(s)}}async function kx(t,e){const n=Se(t);try{const r=await dO(n.localStore,e);e.targetChanges.forEach((i,s)=>{const o=n.Au.get(s);o&&(ge(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.hu=!0:i.modifiedDocuments.size>0?ge(o.hu,14607):i.removedDocuments.size>0&&(ge(o.hu,42227),o.hu=!1))}),await ac(n,r,e)}catch(r){await Io(r)}}function MI(t,e,n){const r=Se(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Tu.forEach((s,o)=>{const a=o.view.va(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){const l=Se(o);l.onlineState=a;let u=!1;l.queries.forEach((f,p)=>{for(const g of p.Sa)g.va(a)&&(u=!0)}),u&&ry(l)}(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function ZO(t,e,n){const r=Se(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Au.get(e),s=i&&i.key;if(s){let o=new ht(se.comparator);o=o.insert(s,vt.newNoDocument(s,_e.min()));const a=Re().add(s),l=new pf(_e.min(),new Map,new ht(we),o,a);await kx(r,l),r.du=r.du.remove(s),r.Au.delete(e),oy(r)}else await rg(r.localStore,e,!1).then(()=>og(r,e,n)).catch(Io)}async function e3(t,e){const n=Se(t),r=e.batch.batchId;try{const i=await cO(n.localStore,e);Dx(n,r,null),Nx(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await ac(n,i)}catch(i){await Io(i)}}async function t3(t,e,n){const r=Se(t);try{const i=await function(o,a){const l=Se(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let f;return l.mutationQueue.lookupMutationBatch(u,a).next(p=>(ge(p!==null,37113),f=p.keys(),l.mutationQueue.removeMutationBatch(u,p))).next(()=>l.mutationQueue.performConsistencyCheck(u)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(u,f,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,f)).next(()=>l.localDocuments.getDocuments(u,f))})}(r.localStore,e);Dx(r,e,n),Nx(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await ac(r,i)}catch(i){await Io(i)}}function Nx(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function Dx(t,e,n){const r=Se(t);let i=r.Vu[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Vu[r.currentUser.toKey()]=i}}function og(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(r=>{t.Ru.containsKey(r)||bx(t,r)})}function bx(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(J_(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),oy(t))}function VI(t,e,n){for(const r of n)r instanceof xx?(t.Ru.addReference(r.key,e),n3(t,r)):r instanceof Rx?(ee(sy,"Document no longer in limbo: "+r.key),t.Ru.removeReference(r.key,e),t.Ru.containsKey(r.key)||bx(t,r.key)):de(19791,{wu:r})}function n3(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Eu.has(r)||(ee(sy,"New document in limbo: "+n),t.Eu.add(r),oy(t))}function oy(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new se(Ge.fromString(e)),r=t.fu.next();t.Au.set(r,new HO(n)),t.du=t.du.insert(n,r),Ex(t.remoteStore,new Wr(zn(nc(n.path)),r,"TargetPurposeLimboResolution",Bn.ce))}}async function ac(t,e,n){const r=Se(t),i=[],s=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((a,l)=>{o.push(r.pu(l,e,n).then(u=>{var f;if((u||n)&&r.isPrimaryClient){const p=u?!u.fromCache:(f=n==null?void 0:n.targetChanges.get(l.targetId))==null?void 0:f.current;r.sharedClientState.updateQueryState(l.targetId,p?"current":"not-current")}if(u){i.push(u);const p=K_.As(l.targetId,u);s.push(p)}}))}),await Promise.all(o),r.Pu.H_(i),await async function(l,u){const f=Se(l);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>q.forEach(u,g=>q.forEach(g.Es,v=>f.persistence.referenceDelegate.addReference(p,g.targetId,v)).next(()=>q.forEach(g.ds,v=>f.persistence.referenceDelegate.removeReference(p,g.targetId,v)))))}catch(p){if(!cs(p))throw p;ee(j_,"Failed to update sequence numbers: "+p)}for(const p of u){const g=p.targetId;if(!p.fromCache){const v=f.Ms.get(g),E=v.snapshotVersion,R=v.withLastLimboFreeSnapshotVersion(E);f.Ms=f.Ms.insert(g,R)}}}(r.localStore,s))}async function r3(t,e){const n=Se(t);if(!n.currentUser.isEqual(e)){ee(sy,"User change. New user:",e.toKey());const r=await gx(n.localStore,e);n.currentUser=e,function(s,o){s.mu.forEach(a=>{a.forEach(l=>{l.reject(new re(j.CANCELLED,o))})}),s.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await ac(n,r.Ls)}}function i3(t,e){const n=Se(t),r=n.Au.get(e);if(r&&r.hu)return Re().add(r.key);{let i=Re();const s=n.Iu.get(e);if(!s)return i;for(const o of s){const a=n.Tu.get(o);i=i.unionWith(a.view.nu)}return i}}function Mx(t){const e=Se(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=kx.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=i3.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=ZO.bind(null,e),e.Pu.H_=qO.bind(null,e.eventManager),e.Pu.yu=GO.bind(null,e.eventManager),e}function Vx(t){const e=Se(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=e3.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=t3.bind(null,e),e}class Bu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=yf(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return mx(this.persistence,new px,e.initialUser,this.serializer)}Cu(e){return new H_(_f.mi,this.serializer)}Du(e){return new yx}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Bu.provider={build:()=>new Bu};class s3 extends Bu{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){ge(this.persistence.referenceDelegate instanceof Ch,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new ux(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?jt.withCacheSize(this.cacheSizeBytes):jt.DEFAULT;return new H_(r=>Ch.mi(r,n),this.serializer)}}class o3 extends Bu{constructor(e,n,r){super(),this.xu=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await Vx(this.xu.syncEngine),await oc(this.xu.remoteStore),await this.persistence.Ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}vu(e){return mx(this.persistence,new px,e.initialUser,this.serializer)}Fu(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new ux(r,e.asyncQueue,n)}Mu(e,n){const r=new hU(n,this.persistence);return new dU(e.asyncQueue,r)}Cu(e){const n=oO(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?jt.withCacheSize(this.cacheSizeBytes):jt.DEFAULT;return new W_(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,EO(),kd(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new yx}}class xh{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>MI(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=r3.bind(null,this.syncEngine),await UO(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new BO}()}createDatastore(e){const n=yf(e.databaseInfo.databaseId),r=function(s){return new TO(s)}(e.databaseInfo);return function(s,o,a,l){return new CO(s,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,a){return new xO(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>MI(this.syncEngine,n,0),function(){return RI.v()?new RI:new gO}())}createSyncEngine(e,n){return function(i,s,o,a,l,u,f){const p=new WO(i,s,o,a,l,u);return f&&(p.gu=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(i){const s=Se(i);ee(yo,"RemoteStore shutting down."),s.Ea.add(5),await sc(s),s.Aa.shutdown(),s.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}xh.provider={build:()=>new xh};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ay{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):nn("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ss="FirestoreClient";class a3{constructor(e,n,r,i,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=Ot.UNAUTHENTICATED,this.clientId=ef.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{ee(ss,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(ee(ss,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Nr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=ey(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Sp(t,e){t.asyncQueue.verifyOperationInProgress(),ee(ss,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await gx(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function LI(t,e){t.asyncQueue.verifyOperationInProgress();const n=await l3(t);ee(ss,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>kI(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>kI(e.remoteStore,i)),t._onlineComponents=e}async function l3(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){ee(ss,"Using user provided OfflineComponentProvider");try{await Sp(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(i){return i.name==="FirebaseError"?i.code===j.FAILED_PRECONDITION||i.code===j.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;es("Error using user provided cache. Falling back to memory cache: "+n),await Sp(t,new Bu)}}else ee(ss,"Using default OfflineComponentProvider"),await Sp(t,new s3(void 0));return t._offlineComponents}async function Lx(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(ee(ss,"Using user provided OnlineComponentProvider"),await LI(t,t._uninitializedComponentsProvider._online)):(ee(ss,"Using default OnlineComponentProvider"),await LI(t,new xh))),t._onlineComponents}function u3(t){return Lx(t).then(e=>e.syncEngine)}async function Rh(t){const e=await Lx(t),n=e.eventManager;return n.onListen=KO.bind(null,e.syncEngine),n.onUnlisten=QO.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=jO.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=YO.bind(null,e.syncEngine),n}function c3(t,e,n={}){const r=new Nr;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,u){const f=new ay({next:g=>{f.Nu(),o.enqueueAndForget(()=>ny(s,p));const v=g.docs.has(a);!v&&g.fromCache?u.reject(new re(j.UNAVAILABLE,"Failed to get document because the client is offline.")):v&&g.fromCache&&l&&l.source==="server"?u.reject(new re(j.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(g)},error:g=>u.reject(g)}),p=new iy(nc(a.path),f,{includeMetadataChanges:!0,qa:!0});return ty(s,p)}(await Rh(t),t.asyncQueue,e,n,r)),r.promise}function d3(t,e,n={}){const r=new Nr;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,u){const f=new ay({next:g=>{f.Nu(),o.enqueueAndForget(()=>ny(s,p)),g.fromCache&&l.source==="server"?u.reject(new re(j.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(g)},error:g=>u.reject(g)}),p=new iy(a,f,{includeMetadataChanges:!0,qa:!0});return ty(s,p)}(await Rh(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fx(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FI=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ux="firestore.googleapis.com",UI=!0;class OI{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new re(j.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Ux,this.ssl=UI}else this.host=e.host,this.ssl=e.ssl??UI;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=sx;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<z4)throw new re(j.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}W0("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Fx(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new re(j.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new re(j.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new re(j.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Tf{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new OI({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new re(j.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new re(j.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new OI(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new z0;switch(r.type){case"firstParty":return new nU(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new re(j.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=FI.get(n);r&&(ee("ComponentProvider","Removing Datastore"),FI.delete(n),r.terminate())}(this),Promise.resolve()}}function Ox(t,e,n,r={}){var u;t=on(t,Tf);const i=Qa(e),s=t._getSettings(),o={...s,emulatorOptions:t._getEmulatorOptions()},a=`${e}:${n}`;i&&(HC(`https://${a}`),WC("Firestore",!0)),s.host!==Ux&&s.host!==a&&es("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...s,host:a,ssl:i,emulatorOptions:r};if(!co(l,o)&&(t._setSettings(l),r.mockUserToken)){let f,p;if(typeof r.mockUserToken=="string")f=r.mockUserToken,p=Ot.MOCK_USER;else{f=x2(r.mockUserToken,(u=t._app)==null?void 0:u.options.projectId);const g=r.mockUserToken.sub||r.mockUserToken.user_id;if(!g)throw new re(j.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");p=new Ot(g)}t._authCredentials=new ZF(new G0(f,p))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hs{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new hs(this.firestore,e,this._query)}}class pt{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new jr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new pt(this.firestore,e,this._key)}toJSON(){return{type:pt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(Xu(n,pt._jsonSchema))return new pt(e,r||null,new se(Ge.fromString(n.referencePath)))}}pt._jsonSchemaVersion="firestore/documentReference/1.0",pt._jsonSchema={type:St("string",pt._jsonSchemaVersion),referencePath:St("string")};class jr extends hs{constructor(e,n,r){super(e,n,nc(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new pt(this.firestore,null,new se(e))}withConverter(e){return new jr(this.firestore,e,this._path)}}function lt(t,e,...n){if(t=Pt(t),H0("collection","path",e),t instanceof Tf){const r=Ge.fromString(e,...n);return PE(r),new jr(t,null,r)}{if(!(t instanceof pt||t instanceof jr))throw new re(j.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ge.fromString(e,...n));return PE(r),new jr(t.firestore,null,r)}}function Ve(t,e,...n){if(t=Pt(t),arguments.length===1&&(e=ef.newId()),H0("doc","path",e),t instanceof Tf){const r=Ge.fromString(e,...n);return RE(r),new pt(t,null,new se(r))}{if(!(t instanceof pt||t instanceof jr))throw new re(j.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ge.fromString(e,...n));return RE(r),new pt(t.firestore,t instanceof jr?t.converter:null,new se(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BI="AsyncQueue";class qI{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new vx(this,"async_queue_retry"),this._c=()=>{const r=kd();r&&ee(BI,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=kd();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=kd();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new Nr;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!cs(e))throw e;ee(BI,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,nn("INTERNAL UNHANDLED ERROR: ",GI(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const i=Z_.createAndSchedule(this,e,n,r,s=>this.hc(s));return this.tc.push(i),i}uc(){this.nc&&de(47125,{Pc:GI(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function GI(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zI(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const i=n;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}class Mr extends Tf{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new qI,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new qI(e),this._firestoreClient=void 0,await e}}}function Bx(t,e){const n=typeof t=="object"?t:e0(),r=typeof t=="string"?t:gh,i=p_(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=C2("firestore");s&&Ox(i,...s)}return i}function lc(t){if(t._terminated)throw new re(j.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||qx(t),t._firestoreClient}function qx(t){var r,i,s;const e=t._freezeSettings(),n=function(a,l,u,f){return new qU(a,l,u,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,Fx(f.experimentalLongPollingOptions),f.useFetchStreams,f.isUsingEmulator)}(t._databaseId,((r=t._app)==null?void 0:r.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(i=e.localCache)!=null&&i._offlineComponentProvider&&((s=e.localCache)!=null&&s._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new a3(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(t._componentsProvider))}function Gx(t,e){es("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings();return h3(t,xh.provider,{build:r=>new o3(r,n.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}function h3(t,e,n){if((t=on(t,Mr))._firestoreClient||t._terminated)throw new re(j.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new re(j.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:n},qx(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class In{constructor(e){this._byteString=e}static fromBase64String(e){try{return new In(Et.fromBase64String(e))}catch(n){throw new re(j.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new In(Et.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:In._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Xu(e,In._jsonSchema))return In.fromBase64String(e.bytes)}}In._jsonSchemaVersion="firestore/bytes/1.0",In._jsonSchema={type:St("string",In._jsonSchemaVersion),bytes:St("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uc{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new re(j.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new dt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cc{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lr{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new re(j.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new re(j.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return we(this._lat,e._lat)||we(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:lr._jsonSchemaVersion}}static fromJSON(e){if(Xu(e,lr._jsonSchema))return new lr(e.latitude,e.longitude)}}lr._jsonSchemaVersion="firestore/geoPoint/1.0",lr._jsonSchema={type:St("string",lr._jsonSchemaVersion),latitude:St("number"),longitude:St("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ur{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}toJSON(){return{type:ur._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Xu(e,ur._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new ur(e.vectorValues);throw new re(j.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ur._jsonSchemaVersion="firestore/vectorValue/1.0",ur._jsonSchema={type:St("string",ur._jsonSchemaVersion),vectorValues:St("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f3=/^__.*__$/;class p3{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new ai(e,this.data,this.fieldMask,n,this.fieldTransforms):new el(e,this.data,n,this.fieldTransforms)}}class zx{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new ai(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function $x(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw de(40011,{Ac:t})}}class ly{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new ly({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var i;const n=(i=this.path)==null?void 0:i.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){var i;const n=(i=this.path)==null?void 0:i.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Ph(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if($x(this.Ac)&&f3.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class m3{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||yf(e)}Cc(e,n,r,i=!1){return new ly({Ac:e,methodName:n,Dc:r,path:dt.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function uy(t){const e=t._freezeSettings(),n=yf(t._databaseId);return new m3(t._databaseId,!!e.ignoreUndefinedProperties,n)}function g3(t,e,n,r,i,s={}){const o=t.Cc(s.merge||s.mergeFields?2:0,e,n,i);dy("Data must be an object, but it was:",o,r);const a=Hx(r,o);let l,u;if(s.merge)l=new fn(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const f=[];for(const p of s.mergeFields){const g=ag(e,p,n);if(!o.contains(g))throw new re(j.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);Kx(f,g)||f.push(g)}l=new fn(f),u=o.fieldTransforms.filter(p=>l.covers(p.field))}else l=null,u=o.fieldTransforms;return new p3(new Qt(a),l,u)}class Ef extends cc{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Ef}}class cy extends cc{_toFieldTransform(e){return new LA(e.path,new Oa)}isEqual(e){return e instanceof cy}}function _3(t,e,n,r){const i=t.Cc(1,e,n);dy("Data must be an object, but it was:",i,r);const s=[],o=Qt.empty();ds(r,(l,u)=>{const f=hy(e,l,n);u=Pt(u);const p=i.yc(f);if(u instanceof Ef)s.push(f);else{const g=dc(u,p);g!=null&&(s.push(f),o.set(f,g))}});const a=new fn(s);return new zx(o,a,i.fieldTransforms)}function y3(t,e,n,r,i,s){const o=t.Cc(1,e,n),a=[ag(e,r,n)],l=[i];if(s.length%2!=0)throw new re(j.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<s.length;g+=2)a.push(ag(e,s[g])),l.push(s[g+1]);const u=[],f=Qt.empty();for(let g=a.length-1;g>=0;--g)if(!Kx(u,a[g])){const v=a[g];let E=l[g];E=Pt(E);const R=o.yc(v);if(E instanceof Ef)u.push(v);else{const M=dc(E,R);M!=null&&(u.push(v),f.set(v,M))}}const p=new fn(u);return new zx(f,p,o.fieldTransforms)}function v3(t,e,n,r=!1){return dc(n,t.Cc(r?4:3,e))}function dc(t,e){if(Wx(t=Pt(t)))return dy("Unsupported field value:",e,t),Hx(t,e);if(t instanceof cc)return function(r,i){if(!$x(i.Ac))throw i.Sc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const a of r){let l=dc(a,i.wc(o));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=Pt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return a4(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=$e.fromDate(r);return{timestampValue:Ga(i.serializer,s)}}if(r instanceof $e){const s=new $e(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Ga(i.serializer,s)}}if(r instanceof lr)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof In)return{bytesValue:zA(i.serializer,r._byteString)};if(r instanceof pt){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:q_(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof ur)return function(o,a){return{mapValue:{fields:{[b_]:{stringValue:M_},[Va]:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw a.Sc("VectorValues must only contain numeric values.");return L_(a.serializer,u)})}}}}}}(r,i);throw i.Sc(`Unsupported field value: ${tf(r)}`)}(t,e)}function Hx(t,e){const n={};return lA(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ds(t,(r,i)=>{const s=dc(i,e.mc(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function Wx(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof $e||t instanceof lr||t instanceof In||t instanceof pt||t instanceof cc||t instanceof ur)}function dy(t,e,n){if(!Wx(n)||!K0(n)){const r=tf(n);throw r==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+r)}}function ag(t,e,n){if((e=Pt(e))instanceof uc)return e._internalPath;if(typeof e=="string")return hy(t,e);throw Ph("Field path arguments must be of type string or ",t,!1,void 0,n)}const T3=new RegExp("[~\\*/\\[\\]]");function hy(t,e,n){if(e.search(T3)>=0)throw Ph(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new uc(...e.split("."))._internalPath}catch{throw Ph(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Ph(t,e,n,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new re(j.INVALID_ARGUMENT,a+t+l)}function Kx(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jx{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new pt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new E3(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(fy("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class E3 extends jx{data(){return super.data()}}function fy(t,e){return typeof e=="string"?hy(t,e):e instanceof uc?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jx(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new re(j.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class py{}class Qx extends py{}function Bl(t,e,...n){let r=[];e instanceof py&&r.push(e),r=r.concat(n),function(s){const o=s.filter(l=>l instanceof If).length,a=s.filter(l=>l instanceof hc).length;if(o>1||o>0&&a>0)throw new re(j.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class hc extends Qx{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new hc(e,n,r)}_apply(e){const n=this._parse(e);return Yx(e._query,n),new hs(e.firestore,e.converter,jm(e._query,n))}_parse(e){const n=uy(e.firestore);return function(s,o,a,l,u,f,p){let g;if(u.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new re(j.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){HI(p,f);const E=[];for(const R of p)E.push($I(l,s,R));g={arrayValue:{values:E}}}else g=$I(l,s,p)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||HI(p,f),g=v3(a,o,p,f==="in"||f==="not-in");return be.create(u,f,g)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function ql(t,e,n){const r=e,i=fy("where",t);return hc._create(i,r,n)}class If extends py{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new If(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:He.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i;const a=s.getFlattenedFilters();for(const l of a)Yx(o,l),o=jm(o,l)}(e._query,n),new hs(e.firestore,e.converter,jm(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function $I(t,e,n){if(typeof(n=Pt(n))=="string"){if(n==="")throw new re(j.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!CA(e)&&n.indexOf("/")!==-1)throw new re(j.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Ge.fromString(n));if(!se.isDocumentKey(r))throw new re(j.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Fu(t,new se(r))}if(n instanceof pt)return Fu(t,n._key);throw new re(j.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${tf(n)}.`)}function HI(t,e){if(!Array.isArray(t)||t.length===0)throw new re(j.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Yx(t,e){const n=function(i,s){for(const o of i)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new re(j.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new re(j.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class Xx{convertValue(e,n="none"){switch(ns(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ut(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(ni(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw de(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return ds(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertVectorValue(e){var r,i,s;const n=(s=(i=(r=e.fields)==null?void 0:r[Va].arrayValue)==null?void 0:i.values)==null?void 0:s.map(o=>ut(o.doubleValue));return new ur(n)}convertGeoPoint(e){return new lr(ut(e.latitude),ut(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=lf(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Vu(e));default:return null}}convertTimestamp(e){const n=ti(e);return new $e(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Ge.fromString(e);ge(ZA(r),9688,{name:e});const i=new ts(r.get(1),r.get(3)),s=new se(r.popFirst(5));return i.isEqual(n)||nn(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I3(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class aa{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ji extends jx{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new lu(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(fy("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new re(j.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Ji._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}Ji._jsonSchemaVersion="firestore/documentSnapshot/1.0",Ji._jsonSchema={type:St("string",Ji._jsonSchemaVersion),bundleSource:St("string","DocumentSnapshot"),bundleName:St("string"),bundle:St("string")};class lu extends Ji{data(e={}){return super.data(e)}}class Qi{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new aa(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new lu(this._firestore,this._userDataWriter,r.key,r,new aa(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new re(j.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{const l=new lu(i._firestore,i._userDataWriter,a.doc.key,a.doc,new aa(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{const l=new lu(i._firestore,i._userDataWriter,a.doc.key,a.doc,new aa(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let u=-1,f=-1;return a.type!==0&&(u=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),f=o.indexOf(a.doc.key)),{type:w3(a.type),doc:l,oldIndex:u,newIndex:f}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new re(j.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Qi._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=ef.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],i=[];return this.docs.forEach(s=>{s._document!==null&&(n.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function w3(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return de(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lg(t){t=on(t,pt);const e=on(t.firestore,Mr);return c3(lc(e),t._key).then(n=>Zx(e,t,n))}Qi._jsonSchemaVersion="firestore/querySnapshot/1.0",Qi._jsonSchema={type:St("string",Qi._jsonSchemaVersion),bundleSource:St("string","QuerySnapshot"),bundleName:St("string"),bundle:St("string")};class my extends Xx{constructor(e){super(),this.firestore=e}convertBytes(e){return new In(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new pt(this.firestore,null,n)}}function wi(t){t=on(t,hs);const e=on(t.firestore,Mr),n=lc(e),r=new my(e);return Jx(t._query),d3(n,t._query).then(i=>new Qi(e,r,t,i))}function _t(t,e,n){t=on(t,pt);const r=on(t.firestore,Mr),i=I3(t.converter,e,n);return wf(r,[g3(uy(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,rn.none())])}function ug(t,e,n,...r){t=on(t,pt);const i=on(t.firestore,Mr),s=uy(i);let o;return o=typeof(e=Pt(e))=="string"||e instanceof uc?y3(s,"updateDoc",t._key,e,n,r):_3(s,"updateDoc",t._key,e),wf(i,[o.toMutation(t._key,rn.exists(!0))])}function Ft(t){return wf(on(t.firestore,Mr),[new ff(t._key,rn.none())])}function Ur(t,...e){var l,u,f;t=Pt(t);let n={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||zI(e[r])||(n=e[r++]);const i={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(zI(e[r])){const p=e[r];e[r]=(l=p.next)==null?void 0:l.bind(p),e[r+1]=(u=p.error)==null?void 0:u.bind(p),e[r+2]=(f=p.complete)==null?void 0:f.bind(p)}let s,o,a;if(t instanceof pt)o=on(t.firestore,Mr),a=nc(t._key.path),s={next:p=>{e[r]&&e[r](Zx(o,t,p))},error:e[r+1],complete:e[r+2]};else{const p=on(t,hs);o=on(p.firestore,Mr),a=p._query;const g=new my(o);s={next:v=>{e[r]&&e[r](new Qi(o,g,p,v))},error:e[r+1],complete:e[r+2]},Jx(t._query)}return function(g,v,E,R){const M=new ay(R),A=new iy(v,M,E);return g.asyncQueue.enqueueAndForget(async()=>ty(await Rh(g),A)),()=>{M.Nu(),g.asyncQueue.enqueueAndForget(async()=>ny(await Rh(g),A))}}(lc(o),a,i,s)}function wf(t,e){return function(r,i){const s=new Nr;return r.asyncQueue.enqueueAndForget(async()=>XO(await u3(r),i,s)),s.promise}(lc(t),e)}function Zx(t,e,n){const r=n.docs.get(e._key),i=new my(t);return new Ji(t,i,e._key,r,new aa(n.hasPendingWrites,n.fromCache),e.converter)}function S3(){return new cy("serverTimestamp")}(function(e,n=!0){(function(i){Za=i})(Ya),Ra(new ho("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),a=new Mr(new eU(r.getProvider("auth-internal")),new rU(o,r.getProvider("app-check-internal")),function(u,f){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new re(j.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ts(u.options.projectId,f)}(o,i),o);return s={useFetchStreams:n,...s},a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),Wi(SE,CE,e),Wi(SE,CE,"esm2020")})();const Ls=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:Xx,Bytes:In,CollectionReference:jr,DocumentReference:pt,DocumentSnapshot:Ji,FieldPath:uc,FieldValue:cc,Firestore:Mr,FirestoreError:re,GeoPoint:lr,Query:hs,QueryCompositeFilterConstraint:If,QueryConstraint:Qx,QueryDocumentSnapshot:lu,QueryFieldFilterConstraint:hc,QuerySnapshot:Qi,SnapshotMetadata:aa,Timestamp:$e,VectorValue:ur,_AutoId:ef,_ByteString:Et,_DatabaseId:ts,_DocumentKey:se,_EmptyAuthCredentialsProvider:z0,_FieldPath:dt,_cast:on,_logWarn:es,_validateIsNotUsedTogether:W0,collection:lt,connectFirestoreEmulator:Ox,deleteDoc:Ft,doc:Ve,enableIndexedDbPersistence:Gx,ensureFirestoreConfigured:lc,executeWrite:wf,getDoc:lg,getDocs:wi,getFirestore:Bx,onSnapshot:Ur,query:Bl,serverTimestamp:S3,setDoc:_t,setLogLevel:B0,updateDoc:ug,where:ql},Symbol.toStringTag,{value:"Module"}));B0("error");const C3={apiKey:"AIzaSyC1zhlBnbOxP_PCaHU6L-UsDOBRTjGgpfk",authDomain:"my-apss-da774.firebaseapp.com",projectId:"my-apss-da774",storageBucket:"my-apss-da774.firebasestorage.app",messagingSenderId:"528434940137",appId:"1:528434940137:web:56be66185a46f390b60878",measurementId:"G-WPGZGF4ZBG"},eR=ZC(C3),Si=YF(eR);UL(Si,S0).catch(t=>console.error("Persistence error:",t));const ro=new qr;ro.addScope("profile");ro.addScope("email");ro.setCustomParameters({prompt:"select_account",access_type:"offline"});if(typeof window<"u"){const t=navigator.userAgent.toLowerCase();t.includes("safari")&&!t.includes("chrome")&&!t.includes("firefox")&&ro.setCustomParameters({prompt:"consent"})}const pe=Bx(eR);Gx(pe).catch(t=>{t.code==="failed-precondition"?console.warn("Firestore: Multiple tabs open, persistence disabled"):t.code==="unimplemented"&&console.warn("Firestore: Browser does not support persistence")});const A3=({onClose:t,onCreate:e,t:n,defaultIsShared:r=!1,googleUser:i})=>{const[s,o]=z.useState(!1),[a,l]=z.useState(""),[u,f]=z.useState(r),[p,g]=z.useState(""),[v,E]=z.useState("editor"),[R,M]=z.useState([]),[A,I]=z.useState("");z.useEffect(()=>{const w=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=w}},[]);const C=()=>{o(!0),setTimeout(()=>{try{t&&t()}catch{}},320)},V=()=>{if(!a.trim()){I("폴더 이름을 입력하세요.");return}try{e&&e({name:a.trim(),isShared:u,collaborators:u?R:[]})}catch{}C()},F=n&&typeof n=="function"?n("folder_create_title"):"",B=F&&F!=="folder_create_title"?F:"새 폴더 만들기",T=m.jsx("div",{className:`alert-backdrop${s?" is-closing":""}`,onClick:C,children:m.jsxs("div",{className:`alert-modal modal-content-small${s?" is-closing":""}`,onClick:w=>w.stopPropagation(),children:[m.jsxs("div",{style:{padding:"18px 18px 12px"},children:[m.jsx("h3",{style:{margin:0,fontSize:"1.05rem",fontWeight:600},children:B}),m.jsx("p",{style:{margin:"8px 0 0",color:"var(--text-secondary-color)",fontSize:"0.9rem"},children:"폴더 이름을 입력하고 확인을 누르세요."})]}),m.jsxs("div",{style:{padding:"12px 18px 8px"},children:[m.jsx("input",{type:"text",value:a,onChange:w=>l(w.target.value),placeholder:"폴더 이름",className:"folder-create-input",autoFocus:!0,onKeyDown:w=>{w.key==="Enter"&&V()}}),A&&m.jsx("div",{style:{color:"var(--danger-color)",fontSize:"13px",marginTop:8},children:A})]}),m.jsxs("div",{className:"modal-buttons",style:{display:"flex",gap:8,padding:"12px 18px 18px"},children:[m.jsx("button",{onClick:C,className:"secondary",children:"취소"}),m.jsx("button",{onClick:V,className:"primary",children:"확인"})]})]})});return typeof document<"u"&&document.body?Pk.createPortal(T,document.body):T},WI=()=>{try{const t=localStorage.getItem("theme");return t==="dark"||t==="light"?t:window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}catch{return"light"}},Lt=t=>{try{return JSON.parse(JSON.stringify(t,(e,n)=>n===void 0?null:n))}catch{return t}},Cp=()=>typeof navigator<"u"?/Mobi|Android|iPhone|iPad|iPod/i.test(navigator.userAgent)||typeof window<"u"&&window.innerWidth<=600:!1,Nl=()=>{try{return window.matchMedia&&window.matchMedia("(display-mode: standalone)").matches||navigator.standalone===!0}catch{return!1}},tR=async()=>{if(!("Notification"in window))return!1;try{return await Notification.requestPermission()==="granted"}catch{return!1}},nR=async()=>{try{if(!("serviceWorker"in navigator)||!("PushManager"in window))return console.log("Push notifications not supported"),!1;const e=await(await navigator.serviceWorker.ready).pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:x3("BOEd9nQKXBj8LJXNM6LJt6Nua5MJMhF8cCQvMNJ-2NWoWsM0cGgNqDG3kNm-QMYbdMDYAXaJ55MFP_fPHqH7SFA")});return await R3(e),!0}catch(t){return console.error("Failed to subscribe to push notifications:",t),!1}},x3=t=>{const e="=".repeat((4-t.length%4)%4),n=(t+e).replace(/\-/g,"+").replace(/_/g,"/"),r=window.atob(n),i=new Uint8Array(r.length);for(let s=0;s<r.length;++s)i[s]=r.charCodeAt(s);return i},R3=async t=>{try{(await fetch("/api/subscribe",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({subscription:t.toJSON(),endpoint:t.endpoint})})).ok||console.error("Failed to send subscription to server")}catch(e){console.error("Error sending subscription to server:",e)}},P3=({onInstalled:t})=>{const[e,n]=z.useState(null),[r,i]=z.useState(!1),[s,o]=z.useState(!0);z.useEffect(()=>{const l=/iPad|iPhone|iPod/.test(navigator.userAgent);i(l);const u=f=>{f.preventDefault(),n(f)};return window.addEventListener("beforeinstallprompt",u),()=>{window.removeEventListener("beforeinstallprompt",u)}},[]);const a=async()=>{if(e){e.prompt();const l=await e.userChoice;try{if(l&&l.outcome==="accepted"){n(null),t&&t(),o(!1);try{localStorage.setItem("pwa-prompt-dismissed","installed")}catch{}}else{try{localStorage.setItem("pwa-prompt-dismissed",Date.now().toString())}catch{}o(!1)}}catch{}}};return s?m.jsx("div",{className:"modal-backdrop",style:{alignItems:"stretch",padding:0,backgroundColor:"rgba(0,0,0,0.95)"},children:m.jsxs("div",{className:"modal-content onboarding-modal install-prompt",onClick:l=>l.stopPropagation(),style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:[m.jsxs("div",{style:{textAlign:"center",padding:"24px"},className:"install-instructions",children:[m.jsx("div",{className:"install-icon","aria-hidden":!0,children:m.jsxs("svg",{width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[m.jsx("path",{d:"M16 6l4 4-4 4",stroke:"#0A0A0A",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),m.jsx("rect",{x:"2",y:"2",width:"20",height:"20",rx:"4",stroke:"#0A0A0A",strokeWidth:"1.5"})]})}),m.jsx("h2",{style:{color:"white",fontSize:"1.6rem",margin:"14px 0 6px",fontWeight:800},children:"아이콘을 탭하고,"}),m.jsx("p",{style:{color:"white",fontSize:"1.5rem",fontWeight:800,margin:0,paddingBottom:10},children:"'홈 화면에 추가'를 누르세요."}),m.jsx("div",{style:{height:18}}),m.jsx("h3",{style:{color:"rgba(255,255,255,0.95)",fontSize:"1.1rem",margin:"8px 0 6px"},children:"아이콘이 보이지 않나요?"}),m.jsx("p",{style:{color:"rgba(255,255,255,0.85)",margin:"0 8px 12px",lineHeight:1.4},children:"아이콘을 탭하면 찾을 수 있습니다."}),m.jsx("div",{className:"install-more-icon","aria-hidden":!0,children:m.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[m.jsx("circle",{cx:"12",cy:"12",r:"10",fill:"#ffffff",opacity:"0.95"}),m.jsx("circle",{cx:"7",cy:"12",r:"1.5",fill:"#0A0A0A"}),m.jsx("circle",{cx:"12",cy:"12",r:"1.5",fill:"#0A0A0A"}),m.jsx("circle",{cx:"17",cy:"12",r:"1.5",fill:"#0A0A0A"})]})})]}),m.jsx("div",{style:{width:"100%",padding:"20px",boxSizing:"border-box",display:"flex",justifyContent:"center",gap:12},children:e?m.jsxs(m.Fragment,{children:[m.jsx("button",{onClick:a,className:"primary",style:{padding:"14px 20px",borderRadius:12,background:"var(--primary-color)",color:"#fff",border:"none",fontSize:"1rem"},children:"지금 설치하기"}),m.jsx("div",{style:{width:"100%",display:"flex",justifyContent:"center",marginTop:10},children:m.jsx("span",{style:{color:"rgba(255,255,255,0.85)",fontSize:"0.95rem"},children:"아이콘을 탭한 뒤, 설치를 진행하세요."})})]}):m.jsx("div",{style:{color:"white",maxWidth:560,textAlign:"left"},children:m.jsxs("ol",{style:{paddingLeft:18,lineHeight:1.6},children:[m.jsx("li",{children:"공유(□↗) 버튼을 탭합니다."}),m.jsx("li",{children:'"홈 화면에 추가"를 선택합니다.'}),m.jsx("li",{children:"추가 버튼을 탭합니다."})]})})})]})}):null},k3={ko:{language_selection_title:"언어",error_wish_required:"목표를 입력해주세요.",error_outcome_required:"결과를 입력해주세요.",error_obstacle_required:"장애물을 입력해주세요.",error_plan_required:"If-Then 계획을 입력해주세요.",error_deadline_required:"마감일을 선택해주세요.",error_day_required:"하나 이상의 요일을 선택해주세요.",my_goals_title:"나의 목표",all_goals_label:"나의 목표",sort_label_manual:"사용자화",sort_label_deadline:"마감일순",sort_label_newest:"최신순",sort_label_alphabetical:"이름순",sort_label_ai:"우선순위로 정렬",ai_sorting_button:"정렬 중...",add_new_goal_button_label:"새로운 목표 추가",filter_all:"나의 목표",filter_active:"진행중",filter_completed:"완료됨",filter_category:"카테고리",category_all:"모든 카테고리",category_school:"학교",category_work:"회사",category_personal:"개인",category_other:"기타",category_label:"카테고리 선택",empty_message_all:"+ 버튼으로 목표를 추가해보세요",empty_message_active:"진행중인 목표가 없습니다.",empty_message_completed:"아직 완료된 목표가 없습니다.",empty_encouragement_1:"새로운 여정의 첫 걸음을 내딛어보세요.",empty_encouragement_2:"작은 변화가 큰 성취로 이어집니다.",empty_encouragement_3:"오늘 하는 일이 내일을 만듭니다.",empty_encouragement_4:"당신의 목표가 현실이 되는 순간을 만나보세요.",delete_button:"삭제",edit_button_aria:"편집",info_button_aria:"정보",filter_title:"필터",sort_title:"정렬",filter_sort_button_aria:"필터 및 정렬",calendar_view_button_aria:"달력 보기",list_view_button_aria:"목록 보기",more_options_button_aria:"더보기",select_button_label:"선택",cancel_selection_button_label:"취소",delete_selected_button_label:"{count}개 삭제",select_all_button_label:"전체선택",delete_selected_confirm_title:"목표 삭제",delete_selected_confirm_message:"선택한 {count}개의 목표가 영구적으로 삭제됩니다. 이 작업은 되돌릴 수 없습니다.",days_left:"{count}일 남음",d_day:"오늘",days_overdue:"{count}일 지남",month_names:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],day_names_short:["일","월","화","수","목","금","토"],day_names_long:["일요일","월요일","화요일","수요일","목요일","금요일","토요일"],calendar_header_month_format:"{year}년 {month}",calendar_view_day3:"3일",calendar_view_week:"주",calendar_view_month:"월",settings_title:"설정",sort_alert_title:"정렬 실패",sort_alert_message:"우선순위 정렬을 사용하려면<br/>2개 이상의 목표가 필요합니다.",ai_sort_error_title:"정렬 오류",ai_sort_error_message:"서버에 연결할 수 없습니다. 나중에 다시 시도해주세요.",confirm_button:"확인",new_goal_modal_title:"새로운 목표",edit_goal_modal_title:"목표 편집",wish_label:"목표",outcome_label:"최상의 결과",obstacle_label:"장애물",plan_label:"If-Then 계획",deadline_label:"마감일",cancel_button:"취소",add_button:"추가",save_button:"저장",goal_details_modal_title:"목표 상세 정보",ai_coach_suggestion:"요약보기",ai_analyzing:"분석 중...",close_button:"닫기",ai_sort_reason_modal_title:"AI 정렬 재안",ai_sort_criteria:"AI 정렬 기준",delete_account_final_confirm_title:"모든 데이터 및 설정 지우기",delete_account_final_confirm_message:"모든 목표와 데이터가 영구적으로 삭제되며, 이 작업은 되돌릴 수 없습니다.",delete_all_data_button:"모든 데이터 및 설정 지우기",settings_done_button:"완료",settings_section_data:"데이터 관리",settings_section_account:"Nova 2.0 계정",settings_sync_data:"지금 동기화",settings_load_data:"불러오기",settings_logout:"로그아웃",settings_export_data:"데이터 내보내기",settings_import_data:"데이터 가져오기",import_confirm_title:"데이터 가져오기",import_confirm_message:"현재 목표를 새로운 데이터로 교체합니다. 이 작업은 되돌릴 수 없습니다.",import_success_toast:"데이터를 성공적으로 가져왔습니다.",import_error_alert_title:"가져오기 실패",import_error_alert_message:"파일을 읽는 중 오류가 발생했거나 파일 형식이 올바르지 않습니다. 나중에 다시 시도히십시오.",settings_section_general:"일반",settings_section_info:"정보",settings_section_help:"사용방법",settings_theme_mode:"테마 모드",theme_mode_light:"라이트 모드",theme_mode_light_desc:"항상 밝은 테마 사용",theme_mode_dark:"다크 모드",theme_mode_dark_desc:"항상 어두운 테마 사용",theme_mode_system:"자동",theme_mode_system_desc:"기기의 설정에에 동기화 됩니다.",settings_dark_mode:"다크 모드",settings_language:"언어",settings_api_key:"Gemini AI 설정",settings_api_key_placeholder:"Gemini API 키 입력",settings_offline_mode:"오프라인 사용",settings_offline_mode_desc:"AI 기능 없이 기본 기능 사용",settings_notifications:"알림",settings_notifications_desc:"PWA 알림 설정",notification_settings_title:"어떤 알림을 받을까요?",reminder_add_title:"미리알림 추가",reminder_step_title:"{step}/5 단계",reminder_step1_title:"🔔 제목",reminder_step1_desc:"미리알림의 제목을 입력하세요",reminder_step2_title:"📅 기한 & ⏰ 시간",reminder_step2_desc:"기한 날짜와 시간을 설정하세요 (선택사항)",reminder_step2_date_toggle:"기한 설정",reminder_step2_time_toggle:"시간 설정",reminder_step3_title:"🔄 반복 설정",reminder_step3_desc:"반복 여부와 반복 주기를 선택하세요",reminder_step3_enable_recurring:"반복 설정",reminder_step4_title:"📝 설명",reminder_step4_desc:"추가 설명을 입력하세요 (선택사항)",reminder_step5_title:"✅ 활성화",reminder_step5_desc:"미리알림 활성화 여부를 선택하세요",reminder_next_button:"다음",reminder_back_button:"이전",reminder_submit_button:"추가",reminder_form_title:"제목",reminder_form_date:"기한",reminder_form_time:"시간",reminder_form_recurring:"반복",reminder_form_description:"설명",reminder_form_enabled:"활성화",recurring_type_none:"반복 없음",recurring_type_daily:"매일",recurring_type_weekly:"매주",recurring_type_monthly:"매월",notification_deadline:"마감일 임박 알림",notification_deadline_desc:"마감이 가까운 목표에 대해 알려줍니다.",notification_suggestion:"지금할일 제안",notification_suggestion_desc:"오늘 해야할 목표를 제안해줍니다.",notification_achievement:"목표 달성 축하",notification_achievement_desc:"목표를 달성했을 때 축하해줍니다.",notification_reminder:"일반 미리알림",notification_reminder_desc:"설정한 시간에 미리알림을 받습니다.",reminder_time_settings_title:"미리알림 시간 설정",reminder_start_time:"시작 시간",reminder_end_time:"종료 시간",language_name:"한국어 (대한민국)",language_modal_title:"언어",settings_section_background:"화면",settings_bg_default:"라이트",settings_bg_default_dark:"다크",settings_bg_pink:"핑크",settings_bg_cherry_noir:"다크 체리",settings_bg_blue:"블루",settings_bg_deep_ocean:"오션",settings_bg_green:"그린",settings_bg_forest_green:"포레스트 그린",settings_bg_purple:"퍼플",settings_bg_royal_purple:"딥 퍼플",settings_version:"버전",test_long_alert:"긴 알림 테스트",test_long_alert_desc:"긴 내용의 알림 팝업 테스트",folder_manage_title:"폴더 관리",folder_manage_info:"폴더 정보",folder_manage_collaborators:"협업자",folder_manage_settings:"설정",folder_name_edit:"폴더 이름 편집",folder_invite_new:"새 협업자 초대",folder_invite_email:"이메일 주소",folder_invite_role:"역할",folder_role_owner:"소유자",folder_role_editor:"편집자",folder_role_viewer:"뷰어",folder_invite_button:"초대하기",folder_leave:"폴더 나가기",folder_delete:"폴더 삭제",folder_share_link:"공유 링크",folder_share_link_desc:"이 링크로 다른 사용자를 초대할 수 있습니다",folder_copy_link:"링크 복사",folder_leave_confirm:"폴더에서 나가시겠습니까?",folder_delete_confirm:"폴더를 삭제하시겠습니까? 나의 목표로 이동됩니다.",settings_developer:"개발자",developer_name:"Kim Kyumin",settings_copyright:"저작권",copyright_notice:"© 2025 Kim Kyumin. All Rights Reserved.",build_number:"빌드 번호",settings_data_header:"데이터 관리",settings_data_header_desc:"목표 데이터를 파일로 내보내거나, 파일에서 가져옵니다.",settings_background_header:"배경화면",settings_background_header_desc:"앱의 배경화면 스타일을 변경하여 개성을 표현해 보세요.",data_importing:"가져오는 중...",data_exporting:"내보내는 중...",data_deleting:"삭제 중...",url_import_title:"URL에서 데이터 불러오기",url_import_message:"URL의 데이터로 현재 목표 목록을 병합하시겠습니까?",url_import_confirm:"불러오기",url_import_success:"URL에서 데이터를 성공적으로 가져왔습니다!",url_import_error:"URL의 데이터가 올바르지 않습니다.",settings_share_link_header:"링크로 공유",settings_generate_link:"공유 링크 생성",settings_copy_link:"복사",link_copied_toast:"링크가 클립보드에 복사되었습니다.",short_url_created:"📎 단축 URL이 생성되었습니다!",share_link_created:"🔗 공유 링크가 생성되었습니다!",short_url_failed:"⚠️ 단축 URL 생성에 실패하여 기본 링크를 사용합니다.",no_data_to_share:"공유할 목표가 없습니다.",usage_guide_tab:"사용방법",usage_guide_title:"사용 가이드",usage_basic_title:"목표 추가하기",usage_basic_desc:`1. 홈 화면에서 "목표 추가 및 편집" 버튼을 탭하세요.
2. 목표, 결과, 장애물, 계획을 차례로 입력하세요.
3. 마감일과 반복 요일을 선택하세요.
4. "저장" 버튼을 눌러 목표를 추가하세요.`,usage_ai_title:"Gemini AI 기능 사용하기",usage_ai_desc:`• 목표 작성 시 "요약보기" 버튼으로 Gemini AI의 개선된 목표를 받아보세요.
• 목표 목록에서 "우선순위 정렬" 버튼으로 중요도 순 정렬이 가능합니다.
• Gemini AI 분석을 통해 더 효과적인 목표 설정을 도와드립니다.

※ Gemini AI 기능 사용을 위해서는 API 키 설정이 필요합니다.`,usage_ai_setup_title:"Gemini AI 설정하기",usage_ai_setup_desc:`1. 설정 > 일반에서 "Gemini AI 설정" 항목을 찾으세요.
2. Google Gemini API 키를 입력하세요.
3. API 키 발급 방법은 다음 Google 지원 문서를 참조하세요:
   https://ai.google.dev/gemini-api/docs/api-key
4. 키 입력 후 Gemini AI 기능이 활성화됩니다.`,usage_share_title:"목표 공유하기",usage_share_desc:`1. 설정 > 공유에서 "목표 링크 생성" 버튼을 탭하세요.
2. 자동으로 생성된 단축 링크를 확인하세요.
3. "링크 복사" 버튼으로 클립보드에 복사하세요.
4. 메신저나 이메일로 링크를 공유하세요.`,usage_theme_title:"테마 변경하기",usage_theme_desc:`1. 설정 > 모양에서 다크 모드 토글을 사용하세요.
2. 배경 테마에서 원하는 색상을 선택하세요.
3. 기본, 핑크, 블루, 그린, 퍼플 테마 중 선택 가능합니다.
4. 변경 사항은 즉시 적용됩니다.`,usage_calendar_title:"캘린더 보기 사용하기",usage_calendar_desc:`1. 하단 탭에서 캘린더 아이콘을 탭하세요.
2. 3일/주간/월간 보기를 선택할 수 있습니다.
3. 날짜를 탭하여 해당 날의 목표를 확인하세요.
4. 좌우 화살표로 날짜를 이동할 수 있습니다.`,usage_offline_title:"오프라인 모드 사용하기",usage_offline_desc:`1. 설정 > 일반에서 "오프라인 모드" 토글을 켜세요.
2. API 키 없이도 목표 추가, 편집, 삭제가 가능합니다.
3. AI 기능은 사용할 수 없지만 모든 기본 기능은 정상 작동합니다.
4. 데이터는 브라우저에 안전하게 저장됩니다.`,goal_assistant_title:"새로운 목표",goal_assistant_mode_woop:"WOOP",goal_assistant_mode_automation:"장기 계획",automation_title:"장기 목표 만들기",automation_base_name_label:"목표 이름",automation_base_name_placeholder:"예: 영어 단어 학습",automation_total_units_label:"총 분량",automation_total_units_placeholder:"예: 30",automation_units_per_day_label:"일일 분량",automation_period_label:"기간",automation_start_date_label:"시작일",automation_end_date_label:"종료일",automation_generate_button:"{count}개 생성",automation_error_all_fields:"모든 필드를 올바르게 입력해주세요.",automation_error_start_after_end:"시작일은 종료일보다 빨라야 합니다.",automation_error_short_period:"기간이 너무 짧습니다. (1일 이상)",next_button:"다음",back_button:"이전",wish_tip:"측정 가능하고 구체적인, 도전적이면서도 현실적인 목표를 설정하세요.",wish_example:"예: 3개월 안에 5kg 감량하기, 이번 학기에 A+ 받기",outcome_tip:"목표 달성 시 얻게 될 가장 긍정적인 결과를 생생하게 상상해 보세요.",outcome_example:"예: 더 건강하고 자신감 있는 모습, 성적 장학금 수령",obstacle_tip:"목표 달성을 방해할 수 있는 내면의 장애물(습관, 감정 등)은 무엇인가요?",obstacle_example:"예: 퇴근 후 피곤해서 운동 가기 싫은 마음, 어려운 과제를 미루는 습관",plan_tip:"'만약 ~라면, ~하겠다' 형식으로 장애물에 대한 구체적인 대응 계획을 세워보세요.",plan_example:"예: 만약 퇴근 후 운동 가기 싫다면, 일단 운동복으로 갈아입고 10분만 스트레칭한다.",recurrence_label:"반복",recurrence_tip:"정해진 요일에 꾸준히 해야 하는 목표인가요? 반복으로 설정하여 연속 달성을 기록해 보세요.",recurrence_example:"예: 매주 월,수,금 헬스장 가기",recurrence_option_daily:"반복 목표",deadline_tip:"현실적인 마감일을 설정하여 동기를 부여하세요. 마감일이 없는 장기 목표도 좋습니다.",deadline_option_no_deadline:"마감일 없음",day_names_short_picker:["월","화","수","목","금","토","일"],settings_delete_account:"모든 데이터 삭제",delete_account_header:"데이터 삭제",delete_account_header_desc:"이 작업은 되돌릴 수 없으며, 모든 목표와 데이터가 영구적으로 삭제됩니다.",version_update_title:"새로운 기능",version_update_1_title:"Firebase 클라우드 동기화",version_update_1_desc:"Google 로그인으로 목표와 설정값을 클라우드에 저장하고 불러올 수 있습니다. 목표는 같은 Google 계정으로 로그인된 여러 기기에서 동기화됩니다.",version_update_2_title:"자동 설정 동기화",version_update_2_desc:"언어, 테마, 배경 색상 등 모든 설정값이 클라우드에 저장되어 다른 기기에서도 동일하게 적용됩니다.",version_update_3_title:"안전한 로그아웃",version_update_3_desc:"로그아웃 시 모든 데이터가 클라우드에 저장되고, 로컬 데이터는 완전히 삭제되며 홈으로 이동합니다.",version_update_4_title:"상태 표시 UI",version_update_4_desc:"로그인, 로그아웃, 동기화 등의 작업 중 버튼 상태가 변화하여 진행 상황을 명확히 보여줍니다."},en:{language_selection_title:"Language",error_wish_required:"Please enter your wish.",error_outcome_required:"Please enter the outcome.",error_obstacle_required:"Please enter the obstacle.",error_plan_required:"Please enter your If-Then plan.",error_deadline_required:"Please select a deadline.",error_day_required:"Please select at least one day.",my_goals_title:"My Goals",all_goals_label:"나의 목표",sort_label_manual:"Manual",sort_label_deadline:"Deadline",sort_label_newest:"Newest",sort_label_alphabetical:"Alphabetical",sort_label_ai:"Priority Order",ai_sorting_button:"Sorting...",add_new_goal_button_label:"Add New Goal",filter_all:"나의 목표",filter_active:"In Progress",filter_completed:"Completed",filter_category:"Category",category_all:"All Categories",category_school:"School",category_work:"Work",category_personal:"Personal",category_other:"Other",category_label:"Select Category",empty_message_all:"Add a goal with the + button",empty_message_active:"No goals in progress.",empty_message_completed:"No completed goals yet.",empty_encouragement_1:"Take the first step toward something amazing.",empty_encouragement_2:"Small changes lead to big achievements.",empty_encouragement_3:"What you do today shapes tomorrow.",empty_encouragement_4:"Your goals are waiting to become reality.",delete_button:"Delete",edit_button_aria:"Edit Goal",info_button_aria:"Details",filter_title:"Filter",sort_title:"Sort",filter_sort_button_aria:"Filter and Sort",calendar_view_button_aria:"Calendar View",list_view_button_aria:"List View",more_options_button_aria:"More",select_button_label:"Select",cancel_selection_button_label:"Cancel",delete_selected_button_label:"Delete {count}",select_all_button_label:"Select All",delete_selected_confirm_title:"Delete Goals",delete_selected_confirm_message:"The {count} selected goals will be permanently deleted.",days_left:"{count} days left",d_day:"D-DAY",days_overdue:"{count} days overdue",month_names:["January","February","March","April","May","June","July","August","September","October","November","December"],day_names_short:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],day_names_long:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],calendar_header_month_format:"{month} {year}",calendar_view_day3:"3-Day",calendar_view_week:"Week",calendar_view_month:"Month",settings_title:"Settings",sort_alert_title:"Unable to Sort",sort_alert_message:"Add at least two goals to use priority order.",ai_sort_error_title:"Unable to Sort",ai_sort_error_message:"Cannot connect to server. Please try again later.",confirm_button:"OK",new_goal_modal_title:"New Goal",edit_goal_modal_title:"Edit Goal",wish_label:"Wish",outcome_label:"Outcome",obstacle_label:"Obstacle",plan_label:"If-Then Plan",deadline_label:"Deadline",cancel_button:"Cancel",add_button:"Add",save_button:"Save",goal_details_modal_title:"Goal Details",ai_coach_suggestion:"View Summary",ai_analyzing:"Analyzing...",close_button:"Close",ai_sort_reason_modal_title:"Sort Reason",ai_sort_criteria:"🤖 Sort Criteria",delete_account_final_confirm_title:"Delete All Data",delete_account_final_confirm_message:"All your goals and data will be permanently deleted. This action cannot be undone.",delete_all_data_button:"Delete All Data",settings_done_button:"Done",settings_section_data:"Data Management",settings_export_data:"Export",settings_import_data:"Import",import_confirm_title:"Import Data",import_confirm_message:"This will replace your current goals with new data. This action cannot be undone.",import_success_toast:"Data imported successfully.",import_error_alert_title:"Import Failed",import_error_alert_message:"There was an error reading the file, or the file format is incorrect.",settings_section_general:"General",settings_section_info:"Information",settings_section_help:"How to Use",settings_theme_mode:"Theme Mode",theme_mode_light:"Light Mode",theme_mode_light_desc:"Use bright theme",theme_mode_dark:"Dark Mode",theme_mode_dark_desc:"Use dark theme",theme_mode_system:"Follow System Settings",theme_mode_system_desc:"Automatically adjust to device settings",settings_dark_mode:"Dark Mode",settings_language:"Language",settings_api_key:"Gemini AI Setup",settings_api_key_placeholder:"Enter Gemini API key",settings_offline_mode:"Offline Mode",settings_offline_mode_desc:"Use basic features without AI",settings_notifications:"Notifications",settings_notifications_desc:"PWA notification settings",notification_settings_title:"What notifications would you like?",notification_deadline:"Deadline Alerts",notification_deadline_desc:"Get notified when deadlines are approaching.",notification_suggestion:"Today's Suggestions",notification_suggestion_desc:"Get suggestions on what to do today.",notification_achievement:"Achievement Celebration",notification_achievement_desc:"Celebrate when you achieve a goal.",notification_reminder:"General Reminder",notification_reminder_desc:"Get reminded at scheduled times.",reminder_time_settings_title:"Reminder Time Settings",reminder_start_time:"Start Time",reminder_end_time:"End Time",reminder_add_title:"Add Reminder",reminder_step_title:"Step {step}/5",reminder_step1_title:"🔔 Title",reminder_step1_desc:"Enter the reminder title",reminder_step2_title:"📅 Date & ⏰ Time",reminder_step2_desc:"Set the reminder date and time (optional)",reminder_step2_date_toggle:"Set Date",reminder_step2_time_toggle:"Set Time",reminder_step3_title:"🔄 Recurring",reminder_step3_desc:"Choose recurrence settings",reminder_step3_enable_recurring:"Enable Recurring",reminder_step4_title:"📝 Description",reminder_step4_desc:"Add optional description",reminder_step5_title:"✅ Enable",reminder_step5_desc:"Choose whether to enable reminder",reminder_next_button:"Next",reminder_back_button:"Back",reminder_submit_button:"Add",reminder_form_title:"Title",reminder_form_date:"Date",reminder_form_time:"Time",reminder_form_recurring:"Recurring",reminder_form_description:"Description",reminder_form_enabled:"Enabled",recurring_type_none:"No Recurrence",recurring_type_daily:"Daily",recurring_type_weekly:"Weekly",recurring_type_monthly:"Monthly",language_name:"English (US)",language_modal_title:"Language",settings_section_background:"Appearance",settings_share_link_header:"Share via Link",settings_generate_link:"Generate Share Link",settings_bg_default:"Light",settings_bg_default_dark:"Dark",settings_bg_pink:"Pink",settings_bg_cherry_noir:"Cherry Noir",settings_bg_blue:"Blue",settings_bg_deep_ocean:"Ocean",settings_bg_green:"Green",settings_bg_forest_green:"Forest",settings_bg_purple:"Purple",settings_bg_royal_purple:"Royal Purple",settings_section_account:"Nova 2.0 Account",settings_sync_data:"Sync Data",settings_load_data:"Load Data",settings_logout:"Sign Out",settings_delete_account:"Delete All Data",delete_account_header:"Delete Data",delete_account_header_desc:"This action is irreversible and will permanently delete all your goals and data.",data_deleting:"Deleting...",settings_version:"Version",test_long_alert:"Test Long Alert",test_long_alert_desc:"Test alert popup with long content",settings_developer:"Developer",developer_name:"GimGyuMin",settings_copyright:"Copyright",copyright_notice:"© 2025 GimGyuMin. All Rights Reserved.",build_number:"Build Number",settings_data_header:"Data Management",settings_data_header_desc:"Export or import your goal data.",settings_background_header:"Background",settings_background_header_desc:"Change the app's background style to express your personality.",data_importing:"Importing...",data_exporting:"Exporting..."}},Le={add:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[m.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),m.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),refresh:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[m.jsx("polyline",{points:"23 4 23 10 17 10"}),m.jsx("path",{d:"M1 20v-6h6"}),m.jsx("path",{d:"M3.51 9a9 9 0 0 1 14.13-3.36L23 10M1 14l5.36 5.36A9 9 0 0 0 20.49 15"})]}),check:m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:m.jsx("polyline",{points:"20 6 9 17 4 12"})}),info:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[m.jsx("circle",{cx:"12",cy:"12",r:"10"}),m.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),m.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),delete:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[m.jsx("polyline",{points:"3 6 5 6 21 6"}),m.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}),m.jsx("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),m.jsx("line",{x1:"14",y1:"11",x2:"14",y2:"17"})]}),edit:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[m.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),m.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),back:m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:m.jsx("polyline",{points:"15 18 9 12 15 6"})}),forward:m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:m.jsx("polyline",{points:"9 18 15 12 9 6"})}),calendar:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[m.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),m.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),m.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),m.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),list:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[m.jsx("line",{x1:"8",y1:"6",x2:"21",y2:"6"}),m.jsx("line",{x1:"8",y1:"12",x2:"21",y2:"12"}),m.jsx("line",{x1:"8",y1:"18",x2:"21",y2:"18"}),m.jsx("line",{x1:"3",y1:"6",x2:"3.01",y2:"6"}),m.jsx("line",{x1:"3",y1:"12",x2:"3.01",y2:"12"}),m.jsx("line",{x1:"3",y1:"18",x2:"3.01",y2:"18"})]}),settings:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[m.jsx("circle",{cx:"12",cy:"12",r:"3"}),m.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]}),filter:m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:m.jsx("polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"})}),flame:m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:m.jsx("path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"})}),data:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[m.jsx("path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83"}),m.jsx("path",{d:"M22 12A10 10 0 0 0 12 2v10z"})]}),background:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[m.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),m.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),m.jsx("polyline",{points:"21 15 16 10 5 21"})]}),exclamation:m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:m.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 15c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1zm1-4h-2V7h2v6z"})})},uu=(t,e)=>{const n=new Date(t),r=new Date(e);return n.getFullYear()===r.getFullYear()&&n.getMonth()===r.getMonth()&&n.getDate()===r.getDate()},N3=(t,e)=>{if(!t)return null;const n=new Date;n.setHours(0,0,0,0);const r=new Date(t);r.setHours(0,0,0,0);const i=r.getTime()-n.getTime(),s=Math.ceil(i/(1e3*60*60*24));return s===0?e("d_day"):s>0?e("days_left").replace("{count}",String(s)):e("days_overdue").replace("{count}",String(Math.abs(s)))},KI=(t,e=1)=>{const n=new Date(t),r=n.getDay(),i=(r<e?7:0)+r-e;return n.setDate(n.getDate()-i),n.setHours(0,0,0,0),n},cg=t=>{try{const e=new TextEncoder().encode(t),n=Array.from(e).map(r=>String.fromCharCode(r)).join("");return btoa(n)}catch(e){return console.error("UTF-8 to Base64 encoding failed:",e),""}},jI=t=>{try{const e=atob(t),n=new Uint8Array(e.length);for(let r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return new TextDecoder().decode(n)}catch(e){return console.error("Base64 to UTF-8 decoding failed:",e),""}},JI=t=>{try{const n=JSON.stringify(t).replace(/\s+/g," ").trim();return cg(n)}catch(e){return console.error("Data compression failed:",e),cg(JSON.stringify(t))}},rR=async t=>{if(t.length<1500)return t;const e=[{name:"is.gd",createUrl:async n=>{const r=await fetch(`https://is.gd/create.php?format=simple&url=${encodeURIComponent(n)}`);if(!r.ok)throw new Error("is.gd API failed");const i=await r.text();if(i.includes("Error")||!i.startsWith("http"))throw new Error("Invalid response from is.gd");return i.trim()}},{name:"tinyurl",createUrl:async n=>new Promise((r,i)=>{const s=`tinyurl_${Date.now()}`,o=document.createElement("script"),a=setTimeout(()=>{l(),i(new Error("TinyURL timeout"))},5e3),l=()=>{clearTimeout(a),o.parentNode&&document.head.removeChild(o),delete window[s]};window[s]=u=>{l(),u&&typeof u=="string"&&!u.includes("Error")&&u.startsWith("http")?r(u.trim()):i(new Error("Invalid TinyURL response"))},o.onerror=()=>{l(),i(new Error("TinyURL script load failed"))},o.src=`https://tinyurl.com/api-create.php?url=${encodeURIComponent(n)}&callback=${s}`,document.head.appendChild(o)})},{name:"v.gd",createUrl:async n=>{const r=await fetch(`https://v.gd/create.php?format=simple&url=${encodeURIComponent(n)}`);if(!r.ok)throw new Error("v.gd API failed");const i=await r.text();if(i.includes("Error")||!i.startsWith("http"))throw new Error("Invalid response from v.gd");return i.trim()}}];for(const n of e)try{console.log(`Trying ${n.name} for URL shortening...`);const r=await n.createUrl(t);return console.log(`✅ ${n.name} success:`,r),r}catch(r){console.warn(`❌ ${n.name} failed:`,r);continue}return console.warn("All URL shortening services failed, using original URL"),t},dg=[{id:"default",lightThemeClass:"bg-solid-default",darkThemeClass:"bg-solid-default",lightNameKey:"settings_bg_default",darkNameKey:"settings_bg_default_dark"},{id:"pink",lightThemeClass:"bg-solid-pink",darkThemeClass:"bg-solid-pink",lightNameKey:"settings_bg_pink",darkNameKey:"settings_bg_cherry_noir"},{id:"blue",lightThemeClass:"bg-solid-blue",darkThemeClass:"bg-solid-blue",lightNameKey:"settings_bg_blue",darkNameKey:"settings_bg_deep_ocean"},{id:"green",lightThemeClass:"bg-solid-green",darkThemeClass:"bg-solid-green",lightNameKey:"settings_bg_green",darkNameKey:"settings_bg_forest_green"},{id:"purple",lightThemeClass:"bg-solid-purple",darkThemeClass:"bg-solid-purple",lightNameKey:"settings_bg_purple",darkNameKey:"settings_bg_royal_purple"}],D3=()=>{const[t,e]=z.useState(!1);z.useRef(null);const[n,r]=z.useState("ko"),[i,s]=z.useState([]),[o,a]=z.useState([]),[l,u]=z.useState(null),[f,p]=z.useState("all"),[g,v]=z.useState("all"),[E,R]=z.useState("manual"),[M,A]=z.useState(["school","work","personal","other"]),[I,C]=z.useState(()=>WI()==="dark"),[V,F]=z.useState("system"),[B,T]=z.useState("default"),[w,x]=z.useState([]),[k,D]=z.useState({}),[L,N]=z.useState([]),[Me,et]=z.useState(!1),[je,ye]=z.useState(!1),[Z,fe]=z.useState(null),[ve,Ee]=z.useState(!1),[Oe,rt]=z.useState(null),[Je,Ae]=z.useState(""),[Qe,zt]=z.useState(""),[hr,Wn]=z.useState("editor"),[kn,fr]=z.useState(!1),[Kn,jn]=z.useState(null),[pr,xe]=z.useState(!1),[$t,Fe]=z.useState(!1),[_n,at]=z.useState(!1),[ze,Te]=z.useState(null),[fc,Co]=z.useState(!1),[fs,mr]=z.useState(new Set),[ps,Pe]=z.useState(""),[rl,li]=z.useState("idle"),[il,Ao]=z.useState(!1),[sl,ui]=z.useState(!1),[ol,al]=z.useState(""),[gr,xo]=z.useState(!1),[Jn,ms]=z.useState(void 0),[gs,Ro]=z.useState(!1),[Vt,_s]=z.useState(!1),[ys,_r]=z.useState(!1),ll=z.useCallback(()=>{Ro(!1),_s(!0),_r(!1),setTimeout(()=>_r(!0),4500)},[]);z.useEffect(()=>{const S=()=>{try{console.log("PWA installed (appinstalled event)")}catch{}ll()};return window.addEventListener("appinstalled",S),()=>window.removeEventListener("appinstalled",S)},[ll]);const[ci,Qn]=z.useState(""),[vs,Sf]=z.useState(!1),[Vr,pc]=z.useState(!0),[Y,Ts]=z.useState(null),[Po,gy]=z.useState(""),[Lr,Cf]=z.useState(!1),[mc,Es]=z.useState(!1),[ul,ko]=z.useState(!1),[cl,cn]=z.useState(!1),[Af,Is]=z.useState(!1),[No,dl]=z.useState(!0);z.useEffect(()=>{let S=null,b=null,U=null;const O=qL(Si,async $=>{if(Ts($),dl(!1),$){console.log("🔑 사용자 로그인 감지 - Firebase 데이터 로드 시작"),await Do($),console.log("📡 실시간 데이터 동기화 리스너 설정 중...");let Q=null,J=null;const X=Ve(pe,"users",$.uid,"data","todos");S=Ur(X,ne=>{Q&&clearTimeout(Q),Q=setTimeout(()=>{if(ne.exists()){const he=ne.data().todos||[];s(ue=>{const ae=ue.filter(tt=>tt.isSharedTodo===!0),me=he.map(tt=>({...tt,isSharedTodo:!1}));return JSON.stringify(ue.filter(tt=>!tt.isSharedTodo))!==JSON.stringify(me)?(console.log("🔄 개인 목표 데이터 실시간 업데이트:",me.length,"공유 목표 보존:",ae.length),[...me,...ae]):ue})}},2e3)});const W=lt(pe,"users",$.uid,"folders");b=Ur(W,async ne=>{J&&clearTimeout(J),J=setTimeout(async()=>{const K=[];ne.forEach(ue=>{const ae=ue.data(),me={id:ue.id,add:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[m.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),m.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),name:ae.name||"이름 없는 폴더",color:ae.color||"#007AFF",createdAt:ae.createdAt||new Date().toISOString(),updatedAt:ae.updatedAt||new Date().toISOString(),...ae,collaborators:ae.collaborators||[],ownerId:ae.ownerId||$.uid};K.push(me)});const he=K.filter(ue=>ue.isShared&&ue.ownerId&&ue.ownerId!==$.uid);if(he.length>0){console.log("📡 공유 폴더 실시간 동기화 설정:",he.map(ae=>({id:ae.id,name:ae.name,ownerId:ae.ownerId}))),U&&U();const ue=[];for(const ae of he)if(ae.ownerId)try{const me=Ve(pe,"users",ae.ownerId,"folders",ae.id),Ne=Ur(me,Mn=>{if(Mn.exists()){const Vn=Mn.data();console.log("🔄 공유 폴더 정보 실시간 업데이트:",{folderId:ae.id,name:Vn.name,color:Vn.color}),a(yn=>yn.map(en=>en.id===ae.id?{...en,name:Vn.name||en.name||"공유 폴더",color:Vn.color||en.color,updatedAt:Vn.updatedAt||en.updatedAt}:en))}},Mn=>{console.error("❌ 공유 폴더 정보 동기화 오류:",Mn)});ue.push(Ne);const tt=lt(pe,"users",ae.ownerId,"todos"),bn=Bl(tt,ql("folderId","==",ae.id));let mi=null;const Ns=Ur(bn,Mn=>{mi&&clearTimeout(mi),mi=setTimeout(()=>{const Vn=[];Mn.forEach(yn=>{const en=yn.data();Vn.push({id:parseInt(yn.id),...en,isSharedTodo:!0})}),console.log("🔄 공유 폴더 목표 실시간 업데이트:",{folderId:ae.id,count:Vn.length}),s(yn=>{const en=yn.filter(Ds=>!(Ds.folderId===ae.id&&Ds.isSharedTodo===!0)),gl=Vn.filter(Ds=>!en.some(Rc=>Rc.id===Ds.id)),Tr=[...en,...gl];return console.log("📊 목표 병합 결과:",{기존총개수:yn.length,제외된공유목표:yn.length-en.length,중복제거후새목표:gl.length,최종총개수:Tr.length}),Tr})},1500)},Mn=>{console.warn("⚠️ 공유 폴더 실시간 동기화 오류:",{folderId:ae.id,error:Mn.code})});ue.push(Ns)}catch(me){console.warn("⚠️ 공유 폴더 리스너 설정 실패:",{folderId:ae.id,error:me})}U=()=>{ue.forEach(ae=>ae())}}a(ue=>JSON.stringify(ue)!==JSON.stringify(K)?(console.log("🔄 폴더 데이터 실시간 업데이트:",K.map(me=>({id:me.id,name:me.name}))),K):ue)},3e3)})}else console.log("🚪 사용자 로그아웃 감지 - 데이터 초기화"),S&&(S(),S=null),b&&(b(),b=null),U&&(U(),U=null),s([]),a([]),r("ko"),F("system"),T("default"),Qn(""),A(["school","work","personal","other"])});return()=>{O(),S&&S(),b&&b(),U&&U()}},[]);const ws=z.useCallback(()=>{console.log("🔍 Firebase 진단 시작..."),console.log("Firebase Auth:",Si),console.log("Firebase DB:",pe),console.log("Google Provider:",ro),console.log("환경 변수 확인:"),console.log("- VITE_FIREBASE_API_KEY:","✅ 설정됨"),console.log("- VITE_FIREBASE_AUTH_DOMAIN:","✅ 설정됨"),console.log("- VITE_FIREBASE_PROJECT_ID:","✅ 설정됨"),console.log("브라우저 정보:"),console.log("- User Agent:",navigator.userAgent),console.log("- 쿠키 활성화:",navigator.cookieEnabled),console.log("- 로컬 스토리지 지원:",typeof Storage<"u"),console.log("네트워크 상태:",navigator.onLine?"✅ 온라인":"❌ 오프라인")},[]),Yn=z.useCallback(async()=>{Es(!0);try{console.log("🔄 Google 로그인 시작..."),console.log("Auth 상태:",Si),console.log("Google Provider 설정:",ro);const S=window.open("","_blank","width=1,height=1");if(!S||S.closed||typeof S.closed>"u")throw new Error("팝업이 차단되었습니다. 브라우저 설정에서 팝업을 허용해주세요.");S.close(),console.log("🔄 signInWithPopup 호출 중...");const b=await oF(Si,ro);console.log("✅ 로그인 성공:",b.user.email),Ts(b.user),Pe("✅ Google 로그인 성공!"),setTimeout(async()=>{var U;try{console.log("📥 사용자 데이터 로딩 시작...");const{doc:O,getDoc:$}=await Ms(async()=>{const{doc:ne,getDoc:K}=await Promise.resolve().then(()=>Ls);return{doc:ne,getDoc:K}},void 0),Q=O(pe,"users",b.user.uid,"data","todos"),J=await $(Q);if(J.exists()){const ne=J.data();s(ne.todos||[]),console.log("📥 목표 데이터 로드 완료:",((U=ne.todos)==null?void 0:U.length)||0)}else console.log("📝 새 사용자 - 빈 목표 목록으로 시작"),s([]);const X=O(pe,"users",b.user.uid,"data","settings"),W=await $(X);if(W.exists()){const ne=W.data();ne.language&&r(ne.language),ne.themeMode&&F(ne.themeMode),ne.isDarkMode!==void 0&&C(ne.isDarkMode),ne.backgroundTheme&&T(ne.backgroundTheme),ne.apiKey&&Qn(ne.apiKey)}Pe("✅ 로그인 완료! 데이터 로드됨")}catch(O){console.error("데이터 로드 실패:",O),Pe("⚠️ 로그인은 성공했으나 데이터 로드 실패")}Es(!1),setTimeout(()=>Pe(""),3e3)},500),setTimeout(()=>Pe(""),3e3)}catch(S){console.error("❌ Google 로그인 오류:",S),console.error("오류 코드:",S.code),console.error("오류 메시지:",S.message);let b="로그인 중 오류가 발생했습니다.";switch(S.code){case"auth/popup-closed-by-user":b="로그인이 취소되었습니다.";break;case"auth/popup-blocked":b="팝업이 차단되었습니다. 브라우저 설정에서 팝업을 허용해주세요.";break;case"auth/cancelled-popup-request":b="다른 로그인 요청이 진행 중입니다.";break;case"auth/network-request-failed":b="네트워크 연결을 확인해주세요.";break;case"auth/too-many-requests":b="너무 많은 요청이 발생했습니다. 잠시 후 다시 시도해주세요.";break;case"auth/user-disabled":b="계정이 비활성화되었습니다.";break;case"auth/operation-not-allowed":b="Google 로그인이 활성화되지 않았습니다. 관리자에게 문의하세요.";break;default:b=`로그인 실패: ${S.message}`}S.code!=="auth/popup-closed-by-user"&&Te({title:"로그인 실패",message:b,confirmText:"확인",onConfirm:()=>Te(null)}),Es(!1)}},[]),hl=(S,b)=>{if(S===null)return;const U=o.map(O=>O.id===S?{...O,collaborators:b}:O);a(U),Jn&&Jn.id===S&&ms({...Jn,collaborators:b}),Pe("✅ 폴더 협업자가 업데이트되었습니다"),setTimeout(()=>Pe(""),3e3)},xf=z.useCallback(async()=>{ko(!0);try{if(Y){Pe("⏳ 데이터 저장 중...");const S=i.filter(ne=>ne!=null),{doc:b,setDoc:U,serverTimestamp:O}=await Ms(async()=>{const{doc:ne,setDoc:K,serverTimestamp:he}=await Promise.resolve().then(()=>Ls);return{doc:ne,setDoc:K,serverTimestamp:he}},void 0),$=S.map(ne=>Lt(ne)).filter(ne=>ne!==void 0),Q=b(pe,"users",Y.uid,"data","todos"),J={todos:$,lastSyncTime:O(),totalGoals:$.length,syncedAt:new Date().toISOString()},X=Lt(J);X?(await U(Q,X),console.log("✅ Todos Firestore 저장 완료:",{count:$.length})):console.error("❌ Todos 데이터 정제 실패");const W=b(pe,"users",Y.uid,"data","settings");await U(W,{language:n,themeMode:V,isDarkMode:I,backgroundTheme:B,updatedAt:O()})}await fE(Si),Ts(null),s([]),r("ko"),T("default"),F("system"),C(WI()==="dark"),fe(null),xe(!1),ye(!1),Pe("✅ 로그아웃 완료"),setTimeout(()=>Pe(""),3e3),ko(!1)}catch(S){console.error("로그아웃 오류:",S),Te({title:"로그아웃 실패",message:"로그아웃 중 오류가 발생했습니다.",confirmText:"확인",onConfirm:()=>Te(null)}),ko(!1)}},[Y,i,n,V,I,B]),Ss=z.useCallback(async()=>{if(!Y){Te({title:"로그인 필요",message:"먼저 로그인해주세요",confirmText:"확인",onConfirm:()=>Te(null)});return}cn(!0);try{const S=i.filter(K=>K!=null),{doc:b,setDoc:U,serverTimestamp:O}=await Ms(async()=>{const{doc:K,setDoc:he,serverTimestamp:ue}=await Promise.resolve().then(()=>Ls);return{doc:K,setDoc:he,serverTimestamp:ue}},void 0),$=S.map(K=>Lt(K)).filter(K=>K!==void 0),Q=b(pe,"users",Y.uid,"data","todos"),J={todos:$,lastSyncTime:O(),totalGoals:$.length,syncedAt:new Date().toISOString()},X=Lt(J);if(X)await U(Q,X),console.log("✅ 백업 Todos Firestore 저장 완료:",{count:$.length});else throw new Error("Todos 데이터 정제 실패");const W=b(pe,"users",Y.uid,"data","settings"),ne={language:n,themeMode:V,isDarkMode:I,backgroundTheme:B,apiKey:ci,userCategories:M,updatedAt:O()};await U(W,ne);for(const K of o)try{const he=b(pe,"users",Y.uid,"folders",K.id),ue={...K,ownerId:K.ownerId||Y.uid,collaborators:K.collaborators||[],updatedAt:O()};await U(he,ue),console.log(`✅ 폴더 ${K.id} 동기화 완료`)}catch(he){console.error(`❌ 폴더 ${K.id} 동기화 실패:`,he)}cn(!1)}catch(S){console.error("동기화 오류:",S),Te({title:"동기화 실패",message:S.message||"데이터 동기화 중 오류가 발생했습니다.",confirmText:"확인",onConfirm:()=>Te(null)}),cn(!1)}},[Y,i,n,V,I,B,ci]),Do=z.useCallback(async S=>{var b;try{const{doc:U,getDoc:O,collection:$,getDocs:Q}=await Ms(async()=>{const{doc:K,getDoc:he,collection:ue,getDocs:ae}=await Promise.resolve().then(()=>Ls);return{doc:K,getDoc:he,collection:ue,getDocs:ae}},void 0),J=U(pe,"users",S.uid,"data","todos"),X=await O(J);if(X.exists()){const he=X.data().todos||[];s(ue=>{const ae=new Set(ue.map(tt=>tt.id)),me=he.filter(tt=>!ae.has(tt.id)),Ne=[...ue,...me];return console.log("🔄 목표 데이터 병합:",{기존:ue.length,로드됨:he.length,새로추가:me.length,전체:Ne.length}),Ne})}const W=U(pe,"users",S.uid,"data","settings"),ne=await O(W);if(ne.exists()){const K=ne.data();K.language&&r(K.language),K.themeMode&&F(K.themeMode),K.isDarkMode!==void 0&&C(K.isDarkMode),K.backgroundTheme&&T(K.backgroundTheme),K.apiKey&&Qn(K.apiKey),K.userCategories&&A(K.userCategories)}try{const K=$(pe,"users",S.uid,"folders"),he=await Q(K),ue=[];he.forEach(ae=>{const me=ae.data(),Ne={id:ae.id,...me,collaborators:me.collaborators||[],ownerId:me.ownerId||S.uid};ue.push(Ne)}),a(ae=>{const me=new Set(ae.map(bn=>bn.id)),Ne=ue.filter(bn=>!me.has(bn.id)),tt=[...ae,...Ne];return console.log("🔄 폴더 데이터 병합:",{기존:ae.length,로드됨:ue.length,새로추가:Ne.length,전체:tt.length}),tt}),console.log("✅ 폴더 로드 완료:",{count:ue.length})}catch(K){console.warn("⚠️ 폴더 로드 실패, 빈 배열로 설정:",K)}console.log("✅ 클라우드 데이터 로드 완료:",{todos:X.exists()&&((b=X.data().todos)==null?void 0:b.length)||0,folders:"로드됨",settings:ne.exists()?"로드됨":"없음"})}catch(U){console.error("❌ 클라우드 데이터 로드 실패:",U)}},[]),gc=z.useCallback(async()=>{if(!Y){Te({title:"로그인 필요",message:"먼저 로그인해주세요",confirmText:"확인",onConfirm:()=>Te(null)});return}Is(!0);try{await Do(Y),Pe("✅ 클라우드 데이터 로드 완료!")}catch(S){console.error("로드 오류:",S),Te({title:"로드 실패",message:S.message||"데이터 로드 중 오류가 발생했습니다.",confirmText:"확인",onConfirm:()=>Te(null)})}finally{Is(!1)}},[Y,Do]),oe=z.useCallback(S=>k3[n][S]||S,[n]),di=z.useCallback(S=>{const b=S||ci;if(vs||!b)return null;try{return new _2({apiKey:b})}catch(U){return console.error("Failed to create AI instance:",U),null}},[ci,vs]),_c=z.useCallback(S=>{F(S)},[]),bo=z.useMemo(()=>[oe("empty_encouragement_1"),oe("empty_encouragement_2"),oe("empty_encouragement_3"),oe("empty_encouragement_4")],[oe]),yc=z.useMemo(()=>bo[Math.floor(Math.random()*bo.length)],[bo]);z.useEffect(()=>{console.log("🚀 클라우드 기반 앱 시작 - localStorage 사용 안 함")},[]),z.useEffect(()=>{(()=>{a(b=>{const U=b.filter(O=>{if(!O.collaborators||O.collaborators.length===0)return!0;const $=O.collaborators.find(Q=>Q.role==="owner");return!$||!$.userId||$.userId.startsWith("owner_")?(console.warn("🗑️ 잘못된 공유 폴더 제거:",O.name,$==null?void 0:$.userId),!1):!0});return U.length!==b.length&&console.log("✅ 잘못된 공유 폴더 정리 완료:",{제거됨:b.length-U.length,남은폴더:U.length}),U})})()},[]),z.useEffect(()=>{if(No)return;const S=async()=>{const b=new URLSearchParams(window.location.search),U=b.get("data"),O=b.get("folder_share");if(O){try{const $=jI(O),Q=JSON.parse($);if(Q.type==="folder_share"&&Q.folderId){if(Q.password){const X=sessionStorage.getItem(`folder_${Q.folderId}_password`);if(!X||X!==Q.password){Te({title:"암호 입력",message:"이 폴더는 암호로 보호되어 있습니다. 암호를 입력하세요.",confirmText:"확인",cancelText:"취소",onConfirm:()=>{const W=prompt("폴더 암호를 입력하세요:");W===Q.password?(sessionStorage.setItem(`folder_${Q.folderId}_password`,W),Te(null),S()):W!==null&&Te({title:"암호 오류",message:"암호가 일치하지 않습니다.",confirmText:"확인",onConfirm:()=>{window.history.replaceState({},document.title,window.location.pathname)}})},onCancel:()=>{window.history.replaceState({},document.title,window.location.pathname)}});return}}if(o.some(X=>X.id===Q.folderId))window.history.replaceState({},document.title,window.location.pathname);else{if(Q.ownerId&&!Y&&!No){Te({title:"로그인 필요",message:"이 공유 폴더는 소유자 기반 동기화를 위해 로그인이 필요합니다. 계속하려면 로그인하세요.",confirmText:"로그인",cancelText:"취소",onConfirm:async()=>{try{await Yn()}catch(K){console.error("로그인 중 오류:",K)}},onCancel:()=>{window.history.replaceState({},document.title,window.location.pathname)}});return}const X=Q.ownerId||null;if(!X){console.error("❌ 공유 링크에 소유자 정보가 없습니다:",Q),Te({title:"❌ 공유 링크 오류",message:`공유 링크에 소유자 정보가 없습니다.
폴더 소유자에게 다시 공유 링크를 요청해주세요.`,confirmText:"확인",onConfirm:()=>{Te(null),window.history.replaceState({},document.title,window.location.pathname)}});return}const W={id:Q.folderId,name:Q.folderName,color:Q.folderColor||"#007AFF",ownerId:X,collaborators:[{userId:X,email:Q.sharedBy||"",role:"owner",addedAt:Q.sharedAt}],createdAt:Q.sharedAt,updatedAt:Q.sharedAt,isShared:!0};let ne=W;if(X&&Y)try{console.log("🔍 협업자 추가 시작:",{ownerUserId:X,googleUserUid:Y.uid});const K=lt(pe,"users",X,"folders"),he=Ve(K,Q.folderId),ue=await lg(he);if(console.log("📄 폴더 조회 결과:",{exists:ue.exists()}),ue.exists()){let ae=ue.data().collaborators||[];console.log("👥 현재 협업자 목록:",ae);const me=ae.some(Ne=>Ne.userId===Y.uid);if(console.log("🔎 협업자 여부:",{isCollaborator:me}),me)console.log("ℹ️ 이미 협업자임");else{const Ne={userId:Y.uid,email:Y.email||"",role:"editor",addedAt:new Date().toISOString()};ae=[...ae,Ne],console.log("📝 새로운 협업자 목록:",ae);const tt=Lt(ae);tt?(await _t(he,{collaborators:tt,updatedAt:new Date().toISOString()},{merge:!0}),console.log("✅ 협업자 Firestore 저장 완료:",Ne)):console.warn("⚠️ 협업자 정제 후 데이터가 없음")}ne={...W,collaborators:ae}}else console.warn("⚠️ 폴더가 존재하지 않음:",Q.folderId)}catch(K){console.error("❌ 협업자 목록 조회/추가 실패:",K)}else console.warn("⚠️ 협업자 추가 조건 미충족:",{ownerUserId:X,hasGoogleUser:!!Y});if(a([...o,ne]),Y)try{const{doc:K,setDoc:he}=await Ms(async()=>{const{doc:ae,setDoc:me}=await Promise.resolve().then(()=>Ls);return{doc:ae,setDoc:me}},void 0),ue=K(pe,"users",Y.uid,"folders",ne.id);await he(ue,{name:ne.name,color:ne.color,ownerId:ne.ownerId,createdAt:ne.createdAt,updatedAt:ne.updatedAt,isShared:ne.isShared,collaborators:ne.collaborators||[],collaborationSettings:ne.collaborationSettings||{enabled:!0,showPresence:!0,showEditingState:!0,enableConflictDetection:!0,allowGuestView:!1,requireApproval:!1}}),console.log("✅ 공유 폴더 Firebase 저장 완료:",ne.id)}catch(K){console.error("❌ 공유 폴더 Firebase 저장 실패:",K)}u(ne.id),Te({title:"공유 폴더 추가됨",message:`"${Q.folderName}" 폴더가 추가되었습니다. 잠시 후 목표들이 로드됩니다.`,confirmText:"확인",onConfirm:()=>{window.history.replaceState({},document.title,window.location.pathname)}})}}}catch($){console.error("폴더 공유 데이터 파싱 실패:",$),window.history.replaceState({},document.title,window.location.pathname)}return}if(U)try{const $=jI(U),Q=JSON.parse($);if(Array.isArray(Q)&&(Q.length===0||"wish"in Q[0]&&"id"in Q[0]))Te({title:oe("url_import_title"),message:oe("url_import_message"),confirmText:oe("url_import_confirm"),cancelText:oe("cancel_button"),onConfirm:()=>{s(Q),Pe(oe("url_import_success")),window.history.replaceState({},document.title,window.location.pathname)},onCancel:()=>{window.history.replaceState({},document.title,window.location.pathname)}});else throw new Error("Invalid data format")}catch($){console.error("Failed to parse data from URL",$),Te({title:oe("import_error_alert_title"),message:oe("url_import_error")}),window.history.replaceState({},document.title,window.location.pathname)}};S()},[oe,o,Y,Yn,No]),z.useEffect(()=>{if(!l||!Y)return;const S=o.find(W=>W.id===l);if(!S||!S.collaborators||S.collaborators.length===0)return;const b=S.collaborators.find(W=>W.role==="owner");if(!b)return;const U=b.userId;if(!U||U.startsWith("owner_")){console.warn("⚠️ Invalid owner UID:",b);return}const O=[],$=Ve(pe,"users",U,"folders",l),Q=Ur($,W=>{if(W.exists()){const ne=W.data();ne.collaborators&&a(K=>K.map(he=>he.id===l?{...he,collaborators:ne.collaborators}:he))}},W=>{console.warn("⚠️ 공유 폴더 메타데이터 접근 오류 (협업자 목록 업데이트 안 됨):",W.code)});O.push(Q);const J=lt(pe,"users",U,"todos");console.log("📊 Syncing todos from owner:",{ownerUid:U,currentFolderId:l});const X=Ur(J,W=>{const ne=[];W.forEach(K=>{const he=K.data();he.folderId===l&&ne.push({id:parseInt(K.id),...he})}),console.log("🎯 Owner todos received:",{count:ne.length,ownerTodos:ne}),s(K=>{const he=K.filter(Ne=>Ne.folderId!==l),ue=K.filter(Ne=>Ne.folderId===l),ae=[],me=new Set;return ne.forEach(Ne=>{ae.push(Ne),me.add(Ne.id)}),ue.forEach(Ne=>{me.has(Ne.id)||ae.push(Ne)}),[...he,...ae]})},W=>{console.error("❌ 실시간 동기화 실패:",W),W.code==="permission-denied"?(console.warn("⚠️ 권한 부족으로 실시간 동기화 실패 - 수동 동기화를 사용하세요"),Pe("⚠️ 실시간 동기화 실패 - 🔄 버튼으로 수동 동기화하세요")):W.code==="not-found"?(console.warn("⚠️ 폴더를 찾을 수 없음 - 폴더가 삭제되었을 수 있습니다"),Pe("⚠️ 공유 폴더를 찾을 수 없습니다")):(console.warn("⚠️ 네트워크 오류로 실시간 동기화 실패"),Pe("⚠️ 네트워크 오류 - 🔄 버튼으로 재시도하세요"))});return O.push(X),()=>{O.forEach(W=>W())}},[l,Y]),z.useEffect(()=>{var W,ne;if(!l||!Y)return;const S=o.find(K=>K.id===l),b=((W=S==null?void 0:S.collaborationSettings)==null?void 0:W.enabled)||(S==null?void 0:S.isShared)||!1,U=((ne=S==null?void 0:S.collaborationSettings)==null?void 0:ne.showPresence)??!0;if(!b||!U){x([]);return}console.log("👥 실시간 접속 상태 추적 시작:",{folderId:l,showPresence:U});const O=lt(pe,"folderPresence",l,"users"),$=Ve(O,Y.uid);(async()=>{try{await _t($,{userId:Y.uid,displayName:Y.displayName||"Anonymous",photoURL:Y.photoURL||null,isOnline:!0,lastSeen:new Date,currentFolder:l},{merge:!0}),console.log("✅ 내 접속 상태 등록:",Y.displayName)}catch(K){console.warn("presence set failed",K)}})();const J=setInterval(()=>{_t($,{lastSeen:new Date,isOnline:!0},{merge:!0}).catch(()=>{})},3e4),X=Ur(O,K=>{const ue=K.docs.map(ae=>{const me=ae.data();return{userId:me.userId||ae.id,displayName:me.displayName||"Anonymous",photoURL:me.photoURL||void 0,isOnline:!!me.isOnline,lastSeen:me.lastSeen?me.lastSeen.toDate?me.lastSeen.toDate():new Date(me.lastSeen):new Date,currentFolder:me.currentFolder}}).filter(ae=>!!ae.userId&&ae.isOnline);x(ue),console.log("👥 활성 사용자 업데이트:",ue.map(ae=>ae.displayName))},K=>console.warn("presence listen failed",K));return()=>{clearInterval(J),_t($,{isOnline:!1,lastSeen:new Date},{merge:!0}).catch(()=>{}),X()}},[l,Y,o]),z.useCallback(async S=>{var $,Q;if(!l||!Y)return;const b=o.find(J=>J.id===l),U=(($=b==null?void 0:b.collaborationSettings)==null?void 0:$.showEditingState)??!0;if(!(!((Q=b==null?void 0:b.collaborationSettings)!=null&&Q.enabled||b!=null&&b.isShared)||!U))try{const J=Ve(pe,"folderEditing",`${l}_${S}`);await _t(J,{todoId:S,userId:Y.uid,userName:Y.displayName||"Anonymous",startTime:new Date,folderId:l}),console.log("✏️ 편집 시작:",{todoId:S,user:Y.displayName})}catch(J){console.warn("start editing failed",J)}},[l,Y,o]),z.useCallback(async S=>{var $,Q;if(!l||!Y)return;const b=o.find(J=>J.id===l),U=(($=b==null?void 0:b.collaborationSettings)==null?void 0:$.showEditingState)??!0;if(!(!((Q=b==null?void 0:b.collaborationSettings)!=null&&Q.enabled||b!=null&&b.isShared)||!U))try{const J=Ve(pe,"folderEditing",`${l}_${S}`);await Ft(J),console.log("✅ 편집 종료:",{todoId:S,user:Y.displayName})}catch(J){console.warn("stop editing failed",J)}},[l,Y,o]),z.useEffect(()=>{var Q,J;if(!l)return;const S=o.find(X=>X.id===l),b=((Q=S==null?void 0:S.collaborationSettings)==null?void 0:Q.showEditingState)??!0;if(!(((J=S==null?void 0:S.collaborationSettings)==null?void 0:J.enabled)||(S==null?void 0:S.isShared)||!1)||!b){D({});return}console.log("✏️ 편집 상태 추적 시작:",{folderId:l});const O=Bl(lt(pe,"folderEditing"),ql("folderId","==",l)),$=Ur(O,X=>{const W={};X.docs.forEach(ne=>{const K=ne.data();K&&K.todoId&&(W[K.todoId]={todoId:K.todoId,userId:K.userId,userName:K.userName,startTime:K.startTime?K.startTime.toDate?K.startTime.toDate():new Date(K.startTime):new Date,folderId:K.folderId})}),D(W),console.log("✏️ 편집 상태 업데이트:",Object.keys(W).length+"개 항목")},X=>console.warn("editing states listen failed",X));return()=>$()},[l,o]),z.useCallback(async S=>{var b,U;try{const O=S.ownerId||(Y==null?void 0:Y.uid);if(!O)throw new Error("No owner UID");const $=o.find(ne=>ne.id===l),Q=((b=$==null?void 0:$.collaborationSettings)==null?void 0:b.enableConflictDetection)??!0,J=((U=$==null?void 0:$.collaborationSettings)==null?void 0:U.enabled)||($==null?void 0:$.isShared)||!1,X=Ve(pe,"users",O,"todos",S.id.toString());if(J&&Q){const ne=await lg(X),K=ne.exists()?ne.data():null,he=(K==null?void 0:K.version)||0,ue=S.version||0;if(K&&he>ue&&(N(me=>[...me,{todoId:S.id,conflictType:"version_mismatch",localVersion:S,serverVersion:K,lastModifiedBy:K.lastModifiedBy||"unknown",lastModifiedAt:K.lastModified?K.lastModified.toDate?K.lastModified.toDate():new Date(K.lastModified):new Date}]),console.warn("⚠️ 충돌 감지:",{todoId:S.id,localVersion:ue,serverVersion:he,lastModifiedBy:K.lastModifiedBy}),!window.confirm("다른 사용자가 이 항목을 수정했습니다. 덮어쓰시겠습니까? (취소하면 변경이 중단됩니다)")))return!1}const W=Lt({...S,version:(S.version||0)+1,lastModified:new Date,lastModifiedBy:(Y==null?void 0:Y.uid)||"unknown"});return W&&(await _t(X,W),console.log("✅ Todo 저장 완료:",{todoId:S.id,version:W.version})),!0}catch(O){return console.error("attemptSaveTodo failed",O),!1}},[Y,l,o]),z.useEffect(()=>{const S=window.matchMedia("(prefers-color-scheme: dark)"),b=U=>{V==="system"&&C(U.matches)};return C(V==="system"?S.matches:V==="dark"),S.addEventListener("change",b),()=>S.removeEventListener("change",b)},[V]),z.useEffect(()=>{const S=()=>{console.log("🌐 인터넷 연결됨"),Pe("✅ 인터넷에 다시 연결되었습니다"),setTimeout(()=>Pe(""),3e3)},b=()=>{console.log("📡 인터넷 연결 끊김"),Pe("⚠️ 오프라인 모드 - 클라우드 동기화 불가"),setTimeout(()=>Pe(""),5e3)};return navigator.onLine||console.log("📡 현재 오프라인 상태"),window.addEventListener("online",S),window.addEventListener("offline",b),()=>{window.removeEventListener("online",S),window.removeEventListener("offline",b)}},[]),z.useEffect(()=>{try{const S=localStorage.getItem("pwa-prompt-dismissed"),b=Cp(),U=Nl(),O=24*60*60*1e3;let $=!0;if(S)if(S==="installed")$=!1;else{const Q=parseInt(S,10);(isNaN(Q)||Date.now()-Q<O)&&($=!1)}console.log("PWA Check:",{isMobileDevice:b,isInStandalone:U,dismissed:S,canShow:$,userAgent:navigator.userAgent}),b&&!U&&$&&(console.log("Showing PWA prompt immediately"),Ro(!0))}catch(S){console.warn("PWA prompt check failed",S),Cp()&&!Nl()&&Ro(!0)}},[]),z.useEffect(()=>{const S=()=>{try{localStorage.setItem("pwa-installed","true")}catch{}Nl()&&(localStorage.getItem("pwa-onboard-shown")||(_s(!0),setTimeout(()=>_r(!0),4500)))};window.addEventListener("appinstalled",S);try{Nl()&&!localStorage.getItem("pwa-onboard-shown")&&(_s(!0),setTimeout(()=>_r(!0),4500))}catch{}return()=>window.removeEventListener("appinstalled",S)},[]),z.useEffect(()=>{"serviceWorker"in navigator&&navigator.serviceWorker.register("/Nova-AI-Planer/sw.js").then(S=>{console.log("SW registered: ",S);const b=Nl(),U=Cp();b&&U&&setTimeout(()=>{tR().then(O=>{O&&nR()})},2e3)}).catch(S=>{console.log("SW registration failed: ",S)})},[]),z.useEffect(()=>{},[V,I]);const Cs=z.useRef(null);z.useEffect(()=>{if(!(!Vr||!Y))return Cs.current&&clearTimeout(Cs.current),Cs.current=setTimeout(()=>{Ss()},5e3),()=>{Cs.current&&clearTimeout(Cs.current)}},[i,o,n,V,I,B,ci,M,Vr,Y]),z.useEffect(()=>{const S=dg.find(U=>U.id===B)||dg[0],b=I?S.darkThemeClass:S.lightThemeClass;document.body.className="",I&&document.body.classList.add("dark-mode"),b&&document.body.classList.add(b)},[B,I]),z.useEffect(()=>{if(ps){const S=setTimeout(()=>Pe(""),3e3);return()=>clearTimeout(S)}},[ps]);const Nn=z.useMemo(()=>{let S=[...i];return l===null?S=S.filter(b=>{if(b.isSharedTodo===!0)return!1;const U=o.find(O=>O.id===b.folderId);return U?U.isShared!==!0:!0}):l==="all"?S=S:S=S.filter(b=>b.folderId===l),E==="deadline"?S.sort((b,U)=>!b.deadline&&!U.deadline?0:b.deadline?U.deadline?new Date(b.deadline).getTime()-new Date(U.deadline).getTime():-1:1):E==="newest"?S.sort((b,U)=>U.id-b.id):E==="alphabetical"&&S.sort((b,U)=>b.wish.localeCompare(U.wish)),f==="active"&&(S=S.filter(b=>!b.completed)),f==="completed"&&(S=S.filter(b=>b.completed)),g!=="all"&&(S=S.filter(b=>(b.category||"other")===g)),S},[i,f,E,g,l]),Dn=async S=>{const b={...S,id:Date.now(),completed:!1,lastCompletedDate:null,streak:0,folderId:l==="all"||l===null?void 0:l};if(Y)try{const U=o.find(X=>X.id===l),O=(U==null?void 0:U.ownerId)||Y.uid,$=lt(pe,"users",O,"todos"),Q=Ve($,b.id.toString()),J=Lt(b);J?(await _t(Q,J),console.log("✅ 목표 Firestore 저장:",{targetOwnerUid:O,newTodo:J})):console.warn("⚠️ 정제 후 저장할 데이터가 없음")}catch(U){console.error("❌ 목표 Firestore 저장 실패:",U)}s(U=>{const O=[b,...U];return console.log("🟢 setTodos after add:",O),O}),u(null),p("all"),ye(!1)},As=async S=>{const b=S.map((U,O)=>({...U,id:Date.now()+O,completed:!1,lastCompletedDate:null,streak:0,folderId:l||void 0})).reverse();if(Y)try{const U=o.find($=>$.id===l),O=(U==null?void 0:U.ownerId)||Y.uid;for(const $ of b){const Q=lt(pe,"users",O,"todos"),J=Ve(Q,$.id.toString()),X=Lt($);X?await _t(J,X):console.warn("⚠️ 정제 후 저장할 데이터가 없음:",$.id)}console.log("✅ 여러 목표 Firestore 저장:",{targetOwnerUid:O,count:b.length})}catch(U){console.error("❌ 여러 목표 Firestore 저장 실패:",U)}s(U=>[...b,...U]),ye(!1)},hi=async S=>{if(Y)try{const b=o.find(J=>J.id===S.folderId),U=(b==null?void 0:b.ownerId)||Y.uid,O=lt(pe,"users",U,"todos"),$=Ve(O,S.id.toString()),Q=Lt(S);Q?(await _t($,Q),console.log("✅ 목표 업데이트 Firestore 저장:",{targetOwnerUid:U,updatedTodo:Q})):console.warn("⚠️ 정제 후 저장할 데이터가 없음")}catch(b){console.error("❌ 목표 업데이트 Firestore 저장 실패:",b)}s(i.map(b=>b.id===S.id?S:b)),fe(null)},fl=async S=>{const b=i.find(O=>O.id===S),U=i.filter(O=>O.id!==S);if(s(U),Y&&b)try{const O=o.find(X=>X.id===b.folderId),$=(O==null?void 0:O.ownerId)||Y.uid,Q=lt(pe,"users",$,"todos"),J=Ve(Q,S.toString());await Ft(J),console.log("✅ 개별 목표 Firestore 삭제:",{targetOwnerUid:$,id:S});try{const X=Ve(pe,"users",$,"data","todos");await _t(X,{todos:U,lastUpdated:new Date().toISOString()},{merge:!0}),console.log("✅ 백업 데이터 업데이트 완료 - 삭제 반영")}catch(X){console.warn("⚠️ 백업 데이터 업데이트 실패:",X)}Vr&&setTimeout(()=>{Ss()},1e3)}catch(O){console.error("❌ 목표 Firestore 삭제 실패:",O),b&&s($=>[...$,b])}},Ye=async S=>{var U;if(!S.trim()){Te({title:"Error",message:"Folder name cannot be empty."});return}const b={id:Date.now().toString(),name:S,ownerId:((U=Si.currentUser)==null?void 0:U.uid)||"unknown",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),color:"#3b82f6",collaborationSettings:{enabled:!1,showPresence:!0,showEditingState:!0,enableConflictDetection:!0,allowGuestView:!1,requireApproval:!0},isShared:!1};if(a([...o,b]),Y)try{const{doc:O,setDoc:$}=await Ms(async()=>{const{doc:J,setDoc:X}=await Promise.resolve().then(()=>Ls);return{doc:J,setDoc:X}},void 0),Q=O(pe,"users",Y.uid,"folders",b.id);await $(Q,{name:b.name,color:b.color,ownerId:b.ownerId,createdAt:b.createdAt,updatedAt:b.updatedAt,isShared:b.isShared,collaborators:[],collaborationSettings:b.collaborationSettings}),console.log("✅ 폴더 Firebase 저장 완료:",b.id)}catch(O){console.error("❌ 폴더 Firebase 저장 실패:",O)}return console.log("📁 새 폴더 생성:",{name:S,collaborationEnabled:!1}),b},fi=z.useCallback(async(S,b)=>{try{if(a(U=>U.map(O=>{if(O.id===S){const $={...O.collaborationSettings,...b};return console.log("⚙️ 공동작업 설정 업데이트:",{folderId:S,settings:$}),{...O,collaborationSettings:$,updatedAt:new Date().toISOString()}}return O})),Y){const U=Ve(pe,"users",Y.uid,"folders",S);await ug(U,{collaborationSettings:{...b},updatedAt:new Date().toISOString()})}}catch(U){console.error("공동작업 설정 업데이트 실패:",U)}},[Y]),xs=z.useCallback(async(S,b)=>{await fi(S,{enabled:b}),b?(a(U=>U.map(O=>O.id===S?{...O,isShared:!0}:O)),console.log("🤝 폴더 공동작업 활성화:",S)):(x([]),D({}),console.log("🔒 폴더 공동작업 비활성화:",S))},[fi]);z.useCallback(()=>{if(!l)return null;const S=o.find(b=>b.id===l);return(S==null?void 0:S.collaborationSettings)||null},[l,o]);const Rs=(S,b)=>{if(!b.trim()){Te({title:"Error",message:"Folder name cannot be empty."});return}a(o.map(U=>U.id===S?{...U,name:b,updatedAt:new Date().toISOString()}:U))},vc=async S=>{const b=o.find(O=>O.id===S);if(!b)return;const U=i.filter(O=>O.folderId===S);if(Y&&U.length>0)try{for(const O of U){const $={...O};delete $.folderId;const Q=b.ownerId||Y.uid,J=lt(pe,"users",Q,"todos"),X=Ve(J,O.id.toString()),W=Lt($);W?(await _t(X,W),console.log(`✅ 목표 ${O.id} Firebase 루트로 이동 완료`)):console.warn(`⚠️ 목표 ${O.id} 데이터 정제 실패`)}console.log("✅ 폴더 삭제 시 목표들 Firebase 이동 완료:",{count:U.length})}catch(O){console.error("❌ 폴더 삭제 시 목표 이동 실패:",O)}if(Y)try{const O=Ve(pe,"users",Y.uid,"folders",S);await Ft(O),console.log("✅ 폴더 Firebase 삭제 완료:",S)}catch(O){console.error("❌ 폴더 Firebase 삭제 실패:",O)}s(i.map(O=>{if(O.folderId===S){const $={...O};return delete $.folderId,$}return O})),a(o.filter(O=>O.id!==S)),l===S&&u(null)},pl=async S=>{if(!Je.trim()||!Y){Ae("");return}try{const b={...S,name:Je.trim(),updatedAt:new Date().toISOString()},U=Ve(pe,"users",Y.uid,"folders",S.id),O=Lt(b);if(O)await _t(U,O),console.log("✅ 폴더 이름 변경 Firestore 저장 완료");else throw new Error("폴더 데이터 정제 실패");a(o.map($=>$.id===S.id?b:$)),Ae(""),console.log("✅ 폴더 이름 변경 완료:",Je.trim())}catch(b){console.error("❌ 폴더 이름 변경 실패:",b),Ae("")}},Rf=async S=>{var b;if(!(!Qe.trim()||!Y||kn)){fr(!0);try{if(((b=S.sharedWith)==null?void 0:b.some(X=>X.email===Qe.trim()))||S.ownerEmail===Qe.trim()){alert("이미 초대된 사용자입니다."),fr(!1);return}const O={email:Qe.trim(),userId:"",role:hr,addedAt:new Date().toISOString()},$={...S,sharedWith:[...S.sharedWith||[],O],updatedAt:new Date().toISOString()},Q=Ve(pe,"users",Y.uid,"folders",S.id),J=Lt($);if(J)await _t(Q,J),console.log("✅ 협업자 초대 Firestore 저장 완료");else throw new Error("폴더 데이터 정제 실패");a(o.map(X=>X.id===S.id?{...$,sharedWith:Array.isArray($.sharedWith)?$.sharedWith.filter(W=>W&&typeof W.role=="string"&&["owner","editor","viewer"].includes(W.role)).map(W=>({...W,role:W.role})):[]}:X)),zt(""),console.log("✅ 협업자 초대 완료:",O)}catch(U){console.error("❌ 협업자 초대 실패:",U)}finally{fr(!1)}}},Pf=async(S,b,U)=>{var O;if(Y)try{const $={...S,sharedWith:(O=S.sharedWith)==null?void 0:O.map(X=>X.userId===b?{...X,role:U}:X),updatedAt:new Date().toISOString()},Q=Ve(pe,"users",Y.uid,"folders",S.id),J=Lt($);if(J)await _t(Q,J);else throw new Error("폴더 데이터 정제 실패");a(o.map(X=>X.id===S.id?{...$,sharedWith:Array.isArray($.sharedWith)?$.sharedWith.filter(W=>W&&typeof W.role=="string"&&["owner","editor","viewer"].includes(W.role)).map(W=>({...W,role:W.role})):[]}:X)),console.log("✅ 협업자 역할 변경 완료:",{userId:b,newRole:U})}catch($){console.error("❌ 협업자 역할 변경 실패:",$)}},kf=async(S,b)=>{var U;if(Y&&confirm("이 협업자를 제거하시겠습니까?"))try{const O={...S,sharedWith:(U=S.sharedWith)==null?void 0:U.filter(J=>J.userId!==b),updatedAt:new Date().toISOString()},$=Ve(pe,"users",Y.uid,"folders",S.id),Q=Lt(O);if(Q)await _t($,Q);else throw new Error("폴더 데이터 정제 실패");a(o.map(J=>J.id===S.id?O:J)),console.log("✅ 협업자 제거 완료:",b)}catch(O){console.error("❌ 협업자 제거 실패:",O)}},Nf=S=>{const b=`${window.location.origin}${window.location.pathname}?invite=${S.id}`;navigator.clipboard.writeText(b).then(()=>{alert("공유 링크가 복사되었습니다!")}).catch(()=>{alert("링크 복사에 실패했습니다.")})},Ps=S=>{confirm(oe("folder_leave_confirm"))&&Fr(S)},Fr=async S=>{var b;if(Y)try{const U={...S,sharedWith:(b=S.sharedWith)==null?void 0:b.filter(Q=>Q.userId!==Y.uid),updatedAt:new Date().toISOString()},O=Ve(pe,"users",S.ownerId,"folders",S.id),$=Lt(U);if($)await _t(O,$);else throw new Error("폴더 데이터 정제 실패");a(o.filter(Q=>Q.id!==S.id)),l===S.id&&u(null),Ee(!1),console.log("✅ 폴더 나가기 완료")}catch(U){console.error("❌ 폴더 나가기 실패:",U)}},Tc=S=>{confirm(oe("folder_delete_confirm"))&&(vc(S.id),Ee(!1))},Ec=S=>{if(u(S),S&&Y){const b=o.find(U=>U.id===S);b!=null&&b.ownerId&&(async()=>{try{console.log("📥 Firestore에서 폴더 목표 로드:",{folderId:S,ownerUid:b.ownerId});const U=lt(pe,"users",b.ownerId,"todos"),O=Bl(U,ql("folderId","==",S)),$=await wi(O),Q=[];$.forEach(J=>{Q.push({id:parseInt(J.id),...J.data()})}),console.log("✅ 폴더 목표 로드 완료:",{count:Q.length,todos:Q}),s(J=>{const X=J.filter(he=>he.folderId!==S),W=new Set(X.map(he=>he.id)),ne=Q.filter(he=>!W.has(he.id)),K=[...X,...ne];return console.log("🔄 목표 병합 완료:",{기존목표:X.length,새로운목표:ne.length,전체목표:K.length,중복제거됨:Q.length-ne.length}),K})}catch(U){console.error("❌ 폴더 목표 로드 실패:",U)}})()}},Ic=async()=>{if(!l||!Y){Pe("❌ 동기화할 폴더가 없습니다");return}cn(!0);try{console.log("🔄 폴더 정보 재로딩 중...",l);const{doc:S,getDoc:b,collection:U,query:O,where:$,getDocs:Q}=await Ms(async()=>{const{doc:me,getDoc:Ne,collection:tt,query:bn,where:mi,getDocs:Ns}=await Promise.resolve().then(()=>Ls);return{doc:me,getDoc:Ne,collection:tt,query:bn,where:mi,getDocs:Ns}},void 0);let J=o.find(me=>me.id===l);if(!J||!J.collaborators||J.collaborators.length===0){console.log("⚠️ 로컬 폴더 정보가 불완전함, Firebase에서 재로딩...");const me=S(pe,"users",Y.uid,"folders",l),Ne=await b(me);if(Ne.exists())J={id:l,...Ne.data()},console.log("✅ 사용자 폴더에서 로드됨:",J);else{console.log("🔍 공유된 폴더 검색 중..."),Te({title:"📡 폴더 정보 로딩 중",message:`폴더 정보를 불러오는 중입니다.
잠시 후 다시 시도하거나 새로고침해주세요.`,confirmText:"확인",onConfirm:()=>Te(null)}),cn(!1);return}}if(!J||!J.collaborators||J.collaborators.length===0){Te({title:"❌ 협업 폴더 아님",message:`이것은 공유 폴더가 아닙니다.
개인 폴더는 개별적으로 동기화됩니다.`,confirmText:"확인",onConfirm:()=>Te(null)}),cn(!1);return}const X=J.collaborators.find(me=>me.role==="owner");if(!X||!X.userId){Te({title:"❌ 소유자 정보 오류",message:`폴더 소유자 정보가 없습니다.
폴더를 다시 공유받아주세요.`,confirmText:"확인",onConfirm:()=>Te(null)}),cn(!1);return}if(X.userId.startsWith("owner_")){console.warn("⚠️ 임시 소유자 ID 발견:",X.userId),Te({title:"⚠️ 소유자 정보 오류",message:`폴더 소유자 정보에 문제가 있습니다.
폴더 소유자에게 새로운 공유 링크를 요청해주세요.`,confirmText:"확인",onConfirm:()=>Te(null)}),cn(!1);return}console.log("🔄 수동 동기화 시작:",{folderId:l,ownerUid:X.userId});const W=i.filter(me=>me.folderId===l);console.log("📊 현재 로컬 목표 수:",W.length);const ne=U(pe,"users",X.userId,"todos"),K=O(ne,$("folderId","==",l)),he=await Q(K),ue=[];he.forEach(me=>{ue.push({id:parseInt(me.id),...me.data()})}),console.log("📊 서버 목표 수:",ue.length),W.length===ue.length?(console.log("✅ 실시간 동기화가 정상 작동 중입니다"),Pe(`✅ 동기화 확인 완료 (${ue.length}개 항목 - 이미 최신 상태)`)):(console.log("⚠️ 로컬과 서버 데이터 불일치 감지:",{local:W.length,server:ue.length}),s(me=>[...me.filter(bn=>bn.folderId!==l),...ue]),Pe(`🔄 동기화 완료 (${ue.length}개 항목 - ${Math.abs(ue.length-W.length)}개 차이 수정)`)),console.log("📡 실시간 리스너 상태:",l&&Y?"활성":"비활성")}catch(S){console.error("❌ 동기화 실패:",S),S instanceof Error?S.message.includes("permission-denied")?Pe("❌ 동기화 실패: 폴더 접근 권한이 없습니다"):S.message.includes("not-found")?Pe("❌ 동기화 실패: 폴더를 찾을 수 없습니다"):Pe("❌ 동기화 실패: "+S.message):Pe("❌ 동기화 실패: 알 수 없는 오류")}finally{cn(!1)}},wc=async()=>{cn(!0);try{console.log("🔄 수동 동기화 시작..."),await Ss(),Pe("✅ 데이터 동기화 완료"),console.log("✅ 수동 동기화 완료")}catch(S){console.error("❌ 수동 동기화 실패:",S),Pe("❌ 동기화 실패")}finally{cn(!1)}},Sc=async(S,b)=>{const U=i.find(J=>J.id===S);if(!U)return;const O=o.find(J=>J.id===b),$=(O==null?void 0:O.isShared)===!0,Q={...U,folderId:b||void 0,isSharedTodo:$};if(Y)try{const J=o.find(he=>he.id===(b||U.folderId)),X=(J==null?void 0:J.ownerId)||Y.uid,W=lt(pe,"users",X,"todos"),ne=Ve(W,S.toString()),K=Lt(Q);K?(await _t(ne,K),console.log("✅ 목표 폴더 이동 Firestore 저장:",{targetOwnerUid:X,goalId:S,folderId:b,isSharedTodo:Q.isSharedTodo})):console.warn("⚠️ 정제 후 저장할 데이터가 없음")}catch(J){console.error("❌ 목표 폴더 이동 Firestore 저장 실패:",J)}s(i.map(J=>J.id===S?Q:J)),Pe("✅ 목표가 폴더로 이동되었습니다"),setTimeout(()=>Pe(""),3e3)},pi=async S=>{const b=new Date().toISOString(),U=(()=>{const O=i.find(J=>J.id===S);if(!O)return null;const $=!O.completed;let Q=O.streak;return O.isRecurring&&($?(!O.lastCompletedDate||!uu(b,O.lastCompletedDate))&&(Q=(O.streak||0)+1):O.lastCompletedDate&&uu(b,O.lastCompletedDate)&&(Q=Math.max(0,(O.streak||1)-1))),{...O,completed:$,lastCompletedDate:$?b:O.lastCompletedDate,streak:Q}})();if(U){if(Y)try{const O=o.find(W=>W.id===U.folderId),$=(O==null?void 0:O.ownerId)||Y.uid,Q=lt(pe,"users",$,"todos"),J=Ve(Q,S.toString()),X=Lt(U);X?(await _t(J,X),console.log("✅ 목표 완료 상태 Firestore 저장:",{targetOwnerUid:$,id:S,completed:U.completed})):console.warn("⚠️ 정제 후 저장할 데이터가 없음")}catch(O){console.error("❌ 목표 완료 상태 Firestore 저장 실패:",O)}s(i.map(O=>O.id===S?U:O))}},Df=async S=>{if(S==="ai"){if(i.length<2){Te({title:oe("sort_alert_title"),message:oe("sort_alert_message")});return}Fe(!0);try{const b=di();if(!b){Pe(vs?"오프라인 모드에서는 AI 정렬을 사용할 수 없습니다.":"AI 정렬을 사용하려면 설정에서 API 키를 입력해주세요."),Fe(!1),R("manual");return}const U=`Here is a list of goals with their details (wish, outcome, obstacle, plan, deadline). Prioritize them based on urgency (closer deadline), importance (based on outcome), and feasibility (based on plan). Return a JSON object with "sorted_ids" array and "reasoning" string explaining your prioritization logic. Goals: ${JSON.stringify(i.map(({id:K,wish:he,outcome:ue,obstacle:ae,plan:me,deadline:Ne})=>({id:K,wish:he,outcome:ue,obstacle:ae,plan:me,deadline:Ne})))}`,O=await b.models.generateContent({model:"gemini-2.5-flash",contents:U,config:{responseMimeType:"application/json",responseSchema:{type:On.OBJECT,properties:{sorted_ids:{type:On.ARRAY,items:{type:On.NUMBER}},reasoning:{type:On.STRING}}}}}),$=JSON.parse(O.text),Q=$.sorted_ids.map(Number),J=new Map(i.map(K=>[Number(K.id),K])),X=Q.map(K=>J.get(K)).filter(Boolean),W=i.filter(K=>!Q.includes(Number(K.id))),ne=[...X,...W].map(K=>({...K,id:Number(K.id)}));s(ne),R("manual"),al($.reasoning||""),xo(!0)}catch(b){console.error("AI sort failed:",b),Te({title:oe("ai_sort_error_title"),message:oe("ai_sort_error_message")})}finally{Fe(!1)}}else R(S)},bf=S=>{const b=new Set(fs);b.has(S)?b.delete(S):b.add(S),mr(b)},Cc=()=>{Co(!1),mr(new Set)},yr=()=>{const S=new Set(Nn.map(b=>b.id));mr(S)},Mf=()=>{const S=fs.size;Te({title:oe("delete_selected_confirm_title"),message:oe("delete_selected_confirm_message").replace("{count}",String(S)),isDestructive:!0,confirmText:oe("delete_selected_button_label").replace("{count}",String(S)),cancelText:oe("cancel_button"),onConfirm:()=>{s(i.filter(b=>!fs.has(b.id))),Cc()}})},ml=()=>{li("exporting");const S=JSON.stringify(i,null,2),b="data:application/json;charset=utf-8,"+encodeURIComponent(S),U="nova_goals.json",O=document.createElement("a");O.setAttribute("href",b),O.setAttribute("download",U),O.click(),setTimeout(()=>{li("idle"),xe(!1)},1500)},Mo=S=>{var O;const b=(O=S.target.files)==null?void 0:O[0];if(!b)return;const U=new FileReader;U.onload=$=>{var Q;try{const J=(Q=$.target)==null?void 0:Q.result;if(typeof J!="string")throw new Error("File content is not a string");const X=JSON.parse(J);if(Array.isArray(X)&&X.every(W=>"wish"in W&&"id"in W))Te({title:oe("import_confirm_title"),message:oe("import_confirm_message"),confirmText:oe("settings_import_data"),cancelText:oe("cancel_button"),onConfirm:()=>{li("importing"),setTimeout(()=>{s(X),Pe(oe("import_success_toast")),li("idle"),xe(!1)},1500)}});else throw new Error("Invalid file format")}catch{Te({title:oe("import_error_alert_title"),message:oe("import_error_alert_message")})}},U.onerror=()=>Te({title:oe("import_error_alert_title"),message:oe("import_error_alert_message")}),U.readAsText(b),S.target.value=""},Ac=()=>{Te({title:"⚠️ 모든 데이터 삭제",message:`정말로 모든 데이터를 삭제하시겠습니까?

이 작업은 되돌릴 수 없습니다:

• 모든 목표와 폴더
• Firebase 클라우드 데이터
• 로컬 설정
• 공유 폴더 데이터
• 실시간 협업 정보`,confirmText:"삭제",cancelText:"취소",isDestructive:!0,onConfirm:()=>{Te(null),ks()},onCancel:()=>{Te(null)}})},ks=async()=>{console.log("🗑️ performDeleteAllData 함수 시작"),li("deleting");try{if(Y){console.log("📧 사용자 정보:",{uid:Y.uid,email:Y.email}),console.log("🗑️ Firebase 데이터 삭제 시작...");try{const W=Ve(pe,"users",Y.uid,"data","todos");await Ft(W),console.log("✅ 백업 todos 데이터 삭제 완료")}catch(W){console.warn("⚠️ 백업 todos 데이터 삭제 실패:",W)}try{const W=Ve(pe,"users",Y.uid,"data","settings");await Ft(W),console.log("✅ 백업 settings 데이터 삭제 완료")}catch(W){console.warn("⚠️ 백업 settings 데이터 삭제 실패:",W)}const S=lt(pe,"users",Y.uid,"todos"),b=await wi(S);console.log("📊 삭제할 todos 개수:",b.size);const U=b.docs.map(W=>Ft(W.ref));await Promise.all(U),console.log("✅ 개별 todos 삭제 완료:",b.size,"개");const O=lt(pe,"users",Y.uid,"folders"),$=await wi(O);console.log("📊 삭제할 folders 개수:",$.size);const Q=$.docs.map(W=>Ft(W.ref));await Promise.all(Q),console.log("✅ folders 삭제 완료:",$.size,"개");const J=lt(pe,"sharedFolders"),X=await wi(J);for(const W of X.docs){const ne=W.data();if(ne.collaborators&&Array.isArray(ne.collaborators)){const K=ne.collaborators.filter(he=>he.userId!==Y.uid);K.length!==ne.collaborators.length&&(await ug(W.ref,{collaborators:K}),console.log("✅ 공유 폴더에서 내 계정 제거:",W.id))}}try{for(const W of o)if(W.id){const ne=Ve(pe,"folderPresence",W.id,"users",Y.uid);await Ft(ne)}console.log("✅ presence 데이터 삭제 완료")}catch(W){console.warn("⚠️ presence 데이터 삭제 중 일부 오류:",W)}try{const W=Bl(lt(pe,"folderEditing"),ql("userId","==",Y.uid)),K=(await wi(W)).docs.map(he=>Ft(he.ref));await Promise.all(K),console.log("✅ editing states 삭제 완료")}catch(W){console.warn("⚠️ editing states 삭제 중 일부 오류:",W)}try{const W=Ve(pe,"users",Y.uid);await Ft(W),console.log("✅ 사용자 프로필 문서 삭제 완료")}catch(W){console.warn("⚠️ 사용자 프로필 문서 삭제 실패:",W)}try{const W=lt(pe,"notifications",Y.uid,"items"),K=(await wi(W)).docs.map(ue=>Ft(ue.ref));await Promise.all(K);const he=Ve(pe,"notifications",Y.uid);await Ft(he),console.log("✅ 알림 데이터 삭제 완료")}catch(W){console.warn("⚠️ 알림 데이터 삭제 중 일부 오류:",W)}try{const W=lt(pe,"userActivity",Y.uid,"logs"),K=(await wi(W)).docs.map(ue=>Ft(ue.ref));await Promise.all(K);const he=Ve(pe,"userActivity",Y.uid);await Ft(he),console.log("✅ 사용자 활동 로그 삭제 완료")}catch(W){console.warn("⚠️ 사용자 활동 로그 삭제 중 일부 오류:",W)}try{const W=Ve(pe,"userMetadata",Y.uid);await Ft(W),console.log("✅ 사용자 메타데이터 삭제 완료")}catch(W){console.warn("⚠️ 사용자 메타데이터 삭제 중 일부 오류:",W)}try{const W=Ve(pe,"userSessions",Y.uid);await Ft(W),console.log("✅ 사용자 세션 데이터 삭제 완료")}catch(W){console.warn("⚠️ 사용자 세션 데이터 삭제 중 일부 오류:",W)}console.log("🔥 모든 클라우드 데이터 삭제 완료 - 사용자 데이터가 완전히 제거되었습니다")}if(console.log("🔄 로컬 상태 초기화 시작..."),s([]),a([]),x([]),D({}),N([]),u(null),mr(new Set),Co(!1),p("all"),v("all"),console.log("⚙️ 설정 초기화 시작..."),r("ko"),C(!0),T("default"),R("manual"),A(["school","work","personal","other"]),console.log("💾 localStorage 초기화 시작..."),localStorage.clear(),console.log("✅ localStorage 완전 삭제 완료"),Y){console.log("🚪 Firebase 로그아웃 처리...");try{await fE(Si),console.log("✅ 로그아웃 완료")}catch(S){console.warn("⚠️ 로그아웃 중 오류:",S)}}console.log("✅ 모든 데이터 삭제 완료"),Pe("✅ 모든 데이터가 완전히 삭제되었습니다. 로그아웃됩니다."),setTimeout(()=>{console.log("🔄 페이지 새로고침으로 완전 초기화..."),window.location.reload()},1500)}catch(S){console.error("❌ 데이터 삭제 중 오류:",S);let b="❌ 삭제 실패",U="데이터 삭제 중 오류가 발생했습니다.";S instanceof Error&&(S.message.includes("permission-denied")||S.message.includes("insufficient permissions")?(b="❌ 권한 부족",U=`삭제 권한이 부족합니다.

잠시 후 다시 시도해주세요.
(Firebase 보안 규칙이 업데이트 중일 수 있습니다)`):S.message.includes("network-request-failed")?(b="❌ 네트워크 오류",U="인터넷 연결을 확인하고 다시 시도해주세요."):S.message.includes("unauthenticated")?(b="❌ 로그인 필요",U=`로그인이 만료되었습니다.
다시 로그인해주세요.`):U=`데이터 삭제 중 오류가 발생했습니다.

오류 내용: `+S.message),Te({title:b,message:U,confirmText:"확인",onConfirm:()=>Te(null)})}finally{li("idle"),xe(!1)}},vr=je||!!Z||!!Kn||pr||!!ze||il||sl||ve||!!Jn||gr,[Vf,xc]=z.useState(!1),[Xe,Lf]=z.useState(()=>typeof window<"u"?window.innerWidth<=600:!1);return z.useEffect(()=>{const S=()=>{Lf(window.innerWidth<=600)};return window.addEventListener("resize",S),()=>window.removeEventListener("resize",S)},[]),m.jsxs("div",{className:`main-page-layout ${_n?"calendar-view-active":""}`,children:[!Xe&&m.jsx("button",{className:"floating-add-btn","aria-label":"목표 추가",onClick:()=>ye(!0),style:{display:vr?"none":"inline-flex"},children:Le.add}),Xe&&m.jsx("button",{className:"floating-add-btn mobile-right-add","aria-label":"목표 추가",onClick:()=>ye(!0),style:{display:vr?"none":"inline-flex"},children:Le.add}),m.jsxs("div",{className:`page-content ${vr?"modal-open":""}`,children:[m.jsx(b3,{folders:o,currentFolderId:l,onSetCurrentFolder:Ec,onCreateFolder:Ye,onRenameFolder:Rs,onDeleteFolder:vc,onSetCollaboratingFolder:ms,todos:i,t:oe,onManageFolder:S=>{rt(S),Ee(!0)},currentUserId:Y==null?void 0:Y.uid,onAddGoal:()=>ye(!0),isAnyModalOpen:vr,isMobileScreen:Xe}),m.jsxs("div",{className:"container",children:[m.jsx(M3,{t:oe,isSelectionMode:fc,selectedCount:fs.size,totalVisibleCount:Nn.length,onCancelSelection:Cc,onDeleteSelected:Mf,onSelectAll:yr,isViewModeCalendar:_n,onToggleViewMode:()=>at(!_n),isAiSorting:$t,sortType:E,onSort:Df,filter:f,onFilter:p,categoryFilter:g,onCategoryFilter:v,userCategories:M,onAddCategory:S=>A([...M,S]),onRemoveCategory:S=>A(M.filter(b=>b!==S)),onSetSelectionMode:()=>Co(!0),onOpenSettings:()=>xe(!0),onAddGoal:Xe?void 0:()=>ye(!0),currentFolderId:l,folders:o,onSyncSharedFolder:Ic,isSyncing:cl,isSyncingData:cl,onManualSync:wc,activeUsers:w,editingStates:k,onToggleCollaboration:xs,onUpdateCollaborationSettings:fi}),_n?m.jsx(z3,{todos:i,t:oe,onGoalClick:jn,language:n}):m.jsx(m.Fragment,{children:m.jsx(V3,{todos:Nn,onToggleComplete:pi,onDelete:fl,onEdit:fe,onInfo:jn,t:oe,filter:f,randomEncouragement:yc,isSelectionMode:fc,selectedTodoIds:fs,onSelectTodo:bf,folders:o,onMoveToFolder:Sc})})]})]}),je&&m.jsx(QI,{onClose:()=>ye(!1),onAddTodo:Dn,onAddMultipleTodos:As,t:oe,language:n,createAI:di,userCategories:M}),Z&&m.jsx(QI,{onClose:()=>fe(null),onEditTodo:hi,existingTodo:Z,t:oe,language:n,createAI:di}),Kn&&m.jsx(O3,{todo:Kn,onClose:()=>jn(null),t:oe,createAI:di,onOpenCollaboration:S=>{const b=o.find(U=>U.id===S.folderId)||(S.folderId===null||S.folderId===void 0?null:void 0);b!==void 0&&ms(b||null)},userCategories:M,onUpdateGoal:hi}),Jn!==void 0&&m.jsx(B3,{folder:Jn,onClose:()=>ms(void 0),t:oe,googleUser:Y,onUpdateCollaborators:hl,setAlertConfig:Te}),pr&&m.jsx(q3,{onClose:()=>xe(!1),isDarkMode:I,onToggleDarkMode:()=>C(!I),themeMode:V,onThemeChange:_c,backgroundTheme:B,onSetBackgroundTheme:T,onExportData:ml,onImportData:Mo,setAlertConfig:Te,onDeleteAllData:Ac,dataActionStatus:rl,language:n,onSetLanguage:r,t:oe,todos:i,setToastMessage:Pe,onOpenVersionInfo:()=>Ao(!0),onOpenUsageGuide:()=>ui(!0),apiKey:ci,onSetApiKey:Qn,isOfflineMode:vs,onToggleOfflineMode:()=>Sf(!vs),googleUser:Y,onGoogleLogin:Yn,onGoogleLogout:xf,onSyncDataToFirebase:Ss,onLoadDataFromFirebase:gc,isGoogleLoggingIn:mc,isGoogleLoggingOut:ul,isSyncingData:cl,isLoadingData:Af,isAutoSyncEnabled:Vr,setIsAutoSyncEnabled:pc,onDiagnoseFirebase:ws}),il&&m.jsx(YI,{onClose:()=>Ao(!1),t:oe}),sl&&m.jsx(G3,{onClose:()=>ui(!1),t:oe}),gr&&m.jsx(So,{onClose:()=>xo(!1),isClosing:!1,className:"ai-sort-reason-modal",children:m.jsxs("div",{style:{padding:"24px"},children:[m.jsx("h2",{style:{marginBottom:"16px",fontSize:"1.3rem",fontWeight:600},children:oe("ai_sort_reason_modal_title")}),m.jsx("div",{style:{marginBottom:"24px",padding:"16px",backgroundColor:"var(--card-bg-color)",borderRadius:"8px",border:"1px solid var(--border-color)",lineHeight:"1.6",color:"var(--text-secondary-color)"},children:ol}),m.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:m.jsx("button",{onClick:()=>xo(!1),className:"primary",children:oe("close_button")})})]})}),il&&m.jsx(YI,{onClose:()=>Ao(!1),t:oe}),ze&&m.jsx($3,{title:ze.title,message:ze.message,onConfirm:()=>{var S;(S=ze.onConfirm)==null||S.call(ze),Te(null)},onCancel:ze.onCancel?()=>{var S;(S=ze.onCancel)==null||S.call(ze),Te(null)}:void 0,confirmText:ze.confirmText,cancelText:ze.cancelText,isDestructive:ze.isDestructive,t:oe}),ps&&m.jsx("div",{className:"toast-notification",children:ps}),gs&&m.jsx(P3,{onInstalled:ll}),Vt&&m.jsx("div",{className:"modal-backdrop",children:m.jsxs("div",{className:"modal-content onboarding-modal",onClick:S=>S.stopPropagation(),children:[m.jsxs("div",{className:"onboarding-header",style:{position:"relative",textAlign:"center"},children:[m.jsx("div",{style:{width:72,height:72,background:"var(--primary-color)",borderRadius:12,display:"inline-flex",alignItems:"center",justifyContent:"center",color:"#fff",fontSize:"28px",marginBottom:12},children:"N"}),m.jsx("h2",{style:{margin:0,fontSize:"1.25rem",fontWeight:700},children:"Nova에 오신 것을 환영합니다"}),m.jsx("p",{style:{marginTop:8,color:"var(--text-secondary-color)"},children:"설치해 주셔서 감사합니다 — Nova의 주요 기능을 빠르게 둘러보실 수 있습니다."})]}),m.jsx("div",{className:"onboarding-body",children:m.jsxs("ul",{style:{textAlign:"left",gap:8,display:"flex",flexDirection:"column"},children:[m.jsx("li",{children:"• 목표 작성 & 관리: 손쉽게 목표를 만들고 추적하세요."}),m.jsx("li",{children:"• Gemini AI 어시스트: 목표를 더 나은 형태로 정리해줍니다."}),m.jsx("li",{children:"• PWA 알림: 푸시로 마감 알림을 받을 수 있습니다."}),m.jsx("li",{children:"• 오프라인 지원 및 클라우드 동기화"})]})}),m.jsx("div",{className:"onboarding-footer",style:{display:"flex",justifyContent:"center",gap:12,padding:"12px 20px 24px 20px"},children:ys?m.jsx("button",{className:"primary",onClick:()=>{try{localStorage.setItem("pwa-onboard-shown","true")}catch{}_s(!1)},style:{padding:"12px 20px",borderRadius:12,background:"var(--primary-color)",color:"#fff",border:"none"},children:"시작하기"}):m.jsx("div",{style:{color:"var(--text-secondary-color)"},children:"시작 버튼이 곧 나타납니다..."})})]})}),ve&&Oe&&m.jsx("div",{className:"modal-backdrop",onClick:()=>Ee(!1),children:m.jsxs("div",{className:"modal-content large-modal",onClick:S=>S.stopPropagation(),children:[m.jsxs("div",{className:"modal-header",children:[m.jsx("h3",{children:oe("folder_manage_title")}),m.jsx("button",{onClick:()=>Ee(!1),children:"✕"})]}),m.jsx("div",{className:"modal-body",children:(()=>{var O,$,Q;const S=o.find(J=>J.id===Oe);if(!S)return null;const b=S.ownerId===(Y==null?void 0:Y.uid),U=b?"owner":(($=(O=S.sharedWith)==null?void 0:O.find(J=>J.userId===(Y==null?void 0:Y.uid)))==null?void 0:$.role)||"viewer";return m.jsxs("div",{className:"folder-manage-content",children:[m.jsxs("div",{className:"folder-info-section",children:[m.jsx("h4",{children:oe("folder_manage_info")}),m.jsxs("div",{className:"folder-info-item",children:[m.jsxs("label",{children:[oe("folder_name"),":"]}),Je?m.jsxs("div",{className:"inline-edit",children:[m.jsx("input",{type:"text",value:Je,onChange:J=>Ae(J.target.value),onKeyPress:J=>{J.key==="Enter"&&pl(S)}}),m.jsx("button",{onClick:()=>pl(S),children:"✓"}),m.jsx("button",{onClick:()=>Ae(""),children:"✕"})]}):m.jsxs("div",{className:"folder-name-display",children:[m.jsx("span",{children:S.name}),b&&m.jsx("button",{className:"edit-btn",onClick:()=>Ae(S.name),children:"✏️"})]})]}),m.jsxs("div",{className:"folder-info-item",children:[m.jsxs("label",{children:[oe("folder_owner"),":"]}),m.jsx("span",{children:S.ownerEmail||S.ownerId})]}),m.jsxs("div",{className:"folder-info-item",children:[m.jsxs("label",{children:[oe("role"),":"]}),m.jsx("span",{children:oe(U==="owner"?"folder_role_owner":U==="editor"?"folder_role_editor":"folder_role_viewer")})]}),m.jsxs("div",{className:"folder-info-item",children:[m.jsxs("label",{children:[oe("created_date"),":"]}),m.jsx("span",{children:new Date(S.createdAt).toLocaleDateString()})]})]}),m.jsxs("div",{className:"collaborators-section",children:[m.jsx("h4",{children:oe("folder_manage_collaborators")}),m.jsxs("div",{className:"collaborator-list",children:[m.jsx("div",{className:"collaborator-item owner",children:m.jsxs("div",{className:"collaborator-info",children:[m.jsx("span",{className:"email",children:S.ownerEmail||S.ownerId}),m.jsx("span",{className:"role owner-role",children:oe("folder_role_owner")})]})}),((Q=S.sharedWith)==null?void 0:Q.map((J,X)=>m.jsxs("div",{className:"collaborator-item",children:[m.jsxs("div",{className:"collaborator-info",children:[m.jsx("span",{className:"email",children:J.email||J.userId}),m.jsx("span",{className:`role ${J.role}`,children:J.role==="editor"?oe("folder_role_editor"):oe("folder_role_viewer")})]}),b&&m.jsxs("div",{className:"collaborator-actions",children:[m.jsxs("select",{value:J.role,onChange:W=>Pf(S,J.userId,W.target.value),children:[m.jsx("option",{value:"editor",children:oe("folder_role_editor")}),m.jsx("option",{value:"viewer",children:oe("folder_role_viewer")})]}),m.jsx("button",{className:"remove-btn",onClick:()=>kf(S,J.userId),children:"🗑️"})]})]},X)))||[]]}),(b||U==="editor")&&m.jsxs("div",{className:"invite-section",children:[m.jsx("h5",{children:oe("folder_invite_new")}),m.jsxs("div",{className:"invite-form",children:[m.jsx("input",{type:"email",placeholder:oe("folder_invite_email"),value:Qe,onChange:J=>zt(J.target.value)}),m.jsxs("select",{value:hr,onChange:J=>Wn(J.target.value),children:[m.jsx("option",{value:"editor",children:oe("folder_role_editor")}),m.jsx("option",{value:"viewer",children:oe("folder_role_viewer")})]}),m.jsx("button",{onClick:()=>Rf(S),disabled:!Qe||kn,children:kn?"초대 중...":oe("folder_invite_button")})]})]})]}),m.jsxs("div",{className:"folder-settings-section",children:[m.jsx("h4",{children:oe("folder_manage_settings")}),m.jsxs("div",{className:"share-link-section",children:[m.jsx("label",{children:oe("folder_share_link")}),m.jsx("p",{className:"share-link-desc",children:oe("folder_share_link_desc")}),m.jsxs("div",{className:"share-link-input",children:[m.jsx("input",{type:"text",readOnly:!0,value:`${window.location.origin}${window.location.pathname}?invite=${S.id}`}),m.jsx("button",{onClick:()=>Nf(S),children:oe("folder_copy_link")})]})]}),m.jsxs("div",{className:"folder-actions",children:[!b&&m.jsx("button",{className:"leave-folder-btn",onClick:()=>Ps(S),children:oe("folder_leave")}),b&&m.jsx("button",{className:"delete-folder-btn",onClick:()=>Tc(S),children:oe("folder_delete")})]})]})]})})()})]})})]})},b3=({folders:t,currentFolderId:e,onSetCurrentFolder:n,onCreateFolder:r,onRenameFolder:i,onDeleteFolder:s,onSetCollaboratingFolder:o,todos:a,t:l,onManageFolder:u,currentUserId:f,onAddGoal:p,isAnyModalOpen:g,isMobileScreen:v})=>{var B;const[E,R]=z.useState(!1),[M,A]=z.useState(null),[I,C]=z.useState(""),[V,F]=z.useState(null);return m.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid var(--border-color)",overflowX:"auto",display:"flex",gap:"8px",alignItems:"center",backgroundColor:"var(--card-bg-color)",position:"relative"},children:[m.jsxs("button",{onClick:()=>n(null),style:{padding:"6px 12px",borderRadius:"8px",border:"none",backgroundColor:e===null?"var(--primary-color)":"transparent",color:e===null?"white":"var(--text-color)",cursor:"pointer",fontSize:"0.9rem",fontWeight:500,whiteSpace:"nowrap",transition:"all 0.2s",minWidth:"80px",textAlign:"center"},children:["📁 ",l("all_goals_label")||"All"]}),m.jsx("button",{onClick:()=>n("all"),style:{padding:"6px 12px",borderRadius:"8px",border:"none",backgroundColor:e==="all"?"#ff6b6b":"transparent",color:e==="all"?"white":"var(--text-color)",cursor:"pointer",fontSize:"0.9rem",fontWeight:500,whiteSpace:"nowrap",transition:"all 0.2s",minWidth:"80px",textAlign:"center"},children:"🌐 전체"}),m.jsx("div",{style:{display:"flex",flex:1,gap:"8px",alignItems:"center"},children:t.length>0&&t.filter(T=>e===null?!T.isShared||T.isShared&&T.ownerId===f:!0).map(T=>{const w=a.filter(x=>x.folderId===T.id).length;return m.jsxs("div",{style:{position:"relative",display:"inline-flex",alignItems:"center",gap:"2px"},children:[m.jsxs("button",{onClick:()=>n(T.id),style:{padding:"6px 12px",borderRadius:"8px",border:"none",backgroundColor:e===T.id?T.color||"var(--primary-color)":`${T.color}20`||"transparent",color:e===T.id?"white":"var(--text-color)",cursor:"pointer",fontSize:"0.9rem",fontWeight:500,whiteSpace:"nowrap",transition:"all 0.2s",position:"relative"},title:T.isShared?"공유 폴더":"개인 폴더",children:[T.isShared?"👥":"📁"," ",T.name," (",w,")"]}),e===T.id&&m.jsxs("div",{style:{display:"flex",gap:"2px"},children:[m.jsx("button",{onClick:()=>o(T),style:{width:"24px",height:"24px",padding:"0",borderRadius:"4px",border:"none",backgroundColor:"var(--primary-color)",color:"white",cursor:"pointer",fontSize:"0.8rem",lineHeight:"1",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s"},title:"폴더 협업",children:"👥"}),m.jsx("button",{onClick:()=>u(T.id),style:{width:"24px",height:"24px",padding:"0",borderRadius:"4px",border:"none",backgroundColor:"var(--button-bg-color)",color:"var(--text-color)",cursor:"pointer",fontSize:"0.8rem",lineHeight:"1",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s"},title:"폴더 관리",children:"⚙️"}),m.jsx("button",{onClick:()=>{A(T.id),C(T.name)},style:{width:"24px",height:"24px",padding:"0",borderRadius:"4px",border:"none",backgroundColor:"var(--button-bg-color)",color:"var(--text-color)",cursor:"pointer",fontSize:"0.8rem",lineHeight:"1",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s"},title:"폴더 이름 변경",children:"✏"}),m.jsx("button",{onClick:()=>{F(T.id)},style:{width:"24px",height:"24px",padding:"0",borderRadius:"4px",border:"none",backgroundColor:"var(--danger-color)",color:"white",cursor:"pointer",fontSize:"0.8rem",lineHeight:"1",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s"},title:"폴더 삭제",children:"×"})]})]},T.id)})}),m.jsx("button",{onClick:()=>R(!0),style:{padding:"6px 12px",borderRadius:"8px",border:"2px solid var(--primary-color)",backgroundColor:"transparent",color:"var(--primary-color)",cursor:"pointer",fontSize:"0.9rem",fontWeight:500,whiteSpace:"nowrap",transition:"all 0.2s",display:"flex",alignItems:"center",gap:"4px"},children:"➕ 폴더"}),E&&m.jsx(A3,{onClose:()=>R(!1),onCreate:T=>{T&&T.name&&r(T.name),R(!1)},t:l}),V&&m.jsx("div",{className:"modal-backdrop alert-backdrop",children:m.jsxs("div",{className:"modal-content alert-modal",children:[m.jsxs("div",{className:"alert-content",children:[m.jsx("h2",{children:"폴더 삭제"}),m.jsxs("p",{style:{fontSize:"0.9rem"},children:['"',(B=t.find(T=>T.id===V))==null?void 0:B.name,'" 폴더를 삭제하시겠습니까?',m.jsx("br",{}),'폴더 내 목표는 "나의 목표"로 이동됩니다.']})]}),m.jsxs("div",{className:"modal-buttons",children:[m.jsx("button",{onClick:()=>F(null),className:"secondary",children:"취소"}),m.jsx("button",{onClick:()=>{s(V),F(null)},className:"destructive",children:"삭제"})]})]})}),M&&m.jsx("div",{className:"modal-backdrop alert-backdrop",children:m.jsxs("div",{className:"modal-content alert-modal",children:[m.jsxs("div",{className:"alert-content",children:[m.jsx("h2",{children:"폴더 이름 변경"}),m.jsx("p",{style:{fontSize:"0.9rem",marginBottom:"16px"},children:"새로운 폴더 이름을 입력하세요"}),m.jsx("input",{type:"text",value:I,onChange:T=>C(T.target.value),onKeyPress:T=>{T.key==="Enter"&&I.trim()&&(i(M,I),A(null),C(""))},placeholder:"폴더 이름...",autoFocus:!0,style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontSize:"0.95rem",outline:"none",boxSizing:"border-box"}})]}),m.jsxs("div",{className:"modal-buttons",children:[m.jsx("button",{onClick:()=>{A(null),C("")},className:"secondary",children:"취소"}),m.jsx("button",{onClick:()=>{I.trim()&&(i(M,I),A(null),C(""))},className:"primary",children:"변경"})]})]})})]})},M3=({t,isSelectionMode:e,selectedCount:n,totalVisibleCount:r,onCancelSelection:i,onDeleteSelected:s,onSelectAll:o,isViewModeCalendar:a,onToggleViewMode:l,isAiSorting:u,sortType:f,onSort:p,filter:g,onFilter:v,categoryFilter:E,onCategoryFilter:R,userCategories:M,onAddCategory:A,onRemoveCategory:I,onSetSelectionMode:C,onOpenSettings:V,onAddGoal:F,currentFolderId:B,folders:T,onSyncSharedFolder:w,isSyncing:x,isSyncingData:k,onManualSync:D,activeUsers:L,editingStates:N,onToggleCollaboration:Me,onUpdateCollaborationSettings:et,isMobileScreen:je})=>{const[ye,Z]=z.useState(!1),[fe,ve]=z.useState(!1),Ee=B?T.find(Ae=>Ae.id===B):null,Oe=Ee==null?void 0:Ee.collaborationSettings;Oe!=null&&Oe.enabled||Ee!=null&&Ee.isShared,z.useEffect(()=>{const Ae=()=>{Z(!1),ve(!1)};return document.addEventListener("click",Ae),document.addEventListener("touchstart",Ae),()=>{document.removeEventListener("click",Ae),document.removeEventListener("touchstart",Ae)}},[]);const rt=Ae=>{Ae.stopPropagation(),Z(Qe=>!Qe)},Je=Ae=>{Ae.stopPropagation()};return m.jsxs("header",{children:[m.jsx("div",{className:"header-left",children:e&&m.jsx("button",{onClick:i,className:"header-action-button",children:t("cancel_selection_button_label")})}),m.jsxs("div",{className:"header-title-group",children:[m.jsx("h1",{children:t("my_goals_title")}),!e&&m.jsxs("div",{className:"header-inline-actions",children:[m.jsx("button",{onClick:l,className:"header-icon-button","aria-label":t(a?"list_view_button_aria":"calendar_view_button_aria"),children:a?Le.list:Le.calendar}),m.jsx("div",{className:"header-category-dropdown",style:{display:"flex",alignItems:"center",gap:8,marginLeft:8},children:m.jsxs("select",{value:E||"all",onChange:Ae=>R(Ae.target.value),style:{padding:"8px 10px",borderRadius:10,border:"1px solid var(--border-color)",background:"var(--button-bg-color)",color:"var(--text-color)",fontFamily:"inherit"},"aria-label":t("category_filter_aria"),children:[m.jsx("option",{value:"all",children:t("category_all")}),M&&M.map(Ae=>m.jsx("option",{value:Ae,children:Ae},Ae))]})}),m.jsxs("div",{className:"filter-sort-container",children:[m.jsx("button",{onClick:rt,onTouchStart:rt,className:"header-icon-button","aria-label":t("filter_sort_button_aria"),children:u?m.jsx("div",{className:"spinner"}):Le.filter}),ye&&m.jsx("div",{className:"profile-popover filter-sort-popover",onClick:Je,onTouchStart:Je,children:m.jsx("div",{className:"popover-section",children:m.jsx("button",{onClick:()=>{C(),Z(!1)},className:"popover-action-button",children:m.jsx("span",{children:t("select_button_label")})})})})]}),m.jsx("button",{className:"header-icon-button","aria-label":t("sync_button_label")||"동기화",onClick:()=>{var Ae;k||(B&&((Ae=T.find(Qe=>Qe.id===B))!=null&&Ae.isShared)?w():D())},disabled:k,style:{marginLeft:8},children:x?m.jsx("span",{className:"sync-spinner"}):Le.refresh}),m.jsx("button",{onClick:V,className:"header-icon-button","aria-label":t("settings_title"),children:Le.settings})]})]}),m.jsx("div",{className:"header-right",children:e?m.jsxs(m.Fragment,{children:[n===0?m.jsx("button",{onClick:o,className:"header-action-button",children:t("select_all_button_label")}):n===r?m.jsx("button",{onClick:i,className:"header-action-button",children:t("cancel_selection_button_label")}):m.jsxs(m.Fragment,{children:[m.jsx("button",{onClick:o,className:"header-action-button",children:t("select_all_button_label")}),m.jsx("button",{onClick:i,className:"header-action-button",children:t("cancel_selection_button_label")})]}),n>0&&m.jsx("button",{onClick:s,className:"header-action-button destructive",children:t("delete_selected_button_label").replace("{count}",String(n))})]}):!je&&F&&m.jsx("button",{onClick:F,className:"header-icon-button","aria-label":t("add_new_goal_button_label"),children:Le.add})})]})},V3=({todos:t,onToggleComplete:e,onDelete:n,onEdit:r,onInfo:i,t:s,filter:o,randomEncouragement:a,isSelectionMode:l,selectedTodoIds:u,onSelectTodo:f,folders:p,onMoveToFolder:g})=>{if(t.length===0){const v=`empty_message_${o}`;return m.jsx("div",{className:"empty-message",children:m.jsx("p",{children:s(v)})})}return m.jsx("ul",{children:t.map(v=>m.jsx(L3,{todo:v,onToggleComplete:e,onDelete:n,onEdit:r,onInfo:i,t:s,isSelectionMode:l,isSelected:u.has(v.id),onSelect:f,folders:p,onMoveToFolder:g},v.id))})},L3=uw.memo(({todo:t,onToggleComplete:e,onDelete:n,onEdit:r,onInfo:i,t:s,isSelectionMode:o,isSelected:a,onSelect:l,folders:u,onMoveToFolder:f})=>{var E;const p=()=>{o&&l(t.id)},g={school:"🎓",work:"💼",personal:"👤",other:"📌"},v=R=>R?{school:s("category_school"),work:s("category_work"),personal:s("category_personal"),other:s("category_other")}[R]||R:"";return m.jsx("li",{className:`${t.completed?"completed":""} ${o?"selection-mode":""} ${a?"selected":""}`,onClick:p,children:m.jsxs("div",{className:"swipeable-content",children:[m.jsxs("label",{className:"checkbox-container",onClick:R=>R.stopPropagation(),children:[m.jsx("input",{type:"checkbox",checked:t.completed,onChange:()=>e(t.id)}),m.jsx("span",{className:"checkmark"})]}),m.jsxs("div",{className:"todo-text-with-streak",children:[m.jsx("span",{className:"todo-text",children:t.wish}),t.isRecurring&&t.streak>0&&m.jsxs("div",{className:"streak-indicator",children:[Le.flame,m.jsx("span",{children:t.streak})]})]}),m.jsxs("div",{className:"todo-actions-and-meta",children:[m.jsxs("div",{className:"todo-meta-badges",children:[t.category&&m.jsxs("span",{style:{backgroundColor:"rgba(88, 86, 214, 0.1)",color:"var(--icon-color-indigo)",padding:"4px 8px",borderRadius:"4px",fontSize:"0.8rem",marginRight:"4px",display:"inline-flex",alignItems:"center",gap:"4px",whiteSpace:"nowrap"},children:[g[t.category]||"📌"," ",v(t.category)]}),t.deadline&&m.jsx("span",{className:"todo-deadline",children:N3(t.deadline,s)}),t.collaborators&&t.collaborators.length>0&&m.jsxs("span",{style:{backgroundColor:"rgba(52, 199, 89, 0.1)",color:"var(--success-color)",padding:"4px 8px",borderRadius:"4px",fontSize:"0.85rem",marginLeft:"4px",display:"inline-flex",alignItems:"center",gap:"4px"},children:["🤝 ",t.collaborators.length]}),t.folderId&&m.jsxs("span",{style:{backgroundColor:"rgba(100, 150, 200, 0.15)",color:"var(--primary-color)",padding:"4px 8px",borderRadius:"4px",fontSize:"0.8rem",marginLeft:"4px",display:"inline-flex",alignItems:"center",gap:"4px",whiteSpace:"nowrap"},children:["📁 ",((E=u.find(R=>R.id===t.folderId))==null?void 0:E.name)||"Unknown"]})]}),m.jsxs("div",{className:"todo-buttons",children:[m.jsxs("select",{onClick:R=>R.stopPropagation(),onChange:R=>{f(t.id,R.target.value==="root"?null:R.target.value)},defaultValue:t.folderId||"root",style:{padding:"4px 8px",borderRadius:"4px",border:"1px solid var(--border-color)",backgroundColor:"var(--card-bg-color)",color:"var(--text-color)",cursor:"pointer",fontSize:"0.85rem",fontFamily:"inherit"},title:"폴더 선택",children:[m.jsx("option",{value:"root",children:"📁 나의 목표"}),u.map(R=>m.jsx("option",{value:R.id,children:R.name},R.id))]}),m.jsx("button",{onClick:R=>{R.stopPropagation(),r(t)},className:"info-button edit-button","aria-label":s("edit_button_aria"),children:Le.edit}),m.jsx("button",{onClick:R=>{R.stopPropagation(),n(t.id)},className:"delete-button","aria-label":s("delete_button"),children:Le.delete}),m.jsx("button",{onClick:R=>{R.stopPropagation(),i(t)},className:"info-button","aria-label":s("info_button_aria"),children:Le.info})]})]})]})})}),So=({onClose:t,children:e,className:n="",isClosing:r,size:i="large",dismissible:s=!0})=>{const o={small:"modal-content-small",medium:"modal-content-medium",large:"modal-content-large"}[i];return m.jsx("div",{className:`modal-backdrop ${r?"is-closing":""}`,onClick:s?t:a=>a.stopPropagation(),children:m.jsx("div",{className:`modal-content ${o} ${n} ${r?"is-closing":""}`,onClick:a=>a.stopPropagation(),children:e})})},nl=t=>{const[e,n]=z.useState(!1);return[e,()=>{n(!0),setTimeout(t,500)}]},F3=({step:t,t:e,createAI:n,...r})=>{const{wish:i,setWish:s,outcome:o,setOutcome:a,obstacle:l,setObstacle:u,plan:f,setPlan:p,isRecurring:g,setIsRecurring:v,recurringDays:E,setRecurringDays:R,deadline:M,setDeadline:A,noDeadline:I,setNoDeadline:C,category:V,setCategory:F,userCategories:B,errors:T,language:w}=r,[x,k]=z.useState(!1),[D,L]=z.useState(""),[N,Me]=z.useState(""),et=async(je,ye)=>{if(ye){k(!0),L(""),Me("");try{const Z=n();if(!Z){Me("AI 기능을 사용하려면 설정에서 API 키를 입력해주세요."),k(!1);return}const fe=`Provide concise, actionable feedback on this part of a WOOP goal: ${je} - "${ye}". The feedback should be helpful and encouraging, in ${w==="ko"?"Korean":"English"}. Keep it to 1-2 sentences.`,ve=await Z.models.generateContent({model:"gemini-2.5-flash",contents:fe});L(ve.text)}catch(Z){console.error("AI Feedback Error:",Z),Me("Failed to get AI feedback.")}finally{k(!1)}}};switch(t){case 1:return m.jsxs("div",{children:[m.jsx("h3",{children:e("wish_label")}),m.jsxs("div",{className:"step-guidance",children:[m.jsx("p",{className:"tip",children:e("wish_tip")}),m.jsx("p",{className:"example",children:e("wish_example")})]}),m.jsx("textarea",{value:i,onChange:ye=>{s(ye.target.value),L(""),Me("")},placeholder:e("wish_label"),className:T.wish?"input-error":"",rows:3}),T.wish&&m.jsxs("p",{className:"field-error-message",children:[Le.exclamation," ",e("error_wish_required")]}),m.jsxs("div",{className:"ai-feedback-section",children:[m.jsxs("button",{onClick:()=>et("Wish",i),disabled:!i.trim()||x,className:"ai-feedback-button",children:[x?m.jsx("div",{className:"spinner-small"}):"🤖",m.jsx("span",{children:e(x?"ai_analyzing":"ai_coach_suggestion")})]}),D&&m.jsx("div",{className:"ai-feedback-bubble",children:D}),N&&m.jsx("div",{className:"ai-feedback-bubble error",children:N})]})]});case 2:return m.jsxs("div",{children:[m.jsx("h3",{children:e("outcome_label")}),m.jsxs("div",{className:"step-guidance",children:[m.jsx("p",{className:"tip",children:e("outcome_tip")}),m.jsx("p",{className:"example",children:e("outcome_example")})]}),m.jsx("textarea",{value:o,onChange:ye=>{a(ye.target.value),L(""),Me("")},placeholder:e("outcome_label"),className:T.outcome?"input-error":"",rows:3}),T.outcome&&m.jsxs("p",{className:"field-error-message",children:[Le.exclamation," ",e("error_outcome_required")]}),m.jsxs("div",{className:"ai-feedback-section",children:[m.jsxs("button",{onClick:()=>et("Outcome",o),disabled:!o.trim()||x,className:"ai-feedback-button",children:[x?m.jsx("div",{className:"spinner-small"}):"🤖",m.jsx("span",{children:e(x?"ai_analyzing":"ai_coach_suggestion")})]}),D&&m.jsx("div",{className:"ai-feedback-bubble",children:D}),N&&m.jsx("div",{className:"ai-feedback-bubble error",children:N})]})]});case 3:return m.jsxs("div",{children:[m.jsx("h3",{children:e("obstacle_label")}),m.jsxs("div",{className:"step-guidance",children:[m.jsx("p",{className:"tip",children:e("obstacle_tip")}),m.jsx("p",{className:"example",children:e("obstacle_example")})]}),m.jsx("textarea",{value:l,onChange:ye=>{u(ye.target.value),L(""),Me("")},placeholder:e("obstacle_label"),className:T.obstacle?"input-error":"",rows:3}),T.obstacle&&m.jsxs("p",{className:"field-error-message",children:[Le.exclamation," ",e("error_obstacle_required")]}),m.jsxs("div",{className:"ai-feedback-section",children:[m.jsxs("button",{onClick:()=>et("Obstacle",l),disabled:!l.trim()||x,className:"ai-feedback-button",children:[x?m.jsx("div",{className:"spinner-small"}):"🤖",m.jsx("span",{children:e(x?"ai_analyzing":"ai_coach_suggestion")})]}),D&&m.jsx("div",{className:"ai-feedback-bubble",children:D}),N&&m.jsx("div",{className:"ai-feedback-bubble error",children:N})]})]});case 4:return m.jsxs("div",{children:[m.jsx("h3",{children:e("plan_label")}),m.jsxs("div",{className:"step-guidance",children:[m.jsx("p",{className:"tip",children:e("plan_tip")}),m.jsx("p",{className:"example",children:e("plan_example")})]}),m.jsx("textarea",{value:f,onChange:ye=>{p(ye.target.value),L(""),Me("")},placeholder:e("plan_label"),className:T.plan?"input-error":"",rows:3}),T.plan&&m.jsxs("p",{className:"field-error-message",children:[Le.exclamation," ",e("error_plan_required")]}),m.jsxs("div",{className:"ai-feedback-section",children:[m.jsxs("button",{onClick:()=>et("Plan",f),disabled:!f.trim()||x,className:"ai-feedback-button",children:[x?m.jsx("div",{className:"spinner-small"}):"🤖",m.jsx("span",{children:e(x?"ai_analyzing":"ai_coach_suggestion")})]}),D&&m.jsx("div",{className:"ai-feedback-bubble",children:D}),N&&m.jsx("div",{className:"ai-feedback-bubble error",children:N})]})]});case 5:const je=ye=>{const Z=[...E],fe=Z.indexOf(ye);fe>-1?Z.splice(fe,1):Z.push(ye),R(Z)};return m.jsxs("div",{children:[m.jsxs("h3",{children:[e("recurrence_label")," & ",e("deadline_label")," & ",e("category_label")]}),m.jsxs("div",{className:"step-guidance",children:[m.jsx("p",{className:"tip",children:e("recurrence_tip")}),m.jsx("p",{className:"example",children:e("recurrence_example")})]}),m.jsxs("label",{className:"settings-item standalone-toggle",children:[m.jsx("span",{style:{fontWeight:500},children:e("recurrence_option_daily")}),m.jsxs("label",{className:"theme-toggle-switch",children:[m.jsx("input",{type:"checkbox",checked:g,onChange:ye=>v(ye.target.checked)}),m.jsx("span",{className:"slider round"})]})]}),g&&m.jsx("div",{className:"day-picker",children:e("day_names_short_picker").map((ye,Z)=>m.jsx("button",{onClick:()=>je(Z),className:`day-button ${E.includes(Z)?"selected":""}`,children:ye},Z))}),T.recurringDays&&m.jsxs("p",{className:"field-error-message",children:[Le.exclamation," ",e("error_day_required")]}),m.jsx("hr",{}),m.jsx("div",{className:"step-guidance",style:{marginTop:"16px"},children:m.jsx("p",{className:"tip",children:e("deadline_tip")})}),m.jsxs("label",{className:"settings-item standalone-toggle",children:[m.jsx("span",{style:{fontWeight:500},children:e("deadline_option_no_deadline")}),m.jsxs("label",{className:"theme-toggle-switch",children:[m.jsx("input",{type:"checkbox",checked:I,onChange:ye=>C(ye.target.checked)}),m.jsx("span",{className:"slider round"})]})]}),!I&&m.jsx("input",{type:"date",value:M,onChange:ye=>A(ye.target.value),className:T.deadline?"input-error":"",style:{marginTop:"12px"}}),T.deadline&&m.jsxs("p",{className:"field-error-message",children:[Le.exclamation," ",e("error_deadline_required")]}),m.jsx("hr",{}),m.jsx("div",{className:"step-guidance",style:{marginTop:"16px"},children:m.jsx("p",{className:"tip",children:e("category_label")})}),m.jsx("div",{style:{display:"grid",gridTemplateColumns:B&&B.length>2?"repeat(2, 1fr)":"repeat(1, 1fr)",gap:"8px",marginTop:"12px"},children:B&&B.map(ye=>m.jsx("button",{onClick:()=>F(ye),className:`category-button ${V===ye?"active":""}`,children:ye},ye))})]});default:return null}},U3=({onGenerate:t,t:e})=>{const[n,r]=z.useState(""),[i,s]=z.useState(""),[o,a]=z.useState(""),[l,u]=z.useState(""),[f,p]=z.useState(""),{endDate:g,generatedCount:v}=z.useMemo(()=>{const R=parseInt(i,10),M=parseInt(o,10);if(!l||!R||R<=0||!M||M<=0)return{endDate:"",generatedCount:0};const A=Math.ceil(R/M),I=new Date(l),C=new Date(I);return C.setDate(I.getDate()+A-1),{endDate:C.toISOString().split("T")[0],generatedCount:A}},[i,o,l]),E=()=>{const R=parseInt(i,10),M=parseInt(o,10);if(!n.trim()||!l||!R||R<=0||!M||M<=0){p(e("automation_error_all_fields"));return}const A=[],I=Math.ceil(R/M),C=new Date(l);for(let V=0;V<I;V++){const F=new Date(C);F.setDate(C.getDate()+V);const B=V*M+1,T=Math.min((V+1)*M,R),w=`${n.trim()} ${B}`+(T>B?` - ${T}`:"");A.push({wish:w,outcome:"",obstacle:"",plan:"",isRecurring:!1,recurringDays:[],deadline:F.toISOString().split("T")[0],category:"personal"})}p(""),t(A)};return m.jsxs("div",{className:"automation-form-container",children:[m.jsx("h3",{children:e("automation_title")}),m.jsxs("div",{className:"form-group",children:[m.jsx("label",{children:e("automation_base_name_label")}),m.jsx("input",{type:"text",value:n,onChange:R=>r(R.target.value),placeholder:e("automation_base_name_placeholder")})]}),m.jsxs("div",{className:"automation-form-grid",children:[m.jsxs("div",{className:"form-group",children:[m.jsx("label",{children:e("automation_total_units_label")}),m.jsx("input",{type:"number",value:i,onChange:R=>s(R.target.value),placeholder:e("automation_total_units_placeholder")})]}),m.jsxs("div",{className:"form-group",children:[m.jsx("label",{children:e("automation_units_per_day_label")}),m.jsx("input",{type:"number",value:o,onChange:R=>a(R.target.value),placeholder:"예: 5"})]})]}),m.jsxs("div",{className:"automation-form-grid",children:[m.jsxs("div",{className:"form-group",children:[m.jsx("label",{children:e("automation_start_date_label")}),m.jsx("input",{type:"date",value:l,onChange:R=>u(R.target.value)})]}),m.jsxs("div",{className:"form-group",children:[m.jsx("label",{children:e("automation_end_date_label")}),m.jsx("input",{type:"date",value:g,readOnly:!0})]})]}),f&&m.jsxs("p",{className:"field-error-message",style:{justifyContent:"center"},children:[Le.exclamation," ",f]}),m.jsx("div",{className:"goal-assistant-nav",children:m.jsx("button",{onClick:E,className:"primary",disabled:v===0,children:e("automation_generate_button").replace("{count}",String(v))})})]})},QI=({onClose:t,onAddTodo:e,onAddMultipleTodos:n,onEditTodo:r,existingTodo:i,t:s,language:o,createAI:a,userCategories:l=["personal"]})=>{const[u,f]=nl(t),[p,g]=z.useState("woop"),[v,E]=z.useState(1),[R,M]=z.useState("forward"),[A,I]=z.useState((i==null?void 0:i.wish)||""),[C,V]=z.useState((i==null?void 0:i.outcome)||""),[F,B]=z.useState((i==null?void 0:i.obstacle)||""),[T,w]=z.useState((i==null?void 0:i.plan)||""),[x,k]=z.useState((i==null?void 0:i.isRecurring)||!1),[D,L]=z.useState((i==null?void 0:i.recurringDays)||[]),[N,Me]=z.useState((i==null?void 0:i.deadline)||""),[et,je]=z.useState(!(i!=null&&i.deadline)),[ye,Z]=z.useState((i==null?void 0:i.category)||"personal"),[fe,ve]=z.useState({}),[Ee,Oe]=z.useState(""),[rt,Je]=z.useState(""),[Ae,Qe]=z.useState(""),[zt,hr]=z.useState("personal"),Wn=5,kn=xe=>{const $t={};return xe===1&&!A.trim()&&($t.wish=!0),xe===2&&!C.trim()&&($t.outcome=!0),xe===3&&!F.trim()&&($t.obstacle=!0),xe===4&&!T.trim()&&($t.plan=!0),xe===5&&(!et&&!N&&($t.deadline=!0),x&&D.length===0&&($t.recurringDays=!0)),ve($t),Object.keys($t).length===0},fr=()=>{kn(v)&&(v<Wn?(M("forward"),E(xe=>xe+1)):jn())},Kn=()=>{v>1&&(M("backward"),E(xe=>xe-1))},jn=()=>{if(!kn(5))return;const xe={wish:A,outcome:C,obstacle:F,plan:T,isRecurring:x,recurringDays:D,deadline:et?"":N,category:ye};i&&r?r({...i,...xe}):e&&(e(xe),f())},pr=()=>{Ee.trim()&&(e&&e({wish:Ee.trim(),outcome:Ee.trim(),obstacle:"",plan:"",isRecurring:!1,recurringDays:[],deadline:rt,category:zt}),Oe(""),Je(""),Qe(""),hr("personal"),f())};return m.jsxs(So,{onClose:f,isClosing:u,className:"goal-assistant-modal",children:[m.jsxs("div",{className:"goal-assistant-header",children:[m.jsx("div",{className:"goal-assistant-header-left",children:v>1&&p==="woop"?m.jsxs(m.Fragment,{children:[m.jsx("button",{onClick:Kn,className:"settings-back-button",children:Le.back}),m.jsx("button",{onClick:Kn,className:"secondary header-back-text",children:"뒤로"})]}):m.jsx("button",{onClick:f,className:"secondary header-close-text",children:"닫기"})}),m.jsx("h2",{children:p==="woop"?"새로운 목표":p==="quick"?"새로운 할일":p==="automation"?"새로운 계획":s("goal_assistant_title")}),m.jsxs("div",{className:"goal-assistant-header-right",children:[p==="woop"&&m.jsx("button",{onClick:fr,className:"primary header-next-button",children:s(v===Wn?i?"save_button":"add_button":"next_button")}),p==="quick"&&m.jsx("button",{onClick:pr,className:"primary header-next-button",disabled:!Ee.trim(),children:s("add_button")})]})]}),!i&&m.jsx("div",{className:"modal-mode-switcher-container",children:m.jsxs("div",{className:"modal-mode-switcher",children:[m.jsx("button",{onClick:()=>g("woop"),className:p==="woop"?"active":"",children:s("goal_assistant_mode_woop")}),m.jsx("button",{onClick:()=>g("quick"),className:p==="quick"?"active":"",children:"새로운 할일"}),m.jsx("button",{onClick:()=>g("automation"),className:p==="automation"?"active":"",children:s("goal_assistant_mode_automation")})]})}),m.jsx("div",{className:"goal-assistant-body",children:p==="woop"?m.jsxs(m.Fragment,{children:[m.jsx("div",{className:"progress-bar-container",children:m.jsx("div",{className:"progress-bar",style:{width:`${v/Wn*100}%`}})}),m.jsx("div",{className:`goal-assistant-step-content-animator ${R}`,children:m.jsx(F3,{step:v,t:s,createAI:a,wish:A,setWish:I,outcome:C,setOutcome:V,obstacle:F,setObstacle:B,plan:T,setPlan:w,isRecurring:x,setIsRecurring:k,recurringDays:D,setRecurringDays:L,deadline:N,setDeadline:Me,noDeadline:et,setNoDeadline:je,category:ye,setCategory:Z,userCategories:l,errors:fe,language:o})},v)]}):p==="quick"?m.jsxs("div",{style:{padding:"24px 16px"},children:[m.jsxs("div",{style:{marginBottom:"20px"},children:[m.jsx("h3",{style:{fontSize:"1rem",fontWeight:"600",marginBottom:"12px"},children:"새로운 할일"}),m.jsx("div",{className:"step-guidance",children:m.jsx("p",{className:"tip",children:"빠르게 할일을 추가하세요"})}),m.jsx("textarea",{value:Ee,onChange:xe=>Oe(xe.target.value),placeholder:"예: 선물 사기",rows:2,style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontSize:"14px",fontFamily:"inherit",resize:"none",marginTop:"12px"},onKeyPress:xe=>{xe.key==="Enter"&&xe.ctrlKey&&pr()}})]}),m.jsx("hr",{}),m.jsxs("div",{style:{marginBottom:"20px"},children:[m.jsx("div",{className:"step-guidance",style:{marginTop:"16px"},children:m.jsx("p",{className:"tip",children:"마감일 설정 (선택)"})}),m.jsxs("label",{className:"settings-item standalone-toggle",style:{marginTop:"12px"},children:[m.jsx("span",{style:{fontWeight:"500"},children:"마감일 설정"}),m.jsxs("label",{className:"theme-toggle-switch",children:[m.jsx("input",{type:"checkbox",checked:!!rt,onChange:xe=>Je(xe.target.checked?new Date().toISOString().split("T")[0]:"")}),m.jsx("span",{className:"slider round"})]})]}),rt&&m.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",marginTop:"12px"},children:[m.jsxs("div",{children:[m.jsx("label",{style:{fontSize:"12px",opacity:.7,display:"block",marginBottom:"4px"},children:"날짜"}),m.jsx("input",{type:"date",value:rt,onChange:xe=>Je(xe.target.value),style:{width:"100%",padding:"10px",borderRadius:"6px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontSize:"13px"}})]}),m.jsxs("div",{children:[m.jsx("label",{style:{fontSize:"12px",opacity:.7,display:"block",marginBottom:"4px"},children:"시간 (선택)"}),m.jsx("input",{type:"time",value:Ae,onChange:xe=>Qe(xe.target.value),style:{width:"100%",padding:"10px",borderRadius:"6px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontSize:"13px"}})]})]})]}),m.jsx("hr",{}),m.jsxs("div",{style:{marginBottom:"24px"},children:[m.jsx("div",{className:"step-guidance",style:{marginTop:"16px"},children:m.jsx("p",{className:"tip",children:s("category_label")})}),m.jsx("div",{style:{display:"grid",gridTemplateColumns:l&&l.length>2?"repeat(2, 1fr)":"repeat(1, 1fr)",gap:"8px",marginTop:"12px"},children:l&&l.map(xe=>m.jsx("button",{onClick:()=>hr(xe),className:`category-button ${zt===xe?"active":""}`,children:xe},xe))})]})]}):n&&m.jsx(U3,{onGenerate:n,t:s})})]})},O3=({todo:t,onClose:e,t:n,createAI:r,onOpenCollaboration:i,userCategories:s,onUpdateGoal:o})=>{const[a,l]=nl(e),[u,f]=z.useState(""),[p,g]=z.useState(!1),[v,E]=z.useState(!1),R=async()=>{g(!0),f(""),E(!1);try{const M=r();if(!M){f("AI 기능을 사용하려면 설정에서 API 키를 입력해주세요."),g(!1);return}const A=`Based on the WOOP method, provide a concise and encouraging suggestion for the following goal: Wish: "${t.wish}", Best Outcome: "${t.outcome}", Obstacle: "${t.obstacle}", Plan: "${t.plan}". Focus on strengthening the plan or reframing the obstacle.`,I=await M.models.generateContent({model:"gemini-2.5-flash",contents:A});f(I.text)}catch(M){console.error(M),E(!0)}finally{g(!1)}};return m.jsxs(So,{onClose:l,isClosing:a,className:"info-modal",children:[m.jsxs("div",{className:"info-modal-content",children:[m.jsx("h2",{children:n("goal_details_modal_title")}),m.jsxs("div",{className:"info-section",children:[m.jsx("h4",{children:n("wish_label")}),m.jsx("p",{children:t.wish})]}),m.jsxs("div",{className:"info-section",children:[m.jsx("h4",{children:n("outcome_label")}),m.jsx("p",{children:t.outcome})]}),m.jsxs("div",{className:"info-section",children:[m.jsx("h4",{children:n("obstacle_label")}),m.jsx("p",{children:t.obstacle})]}),m.jsxs("div",{className:"info-section",children:[m.jsx("h4",{children:n("plan_label")}),m.jsx("p",{children:t.plan})]}),s&&s.length>0&&o&&m.jsxs("div",{className:"info-section",style:{borderTop:"1px solid var(--border-color)",paddingTop:"16px",marginTop:"16px"},children:[m.jsx("h4",{style:{marginBottom:"12px"},children:n("category_label")}),m.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:s.map(M=>m.jsx("button",{onClick:()=>{o({...t,category:M}),l()},className:`category-button ${t.category===M?"active":""}`,style:{padding:"8px 16px",borderRadius:"20px",border:t.category===M?"2px solid var(--primary-color)":"2px solid var(--border-color)",backgroundColor:t.category===M?"var(--primary-color)":"transparent",color:t.category===M?"white":"var(--text-color)",cursor:"pointer",fontSize:"14px",fontWeight:t.category===M?"600":"500",transition:"all 0.25s ease",whiteSpace:"nowrap",display:"inline-block",boxShadow:t.category===M?"0 2px 8px rgba(88, 86, 214, 0.2)":"none"},children:M},M))})]}),m.jsxs("div",{className:"ai-analysis-section",children:[m.jsx("h4",{children:n("ai_coach_suggestion")}),p?m.jsx("p",{children:n("ai_analyzing")}):u?m.jsx("p",{children:u}):v?m.jsx("p",{className:"ai-error",children:n("ai_sort_error_message")}):m.jsx("button",{onClick:R,className:"feedback-button",children:n("ai_coach_suggestion")})]})]}),m.jsxs("div",{className:"modal-buttons",children:[i&&m.jsx("button",{onClick:()=>{i(t),l()},className:"secondary",children:"🤝 협업"}),m.jsx("button",{onClick:l,className:"primary",children:n("close_button")})]})]})},B3=({folder:t,onClose:e,t:n,googleUser:r,onUpdateCollaborators:i,setAlertConfig:s})=>{const[o,a]=nl(e),[l,u]=z.useState(""),[f,p]=z.useState(!1),[g,v]=z.useState(""),[E,R]=z.useState(!1),M=async()=>{if(!(!t||!r)){p(!0);try{if(!g||g.trim().length===0){s({title:"암호 설정 필수",message:"보안을 위해 공유 링크에 반드시 암호를 설정해주세요.",confirmText:"확인",onConfirm:()=>{}}),p(!1);return}const V={type:"folder_share",folderId:t.id,folderName:t.name,folderColor:t.color,goals:[],sharedBy:r==null?void 0:r.email,ownerId:r==null?void 0:r.uid,sharedAt:new Date().toISOString(),password:g},F=lt(pe,"users",r.uid,"folders"),B=Ve(F,t.id),T=t.collaborators||[];await _t(B,{collaborators:T,shareInfo:{password:g,createdAt:new Date().toISOString()},updatedAt:new Date().toISOString()},{merge:!0});const w=cg(JSON.stringify(V)),x=`${window.location.origin}${window.location.pathname}?folder_share=${encodeURIComponent(w)}`,k=await rR(x);u(k),s({title:"공유 링크 생성 완료",message:"클립보드에 복사되었습니다. 협업자에게 공유해주세요!",confirmText:"확인",onConfirm:()=>{navigator.clipboard.writeText(k)}})}catch(V){console.error("공유 링크 생성 실패:",V),s({title:"생성 실패",message:"공유 링크 생성에 실패했습니다. 다시 시도해주세요.",confirmText:"확인",onConfirm:()=>{}})}finally{p(!1)}}},A=()=>{l&&navigator.clipboard.writeText(l).then(()=>{s({title:"복사 완료",message:"링크가 클립보드에 복사되었습니다.",confirmText:"확인",onConfirm:()=>{}})})},I=async V=>{if(!(!t||!r))try{const F=lt(pe,"users",r.uid,"folders"),B=Ve(F,t.id),T=(t.collaborators||[]).filter(w=>w.userId!==V);await _t(B,{collaborators:T,updatedAt:new Date().toISOString()},{merge:!0}),i(t.id,T),s({title:"제거 완료",message:"협업자가 제거되었습니다.",confirmText:"확인",onConfirm:()=>{}})}catch(F){console.error("협업자 제거 실패:",F),s({title:"제거 실패",message:"협업자 제거에 실패했습니다.",confirmText:"확인",onConfirm:()=>{}})}},C=async(V,F)=>{if(!(!t||!r))try{const B=lt(pe,"users",r.uid,"folders"),T=Ve(B,t.id),w=(t.collaborators||[]).map(x=>x.userId===V?{...x,role:F}:x);await _t(T,{collaborators:w,updatedAt:new Date().toISOString()},{merge:!0}),i(t.id,w),s({title:"권한 변경 완료",message:`협업자의 권한이 ${F==="editor"?"편집자":"뷰어"}로 변경되었습니다.`,confirmText:"확인",onConfirm:()=>{}})}catch(B){console.error("권한 변경 실패:",B)}};return t?m.jsxs(So,{onClose:a,isClosing:o,className:"goal-assistant-modal",children:[m.jsxs("div",{className:"goal-assistant-header",children:[m.jsx("div",{className:"goal-assistant-header-left"}),m.jsxs("h2",{children:[t.name," 폴더 공유"]})]}),m.jsx("div",{className:"goal-assistant-body",children:m.jsxs("div",{style:{padding:"24px 16px"},children:[m.jsxs("div",{style:{marginBottom:"20px"},children:[m.jsx("h3",{style:{fontSize:"1rem",fontWeight:"600",marginBottom:"12px"},children:"현재 협업자"}),t.collaborators&&t.collaborators.length>0?m.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:t.collaborators.map(V=>m.jsxs("div",{className:"settings-item",style:{padding:"12px",backgroundColor:"var(--card-bg-color)",borderRadius:"8px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[m.jsxs("div",{style:{flex:1},children:[m.jsx("div",{style:{fontWeight:"500",fontSize:"0.95rem"},children:V.email}),V.role==="owner"?m.jsx("div",{style:{fontSize:"0.85rem",color:"var(--text-secondary-color)",marginTop:"2px"},children:"소유자"}):m.jsxs("select",{value:V.role,onChange:F=>C(V.userId,F.target.value),style:{fontSize:"0.85rem",padding:"4px 8px",marginTop:"4px",borderRadius:"4px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",cursor:"pointer"},children:[m.jsx("option",{value:"editor",children:"편집자"}),m.jsx("option",{value:"viewer",children:"뷰어"})]})]}),V.role!=="owner"&&m.jsx("button",{onClick:()=>I(V.userId),style:{padding:"4px 12px",backgroundColor:"var(--danger-color)",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"0.8rem",marginLeft:"12px",whiteSpace:"nowrap"},children:"제거"})]},V.userId))}):m.jsx("div",{className:"step-guidance",children:m.jsx("p",{className:"tip",children:"협업자가 없습니다. 공유 링크로 협업자를 추가하세요."})})]}),m.jsx("hr",{style:{margin:"20px 0",border:"none",borderTop:"1px solid var(--border-color)"}}),m.jsxs("div",{style:{marginBottom:"20px"},children:[m.jsx("h3",{style:{fontSize:"1rem",fontWeight:"600",marginBottom:"12px"},children:"공유 링크로 협업자 추가"}),m.jsx("div",{className:"step-guidance",children:m.jsx("p",{className:"tip",children:"공유 링크를 생성하고 협업자에게 전달하면, 그들이 해당 폴더에 접근할 수 있습니다."})}),l?m.jsxs("div",{style:{marginTop:"16px",display:"flex",flexDirection:"column",gap:"12px"},children:[m.jsx("div",{style:{padding:"12px",backgroundColor:"var(--card-bg-color)",borderRadius:"8px",border:"1px solid var(--border-color)"},children:m.jsx("input",{type:"text",readOnly:!0,value:l,onClick:V=>V.target.select(),style:{width:"100%",padding:"10px",border:"1px solid var(--border-color)",borderRadius:"6px",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontSize:"0.85rem",boxSizing:"border-box",fontFamily:"monospace"}})}),m.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[m.jsx("button",{onClick:A,className:"primary",children:"클립보드 복사"}),m.jsx("button",{onClick:()=>{u(""),v(""),R(!1)},className:"secondary",children:"새로 생성"})]})]}):m.jsxs("div",{style:{marginTop:"16px",display:"flex",flexDirection:"column",gap:"12px"},children:[m.jsxs("label",{className:"settings-item standalone-toggle",children:[m.jsx("span",{style:{fontWeight:"500"},children:"링크에 암호 설정"}),m.jsxs("label",{className:"theme-toggle-switch",children:[m.jsx("input",{type:"checkbox",checked:E,onChange:V=>{R(V.target.checked),V.target.checked||v("")}}),m.jsx("span",{className:"slider round"})]})]}),E&&m.jsx("input",{type:"password",placeholder:"암호 입력",value:g,onChange:V=>v(V.target.value),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontFamily:"inherit",fontSize:"14px",boxSizing:"border-box"}}),m.jsx("button",{onClick:M,disabled:f||!g.trim(),className:"primary",style:{width:"100%",padding:"14px 0",backgroundColor:"var(--primary-color)",color:"white",border:"none",borderRadius:"24px",boxShadow:"0 2px 8px rgba(88,86,214,0.08)",fontWeight:700,fontSize:"16px",letterSpacing:"0.01em",cursor:f||!g.trim()?"not-allowed":"pointer",opacity:f||!g.trim()?.6:1,transition:"all 0.2s"},children:f?"링크 생성 중...":"공유 링크 생성"})]})]})]})}),m.jsxs("div",{className:"goal-assistant-nav",children:[m.jsx("div",{}),m.jsx("button",{onClick:a,className:"primary",children:"닫기"})]})]}):null},q3=({onClose:t,isDarkMode:e,onToggleDarkMode:n,themeMode:r,onThemeChange:i,backgroundTheme:s,onSetBackgroundTheme:o,onExportData:a,onImportData:l,setAlertConfig:u,onDeleteAllData:f,dataActionStatus:p,language:g,onSetLanguage:v,t:E,todos:R,setToastMessage:M,onOpenVersionInfo:A,onOpenUsageGuide:I,apiKey:C,onSetApiKey:V,isOfflineMode:F,onToggleOfflineMode:B,googleUser:T,onGoogleLogin:w,onGoogleLogout:x,onSyncDataToFirebase:k,onLoadDataFromFirebase:D,isGoogleLoggingIn:L=!1,isGoogleLoggingOut:N=!1,isSyncingData:Me=!1,isLoadingData:et=!1,isAutoSyncEnabled:je,setIsAutoSyncEnabled:ye,onDiagnoseFirebase:Z})=>{const[fe,ve]=nl(t),[Ee,Oe]=z.useState("appearance"),[rt,Je]=z.useState(""),[Ae,Qe]=z.useState(!1),[zt,hr]=z.useState("medium"),[Wn,kn]=z.useState(null),fr=z.useRef(null),Kn=[{id:"appearance",label:E("settings_section_background"),icon:Le.background},{id:"notifications",label:E("settings_notifications"),icon:Le.settings},{id:"general",label:E("settings_section_general"),icon:Le.settings},{id:"data",label:E("settings_section_data"),icon:Le.data}],jn=()=>u({title:E("delete_account_header"),message:E("delete_account_header_desc"),isDestructive:!0,confirmText:E("delete_all_data_button"),cancelText:E("cancel_button"),onConfirm:f,onCancel:()=>{}}),pr=async()=>{if(!R||R.length===0){kn(E("no_data_to_share"));return}Qe(!0);try{const Fe=JI(R),_n=`${window.location.origin}${window.location.pathname}?data=${encodeURIComponent(Fe)}`,at=await rR(_n);Je(at),at!==_n&&at.length<_n.length?M(E("short_url_created")):M(E("share_link_created"))}catch(Fe){console.error("Failed to create share link",Fe);const _n=JI(R),at=`${window.location.origin}${window.location.pathname}?data=${encodeURIComponent(_n)}`;Je(at),M(E("short_url_failed"))}finally{Qe(!1)}},xe=()=>{rt&&navigator.clipboard.writeText(rt).then(()=>{M(E("link_copied_toast"))})},$t=()=>{switch(Ee){case"appearance":return m.jsxs(m.Fragment,{children:[m.jsx("div",{className:"settings-section-header",children:E("settings_theme_mode")}),m.jsxs("div",{className:"settings-section-body",children:[m.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>i("light"),children:[m.jsxs("div",{children:[m.jsx("span",{children:E("theme_mode_light")}),m.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:E("theme_mode_light_desc")})]}),r==="light"&&Le.check]}),m.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>i("dark"),children:[m.jsxs("div",{children:[m.jsx("span",{children:E("theme_mode_dark")}),m.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:E("theme_mode_dark_desc")})]}),r==="dark"&&Le.check]}),m.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>i("system"),children:[m.jsxs("div",{children:[m.jsx("span",{children:E("theme_mode_system")}),m.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:E("theme_mode_system_desc")})]}),r==="system"&&Le.check]})]}),m.jsx("div",{className:"settings-section-header",children:E("settings_background_header")}),m.jsx("div",{className:"settings-section-body",children:dg.map(Fe=>m.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>o(Fe.id),children:[m.jsx("span",{children:E(e?Fe.darkNameKey:Fe.lightNameKey)}),s===Fe.id&&Le.check]},Fe.id))})]});case"notifications":return m.jsxs(m.Fragment,{children:[m.jsx("div",{className:"settings-section-header",children:E("notification_settings_title")}),m.jsxs("div",{className:"settings-section-body",children:[m.jsxs("label",{className:"settings-item",children:[m.jsxs("div",{children:[m.jsx("span",{children:E("notification_deadline")}),m.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:E("notification_deadline_desc")})]}),m.jsxs("div",{className:"theme-toggle-switch",children:[m.jsx("input",{type:"checkbox",defaultChecked:!0,onChange:()=>{}}),m.jsx("span",{className:"slider round"})]})]}),m.jsxs("label",{className:"settings-item",children:[m.jsxs("div",{children:[m.jsx("span",{children:E("notification_suggestion")}),m.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:"지정된 시간에 할일을 제안합니다."})]}),m.jsxs("div",{className:"theme-toggle-switch",children:[m.jsx("input",{type:"checkbox",defaultChecked:!0,onChange:()=>{}}),m.jsx("span",{className:"slider round"})]})]})]}),m.jsx("div",{className:"settings-section-header",children:"알림 권한"}),m.jsxs("div",{className:"settings-section-body",children:[m.jsx("button",{className:"settings-item action-item",onClick:async()=>{await tR()?(M("알림 권한이 허용되었습니다."),await nR()):M("알림 권한을 거부했습니다.")},children:m.jsx("span",{className:"action-text",children:"알림 권한 요청"})}),m.jsxs("div",{style:{fontSize:"12px",opacity:.7,padding:"12px",marginTop:"8px"},children:["현재 권한: ",Notification.permission==="granted"?"✓ 허용됨":Notification.permission==="denied"?"✗ 거부됨":"? 미정"]})]})]});case"general":return m.jsxs(m.Fragment,{children:[m.jsx("div",{className:"settings-section-header",children:E("settings_language")}),m.jsxs("div",{className:"settings-section-body",children:[m.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>v("ko"),children:[m.jsx("span",{children:"한국어"}),g==="ko"&&Le.check]}),m.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>v("en"),children:[m.jsx("span",{children:"English"}),g==="en"&&Le.check]})]}),m.jsx("div",{className:"settings-section-header",children:E("settings_api_key")}),m.jsxs("div",{className:"settings-section-body",children:[m.jsx("div",{className:"settings-item",children:m.jsx("input",{type:"password",placeholder:E("settings_api_key_placeholder"),value:C,onChange:Fe=>V(Fe.target.value),style:{width:"100%",padding:"8px",border:"1px solid var(--border-color)",borderRadius:"4px",backgroundColor:"var(--input-bg)"}})}),m.jsxs("label",{className:"settings-item",children:[m.jsxs("div",{children:[m.jsx("span",{children:E("settings_offline_mode")}),m.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:E("settings_offline_mode_desc")})]}),m.jsxs("div",{className:"theme-toggle-switch",children:[m.jsx("input",{type:"checkbox",checked:F,onChange:B}),m.jsx("span",{className:"slider round"})]})]})]}),m.jsx("div",{className:"settings-section-header",children:E("settings_section_info")}),m.jsxs("div",{className:"settings-section-body",children:[m.jsxs("div",{className:"settings-item nav-indicator",onClick:A,children:[m.jsx("span",{children:E("settings_version")}),m.jsxs("div",{className:"settings-item-value-with-icon",children:[m.jsx("span",{children:"1.5"}),Le.forward]})]}),m.jsxs("div",{className:"settings-item nav-indicator",onClick:I,children:[m.jsx("span",{children:E("usage_guide_title")}),m.jsx("div",{className:"settings-item-value-with-icon",children:Le.forward})]}),m.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>{kn(`이것은 매우 긴 알림 메시지입니다.

이 메시지는 여러 줄에 걸쳐 작성되었으며, 알림 팝업이 내용에 맞게 세로로 확장되는지 테스트하기 위한 목적으로 만들어졌습니다.

줄바꿈 문자도 포함되어 있고,
여러 문단으로 구성되어 있습니다.

이런 식으로 긴 에러 메시지나 안내 메시지가 표시될 때도 팝업이 적절하게 크기 조정이 되어야 합니다.

스크롤이 필요할 정도로 매우 긴 내용일 때는 스크롤바가 나타나야 하고, 버튼 영역은 항상 하단에 고정되어 있어야 합니다.`)},children:[m.jsx("span",{children:E("test_long_alert")}),m.jsxs("div",{className:"settings-item-value-with-icon",children:[m.jsx("span",{children:E("test_long_alert_desc")}),Le.forward]})]}),m.jsxs("div",{className:"settings-item",children:[m.jsx("span",{children:E("settings_developer")}),m.jsx("span",{className:"settings-item-value",children:E("developer_name")})]}),m.jsxs("div",{className:"settings-item",children:[m.jsx("span",{children:E("settings_copyright")}),m.jsx("span",{className:"settings-item-value",children:E("copyright_notice")})]})]})]});case"data":return m.jsxs(m.Fragment,{children:[m.jsx("div",{className:"settings-section-header",children:"계정"}),m.jsx("div",{className:"settings-section-body",children:T?m.jsxs("div",{children:[m.jsxs("div",{className:"settings-item",children:[m.jsxs("div",{children:[m.jsx("span",{children:"Google 계정"}),m.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:T.email}),m.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:T.displayName})]}),m.jsx("span",{style:{color:"var(--success-color, #4CAF50)"},children:"✓"})]}),m.jsx("button",{className:"settings-item action-item",onClick:x,disabled:N,style:{opacity:N?.6:1},children:m.jsx("span",{className:"action-text",children:N?"⏳ 로그아웃 중...":"로그아웃"})})]}):m.jsxs("div",{children:[m.jsx("div",{style:{display:"flex",justifyContent:"center",padding:"12px 0"},children:m.jsxs("button",{onClick:w,disabled:L,style:{backgroundColor:L?"#E0E0E0":"white",border:"1px solid #D3D3D3",borderRadius:"24px",padding:"8px 20px",fontSize:"14px",fontWeight:"500",cursor:L?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"8px",color:L?"#999999":"#1F2937",transition:"all 0.2s",opacity:L?.6:1},children:[m.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",children:[m.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),m.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),m.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),m.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),L?"로그인 중...":"Google로 로그인"]})}),m.jsx("div",{style:{display:"flex",justifyContent:"center",padding:"8px 0"},children:m.jsx("button",{onClick:Z,style:{backgroundColor:"transparent",border:"1px solid #D3D3D3",borderRadius:"16px",padding:"4px 12px",fontSize:"12px",color:"#666",cursor:"pointer"},children:"🔍 로그인 문제 진단"})})]})}),T&&m.jsxs(m.Fragment,{children:[m.jsx("div",{className:"settings-section-header",children:"클라우드 동기화"}),m.jsxs("div",{className:"settings-section-body",children:[m.jsx("button",{className:"settings-item action-item",onClick:k,disabled:Me,children:m.jsx("span",{className:"action-text",children:Me?"저장중...":"클라우드에 저장"})}),m.jsx("button",{className:"settings-item action-item",onClick:D,disabled:et,children:m.jsx("span",{className:"action-text",children:et?"로드중...":"클라우드에서 불러오기"})}),m.jsxs("label",{className:"settings-item",children:[m.jsxs("div",{children:[m.jsx("span",{children:"자동 동기화"}),m.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:"목표 변경 시 자동으로 저장"})]}),m.jsxs("div",{className:"theme-toggle-switch",children:[m.jsx("input",{type:"checkbox",checked:je,onChange:Fe=>ye(Fe.target.checked)}),m.jsx("span",{className:"slider round"})]})]})]})]}),m.jsx("div",{className:"settings-section-header",children:E("settings_data_header")}),m.jsxs("div",{className:"settings-section-body",children:[m.jsx("div",{style:{fontSize:"12px",opacity:.7,marginBottom:"12px",padding:"8px",backgroundColor:"var(--bg-color-secondary)",borderRadius:"8px"},children:E("settings_data_header_desc")}),m.jsx("button",{className:"settings-item action-item",onClick:a,disabled:p!=="idle",children:m.jsx("span",{className:"action-text",children:E(p==="exporting"?"data_exporting":"settings_export_data")})}),m.jsxs("button",{className:"settings-item action-item",onClick:()=>{var Fe;return(Fe=fr.current)==null?void 0:Fe.click()},disabled:p!=="idle",children:[m.jsx("span",{className:"action-text",children:E(p==="importing"?"data_importing":"settings_import_data")}),m.jsx("input",{type:"file",ref:fr,onChange:l,accept:".json",style:{display:"none"}})]})]}),R.length>0&&m.jsxs(m.Fragment,{children:[m.jsx("div",{className:"settings-section-header",children:E("settings_share_link_header")}),m.jsxs("div",{className:"settings-section-body",children:[!rt&&m.jsx("button",{className:"settings-item action-item",onClick:pr,disabled:Ae,children:m.jsx("span",{className:"action-text",children:Ae?"단축 URL 생성 중...":E("settings_generate_link")})}),rt&&m.jsxs("div",{className:"share-link-container",children:[m.jsxs("div",{style:{marginBottom:"8px",fontSize:"12px",opacity:.7},children:[rt.length<100?"단축 URL":"일반 링크"," (",rt.length,"자)"]}),m.jsx("input",{type:"text",readOnly:!0,value:rt,onClick:Fe=>Fe.target.select()}),m.jsx("button",{onClick:xe,children:E("settings_copy_link")})]})]})]}),m.jsx("div",{className:"settings-section-header",children:E("settings_delete_account")}),m.jsx("div",{className:"settings-section-body",children:m.jsx("button",{className:"settings-item action-item",onClick:jn,disabled:p!=="idle",children:m.jsx("span",{className:"action-text destructive",children:E(p==="deleting"?"data_deleting":"settings_delete_account")})})})]});default:return null}};return m.jsxs(So,{onClose:ve,isClosing:fe,className:"settings-modal",size:zt,dismissible:!1,children:[m.jsxs("div",{className:"settings-modal-header",children:[m.jsx("h2",{children:E("settings_title")}),m.jsx("div",{className:"settings-modal-header-right",children:m.jsx("button",{onClick:ve,className:"secondary header-close-text",children:"닫기"})})]}),m.jsxs("div",{className:"settings-modal-body",children:[m.jsx("div",{className:"settings-tabs",children:Kn.map(Fe=>m.jsxs("button",{className:`settings-tab-button ${Ee===Fe.id?"active":""}`,onClick:()=>Oe(Fe.id),"aria-label":Fe.label,children:[m.jsx("div",{className:"settings-tab-icon",children:Fe.icon}),m.jsx("span",{children:Fe.label})]},Fe.id))}),m.jsx("div",{className:"settings-tab-content-container",children:m.jsx("div",{className:"settings-tab-content",children:$t()},Ee)})]}),Wn&&m.jsx("div",{className:"modal-backdrop alert-backdrop",children:m.jsxs("div",{className:"modal-content alert-modal",children:[m.jsxs("div",{className:"alert-content",children:[m.jsx("h2",{children:"알림"}),m.jsx("p",{children:Wn})]}),m.jsx("div",{className:"modal-buttons",children:m.jsx("button",{onClick:()=>kn(null),className:"primary",children:"확인"})})]})})]})},YI=({onClose:t,t:e})=>{const[n,r]=nl(t),i="25.10.28B2",s=[{icon:"🔔",title:"미리알림 관리",desc:"Step-by-step 미리알림 추가. 제목, 기한(선택), 시간(선택), 반복 설정, 설명, 활성화 여부"},{icon:"📅",title:"유연한 날짜/시간 설정",desc:"기한 없음, 시간 없음 옵션으로 필요한 정보만 선택적 입력 가능"},{icon:"🎯",title:"WOOP 목표 설정",desc:"5단계 마법사 (Wish → Outcome → Obstacle → Plan → 기한/반복)로 구조화된 목표 계획"},{icon:"🤖",title:"AI 코치 피드백",desc:"Gemini API 기반 각 단계별 실시간 AI 피드백으로 목표 개선"},{icon:"🔐",title:"Google 로그인",desc:"Google OAuth 인증으로 보안 강화 및 계정 관리"},{icon:"☁️",title:"Firebase 클라우드 동기화",desc:"목표, 설정, 미리알림 등 모든 데이터 Firebase Firestore에 자동 저장"},{icon:"🔄",title:"자동 동기화 제어",desc:"켜고 끄기 옵션으로 클라우드 자동 동기화 제어 가능"},{icon:"🌙",title:"다크 모드 & 테마",desc:"시스템/라이트/다크 모드 자동 감지 및 8가지 배경 테마 지원"},{icon:"📱",title:"PWA & 오프라인",desc:"모바일 PWA 자동 설치 배너, 오프라인 모드, 푸시 알림 지원"},{icon:"🗓️",title:"달력 보기",desc:"3일/주간/월간 달력 뷰로 목표 스케줄링 및 시각화"},{icon:"📤",title:"데이터 내보내기/가져오기",desc:"JSON 형식으로 모든 데이터 로컬 저장 및 복원"},{icon:"🌍",title:"다국어 지원",desc:"한국어, 영어 등 다국어 인터페이스 지원"}];return m.jsxs(So,{onClose:r,isClosing:n,className:"version-info-modal",children:[m.jsxs("div",{className:"version-info-header",children:[m.jsx("h2",{children:"🧪 Nova 2.0"}),m.jsxs("p",{children:[e("build_number"),": ",i]})]}),m.jsx("div",{className:"version-info-body",children:s.map((o,a)=>m.jsxs("div",{className:"changelog-item",children:[m.jsx("div",{className:"changelog-icon",style:{"--icon-bg":"var(--primary-color)"},children:o.icon}),m.jsxs("div",{className:"changelog-text",children:[m.jsx("h3",{children:o.title}),m.jsx("p",{children:o.desc})]})]},a))}),m.jsx("div",{className:"modal-buttons",children:m.jsx("button",{onClick:r,className:"primary",children:e("settings_done_button")})})]})},G3=({onClose:t,t:e})=>{const[n,r]=nl(t),i=o=>{const a=/(https?:\/\/[^\s]+)/g;return o.split(a).map((u,f)=>a.test(u)?m.jsx("a",{href:u,target:"_blank",rel:"noopener noreferrer",className:"guide-link",children:u},f):u)},s=[{titleKey:"usage_basic_title",descKey:"usage_basic_desc"},{titleKey:"usage_ai_setup_title",descKey:"usage_ai_setup_desc"},{titleKey:"usage_ai_use_title",descKey:"usage_ai_use_desc"},{titleKey:"usage_share_title",descKey:"usage_share_desc"},{titleKey:"usage_theme_title",descKey:"usage_theme_desc"},{titleKey:"usage_calendar_title",descKey:"usage_calendar_desc"},{titleKey:"usage_offline_title",descKey:"usage_offline_desc"}];return m.jsxs(So,{onClose:r,isClosing:n,className:"usage-guide-modal",children:[m.jsx("div",{className:"version-info-header",children:m.jsx("h2",{children:e("usage_guide_title")})}),m.jsx("div",{className:"version-info-body",children:s.map((o,a)=>m.jsxs("div",{className:"usage-guide-item",children:[m.jsx("h3",{children:e(o.titleKey)}),m.jsx("p",{children:o.titleKey==="usage_ai_setup_title"?i(e(o.descKey)):e(o.descKey)})]},a))}),m.jsx("div",{className:"modal-buttons",children:m.jsx("button",{onClick:r,className:"primary",children:e("settings_done_button")})})]})},z3=({todos:t,t:e,onGoalClick:n,language:r})=>{const[i,s]=z.useState(new Date),[o,a]=z.useState("week"),l=g=>{const v=new Date(i);o==="month"?v.setMonth(v.getMonth()+g):o==="week"?v.setDate(v.getDate()+g*7):v.setDate(v.getDate()+g*3),s(v)},u=z.useMemo(()=>{const g=[];let v,E;if(o==="month"){const R=new Date(i.getFullYear(),i.getMonth(),1);v=KI(R,r==="ko"?1:0),E=42}else o==="week"?(v=KI(i,r==="ko"?1:0),E=7):(v=new Date(i),v.setDate(v.getDate()-1),E=3);for(let R=0;R<E;R++){const M=new Date(v);M.setDate(M.getDate()+R),g.push(M)}return g},[i,o,r]),f=z.useMemo(()=>{if(o==="month"){const g=i.getFullYear(),v=e("month_names")[i.getMonth()],E=e("calendar_header_month_format");return E&&typeof E=="string"&&E!=="calendar_header_month_format"?E.replace("{year}",String(g)).replace("{month}",v):`${v} ${g}`}return`${i.getFullYear()}.${i.getMonth()+1}`},[i,o,e]),p=z.useMemo(()=>{const g=e("day_names_short");if(r==="ko"&&Array.isArray(g)){const[v,...E]=g;return[...E,v]}return g},[r,e]);return m.jsxs("div",{className:"calendar-view-container",children:[m.jsxs("div",{className:"calendar-header",children:[m.jsx("button",{onClick:()=>l(-1),children:Le.back}),m.jsx("h2",{children:f}),m.jsx("button",{onClick:()=>l(1),children:Le.forward})]}),m.jsxs("div",{className:"calendar-view-mode-selector",children:[m.jsx("button",{onClick:()=>a("day3"),className:o==="day3"?"active":"",children:e("calendar_view_day3")}),m.jsx("button",{onClick:()=>a("week"),className:o==="week"?"active":"",children:e("calendar_view_week")}),m.jsx("button",{onClick:()=>a("month"),className:`calendar-view-button-month ${o==="month"?"active":""}`,children:e("calendar_view_month")})]}),(o==="week"||o==="month")&&m.jsx("div",{className:"calendar-days-of-week",children:Array.isArray(p)&&p.map(g=>m.jsx("div",{children:g},g))}),m.jsx("div",{className:`calendar-grid view-mode-${o}`,children:u.map(g=>{const E=uu(g,new Date),R=g.getMonth()===i.getMonth(),M=t.filter(A=>{if(A.isRecurring){const I=(g.getDay()+6)%7;return A.recurringDays.includes(I)}return A.deadline&&uu(g,A.deadline)});return m.jsxs("div",{className:`calendar-day ${!R&&o==="month"?"not-current-month":""} ${E?"is-today":""}`,"data-day-name":e("day_names_long")[g.getDay()],children:[m.jsx("div",{className:"day-header",children:m.jsx("span",{className:"day-number",children:g.getDate()})}),m.jsx("div",{className:"calendar-goals",children:M.map(A=>m.jsx("div",{className:`calendar-goal-item ${A.completed&&A.lastCompletedDate&&uu(g,A.lastCompletedDate)?"completed":""}`,onClick:()=>n(A),children:A.wish},A.id))})]},g.toISOString())})})]})},$3=({title:t,message:e,onConfirm:n,onCancel:r,confirmText:i,cancelText:s,isDestructive:o,t:a})=>{const l=typeof r=="function";return m.jsx("div",{className:"modal-backdrop alert-backdrop",children:m.jsxs("div",{className:"modal-content alert-modal",children:[m.jsxs("div",{className:"alert-content",children:[m.jsx("h2",{children:t}),m.jsx("p",{dangerouslySetInnerHTML:{__html:e}})]}),m.jsxs("div",{className:"modal-buttons",children:[l&&m.jsx("button",{onClick:r,className:"secondary",children:s||a("cancel_button")}),m.jsx("button",{onClick:n,className:o?"destructive":"primary",children:i||a("confirm_button")})]})]})})},H3=Ap.createRoot(document.getElementById("root"));H3.render(m.jsx(uw.StrictMode,{children:m.jsx(D3,{})}));
