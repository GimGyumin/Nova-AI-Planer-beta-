function XI(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var ZI={exports:{}},Sh={},ew={exports:{}},De={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Uu=Symbol.for("react.element"),iR=Symbol.for("react.portal"),sR=Symbol.for("react.fragment"),oR=Symbol.for("react.strict_mode"),aR=Symbol.for("react.profiler"),lR=Symbol.for("react.provider"),uR=Symbol.for("react.context"),cR=Symbol.for("react.forward_ref"),dR=Symbol.for("react.suspense"),hR=Symbol.for("react.memo"),fR=Symbol.for("react.lazy"),vy=Symbol.iterator;function pR(t){return t===null||typeof t!="object"?null:(t=vy&&t[vy]||t["@@iterator"],typeof t=="function"?t:null)}var tw={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},nw=Object.assign,rw={};function qa(t,e,n){this.props=t,this.context=e,this.refs=rw,this.updater=n||tw}qa.prototype.isReactComponent={};qa.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};qa.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function iw(){}iw.prototype=qa.prototype;function og(t,e,n){this.props=t,this.context=e,this.refs=rw,this.updater=n||tw}var ag=og.prototype=new iw;ag.constructor=og;nw(ag,qa.prototype);ag.isPureReactComponent=!0;var Ty=Array.isArray,sw=Object.prototype.hasOwnProperty,lg={current:null},ow={key:!0,ref:!0,__self:!0,__source:!0};function aw(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)sw.call(e,r)&&!ow.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];i.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:Uu,type:t,key:s,ref:o,props:i,_owner:lg.current}}function mR(t,e){return{$$typeof:Uu,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function ug(t){return typeof t=="object"&&t!==null&&t.$$typeof===Uu}function gR(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Ey=/\/+/g;function bf(t,e){return typeof t=="object"&&t!==null&&t.key!=null?gR(""+t.key):e.toString(36)}function Qc(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Uu:case iR:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+bf(o,0):r,Ty(i)?(n="",t!=null&&(n=t.replace(Ey,"$&/")+"/"),Qc(i,e,n,"",function(u){return u})):i!=null&&(ug(i)&&(i=mR(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(Ey,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",Ty(t))for(var a=0;a<t.length;a++){s=t[a];var l=r+bf(s,a);o+=Qc(s,e,n,l,i)}else if(l=pR(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=r+bf(s,a++),o+=Qc(s,e,n,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Cc(t,e,n){if(t==null)return t;var r=[],i=0;return Qc(t,r,"","",function(s){return e.call(n,s,i++)}),r}function _R(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var ln={current:null},Yc={transition:null},yR={ReactCurrentDispatcher:ln,ReactCurrentBatchConfig:Yc,ReactCurrentOwner:lg};function lw(){throw Error("act(...) is not supported in production builds of React.")}De.Children={map:Cc,forEach:function(t,e,n){Cc(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Cc(t,function(){e++}),e},toArray:function(t){return Cc(t,function(e){return e})||[]},only:function(t){if(!ug(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};De.Component=qa;De.Fragment=sR;De.Profiler=aR;De.PureComponent=og;De.StrictMode=oR;De.Suspense=dR;De.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=yR;De.act=lw;De.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=nw({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=lg.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)sw.call(e,l)&&!ow.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];r.children=a}return{$$typeof:Uu,type:t.type,key:i,ref:s,props:r,_owner:o}};De.createContext=function(t){return t={$$typeof:uR,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:lR,_context:t},t.Consumer=t};De.createElement=aw;De.createFactory=function(t){var e=aw.bind(null,t);return e.type=t,e};De.createRef=function(){return{current:null}};De.forwardRef=function(t){return{$$typeof:cR,render:t}};De.isValidElement=ug;De.lazy=function(t){return{$$typeof:fR,_payload:{_status:-1,_result:t},_init:_R}};De.memo=function(t,e){return{$$typeof:hR,type:t,compare:e===void 0?null:e}};De.startTransition=function(t){var e=Yc.transition;Yc.transition={};try{t()}finally{Yc.transition=e}};De.unstable_act=lw;De.useCallback=function(t,e){return ln.current.useCallback(t,e)};De.useContext=function(t){return ln.current.useContext(t)};De.useDebugValue=function(){};De.useDeferredValue=function(t){return ln.current.useDeferredValue(t)};De.useEffect=function(t,e){return ln.current.useEffect(t,e)};De.useId=function(){return ln.current.useId()};De.useImperativeHandle=function(t,e,n){return ln.current.useImperativeHandle(t,e,n)};De.useInsertionEffect=function(t,e){return ln.current.useInsertionEffect(t,e)};De.useLayoutEffect=function(t,e){return ln.current.useLayoutEffect(t,e)};De.useMemo=function(t,e){return ln.current.useMemo(t,e)};De.useReducer=function(t,e,n){return ln.current.useReducer(t,e,n)};De.useRef=function(t){return ln.current.useRef(t)};De.useState=function(t){return ln.current.useState(t)};De.useSyncExternalStore=function(t,e,n){return ln.current.useSyncExternalStore(t,e,n)};De.useTransition=function(){return ln.current.useTransition()};De.version="18.3.1";ew.exports=De;var z=ew.exports;const uw=XI(z);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vR=z,TR=Symbol.for("react.element"),ER=Symbol.for("react.fragment"),IR=Object.prototype.hasOwnProperty,wR=vR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,SR={key:!0,ref:!0,__self:!0,__source:!0};function cw(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)IR.call(e,r)&&!SR.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:TR,type:t,key:s,ref:o,props:i,_owner:wR.current}}Sh.Fragment=ER;Sh.jsx=cw;Sh.jsxs=cw;ZI.exports=Sh;var m=ZI.exports,Tp={},dw={exports:{}},Rn={},hw={exports:{}},fw={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(Z,he){var ve=Z.length;Z.push(he);e:for(;0<ve;){var Ie=ve-1>>>1,Oe=Z[Ie];if(0<i(Oe,he))Z[Ie]=he,Z[ve]=Oe,ve=Ie;else break e}}function n(Z){return Z.length===0?null:Z[0]}function r(Z){if(Z.length===0)return null;var he=Z[0],ve=Z.pop();if(ve!==he){Z[0]=ve;e:for(var Ie=0,Oe=Z.length,tt=Oe>>>1;Ie<tt;){var Je=2*(Ie+1)-1,Se=Z[Je],Qe=Je+1,Gt=Z[Qe];if(0>i(Se,ve))Qe<Oe&&0>i(Gt,Se)?(Z[Ie]=Gt,Z[Qe]=ve,Ie=Qe):(Z[Ie]=Se,Z[Je]=ve,Ie=Je);else if(Qe<Oe&&0>i(Gt,ve))Z[Ie]=Gt,Z[Qe]=ve,Ie=Qe;else break e}}return he}function i(Z,he){var ve=Z.sortIndex-he.sortIndex;return ve!==0?ve:Z.id-he.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],u=[],f=1,p=null,g=3,v=!1,E=!1,x=!1,b=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,I=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(Z){for(var he=n(u);he!==null;){if(he.callback===null)r(u);else if(he.startTime<=Z)r(u),he.sortIndex=he.expirationTime,e(l,he);else break;he=n(u)}}function V(Z){if(x=!1,S(Z),!E)if(n(l)!==null)E=!0,je(U);else{var he=n(u);he!==null&&ye(V,he.startTime-Z)}}function U(Z,he){E=!1,x&&(x=!1,C(w),w=-1),v=!0;var ve=g;try{for(S(he),p=n(l);p!==null&&(!(p.expirationTime>he)||Z&&!D());){var Ie=p.callback;if(typeof Ie=="function"){p.callback=null,g=p.priorityLevel;var Oe=Ie(p.expirationTime<=he);he=t.unstable_now(),typeof Oe=="function"?p.callback=Oe:p===n(l)&&r(l),S(he)}else r(l);p=n(l)}if(p!==null)var tt=!0;else{var Je=n(u);Je!==null&&ye(V,Je.startTime-he),tt=!1}return tt}finally{p=null,g=ve,v=!1}}var B=!1,T=null,w=-1,A=5,k=-1;function D(){return!(t.unstable_now()-k<A)}function L(){if(T!==null){var Z=t.unstable_now();k=Z;var he=!0;try{he=T(!0,Z)}finally{he?N():(B=!1,T=null)}}else B=!1}var N;if(typeof I=="function")N=function(){I(L)};else if(typeof MessageChannel<"u"){var Ve=new MessageChannel,Ze=Ve.port2;Ve.port1.onmessage=L,N=function(){Ze.postMessage(null)}}else N=function(){b(L,0)};function je(Z){T=Z,B||(B=!0,N())}function ye(Z,he){w=b(function(){Z(t.unstable_now())},he)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Z){Z.callback=null},t.unstable_continueExecution=function(){E||v||(E=!0,je(U))},t.unstable_forceFrameRate=function(Z){0>Z||125<Z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<Z?Math.floor(1e3/Z):5},t.unstable_getCurrentPriorityLevel=function(){return g},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(Z){switch(g){case 1:case 2:case 3:var he=3;break;default:he=g}var ve=g;g=he;try{return Z()}finally{g=ve}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Z,he){switch(Z){case 1:case 2:case 3:case 4:case 5:break;default:Z=3}var ve=g;g=Z;try{return he()}finally{g=ve}},t.unstable_scheduleCallback=function(Z,he,ve){var Ie=t.unstable_now();switch(typeof ve=="object"&&ve!==null?(ve=ve.delay,ve=typeof ve=="number"&&0<ve?Ie+ve:Ie):ve=Ie,Z){case 1:var Oe=-1;break;case 2:Oe=250;break;case 5:Oe=1073741823;break;case 4:Oe=1e4;break;default:Oe=5e3}return Oe=ve+Oe,Z={id:f++,callback:he,priorityLevel:Z,startTime:ve,expirationTime:Oe,sortIndex:-1},ve>Ie?(Z.sortIndex=ve,e(u,Z),n(l)===null&&Z===n(u)&&(x?(C(w),w=-1):x=!0,ye(V,ve-Ie))):(Z.sortIndex=Oe,e(l,Z),E||v||(E=!0,je(U))),Z},t.unstable_shouldYield=D,t.unstable_wrapCallback=function(Z){var he=g;return function(){var ve=g;g=he;try{return Z.apply(this,arguments)}finally{g=ve}}}})(fw);hw.exports=fw;var CR=hw.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var AR=z,An=CR;function te(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var pw=new Set,au={};function uo(t,e){ya(t,e),ya(t+"Capture",e)}function ya(t,e){for(au[t]=e,t=0;t<e.length;t++)pw.add(e[t])}var jr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ep=Object.prototype.hasOwnProperty,xR=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Iy={},wy={};function RR(t){return Ep.call(wy,t)?!0:Ep.call(Iy,t)?!1:xR.test(t)?wy[t]=!0:(Iy[t]=!0,!1)}function PR(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function kR(t,e,n,r){if(e===null||typeof e>"u"||PR(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function un(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var qt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){qt[t]=new un(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];qt[e]=new un(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){qt[t]=new un(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){qt[t]=new un(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){qt[t]=new un(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){qt[t]=new un(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){qt[t]=new un(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){qt[t]=new un(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){qt[t]=new un(t,5,!1,t.toLowerCase(),null,!1,!1)});var cg=/[\-:]([a-z])/g;function dg(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(cg,dg);qt[e]=new un(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(cg,dg);qt[e]=new un(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(cg,dg);qt[e]=new un(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){qt[t]=new un(t,1,!1,t.toLowerCase(),null,!1,!1)});qt.xlinkHref=new un("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){qt[t]=new un(t,1,!1,t.toLowerCase(),null,!0,!0)});function hg(t,e,n,r){var i=qt.hasOwnProperty(e)?qt[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(kR(e,n,i,r)&&(n=null),r||i===null?RR(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var ni=AR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ac=Symbol.for("react.element"),Ho=Symbol.for("react.portal"),Wo=Symbol.for("react.fragment"),fg=Symbol.for("react.strict_mode"),Ip=Symbol.for("react.profiler"),mw=Symbol.for("react.provider"),gw=Symbol.for("react.context"),pg=Symbol.for("react.forward_ref"),wp=Symbol.for("react.suspense"),Sp=Symbol.for("react.suspense_list"),mg=Symbol.for("react.memo"),Ti=Symbol.for("react.lazy"),_w=Symbol.for("react.offscreen"),Sy=Symbol.iterator;function ml(t){return t===null||typeof t!="object"?null:(t=Sy&&t[Sy]||t["@@iterator"],typeof t=="function"?t:null)}var mt=Object.assign,Mf;function Pl(t){if(Mf===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Mf=e&&e[1]||""}return`
`+Mf+t}var Vf=!1;function Lf(t,e){if(!t||Vf)return"";Vf=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{Vf=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Pl(t):""}function NR(t){switch(t.tag){case 5:return Pl(t.type);case 16:return Pl("Lazy");case 13:return Pl("Suspense");case 19:return Pl("SuspenseList");case 0:case 2:case 15:return t=Lf(t.type,!1),t;case 11:return t=Lf(t.type.render,!1),t;case 1:return t=Lf(t.type,!0),t;default:return""}}function Cp(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Wo:return"Fragment";case Ho:return"Portal";case Ip:return"Profiler";case fg:return"StrictMode";case wp:return"Suspense";case Sp:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case gw:return(t.displayName||"Context")+".Consumer";case mw:return(t._context.displayName||"Context")+".Provider";case pg:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case mg:return e=t.displayName||null,e!==null?e:Cp(t.type)||"Memo";case Ti:e=t._payload,t=t._init;try{return Cp(t(e))}catch{}}return null}function DR(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Cp(e);case 8:return e===fg?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Wi(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function yw(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function bR(t){var e=yw(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function xc(t){t._valueTracker||(t._valueTracker=bR(t))}function vw(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=yw(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Cd(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Ap(t,e){var n=e.checked;return mt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Cy(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Wi(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Tw(t,e){e=e.checked,e!=null&&hg(t,"checked",e,!1)}function xp(t,e){Tw(t,e);var n=Wi(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Rp(t,e.type,n):e.hasOwnProperty("defaultValue")&&Rp(t,e.type,Wi(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Ay(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Rp(t,e,n){(e!=="number"||Cd(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var kl=Array.isArray;function sa(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Wi(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Pp(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(te(91));return mt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function xy(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(te(92));if(kl(n)){if(1<n.length)throw Error(te(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Wi(n)}}function Ew(t,e){var n=Wi(e.value),r=Wi(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Ry(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Iw(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function kp(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Iw(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Rc,ww=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Rc=Rc||document.createElement("div"),Rc.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Rc.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function lu(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Ol={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},MR=["Webkit","ms","Moz","O"];Object.keys(Ol).forEach(function(t){MR.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Ol[e]=Ol[t]})});function Sw(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Ol.hasOwnProperty(t)&&Ol[t]?(""+e).trim():e+"px"}function Cw(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=Sw(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var VR=mt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Np(t,e){if(e){if(VR[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(te(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(te(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(te(61))}if(e.style!=null&&typeof e.style!="object")throw Error(te(62))}}function Dp(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var bp=null;function gg(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Mp=null,oa=null,aa=null;function Py(t){if(t=qu(t)){if(typeof Mp!="function")throw Error(te(280));var e=t.stateNode;e&&(e=Ph(e),Mp(t.stateNode,t.type,e))}}function Aw(t){oa?aa?aa.push(t):aa=[t]:oa=t}function xw(){if(oa){var t=oa,e=aa;if(aa=oa=null,Py(t),e)for(t=0;t<e.length;t++)Py(e[t])}}function Rw(t,e){return t(e)}function Pw(){}var Ff=!1;function kw(t,e,n){if(Ff)return t(e,n);Ff=!0;try{return Rw(t,e,n)}finally{Ff=!1,(oa!==null||aa!==null)&&(Pw(),xw())}}function uu(t,e){var n=t.stateNode;if(n===null)return null;var r=Ph(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(te(231,e,typeof n));return n}var Vp=!1;if(jr)try{var gl={};Object.defineProperty(gl,"passive",{get:function(){Vp=!0}}),window.addEventListener("test",gl,gl),window.removeEventListener("test",gl,gl)}catch{Vp=!1}function LR(t,e,n,r,i,s,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(f){this.onError(f)}}var Bl=!1,Ad=null,xd=!1,Lp=null,FR={onError:function(t){Bl=!0,Ad=t}};function UR(t,e,n,r,i,s,o,a,l){Bl=!1,Ad=null,LR.apply(FR,arguments)}function OR(t,e,n,r,i,s,o,a,l){if(UR.apply(this,arguments),Bl){if(Bl){var u=Ad;Bl=!1,Ad=null}else throw Error(te(198));xd||(xd=!0,Lp=u)}}function co(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Nw(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function ky(t){if(co(t)!==t)throw Error(te(188))}function BR(t){var e=t.alternate;if(!e){if(e=co(t),e===null)throw Error(te(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return ky(i),t;if(s===r)return ky(i),e;s=s.sibling}throw Error(te(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(te(189))}}if(n.alternate!==r)throw Error(te(190))}if(n.tag!==3)throw Error(te(188));return n.stateNode.current===n?t:e}function Dw(t){return t=BR(t),t!==null?bw(t):null}function bw(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=bw(t);if(e!==null)return e;t=t.sibling}return null}var Mw=An.unstable_scheduleCallback,Ny=An.unstable_cancelCallback,qR=An.unstable_shouldYield,GR=An.unstable_requestPaint,Tt=An.unstable_now,zR=An.unstable_getCurrentPriorityLevel,_g=An.unstable_ImmediatePriority,Vw=An.unstable_UserBlockingPriority,Rd=An.unstable_NormalPriority,$R=An.unstable_LowPriority,Lw=An.unstable_IdlePriority,Ch=null,Cr=null;function HR(t){if(Cr&&typeof Cr.onCommitFiberRoot=="function")try{Cr.onCommitFiberRoot(Ch,t,void 0,(t.current.flags&128)===128)}catch{}}var nr=Math.clz32?Math.clz32:jR,WR=Math.log,KR=Math.LN2;function jR(t){return t>>>=0,t===0?32:31-(WR(t)/KR|0)|0}var Pc=64,kc=4194304;function Nl(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Pd(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=Nl(a):(s&=o,s!==0&&(r=Nl(s)))}else o=n&~i,o!==0?r=Nl(o):s!==0&&(r=Nl(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-nr(e),i=1<<n,r|=t[n],e&=~i;return r}function JR(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function QR(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-nr(s),a=1<<o,l=i[o];l===-1?(!(a&n)||a&r)&&(i[o]=JR(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function Fp(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Fw(){var t=Pc;return Pc<<=1,!(Pc&4194240)&&(Pc=64),t}function Uf(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Ou(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-nr(e),t[e]=n}function YR(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-nr(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function yg(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-nr(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var We=0;function Uw(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Ow,vg,Bw,qw,Gw,Up=!1,Nc=[],Ni=null,Di=null,bi=null,cu=new Map,du=new Map,Ii=[],XR="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Dy(t,e){switch(t){case"focusin":case"focusout":Ni=null;break;case"dragenter":case"dragleave":Di=null;break;case"mouseover":case"mouseout":bi=null;break;case"pointerover":case"pointerout":cu.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":du.delete(e.pointerId)}}function _l(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=qu(e),e!==null&&vg(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function ZR(t,e,n,r,i){switch(e){case"focusin":return Ni=_l(Ni,t,e,n,r,i),!0;case"dragenter":return Di=_l(Di,t,e,n,r,i),!0;case"mouseover":return bi=_l(bi,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return cu.set(s,_l(cu.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,du.set(s,_l(du.get(s)||null,t,e,n,r,i)),!0}return!1}function zw(t){var e=Fs(t.target);if(e!==null){var n=co(e);if(n!==null){if(e=n.tag,e===13){if(e=Nw(n),e!==null){t.blockedOn=e,Gw(t.priority,function(){Bw(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Xc(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Op(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);bp=r,n.target.dispatchEvent(r),bp=null}else return e=qu(n),e!==null&&vg(e),t.blockedOn=n,!1;e.shift()}return!0}function by(t,e,n){Xc(t)&&n.delete(e)}function eP(){Up=!1,Ni!==null&&Xc(Ni)&&(Ni=null),Di!==null&&Xc(Di)&&(Di=null),bi!==null&&Xc(bi)&&(bi=null),cu.forEach(by),du.forEach(by)}function yl(t,e){t.blockedOn===e&&(t.blockedOn=null,Up||(Up=!0,An.unstable_scheduleCallback(An.unstable_NormalPriority,eP)))}function hu(t){function e(i){return yl(i,t)}if(0<Nc.length){yl(Nc[0],t);for(var n=1;n<Nc.length;n++){var r=Nc[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Ni!==null&&yl(Ni,t),Di!==null&&yl(Di,t),bi!==null&&yl(bi,t),cu.forEach(e),du.forEach(e),n=0;n<Ii.length;n++)r=Ii[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Ii.length&&(n=Ii[0],n.blockedOn===null);)zw(n),n.blockedOn===null&&Ii.shift()}var la=ni.ReactCurrentBatchConfig,kd=!0;function tP(t,e,n,r){var i=We,s=la.transition;la.transition=null;try{We=1,Tg(t,e,n,r)}finally{We=i,la.transition=s}}function nP(t,e,n,r){var i=We,s=la.transition;la.transition=null;try{We=4,Tg(t,e,n,r)}finally{We=i,la.transition=s}}function Tg(t,e,n,r){if(kd){var i=Op(t,e,n,r);if(i===null)jf(t,e,r,Nd,n),Dy(t,r);else if(ZR(i,t,e,n,r))r.stopPropagation();else if(Dy(t,r),e&4&&-1<XR.indexOf(t)){for(;i!==null;){var s=qu(i);if(s!==null&&Ow(s),s=Op(t,e,n,r),s===null&&jf(t,e,r,Nd,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else jf(t,e,r,null,n)}}var Nd=null;function Op(t,e,n,r){if(Nd=null,t=gg(r),t=Fs(t),t!==null)if(e=co(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Nw(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Nd=t,null}function $w(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(zR()){case _g:return 1;case Vw:return 4;case Rd:case $R:return 16;case Lw:return 536870912;default:return 16}default:return 16}}var Ri=null,Eg=null,Zc=null;function Hw(){if(Zc)return Zc;var t,e=Eg,n=e.length,r,i="value"in Ri?Ri.value:Ri.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return Zc=i.slice(t,1<r?1-r:void 0)}function ed(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Dc(){return!0}function My(){return!1}function Pn(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Dc:My,this.isPropagationStopped=My,this}return mt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Dc)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Dc)},persist:function(){},isPersistent:Dc}),e}var Ga={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ig=Pn(Ga),Bu=mt({},Ga,{view:0,detail:0}),rP=Pn(Bu),Of,Bf,vl,Ah=mt({},Bu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:wg,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==vl&&(vl&&t.type==="mousemove"?(Of=t.screenX-vl.screenX,Bf=t.screenY-vl.screenY):Bf=Of=0,vl=t),Of)},movementY:function(t){return"movementY"in t?t.movementY:Bf}}),Vy=Pn(Ah),iP=mt({},Ah,{dataTransfer:0}),sP=Pn(iP),oP=mt({},Bu,{relatedTarget:0}),qf=Pn(oP),aP=mt({},Ga,{animationName:0,elapsedTime:0,pseudoElement:0}),lP=Pn(aP),uP=mt({},Ga,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),cP=Pn(uP),dP=mt({},Ga,{data:0}),Ly=Pn(dP),hP={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fP={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},pP={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function mP(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=pP[t])?!!e[t]:!1}function wg(){return mP}var gP=mt({},Bu,{key:function(t){if(t.key){var e=hP[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=ed(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?fP[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:wg,charCode:function(t){return t.type==="keypress"?ed(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?ed(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),_P=Pn(gP),yP=mt({},Ah,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Fy=Pn(yP),vP=mt({},Bu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:wg}),TP=Pn(vP),EP=mt({},Ga,{propertyName:0,elapsedTime:0,pseudoElement:0}),IP=Pn(EP),wP=mt({},Ah,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),SP=Pn(wP),CP=[9,13,27,32],Sg=jr&&"CompositionEvent"in window,ql=null;jr&&"documentMode"in document&&(ql=document.documentMode);var AP=jr&&"TextEvent"in window&&!ql,Ww=jr&&(!Sg||ql&&8<ql&&11>=ql),Uy=" ",Oy=!1;function Kw(t,e){switch(t){case"keyup":return CP.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function jw(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ko=!1;function xP(t,e){switch(t){case"compositionend":return jw(e);case"keypress":return e.which!==32?null:(Oy=!0,Uy);case"textInput":return t=e.data,t===Uy&&Oy?null:t;default:return null}}function RP(t,e){if(Ko)return t==="compositionend"||!Sg&&Kw(t,e)?(t=Hw(),Zc=Eg=Ri=null,Ko=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Ww&&e.locale!=="ko"?null:e.data;default:return null}}var PP={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function By(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!PP[t.type]:e==="textarea"}function Jw(t,e,n,r){Aw(r),e=Dd(e,"onChange"),0<e.length&&(n=new Ig("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Gl=null,fu=null;function kP(t){oS(t,0)}function xh(t){var e=Qo(t);if(vw(e))return t}function NP(t,e){if(t==="change")return e}var Qw=!1;if(jr){var Gf;if(jr){var zf="oninput"in document;if(!zf){var qy=document.createElement("div");qy.setAttribute("oninput","return;"),zf=typeof qy.oninput=="function"}Gf=zf}else Gf=!1;Qw=Gf&&(!document.documentMode||9<document.documentMode)}function Gy(){Gl&&(Gl.detachEvent("onpropertychange",Yw),fu=Gl=null)}function Yw(t){if(t.propertyName==="value"&&xh(fu)){var e=[];Jw(e,fu,t,gg(t)),kw(kP,e)}}function DP(t,e,n){t==="focusin"?(Gy(),Gl=e,fu=n,Gl.attachEvent("onpropertychange",Yw)):t==="focusout"&&Gy()}function bP(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return xh(fu)}function MP(t,e){if(t==="click")return xh(e)}function VP(t,e){if(t==="input"||t==="change")return xh(e)}function LP(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var ar=typeof Object.is=="function"?Object.is:LP;function pu(t,e){if(ar(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Ep.call(e,i)||!ar(t[i],e[i]))return!1}return!0}function zy(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function $y(t,e){var n=zy(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=zy(n)}}function Xw(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Xw(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Zw(){for(var t=window,e=Cd();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Cd(t.document)}return e}function Cg(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function FP(t){var e=Zw(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Xw(n.ownerDocument.documentElement,n)){if(r!==null&&Cg(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=$y(n,s);var o=$y(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var UP=jr&&"documentMode"in document&&11>=document.documentMode,jo=null,Bp=null,zl=null,qp=!1;function Hy(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;qp||jo==null||jo!==Cd(r)||(r=jo,"selectionStart"in r&&Cg(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),zl&&pu(zl,r)||(zl=r,r=Dd(Bp,"onSelect"),0<r.length&&(e=new Ig("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=jo)))}function bc(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Jo={animationend:bc("Animation","AnimationEnd"),animationiteration:bc("Animation","AnimationIteration"),animationstart:bc("Animation","AnimationStart"),transitionend:bc("Transition","TransitionEnd")},$f={},eS={};jr&&(eS=document.createElement("div").style,"AnimationEvent"in window||(delete Jo.animationend.animation,delete Jo.animationiteration.animation,delete Jo.animationstart.animation),"TransitionEvent"in window||delete Jo.transitionend.transition);function Rh(t){if($f[t])return $f[t];if(!Jo[t])return t;var e=Jo[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in eS)return $f[t]=e[n];return t}var tS=Rh("animationend"),nS=Rh("animationiteration"),rS=Rh("animationstart"),iS=Rh("transitionend"),sS=new Map,Wy="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ts(t,e){sS.set(t,e),uo(e,[t])}for(var Hf=0;Hf<Wy.length;Hf++){var Wf=Wy[Hf],OP=Wf.toLowerCase(),BP=Wf[0].toUpperCase()+Wf.slice(1);ts(OP,"on"+BP)}ts(tS,"onAnimationEnd");ts(nS,"onAnimationIteration");ts(rS,"onAnimationStart");ts("dblclick","onDoubleClick");ts("focusin","onFocus");ts("focusout","onBlur");ts(iS,"onTransitionEnd");ya("onMouseEnter",["mouseout","mouseover"]);ya("onMouseLeave",["mouseout","mouseover"]);ya("onPointerEnter",["pointerout","pointerover"]);ya("onPointerLeave",["pointerout","pointerover"]);uo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));uo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));uo("onBeforeInput",["compositionend","keypress","textInput","paste"]);uo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));uo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));uo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Dl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),qP=new Set("cancel close invalid load scroll toggle".split(" ").concat(Dl));function Ky(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,OR(r,e,void 0,t),t.currentTarget=null}function oS(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;Ky(i,a,u),s=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;Ky(i,a,u),s=l}}}if(xd)throw t=Lp,xd=!1,Lp=null,t}function rt(t,e){var n=e[Wp];n===void 0&&(n=e[Wp]=new Set);var r=t+"__bubble";n.has(r)||(aS(e,t,2,!1),n.add(r))}function Kf(t,e,n){var r=0;e&&(r|=4),aS(n,t,r,e)}var Mc="_reactListening"+Math.random().toString(36).slice(2);function mu(t){if(!t[Mc]){t[Mc]=!0,pw.forEach(function(n){n!=="selectionchange"&&(qP.has(n)||Kf(n,!1,t),Kf(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Mc]||(e[Mc]=!0,Kf("selectionchange",!1,e))}}function aS(t,e,n,r){switch($w(e)){case 1:var i=tP;break;case 4:i=nP;break;default:i=Tg}n=i.bind(null,e,n,t),i=void 0,!Vp||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function jf(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=Fs(a),o===null)return;if(l=o.tag,l===5||l===6){r=s=o;continue e}a=a.parentNode}}r=r.return}kw(function(){var u=s,f=gg(n),p=[];e:{var g=sS.get(t);if(g!==void 0){var v=Ig,E=t;switch(t){case"keypress":if(ed(n)===0)break e;case"keydown":case"keyup":v=_P;break;case"focusin":E="focus",v=qf;break;case"focusout":E="blur",v=qf;break;case"beforeblur":case"afterblur":v=qf;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":v=Vy;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":v=sP;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":v=TP;break;case tS:case nS:case rS:v=lP;break;case iS:v=IP;break;case"scroll":v=rP;break;case"wheel":v=SP;break;case"copy":case"cut":case"paste":v=cP;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":v=Fy}var x=(e&4)!==0,b=!x&&t==="scroll",C=x?g!==null?g+"Capture":null:g;x=[];for(var I=u,S;I!==null;){S=I;var V=S.stateNode;if(S.tag===5&&V!==null&&(S=V,C!==null&&(V=uu(I,C),V!=null&&x.push(gu(I,V,S)))),b)break;I=I.return}0<x.length&&(g=new v(g,E,null,n,f),p.push({event:g,listeners:x}))}}if(!(e&7)){e:{if(g=t==="mouseover"||t==="pointerover",v=t==="mouseout"||t==="pointerout",g&&n!==bp&&(E=n.relatedTarget||n.fromElement)&&(Fs(E)||E[Jr]))break e;if((v||g)&&(g=f.window===f?f:(g=f.ownerDocument)?g.defaultView||g.parentWindow:window,v?(E=n.relatedTarget||n.toElement,v=u,E=E?Fs(E):null,E!==null&&(b=co(E),E!==b||E.tag!==5&&E.tag!==6)&&(E=null)):(v=null,E=u),v!==E)){if(x=Vy,V="onMouseLeave",C="onMouseEnter",I="mouse",(t==="pointerout"||t==="pointerover")&&(x=Fy,V="onPointerLeave",C="onPointerEnter",I="pointer"),b=v==null?g:Qo(v),S=E==null?g:Qo(E),g=new x(V,I+"leave",v,n,f),g.target=b,g.relatedTarget=S,V=null,Fs(f)===u&&(x=new x(C,I+"enter",E,n,f),x.target=S,x.relatedTarget=b,V=x),b=V,v&&E)t:{for(x=v,C=E,I=0,S=x;S;S=bo(S))I++;for(S=0,V=C;V;V=bo(V))S++;for(;0<I-S;)x=bo(x),I--;for(;0<S-I;)C=bo(C),S--;for(;I--;){if(x===C||C!==null&&x===C.alternate)break t;x=bo(x),C=bo(C)}x=null}else x=null;v!==null&&jy(p,g,v,x,!1),E!==null&&b!==null&&jy(p,b,E,x,!0)}}e:{if(g=u?Qo(u):window,v=g.nodeName&&g.nodeName.toLowerCase(),v==="select"||v==="input"&&g.type==="file")var U=NP;else if(By(g))if(Qw)U=VP;else{U=bP;var B=DP}else(v=g.nodeName)&&v.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(U=MP);if(U&&(U=U(t,u))){Jw(p,U,n,f);break e}B&&B(t,g,u),t==="focusout"&&(B=g._wrapperState)&&B.controlled&&g.type==="number"&&Rp(g,"number",g.value)}switch(B=u?Qo(u):window,t){case"focusin":(By(B)||B.contentEditable==="true")&&(jo=B,Bp=u,zl=null);break;case"focusout":zl=Bp=jo=null;break;case"mousedown":qp=!0;break;case"contextmenu":case"mouseup":case"dragend":qp=!1,Hy(p,n,f);break;case"selectionchange":if(UP)break;case"keydown":case"keyup":Hy(p,n,f)}var T;if(Sg)e:{switch(t){case"compositionstart":var w="onCompositionStart";break e;case"compositionend":w="onCompositionEnd";break e;case"compositionupdate":w="onCompositionUpdate";break e}w=void 0}else Ko?Kw(t,n)&&(w="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(w="onCompositionStart");w&&(Ww&&n.locale!=="ko"&&(Ko||w!=="onCompositionStart"?w==="onCompositionEnd"&&Ko&&(T=Hw()):(Ri=f,Eg="value"in Ri?Ri.value:Ri.textContent,Ko=!0)),B=Dd(u,w),0<B.length&&(w=new Ly(w,t,null,n,f),p.push({event:w,listeners:B}),T?w.data=T:(T=jw(n),T!==null&&(w.data=T)))),(T=AP?xP(t,n):RP(t,n))&&(u=Dd(u,"onBeforeInput"),0<u.length&&(f=new Ly("onBeforeInput","beforeinput",null,n,f),p.push({event:f,listeners:u}),f.data=T))}oS(p,e)})}function gu(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Dd(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=uu(t,n),s!=null&&r.unshift(gu(t,s,i)),s=uu(t,e),s!=null&&r.push(gu(t,s,i))),t=t.return}return r}function bo(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function jy(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,u=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&u!==null&&(a=u,i?(l=uu(n,s),l!=null&&o.unshift(gu(n,l,a))):i||(l=uu(n,s),l!=null&&o.push(gu(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var GP=/\r\n?/g,zP=/\u0000|\uFFFD/g;function Jy(t){return(typeof t=="string"?t:""+t).replace(GP,`
`).replace(zP,"")}function Vc(t,e,n){if(e=Jy(e),Jy(t)!==e&&n)throw Error(te(425))}function bd(){}var Gp=null,zp=null;function $p(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Hp=typeof setTimeout=="function"?setTimeout:void 0,$P=typeof clearTimeout=="function"?clearTimeout:void 0,Qy=typeof Promise=="function"?Promise:void 0,HP=typeof queueMicrotask=="function"?queueMicrotask:typeof Qy<"u"?function(t){return Qy.resolve(null).then(t).catch(WP)}:Hp;function WP(t){setTimeout(function(){throw t})}function Jf(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),hu(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);hu(e)}function Mi(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Yy(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var za=Math.random().toString(36).slice(2),Ir="__reactFiber$"+za,_u="__reactProps$"+za,Jr="__reactContainer$"+za,Wp="__reactEvents$"+za,KP="__reactListeners$"+za,jP="__reactHandles$"+za;function Fs(t){var e=t[Ir];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Jr]||n[Ir]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Yy(t);t!==null;){if(n=t[Ir])return n;t=Yy(t)}return e}t=n,n=t.parentNode}return null}function qu(t){return t=t[Ir]||t[Jr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Qo(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(te(33))}function Ph(t){return t[_u]||null}var Kp=[],Yo=-1;function ns(t){return{current:t}}function st(t){0>Yo||(t.current=Kp[Yo],Kp[Yo]=null,Yo--)}function et(t,e){Yo++,Kp[Yo]=t.current,t.current=e}var Ki={},Xt=ns(Ki),mn=ns(!1),Js=Ki;function va(t,e){var n=t.type.contextTypes;if(!n)return Ki;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function gn(t){return t=t.childContextTypes,t!=null}function Md(){st(mn),st(Xt)}function Xy(t,e,n){if(Xt.current!==Ki)throw Error(te(168));et(Xt,e),et(mn,n)}function lS(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(te(108,DR(t)||"Unknown",i));return mt({},n,r)}function Vd(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ki,Js=Xt.current,et(Xt,t),et(mn,mn.current),!0}function Zy(t,e,n){var r=t.stateNode;if(!r)throw Error(te(169));n?(t=lS(t,e,Js),r.__reactInternalMemoizedMergedChildContext=t,st(mn),st(Xt),et(Xt,t)):st(mn),et(mn,n)}var Or=null,kh=!1,Qf=!1;function uS(t){Or===null?Or=[t]:Or.push(t)}function JP(t){kh=!0,uS(t)}function rs(){if(!Qf&&Or!==null){Qf=!0;var t=0,e=We;try{var n=Or;for(We=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Or=null,kh=!1}catch(i){throw Or!==null&&(Or=Or.slice(t+1)),Mw(_g,rs),i}finally{We=e,Qf=!1}}return null}var Xo=[],Zo=0,Ld=null,Fd=0,bn=[],Mn=0,Qs=null,qr=1,Gr="";function Rs(t,e){Xo[Zo++]=Fd,Xo[Zo++]=Ld,Ld=t,Fd=e}function cS(t,e,n){bn[Mn++]=qr,bn[Mn++]=Gr,bn[Mn++]=Qs,Qs=t;var r=qr;t=Gr;var i=32-nr(r)-1;r&=~(1<<i),n+=1;var s=32-nr(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,qr=1<<32-nr(e)+i|n<<i|r,Gr=s+t}else qr=1<<s|n<<i|r,Gr=t}function Ag(t){t.return!==null&&(Rs(t,1),cS(t,1,0))}function xg(t){for(;t===Ld;)Ld=Xo[--Zo],Xo[Zo]=null,Fd=Xo[--Zo],Xo[Zo]=null;for(;t===Qs;)Qs=bn[--Mn],bn[Mn]=null,Gr=bn[--Mn],bn[Mn]=null,qr=bn[--Mn],bn[Mn]=null}var Cn=null,wn=null,ut=!1,Zn=null;function dS(t,e){var n=Vn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function ev(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Cn=t,wn=Mi(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Cn=t,wn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Qs!==null?{id:qr,overflow:Gr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Vn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Cn=t,wn=null,!0):!1;default:return!1}}function jp(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Jp(t){if(ut){var e=wn;if(e){var n=e;if(!ev(t,e)){if(jp(t))throw Error(te(418));e=Mi(n.nextSibling);var r=Cn;e&&ev(t,e)?dS(r,n):(t.flags=t.flags&-4097|2,ut=!1,Cn=t)}}else{if(jp(t))throw Error(te(418));t.flags=t.flags&-4097|2,ut=!1,Cn=t}}}function tv(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Cn=t}function Lc(t){if(t!==Cn)return!1;if(!ut)return tv(t),ut=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!$p(t.type,t.memoizedProps)),e&&(e=wn)){if(jp(t))throw hS(),Error(te(418));for(;e;)dS(t,e),e=Mi(e.nextSibling)}if(tv(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(te(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){wn=Mi(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}wn=null}}else wn=Cn?Mi(t.stateNode.nextSibling):null;return!0}function hS(){for(var t=wn;t;)t=Mi(t.nextSibling)}function Ta(){wn=Cn=null,ut=!1}function Rg(t){Zn===null?Zn=[t]:Zn.push(t)}var QP=ni.ReactCurrentBatchConfig;function Tl(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(te(309));var r=n.stateNode}if(!r)throw Error(te(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(te(284));if(!n._owner)throw Error(te(290,t))}return t}function Fc(t,e){throw t=Object.prototype.toString.call(e),Error(te(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function nv(t){var e=t._init;return e(t._payload)}function fS(t){function e(C,I){if(t){var S=C.deletions;S===null?(C.deletions=[I],C.flags|=16):S.push(I)}}function n(C,I){if(!t)return null;for(;I!==null;)e(C,I),I=I.sibling;return null}function r(C,I){for(C=new Map;I!==null;)I.key!==null?C.set(I.key,I):C.set(I.index,I),I=I.sibling;return C}function i(C,I){return C=Ui(C,I),C.index=0,C.sibling=null,C}function s(C,I,S){return C.index=S,t?(S=C.alternate,S!==null?(S=S.index,S<I?(C.flags|=2,I):S):(C.flags|=2,I)):(C.flags|=1048576,I)}function o(C){return t&&C.alternate===null&&(C.flags|=2),C}function a(C,I,S,V){return I===null||I.tag!==6?(I=rp(S,C.mode,V),I.return=C,I):(I=i(I,S),I.return=C,I)}function l(C,I,S,V){var U=S.type;return U===Wo?f(C,I,S.props.children,V,S.key):I!==null&&(I.elementType===U||typeof U=="object"&&U!==null&&U.$$typeof===Ti&&nv(U)===I.type)?(V=i(I,S.props),V.ref=Tl(C,I,S),V.return=C,V):(V=ad(S.type,S.key,S.props,null,C.mode,V),V.ref=Tl(C,I,S),V.return=C,V)}function u(C,I,S,V){return I===null||I.tag!==4||I.stateNode.containerInfo!==S.containerInfo||I.stateNode.implementation!==S.implementation?(I=ip(S,C.mode,V),I.return=C,I):(I=i(I,S.children||[]),I.return=C,I)}function f(C,I,S,V,U){return I===null||I.tag!==7?(I=zs(S,C.mode,V,U),I.return=C,I):(I=i(I,S),I.return=C,I)}function p(C,I,S){if(typeof I=="string"&&I!==""||typeof I=="number")return I=rp(""+I,C.mode,S),I.return=C,I;if(typeof I=="object"&&I!==null){switch(I.$$typeof){case Ac:return S=ad(I.type,I.key,I.props,null,C.mode,S),S.ref=Tl(C,null,I),S.return=C,S;case Ho:return I=ip(I,C.mode,S),I.return=C,I;case Ti:var V=I._init;return p(C,V(I._payload),S)}if(kl(I)||ml(I))return I=zs(I,C.mode,S,null),I.return=C,I;Fc(C,I)}return null}function g(C,I,S,V){var U=I!==null?I.key:null;if(typeof S=="string"&&S!==""||typeof S=="number")return U!==null?null:a(C,I,""+S,V);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Ac:return S.key===U?l(C,I,S,V):null;case Ho:return S.key===U?u(C,I,S,V):null;case Ti:return U=S._init,g(C,I,U(S._payload),V)}if(kl(S)||ml(S))return U!==null?null:f(C,I,S,V,null);Fc(C,S)}return null}function v(C,I,S,V,U){if(typeof V=="string"&&V!==""||typeof V=="number")return C=C.get(S)||null,a(I,C,""+V,U);if(typeof V=="object"&&V!==null){switch(V.$$typeof){case Ac:return C=C.get(V.key===null?S:V.key)||null,l(I,C,V,U);case Ho:return C=C.get(V.key===null?S:V.key)||null,u(I,C,V,U);case Ti:var B=V._init;return v(C,I,S,B(V._payload),U)}if(kl(V)||ml(V))return C=C.get(S)||null,f(I,C,V,U,null);Fc(I,V)}return null}function E(C,I,S,V){for(var U=null,B=null,T=I,w=I=0,A=null;T!==null&&w<S.length;w++){T.index>w?(A=T,T=null):A=T.sibling;var k=g(C,T,S[w],V);if(k===null){T===null&&(T=A);break}t&&T&&k.alternate===null&&e(C,T),I=s(k,I,w),B===null?U=k:B.sibling=k,B=k,T=A}if(w===S.length)return n(C,T),ut&&Rs(C,w),U;if(T===null){for(;w<S.length;w++)T=p(C,S[w],V),T!==null&&(I=s(T,I,w),B===null?U=T:B.sibling=T,B=T);return ut&&Rs(C,w),U}for(T=r(C,T);w<S.length;w++)A=v(T,C,w,S[w],V),A!==null&&(t&&A.alternate!==null&&T.delete(A.key===null?w:A.key),I=s(A,I,w),B===null?U=A:B.sibling=A,B=A);return t&&T.forEach(function(D){return e(C,D)}),ut&&Rs(C,w),U}function x(C,I,S,V){var U=ml(S);if(typeof U!="function")throw Error(te(150));if(S=U.call(S),S==null)throw Error(te(151));for(var B=U=null,T=I,w=I=0,A=null,k=S.next();T!==null&&!k.done;w++,k=S.next()){T.index>w?(A=T,T=null):A=T.sibling;var D=g(C,T,k.value,V);if(D===null){T===null&&(T=A);break}t&&T&&D.alternate===null&&e(C,T),I=s(D,I,w),B===null?U=D:B.sibling=D,B=D,T=A}if(k.done)return n(C,T),ut&&Rs(C,w),U;if(T===null){for(;!k.done;w++,k=S.next())k=p(C,k.value,V),k!==null&&(I=s(k,I,w),B===null?U=k:B.sibling=k,B=k);return ut&&Rs(C,w),U}for(T=r(C,T);!k.done;w++,k=S.next())k=v(T,C,w,k.value,V),k!==null&&(t&&k.alternate!==null&&T.delete(k.key===null?w:k.key),I=s(k,I,w),B===null?U=k:B.sibling=k,B=k);return t&&T.forEach(function(L){return e(C,L)}),ut&&Rs(C,w),U}function b(C,I,S,V){if(typeof S=="object"&&S!==null&&S.type===Wo&&S.key===null&&(S=S.props.children),typeof S=="object"&&S!==null){switch(S.$$typeof){case Ac:e:{for(var U=S.key,B=I;B!==null;){if(B.key===U){if(U=S.type,U===Wo){if(B.tag===7){n(C,B.sibling),I=i(B,S.props.children),I.return=C,C=I;break e}}else if(B.elementType===U||typeof U=="object"&&U!==null&&U.$$typeof===Ti&&nv(U)===B.type){n(C,B.sibling),I=i(B,S.props),I.ref=Tl(C,B,S),I.return=C,C=I;break e}n(C,B);break}else e(C,B);B=B.sibling}S.type===Wo?(I=zs(S.props.children,C.mode,V,S.key),I.return=C,C=I):(V=ad(S.type,S.key,S.props,null,C.mode,V),V.ref=Tl(C,I,S),V.return=C,C=V)}return o(C);case Ho:e:{for(B=S.key;I!==null;){if(I.key===B)if(I.tag===4&&I.stateNode.containerInfo===S.containerInfo&&I.stateNode.implementation===S.implementation){n(C,I.sibling),I=i(I,S.children||[]),I.return=C,C=I;break e}else{n(C,I);break}else e(C,I);I=I.sibling}I=ip(S,C.mode,V),I.return=C,C=I}return o(C);case Ti:return B=S._init,b(C,I,B(S._payload),V)}if(kl(S))return E(C,I,S,V);if(ml(S))return x(C,I,S,V);Fc(C,S)}return typeof S=="string"&&S!==""||typeof S=="number"?(S=""+S,I!==null&&I.tag===6?(n(C,I.sibling),I=i(I,S),I.return=C,C=I):(n(C,I),I=rp(S,C.mode,V),I.return=C,C=I),o(C)):n(C,I)}return b}var Ea=fS(!0),pS=fS(!1),Ud=ns(null),Od=null,ea=null,Pg=null;function kg(){Pg=ea=Od=null}function Ng(t){var e=Ud.current;st(Ud),t._currentValue=e}function Qp(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function ua(t,e){Od=t,Pg=ea=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(fn=!0),t.firstContext=null)}function qn(t){var e=t._currentValue;if(Pg!==t)if(t={context:t,memoizedValue:e,next:null},ea===null){if(Od===null)throw Error(te(308));ea=t,Od.dependencies={lanes:0,firstContext:t}}else ea=ea.next=t;return e}var Us=null;function Dg(t){Us===null?Us=[t]:Us.push(t)}function mS(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,Dg(e)):(n.next=i.next,i.next=n),e.interleaved=n,Qr(t,r)}function Qr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Ei=!1;function bg(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function gS(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Wr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Vi(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Be&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Qr(t,n)}return i=r.interleaved,i===null?(e.next=e,Dg(r)):(e.next=i.next,i.next=e),r.interleaved=e,Qr(t,n)}function td(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,yg(t,n)}}function rv(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Bd(t,e,n,r){var i=t.updateQueue;Ei=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?s=u:o.next=u,o=l;var f=t.alternate;f!==null&&(f=f.updateQueue,a=f.lastBaseUpdate,a!==o&&(a===null?f.firstBaseUpdate=u:a.next=u,f.lastBaseUpdate=l))}if(s!==null){var p=i.baseState;o=0,f=u=l=null,a=s;do{var g=a.lane,v=a.eventTime;if((r&g)===g){f!==null&&(f=f.next={eventTime:v,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var E=t,x=a;switch(g=e,v=n,x.tag){case 1:if(E=x.payload,typeof E=="function"){p=E.call(v,p,g);break e}p=E;break e;case 3:E.flags=E.flags&-65537|128;case 0:if(E=x.payload,g=typeof E=="function"?E.call(v,p,g):E,g==null)break e;p=mt({},p,g);break e;case 2:Ei=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,g=i.effects,g===null?i.effects=[a]:g.push(a))}else v={eventTime:v,lane:g,tag:a.tag,payload:a.payload,callback:a.callback,next:null},f===null?(u=f=v,l=p):f=f.next=v,o|=g;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;g=a,a=g.next,g.next=null,i.lastBaseUpdate=g,i.shared.pending=null}}while(!0);if(f===null&&(l=p),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=f,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Xs|=o,t.lanes=o,t.memoizedState=p}}function iv(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(te(191,i));i.call(r)}}}var Gu={},Ar=ns(Gu),yu=ns(Gu),vu=ns(Gu);function Os(t){if(t===Gu)throw Error(te(174));return t}function Mg(t,e){switch(et(vu,e),et(yu,t),et(Ar,Gu),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:kp(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=kp(e,t)}st(Ar),et(Ar,e)}function Ia(){st(Ar),st(yu),st(vu)}function _S(t){Os(vu.current);var e=Os(Ar.current),n=kp(e,t.type);e!==n&&(et(yu,t),et(Ar,n))}function Vg(t){yu.current===t&&(st(Ar),st(yu))}var ht=ns(0);function qd(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Yf=[];function Lg(){for(var t=0;t<Yf.length;t++)Yf[t]._workInProgressVersionPrimary=null;Yf.length=0}var nd=ni.ReactCurrentDispatcher,Xf=ni.ReactCurrentBatchConfig,Ys=0,pt=null,At=null,bt=null,Gd=!1,$l=!1,Tu=0,YP=0;function $t(){throw Error(te(321))}function Fg(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!ar(t[n],e[n]))return!1;return!0}function Ug(t,e,n,r,i,s){if(Ys=s,pt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,nd.current=t===null||t.memoizedState===null?tk:nk,t=n(r,i),$l){s=0;do{if($l=!1,Tu=0,25<=s)throw Error(te(301));s+=1,bt=At=null,e.updateQueue=null,nd.current=rk,t=n(r,i)}while($l)}if(nd.current=zd,e=At!==null&&At.next!==null,Ys=0,bt=At=pt=null,Gd=!1,e)throw Error(te(300));return t}function Og(){var t=Tu!==0;return Tu=0,t}function Tr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return bt===null?pt.memoizedState=bt=t:bt=bt.next=t,bt}function Gn(){if(At===null){var t=pt.alternate;t=t!==null?t.memoizedState:null}else t=At.next;var e=bt===null?pt.memoizedState:bt.next;if(e!==null)bt=e,At=t;else{if(t===null)throw Error(te(310));At=t,t={memoizedState:At.memoizedState,baseState:At.baseState,baseQueue:At.baseQueue,queue:At.queue,next:null},bt===null?pt.memoizedState=bt=t:bt=bt.next=t}return bt}function Eu(t,e){return typeof e=="function"?e(t):e}function Zf(t){var e=Gn(),n=e.queue;if(n===null)throw Error(te(311));n.lastRenderedReducer=t;var r=At,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,l=null,u=s;do{var f=u.lane;if((Ys&f)===f)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var p={lane:f,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=p,o=r):l=l.next=p,pt.lanes|=f,Xs|=f}u=u.next}while(u!==null&&u!==s);l===null?o=r:l.next=a,ar(r,e.memoizedState)||(fn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,pt.lanes|=s,Xs|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function ep(t){var e=Gn(),n=e.queue;if(n===null)throw Error(te(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);ar(s,e.memoizedState)||(fn=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function yS(){}function vS(t,e){var n=pt,r=Gn(),i=e(),s=!ar(r.memoizedState,i);if(s&&(r.memoizedState=i,fn=!0),r=r.queue,Bg(IS.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||bt!==null&&bt.memoizedState.tag&1){if(n.flags|=2048,Iu(9,ES.bind(null,n,r,i,e),void 0,null),Mt===null)throw Error(te(349));Ys&30||TS(n,e,i)}return i}function TS(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=pt.updateQueue,e===null?(e={lastEffect:null,stores:null},pt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function ES(t,e,n,r){e.value=n,e.getSnapshot=r,wS(e)&&SS(t)}function IS(t,e,n){return n(function(){wS(e)&&SS(t)})}function wS(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!ar(t,n)}catch{return!0}}function SS(t){var e=Qr(t,1);e!==null&&rr(e,t,1,-1)}function sv(t){var e=Tr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Eu,lastRenderedState:t},e.queue=t,t=t.dispatch=ek.bind(null,pt,t),[e.memoizedState,t]}function Iu(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=pt.updateQueue,e===null?(e={lastEffect:null,stores:null},pt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function CS(){return Gn().memoizedState}function rd(t,e,n,r){var i=Tr();pt.flags|=t,i.memoizedState=Iu(1|e,n,void 0,r===void 0?null:r)}function Nh(t,e,n,r){var i=Gn();r=r===void 0?null:r;var s=void 0;if(At!==null){var o=At.memoizedState;if(s=o.destroy,r!==null&&Fg(r,o.deps)){i.memoizedState=Iu(e,n,s,r);return}}pt.flags|=t,i.memoizedState=Iu(1|e,n,s,r)}function ov(t,e){return rd(8390656,8,t,e)}function Bg(t,e){return Nh(2048,8,t,e)}function AS(t,e){return Nh(4,2,t,e)}function xS(t,e){return Nh(4,4,t,e)}function RS(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function PS(t,e,n){return n=n!=null?n.concat([t]):null,Nh(4,4,RS.bind(null,e,t),n)}function qg(){}function kS(t,e){var n=Gn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Fg(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function NS(t,e){var n=Gn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Fg(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function DS(t,e,n){return Ys&21?(ar(n,e)||(n=Fw(),pt.lanes|=n,Xs|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,fn=!0),t.memoizedState=n)}function XP(t,e){var n=We;We=n!==0&&4>n?n:4,t(!0);var r=Xf.transition;Xf.transition={};try{t(!1),e()}finally{We=n,Xf.transition=r}}function bS(){return Gn().memoizedState}function ZP(t,e,n){var r=Fi(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},MS(t))VS(e,n);else if(n=mS(t,e,n,r),n!==null){var i=sn();rr(n,t,r,i),LS(n,e,r)}}function ek(t,e,n){var r=Fi(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(MS(t))VS(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,ar(a,o)){var l=e.interleaved;l===null?(i.next=i,Dg(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=mS(t,e,i,r),n!==null&&(i=sn(),rr(n,t,r,i),LS(n,e,r))}}function MS(t){var e=t.alternate;return t===pt||e!==null&&e===pt}function VS(t,e){$l=Gd=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function LS(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,yg(t,n)}}var zd={readContext:qn,useCallback:$t,useContext:$t,useEffect:$t,useImperativeHandle:$t,useInsertionEffect:$t,useLayoutEffect:$t,useMemo:$t,useReducer:$t,useRef:$t,useState:$t,useDebugValue:$t,useDeferredValue:$t,useTransition:$t,useMutableSource:$t,useSyncExternalStore:$t,useId:$t,unstable_isNewReconciler:!1},tk={readContext:qn,useCallback:function(t,e){return Tr().memoizedState=[t,e===void 0?null:e],t},useContext:qn,useEffect:ov,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,rd(4194308,4,RS.bind(null,e,t),n)},useLayoutEffect:function(t,e){return rd(4194308,4,t,e)},useInsertionEffect:function(t,e){return rd(4,2,t,e)},useMemo:function(t,e){var n=Tr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Tr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=ZP.bind(null,pt,t),[r.memoizedState,t]},useRef:function(t){var e=Tr();return t={current:t},e.memoizedState=t},useState:sv,useDebugValue:qg,useDeferredValue:function(t){return Tr().memoizedState=t},useTransition:function(){var t=sv(!1),e=t[0];return t=XP.bind(null,t[1]),Tr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=pt,i=Tr();if(ut){if(n===void 0)throw Error(te(407));n=n()}else{if(n=e(),Mt===null)throw Error(te(349));Ys&30||TS(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,ov(IS.bind(null,r,s,t),[t]),r.flags|=2048,Iu(9,ES.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=Tr(),e=Mt.identifierPrefix;if(ut){var n=Gr,r=qr;n=(r&~(1<<32-nr(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Tu++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=YP++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},nk={readContext:qn,useCallback:kS,useContext:qn,useEffect:Bg,useImperativeHandle:PS,useInsertionEffect:AS,useLayoutEffect:xS,useMemo:NS,useReducer:Zf,useRef:CS,useState:function(){return Zf(Eu)},useDebugValue:qg,useDeferredValue:function(t){var e=Gn();return DS(e,At.memoizedState,t)},useTransition:function(){var t=Zf(Eu)[0],e=Gn().memoizedState;return[t,e]},useMutableSource:yS,useSyncExternalStore:vS,useId:bS,unstable_isNewReconciler:!1},rk={readContext:qn,useCallback:kS,useContext:qn,useEffect:Bg,useImperativeHandle:PS,useInsertionEffect:AS,useLayoutEffect:xS,useMemo:NS,useReducer:ep,useRef:CS,useState:function(){return ep(Eu)},useDebugValue:qg,useDeferredValue:function(t){var e=Gn();return At===null?e.memoizedState=t:DS(e,At.memoizedState,t)},useTransition:function(){var t=ep(Eu)[0],e=Gn().memoizedState;return[t,e]},useMutableSource:yS,useSyncExternalStore:vS,useId:bS,unstable_isNewReconciler:!1};function Qn(t,e){if(t&&t.defaultProps){e=mt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Yp(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:mt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Dh={isMounted:function(t){return(t=t._reactInternals)?co(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=sn(),i=Fi(t),s=Wr(r,i);s.payload=e,n!=null&&(s.callback=n),e=Vi(t,s,i),e!==null&&(rr(e,t,i,r),td(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=sn(),i=Fi(t),s=Wr(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=Vi(t,s,i),e!==null&&(rr(e,t,i,r),td(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=sn(),r=Fi(t),i=Wr(n,r);i.tag=2,e!=null&&(i.callback=e),e=Vi(t,i,r),e!==null&&(rr(e,t,r,n),td(e,t,r))}};function av(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!pu(n,r)||!pu(i,s):!0}function FS(t,e,n){var r=!1,i=Ki,s=e.contextType;return typeof s=="object"&&s!==null?s=qn(s):(i=gn(e)?Js:Xt.current,r=e.contextTypes,s=(r=r!=null)?va(t,i):Ki),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Dh,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function lv(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Dh.enqueueReplaceState(e,e.state,null)}function Xp(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},bg(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=qn(s):(s=gn(e)?Js:Xt.current,i.context=va(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Yp(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Dh.enqueueReplaceState(i,i.state,null),Bd(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function wa(t,e){try{var n="",r=e;do n+=NR(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function tp(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Zp(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var ik=typeof WeakMap=="function"?WeakMap:Map;function US(t,e,n){n=Wr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Hd||(Hd=!0,um=r),Zp(t,e)},n}function OS(t,e,n){n=Wr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){Zp(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){Zp(t,e),typeof r!="function"&&(Li===null?Li=new Set([this]):Li.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function uv(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new ik;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=yk.bind(null,t,e,n),e.then(t,t))}function cv(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function dv(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Wr(-1,1),e.tag=2,Vi(n,e,1))),n.lanes|=1),t)}var sk=ni.ReactCurrentOwner,fn=!1;function tn(t,e,n,r){e.child=t===null?pS(e,null,n,r):Ea(e,t.child,n,r)}function hv(t,e,n,r,i){n=n.render;var s=e.ref;return ua(e,i),r=Ug(t,e,n,r,s,i),n=Og(),t!==null&&!fn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Yr(t,e,i)):(ut&&n&&Ag(e),e.flags|=1,tn(t,e,r,i),e.child)}function fv(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!Jg(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,BS(t,e,s,r,i)):(t=ad(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:pu,n(o,r)&&t.ref===e.ref)return Yr(t,e,i)}return e.flags|=1,t=Ui(s,r),t.ref=e.ref,t.return=e,e.child=t}function BS(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(pu(s,r)&&t.ref===e.ref)if(fn=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(fn=!0);else return e.lanes=t.lanes,Yr(t,e,i)}return em(t,e,n,r,i)}function qS(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},et(na,Tn),Tn|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,et(na,Tn),Tn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,et(na,Tn),Tn|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,et(na,Tn),Tn|=r;return tn(t,e,i,n),e.child}function GS(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function em(t,e,n,r,i){var s=gn(n)?Js:Xt.current;return s=va(e,s),ua(e,i),n=Ug(t,e,n,r,s,i),r=Og(),t!==null&&!fn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Yr(t,e,i)):(ut&&r&&Ag(e),e.flags|=1,tn(t,e,n,i),e.child)}function pv(t,e,n,r,i){if(gn(n)){var s=!0;Vd(e)}else s=!1;if(ua(e,i),e.stateNode===null)id(t,e),FS(e,n,r),Xp(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=qn(u):(u=gn(n)?Js:Xt.current,u=va(e,u));var f=n.getDerivedStateFromProps,p=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function";p||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==u)&&lv(e,o,r,u),Ei=!1;var g=e.memoizedState;o.state=g,Bd(e,r,o,i),l=e.memoizedState,a!==r||g!==l||mn.current||Ei?(typeof f=="function"&&(Yp(e,n,f,r),l=e.memoizedState),(a=Ei||av(e,n,a,r,g,l,u))?(p||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=u,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,gS(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:Qn(e.type,a),o.props=u,p=e.pendingProps,g=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=qn(l):(l=gn(n)?Js:Xt.current,l=va(e,l));var v=n.getDerivedStateFromProps;(f=typeof v=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==p||g!==l)&&lv(e,o,r,l),Ei=!1,g=e.memoizedState,o.state=g,Bd(e,r,o,i);var E=e.memoizedState;a!==p||g!==E||mn.current||Ei?(typeof v=="function"&&(Yp(e,n,v,r),E=e.memoizedState),(u=Ei||av(e,n,u,r,g,E,l)||!1)?(f||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,E,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,E,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=E),o.props=r,o.state=E,o.context=l,r=u):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),r=!1)}return tm(t,e,n,r,s,i)}function tm(t,e,n,r,i,s){GS(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&Zy(e,n,!1),Yr(t,e,s);r=e.stateNode,sk.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Ea(e,t.child,null,s),e.child=Ea(e,null,a,s)):tn(t,e,a,s),e.memoizedState=r.state,i&&Zy(e,n,!0),e.child}function zS(t){var e=t.stateNode;e.pendingContext?Xy(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Xy(t,e.context,!1),Mg(t,e.containerInfo)}function mv(t,e,n,r,i){return Ta(),Rg(i),e.flags|=256,tn(t,e,n,r),e.child}var nm={dehydrated:null,treeContext:null,retryLane:0};function rm(t){return{baseLanes:t,cachePool:null,transitions:null}}function $S(t,e,n){var r=e.pendingProps,i=ht.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),et(ht,i&1),t===null)return Jp(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=Vh(o,r,0,null),t=zs(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=rm(n),e.memoizedState=nm,t):Gg(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return ok(t,e,o,r,a,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Ui(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=Ui(a,s):(s=zs(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?rm(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=nm,r}return s=t.child,t=s.sibling,r=Ui(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Gg(t,e){return e=Vh({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Uc(t,e,n,r){return r!==null&&Rg(r),Ea(e,t.child,null,n),t=Gg(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function ok(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=tp(Error(te(422))),Uc(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=Vh({mode:"visible",children:r.children},i,0,null),s=zs(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&Ea(e,t.child,null,o),e.child.memoizedState=rm(o),e.memoizedState=nm,s);if(!(e.mode&1))return Uc(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(te(419)),r=tp(s,r,void 0),Uc(t,e,o,r)}if(a=(o&t.childLanes)!==0,fn||a){if(r=Mt,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Qr(t,i),rr(r,t,i,-1))}return jg(),r=tp(Error(te(421))),Uc(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=vk.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,wn=Mi(i.nextSibling),Cn=e,ut=!0,Zn=null,t!==null&&(bn[Mn++]=qr,bn[Mn++]=Gr,bn[Mn++]=Qs,qr=t.id,Gr=t.overflow,Qs=e),e=Gg(e,r.children),e.flags|=4096,e)}function gv(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Qp(t.return,e,n)}function np(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function HS(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(tn(t,e,r.children,n),r=ht.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&gv(t,n,e);else if(t.tag===19)gv(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(et(ht,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&qd(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),np(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&qd(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}np(e,!0,n,null,s);break;case"together":np(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function id(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Yr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Xs|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(te(153));if(e.child!==null){for(t=e.child,n=Ui(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Ui(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function ak(t,e,n){switch(e.tag){case 3:zS(e),Ta();break;case 5:_S(e);break;case 1:gn(e.type)&&Vd(e);break;case 4:Mg(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;et(Ud,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(et(ht,ht.current&1),e.flags|=128,null):n&e.child.childLanes?$S(t,e,n):(et(ht,ht.current&1),t=Yr(t,e,n),t!==null?t.sibling:null);et(ht,ht.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return HS(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),et(ht,ht.current),r)break;return null;case 22:case 23:return e.lanes=0,qS(t,e,n)}return Yr(t,e,n)}var WS,im,KS,jS;WS=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};im=function(){};KS=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Os(Ar.current);var s=null;switch(n){case"input":i=Ap(t,i),r=Ap(t,r),s=[];break;case"select":i=mt({},i,{value:void 0}),r=mt({},r,{value:void 0}),s=[];break;case"textarea":i=Pp(t,i),r=Pp(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=bd)}Np(n,r);var o;n=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var a=i[u];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(au.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var l=r[u];if(a=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(au.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&rt("scroll",t),s||a===l||(s=[])):(s=s||[]).push(u,l))}n&&(s=s||[]).push("style",n);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};jS=function(t,e,n,r){n!==r&&(e.flags|=4)};function El(t,e){if(!ut)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Ht(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function lk(t,e,n){var r=e.pendingProps;switch(xg(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ht(e),null;case 1:return gn(e.type)&&Md(),Ht(e),null;case 3:return r=e.stateNode,Ia(),st(mn),st(Xt),Lg(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Lc(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Zn!==null&&(hm(Zn),Zn=null))),im(t,e),Ht(e),null;case 5:Vg(e);var i=Os(vu.current);if(n=e.type,t!==null&&e.stateNode!=null)KS(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(te(166));return Ht(e),null}if(t=Os(Ar.current),Lc(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[Ir]=e,r[_u]=s,t=(e.mode&1)!==0,n){case"dialog":rt("cancel",r),rt("close",r);break;case"iframe":case"object":case"embed":rt("load",r);break;case"video":case"audio":for(i=0;i<Dl.length;i++)rt(Dl[i],r);break;case"source":rt("error",r);break;case"img":case"image":case"link":rt("error",r),rt("load",r);break;case"details":rt("toggle",r);break;case"input":Cy(r,s),rt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},rt("invalid",r);break;case"textarea":xy(r,s),rt("invalid",r)}Np(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&Vc(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Vc(r.textContent,a,t),i=["children",""+a]):au.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&rt("scroll",r)}switch(n){case"input":xc(r),Ay(r,s,!0);break;case"textarea":xc(r),Ry(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=bd)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Iw(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Ir]=e,t[_u]=r,WS(t,e,!1,!1),e.stateNode=t;e:{switch(o=Dp(n,r),n){case"dialog":rt("cancel",t),rt("close",t),i=r;break;case"iframe":case"object":case"embed":rt("load",t),i=r;break;case"video":case"audio":for(i=0;i<Dl.length;i++)rt(Dl[i],t);i=r;break;case"source":rt("error",t),i=r;break;case"img":case"image":case"link":rt("error",t),rt("load",t),i=r;break;case"details":rt("toggle",t),i=r;break;case"input":Cy(t,r),i=Ap(t,r),rt("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=mt({},r,{value:void 0}),rt("invalid",t);break;case"textarea":xy(t,r),i=Pp(t,r),rt("invalid",t);break;default:i=r}Np(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?Cw(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&ww(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&lu(t,l):typeof l=="number"&&lu(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(au.hasOwnProperty(s)?l!=null&&s==="onScroll"&&rt("scroll",t):l!=null&&hg(t,s,l,o))}switch(n){case"input":xc(t),Ay(t,r,!1);break;case"textarea":xc(t),Ry(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Wi(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?sa(t,!!r.multiple,s,!1):r.defaultValue!=null&&sa(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=bd)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Ht(e),null;case 6:if(t&&e.stateNode!=null)jS(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(te(166));if(n=Os(vu.current),Os(Ar.current),Lc(e)){if(r=e.stateNode,n=e.memoizedProps,r[Ir]=e,(s=r.nodeValue!==n)&&(t=Cn,t!==null))switch(t.tag){case 3:Vc(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Vc(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Ir]=e,e.stateNode=r}return Ht(e),null;case 13:if(st(ht),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ut&&wn!==null&&e.mode&1&&!(e.flags&128))hS(),Ta(),e.flags|=98560,s=!1;else if(s=Lc(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(te(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(te(317));s[Ir]=e}else Ta(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ht(e),s=!1}else Zn!==null&&(hm(Zn),Zn=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||ht.current&1?xt===0&&(xt=3):jg())),e.updateQueue!==null&&(e.flags|=4),Ht(e),null);case 4:return Ia(),im(t,e),t===null&&mu(e.stateNode.containerInfo),Ht(e),null;case 10:return Ng(e.type._context),Ht(e),null;case 17:return gn(e.type)&&Md(),Ht(e),null;case 19:if(st(ht),s=e.memoizedState,s===null)return Ht(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)El(s,!1);else{if(xt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=qd(t),o!==null){for(e.flags|=128,El(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return et(ht,ht.current&1|2),e.child}t=t.sibling}s.tail!==null&&Tt()>Sa&&(e.flags|=128,r=!0,El(s,!1),e.lanes=4194304)}else{if(!r)if(t=qd(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),El(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!ut)return Ht(e),null}else 2*Tt()-s.renderingStartTime>Sa&&n!==1073741824&&(e.flags|=128,r=!0,El(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Tt(),e.sibling=null,n=ht.current,et(ht,r?n&1|2:n&1),e):(Ht(e),null);case 22:case 23:return Kg(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Tn&1073741824&&(Ht(e),e.subtreeFlags&6&&(e.flags|=8192)):Ht(e),null;case 24:return null;case 25:return null}throw Error(te(156,e.tag))}function uk(t,e){switch(xg(e),e.tag){case 1:return gn(e.type)&&Md(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Ia(),st(mn),st(Xt),Lg(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Vg(e),null;case 13:if(st(ht),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(te(340));Ta()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return st(ht),null;case 4:return Ia(),null;case 10:return Ng(e.type._context),null;case 22:case 23:return Kg(),null;case 24:return null;default:return null}}var Oc=!1,jt=!1,ck=typeof WeakSet=="function"?WeakSet:Set,le=null;function ta(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){yt(t,e,r)}else n.current=null}function sm(t,e,n){try{n()}catch(r){yt(t,e,r)}}var _v=!1;function dk(t,e){if(Gp=kd,t=Zw(),Cg(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,u=0,f=0,p=t,g=null;t:for(;;){for(var v;p!==n||i!==0&&p.nodeType!==3||(a=o+i),p!==s||r!==0&&p.nodeType!==3||(l=o+r),p.nodeType===3&&(o+=p.nodeValue.length),(v=p.firstChild)!==null;)g=p,p=v;for(;;){if(p===t)break t;if(g===n&&++u===i&&(a=o),g===s&&++f===r&&(l=o),(v=p.nextSibling)!==null)break;p=g,g=p.parentNode}p=v}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(zp={focusedElem:t,selectionRange:n},kd=!1,le=e;le!==null;)if(e=le,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,le=t;else for(;le!==null;){e=le;try{var E=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(E!==null){var x=E.memoizedProps,b=E.memoizedState,C=e.stateNode,I=C.getSnapshotBeforeUpdate(e.elementType===e.type?x:Qn(e.type,x),b);C.__reactInternalSnapshotBeforeUpdate=I}break;case 3:var S=e.stateNode.containerInfo;S.nodeType===1?S.textContent="":S.nodeType===9&&S.documentElement&&S.removeChild(S.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(te(163))}}catch(V){yt(e,e.return,V)}if(t=e.sibling,t!==null){t.return=e.return,le=t;break}le=e.return}return E=_v,_v=!1,E}function Hl(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&sm(e,n,s)}i=i.next}while(i!==r)}}function bh(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function om(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function JS(t){var e=t.alternate;e!==null&&(t.alternate=null,JS(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Ir],delete e[_u],delete e[Wp],delete e[KP],delete e[jP])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function QS(t){return t.tag===5||t.tag===3||t.tag===4}function yv(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||QS(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function am(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=bd));else if(r!==4&&(t=t.child,t!==null))for(am(t,e,n),t=t.sibling;t!==null;)am(t,e,n),t=t.sibling}function lm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(lm(t,e,n),t=t.sibling;t!==null;)lm(t,e,n),t=t.sibling}var Ft=null,Yn=!1;function fi(t,e,n){for(n=n.child;n!==null;)YS(t,e,n),n=n.sibling}function YS(t,e,n){if(Cr&&typeof Cr.onCommitFiberUnmount=="function")try{Cr.onCommitFiberUnmount(Ch,n)}catch{}switch(n.tag){case 5:jt||ta(n,e);case 6:var r=Ft,i=Yn;Ft=null,fi(t,e,n),Ft=r,Yn=i,Ft!==null&&(Yn?(t=Ft,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Ft.removeChild(n.stateNode));break;case 18:Ft!==null&&(Yn?(t=Ft,n=n.stateNode,t.nodeType===8?Jf(t.parentNode,n):t.nodeType===1&&Jf(t,n),hu(t)):Jf(Ft,n.stateNode));break;case 4:r=Ft,i=Yn,Ft=n.stateNode.containerInfo,Yn=!0,fi(t,e,n),Ft=r,Yn=i;break;case 0:case 11:case 14:case 15:if(!jt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&sm(n,e,o),i=i.next}while(i!==r)}fi(t,e,n);break;case 1:if(!jt&&(ta(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){yt(n,e,a)}fi(t,e,n);break;case 21:fi(t,e,n);break;case 22:n.mode&1?(jt=(r=jt)||n.memoizedState!==null,fi(t,e,n),jt=r):fi(t,e,n);break;default:fi(t,e,n)}}function vv(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new ck),e.forEach(function(r){var i=Tk.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Jn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Ft=a.stateNode,Yn=!1;break e;case 3:Ft=a.stateNode.containerInfo,Yn=!0;break e;case 4:Ft=a.stateNode.containerInfo,Yn=!0;break e}a=a.return}if(Ft===null)throw Error(te(160));YS(s,o,i),Ft=null,Yn=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){yt(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)XS(e,t),e=e.sibling}function XS(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Jn(e,t),vr(t),r&4){try{Hl(3,t,t.return),bh(3,t)}catch(x){yt(t,t.return,x)}try{Hl(5,t,t.return)}catch(x){yt(t,t.return,x)}}break;case 1:Jn(e,t),vr(t),r&512&&n!==null&&ta(n,n.return);break;case 5:if(Jn(e,t),vr(t),r&512&&n!==null&&ta(n,n.return),t.flags&32){var i=t.stateNode;try{lu(i,"")}catch(x){yt(t,t.return,x)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&Tw(i,s),Dp(a,o);var u=Dp(a,s);for(o=0;o<l.length;o+=2){var f=l[o],p=l[o+1];f==="style"?Cw(i,p):f==="dangerouslySetInnerHTML"?ww(i,p):f==="children"?lu(i,p):hg(i,f,p,u)}switch(a){case"input":xp(i,s);break;case"textarea":Ew(i,s);break;case"select":var g=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var v=s.value;v!=null?sa(i,!!s.multiple,v,!1):g!==!!s.multiple&&(s.defaultValue!=null?sa(i,!!s.multiple,s.defaultValue,!0):sa(i,!!s.multiple,s.multiple?[]:"",!1))}i[_u]=s}catch(x){yt(t,t.return,x)}}break;case 6:if(Jn(e,t),vr(t),r&4){if(t.stateNode===null)throw Error(te(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(x){yt(t,t.return,x)}}break;case 3:if(Jn(e,t),vr(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{hu(e.containerInfo)}catch(x){yt(t,t.return,x)}break;case 4:Jn(e,t),vr(t);break;case 13:Jn(e,t),vr(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Hg=Tt())),r&4&&vv(t);break;case 22:if(f=n!==null&&n.memoizedState!==null,t.mode&1?(jt=(u=jt)||f,Jn(e,t),jt=u):Jn(e,t),vr(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!f&&t.mode&1)for(le=t,f=t.child;f!==null;){for(p=le=f;le!==null;){switch(g=le,v=g.child,g.tag){case 0:case 11:case 14:case 15:Hl(4,g,g.return);break;case 1:ta(g,g.return);var E=g.stateNode;if(typeof E.componentWillUnmount=="function"){r=g,n=g.return;try{e=r,E.props=e.memoizedProps,E.state=e.memoizedState,E.componentWillUnmount()}catch(x){yt(r,n,x)}}break;case 5:ta(g,g.return);break;case 22:if(g.memoizedState!==null){Ev(p);continue}}v!==null?(v.return=g,le=v):Ev(p)}f=f.sibling}e:for(f=null,p=t;;){if(p.tag===5){if(f===null){f=p;try{i=p.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=p.stateNode,l=p.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=Sw("display",o))}catch(x){yt(t,t.return,x)}}}else if(p.tag===6){if(f===null)try{p.stateNode.nodeValue=u?"":p.memoizedProps}catch(x){yt(t,t.return,x)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===t)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===t)break e;for(;p.sibling===null;){if(p.return===null||p.return===t)break e;f===p&&(f=null),p=p.return}f===p&&(f=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:Jn(e,t),vr(t),r&4&&vv(t);break;case 21:break;default:Jn(e,t),vr(t)}}function vr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(QS(n)){var r=n;break e}n=n.return}throw Error(te(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(lu(i,""),r.flags&=-33);var s=yv(t);lm(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=yv(t);am(t,a,o);break;default:throw Error(te(161))}}catch(l){yt(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function hk(t,e,n){le=t,ZS(t)}function ZS(t,e,n){for(var r=(t.mode&1)!==0;le!==null;){var i=le,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||Oc;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||jt;a=Oc;var u=jt;if(Oc=o,(jt=l)&&!u)for(le=i;le!==null;)o=le,l=o.child,o.tag===22&&o.memoizedState!==null?Iv(i):l!==null?(l.return=o,le=l):Iv(i);for(;s!==null;)le=s,ZS(s),s=s.sibling;le=i,Oc=a,jt=u}Tv(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,le=s):Tv(t)}}function Tv(t){for(;le!==null;){var e=le;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:jt||bh(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!jt)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Qn(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&iv(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}iv(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var f=u.memoizedState;if(f!==null){var p=f.dehydrated;p!==null&&hu(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(te(163))}jt||e.flags&512&&om(e)}catch(g){yt(e,e.return,g)}}if(e===t){le=null;break}if(n=e.sibling,n!==null){n.return=e.return,le=n;break}le=e.return}}function Ev(t){for(;le!==null;){var e=le;if(e===t){le=null;break}var n=e.sibling;if(n!==null){n.return=e.return,le=n;break}le=e.return}}function Iv(t){for(;le!==null;){var e=le;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{bh(4,e)}catch(l){yt(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){yt(e,i,l)}}var s=e.return;try{om(e)}catch(l){yt(e,s,l)}break;case 5:var o=e.return;try{om(e)}catch(l){yt(e,o,l)}}}catch(l){yt(e,e.return,l)}if(e===t){le=null;break}var a=e.sibling;if(a!==null){a.return=e.return,le=a;break}le=e.return}}var fk=Math.ceil,$d=ni.ReactCurrentDispatcher,zg=ni.ReactCurrentOwner,Un=ni.ReactCurrentBatchConfig,Be=0,Mt=null,wt=null,Bt=0,Tn=0,na=ns(0),xt=0,wu=null,Xs=0,Mh=0,$g=0,Wl=null,hn=null,Hg=0,Sa=1/0,Ur=null,Hd=!1,um=null,Li=null,Bc=!1,Pi=null,Wd=0,Kl=0,cm=null,sd=-1,od=0;function sn(){return Be&6?Tt():sd!==-1?sd:sd=Tt()}function Fi(t){return t.mode&1?Be&2&&Bt!==0?Bt&-Bt:QP.transition!==null?(od===0&&(od=Fw()),od):(t=We,t!==0||(t=window.event,t=t===void 0?16:$w(t.type)),t):1}function rr(t,e,n,r){if(50<Kl)throw Kl=0,cm=null,Error(te(185));Ou(t,n,r),(!(Be&2)||t!==Mt)&&(t===Mt&&(!(Be&2)&&(Mh|=n),xt===4&&wi(t,Bt)),_n(t,r),n===1&&Be===0&&!(e.mode&1)&&(Sa=Tt()+500,kh&&rs()))}function _n(t,e){var n=t.callbackNode;QR(t,e);var r=Pd(t,t===Mt?Bt:0);if(r===0)n!==null&&Ny(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Ny(n),e===1)t.tag===0?JP(wv.bind(null,t)):uS(wv.bind(null,t)),HP(function(){!(Be&6)&&rs()}),n=null;else{switch(Uw(r)){case 1:n=_g;break;case 4:n=Vw;break;case 16:n=Rd;break;case 536870912:n=Lw;break;default:n=Rd}n=aC(n,eC.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function eC(t,e){if(sd=-1,od=0,Be&6)throw Error(te(327));var n=t.callbackNode;if(ca()&&t.callbackNode!==n)return null;var r=Pd(t,t===Mt?Bt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Kd(t,r);else{e=r;var i=Be;Be|=2;var s=nC();(Mt!==t||Bt!==e)&&(Ur=null,Sa=Tt()+500,Gs(t,e));do try{gk();break}catch(a){tC(t,a)}while(!0);kg(),$d.current=s,Be=i,wt!==null?e=0:(Mt=null,Bt=0,e=xt)}if(e!==0){if(e===2&&(i=Fp(t),i!==0&&(r=i,e=dm(t,i))),e===1)throw n=wu,Gs(t,0),wi(t,r),_n(t,Tt()),n;if(e===6)wi(t,r);else{if(i=t.current.alternate,!(r&30)&&!pk(i)&&(e=Kd(t,r),e===2&&(s=Fp(t),s!==0&&(r=s,e=dm(t,s))),e===1))throw n=wu,Gs(t,0),wi(t,r),_n(t,Tt()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(te(345));case 2:Ps(t,hn,Ur);break;case 3:if(wi(t,r),(r&130023424)===r&&(e=Hg+500-Tt(),10<e)){if(Pd(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){sn(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Hp(Ps.bind(null,t,hn,Ur),e);break}Ps(t,hn,Ur);break;case 4:if(wi(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-nr(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=Tt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*fk(r/1960))-r,10<r){t.timeoutHandle=Hp(Ps.bind(null,t,hn,Ur),r);break}Ps(t,hn,Ur);break;case 5:Ps(t,hn,Ur);break;default:throw Error(te(329))}}}return _n(t,Tt()),t.callbackNode===n?eC.bind(null,t):null}function dm(t,e){var n=Wl;return t.current.memoizedState.isDehydrated&&(Gs(t,e).flags|=256),t=Kd(t,e),t!==2&&(e=hn,hn=n,e!==null&&hm(e)),t}function hm(t){hn===null?hn=t:hn.push.apply(hn,t)}function pk(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!ar(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function wi(t,e){for(e&=~$g,e&=~Mh,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-nr(e),r=1<<n;t[n]=-1,e&=~r}}function wv(t){if(Be&6)throw Error(te(327));ca();var e=Pd(t,0);if(!(e&1))return _n(t,Tt()),null;var n=Kd(t,e);if(t.tag!==0&&n===2){var r=Fp(t);r!==0&&(e=r,n=dm(t,r))}if(n===1)throw n=wu,Gs(t,0),wi(t,e),_n(t,Tt()),n;if(n===6)throw Error(te(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ps(t,hn,Ur),_n(t,Tt()),null}function Wg(t,e){var n=Be;Be|=1;try{return t(e)}finally{Be=n,Be===0&&(Sa=Tt()+500,kh&&rs())}}function Zs(t){Pi!==null&&Pi.tag===0&&!(Be&6)&&ca();var e=Be;Be|=1;var n=Un.transition,r=We;try{if(Un.transition=null,We=1,t)return t()}finally{We=r,Un.transition=n,Be=e,!(Be&6)&&rs()}}function Kg(){Tn=na.current,st(na)}function Gs(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,$P(n)),wt!==null)for(n=wt.return;n!==null;){var r=n;switch(xg(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Md();break;case 3:Ia(),st(mn),st(Xt),Lg();break;case 5:Vg(r);break;case 4:Ia();break;case 13:st(ht);break;case 19:st(ht);break;case 10:Ng(r.type._context);break;case 22:case 23:Kg()}n=n.return}if(Mt=t,wt=t=Ui(t.current,null),Bt=Tn=e,xt=0,wu=null,$g=Mh=Xs=0,hn=Wl=null,Us!==null){for(e=0;e<Us.length;e++)if(n=Us[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}Us=null}return t}function tC(t,e){do{var n=wt;try{if(kg(),nd.current=zd,Gd){for(var r=pt.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Gd=!1}if(Ys=0,bt=At=pt=null,$l=!1,Tu=0,zg.current=null,n===null||n.return===null){xt=1,wu=e,wt=null;break}e:{var s=t,o=n.return,a=n,l=e;if(e=Bt,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,f=a,p=f.tag;if(!(f.mode&1)&&(p===0||p===11||p===15)){var g=f.alternate;g?(f.updateQueue=g.updateQueue,f.memoizedState=g.memoizedState,f.lanes=g.lanes):(f.updateQueue=null,f.memoizedState=null)}var v=cv(o);if(v!==null){v.flags&=-257,dv(v,o,a,s,e),v.mode&1&&uv(s,u,e),e=v,l=u;var E=e.updateQueue;if(E===null){var x=new Set;x.add(l),e.updateQueue=x}else E.add(l);break e}else{if(!(e&1)){uv(s,u,e),jg();break e}l=Error(te(426))}}else if(ut&&a.mode&1){var b=cv(o);if(b!==null){!(b.flags&65536)&&(b.flags|=256),dv(b,o,a,s,e),Rg(wa(l,a));break e}}s=l=wa(l,a),xt!==4&&(xt=2),Wl===null?Wl=[s]:Wl.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var C=US(s,l,e);rv(s,C);break e;case 1:a=l;var I=s.type,S=s.stateNode;if(!(s.flags&128)&&(typeof I.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(Li===null||!Li.has(S)))){s.flags|=65536,e&=-e,s.lanes|=e;var V=OS(s,a,e);rv(s,V);break e}}s=s.return}while(s!==null)}iC(n)}catch(U){e=U,wt===n&&n!==null&&(wt=n=n.return);continue}break}while(!0)}function nC(){var t=$d.current;return $d.current=zd,t===null?zd:t}function jg(){(xt===0||xt===3||xt===2)&&(xt=4),Mt===null||!(Xs&268435455)&&!(Mh&268435455)||wi(Mt,Bt)}function Kd(t,e){var n=Be;Be|=2;var r=nC();(Mt!==t||Bt!==e)&&(Ur=null,Gs(t,e));do try{mk();break}catch(i){tC(t,i)}while(!0);if(kg(),Be=n,$d.current=r,wt!==null)throw Error(te(261));return Mt=null,Bt=0,xt}function mk(){for(;wt!==null;)rC(wt)}function gk(){for(;wt!==null&&!qR();)rC(wt)}function rC(t){var e=oC(t.alternate,t,Tn);t.memoizedProps=t.pendingProps,e===null?iC(t):wt=e,zg.current=null}function iC(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=uk(n,e),n!==null){n.flags&=32767,wt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{xt=6,wt=null;return}}else if(n=lk(n,e,Tn),n!==null){wt=n;return}if(e=e.sibling,e!==null){wt=e;return}wt=e=t}while(e!==null);xt===0&&(xt=5)}function Ps(t,e,n){var r=We,i=Un.transition;try{Un.transition=null,We=1,_k(t,e,n,r)}finally{Un.transition=i,We=r}return null}function _k(t,e,n,r){do ca();while(Pi!==null);if(Be&6)throw Error(te(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(te(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(YR(t,s),t===Mt&&(wt=Mt=null,Bt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Bc||(Bc=!0,aC(Rd,function(){return ca(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=Un.transition,Un.transition=null;var o=We;We=1;var a=Be;Be|=4,zg.current=null,dk(t,n),XS(n,t),FP(zp),kd=!!Gp,zp=Gp=null,t.current=n,hk(n),GR(),Be=a,We=o,Un.transition=s}else t.current=n;if(Bc&&(Bc=!1,Pi=t,Wd=i),s=t.pendingLanes,s===0&&(Li=null),HR(n.stateNode),_n(t,Tt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Hd)throw Hd=!1,t=um,um=null,t;return Wd&1&&t.tag!==0&&ca(),s=t.pendingLanes,s&1?t===cm?Kl++:(Kl=0,cm=t):Kl=0,rs(),null}function ca(){if(Pi!==null){var t=Uw(Wd),e=Un.transition,n=We;try{if(Un.transition=null,We=16>t?16:t,Pi===null)var r=!1;else{if(t=Pi,Pi=null,Wd=0,Be&6)throw Error(te(331));var i=Be;for(Be|=4,le=t.current;le!==null;){var s=le,o=s.child;if(le.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(le=u;le!==null;){var f=le;switch(f.tag){case 0:case 11:case 15:Hl(8,f,s)}var p=f.child;if(p!==null)p.return=f,le=p;else for(;le!==null;){f=le;var g=f.sibling,v=f.return;if(JS(f),f===u){le=null;break}if(g!==null){g.return=v,le=g;break}le=v}}}var E=s.alternate;if(E!==null){var x=E.child;if(x!==null){E.child=null;do{var b=x.sibling;x.sibling=null,x=b}while(x!==null)}}le=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,le=o;else e:for(;le!==null;){if(s=le,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Hl(9,s,s.return)}var C=s.sibling;if(C!==null){C.return=s.return,le=C;break e}le=s.return}}var I=t.current;for(le=I;le!==null;){o=le;var S=o.child;if(o.subtreeFlags&2064&&S!==null)S.return=o,le=S;else e:for(o=I;le!==null;){if(a=le,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:bh(9,a)}}catch(U){yt(a,a.return,U)}if(a===o){le=null;break e}var V=a.sibling;if(V!==null){V.return=a.return,le=V;break e}le=a.return}}if(Be=i,rs(),Cr&&typeof Cr.onPostCommitFiberRoot=="function")try{Cr.onPostCommitFiberRoot(Ch,t)}catch{}r=!0}return r}finally{We=n,Un.transition=e}}return!1}function Sv(t,e,n){e=wa(n,e),e=US(t,e,1),t=Vi(t,e,1),e=sn(),t!==null&&(Ou(t,1,e),_n(t,e))}function yt(t,e,n){if(t.tag===3)Sv(t,t,n);else for(;e!==null;){if(e.tag===3){Sv(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Li===null||!Li.has(r))){t=wa(n,t),t=OS(e,t,1),e=Vi(e,t,1),t=sn(),e!==null&&(Ou(e,1,t),_n(e,t));break}}e=e.return}}function yk(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=sn(),t.pingedLanes|=t.suspendedLanes&n,Mt===t&&(Bt&n)===n&&(xt===4||xt===3&&(Bt&130023424)===Bt&&500>Tt()-Hg?Gs(t,0):$g|=n),_n(t,e)}function sC(t,e){e===0&&(t.mode&1?(e=kc,kc<<=1,!(kc&130023424)&&(kc=4194304)):e=1);var n=sn();t=Qr(t,e),t!==null&&(Ou(t,e,n),_n(t,n))}function vk(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),sC(t,n)}function Tk(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(te(314))}r!==null&&r.delete(e),sC(t,n)}var oC;oC=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||mn.current)fn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return fn=!1,ak(t,e,n);fn=!!(t.flags&131072)}else fn=!1,ut&&e.flags&1048576&&cS(e,Fd,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;id(t,e),t=e.pendingProps;var i=va(e,Xt.current);ua(e,n),i=Ug(null,e,r,t,i,n);var s=Og();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,gn(r)?(s=!0,Vd(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,bg(e),i.updater=Dh,e.stateNode=i,i._reactInternals=e,Xp(e,r,t,n),e=tm(null,e,r,!0,s,n)):(e.tag=0,ut&&s&&Ag(e),tn(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(id(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=Ik(r),t=Qn(r,t),i){case 0:e=em(null,e,r,t,n);break e;case 1:e=pv(null,e,r,t,n);break e;case 11:e=hv(null,e,r,t,n);break e;case 14:e=fv(null,e,r,Qn(r.type,t),n);break e}throw Error(te(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Qn(r,i),em(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Qn(r,i),pv(t,e,r,i,n);case 3:e:{if(zS(e),t===null)throw Error(te(387));r=e.pendingProps,s=e.memoizedState,i=s.element,gS(t,e),Bd(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=wa(Error(te(423)),e),e=mv(t,e,r,n,i);break e}else if(r!==i){i=wa(Error(te(424)),e),e=mv(t,e,r,n,i);break e}else for(wn=Mi(e.stateNode.containerInfo.firstChild),Cn=e,ut=!0,Zn=null,n=pS(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Ta(),r===i){e=Yr(t,e,n);break e}tn(t,e,r,n)}e=e.child}return e;case 5:return _S(e),t===null&&Jp(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,$p(r,i)?o=null:s!==null&&$p(r,s)&&(e.flags|=32),GS(t,e),tn(t,e,o,n),e.child;case 6:return t===null&&Jp(e),null;case 13:return $S(t,e,n);case 4:return Mg(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Ea(e,null,r,n):tn(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Qn(r,i),hv(t,e,r,i,n);case 7:return tn(t,e,e.pendingProps,n),e.child;case 8:return tn(t,e,e.pendingProps.children,n),e.child;case 12:return tn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,et(Ud,r._currentValue),r._currentValue=o,s!==null)if(ar(s.value,o)){if(s.children===i.children&&!mn.current){e=Yr(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=Wr(-1,n&-n),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var f=u.pending;f===null?l.next=l:(l.next=f.next,f.next=l),u.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),Qp(s.return,n,e),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(te(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),Qp(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}tn(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,ua(e,n),i=qn(i),r=r(i),e.flags|=1,tn(t,e,r,n),e.child;case 14:return r=e.type,i=Qn(r,e.pendingProps),i=Qn(r.type,i),fv(t,e,r,i,n);case 15:return BS(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Qn(r,i),id(t,e),e.tag=1,gn(r)?(t=!0,Vd(e)):t=!1,ua(e,n),FS(e,r,i),Xp(e,r,i,n),tm(null,e,r,!0,t,n);case 19:return HS(t,e,n);case 22:return qS(t,e,n)}throw Error(te(156,e.tag))};function aC(t,e){return Mw(t,e)}function Ek(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Vn(t,e,n,r){return new Ek(t,e,n,r)}function Jg(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Ik(t){if(typeof t=="function")return Jg(t)?1:0;if(t!=null){if(t=t.$$typeof,t===pg)return 11;if(t===mg)return 14}return 2}function Ui(t,e){var n=t.alternate;return n===null?(n=Vn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function ad(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")Jg(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Wo:return zs(n.children,i,s,e);case fg:o=8,i|=8;break;case Ip:return t=Vn(12,n,e,i|2),t.elementType=Ip,t.lanes=s,t;case wp:return t=Vn(13,n,e,i),t.elementType=wp,t.lanes=s,t;case Sp:return t=Vn(19,n,e,i),t.elementType=Sp,t.lanes=s,t;case _w:return Vh(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case mw:o=10;break e;case gw:o=9;break e;case pg:o=11;break e;case mg:o=14;break e;case Ti:o=16,r=null;break e}throw Error(te(130,t==null?t:typeof t,""))}return e=Vn(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function zs(t,e,n,r){return t=Vn(7,t,r,e),t.lanes=n,t}function Vh(t,e,n,r){return t=Vn(22,t,r,e),t.elementType=_w,t.lanes=n,t.stateNode={isHidden:!1},t}function rp(t,e,n){return t=Vn(6,t,null,e),t.lanes=n,t}function ip(t,e,n){return e=Vn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function wk(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Uf(0),this.expirationTimes=Uf(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Uf(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Qg(t,e,n,r,i,s,o,a,l){return t=new wk(t,e,n,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Vn(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},bg(s),t}function Sk(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ho,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function lC(t){if(!t)return Ki;t=t._reactInternals;e:{if(co(t)!==t||t.tag!==1)throw Error(te(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(gn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(te(171))}if(t.tag===1){var n=t.type;if(gn(n))return lS(t,n,e)}return e}function uC(t,e,n,r,i,s,o,a,l){return t=Qg(n,r,!0,t,i,s,o,a,l),t.context=lC(null),n=t.current,r=sn(),i=Fi(n),s=Wr(r,i),s.callback=e??null,Vi(n,s,i),t.current.lanes=i,Ou(t,i,r),_n(t,r),t}function Lh(t,e,n,r){var i=e.current,s=sn(),o=Fi(i);return n=lC(n),e.context===null?e.context=n:e.pendingContext=n,e=Wr(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Vi(i,e,o),t!==null&&(rr(t,i,o,s),td(t,i,o)),o}function jd(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Cv(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Yg(t,e){Cv(t,e),(t=t.alternate)&&Cv(t,e)}function Ck(){return null}var cC=typeof reportError=="function"?reportError:function(t){console.error(t)};function Xg(t){this._internalRoot=t}Fh.prototype.render=Xg.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(te(409));Lh(t,e,null,null)};Fh.prototype.unmount=Xg.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Zs(function(){Lh(null,t,null,null)}),e[Jr]=null}};function Fh(t){this._internalRoot=t}Fh.prototype.unstable_scheduleHydration=function(t){if(t){var e=qw();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Ii.length&&e!==0&&e<Ii[n].priority;n++);Ii.splice(n,0,t),n===0&&zw(t)}};function Zg(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Uh(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Av(){}function Ak(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var u=jd(o);s.call(u)}}var o=uC(e,r,t,0,null,!1,!1,"",Av);return t._reactRootContainer=o,t[Jr]=o.current,mu(t.nodeType===8?t.parentNode:t),Zs(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var u=jd(l);a.call(u)}}var l=Qg(t,0,!1,null,null,!1,!1,"",Av);return t._reactRootContainer=l,t[Jr]=l.current,mu(t.nodeType===8?t.parentNode:t),Zs(function(){Lh(e,l,n,r)}),l}function Oh(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=jd(o);a.call(l)}}Lh(e,o,t,i)}else o=Ak(n,e,t,i,r);return jd(o)}Ow=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Nl(e.pendingLanes);n!==0&&(yg(e,n|1),_n(e,Tt()),!(Be&6)&&(Sa=Tt()+500,rs()))}break;case 13:Zs(function(){var r=Qr(t,1);if(r!==null){var i=sn();rr(r,t,1,i)}}),Yg(t,1)}};vg=function(t){if(t.tag===13){var e=Qr(t,134217728);if(e!==null){var n=sn();rr(e,t,134217728,n)}Yg(t,134217728)}};Bw=function(t){if(t.tag===13){var e=Fi(t),n=Qr(t,e);if(n!==null){var r=sn();rr(n,t,e,r)}Yg(t,e)}};qw=function(){return We};Gw=function(t,e){var n=We;try{return We=t,e()}finally{We=n}};Mp=function(t,e,n){switch(e){case"input":if(xp(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=Ph(r);if(!i)throw Error(te(90));vw(r),xp(r,i)}}}break;case"textarea":Ew(t,n);break;case"select":e=n.value,e!=null&&sa(t,!!n.multiple,e,!1)}};Rw=Wg;Pw=Zs;var xk={usingClientEntryPoint:!1,Events:[qu,Qo,Ph,Aw,xw,Wg]},Il={findFiberByHostInstance:Fs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Rk={bundleType:Il.bundleType,version:Il.version,rendererPackageName:Il.rendererPackageName,rendererConfig:Il.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ni.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Dw(t),t===null?null:t.stateNode},findFiberByHostInstance:Il.findFiberByHostInstance||Ck,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var qc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!qc.isDisabled&&qc.supportsFiber)try{Ch=qc.inject(Rk),Cr=qc}catch{}}Rn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xk;Rn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Zg(e))throw Error(te(200));return Sk(t,e,null,n)};Rn.createRoot=function(t,e){if(!Zg(t))throw Error(te(299));var n=!1,r="",i=cC;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Qg(t,1,!1,null,null,n,!1,r,i),t[Jr]=e.current,mu(t.nodeType===8?t.parentNode:t),new Xg(e)};Rn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(te(188)):(t=Object.keys(t).join(","),Error(te(268,t)));return t=Dw(e),t=t===null?null:t.stateNode,t};Rn.flushSync=function(t){return Zs(t)};Rn.hydrate=function(t,e,n){if(!Uh(e))throw Error(te(200));return Oh(null,t,e,!0,n)};Rn.hydrateRoot=function(t,e,n){if(!Zg(t))throw Error(te(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=cC;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=uC(e,null,t,1,n??null,i,!1,s,o),t[Jr]=e.current,mu(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new Fh(e)};Rn.render=function(t,e,n){if(!Uh(e))throw Error(te(200));return Oh(null,t,e,!1,n)};Rn.unmountComponentAtNode=function(t){if(!Uh(t))throw Error(te(40));return t._reactRootContainer?(Zs(function(){Oh(null,null,t,!1,function(){t._reactRootContainer=null,t[Jr]=null})}),!0):!1};Rn.unstable_batchedUpdates=Wg;Rn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Uh(n))throw Error(te(200));if(t==null||t._reactInternals===void 0)throw Error(te(38));return Oh(t,e,n,!1,r)};Rn.version="18.3.1-next-f1338f8080-20240426";function dC(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(dC)}catch(t){console.error(t)}}dC(),dw.exports=Rn;var hC=dw.exports;const Pk=XI(hC);var xv=hC;Tp.createRoot=xv.createRoot,Tp.hydrateRoot=xv.hydrateRoot;const kk=({children:t})=>m.jsx(m.Fragment,{children:t}),Nk="modulepreload",Dk=function(t){return"/Nova-AI-Planer-beta-/"+t},Rv={},Cs=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(n.map(l=>{if(l=Dk(l),l in Rv)return;Rv[l]=!0;const u=l.endsWith(".css"),f=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${f}`))return;const p=document.createElement("link");if(p.rel=u?"stylesheet":Nk,u||(p.as="script"),p.crossOrigin="",p.href=l,a&&p.setAttribute("nonce",a),document.head.appendChild(p),u)return new Promise((g,v)=>{p.addEventListener("load",g),p.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return i.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return e().catch(s)})};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let bk,Mk;function Vk(){return{geminiUrl:bk,vertexUrl:Mk}}function Lk(t,e,n,r){var i,s;if(!(t!=null&&t.baseUrl)){const o=Vk();return e?(i=o.vertexUrl)!==null&&i!==void 0?i:n:(s=o.geminiUrl)!==null&&s!==void 0?s:r}return t.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ho{}function ue(t,e){const n=/\{([^}]+)\}/g;return t.replace(n,(r,i)=>{if(Object.prototype.hasOwnProperty.call(e,i)){const s=e[i];return s!=null?String(s):""}else throw new Error(`Key '${i}' not found in valueMap.`)})}function h(t,e,n){for(let s=0;s<e.length-1;s++){const o=e[s];if(o.endsWith("[]")){const a=o.slice(0,-2);if(!(a in t))if(Array.isArray(n))t[a]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${o}`);if(Array.isArray(t[a])){const l=t[a];if(Array.isArray(n))for(let u=0;u<l.length;u++){const f=l[u];h(f,e.slice(s+1),n[u])}else for(const u of l)h(u,e.slice(s+1),n)}return}else if(o.endsWith("[0]")){const a=o.slice(0,-3);a in t||(t[a]=[{}]);const l=t[a];h(l[0],e.slice(s+1),n);return}(!t[o]||typeof t[o]!="object")&&(t[o]={}),t=t[o]}const r=e[e.length-1],i=t[r];if(i!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===i)return;if(typeof i=="object"&&typeof n=="object"&&i!==null&&n!==null)Object.assign(i,n);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else r==="_self"&&typeof n=="object"&&n!==null&&!Array.isArray(n)?Object.assign(t,n):t[r]=n}function c(t,e,n=void 0){try{if(e.length===1&&e[0]==="_self")return t;for(let r=0;r<e.length;r++){if(typeof t!="object"||t===null)return n;const i=e[r];if(i.endsWith("[]")){const s=i.slice(0,-2);if(s in t){const o=t[s];return Array.isArray(o)?o.map(a=>c(a,e.slice(r+1),n)):n}else return n}else t=t[i]}return t}catch(r){if(r instanceof TypeError)return n;throw r}}function Fk(t,e){for(const[n,r]of Object.entries(e)){const i=n.split("."),s=r.split("."),o=new Set;let a=-1;for(let l=0;l<i.length;l++)if(i[l]==="*"){a=l;break}if(a!==-1&&s.length>a)for(let l=a;l<s.length;l++){const u=s[l];u!=="*"&&!u.endsWith("[]")&&!u.endsWith("[0]")&&o.add(u)}fm(t,i,s,0,o)}}function fm(t,e,n,r,i){if(r>=e.length||typeof t!="object"||t===null)return;const s=e[r];if(s.endsWith("[]")){const o=s.slice(0,-2),a=t;if(o in a&&Array.isArray(a[o]))for(const l of a[o])fm(l,e,n,r+1,i)}else if(s==="*"){if(typeof t=="object"&&t!==null&&!Array.isArray(t)){const o=t,a=Object.keys(o).filter(u=>!u.startsWith("_")&&!i.has(u)),l={};for(const u of a)l[u]=o[u];for(const[u,f]of Object.entries(l)){const p=[];for(const g of n.slice(r))g==="*"?p.push(u):p.push(g);h(o,p,f)}for(const u of a)delete o[u]}}else{const o=t;s in o&&fm(o[s],e,n,r+1,i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function e_(t){if(typeof t!="string")throw new Error("fromImageBytes must be a string");return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Uk(t){const e={},n=c(t,["operationName"]);n!=null&&h(e,["operationName"],n);const r=c(t,["resourceName"]);return r!=null&&h(e,["_url","resourceName"],r),e}function Ok(t){const e={},n=c(t,["name"]);n!=null&&h(e,["name"],n);const r=c(t,["metadata"]);r!=null&&h(e,["metadata"],r);const i=c(t,["done"]);i!=null&&h(e,["done"],i);const s=c(t,["error"]);s!=null&&h(e,["error"],s);const o=c(t,["response","generateVideoResponse"]);return o!=null&&h(e,["response"],qk(o)),e}function Bk(t){const e={},n=c(t,["name"]);n!=null&&h(e,["name"],n);const r=c(t,["metadata"]);r!=null&&h(e,["metadata"],r);const i=c(t,["done"]);i!=null&&h(e,["done"],i);const s=c(t,["error"]);s!=null&&h(e,["error"],s);const o=c(t,["response"]);return o!=null&&h(e,["response"],Gk(o)),e}function qk(t){const e={},n=c(t,["generatedSamples"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>zk(o))),h(e,["generatedVideos"],s)}const r=c(t,["raiMediaFilteredCount"]);r!=null&&h(e,["raiMediaFilteredCount"],r);const i=c(t,["raiMediaFilteredReasons"]);return i!=null&&h(e,["raiMediaFilteredReasons"],i),e}function Gk(t){const e={},n=c(t,["videos"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>$k(o))),h(e,["generatedVideos"],s)}const r=c(t,["raiMediaFilteredCount"]);r!=null&&h(e,["raiMediaFilteredCount"],r);const i=c(t,["raiMediaFilteredReasons"]);return i!=null&&h(e,["raiMediaFilteredReasons"],i),e}function zk(t){const e={},n=c(t,["video"]);return n!=null&&h(e,["video"],Kk(n)),e}function $k(t){const e={},n=c(t,["_self"]);return n!=null&&h(e,["video"],jk(n)),e}function Hk(t){const e={},n=c(t,["operationName"]);return n!=null&&h(e,["_url","operationName"],n),e}function Wk(t){const e={},n=c(t,["operationName"]);return n!=null&&h(e,["_url","operationName"],n),e}function Kk(t){const e={},n=c(t,["uri"]);n!=null&&h(e,["uri"],n);const r=c(t,["encodedVideo"]);r!=null&&h(e,["videoBytes"],e_(r));const i=c(t,["encoding"]);return i!=null&&h(e,["mimeType"],i),e}function jk(t){const e={},n=c(t,["gcsUri"]);n!=null&&h(e,["uri"],n);const r=c(t,["bytesBase64Encoded"]);r!=null&&h(e,["videoBytes"],e_(r));const i=c(t,["mimeType"]);return i!=null&&h(e,["mimeType"],i),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Pv;(function(t){t.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",t.OUTCOME_OK="OUTCOME_OK",t.OUTCOME_FAILED="OUTCOME_FAILED",t.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Pv||(Pv={}));var kv;(function(t){t.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",t.PYTHON="PYTHON"})(kv||(kv={}));var Ln;(function(t){t.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",t.STRING="STRING",t.NUMBER="NUMBER",t.INTEGER="INTEGER",t.BOOLEAN="BOOLEAN",t.ARRAY="ARRAY",t.OBJECT="OBJECT",t.NULL="NULL"})(Ln||(Ln={}));var Nv;(function(t){t.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",t.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",t.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",t.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",t.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",t.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",t.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",t.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",t.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT"})(Nv||(Nv={}));var Dv;(function(t){t.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",t.SEVERITY="SEVERITY",t.PROBABILITY="PROBABILITY"})(Dv||(Dv={}));var bv;(function(t){t.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE",t.OFF="OFF"})(bv||(bv={}));var Mv;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(Mv||(Mv={}));var Vv;(function(t){t.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",t.NO_AUTH="NO_AUTH",t.API_KEY_AUTH="API_KEY_AUTH",t.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",t.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",t.OAUTH="OAUTH",t.OIDC_AUTH="OIDC_AUTH"})(Vv||(Vv={}));var Lv;(function(t){t.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",t.SIMPLE_SEARCH="SIMPLE_SEARCH",t.ELASTIC_SEARCH="ELASTIC_SEARCH"})(Lv||(Lv={}));var Fv;(function(t){t.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",t.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",t.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",t.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",t.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(Fv||(Fv={}));var Uv;(function(t){t.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.LANGUAGE="LANGUAGE",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.SPII="SPII",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.IMAGE_SAFETY="IMAGE_SAFETY",t.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",t.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",t.NO_IMAGE="NO_IMAGE"})(Uv||(Uv={}));var Ov;(function(t){t.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",t.NEGLIGIBLE="NEGLIGIBLE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH"})(Ov||(Ov={}));var Bv;(function(t){t.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",t.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",t.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",t.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",t.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(Bv||(Bv={}));var qv;(function(t){t.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",t.SAFETY="SAFETY",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.IMAGE_SAFETY="IMAGE_SAFETY"})(qv||(qv={}));var Gv;(function(t){t.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",t.ON_DEMAND="ON_DEMAND",t.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(Gv||(Gv={}));var Jd;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.AUDIO="AUDIO"})(Jd||(Jd={}));var zv;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(zv||(zv={}));var pm;(function(t){t.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",t.JOB_STATE_QUEUED="JOB_STATE_QUEUED",t.JOB_STATE_PENDING="JOB_STATE_PENDING",t.JOB_STATE_RUNNING="JOB_STATE_RUNNING",t.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",t.JOB_STATE_FAILED="JOB_STATE_FAILED",t.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",t.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",t.JOB_STATE_PAUSED="JOB_STATE_PAUSED",t.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",t.JOB_STATE_UPDATING="JOB_STATE_UPDATING",t.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(pm||(pm={}));var $v;(function(t){t.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",t.TUNING_MODE_FULL="TUNING_MODE_FULL",t.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})($v||($v={}));var Hv;(function(t){t.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",t.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",t.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",t.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",t.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",t.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",t.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(Hv||(Hv={}));var Wv;(function(t){t.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",t.TUNING_TASK_I2V="TUNING_TASK_I2V",t.TUNING_TASK_T2V="TUNING_TASK_T2V"})(Wv||(Wv={}));var Kv;(function(t){t.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",t.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",t.BALANCED="BALANCED",t.PRIORITIZE_COST="PRIORITIZE_COST"})(Kv||(Kv={}));var jv;(function(t){t.UNSPECIFIED="UNSPECIFIED",t.BLOCKING="BLOCKING",t.NON_BLOCKING="NON_BLOCKING"})(jv||(jv={}));var Jv;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(Jv||(Jv={}));var Qv;(function(t){t.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",t.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(Qv||(Qv={}));var Yv;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.AUTO="AUTO",t.ANY="ANY",t.NONE="NONE",t.VALIDATED="VALIDATED"})(Yv||(Yv={}));var Xv;(function(t){t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE"})(Xv||(Xv={}));var Zv;(function(t){t.DONT_ALLOW="DONT_ALLOW",t.ALLOW_ADULT="ALLOW_ADULT",t.ALLOW_ALL="ALLOW_ALL"})(Zv||(Zv={}));var eT;(function(t){t.auto="auto",t.en="en",t.ja="ja",t.ko="ko",t.hi="hi",t.zh="zh",t.pt="pt",t.es="es"})(eT||(eT={}));var tT;(function(t){t.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",t.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",t.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",t.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",t.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(tT||(tT={}));var nT;(function(t){t.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",t.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",t.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",t.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(nT||(nT={}));var rT;(function(t){t.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",t.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",t.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",t.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(rT||(rT={}));var iT;(function(t){t.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",t.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",t.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",t.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",t.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",t.EDIT_MODE_STYLE="EDIT_MODE_STYLE",t.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",t.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(iT||(iT={}));var sT;(function(t){t.FOREGROUND="FOREGROUND",t.BACKGROUND="BACKGROUND",t.PROMPT="PROMPT",t.SEMANTIC="SEMANTIC",t.INTERACTIVE="INTERACTIVE"})(sT||(sT={}));var oT;(function(t){t.ASSET="ASSET",t.STYLE="STYLE"})(oT||(oT={}));var aT;(function(t){t.INSERT="INSERT",t.REMOVE="REMOVE",t.REMOVE_STATIC="REMOVE_STATIC",t.OUTPAINT="OUTPAINT"})(aT||(aT={}));var lT;(function(t){t.OPTIMIZED="OPTIMIZED",t.LOSSLESS="LOSSLESS"})(lT||(lT={}));var uT;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.PROCESSING="PROCESSING",t.ACTIVE="ACTIVE",t.FAILED="FAILED"})(uT||(uT={}));var cT;(function(t){t.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",t.UPLOADED="UPLOADED",t.GENERATED="GENERATED"})(cT||(cT={}));var dT;(function(t){t.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.RESPONSE_REJECTED="RESPONSE_REJECTED",t.NEED_MORE_INPUT="NEED_MORE_INPUT"})(dT||(dT={}));var hT;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.VIDEO="VIDEO",t.AUDIO="AUDIO",t.DOCUMENT="DOCUMENT"})(hT||(hT={}));var fT;(function(t){t.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",t.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",t.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(fT||(fT={}));var pT;(function(t){t.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",t.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",t.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(pT||(pT={}));var mT;(function(t){t.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",t.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",t.NO_INTERRUPTION="NO_INTERRUPTION"})(mT||(mT={}));var gT;(function(t){t.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",t.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",t.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(gT||(gT={}));var _T;(function(t){t.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",t.SILENT="SILENT",t.WHEN_IDLE="WHEN_IDLE",t.INTERRUPT="INTERRUPT"})(_T||(_T={}));var yT;(function(t){t.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",t.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",t.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",t.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",t.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",t.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",t.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",t.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",t.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",t.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",t.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",t.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",t.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(yT||(yT={}));var vT;(function(t){t.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",t.QUALITY="QUALITY",t.DIVERSITY="DIVERSITY",t.VOCALIZATION="VOCALIZATION"})(vT||(vT={}));var ra;(function(t){t.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",t.PLAY="PLAY",t.PAUSE="PAUSE",t.STOP="STOP",t.RESET_CONTEXT="RESET_CONTEXT"})(ra||(ra={}));class mm{constructor(e){const n={};for(const r of e.headers.entries())n[r[0]]=r[1];this.headers=n,this.responseInternal=e}json(){return this.responseInternal.json()}}class wl{get text(){var e,n,r,i,s,o,a,l;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let u="",f=!1;const p=[];for(const g of(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)!==null&&l!==void 0?l:[]){for(const[v,E]of Object.entries(g))v!=="text"&&v!=="thought"&&(E!==null||E!==void 0)&&p.push(v);if(typeof g.text=="string"){if(typeof g.thought=="boolean"&&g.thought)continue;f=!0,u+=g.text}}return p.length>0&&console.warn(`there are non-text parts ${p} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),f?u:void 0}get data(){var e,n,r,i,s,o,a,l;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let u="";const f=[];for(const p of(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)!==null&&l!==void 0?l:[]){for(const[g,v]of Object.entries(p))g!=="inlineData"&&(v!==null||v!==void 0)&&f.push(g);p.inlineData&&typeof p.inlineData.data=="string"&&(u+=atob(p.inlineData.data))}return f.length>0&&console.warn(`there are non-data parts ${f} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),u.length>0?btoa(u):void 0}get functionCalls(){var e,n,r,i,s,o,a,l;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const u=(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(f=>f.functionCall).map(f=>f.functionCall).filter(f=>f!==void 0);if((u==null?void 0:u.length)!==0)return u}get executableCode(){var e,n,r,i,s,o,a,l,u;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const f=(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(p=>p.executableCode).map(p=>p.executableCode).filter(p=>p!==void 0);if((f==null?void 0:f.length)!==0)return(u=f==null?void 0:f[0])===null||u===void 0?void 0:u.code}get codeExecutionResult(){var e,n,r,i,s,o,a,l,u;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const f=(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(p=>p.codeExecutionResult).map(p=>p.codeExecutionResult).filter(p=>p!==void 0);if((f==null?void 0:f.length)!==0)return(u=f==null?void 0:f[0])===null||u===void 0?void 0:u.output}}class TT{}class ET{}class Jk{}class Qk{}class Yk{}class Xk{}class IT{}class wT{}class ST{}class Zk{}class Qd{_fromAPIResponse({apiResponse:e,isVertexAI:n}){const r=new Qd;let i;const s=e;return n?i=Bk(s):i=Ok(s),Object.assign(r,i),r}}class CT{}class AT{}class xT{}class e1{}class t1{}class n1{}class RT{}class r1{get text(){var e,n,r;let i="",s=!1;const o=[];for(const a of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[l,u]of Object.entries(a))l!=="text"&&l!=="thought"&&u!==null&&o.push(l);if(typeof a.text=="string"){if(typeof a.thought=="boolean"&&a.thought)continue;s=!0,i+=a.text}}return o.length>0&&console.warn(`there are non-text parts ${o} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),s?i:void 0}get data(){var e,n,r;let i="";const s=[];for(const o of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[a,l]of Object.entries(o))a!=="inlineData"&&l!==null&&s.push(a);o.inlineData&&typeof o.inlineData.data=="string"&&(i+=atob(o.inlineData.data))}return s.length>0&&console.warn(`there are non-data parts ${s} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),i.length>0?btoa(i):void 0}}class i1{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function qe(t,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(t.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const n=e.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function fC(t,e){const n=qe(t,e);return n?n.startsWith("publishers/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}`:n.startsWith("models/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/publishers/google/${n}`:n:""}function pC(t){return Array.isArray(t)?t.map(e=>Yd(e)):[Yd(t)]}function Yd(t){if(typeof t=="object"&&t!==null)return t;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof t}`)}function mC(t){const e=Yd(t);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function gC(t){const e=Yd(t);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function PT(t){if(t==null)throw new Error("PartUnion is required");if(typeof t=="object")return t;if(typeof t=="string")return{text:t};throw new Error(`Unsupported part type: ${typeof t}`)}function _C(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("PartListUnion is required");return Array.isArray(t)?t.map(e=>PT(e)):[PT(t)]}function gm(t){return t!=null&&typeof t=="object"&&"parts"in t&&Array.isArray(t.parts)}function kT(t){return t!=null&&typeof t=="object"&&"functionCall"in t}function NT(t){return t!=null&&typeof t=="object"&&"functionResponse"in t}function Qt(t){if(t==null)throw new Error("ContentUnion is required");return gm(t)?t:{role:"user",parts:_C(t)}}function t_(t,e){if(!e)return[];if(t.isVertexAI()&&Array.isArray(e))return e.flatMap(n=>{const r=Qt(n);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(t.isVertexAI()){const n=Qt(e);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(e)?e.map(n=>Qt(n)):[Qt(e)]}function On(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("contents are required");if(!Array.isArray(t)){if(kT(t)||NT(t))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Qt(t)]}const e=[],n=[],r=gm(t[0]);for(const i of t){const s=gm(i);if(s!=r)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(s)e.push(i);else{if(kT(i)||NT(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(i)}}return r||e.push({role:"user",parts:_C(n)}),e}function s1(t,e){t.includes("null")&&(e.nullable=!0);const n=t.filter(r=>r!=="null");if(n.length===1)e.type=Object.values(Ln).includes(n[0].toUpperCase())?n[0].toUpperCase():Ln.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const r of n)e.anyOf.push({type:Object.values(Ln).includes(r.toUpperCase())?r.toUpperCase():Ln.TYPE_UNSPECIFIED})}}function da(t){const e={},n=["items"],r=["anyOf"],i=["properties"];if(t.type&&t.anyOf)throw new Error("type and anyOf cannot be both populated.");const s=t.anyOf;s!=null&&s.length==2&&(s[0].type==="null"?(e.nullable=!0,t=s[1]):s[1].type==="null"&&(e.nullable=!0,t=s[0])),t.type instanceof Array&&s1(t.type,e);for(const[o,a]of Object.entries(t))if(a!=null)if(o=="type"){if(a==="null")throw new Error("type: null can not be the only possible type for the field.");if(a instanceof Array)continue;e.type=Object.values(Ln).includes(a.toUpperCase())?a.toUpperCase():Ln.TYPE_UNSPECIFIED}else if(n.includes(o))e[o]=da(a);else if(r.includes(o)){const l=[];for(const u of a){if(u.type=="null"){e.nullable=!0;continue}l.push(da(u))}e[o]=l}else if(i.includes(o)){const l={};for(const[u,f]of Object.entries(a))l[u]=da(f);e[o]=l}else{if(o==="additionalProperties")continue;e[o]=a}return e}function n_(t){return da(t)}function r_(t){if(typeof t=="object")return t;if(typeof t=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:t}}};throw new Error(`Unsupported speechConfig type: ${typeof t}`)}function i_(t){if("multiSpeakerVoiceConfig"in t)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return t}function $a(t){if(t.functionDeclarations)for(const e of t.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=da(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=da(e.response));return t}function Ha(t){if(t==null)throw new Error("tools is required");if(!Array.isArray(t))throw new Error("tools is required and must be an array of Tools");const e=[];for(const n of t)e.push(n);return e}function o1(t,e,n,r=1){const i=!e.startsWith(`${n}/`)&&e.split("/").length===r;return t.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${t.getProject()}/${e}`:e.startsWith(`${n}/`)?`projects/${t.getProject()}/locations/${t.getLocation()}/${e}`:i?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}/${e}`:e:i?`${n}/${e}`:e}function ri(t,e){if(typeof e!="string")throw new Error("name must be a string");return o1(t,e,"cachedContents")}function yC(t){switch(t){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return t}}function is(t){return e_(t)}function a1(t){return t!=null&&typeof t=="object"&&"name"in t}function l1(t){return t!=null&&typeof t=="object"&&"video"in t}function u1(t){return t!=null&&typeof t=="object"&&"uri"in t}function vC(t){var e;let n;if(a1(t)&&(n=t.name),!(u1(t)&&(n=t.uri,n===void 0))&&!(l1(t)&&(n=(e=t.video)===null||e===void 0?void 0:e.uri,n===void 0))){if(typeof t=="string"&&(n=t),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const i=n.split("files/")[1].match(/[a-z0-9]+/);if(i===null)throw new Error(`Could not extract file name from URI ${n}`);n=i[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function TC(t,e){let n;return t.isVertexAI()?n=e?"publishers/google/models":"models":n=e?"models":"tunedModels",n}function EC(t){for(const e of["models","tunedModels","publisherModels"])if(c1(t,e))return t[e];return[]}function c1(t,e){return t!==null&&typeof t=="object"&&e in t}function d1(t,e={}){const n=t,r={name:n.name,description:n.description,parametersJsonSchema:n.inputSchema};return n.outputSchema&&(r.responseJsonSchema=n.outputSchema),e.behavior&&(r.behavior=e.behavior),{functionDeclarations:[r]}}function h1(t,e={}){const n=[],r=new Set;for(const i of t){const s=i.name;if(r.has(s))throw new Error(`Duplicate function name ${s} found in MCP tools. Please ensure function names are unique.`);r.add(s);const o=d1(i,e);o.functionDeclarations&&n.push(...o.functionDeclarations)}return{functionDeclarations:n}}function IC(t,e){let n;if(typeof e=="string")if(t.isVertexAI())if(e.startsWith("gs://"))n={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))n={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))n={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(t.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");n={inlinedRequests:e}}else n=e;const r=[n.gcsUri,n.bigqueryUri].filter(Boolean).length,i=[n.inlinedRequests,n.fileName].filter(Boolean).length;if(t.isVertexAI()){if(i>0||r!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(r>0||i!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return n}function f1(t){if(typeof t!="string")return t;const e=t;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function wC(t){if(typeof t!="object"||t===null)return{};const e=t,n=e.inlinedResponses;if(typeof n!="object"||n===null)return t;const i=n.inlinedResponses;if(!Array.isArray(i)||i.length===0)return t;let s=!1;for(const o of i){if(typeof o!="object"||o===null)continue;const l=o.response;if(typeof l!="object"||l===null)continue;if(l.embedding!==void 0){s=!0;break}}return s&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),t}function Wa(t,e){const n=e;if(!t.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error(`Invalid batch job name: ${n}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error(`Invalid batch job name: ${n}.`)}function SC(t){const e=t;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function p1(t){const e={},n=c(t,["responsesFile"]);n!=null&&h(e,["fileName"],n);const r=c(t,["inlinedResponses","inlinedResponses"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>H1(o))),h(e,["inlinedResponses"],s)}const i=c(t,["inlinedEmbedContentResponses","inlinedResponses"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),h(e,["inlinedEmbedContentResponses"],s)}return e}function m1(t){const e={},n=c(t,["predictionsFormat"]);n!=null&&h(e,["format"],n);const r=c(t,["gcsDestination","outputUriPrefix"]);r!=null&&h(e,["gcsUri"],r);const i=c(t,["bigqueryDestination","outputUri"]);return i!=null&&h(e,["bigqueryUri"],i),e}function g1(t){const e={},n=c(t,["format"]);n!=null&&h(e,["predictionsFormat"],n);const r=c(t,["gcsUri"]);r!=null&&h(e,["gcsDestination","outputUriPrefix"],r);const i=c(t,["bigqueryUri"]);if(i!=null&&h(e,["bigqueryDestination","outputUri"],i),c(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(c(t,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(c(t,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function ld(t){const e={},n=c(t,["name"]);n!=null&&h(e,["name"],n);const r=c(t,["metadata","displayName"]);r!=null&&h(e,["displayName"],r);const i=c(t,["metadata","state"]);i!=null&&h(e,["state"],SC(i));const s=c(t,["metadata","createTime"]);s!=null&&h(e,["createTime"],s);const o=c(t,["metadata","endTime"]);o!=null&&h(e,["endTime"],o);const a=c(t,["metadata","updateTime"]);a!=null&&h(e,["updateTime"],a);const l=c(t,["metadata","model"]);l!=null&&h(e,["model"],l);const u=c(t,["metadata","output"]);return u!=null&&h(e,["dest"],p1(wC(u))),e}function _m(t){const e={},n=c(t,["name"]);n!=null&&h(e,["name"],n);const r=c(t,["displayName"]);r!=null&&h(e,["displayName"],r);const i=c(t,["state"]);i!=null&&h(e,["state"],SC(i));const s=c(t,["error"]);s!=null&&h(e,["error"],s);const o=c(t,["createTime"]);o!=null&&h(e,["createTime"],o);const a=c(t,["startTime"]);a!=null&&h(e,["startTime"],a);const l=c(t,["endTime"]);l!=null&&h(e,["endTime"],l);const u=c(t,["updateTime"]);u!=null&&h(e,["updateTime"],u);const f=c(t,["model"]);f!=null&&h(e,["model"],f);const p=c(t,["inputConfig"]);p!=null&&h(e,["src"],_1(p));const g=c(t,["outputConfig"]);return g!=null&&h(e,["dest"],m1(wC(g))),e}function _1(t){const e={},n=c(t,["instancesFormat"]);n!=null&&h(e,["format"],n);const r=c(t,["gcsSource","uris"]);r!=null&&h(e,["gcsUri"],r);const i=c(t,["bigquerySource","inputUri"]);return i!=null&&h(e,["bigqueryUri"],i),e}function y1(t,e){const n={};if(c(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(c(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(c(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const r=c(e,["fileName"]);r!=null&&h(n,["fileName"],r);const i=c(e,["inlinedRequests"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>$1(t,o))),h(n,["requests","requests"],s)}return n}function v1(t){const e={},n=c(t,["format"]);n!=null&&h(e,["instancesFormat"],n);const r=c(t,["gcsUri"]);r!=null&&h(e,["gcsSource","uris"],r);const i=c(t,["bigqueryUri"]);if(i!=null&&h(e,["bigquerySource","inputUri"],i),c(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(c(t,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function T1(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["data"]);n!=null&&h(e,["data"],n);const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function E1(t,e){const n={},r=c(e,["name"]);return r!=null&&h(n,["_url","name"],Wa(t,r)),n}function I1(t,e){const n={},r=c(e,["name"]);return r!=null&&h(n,["_url","name"],Wa(t,r)),n}function w1(t){const e={},n=c(t,["content"]);n!=null&&h(e,["content"],n);const r=c(t,["citationMetadata"]);r!=null&&h(e,["citationMetadata"],S1(r));const i=c(t,["tokenCount"]);i!=null&&h(e,["tokenCount"],i);const s=c(t,["finishReason"]);s!=null&&h(e,["finishReason"],s);const o=c(t,["urlContextMetadata"]);o!=null&&h(e,["urlContextMetadata"],o);const a=c(t,["avgLogprobs"]);a!=null&&h(e,["avgLogprobs"],a);const l=c(t,["groundingMetadata"]);l!=null&&h(e,["groundingMetadata"],l);const u=c(t,["index"]);u!=null&&h(e,["index"],u);const f=c(t,["logprobsResult"]);f!=null&&h(e,["logprobsResult"],f);const p=c(t,["safetyRatings"]);if(p!=null){let g=p;Array.isArray(g)&&(g=g.map(v=>v)),h(e,["safetyRatings"],g)}return e}function S1(t){const e={},n=c(t,["citationSources"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>i)),h(e,["citations"],r)}return e}function CC(t){const e={},n=c(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>X1(s))),h(e,["parts"],i)}const r=c(t,["role"]);return r!=null&&h(e,["role"],r),e}function C1(t,e){const n={},r=c(t,["displayName"]);if(e!==void 0&&r!=null&&h(e,["batch","displayName"],r),c(t,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return n}function A1(t,e){const n={},r=c(t,["displayName"]);e!==void 0&&r!=null&&h(e,["displayName"],r);const i=c(t,["dest"]);return e!==void 0&&i!=null&&h(e,["outputConfig"],g1(f1(i))),n}function DT(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=c(e,["src"]);i!=null&&h(n,["batch","inputConfig"],y1(t,IC(t,i)));const s=c(e,["config"]);return s!=null&&C1(s,n),n}function x1(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["model"],qe(t,r));const i=c(e,["src"]);i!=null&&h(n,["inputConfig"],v1(IC(t,i)));const s=c(e,["config"]);return s!=null&&A1(s,n),n}function R1(t,e){const n={},r=c(t,["displayName"]);return e!==void 0&&r!=null&&h(e,["batch","displayName"],r),n}function P1(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=c(e,["src"]);i!=null&&h(n,["batch","inputConfig"],L1(t,i));const s=c(e,["config"]);return s!=null&&R1(s,n),n}function k1(t,e){const n={},r=c(e,["name"]);return r!=null&&h(n,["_url","name"],Wa(t,r)),n}function N1(t,e){const n={},r=c(e,["name"]);return r!=null&&h(n,["_url","name"],Wa(t,r)),n}function D1(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["name"]);r!=null&&h(e,["name"],r);const i=c(t,["done"]);i!=null&&h(e,["done"],i);const s=c(t,["error"]);return s!=null&&h(e,["error"],s),e}function b1(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["name"]);r!=null&&h(e,["name"],r);const i=c(t,["done"]);i!=null&&h(e,["done"],i);const s=c(t,["error"]);return s!=null&&h(e,["error"],s),e}function M1(t,e){const n={},r=c(e,["contents"]);if(r!=null){let s=t_(t,r);Array.isArray(s)&&(s=s.map(o=>o)),h(n,["requests[]","request","content"],s)}const i=c(e,["config"]);return i!=null&&(h(n,["_self"],V1(i,n)),Fk(n,{"requests[].*":"requests[].request.*"})),n}function V1(t,e){const n={},r=c(t,["taskType"]);e!==void 0&&r!=null&&h(e,["requests[]","taskType"],r);const i=c(t,["title"]);e!==void 0&&i!=null&&h(e,["requests[]","title"],i);const s=c(t,["outputDimensionality"]);if(e!==void 0&&s!=null&&h(e,["requests[]","outputDimensionality"],s),c(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(c(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function L1(t,e){const n={},r=c(e,["fileName"]);r!=null&&h(n,["file_name"],r);const i=c(e,["inlinedRequests"]);return i!=null&&h(n,["requests"],M1(t,i)),n}function F1(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["fileUri"]);n!=null&&h(e,["fileUri"],n);const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function U1(t,e,n){const r={},i=c(e,["systemInstruction"]);n!==void 0&&i!=null&&h(n,["systemInstruction"],CC(Qt(i)));const s=c(e,["temperature"]);s!=null&&h(r,["temperature"],s);const o=c(e,["topP"]);o!=null&&h(r,["topP"],o);const a=c(e,["topK"]);a!=null&&h(r,["topK"],a);const l=c(e,["candidateCount"]);l!=null&&h(r,["candidateCount"],l);const u=c(e,["maxOutputTokens"]);u!=null&&h(r,["maxOutputTokens"],u);const f=c(e,["stopSequences"]);f!=null&&h(r,["stopSequences"],f);const p=c(e,["responseLogprobs"]);p!=null&&h(r,["responseLogprobs"],p);const g=c(e,["logprobs"]);g!=null&&h(r,["logprobs"],g);const v=c(e,["presencePenalty"]);v!=null&&h(r,["presencePenalty"],v);const E=c(e,["frequencyPenalty"]);E!=null&&h(r,["frequencyPenalty"],E);const x=c(e,["seed"]);x!=null&&h(r,["seed"],x);const b=c(e,["responseMimeType"]);b!=null&&h(r,["responseMimeType"],b);const C=c(e,["responseSchema"]);C!=null&&h(r,["responseSchema"],n_(C));const I=c(e,["responseJsonSchema"]);if(I!=null&&h(r,["responseJsonSchema"],I),c(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(c(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const S=c(e,["safetySettings"]);if(n!==void 0&&S!=null){let L=S;Array.isArray(L)&&(L=L.map(N=>Z1(N))),h(n,["safetySettings"],L)}const V=c(e,["tools"]);if(n!==void 0&&V!=null){let L=Ha(V);Array.isArray(L)&&(L=L.map(N=>eN($a(N)))),h(n,["tools"],L)}const U=c(e,["toolConfig"]);if(n!==void 0&&U!=null&&h(n,["toolConfig"],U),c(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const B=c(e,["cachedContent"]);n!==void 0&&B!=null&&h(n,["cachedContent"],ri(t,B));const T=c(e,["responseModalities"]);T!=null&&h(r,["responseModalities"],T);const w=c(e,["mediaResolution"]);w!=null&&h(r,["mediaResolution"],w);const A=c(e,["speechConfig"]);if(A!=null&&h(r,["speechConfig"],r_(A)),c(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const k=c(e,["thinkingConfig"]);k!=null&&h(r,["thinkingConfig"],k);const D=c(e,["imageConfig"]);return D!=null&&h(r,["imageConfig"],D),r}function O1(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["candidates"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(u=>w1(u))),h(e,["candidates"],l)}const i=c(t,["modelVersion"]);i!=null&&h(e,["modelVersion"],i);const s=c(t,["promptFeedback"]);s!=null&&h(e,["promptFeedback"],s);const o=c(t,["responseId"]);o!=null&&h(e,["responseId"],o);const a=c(t,["usageMetadata"]);return a!=null&&h(e,["usageMetadata"],a),e}function B1(t,e){const n={},r=c(e,["name"]);return r!=null&&h(n,["_url","name"],Wa(t,r)),n}function q1(t,e){const n={},r=c(e,["name"]);return r!=null&&h(n,["_url","name"],Wa(t,r)),n}function G1(t){const e={};if(c(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=c(t,["enableWidget"]);return n!=null&&h(e,["enableWidget"],n),e}function z1(t){const e={},n=c(t,["timeRangeFilter"]);if(n!=null&&h(e,["timeRangeFilter"],n),c(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function $1(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["request","model"],qe(t,r));const i=c(e,["contents"]);if(i!=null){let a=On(i);Array.isArray(a)&&(a=a.map(l=>CC(l))),h(n,["request","contents"],a)}const s=c(e,["metadata"]);s!=null&&h(n,["metadata"],s);const o=c(e,["config"]);return o!=null&&h(n,["request","generationConfig"],U1(t,o,c(n,["request"],{}))),n}function H1(t){const e={},n=c(t,["response"]);n!=null&&h(e,["response"],O1(n));const r=c(t,["error"]);return r!=null&&h(e,["error"],r),e}function W1(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&h(e,["_query","pageSize"],r);const i=c(t,["pageToken"]);if(e!==void 0&&i!=null&&h(e,["_query","pageToken"],i),c(t,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return n}function K1(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&h(e,["_query","pageSize"],r);const i=c(t,["pageToken"]);e!==void 0&&i!=null&&h(e,["_query","pageToken"],i);const s=c(t,["filter"]);return e!==void 0&&s!=null&&h(e,["_query","filter"],s),n}function j1(t){const e={},n=c(t,["config"]);return n!=null&&W1(n,e),e}function J1(t){const e={},n=c(t,["config"]);return n!=null&&K1(n,e),e}function Q1(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=c(t,["operations"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>ld(o))),h(e,["batchJobs"],s)}return e}function Y1(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=c(t,["batchPredictionJobs"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>_m(o))),h(e,["batchJobs"],s)}return e}function X1(t){const e={},n=c(t,["videoMetadata"]);n!=null&&h(e,["videoMetadata"],n);const r=c(t,["thought"]);r!=null&&h(e,["thought"],r);const i=c(t,["inlineData"]);i!=null&&h(e,["inlineData"],T1(i));const s=c(t,["fileData"]);s!=null&&h(e,["fileData"],F1(s));const o=c(t,["thoughtSignature"]);o!=null&&h(e,["thoughtSignature"],o);const a=c(t,["functionCall"]);a!=null&&h(e,["functionCall"],a);const l=c(t,["codeExecutionResult"]);l!=null&&h(e,["codeExecutionResult"],l);const u=c(t,["executableCode"]);u!=null&&h(e,["executableCode"],u);const f=c(t,["functionResponse"]);f!=null&&h(e,["functionResponse"],f);const p=c(t,["text"]);return p!=null&&h(e,["text"],p),e}function Z1(t){const e={};if(c(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=c(t,["category"]);n!=null&&h(e,["category"],n);const r=c(t,["threshold"]);return r!=null&&h(e,["threshold"],r),e}function eN(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(f=>f)),h(e,["functionDeclarations"],u)}if(c(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=c(t,["googleSearch"]);r!=null&&h(e,["googleSearch"],z1(r));const i=c(t,["googleSearchRetrieval"]);if(i!=null&&h(e,["googleSearchRetrieval"],i),c(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=c(t,["googleMaps"]);s!=null&&h(e,["googleMaps"],G1(s));const o=c(t,["urlContext"]);o!=null&&h(e,["urlContext"],o);const a=c(t,["computerUse"]);a!=null&&h(e,["computerUse"],a);const l=c(t,["codeExecution"]);return l!=null&&h(e,["codeExecution"],l),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var eo;(function(t){t.PAGED_ITEM_BATCH_JOBS="batchJobs",t.PAGED_ITEM_MODELS="models",t.PAGED_ITEM_TUNING_JOBS="tuningJobs",t.PAGED_ITEM_FILES="files",t.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(eo||(eo={}));class zu{constructor(e,n,r,i){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(e,r,i)}init(e,n,r){var i,s;this.nameInternal=e,this.pageInternal=n[this.nameInternal]||[],this.sdkHttpResponseInternal=n==null?void 0:n.sdkHttpResponse,this.idxInternal=0;let o={config:{}};!r||Object.keys(r).length===0?o={config:{}}:typeof r=="object"?o=Object.assign({},r):o=r,o.config&&(o.config.pageToken=n.nextPageToken),this.paramsInternal=o,this.pageInternalSize=(s=(i=o.config)===null||i===void 0?void 0:i.pageSize)!==null&&s!==void 0?s:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class tN extends ho{constructor(e){super(),this.apiClient=e,this.create=async n=>(this.apiClient.isVertexAI()&&(n.config=this.formatDestination(n.src,n.config)),this.createInternal(n)),this.createEmbeddings=async n=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(n)},this.list=async(n={})=>new zu(eo.PAGED_ITEM_BATCH_JOBS,r=>this.listInternal(r),await this.listInternal(n),n)}createInlinedGenerateContentRequest(e){const n=DT(this.apiClient,e),r=n._url,i=ue("{model}:batchGenerateContent",r),a=n.batch.inputConfig.requests,l=a.requests,u=[];for(const f of l){const p=Object.assign({},f);if(p.systemInstruction){const g=p.systemInstruction;delete p.systemInstruction;const v=p.request;v.systemInstruction=g,p.request=v}u.push(p)}return a.requests=u,delete n.config,delete n._url,delete n._query,{path:i,body:n}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,n){const r=n?Object.assign({},n):{},i=Date.now().toString();if(r.displayName||(r.displayName=`genaiBatchJob_${i}`),r.dest===void 0){const s=this.getGcsUri(e),o=this.getBigqueryUri(e);if(s)s.endsWith(".jsonl")?r.dest=`${s.slice(0,-6)}/dest`:r.dest=`${s}_dest_${i}`;else if(o)r.dest=`${o}_dest_${i}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return r}async createInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=x1(this.apiClient,e);return a=ue("batchPredictionJobs",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>_m(f))}else{const u=DT(this.apiClient,e);return a=ue("{model}:batchGenerateContent",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>ld(f))}}async createEmbeddingsInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=P1(this.apiClient,e);return s=ue("{model}:asyncBatchEmbedContent",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>ld(l))}}async get(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=q1(this.apiClient,e);return a=ue("batchPredictionJobs/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>_m(f))}else{const u=B1(this.apiClient,e);return a=ue("batches/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>ld(f))}}async cancel(e){var n,r,i,s;let o="",a={};if(this.apiClient.isVertexAI()){const l=I1(this.apiClient,e);o=ue("batchPredictionJobs/{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}else{const l=E1(this.apiClient,e);o=ue("batches/{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal})}}async listInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=J1(e);return a=ue("batchPredictionJobs",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const p=Y1(f),g=new RT;return Object.assign(g,p),g})}else{const u=j1(e);return a=ue("batches",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const p=Q1(f),g=new RT;return Object.assign(g,p),g})}}async delete(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=N1(this.apiClient,e);return a=ue("batchPredictionJobs/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>b1(f))}else{const u=k1(this.apiClient,e);return a=ue("batches/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>D1(f))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function nN(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["data"]);n!=null&&h(e,["data"],n);const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function bT(t){const e={},n=c(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>wN(s))),h(e,["parts"],i)}const r=c(t,["role"]);return r!=null&&h(e,["role"],r),e}function rN(t,e){const n={},r=c(t,["ttl"]);e!==void 0&&r!=null&&h(e,["ttl"],r);const i=c(t,["expireTime"]);e!==void 0&&i!=null&&h(e,["expireTime"],i);const s=c(t,["displayName"]);e!==void 0&&s!=null&&h(e,["displayName"],s);const o=c(t,["contents"]);if(e!==void 0&&o!=null){let f=On(o);Array.isArray(f)&&(f=f.map(p=>bT(p))),h(e,["contents"],f)}const a=c(t,["systemInstruction"]);e!==void 0&&a!=null&&h(e,["systemInstruction"],bT(Qt(a)));const l=c(t,["tools"]);if(e!==void 0&&l!=null){let f=l;Array.isArray(f)&&(f=f.map(p=>SN(p))),h(e,["tools"],f)}const u=c(t,["toolConfig"]);if(e!==void 0&&u!=null&&h(e,["toolConfig"],u),c(t,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function iN(t,e){const n={},r=c(t,["ttl"]);e!==void 0&&r!=null&&h(e,["ttl"],r);const i=c(t,["expireTime"]);e!==void 0&&i!=null&&h(e,["expireTime"],i);const s=c(t,["displayName"]);e!==void 0&&s!=null&&h(e,["displayName"],s);const o=c(t,["contents"]);if(e!==void 0&&o!=null){let p=On(o);Array.isArray(p)&&(p=p.map(g=>g)),h(e,["contents"],p)}const a=c(t,["systemInstruction"]);e!==void 0&&a!=null&&h(e,["systemInstruction"],Qt(a));const l=c(t,["tools"]);if(e!==void 0&&l!=null){let p=l;Array.isArray(p)&&(p=p.map(g=>CN(g))),h(e,["tools"],p)}const u=c(t,["toolConfig"]);e!==void 0&&u!=null&&h(e,["toolConfig"],u);const f=c(t,["kmsKeyName"]);return e!==void 0&&f!=null&&h(e,["encryption_spec","kmsKeyName"],f),n}function sN(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["model"],fC(t,r));const i=c(e,["config"]);return i!=null&&rN(i,n),n}function oN(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["model"],fC(t,r));const i=c(e,["config"]);return i!=null&&iN(i,n),n}function aN(t,e){const n={},r=c(e,["name"]);return r!=null&&h(n,["_url","name"],ri(t,r)),n}function lN(t,e){const n={},r=c(e,["name"]);return r!=null&&h(n,["_url","name"],ri(t,r)),n}function uN(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&h(e,["sdkHttpResponse"],n),e}function cN(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&h(e,["sdkHttpResponse"],n),e}function dN(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["fileUri"]);n!=null&&h(e,["fileUri"],n);const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function hN(t){const e={};if(c(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=c(t,["description"]);n!=null&&h(e,["description"],n);const r=c(t,["name"]);r!=null&&h(e,["name"],r);const i=c(t,["parameters"]);i!=null&&h(e,["parameters"],i);const s=c(t,["parametersJsonSchema"]);s!=null&&h(e,["parametersJsonSchema"],s);const o=c(t,["response"]);o!=null&&h(e,["response"],o);const a=c(t,["responseJsonSchema"]);return a!=null&&h(e,["responseJsonSchema"],a),e}function fN(t,e){const n={},r=c(e,["name"]);return r!=null&&h(n,["_url","name"],ri(t,r)),n}function pN(t,e){const n={},r=c(e,["name"]);return r!=null&&h(n,["_url","name"],ri(t,r)),n}function mN(t){const e={};if(c(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=c(t,["enableWidget"]);return n!=null&&h(e,["enableWidget"],n),e}function gN(t){const e={},n=c(t,["timeRangeFilter"]);if(n!=null&&h(e,["timeRangeFilter"],n),c(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function _N(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&h(e,["_query","pageSize"],r);const i=c(t,["pageToken"]);return e!==void 0&&i!=null&&h(e,["_query","pageToken"],i),n}function yN(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&h(e,["_query","pageSize"],r);const i=c(t,["pageToken"]);return e!==void 0&&i!=null&&h(e,["_query","pageToken"],i),n}function vN(t){const e={},n=c(t,["config"]);return n!=null&&_N(n,e),e}function TN(t){const e={},n=c(t,["config"]);return n!=null&&yN(n,e),e}function EN(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=c(t,["cachedContents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),h(e,["cachedContents"],s)}return e}function IN(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=c(t,["cachedContents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),h(e,["cachedContents"],s)}return e}function wN(t){const e={},n=c(t,["videoMetadata"]);n!=null&&h(e,["videoMetadata"],n);const r=c(t,["thought"]);r!=null&&h(e,["thought"],r);const i=c(t,["inlineData"]);i!=null&&h(e,["inlineData"],nN(i));const s=c(t,["fileData"]);s!=null&&h(e,["fileData"],dN(s));const o=c(t,["thoughtSignature"]);o!=null&&h(e,["thoughtSignature"],o);const a=c(t,["functionCall"]);a!=null&&h(e,["functionCall"],a);const l=c(t,["codeExecutionResult"]);l!=null&&h(e,["codeExecutionResult"],l);const u=c(t,["executableCode"]);u!=null&&h(e,["executableCode"],u);const f=c(t,["functionResponse"]);f!=null&&h(e,["functionResponse"],f);const p=c(t,["text"]);return p!=null&&h(e,["text"],p),e}function SN(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(f=>f)),h(e,["functionDeclarations"],u)}if(c(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=c(t,["googleSearch"]);r!=null&&h(e,["googleSearch"],gN(r));const i=c(t,["googleSearchRetrieval"]);if(i!=null&&h(e,["googleSearchRetrieval"],i),c(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=c(t,["googleMaps"]);s!=null&&h(e,["googleMaps"],mN(s));const o=c(t,["urlContext"]);o!=null&&h(e,["urlContext"],o);const a=c(t,["computerUse"]);a!=null&&h(e,["computerUse"],a);const l=c(t,["codeExecution"]);return l!=null&&h(e,["codeExecution"],l),e}function CN(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let p=n;Array.isArray(p)&&(p=p.map(g=>hN(g))),h(e,["functionDeclarations"],p)}const r=c(t,["retrieval"]);r!=null&&h(e,["retrieval"],r);const i=c(t,["googleSearch"]);i!=null&&h(e,["googleSearch"],i);const s=c(t,["googleSearchRetrieval"]);s!=null&&h(e,["googleSearchRetrieval"],s);const o=c(t,["enterpriseWebSearch"]);o!=null&&h(e,["enterpriseWebSearch"],o);const a=c(t,["googleMaps"]);a!=null&&h(e,["googleMaps"],a);const l=c(t,["urlContext"]);l!=null&&h(e,["urlContext"],l);const u=c(t,["computerUse"]);u!=null&&h(e,["computerUse"],u);const f=c(t,["codeExecution"]);return f!=null&&h(e,["codeExecution"],f),e}function AN(t,e){const n={},r=c(t,["ttl"]);e!==void 0&&r!=null&&h(e,["ttl"],r);const i=c(t,["expireTime"]);return e!==void 0&&i!=null&&h(e,["expireTime"],i),n}function xN(t,e){const n={},r=c(t,["ttl"]);e!==void 0&&r!=null&&h(e,["ttl"],r);const i=c(t,["expireTime"]);return e!==void 0&&i!=null&&h(e,["expireTime"],i),n}function RN(t,e){const n={},r=c(e,["name"]);r!=null&&h(n,["_url","name"],ri(t,r));const i=c(e,["config"]);return i!=null&&AN(i,n),n}function PN(t,e){const n={},r=c(e,["name"]);r!=null&&h(n,["_url","name"],ri(t,r));const i=c(e,["config"]);return i!=null&&xN(i,n),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class kN extends ho{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new zu(eo.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(n),n)}async create(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=oN(this.apiClient,e);return a=ue("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>f)}else{const u=sN(this.apiClient,e);return a=ue("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>f)}}async get(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=pN(this.apiClient,e);return a=ue("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>f)}else{const u=fN(this.apiClient,e);return a=ue("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>f)}}async delete(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=lN(this.apiClient,e);return a=ue("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const p=cN(f),g=new AT;return Object.assign(g,p),g})}else{const u=aN(this.apiClient,e);return a=ue("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const p=uN(f),g=new AT;return Object.assign(g,p),g})}}async update(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=PN(this.apiClient,e);return a=ue("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>f)}else{const u=RN(this.apiClient,e);return a=ue("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>f)}}async listInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=TN(e);return a=ue("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const p=IN(f),g=new xT;return Object.assign(g,p),g})}else{const u=vN(e);return a=ue("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const p=EN(f),g=new xT;return Object.assign(g,p),g})}}}function MT(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function it(t){return this instanceof it?(this.v=t,this):new it(t)}function ha(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),i,s=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(v){return function(E){return Promise.resolve(E).then(v,p)}}function a(v,E){r[v]&&(i[v]=function(x){return new Promise(function(b,C){s.push([v,x,b,C])>1||l(v,x)})},E&&(i[v]=E(i[v])))}function l(v,E){try{u(r[v](E))}catch(x){g(s[0][3],x)}}function u(v){v.value instanceof it?Promise.resolve(v.value.v).then(f,p):g(s[0][2],v)}function f(v){l("next",v)}function p(v){l("throw",v)}function g(v,E){v(E),s.shift(),s.length&&l(s[0][0],s[0][1])}}function jl(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof MT=="function"?MT(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(s){n[s]=t[s]&&function(o){return new Promise(function(a,l){o=t[s](o),i(a,l,o.done,o.value)})}}function i(s,o,a,l){Promise.resolve(l).then(function(u){s({value:u,done:a})},o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function NN(t){var e;if(t.candidates==null||t.candidates.length===0)return!1;const n=(e=t.candidates[0])===null||e===void 0?void 0:e.content;return n===void 0?!1:AC(n)}function AC(t){if(t.parts===void 0||t.parts.length===0)return!1;for(const e of t.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function DN(t){if(t.length!==0){for(const e of t)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function VT(t){if(t===void 0||t.length===0)return[];const e=[],n=t.length;let r=0;for(;r<n;)if(t[r].role==="user")e.push(t[r]),r++;else{const i=[];let s=!0;for(;r<n&&t[r].role==="model";)i.push(t[r]),s&&!AC(t[r])&&(s=!1),r++;s?e.push(...i):e.pop()}return e}class bN{constructor(e,n){this.modelsModule=e,this.apiClient=n}create(e){return new MN(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class MN{constructor(e,n,r,i={},s=[]){this.apiClient=e,this.modelsModule=n,this.model=r,this.config=i,this.history=s,this.sendPromise=Promise.resolve(),DN(s)}async sendMessage(e){var n;await this.sendPromise;const r=Qt(e.message),i=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var s,o,a;const l=await i,u=(o=(s=l.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content,f=l.automaticFunctionCallingHistory,p=this.getHistory(!0).length;let g=[];f!=null&&(g=(a=f.slice(p))!==null&&a!==void 0?a:[]);const v=u?[u]:[];this.recordHistory(r,v,g)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),i}async sendMessageStream(e){var n;await this.sendPromise;const r=Qt(e.message),i=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});this.sendPromise=i.then(()=>{}).catch(()=>{});const s=await i;return this.processStreamResponse(s,r)}getHistory(e=!1){const n=e?VT(this.history):this.history;return structuredClone(n)}processStreamResponse(e,n){var r,i;return ha(this,arguments,function*(){var o,a,l,u;const f=[];try{for(var p=!0,g=jl(e),v;v=yield it(g.next()),o=v.done,!o;p=!0){u=v.value,p=!1;const E=u;if(NN(E)){const x=(i=(r=E.candidates)===null||r===void 0?void 0:r[0])===null||i===void 0?void 0:i.content;x!==void 0&&f.push(x)}yield yield it(E)}}catch(E){a={error:E}}finally{try{!p&&!o&&(l=g.return)&&(yield it(l.call(g)))}finally{if(a)throw a.error}}this.recordHistory(n,f)})}recordHistory(e,n,r){let i=[];n.length>0&&n.every(s=>s.role!==void 0)?i=n:i.push({role:"model",parts:[]}),r&&r.length>0?this.history.push(...VT(r)):this.history.push(e),this.history.push(...i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Bh extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,Bh.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function VN(t){const e={},n=c(t,["file"]);return n!=null&&h(e,["file"],n),e}function LN(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&h(e,["sdkHttpResponse"],n),e}function FN(t){const e={},n=c(t,["name"]);return n!=null&&h(e,["_url","file"],vC(n)),e}function UN(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&h(e,["sdkHttpResponse"],n),e}function ON(t){const e={},n=c(t,["name"]);return n!=null&&h(e,["_url","file"],vC(n)),e}function BN(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&h(e,["_query","pageSize"],r);const i=c(t,["pageToken"]);return e!==void 0&&i!=null&&h(e,["_query","pageToken"],i),n}function qN(t){const e={},n=c(t,["config"]);return n!=null&&BN(n,e),e}function GN(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=c(t,["files"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),h(e,["files"],s)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class zN extends ho{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new zu(eo.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(n),n)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(n=>n)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=qN(e);return s=ue("files",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>{const u=GN(l),f=new e1;return Object.assign(f,u),f})}}async createInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=VN(e);return s=ue("upload/v1beta/files",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=LN(l),f=new t1;return Object.assign(f,u),f})}}async get(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=ON(e);return s=ue("files/{file}",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>l)}}async delete(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=FN(e);return s=ue("files/{file}",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>{const u=UN(l),f=new n1;return Object.assign(f,u),f})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ud(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["data"]);n!=null&&h(e,["data"],n);const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function $N(t){const e={},n=c(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>sD(s))),h(e,["parts"],i)}const r=c(t,["role"]);return r!=null&&h(e,["role"],r),e}function HN(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["fileUri"]);n!=null&&h(e,["fileUri"],n);const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function WN(t){const e={};if(c(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=c(t,["description"]);n!=null&&h(e,["description"],n);const r=c(t,["name"]);r!=null&&h(e,["name"],r);const i=c(t,["parameters"]);i!=null&&h(e,["parameters"],i);const s=c(t,["parametersJsonSchema"]);s!=null&&h(e,["parametersJsonSchema"],s);const o=c(t,["response"]);o!=null&&h(e,["response"],o);const a=c(t,["responseJsonSchema"]);return a!=null&&h(e,["responseJsonSchema"],a),e}function KN(t){const e={},n=c(t,["modelSelectionConfig"]);n!=null&&h(e,["modelConfig"],n);const r=c(t,["audioTimestamp"]);r!=null&&h(e,["audioTimestamp"],r);const i=c(t,["candidateCount"]);i!=null&&h(e,["candidateCount"],i);const s=c(t,["enableAffectiveDialog"]);s!=null&&h(e,["enableAffectiveDialog"],s);const o=c(t,["frequencyPenalty"]);o!=null&&h(e,["frequencyPenalty"],o);const a=c(t,["logprobs"]);a!=null&&h(e,["logprobs"],a);const l=c(t,["maxOutputTokens"]);l!=null&&h(e,["maxOutputTokens"],l);const u=c(t,["mediaResolution"]);u!=null&&h(e,["mediaResolution"],u);const f=c(t,["presencePenalty"]);f!=null&&h(e,["presencePenalty"],f);const p=c(t,["responseJsonSchema"]);p!=null&&h(e,["responseJsonSchema"],p);const g=c(t,["responseLogprobs"]);g!=null&&h(e,["responseLogprobs"],g);const v=c(t,["responseMimeType"]);v!=null&&h(e,["responseMimeType"],v);const E=c(t,["responseModalities"]);E!=null&&h(e,["responseModalities"],E);const x=c(t,["responseSchema"]);x!=null&&h(e,["responseSchema"],x);const b=c(t,["routingConfig"]);b!=null&&h(e,["routingConfig"],b);const C=c(t,["seed"]);C!=null&&h(e,["seed"],C);const I=c(t,["speechConfig"]);I!=null&&h(e,["speechConfig"],xC(I));const S=c(t,["stopSequences"]);S!=null&&h(e,["stopSequences"],S);const V=c(t,["temperature"]);V!=null&&h(e,["temperature"],V);const U=c(t,["thinkingConfig"]);U!=null&&h(e,["thinkingConfig"],U);const B=c(t,["topK"]);B!=null&&h(e,["topK"],B);const T=c(t,["topP"]);return T!=null&&h(e,["topP"],T),e}function jN(t){const e={};if(c(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=c(t,["enableWidget"]);return n!=null&&h(e,["enableWidget"],n),e}function JN(t){const e={},n=c(t,["timeRangeFilter"]);if(n!=null&&h(e,["timeRangeFilter"],n),c(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function QN(t,e){const n={},r=c(t,["generationConfig"]);e!==void 0&&r!=null&&h(e,["setup","generationConfig"],r);const i=c(t,["responseModalities"]);e!==void 0&&i!=null&&h(e,["setup","generationConfig","responseModalities"],i);const s=c(t,["temperature"]);e!==void 0&&s!=null&&h(e,["setup","generationConfig","temperature"],s);const o=c(t,["topP"]);e!==void 0&&o!=null&&h(e,["setup","generationConfig","topP"],o);const a=c(t,["topK"]);e!==void 0&&a!=null&&h(e,["setup","generationConfig","topK"],a);const l=c(t,["maxOutputTokens"]);e!==void 0&&l!=null&&h(e,["setup","generationConfig","maxOutputTokens"],l);const u=c(t,["mediaResolution"]);e!==void 0&&u!=null&&h(e,["setup","generationConfig","mediaResolution"],u);const f=c(t,["seed"]);e!==void 0&&f!=null&&h(e,["setup","generationConfig","seed"],f);const p=c(t,["speechConfig"]);e!==void 0&&p!=null&&h(e,["setup","generationConfig","speechConfig"],i_(p));const g=c(t,["thinkingConfig"]);e!==void 0&&g!=null&&h(e,["setup","generationConfig","thinkingConfig"],g);const v=c(t,["enableAffectiveDialog"]);e!==void 0&&v!=null&&h(e,["setup","generationConfig","enableAffectiveDialog"],v);const E=c(t,["systemInstruction"]);e!==void 0&&E!=null&&h(e,["setup","systemInstruction"],$N(Qt(E)));const x=c(t,["tools"]);if(e!==void 0&&x!=null){let B=Ha(x);Array.isArray(B)&&(B=B.map(T=>aD($a(T)))),h(e,["setup","tools"],B)}const b=c(t,["sessionResumption"]);e!==void 0&&b!=null&&h(e,["setup","sessionResumption"],oD(b));const C=c(t,["inputAudioTranscription"]);e!==void 0&&C!=null&&h(e,["setup","inputAudioTranscription"],C);const I=c(t,["outputAudioTranscription"]);e!==void 0&&I!=null&&h(e,["setup","outputAudioTranscription"],I);const S=c(t,["realtimeInputConfig"]);e!==void 0&&S!=null&&h(e,["setup","realtimeInputConfig"],S);const V=c(t,["contextWindowCompression"]);e!==void 0&&V!=null&&h(e,["setup","contextWindowCompression"],V);const U=c(t,["proactivity"]);return e!==void 0&&U!=null&&h(e,["setup","proactivity"],U),n}function YN(t,e){const n={},r=c(t,["generationConfig"]);e!==void 0&&r!=null&&h(e,["setup","generationConfig"],KN(r));const i=c(t,["responseModalities"]);e!==void 0&&i!=null&&h(e,["setup","generationConfig","responseModalities"],i);const s=c(t,["temperature"]);e!==void 0&&s!=null&&h(e,["setup","generationConfig","temperature"],s);const o=c(t,["topP"]);e!==void 0&&o!=null&&h(e,["setup","generationConfig","topP"],o);const a=c(t,["topK"]);e!==void 0&&a!=null&&h(e,["setup","generationConfig","topK"],a);const l=c(t,["maxOutputTokens"]);e!==void 0&&l!=null&&h(e,["setup","generationConfig","maxOutputTokens"],l);const u=c(t,["mediaResolution"]);e!==void 0&&u!=null&&h(e,["setup","generationConfig","mediaResolution"],u);const f=c(t,["seed"]);e!==void 0&&f!=null&&h(e,["setup","generationConfig","seed"],f);const p=c(t,["speechConfig"]);e!==void 0&&p!=null&&h(e,["setup","generationConfig","speechConfig"],xC(i_(p)));const g=c(t,["thinkingConfig"]);e!==void 0&&g!=null&&h(e,["setup","generationConfig","thinkingConfig"],g);const v=c(t,["enableAffectiveDialog"]);e!==void 0&&v!=null&&h(e,["setup","generationConfig","enableAffectiveDialog"],v);const E=c(t,["systemInstruction"]);e!==void 0&&E!=null&&h(e,["setup","systemInstruction"],Qt(E));const x=c(t,["tools"]);if(e!==void 0&&x!=null){let B=Ha(x);Array.isArray(B)&&(B=B.map(T=>lD($a(T)))),h(e,["setup","tools"],B)}const b=c(t,["sessionResumption"]);e!==void 0&&b!=null&&h(e,["setup","sessionResumption"],b);const C=c(t,["inputAudioTranscription"]);e!==void 0&&C!=null&&h(e,["setup","inputAudioTranscription"],C);const I=c(t,["outputAudioTranscription"]);e!==void 0&&I!=null&&h(e,["setup","outputAudioTranscription"],I);const S=c(t,["realtimeInputConfig"]);e!==void 0&&S!=null&&h(e,["setup","realtimeInputConfig"],S);const V=c(t,["contextWindowCompression"]);e!==void 0&&V!=null&&h(e,["setup","contextWindowCompression"],V);const U=c(t,["proactivity"]);return e!==void 0&&U!=null&&h(e,["setup","proactivity"],U),n}function XN(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["setup","model"],qe(t,r));const i=c(e,["config"]);return i!=null&&h(n,["config"],QN(i,n)),n}function ZN(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["setup","model"],qe(t,r));const i=c(e,["config"]);return i!=null&&h(n,["config"],YN(i,n)),n}function eD(t){const e={},n=c(t,["musicGenerationConfig"]);return n!=null&&h(e,["musicGenerationConfig"],n),e}function tD(t){const e={},n=c(t,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>i)),h(e,["weightedPrompts"],r)}return e}function nD(t){const e={},n=c(t,["media"]);if(n!=null){let u=pC(n);Array.isArray(u)&&(u=u.map(f=>ud(f))),h(e,["mediaChunks"],u)}const r=c(t,["audio"]);r!=null&&h(e,["audio"],ud(gC(r)));const i=c(t,["audioStreamEnd"]);i!=null&&h(e,["audioStreamEnd"],i);const s=c(t,["video"]);s!=null&&h(e,["video"],ud(mC(s)));const o=c(t,["text"]);o!=null&&h(e,["text"],o);const a=c(t,["activityStart"]);a!=null&&h(e,["activityStart"],a);const l=c(t,["activityEnd"]);return l!=null&&h(e,["activityEnd"],l),e}function rD(t){const e={},n=c(t,["media"]);if(n!=null){let u=pC(n);Array.isArray(u)&&(u=u.map(f=>f)),h(e,["mediaChunks"],u)}const r=c(t,["audio"]);r!=null&&h(e,["audio"],gC(r));const i=c(t,["audioStreamEnd"]);i!=null&&h(e,["audioStreamEnd"],i);const s=c(t,["video"]);s!=null&&h(e,["video"],mC(s));const o=c(t,["text"]);o!=null&&h(e,["text"],o);const a=c(t,["activityStart"]);a!=null&&h(e,["activityStart"],a);const l=c(t,["activityEnd"]);return l!=null&&h(e,["activityEnd"],l),e}function iD(t){const e={},n=c(t,["setupComplete"]);n!=null&&h(e,["setupComplete"],n);const r=c(t,["serverContent"]);r!=null&&h(e,["serverContent"],r);const i=c(t,["toolCall"]);i!=null&&h(e,["toolCall"],i);const s=c(t,["toolCallCancellation"]);s!=null&&h(e,["toolCallCancellation"],s);const o=c(t,["usageMetadata"]);o!=null&&h(e,["usageMetadata"],uD(o));const a=c(t,["goAway"]);a!=null&&h(e,["goAway"],a);const l=c(t,["sessionResumptionUpdate"]);return l!=null&&h(e,["sessionResumptionUpdate"],l),e}function sD(t){const e={},n=c(t,["videoMetadata"]);n!=null&&h(e,["videoMetadata"],n);const r=c(t,["thought"]);r!=null&&h(e,["thought"],r);const i=c(t,["inlineData"]);i!=null&&h(e,["inlineData"],ud(i));const s=c(t,["fileData"]);s!=null&&h(e,["fileData"],HN(s));const o=c(t,["thoughtSignature"]);o!=null&&h(e,["thoughtSignature"],o);const a=c(t,["functionCall"]);a!=null&&h(e,["functionCall"],a);const l=c(t,["codeExecutionResult"]);l!=null&&h(e,["codeExecutionResult"],l);const u=c(t,["executableCode"]);u!=null&&h(e,["executableCode"],u);const f=c(t,["functionResponse"]);f!=null&&h(e,["functionResponse"],f);const p=c(t,["text"]);return p!=null&&h(e,["text"],p),e}function oD(t){const e={},n=c(t,["handle"]);if(n!=null&&h(e,["handle"],n),c(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function xC(t){const e={},n=c(t,["voiceConfig"]);if(n!=null&&h(e,["voiceConfig"],n),c(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const r=c(t,["languageCode"]);return r!=null&&h(e,["languageCode"],r),e}function aD(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(f=>f)),h(e,["functionDeclarations"],u)}if(c(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=c(t,["googleSearch"]);r!=null&&h(e,["googleSearch"],JN(r));const i=c(t,["googleSearchRetrieval"]);if(i!=null&&h(e,["googleSearchRetrieval"],i),c(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=c(t,["googleMaps"]);s!=null&&h(e,["googleMaps"],jN(s));const o=c(t,["urlContext"]);o!=null&&h(e,["urlContext"],o);const a=c(t,["computerUse"]);a!=null&&h(e,["computerUse"],a);const l=c(t,["codeExecution"]);return l!=null&&h(e,["codeExecution"],l),e}function lD(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let p=n;Array.isArray(p)&&(p=p.map(g=>WN(g))),h(e,["functionDeclarations"],p)}const r=c(t,["retrieval"]);r!=null&&h(e,["retrieval"],r);const i=c(t,["googleSearch"]);i!=null&&h(e,["googleSearch"],i);const s=c(t,["googleSearchRetrieval"]);s!=null&&h(e,["googleSearchRetrieval"],s);const o=c(t,["enterpriseWebSearch"]);o!=null&&h(e,["enterpriseWebSearch"],o);const a=c(t,["googleMaps"]);a!=null&&h(e,["googleMaps"],a);const l=c(t,["urlContext"]);l!=null&&h(e,["urlContext"],l);const u=c(t,["computerUse"]);u!=null&&h(e,["computerUse"],u);const f=c(t,["codeExecution"]);return f!=null&&h(e,["codeExecution"],f),e}function uD(t){const e={},n=c(t,["promptTokenCount"]);n!=null&&h(e,["promptTokenCount"],n);const r=c(t,["cachedContentTokenCount"]);r!=null&&h(e,["cachedContentTokenCount"],r);const i=c(t,["candidatesTokenCount"]);i!=null&&h(e,["responseTokenCount"],i);const s=c(t,["toolUsePromptTokenCount"]);s!=null&&h(e,["toolUsePromptTokenCount"],s);const o=c(t,["thoughtsTokenCount"]);o!=null&&h(e,["thoughtsTokenCount"],o);const a=c(t,["totalTokenCount"]);a!=null&&h(e,["totalTokenCount"],a);const l=c(t,["promptTokensDetails"]);if(l!=null){let v=l;Array.isArray(v)&&(v=v.map(E=>E)),h(e,["promptTokensDetails"],v)}const u=c(t,["cacheTokensDetails"]);if(u!=null){let v=u;Array.isArray(v)&&(v=v.map(E=>E)),h(e,["cacheTokensDetails"],v)}const f=c(t,["candidatesTokensDetails"]);if(f!=null){let v=f;Array.isArray(v)&&(v=v.map(E=>E)),h(e,["responseTokensDetails"],v)}const p=c(t,["toolUsePromptTokensDetails"]);if(p!=null){let v=p;Array.isArray(v)&&(v=v.map(E=>E)),h(e,["toolUsePromptTokensDetails"],v)}const g=c(t,["trafficType"]);return g!=null&&h(e,["trafficType"],g),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function cD(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["data"]);n!=null&&h(e,["data"],n);const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function dD(t){const e={},n=c(t,["content"]);n!=null&&h(e,["content"],n);const r=c(t,["citationMetadata"]);r!=null&&h(e,["citationMetadata"],hD(r));const i=c(t,["tokenCount"]);i!=null&&h(e,["tokenCount"],i);const s=c(t,["finishReason"]);s!=null&&h(e,["finishReason"],s);const o=c(t,["urlContextMetadata"]);o!=null&&h(e,["urlContextMetadata"],o);const a=c(t,["avgLogprobs"]);a!=null&&h(e,["avgLogprobs"],a);const l=c(t,["groundingMetadata"]);l!=null&&h(e,["groundingMetadata"],l);const u=c(t,["index"]);u!=null&&h(e,["index"],u);const f=c(t,["logprobsResult"]);f!=null&&h(e,["logprobsResult"],f);const p=c(t,["safetyRatings"]);if(p!=null){let g=p;Array.isArray(g)&&(g=g.map(v=>v)),h(e,["safetyRatings"],g)}return e}function hD(t){const e={},n=c(t,["citationSources"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>i)),h(e,["citations"],r)}return e}function fD(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=c(e,["contents"]);if(i!=null){let s=On(i);Array.isArray(s)&&(s=s.map(o=>o)),h(n,["contents"],s)}return n}function pD(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["tokensInfo"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>s)),h(e,["tokensInfo"],i)}return e}function mD(t){const e={},n=c(t,["values"]);n!=null&&h(e,["values"],n);const r=c(t,["statistics"]);return r!=null&&h(e,["statistics"],gD(r)),e}function gD(t){const e={},n=c(t,["truncated"]);n!=null&&h(e,["truncated"],n);const r=c(t,["token_count"]);return r!=null&&h(e,["tokenCount"],r),e}function qh(t){const e={},n=c(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>Eb(s))),h(e,["parts"],i)}const r=c(t,["role"]);return r!=null&&h(e,["role"],r),e}function _D(t){const e={},n=c(t,["controlType"]);n!=null&&h(e,["controlType"],n);const r=c(t,["enableControlImageComputation"]);return r!=null&&h(e,["computeControl"],r),e}function yD(t){const e={};if(c(t,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(c(t,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(c(t,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function vD(t,e){const n={},r=c(t,["systemInstruction"]);e!==void 0&&r!=null&&h(e,["systemInstruction"],Qt(r));const i=c(t,["tools"]);if(e!==void 0&&i!=null){let o=i;Array.isArray(o)&&(o=o.map(a=>DC(a))),h(e,["tools"],o)}const s=c(t,["generationConfig"]);return e!==void 0&&s!=null&&h(e,["generationConfig"],lb(s)),n}function TD(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=c(e,["contents"]);if(i!=null){let o=On(i);Array.isArray(o)&&(o=o.map(a=>qh(a))),h(n,["contents"],o)}const s=c(e,["config"]);return s!=null&&yD(s),n}function ED(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=c(e,["contents"]);if(i!=null){let o=On(i);Array.isArray(o)&&(o=o.map(a=>a)),h(n,["contents"],o)}const s=c(e,["config"]);return s!=null&&vD(s,n),n}function ID(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["totalTokens"]);r!=null&&h(e,["totalTokens"],r);const i=c(t,["cachedContentTokenCount"]);return i!=null&&h(e,["cachedContentTokenCount"],i),e}function wD(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["totalTokens"]);return r!=null&&h(e,["totalTokens"],r),e}function SD(t,e){const n={},r=c(e,["model"]);return r!=null&&h(n,["_url","name"],qe(t,r)),n}function CD(t,e){const n={},r=c(e,["model"]);return r!=null&&h(n,["_url","name"],qe(t,r)),n}function AD(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&h(e,["sdkHttpResponse"],n),e}function xD(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&h(e,["sdkHttpResponse"],n),e}function RD(t,e){const n={},r=c(t,["outputGcsUri"]);e!==void 0&&r!=null&&h(e,["parameters","storageUri"],r);const i=c(t,["negativePrompt"]);e!==void 0&&i!=null&&h(e,["parameters","negativePrompt"],i);const s=c(t,["numberOfImages"]);e!==void 0&&s!=null&&h(e,["parameters","sampleCount"],s);const o=c(t,["aspectRatio"]);e!==void 0&&o!=null&&h(e,["parameters","aspectRatio"],o);const a=c(t,["guidanceScale"]);e!==void 0&&a!=null&&h(e,["parameters","guidanceScale"],a);const l=c(t,["seed"]);e!==void 0&&l!=null&&h(e,["parameters","seed"],l);const u=c(t,["safetyFilterLevel"]);e!==void 0&&u!=null&&h(e,["parameters","safetySetting"],u);const f=c(t,["personGeneration"]);e!==void 0&&f!=null&&h(e,["parameters","personGeneration"],f);const p=c(t,["includeSafetyAttributes"]);e!==void 0&&p!=null&&h(e,["parameters","includeSafetyAttributes"],p);const g=c(t,["includeRaiReason"]);e!==void 0&&g!=null&&h(e,["parameters","includeRaiReason"],g);const v=c(t,["language"]);e!==void 0&&v!=null&&h(e,["parameters","language"],v);const E=c(t,["outputMimeType"]);e!==void 0&&E!=null&&h(e,["parameters","outputOptions","mimeType"],E);const x=c(t,["outputCompressionQuality"]);e!==void 0&&x!=null&&h(e,["parameters","outputOptions","compressionQuality"],x);const b=c(t,["addWatermark"]);e!==void 0&&b!=null&&h(e,["parameters","addWatermark"],b);const C=c(t,["labels"]);e!==void 0&&C!=null&&h(e,["labels"],C);const I=c(t,["editMode"]);e!==void 0&&I!=null&&h(e,["parameters","editMode"],I);const S=c(t,["baseSteps"]);return e!==void 0&&S!=null&&h(e,["parameters","editConfig","baseSteps"],S),n}function PD(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=c(e,["prompt"]);i!=null&&h(n,["instances[0]","prompt"],i);const s=c(e,["referenceImages"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>xb(l))),h(n,["instances[0]","referenceImages"],a)}const o=c(e,["config"]);return o!=null&&RD(o,n),n}function kD(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>Gh(s))),h(e,["generatedImages"],i)}return e}function ND(t,e){const n={},r=c(t,["taskType"]);e!==void 0&&r!=null&&h(e,["requests[]","taskType"],r);const i=c(t,["title"]);e!==void 0&&i!=null&&h(e,["requests[]","title"],i);const s=c(t,["outputDimensionality"]);if(e!==void 0&&s!=null&&h(e,["requests[]","outputDimensionality"],s),c(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(c(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function DD(t,e){const n={},r=c(t,["taskType"]);e!==void 0&&r!=null&&h(e,["instances[]","task_type"],r);const i=c(t,["title"]);e!==void 0&&i!=null&&h(e,["instances[]","title"],i);const s=c(t,["outputDimensionality"]);e!==void 0&&s!=null&&h(e,["parameters","outputDimensionality"],s);const o=c(t,["mimeType"]);e!==void 0&&o!=null&&h(e,["instances[]","mimeType"],o);const a=c(t,["autoTruncate"]);return e!==void 0&&a!=null&&h(e,["parameters","autoTruncate"],a),n}function bD(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=c(e,["contents"]);if(i!=null){let a=t_(t,i);Array.isArray(a)&&(a=a.map(l=>l)),h(n,["requests[]","content"],a)}const s=c(e,["config"]);s!=null&&ND(s,n);const o=c(e,["model"]);return o!==void 0&&h(n,["requests[]","model"],qe(t,o)),n}function MD(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=c(e,["contents"]);if(i!=null){let o=t_(t,i);Array.isArray(o)&&(o=o.map(a=>a)),h(n,["instances[]","content"],o)}const s=c(e,["config"]);return s!=null&&DD(s,n),n}function VD(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["embeddings"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>o)),h(e,["embeddings"],s)}const i=c(t,["metadata"]);return i!=null&&h(e,["metadata"],i),e}function LD(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["predictions[]","embeddings"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>mD(o))),h(e,["embeddings"],s)}const i=c(t,["metadata"]);return i!=null&&h(e,["metadata"],i),e}function FD(t){const e={},n=c(t,["endpoint"]);n!=null&&h(e,["name"],n);const r=c(t,["deployedModelId"]);return r!=null&&h(e,["deployedModelId"],r),e}function UD(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["fileUri"]);n!=null&&h(e,["fileUri"],n);const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function OD(t){const e={};if(c(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=c(t,["description"]);n!=null&&h(e,["description"],n);const r=c(t,["name"]);r!=null&&h(e,["name"],r);const i=c(t,["parameters"]);i!=null&&h(e,["parameters"],i);const s=c(t,["parametersJsonSchema"]);s!=null&&h(e,["parametersJsonSchema"],s);const o=c(t,["response"]);o!=null&&h(e,["response"],o);const a=c(t,["responseJsonSchema"]);return a!=null&&h(e,["responseJsonSchema"],a),e}function BD(t,e,n){const r={},i=c(e,["systemInstruction"]);n!==void 0&&i!=null&&h(n,["systemInstruction"],qh(Qt(i)));const s=c(e,["temperature"]);s!=null&&h(r,["temperature"],s);const o=c(e,["topP"]);o!=null&&h(r,["topP"],o);const a=c(e,["topK"]);a!=null&&h(r,["topK"],a);const l=c(e,["candidateCount"]);l!=null&&h(r,["candidateCount"],l);const u=c(e,["maxOutputTokens"]);u!=null&&h(r,["maxOutputTokens"],u);const f=c(e,["stopSequences"]);f!=null&&h(r,["stopSequences"],f);const p=c(e,["responseLogprobs"]);p!=null&&h(r,["responseLogprobs"],p);const g=c(e,["logprobs"]);g!=null&&h(r,["logprobs"],g);const v=c(e,["presencePenalty"]);v!=null&&h(r,["presencePenalty"],v);const E=c(e,["frequencyPenalty"]);E!=null&&h(r,["frequencyPenalty"],E);const x=c(e,["seed"]);x!=null&&h(r,["seed"],x);const b=c(e,["responseMimeType"]);b!=null&&h(r,["responseMimeType"],b);const C=c(e,["responseSchema"]);C!=null&&h(r,["responseSchema"],n_(C));const I=c(e,["responseJsonSchema"]);if(I!=null&&h(r,["responseJsonSchema"],I),c(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(c(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const S=c(e,["safetySettings"]);if(n!==void 0&&S!=null){let L=S;Array.isArray(L)&&(L=L.map(N=>Rb(N))),h(n,["safetySettings"],L)}const V=c(e,["tools"]);if(n!==void 0&&V!=null){let L=Ha(V);Array.isArray(L)&&(L=L.map(N=>Mb($a(N)))),h(n,["tools"],L)}const U=c(e,["toolConfig"]);if(n!==void 0&&U!=null&&h(n,["toolConfig"],U),c(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const B=c(e,["cachedContent"]);n!==void 0&&B!=null&&h(n,["cachedContent"],ri(t,B));const T=c(e,["responseModalities"]);T!=null&&h(r,["responseModalities"],T);const w=c(e,["mediaResolution"]);w!=null&&h(r,["mediaResolution"],w);const A=c(e,["speechConfig"]);if(A!=null&&h(r,["speechConfig"],r_(A)),c(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const k=c(e,["thinkingConfig"]);k!=null&&h(r,["thinkingConfig"],k);const D=c(e,["imageConfig"]);return D!=null&&h(r,["imageConfig"],D),r}function qD(t,e,n){const r={},i=c(e,["systemInstruction"]);n!==void 0&&i!=null&&h(n,["systemInstruction"],Qt(i));const s=c(e,["temperature"]);s!=null&&h(r,["temperature"],s);const o=c(e,["topP"]);o!=null&&h(r,["topP"],o);const a=c(e,["topK"]);a!=null&&h(r,["topK"],a);const l=c(e,["candidateCount"]);l!=null&&h(r,["candidateCount"],l);const u=c(e,["maxOutputTokens"]);u!=null&&h(r,["maxOutputTokens"],u);const f=c(e,["stopSequences"]);f!=null&&h(r,["stopSequences"],f);const p=c(e,["responseLogprobs"]);p!=null&&h(r,["responseLogprobs"],p);const g=c(e,["logprobs"]);g!=null&&h(r,["logprobs"],g);const v=c(e,["presencePenalty"]);v!=null&&h(r,["presencePenalty"],v);const E=c(e,["frequencyPenalty"]);E!=null&&h(r,["frequencyPenalty"],E);const x=c(e,["seed"]);x!=null&&h(r,["seed"],x);const b=c(e,["responseMimeType"]);b!=null&&h(r,["responseMimeType"],b);const C=c(e,["responseSchema"]);C!=null&&h(r,["responseSchema"],n_(C));const I=c(e,["responseJsonSchema"]);I!=null&&h(r,["responseJsonSchema"],I);const S=c(e,["routingConfig"]);S!=null&&h(r,["routingConfig"],S);const V=c(e,["modelSelectionConfig"]);V!=null&&h(r,["modelConfig"],V);const U=c(e,["safetySettings"]);if(n!==void 0&&U!=null){let je=U;Array.isArray(je)&&(je=je.map(ye=>ye)),h(n,["safetySettings"],je)}const B=c(e,["tools"]);if(n!==void 0&&B!=null){let je=Ha(B);Array.isArray(je)&&(je=je.map(ye=>DC($a(ye)))),h(n,["tools"],je)}const T=c(e,["toolConfig"]);n!==void 0&&T!=null&&h(n,["toolConfig"],T);const w=c(e,["labels"]);n!==void 0&&w!=null&&h(n,["labels"],w);const A=c(e,["cachedContent"]);n!==void 0&&A!=null&&h(n,["cachedContent"],ri(t,A));const k=c(e,["responseModalities"]);k!=null&&h(r,["responseModalities"],k);const D=c(e,["mediaResolution"]);D!=null&&h(r,["mediaResolution"],D);const L=c(e,["speechConfig"]);L!=null&&h(r,["speechConfig"],NC(r_(L)));const N=c(e,["audioTimestamp"]);N!=null&&h(r,["audioTimestamp"],N);const Ve=c(e,["thinkingConfig"]);Ve!=null&&h(r,["thinkingConfig"],Ve);const Ze=c(e,["imageConfig"]);return Ze!=null&&h(r,["imageConfig"],Ze),r}function LT(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=c(e,["contents"]);if(i!=null){let o=On(i);Array.isArray(o)&&(o=o.map(a=>qh(a))),h(n,["contents"],o)}const s=c(e,["config"]);return s!=null&&h(n,["generationConfig"],BD(t,s,n)),n}function FT(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=c(e,["contents"]);if(i!=null){let o=On(i);Array.isArray(o)&&(o=o.map(a=>a)),h(n,["contents"],o)}const s=c(e,["config"]);return s!=null&&h(n,["generationConfig"],qD(t,s,n)),n}function UT(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["candidates"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(u=>dD(u))),h(e,["candidates"],l)}const i=c(t,["modelVersion"]);i!=null&&h(e,["modelVersion"],i);const s=c(t,["promptFeedback"]);s!=null&&h(e,["promptFeedback"],s);const o=c(t,["responseId"]);o!=null&&h(e,["responseId"],o);const a=c(t,["usageMetadata"]);return a!=null&&h(e,["usageMetadata"],a),e}function OT(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["candidates"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(f=>f)),h(e,["candidates"],u)}const i=c(t,["createTime"]);i!=null&&h(e,["createTime"],i);const s=c(t,["modelVersion"]);s!=null&&h(e,["modelVersion"],s);const o=c(t,["promptFeedback"]);o!=null&&h(e,["promptFeedback"],o);const a=c(t,["responseId"]);a!=null&&h(e,["responseId"],a);const l=c(t,["usageMetadata"]);return l!=null&&h(e,["usageMetadata"],l),e}function GD(t,e){const n={};if(c(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(c(t,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const r=c(t,["numberOfImages"]);e!==void 0&&r!=null&&h(e,["parameters","sampleCount"],r);const i=c(t,["aspectRatio"]);e!==void 0&&i!=null&&h(e,["parameters","aspectRatio"],i);const s=c(t,["guidanceScale"]);if(e!==void 0&&s!=null&&h(e,["parameters","guidanceScale"],s),c(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=c(t,["safetyFilterLevel"]);e!==void 0&&o!=null&&h(e,["parameters","safetySetting"],o);const a=c(t,["personGeneration"]);e!==void 0&&a!=null&&h(e,["parameters","personGeneration"],a);const l=c(t,["includeSafetyAttributes"]);e!==void 0&&l!=null&&h(e,["parameters","includeSafetyAttributes"],l);const u=c(t,["includeRaiReason"]);e!==void 0&&u!=null&&h(e,["parameters","includeRaiReason"],u);const f=c(t,["language"]);e!==void 0&&f!=null&&h(e,["parameters","language"],f);const p=c(t,["outputMimeType"]);e!==void 0&&p!=null&&h(e,["parameters","outputOptions","mimeType"],p);const g=c(t,["outputCompressionQuality"]);if(e!==void 0&&g!=null&&h(e,["parameters","outputOptions","compressionQuality"],g),c(t,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(c(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const v=c(t,["imageSize"]);if(e!==void 0&&v!=null&&h(e,["parameters","sampleImageSize"],v),c(t,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function zD(t,e){const n={},r=c(t,["outputGcsUri"]);e!==void 0&&r!=null&&h(e,["parameters","storageUri"],r);const i=c(t,["negativePrompt"]);e!==void 0&&i!=null&&h(e,["parameters","negativePrompt"],i);const s=c(t,["numberOfImages"]);e!==void 0&&s!=null&&h(e,["parameters","sampleCount"],s);const o=c(t,["aspectRatio"]);e!==void 0&&o!=null&&h(e,["parameters","aspectRatio"],o);const a=c(t,["guidanceScale"]);e!==void 0&&a!=null&&h(e,["parameters","guidanceScale"],a);const l=c(t,["seed"]);e!==void 0&&l!=null&&h(e,["parameters","seed"],l);const u=c(t,["safetyFilterLevel"]);e!==void 0&&u!=null&&h(e,["parameters","safetySetting"],u);const f=c(t,["personGeneration"]);e!==void 0&&f!=null&&h(e,["parameters","personGeneration"],f);const p=c(t,["includeSafetyAttributes"]);e!==void 0&&p!=null&&h(e,["parameters","includeSafetyAttributes"],p);const g=c(t,["includeRaiReason"]);e!==void 0&&g!=null&&h(e,["parameters","includeRaiReason"],g);const v=c(t,["language"]);e!==void 0&&v!=null&&h(e,["parameters","language"],v);const E=c(t,["outputMimeType"]);e!==void 0&&E!=null&&h(e,["parameters","outputOptions","mimeType"],E);const x=c(t,["outputCompressionQuality"]);e!==void 0&&x!=null&&h(e,["parameters","outputOptions","compressionQuality"],x);const b=c(t,["addWatermark"]);e!==void 0&&b!=null&&h(e,["parameters","addWatermark"],b);const C=c(t,["labels"]);e!==void 0&&C!=null&&h(e,["labels"],C);const I=c(t,["imageSize"]);e!==void 0&&I!=null&&h(e,["parameters","sampleImageSize"],I);const S=c(t,["enhancePrompt"]);return e!==void 0&&S!=null&&h(e,["parameters","enhancePrompt"],S),n}function $D(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=c(e,["prompt"]);i!=null&&h(n,["instances[0]","prompt"],i);const s=c(e,["config"]);return s!=null&&GD(s,n),n}function HD(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=c(e,["prompt"]);i!=null&&h(n,["instances[0]","prompt"],i);const s=c(e,["config"]);return s!=null&&zD(s,n),n}function WD(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>ib(o))),h(e,["generatedImages"],s)}const i=c(t,["positivePromptSafetyAttributes"]);return i!=null&&h(e,["positivePromptSafetyAttributes"],PC(i)),e}function KD(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>Gh(o))),h(e,["generatedImages"],s)}const i=c(t,["positivePromptSafetyAttributes"]);return i!=null&&h(e,["positivePromptSafetyAttributes"],kC(i)),e}function jD(t,e){const n={},r=c(t,["numberOfVideos"]);if(e!==void 0&&r!=null&&h(e,["parameters","sampleCount"],r),c(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(c(t,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const i=c(t,["durationSeconds"]);if(e!==void 0&&i!=null&&h(e,["parameters","durationSeconds"],i),c(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const s=c(t,["aspectRatio"]);e!==void 0&&s!=null&&h(e,["parameters","aspectRatio"],s);const o=c(t,["resolution"]);e!==void 0&&o!=null&&h(e,["parameters","resolution"],o);const a=c(t,["personGeneration"]);if(e!==void 0&&a!=null&&h(e,["parameters","personGeneration"],a),c(t,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const l=c(t,["negativePrompt"]);e!==void 0&&l!=null&&h(e,["parameters","negativePrompt"],l);const u=c(t,["enhancePrompt"]);if(e!==void 0&&u!=null&&h(e,["parameters","enhancePrompt"],u),c(t,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const f=c(t,["lastFrame"]);e!==void 0&&f!=null&&h(e,["instances[0]","lastFrame"],zh(f));const p=c(t,["referenceImages"]);if(e!==void 0&&p!=null){let g=p;Array.isArray(g)&&(g=g.map(v=>Kb(v))),h(e,["instances[0]","referenceImages"],g)}if(c(t,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(c(t,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return n}function JD(t,e){const n={},r=c(t,["numberOfVideos"]);e!==void 0&&r!=null&&h(e,["parameters","sampleCount"],r);const i=c(t,["outputGcsUri"]);e!==void 0&&i!=null&&h(e,["parameters","storageUri"],i);const s=c(t,["fps"]);e!==void 0&&s!=null&&h(e,["parameters","fps"],s);const o=c(t,["durationSeconds"]);e!==void 0&&o!=null&&h(e,["parameters","durationSeconds"],o);const a=c(t,["seed"]);e!==void 0&&a!=null&&h(e,["parameters","seed"],a);const l=c(t,["aspectRatio"]);e!==void 0&&l!=null&&h(e,["parameters","aspectRatio"],l);const u=c(t,["resolution"]);e!==void 0&&u!=null&&h(e,["parameters","resolution"],u);const f=c(t,["personGeneration"]);e!==void 0&&f!=null&&h(e,["parameters","personGeneration"],f);const p=c(t,["pubsubTopic"]);e!==void 0&&p!=null&&h(e,["parameters","pubsubTopic"],p);const g=c(t,["negativePrompt"]);e!==void 0&&g!=null&&h(e,["parameters","negativePrompt"],g);const v=c(t,["enhancePrompt"]);e!==void 0&&v!=null&&h(e,["parameters","enhancePrompt"],v);const E=c(t,["generateAudio"]);e!==void 0&&E!=null&&h(e,["parameters","generateAudio"],E);const x=c(t,["lastFrame"]);e!==void 0&&x!=null&&h(e,["instances[0]","lastFrame"],lr(x));const b=c(t,["referenceImages"]);if(e!==void 0&&b!=null){let S=b;Array.isArray(S)&&(S=S.map(V=>jb(V))),h(e,["instances[0]","referenceImages"],S)}const C=c(t,["mask"]);e!==void 0&&C!=null&&h(e,["instances[0]","mask"],Wb(C));const I=c(t,["compressionQuality"]);return e!==void 0&&I!=null&&h(e,["parameters","compressionQuality"],I),n}function QD(t){const e={},n=c(t,["name"]);n!=null&&h(e,["name"],n);const r=c(t,["metadata"]);r!=null&&h(e,["metadata"],r);const i=c(t,["done"]);i!=null&&h(e,["done"],i);const s=c(t,["error"]);s!=null&&h(e,["error"],s);const o=c(t,["response","generateVideoResponse"]);return o!=null&&h(e,["response"],eb(o)),e}function YD(t){const e={},n=c(t,["name"]);n!=null&&h(e,["name"],n);const r=c(t,["metadata"]);r!=null&&h(e,["metadata"],r);const i=c(t,["done"]);i!=null&&h(e,["done"],i);const s=c(t,["error"]);s!=null&&h(e,["error"],s);const o=c(t,["response"]);return o!=null&&h(e,["response"],tb(o)),e}function XD(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=c(e,["prompt"]);i!=null&&h(n,["instances[0]","prompt"],i);const s=c(e,["image"]);s!=null&&h(n,["instances[0]","image"],zh(s));const o=c(e,["video"]);o!=null&&h(n,["instances[0]","video"],bC(o));const a=c(e,["source"]);a!=null&&nb(a,n);const l=c(e,["config"]);return l!=null&&jD(l,n),n}function ZD(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=c(e,["prompt"]);i!=null&&h(n,["instances[0]","prompt"],i);const s=c(e,["image"]);s!=null&&h(n,["instances[0]","image"],lr(s));const o=c(e,["video"]);o!=null&&h(n,["instances[0]","video"],MC(o));const a=c(e,["source"]);a!=null&&rb(a,n);const l=c(e,["config"]);return l!=null&&JD(l,n),n}function eb(t){const e={},n=c(t,["generatedSamples"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>ob(o))),h(e,["generatedVideos"],s)}const r=c(t,["raiMediaFilteredCount"]);r!=null&&h(e,["raiMediaFilteredCount"],r);const i=c(t,["raiMediaFilteredReasons"]);return i!=null&&h(e,["raiMediaFilteredReasons"],i),e}function tb(t){const e={},n=c(t,["videos"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>ab(o))),h(e,["generatedVideos"],s)}const r=c(t,["raiMediaFilteredCount"]);r!=null&&h(e,["raiMediaFilteredCount"],r);const i=c(t,["raiMediaFilteredReasons"]);return i!=null&&h(e,["raiMediaFilteredReasons"],i),e}function nb(t,e){const n={},r=c(t,["prompt"]);e!==void 0&&r!=null&&h(e,["instances[0]","prompt"],r);const i=c(t,["image"]);e!==void 0&&i!=null&&h(e,["instances[0]","image"],zh(i));const s=c(t,["video"]);return e!==void 0&&s!=null&&h(e,["instances[0]","video"],bC(s)),n}function rb(t,e){const n={},r=c(t,["prompt"]);e!==void 0&&r!=null&&h(e,["instances[0]","prompt"],r);const i=c(t,["image"]);e!==void 0&&i!=null&&h(e,["instances[0]","image"],lr(i));const s=c(t,["video"]);return e!==void 0&&s!=null&&h(e,["instances[0]","video"],MC(s)),n}function ib(t){const e={},n=c(t,["_self"]);n!=null&&h(e,["image"],fb(n));const r=c(t,["raiFilteredReason"]);r!=null&&h(e,["raiFilteredReason"],r);const i=c(t,["_self"]);return i!=null&&h(e,["safetyAttributes"],PC(i)),e}function Gh(t){const e={},n=c(t,["_self"]);n!=null&&h(e,["image"],RC(n));const r=c(t,["raiFilteredReason"]);r!=null&&h(e,["raiFilteredReason"],r);const i=c(t,["_self"]);i!=null&&h(e,["safetyAttributes"],kC(i));const s=c(t,["prompt"]);return s!=null&&h(e,["enhancedPrompt"],s),e}function sb(t){const e={},n=c(t,["_self"]);n!=null&&h(e,["mask"],RC(n));const r=c(t,["labels"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>s)),h(e,["labels"],i)}return e}function ob(t){const e={},n=c(t,["video"]);return n!=null&&h(e,["video"],$b(n)),e}function ab(t){const e={},n=c(t,["_self"]);return n!=null&&h(e,["video"],Hb(n)),e}function lb(t){const e={},n=c(t,["modelSelectionConfig"]);n!=null&&h(e,["modelConfig"],n);const r=c(t,["audioTimestamp"]);r!=null&&h(e,["audioTimestamp"],r);const i=c(t,["candidateCount"]);i!=null&&h(e,["candidateCount"],i);const s=c(t,["enableAffectiveDialog"]);s!=null&&h(e,["enableAffectiveDialog"],s);const o=c(t,["frequencyPenalty"]);o!=null&&h(e,["frequencyPenalty"],o);const a=c(t,["logprobs"]);a!=null&&h(e,["logprobs"],a);const l=c(t,["maxOutputTokens"]);l!=null&&h(e,["maxOutputTokens"],l);const u=c(t,["mediaResolution"]);u!=null&&h(e,["mediaResolution"],u);const f=c(t,["presencePenalty"]);f!=null&&h(e,["presencePenalty"],f);const p=c(t,["responseJsonSchema"]);p!=null&&h(e,["responseJsonSchema"],p);const g=c(t,["responseLogprobs"]);g!=null&&h(e,["responseLogprobs"],g);const v=c(t,["responseMimeType"]);v!=null&&h(e,["responseMimeType"],v);const E=c(t,["responseModalities"]);E!=null&&h(e,["responseModalities"],E);const x=c(t,["responseSchema"]);x!=null&&h(e,["responseSchema"],x);const b=c(t,["routingConfig"]);b!=null&&h(e,["routingConfig"],b);const C=c(t,["seed"]);C!=null&&h(e,["seed"],C);const I=c(t,["speechConfig"]);I!=null&&h(e,["speechConfig"],NC(I));const S=c(t,["stopSequences"]);S!=null&&h(e,["stopSequences"],S);const V=c(t,["temperature"]);V!=null&&h(e,["temperature"],V);const U=c(t,["thinkingConfig"]);U!=null&&h(e,["thinkingConfig"],U);const B=c(t,["topK"]);B!=null&&h(e,["topK"],B);const T=c(t,["topP"]);return T!=null&&h(e,["topP"],T),e}function ub(t,e){const n={},r=c(e,["model"]);return r!=null&&h(n,["_url","name"],qe(t,r)),n}function cb(t,e){const n={},r=c(e,["model"]);return r!=null&&h(n,["_url","name"],qe(t,r)),n}function db(t){const e={};if(c(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=c(t,["enableWidget"]);return n!=null&&h(e,["enableWidget"],n),e}function hb(t){const e={},n=c(t,["timeRangeFilter"]);if(n!=null&&h(e,["timeRangeFilter"],n),c(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function fb(t){const e={},n=c(t,["bytesBase64Encoded"]);n!=null&&h(e,["imageBytes"],is(n));const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function RC(t){const e={},n=c(t,["gcsUri"]);n!=null&&h(e,["gcsUri"],n);const r=c(t,["bytesBase64Encoded"]);r!=null&&h(e,["imageBytes"],is(r));const i=c(t,["mimeType"]);return i!=null&&h(e,["mimeType"],i),e}function zh(t){const e={};if(c(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=c(t,["imageBytes"]);n!=null&&h(e,["bytesBase64Encoded"],is(n));const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function lr(t){const e={},n=c(t,["gcsUri"]);n!=null&&h(e,["gcsUri"],n);const r=c(t,["imageBytes"]);r!=null&&h(e,["bytesBase64Encoded"],is(r));const i=c(t,["mimeType"]);return i!=null&&h(e,["mimeType"],i),e}function pb(t,e,n){const r={},i=c(e,["pageSize"]);n!==void 0&&i!=null&&h(n,["_query","pageSize"],i);const s=c(e,["pageToken"]);n!==void 0&&s!=null&&h(n,["_query","pageToken"],s);const o=c(e,["filter"]);n!==void 0&&o!=null&&h(n,["_query","filter"],o);const a=c(e,["queryBase"]);return n!==void 0&&a!=null&&h(n,["_url","models_url"],TC(t,a)),r}function mb(t,e,n){const r={},i=c(e,["pageSize"]);n!==void 0&&i!=null&&h(n,["_query","pageSize"],i);const s=c(e,["pageToken"]);n!==void 0&&s!=null&&h(n,["_query","pageToken"],s);const o=c(e,["filter"]);n!==void 0&&o!=null&&h(n,["_query","filter"],o);const a=c(e,["queryBase"]);return n!==void 0&&a!=null&&h(n,["_url","models_url"],TC(t,a)),r}function gb(t,e){const n={},r=c(e,["config"]);return r!=null&&pb(t,r,n),n}function _b(t,e){const n={},r=c(e,["config"]);return r!=null&&mb(t,r,n),n}function yb(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=c(t,["_self"]);if(i!=null){let s=EC(i);Array.isArray(s)&&(s=s.map(o=>ym(o))),h(e,["models"],s)}return e}function vb(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=c(t,["_self"]);if(i!=null){let s=EC(i);Array.isArray(s)&&(s=s.map(o=>vm(o))),h(e,["models"],s)}return e}function Tb(t){const e={},n=c(t,["maskMode"]);n!=null&&h(e,["maskMode"],n);const r=c(t,["segmentationClasses"]);r!=null&&h(e,["maskClasses"],r);const i=c(t,["maskDilation"]);return i!=null&&h(e,["dilation"],i),e}function ym(t){const e={},n=c(t,["name"]);n!=null&&h(e,["name"],n);const r=c(t,["displayName"]);r!=null&&h(e,["displayName"],r);const i=c(t,["description"]);i!=null&&h(e,["description"],i);const s=c(t,["version"]);s!=null&&h(e,["version"],s);const o=c(t,["_self"]);o!=null&&h(e,["tunedModelInfo"],Vb(o));const a=c(t,["inputTokenLimit"]);a!=null&&h(e,["inputTokenLimit"],a);const l=c(t,["outputTokenLimit"]);l!=null&&h(e,["outputTokenLimit"],l);const u=c(t,["supportedGenerationMethods"]);return u!=null&&h(e,["supportedActions"],u),e}function vm(t){const e={},n=c(t,["name"]);n!=null&&h(e,["name"],n);const r=c(t,["displayName"]);r!=null&&h(e,["displayName"],r);const i=c(t,["description"]);i!=null&&h(e,["description"],i);const s=c(t,["versionId"]);s!=null&&h(e,["version"],s);const o=c(t,["deployedModels"]);if(o!=null){let p=o;Array.isArray(p)&&(p=p.map(g=>FD(g))),h(e,["endpoints"],p)}const a=c(t,["labels"]);a!=null&&h(e,["labels"],a);const l=c(t,["_self"]);l!=null&&h(e,["tunedModelInfo"],Lb(l));const u=c(t,["defaultCheckpointId"]);u!=null&&h(e,["defaultCheckpointId"],u);const f=c(t,["checkpoints"]);if(f!=null){let p=f;Array.isArray(p)&&(p=p.map(g=>g)),h(e,["checkpoints"],p)}return e}function Eb(t){const e={},n=c(t,["videoMetadata"]);n!=null&&h(e,["videoMetadata"],n);const r=c(t,["thought"]);r!=null&&h(e,["thought"],r);const i=c(t,["inlineData"]);i!=null&&h(e,["inlineData"],cD(i));const s=c(t,["fileData"]);s!=null&&h(e,["fileData"],UD(s));const o=c(t,["thoughtSignature"]);o!=null&&h(e,["thoughtSignature"],o);const a=c(t,["functionCall"]);a!=null&&h(e,["functionCall"],a);const l=c(t,["codeExecutionResult"]);l!=null&&h(e,["codeExecutionResult"],l);const u=c(t,["executableCode"]);u!=null&&h(e,["executableCode"],u);const f=c(t,["functionResponse"]);f!=null&&h(e,["functionResponse"],f);const p=c(t,["text"]);return p!=null&&h(e,["text"],p),e}function Ib(t){const e={},n=c(t,["productImage"]);return n!=null&&h(e,["image"],lr(n)),e}function wb(t,e){const n={},r=c(t,["numberOfImages"]);e!==void 0&&r!=null&&h(e,["parameters","sampleCount"],r);const i=c(t,["baseSteps"]);e!==void 0&&i!=null&&h(e,["parameters","editConfig","baseSteps"],i);const s=c(t,["outputGcsUri"]);e!==void 0&&s!=null&&h(e,["parameters","storageUri"],s);const o=c(t,["seed"]);e!==void 0&&o!=null&&h(e,["parameters","seed"],o);const a=c(t,["safetyFilterLevel"]);e!==void 0&&a!=null&&h(e,["parameters","safetySetting"],a);const l=c(t,["personGeneration"]);e!==void 0&&l!=null&&h(e,["parameters","personGeneration"],l);const u=c(t,["addWatermark"]);e!==void 0&&u!=null&&h(e,["parameters","addWatermark"],u);const f=c(t,["outputMimeType"]);e!==void 0&&f!=null&&h(e,["parameters","outputOptions","mimeType"],f);const p=c(t,["outputCompressionQuality"]);e!==void 0&&p!=null&&h(e,["parameters","outputOptions","compressionQuality"],p);const g=c(t,["enhancePrompt"]);e!==void 0&&g!=null&&h(e,["parameters","enhancePrompt"],g);const v=c(t,["labels"]);return e!==void 0&&v!=null&&h(e,["labels"],v),n}function Sb(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=c(e,["source"]);i!=null&&Ab(i,n);const s=c(e,["config"]);return s!=null&&wb(s,n),n}function Cb(t){const e={},n=c(t,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>Gh(i))),h(e,["generatedImages"],r)}return e}function Ab(t,e){const n={},r=c(t,["prompt"]);e!==void 0&&r!=null&&h(e,["instances[0]","prompt"],r);const i=c(t,["personImage"]);e!==void 0&&i!=null&&h(e,["instances[0]","personImage","image"],lr(i));const s=c(t,["productImages"]);if(e!==void 0&&s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>Ib(a))),h(e,["instances[0]","productImages"],o)}return n}function xb(t){const e={},n=c(t,["referenceImage"]);n!=null&&h(e,["referenceImage"],lr(n));const r=c(t,["referenceId"]);r!=null&&h(e,["referenceId"],r);const i=c(t,["referenceType"]);i!=null&&h(e,["referenceType"],i);const s=c(t,["maskImageConfig"]);s!=null&&h(e,["maskImageConfig"],Tb(s));const o=c(t,["controlImageConfig"]);o!=null&&h(e,["controlImageConfig"],_D(o));const a=c(t,["styleImageConfig"]);a!=null&&h(e,["styleImageConfig"],a);const l=c(t,["subjectImageConfig"]);return l!=null&&h(e,["subjectImageConfig"],l),e}function PC(t){const e={},n=c(t,["safetyAttributes","categories"]);n!=null&&h(e,["categories"],n);const r=c(t,["safetyAttributes","scores"]);r!=null&&h(e,["scores"],r);const i=c(t,["contentType"]);return i!=null&&h(e,["contentType"],i),e}function kC(t){const e={},n=c(t,["safetyAttributes","categories"]);n!=null&&h(e,["categories"],n);const r=c(t,["safetyAttributes","scores"]);r!=null&&h(e,["scores"],r);const i=c(t,["contentType"]);return i!=null&&h(e,["contentType"],i),e}function Rb(t){const e={};if(c(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=c(t,["category"]);n!=null&&h(e,["category"],n);const r=c(t,["threshold"]);return r!=null&&h(e,["threshold"],r),e}function Pb(t){const e={},n=c(t,["image"]);return n!=null&&h(e,["image"],lr(n)),e}function kb(t,e){const n={},r=c(t,["mode"]);e!==void 0&&r!=null&&h(e,["parameters","mode"],r);const i=c(t,["maxPredictions"]);e!==void 0&&i!=null&&h(e,["parameters","maxPredictions"],i);const s=c(t,["confidenceThreshold"]);e!==void 0&&s!=null&&h(e,["parameters","confidenceThreshold"],s);const o=c(t,["maskDilation"]);e!==void 0&&o!=null&&h(e,["parameters","maskDilation"],o);const a=c(t,["binaryColorThreshold"]);e!==void 0&&a!=null&&h(e,["parameters","binaryColorThreshold"],a);const l=c(t,["labels"]);return e!==void 0&&l!=null&&h(e,["labels"],l),n}function Nb(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=c(e,["source"]);i!=null&&bb(i,n);const s=c(e,["config"]);return s!=null&&kb(s,n),n}function Db(t){const e={},n=c(t,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>sb(i))),h(e,["generatedMasks"],r)}return e}function bb(t,e){const n={},r=c(t,["prompt"]);e!==void 0&&r!=null&&h(e,["instances[0]","prompt"],r);const i=c(t,["image"]);e!==void 0&&i!=null&&h(e,["instances[0]","image"],lr(i));const s=c(t,["scribbleImage"]);return e!==void 0&&s!=null&&h(e,["instances[0]","scribble"],Pb(s)),n}function NC(t){const e={},n=c(t,["voiceConfig"]);if(n!=null&&h(e,["voiceConfig"],n),c(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const r=c(t,["languageCode"]);return r!=null&&h(e,["languageCode"],r),e}function Mb(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(f=>f)),h(e,["functionDeclarations"],u)}if(c(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=c(t,["googleSearch"]);r!=null&&h(e,["googleSearch"],hb(r));const i=c(t,["googleSearchRetrieval"]);if(i!=null&&h(e,["googleSearchRetrieval"],i),c(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=c(t,["googleMaps"]);s!=null&&h(e,["googleMaps"],db(s));const o=c(t,["urlContext"]);o!=null&&h(e,["urlContext"],o);const a=c(t,["computerUse"]);a!=null&&h(e,["computerUse"],a);const l=c(t,["codeExecution"]);return l!=null&&h(e,["codeExecution"],l),e}function DC(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let p=n;Array.isArray(p)&&(p=p.map(g=>OD(g))),h(e,["functionDeclarations"],p)}const r=c(t,["retrieval"]);r!=null&&h(e,["retrieval"],r);const i=c(t,["googleSearch"]);i!=null&&h(e,["googleSearch"],i);const s=c(t,["googleSearchRetrieval"]);s!=null&&h(e,["googleSearchRetrieval"],s);const o=c(t,["enterpriseWebSearch"]);o!=null&&h(e,["enterpriseWebSearch"],o);const a=c(t,["googleMaps"]);a!=null&&h(e,["googleMaps"],a);const l=c(t,["urlContext"]);l!=null&&h(e,["urlContext"],l);const u=c(t,["computerUse"]);u!=null&&h(e,["computerUse"],u);const f=c(t,["codeExecution"]);return f!=null&&h(e,["codeExecution"],f),e}function Vb(t){const e={},n=c(t,["baseModel"]);n!=null&&h(e,["baseModel"],n);const r=c(t,["createTime"]);r!=null&&h(e,["createTime"],r);const i=c(t,["updateTime"]);return i!=null&&h(e,["updateTime"],i),e}function Lb(t){const e={},n=c(t,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&h(e,["baseModel"],n);const r=c(t,["createTime"]);r!=null&&h(e,["createTime"],r);const i=c(t,["updateTime"]);return i!=null&&h(e,["updateTime"],i),e}function Fb(t,e){const n={},r=c(t,["displayName"]);e!==void 0&&r!=null&&h(e,["displayName"],r);const i=c(t,["description"]);e!==void 0&&i!=null&&h(e,["description"],i);const s=c(t,["defaultCheckpointId"]);return e!==void 0&&s!=null&&h(e,["defaultCheckpointId"],s),n}function Ub(t,e){const n={},r=c(t,["displayName"]);e!==void 0&&r!=null&&h(e,["displayName"],r);const i=c(t,["description"]);e!==void 0&&i!=null&&h(e,["description"],i);const s=c(t,["defaultCheckpointId"]);return e!==void 0&&s!=null&&h(e,["defaultCheckpointId"],s),n}function Ob(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","name"],qe(t,r));const i=c(e,["config"]);return i!=null&&Fb(i,n),n}function Bb(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=c(e,["config"]);return i!=null&&Ub(i,n),n}function qb(t,e){const n={},r=c(t,["outputGcsUri"]);e!==void 0&&r!=null&&h(e,["parameters","storageUri"],r);const i=c(t,["includeRaiReason"]);e!==void 0&&i!=null&&h(e,["parameters","includeRaiReason"],i);const s=c(t,["outputMimeType"]);e!==void 0&&s!=null&&h(e,["parameters","outputOptions","mimeType"],s);const o=c(t,["outputCompressionQuality"]);e!==void 0&&o!=null&&h(e,["parameters","outputOptions","compressionQuality"],o);const a=c(t,["enhanceInputImage"]);e!==void 0&&a!=null&&h(e,["parameters","upscaleConfig","enhanceInputImage"],a);const l=c(t,["imagePreservationFactor"]);e!==void 0&&l!=null&&h(e,["parameters","upscaleConfig","imagePreservationFactor"],l);const u=c(t,["labels"]);e!==void 0&&u!=null&&h(e,["labels"],u);const f=c(t,["numberOfImages"]);e!==void 0&&f!=null&&h(e,["parameters","sampleCount"],f);const p=c(t,["mode"]);return e!==void 0&&p!=null&&h(e,["parameters","mode"],p),n}function Gb(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],qe(t,r));const i=c(e,["image"]);i!=null&&h(n,["instances[0]","image"],lr(i));const s=c(e,["upscaleFactor"]);s!=null&&h(n,["parameters","upscaleConfig","upscaleFactor"],s);const o=c(e,["config"]);return o!=null&&qb(o,n),n}function zb(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>Gh(s))),h(e,["generatedImages"],i)}return e}function $b(t){const e={},n=c(t,["uri"]);n!=null&&h(e,["uri"],n);const r=c(t,["encodedVideo"]);r!=null&&h(e,["videoBytes"],is(r));const i=c(t,["encoding"]);return i!=null&&h(e,["mimeType"],i),e}function Hb(t){const e={},n=c(t,["gcsUri"]);n!=null&&h(e,["uri"],n);const r=c(t,["bytesBase64Encoded"]);r!=null&&h(e,["videoBytes"],is(r));const i=c(t,["mimeType"]);return i!=null&&h(e,["mimeType"],i),e}function Wb(t){const e={},n=c(t,["image"]);n!=null&&h(e,["_self"],lr(n));const r=c(t,["maskMode"]);return r!=null&&h(e,["maskMode"],r),e}function Kb(t){const e={},n=c(t,["image"]);n!=null&&h(e,["image"],zh(n));const r=c(t,["referenceType"]);return r!=null&&h(e,["referenceType"],r),e}function jb(t){const e={},n=c(t,["image"]);n!=null&&h(e,["image"],lr(n));const r=c(t,["referenceType"]);return r!=null&&h(e,["referenceType"],r),e}function bC(t){const e={},n=c(t,["uri"]);n!=null&&h(e,["uri"],n);const r=c(t,["videoBytes"]);r!=null&&h(e,["encodedVideo"],is(r));const i=c(t,["mimeType"]);return i!=null&&h(e,["encoding"],i),e}function MC(t){const e={},n=c(t,["uri"]);n!=null&&h(e,["gcsUri"],n);const r=c(t,["videoBytes"]);r!=null&&h(e,["bytesBase64Encoded"],is(r));const i=c(t,["mimeType"]);return i!=null&&h(e,["mimeType"],i),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Jb="Content-Type",Qb="X-Server-Timeout",Yb="User-Agent",Tm="x-goog-api-client",Xb="1.25.0",Zb=`google-genai-sdk/${Xb}`,eM="v1beta1",tM="v1beta",BT=/^\s*data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class nM{constructor(e){var n,r;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const i={};this.clientOptions.vertexai?(i.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:eM,i.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(i.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:tM,i.baseUrl="https://generativelanguage.googleapis.com/"),i.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=i,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(i,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&r.push(e.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),n=new URL(e);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,n,r){const i=[this.getRequestUrlInternal(n)];return r&&i.push(this.getBaseResourcePath()),e!==""&&i.push(e),new URL(`${i.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,n,r);if(e.queryParams)for(const[o,a]of Object.entries(e.queryParams))i.searchParams.append(o,String(a));let s={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else s.body=e.body;return s=await this.includeExtraHttpOptionsToRequestInit(s,n,e.abortSignal),this.unaryApiCall(i,s,e.httpMethod)}patchHttpOptions(e,n){const r=JSON.parse(JSON.stringify(e));for(const[i,s]of Object.entries(n))typeof s=="object"?r[i]=Object.assign(Object.assign({},r[i]),s):s!==void 0&&(r[i]=s);return r}async requestStream(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,n,r);(!i.searchParams.has("alt")||i.searchParams.get("alt")!=="sse")&&i.searchParams.set("alt","sse");let s={};return s.body=e.body,s=await this.includeExtraHttpOptionsToRequestInit(s,n,e.abortSignal),this.streamApiCall(i,s,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,n,r){if(n&&n.timeout||r){const i=new AbortController,s=i.signal;if(n.timeout&&(n==null?void 0:n.timeout)>0){const o=setTimeout(()=>i.abort(),n.timeout);o&&typeof o.unref=="function"&&o.unref()}r&&r.addEventListener("abort",()=>{i.abort()}),e.signal=s}return n&&n.extraBody!==null&&rM(e,n.extraBody),e.headers=await this.getHeadersInternal(n),e}async unaryApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async i=>(await qT(i),new mm(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}async streamApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async i=>(await qT(i),this.processStreamResponse(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}processStreamResponse(e){var n;return ha(this,arguments,function*(){const i=(n=e==null?void 0:e.body)===null||n===void 0?void 0:n.getReader(),s=new TextDecoder("utf-8");if(!i)throw new Error("Response body is empty");try{let o="";for(;;){const{done:a,value:l}=yield it(i.read());if(a){if(o.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const u=s.decode(l,{stream:!0});try{const p=JSON.parse(u);if("error"in p){const g=JSON.parse(JSON.stringify(p.error)),v=g.status,E=g.code,x=`got status: ${v}. ${JSON.stringify(p)}`;if(E>=400&&E<600)throw new Bh({message:x,status:E})}}catch(p){if(p.name==="ApiError")throw p}o+=u;let f=o.match(BT);for(;f;){const p=f[1];try{const g=new Response(p,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield it(new mm(g)),o=o.slice(f[0].length),f=o.match(BT)}catch(g){throw new Error(`exception parsing stream chunk ${p}. ${g}`)}}}}finally{i.releaseLock()}})}async apiCall(e,n){return fetch(e,n).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const e={},n=Zb+" "+this.clientOptions.userAgentExtra;return e[Yb]=n,e[Tm]=n,e[Jb]="application/json",e}async getHeadersInternal(e){const n=new Headers;if(e&&e.headers){for(const[r,i]of Object.entries(e.headers))n.append(r,i);e.timeout&&e.timeout>0&&n.append(Qb,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(n),n}async uploadFile(e,n){var r;const i={};n!=null&&(i.mimeType=n.mimeType,i.name=n.name,i.displayName=n.displayName),i.name&&!i.name.startsWith("files/")&&(i.name=`files/${i.name}`);const s=this.clientOptions.uploader,o=await s.stat(e);i.sizeBytes=String(o.size);const a=(r=n==null?void 0:n.mimeType)!==null&&r!==void 0?r:o.type;if(a===void 0||a==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");i.mimeType=a;const l=await this.fetchUploadUrl(i,n);return s.upload(e,l,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,n){var r;let i={};n!=null&&n.httpOptions?i=n.httpOptions:i={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};const s={file:e},o=await this.request({path:ue("upload/v1beta/files",s._url),body:JSON.stringify(s),httpMethod:"POST",httpOptions:i});if(!o||!(o!=null&&o.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const a=(r=o==null?void 0:o.headers)===null||r===void 0?void 0:r["x-goog-upload-url"];if(a===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return a}}async function qT(t){var e;if(t===void 0)throw new Error("response is undefined");if(!t.ok){const n=t.status;let r;!((e=t.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?r=await t.json():r={error:{message:await t.text(),code:t.status,status:t.statusText}};const i=JSON.stringify(r);throw n>=400&&n<600?new Bh({message:i,status:n}):new Error(i)}}function rM(t,e){if(!e||Object.keys(e).length===0)return;if(t.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let n={};if(typeof t.body=="string"&&t.body.length>0)try{const s=JSON.parse(t.body);if(typeof s=="object"&&s!==null&&!Array.isArray(s))n=s;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function r(s,o){const a=Object.assign({},s);for(const l in o)if(Object.prototype.hasOwnProperty.call(o,l)){const u=o[l],f=a[l];u&&typeof u=="object"&&!Array.isArray(u)&&f&&typeof f=="object"&&!Array.isArray(f)?a[l]=r(f,u):(f&&u&&typeof f!=typeof u&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${l}". Original type: ${typeof f}, New type: ${typeof u}. Overwriting.`),a[l]=u)}return a}const i=r(n,e);t.body=JSON.stringify(i)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const iM="mcp_used/unknown";let sM=!1;function VC(t){for(const e of t)if(oM(e)||typeof e=="object"&&"inputSchema"in e)return!0;return sM}function LC(t){var e;const n=(e=t[Tm])!==null&&e!==void 0?e:"";t[Tm]=(n+` ${iM}`).trimStart()}function oM(t){return t!==null&&typeof t=="object"&&t instanceof s_}function aM(t,e=100){return ha(this,arguments,function*(){let r,i=0;for(;i<e;){const s=yield it(t.listTools({cursor:r}));for(const o of s.tools)yield yield it(o),i++;if(!s.nextCursor)break;r=s.nextCursor}})}class s_{constructor(e=[],n){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=n}static create(e,n){return new s_(e,n)}async initialize(){var e,n,r,i;if(this.mcpTools.length>0)return;const s={},o=[];for(const f of this.mcpClients)try{for(var a=!0,l=(n=void 0,jl(aM(f))),u;u=await l.next(),e=u.done,!e;a=!0){i=u.value,a=!1;const p=i;o.push(p);const g=p.name;if(s[g])throw new Error(`Duplicate function name ${g} found in MCP tools. Please ensure function names are unique.`);s[g]=f}}catch(p){n={error:p}}finally{try{!a&&!e&&(r=l.return)&&await r.call(l)}finally{if(n)throw n.error}}this.mcpTools=o,this.functionNameToMcpClient=s}async tool(){return await this.initialize(),h1(this.mcpTools,this.config)}async callTool(e){await this.initialize();const n=[];for(const r of e)if(r.name in this.functionNameToMcpClient){const i=this.functionNameToMcpClient[r.name];let s;this.config.timeout&&(s={timeout:this.config.timeout});const o=await i.callTool({name:r.name,arguments:r.args},void 0,s);n.push({functionResponse:{name:r.name,response:o.isError?{error:o}:o}})}return n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function lM(t,e,n){const r=new i1;let i;n.data instanceof Blob?i=JSON.parse(await n.data.text()):i=JSON.parse(n.data),Object.assign(r,i),e(r)}class uM{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r}async connect(e){var n,r;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const i=this.apiClient.getWebsocketBaseUrl(),s=this.apiClient.getApiVersion(),o=hM(this.apiClient.getDefaultHeaders()),a=this.apiClient.getApiKey(),l=`${i}/ws/google.ai.generativelanguage.${s}.GenerativeService.BidiGenerateMusic?key=${a}`;let u=()=>{};const f=new Promise(S=>{u=S}),p=e.callbacks,g=function(){u({})},v=this.apiClient,E={onopen:g,onmessage:S=>{lM(v,p.onmessage,S)},onerror:(n=p==null?void 0:p.onerror)!==null&&n!==void 0?n:function(S){},onclose:(r=p==null?void 0:p.onclose)!==null&&r!==void 0?r:function(S){}},x=this.webSocketFactory.create(l,dM(o),E);x.connect(),await f;const I={setup:{model:qe(this.apiClient,e.model)}};return x.send(JSON.stringify(I)),new cM(x,this.apiClient)}}class cM{constructor(e,n){this.conn=e,this.apiClient=n}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const n=tD(e);this.conn.send(JSON.stringify({clientContent:n}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const n=eD(e);this.conn.send(JSON.stringify(n))}sendPlaybackControl(e){const n={playbackControl:e};this.conn.send(JSON.stringify(n))}play(){this.sendPlaybackControl(ra.PLAY)}pause(){this.sendPlaybackControl(ra.PAUSE)}stop(){this.sendPlaybackControl(ra.STOP)}resetContext(){this.sendPlaybackControl(ra.RESET_CONTEXT)}close(){this.conn.close()}}function dM(t){const e={};return t.forEach((n,r)=>{e[r]=n}),e}function hM(t){const e=new Headers;for(const[n,r]of Object.entries(t))e.append(n,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const fM="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function pM(t,e,n){const r=new r1;let i;n.data instanceof Blob?i=await n.data.text():n.data instanceof ArrayBuffer?i=new TextDecoder().decode(n.data):i=n.data;const s=JSON.parse(i);if(t.isVertexAI()){const o=iD(s);Object.assign(r,o)}else Object.assign(r,s);e(r)}class mM{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r,this.music=new uM(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var n,r,i,s,o,a;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const l=this.apiClient.getWebsocketBaseUrl(),u=this.apiClient.getApiVersion();let f;const p=this.apiClient.getHeaders();e.config&&e.config.tools&&VC(e.config.tools)&&LC(p);const g=vM(p);if(this.apiClient.isVertexAI())f=`${l}/ws/google.cloud.aiplatform.${u}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(g);else{const A=this.apiClient.getApiKey();let k="BidiGenerateContent",D="key";A!=null&&A.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),u!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),k="BidiGenerateContentConstrained",D="access_token"),f=`${l}/ws/google.ai.generativelanguage.${u}.GenerativeService.${k}?${D}=${A}`}let v=()=>{};const E=new Promise(A=>{v=A}),x=e.callbacks,b=function(){var A;(A=x==null?void 0:x.onopen)===null||A===void 0||A.call(x),v({})},C=this.apiClient,I={onopen:b,onmessage:A=>{pM(C,x.onmessage,A)},onerror:(n=x==null?void 0:x.onerror)!==null&&n!==void 0?n:function(A){},onclose:(r=x==null?void 0:x.onclose)!==null&&r!==void 0?r:function(A){}},S=this.webSocketFactory.create(f,yM(g),I);S.connect(),await E;let V=qe(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&V.startsWith("publishers/")){const A=this.apiClient.getProject(),k=this.apiClient.getLocation();V=`projects/${A}/locations/${k}/`+V}let U={};this.apiClient.isVertexAI()&&((i=e.config)===null||i===void 0?void 0:i.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[Jd.AUDIO]}:e.config.responseModalities=[Jd.AUDIO]),!((s=e.config)===null||s===void 0)&&s.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const B=(a=(o=e.config)===null||o===void 0?void 0:o.tools)!==null&&a!==void 0?a:[],T=[];for(const A of B)if(this.isCallableTool(A)){const k=A;T.push(await k.tool())}else T.push(A);T.length>0&&(e.config.tools=T);const w={model:V,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?U=ZN(this.apiClient,w):U=XN(this.apiClient,w),delete U.config,S.send(JSON.stringify(U)),new _M(S,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const gM={turnComplete:!0};class _M{constructor(e,n){this.conn=e,this.apiClient=n}tLiveClientContent(e,n){if(n.turns!==null&&n.turns!==void 0){let r=[];try{r=On(n.turns),e.isVertexAI()||(r=r.map(i=>qh(i)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:r,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(e,n){let r=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?r=n.functionResponses:r=[n.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const s of r){if(typeof s!="object"||s===null||!("name"in s)||!("response"in s))throw new Error(`Could not parse function response, type '${typeof s}'.`);if(!e.isVertexAI()&&!("id"in s))throw new Error(fM)}return{toolResponse:{functionResponses:r}}}sendClientContent(e){e=Object.assign(Object.assign({},gM),e);const n=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(n))}sendRealtimeInput(e){let n={};this.apiClient.isVertexAI()?n={realtimeInput:rD(e)}:n={realtimeInput:nD(e)},this.conn.send(JSON.stringify(n))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function yM(t){const e={};return t.forEach((n,r)=>{e[r]=n}),e}function vM(t){const e=new Headers;for(const[n,r]of Object.entries(t))e.append(n,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const GT=10;function zT(t){var e,n,r;if(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let i=!1;for(const o of(n=t==null?void 0:t.tools)!==null&&n!==void 0?n:[])if(fa(o)){i=!0;break}if(!i)return!0;const s=(r=t==null?void 0:t.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls;return s&&(s<0||!Number.isInteger(s))||s==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",s),!0):!1}function fa(t){return"callTool"in t&&typeof t.callTool=="function"}function TM(t){var e,n,r;return(r=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(i=>fa(i)))!==null&&r!==void 0?r:!1}function EM(t){var e,n,r;return(r=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(i=>!fa(i)))!==null&&r!==void 0?r:!1}function $T(t){var e;return!(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class IM extends ho{constructor(e){super(),this.apiClient=e,this.generateContent=async n=>{var r,i,s,o,a;const l=await this.processParamsMaybeAddMcpUsage(n);if(this.maybeMoveToResponseJsonSchem(n),!TM(n)||zT(n.config))return await this.generateContentInternal(l);if(EM(n))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");let u,f;const p=On(l.contents),g=(s=(i=(r=l.config)===null||r===void 0?void 0:r.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&s!==void 0?s:GT;let v=0;for(;v<g&&(u=await this.generateContentInternal(l),!(!u.functionCalls||u.functionCalls.length===0));){const E=u.candidates[0].content,x=[];for(const b of(a=(o=n.config)===null||o===void 0?void 0:o.tools)!==null&&a!==void 0?a:[])if(fa(b)){const I=await b.callTool(u.functionCalls);x.push(...I)}v++,f={role:"user",parts:x},l.contents=On(l.contents),l.contents.push(E),l.contents.push(f),$T(l.config)&&(p.push(E),p.push(f))}return $T(l.config)&&(u.automaticFunctionCallingHistory=p),u},this.generateContentStream=async n=>{if(this.maybeMoveToResponseJsonSchem(n),zT(n.config)){const r=await this.processParamsMaybeAddMcpUsage(n);return await this.generateContentStreamInternal(r)}else return await this.processAfcStream(n)},this.generateImages=async n=>await this.generateImagesInternal(n).then(r=>{var i;let s;const o=[];if(r!=null&&r.generatedImages)for(const l of r.generatedImages)l&&(l!=null&&l.safetyAttributes)&&((i=l==null?void 0:l.safetyAttributes)===null||i===void 0?void 0:i.contentType)==="Positive Prompt"?s=l==null?void 0:l.safetyAttributes:o.push(l);let a;return s?a={generatedImages:o,positivePromptSafetyAttributes:s,sdkHttpResponse:r.sdkHttpResponse}:a={generatedImages:o,sdkHttpResponse:r.sdkHttpResponse},a}),this.list=async n=>{var r;const o={config:Object.assign(Object.assign({},{queryBase:!0}),n==null?void 0:n.config)};if(this.apiClient.isVertexAI()&&!o.config.queryBase){if(!((r=o.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");o.config.filter="labels.tune-type:*"}return new zu(eo.PAGED_ITEM_MODELS,a=>this.listInternal(a),await this.listInternal(o),o)},this.editImage=async n=>{const r={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(r.referenceImages=n.referenceImages.map(i=>i.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async n=>{let r={numberOfImages:1,mode:"upscale"};n.config&&(r=Object.assign(Object.assign({},r),n.config));const i={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:r};return await this.upscaleImageInternal(i)},this.generateVideos=async n=>{var r,i,s,o,a,l;if((n.prompt||n.image||n.video)&&n.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((r=n.video)===null||r===void 0)&&r.uri&&(!((i=n.video)===null||i===void 0)&&i.videoBytes)?n.video={uri:n.video.uri,mimeType:n.video.mimeType}:!((o=(s=n.source)===null||s===void 0?void 0:s.video)===null||o===void 0)&&o.uri&&(!((l=(a=n.source)===null||a===void 0?void 0:a.video)===null||l===void 0)&&l.videoBytes)&&(n.source.video={uri:n.source.video.uri,mimeType:n.source.video.mimeType})),await this.generateVideosInternal(n)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var n,r,i;const s=(n=e.config)===null||n===void 0?void 0:n.tools;if(!s)return e;const o=await Promise.all(s.map(async l=>fa(l)?await l.tool():l)),a={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:o})};if(a.config.tools=o,e.config&&e.config.tools&&VC(e.config.tools)){const l=(i=(r=e.config.httpOptions)===null||r===void 0?void 0:r.headers)!==null&&i!==void 0?i:{};let u=Object.assign({},l);Object.keys(u).length===0&&(u=this.apiClient.getDefaultHeaders()),LC(u),a.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:u})}return a}async initAfcToolsMap(e){var n,r,i;const s=new Map;for(const o of(r=(n=e.config)===null||n===void 0?void 0:n.tools)!==null&&r!==void 0?r:[])if(fa(o)){const a=o,l=await a.tool();for(const u of(i=l.functionDeclarations)!==null&&i!==void 0?i:[]){if(!u.name)throw new Error("Function declaration name is required.");if(s.has(u.name))throw new Error(`Duplicate tool declaration name: ${u.name}`);s.set(u.name,a)}}return s}async processAfcStream(e){var n,r,i;const s=(i=(r=(n=e.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&i!==void 0?i:GT;let o=!1,a=0;const l=await this.initAfcToolsMap(e);return function(u,f,p){var g,v;return ha(this,arguments,function*(){for(var E,x,b,C;a<s;){o&&(a++,o=!1);const U=yield it(u.processParamsMaybeAddMcpUsage(p)),B=yield it(u.generateContentStreamInternal(U)),T=[],w=[];try{for(var I=!0,S=(x=void 0,jl(B)),V;V=yield it(S.next()),E=V.done,!E;I=!0){C=V.value,I=!1;const A=C;if(yield yield it(A),A.candidates&&(!((g=A.candidates[0])===null||g===void 0)&&g.content)){w.push(A.candidates[0].content);for(const k of(v=A.candidates[0].content.parts)!==null&&v!==void 0?v:[])if(a<s&&k.functionCall){if(!k.functionCall.name)throw new Error("Function call name was not returned by the model.");if(f.has(k.functionCall.name)){const D=yield it(f.get(k.functionCall.name).callTool([k.functionCall]));T.push(...D)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${f.keys()}, mising tool: ${k.functionCall.name}`)}}}}catch(A){x={error:A}}finally{try{!I&&!E&&(b=S.return)&&(yield it(b.call(S)))}finally{if(x)throw x.error}}if(T.length>0){o=!0;const A=new wl;A.candidates=[{content:{role:"user",parts:T}}],yield yield it(A);const k=[];k.push(...w),k.push({role:"user",parts:T});const D=On(p.contents).concat(k);p.contents=D}else break}})}(this,l,e)}async generateContentInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=FT(this.apiClient,e);return a=ue("{model}:generateContent",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const p=OT(f),g=new wl;return Object.assign(g,p),g})}else{const u=LT(this.apiClient,e);return a=ue("{model}:generateContent",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const p=UT(f),g=new wl;return Object.assign(g,p),g})}}async generateContentStreamInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=FT(this.apiClient,e);return a=ue("{model}:streamGenerateContent?alt=sse",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.requestStream({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}),o.then(function(p){return ha(this,arguments,function*(){var g,v,E,x;try{for(var b=!0,C=jl(p),I;I=yield it(C.next()),g=I.done,!g;b=!0){x=I.value,b=!1;const S=x,V=OT(yield it(S.json()));V.sdkHttpResponse={headers:S.headers};const U=new wl;Object.assign(U,V),yield yield it(U)}}catch(S){v={error:S}}finally{try{!b&&!g&&(E=C.return)&&(yield it(E.call(C)))}finally{if(v)throw v.error}}})})}else{const u=LT(this.apiClient,e);return a=ue("{model}:streamGenerateContent?alt=sse",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.requestStream({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}),o.then(function(p){return ha(this,arguments,function*(){var g,v,E,x;try{for(var b=!0,C=jl(p),I;I=yield it(C.next()),g=I.done,!g;b=!0){x=I.value,b=!1;const S=x,V=UT(yield it(S.json()));V.sdkHttpResponse={headers:S.headers};const U=new wl;Object.assign(U,V),yield yield it(U)}}catch(S){v={error:S}}finally{try{!b&&!g&&(E=C.return)&&(yield it(E.call(C)))}finally{if(v)throw v.error}}})})}}async embedContent(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=MD(this.apiClient,e);return a=ue("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const p=LD(f),g=new TT;return Object.assign(g,p),g})}else{const u=bD(this.apiClient,e);return a=ue("{model}:batchEmbedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const p=VD(f),g=new TT;return Object.assign(g,p),g})}}async generateImagesInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=HD(this.apiClient,e);return a=ue("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const p=KD(f),g=new ET;return Object.assign(g,p),g})}else{const u=$D(this.apiClient,e);return a=ue("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const p=WD(f),g=new ET;return Object.assign(g,p),g})}}async editImageInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=PD(this.apiClient,e);return s=ue("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>{const u=kD(l),f=new Jk;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=Gb(this.apiClient,e);return s=ue("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>{const u=zb(l),f=new Qk;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=Sb(this.apiClient,e);return s=ue("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=Cb(l),f=new Yk;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=Nb(this.apiClient,e);return s=ue("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=Db(l),f=new Xk;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=cb(this.apiClient,e);return a=ue("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>vm(f))}else{const u=ub(this.apiClient,e);return a=ue("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>ym(f))}}async listInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=_b(this.apiClient,e);return a=ue("{models_url}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const p=vb(f),g=new IT;return Object.assign(g,p),g})}else{const u=gb(this.apiClient,e);return a=ue("{models_url}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const p=yb(f),g=new IT;return Object.assign(g,p),g})}}async update(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=Bb(this.apiClient,e);return a=ue("{model}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>vm(f))}else{const u=Ob(this.apiClient,e);return a=ue("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>ym(f))}}async delete(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=CD(this.apiClient,e);return a=ue("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const p=xD(f),g=new wT;return Object.assign(g,p),g})}else{const u=SD(this.apiClient,e);return a=ue("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const p=AD(f),g=new wT;return Object.assign(g,p),g})}}async countTokens(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=ED(this.apiClient,e);return a=ue("{model}:countTokens",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const p=wD(f),g=new ST;return Object.assign(g,p),g})}else{const u=TD(this.apiClient,e);return a=ue("{model}:countTokens",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const p=ID(f),g=new ST;return Object.assign(g,p),g})}}async computeTokens(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=fD(this.apiClient,e);return s=ue("{model}:computeTokens",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>{const u=pD(l),f=new Zk;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=ZD(this.apiClient,e);return a=ue("{model}:predictLongRunning",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>{const p=YD(f),g=new Qd;return Object.assign(g,p),g})}else{const u=XD(this.apiClient,e);return a=ue("{model}:predictLongRunning",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>{const p=QD(f),g=new Qd;return Object.assign(g,p),g})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class wM extends ho{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const n=e.operation,r=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=n.name.split("/operations/")[0];let s;r&&"httpOptions"in r&&(s=r.httpOptions);const o=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:i,config:{httpOptions:s}});return n._fromAPIResponse({apiResponse:o,isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:i,isVertexAI:!1})}}async get(e){const n=e.operation,r=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=n.name.split("/operations/")[0];let s;r&&"httpOptions"in r&&(s=r.httpOptions);const o=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:i,config:{httpOptions:s}});return n._fromAPIResponse({apiResponse:o,isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:i,isVertexAI:!1})}}async getVideosOperationInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=Wk(e);return a=ue("{operationName}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o}else{const u=Hk(e);return a=ue("{operationName}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o}}async fetchPredictVideosOperationInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=Uk(e);return s=ue("{resourceName}:fetchPredictOperation",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function SM(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["data"]);n!=null&&h(e,["data"],n);const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function CM(t){const e={},n=c(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>bM(s))),h(e,["parts"],i)}const r=c(t,["role"]);return r!=null&&h(e,["role"],r),e}function AM(t,e,n){const r={},i=c(e,["expireTime"]);n!==void 0&&i!=null&&h(n,["expireTime"],i);const s=c(e,["newSessionExpireTime"]);n!==void 0&&s!=null&&h(n,["newSessionExpireTime"],s);const o=c(e,["uses"]);n!==void 0&&o!=null&&h(n,["uses"],o);const a=c(e,["liveConnectConstraints"]);n!==void 0&&a!=null&&h(n,["bidiGenerateContentSetup"],DM(t,a));const l=c(e,["lockAdditionalFields"]);return n!==void 0&&l!=null&&h(n,["fieldMask"],l),r}function xM(t,e){const n={},r=c(e,["config"]);return r!=null&&h(n,["config"],AM(t,r,n)),n}function RM(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["fileUri"]);n!=null&&h(e,["fileUri"],n);const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function PM(t){const e={};if(c(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=c(t,["enableWidget"]);return n!=null&&h(e,["enableWidget"],n),e}function kM(t){const e={},n=c(t,["timeRangeFilter"]);if(n!=null&&h(e,["timeRangeFilter"],n),c(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function NM(t,e){const n={},r=c(t,["generationConfig"]);e!==void 0&&r!=null&&h(e,["setup","generationConfig"],r);const i=c(t,["responseModalities"]);e!==void 0&&i!=null&&h(e,["setup","generationConfig","responseModalities"],i);const s=c(t,["temperature"]);e!==void 0&&s!=null&&h(e,["setup","generationConfig","temperature"],s);const o=c(t,["topP"]);e!==void 0&&o!=null&&h(e,["setup","generationConfig","topP"],o);const a=c(t,["topK"]);e!==void 0&&a!=null&&h(e,["setup","generationConfig","topK"],a);const l=c(t,["maxOutputTokens"]);e!==void 0&&l!=null&&h(e,["setup","generationConfig","maxOutputTokens"],l);const u=c(t,["mediaResolution"]);e!==void 0&&u!=null&&h(e,["setup","generationConfig","mediaResolution"],u);const f=c(t,["seed"]);e!==void 0&&f!=null&&h(e,["setup","generationConfig","seed"],f);const p=c(t,["speechConfig"]);e!==void 0&&p!=null&&h(e,["setup","generationConfig","speechConfig"],i_(p));const g=c(t,["thinkingConfig"]);e!==void 0&&g!=null&&h(e,["setup","generationConfig","thinkingConfig"],g);const v=c(t,["enableAffectiveDialog"]);e!==void 0&&v!=null&&h(e,["setup","generationConfig","enableAffectiveDialog"],v);const E=c(t,["systemInstruction"]);e!==void 0&&E!=null&&h(e,["setup","systemInstruction"],CM(Qt(E)));const x=c(t,["tools"]);if(e!==void 0&&x!=null){let B=Ha(x);Array.isArray(B)&&(B=B.map(T=>VM($a(T)))),h(e,["setup","tools"],B)}const b=c(t,["sessionResumption"]);e!==void 0&&b!=null&&h(e,["setup","sessionResumption"],MM(b));const C=c(t,["inputAudioTranscription"]);e!==void 0&&C!=null&&h(e,["setup","inputAudioTranscription"],C);const I=c(t,["outputAudioTranscription"]);e!==void 0&&I!=null&&h(e,["setup","outputAudioTranscription"],I);const S=c(t,["realtimeInputConfig"]);e!==void 0&&S!=null&&h(e,["setup","realtimeInputConfig"],S);const V=c(t,["contextWindowCompression"]);e!==void 0&&V!=null&&h(e,["setup","contextWindowCompression"],V);const U=c(t,["proactivity"]);return e!==void 0&&U!=null&&h(e,["setup","proactivity"],U),n}function DM(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["setup","model"],qe(t,r));const i=c(e,["config"]);return i!=null&&h(n,["config"],NM(i,n)),n}function bM(t){const e={},n=c(t,["videoMetadata"]);n!=null&&h(e,["videoMetadata"],n);const r=c(t,["thought"]);r!=null&&h(e,["thought"],r);const i=c(t,["inlineData"]);i!=null&&h(e,["inlineData"],SM(i));const s=c(t,["fileData"]);s!=null&&h(e,["fileData"],RM(s));const o=c(t,["thoughtSignature"]);o!=null&&h(e,["thoughtSignature"],o);const a=c(t,["functionCall"]);a!=null&&h(e,["functionCall"],a);const l=c(t,["codeExecutionResult"]);l!=null&&h(e,["codeExecutionResult"],l);const u=c(t,["executableCode"]);u!=null&&h(e,["executableCode"],u);const f=c(t,["functionResponse"]);f!=null&&h(e,["functionResponse"],f);const p=c(t,["text"]);return p!=null&&h(e,["text"],p),e}function MM(t){const e={},n=c(t,["handle"]);if(n!=null&&h(e,["handle"],n),c(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function VM(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(f=>f)),h(e,["functionDeclarations"],u)}if(c(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=c(t,["googleSearch"]);r!=null&&h(e,["googleSearch"],kM(r));const i=c(t,["googleSearchRetrieval"]);if(i!=null&&h(e,["googleSearchRetrieval"],i),c(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=c(t,["googleMaps"]);s!=null&&h(e,["googleMaps"],PM(s));const o=c(t,["urlContext"]);o!=null&&h(e,["urlContext"],o);const a=c(t,["computerUse"]);a!=null&&h(e,["computerUse"],a);const l=c(t,["codeExecution"]);return l!=null&&h(e,["codeExecution"],l),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function LM(t){const e=[];for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const r=t[n];if(typeof r=="object"&&r!=null&&Object.keys(r).length>0){const i=Object.keys(r).map(s=>`${n}.${s}`);e.push(...i)}else e.push(n)}return e.join(",")}function FM(t,e){let n=null;const r=t.bidiGenerateContentSetup;if(typeof r=="object"&&r!==null&&"setup"in r){const s=r.setup;typeof s=="object"&&s!==null?(t.bidiGenerateContentSetup=s,n=s):delete t.bidiGenerateContentSetup}else r!==void 0&&delete t.bidiGenerateContentSetup;const i=t.fieldMask;if(n){const s=LM(n);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)s?t.fieldMask=s:delete t.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&i!==null&&Array.isArray(i)&&i.length>0){const o=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let a=[];i.length>0&&(a=i.map(u=>o.includes(u)?`generationConfig.${u}`:u));const l=[];s&&l.push(s),a.length>0&&l.push(...a),l.length>0?t.fieldMask=l.join(","):delete t.fieldMask}else delete t.fieldMask}else i!==null&&Array.isArray(i)&&i.length>0?t.fieldMask=i.join(","):delete t.fieldMask;return t}class UM extends ho{constructor(e){super(),this.apiClient=e}async create(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const a=xM(this.apiClient,e);s=ue("auth_tokens",a._url),o=a._query,delete a.config,delete a._url,delete a._query;const l=FM(a,e.config);return i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>u)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function OM(t){const e={},n=c(t,["name"]);return n!=null&&h(e,["_url","name"],n),e}function BM(t){const e={},n=c(t,["name"]);return n!=null&&h(e,["_url","name"],n),e}function qM(t,e){const n={};if(c(t,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const r=c(t,["tunedModelDisplayName"]);if(e!==void 0&&r!=null&&h(e,["displayName"],r),c(t,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const i=c(t,["epochCount"]);e!==void 0&&i!=null&&h(e,["tuningTask","hyperparameters","epochCount"],i);const s=c(t,["learningRateMultiplier"]);if(s!=null&&h(n,["tuningTask","hyperparameters","learningRateMultiplier"],s),c(t,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(c(t,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(c(t,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const o=c(t,["batchSize"]);e!==void 0&&o!=null&&h(e,["tuningTask","hyperparameters","batchSize"],o);const a=c(t,["learningRate"]);if(e!==void 0&&a!=null&&h(e,["tuningTask","hyperparameters","learningRate"],a),c(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");return n}function GM(t,e){const n={},r=c(t,["validationDataset"]);e!==void 0&&r!=null&&h(e,["supervisedTuningSpec"],r2(r,n));const i=c(t,["tunedModelDisplayName"]);e!==void 0&&i!=null&&h(e,["tunedModelDisplayName"],i);const s=c(t,["description"]);e!==void 0&&s!=null&&h(e,["description"],s);const o=c(t,["epochCount"]);e!==void 0&&o!=null&&h(e,["supervisedTuningSpec","hyperParameters","epochCount"],o);const a=c(t,["learningRateMultiplier"]);e!==void 0&&a!=null&&h(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],a);const l=c(t,["exportLastCheckpointOnly"]);e!==void 0&&l!=null&&h(e,["supervisedTuningSpec","exportLastCheckpointOnly"],l);const u=c(t,["adapterSize"]);if(e!==void 0&&u!=null&&h(e,["supervisedTuningSpec","hyperParameters","adapterSize"],u),c(t,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(c(t,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const f=c(t,["labels"]);return e!==void 0&&f!=null&&h(e,["labels"],f),n}function zM(t){const e={},n=c(t,["baseModel"]);n!=null&&h(e,["baseModel"],n);const r=c(t,["preTunedModel"]);r!=null&&h(e,["preTunedModel"],r);const i=c(t,["trainingDataset"]);i!=null&&h(e,["tuningTask","trainingData"],e2(i));const s=c(t,["config"]);return s!=null&&qM(s,e),e}function $M(t){const e={},n=c(t,["baseModel"]);n!=null&&h(e,["baseModel"],n);const r=c(t,["preTunedModel"]);r!=null&&h(e,["preTunedModel"],r);const i=c(t,["trainingDataset"]);i!=null&&h(e,["supervisedTuningSpec","trainingDatasetUri"],t2(i,e));const s=c(t,["config"]);return s!=null&&GM(s,e),e}function HM(t){const e={},n=c(t,["name"]);return n!=null&&h(e,["_url","name"],n),e}function WM(t){const e={},n=c(t,["name"]);return n!=null&&h(e,["_url","name"],n),e}function KM(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&h(e,["_query","pageSize"],r);const i=c(t,["pageToken"]);e!==void 0&&i!=null&&h(e,["_query","pageToken"],i);const s=c(t,["filter"]);return e!==void 0&&s!=null&&h(e,["_query","filter"],s),n}function jM(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&h(e,["_query","pageSize"],r);const i=c(t,["pageToken"]);e!==void 0&&i!=null&&h(e,["_query","pageToken"],i);const s=c(t,["filter"]);return e!==void 0&&s!=null&&h(e,["_query","filter"],s),n}function JM(t){const e={},n=c(t,["config"]);return n!=null&&KM(n,e),e}function QM(t){const e={},n=c(t,["config"]);return n!=null&&jM(n,e),e}function YM(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=c(t,["tunedModels"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>FC(o))),h(e,["tuningJobs"],s)}return e}function XM(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=c(t,["tuningJobs"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>Em(o))),h(e,["tuningJobs"],s)}return e}function ZM(t){const e={},n=c(t,["name"]);n!=null&&h(e,["model"],n);const r=c(t,["name"]);return r!=null&&h(e,["endpoint"],r),e}function e2(t){const e={};if(c(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(c(t,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const n=c(t,["examples"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>i)),h(e,["examples","examples"],r)}return e}function t2(t,e){const n={},r=c(t,["gcsUri"]);e!==void 0&&r!=null&&h(e,["supervisedTuningSpec","trainingDatasetUri"],r);const i=c(t,["vertexDatasetResource"]);if(e!==void 0&&i!=null&&h(e,["supervisedTuningSpec","trainingDatasetUri"],i),c(t,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return n}function FC(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["name"]);r!=null&&h(e,["name"],r);const i=c(t,["state"]);i!=null&&h(e,["state"],yC(i));const s=c(t,["createTime"]);s!=null&&h(e,["createTime"],s);const o=c(t,["tuningTask","startTime"]);o!=null&&h(e,["startTime"],o);const a=c(t,["tuningTask","completeTime"]);a!=null&&h(e,["endTime"],a);const l=c(t,["updateTime"]);l!=null&&h(e,["updateTime"],l);const u=c(t,["description"]);u!=null&&h(e,["description"],u);const f=c(t,["baseModel"]);f!=null&&h(e,["baseModel"],f);const p=c(t,["_self"]);p!=null&&h(e,["tunedModel"],ZM(p));const g=c(t,["customBaseModel"]);g!=null&&h(e,["customBaseModel"],g);const v=c(t,["experiment"]);v!=null&&h(e,["experiment"],v);const E=c(t,["labels"]);E!=null&&h(e,["labels"],E);const x=c(t,["outputUri"]);x!=null&&h(e,["outputUri"],x);const b=c(t,["pipelineJob"]);b!=null&&h(e,["pipelineJob"],b);const C=c(t,["serviceAccount"]);C!=null&&h(e,["serviceAccount"],C);const I=c(t,["tunedModelDisplayName"]);I!=null&&h(e,["tunedModelDisplayName"],I);const S=c(t,["veoTuningSpec"]);return S!=null&&h(e,["veoTuningSpec"],S),e}function Em(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["name"]);r!=null&&h(e,["name"],r);const i=c(t,["state"]);i!=null&&h(e,["state"],yC(i));const s=c(t,["createTime"]);s!=null&&h(e,["createTime"],s);const o=c(t,["startTime"]);o!=null&&h(e,["startTime"],o);const a=c(t,["endTime"]);a!=null&&h(e,["endTime"],a);const l=c(t,["updateTime"]);l!=null&&h(e,["updateTime"],l);const u=c(t,["error"]);u!=null&&h(e,["error"],u);const f=c(t,["description"]);f!=null&&h(e,["description"],f);const p=c(t,["baseModel"]);p!=null&&h(e,["baseModel"],p);const g=c(t,["tunedModel"]);g!=null&&h(e,["tunedModel"],g);const v=c(t,["preTunedModel"]);v!=null&&h(e,["preTunedModel"],v);const E=c(t,["supervisedTuningSpec"]);E!=null&&h(e,["supervisedTuningSpec"],E);const x=c(t,["tuningDataStats"]);x!=null&&h(e,["tuningDataStats"],x);const b=c(t,["encryptionSpec"]);b!=null&&h(e,["encryptionSpec"],b);const C=c(t,["partnerModelTuningSpec"]);C!=null&&h(e,["partnerModelTuningSpec"],C);const I=c(t,["customBaseModel"]);I!=null&&h(e,["customBaseModel"],I);const S=c(t,["experiment"]);S!=null&&h(e,["experiment"],S);const V=c(t,["labels"]);V!=null&&h(e,["labels"],V);const U=c(t,["outputUri"]);U!=null&&h(e,["outputUri"],U);const B=c(t,["pipelineJob"]);B!=null&&h(e,["pipelineJob"],B);const T=c(t,["serviceAccount"]);T!=null&&h(e,["serviceAccount"],T);const w=c(t,["tunedModelDisplayName"]);w!=null&&h(e,["tunedModelDisplayName"],w);const A=c(t,["veoTuningSpec"]);return A!=null&&h(e,["veoTuningSpec"],A),e}function n2(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["name"]);r!=null&&h(e,["name"],r);const i=c(t,["metadata"]);i!=null&&h(e,["metadata"],i);const s=c(t,["done"]);s!=null&&h(e,["done"],s);const o=c(t,["error"]);return o!=null&&h(e,["error"],o),e}function r2(t,e){const n={},r=c(t,["gcsUri"]);r!=null&&h(n,["validationDatasetUri"],r);const i=c(t,["vertexDatasetResource"]);return e!==void 0&&i!=null&&h(e,["supervisedTuningSpec","trainingDatasetUri"],i),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class i2 extends ho{constructor(e){super(),this.apiClient=e,this.get=async n=>await this.getInternal(n),this.list=async(n={})=>new zu(eo.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(n),n),this.tune=async n=>{var r;if(this.apiClient.isVertexAI())if(n.baseModel.startsWith("projects/")){const i={tunedModelName:n.baseModel};!((r=n.config)===null||r===void 0)&&r.preTunedModelCheckpointId&&(i.checkpointId=n.config.preTunedModelCheckpointId);const s=Object.assign(Object.assign({},n),{preTunedModel:i});return s.baseModel=void 0,await this.tuneInternal(s)}else{const i=Object.assign({},n);return await this.tuneInternal(i)}else{const i=Object.assign({},n),s=await this.tuneMldevInternal(i);let o="";return s.metadata!==void 0&&s.metadata.tunedModel!==void 0?o=s.metadata.tunedModel:s.name!==void 0&&s.name.includes("/operations/")&&(o=s.name.split("/operations/")[0]),{name:o,state:pm.JOB_STATE_QUEUED}}}}async getInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=WM(e);return a=ue("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>Em(f))}else{const u=HM(e);return a=ue("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>FC(f))}}async listInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=QM(e);return a=ue("tuningJobs",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const p=XM(f),g=new CT;return Object.assign(g,p),g})}else{const u=JM(e);return a=ue("tunedModels",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:f.headers},g})),o.then(f=>{const p=YM(f),g=new CT;return Object.assign(g,p),g})}}async cancel(e){var n,r,i,s;let o="",a={};if(this.apiClient.isVertexAI()){const l=BM(e);o=ue("{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}else{const l=OM(e);o=ue("{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal})}}async tuneInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=$M(e);return s=ue("tuningJobs",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>Em(l))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=zM(e);return s=ue("tunedModels",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>n2(l))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class s2{async download(e,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const o2=1024*1024*8,a2=3,l2=1e3,u2=2,sp="x-goog-upload-status";async function c2(t,e,n){var r,i,s;let o=0,a=0,l=new mm(new Response),u="upload";for(o=t.size;a<o;){const p=Math.min(o2,o-a),g=t.slice(a,a+p);a+p>=o&&(u+=", finalize");let v=0,E=l2;for(;v<a2&&(l=await n.request({path:"",body:g,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":u,"X-Goog-Upload-Offset":String(a),"Content-Length":String(p)}}}),!(!((r=l==null?void 0:l.headers)===null||r===void 0)&&r[sp]));)v++,await h2(E),E=E*u2;if(a+=p,((i=l==null?void 0:l.headers)===null||i===void 0?void 0:i[sp])!=="active")break;if(o<=a)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const f=await(l==null?void 0:l.json());if(((s=l==null?void 0:l.headers)===null||s===void 0?void 0:s[sp])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return f.file}async function d2(t){return{size:t.size,type:t.type}}function h2(t){return new Promise(e=>setTimeout(e,t))}class f2{async upload(e,n,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await c2(e,n,r)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await d2(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class p2{create(e,n,r){return new m2(e,n,r)}}class m2{constructor(e,n,r){this.url=e,this.headers=n,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const HT="x-goog-api-key";class g2{constructor(e){this.apiKey=e}async addAuthHeaders(e){if(e.get(HT)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(HT,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const _2="gl-node/";class y2{constructor(e){var n;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=e.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=e.apiKey;const r=Lk(e.httpOptions,e.vertexai,void 0,void 0);r&&(e.httpOptions?e.httpOptions.baseUrl=r:e.httpOptions={baseUrl:r}),this.apiVersion=e.apiVersion;const i=new g2(this.apiKey);this.apiClient=new nM({auth:i,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:_2+"web",uploader:new f2,downloader:new s2}),this.models=new IM(this.apiClient),this.live=new mM(this.apiClient,i,new p2),this.batches=new tN(this.apiClient),this.chats=new bN(this.models,this.apiClient),this.caches=new kN(this.apiClient),this.files=new zN(this.apiClient),this.operations=new wM(this.apiClient),this.authTokens=new UM(this.apiClient),this.tunings=new i2(this.apiClient)}}const v2=()=>{};var WT={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UC=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},T2=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],o=t[n++],a=t[n++],l=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},OC={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],o=i+1<t.length,a=o?t[i+1]:0,l=i+2<t.length,u=l?t[i+2]:0,f=s>>2,p=(s&3)<<4|a>>4;let g=(a&15)<<2|u>>6,v=u&63;l||(v=64,o||(g=64)),r.push(n[f],n[p],n[g],n[v])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(UC(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):T2(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0;++i;const u=i<t.length?n[t.charAt(i)]:64;++i;const p=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||a==null||u==null||p==null)throw new E2;const g=s<<2|a>>4;if(r.push(g),u!==64){const v=a<<4&240|u>>2;if(r.push(v),p!==64){const E=u<<6&192|p;r.push(E)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class E2 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const I2=function(t){const e=UC(t);return OC.encodeByteArray(e,!0)},Xd=function(t){return I2(t).replace(/\./g,"")},BC=function(t){try{return OC.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qC(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w2=()=>qC().__FIREBASE_DEFAULTS__,S2=()=>{if(typeof process>"u"||typeof WT>"u")return;const t=WT.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},C2=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&BC(t[1]);return e&&JSON.parse(e)},$h=()=>{try{return v2()||w2()||S2()||C2()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},GC=t=>{var e,n;return(n=(e=$h())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},A2=t=>{const e=GC(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},zC=()=>{var t;return(t=$h())==null?void 0:t.config},$C=t=>{var e;return(e=$h())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x2{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ka(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function HC(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R2(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...t};return[Xd(JSON.stringify(n)),Xd(JSON.stringify(o)),""].join(".")}const Jl={};function P2(){const t={prod:[],emulator:[]};for(const e of Object.keys(Jl))Jl[e]?t.emulator.push(e):t.prod.push(e);return t}function k2(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let KT=!1;function WC(t,e){if(typeof window>"u"||typeof document>"u"||!Ka(window.location.host)||Jl[t]===e||Jl[t]||KT)return;Jl[t]=e;function n(g){return`__firebase__banner__${g}`}const r="__firebase__banner",s=P2().prod.length>0;function o(){const g=document.getElementById(r);g&&g.remove()}function a(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function l(g,v){g.setAttribute("width","24"),g.setAttribute("id",v),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function u(){const g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{KT=!0,o()},g}function f(g,v){g.setAttribute("id",v),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function p(){const g=k2(r),v=n("text"),E=document.getElementById(v)||document.createElement("span"),x=n("learnmore"),b=document.getElementById(x)||document.createElement("a"),C=n("preprendIcon"),I=document.getElementById(C)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){const S=g.element;a(S),f(b,x);const V=u();l(I,C),S.append(I,E,b,V),document.body.appendChild(S)}s?(E.innerText="Preview backend disconnected.",I.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(I.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,E.innerText="Preview backend running in this workspace."),E.setAttribute("id",v)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",p):p()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function N2(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Rt())}function KC(){var e;const t=(e=$h())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function D2(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function b2(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function M2(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function V2(){const t=Rt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function jC(){return!KC()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function JC(){return!KC()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function QC(){try{return typeof indexedDB=="object"}catch{return!1}}function L2(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)==null?void 0:s.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F2="FirebaseError";class ii extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=F2,Object.setPrototypeOf(this,ii.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,$u.prototype.create)}}class $u{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?U2(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new ii(i,a,r)}}function U2(t,e){return t.replace(O2,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const O2=/\{\$([^}]+)}/g;function B2(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function to(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],o=e[i];if(jT(s)&&jT(o)){if(!to(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function jT(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hu(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function q2(t,e){const n=new G2(t,e);return n.subscribe.bind(n)}class G2{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");z2(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=op),i.error===void 0&&(i.error=op),i.complete===void 0&&(i.complete=op);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function z2(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function op(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pt(t){return t&&t._delegate?t._delegate:t}class no{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ks="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $2{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new x2;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(W2(e))try{this.getOrInitializeService({instanceIdentifier:ks})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=ks){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ks){return this.instances.has(e)}getOptions(e=ks){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:H2(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=ks){return this.component?this.component.multipleInstances?e:ks:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function H2(t){return t===ks?void 0:t}function W2(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K2{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new $2(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var be;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(be||(be={}));const j2={debug:be.DEBUG,verbose:be.VERBOSE,info:be.INFO,warn:be.WARN,error:be.ERROR,silent:be.SILENT},J2=be.INFO,Q2={[be.DEBUG]:"log",[be.VERBOSE]:"log",[be.INFO]:"info",[be.WARN]:"warn",[be.ERROR]:"error"},Y2=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=Q2[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class o_{constructor(e){this.name=e,this._logLevel=J2,this._logHandler=Y2,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in be))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?j2[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,be.DEBUG,...e),this._logHandler(this,be.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,be.VERBOSE,...e),this._logHandler(this,be.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,be.INFO,...e),this._logHandler(this,be.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,be.WARN,...e),this._logHandler(this,be.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,be.ERROR,...e),this._logHandler(this,be.ERROR,...e)}}const X2=(t,e)=>e.some(n=>t instanceof n);let JT,QT;function Z2(){return JT||(JT=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function eV(){return QT||(QT=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const YC=new WeakMap,Im=new WeakMap,XC=new WeakMap,ap=new WeakMap,a_=new WeakMap;function tV(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(Oi(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&YC.set(n,t)}).catch(()=>{}),a_.set(e,t),e}function nV(t){if(Im.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});Im.set(t,e)}let wm={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Im.get(t);if(e==="objectStoreNames")return t.objectStoreNames||XC.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Oi(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function rV(t){wm=t(wm)}function iV(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(lp(this),e,...n);return XC.set(r,e.sort?e.sort():[e]),Oi(r)}:eV().includes(t)?function(...e){return t.apply(lp(this),e),Oi(YC.get(this))}:function(...e){return Oi(t.apply(lp(this),e))}}function sV(t){return typeof t=="function"?iV(t):(t instanceof IDBTransaction&&nV(t),X2(t,Z2())?new Proxy(t,wm):t)}function Oi(t){if(t instanceof IDBRequest)return tV(t);if(ap.has(t))return ap.get(t);const e=sV(t);return e!==t&&(ap.set(t,e),a_.set(e,t)),e}const lp=t=>a_.get(t);function oV(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),a=Oi(o);return r&&o.addEventListener("upgradeneeded",l=>{r(Oi(o.result),l.oldVersion,l.newVersion,Oi(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}const aV=["get","getKey","getAll","getAllKeys","count"],lV=["put","add","delete","clear"],up=new Map;function YT(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(up.get(e))return up.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=lV.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||aV.includes(n)))return;const s=async function(o,...a){const l=this.transaction(o,i?"readwrite":"readonly");let u=l.store;return r&&(u=u.index(a.shift())),(await Promise.all([u[n](...a),i&&l.done]))[0]};return up.set(e,s),s}rV(t=>({...t,get:(e,n,r)=>YT(e,n)||t.get(e,n,r),has:(e,n)=>!!YT(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uV{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(cV(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function cV(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Sm="@firebase/app",XT="0.14.4";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xr=new o_("@firebase/app"),dV="@firebase/app-compat",hV="@firebase/analytics-compat",fV="@firebase/analytics",pV="@firebase/app-check-compat",mV="@firebase/app-check",gV="@firebase/auth",_V="@firebase/auth-compat",yV="@firebase/database",vV="@firebase/data-connect",TV="@firebase/database-compat",EV="@firebase/functions",IV="@firebase/functions-compat",wV="@firebase/installations",SV="@firebase/installations-compat",CV="@firebase/messaging",AV="@firebase/messaging-compat",xV="@firebase/performance",RV="@firebase/performance-compat",PV="@firebase/remote-config",kV="@firebase/remote-config-compat",NV="@firebase/storage",DV="@firebase/storage-compat",bV="@firebase/firestore",MV="@firebase/ai",VV="@firebase/firestore-compat",LV="firebase",FV="12.4.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cm="[DEFAULT]",UV={[Sm]:"fire-core",[dV]:"fire-core-compat",[fV]:"fire-analytics",[hV]:"fire-analytics-compat",[mV]:"fire-app-check",[pV]:"fire-app-check-compat",[gV]:"fire-auth",[_V]:"fire-auth-compat",[yV]:"fire-rtdb",[vV]:"fire-data-connect",[TV]:"fire-rtdb-compat",[EV]:"fire-fn",[IV]:"fire-fn-compat",[wV]:"fire-iid",[SV]:"fire-iid-compat",[CV]:"fire-fcm",[AV]:"fire-fcm-compat",[xV]:"fire-perf",[RV]:"fire-perf-compat",[PV]:"fire-rc",[kV]:"fire-rc-compat",[NV]:"fire-gcs",[DV]:"fire-gcs-compat",[bV]:"fire-fst",[VV]:"fire-fst-compat",[MV]:"fire-vertex","fire-js":"fire-js",[LV]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zd=new Map,OV=new Map,Am=new Map;function ZT(t,e){try{t.container.addComponent(e)}catch(n){Xr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Ca(t){const e=t.name;if(Am.has(e))return Xr.debug(`There were multiple attempts to register component ${e}.`),!1;Am.set(e,t);for(const n of Zd.values())ZT(n,t);for(const n of OV.values())ZT(n,t);return!0}function l_(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function er(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BV={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Bi=new $u("app","Firebase",BV);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qV{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new no("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Bi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ja=FV;function ZC(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:Cm,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw Bi.create("bad-app-name",{appName:String(i)});if(n||(n=zC()),!n)throw Bi.create("no-options");const s=Zd.get(i);if(s){if(to(n,s.options)&&to(r,s.config))return s;throw Bi.create("duplicate-app",{appName:i})}const o=new K2(i);for(const l of Am.values())o.addComponent(l);const a=new qV(n,r,o);return Zd.set(i,a),a}function e0(t=Cm){const e=Zd.get(t);if(!e&&t===Cm&&zC())return ZC();if(!e)throw Bi.create("no-app",{appName:t});return e}function qi(t,e,n){let r=UV[t]??t;n&&(r+=`-${n}`);const i=r.match(/\s|\//),s=e.match(/\s|\//);if(i||s){const o=[`Unable to register library "${r}" with version "${e}":`];i&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Xr.warn(o.join(" "));return}Ca(new no(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GV="firebase-heartbeat-database",zV=1,Su="firebase-heartbeat-store";let cp=null;function t0(){return cp||(cp=oV(GV,zV,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Su)}catch(n){console.warn(n)}}}}).catch(t=>{throw Bi.create("idb-open",{originalErrorMessage:t.message})})),cp}async function $V(t){try{const n=(await t0()).transaction(Su),r=await n.objectStore(Su).get(n0(t));return await n.done,r}catch(e){if(e instanceof ii)Xr.warn(e.message);else{const n=Bi.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Xr.warn(n.message)}}}async function eE(t,e){try{const r=(await t0()).transaction(Su,"readwrite");await r.objectStore(Su).put(e,n0(t)),await r.done}catch(n){if(n instanceof ii)Xr.warn(n.message);else{const r=Bi.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Xr.warn(r.message)}}}function n0(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HV=1024,WV=30;class KV{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new JV(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=tE();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>WV){const o=QV(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Xr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=tE(),{heartbeatsToSend:r,unsentEntries:i}=jV(this._heartbeatsCache.heartbeats),s=Xd(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return Xr.warn(n),""}}}function tE(){return new Date().toISOString().substring(0,10)}function jV(t,e=HV){const n=[];let r=t.slice();for(const i of t){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),nE(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),nE(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class JV{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return QC()?L2().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await $V(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return eE(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return eE(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function nE(t){return Xd(JSON.stringify({version:2,heartbeats:t})).length}function QV(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YV(t){Ca(new no("platform-logger",e=>new uV(e),"PRIVATE")),Ca(new no("heartbeat",e=>new KV(e),"PRIVATE")),qi(Sm,XT,t),qi(Sm,XT,"esm2020"),qi("fire-js","")}YV("");var XV="firebase",ZV="12.4.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */qi(XV,ZV,"app");function r0(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const eL=r0,i0=new $u("auth","Firebase",r0());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eh=new o_("@firebase/auth");function tL(t,...e){eh.logLevel<=be.WARN&&eh.warn(`Auth (${ja}): ${t}`,...e)}function cd(t,...e){eh.logLevel<=be.ERROR&&eh.error(`Auth (${ja}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pr(t,...e){throw c_(t,...e)}function ir(t,...e){return c_(t,...e)}function u_(t,e,n){const r={...eL(),[e]:n};return new $u("auth","Firebase",r).create(e,{appName:t.name})}function $s(t){return u_(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function nL(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&Pr(t,"argument-error"),u_(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function c_(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return i0.create(t,...e)}function we(t,e,...n){if(!t)throw c_(e,...n)}function zr(t){const e="INTERNAL ASSERTION FAILED: "+t;throw cd(e),new Error(e)}function Zr(t,e){t||zr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xm(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function rL(){return rE()==="http:"||rE()==="https:"}function rE(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iL(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(rL()||b2()||"connection"in navigator)?navigator.onLine:!0}function sL(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wu{constructor(e,n){this.shortDelay=e,this.longDelay=n,Zr(n>e,"Short delay should be less than long delay!"),this.isMobile=N2()||M2()}get(){return iL()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d_(t,e){Zr(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s0{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;zr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;zr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;zr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oL={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aL=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],lL=new Wu(3e4,6e4);function h_(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function Ja(t,e,n,r,i={}){return o0(t,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const a=Hu({key:t.config.apiKey,...o}).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const u={method:e,headers:l,...s};return D2()||(u.referrerPolicy="no-referrer"),t.emulatorConfig&&Ka(t.emulatorConfig.host)&&(u.credentials="include"),s0.fetch()(await a0(t,t.config.apiHost,n,a),u)})}async function o0(t,e,n){t._canInitEmulator=!1;const r={...oL,...e};try{const i=new cL(t),s=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw Gc(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[l,u]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Gc(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw Gc(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw Gc(t,"user-disabled",o);const f=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw u_(t,f,u);Pr(t,f)}}catch(i){if(i instanceof ii)throw i;Pr(t,"network-request-failed",{message:String(i)})}}async function uL(t,e,n,r,i={}){const s=await Ja(t,e,n,r,i);return"mfaPendingCredential"in s&&Pr(t,"multi-factor-auth-required",{_serverResponse:s}),s}async function a0(t,e,n,r){const i=`${e}${n}?${r}`,s=t,o=s.config.emulator?d_(t.config,i):`${t.config.apiScheme}://${i}`;return aL.includes(n)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}class cL{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(ir(this.auth,"network-request-failed")),lL.get())})}}function Gc(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=ir(t,e,r);return i.customData._tokenResponse=n,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dL(t,e){return Ja(t,"POST","/v1/accounts:delete",e)}async function th(t,e){return Ja(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ql(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function hL(t,e=!1){const n=Pt(t),r=await n.getIdToken(e),i=f_(r);we(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:Ql(dp(i.auth_time)),issuedAtTime:Ql(dp(i.iat)),expirationTime:Ql(dp(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function dp(t){return Number(t)*1e3}function f_(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return cd("JWT malformed, contained fewer than 3 sections"),null;try{const i=BC(n);return i?JSON.parse(i):(cd("Failed to decode base64 JWT payload"),null)}catch(i){return cd("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function iE(t){const e=f_(t);return we(e,"internal-error"),we(typeof e.exp<"u","internal-error"),we(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Cu(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof ii&&fL(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function fL({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pL{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rm{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ql(this.lastLoginAt),this.creationTime=Ql(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nh(t){var p;const e=t.auth,n=await t.getIdToken(),r=await Cu(t,th(e,{idToken:n}));we(r==null?void 0:r.users.length,e,"internal-error");const i=r.users[0];t._notifyReloadListener(i);const s=(p=i.providerUserInfo)!=null&&p.length?l0(i.providerUserInfo):[],o=gL(t.providerData,s),a=t.isAnonymous,l=!(t.email&&i.passwordHash)&&!(o!=null&&o.length),u=a?l:!1,f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new Rm(i.createdAt,i.lastLoginAt),isAnonymous:u};Object.assign(t,f)}async function mL(t){const e=Pt(t);await nh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function gL(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function l0(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _L(t,e){const n=await o0(t,{},async()=>{const r=Hu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,o=await a0(t,i,"/v1/token",`key=${s}`),a=await t._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:a,body:r};return t.emulatorConfig&&Ka(t.emulatorConfig.host)&&(l.credentials="include"),s0.fetch()(o,l)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function yL(t,e){return Ja(t,"POST","/v2/accounts:revokeToken",h_(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pa{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){we(e.idToken,"internal-error"),we(typeof e.idToken<"u","internal-error"),we(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):iE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){we(e.length!==0,"internal-error");const n=iE(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(we(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:s}=await _L(e,n);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:s}=n,o=new pa;return r&&(we(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(we(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(we(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new pa,this.toJSON())}_performRefresh(){return zr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pi(t,e){we(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class tr{constructor({uid:e,auth:n,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new pL(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Rm(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await Cu(this,this.stsTokenManager.getToken(this.auth,e));return we(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return hL(this,e)}reload(){return mL(this)}_assign(e){this!==e&&(we(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new tr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){we(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await nh(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(er(this.auth.app))return Promise.reject($s(this.auth));const e=await this.getIdToken();return await Cu(this,dL(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,i=n.email??void 0,s=n.phoneNumber??void 0,o=n.photoURL??void 0,a=n.tenantId??void 0,l=n._redirectEventId??void 0,u=n.createdAt??void 0,f=n.lastLoginAt??void 0,{uid:p,emailVerified:g,isAnonymous:v,providerData:E,stsTokenManager:x}=n;we(p&&x,e,"internal-error");const b=pa.fromJSON(this.name,x);we(typeof p=="string",e,"internal-error"),pi(r,e.name),pi(i,e.name),we(typeof g=="boolean",e,"internal-error"),we(typeof v=="boolean",e,"internal-error"),pi(s,e.name),pi(o,e.name),pi(a,e.name),pi(l,e.name),pi(u,e.name),pi(f,e.name);const C=new tr({uid:p,auth:e,email:i,emailVerified:g,displayName:r,isAnonymous:v,photoURL:o,phoneNumber:s,tenantId:a,stsTokenManager:b,createdAt:u,lastLoginAt:f});return E&&Array.isArray(E)&&(C.providerData=E.map(I=>({...I}))),l&&(C._redirectEventId=l),C}static async _fromIdTokenResponse(e,n,r=!1){const i=new pa;i.updateFromServerResponse(n);const s=new tr({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await nh(s),s}static async _fromGetAccountInfoResponse(e,n,r){const i=n.users[0];we(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?l0(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),a=new pa;a.updateFromIdToken(r);const l=new tr({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Rm(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(l,u),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sE=new Map;function $r(t){Zr(t instanceof Function,"Expected a class definition");let e=sE.get(t);return e?(Zr(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,sE.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u0{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}u0.type="NONE";const oE=u0;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dd(t,e,n){return`firebase:${t}:${e}:${n}`}class ma{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=dd(this.userKey,i.apiKey,s),this.fullPersistenceKey=dd("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await th(this.auth,{idToken:e}).catch(()=>{});return n?tr._fromGetAccountInfoResponse(this.auth,n,e):null}return tr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new ma($r(oE),e,r);const i=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let s=i[0]||$r(oE);const o=dd(r,e.config.apiKey,e.name);let a=null;for(const u of n)try{const f=await u._get(o);if(f){let p;if(typeof f=="string"){const g=await th(e,{idToken:f}).catch(()=>{});if(!g)break;p=await tr._fromGetAccountInfoResponse(e,g,f)}else p=tr._fromJSON(e,f);u!==s&&(a=p),s=u;break}}catch{}const l=i.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new ma(s,e,r):(s=l[0],a&&await s._set(o,a.toJSON()),await Promise.all(n.map(async u=>{if(u!==s)try{await u._remove(o)}catch{}})),new ma(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aE(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(f0(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(c0(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(m0(e))return"Blackberry";if(g0(e))return"Webos";if(d0(e))return"Safari";if((e.includes("chrome/")||h0(e))&&!e.includes("edge/"))return"Chrome";if(p0(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function c0(t=Rt()){return/firefox\//i.test(t)}function d0(t=Rt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function h0(t=Rt()){return/crios\//i.test(t)}function f0(t=Rt()){return/iemobile/i.test(t)}function p0(t=Rt()){return/android/i.test(t)}function m0(t=Rt()){return/blackberry/i.test(t)}function g0(t=Rt()){return/webos/i.test(t)}function p_(t=Rt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function vL(t=Rt()){var e;return p_(t)&&!!((e=window.navigator)!=null&&e.standalone)}function TL(){return V2()&&document.documentMode===10}function _0(t=Rt()){return p_(t)||p0(t)||g0(t)||m0(t)||/windows phone/i.test(t)||f0(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y0(t,e=[]){let n;switch(t){case"Browser":n=aE(Rt());break;case"Worker":n=`${aE(Rt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${ja}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EL{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=s=>new Promise((o,a)=>{try{const l=e(s);o(l)}catch(l){a(l)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function IL(t,e={}){return Ja(t,"GET","/v2/passwordPolicy",h_(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wL=6;class SL{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??wL,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CL{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new lE(this),this.idTokenSubscription=new lE(this),this.beforeStateQueue=new EL(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=i0,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=$r(n)),this._initializationPromise=this.queue(async()=>{var r,i,s;if(!this._deleted&&(this.persistenceManager=await ma.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((i=this._popupRedirectResolver)!=null&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)==null?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await th(this,{idToken:e}),r=await tr._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var s;if(er(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(s=this.redirectUser)==null?void 0:s._redirectEventId,a=r==null?void 0:r._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(r=l.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return we(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await nh(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=sL()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(er(this.app))return Promise.reject($s(this));const n=e?Pt(e):null;return n&&we(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&we(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return er(this.app)?Promise.reject($s(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return er(this.app)?Promise.reject($s(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence($r(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await IL(this),n=new SL(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new $u("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await yL(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&$r(e)||this._popupRedirectResolver;we(n,this,"argument-error"),this.redirectPersistenceManager=await ma.create(this,[$r(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(we(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,r,i);return()=>{o=!0,l()}}else{const l=e.addObserver(n);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return we(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=y0(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var i;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((i=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:i.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if(er(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&tL(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Hh(t){return Pt(t)}class lE{constructor(e){this.auth=e,this.observer=null,this.addObserver=q2(n=>this.observer=n)}get next(){return we(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let m_={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function AL(t){m_=t}function xL(t){return m_.loadJS(t)}function RL(){return m_.gapiScript}function PL(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kL(t,e){const n=l_(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),s=n.getOptions();if(to(s,e??{}))return i;Pr(i,"already-initialized")}return n.initialize({options:e})}function NL(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map($r);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function DL(t,e,n){const r=Hh(t);we(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,s=v0(e),{host:o,port:a}=bL(e),l=a===null?"":`:${a}`,u={url:`${s}//${o}${l}/`},f=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){we(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),we(to(u,r.config.emulator)&&to(f,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=u,r.emulatorConfig=f,r.settings.appVerificationDisabledForTesting=!0,Ka(o)?(HC(`${s}//${o}${l}`),WC("Auth",!0)):ML()}function v0(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function bL(t){const e=v0(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:uE(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:uE(o)}}}function uE(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function ML(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T0{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return zr("not implemented")}_getIdTokenResponse(e){return zr("not implemented")}_linkToIdToken(e,n){return zr("not implemented")}_getReauthenticationResolver(e){return zr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ga(t,e){return uL(t,"POST","/v1/accounts:signInWithIdp",h_(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VL="http://localhost";class ro extends T0{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new ro(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Pr("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...s}=n;if(!r||!i)return null;const o=new ro(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return ga(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,ga(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,ga(e,n)}buildRequest(){const e={requestUri:VL,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Hu(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g_{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ku extends g_{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Si extends Ku{constructor(){super("facebook.com")}static credential(e){return ro._fromParams({providerId:Si.PROVIDER_ID,signInMethod:Si.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Si.credentialFromTaggedObject(e)}static credentialFromError(e){return Si.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Si.credential(e.oauthAccessToken)}catch{return null}}}Si.FACEBOOK_SIGN_IN_METHOD="facebook.com";Si.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Br extends Ku{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return ro._fromParams({providerId:Br.PROVIDER_ID,signInMethod:Br.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Br.credentialFromTaggedObject(e)}static credentialFromError(e){return Br.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Br.credential(n,r)}catch{return null}}}Br.GOOGLE_SIGN_IN_METHOD="google.com";Br.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ci extends Ku{constructor(){super("github.com")}static credential(e){return ro._fromParams({providerId:Ci.PROVIDER_ID,signInMethod:Ci.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ci.credentialFromTaggedObject(e)}static credentialFromError(e){return Ci.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ci.credential(e.oauthAccessToken)}catch{return null}}}Ci.GITHUB_SIGN_IN_METHOD="github.com";Ci.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ai extends Ku{constructor(){super("twitter.com")}static credential(e,n){return ro._fromParams({providerId:Ai.PROVIDER_ID,signInMethod:Ai.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Ai.credentialFromTaggedObject(e)}static credentialFromError(e){return Ai.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Ai.credential(n,r)}catch{return null}}}Ai.TWITTER_SIGN_IN_METHOD="twitter.com";Ai.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aa{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const s=await tr._fromIdTokenResponse(e,r,i),o=cE(r);return new Aa({user:s,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=cE(r);return new Aa({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function cE(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rh extends ii{constructor(e,n,r,i){super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,rh.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new rh(e,n,r,i)}}function E0(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?rh._fromErrorAndOperation(t,s,e,r):s})}async function LL(t,e,n=!1){const r=await Cu(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Aa._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function FL(t,e,n=!1){const{auth:r}=t;if(er(r.app))return Promise.reject($s(r));const i="reauthenticate";try{const s=await Cu(t,E0(r,i,e,t),n);we(s.idToken,r,"internal-error");const o=f_(s.idToken);we(o,r,"internal-error");const{sub:a}=o;return we(t.uid===a,r,"user-mismatch"),Aa._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&Pr(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UL(t,e,n=!1){if(er(t.app))return Promise.reject($s(t));const r="signIn",i=await E0(t,r,e),s=await Aa._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(s.user),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OL(t,e){return Pt(t).setPersistence(e)}function BL(t,e,n,r){return Pt(t).onIdTokenChanged(e,n,r)}function qL(t,e,n){return Pt(t).beforeAuthStateChanged(e,n)}function GL(t,e,n,r){return Pt(t).onAuthStateChanged(e,n,r)}function dE(t){return Pt(t).signOut()}const ih="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I0{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(ih,"1"),this.storage.removeItem(ih),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zL=1e3,$L=10;class w0 extends I0{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=_0(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;n?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);TL()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,$L):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},zL)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}w0.type="LOCAL";const S0=w0;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C0 extends I0{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}C0.type="SESSION";const A0=C0;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HL(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wh{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new Wh(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:s}=n.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const a=Array.from(o).map(async u=>u(n.origin,s)),l=await HL(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Wh.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WL{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,l)=>{const u=__("",20);i.port1.start();const f=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(p){const g=p;if(g.data.eventId===u)switch(g.data.status){case"ack":clearTimeout(f),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(g.data.response);break;default:clearTimeout(f),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xr(){return window}function KL(t){xr().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x0(){return typeof xr().WorkerGlobalScope<"u"&&typeof xr().importScripts=="function"}async function jL(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function JL(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function QL(){return x0()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R0="firebaseLocalStorageDb",YL=1,sh="firebaseLocalStorage",P0="fbase_key";class ju{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Kh(t,e){return t.transaction([sh],e?"readwrite":"readonly").objectStore(sh)}function XL(){const t=indexedDB.deleteDatabase(R0);return new ju(t).toPromise()}function Pm(){const t=indexedDB.open(R0,YL);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(sh,{keyPath:P0})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(sh)?e(r):(r.close(),await XL(),e(await Pm()))})})}async function hE(t,e,n){const r=Kh(t,!0).put({[P0]:e,value:n});return new ju(r).toPromise()}async function ZL(t,e){const n=Kh(t,!1).get(e),r=await new ju(n).toPromise();return r===void 0?null:r.value}function fE(t,e){const n=Kh(t,!0).delete(e);return new ju(n).toPromise()}const eF=800,tF=3;class k0{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Pm(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>tF)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return x0()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Wh._getInstance(QL()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await jL(),!this.activeServiceWorker)return;this.sender=new WL(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||JL()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Pm();return await hE(e,ih,"1"),await fE(e,ih),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>hE(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>ZL(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>fE(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=Kh(i,!1).getAll();return new ju(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),eF)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}k0.type="LOCAL";const nF=k0;new Wu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N0(t,e){return e?$r(e):(we(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y_ extends T0{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ga(e,this._buildIdpRequest())}_linkToIdToken(e,n){return ga(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return ga(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function rF(t){return UL(t.auth,new y_(t),t.bypassAuthState)}function iF(t){const{auth:e,user:n}=t;return we(n,e,"internal-error"),FL(n,new y_(t),t.bypassAuthState)}async function sF(t){const{auth:e,user:n}=t;return we(n,e,"internal-error"),LL(n,new y_(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D0{constructor(e,n,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return rF;case"linkViaPopup":case"linkViaRedirect":return sF;case"reauthViaPopup":case"reauthViaRedirect":return iF;default:Pr(this.auth,"internal-error")}}resolve(e){Zr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Zr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oF=new Wu(2e3,1e4);async function aF(t,e,n){if(er(t.app))return Promise.reject(ir(t,"operation-not-supported-in-this-environment"));const r=Hh(t);nL(t,e,g_);const i=N0(r,n);return new Bs(r,"signInViaPopup",e,i).executeNotNull()}class Bs extends D0{constructor(e,n,r,i,s){super(e,n,i,s),this.provider=r,this.authWindow=null,this.pollId=null,Bs.currentPopupAction&&Bs.currentPopupAction.cancel(),Bs.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return we(e,this.auth,"internal-error"),e}async onExecution(){Zr(this.filter.length===1,"Popup operations only handle one event");const e=__();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(ir(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(ir(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Bs.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ir(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,oF.get())};e()}}Bs.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lF="pendingRedirect",hd=new Map;class uF extends D0{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=hd.get(this.auth._key());if(!e){try{const r=await cF(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}hd.set(this.auth._key(),e)}return this.bypassAuthState||hd.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function cF(t,e){const n=fF(e),r=hF(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}function dF(t,e){hd.set(t._key(),e)}function hF(t){return $r(t._redirectPersistence)}function fF(t){return dd(lF,t.config.apiKey,t.name)}async function pF(t,e,n=!1){if(er(t.app))return Promise.reject($s(t));const r=Hh(t),i=N0(r,e),o=await new uF(r,i,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mF=10*60*1e3;class gF{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!_F(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!b0(e)){const i=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(ir(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=mF&&this.cachedEventUids.clear(),this.cachedEventUids.has(pE(e))}saveEventToCache(e){this.cachedEventUids.add(pE(e)),this.lastProcessedEventTime=Date.now()}}function pE(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function b0({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function _F(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return b0(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yF(t,e={}){return Ja(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vF=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,TF=/^https?/;async function EF(t){if(t.config.emulator)return;const{authorizedDomains:e}=await yF(t);for(const n of e)try{if(IF(n))return}catch{}Pr(t,"unauthorized-domain")}function IF(t){const e=xm(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!TF.test(n))return!1;if(vF.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wF=new Wu(3e4,6e4);function mE(){const t=xr().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function SF(t){return new Promise((e,n)=>{var i,s,o;function r(){mE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{mE(),n(ir(t,"network-request-failed"))},timeout:wF.get()})}if((s=(i=xr().gapi)==null?void 0:i.iframes)!=null&&s.Iframe)e(gapi.iframes.getContext());else if((o=xr().gapi)!=null&&o.load)r();else{const a=PL("iframefcb");return xr()[a]=()=>{gapi.load?r():n(ir(t,"network-request-failed"))},xL(`${RL()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw fd=null,e})}let fd=null;function CF(t){return fd=fd||SF(t),fd}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AF=new Wu(5e3,15e3),xF="__/auth/iframe",RF="emulator/auth/iframe",PF={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},kF=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function NF(t){const e=t.config;we(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?d_(e,RF):`https://${t.config.authDomain}/${xF}`,r={apiKey:e.apiKey,appName:t.name,v:ja},i=kF.get(t.config.apiHost);i&&(r.eid=i);const s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${Hu(r).slice(1)}`}async function DF(t){const e=await CF(t),n=xr().gapi;return we(n,t,"internal-error"),e.open({where:document.body,url:NF(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:PF,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=ir(t,"network-request-failed"),a=xr().setTimeout(()=>{s(o)},AF.get());function l(){xr().clearTimeout(a),i(r)}r.ping(l).then(l,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bF={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},MF=500,VF=600,LF="_blank",FF="http://localhost";class gE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function UF(t,e,n,r=MF,i=VF){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l={...bF,width:r.toString(),height:i.toString(),top:s,left:o},u=Rt().toLowerCase();n&&(a=h0(u)?LF:n),c0(u)&&(e=e||FF,l.scrollbars="yes");const f=Object.entries(l).reduce((g,[v,E])=>`${g}${v}=${E},`,"");if(vL(u)&&a!=="_self")return OF(e||"",a),new gE(null);const p=window.open(e||"",a,f);we(p,t,"popup-blocked");try{p.focus()}catch{}return new gE(p)}function OF(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BF="__/auth/handler",qF="emulator/auth/handler",GF=encodeURIComponent("fac");async function _E(t,e,n,r,i,s){we(t.config.authDomain,t,"auth-domain-config-required"),we(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:ja,eventId:i};if(e instanceof g_){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",B2(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,p]of Object.entries({}))o[f]=p}if(e instanceof Ku){const f=e.getScopes().filter(p=>p!=="");f.length>0&&(o.scopes=f.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const f of Object.keys(a))a[f]===void 0&&delete a[f];const l=await t._getAppCheckToken(),u=l?`#${GF}=${encodeURIComponent(l)}`:"";return`${zF(t)}?${Hu(a).slice(1)}${u}`}function zF({config:t}){return t.emulator?d_(t,qF):`https://${t.authDomain}/${BF}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hp="webStorageSupport";class $F{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=A0,this._completeRedirectFn=pF,this._overrideRedirectResult=dF}async _openPopup(e,n,r,i){var o;Zr((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const s=await _E(e,n,r,xm(),i);return UF(e,s,__())}async _openRedirect(e,n,r,i){await this._originValidation(e);const s=await _E(e,n,r,xm(),i);return KL(s),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:s}=this.eventManagers[n];return i?Promise.resolve(i):(Zr(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await DF(e),r=new gF(e);return n.register("authEvent",i=>(we(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(hp,{type:hp},i=>{var o;const s=(o=i==null?void 0:i[0])==null?void 0:o[hp];s!==void 0&&n(!!s),Pr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=EF(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return _0()||d0()||p_()}}const HF=$F;var yE="@firebase/auth",vE="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WF{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){we(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KF(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function jF(t){Ca(new no("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;we(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:y0(t)},u=new CL(r,i,s,l);return NL(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Ca(new no("auth-internal",e=>{const n=Hh(e.getProvider("auth").getImmediate());return(r=>new WF(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),qi(yE,vE,KF(t)),qi(yE,vE,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JF=5*60,QF=$C("authIdTokenMaxAge")||JF;let TE=null;const YF=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>QF)return;const i=n==null?void 0:n.token;TE!==i&&(TE=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function XF(t=e0()){const e=l_(t,"auth");if(e.isInitialized())return e.getImmediate();const n=kL(t,{popupRedirectResolver:HF,persistence:[nF,S0,A0]}),r=$C("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const o=YF(s.toString());qL(n,o,()=>o(n.currentUser)),BL(n,a=>o(a))}}const i=GC("auth");return i&&DL(n,`http://${i}`),n}function ZF(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}AL({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const s=ir("internal-error");s.customData=i,n(s)},r.type="text/javascript",r.charset="UTF-8",ZF().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});jF("Browser");var EE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Gi,M0;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(T,w){function A(){}A.prototype=w.prototype,T.F=w.prototype,T.prototype=new A,T.prototype.constructor=T,T.D=function(k,D,L){for(var N=Array(arguments.length-2),Ve=2;Ve<arguments.length;Ve++)N[Ve-2]=arguments[Ve];return w.prototype[D].apply(k,N)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(T,w,A){A||(A=0);const k=Array(16);if(typeof w=="string")for(var D=0;D<16;++D)k[D]=w.charCodeAt(A++)|w.charCodeAt(A++)<<8|w.charCodeAt(A++)<<16|w.charCodeAt(A++)<<24;else for(D=0;D<16;++D)k[D]=w[A++]|w[A++]<<8|w[A++]<<16|w[A++]<<24;w=T.g[0],A=T.g[1],D=T.g[2];let L=T.g[3],N;N=w+(L^A&(D^L))+k[0]+3614090360&4294967295,w=A+(N<<7&4294967295|N>>>25),N=L+(D^w&(A^D))+k[1]+3905402710&4294967295,L=w+(N<<12&4294967295|N>>>20),N=D+(A^L&(w^A))+k[2]+606105819&4294967295,D=L+(N<<17&4294967295|N>>>15),N=A+(w^D&(L^w))+k[3]+3250441966&4294967295,A=D+(N<<22&4294967295|N>>>10),N=w+(L^A&(D^L))+k[4]+4118548399&4294967295,w=A+(N<<7&4294967295|N>>>25),N=L+(D^w&(A^D))+k[5]+1200080426&4294967295,L=w+(N<<12&4294967295|N>>>20),N=D+(A^L&(w^A))+k[6]+2821735955&4294967295,D=L+(N<<17&4294967295|N>>>15),N=A+(w^D&(L^w))+k[7]+4249261313&4294967295,A=D+(N<<22&4294967295|N>>>10),N=w+(L^A&(D^L))+k[8]+1770035416&4294967295,w=A+(N<<7&4294967295|N>>>25),N=L+(D^w&(A^D))+k[9]+2336552879&4294967295,L=w+(N<<12&4294967295|N>>>20),N=D+(A^L&(w^A))+k[10]+4294925233&4294967295,D=L+(N<<17&4294967295|N>>>15),N=A+(w^D&(L^w))+k[11]+2304563134&4294967295,A=D+(N<<22&4294967295|N>>>10),N=w+(L^A&(D^L))+k[12]+1804603682&4294967295,w=A+(N<<7&4294967295|N>>>25),N=L+(D^w&(A^D))+k[13]+4254626195&4294967295,L=w+(N<<12&4294967295|N>>>20),N=D+(A^L&(w^A))+k[14]+2792965006&4294967295,D=L+(N<<17&4294967295|N>>>15),N=A+(w^D&(L^w))+k[15]+1236535329&4294967295,A=D+(N<<22&4294967295|N>>>10),N=w+(D^L&(A^D))+k[1]+4129170786&4294967295,w=A+(N<<5&4294967295|N>>>27),N=L+(A^D&(w^A))+k[6]+3225465664&4294967295,L=w+(N<<9&4294967295|N>>>23),N=D+(w^A&(L^w))+k[11]+643717713&4294967295,D=L+(N<<14&4294967295|N>>>18),N=A+(L^w&(D^L))+k[0]+3921069994&4294967295,A=D+(N<<20&4294967295|N>>>12),N=w+(D^L&(A^D))+k[5]+3593408605&4294967295,w=A+(N<<5&4294967295|N>>>27),N=L+(A^D&(w^A))+k[10]+38016083&4294967295,L=w+(N<<9&4294967295|N>>>23),N=D+(w^A&(L^w))+k[15]+3634488961&4294967295,D=L+(N<<14&4294967295|N>>>18),N=A+(L^w&(D^L))+k[4]+3889429448&4294967295,A=D+(N<<20&4294967295|N>>>12),N=w+(D^L&(A^D))+k[9]+568446438&4294967295,w=A+(N<<5&4294967295|N>>>27),N=L+(A^D&(w^A))+k[14]+3275163606&4294967295,L=w+(N<<9&4294967295|N>>>23),N=D+(w^A&(L^w))+k[3]+4107603335&4294967295,D=L+(N<<14&4294967295|N>>>18),N=A+(L^w&(D^L))+k[8]+1163531501&4294967295,A=D+(N<<20&4294967295|N>>>12),N=w+(D^L&(A^D))+k[13]+2850285829&4294967295,w=A+(N<<5&4294967295|N>>>27),N=L+(A^D&(w^A))+k[2]+4243563512&4294967295,L=w+(N<<9&4294967295|N>>>23),N=D+(w^A&(L^w))+k[7]+1735328473&4294967295,D=L+(N<<14&4294967295|N>>>18),N=A+(L^w&(D^L))+k[12]+2368359562&4294967295,A=D+(N<<20&4294967295|N>>>12),N=w+(A^D^L)+k[5]+4294588738&4294967295,w=A+(N<<4&4294967295|N>>>28),N=L+(w^A^D)+k[8]+2272392833&4294967295,L=w+(N<<11&4294967295|N>>>21),N=D+(L^w^A)+k[11]+1839030562&4294967295,D=L+(N<<16&4294967295|N>>>16),N=A+(D^L^w)+k[14]+4259657740&4294967295,A=D+(N<<23&4294967295|N>>>9),N=w+(A^D^L)+k[1]+2763975236&4294967295,w=A+(N<<4&4294967295|N>>>28),N=L+(w^A^D)+k[4]+1272893353&4294967295,L=w+(N<<11&4294967295|N>>>21),N=D+(L^w^A)+k[7]+4139469664&4294967295,D=L+(N<<16&4294967295|N>>>16),N=A+(D^L^w)+k[10]+3200236656&4294967295,A=D+(N<<23&4294967295|N>>>9),N=w+(A^D^L)+k[13]+681279174&4294967295,w=A+(N<<4&4294967295|N>>>28),N=L+(w^A^D)+k[0]+3936430074&4294967295,L=w+(N<<11&4294967295|N>>>21),N=D+(L^w^A)+k[3]+3572445317&4294967295,D=L+(N<<16&4294967295|N>>>16),N=A+(D^L^w)+k[6]+76029189&4294967295,A=D+(N<<23&4294967295|N>>>9),N=w+(A^D^L)+k[9]+3654602809&4294967295,w=A+(N<<4&4294967295|N>>>28),N=L+(w^A^D)+k[12]+3873151461&4294967295,L=w+(N<<11&4294967295|N>>>21),N=D+(L^w^A)+k[15]+530742520&4294967295,D=L+(N<<16&4294967295|N>>>16),N=A+(D^L^w)+k[2]+3299628645&4294967295,A=D+(N<<23&4294967295|N>>>9),N=w+(D^(A|~L))+k[0]+4096336452&4294967295,w=A+(N<<6&4294967295|N>>>26),N=L+(A^(w|~D))+k[7]+1126891415&4294967295,L=w+(N<<10&4294967295|N>>>22),N=D+(w^(L|~A))+k[14]+2878612391&4294967295,D=L+(N<<15&4294967295|N>>>17),N=A+(L^(D|~w))+k[5]+4237533241&4294967295,A=D+(N<<21&4294967295|N>>>11),N=w+(D^(A|~L))+k[12]+1700485571&4294967295,w=A+(N<<6&4294967295|N>>>26),N=L+(A^(w|~D))+k[3]+2399980690&4294967295,L=w+(N<<10&4294967295|N>>>22),N=D+(w^(L|~A))+k[10]+4293915773&4294967295,D=L+(N<<15&4294967295|N>>>17),N=A+(L^(D|~w))+k[1]+2240044497&4294967295,A=D+(N<<21&4294967295|N>>>11),N=w+(D^(A|~L))+k[8]+1873313359&4294967295,w=A+(N<<6&4294967295|N>>>26),N=L+(A^(w|~D))+k[15]+4264355552&4294967295,L=w+(N<<10&4294967295|N>>>22),N=D+(w^(L|~A))+k[6]+2734768916&4294967295,D=L+(N<<15&4294967295|N>>>17),N=A+(L^(D|~w))+k[13]+1309151649&4294967295,A=D+(N<<21&4294967295|N>>>11),N=w+(D^(A|~L))+k[4]+4149444226&4294967295,w=A+(N<<6&4294967295|N>>>26),N=L+(A^(w|~D))+k[11]+3174756917&4294967295,L=w+(N<<10&4294967295|N>>>22),N=D+(w^(L|~A))+k[2]+718787259&4294967295,D=L+(N<<15&4294967295|N>>>17),N=A+(L^(D|~w))+k[9]+3951481745&4294967295,T.g[0]=T.g[0]+w&4294967295,T.g[1]=T.g[1]+(D+(N<<21&4294967295|N>>>11))&4294967295,T.g[2]=T.g[2]+D&4294967295,T.g[3]=T.g[3]+L&4294967295}r.prototype.v=function(T,w){w===void 0&&(w=T.length);const A=w-this.blockSize,k=this.C;let D=this.h,L=0;for(;L<w;){if(D==0)for(;L<=A;)i(this,T,L),L+=this.blockSize;if(typeof T=="string"){for(;L<w;)if(k[D++]=T.charCodeAt(L++),D==this.blockSize){i(this,k),D=0;break}}else for(;L<w;)if(k[D++]=T[L++],D==this.blockSize){i(this,k),D=0;break}}this.h=D,this.o+=w},r.prototype.A=function(){var T=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);T[0]=128;for(var w=1;w<T.length-8;++w)T[w]=0;w=this.o*8;for(var A=T.length-8;A<T.length;++A)T[A]=w&255,w/=256;for(this.v(T),T=Array(16),w=0,A=0;A<4;++A)for(let k=0;k<32;k+=8)T[w++]=this.g[A]>>>k&255;return T};function s(T,w){var A=a;return Object.prototype.hasOwnProperty.call(A,T)?A[T]:A[T]=w(T)}function o(T,w){this.h=w;const A=[];let k=!0;for(let D=T.length-1;D>=0;D--){const L=T[D]|0;k&&L==w||(A[D]=L,k=!1)}this.g=A}var a={};function l(T){return-128<=T&&T<128?s(T,function(w){return new o([w|0],w<0?-1:0)}):new o([T|0],T<0?-1:0)}function u(T){if(isNaN(T)||!isFinite(T))return p;if(T<0)return b(u(-T));const w=[];let A=1;for(let k=0;T>=A;k++)w[k]=T/A|0,A*=4294967296;return new o(w,0)}function f(T,w){if(T.length==0)throw Error("number format error: empty string");if(w=w||10,w<2||36<w)throw Error("radix out of range: "+w);if(T.charAt(0)=="-")return b(f(T.substring(1),w));if(T.indexOf("-")>=0)throw Error('number format error: interior "-" character');const A=u(Math.pow(w,8));let k=p;for(let L=0;L<T.length;L+=8){var D=Math.min(8,T.length-L);const N=parseInt(T.substring(L,L+D),w);D<8?(D=u(Math.pow(w,D)),k=k.j(D).add(u(N))):(k=k.j(A),k=k.add(u(N)))}return k}var p=l(0),g=l(1),v=l(16777216);t=o.prototype,t.m=function(){if(x(this))return-b(this).m();let T=0,w=1;for(let A=0;A<this.g.length;A++){const k=this.i(A);T+=(k>=0?k:4294967296+k)*w,w*=4294967296}return T},t.toString=function(T){if(T=T||10,T<2||36<T)throw Error("radix out of range: "+T);if(E(this))return"0";if(x(this))return"-"+b(this).toString(T);const w=u(Math.pow(T,6));var A=this;let k="";for(;;){const D=V(A,w).g;A=C(A,D.j(w));let L=((A.g.length>0?A.g[0]:A.h)>>>0).toString(T);if(A=D,E(A))return L+k;for(;L.length<6;)L="0"+L;k=L+k}},t.i=function(T){return T<0?0:T<this.g.length?this.g[T]:this.h};function E(T){if(T.h!=0)return!1;for(let w=0;w<T.g.length;w++)if(T.g[w]!=0)return!1;return!0}function x(T){return T.h==-1}t.l=function(T){return T=C(this,T),x(T)?-1:E(T)?0:1};function b(T){const w=T.g.length,A=[];for(let k=0;k<w;k++)A[k]=~T.g[k];return new o(A,~T.h).add(g)}t.abs=function(){return x(this)?b(this):this},t.add=function(T){const w=Math.max(this.g.length,T.g.length),A=[];let k=0;for(let D=0;D<=w;D++){let L=k+(this.i(D)&65535)+(T.i(D)&65535),N=(L>>>16)+(this.i(D)>>>16)+(T.i(D)>>>16);k=N>>>16,L&=65535,N&=65535,A[D]=N<<16|L}return new o(A,A[A.length-1]&-2147483648?-1:0)};function C(T,w){return T.add(b(w))}t.j=function(T){if(E(this)||E(T))return p;if(x(this))return x(T)?b(this).j(b(T)):b(b(this).j(T));if(x(T))return b(this.j(b(T)));if(this.l(v)<0&&T.l(v)<0)return u(this.m()*T.m());const w=this.g.length+T.g.length,A=[];for(var k=0;k<2*w;k++)A[k]=0;for(k=0;k<this.g.length;k++)for(let D=0;D<T.g.length;D++){const L=this.i(k)>>>16,N=this.i(k)&65535,Ve=T.i(D)>>>16,Ze=T.i(D)&65535;A[2*k+2*D]+=N*Ze,I(A,2*k+2*D),A[2*k+2*D+1]+=L*Ze,I(A,2*k+2*D+1),A[2*k+2*D+1]+=N*Ve,I(A,2*k+2*D+1),A[2*k+2*D+2]+=L*Ve,I(A,2*k+2*D+2)}for(T=0;T<w;T++)A[T]=A[2*T+1]<<16|A[2*T];for(T=w;T<2*w;T++)A[T]=0;return new o(A,0)};function I(T,w){for(;(T[w]&65535)!=T[w];)T[w+1]+=T[w]>>>16,T[w]&=65535,w++}function S(T,w){this.g=T,this.h=w}function V(T,w){if(E(w))throw Error("division by zero");if(E(T))return new S(p,p);if(x(T))return w=V(b(T),w),new S(b(w.g),b(w.h));if(x(w))return w=V(T,b(w)),new S(b(w.g),w.h);if(T.g.length>30){if(x(T)||x(w))throw Error("slowDivide_ only works with positive integers.");for(var A=g,k=w;k.l(T)<=0;)A=U(A),k=U(k);var D=B(A,1),L=B(k,1);for(k=B(k,2),A=B(A,2);!E(k);){var N=L.add(k);N.l(T)<=0&&(D=D.add(A),L=N),k=B(k,1),A=B(A,1)}return w=C(T,D.j(w)),new S(D,w)}for(D=p;T.l(w)>=0;){for(A=Math.max(1,Math.floor(T.m()/w.m())),k=Math.ceil(Math.log(A)/Math.LN2),k=k<=48?1:Math.pow(2,k-48),L=u(A),N=L.j(w);x(N)||N.l(T)>0;)A-=k,L=u(A),N=L.j(w);E(L)&&(L=g),D=D.add(L),T=C(T,N)}return new S(D,T)}t.B=function(T){return V(this,T).h},t.and=function(T){const w=Math.max(this.g.length,T.g.length),A=[];for(let k=0;k<w;k++)A[k]=this.i(k)&T.i(k);return new o(A,this.h&T.h)},t.or=function(T){const w=Math.max(this.g.length,T.g.length),A=[];for(let k=0;k<w;k++)A[k]=this.i(k)|T.i(k);return new o(A,this.h|T.h)},t.xor=function(T){const w=Math.max(this.g.length,T.g.length),A=[];for(let k=0;k<w;k++)A[k]=this.i(k)^T.i(k);return new o(A,this.h^T.h)};function U(T){const w=T.g.length+1,A=[];for(let k=0;k<w;k++)A[k]=T.i(k)<<1|T.i(k-1)>>>31;return new o(A,T.h)}function B(T,w){const A=w>>5;w%=32;const k=T.g.length-A,D=[];for(let L=0;L<k;L++)D[L]=w>0?T.i(L+A)>>>w|T.i(L+A+1)<<32-w:T.i(L+A);return new o(D,T.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,M0=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=f,Gi=o}).apply(typeof EE<"u"?EE:typeof self<"u"?self:typeof window<"u"?window:{});var zc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var V0,bl,L0,pd,km,F0,U0,O0;(function(){var t,e=Object.defineProperty;function n(d){d=[typeof globalThis=="object"&&globalThis,d,typeof window=="object"&&window,typeof self=="object"&&self,typeof zc=="object"&&zc];for(var _=0;_<d.length;++_){var y=d[_];if(y&&y.Math==Math)return y}throw Error("Cannot find global object")}var r=n(this);function i(d,_){if(_)e:{var y=r;d=d.split(".");for(var P=0;P<d.length-1;P++){var G=d[P];if(!(G in y))break e;y=y[G]}d=d[d.length-1],P=y[d],_=_(P),_!=P&&_!=null&&e(y,d,{configurable:!0,writable:!0,value:_})}}i("Symbol.dispose",function(d){return d||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(d){return d||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(d){return d||function(_){var y=[],P;for(P in _)Object.prototype.hasOwnProperty.call(_,P)&&y.push([P,_[P]]);return y}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var s=s||{},o=this||self;function a(d){var _=typeof d;return _=="object"&&d!=null||_=="function"}function l(d,_,y){return d.call.apply(d.bind,arguments)}function u(d,_,y){return u=l,u.apply(null,arguments)}function f(d,_){var y=Array.prototype.slice.call(arguments,1);return function(){var P=y.slice();return P.push.apply(P,arguments),d.apply(this,P)}}function p(d,_){function y(){}y.prototype=_.prototype,d.Z=_.prototype,d.prototype=new y,d.prototype.constructor=d,d.Ob=function(P,G,$){for(var ie=Array(arguments.length-2),xe=2;xe<arguments.length;xe++)ie[xe-2]=arguments[xe];return _.prototype[G].apply(P,ie)}}var g=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?d=>d&&AsyncContext.Snapshot.wrap(d):d=>d;function v(d){const _=d.length;if(_>0){const y=Array(_);for(let P=0;P<_;P++)y[P]=d[P];return y}return[]}function E(d,_){for(let P=1;P<arguments.length;P++){const G=arguments[P];var y=typeof G;if(y=y!="object"?y:G?Array.isArray(G)?"array":y:"null",y=="array"||y=="object"&&typeof G.length=="number"){y=d.length||0;const $=G.length||0;d.length=y+$;for(let ie=0;ie<$;ie++)d[y+ie]=G[ie]}else d.push(G)}}class x{constructor(_,y){this.i=_,this.j=y,this.h=0,this.g=null}get(){let _;return this.h>0?(this.h--,_=this.g,this.g=_.next,_.next=null):_=this.i(),_}}function b(d){o.setTimeout(()=>{throw d},0)}function C(){var d=T;let _=null;return d.g&&(_=d.g,d.g=d.g.next,d.g||(d.h=null),_.next=null),_}class I{constructor(){this.h=this.g=null}add(_,y){const P=S.get();P.set(_,y),this.h?this.h.next=P:this.g=P,this.h=P}}var S=new x(()=>new V,d=>d.reset());class V{constructor(){this.next=this.g=this.h=null}set(_,y){this.h=_,this.g=y,this.next=null}reset(){this.next=this.g=this.h=null}}let U,B=!1,T=new I,w=()=>{const d=Promise.resolve(void 0);U=()=>{d.then(A)}};function A(){for(var d;d=C();){try{d.h.call(d.g)}catch(y){b(y)}var _=S;_.j(d),_.h<100&&(_.h++,d.next=_.g,_.g=d)}B=!1}function k(){this.u=this.u,this.C=this.C}k.prototype.u=!1,k.prototype.dispose=function(){this.u||(this.u=!0,this.N())},k.prototype[Symbol.dispose]=function(){this.dispose()},k.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function D(d,_){this.type=d,this.g=this.target=_,this.defaultPrevented=!1}D.prototype.h=function(){this.defaultPrevented=!0};var L=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var d=!1,_=Object.defineProperty({},"passive",{get:function(){d=!0}});try{const y=()=>{};o.addEventListener("test",y,_),o.removeEventListener("test",y,_)}catch{}return d}();function N(d){return/^[\s\xa0]*$/.test(d)}function Ve(d,_){D.call(this,d?d.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,d&&this.init(d,_)}p(Ve,D),Ve.prototype.init=function(d,_){const y=this.type=d.type,P=d.changedTouches&&d.changedTouches.length?d.changedTouches[0]:null;this.target=d.target||d.srcElement,this.g=_,_=d.relatedTarget,_||(y=="mouseover"?_=d.fromElement:y=="mouseout"&&(_=d.toElement)),this.relatedTarget=_,P?(this.clientX=P.clientX!==void 0?P.clientX:P.pageX,this.clientY=P.clientY!==void 0?P.clientY:P.pageY,this.screenX=P.screenX||0,this.screenY=P.screenY||0):(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0),this.button=d.button,this.key=d.key||"",this.ctrlKey=d.ctrlKey,this.altKey=d.altKey,this.shiftKey=d.shiftKey,this.metaKey=d.metaKey,this.pointerId=d.pointerId||0,this.pointerType=d.pointerType,this.state=d.state,this.i=d,d.defaultPrevented&&Ve.Z.h.call(this)},Ve.prototype.h=function(){Ve.Z.h.call(this);const d=this.i;d.preventDefault?d.preventDefault():d.returnValue=!1};var Ze="closure_listenable_"+(Math.random()*1e6|0),je=0;function ye(d,_,y,P,G){this.listener=d,this.proxy=null,this.src=_,this.type=y,this.capture=!!P,this.ha=G,this.key=++je,this.da=this.fa=!1}function Z(d){d.da=!0,d.listener=null,d.proxy=null,d.src=null,d.ha=null}function he(d,_,y){for(const P in d)_.call(y,d[P],P,d)}function ve(d,_){for(const y in d)_.call(void 0,d[y],y,d)}function Ie(d){const _={};for(const y in d)_[y]=d[y];return _}const Oe="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function tt(d,_){let y,P;for(let G=1;G<arguments.length;G++){P=arguments[G];for(y in P)d[y]=P[y];for(let $=0;$<Oe.length;$++)y=Oe[$],Object.prototype.hasOwnProperty.call(P,y)&&(d[y]=P[y])}}function Je(d){this.src=d,this.g={},this.h=0}Je.prototype.add=function(d,_,y,P,G){const $=d.toString();d=this.g[$],d||(d=this.g[$]=[],this.h++);const ie=Qe(d,_,P,G);return ie>-1?(_=d[ie],y||(_.fa=!1)):(_=new ye(_,this.src,$,!!P,G),_.fa=y,d.push(_)),_};function Se(d,_){const y=_.type;if(y in d.g){var P=d.g[y],G=Array.prototype.indexOf.call(P,_,void 0),$;($=G>=0)&&Array.prototype.splice.call(P,G,1),$&&(Z(_),d.g[y].length==0&&(delete d.g[y],d.h--))}}function Qe(d,_,y,P){for(let G=0;G<d.length;++G){const $=d[G];if(!$.da&&$.listener==_&&$.capture==!!y&&$.ha==P)return G}return-1}var Gt="closure_lm_"+(Math.random()*1e6|0),ur={};function zn(d,_,y,P,G){if(Array.isArray(_)){for(let $=0;$<_.length;$++)zn(d,_[$],y,P,G);return null}return y=yn(y),d&&d[Ze]?d.J(_,y,a(P)?!!P.capture:!1,G):kn(d,_,y,!1,P,G)}function kn(d,_,y,P,G,$){if(!_)throw Error("Invalid event type");const ie=a(G)?!!G.capture:!!G;let xe=zt(d);if(xe||(d[Gt]=xe=new Je(d)),y=xe.add(_,y,P,ie,$),y.proxy)return y;if(P=cr(),y.proxy=P,P.src=d,P.listener=y,d.addEventListener)L||(G=ie),G===void 0&&(G=!1),d.addEventListener(_.toString(),P,G);else if(d.attachEvent)d.attachEvent(hr(_.toString()),P);else if(d.addListener&&d.removeListener)d.addListener(P);else throw Error("addEventListener and attachEvent are unavailable.");return y}function cr(){function d(y){return _.call(d.src,d.listener,y)}const _=Re;return d}function dr(d,_,y,P,G){if(Array.isArray(_))for(var $=0;$<_.length;$++)dr(d,_[$],y,P,G);else P=a(P)?!!P.capture:!!P,y=yn(y),d&&d[Ze]?(d=d.i,$=String(_).toString(),$ in d.g&&(_=d.g[$],y=Qe(_,y,P,G),y>-1&&(Z(_[y]),Array.prototype.splice.call(_,y,1),_.length==0&&(delete d.g[$],d.h--)))):d&&(d=zt(d))&&(_=d.g[_.toString()],d=-1,_&&(d=Qe(_,y,P,G)),(y=d>-1?_[d]:null)&&$n(y))}function $n(d){if(typeof d!="number"&&d&&!d.da){var _=d.src;if(_&&_[Ze])Se(_.i,d);else{var y=d.type,P=d.proxy;_.removeEventListener?_.removeEventListener(y,P,d.capture):_.detachEvent?_.detachEvent(hr(y),P):_.addListener&&_.removeListener&&_.removeListener(P),(y=zt(_))?(Se(y,d),y.h==0&&(y.src=null,_[Gt]=null)):Z(d)}}}function hr(d){return d in ur?ur[d]:ur[d]="on"+d}function Re(d,_){if(d.da)d=!0;else{_=new Ve(_,this);const y=d.listener,P=d.ha||d.src;d.fa&&$n(d),d=y.call(P,_)}return d}function zt(d){return d=d[Gt],d instanceof Je?d:null}var Fe="__closure_events_fn_"+(Math.random()*1e9>>>0);function yn(d){return typeof d=="function"?d:(d[Fe]||(d[Fe]=function(_){return d.handleEvent(_)}),d[Fe])}function ot(){k.call(this),this.i=new Je(this),this.M=this,this.G=null}p(ot,k),ot.prototype[Ze]=!0,ot.prototype.removeEventListener=function(d,_,y,P){dr(this,d,_,y,P)};function ze(d,_){var y,P=d.G;if(P)for(y=[];P;P=P.G)y.push(P);if(d=d.M,P=_.type||_,typeof _=="string")_=new D(_,d);else if(_ instanceof D)_.target=_.target||d;else{var G=_;_=new D(P,d),tt(_,G)}G=!0;let $,ie;if(y)for(ie=y.length-1;ie>=0;ie--)$=_.g=y[ie],G=Te($,P,!0,_)&&G;if($=_.g=d,G=Te($,P,!0,_)&&G,G=Te($,P,!1,_)&&G,y)for(ie=0;ie<y.length;ie++)$=_.g=y[ie],G=Te($,P,!1,_)&&G}ot.prototype.N=function(){if(ot.Z.N.call(this),this.i){var d=this.i;for(const _ in d.g){const y=d.g[_];for(let P=0;P<y.length;P++)Z(y[P]);delete d.g[_],d.h--}}this.G=null},ot.prototype.J=function(d,_,y,P){return this.i.add(String(d),_,!1,y,P)},ot.prototype.K=function(d,_,y,P){return this.i.add(String(d),_,!0,y,P)};function Te(d,_,y,P){if(_=d.i.g[String(_)],!_)return!0;_=_.concat();let G=!0;for(let $=0;$<_.length;++$){const ie=_[$];if(ie&&!ie.da&&ie.capture==y){const xe=ie.listener,Ct=ie.ha||ie.src;ie.fa&&Se(d.i,ie),G=xe.call(Ct,P)!==!1&&G}}return G&&!P.defaultPrevented}function cc(d,_){if(typeof d!="function")if(d&&typeof d.handleEvent=="function")d=u(d.handleEvent,d);else throw Error("Invalid listener argument");return Number(_)>2147483647?-1:o.setTimeout(d,_||0)}function go(d){d.g=cc(()=>{d.g=null,d.i&&(d.i=!1,go(d))},d.l);const _=d.h;d.h=null,d.m.apply(null,_)}class ls extends k{constructor(_,y){super(),this.m=_,this.l=y,this.h=null,this.i=!1,this.g=null}j(_){this.h=arguments,this.g?this.i=!0:go(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function fr(d){k.call(this),this.h=d,this.g={}}p(fr,k);var us=[];function ke(d){he(d.g,function(_,y){this.g.hasOwnProperty(y)&&$n(_)},d),d.g={}}fr.prototype.N=function(){fr.Z.N.call(this),ke(this)},fr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var el=o.JSON.stringify,ai=o.JSON.parse,tl=class{stringify(d){return o.JSON.stringify(d,void 0)}parse(d){return o.JSON.parse(d,void 0)}};function _o(){}function nl(){}var li={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function rl(){D.call(this,"d")}p(rl,D);function il(){D.call(this,"c")}p(il,D);var pr={},yo=null;function Hn(){return yo=yo||new ot}pr.Ia="serverreachability";function cs(d){D.call(this,pr.Ia,d)}p(cs,D);function ds(d){const _=Hn();ze(_,new cs(_))}pr.STAT_EVENT="statevent";function sl(d,_){D.call(this,pr.STAT_EVENT,d),this.stat=_}p(sl,D);function gt(d){const _=Hn();ze(_,new sl(_,d))}pr.Ja="timingevent";function hs(d,_){D.call(this,pr.Ja,d),this.size=_}p(hs,D);function Wn(d,_){if(typeof d!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){d()},_)}function fs(){this.g=!0}fs.prototype.ua=function(){this.g=!1};function vo(d,_,y,P,G,$){d.info(function(){if(d.g)if($){var ie="",xe=$.split("&");for(let Xe=0;Xe<xe.length;Xe++){var Ct=xe[Xe].split("=");if(Ct.length>1){const Nt=Ct[0];Ct=Ct[1];const yr=Nt.split("_");ie=yr.length>=2&&yr[1]=="type"?ie+(Nt+"="+Ct+"&"):ie+(Nt+"=redacted&")}}}else ie=null;else ie=$;return"XMLHTTP REQ ("+P+") [attempt "+G+"]: "+_+`
`+y+`
`+ie})}function yf(d,_,y,P,G,$,ie){d.info(function(){return"XMLHTTP RESP ("+P+") [ attempt "+G+"]: "+_+`
`+y+`
`+$+" "+ie})}function Q(d,_,y,P){d.info(function(){return"XMLHTTP TEXT ("+_+"): "+cy(d,y)+(P?" "+P:"")})}function ol(d,_){d.info(function(){return"TIMEOUT: "+_})}fs.prototype.info=function(){};function cy(d,_){if(!d.g)return _;if(!_)return null;try{const $=JSON.parse(_);if($){for(d=0;d<$.length;d++)if(Array.isArray($[d])){var y=$[d];if(!(y.length<2)){var P=y[1];if(Array.isArray(P)&&!(P.length<1)){var G=P[0];if(G!="noop"&&G!="stop"&&G!="close")for(let ie=1;ie<P.length;ie++)P[ie]=""}}}}return el($)}catch{return _}}var al={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},vf={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Tf;function ll(){}p(ll,_o),ll.prototype.g=function(){return new XMLHttpRequest},Tf=new ll;function Dr(d){return encodeURIComponent(String(d))}function Ef(d){var _=1;d=d.split(":");const y=[];for(;_>0&&d.length;)y.push(d.shift()),_--;return d.length&&y.push(d.join(":")),y}function Nn(d,_,y,P){this.j=d,this.i=_,this.l=y,this.S=P||1,this.V=new fr(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new To}function To(){this.i=null,this.g="",this.h=!1}var cn={},ul={};function Eo(d,_,y){d.M=1,d.A=xo(dn(_)),d.u=y,d.R=!0,Io(d,null)}function Io(d,_){d.F=Date.now(),wo(d),d.B=dn(d.A);var y=d.B,P=d.S;Array.isArray(P)||(P=[String(P)]),hl(y.i,"t",P),d.C=0,y=d.j.L,d.h=new To,d.g=my(d.j,y?_:null,!d.u),d.P>0&&(d.O=new ls(u(d.Y,d,d.g),d.P)),_=d.V,y=d.g,P=d.ba;var G="readystatechange";Array.isArray(G)||(G&&(us[0]=G.toString()),G=us);for(let $=0;$<G.length;$++){const ie=zn(y,G[$],P||_.handleEvent,!1,_.h||_);if(!ie)break;_.g[ie.key]=ie}_=d.J?Ie(d.J):{},d.u?(d.v||(d.v="POST"),_["Content-Type"]="application/x-www-form-urlencoded",d.g.ea(d.B,d.v,d.u,_)):(d.v="GET",d.g.ea(d.B,d.v,null,_)),ds(),vo(d.i,d.v,d.B,d.l,d.S,d.u)}Nn.prototype.ba=function(d){d=d.target;const _=this.O;_&&W(d)==3?_.j():this.Y(d)},Nn.prototype.Y=function(d){try{if(d==this.g)e:{const xe=W(this.g),Ct=this.g.ya(),Xe=this.g.ca();if(!(xe<3)&&(xe!=3||this.g&&(this.h.h||this.g.la()||fe(this.g)))){this.K||xe!=4||Ct==7||(Ct==8||Xe<=0?ds(3):ds(2)),ui(this);var _=this.g.ca();this.X=_;var y=If(this);if(this.o=_==200,yf(this.i,this.v,this.B,this.l,this.S,xe,_),this.o){if(this.U&&!this.L){t:{if(this.g){var P,G=this.g;if((P=G.g?G.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!N(P)){var $=P;break t}}$=null}if(d=$)Q(this.i,this.l,d,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,oe(this,d);else{this.o=!1,this.m=3,gt(12),Mr(this),br(this);break e}}if(this.R){d=!0;let Nt;for(;!this.K&&this.C<y.length;)if(Nt=cl(this,y),Nt==ul){xe==4&&(this.m=4,gt(14),d=!1),Q(this.i,this.l,null,"[Incomplete Response]");break}else if(Nt==cn){this.m=4,gt(15),Q(this.i,this.l,y,"[Invalid Chunk]"),d=!1;break}else Q(this.i,this.l,Nt,null),oe(this,Nt);if(dc(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),xe!=4||y.length!=0||this.h.h||(this.m=1,gt(16),d=!1),this.o=this.o&&d,!d)Q(this.i,this.l,y,"[Invalid Chunked Response]"),Mr(this),br(this);else if(y.length>0&&!this.W){this.W=!0;var ie=this.j;ie.g==this&&ie.aa&&!ie.P&&(ie.j.info("Great, no buffering proxy detected. Bytes received: "+y.length),ko(ie),ie.P=!0,gt(11))}}else Q(this.i,this.l,y,null),oe(this,y);xe==4&&Mr(this),this.o&&!this.K&&(xe==4?dy(this.j,this):(this.o=!1,wo(this)))}else de(this.g),_==400&&y.indexOf("Unknown SID")>0?(this.m=3,gt(12)):(this.m=0,gt(13)),Mr(this),br(this)}}}catch{}finally{}};function If(d){if(!dc(d))return d.g.la();const _=fe(d.g);if(_==="")return"";let y="";const P=_.length,G=W(d.g)==4;if(!d.h.i){if(typeof TextDecoder>"u")return Mr(d),br(d),"";d.h.i=new o.TextDecoder}for(let $=0;$<P;$++)d.h.h=!0,y+=d.h.i.decode(_[$],{stream:!(G&&$==P-1)});return _.length=0,d.h.g+=y,d.C=0,d.h.g}function dc(d){return d.g?d.v=="GET"&&d.M!=2&&d.j.Aa:!1}function cl(d,_){var y=d.C,P=_.indexOf(`
`,y);return P==-1?ul:(y=Number(_.substring(y,P)),isNaN(y)?cn:(P+=1,P+y>_.length?ul:(_=_.slice(P,P+y),d.C=P+y,_)))}Nn.prototype.cancel=function(){this.K=!0,Mr(this)};function wo(d){d.T=Date.now()+d.H,hc(d,d.H)}function hc(d,_){if(d.D!=null)throw Error("WatchDog timer not null");d.D=Wn(u(d.aa,d),_)}function ui(d){d.D&&(o.clearTimeout(d.D),d.D=null)}Nn.prototype.aa=function(){this.D=null;const d=Date.now();d-this.T>=0?(ol(this.i,this.B),this.M!=2&&(ds(),gt(17)),Mr(this),this.m=2,br(this)):hc(this,this.T-d)};function br(d){d.j.I==0||d.K||dy(d.j,d)}function Mr(d){ui(d);var _=d.O;_&&typeof _.dispose=="function"&&_.dispose(),d.O=null,ke(d.V),d.g&&(_=d.g,d.g=null,_.abort(),_.dispose())}function oe(d,_){try{var y=d.j;if(y.I!=0&&(y.g==d||Vr(y.h,d))){if(!d.L&&Vr(y.h,d)&&y.I==3){try{var P=y.Ba.g.parse(_)}catch{P=null}if(Array.isArray(P)&&P.length==3){var G=P;if(G[0]==0){e:if(!y.v){if(y.g)if(y.g.F+3e3<d.F)No(y),nt(y);else break e;Po(y),gt(18)}}else y.xa=G[1],0<y.xa-y.K&&G[2]<37500&&y.F&&y.A==0&&!y.C&&(y.C=Wn(u(y.Va,y),6e3));pc(y.h)<=1&&y.ta&&(y.ta=void 0)}else ws(y,11)}else if((d.L||y.g==d)&&No(y),!N(_))for(G=y.Ba.g.parse(_),_=0;_<G.length;_++){let Xe=G[_];const Nt=Xe[0];if(!(Nt<=y.K))if(y.K=Nt,Xe=Xe[1],y.I==2)if(Xe[0]=="c"){y.M=Xe[1],y.ba=Xe[2];const yr=Xe[3];yr!=null&&(y.ka=yr,y.j.info("VER="+y.ka));const Ss=Xe[4];Ss!=null&&(y.za=Ss,y.j.info("SVER="+y.za));const di=Xe[5];di!=null&&typeof di=="number"&&di>0&&(P=1.5*di,y.O=P,y.j.info("backChannelRequestTimeoutMs_="+P)),P=y;const hi=d.g;if(hi){const Sc=hi.g?hi.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Sc){var $=P.h;$.g||Sc.indexOf("spdy")==-1&&Sc.indexOf("quic")==-1&&Sc.indexOf("h2")==-1||($.j=$.l,$.g=new Set,$.h&&(ps($,$.h),$.h=null))}if(P.G){const Df=hi.g?hi.g.getResponseHeader("X-HTTP-Session-Id"):null;Df&&(P.wa=Df,Ye(P.J,P.G,Df))}}y.I=3,y.l&&y.l.ra(),y.aa&&(y.T=Date.now()-d.F,y.j.info("Handshake RTT: "+y.T+"ms")),P=y;var ie=d;if(P.na=py(P,P.L?P.ba:null,P.W),ie.L){mc(P.h,ie);var xe=ie,Ct=P.O;Ct&&(xe.H=Ct),xe.D&&(ui(xe),wo(xe)),P.g=ie}else en(P);y.i.length>0&&_r(y)}else Xe[0]!="stop"&&Xe[0]!="close"||ws(y,7);else y.I==3&&(Xe[0]=="stop"||Xe[0]=="close"?Xe[0]=="stop"?ws(y,7):Ne(y):Xe[0]!="noop"&&y.l&&y.l.qa(Xe),y.A=0)}}ds(4)}catch{}}var So=class{constructor(d,_){this.g=d,this.map=_}};function fc(d){this.l=d||10,o.PerformanceNavigationTiming?(d=o.performance.getEntriesByType("navigation"),d=d.length>0&&(d[0].nextHopProtocol=="hq"||d[0].nextHopProtocol=="h2")):d=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=d?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Co(d){return d.h?!0:d.g?d.g.size>=d.j:!1}function pc(d){return d.h?1:d.g?d.g.size:0}function Vr(d,_){return d.h?d.h==_:d.g?d.g.has(_):!1}function ps(d,_){d.g?d.g.add(_):d.h=_}function mc(d,_){d.h&&d.h==_?d.h=null:d.g&&d.g.has(_)&&d.g.delete(_)}fc.prototype.cancel=function(){if(this.i=gc(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const d of this.g.values())d.cancel();this.g.clear()}};function gc(d){if(d.h!=null)return d.i.concat(d.h.G);if(d.g!=null&&d.g.size!==0){let _=d.i;for(const y of d.g.values())_=_.concat(y.G);return _}return v(d.i)}var dl=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function wf(d,_){if(d){d=d.split("&");for(let y=0;y<d.length;y++){const P=d[y].indexOf("=");let G,$=null;P>=0?(G=d[y].substring(0,P),$=d[y].substring(P+1)):G=d[y],_(G,$?decodeURIComponent($.replace(/\+/g," ")):"")}}}function mr(d){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let _;d instanceof mr?(this.l=d.l,ms(this,d.j),this.o=d.o,this.g=d.g,gs(this,d.u),this.h=d.h,Ao(this,Ec(d.i)),this.m=d.m):d&&(_=String(d).match(dl))?(this.l=!1,ms(this,_[1]||"",!0),this.o=_s(_[2]||""),this.g=_s(_[3]||"",!0),gs(this,_[4]),this.h=_s(_[5]||"",!0),Ao(this,_[6]||"",!0),this.m=_s(_[7]||"")):(this.l=!1,this.i=new vs(null,this.l))}mr.prototype.toString=function(){const d=[];var _=this.j;_&&d.push(ys(_,_c,!0),":");var y=this.g;return(y||_=="file")&&(d.push("//"),(_=this.o)&&d.push(ys(_,_c,!0),"@"),d.push(Dr(y).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y=this.u,y!=null&&d.push(":",String(y))),(y=this.h)&&(this.g&&y.charAt(0)!="/"&&d.push("/"),d.push(ys(y,y.charAt(0)=="/"?Af:Cf,!0))),(y=this.i.toString())&&d.push("?",y),(y=this.m)&&d.push("#",ys(y,Rf)),d.join("")},mr.prototype.resolve=function(d){const _=dn(this);let y=!!d.j;y?ms(_,d.j):y=!!d.o,y?_.o=d.o:y=!!d.g,y?_.g=d.g:y=d.u!=null;var P=d.h;if(y)gs(_,d.u);else if(y=!!d.h){if(P.charAt(0)!="/")if(this.g&&!this.h)P="/"+P;else{var G=_.h.lastIndexOf("/");G!=-1&&(P=_.h.slice(0,G+1)+P)}if(G=P,G==".."||G==".")P="";else if(G.indexOf("./")!=-1||G.indexOf("/.")!=-1){P=G.lastIndexOf("/",0)==0,G=G.split("/");const $=[];for(let ie=0;ie<G.length;){const xe=G[ie++];xe=="."?P&&ie==G.length&&$.push(""):xe==".."?(($.length>1||$.length==1&&$[0]!="")&&$.pop(),P&&ie==G.length&&$.push("")):($.push(xe),P=!0)}P=$.join("/")}else P=G}return y?_.h=P:y=d.i.toString()!=="",y?Ao(_,Ec(d.i)):y=!!d.m,y&&(_.m=d.m),_};function dn(d){return new mr(d)}function ms(d,_,y){d.j=y?_s(_,!0):_,d.j&&(d.j=d.j.replace(/:$/,""))}function gs(d,_){if(_){if(_=Number(_),isNaN(_)||_<0)throw Error("Bad port number "+_);d.u=_}else d.u=null}function Ao(d,_,y){_ instanceof vs?(d.i=_,Pf(d.i,d.l)):(y||(_=ys(_,xf)),d.i=new vs(_,d.l))}function Ye(d,_,y){d.i.set(_,y)}function xo(d){return Ye(d,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),d}function _s(d,_){return d?_?decodeURI(d.replace(/%25/g,"%2525")):decodeURIComponent(d):""}function ys(d,_,y){return typeof d=="string"?(d=encodeURI(d).replace(_,Sf),y&&(d=d.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d):null}function Sf(d){return d=d.charCodeAt(0),"%"+(d>>4&15).toString(16)+(d&15).toString(16)}var _c=/[#\/\?@]/g,Cf=/[#\?:]/g,Af=/[#\?]/g,xf=/[#\?@]/g,Rf=/#/g;function vs(d,_){this.h=this.g=null,this.i=d||null,this.j=!!_}function Lr(d){d.g||(d.g=new Map,d.h=0,d.i&&wf(d.i,function(_,y){d.add(decodeURIComponent(_.replace(/\+/g," ")),y)}))}t=vs.prototype,t.add=function(d,_){Lr(this),this.i=null,d=ci(this,d);let y=this.g.get(d);return y||this.g.set(d,y=[]),y.push(_),this.h+=1,this};function yc(d,_){Lr(d),_=ci(d,_),d.g.has(_)&&(d.i=null,d.h-=d.g.get(_).length,d.g.delete(_))}function vc(d,_){return Lr(d),_=ci(d,_),d.g.has(_)}t.forEach=function(d,_){Lr(this),this.g.forEach(function(y,P){y.forEach(function(G){d.call(_,G,P,this)},this)},this)};function Tc(d,_){Lr(d);let y=[];if(typeof _=="string")vc(d,_)&&(y=y.concat(d.g.get(ci(d,_))));else for(d=Array.from(d.g.values()),_=0;_<d.length;_++)y=y.concat(d[_]);return y}t.set=function(d,_){return Lr(this),this.i=null,d=ci(this,d),vc(this,d)&&(this.h-=this.g.get(d).length),this.g.set(d,[_]),this.h+=1,this},t.get=function(d,_){return d?(d=Tc(this,d),d.length>0?String(d[0]):_):_};function hl(d,_,y){yc(d,_),y.length>0&&(d.i=null,d.g.set(ci(d,_),v(y)),d.h+=y.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const d=[],_=Array.from(this.g.keys());for(let P=0;P<_.length;P++){var y=_[P];const G=Dr(y);y=Tc(this,y);for(let $=0;$<y.length;$++){let ie=G;y[$]!==""&&(ie+="="+Dr(y[$])),d.push(ie)}}return this.i=d.join("&")};function Ec(d){const _=new vs;return _.i=d.i,d.g&&(_.g=new Map(d.g),_.h=d.h),_}function ci(d,_){return _=String(_),d.j&&(_=_.toLowerCase()),_}function Pf(d,_){_&&!d.j&&(Lr(d),d.i=null,d.g.forEach(function(y,P){const G=P.toLowerCase();P!=G&&(yc(this,P),hl(this,G,y))},d)),d.j=_}function kf(d,_){const y=new fs;if(o.Image){const P=new Image;P.onload=f(gr,y,"TestLoadImage: loaded",!0,_,P),P.onerror=f(gr,y,"TestLoadImage: error",!1,_,P),P.onabort=f(gr,y,"TestLoadImage: abort",!1,_,P),P.ontimeout=f(gr,y,"TestLoadImage: timeout",!1,_,P),o.setTimeout(function(){P.ontimeout&&P.ontimeout()},1e4),P.src=d}else _(!1)}function Nf(d,_){const y=new fs,P=new AbortController,G=setTimeout(()=>{P.abort(),gr(y,"TestPingServer: timeout",!1,_)},1e4);fetch(d,{signal:P.signal}).then($=>{clearTimeout(G),$.ok?gr(y,"TestPingServer: ok",!0,_):gr(y,"TestPingServer: server error",!1,_)}).catch(()=>{clearTimeout(G),gr(y,"TestPingServer: error",!1,_)})}function gr(d,_,y,P,G){try{G&&(G.onload=null,G.onerror=null,G.onabort=null,G.ontimeout=null),P(y)}catch{}}function Ro(){this.g=new tl}function Ic(d){this.i=d.Sb||null,this.h=d.ab||!1}p(Ic,_o),Ic.prototype.g=function(){return new fl(this.i,this.h)};function fl(d,_){ot.call(this),this.H=d,this.o=_,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}p(fl,ot),t=fl.prototype,t.open=function(d,_){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=d,this.D=_,this.readyState=1,R(this)},t.send=function(d){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const _={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};d&&(_.body=d),(this.H||o).fetch(new Request(this.D,_)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Es(this)),this.readyState=0},t.Pa=function(d){if(this.g&&(this.l=d,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=d.headers,this.readyState=2,R(this)),this.g&&(this.readyState=3,R(this),this.g)))if(this.responseType==="arraybuffer")d.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in d){if(this.j=d.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Ts(this)}else d.text().then(this.Oa.bind(this),this.ga.bind(this))};function Ts(d){d.j.read().then(d.Ma.bind(d)).catch(d.ga.bind(d))}t.Ma=function(d){if(this.g){if(this.o&&d.value)this.response.push(d.value);else if(!this.o){var _=d.value?d.value:new Uint8Array(0);(_=this.B.decode(_,{stream:!d.done}))&&(this.response=this.responseText+=_)}d.done?Es(this):R(this),this.readyState==3&&Ts(this)}},t.Oa=function(d){this.g&&(this.response=this.responseText=d,Es(this))},t.Na=function(d){this.g&&(this.response=d,Es(this))},t.ga=function(){this.g&&Es(this)};function Es(d){d.readyState=4,d.l=null,d.j=null,d.B=null,R(d)}t.setRequestHeader=function(d,_){this.A.append(d,_)},t.getResponseHeader=function(d){return this.h&&this.h.get(d.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const d=[],_=this.h.entries();for(var y=_.next();!y.done;)y=y.value,d.push(y[0]+": "+y[1]),y=_.next();return d.join(`\r
`)};function R(d){d.onreadystatechange&&d.onreadystatechange.call(d)}Object.defineProperty(fl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(d){this.m=d?"include":"same-origin"}});function M(d){let _="";return he(d,function(y,P){_+=P,_+=":",_+=y,_+=`\r
`}),_}function O(d,_,y){e:{for(P in y){var P=!1;break e}P=!0}P||(y=M(y),typeof d=="string"?y!=null&&Dr(y):Ye(d,_,y))}function F(d){ot.call(this),this.headers=new Map,this.L=d||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}p(F,ot);var H=/^https?$/i,Y=["POST","PUT"];t=F.prototype,t.Fa=function(d){this.H=d},t.ea=function(d,_,y,P){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+d);_=_?_.toUpperCase():"GET",this.D=d,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Tf.g(),this.g.onreadystatechange=g(u(this.Ca,this));try{this.B=!0,this.g.open(_,String(d),!0),this.B=!1}catch($){J(this,$);return}if(d=y||"",y=new Map(this.headers),P)if(Object.getPrototypeOf(P)===Object.prototype)for(var G in P)y.set(G,P[G]);else if(typeof P.keys=="function"&&typeof P.get=="function")for(const $ of P.keys())y.set($,P.get($));else throw Error("Unknown input type for opt_headers: "+String(P));P=Array.from(y.keys()).find($=>$.toLowerCase()=="content-type"),G=o.FormData&&d instanceof o.FormData,!(Array.prototype.indexOf.call(Y,_,void 0)>=0)||P||G||y.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[$,ie]of y)this.g.setRequestHeader($,ie);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(d),this.v=!1}catch($){J(this,$)}};function J(d,_){d.h=!1,d.g&&(d.j=!0,d.g.abort(),d.j=!1),d.l=_,d.o=5,X(d),ne(d)}function X(d){d.A||(d.A=!0,ze(d,"complete"),ze(d,"error"))}t.abort=function(d){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=d||7,ze(this,"complete"),ze(this,"abort"),ne(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ne(this,!0)),F.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?K(this):this.Xa())},t.Xa=function(){K(this)};function K(d){if(d.h&&typeof s<"u"){if(d.v&&W(d)==4)setTimeout(d.Ca.bind(d),0);else if(ze(d,"readystatechange"),W(d)==4){d.h=!1;try{const $=d.ca();e:switch($){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var _=!0;break e;default:_=!1}var y;if(!(y=_)){var P;if(P=$===0){let ie=String(d.D).match(dl)[1]||null;!ie&&o.self&&o.self.location&&(ie=o.self.location.protocol.slice(0,-1)),P=!H.test(ie?ie.toLowerCase():"")}y=P}if(y)ze(d,"complete"),ze(d,"success");else{d.o=6;try{var G=W(d)>2?d.g.statusText:""}catch{G=""}d.l=G+" ["+d.ca()+"]",X(d)}}finally{ne(d)}}}}function ne(d,_){if(d.g){d.m&&(clearTimeout(d.m),d.m=null);const y=d.g;d.g=null,_||ze(d,"ready");try{y.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function W(d){return d.g?d.g.readyState:0}t.ca=function(){try{return W(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(d){if(this.g){var _=this.g.responseText;return d&&_.indexOf(d)==0&&(_=_.substring(d.length)),ai(_)}};function fe(d){try{if(!d.g)return null;if("response"in d.g)return d.g.response;switch(d.F){case"":case"text":return d.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in d.g)return d.g.mozResponseArrayBuffer}return null}catch{return null}}function de(d){const _={};d=(d.g&&W(d)>=2&&d.g.getAllResponseHeaders()||"").split(`\r
`);for(let P=0;P<d.length;P++){if(N(d[P]))continue;var y=Ef(d[P]);const G=y[0];if(y=y[1],typeof y!="string")continue;y=y.trim();const $=_[G]||[];_[G]=$,$.push(y)}ve(_,function(P){return P.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function ae(d,_,y){return y&&y.internalChannelParams&&y.internalChannelParams[d]||_}function pe(d){this.za=0,this.i=[],this.j=new fs,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=ae("failFast",!1,d),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=ae("baseRetryDelayMs",5e3,d),this.Za=ae("retryDelaySeedMs",1e4,d),this.Ta=ae("forwardChannelMaxRetries",2,d),this.va=ae("forwardChannelRequestTimeoutMs",2e4,d),this.ma=d&&d.xmlHttpFactory||void 0,this.Ua=d&&d.Rb||void 0,this.Aa=d&&d.useFetchStreams||!1,this.O=void 0,this.L=d&&d.supportsCrossDomainXhr||!1,this.M="",this.h=new fc(d&&d.concurrentRequestLimit),this.Ba=new Ro,this.S=d&&d.fastHandshake||!1,this.R=d&&d.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=d&&d.Pb||!1,d&&d.ua&&this.j.ua(),d&&d.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&d&&d.detectBufferingProxy||!1,this.ia=void 0,d&&d.longPollingTimeout&&d.longPollingTimeout>0&&(this.ia=d.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=pe.prototype,t.ka=8,t.I=1,t.connect=function(d,_,y,P){gt(0),this.W=d,this.H=_||{},y&&P!==void 0&&(this.H.OSID=y,this.H.OAID=P),this.F=this.X,this.J=py(this,null,this.W),_r(this)};function Ne(d){if(Dn(d),d.I==3){var _=d.V++,y=dn(d.J);if(Ye(y,"SID",d.M),Ye(y,"RID",_),Ye(y,"TYPE","terminate"),Zt(d,y),_=new Nn(d,d.j,_),_.M=2,_.A=xo(dn(y)),y=!1,o.navigator&&o.navigator.sendBeacon)try{y=o.navigator.sendBeacon(_.A.toString(),"")}catch{}!y&&o.Image&&(new Image().src=_.A,y=!0),y||(_.g=my(_.j,null),_.g.ea(_.A)),_.F=Date.now(),wo(_)}fy(d)}function nt(d){d.g&&(ko(d),d.g.cancel(),d.g=null)}function Dn(d){nt(d),d.v&&(o.clearTimeout(d.v),d.v=null),No(d),d.h.cancel(),d.m&&(typeof d.m=="number"&&o.clearTimeout(d.m),d.m=null)}function _r(d){if(!Co(d.h)&&!d.m){d.m=!0;var _=d.Ea;U||w(),B||(U(),B=!0),T.add(_,d),d.D=0}}function pl(d,_){return pc(d.h)>=d.h.j-(d.m?1:0)?!1:d.m?(d.i=_.G.concat(d.i),!0):d.I==1||d.I==2||d.D>=(d.Sa?0:d.Ta)?!1:(d.m=Wn(u(d.Ea,d,_),hy(d,d.D)),d.D++,!0)}t.Ea=function(d){if(this.m)if(this.m=null,this.I==1){if(!d){this.V=Math.floor(Math.random()*1e5),d=this.V++;const G=new Nn(this,this.j,d);let $=this.o;if(this.U&&($?($=Ie($),tt($,this.U)):$=this.U),this.u!==null||this.R||(G.J=$,$=null),this.S)e:{for(var _=0,y=0;y<this.i.length;y++){t:{var P=this.i[y];if("__data__"in P.map&&(P=P.map.__data__,typeof P=="string")){P=P.length;break t}P=void 0}if(P===void 0)break;if(_+=P,_>4096){_=y;break e}if(_===4096||y===this.i.length-1){_=y+1;break e}}_=1e3}else _=1e3;_=jn(this,G,_),y=dn(this.J),Ye(y,"RID",d),Ye(y,"CVER",22),this.G&&Ye(y,"X-HTTP-Session-Id",this.G),Zt(this,y),$&&(this.R?_="headers="+Dr(M($))+"&"+_:this.u&&O(y,this.u,$)),ps(this.h,G),this.Ra&&Ye(y,"TYPE","init"),this.S?(Ye(y,"$req",_),Ye(y,"SID","null"),G.U=!0,Eo(G,y,null)):Eo(G,y,_),this.I=2}}else this.I==3&&(d?Kn(this,d):this.i.length==0||Co(this.h)||Kn(this))};function Kn(d,_){var y;_?y=_.l:y=d.V++;const P=dn(d.J);Ye(P,"SID",d.M),Ye(P,"RID",y),Ye(P,"AID",d.K),Zt(d,P),d.u&&d.o&&O(P,d.u,d.o),y=new Nn(d,d.j,y,d.D+1),d.u===null&&(y.J=d.o),_&&(d.i=_.G.concat(d.i)),_=jn(d,y,1e3),y.H=Math.round(d.va*.5)+Math.round(d.va*.5*Math.random()),ps(d.h,y),Eo(y,P,_)}function Zt(d,_){d.H&&he(d.H,function(y,P){Ye(_,P,y)}),d.l&&he({},function(y,P){Ye(_,P,y)})}function jn(d,_,y){y=Math.min(d.i.length,y);const P=d.l?u(d.l.Ka,d.l,d):null;e:{var G=d.i;let xe=-1;for(;;){const Ct=["count="+y];xe==-1?y>0?(xe=G[0].g,Ct.push("ofs="+xe)):xe=0:Ct.push("ofs="+xe);let Xe=!0;for(let Nt=0;Nt<y;Nt++){var $=G[Nt].g;const yr=G[Nt].map;if($-=xe,$<0)xe=Math.max(0,G[Nt].g-100),Xe=!1;else try{$="req"+$+"_"||"";try{var ie=yr instanceof Map?yr:Object.entries(yr);for(const[Ss,di]of ie){let hi=di;a(di)&&(hi=el(di)),Ct.push($+Ss+"="+encodeURIComponent(hi))}}catch(Ss){throw Ct.push($+"type="+encodeURIComponent("_badmap")),Ss}}catch{P&&P(yr)}}if(Xe){ie=Ct.join("&");break e}}ie=void 0}return d=d.i.splice(0,y),_.G=d,ie}function en(d){if(!d.g&&!d.v){d.Y=1;var _=d.Da;U||w(),B||(U(),B=!0),T.add(_,d),d.A=0}}function Po(d){return d.g||d.v||d.A>=3?!1:(d.Y++,d.v=Wn(u(d.Da,d),hy(d,d.A)),d.A++,!0)}t.Da=function(){if(this.v=null,Is(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var d=4*this.T;this.j.info("BP detection timer enabled: "+d),this.B=Wn(u(this.Wa,this),d)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,gt(10),nt(this),Is(this))};function ko(d){d.B!=null&&(o.clearTimeout(d.B),d.B=null)}function Is(d){d.g=new Nn(d,d.j,"rpc",d.Y),d.u===null&&(d.g.J=d.o),d.g.P=0;var _=dn(d.na);Ye(_,"RID","rpc"),Ye(_,"SID",d.M),Ye(_,"AID",d.K),Ye(_,"CI",d.F?"0":"1"),!d.F&&d.ia&&Ye(_,"TO",d.ia),Ye(_,"TYPE","xmlhttp"),Zt(d,_),d.u&&d.o&&O(_,d.u,d.o),d.O&&(d.g.H=d.O);var y=d.g;d=d.ba,y.M=1,y.A=xo(dn(_)),y.u=null,y.R=!0,Io(y,d)}t.Va=function(){this.C!=null&&(this.C=null,nt(this),Po(this),gt(19))};function No(d){d.C!=null&&(o.clearTimeout(d.C),d.C=null)}function dy(d,_){var y=null;if(d.g==_){No(d),ko(d),d.g=null;var P=2}else if(Vr(d.h,_))y=_.G,mc(d.h,_),P=1;else return;if(d.I!=0){if(_.o)if(P==1){y=_.u?_.u.length:0,_=Date.now()-_.F;var G=d.D;P=Hn(),ze(P,new hs(P,y)),_r(d)}else en(d);else if(G=_.m,G==3||G==0&&_.X>0||!(P==1&&pl(d,_)||P==2&&Po(d)))switch(y&&y.length>0&&(_=d.h,_.i=_.i.concat(y)),G){case 1:ws(d,5);break;case 4:ws(d,10);break;case 3:ws(d,6);break;default:ws(d,2)}}}function hy(d,_){let y=d.Qa+Math.floor(Math.random()*d.Za);return d.isActive()||(y*=2),y*_}function ws(d,_){if(d.j.info("Error code "+_),_==2){var y=u(d.bb,d),P=d.Ua;const G=!P;P=new mr(P||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||ms(P,"https"),xo(P),G?kf(P.toString(),y):Nf(P.toString(),y)}else gt(2);d.I=0,d.l&&d.l.pa(_),fy(d),Dn(d)}t.bb=function(d){d?(this.j.info("Successfully pinged google.com"),gt(2)):(this.j.info("Failed to ping google.com"),gt(1))};function fy(d){if(d.I=0,d.ja=[],d.l){const _=gc(d.h);(_.length!=0||d.i.length!=0)&&(E(d.ja,_),E(d.ja,d.i),d.h.i.length=0,v(d.i),d.i.length=0),d.l.oa()}}function py(d,_,y){var P=y instanceof mr?dn(y):new mr(y);if(P.g!="")_&&(P.g=_+"."+P.g),gs(P,P.u);else{var G=o.location;P=G.protocol,_=_?_+"."+G.hostname:G.hostname,G=+G.port;const $=new mr(null);P&&ms($,P),_&&($.g=_),G&&gs($,G),y&&($.h=y),P=$}return y=d.G,_=d.wa,y&&_&&Ye(P,y,_),Ye(P,"VER",d.ka),Zt(d,P),P}function my(d,_,y){if(_&&!d.L)throw Error("Can't create secondary domain capable XhrIo object.");return _=d.Aa&&!d.ma?new F(new Ic({ab:y})):new F(d.ma),_.Fa(d.L),_}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function gy(){}t=gy.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function wc(){}wc.prototype.g=function(d,_){return new vn(d,_)};function vn(d,_){ot.call(this),this.g=new pe(_),this.l=d,this.h=_&&_.messageUrlParams||null,d=_&&_.messageHeaders||null,_&&_.clientProtocolHeaderRequired&&(d?d["X-Client-Protocol"]="webchannel":d={"X-Client-Protocol":"webchannel"}),this.g.o=d,d=_&&_.initMessageHeaders||null,_&&_.messageContentType&&(d?d["X-WebChannel-Content-Type"]=_.messageContentType:d={"X-WebChannel-Content-Type":_.messageContentType}),_&&_.sa&&(d?d["X-WebChannel-Client-Profile"]=_.sa:d={"X-WebChannel-Client-Profile":_.sa}),this.g.U=d,(d=_&&_.Qb)&&!N(d)&&(this.g.u=d),this.A=_&&_.supportsCrossDomainXhr||!1,this.v=_&&_.sendRawJson||!1,(_=_&&_.httpSessionIdParam)&&!N(_)&&(this.g.G=_,d=this.h,d!==null&&_ in d&&(d=this.h,_ in d&&delete d[_])),this.j=new Do(this)}p(vn,ot),vn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},vn.prototype.close=function(){Ne(this.g)},vn.prototype.o=function(d){var _=this.g;if(typeof d=="string"){var y={};y.__data__=d,d=y}else this.v&&(y={},y.__data__=el(d),d=y);_.i.push(new So(_.Ya++,d)),_.I==3&&_r(_)},vn.prototype.N=function(){this.g.l=null,delete this.j,Ne(this.g),delete this.g,vn.Z.N.call(this)};function _y(d){rl.call(this),d.__headers__&&(this.headers=d.__headers__,this.statusCode=d.__status__,delete d.__headers__,delete d.__status__);var _=d.__sm__;if(_){e:{for(const y in _){d=y;break e}d=void 0}(this.i=d)&&(d=this.i,_=_!==null&&d in _?_[d]:void 0),this.data=_}else this.data=d}p(_y,rl);function yy(){il.call(this),this.status=1}p(yy,il);function Do(d){this.g=d}p(Do,gy),Do.prototype.ra=function(){ze(this.g,"a")},Do.prototype.qa=function(d){ze(this.g,new _y(d))},Do.prototype.pa=function(d){ze(this.g,new yy)},Do.prototype.oa=function(){ze(this.g,"b")},wc.prototype.createWebChannel=wc.prototype.g,vn.prototype.send=vn.prototype.o,vn.prototype.open=vn.prototype.m,vn.prototype.close=vn.prototype.close,O0=function(){return new wc},U0=function(){return Hn()},F0=pr,km={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},al.NO_ERROR=0,al.TIMEOUT=8,al.HTTP_ERROR=6,pd=al,vf.COMPLETE="complete",L0=vf,nl.EventType=li,li.OPEN="a",li.CLOSE="b",li.ERROR="c",li.MESSAGE="d",ot.prototype.listen=ot.prototype.J,bl=nl,F.prototype.listenOnce=F.prototype.K,F.prototype.getLastError=F.prototype.Ha,F.prototype.getLastErrorCode=F.prototype.ya,F.prototype.getStatus=F.prototype.ca,F.prototype.getResponseJson=F.prototype.La,F.prototype.getResponseText=F.prototype.la,F.prototype.send=F.prototype.ea,F.prototype.setWithCredentials=F.prototype.Fa,V0=F}).apply(typeof zc<"u"?zc:typeof self<"u"?self:typeof window<"u"?window:{});const IE="@firebase/firestore",wE="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ut{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ut.UNAUTHENTICATED=new Ut(null),Ut.GOOGLE_CREDENTIALS=new Ut("google-credentials-uid"),Ut.FIRST_PARTY=new Ut("first-party-uid"),Ut.MOCK_USER=new Ut("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Qa="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ji=new o_("@firebase/firestore");function Bo(){return ji.logLevel}function B0(t){ji.setLogLevel(t)}function ee(t,...e){if(ji.logLevel<=be.DEBUG){const n=e.map(v_);ji.debug(`Firestore (${Qa}): ${t}`,...n)}}function nn(t,...e){if(ji.logLevel<=be.ERROR){const n=e.map(v_);ji.error(`Firestore (${Qa}): ${t}`,...n)}}function Ji(t,...e){if(ji.logLevel<=be.WARN){const n=e.map(v_);ji.warn(`Firestore (${Qa}): ${t}`,...n)}}function v_(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ce(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,q0(t,r,n)}function q0(t,e,n){let r=`FIRESTORE (${Qa}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw nn(r),new Error(r)}function ge(t,e,n,r){let i="Unexpected state";typeof n=="string"?i=n:r=n,t||q0(e,i,r)}function Ae(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class re extends ii{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rr{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G0{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class z0{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Ut.UNAUTHENTICATED))}shutdown(){}}class eU{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class tU{constructor(e){this.t=e,this.currentUser=Ut.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){ge(this.o===void 0,42304);let r=this.i;const i=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let s=new Rr;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Rr,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},a=l=>{ee("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(ee("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Rr)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(ee("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ge(typeof r.accessToken=="string",31837,{l:r}),new G0(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ge(e===null||typeof e=="string",2055,{h:e}),new Ut(e)}}class nU{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=Ut.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class rU{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new nU(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(Ut.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class SE{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class iU{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,er(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){ge(this.o===void 0,3512);const r=s=>{s.error!=null&&ee("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,ee("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{ee("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):ee("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new SE(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(ge(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new SE(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sU(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jh{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=sU(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%62))}return r}}function Ce(t,e){return t<e?-1:t>e?1:0}function Nm(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const i=t.charAt(r),s=e.charAt(r);if(i!==s)return fp(i)===fp(s)?Ce(i,s):fp(i)?1:-1}return Ce(t.length,e.length)}const oU=55296,aU=57343;function fp(t){const e=t.charCodeAt(0);return e>=oU&&e<=aU}function xa(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function $0(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CE="__name__";class Er{constructor(e,n,r){n===void 0?n=0:n>e.length&&ce(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&ce(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Er.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Er?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=Er.compareSegments(e.get(i),n.get(i));if(s!==0)return s}return Ce(e.length,n.length)}static compareSegments(e,n){const r=Er.isNumericId(e),i=Er.isNumericId(n);return r&&!i?-1:!r&&i?1:r&&i?Er.extractNumericId(e).compare(Er.extractNumericId(n)):Nm(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Gi.fromString(e.substring(4,e.length-2))}}class Ge extends Er{construct(e,n,r){return new Ge(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new re(j.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new Ge(n)}static emptyPath(){return new Ge([])}}const lU=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ct extends Er{construct(e,n,r){return new ct(e,n,r)}static isValidIdentifier(e){return lU.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ct.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===CE}static keyField(){return new ct([CE])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new re(j.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new re(j.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new re(j.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new re(j.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ct(n)}static emptyPath(){return new ct([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class se{constructor(e){this.path=e}static fromPath(e){return new se(Ge.fromString(e))}static fromName(e){return new se(Ge.fromString(e).popFirst(5))}static empty(){return new se(Ge.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ge.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Ge.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new se(new Ge(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H0(t,e,n){if(!n)throw new re(j.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function W0(t,e,n,r){if(e===!0&&r===!0)throw new re(j.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function AE(t){if(!se.isDocumentKey(t))throw new re(j.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function xE(t){if(se.isDocumentKey(t))throw new re(j.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function K0(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Jh(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ce(12329,{type:typeof t})}function on(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new re(j.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Jh(t);throw new re(j.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function St(t,e){const n={typeString:t};return e&&(n.value=e),n}function Ju(t,e){if(!K0(t))throw new re(j.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(i&&typeof o!==i){n=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&o!==s.value){n=`Expected '${r}' field to equal '${s.value}'`;break}}if(n)throw new re(j.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RE=-62135596800,PE=1e6;class $e{static now(){return $e.fromMillis(Date.now())}static fromDate(e){return $e.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*PE);return new $e(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new re(j.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new re(j.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<RE)throw new re(j.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new re(j.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/PE}_compareTo(e){return this.seconds===e.seconds?Ce(this.nanoseconds,e.nanoseconds):Ce(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:$e._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Ju(e,$e._jsonSchema))return new $e(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-RE;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}$e._jsonSchemaVersion="firestore/timestamp/1.0",$e._jsonSchema={type:St("string",$e._jsonSchemaVersion),seconds:St("number"),nanoseconds:St("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _e{static fromTimestamp(e){return new _e(e)}static min(){return new _e(new $e(0,0))}static max(){return new _e(new $e(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Au=-1;class oh{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}}function Dm(t){return t.fields.find(e=>e.kind===2)}function Ns(t){return t.fields.filter(e=>e.kind!==2)}oh.UNKNOWN_ID=-1;class md{constructor(e,n){this.fieldPath=e,this.kind=n}}class xu{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new xu(0,xn.min())}}function uU(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=_e.fromTimestamp(r===1e9?new $e(n+1,0):new $e(n,r));return new xn(i,se.empty(),e)}function j0(t){return new xn(t.readTime,t.key,Au)}class xn{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new xn(_e.min(),se.empty(),Au)}static max(){return new xn(_e.max(),se.empty(),Au)}}function T_(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=se.comparator(t.documentKey,e.documentKey),n!==0?n:Ce(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J0="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Q0{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fo(t){if(t.code!==j.FAILED_PRECONDITION||t.message!==J0)throw t;ee("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&ce(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new q((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof q?n:q.resolve(n)}catch(n){return q.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):q.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):q.reject(n)}static resolve(e){return new q((n,r)=>{n(e)})}static reject(e){return new q((n,r)=>{r(e)})}static waitFor(e){return new q((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},l=>r(l))}),o=!0,s===i&&n()})}static or(e){let n=q.resolve(!1);for(const r of e)n=n.next(i=>i?q.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new q((r,i)=>{const s=e.length,o=new Array(s);let a=0;for(let l=0;l<s;l++){const u=l;n(e[u]).next(f=>{o[u]=f,++a,a===s&&r(o)},f=>i(f))}})}static doWhile(e,n){return new q((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const En="SimpleDb";class Qh{static open(e,n,r,i){try{return new Qh(n,e.transaction(i,r))}catch(s){throw new Yl(n,s)}}constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.S=new Rr,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{n.error?this.S.reject(new Yl(e,n.error)):this.S.resolve()},this.transaction.onerror=r=>{const i=E_(r.target.error);this.S.reject(new Yl(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(ee(En,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new dU(n)}}class zi{static delete(e){return ee(En,"Removing database:",e),bs(qC().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!QC())return!1;if(zi.F())return!0;const e=Rt(),n=zi.M(e),r=0<n&&n<10,i=Y0(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)==null?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)==="YES"}static O(e,n){return e.store(n)}static M(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,n,r){this.name=e,this.version=n,this.N=r,this.B=null,zi.M(Rt())===12.2&&nn("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(ee(En,"Opening database:",this.name),this.db=await new Promise((n,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const o=s.target.result;n(o)},i.onblocked=()=>{r(new Yl(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const o=s.target.error;o.name==="VersionError"?r(new re(j.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new re(j.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Yl(e,o))},i.onupgradeneeded=s=>{ee(En,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.N.k(o,i.transaction,s.oldVersion,this.version).next(()=>{ee(En,"Database upgrade to version "+this.version+" complete")})}})),this.q&&(this.db.onversionchange=n=>this.q(n)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,i){const s=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const a=Qh.open(this.db,e,s?"readonly":"readwrite",r),l=i(a).next(u=>(a.C(),u)).catch(u=>(a.abort(u),q.reject(u))).toPromise();return l.catch(()=>{}),await a.D,l}catch(a){const l=a,u=l.name!=="FirebaseError"&&o<3;if(ee(En,"Transaction failed with error:",l.message,"Retrying:",u),this.close(),!u)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function Y0(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class cU{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return bs(this.U.delete())}}class Yl extends re{constructor(e,n){super(j.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function ss(t){return t.name==="IndexedDbTransactionError"}class dU{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(ee(En,"PUT",this.store.name,e,n),r=this.store.put(n,e)):(ee(En,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),bs(r)}add(e){return ee(En,"ADD",this.store.name,e,e),bs(this.store.add(e))}get(e){return bs(this.store.get(e)).next(n=>(n===void 0&&(n=null),ee(En,"GET",this.store.name,e,n),n))}delete(e){return ee(En,"DELETE",this.store.name,e),bs(this.store.delete(e))}count(){return ee(En,"COUNT",this.store.name),bs(this.store.count())}J(e,n){const r=this.options(e,n),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const s=i.getAll(r.range);return new q((o,a)=>{s.onerror=l=>{a(l.target.error)},s.onsuccess=l=>{o(l.target.result)}})}{const s=this.cursor(r),o=[];return this.H(s,(a,l)=>{o.push(l)}).next(()=>o)}}Y(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new q((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}Z(e,n){ee(En,"DELETE ALL",this.store.name);const r=this.options(e,n);r.X=!1;const i=this.cursor(r);return this.H(i,(s,o,a)=>a.delete())}ee(e,n){let r;n?r=e:(r={},n=e);const i=this.cursor(r);return this.H(i,n)}te(e){const n=this.cursor({});return new q((r,i)=>{n.onerror=s=>{const o=E_(s.target.error);i(o)},n.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}H(e,n){const r=[];return new q((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void i();const l=new cU(a),u=n(a.primaryKey,a.value,l);if(u instanceof q){const f=u.catch(p=>(l.done(),q.reject(p)));r.push(f)}l.isDone?i():l.G===null?a.continue():a.continue(l.G)}}).next(()=>q.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function bs(t){return new q((e,n)=>{t.onsuccess=r=>{const i=r.target.result;e(i)},t.onerror=r=>{const i=E_(r.target.error);n(i)}})}let kE=!1;function E_(t){const e=zi.M(Rt());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new re("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return kE||(kE=!0,setTimeout(()=>{throw r},0)),r}}return t}const Xl="IndexBackfiller";class hU{constructor(e,n){this.asyncQueue=e,this.ne=n,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){ee(Xl,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const n=await this.ne.ie();ee(Xl,`Documents written: ${n}`)}catch(n){ss(n)?ee(Xl,"Ignoring IndexedDB error during index backfill: ",n):await fo(n)}await this.re(6e4)})}}class fU{constructor(e,n){this.localStore=e,this.persistence=n}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.se(n,e))}se(e,n){const r=new Set;let i=n,s=!0;return q.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return ee(Xl,`Processing collection: ${o}`),this.oe(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>n-i)}oe(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this._e(i,s)).next(a=>(ee(Xl,`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}_e(e,n){let r=e;return n.changes.forEach((i,s)=>{const o=j0(s);T_(o,r)>0&&(r=o)}),new xn(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fn{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Fn.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hs=-1;function Yh(t){return t==null}function Ru(t){return t===0&&1/t==-1/0}function pU(t){return typeof t=="number"&&Number.isInteger(t)&&!Ru(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ah="";function Yt(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=NE(e)),e=mU(t.get(n),e);return NE(e)}function mU(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const s=t.charAt(i);switch(s){case"\0":n+="";break;case ah:n+="";break;default:n+=s}}return n}function NE(t){return t+ah+""}function wr(t){const e=t.length;if(ge(e>=2,64408,{path:t}),e===2)return ge(t.charAt(0)===ah&&t.charAt(1)==="",56145,{path:t}),Ge.emptyPath();const n=e-2,r=[];let i="";for(let s=0;s<e;){const o=t.indexOf(ah,s);switch((o<0||o>n)&&ce(50515,{path:t}),t.charAt(o+1)){case"":const a=t.substring(s,o);let l;i.length===0?l=a:(i+=a,l=i,i=""),r.push(l);break;case"":i+=t.substring(s,o),i+="\0";break;case"":i+=t.substring(s,o+1);break;default:ce(61167,{path:t})}s=o+2}return new Ge(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ds="remoteDocuments",Qu="owner",Mo="owner",Pu="mutationQueues",gU="userId",Xn="mutations",DE="batchId",qs="userMutationsIndex",bE=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gd(t,e){return[t,Yt(e)]}function X0(t,e,n){return[t,Yt(e),n]}const _U={},Ra="documentMutations",lh="remoteDocumentsV14",yU=["prefixPath","collectionGroup","readTime","documentId"],_d="documentKeyIndex",vU=["prefixPath","collectionGroup","documentId"],Z0="collectionGroupIndex",TU=["collectionGroup","readTime","prefixPath","documentId"],ku="remoteDocumentGlobal",bm="remoteDocumentGlobalKey",Pa="targets",eA="queryTargetsIndex",EU=["canonicalId","targetId"],ka="targetDocuments",IU=["targetId","path"],I_="documentTargetsIndex",wU=["path","targetId"],uh="targetGlobalKey",Ws="targetGlobal",Nu="collectionParents",SU=["collectionId","parent"],Na="clientMetadata",CU="clientId",Xh="bundles",AU="bundleId",Zh="namedQueries",xU="name",w_="indexConfiguration",RU="indexId",Mm="collectionGroupIndex",PU="collectionGroup",Zl="indexState",kU=["indexId","uid"],tA="sequenceNumberIndex",NU=["uid","sequenceNumber"],eu="indexEntries",DU=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],nA="documentKeyIndex",bU=["indexId","uid","orderedDocumentKey"],ef="documentOverlays",MU=["userId","collectionPath","documentId"],Vm="collectionPathOverlayIndex",VU=["userId","collectionPath","largestBatchId"],rA="collectionGroupOverlayIndex",LU=["userId","collectionGroup","largestBatchId"],S_="globals",FU="name",iA=[Pu,Xn,Ra,Ds,Pa,Qu,Ws,ka,Na,ku,Nu,Xh,Zh],UU=[...iA,ef],sA=[Pu,Xn,Ra,lh,Pa,Qu,Ws,ka,Na,ku,Nu,Xh,Zh,ef],oA=sA,C_=[...oA,w_,Zl,eu],OU=C_,aA=[...C_,S_],BU=aA;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lm extends Q0{constructor(e,n){super(),this.le=e,this.currentSequenceNumber=n}}function kt(t,e){const n=Ae(t);return zi.O(n.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ME(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function os(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function lA(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dt{constructor(e,n){this.comparator=e,this.root=n||Ot.EMPTY}insert(e,n){return new dt(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Ot.BLACK,null,null))}remove(e){return new dt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ot.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new $c(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new $c(this.root,e,this.comparator,!1)}getReverseIterator(){return new $c(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new $c(this.root,e,this.comparator,!0)}}class $c{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ot{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??Ot.RED,this.left=i??Ot.EMPTY,this.right=s??Ot.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new Ot(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Ot.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return Ot.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ot.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ot.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ce(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ce(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ce(27949);return e+(this.isRed()?0:1)}}Ot.EMPTY=null,Ot.RED=!0,Ot.BLACK=!1;Ot.EMPTY=new class{constructor(){this.size=0}get key(){throw ce(57766)}get value(){throw ce(16141)}get color(){throw ce(16727)}get left(){throw ce(29726)}get right(){throw ce(36894)}copy(e,n,r,i,s){return this}insert(e,n,r){return new Ot(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ke{constructor(e){this.comparator=e,this.data=new dt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new VE(this.data.getIterator())}getIteratorFrom(e){return new VE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Ke)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Ke(this.comparator);return n.data=e,n}}class VE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Vo(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pn{constructor(e){this.fields=e,e.sort(ct.comparator)}static empty(){return new pn([])}unionWith(e){let n=new Ke(ct.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new pn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return xa(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uA extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Et{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new uA("Invalid base64 string: "+s):s}}(e);return new Et(n)}static fromUint8Array(e){const n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new Et(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ce(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Et.EMPTY_BYTE_STRING=new Et("");const qU=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ei(t){if(ge(!!t,39018),typeof t=="string"){let e=0;const n=qU.exec(t);if(ge(!!n,46558,{timestamp:t}),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:lt(t.seconds),nanos:lt(t.nanos)}}function lt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function ti(t){return typeof t=="string"?Et.fromBase64String(t):Et.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cA="server_timestamp",dA="__type__",hA="__previous_value__",fA="__local_write_time__";function A_(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[dA])==null?void 0:r.stringValue)===cA}function tf(t){const e=t.mapValue.fields[hA];return A_(e)?tf(e):e}function Du(t){const e=ei(t.mapValue.fields[fA].timestampValue);return new $e(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GU{constructor(e,n,r,i,s,o,a,l,u,f){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=u,this.isUsingEmulator=f}}const ch="(default)";class Qi{constructor(e,n){this.projectId=e,this.database=n||ch}static empty(){return new Qi("","")}get isDefaultDatabase(){return this.database===ch}isEqual(e){return e instanceof Qi&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x_="__type__",pA="__max__",ki={mapValue:{fields:{__type__:{stringValue:pA}}}},R_="__vector__",Da="value",yd={nullValue:"NULL_VALUE"};function Yi(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?A_(t)?4:mA(t)?9007199254740991:nf(t)?10:11:ce(28295,{value:t})}function kr(t,e){if(t===e)return!0;const n=Yi(t);if(n!==Yi(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Du(t).isEqual(Du(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=ei(i.timestampValue),a=ei(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return ti(i.bytesValue).isEqual(ti(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return lt(i.geoPointValue.latitude)===lt(s.geoPointValue.latitude)&&lt(i.geoPointValue.longitude)===lt(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return lt(i.integerValue)===lt(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=lt(i.doubleValue),a=lt(s.doubleValue);return o===a?Ru(o)===Ru(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return xa(t.arrayValue.values||[],e.arrayValue.values||[],kr);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(ME(o)!==ME(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!kr(o[l],a[l])))return!1;return!0}(t,e);default:return ce(52216,{left:t})}}function bu(t,e){return(t.values||[]).find(n=>kr(n,e))!==void 0}function Xi(t,e){if(t===e)return 0;const n=Yi(t),r=Yi(e);if(n!==r)return Ce(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Ce(t.booleanValue,e.booleanValue);case 2:return function(s,o){const a=lt(s.integerValue||s.doubleValue),l=lt(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(t,e);case 3:return LE(t.timestampValue,e.timestampValue);case 4:return LE(Du(t),Du(e));case 5:return Nm(t.stringValue,e.stringValue);case 6:return function(s,o){const a=ti(s),l=ti(o);return a.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),l=o.split("/");for(let u=0;u<a.length&&u<l.length;u++){const f=Ce(a[u],l[u]);if(f!==0)return f}return Ce(a.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){const a=Ce(lt(s.latitude),lt(o.latitude));return a!==0?a:Ce(lt(s.longitude),lt(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return FE(t.arrayValue,e.arrayValue);case 10:return function(s,o){var g,v,E,x;const a=s.fields||{},l=o.fields||{},u=(g=a[Da])==null?void 0:g.arrayValue,f=(v=l[Da])==null?void 0:v.arrayValue,p=Ce(((E=u==null?void 0:u.values)==null?void 0:E.length)||0,((x=f==null?void 0:f.values)==null?void 0:x.length)||0);return p!==0?p:FE(u,f)}(t.mapValue,e.mapValue);case 11:return function(s,o){if(s===ki.mapValue&&o===ki.mapValue)return 0;if(s===ki.mapValue)return 1;if(o===ki.mapValue)return-1;const a=s.fields||{},l=Object.keys(a),u=o.fields||{},f=Object.keys(u);l.sort(),f.sort();for(let p=0;p<l.length&&p<f.length;++p){const g=Nm(l[p],f[p]);if(g!==0)return g;const v=Xi(a[l[p]],u[f[p]]);if(v!==0)return v}return Ce(l.length,f.length)}(t.mapValue,e.mapValue);default:throw ce(23264,{he:n})}}function LE(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Ce(t,e);const n=ei(t),r=ei(e),i=Ce(n.seconds,r.seconds);return i!==0?i:Ce(n.nanos,r.nanos)}function FE(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const s=Xi(n[i],r[i]);if(s)return s}return Ce(n.length,r.length)}function ba(t){return Fm(t)}function Fm(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=ei(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return ti(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return se.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=Fm(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${Fm(n.fields[o])}`;return i+"}"}(t.mapValue):ce(61005,{value:t})}function vd(t){switch(Yi(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=tf(t);return e?16+vd(e):16;case 5:return 2*t.stringValue.length;case 6:return ti(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,s)=>i+vd(s),0)}(t.arrayValue);case 10:case 11:return function(r){let i=0;return os(r.fields,(s,o)=>{i+=s.length+vd(o)}),i}(t.mapValue);default:throw ce(13486,{value:t})}}function Mu(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Um(t){return!!t&&"integerValue"in t}function Vu(t){return!!t&&"arrayValue"in t}function UE(t){return!!t&&"nullValue"in t}function OE(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Td(t){return!!t&&"mapValue"in t}function nf(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[x_])==null?void 0:r.stringValue)===R_}function tu(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return os(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=tu(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=tu(t.arrayValue.values[n]);return e}return{...t}}function mA(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===pA}const gA={mapValue:{fields:{[x_]:{stringValue:R_},[Da]:{arrayValue:{}}}}};function zU(t){return"nullValue"in t?yd:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?Mu(Qi.empty(),se.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?nf(t)?gA:{mapValue:{}}:ce(35942,{value:t})}function $U(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?Mu(Qi.empty(),se.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?gA:"mapValue"in t?nf(t)?{mapValue:{}}:ki:ce(61959,{value:t})}function BE(t,e){const n=Xi(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function qE(t,e){const n=Xi(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jt{constructor(e){this.value=e}static empty(){return new Jt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Td(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=tu(n)}setAll(e){let n=ct.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=tu(o):i.push(a.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());Td(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return kr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];Td(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){os(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new Jt(tu(this.value))}}function _A(t){const e=[];return os(t.fields,(n,r)=>{const i=new ct([n]);if(Td(r)){const s=_A(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new pn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vt{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new vt(e,0,_e.min(),_e.min(),_e.min(),Jt.empty(),0)}static newFoundDocument(e,n,r,i){return new vt(e,1,n,_e.min(),r,i,0)}static newNoDocument(e,n){return new vt(e,2,n,_e.min(),_e.min(),Jt.empty(),0)}static newUnknownDocument(e,n){return new vt(e,3,n,_e.min(),_e.min(),Jt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(_e.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Jt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Jt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=_e.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof vt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new vt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ma{constructor(e,n){this.position=e,this.inclusive=n}}function GE(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(s.field.isKeyField()?r=se.comparator(se.fromName(o.referenceValue),n.key):r=Xi(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function zE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!kr(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dh{constructor(e,n="asc"){this.field=e,this.dir=n}}function HU(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yA{}class Me extends yA{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new WU(e,n,r):n==="array-contains"?new JU(e,r):n==="in"?new SA(e,r):n==="not-in"?new QU(e,r):n==="array-contains-any"?new YU(e,r):new Me(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new KU(e,r):new jU(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Xi(n,this.value)):n!==null&&Yi(this.value)===Yi(n)&&this.matchesComparison(Xi(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ce(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class He extends yA{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new He(e,n)}matches(e){return Va(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Va(t){return t.op==="and"}function Om(t){return t.op==="or"}function P_(t){return vA(t)&&Va(t)}function vA(t){for(const e of t.filters)if(e instanceof He)return!1;return!0}function Bm(t){if(t instanceof Me)return t.field.canonicalString()+t.op.toString()+ba(t.value);if(P_(t))return t.filters.map(e=>Bm(e)).join(",");{const e=t.filters.map(n=>Bm(n)).join(",");return`${t.op}(${e})`}}function TA(t,e){return t instanceof Me?function(r,i){return i instanceof Me&&r.op===i.op&&r.field.isEqual(i.field)&&kr(r.value,i.value)}(t,e):t instanceof He?function(r,i){return i instanceof He&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&TA(o,i.filters[a]),!0):!1}(t,e):void ce(19439)}function EA(t,e){const n=t.filters.concat(e);return He.create(n,t.op)}function IA(t){return t instanceof Me?function(n){return`${n.field.canonicalString()} ${n.op} ${ba(n.value)}`}(t):t instanceof He?function(n){return n.op.toString()+" {"+n.getFilters().map(IA).join(" ,")+"}"}(t):"Filter"}class WU extends Me{constructor(e,n,r){super(e,n,r),this.key=se.fromName(r.referenceValue)}matches(e){const n=se.comparator(e.key,this.key);return this.matchesComparison(n)}}class KU extends Me{constructor(e,n){super(e,"in",n),this.keys=wA("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class jU extends Me{constructor(e,n){super(e,"not-in",n),this.keys=wA("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function wA(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(r=>se.fromName(r.referenceValue))}class JU extends Me{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Vu(n)&&bu(n.arrayValue,this.value)}}class SA extends Me{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&bu(this.value.arrayValue,n)}}class QU extends Me{constructor(e,n){super(e,"not-in",n)}matches(e){if(bu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!bu(this.value.arrayValue,n)}}class YU extends Me{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Vu(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>bu(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XU{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.Te=null}}function qm(t,e=null,n=[],r=[],i=null,s=null,o=null){return new XU(t,e,n,r,i,s,o)}function io(t){const e=Ae(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Bm(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Yh(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>ba(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>ba(r)).join(",")),e.Te=n}return e.Te}function Yu(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!HU(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!TA(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!zE(t.startAt,e.startAt)&&zE(t.endAt,e.endAt)}function hh(t){return se.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function fh(t,e){return t.filters.filter(n=>n instanceof Me&&n.field.isEqual(e))}function $E(t,e,n){let r=yd,i=!0;for(const s of fh(t,e)){let o=yd,a=!0;switch(s.op){case"<":case"<=":o=zU(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=yd}BE({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];BE({value:r,inclusive:i},{value:o,inclusive:n.inclusive})<0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}function HE(t,e,n){let r=ki,i=!0;for(const s of fh(t,e)){let o=ki,a=!0;switch(s.op){case">=":case">":o=$U(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=ki}qE({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];qE({value:r,inclusive:i},{value:o,inclusive:n.inclusive})>0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xu{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function ZU(t,e,n,r,i,s,o,a){return new Xu(t,e,n,r,i,s,o,a)}function Zu(t){return new Xu(t)}function WE(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function CA(t){return t.collectionGroup!==null}function nu(t){const e=Ae(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Ke(ct.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(u=>{u.isInequality()&&(a=a.add(u.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new dh(s,r))}),n.has(ct.keyField().canonicalString())||e.Ie.push(new dh(ct.keyField(),r))}return e.Ie}function Bn(t){const e=Ae(t);return e.Ee||(e.Ee=e4(e,nu(t))),e.Ee}function e4(t,e){if(t.limitType==="F")return qm(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new dh(i.field,s)});const n=t.endAt?new Ma(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Ma(t.startAt.position,t.startAt.inclusive):null;return qm(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Gm(t,e){const n=t.filters.concat([e]);return new Xu(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function zm(t,e,n){return new Xu(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function rf(t,e){return Yu(Bn(t),Bn(e))&&t.limitType===e.limitType}function AA(t){return`${io(Bn(t))}|lt:${t.limitType}`}function qo(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>IA(i)).join(", ")}]`),Yh(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>ba(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>ba(i)).join(",")),`Target(${r})`}(Bn(t))}; limitType=${t.limitType})`}function ec(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):se.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of nu(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,a,l){const u=GE(o,a,l);return o.inclusive?u<=0:u<0}(r.startAt,nu(r),i)||r.endAt&&!function(o,a,l){const u=GE(o,a,l);return o.inclusive?u>=0:u>0}(r.endAt,nu(r),i))}(t,e)}function t4(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function xA(t){return(e,n)=>{let r=!1;for(const i of nu(t)){const s=n4(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function n4(t,e,n){const r=t.field.isKeyField()?se.comparator(e.key,n.key):function(s,o,a){const l=o.data.field(s),u=a.data.field(s);return l!==null&&u!==null?Xi(l,u):ce(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return ce(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class si{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){os(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return lA(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r4=new dt(se.comparator);function Sn(){return r4}const RA=new dt(se.comparator);function Ml(...t){let e=RA;for(const n of t)e=e.insert(n.key,n);return e}function PA(t){let e=RA;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Sr(){return ru()}function kA(){return ru()}function ru(){return new si(t=>t.toString(),(t,e)=>t.isEqual(e))}const i4=new dt(se.comparator),s4=new Ke(se.comparator);function Pe(...t){let e=s4;for(const n of t)e=e.add(n);return e}const o4=new Ke(Ce);function a4(){return o4}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k_(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ru(e)?"-0":e}}function NA(t){return{integerValue:""+t}}function l4(t,e){return pU(e)?NA(e):k_(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sf{constructor(){this._=void 0}}function u4(t,e,n){return t instanceof La?function(i,s){const o={fields:{[dA]:{stringValue:cA},[fA]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&A_(s)&&(s=tf(s)),s&&(o.fields[hA]=s),{mapValue:o}}(n,e):t instanceof Fa?bA(t,e):t instanceof Ua?MA(t,e):function(i,s){const o=DA(i,s),a=KE(o)+KE(i.Ae);return Um(o)&&Um(i.Ae)?NA(a):k_(i.serializer,a)}(t,e)}function c4(t,e,n){return t instanceof Fa?bA(t,e):t instanceof Ua?MA(t,e):n}function DA(t,e){return t instanceof Lu?function(r){return Um(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class La extends sf{}class Fa extends sf{constructor(e){super(),this.elements=e}}function bA(t,e){const n=VA(e);for(const r of t.elements)n.some(i=>kr(i,r))||n.push(r);return{arrayValue:{values:n}}}class Ua extends sf{constructor(e){super(),this.elements=e}}function MA(t,e){let n=VA(e);for(const r of t.elements)n=n.filter(i=>!kr(i,r));return{arrayValue:{values:n}}}class Lu extends sf{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function KE(t){return lt(t.integerValue||t.doubleValue)}function VA(t){return Vu(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LA{constructor(e,n){this.field=e,this.transform=n}}function d4(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof Fa&&i instanceof Fa||r instanceof Ua&&i instanceof Ua?xa(r.elements,i.elements,kr):r instanceof Lu&&i instanceof Lu?kr(r.Ae,i.Ae):r instanceof La&&i instanceof La}(t.transform,e.transform)}class h4{constructor(e,n){this.version=e,this.transformResults=n}}class rn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new rn}static exists(e){return new rn(void 0,e)}static updateTime(e){return new rn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ed(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class of{}function FA(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new af(t.key,rn.none()):new Ya(t.key,t.data,rn.none());{const n=t.data,r=Jt.empty();let i=new Ke(ct.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new oi(t.key,r,new pn(i.toArray()),rn.none())}}function f4(t,e,n){t instanceof Ya?function(i,s,o){const a=i.value.clone(),l=JE(i.fieldTransforms,s,o.transformResults);a.setAll(l),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof oi?function(i,s,o){if(!Ed(i.precondition,s))return void s.convertToUnknownDocument(o.version);const a=JE(i.fieldTransforms,s,o.transformResults),l=s.data;l.setAll(UA(i)),l.setAll(a),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function iu(t,e,n,r){return t instanceof Ya?function(s,o,a,l){if(!Ed(s.precondition,o))return a;const u=s.value.clone(),f=QE(s.fieldTransforms,l,o);return u.setAll(f),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,n,r):t instanceof oi?function(s,o,a,l){if(!Ed(s.precondition,o))return a;const u=QE(s.fieldTransforms,l,o),f=o.data;return f.setAll(UA(s)),f.setAll(u),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(p=>p.field))}(t,e,n,r):function(s,o,a){return Ed(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function p4(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=DA(r.transform,i||null);s!=null&&(n===null&&(n=Jt.empty()),n.set(r.field,s))}return n||null}function jE(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&xa(r,i,(s,o)=>d4(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Ya extends of{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class oi extends of{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function UA(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function JE(t,e,n){const r=new Map;ge(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,c4(o,a,n[i]))}return r}function QE(t,e,n){const r=new Map;for(const i of t){const s=i.transform,o=n.data.field(i.field);r.set(i.field,u4(s,o,e))}return r}class af extends of{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class OA extends of{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N_{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&f4(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=iu(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=iu(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=kA();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;const l=FA(o,a);l!==null&&r.set(i.key,l),o.isValidDocument()||o.convertToNoDocument(_e.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Pe())}isEqual(e){return this.batchId===e.batchId&&xa(this.mutations,e.mutations,(n,r)=>jE(n,r))&&xa(this.baseMutations,e.baseMutations,(n,r)=>jE(n,r))}}class D_{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){ge(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=function(){return i4}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new D_(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b_{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m4{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var It,Ue;function g4(t){switch(t){case j.OK:return ce(64938);case j.CANCELLED:case j.UNKNOWN:case j.DEADLINE_EXCEEDED:case j.RESOURCE_EXHAUSTED:case j.INTERNAL:case j.UNAVAILABLE:case j.UNAUTHENTICATED:return!1;case j.INVALID_ARGUMENT:case j.NOT_FOUND:case j.ALREADY_EXISTS:case j.PERMISSION_DENIED:case j.FAILED_PRECONDITION:case j.ABORTED:case j.OUT_OF_RANGE:case j.UNIMPLEMENTED:case j.DATA_LOSS:return!0;default:return ce(15467,{code:t})}}function BA(t){if(t===void 0)return nn("GRPC error has no .code"),j.UNKNOWN;switch(t){case It.OK:return j.OK;case It.CANCELLED:return j.CANCELLED;case It.UNKNOWN:return j.UNKNOWN;case It.DEADLINE_EXCEEDED:return j.DEADLINE_EXCEEDED;case It.RESOURCE_EXHAUSTED:return j.RESOURCE_EXHAUSTED;case It.INTERNAL:return j.INTERNAL;case It.UNAVAILABLE:return j.UNAVAILABLE;case It.UNAUTHENTICATED:return j.UNAUTHENTICATED;case It.INVALID_ARGUMENT:return j.INVALID_ARGUMENT;case It.NOT_FOUND:return j.NOT_FOUND;case It.ALREADY_EXISTS:return j.ALREADY_EXISTS;case It.PERMISSION_DENIED:return j.PERMISSION_DENIED;case It.FAILED_PRECONDITION:return j.FAILED_PRECONDITION;case It.ABORTED:return j.ABORTED;case It.OUT_OF_RANGE:return j.OUT_OF_RANGE;case It.UNIMPLEMENTED:return j.UNIMPLEMENTED;case It.DATA_LOSS:return j.DATA_LOSS;default:return ce(39323,{code:t})}}(Ue=It||(It={}))[Ue.OK=0]="OK",Ue[Ue.CANCELLED=1]="CANCELLED",Ue[Ue.UNKNOWN=2]="UNKNOWN",Ue[Ue.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ue[Ue.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ue[Ue.NOT_FOUND=5]="NOT_FOUND",Ue[Ue.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ue[Ue.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ue[Ue.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ue[Ue.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ue[Ue.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ue[Ue.ABORTED=10]="ABORTED",Ue[Ue.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ue[Ue.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ue[Ue.INTERNAL=13]="INTERNAL",Ue[Ue.UNAVAILABLE=14]="UNAVAILABLE",Ue[Ue.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _4(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y4=new Gi([4294967295,4294967295],0);function YE(t){const e=_4().encode(t),n=new M0;return n.update(e),new Uint8Array(n.digest())}function XE(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Gi([n,r],0),new Gi([i,s],0)]}class M_{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Vl(`Invalid padding: ${n}`);if(r<0)throw new Vl(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Vl(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Vl(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=Gi.fromNumber(this.ge)}ye(e,n,r){let i=e.add(n.multiply(Gi.fromNumber(r)));return i.compare(y4)===1&&(i=new Gi([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=YE(e),[r,i]=XE(n);for(let s=0;s<this.hashCount;s++){const o=this.ye(r,i,s);if(!this.we(o))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new M_(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.ge===0)return;const n=YE(e),[r,i]=XE(n);for(let s=0;s<this.hashCount;s++){const o=this.ye(r,i,s);this.Se(o)}}Se(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Vl extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lf{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,tc.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new lf(_e.min(),i,new dt(Ce),Sn(),Pe())}}class tc{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new tc(r,n,Pe(),Pe(),Pe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Id{constructor(e,n,r,i){this.be=e,this.removedTargetIds=n,this.key=r,this.De=i}}class qA{constructor(e,n){this.targetId=e,this.Ce=n}}class GA{constructor(e,n,r=Et.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class ZE{constructor(){this.ve=0,this.Fe=eI(),this.Me=Et.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Pe(),n=Pe(),r=Pe();return this.Fe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:ce(38017,{changeType:s})}}),new tc(this.Me,this.xe,e,n,r)}qe(){this.Oe=!1,this.Fe=eI()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,ge(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class v4{constructor(e){this.Ge=e,this.ze=new Map,this.je=Sn(),this.Je=Hc(),this.He=Hc(),this.Ye=new dt(Ce)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:ce(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((r,i)=>{this.rt(i)&&n(i)})}st(e){const n=e.targetId,r=e.Ce.count,i=this.ot(n);if(i){const s=i.target;if(hh(s))if(r===0){const o=new se(s.path);this.et(n,o,vt.newNoDocument(o,_e.min()))}else ge(r===1,20013,{expectedCount:r});else{const o=this._t(n);if(o!==r){const a=this.ut(e),l=a?this.ct(a,e,o):1;if(l!==0){this.it(n);const u=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,u)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let o,a;try{o=ti(r).toUint8Array()}catch(l){if(l instanceof uA)return Ji("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new M_(o,i,s)}catch(l){return Ji(l instanceof Vl?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.ge===0?null:a}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.et(n,s,null),i++)}),i}Tt(e){const n=new Map;this.ze.forEach((s,o)=>{const a=this.ot(o);if(a){if(s.current&&hh(a.target)){const l=new se(a.target.path);this.It(l).has(o)||this.Et(o,l)||this.et(o,l,vt.newNoDocument(l,e))}s.Be&&(n.set(o,s.ke()),s.qe())}});let r=Pe();this.He.forEach((s,o)=>{let a=!0;o.forEachWhile(l=>{const u=this.ot(l);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.je.forEach((s,o)=>o.setReadTime(e));const i=new lf(e,n,this.Ye,this.je,r);return this.je=Sn(),this.Je=Hc(),this.He=Hc(),this.Ye=new dt(Ce),i}Xe(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,r),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,n)?i.Qe(n,1):i.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new ZE,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new Ke(Ce),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new Ke(Ce),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||ee("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new ZE),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function Hc(){return new dt(se.comparator)}function eI(){return new dt(se.comparator)}const T4={asc:"ASCENDING",desc:"DESCENDING"},E4={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},I4={and:"AND",or:"OR"};class w4{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function $m(t,e){return t.useProto3Json||Yh(e)?e:{value:e}}function Oa(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function zA(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function S4(t,e){return Oa(t,e.toTimestamp())}function an(t){return ge(!!t,49232),_e.fromTimestamp(function(n){const r=ei(n);return new $e(r.seconds,r.nanos)}(t))}function V_(t,e){return Hm(t,e).canonicalString()}function Hm(t,e){const n=function(i){return new Ge(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function $A(t){const e=Ge.fromString(t);return ge(ZA(e),10190,{key:e.toString()}),e}function ph(t,e){return V_(t.databaseId,e.path)}function Ks(t,e){const n=$A(e);if(n.get(1)!==t.databaseId.projectId)throw new re(j.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new re(j.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new se(KA(n))}function HA(t,e){return V_(t.databaseId,e)}function WA(t){const e=$A(t);return e.length===4?Ge.emptyPath():KA(e)}function Wm(t){return new Ge(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function KA(t){return ge(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function tI(t,e,n){return{name:ph(t,e),fields:n.value.mapValue.fields}}function C4(t,e,n){const r=Ks(t,e.name),i=an(e.updateTime),s=e.createTime?an(e.createTime):_e.min(),o=new Jt({mapValue:{fields:e.fields}}),a=vt.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function A4(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:ce(39313,{state:u})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(u,f){return u.useProto3Json?(ge(f===void 0||typeof f=="string",58123),Et.fromBase64String(f||"")):(ge(f===void 0||f instanceof Buffer||f instanceof Uint8Array,16193),Et.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(u){const f=u.code===void 0?j.UNKNOWN:BA(u.code);return new re(f,u.message||"")}(o);n=new GA(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Ks(t,r.document.name),s=an(r.document.updateTime),o=r.document.createTime?an(r.document.createTime):_e.min(),a=new Jt({mapValue:{fields:r.document.fields}}),l=vt.newFoundDocument(i,s,o,a),u=r.targetIds||[],f=r.removedTargetIds||[];n=new Id(u,f,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Ks(t,r.document),s=r.readTime?an(r.readTime):_e.min(),o=vt.newNoDocument(i,s),a=r.removedTargetIds||[];n=new Id([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Ks(t,r.document),s=r.removedTargetIds||[];n=new Id([],s,i,null)}else{if(!("filter"in e))return ce(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new m4(i,s),a=r.targetId;n=new qA(a,o)}}return n}function mh(t,e){let n;if(e instanceof Ya)n={update:tI(t,e.key,e.value)};else if(e instanceof af)n={delete:ph(t,e.key)};else if(e instanceof oi)n={update:tI(t,e.key,e.data),updateMask:D4(e.fieldMask)};else{if(!(e instanceof OA))return ce(16599,{Vt:e.type});n={verify:ph(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const a=o.transform;if(a instanceof La)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Fa)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Ua)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Lu)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw ce(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:S4(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:ce(27497)}(t,e.precondition)),n}function Km(t,e){const n=e.currentDocument?function(s){return s.updateTime!==void 0?rn.updateTime(an(s.updateTime)):s.exists!==void 0?rn.exists(s.exists):rn.none()}(e.currentDocument):rn.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let l=null;if("setToServerValue"in a)ge(a.setToServerValue==="REQUEST_TIME",16630,{proto:a}),l=new La;else if("appendMissingElements"in a){const f=a.appendMissingElements.values||[];l=new Fa(f)}else if("removeAllFromArray"in a){const f=a.removeAllFromArray.values||[];l=new Ua(f)}else"increment"in a?l=new Lu(o,a.increment):ce(16584,{proto:a});const u=ct.fromServerFormat(a.fieldPath);return new LA(u,l)}(t,i)):[];if(e.update){e.update.name;const i=Ks(t,e.update.name),s=new Jt({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(l){const u=l.fieldPaths||[];return new pn(u.map(f=>ct.fromServerFormat(f)))}(e.updateMask);return new oi(i,s,o,n,r)}return new Ya(i,s,n,r)}if(e.delete){const i=Ks(t,e.delete);return new af(i,n)}if(e.verify){const i=Ks(t,e.verify);return new OA(i,n)}return ce(1463,{proto:e})}function x4(t,e){return t&&t.length>0?(ge(e!==void 0,14353),t.map(n=>function(i,s){let o=i.updateTime?an(i.updateTime):an(s);return o.isEqual(_e.min())&&(o=an(s)),new h4(o,i.transformResults||[])}(n,e))):[]}function jA(t,e){return{documents:[HA(t,e.path)]}}function JA(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=HA(t,i);const s=function(u){if(u.length!==0)return XA(He.create(u,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const o=function(u){if(u.length!==0)return u.map(f=>function(g){return{field:Go(g.field),direction:P4(g.dir)}}(f))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=$m(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{ft:n,parent:i}}function QA(t){let e=WA(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){ge(r===1,65062);const f=n.from[0];f.allDescendants?i=f.collectionId:e=e.child(f.collectionId)}let s=[];n.where&&(s=function(p){const g=YA(p);return g instanceof He&&P_(g)?g.getFilters():[g]}(n.where));let o=[];n.orderBy&&(o=function(p){return p.map(g=>function(E){return new dh(zo(E.field),function(b){switch(b){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(E.direction))}(g))}(n.orderBy));let a=null;n.limit&&(a=function(p){let g;return g=typeof p=="object"?p.value:p,Yh(g)?null:g}(n.limit));let l=null;n.startAt&&(l=function(p){const g=!!p.before,v=p.values||[];return new Ma(v,g)}(n.startAt));let u=null;return n.endAt&&(u=function(p){const g=!p.before,v=p.values||[];return new Ma(v,g)}(n.endAt)),ZU(e,i,o,s,a,"F",l,u)}function R4(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ce(28987,{purpose:i})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function YA(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=zo(n.unaryFilter.field);return Me.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=zo(n.unaryFilter.field);return Me.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=zo(n.unaryFilter.field);return Me.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=zo(n.unaryFilter.field);return Me.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ce(61313);default:return ce(60726)}}(t):t.fieldFilter!==void 0?function(n){return Me.create(zo(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ce(58110);default:return ce(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return He.create(n.compositeFilter.filters.map(r=>YA(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return ce(1026)}}(n.compositeFilter.op))}(t):ce(30097,{filter:t})}function P4(t){return T4[t]}function k4(t){return E4[t]}function N4(t){return I4[t]}function Go(t){return{fieldPath:t.canonicalString()}}function zo(t){return ct.fromServerFormat(t.fieldPath)}function XA(t){return t instanceof Me?function(n){if(n.op==="=="){if(OE(n.value))return{unaryFilter:{field:Go(n.field),op:"IS_NAN"}};if(UE(n.value))return{unaryFilter:{field:Go(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(OE(n.value))return{unaryFilter:{field:Go(n.field),op:"IS_NOT_NAN"}};if(UE(n.value))return{unaryFilter:{field:Go(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Go(n.field),op:k4(n.op),value:n.value}}}(t):t instanceof He?function(n){const r=n.getFilters().map(i=>XA(i));return r.length===1?r[0]:{compositeFilter:{op:N4(n.op),filters:r}}}(t):ce(54877,{filter:t})}function D4(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function ZA(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hr{constructor(e,n,r,i,s=_e.min(),o=_e.min(),a=Et.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new Hr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Hr(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Hr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Hr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ex{constructor(e){this.yt=e}}function b4(t,e){let n;if(e.document)n=C4(t.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=se.fromSegments(e.noDocument.path),i=oo(e.noDocument.readTime);n=vt.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return ce(56709);{const r=se.fromSegments(e.unknownDocument.path),i=oo(e.unknownDocument.version);n=vt.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){const s=new $e(i[0],i[1]);return _e.fromTimestamp(s)}(e.readTime)),n}function nI(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:gh(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:ph(s,o.key),fields:o.data.value.mapValue.fields,updateTime:Oa(s,o.version.toTimestamp()),createTime:Oa(s,o.createTime.toTimestamp())}}(t.yt,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:so(e.version)};else{if(!e.isUnknownDocument())return ce(57904,{document:e});r.unknownDocument={path:n.path.toArray(),version:so(e.version)}}return r}function gh(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function so(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function oo(t){const e=new $e(t.seconds,t.nanoseconds);return _e.fromTimestamp(e)}function Ms(t,e){const n=(e.baseMutations||[]).map(s=>Km(t.yt,s));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map(s=>Km(t.yt,s)),i=$e.fromMillis(e.localWriteTimeMs);return new N_(e.batchId,i,n,r)}function Ll(t){const e=oo(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?oo(t.lastLimboFreeSnapshotVersion):_e.min();let r;return r=function(s){return s.documents!==void 0}(t.query)?function(s){const o=s.documents.length;return ge(o===1,1966,{count:o}),Bn(Zu(WA(s.documents[0])))}(t.query):function(s){return Bn(QA(s))}(t.query),new Hr(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,Et.fromBase64String(t.resumeToken))}function tx(t,e){const n=so(e.snapshotVersion),r=so(e.lastLimboFreeSnapshotVersion);let i;i=hh(e.target)?jA(t.yt,e.target):JA(t.yt,e.target).ft;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:io(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function nx(t){const e=QA({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?zm(e,e.limit,"L"):e}function pp(t,e){return new b_(e.largestBatchId,Km(t.yt,e.overlayMutation))}function rI(t,e){const n=e.path.lastSegment();return[t,Yt(e.path.popLast()),n]}function iI(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:so(r.readTime),documentKey:Yt(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M4{getBundleMetadata(e,n){return sI(e).get(n).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:oo(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,n){return sI(e).put(function(i){return{bundleId:i.id,createTime:so(an(i.createTime)),version:i.version}}(n))}getNamedQuery(e,n){return oI(e).get(n).next(r=>{if(r)return function(s){return{name:s.name,query:nx(s.bundledQuery),readTime:oo(s.readTime)}}(r)})}saveNamedQuery(e,n){return oI(e).put(function(i){return{name:i.name,readTime:so(an(i.readTime)),bundledQuery:i.bundledQuery}}(n))}}function sI(t){return kt(t,Xh)}function oI(t){return kt(t,Zh)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uf{constructor(e,n){this.serializer=e,this.userId=n}static wt(e,n){const r=n.uid||"";return new uf(e,r)}getOverlay(e,n){return Sl(e).get(rI(this.userId,n)).next(r=>r?pp(this.serializer,r):null)}getOverlays(e,n){const r=Sr();return q.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){const i=[];return r.forEach((s,o)=>{const a=new b_(n,o);i.push(this.St(e,a))}),q.waitFor(i)}removeOverlaysForBatchId(e,n,r){const i=new Set;n.forEach(o=>i.add(Yt(o.getCollectionPath())));const s=[];return i.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(Sl(e).Z(Vm,a))}),q.waitFor(s)}getOverlaysForCollection(e,n,r){const i=Sr(),s=Yt(n),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Sl(e).J(Vm,o).next(a=>{for(const l of a){const u=pp(this.serializer,l);i.set(u.getKey(),u)}return i})}getOverlaysForCollectionGroup(e,n,r,i){const s=Sr();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return Sl(e).ee({index:rA,range:a},(l,u,f)=>{const p=pp(this.serializer,u);s.size()<i||p.largestBatchId===o?(s.set(p.getKey(),p),o=p.largestBatchId):f.done()}).next(()=>s)}St(e,n){return Sl(e).put(function(i,s,o){const[a,l,u]=rI(s,o.mutation.key);return{userId:s,collectionPath:l,documentId:u,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:mh(i.yt,o.mutation)}}(this.serializer,this.userId,n))}}function Sl(t){return kt(t,ef)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V4{bt(e){return kt(e,S_)}getSessionToken(e){return this.bt(e).get("sessionToken").next(n=>{const r=n==null?void 0:n.value;return r?Et.fromUint8Array(r):Et.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.bt(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vs{constructor(){}Dt(e,n){this.Ct(e,n),n.vt()}Ct(e,n){if("nullValue"in e)this.Ft(n,5);else if("booleanValue"in e)this.Ft(n,10),n.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(n,15),n.Mt(lt(e.integerValue));else if("doubleValue"in e){const r=lt(e.doubleValue);isNaN(r)?this.Ft(n,13):(this.Ft(n,15),Ru(r)?n.Mt(0):n.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(n,20),typeof r=="string"&&(r=ei(r)),n.xt(`${r.seconds||""}`),n.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,n),this.Nt(n);else if("bytesValue"in e)this.Ft(n,30),n.Bt(ti(e.bytesValue)),this.Nt(n);else if("referenceValue"in e)this.Lt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(n,45),n.Mt(r.latitude||0),n.Mt(r.longitude||0)}else"mapValue"in e?mA(e)?this.Ft(n,Number.MAX_SAFE_INTEGER):nf(e)?this.kt(e.mapValue,n):(this.qt(e.mapValue,n),this.Nt(n)):"arrayValue"in e?(this.Qt(e.arrayValue,n),this.Nt(n)):ce(19022,{$t:e})}Ot(e,n){this.Ft(n,25),this.Ut(e,n)}Ut(e,n){n.xt(e)}qt(e,n){const r=e.fields||{};this.Ft(n,55);for(const i of Object.keys(r))this.Ot(i,n),this.Ct(r[i],n)}kt(e,n){var o,a;const r=e.fields||{};this.Ft(n,53);const i=Da,s=((a=(o=r[i].arrayValue)==null?void 0:o.values)==null?void 0:a.length)||0;this.Ft(n,15),n.Mt(lt(s)),this.Ot(i,n),this.Ct(r[i],n)}Qt(e,n){const r=e.values||[];this.Ft(n,50);for(const i of r)this.Ct(i,n)}Lt(e,n){this.Ft(n,37),se.fromName(e).path.forEach(r=>{this.Ft(n,60),this.Ut(r,n)})}Ft(e,n){e.Mt(n)}Nt(e){e.Mt(2)}}Vs.Kt=new Vs;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lo=255;function L4(t){if(t===0)return 8;let e=0;return t>>4||(e+=4,t<<=4),t>>6||(e+=2,t<<=2),t>>7||(e+=1),e}function aI(t){const e=64-function(r){let i=0;for(let s=0;s<8;++s){const o=L4(255&r[s]);if(i+=o,o!==8)break}return i}(t);return Math.ceil(e/8)}class F4{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Gt(r.value),r=n.next();this.zt()}jt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Jt(r.value),r=n.next();this.Ht()}Yt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const i=n.codePointAt(0);this.Gt(240|i>>>18),this.Gt(128|63&i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i)}}this.zt()}Zt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const i=n.codePointAt(0);this.Jt(240|i>>>18),this.Jt(128|63&i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i)}}this.Ht()}Xt(e){const n=this.en(e),r=aI(n);this.tn(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}nn(e){const n=this.en(e),r=aI(n);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}rn(){this.sn(Lo),this.sn(255)}_n(){this.an(Lo),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const n=function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=!!(128&n[0]);n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Gt(e){const n=255&e;n===0?(this.sn(0),this.sn(255)):n===Lo?(this.sn(Lo),this.sn(0)):this.sn(n)}Jt(e){const n=255&e;n===0?(this.an(0),this.an(255)):n===Lo?(this.an(Lo),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class U4{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class O4{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class Cl{constructor(){this.cn=new F4,this.ln=new U4(this.cn),this.hn=new O4(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ls{constructor(e,n,r,i){this.Tn=e,this.In=n,this.En=r,this.dn=i}An(){const e=this.dn.length,n=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.dn,0),n!==e?r.set([0],this.dn.length):++r[r.length-1],new Ls(this.Tn,this.In,this.En,r)}Rn(e,n,r){return{indexId:this.Tn,uid:e,arrayValue:wd(this.En),directionalValue:wd(this.dn),orderedDocumentKey:wd(n),documentKey:r.path.toArray()}}Vn(e,n,r){const i=this.Rn(e,n,r);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}}function mi(t,e){let n=t.Tn-e.Tn;return n!==0?n:(n=lI(t.En,e.En),n!==0?n:(n=lI(t.dn,e.dn),n!==0?n:se.comparator(t.In,e.In)))}function lI(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}function wd(t){return JC()?function(n){let r="";for(let i=0;i<n.length;i++)r+=String.fromCharCode(n[i]);return r}(t):t}function uI(t){return typeof t!="string"?t:function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(t)}class cI{constructor(e){this.mn=new Ke((n,r)=>ct.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const n of e.filters){const r=n;r.isInequality()?this.mn=this.mn.add(r):this.gn.push(r)}}get pn(){return this.mn.size>1}yn(e){if(ge(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const n=Dm(e);if(n!==void 0&&!this.wn(n))return!1;const r=Ns(e);let i=new Set,s=0,o=0;for(;s<r.length&&this.wn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.mn.size>0){const a=this.mn.getIterator().getNext();if(!i.has(a.field.canonicalString())){const l=r[s];if(!this.Sn(a,l)||!this.bn(this.fn[o++],l))return!1}++s}for(;s<r.length;++s){const a=r[s];if(o>=this.fn.length||!this.bn(this.fn[o++],a))return!1}return!0}Dn(){if(this.pn)return null;let e=new Ke(ct.comparator);const n=[];for(const r of this.gn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new md(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new md(r.field,0))}for(const r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new md(r.field,r.dir==="asc"?0:1)));return new oh(oh.UNKNOWN_ID,this.collectionId,n,xu.empty())}wn(e){for(const n of this.gn)if(this.Sn(n,e))return!0;return!1}Sn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}bn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rx(t){var n,r;if(ge(t instanceof Me||t instanceof He,20012),t instanceof Me){if(t instanceof SA){const i=((r=(n=t.value.arrayValue)==null?void 0:n.values)==null?void 0:r.map(s=>Me.create(t.field,"==",s)))||[];return He.create(i,"or")}return t}const e=t.filters.map(i=>rx(i));return He.create(e,t.op)}function B4(t){if(t.getFilters().length===0)return[];const e=Qm(rx(t));return ge(ix(e),7391),jm(e)||Jm(e)?[e]:e.getFilters()}function jm(t){return t instanceof Me}function Jm(t){return t instanceof He&&P_(t)}function ix(t){return jm(t)||Jm(t)||function(n){if(n instanceof He&&Om(n)){for(const r of n.getFilters())if(!jm(r)&&!Jm(r))return!1;return!0}return!1}(t)}function Qm(t){if(ge(t instanceof Me||t instanceof He,34018),t instanceof Me)return t;if(t.filters.length===1)return Qm(t.filters[0]);const e=t.filters.map(r=>Qm(r));let n=He.create(e,t.op);return n=_h(n),ix(n)?n:(ge(n instanceof He,64498),ge(Va(n),40251),ge(n.filters.length>1,57927),n.filters.reduce((r,i)=>L_(r,i)))}function L_(t,e){let n;return ge(t instanceof Me||t instanceof He,38388),ge(e instanceof Me||e instanceof He,25473),n=t instanceof Me?e instanceof Me?function(i,s){return He.create([i,s],"and")}(t,e):dI(t,e):e instanceof Me?dI(e,t):function(i,s){if(ge(i.filters.length>0&&s.filters.length>0,48005),Va(i)&&Va(s))return EA(i,s.getFilters());const o=Om(i)?i:s,a=Om(i)?s:i,l=o.filters.map(u=>L_(u,a));return He.create(l,"or")}(t,e),_h(n)}function dI(t,e){if(Va(e))return EA(e,t.getFilters());{const n=e.filters.map(r=>L_(t,r));return He.create(n,"or")}}function _h(t){if(ge(t instanceof Me||t instanceof He,11850),t instanceof Me)return t;const e=t.getFilters();if(e.length===1)return _h(e[0]);if(vA(t))return t;const n=e.map(i=>_h(i)),r=[];return n.forEach(i=>{i instanceof Me?r.push(i):i instanceof He&&(i.op===t.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:He.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q4{constructor(){this.Cn=new F_}addToCollectionParentIndex(e,n){return this.Cn.add(n),q.resolve()}getCollectionParents(e,n){return q.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return q.resolve()}deleteFieldIndex(e,n){return q.resolve()}deleteAllFieldIndexes(e){return q.resolve()}createTargetIndexes(e,n){return q.resolve()}getDocumentsMatchingTarget(e,n){return q.resolve(null)}getIndexType(e,n){return q.resolve(0)}getFieldIndexes(e,n){return q.resolve([])}getNextCollectionGroupToUpdate(e){return q.resolve(null)}getMinOffset(e,n){return q.resolve(xn.min())}getMinOffsetFromCollectionGroup(e,n){return q.resolve(xn.min())}updateCollectionGroup(e,n,r){return q.resolve()}updateIndexEntries(e,n){return q.resolve()}}class F_{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Ke(Ge.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Ke(Ge.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hI="IndexedDbIndexManager",Wc=new Uint8Array(0);class G4{constructor(e,n){this.databaseId=n,this.vn=new F_,this.Fn=new si(r=>io(r),(r,i)=>Yu(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.vn.has(n)){const r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this.vn.add(n)});const s={collectionId:r,parent:Yt(i)};return fI(e).put(s)}return q.resolve()}getCollectionParents(e,n){const r=[],i=IDBKeyRange.bound([n,""],[$0(n),""],!1,!0);return fI(e).J(i).next(s=>{for(const o of s){if(o.collectionId!==n)break;r.push(wr(o.parent))}return r})}addFieldIndex(e,n){const r=Al(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(l=>[l.fieldPath.canonicalString(),l.kind])}}(n);delete i.indexId;const s=r.add(i);if(n.indexState){const o=Uo(e);return s.next(a=>{o.put(iI(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){const r=Al(e),i=Uo(e),s=Fo(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=Al(e),r=Fo(e),i=Uo(e);return n.Z().next(()=>r.Z()).next(()=>i.Z())}createTargetIndexes(e,n){return q.forEach(this.Mn(n),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){const s=new cI(r).Dn();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,n){const r=Fo(e);let i=!0;const s=new Map;return q.forEach(this.Mn(n),o=>this.xn(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=Pe();const a=[];return q.forEach(s,(l,u)=>{ee(hI,`Using index ${function(S){return`id=${S.indexId}|cg=${S.collectionGroup}|f=${S.fields.map(V=>`${V.fieldPath}:${V.kind}`).join(",")}`}(l)} to execute ${io(n)}`);const f=function(S,V){const U=Dm(V);if(U===void 0)return null;for(const B of fh(S,U.fieldPath))switch(B.op){case"array-contains-any":return B.value.arrayValue.values||[];case"array-contains":return[B.value]}return null}(u,l),p=function(S,V){const U=new Map;for(const B of Ns(V))for(const T of fh(S,B.fieldPath))switch(T.op){case"==":case"in":U.set(B.fieldPath.canonicalString(),T.value);break;case"not-in":case"!=":return U.set(B.fieldPath.canonicalString(),T.value),Array.from(U.values())}return null}(u,l),g=function(S,V){const U=[];let B=!0;for(const T of Ns(V)){const w=T.kind===0?$E(S,T.fieldPath,S.startAt):HE(S,T.fieldPath,S.startAt);U.push(w.value),B&&(B=w.inclusive)}return new Ma(U,B)}(u,l),v=function(S,V){const U=[];let B=!0;for(const T of Ns(V)){const w=T.kind===0?HE(S,T.fieldPath,S.endAt):$E(S,T.fieldPath,S.endAt);U.push(w.value),B&&(B=w.inclusive)}return new Ma(U,B)}(u,l),E=this.On(l,u,g),x=this.On(l,u,v),b=this.Nn(l,u,p),C=this.Bn(l.indexId,f,E,g.inclusive,x,v.inclusive,b);return q.forEach(C,I=>r.Y(I,n.limit).next(S=>{S.forEach(V=>{const U=se.fromSegments(V.documentKey);o.has(U)||(o=o.add(U),a.push(U))})}))}).next(()=>a)}return q.resolve(null)})}Mn(e){let n=this.Fn.get(e);return n||(e.filters.length===0?n=[e]:n=B4(He.create(e.filters,"and")).map(r=>qm(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.Fn.set(e,n),n)}Bn(e,n,r,i,s,o,a){const l=(n!=null?n.length:1)*Math.max(r.length,s.length),u=l/(n!=null?n.length:1),f=[];for(let p=0;p<l;++p){const g=n?this.Ln(n[p/u]):Wc,v=this.kn(e,g,r[p%u],i),E=this.qn(e,g,s[p%u],o),x=a.map(b=>this.kn(e,g,b,!0));f.push(...this.createRange(v,E,x))}return f}kn(e,n,r,i){const s=new Ls(e,se.empty(),n,r);return i?s:s.An()}qn(e,n,r,i){const s=new Ls(e,se.empty(),n,r);return i?s.An():s}xn(e,n){const r=new cI(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(const a of s)r.yn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2;const i=this.Mn(n);return q.forEach(i,s=>this.xn(e,s).next(o=>{o?r!==0&&o.fields.length<function(l){let u=new Ke(ct.comparator),f=!1;for(const p of l.filters)for(const g of p.getFlattenedFilters())g.field.isKeyField()||(g.op==="array-contains"||g.op==="array-contains-any"?f=!0:u=u.add(g.field));for(const p of l.orderBy)p.field.isKeyField()||(u=u.add(p.field));return u.size+(f?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&i.length>1&&r===2?1:r)}Qn(e,n){const r=new Cl;for(const i of Ns(e)){const s=n.data.field(i.fieldPath);if(s==null)return null;const o=r.Pn(i.kind);Vs.Kt.Dt(s,o)}return r.un()}Ln(e){const n=new Cl;return Vs.Kt.Dt(e,n.Pn(0)),n.un()}$n(e,n){const r=new Cl;return Vs.Kt.Dt(Mu(this.databaseId,n),r.Pn(function(s){const o=Ns(s);return o.length===0?0:o[o.length-1].kind}(e))),r.un()}Nn(e,n,r){if(r===null)return[];let i=[];i.push(new Cl);let s=0;for(const o of Ns(e)){const a=r[s++];for(const l of i)if(this.Un(n,o.fieldPath)&&Vu(a))i=this.Kn(i,o,a);else{const u=l.Pn(o.kind);Vs.Kt.Dt(a,u)}}return this.Wn(i)}On(e,n,r){return this.Nn(e,n,r.position)}Wn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].un();return n}Kn(e,n,r){const i=[...e],s=[];for(const o of r.arrayValue.values||[])for(const a of i){const l=new Cl;l.seed(a.un()),Vs.Kt.Dt(o,l.Pn(n.kind)),s.push(l)}return s}Un(e,n){return!!e.filters.find(r=>r instanceof Me&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=Al(e),i=Uo(e);return(n?r.J(Mm,IDBKeyRange.bound(n,n)):r.J()).next(s=>{const o=[];return q.forEach(s,a=>i.get([a.indexId,this.uid]).next(l=>{o.push(function(f,p){const g=p?new xu(p.sequenceNumber,new xn(oo(p.readTime),new se(wr(p.documentKey)),p.largestBatchId)):xu.empty(),v=f.fields.map(([E,x])=>new md(ct.fromServerFormat(E),x));return new oh(f.indexId,f.collectionGroup,v,g)}(a,l))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:Ce(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const i=Al(e),s=Uo(e);return this.Gn(e).next(o=>i.J(Mm,IDBKeyRange.bound(n,n)).next(a=>q.forEach(a,l=>s.put(iI(l.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){const r=new Map;return q.forEach(n,(i,s)=>{const o=r.get(i.collectionGroup);return(o?q.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),q.forEach(a,l=>this.zn(e,i,l).next(u=>{const f=this.jn(s,l);return u.isEqual(f)?q.resolve():this.Jn(e,s,l,u,f)}))))})}Hn(e,n,r,i){return Fo(e).put(i.Rn(this.uid,this.$n(r,n.key),n.key))}Yn(e,n,r,i){return Fo(e).delete(i.Vn(this.uid,this.$n(r,n.key),n.key))}zn(e,n,r){const i=Fo(e);let s=new Ke(mi);return i.ee({index:nA,range:IDBKeyRange.only([r.indexId,this.uid,wd(this.$n(r,n))])},(o,a)=>{s=s.add(new Ls(r.indexId,n,uI(a.arrayValue),uI(a.directionalValue)))}).next(()=>s)}jn(e,n){let r=new Ke(mi);const i=this.Qn(n,e);if(i==null)return r;const s=Dm(n);if(s!=null){const o=e.data.field(s.fieldPath);if(Vu(o))for(const a of o.arrayValue.values||[])r=r.add(new Ls(n.indexId,e.key,this.Ln(a),i))}else r=r.add(new Ls(n.indexId,e.key,Wc,i));return r}Jn(e,n,r,i,s){ee(hI,"Updating index entries for document '%s'",n.key);const o=[];return function(l,u,f,p,g){const v=l.getIterator(),E=u.getIterator();let x=Vo(v),b=Vo(E);for(;x||b;){let C=!1,I=!1;if(x&&b){const S=f(x,b);S<0?I=!0:S>0&&(C=!0)}else x!=null?I=!0:C=!0;C?(p(b),b=Vo(E)):I?(g(x),x=Vo(v)):(x=Vo(v),b=Vo(E))}}(i,s,mi,a=>{o.push(this.Hn(e,n,r,a))},a=>{o.push(this.Yn(e,n,r,a))}),q.waitFor(o)}Gn(e){let n=1;return Uo(e).ee({index:tA,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>mi(o,a)).filter((o,a,l)=>!a||mi(o,l[a-1])!==0);const i=[];i.push(e);for(const o of r){const a=mi(o,e),l=mi(o,n);if(a===0)i[0]=e.An();else if(a>0&&l<0)i.push(o),i.push(o.An());else if(l>0)break}i.push(n);const s=[];for(let o=0;o<i.length;o+=2){if(this.Zn(i[o],i[o+1]))return[];const a=i[o].Vn(this.uid,Wc,se.empty()),l=i[o+1].Vn(this.uid,Wc,se.empty());s.push(IDBKeyRange.bound(a,l))}return s}Zn(e,n){return mi(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(pI)}getMinOffset(e,n){return q.mapArray(this.Mn(n),r=>this.xn(e,r).next(i=>i||ce(44426))).next(pI)}}function fI(t){return kt(t,Nu)}function Fo(t){return kt(t,eu)}function Al(t){return kt(t,w_)}function Uo(t){return kt(t,Zl)}function pI(t){ge(t.length!==0,28825);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const i=t[r].indexState.offset;T_(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new xn(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mI={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},sx=41943040;class Kt{static withCacheSize(e){return new Kt(e,Kt.DEFAULT_COLLECTION_PERCENTILE,Kt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ox(t,e,n){const r=t.store(Xn),i=t.store(Ra),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const l=r.ee({range:o},(f,p,g)=>(a++,g.delete()));s.push(l.next(()=>{ge(a===1,47070,{batchId:n.batchId})}));const u=[];for(const f of n.mutations){const p=X0(e,f.key.path,n.batchId);s.push(i.delete(p)),u.push(f.key)}return q.waitFor(s).next(()=>u)}function yh(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw ce(14731);e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Kt.DEFAULT_COLLECTION_PERCENTILE=10,Kt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Kt.DEFAULT=new Kt(sx,Kt.DEFAULT_COLLECTION_PERCENTILE,Kt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Kt.DISABLED=new Kt(-1,0,0);class cf{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Xn={}}static wt(e,n,r,i){ge(e.uid!=="",64387);const s=e.isAuthenticated()?e.uid:"";return new cf(s,n,r,i)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return gi(e).ee({index:qs,range:r},(i,s,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,i){const s=$o(e),o=gi(e);return o.add({}).next(a=>{ge(typeof a=="number",49019);const l=new N_(a,n,r,i),u=function(v,E,x){const b=x.baseMutations.map(I=>mh(v.yt,I)),C=x.mutations.map(I=>mh(v.yt,I));return{userId:E,batchId:x.batchId,localWriteTimeMs:x.localWriteTime.toMillis(),baseMutations:b,mutations:C}}(this.serializer,this.userId,l),f=[];let p=new Ke((g,v)=>Ce(g.canonicalString(),v.canonicalString()));for(const g of i){const v=X0(this.userId,g.key.path,a);p=p.add(g.key.path.popLast()),f.push(o.put(u)),f.push(s.put(v,_U))}return p.forEach(g=>{f.push(this.indexManager.addToCollectionParentIndex(e,g))}),e.addOnCommittedListener(()=>{this.Xn[a]=l.keys()}),q.waitFor(f).next(()=>l)})}lookupMutationBatch(e,n){return gi(e).get(n).next(r=>r?(ge(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:n}),Ms(this.serializer,r)):null)}er(e,n){return this.Xn[n]?q.resolve(this.Xn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const i=r.keys();return this.Xn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return gi(e).ee({index:qs,range:i},(o,a,l)=>{a.userId===this.userId&&(ge(a.batchId>=r,47524,{tr:r}),s=Ms(this.serializer,a)),l.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=Hs;return gi(e).ee({index:qs,range:n,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,Hs],[this.userId,Number.POSITIVE_INFINITY]);return gi(e).J(qs,n).next(r=>r.map(i=>Ms(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=gd(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return $o(e).ee({range:i},(o,a,l)=>{const[u,f,p]=o,g=wr(f);if(u===this.userId&&n.path.isEqual(g))return gi(e).get(p).next(v=>{if(!v)throw ce(61480,{nr:o,batchId:p});ge(v.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:v.userId,batchId:p}),s.push(Ms(this.serializer,v))});l.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ke(Ce);const i=[];return n.forEach(s=>{const o=gd(this.userId,s.path),a=IDBKeyRange.lowerBound(o),l=$o(e).ee({range:a},(u,f,p)=>{const[g,v,E]=u,x=wr(v);g===this.userId&&s.path.isEqual(x)?r=r.add(E):p.done()});i.push(l)}),q.waitFor(i).next(()=>this.rr(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1,s=gd(this.userId,r),o=IDBKeyRange.lowerBound(s);let a=new Ke(Ce);return $o(e).ee({range:o},(l,u,f)=>{const[p,g,v]=l,E=wr(g);p===this.userId&&r.isPrefixOf(E)?E.length===i&&(a=a.add(v)):f.done()}).next(()=>this.rr(e,a))}rr(e,n){const r=[],i=[];return n.forEach(s=>{i.push(gi(e).get(s).next(o=>{if(o===null)throw ce(35274,{batchId:s});ge(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:s}),r.push(Ms(this.serializer,o))}))}),q.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return ox(e.le,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.ir(n.batchId)}),q.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return q.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return $o(e).ee({range:r},(s,o,a)=>{if(s[0]===this.userId){const l=wr(s[1]);i.push(l)}else a.done()}).next(()=>{ge(i.length===0,56720,{sr:i.map(s=>s.canonicalString())})})})}containsKey(e,n){return ax(e,this.userId,n)}_r(e){return lx(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:Hs,lastStreamToken:""})}}function ax(t,e,n){const r=gd(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return $o(t).ee({range:s,X:!0},(a,l,u)=>{const[f,p,g]=a;f===e&&p===i&&(o=!0),u.done()}).next(()=>o)}function gi(t){return kt(t,Xn)}function $o(t){return kt(t,Ra)}function lx(t){return kt(t,Pu)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ao{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new ao(0)}static cr(){return new ao(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z4{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.lr(e).next(n=>{const r=new ao(n.highestTargetId);return n.highestTargetId=r.next(),this.hr(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.lr(e).next(n=>_e.fromTimestamp(new $e(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.lr(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.lr(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.hr(e,i)))}addTargetData(e,n){return this.Pr(e,n).next(()=>this.lr(e).next(r=>(r.targetCount+=1,this.Tr(n,r),this.hr(e,r))))}updateTargetData(e,n){return this.Pr(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>Oo(e).delete(n.targetId)).next(()=>this.lr(e)).next(r=>(ge(r.targetCount>0,8065),r.targetCount-=1,this.hr(e,r)))}removeTargets(e,n,r){let i=0;const s=[];return Oo(e).ee((o,a)=>{const l=Ll(a);l.sequenceNumber<=n&&r.get(l.targetId)===null&&(i++,s.push(this.removeTargetData(e,l)))}).next(()=>q.waitFor(s)).next(()=>i)}forEachTarget(e,n){return Oo(e).ee((r,i)=>{const s=Ll(i);n(s)})}lr(e){return gI(e).get(uh).next(n=>(ge(n!==null,2888),n))}hr(e,n){return gI(e).put(uh,n)}Pr(e,n){return Oo(e).put(tx(this.serializer,n))}Tr(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next(n=>n.targetCount)}getTargetData(e,n){const r=io(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return Oo(e).ee({range:i,index:eA},(o,a,l)=>{const u=Ll(a);Yu(n,u.target)&&(s=u,l.done())}).next(()=>s)}addMatchingKeys(e,n,r){const i=[],s=xi(e);return n.forEach(o=>{const a=Yt(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),q.waitFor(i)}removeMatchingKeys(e,n,r){const i=xi(e);return q.forEach(n,s=>{const o=Yt(s.path);return q.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){const r=xi(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),i=xi(e);let s=Pe();return i.ee({range:r,X:!0},(o,a,l)=>{const u=wr(o[1]),f=new se(u);s=s.add(f)}).next(()=>s)}containsKey(e,n){const r=Yt(n.path),i=IDBKeyRange.bound([r],[$0(r)],!1,!0);let s=0;return xi(e).ee({index:I_,X:!0,range:i},([o,a],l,u)=>{o!==0&&(s++,u.done())}).next(()=>s>0)}At(e,n){return Oo(e).get(n).next(r=>r?Ll(r):null)}}function Oo(t){return kt(t,Pa)}function gI(t){return kt(t,Ws)}function xi(t){return kt(t,ka)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _I="LruGarbageCollector",$4=1048576;function yI([t,e],[n,r]){const i=Ce(t,n);return i===0?Ce(e,r):i}class H4{constructor(e){this.Ir=e,this.buffer=new Ke(yI),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();yI(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class ux{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){ee(_I,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){ss(n)?ee(_I,"Ignoring IndexedDB error during garbage collection: ",n):await fo(n)}await this.Vr(3e5)})}}class W4{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return q.resolve(Fn.ce);const r=new H4(n);return this.mr.forEachTarget(e,i=>r.Ar(i.sequenceNumber)).next(()=>this.mr.pr(e,i=>r.Ar(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.mr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(ee("LruGarbageCollector","Garbage collection skipped; disabled"),q.resolve(mI)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(ee("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),mI):this.yr(e,n))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let r,i,s,o,a,l,u;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(p=>(p>this.params.maximumSequenceNumbersToCollect?(ee("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),i=this.params.maximumSequenceNumbersToCollect):i=p,o=Date.now(),this.nthSequenceNumber(e,i))).next(p=>(r=p,a=Date.now(),this.removeTargets(e,r,n))).next(p=>(s=p,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(p=>(u=Date.now(),Bo()<=be.DEBUG&&ee("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-f}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(l-a)+`ms
	Removed ${p} documents in `+(u-l)+`ms
Total Duration: ${u-f}ms`),q.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:p})))}}function cx(t,e){return new W4(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K4{constructor(e,n){this.db=e,this.garbageCollector=cx(this,n)}gr(e){const n=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}pr(e,n){return this.Sr(e,(r,i)=>n(i))}addReference(e,n,r){return Kc(e,r)}removeReference(e,n,r){return Kc(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return Kc(e,n)}br(e,n){return function(i,s){let o=!1;return lx(i).te(a=>ax(i,a,s).next(l=>(l&&(o=!0),q.resolve(!l)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Sr(e,(o,a)=>{if(a<=n){const l=this.br(e,o).next(u=>{if(!u)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,_e.min()),xi(e).delete(function(p){return[0,Yt(p.path)]}(o))))});i.push(l)}}).next(()=>q.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return Kc(e,n)}Sr(e,n){const r=xi(e);let i,s=Fn.ce;return r.ee({index:I_},([o,a],{path:l,sequenceNumber:u})=>{o===0?(s!==Fn.ce&&n(new se(wr(i)),s),s=u,i=l):s=Fn.ce}).next(()=>{s!==Fn.ce&&n(new se(wr(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Kc(t,e){return xi(t).put(function(r,i){return{targetId:0,path:Yt(r.path),sequenceNumber:i}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dx{constructor(){this.changes=new si(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,vt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?q.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j4{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return As(e).put(r)}removeEntry(e,n,r){return As(e).delete(function(s,o){const a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],gh(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.Dr(e,r)))}getEntry(e,n){let r=vt.newInvalidDocument(n);return As(e).ee({index:_d,range:IDBKeyRange.only(xl(n))},(i,s)=>{r=this.Cr(n,s)}).next(()=>r)}vr(e,n){let r={size:0,document:vt.newInvalidDocument(n)};return As(e).ee({index:_d,range:IDBKeyRange.only(xl(n))},(i,s)=>{r={document:this.Cr(n,s),size:yh(s)}}).next(()=>r)}getEntries(e,n){let r=Sn();return this.Fr(e,n,(i,s)=>{const o=this.Cr(i,s);r=r.insert(i,o)}).next(()=>r)}Mr(e,n){let r=Sn(),i=new dt(se.comparator);return this.Fr(e,n,(s,o)=>{const a=this.Cr(s,o);r=r.insert(s,a),i=i.insert(s,yh(o))}).next(()=>({documents:r,Or:i}))}Fr(e,n,r){if(n.isEmpty())return q.resolve();let i=new Ke(EI);n.forEach(l=>i=i.add(l));const s=IDBKeyRange.bound(xl(i.first()),xl(i.last())),o=i.getIterator();let a=o.getNext();return As(e).ee({index:_d,range:s},(l,u,f)=>{const p=se.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;a&&EI(a,p)<0;)r(a,null),a=o.getNext();a&&a.isEqual(p)&&(r(a,u),a=o.hasNext()?o.getNext():null),a?f.j(xl(a)):f.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,s){const o=n.path,a=[o.popLast().toArray(),o.lastSegment(),gh(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return As(e).J(IDBKeyRange.bound(a,l,!0)).next(u=>{s==null||s.incrementDocumentReadCount(u.length);let f=Sn();for(const p of u){const g=this.Cr(se.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);g.isFoundDocument()&&(ec(n,g)||i.has(g.key))&&(f=f.insert(g.key,g))}return f})}getAllFromCollectionGroup(e,n,r,i){let s=Sn();const o=TI(n,r),a=TI(n,xn.max());return As(e).ee({index:Z0,range:IDBKeyRange.bound(o,a,!0)},(l,u,f)=>{const p=this.Cr(se.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);s=s.insert(p.key,p),s.size===i&&f.done()}).next(()=>s)}newChangeBuffer(e){return new J4(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return vI(e).get(bm).next(n=>(ge(!!n,20021),n))}Dr(e,n){return vI(e).put(bm,n)}Cr(e,n){if(n){const r=b4(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(_e.min())))return r}return vt.newInvalidDocument(e)}}function hx(t){return new j4(t)}class J4 extends dx{constructor(e,n){super(),this.Nr=e,this.trackRemovals=n,this.Br=new si(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const n=[];let r=0,i=new Ke((s,o)=>Ce(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const a=this.Br.get(s);if(n.push(this.Nr.removeEntry(e,s,a.readTime)),o.isValidDocument()){const l=nI(this.Nr.serializer,o);i=i.add(s.path.popLast());const u=yh(l);r+=u-a.size,n.push(this.Nr.addEntry(e,s,l))}else if(r-=a.size,this.trackRemovals){const l=nI(this.Nr.serializer,o.convertToNoDocument(_e.min()));n.push(this.Nr.addEntry(e,s,l))}}),i.forEach(s=>{n.push(this.Nr.indexManager.addToCollectionParentIndex(e,s))}),n.push(this.Nr.updateMetadata(e,r)),q.waitFor(n)}getFromCache(e,n){return this.Nr.vr(e,n).next(r=>(this.Br.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.Nr.Mr(e,n).next(({documents:r,Or:i})=>(i.forEach((s,o)=>{this.Br.set(s,{size:o,readTime:r.get(s).readTime})}),r))}}function vI(t){return kt(t,ku)}function As(t){return kt(t,lh)}function xl(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function TI(t,e){const n=e.documentKey.path.toArray();return[t,gh(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function EI(t,e){const n=t.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=Ce(n[s],r[s]),i)return i;return i=Ce(n.length,r.length),i||(i=Ce(n[n.length-2],r[r.length-2]),i||Ce(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q4{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fx{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&iu(r.mutation,i,pn.empty(),$e.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Pe()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Pe()){const i=Sr();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=Ml();return s.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=Sr();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Pe()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=Sn();const o=ru(),a=function(){return ru()}();return n.forEach((l,u)=>{const f=r.get(u.key);i.has(u.key)&&(f===void 0||f.mutation instanceof oi)?s=s.insert(u.key,u):f!==void 0?(o.set(u.key,f.mutation.getFieldMask()),iu(f.mutation,u,f.mutation.getFieldMask(),$e.now())):o.set(u.key,pn.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((u,f)=>o.set(u,f)),n.forEach((u,f)=>a.set(u,new Q4(f,o.get(u)??null))),a))}recalculateAndSaveOverlays(e,n){const r=ru();let i=new dt((o,a)=>o-a),s=Pe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const u=n.get(l);if(u===null)return;let f=r.get(l)||pn.empty();f=a.applyToLocalView(u,f),r.set(l,f);const p=(i.get(a.batchId)||Pe()).add(l);i=i.insert(a.batchId,p)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),u=l.key,f=l.value,p=kA();f.forEach(g=>{if(!s.has(g)){const v=FA(n.get(g),r.get(g));v!==null&&p.set(g,v),s=s.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,p))}return q.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return se.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):CA(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):q.resolve(Sr());let a=Au,l=s;return o.next(u=>q.forEach(u,(f,p)=>(a<p.largestBatchId&&(a=p.largestBatchId),s.get(f)?q.resolve():this.remoteDocumentCache.getEntry(e,f).next(g=>{l=l.insert(f,g)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,l,u,Pe())).next(f=>({batchId:a,changes:PA(f)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new se(n)).next(r=>{let i=Ml();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let o=Ml();return this.indexManager.getCollectionParents(e,s).next(a=>q.forEach(a,l=>{const u=function(p,g){return new Xu(g,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(n,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,r,i).next(f=>{f.forEach((p,g)=>{o=o.insert(p,g)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((l,u)=>{const f=u.getKey();o.get(f)===null&&(o=o.insert(f,vt.newInvalidDocument(f)))});let a=Ml();return o.forEach((l,u)=>{const f=s.get(l);f!==void 0&&iu(f.mutation,u,pn.empty(),$e.now()),ec(n,u)&&(a=a.insert(l,u))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y4{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return q.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:an(i.createTime)}}(n)),q.resolve()}getNamedQuery(e,n){return q.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,function(i){return{name:i.name,query:nx(i.bundledQuery),readTime:an(i.readTime)}}(n)),q.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X4{constructor(){this.overlays=new dt(se.comparator),this.qr=new Map}getOverlay(e,n){return q.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Sr();return q.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.St(e,n,s)}),q.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.qr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.qr.delete(r)),q.resolve()}getOverlaysForCollection(e,n,r){const i=Sr(),s=n.length+1,o=new se(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,u=l.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return q.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new dt((u,f)=>u-f);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let f=s.get(u.largestBatchId);f===null&&(f=Sr(),s=s.insert(u.largestBatchId,f)),f.set(u.getKey(),u)}}const a=Sr(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((u,f)=>a.set(u,f)),!(a.size()>=i)););return q.resolve(a)}St(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new b_(n,r));let s=this.qr.get(n);s===void 0&&(s=Pe(),this.qr.set(n,s)),this.qr.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z4{constructor(){this.sessionToken=Et.EMPTY_BYTE_STRING}getSessionToken(e){return q.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,q.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U_{constructor(){this.Qr=new Ke(Dt.$r),this.Ur=new Ke(Dt.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const r=new Dt(e,n);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Gr(new Dt(e,n))}zr(e,n){e.forEach(r=>this.removeReference(r,n))}jr(e){const n=new se(new Ge([])),r=new Dt(n,e),i=new Dt(n,e+1),s=[];return this.Ur.forEachInRange([r,i],o=>{this.Gr(o),s.push(o.key)}),s}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new se(new Ge([])),r=new Dt(n,e),i=new Dt(n,e+1);let s=Pe();return this.Ur.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const n=new Dt(e,0),r=this.Qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Dt{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return se.comparator(e.key,n.key)||Ce(e.Yr,n.Yr)}static Kr(e,n){return Ce(e.Yr,n.Yr)||se.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eO{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new Ke(Dt.$r)}checkEmpty(e){return q.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new N_(s,n,r,i);this.mutationQueue.push(o);for(const a of i)this.Zr=this.Zr.add(new Dt(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return q.resolve(o)}lookupMutationBatch(e,n){return q.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.ei(r),s=i<0?0:i;return q.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return q.resolve(this.mutationQueue.length===0?Hs:this.tr-1)}getAllMutationBatches(e){return q.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Dt(n,0),i=new Dt(n,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([r,i],o=>{const a=this.Xr(o.Yr);s.push(a)}),q.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ke(Ce);return n.forEach(i=>{const s=new Dt(i,0),o=new Dt(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,o],a=>{r=r.add(a.Yr)})}),q.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;se.isDocumentKey(s)||(s=s.child(""));const o=new Dt(new se(s),0);let a=new Ke(Ce);return this.Zr.forEachWhile(l=>{const u=l.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(a=a.add(l.Yr)),!0)},o),q.resolve(this.ti(a))}ti(e){const n=[];return e.forEach(r=>{const i=this.Xr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){ge(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return q.forEach(n.mutations,i=>{const s=new Dt(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,n){const r=new Dt(n,0),i=this.Zr.firstAfterOrEqual(r);return q.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,q.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tO{constructor(e){this.ri=e,this.docs=function(){return new dt(se.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.ri(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return q.resolve(r?r.document.mutableCopy():vt.newInvalidDocument(n))}getEntries(e,n){let r=Sn();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():vt.newInvalidDocument(i))}),q.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=Sn();const o=n.path,a=new se(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:u,value:{document:f}}=l.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||T_(j0(f),r)<=0||(i.has(f.key)||ec(n,f))&&(s=s.insert(f.key,f.mutableCopy()))}return q.resolve(s)}getAllFromCollectionGroup(e,n,r,i){ce(9500)}ii(e,n){return q.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new nO(this)}getSize(e){return q.resolve(this.size)}}class nO extends dx{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)}),q.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rO{constructor(e){this.persistence=e,this.si=new si(n=>io(n),Yu),this.lastRemoteSnapshotVersion=_e.min(),this.highestTargetId=0,this.oi=0,this._i=new U_,this.targetCount=0,this.ai=ao.ur()}forEachTarget(e,n){return this.si.forEach((r,i)=>n(i)),q.resolve()}getLastRemoteSnapshotVersion(e){return q.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return q.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),q.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.oi&&(this.oi=n),q.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new ao(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,q.resolve()}updateTargetData(e,n){return this.Pr(n),q.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,q.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.si.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.si.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),q.waitFor(s).next(()=>i)}getTargetCount(e){return q.resolve(this.targetCount)}getTargetData(e,n){const r=this.si.get(n)||null;return q.resolve(r)}addMatchingKeys(e,n,r){return this._i.Wr(n,r),q.resolve()}removeMatchingKeys(e,n,r){this._i.zr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),q.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),q.resolve()}getMatchingKeysForTargetId(e,n){const r=this._i.Hr(n);return q.resolve(r)}containsKey(e,n){return q.resolve(this._i.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O_{constructor(e,n){this.ui={},this.overlays={},this.ci=new Fn(0),this.li=!1,this.li=!0,this.hi=new Z4,this.referenceDelegate=e(this),this.Pi=new rO(this),this.indexManager=new q4,this.remoteDocumentCache=function(i){return new tO(i)}(r=>this.referenceDelegate.Ti(r)),this.serializer=new ex(n),this.Ii=new Y4(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new X4,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ui[e.toKey()];return r||(r=new eO(n,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,r){ee("MemoryPersistence","Starting transaction:",e);const i=new iO(this.ci.next());return this.referenceDelegate.Ei(),r(i).next(s=>this.referenceDelegate.di(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ai(e,n){return q.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,n)))}}class iO extends Q0{constructor(e){super(),this.currentSequenceNumber=e}}class df{constructor(e){this.persistence=e,this.Ri=new U_,this.Vi=null}static mi(e){return new df(e)}get fi(){if(this.Vi)return this.Vi;throw ce(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.fi.delete(r.toString()),q.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.fi.add(r.toString()),q.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),q.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach(i=>this.fi.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.fi.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return q.forEach(this.fi,r=>{const i=se.fromPath(r);return this.gi(e,i).next(s=>{s||n.removeEntry(i,_e.min())})}).next(()=>(this.Vi=null,n.apply(e)))}updateLimboDocument(e,n){return this.gi(e,n).next(r=>{r?this.fi.delete(n.toString()):this.fi.add(n.toString())})}Ti(e){return 0}gi(e,n){return q.or([()=>q.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class vh{constructor(e,n){this.persistence=e,this.pi=new si(r=>Yt(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=cx(this,n)}static mi(e,n){return new vh(e,n)}Ei(){}di(e){return q.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}pr(e,n){return q.forEach(this.pi,(r,i)=>this.br(e,r,i).next(s=>s?q.resolve():n(i)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ii(e,o=>this.br(e,o,n).next(a=>{a||(r++,s.removeEntry(o,_e.min()))})).next(()=>s.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),q.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),q.resolve()}removeReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),q.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),q.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=vd(e.data.value)),n}br(e,n,r){return q.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const i=this.pi.get(n);return q.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sO{constructor(e){this.serializer=e}k(e,n,r,i){const s=new Qh("createOrUpgrade",n);r<1&&i>=1&&(function(l){l.createObjectStore(Qu)}(e),function(l){l.createObjectStore(Pu,{keyPath:gU}),l.createObjectStore(Xn,{keyPath:DE,autoIncrement:!0}).createIndex(qs,bE,{unique:!0}),l.createObjectStore(Ra)}(e),II(e),function(l){l.createObjectStore(Ds)}(e));let o=q.resolve();return r<3&&i>=3&&(r!==0&&(function(l){l.deleteObjectStore(ka),l.deleteObjectStore(Pa),l.deleteObjectStore(Ws)}(e),II(e)),o=o.next(()=>function(l){const u=l.store(Ws),f={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:_e.min().toTimestamp(),targetCount:0};return u.put(uh,f)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(l,u){return u.store(Xn).J().next(p=>{l.deleteObjectStore(Xn),l.createObjectStore(Xn,{keyPath:DE,autoIncrement:!0}).createIndex(qs,bE,{unique:!0});const g=u.store(Xn),v=p.map(E=>g.put(E));return q.waitFor(v)})}(e,s))),o=o.next(()=>{(function(l){l.createObjectStore(Na,{keyPath:CU})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.yi(s))),r<6&&i>=6&&(o=o.next(()=>(function(l){l.createObjectStore(ku)}(e),this.wi(s)))),r<7&&i>=7&&(o=o.next(()=>this.Si(s))),r<8&&i>=8&&(o=o.next(()=>this.bi(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.Di(s))),r<11&&i>=11&&(o=o.next(()=>{(function(l){l.createObjectStore(Xh,{keyPath:AU})})(e),function(l){l.createObjectStore(Zh,{keyPath:xU})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(l){const u=l.createObjectStore(ef,{keyPath:MU});u.createIndex(Vm,VU,{unique:!1}),u.createIndex(rA,LU,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(l){const u=l.createObjectStore(lh,{keyPath:yU});u.createIndex(_d,vU),u.createIndex(Z0,TU)}(e)).next(()=>this.Ci(e,s)).next(()=>e.deleteObjectStore(Ds))),r<14&&i>=14&&(o=o.next(()=>this.Fi(e,s))),r<15&&i>=15&&(o=o.next(()=>function(l){l.createObjectStore(w_,{keyPath:RU,autoIncrement:!0}).createIndex(Mm,PU,{unique:!1}),l.createObjectStore(Zl,{keyPath:kU}).createIndex(tA,NU,{unique:!1}),l.createObjectStore(eu,{keyPath:DU}).createIndex(nA,bU,{unique:!1})}(e))),r<16&&i>=16&&(o=o.next(()=>{n.objectStore(Zl).clear()}).next(()=>{n.objectStore(eu).clear()})),r<17&&i>=17&&(o=o.next(()=>{(function(l){l.createObjectStore(S_,{keyPath:FU})})(e)})),r<18&&i>=18&&JC()&&(o=o.next(()=>{n.objectStore(Zl).clear()}).next(()=>{n.objectStore(eu).clear()})),o}wi(e){let n=0;return e.store(Ds).ee((r,i)=>{n+=yh(i)}).next(()=>{const r={byteSize:n};return e.store(ku).put(bm,r)})}yi(e){const n=e.store(Pu),r=e.store(Xn);return n.J().next(i=>q.forEach(i,s=>{const o=IDBKeyRange.bound([s.userId,Hs],[s.userId,s.lastAcknowledgedBatchId]);return r.J(qs,o).next(a=>q.forEach(a,l=>{ge(l.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:l.batchId});const u=Ms(this.serializer,l);return ox(e,s.userId,u).next(()=>{})}))}))}Si(e){const n=e.store(ka),r=e.store(Ds);return e.store(Ws).get(uh).next(i=>{const s=[];return r.ee((o,a)=>{const l=new Ge(o),u=function(p){return[0,Yt(p)]}(l);s.push(n.get(u).next(f=>f?q.resolve():(p=>n.put({targetId:0,path:Yt(p),sequenceNumber:i.highestListenSequenceNumber}))(l)))}).next(()=>q.waitFor(s))})}bi(e,n){e.createObjectStore(Nu,{keyPath:SU});const r=n.store(Nu),i=new F_,s=o=>{if(i.add(o)){const a=o.lastSegment(),l=o.popLast();return r.put({collectionId:a,parent:Yt(l)})}};return n.store(Ds).ee({X:!0},(o,a)=>{const l=new Ge(o);return s(l.popLast())}).next(()=>n.store(Ra).ee({X:!0},([o,a,l],u)=>{const f=wr(a);return s(f.popLast())}))}Di(e){const n=e.store(Pa);return n.ee((r,i)=>{const s=Ll(i),o=tx(this.serializer,s);return n.put(o)})}Ci(e,n){const r=n.store(Ds),i=[];return r.ee((s,o)=>{const a=n.store(lh),l=function(p){return p.document?new se(Ge.fromString(p.document.name).popFirst(5)):p.noDocument?se.fromSegments(p.noDocument.path):p.unknownDocument?se.fromSegments(p.unknownDocument.path):ce(36783)}(o).path.toArray(),u={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(u))}).next(()=>q.waitFor(i))}Fi(e,n){const r=n.store(Xn),i=hx(this.serializer),s=new O_(df.mi,this.serializer.yt);return r.J().next(o=>{const a=new Map;return o.forEach(l=>{let u=a.get(l.userId)??Pe();Ms(this.serializer,l).keys().forEach(f=>u=u.add(f)),a.set(l.userId,u)}),q.forEach(a,(l,u)=>{const f=new Ut(u),p=uf.wt(this.serializer,f),g=s.getIndexManager(f),v=cf.wt(f,this.serializer,g,s.referenceDelegate);return new fx(i,v,p,g).recalculateAndSaveOverlaysForDocumentKeys(new Lm(n,Fn.ce),l).next()})})}}function II(t){t.createObjectStore(ka,{keyPath:IU}).createIndex(I_,wU,{unique:!0}),t.createObjectStore(Pa,{keyPath:"targetId"}).createIndex(eA,EU,{unique:!0}),t.createObjectStore(Ws)}const _i="IndexedDbPersistence",mp=18e5,gp=5e3,_p="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",oO="main";class B_{constructor(e,n,r,i,s,o,a,l,u,f,p=18){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Mi=s,this.window=o,this.document=a,this.xi=u,this.Oi=f,this.Ni=p,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=g=>Promise.resolve(),!B_.v())throw new re(j.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new K4(this,i),this.$i=n+oO,this.serializer=new ex(l),this.Ui=new zi(this.$i,this.Ni,new sO(this.serializer)),this.hi=new V4,this.Pi=new z4(this.referenceDelegate,this.serializer),this.remoteDocumentCache=hx(this.serializer),this.Ii=new M4,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,f===!1&&nn(_i,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new re(j.FAILED_PRECONDITION,_p);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Pi.getHighestSequenceNumber(e))}).then(e=>{this.ci=new Fn(e,this.xi)}).then(()=>{this.li=!0}).catch(e=>(this.Ui&&this.Ui.close(),Promise.reject(e)))}Ji(e){return this.Qi=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget(async()=>{this.started&&await this.Wi()}))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>jc(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Hi(e).next(n=>{n||(this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)))})}).next(()=>this.Yi(e)).next(n=>this.isPrimary&&!n?this.Zi(e).next(()=>!1):!!n&&this.Xi(e).next(()=>!0))).catch(e=>{if(ss(e))return ee(_i,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return ee(_i,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable(()=>this.Qi(e)),this.isPrimary=e})}Hi(e){return Rl(e).get(Mo).next(n=>q.resolve(this.es(n)))}ts(e){return jc(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,mp)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=kt(n,Na);return r.J().next(i=>{const s=this.ss(i,mp),o=i.filter(a=>s.indexOf(a)===-1);return q.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Ki)for(const n of e)this.Ki.removeItem(this._s(n.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Wi().then(()=>this.ns()).then(()=>this.ji()))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?q.resolve(!0):Rl(e).get(Mo).next(n=>{if(n!==null&&this.rs(n.leaseTimestampMs,gp)&&!this.us(n.ownerId)){if(this.es(n)&&this.networkEnabled)return!0;if(!this.es(n)){if(!n.allowTabSynchronization)throw new re(j.FAILED_PRECONDITION,_p);return!1}}return!(!this.networkEnabled||!this.inForeground)||jc(e).J().next(r=>this.ss(r,gp).find(i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&ee(_i,`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[Qu,Na],e=>{const n=new Lm(e,Fn.ce);return this.Zi(n).next(()=>this.ts(n))}),this.Ui.close(),this.Ps()}ss(e,n){return e.filter(r=>this.rs(r.updateTimeMs,n)&&!this.us(r.clientId))}Ts(){return this.runTransaction("getActiveClients","readonly",e=>jc(e).J().next(n=>this.ss(n,mp).map(r=>r.clientId)))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,n){return cf.wt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new G4(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return uf.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,n,r){ee(_i,"Starting transaction:",e);const i=n==="readonly"?"readonly":"readwrite",s=function(l){return l===18?BU:l===17?aA:l===16?OU:l===15?C_:l===14?oA:l===13?sA:l===12?UU:l===11?iA:void ce(60245)}(this.Ni);let o;return this.Ui.runTransaction(e,i,s,a=>(o=new Lm(a,this.ci?this.ci.next():Fn.ce),n==="readwrite-primary"?this.Hi(o).next(l=>!!l||this.Yi(o)).next(l=>{if(!l)throw nn(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)),new re(j.FAILED_PRECONDITION,J0);return r(o)}).next(l=>this.Xi(o).next(()=>l)):this.Is(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Is(e){return Rl(e).get(Mo).next(n=>{if(n!==null&&this.rs(n.leaseTimestampMs,gp)&&!this.us(n.ownerId)&&!this.es(n)&&!(this.Oi||this.allowTabSynchronization&&n.allowTabSynchronization))throw new re(j.FAILED_PRECONDITION,_p)})}Xi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Rl(e).put(Mo,n)}static v(){return zi.v()}Zi(e){const n=Rl(e);return n.get(Mo).next(r=>this.es(r)?(ee(_i,"Releasing primary lease."),n.delete(Mo)):q.resolve())}rs(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(nn(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi()))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){var e;typeof((e=this.window)==null?void 0:e.addEventListener)=="function"&&(this.Bi=()=>{this.cs();const n=/(?:Version|Mobile)\/1[456]/;jC()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){var n;try{const r=((n=this.Ki)==null?void 0:n.getItem(this._s(e)))!==null;return ee(_i,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return nn(_i,"Failed to get zombied client id.",r),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){nn("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Rl(t){return kt(t,Qu)}function jc(t){return kt(t,Na)}function aO(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q_{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.Es=r,this.ds=i}static As(e,n){let r=Pe(),i=Pe();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new q_(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lO{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class px{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return jC()?8:Y0(Rt())>0?6:4}()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.ys(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ws(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new lO;return this.Ss(e,n,o).next(a=>{if(s.result=a,this.Vs)return this.bs(e,n,o,a.size)})}).next(()=>s.result)}bs(e,n,r,i){return r.documentReadCount<this.fs?(Bo()<=be.DEBUG&&ee("QueryEngine","SDK will not create cache indexes for query:",qo(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),q.resolve()):(Bo()<=be.DEBUG&&ee("QueryEngine","Query:",qo(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?(Bo()<=be.DEBUG&&ee("QueryEngine","The SDK decides to create cache indexes for query:",qo(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Bn(n))):q.resolve())}ys(e,n){if(WE(n))return q.resolve(null);let r=Bn(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=zm(n,null,"F"),r=Bn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=Pe(...s);return this.ps.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const u=this.Ds(n,a);return this.Cs(n,u,o,l.readTime)?this.ys(e,zm(n,null,"F")):this.vs(e,u,n,l)}))})))}ws(e,n,r,i){return WE(n)||i.isEqual(_e.min())?q.resolve(null):this.ps.getDocuments(e,r).next(s=>{const o=this.Ds(n,s);return this.Cs(n,o,r,i)?q.resolve(null):(Bo()<=be.DEBUG&&ee("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),qo(n)),this.vs(e,o,n,uU(i,Au)).next(a=>a))})}Ds(e,n){let r=new Ke(xA(e));return n.forEach((i,s)=>{ec(e,s)&&(r=r.add(s))}),r}Cs(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ss(e,n,r){return Bo()<=be.DEBUG&&ee("QueryEngine","Using full collection scan to execute query:",qo(n)),this.ps.getDocumentsMatchingQuery(e,n,xn.min(),r)}vs(e,n,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G_="LocalStore",uO=3e8;class cO{constructor(e,n,r,i){this.persistence=e,this.Fs=n,this.serializer=i,this.Ms=new dt(Ce),this.xs=new si(s=>io(s),Yu),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new fx(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ms))}}function mx(t,e,n,r){return new cO(t,e,n,r)}async function gx(t,e){const n=Ae(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.Bs(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],a=[];let l=Pe();for(const u of i){o.push(u.batchId);for(const f of u.mutations)l=l.add(f.key)}for(const u of s){a.push(u.batchId);for(const f of u.mutations)l=l.add(f.key)}return n.localDocuments.getDocuments(r,l).next(u=>({Ls:u,removedBatchIds:o,addedBatchIds:a}))})})}function dO(t,e){const n=Ae(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.Ns.newChangeBuffer({trackRemovals:!0});return function(a,l,u,f){const p=u.batch,g=p.keys();let v=q.resolve();return g.forEach(E=>{v=v.next(()=>f.getEntry(l,E)).next(x=>{const b=u.docVersions.get(E);ge(b!==null,48541),x.version.compareTo(b)<0&&(p.applyToRemoteDocument(x,u),x.isValidDocument()&&(x.setReadTime(u.commitVersion),f.addEntry(x)))})}),v.next(()=>a.mutationQueue.removeMutationBatch(l,p))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=Pe();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(l=l.add(a.batch.mutations[u].key));return l}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function _x(t){const e=Ae(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Pi.getLastRemoteSnapshotVersion(n))}function hO(t,e){const n=Ae(t),r=e.snapshotVersion;let i=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.Ns.newChangeBuffer({trackRemovals:!0});i=n.Ms;const a=[];e.targetChanges.forEach((f,p)=>{const g=i.get(p);if(!g)return;a.push(n.Pi.removeMatchingKeys(s,f.removedDocuments,p).next(()=>n.Pi.addMatchingKeys(s,f.addedDocuments,p)));let v=g.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(p)!==null?v=v.withResumeToken(Et.EMPTY_BYTE_STRING,_e.min()).withLastLimboFreeSnapshotVersion(_e.min()):f.resumeToken.approximateByteSize()>0&&(v=v.withResumeToken(f.resumeToken,r)),i=i.insert(p,v),function(x,b,C){return x.resumeToken.approximateByteSize()===0||b.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=uO?!0:C.addedDocuments.size+C.modifiedDocuments.size+C.removedDocuments.size>0}(g,v,f)&&a.push(n.Pi.updateTargetData(s,v))});let l=Sn(),u=Pe();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,f))}),a.push(fO(s,o,e.documentUpdates).next(f=>{l=f.ks,u=f.qs})),!r.isEqual(_e.min())){const f=n.Pi.getLastRemoteSnapshotVersion(s).next(p=>n.Pi.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(f)}return q.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,l,u)).next(()=>l)}).then(s=>(n.Ms=i,s))}function fO(t,e,n){let r=Pe(),i=Pe();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=Sn();return n.forEach((a,l)=>{const u=s.get(a);l.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(a)),l.isNoDocument()&&l.version.isEqual(_e.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):ee(G_,"Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",l.version)}),{ks:o,qs:i}})}function pO(t,e){const n=Ae(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=Hs),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function mO(t,e){const n=Ae(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Pi.getTargetData(r,e).next(s=>s?(i=s,q.resolve(i)):n.Pi.allocateTargetId(r).next(o=>(i=new Hr(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Pi.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.Ms.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(r.targetId,r),n.xs.set(e,r.targetId)),r})}async function Ym(t,e,n){const r=Ae(t),i=r.Ms.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!ss(o))throw o;ee(G_,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(i.target)}function wI(t,e,n){const r=Ae(t);let i=_e.min(),s=Pe();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,u,f){const p=Ae(l),g=p.xs.get(f);return g!==void 0?q.resolve(p.Ms.get(g)):p.Pi.getTargetData(u,f)}(r,o,Bn(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,a.targetId).next(l=>{s=l})}).next(()=>r.Fs.getDocumentsMatchingQuery(o,e,n?i:_e.min(),n?s:Pe())).next(a=>(gO(r,t4(e),a),{documents:a,Qs:s})))}function gO(t,e,n){let r=t.Os.get(e)||_e.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.Os.set(e,r)}class SI{constructor(){this.activeTargetIds=a4()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class yx{constructor(){this.Mo=new SI,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,r){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new SI,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _O{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CI="ConnectivityMonitor";class AI{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){ee(CI,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){ee(CI,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Jc=null;function Xm(){return Jc===null?Jc=function(){return 268435456+Math.round(2147483648*Math.random())}():Jc++,"0x"+Jc.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yp="RestConnection",yO={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class vO{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===ch?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,n,r,i,s){const o=Xm(),a=this.zo(e,n.toUriEncodedString());ee(yp,`Sending RPC '${e}' ${o}:`,a,r);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,i,s);const{host:u}=new URL(a),f=Ka(u);return this.Jo(e,a,l,r,f).then(p=>(ee(yp,`Received RPC '${e}' ${o}: `,p),p),p=>{throw Ji(yp,`RPC '${e}' ${o} failed with error: `,p,"url: ",a,"request:",r),p})}Ho(e,n,r,i,s,o){return this.Go(e,n,r,i,s)}jo(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Qa}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((i,s)=>e[s]=i),r&&r.headers.forEach((i,s)=>e[s]=i)}zo(e,n){const r=yO[e];return`${this.Uo}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TO{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wt="WebChannelConnection";class EO extends vO{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,i,s){const o=Xm();return new Promise((a,l)=>{const u=new V0;u.setWithCredentials(!0),u.listenOnce(L0.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case pd.NO_ERROR:const p=u.getResponseJson();ee(Wt,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(p)),a(p);break;case pd.TIMEOUT:ee(Wt,`RPC '${e}' ${o} timed out`),l(new re(j.DEADLINE_EXCEEDED,"Request time out"));break;case pd.HTTP_ERROR:const g=u.getStatus();if(ee(Wt,`RPC '${e}' ${o} failed with status:`,g,"response text:",u.getResponseText()),g>0){let v=u.getResponseJson();Array.isArray(v)&&(v=v[0]);const E=v==null?void 0:v.error;if(E&&E.status&&E.message){const x=function(C){const I=C.toLowerCase().replace(/_/g,"-");return Object.values(j).indexOf(I)>=0?I:j.UNKNOWN}(E.status);l(new re(x,E.message))}else l(new re(j.UNKNOWN,"Server responded with status "+u.getStatus()))}else l(new re(j.UNAVAILABLE,"Connection failed."));break;default:ce(9055,{l_:e,streamId:o,h_:u.getLastErrorCode(),P_:u.getLastError()})}}finally{ee(Wt,`RPC '${e}' ${o} completed.`)}});const f=JSON.stringify(i);ee(Wt,`RPC '${e}' ${o} sending request:`,i),u.send(n,"POST",f,r,15)})}T_(e,n,r){const i=Xm(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=O0(),a=U0(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(l.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,n,r),l.encodeInitMessageHeaders=!0;const f=s.join("");ee(Wt,`Creating RPC '${e}' stream ${i}: ${f}`,l);const p=o.createWebChannel(f,l);this.I_(p);let g=!1,v=!1;const E=new TO({Yo:b=>{v?ee(Wt,`Not sending because RPC '${e}' stream ${i} is closed:`,b):(g||(ee(Wt,`Opening RPC '${e}' stream ${i} transport.`),p.open(),g=!0),ee(Wt,`RPC '${e}' stream ${i} sending:`,b),p.send(b))},Zo:()=>p.close()}),x=(b,C,I)=>{b.listen(C,S=>{try{I(S)}catch(V){setTimeout(()=>{throw V},0)}})};return x(p,bl.EventType.OPEN,()=>{v||(ee(Wt,`RPC '${e}' stream ${i} transport opened.`),E.o_())}),x(p,bl.EventType.CLOSE,()=>{v||(v=!0,ee(Wt,`RPC '${e}' stream ${i} transport closed`),E.a_(),this.E_(p))}),x(p,bl.EventType.ERROR,b=>{v||(v=!0,Ji(Wt,`RPC '${e}' stream ${i} transport errored. Name:`,b.name,"Message:",b.message),E.a_(new re(j.UNAVAILABLE,"The operation could not be completed")))}),x(p,bl.EventType.MESSAGE,b=>{var C;if(!v){const I=b.data[0];ge(!!I,16349);const S=I,V=(S==null?void 0:S.error)||((C=S[0])==null?void 0:C.error);if(V){ee(Wt,`RPC '${e}' stream ${i} received error:`,V);const U=V.status;let B=function(A){const k=It[A];if(k!==void 0)return BA(k)}(U),T=V.message;B===void 0&&(B=j.INTERNAL,T="Unknown error status: "+U+" with message "+V.message),v=!0,E.a_(new re(B,T)),p.close()}else ee(Wt,`RPC '${e}' stream ${i} received:`,I),E.u_(I)}}),x(a,F0.STAT_EVENT,b=>{b.stat===km.PROXY?ee(Wt,`RPC '${e}' stream ${i} detected buffering proxy`):b.stat===km.NOPROXY&&ee(Wt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{E.__()},0),E}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(n=>n===e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IO(){return typeof window<"u"?window:null}function Sd(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hf(t){return new w4(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vx{constructor(e,n,r=1e3,i=1.5,s=6e4){this.Mi=e,this.timerId=n,this.d_=r,this.A_=i,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,n-r);i>0&&ee("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xI="PersistentStream";class Tx{constructor(e,n,r,i,s,o,a,l){this.Mi=e,this.S_=r,this.b_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new vx(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===j.RESOURCE_EXHAUSTED?(nn(n.toString()),nn("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===j.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.D_===n&&this.G_(r,i)},r=>{e(()=>{const i=new re(j.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)})})}G_(e,n){const r=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(i=>{r(()=>this.z_(i))}),this.stream.onMessage(i=>{r(()=>++this.F_==1?this.J_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return ee(xI,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget(()=>this.D_===e?n():(ee(xI,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class wO extends Tx{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=A4(this.serializer,e),r=function(s){if(!("targetChange"in s))return _e.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?_e.min():o.readTime?an(o.readTime):_e.min()}(e);return this.listener.H_(n,r)}Y_(e){const n={};n.database=Wm(this.serializer),n.addTarget=function(s,o){let a;const l=o.target;if(a=hh(l)?{documents:jA(s,l)}:{query:JA(s,l).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=zA(s,o.resumeToken);const u=$m(s,o.expectedCount);u!==null&&(a.expectedCount=u)}else if(o.snapshotVersion.compareTo(_e.min())>0){a.readTime=Oa(s,o.snapshotVersion.toTimestamp());const u=$m(s,o.expectedCount);u!==null&&(a.expectedCount=u)}return a}(this.serializer,e);const r=R4(this.serializer,e);r&&(n.labels=r),this.q_(n)}Z_(e){const n={};n.database=Wm(this.serializer),n.removeTarget=e,this.q_(n)}}class SO extends Tx{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return ge(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,ge(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){ge(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=x4(e.writeResults,e.commitTime),r=an(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=Wm(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>mh(this.serializer,r))};this.q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CO{}class AO extends CO{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new re(j.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Go(e,Hm(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===j.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new re(j.UNKNOWN,s.toString())})}Ho(e,n,r,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Ho(e,Hm(n,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===j.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new re(j.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class xO{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(nn(n),this.aa=!1):ee("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lo="RemoteStore";class RO{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo(o=>{r.enqueueAndForget(async()=>{po(this)&&(ee(lo,"Restarting streams for network reachability change."),await async function(l){const u=Ae(l);u.Ea.add(4),await nc(u),u.Ra.set("Unknown"),u.Ea.delete(4),await ff(u)}(this))})}),this.Ra=new xO(r,i)}}async function ff(t){if(po(t))for(const e of t.da)await e(!0)}async function nc(t){for(const e of t.da)await e(!1)}function Ex(t,e){const n=Ae(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),W_(n)?H_(n):Xa(n).O_()&&$_(n,e))}function z_(t,e){const n=Ae(t),r=Xa(n);n.Ia.delete(e),r.O_()&&Ix(n,e),n.Ia.size===0&&(r.O_()?r.L_():po(n)&&n.Ra.set("Unknown"))}function $_(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(_e.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Xa(t).Y_(e)}function Ix(t,e){t.Va.Ue(e),Xa(t).Z_(e)}function H_(t){t.Va=new v4({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),Xa(t).start(),t.Ra.ua()}function W_(t){return po(t)&&!Xa(t).x_()&&t.Ia.size>0}function po(t){return Ae(t).Ea.size===0}function wx(t){t.Va=void 0}async function PO(t){t.Ra.set("Online")}async function kO(t){t.Ia.forEach((e,n)=>{$_(t,e)})}async function NO(t,e){wx(t),W_(t)?(t.Ra.ha(e),H_(t)):t.Ra.set("Unknown")}async function DO(t,e,n){if(t.Ra.set("Online"),e instanceof GA&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const a of s.targetIds)i.Ia.has(a)&&(await i.remoteSyncer.rejectListen(a,o),i.Ia.delete(a),i.Va.removeTarget(a))}(t,e)}catch(r){ee(lo,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Th(t,r)}else if(e instanceof Id?t.Va.Ze(e):e instanceof qA?t.Va.st(e):t.Va.tt(e),!n.isEqual(_e.min()))try{const r=await _x(t.localStore);n.compareTo(r)>=0&&await function(s,o){const a=s.Va.Tt(o);return a.targetChanges.forEach((l,u)=>{if(l.resumeToken.approximateByteSize()>0){const f=s.Ia.get(u);f&&s.Ia.set(u,f.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,u)=>{const f=s.Ia.get(l);if(!f)return;s.Ia.set(l,f.withResumeToken(Et.EMPTY_BYTE_STRING,f.snapshotVersion)),Ix(s,l);const p=new Hr(f.target,l,u,f.sequenceNumber);$_(s,p)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){ee(lo,"Failed to raise snapshot:",r),await Th(t,r)}}async function Th(t,e,n){if(!ss(e))throw e;t.Ea.add(1),await nc(t),t.Ra.set("Offline"),n||(n=()=>_x(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{ee(lo,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await ff(t)})}function Sx(t,e){return e().catch(n=>Th(t,n,e))}async function rc(t){const e=Ae(t),n=Zi(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Hs;for(;bO(e);)try{const i=await pO(e.localStore,r);if(i===null){e.Ta.length===0&&n.L_();break}r=i.batchId,MO(e,i)}catch(i){await Th(e,i)}Cx(e)&&Ax(e)}function bO(t){return po(t)&&t.Ta.length<10}function MO(t,e){t.Ta.push(e);const n=Zi(t);n.O_()&&n.X_&&n.ea(e.mutations)}function Cx(t){return po(t)&&!Zi(t).x_()&&t.Ta.length>0}function Ax(t){Zi(t).start()}async function VO(t){Zi(t).ra()}async function LO(t){const e=Zi(t);for(const n of t.Ta)e.ea(n.mutations)}async function FO(t,e,n){const r=t.Ta.shift(),i=D_.from(r,e,n);await Sx(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await rc(t)}async function UO(t,e){e&&Zi(t).X_&&await async function(r,i){if(function(o){return g4(o)&&o!==j.ABORTED}(i.code)){const s=r.Ta.shift();Zi(r).B_(),await Sx(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await rc(r)}}(t,e),Cx(t)&&Ax(t)}async function RI(t,e){const n=Ae(t);n.asyncQueue.verifyOperationInProgress(),ee(lo,"RemoteStore received new credentials");const r=po(n);n.Ea.add(3),await nc(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await ff(n)}async function OO(t,e){const n=Ae(t);e?(n.Ea.delete(2),await ff(n)):e||(n.Ea.add(2),await nc(n),n.Ra.set("Unknown"))}function Xa(t){return t.ma||(t.ma=function(n,r,i){const s=Ae(n);return s.sa(),new wO(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Xo:PO.bind(null,t),t_:kO.bind(null,t),r_:NO.bind(null,t),H_:DO.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),W_(t)?H_(t):t.Ra.set("Unknown")):(await t.ma.stop(),wx(t))})),t.ma}function Zi(t){return t.fa||(t.fa=function(n,r,i){const s=Ae(n);return s.sa(),new SO(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:VO.bind(null,t),r_:UO.bind(null,t),ta:LO.bind(null,t),na:FO.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await rc(t)):(await t.fa.stop(),t.Ta.length>0&&(ee(lo,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K_{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Rr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const o=Date.now()+r,a=new K_(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new re(j.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function j_(t,e){if(nn("AsyncQueue",`${e}: ${t}`),ss(t))return new re(j.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _a{static emptySet(e){return new _a(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||se.comparator(n.key,r.key):(n,r)=>se.comparator(n.key,r.key),this.keyedMap=Ml(),this.sortedSet=new dt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof _a)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new _a;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PI{constructor(){this.ga=new dt(se.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):ce(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,r)=>{e.push(r)}),e}}class Ba{constructor(e,n,r,i,s,o,a,l,u){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,n,r,i,s){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new Ba(e,n,_a.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&rf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BO{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class qO{constructor(){this.queries=kI(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const i=Ae(n),s=i.queries;i.queries=kI(),s.forEach((o,a)=>{for(const l of a.Sa)l.onError(r)})})(this,new re(j.ABORTED,"Firestore shutting down"))}}function kI(){return new si(t=>AA(t),rf)}async function J_(t,e){const n=Ae(t);let r=3;const i=e.query;let s=n.queries.get(i);s?!s.ba()&&e.Da()&&(r=2):(s=new BO,r=e.Da()?0:1);try{switch(r){case 0:s.wa=await n.onListen(i,!0);break;case 1:s.wa=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(o){const a=j_(o,`Initialization of query '${qo(e.query)}' failed`);return void e.onError(a)}n.queries.set(i,s),s.Sa.push(e),e.va(n.onlineState),s.wa&&e.Fa(s.wa)&&Y_(n)}async function Q_(t,e){const n=Ae(t),r=e.query;let i=3;const s=n.queries.get(r);if(s){const o=s.Sa.indexOf(e);o>=0&&(s.Sa.splice(o,1),s.Sa.length===0?i=e.Da()?0:1:!s.ba()&&e.Da()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function GO(t,e){const n=Ae(t);let r=!1;for(const i of e){const s=i.query,o=n.queries.get(s);if(o){for(const a of o.Sa)a.Fa(i)&&(r=!0);o.wa=i}}r&&Y_(n)}function zO(t,e,n){const r=Ae(t),i=r.queries.get(e);if(i)for(const s of i.Sa)s.onError(n);r.queries.delete(e)}function Y_(t){t.Ca.forEach(e=>{e.next()})}var Zm,NI;(NI=Zm||(Zm={})).Ma="default",NI.Cache="cache";class X_{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new Ba(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=Ba.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Zm.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xx{constructor(e){this.key=e}}class Rx{constructor(e){this.key=e}}class $O{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Pe(),this.mutatedKeys=Pe(),this.eu=xA(e),this.tu=new _a(this.eu)}get nu(){return this.Ya}ru(e,n){const r=n?n.iu:new PI,i=n?n.tu:this.tu;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((f,p)=>{const g=i.get(f),v=ec(this.query,p)?p:null,E=!!g&&this.mutatedKeys.has(g.key),x=!!v&&(v.hasLocalMutations||this.mutatedKeys.has(v.key)&&v.hasCommittedMutations);let b=!1;g&&v?g.data.isEqual(v.data)?E!==x&&(r.track({type:3,doc:v}),b=!0):this.su(g,v)||(r.track({type:2,doc:v}),b=!0,(l&&this.eu(v,l)>0||u&&this.eu(v,u)<0)&&(a=!0)):!g&&v?(r.track({type:0,doc:v}),b=!0):g&&!v&&(r.track({type:1,doc:g}),b=!0,(l||u)&&(a=!0)),b&&(v?(o=o.add(v),s=x?s.add(f):s.delete(f)):(o=o.delete(f),s=s.delete(f)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const f=this.query.limitType==="F"?o.last():o.first();o=o.delete(f.key),s=s.delete(f.key),r.track({type:1,doc:f})}return{tu:o,iu:r,Cs:a,mutatedKeys:s}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((f,p)=>function(v,E){const x=b=>{switch(b){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ce(20277,{Rt:b})}};return x(v)-x(E)}(f.type,p.type)||this.eu(f.doc,p.doc)),this.ou(r),i=i??!1;const a=n&&!i?this._u():[],l=this.Xa.size===0&&this.current&&!i?1:0,u=l!==this.Za;return this.Za=l,o.length!==0||u?{snapshot:new Ba(this.query,e.tu,s,o,e.mutatedKeys,l===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new PI,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Ya=this.Ya.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ya=this.Ya.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Pe(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))});const n=[];return e.forEach(r=>{this.Xa.has(r)||n.push(new Rx(r))}),this.Xa.forEach(r=>{e.has(r)||n.push(new xx(r))}),n}cu(e){this.Ya=e.Qs,this.Xa=Pe();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return Ba.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Z_="SyncEngine";class HO{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class WO{constructor(e){this.key=e,this.hu=!1}}class KO{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new si(a=>AA(a),rf),this.Iu=new Map,this.Eu=new Set,this.du=new dt(se.comparator),this.Au=new Map,this.Ru=new U_,this.Vu={},this.mu=new Map,this.fu=ao.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function jO(t,e,n=!0){const r=Mx(t);let i;const s=r.Tu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await Px(r,e,n,!0),i}async function JO(t,e){const n=Mx(t);await Px(n,e,!0,!1)}async function Px(t,e,n,r){const i=await mO(t.localStore,Bn(e)),s=i.targetId,o=t.sharedClientState.addLocalQueryTarget(s,n);let a;return r&&(a=await QO(t,e,s,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&Ex(t.remoteStore,i),a}async function QO(t,e,n,r,i){t.pu=(p,g,v)=>async function(x,b,C,I){let S=b.view.ru(C);S.Cs&&(S=await wI(x.localStore,b.query,!1).then(({documents:T})=>b.view.ru(T,S)));const V=I&&I.targetChanges.get(b.targetId),U=I&&I.targetMismatches.get(b.targetId)!=null,B=b.view.applyChanges(S,x.isPrimaryClient,V,U);return bI(x,b.targetId,B.au),B.snapshot}(t,p,g,v);const s=await wI(t.localStore,e,!0),o=new $O(e,s.Qs),a=o.ru(s.documents),l=tc.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),u=o.applyChanges(a,t.isPrimaryClient,l);bI(t,n,u.au);const f=new HO(e,n,o);return t.Tu.set(e,f),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),u.snapshot}async function YO(t,e,n){const r=Ae(t),i=r.Tu.get(e),s=r.Iu.get(i.targetId);if(s.length>1)return r.Iu.set(i.targetId,s.filter(o=>!rf(o,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Ym(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&z_(r.remoteStore,i.targetId),eg(r,i.targetId)}).catch(fo)):(eg(r,i.targetId),await Ym(r.localStore,i.targetId,!0))}async function XO(t,e){const n=Ae(t),r=n.Tu.get(e),i=n.Iu.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),z_(n.remoteStore,r.targetId))}async function ZO(t,e,n){const r=Vx(t);try{const i=await function(o,a){const l=Ae(o),u=$e.now(),f=a.reduce((v,E)=>v.add(E.key),Pe());let p,g;return l.persistence.runTransaction("Locally write mutations","readwrite",v=>{let E=Sn(),x=Pe();return l.Ns.getEntries(v,f).next(b=>{E=b,E.forEach((C,I)=>{I.isValidDocument()||(x=x.add(C))})}).next(()=>l.localDocuments.getOverlayedDocuments(v,E)).next(b=>{p=b;const C=[];for(const I of a){const S=p4(I,p.get(I.key).overlayedDocument);S!=null&&C.push(new oi(I.key,S,_A(S.value.mapValue),rn.exists(!0)))}return l.mutationQueue.addMutationBatch(v,u,C,a)}).next(b=>{g=b;const C=b.applyToLocalDocumentSet(p,x);return l.documentOverlayCache.saveOverlays(v,b.batchId,C)})}).then(()=>({batchId:g.batchId,changes:PA(p)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,l){let u=o.Vu[o.currentUser.toKey()];u||(u=new dt(Ce)),u=u.insert(a,l),o.Vu[o.currentUser.toKey()]=u}(r,i.batchId,n),await ic(r,i.changes),await rc(r.remoteStore)}catch(i){const s=j_(i,"Failed to persist write");n.reject(s)}}async function kx(t,e){const n=Ae(t);try{const r=await hO(n.localStore,e);e.targetChanges.forEach((i,s)=>{const o=n.Au.get(s);o&&(ge(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.hu=!0:i.modifiedDocuments.size>0?ge(o.hu,14607):i.removedDocuments.size>0&&(ge(o.hu,42227),o.hu=!1))}),await ic(n,r,e)}catch(r){await fo(r)}}function DI(t,e,n){const r=Ae(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Tu.forEach((s,o)=>{const a=o.view.va(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){const l=Ae(o);l.onlineState=a;let u=!1;l.queries.forEach((f,p)=>{for(const g of p.Sa)g.va(a)&&(u=!0)}),u&&Y_(l)}(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function e3(t,e,n){const r=Ae(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Au.get(e),s=i&&i.key;if(s){let o=new dt(se.comparator);o=o.insert(s,vt.newNoDocument(s,_e.min()));const a=Pe().add(s),l=new lf(_e.min(),new Map,new dt(Ce),o,a);await kx(r,l),r.du=r.du.remove(s),r.Au.delete(e),ey(r)}else await Ym(r.localStore,e,!1).then(()=>eg(r,e,n)).catch(fo)}async function t3(t,e){const n=Ae(t),r=e.batch.batchId;try{const i=await dO(n.localStore,e);Dx(n,r,null),Nx(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await ic(n,i)}catch(i){await fo(i)}}async function n3(t,e,n){const r=Ae(t);try{const i=await function(o,a){const l=Ae(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let f;return l.mutationQueue.lookupMutationBatch(u,a).next(p=>(ge(p!==null,37113),f=p.keys(),l.mutationQueue.removeMutationBatch(u,p))).next(()=>l.mutationQueue.performConsistencyCheck(u)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(u,f,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,f)).next(()=>l.localDocuments.getDocuments(u,f))})}(r.localStore,e);Dx(r,e,n),Nx(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await ic(r,i)}catch(i){await fo(i)}}function Nx(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function Dx(t,e,n){const r=Ae(t);let i=r.Vu[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Vu[r.currentUser.toKey()]=i}}function eg(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(r=>{t.Ru.containsKey(r)||bx(t,r)})}function bx(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(z_(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),ey(t))}function bI(t,e,n){for(const r of n)r instanceof xx?(t.Ru.addReference(r.key,e),r3(t,r)):r instanceof Rx?(ee(Z_,"Document no longer in limbo: "+r.key),t.Ru.removeReference(r.key,e),t.Ru.containsKey(r.key)||bx(t,r.key)):ce(19791,{wu:r})}function r3(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Eu.has(r)||(ee(Z_,"New document in limbo: "+n),t.Eu.add(r),ey(t))}function ey(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new se(Ge.fromString(e)),r=t.fu.next();t.Au.set(r,new WO(n)),t.du=t.du.insert(n,r),Ex(t.remoteStore,new Hr(Bn(Zu(n.path)),r,"TargetPurposeLimboResolution",Fn.ce))}}async function ic(t,e,n){const r=Ae(t),i=[],s=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((a,l)=>{o.push(r.pu(l,e,n).then(u=>{var f;if((u||n)&&r.isPrimaryClient){const p=u?!u.fromCache:(f=n==null?void 0:n.targetChanges.get(l.targetId))==null?void 0:f.current;r.sharedClientState.updateQueryState(l.targetId,p?"current":"not-current")}if(u){i.push(u);const p=q_.As(l.targetId,u);s.push(p)}}))}),await Promise.all(o),r.Pu.H_(i),await async function(l,u){const f=Ae(l);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>q.forEach(u,g=>q.forEach(g.Es,v=>f.persistence.referenceDelegate.addReference(p,g.targetId,v)).next(()=>q.forEach(g.ds,v=>f.persistence.referenceDelegate.removeReference(p,g.targetId,v)))))}catch(p){if(!ss(p))throw p;ee(G_,"Failed to update sequence numbers: "+p)}for(const p of u){const g=p.targetId;if(!p.fromCache){const v=f.Ms.get(g),E=v.snapshotVersion,x=v.withLastLimboFreeSnapshotVersion(E);f.Ms=f.Ms.insert(g,x)}}}(r.localStore,s))}async function i3(t,e){const n=Ae(t);if(!n.currentUser.isEqual(e)){ee(Z_,"User change. New user:",e.toKey());const r=await gx(n.localStore,e);n.currentUser=e,function(s,o){s.mu.forEach(a=>{a.forEach(l=>{l.reject(new re(j.CANCELLED,o))})}),s.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await ic(n,r.Ls)}}function s3(t,e){const n=Ae(t),r=n.Au.get(e);if(r&&r.hu)return Pe().add(r.key);{let i=Pe();const s=n.Iu.get(e);if(!s)return i;for(const o of s){const a=n.Tu.get(o);i=i.unionWith(a.view.nu)}return i}}function Mx(t){const e=Ae(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=kx.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=s3.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=e3.bind(null,e),e.Pu.H_=GO.bind(null,e.eventManager),e.Pu.yu=zO.bind(null,e.eventManager),e}function Vx(t){const e=Ae(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=t3.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=n3.bind(null,e),e}class Fu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=hf(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return mx(this.persistence,new px,e.initialUser,this.serializer)}Cu(e){return new O_(df.mi,this.serializer)}Du(e){return new yx}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Fu.provider={build:()=>new Fu};class o3 extends Fu{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){ge(this.persistence.referenceDelegate instanceof vh,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new ux(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?Kt.withCacheSize(this.cacheSizeBytes):Kt.DEFAULT;return new O_(r=>vh.mi(r,n),this.serializer)}}class a3 extends Fu{constructor(e,n,r){super(),this.xu=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await Vx(this.xu.syncEngine),await rc(this.xu.remoteStore),await this.persistence.Ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}vu(e){return mx(this.persistence,new px,e.initialUser,this.serializer)}Fu(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new ux(r,e.asyncQueue,n)}Mu(e,n){const r=new fU(n,this.persistence);return new hU(e.asyncQueue,r)}Cu(e){const n=aO(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Kt.withCacheSize(this.cacheSizeBytes):Kt.DEFAULT;return new B_(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,IO(),Sd(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new yx}}class Eh{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>DI(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=i3.bind(null,this.syncEngine),await OO(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new qO}()}createDatastore(e){const n=hf(e.databaseInfo.databaseId),r=function(s){return new EO(s)}(e.databaseInfo);return function(s,o,a,l){return new AO(s,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,a){return new RO(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>DI(this.syncEngine,n,0),function(){return AI.v()?new AI:new _O}())}createSyncEngine(e,n){return function(i,s,o,a,l,u,f){const p=new KO(i,s,o,a,l,u);return f&&(p.gu=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(i){const s=Ae(i);ee(lo,"RemoteStore shutting down."),s.Ea.add(5),await nc(s),s.Aa.shutdown(),s.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}Eh.provider={build:()=>new Eh};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ty{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):nn("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const es="FirestoreClient";class l3{constructor(e,n,r,i,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=Ut.UNAUTHENTICATED,this.clientId=jh.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{ee(es,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(ee(es,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Rr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=j_(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function vp(t,e){t.asyncQueue.verifyOperationInProgress(),ee(es,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await gx(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function MI(t,e){t.asyncQueue.verifyOperationInProgress();const n=await u3(t);ee(es,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>RI(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>RI(e.remoteStore,i)),t._onlineComponents=e}async function u3(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){ee(es,"Using user provided OfflineComponentProvider");try{await vp(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(i){return i.name==="FirebaseError"?i.code===j.FAILED_PRECONDITION||i.code===j.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;Ji("Error using user provided cache. Falling back to memory cache: "+n),await vp(t,new Fu)}}else ee(es,"Using default OfflineComponentProvider"),await vp(t,new o3(void 0));return t._offlineComponents}async function Lx(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(ee(es,"Using user provided OnlineComponentProvider"),await MI(t,t._uninitializedComponentsProvider._online)):(ee(es,"Using default OnlineComponentProvider"),await MI(t,new Eh))),t._onlineComponents}function c3(t){return Lx(t).then(e=>e.syncEngine)}async function Ih(t){const e=await Lx(t),n=e.eventManager;return n.onListen=jO.bind(null,e.syncEngine),n.onUnlisten=YO.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=JO.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=XO.bind(null,e.syncEngine),n}function d3(t,e,n={}){const r=new Rr;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,u){const f=new ty({next:g=>{f.Nu(),o.enqueueAndForget(()=>Q_(s,p));const v=g.docs.has(a);!v&&g.fromCache?u.reject(new re(j.UNAVAILABLE,"Failed to get document because the client is offline.")):v&&g.fromCache&&l&&l.source==="server"?u.reject(new re(j.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(g)},error:g=>u.reject(g)}),p=new X_(Zu(a.path),f,{includeMetadataChanges:!0,qa:!0});return J_(s,p)}(await Ih(t),t.asyncQueue,e,n,r)),r.promise}function h3(t,e,n={}){const r=new Rr;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,u){const f=new ty({next:g=>{f.Nu(),o.enqueueAndForget(()=>Q_(s,p)),g.fromCache&&l.source==="server"?u.reject(new re(j.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(g)},error:g=>u.reject(g)}),p=new X_(a,f,{includeMetadataChanges:!0,qa:!0});return J_(s,p)}(await Ih(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fx(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VI=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ux="firestore.googleapis.com",LI=!0;class FI{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new re(j.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Ux,this.ssl=LI}else this.host=e.host,this.ssl=e.ssl??LI;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=sx;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<$4)throw new re(j.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}W0("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Fx(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new re(j.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new re(j.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new re(j.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class pf{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new FI({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new re(j.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new re(j.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new FI(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new z0;switch(r.type){case"firstParty":return new rU(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new re(j.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=VI.get(n);r&&(ee("ComponentProvider","Removing Datastore"),VI.delete(n),r.terminate())}(this),Promise.resolve()}}function Ox(t,e,n,r={}){var u;t=on(t,pf);const i=Ka(e),s=t._getSettings(),o={...s,emulatorOptions:t._getEmulatorOptions()},a=`${e}:${n}`;i&&(HC(`https://${a}`),WC("Firestore",!0)),s.host!==Ux&&s.host!==a&&Ji("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...s,host:a,ssl:i,emulatorOptions:r};if(!to(l,o)&&(t._setSettings(l),r.mockUserToken)){let f,p;if(typeof r.mockUserToken=="string")f=r.mockUserToken,p=Ut.MOCK_USER;else{f=R2(r.mockUserToken,(u=t._app)==null?void 0:u.options.projectId);const g=r.mockUserToken.sub||r.mockUserToken.user_id;if(!g)throw new re(j.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");p=new Ut(g)}t._authCredentials=new eU(new G0(f,p))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class as{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new as(this.firestore,e,this._query)}}class ft{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Kr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ft(this.firestore,e,this._key)}toJSON(){return{type:ft._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(Ju(n,ft._jsonSchema))return new ft(e,r||null,new se(Ge.fromString(n.referencePath)))}}ft._jsonSchemaVersion="firestore/documentReference/1.0",ft._jsonSchema={type:St("string",ft._jsonSchemaVersion),referencePath:St("string")};class Kr extends as{constructor(e,n,r){super(e,n,Zu(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ft(this.firestore,null,new se(e))}withConverter(e){return new Kr(this.firestore,e,this._path)}}function at(t,e,...n){if(t=Pt(t),H0("collection","path",e),t instanceof pf){const r=Ge.fromString(e,...n);return xE(r),new Kr(t,null,r)}{if(!(t instanceof ft||t instanceof Kr))throw new re(j.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ge.fromString(e,...n));return xE(r),new Kr(t.firestore,null,r)}}function Le(t,e,...n){if(t=Pt(t),arguments.length===1&&(e=jh.newId()),H0("doc","path",e),t instanceof pf){const r=Ge.fromString(e,...n);return AE(r),new ft(t,null,new se(r))}{if(!(t instanceof ft||t instanceof Kr))throw new re(j.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ge.fromString(e,...n));return AE(r),new ft(t.firestore,t instanceof Kr?t.converter:null,new se(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UI="AsyncQueue";class OI{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new vx(this,"async_queue_retry"),this._c=()=>{const r=Sd();r&&ee(UI,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=Sd();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=Sd();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new Rr;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!ss(e))throw e;ee(UI,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,nn("INTERNAL UNHANDLED ERROR: ",BI(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const i=K_.createAndSchedule(this,e,n,r,s=>this.hc(s));return this.tc.push(i),i}uc(){this.nc&&ce(47125,{Pc:BI(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function BI(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qI(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const i=n;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}class Nr extends pf{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new OI,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new OI(e),this._firestoreClient=void 0,await e}}}function Bx(t,e){const n=typeof t=="object"?t:e0(),r=typeof t=="string"?t:ch,i=l_(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=A2("firestore");s&&Ox(i,...s)}return i}function sc(t){if(t._terminated)throw new re(j.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||qx(t),t._firestoreClient}function qx(t){var r,i,s;const e=t._freezeSettings(),n=function(a,l,u,f){return new GU(a,l,u,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,Fx(f.experimentalLongPollingOptions),f.useFetchStreams,f.isUsingEmulator)}(t._databaseId,((r=t._app)==null?void 0:r.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(i=e.localCache)!=null&&i._offlineComponentProvider&&((s=e.localCache)!=null&&s._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new l3(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(t._componentsProvider))}function Gx(t,e){Ji("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings();return f3(t,Eh.provider,{build:r=>new a3(r,n.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}function f3(t,e,n){if((t=on(t,Nr))._firestoreClient||t._terminated)throw new re(j.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new re(j.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:n},qx(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class In{constructor(e){this._byteString=e}static fromBase64String(e){try{return new In(Et.fromBase64String(e))}catch(n){throw new re(j.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new In(Et.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:In._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Ju(e,In._jsonSchema))return In.fromBase64String(e.bytes)}}In._jsonSchemaVersion="firestore/bytes/1.0",In._jsonSchema={type:St("string",In._jsonSchemaVersion),bytes:St("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oc{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new re(j.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ct(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ac{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sr{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new re(j.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new re(j.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Ce(this._lat,e._lat)||Ce(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:sr._jsonSchemaVersion}}static fromJSON(e){if(Ju(e,sr._jsonSchema))return new sr(e.latitude,e.longitude)}}sr._jsonSchemaVersion="firestore/geoPoint/1.0",sr._jsonSchema={type:St("string",sr._jsonSchemaVersion),latitude:St("number"),longitude:St("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class or{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}toJSON(){return{type:or._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Ju(e,or._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new or(e.vectorValues);throw new re(j.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}or._jsonSchemaVersion="firestore/vectorValue/1.0",or._jsonSchema={type:St("string",or._jsonSchemaVersion),vectorValues:St("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p3=/^__.*__$/;class m3{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new oi(e,this.data,this.fieldMask,n,this.fieldTransforms):new Ya(e,this.data,n,this.fieldTransforms)}}class zx{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new oi(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function $x(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ce(40011,{Ac:t})}}class ny{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new ny({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var i;const n=(i=this.path)==null?void 0:i.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){var i;const n=(i=this.path)==null?void 0:i.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return wh(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if($x(this.Ac)&&p3.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class g3{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||hf(e)}Cc(e,n,r,i=!1){return new ny({Ac:e,methodName:n,Dc:r,path:ct.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function ry(t){const e=t._freezeSettings(),n=hf(t._databaseId);return new g3(t._databaseId,!!e.ignoreUndefinedProperties,n)}function _3(t,e,n,r,i,s={}){const o=t.Cc(s.merge||s.mergeFields?2:0,e,n,i);sy("Data must be an object, but it was:",o,r);const a=Hx(r,o);let l,u;if(s.merge)l=new pn(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const f=[];for(const p of s.mergeFields){const g=tg(e,p,n);if(!o.contains(g))throw new re(j.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);Kx(f,g)||f.push(g)}l=new pn(f),u=o.fieldTransforms.filter(p=>l.covers(p.field))}else l=null,u=o.fieldTransforms;return new m3(new Jt(a),l,u)}class mf extends ac{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof mf}}class iy extends ac{_toFieldTransform(e){return new LA(e.path,new La)}isEqual(e){return e instanceof iy}}function y3(t,e,n,r){const i=t.Cc(1,e,n);sy("Data must be an object, but it was:",i,r);const s=[],o=Jt.empty();os(r,(l,u)=>{const f=oy(e,l,n);u=Pt(u);const p=i.yc(f);if(u instanceof mf)s.push(f);else{const g=lc(u,p);g!=null&&(s.push(f),o.set(f,g))}});const a=new pn(s);return new zx(o,a,i.fieldTransforms)}function v3(t,e,n,r,i,s){const o=t.Cc(1,e,n),a=[tg(e,r,n)],l=[i];if(s.length%2!=0)throw new re(j.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<s.length;g+=2)a.push(tg(e,s[g])),l.push(s[g+1]);const u=[],f=Jt.empty();for(let g=a.length-1;g>=0;--g)if(!Kx(u,a[g])){const v=a[g];let E=l[g];E=Pt(E);const x=o.yc(v);if(E instanceof mf)u.push(v);else{const b=lc(E,x);b!=null&&(u.push(v),f.set(v,b))}}const p=new pn(u);return new zx(f,p,o.fieldTransforms)}function T3(t,e,n,r=!1){return lc(n,t.Cc(r?4:3,e))}function lc(t,e){if(Wx(t=Pt(t)))return sy("Unsupported field value:",e,t),Hx(t,e);if(t instanceof ac)return function(r,i){if(!$x(i.Ac))throw i.Sc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const a of r){let l=lc(a,i.wc(o));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=Pt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return l4(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=$e.fromDate(r);return{timestampValue:Oa(i.serializer,s)}}if(r instanceof $e){const s=new $e(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Oa(i.serializer,s)}}if(r instanceof sr)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof In)return{bytesValue:zA(i.serializer,r._byteString)};if(r instanceof ft){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:V_(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof or)return function(o,a){return{mapValue:{fields:{[x_]:{stringValue:R_},[Da]:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw a.Sc("VectorValues must only contain numeric values.");return k_(a.serializer,u)})}}}}}}(r,i);throw i.Sc(`Unsupported field value: ${Jh(r)}`)}(t,e)}function Hx(t,e){const n={};return lA(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):os(t,(r,i)=>{const s=lc(i,e.mc(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function Wx(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof $e||t instanceof sr||t instanceof In||t instanceof ft||t instanceof ac||t instanceof or)}function sy(t,e,n){if(!Wx(n)||!K0(n)){const r=Jh(n);throw r==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+r)}}function tg(t,e,n){if((e=Pt(e))instanceof oc)return e._internalPath;if(typeof e=="string")return oy(t,e);throw wh("Field path arguments must be of type string or ",t,!1,void 0,n)}const E3=new RegExp("[~\\*/\\[\\]]");function oy(t,e,n){if(e.search(E3)>=0)throw wh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new oc(...e.split("."))._internalPath}catch{throw wh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function wh(t,e,n,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new re(j.INVALID_ARGUMENT,a+t+l)}function Kx(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jx{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new ft(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new I3(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(ay("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class I3 extends jx{data(){return super.data()}}function ay(t,e){return typeof e=="string"?oy(t,e):e instanceof oc?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jx(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new re(j.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class ly{}class Qx extends ly{}function Fl(t,e,...n){let r=[];e instanceof ly&&r.push(e),r=r.concat(n),function(s){const o=s.filter(l=>l instanceof gf).length,a=s.filter(l=>l instanceof uc).length;if(o>1||o>0&&a>0)throw new re(j.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class uc extends Qx{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new uc(e,n,r)}_apply(e){const n=this._parse(e);return Yx(e._query,n),new as(e.firestore,e.converter,Gm(e._query,n))}_parse(e){const n=ry(e.firestore);return function(s,o,a,l,u,f,p){let g;if(u.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new re(j.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){zI(p,f);const E=[];for(const x of p)E.push(GI(l,s,x));g={arrayValue:{values:E}}}else g=GI(l,s,p)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||zI(p,f),g=T3(a,o,p,f==="in"||f==="not-in");return Me.create(u,f,g)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Ul(t,e,n){const r=e,i=ay("where",t);return uc._create(i,r,n)}class gf extends ly{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new gf(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:He.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i;const a=s.getFlattenedFilters();for(const l of a)Yx(o,l),o=Gm(o,l)}(e._query,n),new as(e.firestore,e.converter,Gm(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function GI(t,e,n){if(typeof(n=Pt(n))=="string"){if(n==="")throw new re(j.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!CA(e)&&n.indexOf("/")!==-1)throw new re(j.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Ge.fromString(n));if(!se.isDocumentKey(r))throw new re(j.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Mu(t,new se(r))}if(n instanceof ft)return Mu(t,n._key);throw new re(j.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Jh(n)}.`)}function zI(t,e){if(!Array.isArray(t)||t.length===0)throw new re(j.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Yx(t,e){const n=function(i,s){for(const o of i)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new re(j.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new re(j.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class Xx{convertValue(e,n="none"){switch(Yi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return lt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(ti(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw ce(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return os(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertVectorValue(e){var r,i,s;const n=(s=(i=(r=e.fields)==null?void 0:r[Da].arrayValue)==null?void 0:i.values)==null?void 0:s.map(o=>lt(o.doubleValue));return new or(n)}convertGeoPoint(e){return new sr(lt(e.latitude),lt(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=tf(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Du(e));default:return null}}convertTimestamp(e){const n=ei(e);return new $e(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Ge.fromString(e);ge(ZA(r),9688,{name:e});const i=new Qi(r.get(1),r.get(3)),s=new se(r.popFirst(5));return i.isEqual(n)||nn(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w3(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class ia{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class $i extends jx{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new su(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(ay("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new re(j.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=$i._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}$i._jsonSchemaVersion="firestore/documentSnapshot/1.0",$i._jsonSchema={type:St("string",$i._jsonSchemaVersion),bundleSource:St("string","DocumentSnapshot"),bundleName:St("string"),bundle:St("string")};class su extends $i{data(e={}){return super.data(e)}}class Hi{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new ia(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new su(this._firestore,this._userDataWriter,r.key,r,new ia(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new re(j.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{const l=new su(i._firestore,i._userDataWriter,a.doc.key,a.doc,new ia(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{const l=new su(i._firestore,i._userDataWriter,a.doc.key,a.doc,new ia(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let u=-1,f=-1;return a.type!==0&&(u=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),f=o.indexOf(a.doc.key)),{type:S3(a.type),doc:l,oldIndex:u,newIndex:f}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new re(j.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Hi._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=jh.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],i=[];return this.docs.forEach(s=>{s._document!==null&&(n.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function S3(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ce(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ng(t){t=on(t,ft);const e=on(t.firestore,Nr);return d3(sc(e),t._key).then(n=>Zx(e,t,n))}Hi._jsonSchemaVersion="firestore/querySnapshot/1.0",Hi._jsonSchema={type:St("string",Hi._jsonSchemaVersion),bundleSource:St("string","QuerySnapshot"),bundleName:St("string"),bundle:St("string")};class uy extends Xx{constructor(e){super(),this.firestore=e}convertBytes(e){return new In(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new ft(this.firestore,null,n)}}function yi(t){t=on(t,as);const e=on(t.firestore,Nr),n=sc(e),r=new uy(e);return Jx(t._query),h3(n,t._query).then(i=>new Hi(e,r,t,i))}function _t(t,e,n){t=on(t,ft);const r=on(t.firestore,Nr),i=w3(t.converter,e,n);return _f(r,[_3(ry(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,rn.none())])}function rg(t,e,n,...r){t=on(t,ft);const i=on(t.firestore,Nr),s=ry(i);let o;return o=typeof(e=Pt(e))=="string"||e instanceof oc?v3(s,"updateDoc",t._key,e,n,r):y3(s,"updateDoc",t._key,e),_f(i,[o.toMutation(t._key,rn.exists(!0))])}function Lt(t){return _f(on(t.firestore,Nr),[new af(t._key,rn.none())])}function Fr(t,...e){var l,u,f;t=Pt(t);let n={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||qI(e[r])||(n=e[r++]);const i={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(qI(e[r])){const p=e[r];e[r]=(l=p.next)==null?void 0:l.bind(p),e[r+1]=(u=p.error)==null?void 0:u.bind(p),e[r+2]=(f=p.complete)==null?void 0:f.bind(p)}let s,o,a;if(t instanceof ft)o=on(t.firestore,Nr),a=Zu(t._key.path),s={next:p=>{e[r]&&e[r](Zx(o,t,p))},error:e[r+1],complete:e[r+2]};else{const p=on(t,as);o=on(p.firestore,Nr),a=p._query;const g=new uy(o);s={next:v=>{e[r]&&e[r](new Hi(o,g,p,v))},error:e[r+1],complete:e[r+2]},Jx(t._query)}return function(g,v,E,x){const b=new ty(x),C=new X_(v,b,E);return g.asyncQueue.enqueueAndForget(async()=>J_(await Ih(g),C)),()=>{b.Nu(),g.asyncQueue.enqueueAndForget(async()=>Q_(await Ih(g),C))}}(sc(o),a,i,s)}function _f(t,e){return function(r,i){const s=new Rr;return r.asyncQueue.enqueueAndForget(async()=>ZO(await c3(r),i,s)),s.promise}(sc(t),e)}function Zx(t,e,n){const r=n.docs.get(e._key),i=new uy(t);return new $i(t,i,e._key,r,new ia(n.hasPendingWrites,n.fromCache),e.converter)}function C3(){return new iy("serverTimestamp")}(function(e,n=!0){(function(i){Qa=i})(ja),Ca(new no("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),a=new Nr(new tU(r.getProvider("auth-internal")),new iU(o,r.getProvider("app-check-internal")),function(u,f){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new re(j.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Qi(u.options.projectId,f)}(o,i),o);return s={useFetchStreams:n,...s},a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),qi(IE,wE,e),qi(IE,wE,"esm2020")})();const xs=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:Xx,Bytes:In,CollectionReference:Kr,DocumentReference:ft,DocumentSnapshot:$i,FieldPath:oc,FieldValue:ac,Firestore:Nr,FirestoreError:re,GeoPoint:sr,Query:as,QueryCompositeFilterConstraint:gf,QueryConstraint:Qx,QueryDocumentSnapshot:su,QueryFieldFilterConstraint:uc,QuerySnapshot:Hi,SnapshotMetadata:ia,Timestamp:$e,VectorValue:or,_AutoId:jh,_ByteString:Et,_DatabaseId:Qi,_DocumentKey:se,_EmptyAuthCredentialsProvider:z0,_FieldPath:ct,_cast:on,_logWarn:Ji,_validateIsNotUsedTogether:W0,collection:at,connectFirestoreEmulator:Ox,deleteDoc:Lt,doc:Le,enableIndexedDbPersistence:Gx,ensureFirestoreConfigured:sc,executeWrite:_f,getDoc:ng,getDocs:yi,getFirestore:Bx,onSnapshot:Fr,query:Fl,serverTimestamp:C3,setDoc:_t,setLogLevel:B0,updateDoc:rg,where:Ul},Symbol.toStringTag,{value:"Module"}));B0("error");const A3={apiKey:"AIzaSyC1zhlBnbOxP_PCaHU6L-UsDOBRTjGgpfk",authDomain:"my-apss-da774.firebaseapp.com",projectId:"my-apss-da774",storageBucket:"my-apss-da774.firebasestorage.app",messagingSenderId:"528434940137",appId:"1:528434940137:web:56be66185a46f390b60878",measurementId:"G-WPGZGF4ZBG"},eR=ZC(A3),vi=XF(eR);OL(vi,S0).catch(t=>console.error("Persistence error:",t));const js=new Br;js.addScope("profile");js.addScope("email");js.setCustomParameters({prompt:"select_account",access_type:"offline"});if(typeof window<"u"){const t=navigator.userAgent.toLowerCase();t.includes("safari")&&!t.includes("chrome")&&!t.includes("firefox")&&js.setCustomParameters({prompt:"consent"})}const me=Bx(eR);Gx(me).catch(t=>{t.code==="failed-precondition"?console.warn("Firestore: Multiple tabs open, persistence disabled"):t.code==="unimplemented"&&console.warn("Firestore: Browser does not support persistence")});const x3=({onClose:t,onCreate:e,t:n,defaultIsShared:r=!1,googleUser:i})=>{const[s,o]=z.useState(!1),[a,l]=z.useState(""),[u,f]=z.useState(r),[p,g]=z.useState(""),[v,E]=z.useState("editor"),[x,b]=z.useState([]),[C,I]=z.useState("");z.useEffect(()=>{const w=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=w}},[]);const S=()=>{o(!0),setTimeout(()=>{try{t&&t()}catch{}},320)},V=()=>{if(!a.trim()){I("폴더 이름을 입력하세요.");return}try{e&&e({name:a.trim(),isShared:u,collaborators:u?x:[]})}catch{}S()},U=n&&typeof n=="function"?n("folder_create_title"):"",B=U&&U!=="folder_create_title"?U:"새 폴더 만들기",T=m.jsx("div",{className:`alert-backdrop${s?" is-closing":""}`,onClick:S,children:m.jsxs("div",{className:`alert-modal modal-content-small${s?" is-closing":""}`,onClick:w=>w.stopPropagation(),children:[m.jsxs("div",{style:{padding:"18px 18px 12px"},children:[m.jsx("h3",{style:{margin:0,fontSize:"1.05rem",fontWeight:600},children:B}),m.jsx("p",{style:{margin:"8px 0 0",color:"var(--text-secondary-color)",fontSize:"0.9rem"},children:"폴더 이름을 입력하고 확인을 누르세요."})]}),m.jsxs("div",{style:{padding:"12px 18px 8px"},children:[m.jsx("input",{type:"text",value:a,onChange:w=>l(w.target.value),placeholder:"폴더 이름",className:"folder-create-input",autoFocus:!0,onKeyDown:w=>{w.key==="Enter"&&V()}}),C&&m.jsx("div",{style:{color:"var(--danger-color)",fontSize:"13px",marginTop:8},children:C})]}),m.jsxs("div",{className:"modal-buttons",style:{display:"flex",gap:8,padding:"12px 18px 18px"},children:[m.jsx("button",{onClick:S,className:"secondary",children:"취소"}),m.jsx("button",{onClick:V,className:"primary",children:"확인"})]})]})});return typeof document<"u"&&document.body?Pk.createPortal(T,document.body):T},$I=()=>{try{const t=localStorage.getItem("theme");return t==="dark"||t==="light"?t:window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}catch{return"light"}},Vt=t=>{try{return JSON.parse(JSON.stringify(t,(e,n)=>n===void 0?null:n))}catch{return t}},HI=()=>typeof navigator<"u"?/Mobi|Android|iPhone|iPad|iPod/i.test(navigator.userAgent)||typeof window<"u"&&window.innerWidth<=600:!1,WI=()=>{try{return window.matchMedia&&window.matchMedia("(display-mode: standalone)").matches||navigator.standalone===!0}catch{return!1}},tR=async()=>{if(!("Notification"in window))return!1;try{return await Notification.requestPermission()==="granted"}catch{return!1}},nR=async()=>{try{if(!("serviceWorker"in navigator)||!("PushManager"in window))return console.log("Push notifications not supported"),!1;const e=await(await navigator.serviceWorker.ready).pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:R3("BOEd9nQKXBj8LJXNM6LJt6Nua5MJMhF8cCQvMNJ-2NWoWsM0cGgNqDG3kNm-QMYbdMDYAXaJ55MFP_fPHqH7SFA")});return await P3(e),!0}catch(t){return console.error("Failed to subscribe to push notifications:",t),!1}},R3=t=>{const e="=".repeat((4-t.length%4)%4),n=(t+e).replace(/\-/g,"+").replace(/_/g,"/"),r=window.atob(n),i=new Uint8Array(r.length);for(let s=0;s<r.length;++s)i[s]=r.charCodeAt(s);return i},P3=async t=>{try{(await fetch("/api/subscribe",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({subscription:t.toJSON(),endpoint:t.endpoint})})).ok||console.error("Failed to send subscription to server")}catch(e){console.error("Error sending subscription to server:",e)}},k3=({onClose:t})=>{const[e,n]=z.useState(null),[r,i]=z.useState(!1);z.useEffect(()=>{const o=/iPad|iPhone|iPod/.test(navigator.userAgent);i(o);const a=l=>{l.preventDefault(),n(l)};return window.addEventListener("beforeinstallprompt",a),()=>{window.removeEventListener("beforeinstallprompt",a)}},[]);const s=async()=>{if(e){e.prompt();const{outcome:o}=await e.userChoice;o==="accepted"&&(n(null),t())}};return m.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:m.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-sm w-full",children:[m.jsxs("div",{className:"text-center mb-4",children:[m.jsx("div",{className:"w-16 h-16 bg-indigo-600 rounded-lg mx-auto mb-4 flex items-center justify-center",children:m.jsx("span",{className:"text-white text-2xl font-bold",children:"N"})}),m.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"앱으로 설치하기"}),m.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-sm",children:"Nova Beta를 홈 화면에 추가하여 더 편리하게 사용하세요."}),m.jsxs("ol",{className:"list-decimal pl-6 space-y-2 text-left mt-4",children:[m.jsxs("li",{className:"flex items-center",children:[m.jsx("span",{className:"w-6 h-6 bg-indigo-600 text-white rounded-full flex items-center justify-center text-xs mr-2",children:"1"}),"하단의 공유 버튼 (□↗) 탭"]}),m.jsxs("li",{className:"flex items-center",children:[m.jsx("span",{className:"w-6 h-6 bg-indigo-600 text-white rounded-full flex items-center justify-center text-xs mr-2",children:"2"}),'"홈 화면에 추가" 선택']}),m.jsxs("li",{className:"flex items-center",children:[m.jsx("span",{className:"w-6 h-6 bg-indigo-600 text-white rounded-full flex items-center justify-center text-xs mr-2",children:"3"}),'"추가" 버튼 탭']})]})]}),m.jsx("div",{className:"mb-4",children:e?m.jsx("button",{onClick:s,className:"w-full bg-indigo-600 text-white py-2 px-4 rounded-lg hover:bg-indigo-700 transition-colors",children:"지금 설치하기"}):m.jsx("div",{className:"bg-gray-50 dark:bg-gray-700 p-3 rounded-lg",children:m.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:'브라우저 메뉴에서 "홈 화면에 추가" 또는 "앱 설치"를 선택하세요.'})})}),m.jsxs("div",{className:"flex space-x-2",children:[m.jsx("button",{onClick:t,className:"flex-1 bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-gray-200 py-2 px-4 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-500 transition-colors",children:"나중에"}),m.jsx("button",{onClick:()=>{localStorage.setItem("pwa-prompt-dismissed","true"),t()},className:"flex-1 bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-gray-200 py-2 px-4 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-500 transition-colors",children:"다시 보지 않기"})]})]})})},N3={ko:{language_selection_title:"언어",error_wish_required:"목표를 입력해주세요.",error_outcome_required:"결과를 입력해주세요.",error_obstacle_required:"장애물을 입력해주세요.",error_plan_required:"If-Then 계획을 입력해주세요.",error_deadline_required:"마감일을 선택해주세요.",error_day_required:"하나 이상의 요일을 선택해주세요.",my_goals_title:"나의 목표",all_goals_label:"나의 목표",sort_label_manual:"사용자화",sort_label_deadline:"마감일순",sort_label_newest:"최신순",sort_label_alphabetical:"이름순",sort_label_ai:"우선순위로 정렬",ai_sorting_button:"정렬 중...",add_new_goal_button_label:"새로운 목표 추가",filter_all:"나의 목표",filter_active:"진행중",filter_completed:"완료됨",filter_category:"카테고리",category_all:"모든 카테고리",category_school:"학교",category_work:"회사",category_personal:"개인",category_other:"기타",category_label:"카테고리 선택",empty_message_all:"+ 버튼으로 목표를 추가해보세요",empty_message_active:"진행중인 목표가 없습니다.",empty_message_completed:"아직 완료된 목표가 없습니다.",empty_encouragement_1:"새로운 여정의 첫 걸음을 내딛어보세요.",empty_encouragement_2:"작은 변화가 큰 성취로 이어집니다.",empty_encouragement_3:"오늘 하는 일이 내일을 만듭니다.",empty_encouragement_4:"당신의 목표가 현실이 되는 순간을 만나보세요.",delete_button:"삭제",edit_button_aria:"편집",info_button_aria:"정보",filter_title:"필터",sort_title:"정렬",filter_sort_button_aria:"필터 및 정렬",calendar_view_button_aria:"달력 보기",list_view_button_aria:"목록 보기",more_options_button_aria:"더보기",select_button_label:"선택",cancel_selection_button_label:"취소",delete_selected_button_label:"{count}개 삭제",select_all_button_label:"전체선택",delete_selected_confirm_title:"목표 삭제",delete_selected_confirm_message:"선택한 {count}개의 목표가 영구적으로 삭제됩니다. 이 작업은 되돌릴 수 없습니다.",days_left:"{count}일 남음",d_day:"오늘",days_overdue:"{count}일 지남",month_names:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],day_names_short:["일","월","화","수","목","금","토"],day_names_long:["일요일","월요일","화요일","수요일","목요일","금요일","토요일"],calendar_header_month_format:"{year}년 {month}",calendar_view_day3:"3일",calendar_view_week:"주",calendar_view_month:"월",settings_title:"설정",sort_alert_title:"정렬 실패",sort_alert_message:"우선순위 정렬을 사용하려면<br/>2개 이상의 목표가 필요합니다.",ai_sort_error_title:"정렬 오류",ai_sort_error_message:"서버에 연결할 수 없습니다. 나중에 다시 시도해주세요.",confirm_button:"확인",new_goal_modal_title:"새로운 목표",edit_goal_modal_title:"목표 편집",wish_label:"목표",outcome_label:"최상의 결과",obstacle_label:"장애물",plan_label:"If-Then 계획",deadline_label:"마감일",cancel_button:"취소",add_button:"추가",save_button:"저장",goal_details_modal_title:"목표 상세 정보",ai_coach_suggestion:"요약보기",ai_analyzing:"분석 중...",close_button:"닫기",ai_sort_reason_modal_title:"AI 정렬 재안",ai_sort_criteria:"AI 정렬 기준",delete_account_final_confirm_title:"모든 데이터 및 설정 지우기",delete_account_final_confirm_message:"모든 목표와 데이터가 영구적으로 삭제되며, 이 작업은 되돌릴 수 없습니다.",delete_all_data_button:"모든 데이터 및 설정 지우기",settings_done_button:"완료",settings_section_data:"데이터 관리",settings_section_account:"Nova Beta 계정",settings_sync_data:"지금 동기화",settings_load_data:"불러오기",settings_logout:"로그아웃",settings_export_data:"데이터 내보내기",settings_import_data:"데이터 가져오기",import_confirm_title:"데이터 가져오기",import_confirm_message:"현재 목표를 새로운 데이터로 교체합니다. 이 작업은 되돌릴 수 없습니다.",import_success_toast:"데이터를 성공적으로 가져왔습니다.",import_error_alert_title:"가져오기 실패",import_error_alert_message:"파일을 읽는 중 오류가 발생했거나 파일 형식이 올바르지 않습니다. 나중에 다시 시도히십시오.",settings_section_general:"일반",settings_section_info:"정보",settings_section_help:"사용방법",settings_theme_mode:"테마 모드",theme_mode_light:"라이트 모드",theme_mode_light_desc:"항상 밝은 테마 사용",theme_mode_dark:"다크 모드",theme_mode_dark_desc:"항상 어두운 테마 사용",theme_mode_system:"자동",theme_mode_system_desc:"기기의 설정에에 동기화 됩니다.",settings_dark_mode:"다크 모드",settings_language:"언어",settings_api_key:"Gemini AI 설정",settings_api_key_placeholder:"Gemini API 키 입력",settings_offline_mode:"오프라인 사용",settings_offline_mode_desc:"AI 기능 없이 기본 기능 사용",settings_notifications:"알림",settings_notifications_desc:"PWA 알림 설정",notification_settings_title:"어떤 알림을 받을까요?",reminder_add_title:"미리알림 추가",reminder_step_title:"{step}/5 단계",reminder_step1_title:"🔔 제목",reminder_step1_desc:"미리알림의 제목을 입력하세요",reminder_step2_title:"📅 기한 & ⏰ 시간",reminder_step2_desc:"기한 날짜와 시간을 설정하세요 (선택사항)",reminder_step2_date_toggle:"기한 설정",reminder_step2_time_toggle:"시간 설정",reminder_step3_title:"🔄 반복 설정",reminder_step3_desc:"반복 여부와 반복 주기를 선택하세요",reminder_step3_enable_recurring:"반복 설정",reminder_step4_title:"📝 설명",reminder_step4_desc:"추가 설명을 입력하세요 (선택사항)",reminder_step5_title:"✅ 활성화",reminder_step5_desc:"미리알림 활성화 여부를 선택하세요",reminder_next_button:"다음",reminder_back_button:"이전",reminder_submit_button:"추가",reminder_form_title:"제목",reminder_form_date:"기한",reminder_form_time:"시간",reminder_form_recurring:"반복",reminder_form_description:"설명",reminder_form_enabled:"활성화",recurring_type_none:"반복 없음",recurring_type_daily:"매일",recurring_type_weekly:"매주",recurring_type_monthly:"매월",notification_deadline:"마감일 임박 알림",notification_deadline_desc:"마감이 가까운 목표에 대해 알려줍니다.",notification_suggestion:"지금할일 제안",notification_suggestion_desc:"오늘 해야할 목표를 제안해줍니다.",notification_achievement:"목표 달성 축하",notification_achievement_desc:"목표를 달성했을 때 축하해줍니다.",notification_reminder:"일반 미리알림",notification_reminder_desc:"설정한 시간에 미리알림을 받습니다.",reminder_time_settings_title:"미리알림 시간 설정",reminder_start_time:"시작 시간",reminder_end_time:"종료 시간",language_name:"한국어 (대한민국)",language_modal_title:"언어",settings_section_background:"화면",settings_bg_default:"라이트",settings_bg_default_dark:"다크",settings_bg_pink:"핑크",settings_bg_cherry_noir:"다크 체리",settings_bg_blue:"블루",settings_bg_deep_ocean:"오션",settings_bg_green:"그린",settings_bg_forest_green:"포레스트 그린",settings_bg_purple:"퍼플",settings_bg_royal_purple:"딥 퍼플",settings_version:"버전",test_long_alert:"긴 알림 테스트",test_long_alert_desc:"긴 내용의 알림 팝업 테스트",folder_manage_title:"폴더 관리",folder_manage_info:"폴더 정보",folder_manage_collaborators:"협업자",folder_manage_settings:"설정",folder_name_edit:"폴더 이름 편집",folder_invite_new:"새 협업자 초대",folder_invite_email:"이메일 주소",folder_invite_role:"역할",folder_role_owner:"소유자",folder_role_editor:"편집자",folder_role_viewer:"뷰어",folder_invite_button:"초대하기",folder_leave:"폴더 나가기",folder_delete:"폴더 삭제",folder_share_link:"공유 링크",folder_share_link_desc:"이 링크로 다른 사용자를 초대할 수 있습니다",folder_copy_link:"링크 복사",folder_leave_confirm:"폴더에서 나가시겠습니까?",folder_delete_confirm:"폴더를 삭제하시겠습니까? 나의 목표로 이동됩니다.",settings_developer:"개발자",developer_name:"Kim Kyumin",settings_copyright:"저작권",copyright_notice:"© 2025 Kim Kyumin. All Rights Reserved.",build_number:"빌드 번호",settings_data_header:"데이터 관리",settings_data_header_desc:"목표 데이터를 파일로 내보내거나, 파일에서 가져옵니다.",settings_background_header:"배경화면",settings_background_header_desc:"앱의 배경화면 스타일을 변경하여 개성을 표현해 보세요.",data_importing:"가져오는 중...",data_exporting:"내보내는 중...",data_deleting:"삭제 중...",url_import_title:"URL에서 데이터 불러오기",url_import_message:"URL의 데이터로 현재 목표 목록을 병합하시겠습니까?",url_import_confirm:"불러오기",url_import_success:"URL에서 데이터를 성공적으로 가져왔습니다!",url_import_error:"URL의 데이터가 올바르지 않습니다.",settings_share_link_header:"링크로 공유",settings_generate_link:"공유 링크 생성",settings_copy_link:"복사",link_copied_toast:"링크가 클립보드에 복사되었습니다.",short_url_created:"📎 단축 URL이 생성되었습니다!",share_link_created:"🔗 공유 링크가 생성되었습니다!",short_url_failed:"⚠️ 단축 URL 생성에 실패하여 기본 링크를 사용합니다.",no_data_to_share:"공유할 목표가 없습니다.",usage_guide_tab:"사용방법",usage_guide_title:"사용 가이드",usage_basic_title:"목표 추가하기",usage_basic_desc:`1. 홈 화면에서 "목표 추가 및 편집" 버튼을 탭하세요.
2. 목표, 결과, 장애물, 계획을 차례로 입력하세요.
3. 마감일과 반복 요일을 선택하세요.
4. "저장" 버튼을 눌러 목표를 추가하세요.`,usage_ai_title:"Gemini AI 기능 사용하기",usage_ai_desc:`• 목표 작성 시 "요약보기" 버튼으로 Gemini AI의 개선된 목표를 받아보세요.
• 목표 목록에서 "우선순위 정렬" 버튼으로 중요도 순 정렬이 가능합니다.
• Gemini AI 분석을 통해 더 효과적인 목표 설정을 도와드립니다.

※ Gemini AI 기능 사용을 위해서는 API 키 설정이 필요합니다.`,usage_ai_setup_title:"Gemini AI 설정하기",usage_ai_setup_desc:`1. 설정 > 일반에서 "Gemini AI 설정" 항목을 찾으세요.
2. Google Gemini API 키를 입력하세요.
3. API 키 발급 방법은 다음 Google 지원 문서를 참조하세요:
   https://ai.google.dev/gemini-api/docs/api-key
4. 키 입력 후 Gemini AI 기능이 활성화됩니다.`,usage_share_title:"목표 공유하기",usage_share_desc:`1. 설정 > 공유에서 "목표 링크 생성" 버튼을 탭하세요.
2. 자동으로 생성된 단축 링크를 확인하세요.
3. "링크 복사" 버튼으로 클립보드에 복사하세요.
4. 메신저나 이메일로 링크를 공유하세요.`,usage_theme_title:"테마 변경하기",usage_theme_desc:`1. 설정 > 모양에서 다크 모드 토글을 사용하세요.
2. 배경 테마에서 원하는 색상을 선택하세요.
3. 기본, 핑크, 블루, 그린, 퍼플 테마 중 선택 가능합니다.
4. 변경 사항은 즉시 적용됩니다.`,usage_calendar_title:"캘린더 보기 사용하기",usage_calendar_desc:`1. 하단 탭에서 캘린더 아이콘을 탭하세요.
2. 3일/주간/월간 보기를 선택할 수 있습니다.
3. 날짜를 탭하여 해당 날의 목표를 확인하세요.
4. 좌우 화살표로 날짜를 이동할 수 있습니다.`,usage_offline_title:"오프라인 모드 사용하기",usage_offline_desc:`1. 설정 > 일반에서 "오프라인 모드" 토글을 켜세요.
2. API 키 없이도 목표 추가, 편집, 삭제가 가능합니다.
3. AI 기능은 사용할 수 없지만 모든 기본 기능은 정상 작동합니다.
4. 데이터는 브라우저에 안전하게 저장됩니다.`,goal_assistant_title:"새로운 목표",goal_assistant_mode_woop:"WOOP",goal_assistant_mode_automation:"장기 계획",automation_title:"장기 목표 만들기",automation_base_name_label:"목표 이름",automation_base_name_placeholder:"예: 영어 단어 학습",automation_total_units_label:"총 분량",automation_total_units_placeholder:"예: 30",automation_units_per_day_label:"일일 분량",automation_period_label:"기간",automation_start_date_label:"시작일",automation_end_date_label:"종료일",automation_generate_button:"{count}개 생성",automation_error_all_fields:"모든 필드를 올바르게 입력해주세요.",automation_error_start_after_end:"시작일은 종료일보다 빨라야 합니다.",automation_error_short_period:"기간이 너무 짧습니다. (1일 이상)",next_button:"다음",back_button:"이전",wish_tip:"측정 가능하고 구체적인, 도전적이면서도 현실적인 목표를 설정하세요.",wish_example:"예: 3개월 안에 5kg 감량하기, 이번 학기에 A+ 받기",outcome_tip:"목표 달성 시 얻게 될 가장 긍정적인 결과를 생생하게 상상해 보세요.",outcome_example:"예: 더 건강하고 자신감 있는 모습, 성적 장학금 수령",obstacle_tip:"목표 달성을 방해할 수 있는 내면의 장애물(습관, 감정 등)은 무엇인가요?",obstacle_example:"예: 퇴근 후 피곤해서 운동 가기 싫은 마음, 어려운 과제를 미루는 습관",plan_tip:"'만약 ~라면, ~하겠다' 형식으로 장애물에 대한 구체적인 대응 계획을 세워보세요.",plan_example:"예: 만약 퇴근 후 운동 가기 싫다면, 일단 운동복으로 갈아입고 10분만 스트레칭한다.",recurrence_label:"반복",recurrence_tip:"정해진 요일에 꾸준히 해야 하는 목표인가요? 반복으로 설정하여 연속 달성을 기록해 보세요.",recurrence_example:"예: 매주 월,수,금 헬스장 가기",recurrence_option_daily:"반복 목표",deadline_tip:"현실적인 마감일을 설정하여 동기를 부여하세요. 마감일이 없는 장기 목표도 좋습니다.",deadline_option_no_deadline:"마감일 없음",day_names_short_picker:["월","화","수","목","금","토","일"],settings_delete_account:"모든 데이터 삭제",delete_account_header:"데이터 삭제",delete_account_header_desc:"이 작업은 되돌릴 수 없으며, 모든 목표와 데이터가 영구적으로 삭제됩니다.",version_update_title:"새로운 기능",version_update_1_title:"Firebase 클라우드 동기화",version_update_1_desc:"Google 로그인으로 목표와 설정값을 클라우드에 저장하고 불러올 수 있습니다. 목표는 같은 Google 계정으로 로그인된 여러 기기에서 동기화됩니다.",version_update_2_title:"자동 설정 동기화",version_update_2_desc:"언어, 테마, 배경 색상 등 모든 설정값이 클라우드에 저장되어 다른 기기에서도 동일하게 적용됩니다.",version_update_3_title:"안전한 로그아웃",version_update_3_desc:"로그아웃 시 모든 데이터가 클라우드에 저장되고, 로컬 데이터는 완전히 삭제되며 홈으로 이동합니다.",version_update_4_title:"상태 표시 UI",version_update_4_desc:"로그인, 로그아웃, 동기화 등의 작업 중 버튼 상태가 변화하여 진행 상황을 명확히 보여줍니다."},en:{language_selection_title:"Language",error_wish_required:"Please enter your wish.",error_outcome_required:"Please enter the outcome.",error_obstacle_required:"Please enter the obstacle.",error_plan_required:"Please enter your If-Then plan.",error_deadline_required:"Please select a deadline.",error_day_required:"Please select at least one day.",my_goals_title:"My Goals",all_goals_label:"나의 목표",sort_label_manual:"Manual",sort_label_deadline:"Deadline",sort_label_newest:"Newest",sort_label_alphabetical:"Alphabetical",sort_label_ai:"Priority Order",ai_sorting_button:"Sorting...",add_new_goal_button_label:"Add New Goal",filter_all:"나의 목표",filter_active:"In Progress",filter_completed:"Completed",filter_category:"Category",category_all:"All Categories",category_school:"School",category_work:"Work",category_personal:"Personal",category_other:"Other",category_label:"Select Category",empty_message_all:"Add a goal with the + button",empty_message_active:"No goals in progress.",empty_message_completed:"No completed goals yet.",empty_encouragement_1:"Take the first step toward something amazing.",empty_encouragement_2:"Small changes lead to big achievements.",empty_encouragement_3:"What you do today shapes tomorrow.",empty_encouragement_4:"Your goals are waiting to become reality.",delete_button:"Delete",edit_button_aria:"Edit Goal",info_button_aria:"Details",filter_title:"Filter",sort_title:"Sort",filter_sort_button_aria:"Filter and Sort",calendar_view_button_aria:"Calendar View",list_view_button_aria:"List View",more_options_button_aria:"More",select_button_label:"Select",cancel_selection_button_label:"Cancel",delete_selected_button_label:"Delete {count}",select_all_button_label:"Select All",delete_selected_confirm_title:"Delete Goals",delete_selected_confirm_message:"The {count} selected goals will be permanently deleted.",days_left:"{count} days left",d_day:"D-DAY",days_overdue:"{count} days overdue",month_names:["January","February","March","April","May","June","July","August","September","October","November","December"],day_names_short:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],day_names_long:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],calendar_header_month_format:"{month} {year}",calendar_view_day3:"3-Day",calendar_view_week:"Week",calendar_view_month:"Month",settings_title:"Settings",sort_alert_title:"Unable to Sort",sort_alert_message:"Add at least two goals to use priority order.",ai_sort_error_title:"Unable to Sort",ai_sort_error_message:"Cannot connect to server. Please try again later.",confirm_button:"OK",new_goal_modal_title:"New Goal",edit_goal_modal_title:"Edit Goal",wish_label:"Wish",outcome_label:"Outcome",obstacle_label:"Obstacle",plan_label:"If-Then Plan",deadline_label:"Deadline",cancel_button:"Cancel",add_button:"Add",save_button:"Save",goal_details_modal_title:"Goal Details",ai_coach_suggestion:"View Summary",ai_analyzing:"Analyzing...",close_button:"Close",ai_sort_reason_modal_title:"Sort Reason",ai_sort_criteria:"🤖 Sort Criteria",delete_account_final_confirm_title:"Delete All Data",delete_account_final_confirm_message:"All your goals and data will be permanently deleted. This action cannot be undone.",delete_all_data_button:"Delete All Data",settings_done_button:"Done",settings_section_data:"Data Management",settings_export_data:"Export",settings_import_data:"Import",import_confirm_title:"Import Data",import_confirm_message:"This will replace your current goals with new data. This action cannot be undone.",import_success_toast:"Data imported successfully.",import_error_alert_title:"Import Failed",import_error_alert_message:"There was an error reading the file, or the file format is incorrect.",settings_section_general:"General",settings_section_info:"Information",settings_section_help:"How to Use",settings_theme_mode:"Theme Mode",theme_mode_light:"Light Mode",theme_mode_light_desc:"Use bright theme",theme_mode_dark:"Dark Mode",theme_mode_dark_desc:"Use dark theme",theme_mode_system:"Follow System Settings",theme_mode_system_desc:"Automatically adjust to device settings",settings_dark_mode:"Dark Mode",settings_language:"Language",settings_api_key:"Gemini AI Setup",settings_api_key_placeholder:"Enter Gemini API key",settings_offline_mode:"Offline Mode",settings_offline_mode_desc:"Use basic features without AI",settings_notifications:"Notifications",settings_notifications_desc:"PWA notification settings",notification_settings_title:"What notifications would you like?",notification_deadline:"Deadline Alerts",notification_deadline_desc:"Get notified when deadlines are approaching.",notification_suggestion:"Today's Suggestions",notification_suggestion_desc:"Get suggestions on what to do today.",notification_achievement:"Achievement Celebration",notification_achievement_desc:"Celebrate when you achieve a goal.",notification_reminder:"General Reminder",notification_reminder_desc:"Get reminded at scheduled times.",reminder_time_settings_title:"Reminder Time Settings",reminder_start_time:"Start Time",reminder_end_time:"End Time",reminder_add_title:"Add Reminder",reminder_step_title:"Step {step}/5",reminder_step1_title:"🔔 Title",reminder_step1_desc:"Enter the reminder title",reminder_step2_title:"📅 Date & ⏰ Time",reminder_step2_desc:"Set the reminder date and time (optional)",reminder_step2_date_toggle:"Set Date",reminder_step2_time_toggle:"Set Time",reminder_step3_title:"🔄 Recurring",reminder_step3_desc:"Choose recurrence settings",reminder_step3_enable_recurring:"Enable Recurring",reminder_step4_title:"📝 Description",reminder_step4_desc:"Add optional description",reminder_step5_title:"✅ Enable",reminder_step5_desc:"Choose whether to enable reminder",reminder_next_button:"Next",reminder_back_button:"Back",reminder_submit_button:"Add",reminder_form_title:"Title",reminder_form_date:"Date",reminder_form_time:"Time",reminder_form_recurring:"Recurring",reminder_form_description:"Description",reminder_form_enabled:"Enabled",recurring_type_none:"No Recurrence",recurring_type_daily:"Daily",recurring_type_weekly:"Weekly",recurring_type_monthly:"Monthly",language_name:"English (US)",language_modal_title:"Language",settings_section_background:"Appearance",settings_share_link_header:"Share via Link",settings_generate_link:"Generate Share Link",settings_bg_default:"Light",settings_bg_default_dark:"Dark",settings_bg_pink:"Pink",settings_bg_cherry_noir:"Cherry Noir",settings_bg_blue:"Blue",settings_bg_deep_ocean:"Ocean",settings_bg_green:"Green",settings_bg_forest_green:"Forest",settings_bg_purple:"Purple",settings_bg_royal_purple:"Royal Purple",settings_section_account:"Nova Beta Account",settings_sync_data:"Sync Data",settings_load_data:"Load Data",settings_logout:"Sign Out",settings_delete_account:"Delete All Data",delete_account_header:"Delete Data",delete_account_header_desc:"This action is irreversible and will permanently delete all your goals and data.",data_deleting:"Deleting...",settings_version:"Version",test_long_alert:"Test Long Alert",test_long_alert_desc:"Test alert popup with long content",settings_developer:"Developer",developer_name:"GimGyuMin",settings_copyright:"Copyright",copyright_notice:"© 2025 GimGyuMin. All Rights Reserved.",build_number:"Build Number",settings_data_header:"Data Management",settings_data_header_desc:"Export or import your goal data.",settings_background_header:"Background",settings_background_header_desc:"Change the app's background style to express your personality.",data_importing:"Importing...",data_exporting:"Exporting..."}},Ee={add:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[m.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),m.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),refresh:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[m.jsx("polyline",{points:"23 4 23 10 17 10"}),m.jsx("path",{d:"M1 20v-6h6"}),m.jsx("path",{d:"M3.51 9a9 9 0 0 1 14.13-3.36L23 10M1 14l5.36 5.36A9 9 0 0 0 20.49 15"})]}),check:m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:m.jsx("polyline",{points:"20 6 9 17 4 12"})}),info:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[m.jsx("circle",{cx:"12",cy:"12",r:"10"}),m.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),m.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),delete:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[m.jsx("polyline",{points:"3 6 5 6 21 6"}),m.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}),m.jsx("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),m.jsx("line",{x1:"14",y1:"11",x2:"14",y2:"17"})]}),edit:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[m.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),m.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),close:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[m.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),m.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}),back:m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:m.jsx("polyline",{points:"15 18 9 12 15 6"})}),forward:m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:m.jsx("polyline",{points:"9 18 15 12 9 6"})}),calendar:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[m.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),m.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),m.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),m.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),list:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[m.jsx("line",{x1:"8",y1:"6",x2:"21",y2:"6"}),m.jsx("line",{x1:"8",y1:"12",x2:"21",y2:"12"}),m.jsx("line",{x1:"8",y1:"18",x2:"21",y2:"18"}),m.jsx("line",{x1:"3",y1:"6",x2:"3.01",y2:"6"}),m.jsx("line",{x1:"3",y1:"12",x2:"3.01",y2:"12"}),m.jsx("line",{x1:"3",y1:"18",x2:"3.01",y2:"18"})]}),settings:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[m.jsx("circle",{cx:"12",cy:"12",r:"3"}),m.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]}),filter:m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:m.jsx("polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"})}),ai:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[m.jsx("path",{d:"M12 3L14.34 8.66L20 11L14.34 13.34L12 19L9.66 13.34L4 11L9.66 8.66L12 3Z"}),m.jsx("path",{d:"M5 21L7 16"}),m.jsx("path",{d:"M19 21L17 16"})]}),flame:m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:m.jsx("path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"})}),data:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[m.jsx("path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83"}),m.jsx("path",{d:"M22 12A10 10 0 0 0 12 2v10z"})]}),background:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[m.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),m.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),m.jsx("polyline",{points:"21 15 16 10 5 21"})]}),exclamation:m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:m.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 15c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1zm1-4h-2V7h2v6z"})})},ou=(t,e)=>{const n=new Date(t),r=new Date(e);return n.getFullYear()===r.getFullYear()&&n.getMonth()===r.getMonth()&&n.getDate()===r.getDate()},D3=(t,e)=>{if(!t)return null;const n=new Date;n.setHours(0,0,0,0);const r=new Date(t);r.setHours(0,0,0,0);const i=r.getTime()-n.getTime(),s=Math.ceil(i/(1e3*60*60*24));return s===0?e("d_day"):s>0?e("days_left").replace("{count}",String(s)):e("days_overdue").replace("{count}",String(Math.abs(s)))},KI=(t,e=1)=>{const n=new Date(t),r=n.getDay(),i=(r<e?7:0)+r-e;return n.setDate(n.getDate()-i),n.setHours(0,0,0,0),n},ig=t=>{try{const e=new TextEncoder().encode(t),n=Array.from(e).map(r=>String.fromCharCode(r)).join("");return btoa(n)}catch(e){return console.error("UTF-8 to Base64 encoding failed:",e),""}},jI=t=>{try{const e=atob(t),n=new Uint8Array(e.length);for(let r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return new TextDecoder().decode(n)}catch(e){return console.error("Base64 to UTF-8 decoding failed:",e),""}},JI=t=>{try{const n=JSON.stringify(t).replace(/\s+/g," ").trim();return ig(n)}catch(e){return console.error("Data compression failed:",e),ig(JSON.stringify(t))}},rR=async t=>{if(t.length<1500)return t;const e=[{name:"is.gd",createUrl:async n=>{const r=await fetch(`https://is.gd/create.php?format=simple&url=${encodeURIComponent(n)}`);if(!r.ok)throw new Error("is.gd API failed");const i=await r.text();if(i.includes("Error")||!i.startsWith("http"))throw new Error("Invalid response from is.gd");return i.trim()}},{name:"tinyurl",createUrl:async n=>new Promise((r,i)=>{const s=`tinyurl_${Date.now()}`,o=document.createElement("script"),a=setTimeout(()=>{l(),i(new Error("TinyURL timeout"))},5e3),l=()=>{clearTimeout(a),o.parentNode&&document.head.removeChild(o),delete window[s]};window[s]=u=>{l(),u&&typeof u=="string"&&!u.includes("Error")&&u.startsWith("http")?r(u.trim()):i(new Error("Invalid TinyURL response"))},o.onerror=()=>{l(),i(new Error("TinyURL script load failed"))},o.src=`https://tinyurl.com/api-create.php?url=${encodeURIComponent(n)}&callback=${s}`,document.head.appendChild(o)})},{name:"v.gd",createUrl:async n=>{const r=await fetch(`https://v.gd/create.php?format=simple&url=${encodeURIComponent(n)}`);if(!r.ok)throw new Error("v.gd API failed");const i=await r.text();if(i.includes("Error")||!i.startsWith("http"))throw new Error("Invalid response from v.gd");return i.trim()}}];for(const n of e)try{console.log(`Trying ${n.name} for URL shortening...`);const r=await n.createUrl(t);return console.log(`✅ ${n.name} success:`,r),r}catch(r){console.warn(`❌ ${n.name} failed:`,r);continue}return console.warn("All URL shortening services failed, using original URL"),t},sg=[{id:"default",lightThemeClass:"bg-solid-default",darkThemeClass:"bg-solid-default",lightNameKey:"settings_bg_default",darkNameKey:"settings_bg_default_dark"},{id:"pink",lightThemeClass:"bg-solid-pink",darkThemeClass:"bg-solid-pink",lightNameKey:"settings_bg_pink",darkNameKey:"settings_bg_cherry_noir"},{id:"blue",lightThemeClass:"bg-solid-blue",darkThemeClass:"bg-solid-blue",lightNameKey:"settings_bg_blue",darkNameKey:"settings_bg_deep_ocean"},{id:"green",lightThemeClass:"bg-solid-green",darkThemeClass:"bg-solid-green",lightNameKey:"settings_bg_green",darkNameKey:"settings_bg_forest_green"},{id:"purple",lightThemeClass:"bg-solid-purple",darkThemeClass:"bg-solid-purple",lightNameKey:"settings_bg_purple",darkNameKey:"settings_bg_royal_purple"}],b3=()=>{const[t,e]=z.useState(!1);z.useRef(null);const[n,r]=z.useState("ko"),[i,s]=z.useState([]),[o,a]=z.useState([]),[l,u]=z.useState(null),[f,p]=z.useState("all"),[g,v]=z.useState("all"),[E,x]=z.useState("manual"),[b,C]=z.useState(["school","work","personal","other"]),[I,S]=z.useState(()=>$I()==="dark"),[V,U]=z.useState("system"),[B,T]=z.useState("default"),[w,A]=z.useState([]),[k,D]=z.useState({}),[L,N]=z.useState([]),[Ve,Ze]=z.useState(!1),[je,ye]=z.useState(!1),[Z,he]=z.useState(null),[ve,Ie]=z.useState(!1),[Oe,tt]=z.useState(null),[Je,Se]=z.useState(""),[Qe,Gt]=z.useState(""),[ur,zn]=z.useState("editor"),[kn,cr]=z.useState(!1),[dr,$n]=z.useState(null),[hr,Re]=z.useState(!1),[zt,Fe]=z.useState(!1),[yn,ot]=z.useState(!1),[ze,Te]=z.useState(null),[cc,go]=z.useState(!1),[ls,fr]=z.useState(new Set),[us,ke]=z.useState(""),[el,ai]=z.useState("idle"),[tl,_o]=z.useState(!1),[nl,li]=z.useState(!1),[rl,il]=z.useState(""),[pr,yo]=z.useState(!1),[Hn,cs]=z.useState(void 0),[ds,sl]=z.useState(!1),[gt,hs]=z.useState(""),[Wn,fs]=z.useState(!1),[vo,yf]=z.useState(!0),[Q,ol]=z.useState(null),[cy,al]=z.useState(""),[vf,Tf]=z.useState(!1),[ll,Dr]=z.useState(!1),[Ef,Nn]=z.useState(!1),[To,cn]=z.useState(!1),[ul,Eo]=z.useState(!1),[Io,If]=z.useState(!0);z.useEffect(()=>{let R=null,M=null,O=null;const F=GL(vi,async H=>{if(ol(H),If(!1),H){console.log("🔑 사용자 로그인 감지 - Firebase 데이터 로드 시작"),await br(H),console.log("📡 실시간 데이터 동기화 리스너 설정 중...");let Y=null,J=null;const X=Le(me,"users",H.uid,"data","todos");R=Fr(X,ne=>{Y&&clearTimeout(Y),Y=setTimeout(()=>{if(ne.exists()){const fe=ne.data().todos||[];s(de=>{const ae=de.filter(nt=>nt.isSharedTodo===!0),pe=fe.map(nt=>({...nt,isSharedTodo:!1}));return JSON.stringify(de.filter(nt=>!nt.isSharedTodo))!==JSON.stringify(pe)?(console.log("🔄 개인 목표 데이터 실시간 업데이트:",pe.length,"공유 목표 보존:",ae.length),[...pe,...ae]):de})}},2e3)});const K=at(me,"users",H.uid,"folders");M=Fr(K,async ne=>{J&&clearTimeout(J),J=setTimeout(async()=>{const W=[];ne.forEach(de=>{const ae=de.data(),pe={id:de.id,add:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[m.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),m.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),name:ae.name||"이름 없는 폴더",color:ae.color||"#007AFF",createdAt:ae.createdAt||new Date().toISOString(),updatedAt:ae.updatedAt||new Date().toISOString(),...ae,collaborators:ae.collaborators||[],ownerId:ae.ownerId||H.uid};W.push(pe)});const fe=W.filter(de=>de.isShared&&de.ownerId&&de.ownerId!==H.uid);if(fe.length>0){console.log("📡 공유 폴더 실시간 동기화 설정:",fe.map(ae=>({id:ae.id,name:ae.name,ownerId:ae.ownerId}))),O&&O();const de=[];for(const ae of fe)if(ae.ownerId)try{const pe=Le(me,"users",ae.ownerId,"folders",ae.id),Ne=Fr(pe,Kn=>{if(Kn.exists()){const Zt=Kn.data();console.log("🔄 공유 폴더 정보 실시간 업데이트:",{folderId:ae.id,name:Zt.name,color:Zt.color}),a(jn=>jn.map(en=>en.id===ae.id?{...en,name:Zt.name||en.name||"공유 폴더",color:Zt.color||en.color,updatedAt:Zt.updatedAt||en.updatedAt}:en))}},Kn=>{console.error("❌ 공유 폴더 정보 동기화 오류:",Kn)});de.push(Ne);const nt=at(me,"users",ae.ownerId,"todos"),Dn=Fl(nt,Ul("folderId","==",ae.id));let _r=null;const pl=Fr(Dn,Kn=>{_r&&clearTimeout(_r),_r=setTimeout(()=>{const Zt=[];Kn.forEach(jn=>{const en=jn.data();Zt.push({id:parseInt(jn.id),...en,isSharedTodo:!0})}),console.log("🔄 공유 폴더 목표 실시간 업데이트:",{folderId:ae.id,count:Zt.length}),s(jn=>{const en=jn.filter(Is=>!(Is.folderId===ae.id&&Is.isSharedTodo===!0)),Po=Zt.filter(Is=>!en.some(No=>No.id===Is.id)),ko=[...en,...Po];return console.log("📊 목표 병합 결과:",{기존총개수:jn.length,제외된공유목표:jn.length-en.length,중복제거후새목표:Po.length,최종총개수:ko.length}),ko})},1500)},Kn=>{console.warn("⚠️ 공유 폴더 실시간 동기화 오류:",{folderId:ae.id,error:Kn.code})});de.push(pl)}catch(pe){console.warn("⚠️ 공유 폴더 리스너 설정 실패:",{folderId:ae.id,error:pe})}O=()=>{de.forEach(ae=>ae())}}a(de=>JSON.stringify(de)!==JSON.stringify(W)?(console.log("🔄 폴더 데이터 실시간 업데이트:",W.map(pe=>({id:pe.id,name:pe.name}))),W):de)},3e3)})}else console.log("🚪 사용자 로그아웃 감지 - 데이터 초기화"),R&&(R(),R=null),M&&(M(),M=null),O&&(O(),O=null),s([]),a([]),r("ko"),U("system"),T("default"),hs(""),C(["school","work","personal","other"])});return()=>{F(),R&&R(),M&&M(),O&&O()}},[]);const dc=z.useCallback(()=>{console.log("🔍 Firebase 진단 시작..."),console.log("Firebase Auth:",vi),console.log("Firebase DB:",me),console.log("Google Provider:",js),console.log("환경 변수 확인:"),console.log("- VITE_FIREBASE_API_KEY:","✅ 설정됨"),console.log("- VITE_FIREBASE_AUTH_DOMAIN:","✅ 설정됨"),console.log("- VITE_FIREBASE_PROJECT_ID:","✅ 설정됨"),console.log("브라우저 정보:"),console.log("- User Agent:",navigator.userAgent),console.log("- 쿠키 활성화:",navigator.cookieEnabled),console.log("- 로컬 스토리지 지원:",typeof Storage<"u"),console.log("네트워크 상태:",navigator.onLine?"✅ 온라인":"❌ 오프라인")},[]),cl=z.useCallback(async()=>{Dr(!0);try{console.log("🔄 Google 로그인 시작..."),console.log("Auth 상태:",vi),console.log("Google Provider 설정:",js);const R=window.open("","_blank","width=1,height=1");if(!R||R.closed||typeof R.closed>"u")throw new Error("팝업이 차단되었습니다. 브라우저 설정에서 팝업을 허용해주세요.");R.close(),console.log("🔄 signInWithPopup 호출 중...");const M=await aF(vi,js);console.log("✅ 로그인 성공:",M.user.email),ol(M.user),ke("✅ Google 로그인 성공!"),setTimeout(async()=>{var O;try{console.log("📥 사용자 데이터 로딩 시작...");const{doc:F,getDoc:H}=await Cs(async()=>{const{doc:ne,getDoc:W}=await Promise.resolve().then(()=>xs);return{doc:ne,getDoc:W}},void 0),Y=F(me,"users",M.user.uid,"data","todos"),J=await H(Y);if(J.exists()){const ne=J.data();s(ne.todos||[]),console.log("📥 목표 데이터 로드 완료:",((O=ne.todos)==null?void 0:O.length)||0)}else console.log("📝 새 사용자 - 빈 목표 목록으로 시작"),s([]);const X=F(me,"users",M.user.uid,"data","settings"),K=await H(X);if(K.exists()){const ne=K.data();ne.language&&r(ne.language),ne.themeMode&&U(ne.themeMode),ne.isDarkMode!==void 0&&S(ne.isDarkMode),ne.backgroundTheme&&T(ne.backgroundTheme),ne.apiKey&&hs(ne.apiKey)}ke("✅ 로그인 완료! 데이터 로드됨")}catch(F){console.error("데이터 로드 실패:",F),ke("⚠️ 로그인은 성공했으나 데이터 로드 실패")}Dr(!1),setTimeout(()=>ke(""),3e3)},500),setTimeout(()=>ke(""),3e3)}catch(R){console.error("❌ Google 로그인 오류:",R),console.error("오류 코드:",R.code),console.error("오류 메시지:",R.message);let M="로그인 중 오류가 발생했습니다.";switch(R.code){case"auth/popup-closed-by-user":M="로그인이 취소되었습니다.";break;case"auth/popup-blocked":M="팝업이 차단되었습니다. 브라우저 설정에서 팝업을 허용해주세요.";break;case"auth/cancelled-popup-request":M="다른 로그인 요청이 진행 중입니다.";break;case"auth/network-request-failed":M="네트워크 연결을 확인해주세요.";break;case"auth/too-many-requests":M="너무 많은 요청이 발생했습니다. 잠시 후 다시 시도해주세요.";break;case"auth/user-disabled":M="계정이 비활성화되었습니다.";break;case"auth/operation-not-allowed":M="Google 로그인이 활성화되지 않았습니다. 관리자에게 문의하세요.";break;default:M=`로그인 실패: ${R.message}`}R.code!=="auth/popup-closed-by-user"&&Te({title:"로그인 실패",message:M,confirmText:"확인",onConfirm:()=>Te(null)}),Dr(!1)}},[]),wo=(R,M)=>{if(R===null)return;const O=o.map(F=>F.id===R?{...F,collaborators:M}:F);a(O),Hn&&Hn.id===R&&cs({...Hn,collaborators:M}),ke("✅ 폴더 협업자가 업데이트되었습니다"),setTimeout(()=>ke(""),3e3)},hc=z.useCallback(async()=>{Nn(!0);try{if(Q){ke("⏳ 데이터 저장 중...");const R=i.filter(ne=>ne!=null),{doc:M,setDoc:O,serverTimestamp:F}=await Cs(async()=>{const{doc:ne,setDoc:W,serverTimestamp:fe}=await Promise.resolve().then(()=>xs);return{doc:ne,setDoc:W,serverTimestamp:fe}},void 0),H=R.map(ne=>Vt(ne)).filter(ne=>ne!==void 0),Y=M(me,"users",Q.uid,"data","todos"),J={todos:H,lastSyncTime:F(),totalGoals:H.length,syncedAt:new Date().toISOString()},X=Vt(J);X?(await O(Y,X),console.log("✅ Todos Firestore 저장 완료:",{count:H.length})):console.error("❌ Todos 데이터 정제 실패");const K=M(me,"users",Q.uid,"data","settings");await O(K,{language:n,themeMode:V,isDarkMode:I,backgroundTheme:B,updatedAt:F()})}await dE(vi),ol(null),s([]),r("ko"),T("default"),U("system"),S($I()==="dark"),he(null),Re(!1),ye(!1),ke("✅ 로그아웃 완료"),setTimeout(()=>ke(""),3e3),Nn(!1)}catch(R){console.error("로그아웃 오류:",R),Te({title:"로그아웃 실패",message:"로그아웃 중 오류가 발생했습니다.",confirmText:"확인",onConfirm:()=>Te(null)}),Nn(!1)}},[Q,i,n,V,I,B]),ui=z.useCallback(async()=>{if(!Q){Te({title:"로그인 필요",message:"먼저 로그인해주세요",confirmText:"확인",onConfirm:()=>Te(null)});return}cn(!0);try{const R=i.filter(W=>W!=null),{doc:M,setDoc:O,serverTimestamp:F}=await Cs(async()=>{const{doc:W,setDoc:fe,serverTimestamp:de}=await Promise.resolve().then(()=>xs);return{doc:W,setDoc:fe,serverTimestamp:de}},void 0),H=R.map(W=>Vt(W)).filter(W=>W!==void 0),Y=M(me,"users",Q.uid,"data","todos"),J={todos:H,lastSyncTime:F(),totalGoals:H.length,syncedAt:new Date().toISOString()},X=Vt(J);if(X)await O(Y,X),console.log("✅ 백업 Todos Firestore 저장 완료:",{count:H.length});else throw new Error("Todos 데이터 정제 실패");const K=M(me,"users",Q.uid,"data","settings"),ne={language:n,themeMode:V,isDarkMode:I,backgroundTheme:B,apiKey:gt,userCategories:b,updatedAt:F()};await O(K,ne);for(const W of o)try{const fe=M(me,"users",Q.uid,"folders",W.id),de={...W,ownerId:W.ownerId||Q.uid,collaborators:W.collaborators||[],updatedAt:F()};await O(fe,de),console.log(`✅ 폴더 ${W.id} 동기화 완료`)}catch(fe){console.error(`❌ 폴더 ${W.id} 동기화 실패:`,fe)}cn(!1)}catch(R){console.error("동기화 오류:",R),Te({title:"동기화 실패",message:R.message||"데이터 동기화 중 오류가 발생했습니다.",confirmText:"확인",onConfirm:()=>Te(null)}),cn(!1)}},[Q,i,n,V,I,B,gt]),br=z.useCallback(async R=>{var M;try{const{doc:O,getDoc:F,collection:H,getDocs:Y}=await Cs(async()=>{const{doc:W,getDoc:fe,collection:de,getDocs:ae}=await Promise.resolve().then(()=>xs);return{doc:W,getDoc:fe,collection:de,getDocs:ae}},void 0),J=O(me,"users",R.uid,"data","todos"),X=await F(J);if(X.exists()){const fe=X.data().todos||[];s(de=>{const ae=new Set(de.map(nt=>nt.id)),pe=fe.filter(nt=>!ae.has(nt.id)),Ne=[...de,...pe];return console.log("🔄 목표 데이터 병합:",{기존:de.length,로드됨:fe.length,새로추가:pe.length,전체:Ne.length}),Ne})}const K=O(me,"users",R.uid,"data","settings"),ne=await F(K);if(ne.exists()){const W=ne.data();W.language&&r(W.language),W.themeMode&&U(W.themeMode),W.isDarkMode!==void 0&&S(W.isDarkMode),W.backgroundTheme&&T(W.backgroundTheme),W.apiKey&&hs(W.apiKey),W.userCategories&&C(W.userCategories)}try{const W=H(me,"users",R.uid,"folders"),fe=await Y(W),de=[];fe.forEach(ae=>{const pe=ae.data(),Ne={id:ae.id,...pe,collaborators:pe.collaborators||[],ownerId:pe.ownerId||R.uid};de.push(Ne)}),a(ae=>{const pe=new Set(ae.map(Dn=>Dn.id)),Ne=de.filter(Dn=>!pe.has(Dn.id)),nt=[...ae,...Ne];return console.log("🔄 폴더 데이터 병합:",{기존:ae.length,로드됨:de.length,새로추가:Ne.length,전체:nt.length}),nt}),console.log("✅ 폴더 로드 완료:",{count:de.length})}catch(W){console.warn("⚠️ 폴더 로드 실패, 빈 배열로 설정:",W)}console.log("✅ 클라우드 데이터 로드 완료:",{todos:X.exists()&&((M=X.data().todos)==null?void 0:M.length)||0,folders:"로드됨",settings:ne.exists()?"로드됨":"없음"})}catch(O){console.error("❌ 클라우드 데이터 로드 실패:",O)}},[]),Mr=z.useCallback(async()=>{if(!Q){Te({title:"로그인 필요",message:"먼저 로그인해주세요",confirmText:"확인",onConfirm:()=>Te(null)});return}Eo(!0);try{await br(Q),ke("✅ 클라우드 데이터 로드 완료!")}catch(R){console.error("로드 오류:",R),Te({title:"로드 실패",message:R.message||"데이터 로드 중 오류가 발생했습니다.",confirmText:"확인",onConfirm:()=>Te(null)})}finally{Eo(!1)}},[Q,br]),oe=z.useCallback(R=>N3[n][R]||R,[n]),So=z.useCallback(R=>{const M=R||gt;if(Wn||!M)return null;try{return new y2({apiKey:M})}catch(O){return console.error("Failed to create AI instance:",O),null}},[gt,Wn]),fc=z.useCallback(R=>{U(R)},[]),Co=z.useMemo(()=>[oe("empty_encouragement_1"),oe("empty_encouragement_2"),oe("empty_encouragement_3"),oe("empty_encouragement_4")],[oe]),pc=z.useMemo(()=>Co[Math.floor(Math.random()*Co.length)],[Co]);z.useEffect(()=>{console.log("🚀 클라우드 기반 앱 시작 - localStorage 사용 안 함")},[]),z.useEffect(()=>{(()=>{a(M=>{const O=M.filter(F=>{if(!F.collaborators||F.collaborators.length===0)return!0;const H=F.collaborators.find(Y=>Y.role==="owner");return!H||!H.userId||H.userId.startsWith("owner_")?(console.warn("🗑️ 잘못된 공유 폴더 제거:",F.name,H==null?void 0:H.userId),!1):!0});return O.length!==M.length&&console.log("✅ 잘못된 공유 폴더 정리 완료:",{제거됨:M.length-O.length,남은폴더:O.length}),O})})()},[]),z.useEffect(()=>{if(Io)return;const R=async()=>{const M=new URLSearchParams(window.location.search),O=M.get("data"),F=M.get("folder_share");if(F){try{const H=jI(F),Y=JSON.parse(H);if(Y.type==="folder_share"&&Y.folderId){if(Y.password){const X=sessionStorage.getItem(`folder_${Y.folderId}_password`);if(!X||X!==Y.password){Te({title:"암호 입력",message:"이 폴더는 암호로 보호되어 있습니다. 암호를 입력하세요.",confirmText:"확인",cancelText:"취소",onConfirm:()=>{const K=prompt("폴더 암호를 입력하세요:");K===Y.password?(sessionStorage.setItem(`folder_${Y.folderId}_password`,K),Te(null),R()):K!==null&&Te({title:"암호 오류",message:"암호가 일치하지 않습니다.",confirmText:"확인",onConfirm:()=>{window.history.replaceState({},document.title,window.location.pathname)}})},onCancel:()=>{window.history.replaceState({},document.title,window.location.pathname)}});return}}if(o.some(X=>X.id===Y.folderId))window.history.replaceState({},document.title,window.location.pathname);else{if(Y.ownerId&&!Q&&!Io){Te({title:"로그인 필요",message:"이 공유 폴더는 소유자 기반 동기화를 위해 로그인이 필요합니다. 계속하려면 로그인하세요.",confirmText:"로그인",cancelText:"취소",onConfirm:async()=>{try{await cl()}catch(W){console.error("로그인 중 오류:",W)}},onCancel:()=>{window.history.replaceState({},document.title,window.location.pathname)}});return}const X=Y.ownerId||null;if(!X){console.error("❌ 공유 링크에 소유자 정보가 없습니다:",Y),Te({title:"❌ 공유 링크 오류",message:`공유 링크에 소유자 정보가 없습니다.
폴더 소유자에게 다시 공유 링크를 요청해주세요.`,confirmText:"확인",onConfirm:()=>{Te(null),window.history.replaceState({},document.title,window.location.pathname)}});return}const K={id:Y.folderId,name:Y.folderName,color:Y.folderColor||"#007AFF",ownerId:X,collaborators:[{userId:X,email:Y.sharedBy||"",role:"owner",addedAt:Y.sharedAt}],createdAt:Y.sharedAt,updatedAt:Y.sharedAt,isShared:!0};let ne=K;if(X&&Q)try{console.log("🔍 협업자 추가 시작:",{ownerUserId:X,googleUserUid:Q.uid});const W=at(me,"users",X,"folders"),fe=Le(W,Y.folderId),de=await ng(fe);if(console.log("📄 폴더 조회 결과:",{exists:de.exists()}),de.exists()){let ae=de.data().collaborators||[];console.log("👥 현재 협업자 목록:",ae);const pe=ae.some(Ne=>Ne.userId===Q.uid);if(console.log("🔎 협업자 여부:",{isCollaborator:pe}),pe)console.log("ℹ️ 이미 협업자임");else{const Ne={userId:Q.uid,email:Q.email||"",role:"editor",addedAt:new Date().toISOString()};ae=[...ae,Ne],console.log("📝 새로운 협업자 목록:",ae);const nt=Vt(ae);nt?(await _t(fe,{collaborators:nt,updatedAt:new Date().toISOString()},{merge:!0}),console.log("✅ 협업자 Firestore 저장 완료:",Ne)):console.warn("⚠️ 협업자 정제 후 데이터가 없음")}ne={...K,collaborators:ae}}else console.warn("⚠️ 폴더가 존재하지 않음:",Y.folderId)}catch(W){console.error("❌ 협업자 목록 조회/추가 실패:",W)}else console.warn("⚠️ 협업자 추가 조건 미충족:",{ownerUserId:X,hasGoogleUser:!!Q});if(a([...o,ne]),Q)try{const{doc:W,setDoc:fe}=await Cs(async()=>{const{doc:ae,setDoc:pe}=await Promise.resolve().then(()=>xs);return{doc:ae,setDoc:pe}},void 0),de=W(me,"users",Q.uid,"folders",ne.id);await fe(de,{name:ne.name,color:ne.color,ownerId:ne.ownerId,createdAt:ne.createdAt,updatedAt:ne.updatedAt,isShared:ne.isShared,collaborators:ne.collaborators||[],collaborationSettings:ne.collaborationSettings||{enabled:!0,showPresence:!0,showEditingState:!0,enableConflictDetection:!0,allowGuestView:!1,requireApproval:!1}}),console.log("✅ 공유 폴더 Firebase 저장 완료:",ne.id)}catch(W){console.error("❌ 공유 폴더 Firebase 저장 실패:",W)}u(ne.id),Te({title:"공유 폴더 추가됨",message:`"${Y.folderName}" 폴더가 추가되었습니다. 잠시 후 목표들이 로드됩니다.`,confirmText:"확인",onConfirm:()=>{window.history.replaceState({},document.title,window.location.pathname)}})}}}catch(H){console.error("폴더 공유 데이터 파싱 실패:",H),window.history.replaceState({},document.title,window.location.pathname)}return}if(O)try{const H=jI(O),Y=JSON.parse(H);if(Array.isArray(Y)&&(Y.length===0||"wish"in Y[0]&&"id"in Y[0]))Te({title:oe("url_import_title"),message:oe("url_import_message"),confirmText:oe("url_import_confirm"),cancelText:oe("cancel_button"),onConfirm:()=>{s(Y),ke(oe("url_import_success")),window.history.replaceState({},document.title,window.location.pathname)},onCancel:()=>{window.history.replaceState({},document.title,window.location.pathname)}});else throw new Error("Invalid data format")}catch(H){console.error("Failed to parse data from URL",H),Te({title:oe("import_error_alert_title"),message:oe("url_import_error")}),window.history.replaceState({},document.title,window.location.pathname)}};R()},[oe,o,Q,cl,Io]),z.useEffect(()=>{if(!l||!Q)return;const R=o.find(K=>K.id===l);if(!R||!R.collaborators||R.collaborators.length===0)return;const M=R.collaborators.find(K=>K.role==="owner");if(!M)return;const O=M.userId;if(!O||O.startsWith("owner_")){console.warn("⚠️ Invalid owner UID:",M);return}const F=[],H=Le(me,"users",O,"folders",l),Y=Fr(H,K=>{if(K.exists()){const ne=K.data();ne.collaborators&&a(W=>W.map(fe=>fe.id===l?{...fe,collaborators:ne.collaborators}:fe))}},K=>{console.warn("⚠️ 공유 폴더 메타데이터 접근 오류 (협업자 목록 업데이트 안 됨):",K.code)});F.push(Y);const J=at(me,"users",O,"todos");console.log("📊 Syncing todos from owner:",{ownerUid:O,currentFolderId:l});const X=Fr(J,K=>{const ne=[];K.forEach(W=>{const fe=W.data();fe.folderId===l&&ne.push({id:parseInt(W.id),...fe})}),console.log("🎯 Owner todos received:",{count:ne.length,ownerTodos:ne}),s(W=>{const fe=W.filter(Ne=>Ne.folderId!==l),de=W.filter(Ne=>Ne.folderId===l),ae=[],pe=new Set;return ne.forEach(Ne=>{ae.push(Ne),pe.add(Ne.id)}),de.forEach(Ne=>{pe.has(Ne.id)||ae.push(Ne)}),[...fe,...ae]})},K=>{console.error("❌ 실시간 동기화 실패:",K),K.code==="permission-denied"?(console.warn("⚠️ 권한 부족으로 실시간 동기화 실패 - 수동 동기화를 사용하세요"),ke("⚠️ 실시간 동기화 실패 - 🔄 버튼으로 수동 동기화하세요")):K.code==="not-found"?(console.warn("⚠️ 폴더를 찾을 수 없음 - 폴더가 삭제되었을 수 있습니다"),ke("⚠️ 공유 폴더를 찾을 수 없습니다")):(console.warn("⚠️ 네트워크 오류로 실시간 동기화 실패"),ke("⚠️ 네트워크 오류 - 🔄 버튼으로 재시도하세요"))});return F.push(X),()=>{F.forEach(K=>K())}},[l,Q]),z.useEffect(()=>{var K,ne;if(!l||!Q)return;const R=o.find(W=>W.id===l),M=((K=R==null?void 0:R.collaborationSettings)==null?void 0:K.enabled)||(R==null?void 0:R.isShared)||!1,O=((ne=R==null?void 0:R.collaborationSettings)==null?void 0:ne.showPresence)??!0;if(!M||!O){A([]);return}console.log("👥 실시간 접속 상태 추적 시작:",{folderId:l,showPresence:O});const F=at(me,"folderPresence",l,"users"),H=Le(F,Q.uid);(async()=>{try{await _t(H,{userId:Q.uid,displayName:Q.displayName||"Anonymous",photoURL:Q.photoURL||null,isOnline:!0,lastSeen:new Date,currentFolder:l},{merge:!0}),console.log("✅ 내 접속 상태 등록:",Q.displayName)}catch(W){console.warn("presence set failed",W)}})();const J=setInterval(()=>{_t(H,{lastSeen:new Date,isOnline:!0},{merge:!0}).catch(()=>{})},3e4),X=Fr(F,W=>{const de=W.docs.map(ae=>{const pe=ae.data();return{userId:pe.userId||ae.id,displayName:pe.displayName||"Anonymous",photoURL:pe.photoURL||void 0,isOnline:!!pe.isOnline,lastSeen:pe.lastSeen?pe.lastSeen.toDate?pe.lastSeen.toDate():new Date(pe.lastSeen):new Date,currentFolder:pe.currentFolder}}).filter(ae=>!!ae.userId&&ae.isOnline);A(de),console.log("👥 활성 사용자 업데이트:",de.map(ae=>ae.displayName))},W=>console.warn("presence listen failed",W));return()=>{clearInterval(J),_t(H,{isOnline:!1,lastSeen:new Date},{merge:!0}).catch(()=>{}),X()}},[l,Q,o]),z.useCallback(async R=>{var H,Y;if(!l||!Q)return;const M=o.find(J=>J.id===l),O=((H=M==null?void 0:M.collaborationSettings)==null?void 0:H.showEditingState)??!0;if(!(!((Y=M==null?void 0:M.collaborationSettings)!=null&&Y.enabled||M!=null&&M.isShared)||!O))try{const J=Le(me,"folderEditing",`${l}_${R}`);await _t(J,{todoId:R,userId:Q.uid,userName:Q.displayName||"Anonymous",startTime:new Date,folderId:l}),console.log("✏️ 편집 시작:",{todoId:R,user:Q.displayName})}catch(J){console.warn("start editing failed",J)}},[l,Q,o]),z.useCallback(async R=>{var H,Y;if(!l||!Q)return;const M=o.find(J=>J.id===l),O=((H=M==null?void 0:M.collaborationSettings)==null?void 0:H.showEditingState)??!0;if(!(!((Y=M==null?void 0:M.collaborationSettings)!=null&&Y.enabled||M!=null&&M.isShared)||!O))try{const J=Le(me,"folderEditing",`${l}_${R}`);await Lt(J),console.log("✅ 편집 종료:",{todoId:R,user:Q.displayName})}catch(J){console.warn("stop editing failed",J)}},[l,Q,o]),z.useEffect(()=>{var Y,J;if(!l)return;const R=o.find(X=>X.id===l),M=((Y=R==null?void 0:R.collaborationSettings)==null?void 0:Y.showEditingState)??!0;if(!(((J=R==null?void 0:R.collaborationSettings)==null?void 0:J.enabled)||(R==null?void 0:R.isShared)||!1)||!M){D({});return}console.log("✏️ 편집 상태 추적 시작:",{folderId:l});const F=Fl(at(me,"folderEditing"),Ul("folderId","==",l)),H=Fr(F,X=>{const K={};X.docs.forEach(ne=>{const W=ne.data();W&&W.todoId&&(K[W.todoId]={todoId:W.todoId,userId:W.userId,userName:W.userName,startTime:W.startTime?W.startTime.toDate?W.startTime.toDate():new Date(W.startTime):new Date,folderId:W.folderId})}),D(K),console.log("✏️ 편집 상태 업데이트:",Object.keys(K).length+"개 항목")},X=>console.warn("editing states listen failed",X));return()=>H()},[l,o]),z.useCallback(async R=>{var M,O;try{const F=R.ownerId||(Q==null?void 0:Q.uid);if(!F)throw new Error("No owner UID");const H=o.find(ne=>ne.id===l),Y=((M=H==null?void 0:H.collaborationSettings)==null?void 0:M.enableConflictDetection)??!0,J=((O=H==null?void 0:H.collaborationSettings)==null?void 0:O.enabled)||(H==null?void 0:H.isShared)||!1,X=Le(me,"users",F,"todos",R.id.toString());if(J&&Y){const ne=await ng(X),W=ne.exists()?ne.data():null,fe=(W==null?void 0:W.version)||0,de=R.version||0;if(W&&fe>de&&(N(pe=>[...pe,{todoId:R.id,conflictType:"version_mismatch",localVersion:R,serverVersion:W,lastModifiedBy:W.lastModifiedBy||"unknown",lastModifiedAt:W.lastModified?W.lastModified.toDate?W.lastModified.toDate():new Date(W.lastModified):new Date}]),console.warn("⚠️ 충돌 감지:",{todoId:R.id,localVersion:de,serverVersion:fe,lastModifiedBy:W.lastModifiedBy}),!window.confirm("다른 사용자가 이 항목을 수정했습니다. 덮어쓰시겠습니까? (취소하면 변경이 중단됩니다)")))return!1}const K=Vt({...R,version:(R.version||0)+1,lastModified:new Date,lastModifiedBy:(Q==null?void 0:Q.uid)||"unknown"});return K&&(await _t(X,K),console.log("✅ Todo 저장 완료:",{todoId:R.id,version:K.version})),!0}catch(F){return console.error("attemptSaveTodo failed",F),!1}},[Q,l,o]),z.useEffect(()=>{const R=window.matchMedia("(prefers-color-scheme: dark)"),M=O=>{V==="system"&&S(O.matches)};return S(V==="system"?R.matches:V==="dark"),R.addEventListener("change",M),()=>R.removeEventListener("change",M)},[V]),z.useEffect(()=>{const R=()=>{console.log("🌐 인터넷 연결됨"),ke("✅ 인터넷에 다시 연결되었습니다"),setTimeout(()=>ke(""),3e3)},M=()=>{console.log("📡 인터넷 연결 끊김"),ke("⚠️ 오프라인 모드 - 클라우드 동기화 불가"),setTimeout(()=>ke(""),5e3)};return navigator.onLine||console.log("📡 현재 오프라인 상태"),window.addEventListener("online",R),window.addEventListener("offline",M),()=>{window.removeEventListener("online",R),window.removeEventListener("offline",M)}},[]),z.useEffect(()=>{const R=localStorage.getItem("pwa-prompt-dismissed"),M=HI(),O=WI();console.log("PWA Check:",{isMobileDevice:M,isInStandalone:O,isDismissed:R,userAgent:navigator.userAgent}),M&&!O&&!R&&(console.log("Showing PWA prompt immediately"),sl(!0))},[]),z.useEffect(()=>{"serviceWorker"in navigator&&navigator.serviceWorker.register("/Nova-AI-Planer/sw.js").then(R=>{console.log("SW registered: ",R);const M=WI(),O=HI();M&&O&&setTimeout(()=>{tR().then(F=>{F&&nR()})},2e3)}).catch(R=>{console.log("SW registration failed: ",R)})},[]),z.useEffect(()=>{},[V,I]);const Vr=z.useRef(null);z.useEffect(()=>{if(!(!vo||!Q))return Vr.current&&clearTimeout(Vr.current),Vr.current=setTimeout(()=>{ui()},5e3),()=>{Vr.current&&clearTimeout(Vr.current)}},[i,o,n,V,I,B,gt,b,vo,Q]),z.useEffect(()=>{const R=sg.find(O=>O.id===B)||sg[0],M=I?R.darkThemeClass:R.lightThemeClass;document.body.className="",I&&document.body.classList.add("dark-mode"),M&&document.body.classList.add(M)},[B,I]),z.useEffect(()=>{if(us){const R=setTimeout(()=>ke(""),3e3);return()=>clearTimeout(R)}},[us]);const ps=z.useMemo(()=>{let R=[...i];return l===null?R=R.filter(M=>{if(M.isSharedTodo===!0)return!1;const O=o.find(F=>F.id===M.folderId);return O?O.isShared!==!0:!0}):l==="all"?R=R:R=R.filter(M=>M.folderId===l),E==="deadline"?R.sort((M,O)=>!M.deadline&&!O.deadline?0:M.deadline?O.deadline?new Date(M.deadline).getTime()-new Date(O.deadline).getTime():-1:1):E==="newest"?R.sort((M,O)=>O.id-M.id):E==="alphabetical"&&R.sort((M,O)=>M.wish.localeCompare(O.wish)),f==="active"&&(R=R.filter(M=>!M.completed)),f==="completed"&&(R=R.filter(M=>M.completed)),g!=="all"&&(R=R.filter(M=>(M.category||"other")===g)),R},[i,f,E,g,l]),mc=async R=>{const M={...R,id:Date.now(),completed:!1,lastCompletedDate:null,streak:0,folderId:l==="all"||l===null?void 0:l};if(Q)try{const O=o.find(X=>X.id===l),F=(O==null?void 0:O.ownerId)||Q.uid,H=at(me,"users",F,"todos"),Y=Le(H,M.id.toString()),J=Vt(M);J?(await _t(Y,J),console.log("✅ 목표 Firestore 저장:",{targetOwnerUid:F,newTodo:J})):console.warn("⚠️ 정제 후 저장할 데이터가 없음")}catch(O){console.error("❌ 목표 Firestore 저장 실패:",O)}s(O=>{const F=[M,...O];return console.log("🟢 setTodos after add:",F),F}),u(null),p("all"),ye(!1)},gc=async R=>{const M=R.map((O,F)=>({...O,id:Date.now()+F,completed:!1,lastCompletedDate:null,streak:0,folderId:l||void 0})).reverse();if(Q)try{const O=o.find(H=>H.id===l),F=(O==null?void 0:O.ownerId)||Q.uid;for(const H of M){const Y=at(me,"users",F,"todos"),J=Le(Y,H.id.toString()),X=Vt(H);X?await _t(J,X):console.warn("⚠️ 정제 후 저장할 데이터가 없음:",H.id)}console.log("✅ 여러 목표 Firestore 저장:",{targetOwnerUid:F,count:M.length})}catch(O){console.error("❌ 여러 목표 Firestore 저장 실패:",O)}s(O=>[...M,...O]),ye(!1)},dl=async R=>{if(Q)try{const M=o.find(J=>J.id===R.folderId),O=(M==null?void 0:M.ownerId)||Q.uid,F=at(me,"users",O,"todos"),H=Le(F,R.id.toString()),Y=Vt(R);Y?(await _t(H,Y),console.log("✅ 목표 업데이트 Firestore 저장:",{targetOwnerUid:O,updatedTodo:Y})):console.warn("⚠️ 정제 후 저장할 데이터가 없음")}catch(M){console.error("❌ 목표 업데이트 Firestore 저장 실패:",M)}s(i.map(M=>M.id===R.id?R:M)),he(null)},wf=async R=>{const M=i.find(F=>F.id===R),O=i.filter(F=>F.id!==R);if(s(O),Q&&M)try{const F=o.find(X=>X.id===M.folderId),H=(F==null?void 0:F.ownerId)||Q.uid,Y=at(me,"users",H,"todos"),J=Le(Y,R.toString());await Lt(J),console.log("✅ 개별 목표 Firestore 삭제:",{targetOwnerUid:H,id:R});try{const X=Le(me,"users",H,"data","todos");await _t(X,{todos:O,lastUpdated:new Date().toISOString()},{merge:!0}),console.log("✅ 백업 데이터 업데이트 완료 - 삭제 반영")}catch(X){console.warn("⚠️ 백업 데이터 업데이트 실패:",X)}vo&&setTimeout(()=>{ui()},1e3)}catch(F){console.error("❌ 목표 Firestore 삭제 실패:",F),M&&s(H=>[...H,M])}},mr=async R=>{var O;if(!R.trim()){Te({title:"Error",message:"Folder name cannot be empty."});return}const M={id:Date.now().toString(),name:R,ownerId:((O=vi.currentUser)==null?void 0:O.uid)||"unknown",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),color:"#3b82f6",collaborationSettings:{enabled:!1,showPresence:!0,showEditingState:!0,enableConflictDetection:!0,allowGuestView:!1,requireApproval:!0},isShared:!1};if(a([...o,M]),Q)try{const{doc:F,setDoc:H}=await Cs(async()=>{const{doc:J,setDoc:X}=await Promise.resolve().then(()=>xs);return{doc:J,setDoc:X}},void 0),Y=F(me,"users",Q.uid,"folders",M.id);await H(Y,{name:M.name,color:M.color,ownerId:M.ownerId,createdAt:M.createdAt,updatedAt:M.updatedAt,isShared:M.isShared,collaborators:[],collaborationSettings:M.collaborationSettings}),console.log("✅ 폴더 Firebase 저장 완료:",M.id)}catch(F){console.error("❌ 폴더 Firebase 저장 실패:",F)}return console.log("📁 새 폴더 생성:",{name:R,collaborationEnabled:!1}),M},dn=z.useCallback(async(R,M)=>{try{if(a(O=>O.map(F=>{if(F.id===R){const H={...F.collaborationSettings,...M};return console.log("⚙️ 공동작업 설정 업데이트:",{folderId:R,settings:H}),{...F,collaborationSettings:H,updatedAt:new Date().toISOString()}}return F})),Q){const O=Le(me,"users",Q.uid,"folders",R);await rg(O,{collaborationSettings:{...M},updatedAt:new Date().toISOString()})}}catch(O){console.error("공동작업 설정 업데이트 실패:",O)}},[Q]),ms=z.useCallback(async(R,M)=>{await dn(R,{enabled:M}),M?(a(O=>O.map(F=>F.id===R?{...F,isShared:!0}:F)),console.log("🤝 폴더 공동작업 활성화:",R)):(A([]),D({}),console.log("🔒 폴더 공동작업 비활성화:",R))},[dn]);z.useCallback(()=>{if(!l)return null;const R=o.find(M=>M.id===l);return(R==null?void 0:R.collaborationSettings)||null},[l,o]);const gs=(R,M)=>{if(!M.trim()){Te({title:"Error",message:"Folder name cannot be empty."});return}a(o.map(O=>O.id===R?{...O,name:M,updatedAt:new Date().toISOString()}:O))},Ao=async R=>{const M=o.find(F=>F.id===R);if(!M)return;const O=i.filter(F=>F.folderId===R);if(Q&&O.length>0)try{for(const F of O){const H={...F};delete H.folderId;const Y=M.ownerId||Q.uid,J=at(me,"users",Y,"todos"),X=Le(J,F.id.toString()),K=Vt(H);K?(await _t(X,K),console.log(`✅ 목표 ${F.id} Firebase 루트로 이동 완료`)):console.warn(`⚠️ 목표 ${F.id} 데이터 정제 실패`)}console.log("✅ 폴더 삭제 시 목표들 Firebase 이동 완료:",{count:O.length})}catch(F){console.error("❌ 폴더 삭제 시 목표 이동 실패:",F)}if(Q)try{const F=Le(me,"users",Q.uid,"folders",R);await Lt(F),console.log("✅ 폴더 Firebase 삭제 완료:",R)}catch(F){console.error("❌ 폴더 Firebase 삭제 실패:",F)}s(i.map(F=>{if(F.folderId===R){const H={...F};return delete H.folderId,H}return F})),a(o.filter(F=>F.id!==R)),l===R&&u(null)},Ye=async R=>{if(!Je.trim()||!Q){Se("");return}try{const M={...R,name:Je.trim(),updatedAt:new Date().toISOString()},O=Le(me,"users",Q.uid,"folders",R.id),F=Vt(M);if(F)await _t(O,F),console.log("✅ 폴더 이름 변경 Firestore 저장 완료");else throw new Error("폴더 데이터 정제 실패");a(o.map(H=>H.id===R.id?M:H)),Se(""),console.log("✅ 폴더 이름 변경 완료:",Je.trim())}catch(M){console.error("❌ 폴더 이름 변경 실패:",M),Se("")}},xo=async R=>{var M;if(!(!Qe.trim()||!Q||kn)){cr(!0);try{if(((M=R.sharedWith)==null?void 0:M.some(X=>X.email===Qe.trim()))||R.ownerEmail===Qe.trim()){alert("이미 초대된 사용자입니다."),cr(!1);return}const F={email:Qe.trim(),userId:"",role:ur,addedAt:new Date().toISOString()},H={...R,sharedWith:[...R.sharedWith||[],F],updatedAt:new Date().toISOString()},Y=Le(me,"users",Q.uid,"folders",R.id),J=Vt(H);if(J)await _t(Y,J),console.log("✅ 협업자 초대 Firestore 저장 완료");else throw new Error("폴더 데이터 정제 실패");a(o.map(X=>X.id===R.id?{...H,sharedWith:Array.isArray(H.sharedWith)?H.sharedWith.filter(K=>K&&typeof K.role=="string"&&["owner","editor","viewer"].includes(K.role)).map(K=>({...K,role:K.role})):[]}:X)),Gt(""),console.log("✅ 협업자 초대 완료:",F)}catch(O){console.error("❌ 협업자 초대 실패:",O)}finally{cr(!1)}}},_s=async(R,M,O)=>{var F;if(Q)try{const H={...R,sharedWith:(F=R.sharedWith)==null?void 0:F.map(X=>X.userId===M?{...X,role:O}:X),updatedAt:new Date().toISOString()},Y=Le(me,"users",Q.uid,"folders",R.id),J=Vt(H);if(J)await _t(Y,J);else throw new Error("폴더 데이터 정제 실패");a(o.map(X=>X.id===R.id?{...H,sharedWith:Array.isArray(H.sharedWith)?H.sharedWith.filter(K=>K&&typeof K.role=="string"&&["owner","editor","viewer"].includes(K.role)).map(K=>({...K,role:K.role})):[]}:X)),console.log("✅ 협업자 역할 변경 완료:",{userId:M,newRole:O})}catch(H){console.error("❌ 협업자 역할 변경 실패:",H)}},ys=async(R,M)=>{var O;if(Q&&confirm("이 협업자를 제거하시겠습니까?"))try{const F={...R,sharedWith:(O=R.sharedWith)==null?void 0:O.filter(J=>J.userId!==M),updatedAt:new Date().toISOString()},H=Le(me,"users",Q.uid,"folders",R.id),Y=Vt(F);if(Y)await _t(H,Y);else throw new Error("폴더 데이터 정제 실패");a(o.map(J=>J.id===R.id?F:J)),console.log("✅ 협업자 제거 완료:",M)}catch(F){console.error("❌ 협업자 제거 실패:",F)}},Sf=R=>{const M=`${window.location.origin}${window.location.pathname}?invite=${R.id}`;navigator.clipboard.writeText(M).then(()=>{alert("공유 링크가 복사되었습니다!")}).catch(()=>{alert("링크 복사에 실패했습니다.")})},_c=R=>{confirm(oe("folder_leave_confirm"))&&Cf(R)},Cf=async R=>{var M;if(Q)try{const O={...R,sharedWith:(M=R.sharedWith)==null?void 0:M.filter(Y=>Y.userId!==Q.uid),updatedAt:new Date().toISOString()},F=Le(me,"users",R.ownerId,"folders",R.id),H=Vt(O);if(H)await _t(F,H);else throw new Error("폴더 데이터 정제 실패");a(o.filter(Y=>Y.id!==R.id)),l===R.id&&u(null),Ie(!1),console.log("✅ 폴더 나가기 완료")}catch(O){console.error("❌ 폴더 나가기 실패:",O)}},Af=R=>{confirm(oe("folder_delete_confirm"))&&(Ao(R.id),Ie(!1))},xf=R=>{if(u(R),R&&Q){const M=o.find(O=>O.id===R);M!=null&&M.ownerId&&(async()=>{try{console.log("📥 Firestore에서 폴더 목표 로드:",{folderId:R,ownerUid:M.ownerId});const O=at(me,"users",M.ownerId,"todos"),F=Fl(O,Ul("folderId","==",R)),H=await yi(F),Y=[];H.forEach(J=>{Y.push({id:parseInt(J.id),...J.data()})}),console.log("✅ 폴더 목표 로드 완료:",{count:Y.length,todos:Y}),s(J=>{const X=J.filter(fe=>fe.folderId!==R),K=new Set(X.map(fe=>fe.id)),ne=Y.filter(fe=>!K.has(fe.id)),W=[...X,...ne];return console.log("🔄 목표 병합 완료:",{기존목표:X.length,새로운목표:ne.length,전체목표:W.length,중복제거됨:Y.length-ne.length}),W})}catch(O){console.error("❌ 폴더 목표 로드 실패:",O)}})()}},Rf=async()=>{if(!l||!Q){ke("❌ 동기화할 폴더가 없습니다");return}cn(!0);try{console.log("🔄 폴더 정보 재로딩 중...",l);const{doc:R,getDoc:M,collection:O,query:F,where:H,getDocs:Y}=await Cs(async()=>{const{doc:pe,getDoc:Ne,collection:nt,query:Dn,where:_r,getDocs:pl}=await Promise.resolve().then(()=>xs);return{doc:pe,getDoc:Ne,collection:nt,query:Dn,where:_r,getDocs:pl}},void 0);let J=o.find(pe=>pe.id===l);if(!J||!J.collaborators||J.collaborators.length===0){console.log("⚠️ 로컬 폴더 정보가 불완전함, Firebase에서 재로딩...");const pe=R(me,"users",Q.uid,"folders",l),Ne=await M(pe);if(Ne.exists())J={id:l,...Ne.data()},console.log("✅ 사용자 폴더에서 로드됨:",J);else{console.log("🔍 공유된 폴더 검색 중..."),Te({title:"📡 폴더 정보 로딩 중",message:`폴더 정보를 불러오는 중입니다.
잠시 후 다시 시도하거나 새로고침해주세요.`,confirmText:"확인",onConfirm:()=>Te(null)}),cn(!1);return}}if(!J||!J.collaborators||J.collaborators.length===0){Te({title:"❌ 협업 폴더 아님",message:`이것은 공유 폴더가 아닙니다.
개인 폴더는 개별적으로 동기화됩니다.`,confirmText:"확인",onConfirm:()=>Te(null)}),cn(!1);return}const X=J.collaborators.find(pe=>pe.role==="owner");if(!X||!X.userId){Te({title:"❌ 소유자 정보 오류",message:`폴더 소유자 정보가 없습니다.
폴더를 다시 공유받아주세요.`,confirmText:"확인",onConfirm:()=>Te(null)}),cn(!1);return}if(X.userId.startsWith("owner_")){console.warn("⚠️ 임시 소유자 ID 발견:",X.userId),Te({title:"⚠️ 소유자 정보 오류",message:`폴더 소유자 정보에 문제가 있습니다.
폴더 소유자에게 새로운 공유 링크를 요청해주세요.`,confirmText:"확인",onConfirm:()=>Te(null)}),cn(!1);return}console.log("🔄 수동 동기화 시작:",{folderId:l,ownerUid:X.userId});const K=i.filter(pe=>pe.folderId===l);console.log("📊 현재 로컬 목표 수:",K.length);const ne=O(me,"users",X.userId,"todos"),W=F(ne,H("folderId","==",l)),fe=await Y(W),de=[];fe.forEach(pe=>{de.push({id:parseInt(pe.id),...pe.data()})}),console.log("📊 서버 목표 수:",de.length),K.length===de.length?(console.log("✅ 실시간 동기화가 정상 작동 중입니다"),ke(`✅ 동기화 확인 완료 (${de.length}개 항목 - 이미 최신 상태)`)):(console.log("⚠️ 로컬과 서버 데이터 불일치 감지:",{local:K.length,server:de.length}),s(pe=>[...pe.filter(Dn=>Dn.folderId!==l),...de]),ke(`🔄 동기화 완료 (${de.length}개 항목 - ${Math.abs(de.length-K.length)}개 차이 수정)`)),console.log("📡 실시간 리스너 상태:",l&&Q?"활성":"비활성")}catch(R){console.error("❌ 동기화 실패:",R),R instanceof Error?R.message.includes("permission-denied")?ke("❌ 동기화 실패: 폴더 접근 권한이 없습니다"):R.message.includes("not-found")?ke("❌ 동기화 실패: 폴더를 찾을 수 없습니다"):ke("❌ 동기화 실패: "+R.message):ke("❌ 동기화 실패: 알 수 없는 오류")}finally{cn(!1)}},vs=async()=>{cn(!0);try{console.log("🔄 수동 동기화 시작..."),await ui(),ke("✅ 데이터 동기화 완료"),console.log("✅ 수동 동기화 완료")}catch(R){console.error("❌ 수동 동기화 실패:",R),ke("❌ 동기화 실패")}finally{cn(!1)}},Lr=async(R,M)=>{const O=i.find(J=>J.id===R);if(!O)return;const F=o.find(J=>J.id===M),H=(F==null?void 0:F.isShared)===!0,Y={...O,folderId:M||void 0,isSharedTodo:H};if(Q)try{const J=o.find(fe=>fe.id===(M||O.folderId)),X=(J==null?void 0:J.ownerId)||Q.uid,K=at(me,"users",X,"todos"),ne=Le(K,R.toString()),W=Vt(Y);W?(await _t(ne,W),console.log("✅ 목표 폴더 이동 Firestore 저장:",{targetOwnerUid:X,goalId:R,folderId:M,isSharedTodo:Y.isSharedTodo})):console.warn("⚠️ 정제 후 저장할 데이터가 없음")}catch(J){console.error("❌ 목표 폴더 이동 Firestore 저장 실패:",J)}s(i.map(J=>J.id===R?Y:J)),ke("✅ 목표가 폴더로 이동되었습니다"),setTimeout(()=>ke(""),3e3)},yc=async R=>{const M=new Date().toISOString(),O=(()=>{const F=i.find(J=>J.id===R);if(!F)return null;const H=!F.completed;let Y=F.streak;return F.isRecurring&&(H?(!F.lastCompletedDate||!ou(M,F.lastCompletedDate))&&(Y=(F.streak||0)+1):F.lastCompletedDate&&ou(M,F.lastCompletedDate)&&(Y=Math.max(0,(F.streak||1)-1))),{...F,completed:H,lastCompletedDate:H?M:F.lastCompletedDate,streak:Y}})();if(O){if(Q)try{const F=o.find(K=>K.id===O.folderId),H=(F==null?void 0:F.ownerId)||Q.uid,Y=at(me,"users",H,"todos"),J=Le(Y,R.toString()),X=Vt(O);X?(await _t(J,X),console.log("✅ 목표 완료 상태 Firestore 저장:",{targetOwnerUid:H,id:R,completed:O.completed})):console.warn("⚠️ 정제 후 저장할 데이터가 없음")}catch(F){console.error("❌ 목표 완료 상태 Firestore 저장 실패:",F)}s(i.map(F=>F.id===R?O:F))}},vc=async R=>{if(R==="ai"){if(i.length<2){Te({title:oe("sort_alert_title"),message:oe("sort_alert_message")});return}Fe(!0);try{const M=So();if(!M){ke(Wn?"오프라인 모드에서는 AI 정렬을 사용할 수 없습니다.":"AI 정렬을 사용하려면 설정에서 API 키를 입력해주세요."),Fe(!1),x("manual");return}const O=`Here is a list of goals with their details (wish, outcome, obstacle, plan, deadline). Prioritize them based on urgency (closer deadline), importance (based on outcome), and feasibility (based on plan). Return a JSON object with "sorted_ids" array and "reasoning" string explaining your prioritization logic. Goals: ${JSON.stringify(i.map(({id:W,wish:fe,outcome:de,obstacle:ae,plan:pe,deadline:Ne})=>({id:W,wish:fe,outcome:de,obstacle:ae,plan:pe,deadline:Ne})))}`,F=await M.models.generateContent({model:"gemini-2.5-flash",contents:O,config:{responseMimeType:"application/json",responseSchema:{type:Ln.OBJECT,properties:{sorted_ids:{type:Ln.ARRAY,items:{type:Ln.NUMBER}},reasoning:{type:Ln.STRING}}}}}),H=JSON.parse(F.text),Y=H.sorted_ids.map(Number),J=new Map(i.map(W=>[Number(W.id),W])),X=Y.map(W=>J.get(W)).filter(Boolean),K=i.filter(W=>!Y.includes(Number(W.id))),ne=[...X,...K].map(W=>({...W,id:Number(W.id)}));s(ne),x("manual"),il(H.reasoning||""),yo(!0)}catch(M){console.error("AI sort failed:",M),Te({title:oe("ai_sort_error_title"),message:oe("ai_sort_error_message")})}finally{Fe(!1)}}else x(R)},Tc=R=>{const M=new Set(ls);M.has(R)?M.delete(R):M.add(R),fr(M)},hl=()=>{go(!1),fr(new Set)},Ec=()=>{const R=new Set(ps.map(M=>M.id));fr(R)},ci=()=>{const R=ls.size;Te({title:oe("delete_selected_confirm_title"),message:oe("delete_selected_confirm_message").replace("{count}",String(R)),isDestructive:!0,confirmText:oe("delete_selected_button_label").replace("{count}",String(R)),cancelText:oe("cancel_button"),onConfirm:()=>{s(i.filter(M=>!ls.has(M.id))),hl()}})},Pf=()=>{ai("exporting");const R=JSON.stringify(i,null,2),M="data:application/json;charset=utf-8,"+encodeURIComponent(R),O="nova_goals.json",F=document.createElement("a");F.setAttribute("href",M),F.setAttribute("download",O),F.click(),setTimeout(()=>{ai("idle"),Re(!1)},1500)},kf=R=>{var F;const M=(F=R.target.files)==null?void 0:F[0];if(!M)return;const O=new FileReader;O.onload=H=>{var Y;try{const J=(Y=H.target)==null?void 0:Y.result;if(typeof J!="string")throw new Error("File content is not a string");const X=JSON.parse(J);if(Array.isArray(X)&&X.every(K=>"wish"in K&&"id"in K))Te({title:oe("import_confirm_title"),message:oe("import_confirm_message"),confirmText:oe("settings_import_data"),cancelText:oe("cancel_button"),onConfirm:()=>{ai("importing"),setTimeout(()=>{s(X),ke(oe("import_success_toast")),ai("idle"),Re(!1)},1500)}});else throw new Error("Invalid file format")}catch{Te({title:oe("import_error_alert_title"),message:oe("import_error_alert_message")})}},O.onerror=()=>Te({title:oe("import_error_alert_title"),message:oe("import_error_alert_message")}),O.readAsText(M),R.target.value=""},Nf=()=>{Te({title:"⚠️ 모든 데이터 삭제",message:`정말로 모든 데이터를 삭제하시겠습니까?

이 작업은 되돌릴 수 없습니다:

• 모든 목표와 폴더
• Firebase 클라우드 데이터
• 로컬 설정
• 공유 폴더 데이터
• 실시간 협업 정보`,confirmText:"삭제",cancelText:"취소",isDestructive:!0,onConfirm:()=>{Te(null),gr()},onCancel:()=>{Te(null)}})},gr=async()=>{console.log("🗑️ performDeleteAllData 함수 시작"),ai("deleting");try{if(Q){console.log("📧 사용자 정보:",{uid:Q.uid,email:Q.email}),console.log("🗑️ Firebase 데이터 삭제 시작...");try{const K=Le(me,"users",Q.uid,"data","todos");await Lt(K),console.log("✅ 백업 todos 데이터 삭제 완료")}catch(K){console.warn("⚠️ 백업 todos 데이터 삭제 실패:",K)}try{const K=Le(me,"users",Q.uid,"data","settings");await Lt(K),console.log("✅ 백업 settings 데이터 삭제 완료")}catch(K){console.warn("⚠️ 백업 settings 데이터 삭제 실패:",K)}const R=at(me,"users",Q.uid,"todos"),M=await yi(R);console.log("📊 삭제할 todos 개수:",M.size);const O=M.docs.map(K=>Lt(K.ref));await Promise.all(O),console.log("✅ 개별 todos 삭제 완료:",M.size,"개");const F=at(me,"users",Q.uid,"folders"),H=await yi(F);console.log("📊 삭제할 folders 개수:",H.size);const Y=H.docs.map(K=>Lt(K.ref));await Promise.all(Y),console.log("✅ folders 삭제 완료:",H.size,"개");const J=at(me,"sharedFolders"),X=await yi(J);for(const K of X.docs){const ne=K.data();if(ne.collaborators&&Array.isArray(ne.collaborators)){const W=ne.collaborators.filter(fe=>fe.userId!==Q.uid);W.length!==ne.collaborators.length&&(await rg(K.ref,{collaborators:W}),console.log("✅ 공유 폴더에서 내 계정 제거:",K.id))}}try{for(const K of o)if(K.id){const ne=Le(me,"folderPresence",K.id,"users",Q.uid);await Lt(ne)}console.log("✅ presence 데이터 삭제 완료")}catch(K){console.warn("⚠️ presence 데이터 삭제 중 일부 오류:",K)}try{const K=Fl(at(me,"folderEditing"),Ul("userId","==",Q.uid)),W=(await yi(K)).docs.map(fe=>Lt(fe.ref));await Promise.all(W),console.log("✅ editing states 삭제 완료")}catch(K){console.warn("⚠️ editing states 삭제 중 일부 오류:",K)}try{const K=Le(me,"users",Q.uid);await Lt(K),console.log("✅ 사용자 프로필 문서 삭제 완료")}catch(K){console.warn("⚠️ 사용자 프로필 문서 삭제 실패:",K)}try{const K=at(me,"notifications",Q.uid,"items"),W=(await yi(K)).docs.map(de=>Lt(de.ref));await Promise.all(W);const fe=Le(me,"notifications",Q.uid);await Lt(fe),console.log("✅ 알림 데이터 삭제 완료")}catch(K){console.warn("⚠️ 알림 데이터 삭제 중 일부 오류:",K)}try{const K=at(me,"userActivity",Q.uid,"logs"),W=(await yi(K)).docs.map(de=>Lt(de.ref));await Promise.all(W);const fe=Le(me,"userActivity",Q.uid);await Lt(fe),console.log("✅ 사용자 활동 로그 삭제 완료")}catch(K){console.warn("⚠️ 사용자 활동 로그 삭제 중 일부 오류:",K)}try{const K=Le(me,"userMetadata",Q.uid);await Lt(K),console.log("✅ 사용자 메타데이터 삭제 완료")}catch(K){console.warn("⚠️ 사용자 메타데이터 삭제 중 일부 오류:",K)}try{const K=Le(me,"userSessions",Q.uid);await Lt(K),console.log("✅ 사용자 세션 데이터 삭제 완료")}catch(K){console.warn("⚠️ 사용자 세션 데이터 삭제 중 일부 오류:",K)}console.log("🔥 모든 클라우드 데이터 삭제 완료 - 사용자 데이터가 완전히 제거되었습니다")}if(console.log("🔄 로컬 상태 초기화 시작..."),s([]),a([]),A([]),D({}),N([]),u(null),fr(new Set),go(!1),p("all"),v("all"),console.log("⚙️ 설정 초기화 시작..."),r("ko"),S(!0),T("default"),x("manual"),C(["school","work","personal","other"]),console.log("💾 localStorage 초기화 시작..."),localStorage.clear(),console.log("✅ localStorage 완전 삭제 완료"),Q){console.log("🚪 Firebase 로그아웃 처리...");try{await dE(vi),console.log("✅ 로그아웃 완료")}catch(R){console.warn("⚠️ 로그아웃 중 오류:",R)}}console.log("✅ 모든 데이터 삭제 완료"),ke("✅ 모든 데이터가 완전히 삭제되었습니다. 로그아웃됩니다."),setTimeout(()=>{console.log("🔄 페이지 새로고침으로 완전 초기화..."),window.location.reload()},1500)}catch(R){console.error("❌ 데이터 삭제 중 오류:",R);let M="❌ 삭제 실패",O="데이터 삭제 중 오류가 발생했습니다.";R instanceof Error&&(R.message.includes("permission-denied")||R.message.includes("insufficient permissions")?(M="❌ 권한 부족",O=`삭제 권한이 부족합니다.

잠시 후 다시 시도해주세요.
(Firebase 보안 규칙이 업데이트 중일 수 있습니다)`):R.message.includes("network-request-failed")?(M="❌ 네트워크 오류",O="인터넷 연결을 확인하고 다시 시도해주세요."):R.message.includes("unauthenticated")?(M="❌ 로그인 필요",O=`로그인이 만료되었습니다.
다시 로그인해주세요.`):O=`데이터 삭제 중 오류가 발생했습니다.

오류 내용: `+R.message),Te({title:M,message:O,confirmText:"확인",onConfirm:()=>Te(null)})}finally{ai("idle"),Re(!1)}},Ro=je||!!Z||!!dr||hr||!!ze||tl||nl||ve||!!Hn||pr,[Ic,fl]=z.useState(!1),[Ts,Es]=z.useState(()=>typeof window<"u"?window.innerWidth<=600:!1);return z.useEffect(()=>{const R=()=>{Es(window.innerWidth<=600)};return window.addEventListener("resize",R),()=>window.removeEventListener("resize",R)},[]),m.jsxs("div",{className:`main-page-layout ${yn?"calendar-view-active":""}`,children:[!Ts&&m.jsx("button",{className:"floating-add-btn","aria-label":"목표 추가",onClick:()=>ye(!0),style:{display:Ro?"none":"inline-flex"},children:Ee.add}),Ts&&!Ro&&m.jsx("button",{className:"floating-add-btn mobile-bottom-add","aria-label":"목표 추가",onClick:()=>ye(!0),children:Ee.add}),m.jsxs("div",{className:`page-content ${Ro?"modal-open":""}`,children:[m.jsx(M3,{folders:o,currentFolderId:l,onSetCurrentFolder:xf,onCreateFolder:mr,onRenameFolder:gs,onDeleteFolder:Ao,onSetCollaboratingFolder:cs,todos:i,t:oe,onManageFolder:R=>{tt(R),Ie(!0)},currentUserId:Q==null?void 0:Q.uid,onAddGoal:()=>ye(!0),isAnyModalOpen:Ro,isMobileScreen:Ts}),m.jsxs("div",{className:"container",children:[m.jsx(V3,{t:oe,isSelectionMode:cc,selectedCount:ls.size,totalVisibleCount:ps.length,onCancelSelection:hl,onDeleteSelected:ci,onSelectAll:Ec,isViewModeCalendar:yn,onToggleViewMode:()=>ot(!yn),isAiSorting:zt,sortType:E,onSort:vc,filter:f,onFilter:p,categoryFilter:g,onCategoryFilter:v,userCategories:b,onAddCategory:R=>C([...b,R]),onRemoveCategory:R=>C(b.filter(M=>M!==R)),onSetSelectionMode:()=>go(!0),onOpenSettings:()=>Re(!0),onAddGoal:Ts?void 0:()=>ye(!0),currentFolderId:l,folders:o,onSyncSharedFolder:Rf,isSyncing:To,isSyncingData:To,onManualSync:vs,activeUsers:w,editingStates:k,onToggleCollaboration:ms,onUpdateCollaborationSettings:dn}),yn?m.jsx($3,{todos:i,t:oe,onGoalClick:$n,language:n}):m.jsx(m.Fragment,{children:m.jsx(L3,{todos:ps,onToggleComplete:yc,onDelete:wf,onEdit:he,onInfo:$n,t:oe,filter:f,randomEncouragement:pc,isSelectionMode:cc,selectedTodoIds:ls,onSelectTodo:Tc,folders:o,onMoveToFolder:Lr})})]})]}),je&&m.jsx(QI,{onClose:()=>ye(!1),onAddTodo:mc,onAddMultipleTodos:gc,t:oe,language:n,createAI:So,userCategories:b}),Z&&m.jsx(QI,{onClose:()=>he(null),onEditTodo:dl,existingTodo:Z,t:oe,language:n,createAI:So}),dr&&m.jsx(B3,{todo:dr,onClose:()=>$n(null),t:oe,createAI:So,onOpenCollaboration:R=>{const M=o.find(O=>O.id===R.folderId)||(R.folderId===null||R.folderId===void 0?null:void 0);M!==void 0&&cs(M||null)},userCategories:b,onUpdateGoal:dl}),Hn!==void 0&&m.jsx(q3,{folder:Hn,onClose:()=>cs(void 0),t:oe,googleUser:Q,onUpdateCollaborators:wo,setAlertConfig:Te}),hr&&m.jsx(G3,{onClose:()=>Re(!1),isDarkMode:I,onToggleDarkMode:()=>S(!I),themeMode:V,onThemeChange:fc,backgroundTheme:B,onSetBackgroundTheme:T,onExportData:Pf,onImportData:kf,setAlertConfig:Te,onDeleteAllData:Nf,dataActionStatus:el,language:n,onSetLanguage:r,t:oe,todos:i,setToastMessage:ke,onOpenVersionInfo:()=>_o(!0),onOpenUsageGuide:()=>li(!0),apiKey:gt,onSetApiKey:hs,isOfflineMode:Wn,onToggleOfflineMode:()=>fs(!Wn),googleUser:Q,onGoogleLogin:cl,onGoogleLogout:hc,onSyncDataToFirebase:ui,onLoadDataFromFirebase:Mr,isGoogleLoggingIn:ll,isGoogleLoggingOut:Ef,isSyncingData:To,isLoadingData:ul,isAutoSyncEnabled:vo,setIsAutoSyncEnabled:yf,onDiagnoseFirebase:dc}),tl&&m.jsx(YI,{onClose:()=>_o(!1),t:oe}),nl&&m.jsx(z3,{onClose:()=>li(!1),t:oe}),pr&&m.jsx(mo,{onClose:()=>yo(!1),isClosing:!1,className:"ai-sort-reason-modal",children:m.jsxs("div",{style:{padding:"24px"},children:[m.jsx("h2",{style:{marginBottom:"16px",fontSize:"1.3rem",fontWeight:600},children:oe("ai_sort_reason_modal_title")}),m.jsx("div",{style:{marginBottom:"24px",padding:"16px",backgroundColor:"var(--card-bg-color)",borderRadius:"8px",border:"1px solid var(--border-color)",lineHeight:"1.6",color:"var(--text-secondary-color)"},children:rl}),m.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:m.jsx("button",{onClick:()=>yo(!1),className:"primary",children:oe("close_button")})})]})}),tl&&m.jsx(YI,{onClose:()=>_o(!1),t:oe}),ze&&m.jsx(H3,{title:ze.title,message:ze.message,onConfirm:()=>{var R;(R=ze.onConfirm)==null||R.call(ze),Te(null)},onCancel:ze.onCancel?()=>{var R;(R=ze.onCancel)==null||R.call(ze),Te(null)}:void 0,confirmText:ze.confirmText,cancelText:ze.cancelText,isDestructive:ze.isDestructive,t:oe}),us&&m.jsx("div",{className:"toast-notification",children:us}),ds&&m.jsx(k3,{onClose:()=>sl(!1)}),ve&&Oe&&m.jsx("div",{className:"modal-backdrop",onClick:()=>Ie(!1),children:m.jsxs("div",{className:"modal-content large-modal",onClick:R=>R.stopPropagation(),children:[m.jsxs("div",{className:"modal-header",children:[m.jsx("h3",{children:oe("folder_manage_title")}),m.jsx("button",{onClick:()=>Ie(!1),children:"✕"})]}),m.jsx("div",{className:"modal-body",children:(()=>{var F,H,Y;const R=o.find(J=>J.id===Oe);if(!R)return null;const M=R.ownerId===(Q==null?void 0:Q.uid),O=M?"owner":((H=(F=R.sharedWith)==null?void 0:F.find(J=>J.userId===(Q==null?void 0:Q.uid)))==null?void 0:H.role)||"viewer";return m.jsxs("div",{className:"folder-manage-content",children:[m.jsxs("div",{className:"folder-info-section",children:[m.jsx("h4",{children:oe("folder_manage_info")}),m.jsxs("div",{className:"folder-info-item",children:[m.jsxs("label",{children:[oe("folder_name"),":"]}),Je?m.jsxs("div",{className:"inline-edit",children:[m.jsx("input",{type:"text",value:Je,onChange:J=>Se(J.target.value),onKeyPress:J=>{J.key==="Enter"&&Ye(R)}}),m.jsx("button",{onClick:()=>Ye(R),children:"✓"}),m.jsx("button",{onClick:()=>Se(""),children:"✕"})]}):m.jsxs("div",{className:"folder-name-display",children:[m.jsx("span",{children:R.name}),M&&m.jsx("button",{className:"edit-btn",onClick:()=>Se(R.name),children:"✏️"})]})]}),m.jsxs("div",{className:"folder-info-item",children:[m.jsxs("label",{children:[oe("folder_owner"),":"]}),m.jsx("span",{children:R.ownerEmail||R.ownerId})]}),m.jsxs("div",{className:"folder-info-item",children:[m.jsxs("label",{children:[oe("role"),":"]}),m.jsx("span",{children:oe(O==="owner"?"folder_role_owner":O==="editor"?"folder_role_editor":"folder_role_viewer")})]}),m.jsxs("div",{className:"folder-info-item",children:[m.jsxs("label",{children:[oe("created_date"),":"]}),m.jsx("span",{children:new Date(R.createdAt).toLocaleDateString()})]})]}),m.jsxs("div",{className:"collaborators-section",children:[m.jsx("h4",{children:oe("folder_manage_collaborators")}),m.jsxs("div",{className:"collaborator-list",children:[m.jsx("div",{className:"collaborator-item owner",children:m.jsxs("div",{className:"collaborator-info",children:[m.jsx("span",{className:"email",children:R.ownerEmail||R.ownerId}),m.jsx("span",{className:"role owner-role",children:oe("folder_role_owner")})]})}),((Y=R.sharedWith)==null?void 0:Y.map((J,X)=>m.jsxs("div",{className:"collaborator-item",children:[m.jsxs("div",{className:"collaborator-info",children:[m.jsx("span",{className:"email",children:J.email||J.userId}),m.jsx("span",{className:`role ${J.role}`,children:J.role==="editor"?oe("folder_role_editor"):oe("folder_role_viewer")})]}),M&&m.jsxs("div",{className:"collaborator-actions",children:[m.jsxs("select",{value:J.role,onChange:K=>_s(R,J.userId,K.target.value),children:[m.jsx("option",{value:"editor",children:oe("folder_role_editor")}),m.jsx("option",{value:"viewer",children:oe("folder_role_viewer")})]}),m.jsx("button",{className:"remove-btn",onClick:()=>ys(R,J.userId),children:"🗑️"})]})]},X)))||[]]}),(M||O==="editor")&&m.jsxs("div",{className:"invite-section",children:[m.jsx("h5",{children:oe("folder_invite_new")}),m.jsxs("div",{className:"invite-form",children:[m.jsx("input",{type:"email",placeholder:oe("folder_invite_email"),value:Qe,onChange:J=>Gt(J.target.value)}),m.jsxs("select",{value:ur,onChange:J=>zn(J.target.value),children:[m.jsx("option",{value:"editor",children:oe("folder_role_editor")}),m.jsx("option",{value:"viewer",children:oe("folder_role_viewer")})]}),m.jsx("button",{onClick:()=>xo(R),disabled:!Qe||kn,children:kn?"초대 중...":oe("folder_invite_button")})]})]})]}),m.jsxs("div",{className:"folder-settings-section",children:[m.jsx("h4",{children:oe("folder_manage_settings")}),m.jsxs("div",{className:"share-link-section",children:[m.jsx("label",{children:oe("folder_share_link")}),m.jsx("p",{className:"share-link-desc",children:oe("folder_share_link_desc")}),m.jsxs("div",{className:"share-link-input",children:[m.jsx("input",{type:"text",readOnly:!0,value:`${window.location.origin}${window.location.pathname}?invite=${R.id}`}),m.jsx("button",{onClick:()=>Sf(R),children:oe("folder_copy_link")})]})]}),m.jsxs("div",{className:"folder-actions",children:[!M&&m.jsx("button",{className:"leave-folder-btn",onClick:()=>_c(R),children:oe("folder_leave")}),M&&m.jsx("button",{className:"delete-folder-btn",onClick:()=>Af(R),children:oe("folder_delete")})]})]})]})})()})]})})]})},M3=({folders:t,currentFolderId:e,onSetCurrentFolder:n,onCreateFolder:r,onRenameFolder:i,onDeleteFolder:s,onSetCollaboratingFolder:o,todos:a,t:l,onManageFolder:u,currentUserId:f,onAddGoal:p,isAnyModalOpen:g,isMobileScreen:v})=>{var B;const[E,x]=z.useState(!1),[b,C]=z.useState(null),[I,S]=z.useState(""),[V,U]=z.useState(null);return m.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid var(--border-color)",overflowX:"auto",display:"flex",gap:"8px",alignItems:"center",backgroundColor:"var(--card-bg-color)",position:"relative"},children:[m.jsxs("button",{onClick:()=>n(null),style:{padding:"6px 12px",borderRadius:"8px",border:"none",backgroundColor:e===null?"var(--primary-color)":"transparent",color:e===null?"white":"var(--text-color)",cursor:"pointer",fontSize:"0.9rem",fontWeight:500,whiteSpace:"nowrap",transition:"all 0.2s",minWidth:"80px",textAlign:"center"},children:["📁 ",l("all_goals_label")||"All"]}),m.jsx("button",{onClick:()=>n("all"),style:{padding:"6px 12px",borderRadius:"8px",border:"none",backgroundColor:e==="all"?"#ff6b6b":"transparent",color:e==="all"?"white":"var(--text-color)",cursor:"pointer",fontSize:"0.9rem",fontWeight:500,whiteSpace:"nowrap",transition:"all 0.2s",minWidth:"80px",textAlign:"center"},children:"🌐 전체"}),m.jsx("div",{style:{display:"flex",flex:1,gap:"8px",alignItems:"center"},children:t.length>0&&t.filter(T=>e===null?!T.isShared||T.isShared&&T.ownerId===f:!0).map(T=>{const w=a.filter(A=>A.folderId===T.id).length;return m.jsxs("div",{style:{position:"relative",display:"inline-flex",alignItems:"center",gap:"2px"},children:[m.jsxs("button",{onClick:()=>n(T.id),style:{padding:"6px 12px",borderRadius:"8px",border:"none",backgroundColor:e===T.id?T.color||"var(--primary-color)":`${T.color}20`||"transparent",color:e===T.id?"white":"var(--text-color)",cursor:"pointer",fontSize:"0.9rem",fontWeight:500,whiteSpace:"nowrap",transition:"all 0.2s",position:"relative"},title:T.isShared?"공유 폴더":"개인 폴더",children:[T.isShared?"👥":"📁"," ",T.name," (",w,")"]}),e===T.id&&m.jsxs("div",{style:{display:"flex",gap:"2px"},children:[m.jsx("button",{onClick:()=>o(T),style:{width:"24px",height:"24px",padding:"0",borderRadius:"4px",border:"none",backgroundColor:"var(--primary-color)",color:"white",cursor:"pointer",fontSize:"0.8rem",lineHeight:"1",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s"},title:"폴더 협업",children:"👥"}),m.jsx("button",{onClick:()=>u(T.id),style:{width:"24px",height:"24px",padding:"0",borderRadius:"4px",border:"none",backgroundColor:"var(--button-bg-color)",color:"var(--text-color)",cursor:"pointer",fontSize:"0.8rem",lineHeight:"1",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s"},title:"폴더 관리",children:"⚙️"}),m.jsx("button",{onClick:()=>{C(T.id),S(T.name)},style:{width:"24px",height:"24px",padding:"0",borderRadius:"4px",border:"none",backgroundColor:"var(--button-bg-color)",color:"var(--text-color)",cursor:"pointer",fontSize:"0.8rem",lineHeight:"1",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s"},title:"폴더 이름 변경",children:"✏"}),m.jsx("button",{onClick:()=>{U(T.id)},style:{width:"24px",height:"24px",padding:"0",borderRadius:"4px",border:"none",backgroundColor:"var(--danger-color)",color:"white",cursor:"pointer",fontSize:"0.8rem",lineHeight:"1",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s"},title:"폴더 삭제",children:"×"})]})]},T.id)})}),m.jsx("button",{onClick:()=>x(!0),style:{padding:"6px 12px",borderRadius:"8px",border:"2px solid var(--primary-color)",backgroundColor:"transparent",color:"var(--primary-color)",cursor:"pointer",fontSize:"0.9rem",fontWeight:500,whiteSpace:"nowrap",transition:"all 0.2s",display:"flex",alignItems:"center",gap:"4px"},children:"➕ 폴더"}),v&&p&&!g&&m.jsx("div",{style:{flex:1,display:"flex",justifyContent:"flex-end"},children:m.jsx("button",{className:"header-icon-button","aria-label":"목표 추가",onClick:p,style:{background:"var(--primary-color)",color:"#fff",width:44,height:44,borderRadius:"50%",fontSize:24,display:"flex",alignItems:"center",justifyContent:"center",zIndex:10,marginLeft:8},children:Ee.add})}),E&&m.jsx(x3,{onClose:()=>x(!1),onCreate:T=>{T&&T.name&&r(T.name),x(!1)},t:l}),V&&m.jsx("div",{className:"modal-backdrop alert-backdrop",children:m.jsxs("div",{className:"modal-content alert-modal",children:[m.jsxs("div",{className:"alert-content",children:[m.jsx("h2",{children:"폴더 삭제"}),m.jsxs("p",{style:{fontSize:"0.9rem"},children:['"',(B=t.find(T=>T.id===V))==null?void 0:B.name,'" 폴더를 삭제하시겠습니까?',m.jsx("br",{}),'폴더 내 목표는 "나의 목표"로 이동됩니다.']})]}),m.jsxs("div",{className:"modal-buttons",children:[m.jsx("button",{onClick:()=>U(null),className:"secondary",children:"취소"}),m.jsx("button",{onClick:()=>{s(V),U(null)},className:"destructive",children:"삭제"})]})]})}),b&&m.jsx("div",{className:"modal-backdrop alert-backdrop",children:m.jsxs("div",{className:"modal-content alert-modal",children:[m.jsxs("div",{className:"alert-content",children:[m.jsx("h2",{children:"폴더 이름 변경"}),m.jsx("p",{style:{fontSize:"0.9rem",marginBottom:"16px"},children:"새로운 폴더 이름을 입력하세요"}),m.jsx("input",{type:"text",value:I,onChange:T=>S(T.target.value),onKeyPress:T=>{T.key==="Enter"&&I.trim()&&(i(b,I),C(null),S(""))},placeholder:"폴더 이름...",autoFocus:!0,style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontSize:"0.95rem",outline:"none",boxSizing:"border-box"}})]}),m.jsxs("div",{className:"modal-buttons",children:[m.jsx("button",{onClick:()=>{C(null),S("")},className:"secondary",children:"취소"}),m.jsx("button",{onClick:()=>{I.trim()&&(i(b,I),C(null),S(""))},className:"primary",children:"변경"})]})]})})]})},V3=({t,isSelectionMode:e,selectedCount:n,totalVisibleCount:r,onCancelSelection:i,onDeleteSelected:s,onSelectAll:o,isViewModeCalendar:a,onToggleViewMode:l,isAiSorting:u,sortType:f,onSort:p,filter:g,onFilter:v,categoryFilter:E,onCategoryFilter:x,userCategories:b,onAddCategory:C,onRemoveCategory:I,onSetSelectionMode:S,onOpenSettings:V,onAddGoal:U,currentFolderId:B,folders:T,onSyncSharedFolder:w,isSyncing:A,isSyncingData:k,onManualSync:D,activeUsers:L,editingStates:N,onToggleCollaboration:Ve,onUpdateCollaborationSettings:Ze,isMobileScreen:je})=>{const[ye,Z]=z.useState(!1),[he,ve]=z.useState(!1),Ie=B?T.find(Se=>Se.id===B):null,Oe=Ie==null?void 0:Ie.collaborationSettings;Oe!=null&&Oe.enabled||Ie!=null&&Ie.isShared,z.useEffect(()=>{const Se=()=>{Z(!1),ve(!1)};return document.addEventListener("click",Se),document.addEventListener("touchstart",Se),()=>{document.removeEventListener("click",Se),document.removeEventListener("touchstart",Se)}},[]);const tt=Se=>{Se.stopPropagation(),Z(Qe=>!Qe)},Je=Se=>{Se.stopPropagation()};return m.jsxs("header",{children:[m.jsx("div",{className:"header-left",children:e&&m.jsx("button",{onClick:i,className:"header-action-button",children:t("cancel_selection_button_label")})}),m.jsxs("div",{className:"header-title-group",children:[m.jsx("h1",{children:t("my_goals_title")}),!e&&m.jsxs("div",{className:"header-inline-actions",children:[m.jsx("button",{onClick:l,className:"header-icon-button","aria-label":t(a?"list_view_button_aria":"calendar_view_button_aria"),children:a?Ee.list:Ee.calendar}),m.jsxs("div",{className:"filter-sort-container",children:[m.jsx("button",{onClick:tt,onTouchStart:tt,className:"header-icon-button","aria-label":t("filter_sort_button_aria"),children:u?m.jsx("div",{className:"spinner"}):Ee.filter}),ye&&m.jsxs("div",{className:"profile-popover filter-sort-popover",onClick:Je,onTouchStart:Je,children:[m.jsx("div",{className:"popover-section",children:m.jsx("button",{onClick:()=>{S(),Z(!1)},className:"popover-action-button",children:m.jsx("span",{children:t("select_button_label")})})}),m.jsxs("div",{className:"popover-section",children:[m.jsx("h4",{children:t("filter_title")}),m.jsxs("button",{onClick:()=>{v("all")},className:`popover-action-button ${g==="all"?"active":""}`,children:[m.jsx("span",{children:t("filter_all")}),g==="all"&&Ee.check]}),m.jsxs("button",{onClick:()=>{v("active")},className:`popover-action-button ${g==="active"?"active":""}`,children:[m.jsx("span",{children:t("filter_active")}),g==="active"&&Ee.check]}),m.jsxs("button",{onClick:()=>{v("completed")},className:`popover-action-button ${g==="completed"?"active":""}`,children:[m.jsx("span",{children:t("filter_completed")}),g==="completed"&&Ee.check]})]}),m.jsxs("div",{className:"popover-section",children:[m.jsxs("h4",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[m.jsx("span",{children:t("filter_category")}),m.jsx("button",{onClick:()=>{const Se=prompt("새 카테고리 이름: (New category name:)");Se&&Se.trim()&&!b.includes(Se.trim())&&C(Se.trim())},style:{background:"none",border:"none",color:"var(--primary-color)",cursor:"pointer",fontSize:"1.2rem",padding:"0"},children:"+"})]}),m.jsxs("button",{onClick:()=>{x("all")},className:`popover-action-button ${E==="all"?"active":""}`,children:[m.jsx("span",{children:t("category_all")}),E==="all"&&Ee.check]}),b.map(Se=>m.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[m.jsxs("button",{onClick:()=>{x(Se)},className:`popover-action-button ${E===Se?"active":""}`,style:{flex:1,justifyContent:"space-between"},children:[m.jsx("span",{children:Se}),E===Se&&Ee.check]}),!["school","work","personal","other"].includes(Se)&&m.jsx("button",{onClick:()=>I(Se),style:{background:"rgba(255, 59, 48, 0.1)",border:"none",color:"var(--danger-color)",borderRadius:"4px",padding:"4px 8px",cursor:"pointer",fontSize:"0.8rem"},children:"✕"})]},Se))]}),m.jsxs("div",{className:"popover-section",children:[m.jsx("h4",{children:t("sort_title")}),m.jsxs("button",{onClick:()=>{p("manual")},className:`popover-action-button ${f==="manual"?"active":""}`,children:[m.jsx("span",{children:t("sort_label_manual")}),f==="manual"&&Ee.check]}),m.jsxs("button",{onClick:()=>{p("deadline")},className:`popover-action-button ${f==="deadline"?"active":""}`,children:[m.jsx("span",{children:t("sort_label_deadline")}),f==="deadline"&&Ee.check]}),m.jsxs("button",{onClick:()=>{p("newest")},className:`popover-action-button ${f==="newest"?"active":""}`,children:[m.jsx("span",{children:t("sort_label_newest")}),f==="newest"&&Ee.check]}),m.jsxs("button",{onClick:()=>{p("alphabetical")},className:`popover-action-button ${f==="alphabetical"?"active":""}`,children:[m.jsx("span",{children:t("sort_label_alphabetical")}),f==="alphabetical"&&Ee.check]}),m.jsxs("button",{onClick:()=>{p("ai")},className:"popover-action-button with-icon",children:[m.jsx("span",{className:"popover-button-icon",children:Ee.ai}),m.jsx("span",{children:t(u?"ai_sorting_button":"sort_label_ai")})]}),m.jsx("button",{onClick:()=>{p("ai"),Z(!1)},className:"popover-action-button",style:{backgroundColor:"rgba(88, 86, 214, 0.1)",marginTop:"8px",color:"var(--icon-color-indigo)"},children:m.jsx("span",{children:"💡 정렬 제안 보기"})})]})]})]}),m.jsx("button",{className:"header-icon-button","aria-label":t("sync_button_label")||"동기화",onClick:()=>{var Se;k||(B&&((Se=T.find(Qe=>Qe.id===B))!=null&&Se.isShared)?w():D())},disabled:k,style:{marginLeft:8},children:A?m.jsx("span",{className:"sync-spinner"}):Ee.refresh}),m.jsx("button",{onClick:V,className:"header-icon-button","aria-label":t("settings_title"),children:Ee.settings})]})]}),m.jsx("div",{className:"header-right",children:e?m.jsxs(m.Fragment,{children:[n===0?m.jsx("button",{onClick:o,className:"header-action-button",children:t("select_all_button_label")}):n===r?m.jsx("button",{onClick:i,className:"header-action-button",children:t("cancel_selection_button_label")}):m.jsxs(m.Fragment,{children:[m.jsx("button",{onClick:o,className:"header-action-button",children:t("select_all_button_label")}),m.jsx("button",{onClick:i,className:"header-action-button",children:t("cancel_selection_button_label")})]}),n>0&&m.jsx("button",{onClick:s,className:"header-action-button destructive",children:t("delete_selected_button_label").replace("{count}",String(n))})]}):!je&&U&&m.jsx("button",{onClick:U,className:"header-icon-button","aria-label":t("add_new_goal_button_label"),children:Ee.add})})]})},L3=({todos:t,onToggleComplete:e,onDelete:n,onEdit:r,onInfo:i,t:s,filter:o,randomEncouragement:a,isSelectionMode:l,selectedTodoIds:u,onSelectTodo:f,folders:p,onMoveToFolder:g})=>{if(t.length===0){const v=`empty_message_${o}`;return m.jsx("div",{className:"empty-message",children:m.jsx("p",{children:s(v)})})}return m.jsx("ul",{children:t.map(v=>m.jsx(F3,{todo:v,onToggleComplete:e,onDelete:n,onEdit:r,onInfo:i,t:s,isSelectionMode:l,isSelected:u.has(v.id),onSelect:f,folders:p,onMoveToFolder:g},v.id))})},F3=uw.memo(({todo:t,onToggleComplete:e,onDelete:n,onEdit:r,onInfo:i,t:s,isSelectionMode:o,isSelected:a,onSelect:l,folders:u,onMoveToFolder:f})=>{var E;const p=()=>{o&&l(t.id)},g={school:"🎓",work:"💼",personal:"👤",other:"📌"},v=x=>x?{school:s("category_school"),work:s("category_work"),personal:s("category_personal"),other:s("category_other")}[x]||x:"";return m.jsx("li",{className:`${t.completed?"completed":""} ${o?"selection-mode":""} ${a?"selected":""}`,onClick:p,children:m.jsxs("div",{className:"swipeable-content",children:[m.jsxs("label",{className:"checkbox-container",onClick:x=>x.stopPropagation(),children:[m.jsx("input",{type:"checkbox",checked:t.completed,onChange:()=>e(t.id)}),m.jsx("span",{className:"checkmark"})]}),m.jsxs("div",{className:"todo-text-with-streak",children:[m.jsx("span",{className:"todo-text",children:t.wish}),t.isRecurring&&t.streak>0&&m.jsxs("div",{className:"streak-indicator",children:[Ee.flame,m.jsx("span",{children:t.streak})]})]}),m.jsxs("div",{className:"todo-actions-and-meta",children:[m.jsxs("div",{className:"todo-meta-badges",children:[t.category&&m.jsxs("span",{style:{backgroundColor:"rgba(88, 86, 214, 0.1)",color:"var(--icon-color-indigo)",padding:"4px 8px",borderRadius:"4px",fontSize:"0.8rem",marginRight:"4px",display:"inline-flex",alignItems:"center",gap:"4px",whiteSpace:"nowrap"},children:[g[t.category]||"📌"," ",v(t.category)]}),t.deadline&&m.jsx("span",{className:"todo-deadline",children:D3(t.deadline,s)}),t.collaborators&&t.collaborators.length>0&&m.jsxs("span",{style:{backgroundColor:"rgba(52, 199, 89, 0.1)",color:"var(--success-color)",padding:"4px 8px",borderRadius:"4px",fontSize:"0.85rem",marginLeft:"4px",display:"inline-flex",alignItems:"center",gap:"4px"},children:["🤝 ",t.collaborators.length]}),t.folderId&&m.jsxs("span",{style:{backgroundColor:"rgba(100, 150, 200, 0.15)",color:"var(--primary-color)",padding:"4px 8px",borderRadius:"4px",fontSize:"0.8rem",marginLeft:"4px",display:"inline-flex",alignItems:"center",gap:"4px",whiteSpace:"nowrap"},children:["📁 ",((E=u.find(x=>x.id===t.folderId))==null?void 0:E.name)||"Unknown"]})]}),m.jsxs("div",{className:"todo-buttons",children:[m.jsxs("select",{onClick:x=>x.stopPropagation(),onChange:x=>{f(t.id,x.target.value==="root"?null:x.target.value)},defaultValue:t.folderId||"root",style:{padding:"4px 8px",borderRadius:"4px",border:"1px solid var(--border-color)",backgroundColor:"var(--card-bg-color)",color:"var(--text-color)",cursor:"pointer",fontSize:"0.85rem",fontFamily:"inherit"},title:"폴더 선택",children:[m.jsx("option",{value:"root",children:"📁 나의 목표"}),u.map(x=>m.jsx("option",{value:x.id,children:x.name},x.id))]}),m.jsx("button",{onClick:x=>{x.stopPropagation(),r(t)},className:"info-button edit-button","aria-label":s("edit_button_aria"),children:Ee.edit}),m.jsx("button",{onClick:x=>{x.stopPropagation(),n(t.id)},className:"delete-button","aria-label":s("delete_button"),children:Ee.delete}),m.jsx("button",{onClick:x=>{x.stopPropagation(),i(t)},className:"info-button","aria-label":s("info_button_aria"),children:Ee.info})]})]})]})})}),mo=({onClose:t,children:e,className:n="",isClosing:r,size:i="large"})=>{const s={small:"modal-content-small",medium:"modal-content-medium",large:"modal-content-large"}[i];return m.jsx("div",{className:`modal-backdrop ${r?"is-closing":""}`,onClick:t,children:m.jsx("div",{className:`modal-content ${s} ${n} ${r?"is-closing":""}`,onClick:o=>o.stopPropagation(),children:e})})},Za=t=>{const[e,n]=z.useState(!1);return[e,()=>{n(!0),setTimeout(t,500)}]},U3=({step:t,t:e,createAI:n,...r})=>{const{wish:i,setWish:s,outcome:o,setOutcome:a,obstacle:l,setObstacle:u,plan:f,setPlan:p,isRecurring:g,setIsRecurring:v,recurringDays:E,setRecurringDays:x,deadline:b,setDeadline:C,noDeadline:I,setNoDeadline:S,category:V,setCategory:U,userCategories:B,errors:T,language:w}=r,[A,k]=z.useState(!1),[D,L]=z.useState(""),[N,Ve]=z.useState(""),Ze=async(je,ye)=>{if(ye){k(!0),L(""),Ve("");try{const Z=n();if(!Z){Ve("AI 기능을 사용하려면 설정에서 API 키를 입력해주세요."),k(!1);return}const he=`Provide concise, actionable feedback on this part of a WOOP goal: ${je} - "${ye}". The feedback should be helpful and encouraging, in ${w==="ko"?"Korean":"English"}. Keep it to 1-2 sentences.`,ve=await Z.models.generateContent({model:"gemini-2.5-flash",contents:he});L(ve.text)}catch(Z){console.error("AI Feedback Error:",Z),Ve("Failed to get AI feedback.")}finally{k(!1)}}};switch(t){case 1:return m.jsxs("div",{children:[m.jsx("h3",{children:e("wish_label")}),m.jsxs("div",{className:"step-guidance",children:[m.jsx("p",{className:"tip",children:e("wish_tip")}),m.jsx("p",{className:"example",children:e("wish_example")})]}),m.jsx("textarea",{value:i,onChange:ye=>{s(ye.target.value),L(""),Ve("")},placeholder:e("wish_label"),className:T.wish?"input-error":"",rows:3}),T.wish&&m.jsxs("p",{className:"field-error-message",children:[Ee.exclamation," ",e("error_wish_required")]}),m.jsxs("div",{className:"ai-feedback-section",children:[m.jsxs("button",{onClick:()=>Ze("Wish",i),disabled:!i.trim()||A,className:"ai-feedback-button",children:[A?m.jsx("div",{className:"spinner-small"}):"🤖",m.jsx("span",{children:e(A?"ai_analyzing":"ai_coach_suggestion")})]}),D&&m.jsx("div",{className:"ai-feedback-bubble",children:D}),N&&m.jsx("div",{className:"ai-feedback-bubble error",children:N})]})]});case 2:return m.jsxs("div",{children:[m.jsx("h3",{children:e("outcome_label")}),m.jsxs("div",{className:"step-guidance",children:[m.jsx("p",{className:"tip",children:e("outcome_tip")}),m.jsx("p",{className:"example",children:e("outcome_example")})]}),m.jsx("textarea",{value:o,onChange:ye=>{a(ye.target.value),L(""),Ve("")},placeholder:e("outcome_label"),className:T.outcome?"input-error":"",rows:3}),T.outcome&&m.jsxs("p",{className:"field-error-message",children:[Ee.exclamation," ",e("error_outcome_required")]}),m.jsxs("div",{className:"ai-feedback-section",children:[m.jsxs("button",{onClick:()=>Ze("Outcome",o),disabled:!o.trim()||A,className:"ai-feedback-button",children:[A?m.jsx("div",{className:"spinner-small"}):"🤖",m.jsx("span",{children:e(A?"ai_analyzing":"ai_coach_suggestion")})]}),D&&m.jsx("div",{className:"ai-feedback-bubble",children:D}),N&&m.jsx("div",{className:"ai-feedback-bubble error",children:N})]})]});case 3:return m.jsxs("div",{children:[m.jsx("h3",{children:e("obstacle_label")}),m.jsxs("div",{className:"step-guidance",children:[m.jsx("p",{className:"tip",children:e("obstacle_tip")}),m.jsx("p",{className:"example",children:e("obstacle_example")})]}),m.jsx("textarea",{value:l,onChange:ye=>{u(ye.target.value),L(""),Ve("")},placeholder:e("obstacle_label"),className:T.obstacle?"input-error":"",rows:3}),T.obstacle&&m.jsxs("p",{className:"field-error-message",children:[Ee.exclamation," ",e("error_obstacle_required")]}),m.jsxs("div",{className:"ai-feedback-section",children:[m.jsxs("button",{onClick:()=>Ze("Obstacle",l),disabled:!l.trim()||A,className:"ai-feedback-button",children:[A?m.jsx("div",{className:"spinner-small"}):"🤖",m.jsx("span",{children:e(A?"ai_analyzing":"ai_coach_suggestion")})]}),D&&m.jsx("div",{className:"ai-feedback-bubble",children:D}),N&&m.jsx("div",{className:"ai-feedback-bubble error",children:N})]})]});case 4:return m.jsxs("div",{children:[m.jsx("h3",{children:e("plan_label")}),m.jsxs("div",{className:"step-guidance",children:[m.jsx("p",{className:"tip",children:e("plan_tip")}),m.jsx("p",{className:"example",children:e("plan_example")})]}),m.jsx("textarea",{value:f,onChange:ye=>{p(ye.target.value),L(""),Ve("")},placeholder:e("plan_label"),className:T.plan?"input-error":"",rows:3}),T.plan&&m.jsxs("p",{className:"field-error-message",children:[Ee.exclamation," ",e("error_plan_required")]}),m.jsxs("div",{className:"ai-feedback-section",children:[m.jsxs("button",{onClick:()=>Ze("Plan",f),disabled:!f.trim()||A,className:"ai-feedback-button",children:[A?m.jsx("div",{className:"spinner-small"}):"🤖",m.jsx("span",{children:e(A?"ai_analyzing":"ai_coach_suggestion")})]}),D&&m.jsx("div",{className:"ai-feedback-bubble",children:D}),N&&m.jsx("div",{className:"ai-feedback-bubble error",children:N})]})]});case 5:const je=ye=>{const Z=[...E],he=Z.indexOf(ye);he>-1?Z.splice(he,1):Z.push(ye),x(Z)};return m.jsxs("div",{children:[m.jsxs("h3",{children:[e("recurrence_label")," & ",e("deadline_label")," & ",e("category_label")]}),m.jsxs("div",{className:"step-guidance",children:[m.jsx("p",{className:"tip",children:e("recurrence_tip")}),m.jsx("p",{className:"example",children:e("recurrence_example")})]}),m.jsxs("label",{className:"settings-item standalone-toggle",children:[m.jsx("span",{style:{fontWeight:500},children:e("recurrence_option_daily")}),m.jsxs("label",{className:"theme-toggle-switch",children:[m.jsx("input",{type:"checkbox",checked:g,onChange:ye=>v(ye.target.checked)}),m.jsx("span",{className:"slider round"})]})]}),g&&m.jsx("div",{className:"day-picker",children:e("day_names_short_picker").map((ye,Z)=>m.jsx("button",{onClick:()=>je(Z),className:`day-button ${E.includes(Z)?"selected":""}`,children:ye},Z))}),T.recurringDays&&m.jsxs("p",{className:"field-error-message",children:[Ee.exclamation," ",e("error_day_required")]}),m.jsx("hr",{}),m.jsx("div",{className:"step-guidance",style:{marginTop:"16px"},children:m.jsx("p",{className:"tip",children:e("deadline_tip")})}),m.jsxs("label",{className:"settings-item standalone-toggle",children:[m.jsx("span",{style:{fontWeight:500},children:e("deadline_option_no_deadline")}),m.jsxs("label",{className:"theme-toggle-switch",children:[m.jsx("input",{type:"checkbox",checked:I,onChange:ye=>S(ye.target.checked)}),m.jsx("span",{className:"slider round"})]})]}),!I&&m.jsx("input",{type:"date",value:b,onChange:ye=>C(ye.target.value),className:T.deadline?"input-error":"",style:{marginTop:"12px"}}),T.deadline&&m.jsxs("p",{className:"field-error-message",children:[Ee.exclamation," ",e("error_deadline_required")]}),m.jsx("hr",{}),m.jsx("div",{className:"step-guidance",style:{marginTop:"16px"},children:m.jsx("p",{className:"tip",children:e("category_label")})}),m.jsx("div",{style:{display:"grid",gridTemplateColumns:B&&B.length>2?"repeat(2, 1fr)":"repeat(1, 1fr)",gap:"8px",marginTop:"12px"},children:B&&B.map(ye=>m.jsx("button",{onClick:()=>U(ye),className:`category-button ${V===ye?"active":""}`,children:ye},ye))})]});default:return null}},O3=({onGenerate:t,t:e})=>{const[n,r]=z.useState(""),[i,s]=z.useState(""),[o,a]=z.useState(""),[l,u]=z.useState(""),[f,p]=z.useState(""),{endDate:g,generatedCount:v}=z.useMemo(()=>{const x=parseInt(i,10),b=parseInt(o,10);if(!l||!x||x<=0||!b||b<=0)return{endDate:"",generatedCount:0};const C=Math.ceil(x/b),I=new Date(l),S=new Date(I);return S.setDate(I.getDate()+C-1),{endDate:S.toISOString().split("T")[0],generatedCount:C}},[i,o,l]),E=()=>{const x=parseInt(i,10),b=parseInt(o,10);if(!n.trim()||!l||!x||x<=0||!b||b<=0){p(e("automation_error_all_fields"));return}const C=[],I=Math.ceil(x/b),S=new Date(l);for(let V=0;V<I;V++){const U=new Date(S);U.setDate(S.getDate()+V);const B=V*b+1,T=Math.min((V+1)*b,x),w=`${n.trim()} ${B}`+(T>B?` - ${T}`:"");C.push({wish:w,outcome:"",obstacle:"",plan:"",isRecurring:!1,recurringDays:[],deadline:U.toISOString().split("T")[0],category:"personal"})}p(""),t(C)};return m.jsxs("div",{className:"automation-form-container",children:[m.jsx("h3",{children:e("automation_title")}),m.jsxs("div",{className:"form-group",children:[m.jsx("label",{children:e("automation_base_name_label")}),m.jsx("input",{type:"text",value:n,onChange:x=>r(x.target.value),placeholder:e("automation_base_name_placeholder")})]}),m.jsxs("div",{className:"automation-form-grid",children:[m.jsxs("div",{className:"form-group",children:[m.jsx("label",{children:e("automation_total_units_label")}),m.jsx("input",{type:"number",value:i,onChange:x=>s(x.target.value),placeholder:e("automation_total_units_placeholder")})]}),m.jsxs("div",{className:"form-group",children:[m.jsx("label",{children:e("automation_units_per_day_label")}),m.jsx("input",{type:"number",value:o,onChange:x=>a(x.target.value),placeholder:"예: 5"})]})]}),m.jsxs("div",{className:"automation-form-grid",children:[m.jsxs("div",{className:"form-group",children:[m.jsx("label",{children:e("automation_start_date_label")}),m.jsx("input",{type:"date",value:l,onChange:x=>u(x.target.value)})]}),m.jsxs("div",{className:"form-group",children:[m.jsx("label",{children:e("automation_end_date_label")}),m.jsx("input",{type:"date",value:g,readOnly:!0})]})]}),f&&m.jsxs("p",{className:"field-error-message",style:{justifyContent:"center"},children:[Ee.exclamation," ",f]}),m.jsx("div",{className:"goal-assistant-nav",children:m.jsx("button",{onClick:E,className:"primary",disabled:v===0,children:e("automation_generate_button").replace("{count}",String(v))})})]})},QI=({onClose:t,onAddTodo:e,onAddMultipleTodos:n,onEditTodo:r,existingTodo:i,t:s,language:o,createAI:a,userCategories:l=["personal"]})=>{const[u,f]=Za(t),[p,g]=z.useState("woop"),[v,E]=z.useState(1),[x,b]=z.useState("forward"),[C,I]=z.useState((i==null?void 0:i.wish)||""),[S,V]=z.useState((i==null?void 0:i.outcome)||""),[U,B]=z.useState((i==null?void 0:i.obstacle)||""),[T,w]=z.useState((i==null?void 0:i.plan)||""),[A,k]=z.useState((i==null?void 0:i.isRecurring)||!1),[D,L]=z.useState((i==null?void 0:i.recurringDays)||[]),[N,Ve]=z.useState((i==null?void 0:i.deadline)||""),[Ze,je]=z.useState(!(i!=null&&i.deadline)),[ye,Z]=z.useState((i==null?void 0:i.category)||"personal"),[he,ve]=z.useState({}),[Ie,Oe]=z.useState(""),[tt,Je]=z.useState(""),[Se,Qe]=z.useState(""),[Gt,ur]=z.useState("personal"),zn=5,kn=Re=>{const zt={};return Re===1&&!C.trim()&&(zt.wish=!0),Re===2&&!S.trim()&&(zt.outcome=!0),Re===3&&!U.trim()&&(zt.obstacle=!0),Re===4&&!T.trim()&&(zt.plan=!0),Re===5&&(!Ze&&!N&&(zt.deadline=!0),A&&D.length===0&&(zt.recurringDays=!0)),ve(zt),Object.keys(zt).length===0},cr=()=>{kn(v)&&(v<zn?(b("forward"),E(Re=>Re+1)):$n())},dr=()=>{v>1&&(b("backward"),E(Re=>Re-1))},$n=()=>{if(!kn(5))return;const Re={wish:C,outcome:S,obstacle:U,plan:T,isRecurring:A,recurringDays:D,deadline:Ze?"":N,category:ye};i&&r?r({...i,...Re}):e&&(e(Re),f())},hr=()=>{Ie.trim()&&(e&&e({wish:Ie.trim(),outcome:Ie.trim(),obstacle:"",plan:"",isRecurring:!1,recurringDays:[],deadline:tt,category:Gt}),Oe(""),Je(""),Qe(""),ur("personal"),f())};return m.jsxs(mo,{onClose:f,isClosing:u,className:"goal-assistant-modal",children:[m.jsxs("div",{className:"goal-assistant-header",children:[m.jsxs("div",{className:"goal-assistant-header-left",children:[v>1&&p==="woop"&&m.jsx("button",{onClick:dr,className:"settings-back-button",children:Ee.back}),m.jsx("button",{onClick:f,className:"secondary header-cancel-button",children:s("cancel_button")})]}),m.jsx("h2",{children:p==="woop"?"새로운 목표":p==="quick"?"새로운 할일":p==="automation"?"새로운 계획":s("goal_assistant_title")}),m.jsxs("div",{className:"goal-assistant-header-right",children:[p==="woop"&&m.jsx("button",{onClick:cr,className:"primary header-next-button",children:s(v===zn?i?"save_button":"add_button":"next_button")}),p==="quick"&&m.jsx("button",{onClick:hr,className:"primary header-next-button",disabled:!Ie.trim(),children:s("add_button")})]})]}),!i&&m.jsx("div",{className:"modal-mode-switcher-container",children:m.jsxs("div",{className:"modal-mode-switcher",children:[m.jsx("button",{onClick:()=>g("woop"),className:p==="woop"?"active":"",children:s("goal_assistant_mode_woop")}),m.jsx("button",{onClick:()=>g("quick"),className:p==="quick"?"active":"",children:"새로운 할일"}),m.jsx("button",{onClick:()=>g("automation"),className:p==="automation"?"active":"",children:s("goal_assistant_mode_automation")})]})}),m.jsx("div",{className:"goal-assistant-body",children:p==="woop"?m.jsxs(m.Fragment,{children:[m.jsx("div",{className:"progress-bar-container",children:m.jsx("div",{className:"progress-bar",style:{width:`${v/zn*100}%`}})}),m.jsx("div",{className:`goal-assistant-step-content-animator ${x}`,children:m.jsx(U3,{step:v,t:s,createAI:a,wish:C,setWish:I,outcome:S,setOutcome:V,obstacle:U,setObstacle:B,plan:T,setPlan:w,isRecurring:A,setIsRecurring:k,recurringDays:D,setRecurringDays:L,deadline:N,setDeadline:Ve,noDeadline:Ze,setNoDeadline:je,category:ye,setCategory:Z,userCategories:l,errors:he,language:o})},v)]}):p==="quick"?m.jsxs("div",{style:{padding:"24px 16px"},children:[m.jsxs("div",{style:{marginBottom:"20px"},children:[m.jsx("h3",{style:{fontSize:"1rem",fontWeight:"600",marginBottom:"12px"},children:"새로운 할일"}),m.jsx("div",{className:"step-guidance",children:m.jsx("p",{className:"tip",children:"빠르게 할일을 추가하세요"})}),m.jsx("textarea",{value:Ie,onChange:Re=>Oe(Re.target.value),placeholder:"예: 선물 사기",rows:2,style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontSize:"14px",fontFamily:"inherit",resize:"none",marginTop:"12px"},onKeyPress:Re=>{Re.key==="Enter"&&Re.ctrlKey&&hr()}})]}),m.jsx("hr",{}),m.jsxs("div",{style:{marginBottom:"20px"},children:[m.jsx("div",{className:"step-guidance",style:{marginTop:"16px"},children:m.jsx("p",{className:"tip",children:"마감일 설정 (선택)"})}),m.jsxs("label",{className:"settings-item standalone-toggle",style:{marginTop:"12px"},children:[m.jsx("span",{style:{fontWeight:"500"},children:"마감일 설정"}),m.jsxs("label",{className:"theme-toggle-switch",children:[m.jsx("input",{type:"checkbox",checked:!!tt,onChange:Re=>Je(Re.target.checked?new Date().toISOString().split("T")[0]:"")}),m.jsx("span",{className:"slider round"})]})]}),tt&&m.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",marginTop:"12px"},children:[m.jsxs("div",{children:[m.jsx("label",{style:{fontSize:"12px",opacity:.7,display:"block",marginBottom:"4px"},children:"날짜"}),m.jsx("input",{type:"date",value:tt,onChange:Re=>Je(Re.target.value),style:{width:"100%",padding:"10px",borderRadius:"6px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontSize:"13px"}})]}),m.jsxs("div",{children:[m.jsx("label",{style:{fontSize:"12px",opacity:.7,display:"block",marginBottom:"4px"},children:"시간 (선택)"}),m.jsx("input",{type:"time",value:Se,onChange:Re=>Qe(Re.target.value),style:{width:"100%",padding:"10px",borderRadius:"6px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontSize:"13px"}})]})]})]}),m.jsx("hr",{}),m.jsxs("div",{style:{marginBottom:"24px"},children:[m.jsx("div",{className:"step-guidance",style:{marginTop:"16px"},children:m.jsx("p",{className:"tip",children:s("category_label")})}),m.jsx("div",{style:{display:"grid",gridTemplateColumns:l&&l.length>2?"repeat(2, 1fr)":"repeat(1, 1fr)",gap:"8px",marginTop:"12px"},children:l&&l.map(Re=>m.jsx("button",{onClick:()=>ur(Re),className:`category-button ${Gt===Re?"active":""}`,children:Re},Re))})]})]}):n&&m.jsx(O3,{onGenerate:n,t:s})})]})},B3=({todo:t,onClose:e,t:n,createAI:r,onOpenCollaboration:i,userCategories:s,onUpdateGoal:o})=>{const[a,l]=Za(e),[u,f]=z.useState(""),[p,g]=z.useState(!1),[v,E]=z.useState(!1),x=async()=>{g(!0),f(""),E(!1);try{const b=r();if(!b){f("AI 기능을 사용하려면 설정에서 API 키를 입력해주세요."),g(!1);return}const C=`Based on the WOOP method, provide a concise and encouraging suggestion for the following goal: Wish: "${t.wish}", Best Outcome: "${t.outcome}", Obstacle: "${t.obstacle}", Plan: "${t.plan}". Focus on strengthening the plan or reframing the obstacle.`,I=await b.models.generateContent({model:"gemini-2.5-flash",contents:C});f(I.text)}catch(b){console.error(b),E(!0)}finally{g(!1)}};return m.jsxs(mo,{onClose:l,isClosing:a,className:"info-modal",children:[m.jsxs("div",{className:"info-modal-content",children:[m.jsx("h2",{children:n("goal_details_modal_title")}),m.jsxs("div",{className:"info-section",children:[m.jsx("h4",{children:n("wish_label")}),m.jsx("p",{children:t.wish})]}),m.jsxs("div",{className:"info-section",children:[m.jsx("h4",{children:n("outcome_label")}),m.jsx("p",{children:t.outcome})]}),m.jsxs("div",{className:"info-section",children:[m.jsx("h4",{children:n("obstacle_label")}),m.jsx("p",{children:t.obstacle})]}),m.jsxs("div",{className:"info-section",children:[m.jsx("h4",{children:n("plan_label")}),m.jsx("p",{children:t.plan})]}),s&&s.length>0&&o&&m.jsxs("div",{className:"info-section",style:{borderTop:"1px solid var(--border-color)",paddingTop:"16px",marginTop:"16px"},children:[m.jsx("h4",{style:{marginBottom:"12px"},children:n("category_label")}),m.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:s.map(b=>m.jsx("button",{onClick:()=>{o({...t,category:b}),l()},className:`category-button ${t.category===b?"active":""}`,style:{padding:"8px 16px",borderRadius:"20px",border:t.category===b?"2px solid var(--primary-color)":"2px solid var(--border-color)",backgroundColor:t.category===b?"var(--primary-color)":"transparent",color:t.category===b?"white":"var(--text-color)",cursor:"pointer",fontSize:"14px",fontWeight:t.category===b?"600":"500",transition:"all 0.25s ease",whiteSpace:"nowrap",display:"inline-block",boxShadow:t.category===b?"0 2px 8px rgba(88, 86, 214, 0.2)":"none"},children:b},b))})]}),m.jsxs("div",{className:"ai-analysis-section",children:[m.jsx("h4",{children:n("ai_coach_suggestion")}),p?m.jsx("p",{children:n("ai_analyzing")}):u?m.jsx("p",{children:u}):v?m.jsx("p",{className:"ai-error",children:n("ai_sort_error_message")}):m.jsx("button",{onClick:x,className:"feedback-button",children:n("ai_coach_suggestion")})]})]}),m.jsxs("div",{className:"modal-buttons",children:[i&&m.jsx("button",{onClick:()=>{i(t),l()},className:"secondary",children:"🤝 협업"}),m.jsx("button",{onClick:l,className:"primary",children:n("close_button")})]})]})},q3=({folder:t,onClose:e,t:n,googleUser:r,onUpdateCollaborators:i,setAlertConfig:s})=>{const[o,a]=Za(e),[l,u]=z.useState(""),[f,p]=z.useState(!1),[g,v]=z.useState(""),[E,x]=z.useState(!1),b=async()=>{if(!(!t||!r)){p(!0);try{if(!g||g.trim().length===0){s({title:"암호 설정 필수",message:"보안을 위해 공유 링크에 반드시 암호를 설정해주세요.",confirmText:"확인",onConfirm:()=>{}}),p(!1);return}const V={type:"folder_share",folderId:t.id,folderName:t.name,folderColor:t.color,goals:[],sharedBy:r==null?void 0:r.email,ownerId:r==null?void 0:r.uid,sharedAt:new Date().toISOString(),password:g},U=at(me,"users",r.uid,"folders"),B=Le(U,t.id),T=t.collaborators||[];await _t(B,{collaborators:T,shareInfo:{password:g,createdAt:new Date().toISOString()},updatedAt:new Date().toISOString()},{merge:!0});const w=ig(JSON.stringify(V)),A=`${window.location.origin}${window.location.pathname}?folder_share=${encodeURIComponent(w)}`,k=await rR(A);u(k),s({title:"공유 링크 생성 완료",message:"클립보드에 복사되었습니다. 협업자에게 공유해주세요!",confirmText:"확인",onConfirm:()=>{navigator.clipboard.writeText(k)}})}catch(V){console.error("공유 링크 생성 실패:",V),s({title:"생성 실패",message:"공유 링크 생성에 실패했습니다. 다시 시도해주세요.",confirmText:"확인",onConfirm:()=>{}})}finally{p(!1)}}},C=()=>{l&&navigator.clipboard.writeText(l).then(()=>{s({title:"복사 완료",message:"링크가 클립보드에 복사되었습니다.",confirmText:"확인",onConfirm:()=>{}})})},I=async V=>{if(!(!t||!r))try{const U=at(me,"users",r.uid,"folders"),B=Le(U,t.id),T=(t.collaborators||[]).filter(w=>w.userId!==V);await _t(B,{collaborators:T,updatedAt:new Date().toISOString()},{merge:!0}),i(t.id,T),s({title:"제거 완료",message:"협업자가 제거되었습니다.",confirmText:"확인",onConfirm:()=>{}})}catch(U){console.error("협업자 제거 실패:",U),s({title:"제거 실패",message:"협업자 제거에 실패했습니다.",confirmText:"확인",onConfirm:()=>{}})}},S=async(V,U)=>{if(!(!t||!r))try{const B=at(me,"users",r.uid,"folders"),T=Le(B,t.id),w=(t.collaborators||[]).map(A=>A.userId===V?{...A,role:U}:A);await _t(T,{collaborators:w,updatedAt:new Date().toISOString()},{merge:!0}),i(t.id,w),s({title:"권한 변경 완료",message:`협업자의 권한이 ${U==="editor"?"편집자":"뷰어"}로 변경되었습니다.`,confirmText:"확인",onConfirm:()=>{}})}catch(B){console.error("권한 변경 실패:",B)}};return t?m.jsxs(mo,{onClose:a,isClosing:o,className:"goal-assistant-modal",children:[m.jsxs("div",{className:"goal-assistant-header",children:[m.jsx("div",{className:"goal-assistant-header-left"}),m.jsxs("h2",{children:[t.name," 폴더 공유"]}),m.jsx("div",{className:"goal-assistant-header-right",children:m.jsx("button",{onClick:a,className:"close-button",children:Ee.close})})]}),m.jsx("div",{className:"goal-assistant-body",children:m.jsxs("div",{style:{padding:"24px 16px"},children:[m.jsxs("div",{style:{marginBottom:"20px"},children:[m.jsx("h3",{style:{fontSize:"1rem",fontWeight:"600",marginBottom:"12px"},children:"현재 협업자"}),t.collaborators&&t.collaborators.length>0?m.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:t.collaborators.map(V=>m.jsxs("div",{className:"settings-item",style:{padding:"12px",backgroundColor:"var(--card-bg-color)",borderRadius:"8px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[m.jsxs("div",{style:{flex:1},children:[m.jsx("div",{style:{fontWeight:"500",fontSize:"0.95rem"},children:V.email}),V.role==="owner"?m.jsx("div",{style:{fontSize:"0.85rem",color:"var(--text-secondary-color)",marginTop:"2px"},children:"소유자"}):m.jsxs("select",{value:V.role,onChange:U=>S(V.userId,U.target.value),style:{fontSize:"0.85rem",padding:"4px 8px",marginTop:"4px",borderRadius:"4px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",cursor:"pointer"},children:[m.jsx("option",{value:"editor",children:"편집자"}),m.jsx("option",{value:"viewer",children:"뷰어"})]})]}),V.role!=="owner"&&m.jsx("button",{onClick:()=>I(V.userId),style:{padding:"4px 12px",backgroundColor:"var(--danger-color)",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"0.8rem",marginLeft:"12px",whiteSpace:"nowrap"},children:"제거"})]},V.userId))}):m.jsx("div",{className:"step-guidance",children:m.jsx("p",{className:"tip",children:"협업자가 없습니다. 공유 링크로 협업자를 추가하세요."})})]}),m.jsx("hr",{style:{margin:"20px 0",border:"none",borderTop:"1px solid var(--border-color)"}}),m.jsxs("div",{style:{marginBottom:"20px"},children:[m.jsx("h3",{style:{fontSize:"1rem",fontWeight:"600",marginBottom:"12px"},children:"공유 링크로 협업자 추가"}),m.jsx("div",{className:"step-guidance",children:m.jsx("p",{className:"tip",children:"공유 링크를 생성하고 협업자에게 전달하면, 그들이 해당 폴더에 접근할 수 있습니다."})}),l?m.jsxs("div",{style:{marginTop:"16px",display:"flex",flexDirection:"column",gap:"12px"},children:[m.jsx("div",{style:{padding:"12px",backgroundColor:"var(--card-bg-color)",borderRadius:"8px",border:"1px solid var(--border-color)"},children:m.jsx("input",{type:"text",readOnly:!0,value:l,onClick:V=>V.target.select(),style:{width:"100%",padding:"10px",border:"1px solid var(--border-color)",borderRadius:"6px",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontSize:"0.85rem",boxSizing:"border-box",fontFamily:"monospace"}})}),m.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[m.jsx("button",{onClick:C,className:"primary",children:"클립보드 복사"}),m.jsx("button",{onClick:()=>{u(""),v(""),x(!1)},className:"secondary",children:"새로 생성"})]})]}):m.jsxs("div",{style:{marginTop:"16px",display:"flex",flexDirection:"column",gap:"12px"},children:[m.jsxs("label",{className:"settings-item standalone-toggle",children:[m.jsx("span",{style:{fontWeight:"500"},children:"링크에 암호 설정"}),m.jsxs("label",{className:"theme-toggle-switch",children:[m.jsx("input",{type:"checkbox",checked:E,onChange:V=>{x(V.target.checked),V.target.checked||v("")}}),m.jsx("span",{className:"slider round"})]})]}),E&&m.jsx("input",{type:"password",placeholder:"암호 입력",value:g,onChange:V=>v(V.target.value),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontFamily:"inherit",fontSize:"14px",boxSizing:"border-box"}}),m.jsx("button",{onClick:b,disabled:f||!g.trim(),className:"primary",style:{width:"100%",padding:"14px 0",backgroundColor:"var(--primary-color)",color:"white",border:"none",borderRadius:"24px",boxShadow:"0 2px 8px rgba(88,86,214,0.08)",fontWeight:700,fontSize:"16px",letterSpacing:"0.01em",cursor:f||!g.trim()?"not-allowed":"pointer",opacity:f||!g.trim()?.6:1,transition:"all 0.2s"},children:f?"링크 생성 중...":"공유 링크 생성"})]})]})]})}),m.jsxs("div",{className:"goal-assistant-nav",children:[m.jsx("div",{}),m.jsx("button",{onClick:a,className:"primary",children:"닫기"})]})]}):null},G3=({onClose:t,isDarkMode:e,onToggleDarkMode:n,themeMode:r,onThemeChange:i,backgroundTheme:s,onSetBackgroundTheme:o,onExportData:a,onImportData:l,setAlertConfig:u,onDeleteAllData:f,dataActionStatus:p,language:g,onSetLanguage:v,t:E,todos:x,setToastMessage:b,onOpenVersionInfo:C,onOpenUsageGuide:I,apiKey:S,onSetApiKey:V,isOfflineMode:U,onToggleOfflineMode:B,googleUser:T,onGoogleLogin:w,onGoogleLogout:A,onSyncDataToFirebase:k,onLoadDataFromFirebase:D,isGoogleLoggingIn:L=!1,isGoogleLoggingOut:N=!1,isSyncingData:Ve=!1,isLoadingData:Ze=!1,isAutoSyncEnabled:je,setIsAutoSyncEnabled:ye,onDiagnoseFirebase:Z})=>{const[he,ve]=Za(t),[Ie,Oe]=z.useState("appearance"),[tt,Je]=z.useState(""),[Se,Qe]=z.useState(!1),[Gt,ur]=z.useState("medium"),[zn,kn]=z.useState(null),cr=z.useRef(null),dr=[{id:"appearance",label:E("settings_section_background"),icon:Ee.background},{id:"notifications",label:E("settings_notifications"),icon:Ee.settings},{id:"general",label:E("settings_section_general"),icon:Ee.settings},{id:"data",label:E("settings_section_data"),icon:Ee.data}],$n=()=>u({title:E("delete_account_header"),message:E("delete_account_header_desc"),isDestructive:!0,confirmText:E("delete_all_data_button"),cancelText:E("cancel_button"),onConfirm:f,onCancel:()=>{}}),hr=async()=>{if(!x||x.length===0){kn(E("no_data_to_share"));return}Qe(!0);try{const Fe=JI(x),yn=`${window.location.origin}${window.location.pathname}?data=${encodeURIComponent(Fe)}`,ot=await rR(yn);Je(ot),ot!==yn&&ot.length<yn.length?b(E("short_url_created")):b(E("share_link_created"))}catch(Fe){console.error("Failed to create share link",Fe);const yn=JI(x),ot=`${window.location.origin}${window.location.pathname}?data=${encodeURIComponent(yn)}`;Je(ot),b(E("short_url_failed"))}finally{Qe(!1)}},Re=()=>{tt&&navigator.clipboard.writeText(tt).then(()=>{b(E("link_copied_toast"))})},zt=()=>{switch(Ie){case"appearance":return m.jsxs(m.Fragment,{children:[m.jsx("div",{className:"settings-section-header",children:E("settings_theme_mode")}),m.jsxs("div",{className:"settings-section-body",children:[m.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>i("light"),children:[m.jsxs("div",{children:[m.jsx("span",{children:E("theme_mode_light")}),m.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:E("theme_mode_light_desc")})]}),r==="light"&&Ee.check]}),m.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>i("dark"),children:[m.jsxs("div",{children:[m.jsx("span",{children:E("theme_mode_dark")}),m.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:E("theme_mode_dark_desc")})]}),r==="dark"&&Ee.check]}),m.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>i("system"),children:[m.jsxs("div",{children:[m.jsx("span",{children:E("theme_mode_system")}),m.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:E("theme_mode_system_desc")})]}),r==="system"&&Ee.check]})]}),m.jsx("div",{className:"settings-section-header",children:E("settings_background_header")}),m.jsx("div",{className:"settings-section-body",children:sg.map(Fe=>m.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>o(Fe.id),children:[m.jsx("span",{children:E(e?Fe.darkNameKey:Fe.lightNameKey)}),s===Fe.id&&Ee.check]},Fe.id))})]});case"notifications":return m.jsxs(m.Fragment,{children:[m.jsx("div",{className:"settings-section-header",children:E("notification_settings_title")}),m.jsxs("div",{className:"settings-section-body",children:[m.jsxs("label",{className:"settings-item",children:[m.jsxs("div",{children:[m.jsx("span",{children:E("notification_deadline")}),m.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:E("notification_deadline_desc")})]}),m.jsxs("div",{className:"theme-toggle-switch",children:[m.jsx("input",{type:"checkbox",defaultChecked:!0,onChange:()=>{}}),m.jsx("span",{className:"slider round"})]})]}),m.jsxs("label",{className:"settings-item",children:[m.jsxs("div",{children:[m.jsx("span",{children:E("notification_suggestion")}),m.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:"지정된 시간에 할일을 제안합니다."})]}),m.jsxs("div",{className:"theme-toggle-switch",children:[m.jsx("input",{type:"checkbox",defaultChecked:!0,onChange:()=>{}}),m.jsx("span",{className:"slider round"})]})]})]}),m.jsx("div",{className:"settings-section-header",children:"알림 권한"}),m.jsxs("div",{className:"settings-section-body",children:[m.jsx("button",{className:"settings-item action-item",onClick:async()=>{await tR()?(b("알림 권한이 허용되었습니다."),await nR()):b("알림 권한을 거부했습니다.")},children:m.jsx("span",{className:"action-text",children:"알림 권한 요청"})}),m.jsxs("div",{style:{fontSize:"12px",opacity:.7,padding:"12px",marginTop:"8px"},children:["현재 권한: ",Notification.permission==="granted"?"✓ 허용됨":Notification.permission==="denied"?"✗ 거부됨":"? 미정"]})]})]});case"general":return m.jsxs(m.Fragment,{children:[m.jsx("div",{className:"settings-section-header",children:E("settings_language")}),m.jsxs("div",{className:"settings-section-body",children:[m.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>v("ko"),children:[m.jsx("span",{children:"한국어"}),g==="ko"&&Ee.check]}),m.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>v("en"),children:[m.jsx("span",{children:"English"}),g==="en"&&Ee.check]})]}),m.jsx("div",{className:"settings-section-header",children:E("settings_api_key")}),m.jsxs("div",{className:"settings-section-body",children:[m.jsx("div",{className:"settings-item",children:m.jsx("input",{type:"password",placeholder:E("settings_api_key_placeholder"),value:S,onChange:Fe=>V(Fe.target.value),style:{width:"100%",padding:"8px",border:"1px solid var(--border-color)",borderRadius:"4px",backgroundColor:"var(--input-bg)"}})}),m.jsxs("label",{className:"settings-item",children:[m.jsxs("div",{children:[m.jsx("span",{children:E("settings_offline_mode")}),m.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:E("settings_offline_mode_desc")})]}),m.jsxs("div",{className:"theme-toggle-switch",children:[m.jsx("input",{type:"checkbox",checked:U,onChange:B}),m.jsx("span",{className:"slider round"})]})]})]}),m.jsx("div",{className:"settings-section-header",children:E("settings_section_info")}),m.jsxs("div",{className:"settings-section-body",children:[m.jsxs("div",{className:"settings-item nav-indicator",onClick:C,children:[m.jsx("span",{children:E("settings_version")}),m.jsxs("div",{className:"settings-item-value-with-icon",children:[m.jsx("span",{children:"1.5"}),Ee.forward]})]}),m.jsxs("div",{className:"settings-item nav-indicator",onClick:I,children:[m.jsx("span",{children:E("usage_guide_title")}),m.jsx("div",{className:"settings-item-value-with-icon",children:Ee.forward})]}),m.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>{kn(`이것은 매우 긴 알림 메시지입니다.

이 메시지는 여러 줄에 걸쳐 작성되었으며, 알림 팝업이 내용에 맞게 세로로 확장되는지 테스트하기 위한 목적으로 만들어졌습니다.

줄바꿈 문자도 포함되어 있고,
여러 문단으로 구성되어 있습니다.

이런 식으로 긴 에러 메시지나 안내 메시지가 표시될 때도 팝업이 적절하게 크기 조정이 되어야 합니다.

스크롤이 필요할 정도로 매우 긴 내용일 때는 스크롤바가 나타나야 하고, 버튼 영역은 항상 하단에 고정되어 있어야 합니다.`)},children:[m.jsx("span",{children:E("test_long_alert")}),m.jsxs("div",{className:"settings-item-value-with-icon",children:[m.jsx("span",{children:E("test_long_alert_desc")}),Ee.forward]})]}),m.jsxs("div",{className:"settings-item",children:[m.jsx("span",{children:E("settings_developer")}),m.jsx("span",{className:"settings-item-value",children:E("developer_name")})]}),m.jsxs("div",{className:"settings-item",children:[m.jsx("span",{children:E("settings_copyright")}),m.jsx("span",{className:"settings-item-value",children:E("copyright_notice")})]})]})]});case"data":return m.jsxs(m.Fragment,{children:[m.jsx("div",{className:"settings-section-header",children:"계정"}),m.jsx("div",{className:"settings-section-body",children:T?m.jsxs("div",{children:[m.jsxs("div",{className:"settings-item",children:[m.jsxs("div",{children:[m.jsx("span",{children:"Google 계정"}),m.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:T.email}),m.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:T.displayName})]}),m.jsx("span",{style:{color:"var(--success-color, #4CAF50)"},children:"✓"})]}),m.jsx("button",{className:"settings-item action-item",onClick:A,disabled:N,style:{opacity:N?.6:1},children:m.jsx("span",{className:"action-text",children:N?"⏳ 로그아웃 중...":"로그아웃"})})]}):m.jsxs("div",{children:[m.jsx("div",{style:{display:"flex",justifyContent:"center",padding:"12px 0"},children:m.jsxs("button",{onClick:w,disabled:L,style:{backgroundColor:L?"#E0E0E0":"white",border:"1px solid #D3D3D3",borderRadius:"24px",padding:"8px 20px",fontSize:"14px",fontWeight:"500",cursor:L?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"8px",color:L?"#999999":"#1F2937",transition:"all 0.2s",opacity:L?.6:1},children:[m.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",children:[m.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),m.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),m.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),m.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),L?"로그인 중...":"Google로 로그인"]})}),m.jsx("div",{style:{display:"flex",justifyContent:"center",padding:"8px 0"},children:m.jsx("button",{onClick:Z,style:{backgroundColor:"transparent",border:"1px solid #D3D3D3",borderRadius:"16px",padding:"4px 12px",fontSize:"12px",color:"#666",cursor:"pointer"},children:"🔍 로그인 문제 진단"})})]})}),T&&m.jsxs(m.Fragment,{children:[m.jsx("div",{className:"settings-section-header",children:"클라우드 동기화"}),m.jsxs("div",{className:"settings-section-body",children:[m.jsx("button",{className:"settings-item action-item",onClick:k,disabled:Ve,children:m.jsx("span",{className:"action-text",children:Ve?"저장중...":"클라우드에 저장"})}),m.jsx("button",{className:"settings-item action-item",onClick:D,disabled:Ze,children:m.jsx("span",{className:"action-text",children:Ze?"로드중...":"클라우드에서 불러오기"})}),m.jsxs("label",{className:"settings-item",children:[m.jsxs("div",{children:[m.jsx("span",{children:"자동 동기화"}),m.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:"목표 변경 시 자동으로 저장"})]}),m.jsxs("div",{className:"theme-toggle-switch",children:[m.jsx("input",{type:"checkbox",checked:je,onChange:Fe=>ye(Fe.target.checked)}),m.jsx("span",{className:"slider round"})]})]})]})]}),m.jsx("div",{className:"settings-section-header",children:E("settings_data_header")}),m.jsxs("div",{className:"settings-section-body",children:[m.jsx("div",{style:{fontSize:"12px",opacity:.7,marginBottom:"12px",padding:"8px",backgroundColor:"var(--bg-color-secondary)",borderRadius:"8px"},children:E("settings_data_header_desc")}),m.jsx("button",{className:"settings-item action-item",onClick:a,disabled:p!=="idle",children:m.jsx("span",{className:"action-text",children:E(p==="exporting"?"data_exporting":"settings_export_data")})}),m.jsxs("button",{className:"settings-item action-item",onClick:()=>{var Fe;return(Fe=cr.current)==null?void 0:Fe.click()},disabled:p!=="idle",children:[m.jsx("span",{className:"action-text",children:E(p==="importing"?"data_importing":"settings_import_data")}),m.jsx("input",{type:"file",ref:cr,onChange:l,accept:".json",style:{display:"none"}})]})]}),x.length>0&&m.jsxs(m.Fragment,{children:[m.jsx("div",{className:"settings-section-header",children:E("settings_share_link_header")}),m.jsxs("div",{className:"settings-section-body",children:[!tt&&m.jsx("button",{className:"settings-item action-item",onClick:hr,disabled:Se,children:m.jsx("span",{className:"action-text",children:Se?"단축 URL 생성 중...":E("settings_generate_link")})}),tt&&m.jsxs("div",{className:"share-link-container",children:[m.jsxs("div",{style:{marginBottom:"8px",fontSize:"12px",opacity:.7},children:[tt.length<100?"단축 URL":"일반 링크"," (",tt.length,"자)"]}),m.jsx("input",{type:"text",readOnly:!0,value:tt,onClick:Fe=>Fe.target.select()}),m.jsx("button",{onClick:Re,children:E("settings_copy_link")})]})]})]}),m.jsx("div",{className:"settings-section-header",children:E("settings_delete_account")}),m.jsx("div",{className:"settings-section-body",children:m.jsx("button",{className:"settings-item action-item",onClick:$n,disabled:p!=="idle",children:m.jsx("span",{className:"action-text destructive",children:E(p==="deleting"?"data_deleting":"settings_delete_account")})})})]});default:return null}};return m.jsxs(mo,{onClose:ve,isClosing:he,className:"settings-modal",size:Gt,children:[m.jsxs("div",{className:"settings-modal-header",children:[m.jsx("h2",{children:E("settings_title")}),m.jsx("div",{className:"settings-modal-header-right",children:m.jsx("button",{onClick:ve,className:"close-button",children:Ee.close})})]}),m.jsxs("div",{className:"settings-modal-body",children:[m.jsx("div",{className:"settings-tabs",children:dr.map(Fe=>m.jsxs("button",{className:`settings-tab-button ${Ie===Fe.id?"active":""}`,onClick:()=>Oe(Fe.id),"aria-label":Fe.label,children:[m.jsx("div",{className:"settings-tab-icon",children:Fe.icon}),m.jsx("span",{children:Fe.label})]},Fe.id))}),m.jsx("div",{className:"settings-tab-content-container",children:m.jsx("div",{className:"settings-tab-content",children:zt()},Ie)})]}),zn&&m.jsx("div",{className:"modal-backdrop alert-backdrop",children:m.jsxs("div",{className:"modal-content alert-modal",children:[m.jsxs("div",{className:"alert-content",children:[m.jsx("h2",{children:"알림"}),m.jsx("p",{children:zn})]}),m.jsx("div",{className:"modal-buttons",children:m.jsx("button",{onClick:()=>kn(null),className:"primary",children:"확인"})})]})})]})},YI=({onClose:t,t:e})=>{const[n,r]=Za(t),i="2.0.0 (25.10.24)",s=[{icon:"🔔",title:"미리알림 관리",desc:"Step-by-step 미리알림 추가. 제목, 기한(선택), 시간(선택), 반복 설정, 설명, 활성화 여부"},{icon:"📅",title:"유연한 날짜/시간 설정",desc:"기한 없음, 시간 없음 옵션으로 필요한 정보만 선택적 입력 가능"},{icon:"🎯",title:"WOOP 목표 설정",desc:"5단계 마법사 (Wish → Outcome → Obstacle → Plan → 기한/반복)로 구조화된 목표 계획"},{icon:"🤖",title:"AI 코치 피드백",desc:"Gemini API 기반 각 단계별 실시간 AI 피드백으로 목표 개선"},{icon:"🔐",title:"Google 로그인",desc:"Google OAuth 인증으로 보안 강화 및 계정 관리"},{icon:"☁️",title:"Firebase 클라우드 동기화",desc:"목표, 설정, 미리알림 등 모든 데이터 Firebase Firestore에 자동 저장"},{icon:"🔄",title:"자동 동기화 제어",desc:"켜고 끄기 옵션으로 클라우드 자동 동기화 제어 가능"},{icon:"🌙",title:"다크 모드 & 테마",desc:"시스템/라이트/다크 모드 자동 감지 및 8가지 배경 테마 지원"},{icon:"📱",title:"PWA & 오프라인",desc:"모바일 PWA 자동 설치 배너, 오프라인 모드, 푸시 알림 지원"},{icon:"🗓️",title:"달력 보기",desc:"3일/주간/월간 달력 뷰로 목표 스케줄링 및 시각화"},{icon:"📤",title:"데이터 내보내기/가져오기",desc:"JSON 형식으로 모든 데이터 로컬 저장 및 복원"},{icon:"🌍",title:"다국어 지원",desc:"한국어, 영어 등 다국어 인터페이스 지원"}];return m.jsxs(mo,{onClose:r,isClosing:n,className:"version-info-modal",children:[m.jsxs("div",{className:"version-info-header",children:[m.jsx("h2",{children:"🧪 Nova AI Planner v2.0 Beta"}),m.jsxs("p",{children:[e("build_number"),": ",i]})]}),m.jsx("div",{className:"version-info-body",children:s.map((o,a)=>m.jsxs("div",{className:"changelog-item",children:[m.jsx("div",{className:"changelog-icon",style:{"--icon-bg":"var(--primary-color)"},children:o.icon}),m.jsxs("div",{className:"changelog-text",children:[m.jsx("h3",{children:o.title}),m.jsx("p",{children:o.desc})]})]},a))}),m.jsx("div",{className:"modal-buttons",children:m.jsx("button",{onClick:r,className:"primary",children:e("settings_done_button")})})]})},z3=({onClose:t,t:e})=>{const[n,r]=Za(t),i=o=>{const a=/(https?:\/\/[^\s]+)/g;return o.split(a).map((u,f)=>a.test(u)?m.jsx("a",{href:u,target:"_blank",rel:"noopener noreferrer",className:"guide-link",children:u},f):u)},s=[{titleKey:"usage_basic_title",descKey:"usage_basic_desc"},{titleKey:"usage_ai_setup_title",descKey:"usage_ai_setup_desc"},{titleKey:"usage_ai_use_title",descKey:"usage_ai_use_desc"},{titleKey:"usage_share_title",descKey:"usage_share_desc"},{titleKey:"usage_theme_title",descKey:"usage_theme_desc"},{titleKey:"usage_calendar_title",descKey:"usage_calendar_desc"},{titleKey:"usage_offline_title",descKey:"usage_offline_desc"}];return m.jsxs(mo,{onClose:r,isClosing:n,className:"usage-guide-modal",children:[m.jsx("div",{className:"version-info-header",children:m.jsx("h2",{children:e("usage_guide_title")})}),m.jsx("div",{className:"version-info-body",children:s.map((o,a)=>m.jsxs("div",{className:"usage-guide-item",children:[m.jsx("h3",{children:e(o.titleKey)}),m.jsx("p",{children:o.titleKey==="usage_ai_setup_title"?i(e(o.descKey)):e(o.descKey)})]},a))}),m.jsx("div",{className:"modal-buttons",children:m.jsx("button",{onClick:r,className:"primary",children:e("settings_done_button")})})]})},$3=({todos:t,t:e,onGoalClick:n,language:r})=>{const[i,s]=z.useState(new Date),[o,a]=z.useState("week"),l=g=>{const v=new Date(i);o==="month"?v.setMonth(v.getMonth()+g):o==="week"?v.setDate(v.getDate()+g*7):v.setDate(v.getDate()+g*3),s(v)},u=z.useMemo(()=>{const g=[];let v,E;if(o==="month"){const x=new Date(i.getFullYear(),i.getMonth(),1);v=KI(x,r==="ko"?1:0),E=42}else o==="week"?(v=KI(i,r==="ko"?1:0),E=7):(v=new Date(i),v.setDate(v.getDate()-1),E=3);for(let x=0;x<E;x++){const b=new Date(v);b.setDate(b.getDate()+x),g.push(b)}return g},[i,o,r]),f=z.useMemo(()=>{if(o==="month"){const g=i.getFullYear(),v=e("month_names")[i.getMonth()],E=e("calendar_header_month_format");return E&&typeof E=="string"&&E!=="calendar_header_month_format"?E.replace("{year}",String(g)).replace("{month}",v):`${v} ${g}`}return`${i.getFullYear()}.${i.getMonth()+1}`},[i,o,e]),p=z.useMemo(()=>{const g=e("day_names_short");if(r==="ko"&&Array.isArray(g)){const[v,...E]=g;return[...E,v]}return g},[r,e]);return m.jsxs("div",{className:"calendar-view-container",children:[m.jsxs("div",{className:"calendar-header",children:[m.jsx("button",{onClick:()=>l(-1),children:Ee.back}),m.jsx("h2",{children:f}),m.jsx("button",{onClick:()=>l(1),children:Ee.forward})]}),m.jsxs("div",{className:"calendar-view-mode-selector",children:[m.jsx("button",{onClick:()=>a("day3"),className:o==="day3"?"active":"",children:e("calendar_view_day3")}),m.jsx("button",{onClick:()=>a("week"),className:o==="week"?"active":"",children:e("calendar_view_week")}),m.jsx("button",{onClick:()=>a("month"),className:`calendar-view-button-month ${o==="month"?"active":""}`,children:e("calendar_view_month")})]}),(o==="week"||o==="month")&&m.jsx("div",{className:"calendar-days-of-week",children:Array.isArray(p)&&p.map(g=>m.jsx("div",{children:g},g))}),m.jsx("div",{className:`calendar-grid view-mode-${o}`,children:u.map(g=>{const E=ou(g,new Date),x=g.getMonth()===i.getMonth(),b=t.filter(C=>{if(C.isRecurring){const I=(g.getDay()+6)%7;return C.recurringDays.includes(I)}return C.deadline&&ou(g,C.deadline)});return m.jsxs("div",{className:`calendar-day ${!x&&o==="month"?"not-current-month":""} ${E?"is-today":""}`,"data-day-name":e("day_names_long")[g.getDay()],children:[m.jsx("div",{className:"day-header",children:m.jsx("span",{className:"day-number",children:g.getDate()})}),m.jsx("div",{className:"calendar-goals",children:b.map(C=>m.jsx("div",{className:`calendar-goal-item ${C.completed&&C.lastCompletedDate&&ou(g,C.lastCompletedDate)?"completed":""}`,onClick:()=>n(C),children:C.wish},C.id))})]},g.toISOString())})})]})},H3=({title:t,message:e,onConfirm:n,onCancel:r,confirmText:i,cancelText:s,isDestructive:o,t:a})=>{const l=typeof r=="function";return m.jsx("div",{className:"modal-backdrop alert-backdrop",children:m.jsxs("div",{className:"modal-content alert-modal",children:[m.jsxs("div",{className:"alert-content",children:[m.jsx("h2",{children:t}),m.jsx("p",{dangerouslySetInnerHTML:{__html:e}})]}),m.jsxs("div",{className:"modal-buttons",children:[l&&m.jsx("button",{onClick:r,className:"secondary",children:s||a("cancel_button")}),m.jsx("button",{onClick:n,className:o?"destructive":"primary",children:i||a("confirm_button")})]})]})})},W3=Tp.createRoot(document.getElementById("root"));W3.render(m.jsx(uw.StrictMode,{children:m.jsx(kk,{children:m.jsx(b3,{})})}));
