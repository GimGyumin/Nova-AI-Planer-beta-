(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();const hR="modulepreload",fR=function(t){return"/Nova-AI-Planer/"+t},A_={},fu=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(n.map(l=>{if(l=fR(l),l in A_)return;A_[l]=!0;const u=l.endsWith(".css"),f=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${f}`))return;const p=document.createElement("link");if(p.rel=u?"stylesheet":hR,u||(p.as="script"),p.crossOrigin="",p.href=l,a&&p.setAttribute("nonce",a),document.head.appendChild(p),u)return new Promise((m,v)=>{p.addEventListener("load",m),p.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return i.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return e().catch(s)})};function pR(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var jE={exports:{}},pd={},XE={exports:{}},me={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Cl=Symbol.for("react.element"),mR=Symbol.for("react.portal"),gR=Symbol.for("react.fragment"),_R=Symbol.for("react.strict_mode"),yR=Symbol.for("react.profiler"),vR=Symbol.for("react.provider"),TR=Symbol.for("react.context"),ER=Symbol.for("react.forward_ref"),IR=Symbol.for("react.suspense"),wR=Symbol.for("react.memo"),SR=Symbol.for("react.lazy"),R_=Symbol.iterator;function CR(t){return t===null||typeof t!="object"?null:(t=R_&&t[R_]||t["@@iterator"],typeof t=="function"?t:null)}var ZE={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},eI=Object.assign,tI={};function No(t,e,n){this.props=t,this.context=e,this.refs=tI,this.updater=n||ZE}No.prototype.isReactComponent={};No.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};No.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function nI(){}nI.prototype=No.prototype;function Hp(t,e,n){this.props=t,this.context=e,this.refs=tI,this.updater=n||ZE}var Kp=Hp.prototype=new nI;Kp.constructor=Hp;eI(Kp,No.prototype);Kp.isPureReactComponent=!0;var P_=Array.isArray,rI=Object.prototype.hasOwnProperty,Wp={current:null},iI={key:!0,ref:!0,__self:!0,__source:!0};function sI(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)rI.call(e,r)&&!iI.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];i.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:Cl,type:t,key:s,ref:o,props:i,_owner:Wp.current}}function AR(t,e){return{$$typeof:Cl,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Jp(t){return typeof t=="object"&&t!==null&&t.$$typeof===Cl}function RR(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var x_=/\/+/g;function Ih(t,e){return typeof t=="object"&&t!==null&&t.key!=null?RR(""+t.key):e.toString(36)}function Bu(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Cl:case mR:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+Ih(o,0):r,P_(i)?(n="",t!=null&&(n=t.replace(x_,"$&/")+"/"),Bu(i,e,n,"",function(u){return u})):i!=null&&(Jp(i)&&(i=AR(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(x_,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",P_(t))for(var a=0;a<t.length;a++){s=t[a];var l=r+Ih(s,a);o+=Bu(s,e,n,l,i)}else if(l=CR(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=r+Ih(s,a++),o+=Bu(s,e,n,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function pu(t,e,n){if(t==null)return t;var r=[],i=0;return Bu(t,r,"","",function(s){return e.call(n,s,i++)}),r}function PR(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Lt={current:null},Gu={transition:null},xR={ReactCurrentDispatcher:Lt,ReactCurrentBatchConfig:Gu,ReactCurrentOwner:Wp};function oI(){throw Error("act(...) is not supported in production builds of React.")}me.Children={map:pu,forEach:function(t,e,n){pu(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return pu(t,function(){e++}),e},toArray:function(t){return pu(t,function(e){return e})||[]},only:function(t){if(!Jp(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};me.Component=No;me.Fragment=gR;me.Profiler=yR;me.PureComponent=Hp;me.StrictMode=_R;me.Suspense=IR;me.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xR;me.act=oI;me.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=eI({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=Wp.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)rI.call(e,l)&&!iI.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];r.children=a}return{$$typeof:Cl,type:t.type,key:i,ref:s,props:r,_owner:o}};me.createContext=function(t){return t={$$typeof:TR,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:vR,_context:t},t.Consumer=t};me.createElement=sI;me.createFactory=function(t){var e=sI.bind(null,t);return e.type=t,e};me.createRef=function(){return{current:null}};me.forwardRef=function(t){return{$$typeof:ER,render:t}};me.isValidElement=Jp;me.lazy=function(t){return{$$typeof:SR,_payload:{_status:-1,_result:t},_init:PR}};me.memo=function(t,e){return{$$typeof:wR,type:t,compare:e===void 0?null:e}};me.startTransition=function(t){var e=Gu.transition;Gu.transition={};try{t()}finally{Gu.transition=e}};me.unstable_act=oI;me.useCallback=function(t,e){return Lt.current.useCallback(t,e)};me.useContext=function(t){return Lt.current.useContext(t)};me.useDebugValue=function(){};me.useDeferredValue=function(t){return Lt.current.useDeferredValue(t)};me.useEffect=function(t,e){return Lt.current.useEffect(t,e)};me.useId=function(){return Lt.current.useId()};me.useImperativeHandle=function(t,e,n){return Lt.current.useImperativeHandle(t,e,n)};me.useInsertionEffect=function(t,e){return Lt.current.useInsertionEffect(t,e)};me.useLayoutEffect=function(t,e){return Lt.current.useLayoutEffect(t,e)};me.useMemo=function(t,e){return Lt.current.useMemo(t,e)};me.useReducer=function(t,e,n){return Lt.current.useReducer(t,e,n)};me.useRef=function(t){return Lt.current.useRef(t)};me.useState=function(t){return Lt.current.useState(t)};me.useSyncExternalStore=function(t,e,n){return Lt.current.useSyncExternalStore(t,e,n)};me.useTransition=function(){return Lt.current.useTransition()};me.version="18.3.1";XE.exports=me;var G=XE.exports;const aI=pR(G);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kR=G,NR=Symbol.for("react.element"),DR=Symbol.for("react.fragment"),MR=Object.prototype.hasOwnProperty,VR=kR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,bR={key:!0,ref:!0,__self:!0,__source:!0};function lI(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)MR.call(e,r)&&!bR.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:NR,type:t,key:s,ref:o,props:i,_owner:VR.current}}pd.Fragment=DR;pd.jsx=lI;pd.jsxs=lI;jE.exports=pd;var _=jE.exports,cf={},uI={exports:{}},nn={},cI={exports:{}},dI={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(W,ee){var ie=W.length;W.push(ee);e:for(;0<ie;){var Ee=ie-1>>>1,Ae=W[Ee];if(0<i(Ae,ee))W[Ee]=ee,W[ie]=Ae,ie=Ee;else break e}}function n(W){return W.length===0?null:W[0]}function r(W){if(W.length===0)return null;var ee=W[0],ie=W.pop();if(ie!==ee){W[0]=ie;e:for(var Ee=0,Ae=W.length,Ve=Ae>>>1;Ee<Ve;){var be=2*(Ee+1)-1,sn=W[be],st=be+1,on=W[st];if(0>i(sn,ie))st<Ae&&0>i(on,sn)?(W[Ee]=on,W[st]=ie,Ee=st):(W[Ee]=sn,W[be]=ie,Ee=be);else if(st<Ae&&0>i(on,ie))W[Ee]=on,W[st]=ie,Ee=st;else break e}}return ee}function i(W,ee){var ie=W.sortIndex-ee.sortIndex;return ie!==0?ie:W.id-ee.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],u=[],f=1,p=null,m=3,v=!1,I=!1,x=!1,M=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(W){for(var ee=n(u);ee!==null;){if(ee.callback===null)r(u);else if(ee.startTime<=W)r(u),ee.sortIndex=ee.expirationTime,e(l,ee);else break;ee=n(u)}}function V(W){if(x=!1,S(W),!I)if(n(l)!==null)I=!0,Ce(U);else{var ee=n(u);ee!==null&&oe(V,ee.startTime-W)}}function U(W,ee){I=!1,x&&(x=!1,A(E),E=-1),v=!0;var ie=m;try{for(S(ee),p=n(l);p!==null&&(!(p.expirationTime>ee)||W&&!N());){var Ee=p.callback;if(typeof Ee=="function"){p.callback=null,m=p.priorityLevel;var Ae=Ee(p.expirationTime<=ee);ee=t.unstable_now(),typeof Ae=="function"?p.callback=Ae:p===n(l)&&r(l),S(ee)}else r(l);p=n(l)}if(p!==null)var Ve=!0;else{var be=n(u);be!==null&&oe(V,be.startTime-ee),Ve=!1}return Ve}finally{p=null,m=ie,v=!1}}var F=!1,C=null,E=-1,R=5,P=-1;function N(){return!(t.unstable_now()-P<R)}function D(){if(C!==null){var W=t.unstable_now();P=W;var ee=!0;try{ee=C(!0,W)}finally{ee?k():(F=!1,C=null)}}else F=!1}var k;if(typeof T=="function")k=function(){T(D)};else if(typeof MessageChannel<"u"){var ne=new MessageChannel,ye=ne.port2;ne.port1.onmessage=D,k=function(){ye.postMessage(null)}}else k=function(){M(D,0)};function Ce(W){C=W,F||(F=!0,k())}function oe(W,ee){E=M(function(){W(t.unstable_now())},ee)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(W){W.callback=null},t.unstable_continueExecution=function(){I||v||(I=!0,Ce(U))},t.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<W?Math.floor(1e3/W):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(W){switch(m){case 1:case 2:case 3:var ee=3;break;default:ee=m}var ie=m;m=ee;try{return W()}finally{m=ie}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(W,ee){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var ie=m;m=W;try{return ee()}finally{m=ie}},t.unstable_scheduleCallback=function(W,ee,ie){var Ee=t.unstable_now();switch(typeof ie=="object"&&ie!==null?(ie=ie.delay,ie=typeof ie=="number"&&0<ie?Ee+ie:Ee):ie=Ee,W){case 1:var Ae=-1;break;case 2:Ae=250;break;case 5:Ae=1073741823;break;case 4:Ae=1e4;break;default:Ae=5e3}return Ae=ie+Ae,W={id:f++,callback:ee,priorityLevel:W,startTime:ie,expirationTime:Ae,sortIndex:-1},ie>Ee?(W.sortIndex=ie,e(u,W),n(l)===null&&W===n(u)&&(x?(A(E),E=-1):x=!0,oe(V,ie-Ee))):(W.sortIndex=Ae,e(l,W),I||v||(I=!0,Ce(U))),W},t.unstable_shouldYield=N,t.unstable_wrapCallback=function(W){var ee=m;return function(){var ie=m;m=ee;try{return W.apply(this,arguments)}finally{m=ie}}}})(dI);cI.exports=dI;var LR=cI.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var FR=G,Zt=LR;function z(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var hI=new Set,Qa={};function os(t,e){oo(t,e),oo(t+"Capture",e)}function oo(t,e){for(Qa[t]=e,t=0;t<e.length;t++)hI.add(e[t])}var sr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),df=Object.prototype.hasOwnProperty,UR=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,k_={},N_={};function OR(t){return df.call(N_,t)?!0:df.call(k_,t)?!1:UR.test(t)?N_[t]=!0:(k_[t]=!0,!1)}function BR(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function GR(t,e,n,r){if(e===null||typeof e>"u"||BR(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Ft(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var wt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){wt[t]=new Ft(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];wt[e]=new Ft(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){wt[t]=new Ft(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){wt[t]=new Ft(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){wt[t]=new Ft(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){wt[t]=new Ft(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){wt[t]=new Ft(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){wt[t]=new Ft(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){wt[t]=new Ft(t,5,!1,t.toLowerCase(),null,!1,!1)});var Qp=/[\-:]([a-z])/g;function Yp(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Qp,Yp);wt[e]=new Ft(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Qp,Yp);wt[e]=new Ft(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Qp,Yp);wt[e]=new Ft(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){wt[t]=new Ft(t,1,!1,t.toLowerCase(),null,!1,!1)});wt.xlinkHref=new Ft("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){wt[t]=new Ft(t,1,!1,t.toLowerCase(),null,!0,!0)});function jp(t,e,n,r){var i=wt.hasOwnProperty(e)?wt[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(GR(e,n,i,r)&&(n=null),r||i===null?OR(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var fr=FR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,mu=Symbol.for("react.element"),Ns=Symbol.for("react.portal"),Ds=Symbol.for("react.fragment"),Xp=Symbol.for("react.strict_mode"),hf=Symbol.for("react.profiler"),fI=Symbol.for("react.provider"),pI=Symbol.for("react.context"),Zp=Symbol.for("react.forward_ref"),ff=Symbol.for("react.suspense"),pf=Symbol.for("react.suspense_list"),em=Symbol.for("react.memo"),Pr=Symbol.for("react.lazy"),mI=Symbol.for("react.offscreen"),D_=Symbol.iterator;function oa(t){return t===null||typeof t!="object"?null:(t=D_&&t[D_]||t["@@iterator"],typeof t=="function"?t:null)}var Je=Object.assign,wh;function Ta(t){if(wh===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);wh=e&&e[1]||""}return`
`+wh+t}var Sh=!1;function Ch(t,e){if(!t||Sh)return"";Sh=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{Sh=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Ta(t):""}function qR(t){switch(t.tag){case 5:return Ta(t.type);case 16:return Ta("Lazy");case 13:return Ta("Suspense");case 19:return Ta("SuspenseList");case 0:case 2:case 15:return t=Ch(t.type,!1),t;case 11:return t=Ch(t.type.render,!1),t;case 1:return t=Ch(t.type,!0),t;default:return""}}function mf(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Ds:return"Fragment";case Ns:return"Portal";case hf:return"Profiler";case Xp:return"StrictMode";case ff:return"Suspense";case pf:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case pI:return(t.displayName||"Context")+".Consumer";case fI:return(t._context.displayName||"Context")+".Provider";case Zp:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case em:return e=t.displayName||null,e!==null?e:mf(t.type)||"Memo";case Pr:e=t._payload,t=t._init;try{return mf(t(e))}catch{}}return null}function $R(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return mf(e);case 8:return e===Xp?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Zr(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function gI(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function zR(t){var e=gI(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function gu(t){t._valueTracker||(t._valueTracker=zR(t))}function _I(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=gI(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function gc(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function gf(t,e){var n=e.checked;return Je({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function M_(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Zr(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function yI(t,e){e=e.checked,e!=null&&jp(t,"checked",e,!1)}function _f(t,e){yI(t,e);var n=Zr(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?yf(t,e.type,n):e.hasOwnProperty("defaultValue")&&yf(t,e.type,Zr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function V_(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function yf(t,e,n){(e!=="number"||gc(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Ea=Array.isArray;function Hs(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Zr(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function vf(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(z(91));return Je({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function b_(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(z(92));if(Ea(n)){if(1<n.length)throw Error(z(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Zr(n)}}function vI(t,e){var n=Zr(e.value),r=Zr(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function L_(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function TI(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Tf(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?TI(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var _u,EI=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(_u=_u||document.createElement("div"),_u.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=_u.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Ya(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Pa={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},HR=["Webkit","ms","Moz","O"];Object.keys(Pa).forEach(function(t){HR.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Pa[e]=Pa[t]})});function II(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Pa.hasOwnProperty(t)&&Pa[t]?(""+e).trim():e+"px"}function wI(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=II(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var KR=Je({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ef(t,e){if(e){if(KR[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(z(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(z(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(z(61))}if(e.style!=null&&typeof e.style!="object")throw Error(z(62))}}function If(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wf=null;function tm(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Sf=null,Ks=null,Ws=null;function F_(t){if(t=Pl(t)){if(typeof Sf!="function")throw Error(z(280));var e=t.stateNode;e&&(e=vd(e),Sf(t.stateNode,t.type,e))}}function SI(t){Ks?Ws?Ws.push(t):Ws=[t]:Ks=t}function CI(){if(Ks){var t=Ks,e=Ws;if(Ws=Ks=null,F_(t),e)for(t=0;t<e.length;t++)F_(e[t])}}function AI(t,e){return t(e)}function RI(){}var Ah=!1;function PI(t,e,n){if(Ah)return t(e,n);Ah=!0;try{return AI(t,e,n)}finally{Ah=!1,(Ks!==null||Ws!==null)&&(RI(),CI())}}function ja(t,e){var n=t.stateNode;if(n===null)return null;var r=vd(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(z(231,e,typeof n));return n}var Cf=!1;if(sr)try{var aa={};Object.defineProperty(aa,"passive",{get:function(){Cf=!0}}),window.addEventListener("test",aa,aa),window.removeEventListener("test",aa,aa)}catch{Cf=!1}function WR(t,e,n,r,i,s,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(f){this.onError(f)}}var xa=!1,_c=null,yc=!1,Af=null,JR={onError:function(t){xa=!0,_c=t}};function QR(t,e,n,r,i,s,o,a,l){xa=!1,_c=null,WR.apply(JR,arguments)}function YR(t,e,n,r,i,s,o,a,l){if(QR.apply(this,arguments),xa){if(xa){var u=_c;xa=!1,_c=null}else throw Error(z(198));yc||(yc=!0,Af=u)}}function as(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function xI(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function U_(t){if(as(t)!==t)throw Error(z(188))}function jR(t){var e=t.alternate;if(!e){if(e=as(t),e===null)throw Error(z(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return U_(i),t;if(s===r)return U_(i),e;s=s.sibling}throw Error(z(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(z(189))}}if(n.alternate!==r)throw Error(z(190))}if(n.tag!==3)throw Error(z(188));return n.stateNode.current===n?t:e}function kI(t){return t=jR(t),t!==null?NI(t):null}function NI(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=NI(t);if(e!==null)return e;t=t.sibling}return null}var DI=Zt.unstable_scheduleCallback,O_=Zt.unstable_cancelCallback,XR=Zt.unstable_shouldYield,ZR=Zt.unstable_requestPaint,Xe=Zt.unstable_now,eP=Zt.unstable_getCurrentPriorityLevel,nm=Zt.unstable_ImmediatePriority,MI=Zt.unstable_UserBlockingPriority,vc=Zt.unstable_NormalPriority,tP=Zt.unstable_LowPriority,VI=Zt.unstable_IdlePriority,md=null,Gn=null;function nP(t){if(Gn&&typeof Gn.onCommitFiberRoot=="function")try{Gn.onCommitFiberRoot(md,t,void 0,(t.current.flags&128)===128)}catch{}}var An=Math.clz32?Math.clz32:sP,rP=Math.log,iP=Math.LN2;function sP(t){return t>>>=0,t===0?32:31-(rP(t)/iP|0)|0}var yu=64,vu=4194304;function Ia(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Tc(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=Ia(a):(s&=o,s!==0&&(r=Ia(s)))}else o=n&~i,o!==0?r=Ia(o):s!==0&&(r=Ia(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-An(e),i=1<<n,r|=t[n],e&=~i;return r}function oP(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function aP(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-An(s),a=1<<o,l=i[o];l===-1?(!(a&n)||a&r)&&(i[o]=oP(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function Rf(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function bI(){var t=yu;return yu<<=1,!(yu&4194240)&&(yu=64),t}function Rh(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Al(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-An(e),t[e]=n}function lP(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-An(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function rm(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-An(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var Pe=0;function LI(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var FI,im,UI,OI,BI,Pf=!1,Tu=[],Or=null,Br=null,Gr=null,Xa=new Map,Za=new Map,kr=[],uP="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function B_(t,e){switch(t){case"focusin":case"focusout":Or=null;break;case"dragenter":case"dragleave":Br=null;break;case"mouseover":case"mouseout":Gr=null;break;case"pointerover":case"pointerout":Xa.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Za.delete(e.pointerId)}}function la(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Pl(e),e!==null&&im(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function cP(t,e,n,r,i){switch(e){case"focusin":return Or=la(Or,t,e,n,r,i),!0;case"dragenter":return Br=la(Br,t,e,n,r,i),!0;case"mouseover":return Gr=la(Gr,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return Xa.set(s,la(Xa.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Za.set(s,la(Za.get(s)||null,t,e,n,r,i)),!0}return!1}function GI(t){var e=Vi(t.target);if(e!==null){var n=as(e);if(n!==null){if(e=n.tag,e===13){if(e=xI(n),e!==null){t.blockedOn=e,BI(t.priority,function(){UI(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function qu(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=xf(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);wf=r,n.target.dispatchEvent(r),wf=null}else return e=Pl(n),e!==null&&im(e),t.blockedOn=n,!1;e.shift()}return!0}function G_(t,e,n){qu(t)&&n.delete(e)}function dP(){Pf=!1,Or!==null&&qu(Or)&&(Or=null),Br!==null&&qu(Br)&&(Br=null),Gr!==null&&qu(Gr)&&(Gr=null),Xa.forEach(G_),Za.forEach(G_)}function ua(t,e){t.blockedOn===e&&(t.blockedOn=null,Pf||(Pf=!0,Zt.unstable_scheduleCallback(Zt.unstable_NormalPriority,dP)))}function el(t){function e(i){return ua(i,t)}if(0<Tu.length){ua(Tu[0],t);for(var n=1;n<Tu.length;n++){var r=Tu[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Or!==null&&ua(Or,t),Br!==null&&ua(Br,t),Gr!==null&&ua(Gr,t),Xa.forEach(e),Za.forEach(e),n=0;n<kr.length;n++)r=kr[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<kr.length&&(n=kr[0],n.blockedOn===null);)GI(n),n.blockedOn===null&&kr.shift()}var Js=fr.ReactCurrentBatchConfig,Ec=!0;function hP(t,e,n,r){var i=Pe,s=Js.transition;Js.transition=null;try{Pe=1,sm(t,e,n,r)}finally{Pe=i,Js.transition=s}}function fP(t,e,n,r){var i=Pe,s=Js.transition;Js.transition=null;try{Pe=4,sm(t,e,n,r)}finally{Pe=i,Js.transition=s}}function sm(t,e,n,r){if(Ec){var i=xf(t,e,n,r);if(i===null)Fh(t,e,r,Ic,n),B_(t,r);else if(cP(i,t,e,n,r))r.stopPropagation();else if(B_(t,r),e&4&&-1<uP.indexOf(t)){for(;i!==null;){var s=Pl(i);if(s!==null&&FI(s),s=xf(t,e,n,r),s===null&&Fh(t,e,r,Ic,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else Fh(t,e,r,null,n)}}var Ic=null;function xf(t,e,n,r){if(Ic=null,t=tm(r),t=Vi(t),t!==null)if(e=as(t),e===null)t=null;else if(n=e.tag,n===13){if(t=xI(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Ic=t,null}function qI(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(eP()){case nm:return 1;case MI:return 4;case vc:case tP:return 16;case VI:return 536870912;default:return 16}default:return 16}}var Lr=null,om=null,$u=null;function $I(){if($u)return $u;var t,e=om,n=e.length,r,i="value"in Lr?Lr.value:Lr.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return $u=i.slice(t,1<r?1-r:void 0)}function zu(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Eu(){return!0}function q_(){return!1}function rn(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Eu:q_,this.isPropagationStopped=q_,this}return Je(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Eu)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Eu)},persist:function(){},isPersistent:Eu}),e}var Do={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},am=rn(Do),Rl=Je({},Do,{view:0,detail:0}),pP=rn(Rl),Ph,xh,ca,gd=Je({},Rl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:lm,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ca&&(ca&&t.type==="mousemove"?(Ph=t.screenX-ca.screenX,xh=t.screenY-ca.screenY):xh=Ph=0,ca=t),Ph)},movementY:function(t){return"movementY"in t?t.movementY:xh}}),$_=rn(gd),mP=Je({},gd,{dataTransfer:0}),gP=rn(mP),_P=Je({},Rl,{relatedTarget:0}),kh=rn(_P),yP=Je({},Do,{animationName:0,elapsedTime:0,pseudoElement:0}),vP=rn(yP),TP=Je({},Do,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),EP=rn(TP),IP=Je({},Do,{data:0}),z_=rn(IP),wP={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},SP={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},CP={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function AP(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=CP[t])?!!e[t]:!1}function lm(){return AP}var RP=Je({},Rl,{key:function(t){if(t.key){var e=wP[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=zu(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?SP[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:lm,charCode:function(t){return t.type==="keypress"?zu(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?zu(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),PP=rn(RP),xP=Je({},gd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),H_=rn(xP),kP=Je({},Rl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:lm}),NP=rn(kP),DP=Je({},Do,{propertyName:0,elapsedTime:0,pseudoElement:0}),MP=rn(DP),VP=Je({},gd,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),bP=rn(VP),LP=[9,13,27,32],um=sr&&"CompositionEvent"in window,ka=null;sr&&"documentMode"in document&&(ka=document.documentMode);var FP=sr&&"TextEvent"in window&&!ka,zI=sr&&(!um||ka&&8<ka&&11>=ka),K_=" ",W_=!1;function HI(t,e){switch(t){case"keyup":return LP.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function KI(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ms=!1;function UP(t,e){switch(t){case"compositionend":return KI(e);case"keypress":return e.which!==32?null:(W_=!0,K_);case"textInput":return t=e.data,t===K_&&W_?null:t;default:return null}}function OP(t,e){if(Ms)return t==="compositionend"||!um&&HI(t,e)?(t=$I(),$u=om=Lr=null,Ms=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return zI&&e.locale!=="ko"?null:e.data;default:return null}}var BP={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function J_(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!BP[t.type]:e==="textarea"}function WI(t,e,n,r){SI(r),e=wc(e,"onChange"),0<e.length&&(n=new am("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Na=null,tl=null;function GP(t){iw(t,0)}function _d(t){var e=Ls(t);if(_I(e))return t}function qP(t,e){if(t==="change")return e}var JI=!1;if(sr){var Nh;if(sr){var Dh="oninput"in document;if(!Dh){var Q_=document.createElement("div");Q_.setAttribute("oninput","return;"),Dh=typeof Q_.oninput=="function"}Nh=Dh}else Nh=!1;JI=Nh&&(!document.documentMode||9<document.documentMode)}function Y_(){Na&&(Na.detachEvent("onpropertychange",QI),tl=Na=null)}function QI(t){if(t.propertyName==="value"&&_d(tl)){var e=[];WI(e,tl,t,tm(t)),PI(GP,e)}}function $P(t,e,n){t==="focusin"?(Y_(),Na=e,tl=n,Na.attachEvent("onpropertychange",QI)):t==="focusout"&&Y_()}function zP(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return _d(tl)}function HP(t,e){if(t==="click")return _d(e)}function KP(t,e){if(t==="input"||t==="change")return _d(e)}function WP(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Nn=typeof Object.is=="function"?Object.is:WP;function nl(t,e){if(Nn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!df.call(e,i)||!Nn(t[i],e[i]))return!1}return!0}function j_(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function X_(t,e){var n=j_(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=j_(n)}}function YI(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?YI(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function jI(){for(var t=window,e=gc();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=gc(t.document)}return e}function cm(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function JP(t){var e=jI(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&YI(n.ownerDocument.documentElement,n)){if(r!==null&&cm(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=X_(n,s);var o=X_(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var QP=sr&&"documentMode"in document&&11>=document.documentMode,Vs=null,kf=null,Da=null,Nf=!1;function Z_(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Nf||Vs==null||Vs!==gc(r)||(r=Vs,"selectionStart"in r&&cm(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Da&&nl(Da,r)||(Da=r,r=wc(kf,"onSelect"),0<r.length&&(e=new am("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Vs)))}function Iu(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var bs={animationend:Iu("Animation","AnimationEnd"),animationiteration:Iu("Animation","AnimationIteration"),animationstart:Iu("Animation","AnimationStart"),transitionend:Iu("Transition","TransitionEnd")},Mh={},XI={};sr&&(XI=document.createElement("div").style,"AnimationEvent"in window||(delete bs.animationend.animation,delete bs.animationiteration.animation,delete bs.animationstart.animation),"TransitionEvent"in window||delete bs.transitionend.transition);function yd(t){if(Mh[t])return Mh[t];if(!bs[t])return t;var e=bs[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in XI)return Mh[t]=e[n];return t}var ZI=yd("animationend"),ew=yd("animationiteration"),tw=yd("animationstart"),nw=yd("transitionend"),rw=new Map,ey="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function li(t,e){rw.set(t,e),os(e,[t])}for(var Vh=0;Vh<ey.length;Vh++){var bh=ey[Vh],YP=bh.toLowerCase(),jP=bh[0].toUpperCase()+bh.slice(1);li(YP,"on"+jP)}li(ZI,"onAnimationEnd");li(ew,"onAnimationIteration");li(tw,"onAnimationStart");li("dblclick","onDoubleClick");li("focusin","onFocus");li("focusout","onBlur");li(nw,"onTransitionEnd");oo("onMouseEnter",["mouseout","mouseover"]);oo("onMouseLeave",["mouseout","mouseover"]);oo("onPointerEnter",["pointerout","pointerover"]);oo("onPointerLeave",["pointerout","pointerover"]);os("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));os("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));os("onBeforeInput",["compositionend","keypress","textInput","paste"]);os("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));os("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));os("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var wa="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),XP=new Set("cancel close invalid load scroll toggle".split(" ").concat(wa));function ty(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,YR(r,e,void 0,t),t.currentTarget=null}function iw(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;ty(i,a,u),s=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;ty(i,a,u),s=l}}}if(yc)throw t=Af,yc=!1,Af=null,t}function Ue(t,e){var n=e[Lf];n===void 0&&(n=e[Lf]=new Set);var r=t+"__bubble";n.has(r)||(sw(e,t,2,!1),n.add(r))}function Lh(t,e,n){var r=0;e&&(r|=4),sw(n,t,r,e)}var wu="_reactListening"+Math.random().toString(36).slice(2);function rl(t){if(!t[wu]){t[wu]=!0,hI.forEach(function(n){n!=="selectionchange"&&(XP.has(n)||Lh(n,!1,t),Lh(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[wu]||(e[wu]=!0,Lh("selectionchange",!1,e))}}function sw(t,e,n,r){switch(qI(e)){case 1:var i=hP;break;case 4:i=fP;break;default:i=sm}n=i.bind(null,e,n,t),i=void 0,!Cf||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function Fh(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=Vi(a),o===null)return;if(l=o.tag,l===5||l===6){r=s=o;continue e}a=a.parentNode}}r=r.return}PI(function(){var u=s,f=tm(n),p=[];e:{var m=rw.get(t);if(m!==void 0){var v=am,I=t;switch(t){case"keypress":if(zu(n)===0)break e;case"keydown":case"keyup":v=PP;break;case"focusin":I="focus",v=kh;break;case"focusout":I="blur",v=kh;break;case"beforeblur":case"afterblur":v=kh;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":v=$_;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":v=gP;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":v=NP;break;case ZI:case ew:case tw:v=vP;break;case nw:v=MP;break;case"scroll":v=pP;break;case"wheel":v=bP;break;case"copy":case"cut":case"paste":v=EP;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":v=H_}var x=(e&4)!==0,M=!x&&t==="scroll",A=x?m!==null?m+"Capture":null:m;x=[];for(var T=u,S;T!==null;){S=T;var V=S.stateNode;if(S.tag===5&&V!==null&&(S=V,A!==null&&(V=ja(T,A),V!=null&&x.push(il(T,V,S)))),M)break;T=T.return}0<x.length&&(m=new v(m,I,null,n,f),p.push({event:m,listeners:x}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",v=t==="mouseout"||t==="pointerout",m&&n!==wf&&(I=n.relatedTarget||n.fromElement)&&(Vi(I)||I[or]))break e;if((v||m)&&(m=f.window===f?f:(m=f.ownerDocument)?m.defaultView||m.parentWindow:window,v?(I=n.relatedTarget||n.toElement,v=u,I=I?Vi(I):null,I!==null&&(M=as(I),I!==M||I.tag!==5&&I.tag!==6)&&(I=null)):(v=null,I=u),v!==I)){if(x=$_,V="onMouseLeave",A="onMouseEnter",T="mouse",(t==="pointerout"||t==="pointerover")&&(x=H_,V="onPointerLeave",A="onPointerEnter",T="pointer"),M=v==null?m:Ls(v),S=I==null?m:Ls(I),m=new x(V,T+"leave",v,n,f),m.target=M,m.relatedTarget=S,V=null,Vi(f)===u&&(x=new x(A,T+"enter",I,n,f),x.target=S,x.relatedTarget=M,V=x),M=V,v&&I)t:{for(x=v,A=I,T=0,S=x;S;S=vs(S))T++;for(S=0,V=A;V;V=vs(V))S++;for(;0<T-S;)x=vs(x),T--;for(;0<S-T;)A=vs(A),S--;for(;T--;){if(x===A||A!==null&&x===A.alternate)break t;x=vs(x),A=vs(A)}x=null}else x=null;v!==null&&ny(p,m,v,x,!1),I!==null&&M!==null&&ny(p,M,I,x,!0)}}e:{if(m=u?Ls(u):window,v=m.nodeName&&m.nodeName.toLowerCase(),v==="select"||v==="input"&&m.type==="file")var U=qP;else if(J_(m))if(JI)U=KP;else{U=zP;var F=$P}else(v=m.nodeName)&&v.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(U=HP);if(U&&(U=U(t,u))){WI(p,U,n,f);break e}F&&F(t,m,u),t==="focusout"&&(F=m._wrapperState)&&F.controlled&&m.type==="number"&&yf(m,"number",m.value)}switch(F=u?Ls(u):window,t){case"focusin":(J_(F)||F.contentEditable==="true")&&(Vs=F,kf=u,Da=null);break;case"focusout":Da=kf=Vs=null;break;case"mousedown":Nf=!0;break;case"contextmenu":case"mouseup":case"dragend":Nf=!1,Z_(p,n,f);break;case"selectionchange":if(QP)break;case"keydown":case"keyup":Z_(p,n,f)}var C;if(um)e:{switch(t){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else Ms?HI(t,n)&&(E="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(E="onCompositionStart");E&&(zI&&n.locale!=="ko"&&(Ms||E!=="onCompositionStart"?E==="onCompositionEnd"&&Ms&&(C=$I()):(Lr=f,om="value"in Lr?Lr.value:Lr.textContent,Ms=!0)),F=wc(u,E),0<F.length&&(E=new z_(E,t,null,n,f),p.push({event:E,listeners:F}),C?E.data=C:(C=KI(n),C!==null&&(E.data=C)))),(C=FP?UP(t,n):OP(t,n))&&(u=wc(u,"onBeforeInput"),0<u.length&&(f=new z_("onBeforeInput","beforeinput",null,n,f),p.push({event:f,listeners:u}),f.data=C))}iw(p,e)})}function il(t,e,n){return{instance:t,listener:e,currentTarget:n}}function wc(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=ja(t,n),s!=null&&r.unshift(il(t,s,i)),s=ja(t,e),s!=null&&r.push(il(t,s,i))),t=t.return}return r}function vs(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function ny(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,u=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&u!==null&&(a=u,i?(l=ja(n,s),l!=null&&o.unshift(il(n,l,a))):i||(l=ja(n,s),l!=null&&o.push(il(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var ZP=/\r\n?/g,ex=/\u0000|\uFFFD/g;function ry(t){return(typeof t=="string"?t:""+t).replace(ZP,`
`).replace(ex,"")}function Su(t,e,n){if(e=ry(e),ry(t)!==e&&n)throw Error(z(425))}function Sc(){}var Df=null,Mf=null;function Vf(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var bf=typeof setTimeout=="function"?setTimeout:void 0,tx=typeof clearTimeout=="function"?clearTimeout:void 0,iy=typeof Promise=="function"?Promise:void 0,nx=typeof queueMicrotask=="function"?queueMicrotask:typeof iy<"u"?function(t){return iy.resolve(null).then(t).catch(rx)}:bf;function rx(t){setTimeout(function(){throw t})}function Uh(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),el(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);el(e)}function qr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function sy(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Mo=Math.random().toString(36).slice(2),Un="__reactFiber$"+Mo,sl="__reactProps$"+Mo,or="__reactContainer$"+Mo,Lf="__reactEvents$"+Mo,ix="__reactListeners$"+Mo,sx="__reactHandles$"+Mo;function Vi(t){var e=t[Un];if(e)return e;for(var n=t.parentNode;n;){if(e=n[or]||n[Un]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=sy(t);t!==null;){if(n=t[Un])return n;t=sy(t)}return e}t=n,n=t.parentNode}return null}function Pl(t){return t=t[Un]||t[or],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Ls(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(z(33))}function vd(t){return t[sl]||null}var Ff=[],Fs=-1;function ui(t){return{current:t}}function Be(t){0>Fs||(t.current=Ff[Fs],Ff[Fs]=null,Fs--)}function Le(t,e){Fs++,Ff[Fs]=t.current,t.current=e}var ei={},Nt=ui(ei),Gt=ui(!1),Hi=ei;function ao(t,e){var n=t.type.contextTypes;if(!n)return ei;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function qt(t){return t=t.childContextTypes,t!=null}function Cc(){Be(Gt),Be(Nt)}function oy(t,e,n){if(Nt.current!==ei)throw Error(z(168));Le(Nt,e),Le(Gt,n)}function ow(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(z(108,$R(t)||"Unknown",i));return Je({},n,r)}function Ac(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ei,Hi=Nt.current,Le(Nt,t),Le(Gt,Gt.current),!0}function ay(t,e,n){var r=t.stateNode;if(!r)throw Error(z(169));n?(t=ow(t,e,Hi),r.__reactInternalMemoizedMergedChildContext=t,Be(Gt),Be(Nt),Le(Nt,t)):Be(Gt),Le(Gt,n)}var Yn=null,Td=!1,Oh=!1;function aw(t){Yn===null?Yn=[t]:Yn.push(t)}function ox(t){Td=!0,aw(t)}function ci(){if(!Oh&&Yn!==null){Oh=!0;var t=0,e=Pe;try{var n=Yn;for(Pe=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Yn=null,Td=!1}catch(i){throw Yn!==null&&(Yn=Yn.slice(t+1)),DI(nm,ci),i}finally{Pe=e,Oh=!1}}return null}var Us=[],Os=0,Rc=null,Pc=0,an=[],ln=0,Ki=null,Xn=1,Zn="";function Ci(t,e){Us[Os++]=Pc,Us[Os++]=Rc,Rc=t,Pc=e}function lw(t,e,n){an[ln++]=Xn,an[ln++]=Zn,an[ln++]=Ki,Ki=t;var r=Xn;t=Zn;var i=32-An(r)-1;r&=~(1<<i),n+=1;var s=32-An(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Xn=1<<32-An(e)+i|n<<i|r,Zn=s+t}else Xn=1<<s|n<<i|r,Zn=t}function dm(t){t.return!==null&&(Ci(t,1),lw(t,1,0))}function hm(t){for(;t===Rc;)Rc=Us[--Os],Us[Os]=null,Pc=Us[--Os],Us[Os]=null;for(;t===Ki;)Ki=an[--ln],an[ln]=null,Zn=an[--ln],an[ln]=null,Xn=an[--ln],an[ln]=null}var Xt=null,Qt=null,$e=!1,In=null;function uw(t,e){var n=un(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function ly(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Xt=t,Qt=qr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Xt=t,Qt=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Ki!==null?{id:Xn,overflow:Zn}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=un(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Xt=t,Qt=null,!0):!1;default:return!1}}function Uf(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Of(t){if($e){var e=Qt;if(e){var n=e;if(!ly(t,e)){if(Uf(t))throw Error(z(418));e=qr(n.nextSibling);var r=Xt;e&&ly(t,e)?uw(r,n):(t.flags=t.flags&-4097|2,$e=!1,Xt=t)}}else{if(Uf(t))throw Error(z(418));t.flags=t.flags&-4097|2,$e=!1,Xt=t}}}function uy(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Xt=t}function Cu(t){if(t!==Xt)return!1;if(!$e)return uy(t),$e=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Vf(t.type,t.memoizedProps)),e&&(e=Qt)){if(Uf(t))throw cw(),Error(z(418));for(;e;)uw(t,e),e=qr(e.nextSibling)}if(uy(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(z(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Qt=qr(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Qt=null}}else Qt=Xt?qr(t.stateNode.nextSibling):null;return!0}function cw(){for(var t=Qt;t;)t=qr(t.nextSibling)}function lo(){Qt=Xt=null,$e=!1}function fm(t){In===null?In=[t]:In.push(t)}var ax=fr.ReactCurrentBatchConfig;function da(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(z(309));var r=n.stateNode}if(!r)throw Error(z(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(z(284));if(!n._owner)throw Error(z(290,t))}return t}function Au(t,e){throw t=Object.prototype.toString.call(e),Error(z(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function cy(t){var e=t._init;return e(t._payload)}function dw(t){function e(A,T){if(t){var S=A.deletions;S===null?(A.deletions=[T],A.flags|=16):S.push(T)}}function n(A,T){if(!t)return null;for(;T!==null;)e(A,T),T=T.sibling;return null}function r(A,T){for(A=new Map;T!==null;)T.key!==null?A.set(T.key,T):A.set(T.index,T),T=T.sibling;return A}function i(A,T){return A=Kr(A,T),A.index=0,A.sibling=null,A}function s(A,T,S){return A.index=S,t?(S=A.alternate,S!==null?(S=S.index,S<T?(A.flags|=2,T):S):(A.flags|=2,T)):(A.flags|=1048576,T)}function o(A){return t&&A.alternate===null&&(A.flags|=2),A}function a(A,T,S,V){return T===null||T.tag!==6?(T=Kh(S,A.mode,V),T.return=A,T):(T=i(T,S),T.return=A,T)}function l(A,T,S,V){var U=S.type;return U===Ds?f(A,T,S.props.children,V,S.key):T!==null&&(T.elementType===U||typeof U=="object"&&U!==null&&U.$$typeof===Pr&&cy(U)===T.type)?(V=i(T,S.props),V.ref=da(A,T,S),V.return=A,V):(V=ju(S.type,S.key,S.props,null,A.mode,V),V.ref=da(A,T,S),V.return=A,V)}function u(A,T,S,V){return T===null||T.tag!==4||T.stateNode.containerInfo!==S.containerInfo||T.stateNode.implementation!==S.implementation?(T=Wh(S,A.mode,V),T.return=A,T):(T=i(T,S.children||[]),T.return=A,T)}function f(A,T,S,V,U){return T===null||T.tag!==7?(T=Bi(S,A.mode,V,U),T.return=A,T):(T=i(T,S),T.return=A,T)}function p(A,T,S){if(typeof T=="string"&&T!==""||typeof T=="number")return T=Kh(""+T,A.mode,S),T.return=A,T;if(typeof T=="object"&&T!==null){switch(T.$$typeof){case mu:return S=ju(T.type,T.key,T.props,null,A.mode,S),S.ref=da(A,null,T),S.return=A,S;case Ns:return T=Wh(T,A.mode,S),T.return=A,T;case Pr:var V=T._init;return p(A,V(T._payload),S)}if(Ea(T)||oa(T))return T=Bi(T,A.mode,S,null),T.return=A,T;Au(A,T)}return null}function m(A,T,S,V){var U=T!==null?T.key:null;if(typeof S=="string"&&S!==""||typeof S=="number")return U!==null?null:a(A,T,""+S,V);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case mu:return S.key===U?l(A,T,S,V):null;case Ns:return S.key===U?u(A,T,S,V):null;case Pr:return U=S._init,m(A,T,U(S._payload),V)}if(Ea(S)||oa(S))return U!==null?null:f(A,T,S,V,null);Au(A,S)}return null}function v(A,T,S,V,U){if(typeof V=="string"&&V!==""||typeof V=="number")return A=A.get(S)||null,a(T,A,""+V,U);if(typeof V=="object"&&V!==null){switch(V.$$typeof){case mu:return A=A.get(V.key===null?S:V.key)||null,l(T,A,V,U);case Ns:return A=A.get(V.key===null?S:V.key)||null,u(T,A,V,U);case Pr:var F=V._init;return v(A,T,S,F(V._payload),U)}if(Ea(V)||oa(V))return A=A.get(S)||null,f(T,A,V,U,null);Au(T,V)}return null}function I(A,T,S,V){for(var U=null,F=null,C=T,E=T=0,R=null;C!==null&&E<S.length;E++){C.index>E?(R=C,C=null):R=C.sibling;var P=m(A,C,S[E],V);if(P===null){C===null&&(C=R);break}t&&C&&P.alternate===null&&e(A,C),T=s(P,T,E),F===null?U=P:F.sibling=P,F=P,C=R}if(E===S.length)return n(A,C),$e&&Ci(A,E),U;if(C===null){for(;E<S.length;E++)C=p(A,S[E],V),C!==null&&(T=s(C,T,E),F===null?U=C:F.sibling=C,F=C);return $e&&Ci(A,E),U}for(C=r(A,C);E<S.length;E++)R=v(C,A,E,S[E],V),R!==null&&(t&&R.alternate!==null&&C.delete(R.key===null?E:R.key),T=s(R,T,E),F===null?U=R:F.sibling=R,F=R);return t&&C.forEach(function(N){return e(A,N)}),$e&&Ci(A,E),U}function x(A,T,S,V){var U=oa(S);if(typeof U!="function")throw Error(z(150));if(S=U.call(S),S==null)throw Error(z(151));for(var F=U=null,C=T,E=T=0,R=null,P=S.next();C!==null&&!P.done;E++,P=S.next()){C.index>E?(R=C,C=null):R=C.sibling;var N=m(A,C,P.value,V);if(N===null){C===null&&(C=R);break}t&&C&&N.alternate===null&&e(A,C),T=s(N,T,E),F===null?U=N:F.sibling=N,F=N,C=R}if(P.done)return n(A,C),$e&&Ci(A,E),U;if(C===null){for(;!P.done;E++,P=S.next())P=p(A,P.value,V),P!==null&&(T=s(P,T,E),F===null?U=P:F.sibling=P,F=P);return $e&&Ci(A,E),U}for(C=r(A,C);!P.done;E++,P=S.next())P=v(C,A,E,P.value,V),P!==null&&(t&&P.alternate!==null&&C.delete(P.key===null?E:P.key),T=s(P,T,E),F===null?U=P:F.sibling=P,F=P);return t&&C.forEach(function(D){return e(A,D)}),$e&&Ci(A,E),U}function M(A,T,S,V){if(typeof S=="object"&&S!==null&&S.type===Ds&&S.key===null&&(S=S.props.children),typeof S=="object"&&S!==null){switch(S.$$typeof){case mu:e:{for(var U=S.key,F=T;F!==null;){if(F.key===U){if(U=S.type,U===Ds){if(F.tag===7){n(A,F.sibling),T=i(F,S.props.children),T.return=A,A=T;break e}}else if(F.elementType===U||typeof U=="object"&&U!==null&&U.$$typeof===Pr&&cy(U)===F.type){n(A,F.sibling),T=i(F,S.props),T.ref=da(A,F,S),T.return=A,A=T;break e}n(A,F);break}else e(A,F);F=F.sibling}S.type===Ds?(T=Bi(S.props.children,A.mode,V,S.key),T.return=A,A=T):(V=ju(S.type,S.key,S.props,null,A.mode,V),V.ref=da(A,T,S),V.return=A,A=V)}return o(A);case Ns:e:{for(F=S.key;T!==null;){if(T.key===F)if(T.tag===4&&T.stateNode.containerInfo===S.containerInfo&&T.stateNode.implementation===S.implementation){n(A,T.sibling),T=i(T,S.children||[]),T.return=A,A=T;break e}else{n(A,T);break}else e(A,T);T=T.sibling}T=Wh(S,A.mode,V),T.return=A,A=T}return o(A);case Pr:return F=S._init,M(A,T,F(S._payload),V)}if(Ea(S))return I(A,T,S,V);if(oa(S))return x(A,T,S,V);Au(A,S)}return typeof S=="string"&&S!==""||typeof S=="number"?(S=""+S,T!==null&&T.tag===6?(n(A,T.sibling),T=i(T,S),T.return=A,A=T):(n(A,T),T=Kh(S,A.mode,V),T.return=A,A=T),o(A)):n(A,T)}return M}var uo=dw(!0),hw=dw(!1),xc=ui(null),kc=null,Bs=null,pm=null;function mm(){pm=Bs=kc=null}function gm(t){var e=xc.current;Be(xc),t._currentValue=e}function Bf(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Qs(t,e){kc=t,pm=Bs=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Bt=!0),t.firstContext=null)}function mn(t){var e=t._currentValue;if(pm!==t)if(t={context:t,memoizedValue:e,next:null},Bs===null){if(kc===null)throw Error(z(308));Bs=t,kc.dependencies={lanes:0,firstContext:t}}else Bs=Bs.next=t;return e}var bi=null;function _m(t){bi===null?bi=[t]:bi.push(t)}function fw(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,_m(e)):(n.next=i.next,i.next=n),e.interleaved=n,ar(t,r)}function ar(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var xr=!1;function ym(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function pw(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function rr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function $r(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Ie&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,ar(t,n)}return i=r.interleaved,i===null?(e.next=e,_m(r)):(e.next=i.next,i.next=e),r.interleaved=e,ar(t,n)}function Hu(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,rm(t,n)}}function dy(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Nc(t,e,n,r){var i=t.updateQueue;xr=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?s=u:o.next=u,o=l;var f=t.alternate;f!==null&&(f=f.updateQueue,a=f.lastBaseUpdate,a!==o&&(a===null?f.firstBaseUpdate=u:a.next=u,f.lastBaseUpdate=l))}if(s!==null){var p=i.baseState;o=0,f=u=l=null,a=s;do{var m=a.lane,v=a.eventTime;if((r&m)===m){f!==null&&(f=f.next={eventTime:v,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var I=t,x=a;switch(m=e,v=n,x.tag){case 1:if(I=x.payload,typeof I=="function"){p=I.call(v,p,m);break e}p=I;break e;case 3:I.flags=I.flags&-65537|128;case 0:if(I=x.payload,m=typeof I=="function"?I.call(v,p,m):I,m==null)break e;p=Je({},p,m);break e;case 2:xr=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,m=i.effects,m===null?i.effects=[a]:m.push(a))}else v={eventTime:v,lane:m,tag:a.tag,payload:a.payload,callback:a.callback,next:null},f===null?(u=f=v,l=p):f=f.next=v,o|=m;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;m=a,a=m.next,m.next=null,i.lastBaseUpdate=m,i.shared.pending=null}}while(!0);if(f===null&&(l=p),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=f,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Ji|=o,t.lanes=o,t.memoizedState=p}}function hy(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(z(191,i));i.call(r)}}}var xl={},qn=ui(xl),ol=ui(xl),al=ui(xl);function Li(t){if(t===xl)throw Error(z(174));return t}function vm(t,e){switch(Le(al,e),Le(ol,t),Le(qn,xl),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Tf(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Tf(e,t)}Be(qn),Le(qn,e)}function co(){Be(qn),Be(ol),Be(al)}function mw(t){Li(al.current);var e=Li(qn.current),n=Tf(e,t.type);e!==n&&(Le(ol,t),Le(qn,n))}function Tm(t){ol.current===t&&(Be(qn),Be(ol))}var Ke=ui(0);function Dc(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Bh=[];function Em(){for(var t=0;t<Bh.length;t++)Bh[t]._workInProgressVersionPrimary=null;Bh.length=0}var Ku=fr.ReactCurrentDispatcher,Gh=fr.ReactCurrentBatchConfig,Wi=0,We=null,at=null,mt=null,Mc=!1,Ma=!1,ll=0,lx=0;function St(){throw Error(z(321))}function Im(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Nn(t[n],e[n]))return!1;return!0}function wm(t,e,n,r,i,s){if(Wi=s,We=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Ku.current=t===null||t.memoizedState===null?hx:fx,t=n(r,i),Ma){s=0;do{if(Ma=!1,ll=0,25<=s)throw Error(z(301));s+=1,mt=at=null,e.updateQueue=null,Ku.current=px,t=n(r,i)}while(Ma)}if(Ku.current=Vc,e=at!==null&&at.next!==null,Wi=0,mt=at=We=null,Mc=!1,e)throw Error(z(300));return t}function Sm(){var t=ll!==0;return ll=0,t}function Ln(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return mt===null?We.memoizedState=mt=t:mt=mt.next=t,mt}function gn(){if(at===null){var t=We.alternate;t=t!==null?t.memoizedState:null}else t=at.next;var e=mt===null?We.memoizedState:mt.next;if(e!==null)mt=e,at=t;else{if(t===null)throw Error(z(310));at=t,t={memoizedState:at.memoizedState,baseState:at.baseState,baseQueue:at.baseQueue,queue:at.queue,next:null},mt===null?We.memoizedState=mt=t:mt=mt.next=t}return mt}function ul(t,e){return typeof e=="function"?e(t):e}function qh(t){var e=gn(),n=e.queue;if(n===null)throw Error(z(311));n.lastRenderedReducer=t;var r=at,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,l=null,u=s;do{var f=u.lane;if((Wi&f)===f)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var p={lane:f,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=p,o=r):l=l.next=p,We.lanes|=f,Ji|=f}u=u.next}while(u!==null&&u!==s);l===null?o=r:l.next=a,Nn(r,e.memoizedState)||(Bt=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,We.lanes|=s,Ji|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function $h(t){var e=gn(),n=e.queue;if(n===null)throw Error(z(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);Nn(s,e.memoizedState)||(Bt=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function gw(){}function _w(t,e){var n=We,r=gn(),i=e(),s=!Nn(r.memoizedState,i);if(s&&(r.memoizedState=i,Bt=!0),r=r.queue,Cm(Tw.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||mt!==null&&mt.memoizedState.tag&1){if(n.flags|=2048,cl(9,vw.bind(null,n,r,i,e),void 0,null),gt===null)throw Error(z(349));Wi&30||yw(n,e,i)}return i}function yw(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=We.updateQueue,e===null?(e={lastEffect:null,stores:null},We.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function vw(t,e,n,r){e.value=n,e.getSnapshot=r,Ew(e)&&Iw(t)}function Tw(t,e,n){return n(function(){Ew(e)&&Iw(t)})}function Ew(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Nn(t,n)}catch{return!0}}function Iw(t){var e=ar(t,1);e!==null&&Rn(e,t,1,-1)}function fy(t){var e=Ln();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ul,lastRenderedState:t},e.queue=t,t=t.dispatch=dx.bind(null,We,t),[e.memoizedState,t]}function cl(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=We.updateQueue,e===null?(e={lastEffect:null,stores:null},We.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function ww(){return gn().memoizedState}function Wu(t,e,n,r){var i=Ln();We.flags|=t,i.memoizedState=cl(1|e,n,void 0,r===void 0?null:r)}function Ed(t,e,n,r){var i=gn();r=r===void 0?null:r;var s=void 0;if(at!==null){var o=at.memoizedState;if(s=o.destroy,r!==null&&Im(r,o.deps)){i.memoizedState=cl(e,n,s,r);return}}We.flags|=t,i.memoizedState=cl(1|e,n,s,r)}function py(t,e){return Wu(8390656,8,t,e)}function Cm(t,e){return Ed(2048,8,t,e)}function Sw(t,e){return Ed(4,2,t,e)}function Cw(t,e){return Ed(4,4,t,e)}function Aw(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Rw(t,e,n){return n=n!=null?n.concat([t]):null,Ed(4,4,Aw.bind(null,e,t),n)}function Am(){}function Pw(t,e){var n=gn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Im(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function xw(t,e){var n=gn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Im(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function kw(t,e,n){return Wi&21?(Nn(n,e)||(n=bI(),We.lanes|=n,Ji|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Bt=!0),t.memoizedState=n)}function ux(t,e){var n=Pe;Pe=n!==0&&4>n?n:4,t(!0);var r=Gh.transition;Gh.transition={};try{t(!1),e()}finally{Pe=n,Gh.transition=r}}function Nw(){return gn().memoizedState}function cx(t,e,n){var r=Hr(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Dw(t))Mw(e,n);else if(n=fw(t,e,n,r),n!==null){var i=Vt();Rn(n,t,r,i),Vw(n,e,r)}}function dx(t,e,n){var r=Hr(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Dw(t))Mw(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,Nn(a,o)){var l=e.interleaved;l===null?(i.next=i,_m(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=fw(t,e,i,r),n!==null&&(i=Vt(),Rn(n,t,r,i),Vw(n,e,r))}}function Dw(t){var e=t.alternate;return t===We||e!==null&&e===We}function Mw(t,e){Ma=Mc=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Vw(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,rm(t,n)}}var Vc={readContext:mn,useCallback:St,useContext:St,useEffect:St,useImperativeHandle:St,useInsertionEffect:St,useLayoutEffect:St,useMemo:St,useReducer:St,useRef:St,useState:St,useDebugValue:St,useDeferredValue:St,useTransition:St,useMutableSource:St,useSyncExternalStore:St,useId:St,unstable_isNewReconciler:!1},hx={readContext:mn,useCallback:function(t,e){return Ln().memoizedState=[t,e===void 0?null:e],t},useContext:mn,useEffect:py,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Wu(4194308,4,Aw.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Wu(4194308,4,t,e)},useInsertionEffect:function(t,e){return Wu(4,2,t,e)},useMemo:function(t,e){var n=Ln();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Ln();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=cx.bind(null,We,t),[r.memoizedState,t]},useRef:function(t){var e=Ln();return t={current:t},e.memoizedState=t},useState:fy,useDebugValue:Am,useDeferredValue:function(t){return Ln().memoizedState=t},useTransition:function(){var t=fy(!1),e=t[0];return t=ux.bind(null,t[1]),Ln().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=We,i=Ln();if($e){if(n===void 0)throw Error(z(407));n=n()}else{if(n=e(),gt===null)throw Error(z(349));Wi&30||yw(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,py(Tw.bind(null,r,s,t),[t]),r.flags|=2048,cl(9,vw.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=Ln(),e=gt.identifierPrefix;if($e){var n=Zn,r=Xn;n=(r&~(1<<32-An(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=ll++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=lx++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},fx={readContext:mn,useCallback:Pw,useContext:mn,useEffect:Cm,useImperativeHandle:Rw,useInsertionEffect:Sw,useLayoutEffect:Cw,useMemo:xw,useReducer:qh,useRef:ww,useState:function(){return qh(ul)},useDebugValue:Am,useDeferredValue:function(t){var e=gn();return kw(e,at.memoizedState,t)},useTransition:function(){var t=qh(ul)[0],e=gn().memoizedState;return[t,e]},useMutableSource:gw,useSyncExternalStore:_w,useId:Nw,unstable_isNewReconciler:!1},px={readContext:mn,useCallback:Pw,useContext:mn,useEffect:Cm,useImperativeHandle:Rw,useInsertionEffect:Sw,useLayoutEffect:Cw,useMemo:xw,useReducer:$h,useRef:ww,useState:function(){return $h(ul)},useDebugValue:Am,useDeferredValue:function(t){var e=gn();return at===null?e.memoizedState=t:kw(e,at.memoizedState,t)},useTransition:function(){var t=$h(ul)[0],e=gn().memoizedState;return[t,e]},useMutableSource:gw,useSyncExternalStore:_w,useId:Nw,unstable_isNewReconciler:!1};function vn(t,e){if(t&&t.defaultProps){e=Je({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Gf(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Je({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Id={isMounted:function(t){return(t=t._reactInternals)?as(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Vt(),i=Hr(t),s=rr(r,i);s.payload=e,n!=null&&(s.callback=n),e=$r(t,s,i),e!==null&&(Rn(e,t,i,r),Hu(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Vt(),i=Hr(t),s=rr(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=$r(t,s,i),e!==null&&(Rn(e,t,i,r),Hu(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Vt(),r=Hr(t),i=rr(n,r);i.tag=2,e!=null&&(i.callback=e),e=$r(t,i,r),e!==null&&(Rn(e,t,r,n),Hu(e,t,r))}};function my(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!nl(n,r)||!nl(i,s):!0}function bw(t,e,n){var r=!1,i=ei,s=e.contextType;return typeof s=="object"&&s!==null?s=mn(s):(i=qt(e)?Hi:Nt.current,r=e.contextTypes,s=(r=r!=null)?ao(t,i):ei),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Id,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function gy(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Id.enqueueReplaceState(e,e.state,null)}function qf(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},ym(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=mn(s):(s=qt(e)?Hi:Nt.current,i.context=ao(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Gf(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Id.enqueueReplaceState(i,i.state,null),Nc(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function ho(t,e){try{var n="",r=e;do n+=qR(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function zh(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function $f(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var mx=typeof WeakMap=="function"?WeakMap:Map;function Lw(t,e,n){n=rr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Lc||(Lc=!0,Zf=r),$f(t,e)},n}function Fw(t,e,n){n=rr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){$f(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){$f(t,e),typeof r!="function"&&(zr===null?zr=new Set([this]):zr.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function _y(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new mx;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=xx.bind(null,t,e,n),e.then(t,t))}function yy(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function vy(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=rr(-1,1),e.tag=2,$r(n,e,1))),n.lanes|=1),t)}var gx=fr.ReactCurrentOwner,Bt=!1;function Dt(t,e,n,r){e.child=t===null?hw(e,null,n,r):uo(e,t.child,n,r)}function Ty(t,e,n,r,i){n=n.render;var s=e.ref;return Qs(e,i),r=wm(t,e,n,r,s,i),n=Sm(),t!==null&&!Bt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,lr(t,e,i)):($e&&n&&dm(e),e.flags|=1,Dt(t,e,r,i),e.child)}function Ey(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!Vm(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,Uw(t,e,s,r,i)):(t=ju(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:nl,n(o,r)&&t.ref===e.ref)return lr(t,e,i)}return e.flags|=1,t=Kr(s,r),t.ref=e.ref,t.return=e,e.child=t}function Uw(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(nl(s,r)&&t.ref===e.ref)if(Bt=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(Bt=!0);else return e.lanes=t.lanes,lr(t,e,i)}return zf(t,e,n,r,i)}function Ow(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Le(qs,Kt),Kt|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Le(qs,Kt),Kt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,Le(qs,Kt),Kt|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,Le(qs,Kt),Kt|=r;return Dt(t,e,i,n),e.child}function Bw(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function zf(t,e,n,r,i){var s=qt(n)?Hi:Nt.current;return s=ao(e,s),Qs(e,i),n=wm(t,e,n,r,s,i),r=Sm(),t!==null&&!Bt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,lr(t,e,i)):($e&&r&&dm(e),e.flags|=1,Dt(t,e,n,i),e.child)}function Iy(t,e,n,r,i){if(qt(n)){var s=!0;Ac(e)}else s=!1;if(Qs(e,i),e.stateNode===null)Ju(t,e),bw(e,n,r),qf(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=mn(u):(u=qt(n)?Hi:Nt.current,u=ao(e,u));var f=n.getDerivedStateFromProps,p=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function";p||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==u)&&gy(e,o,r,u),xr=!1;var m=e.memoizedState;o.state=m,Nc(e,r,o,i),l=e.memoizedState,a!==r||m!==l||Gt.current||xr?(typeof f=="function"&&(Gf(e,n,f,r),l=e.memoizedState),(a=xr||my(e,n,a,r,m,l,u))?(p||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=u,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,pw(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:vn(e.type,a),o.props=u,p=e.pendingProps,m=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=mn(l):(l=qt(n)?Hi:Nt.current,l=ao(e,l));var v=n.getDerivedStateFromProps;(f=typeof v=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==p||m!==l)&&gy(e,o,r,l),xr=!1,m=e.memoizedState,o.state=m,Nc(e,r,o,i);var I=e.memoizedState;a!==p||m!==I||Gt.current||xr?(typeof v=="function"&&(Gf(e,n,v,r),I=e.memoizedState),(u=xr||my(e,n,u,r,m,I,l)||!1)?(f||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,I,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,I,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=I),o.props=r,o.state=I,o.context=l,r=u):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),r=!1)}return Hf(t,e,n,r,s,i)}function Hf(t,e,n,r,i,s){Bw(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&ay(e,n,!1),lr(t,e,s);r=e.stateNode,gx.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=uo(e,t.child,null,s),e.child=uo(e,null,a,s)):Dt(t,e,a,s),e.memoizedState=r.state,i&&ay(e,n,!0),e.child}function Gw(t){var e=t.stateNode;e.pendingContext?oy(t,e.pendingContext,e.pendingContext!==e.context):e.context&&oy(t,e.context,!1),vm(t,e.containerInfo)}function wy(t,e,n,r,i){return lo(),fm(i),e.flags|=256,Dt(t,e,n,r),e.child}var Kf={dehydrated:null,treeContext:null,retryLane:0};function Wf(t){return{baseLanes:t,cachePool:null,transitions:null}}function qw(t,e,n){var r=e.pendingProps,i=Ke.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Le(Ke,i&1),t===null)return Of(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=Cd(o,r,0,null),t=Bi(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Wf(n),e.memoizedState=Kf,t):Rm(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return _x(t,e,o,r,a,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Kr(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=Kr(a,s):(s=Bi(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?Wf(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=Kf,r}return s=t.child,t=s.sibling,r=Kr(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Rm(t,e){return e=Cd({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Ru(t,e,n,r){return r!==null&&fm(r),uo(e,t.child,null,n),t=Rm(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function _x(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=zh(Error(z(422))),Ru(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=Cd({mode:"visible",children:r.children},i,0,null),s=Bi(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&uo(e,t.child,null,o),e.child.memoizedState=Wf(o),e.memoizedState=Kf,s);if(!(e.mode&1))return Ru(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(z(419)),r=zh(s,r,void 0),Ru(t,e,o,r)}if(a=(o&t.childLanes)!==0,Bt||a){if(r=gt,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,ar(t,i),Rn(r,t,i,-1))}return Mm(),r=zh(Error(z(421))),Ru(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=kx.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Qt=qr(i.nextSibling),Xt=e,$e=!0,In=null,t!==null&&(an[ln++]=Xn,an[ln++]=Zn,an[ln++]=Ki,Xn=t.id,Zn=t.overflow,Ki=e),e=Rm(e,r.children),e.flags|=4096,e)}function Sy(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Bf(t.return,e,n)}function Hh(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function $w(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(Dt(t,e,r.children,n),r=Ke.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Sy(t,n,e);else if(t.tag===19)Sy(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Le(Ke,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&Dc(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Hh(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Dc(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Hh(e,!0,n,null,s);break;case"together":Hh(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Ju(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function lr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Ji|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(z(153));if(e.child!==null){for(t=e.child,n=Kr(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Kr(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function yx(t,e,n){switch(e.tag){case 3:Gw(e),lo();break;case 5:mw(e);break;case 1:qt(e.type)&&Ac(e);break;case 4:vm(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Le(xc,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Le(Ke,Ke.current&1),e.flags|=128,null):n&e.child.childLanes?qw(t,e,n):(Le(Ke,Ke.current&1),t=lr(t,e,n),t!==null?t.sibling:null);Le(Ke,Ke.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return $w(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Le(Ke,Ke.current),r)break;return null;case 22:case 23:return e.lanes=0,Ow(t,e,n)}return lr(t,e,n)}var zw,Jf,Hw,Kw;zw=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Jf=function(){};Hw=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Li(qn.current);var s=null;switch(n){case"input":i=gf(t,i),r=gf(t,r),s=[];break;case"select":i=Je({},i,{value:void 0}),r=Je({},r,{value:void 0}),s=[];break;case"textarea":i=vf(t,i),r=vf(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Sc)}Ef(n,r);var o;n=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var a=i[u];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Qa.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var l=r[u];if(a=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Qa.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Ue("scroll",t),s||a===l||(s=[])):(s=s||[]).push(u,l))}n&&(s=s||[]).push("style",n);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};Kw=function(t,e,n,r){n!==r&&(e.flags|=4)};function ha(t,e){if(!$e)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Ct(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function vx(t,e,n){var r=e.pendingProps;switch(hm(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ct(e),null;case 1:return qt(e.type)&&Cc(),Ct(e),null;case 3:return r=e.stateNode,co(),Be(Gt),Be(Nt),Em(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Cu(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,In!==null&&(np(In),In=null))),Jf(t,e),Ct(e),null;case 5:Tm(e);var i=Li(al.current);if(n=e.type,t!==null&&e.stateNode!=null)Hw(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(z(166));return Ct(e),null}if(t=Li(qn.current),Cu(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[Un]=e,r[sl]=s,t=(e.mode&1)!==0,n){case"dialog":Ue("cancel",r),Ue("close",r);break;case"iframe":case"object":case"embed":Ue("load",r);break;case"video":case"audio":for(i=0;i<wa.length;i++)Ue(wa[i],r);break;case"source":Ue("error",r);break;case"img":case"image":case"link":Ue("error",r),Ue("load",r);break;case"details":Ue("toggle",r);break;case"input":M_(r,s),Ue("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Ue("invalid",r);break;case"textarea":b_(r,s),Ue("invalid",r)}Ef(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&Su(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Su(r.textContent,a,t),i=["children",""+a]):Qa.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Ue("scroll",r)}switch(n){case"input":gu(r),V_(r,s,!0);break;case"textarea":gu(r),L_(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=Sc)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=TI(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Un]=e,t[sl]=r,zw(t,e,!1,!1),e.stateNode=t;e:{switch(o=If(n,r),n){case"dialog":Ue("cancel",t),Ue("close",t),i=r;break;case"iframe":case"object":case"embed":Ue("load",t),i=r;break;case"video":case"audio":for(i=0;i<wa.length;i++)Ue(wa[i],t);i=r;break;case"source":Ue("error",t),i=r;break;case"img":case"image":case"link":Ue("error",t),Ue("load",t),i=r;break;case"details":Ue("toggle",t),i=r;break;case"input":M_(t,r),i=gf(t,r),Ue("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=Je({},r,{value:void 0}),Ue("invalid",t);break;case"textarea":b_(t,r),i=vf(t,r),Ue("invalid",t);break;default:i=r}Ef(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?wI(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&EI(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Ya(t,l):typeof l=="number"&&Ya(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Qa.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Ue("scroll",t):l!=null&&jp(t,s,l,o))}switch(n){case"input":gu(t),V_(t,r,!1);break;case"textarea":gu(t),L_(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Zr(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?Hs(t,!!r.multiple,s,!1):r.defaultValue!=null&&Hs(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Sc)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Ct(e),null;case 6:if(t&&e.stateNode!=null)Kw(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(z(166));if(n=Li(al.current),Li(qn.current),Cu(e)){if(r=e.stateNode,n=e.memoizedProps,r[Un]=e,(s=r.nodeValue!==n)&&(t=Xt,t!==null))switch(t.tag){case 3:Su(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Su(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Un]=e,e.stateNode=r}return Ct(e),null;case 13:if(Be(Ke),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if($e&&Qt!==null&&e.mode&1&&!(e.flags&128))cw(),lo(),e.flags|=98560,s=!1;else if(s=Cu(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(z(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(z(317));s[Un]=e}else lo(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ct(e),s=!1}else In!==null&&(np(In),In=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Ke.current&1?lt===0&&(lt=3):Mm())),e.updateQueue!==null&&(e.flags|=4),Ct(e),null);case 4:return co(),Jf(t,e),t===null&&rl(e.stateNode.containerInfo),Ct(e),null;case 10:return gm(e.type._context),Ct(e),null;case 17:return qt(e.type)&&Cc(),Ct(e),null;case 19:if(Be(Ke),s=e.memoizedState,s===null)return Ct(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)ha(s,!1);else{if(lt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Dc(t),o!==null){for(e.flags|=128,ha(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Le(Ke,Ke.current&1|2),e.child}t=t.sibling}s.tail!==null&&Xe()>fo&&(e.flags|=128,r=!0,ha(s,!1),e.lanes=4194304)}else{if(!r)if(t=Dc(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),ha(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!$e)return Ct(e),null}else 2*Xe()-s.renderingStartTime>fo&&n!==1073741824&&(e.flags|=128,r=!0,ha(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Xe(),e.sibling=null,n=Ke.current,Le(Ke,r?n&1|2:n&1),e):(Ct(e),null);case 22:case 23:return Dm(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Kt&1073741824&&(Ct(e),e.subtreeFlags&6&&(e.flags|=8192)):Ct(e),null;case 24:return null;case 25:return null}throw Error(z(156,e.tag))}function Tx(t,e){switch(hm(e),e.tag){case 1:return qt(e.type)&&Cc(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return co(),Be(Gt),Be(Nt),Em(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Tm(e),null;case 13:if(Be(Ke),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(z(340));lo()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Be(Ke),null;case 4:return co(),null;case 10:return gm(e.type._context),null;case 22:case 23:return Dm(),null;case 24:return null;default:return null}}var Pu=!1,Pt=!1,Ex=typeof WeakSet=="function"?WeakSet:Set,Y=null;function Gs(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Ye(t,e,r)}else n.current=null}function Qf(t,e,n){try{n()}catch(r){Ye(t,e,r)}}var Cy=!1;function Ix(t,e){if(Df=Ec,t=jI(),cm(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,u=0,f=0,p=t,m=null;t:for(;;){for(var v;p!==n||i!==0&&p.nodeType!==3||(a=o+i),p!==s||r!==0&&p.nodeType!==3||(l=o+r),p.nodeType===3&&(o+=p.nodeValue.length),(v=p.firstChild)!==null;)m=p,p=v;for(;;){if(p===t)break t;if(m===n&&++u===i&&(a=o),m===s&&++f===r&&(l=o),(v=p.nextSibling)!==null)break;p=m,m=p.parentNode}p=v}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(Mf={focusedElem:t,selectionRange:n},Ec=!1,Y=e;Y!==null;)if(e=Y,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Y=t;else for(;Y!==null;){e=Y;try{var I=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(I!==null){var x=I.memoizedProps,M=I.memoizedState,A=e.stateNode,T=A.getSnapshotBeforeUpdate(e.elementType===e.type?x:vn(e.type,x),M);A.__reactInternalSnapshotBeforeUpdate=T}break;case 3:var S=e.stateNode.containerInfo;S.nodeType===1?S.textContent="":S.nodeType===9&&S.documentElement&&S.removeChild(S.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(z(163))}}catch(V){Ye(e,e.return,V)}if(t=e.sibling,t!==null){t.return=e.return,Y=t;break}Y=e.return}return I=Cy,Cy=!1,I}function Va(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&Qf(e,n,s)}i=i.next}while(i!==r)}}function wd(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Yf(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function Ww(t){var e=t.alternate;e!==null&&(t.alternate=null,Ww(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Un],delete e[sl],delete e[Lf],delete e[ix],delete e[sx])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Jw(t){return t.tag===5||t.tag===3||t.tag===4}function Ay(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Jw(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function jf(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Sc));else if(r!==4&&(t=t.child,t!==null))for(jf(t,e,n),t=t.sibling;t!==null;)jf(t,e,n),t=t.sibling}function Xf(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Xf(t,e,n),t=t.sibling;t!==null;)Xf(t,e,n),t=t.sibling}var vt=null,Tn=!1;function wr(t,e,n){for(n=n.child;n!==null;)Qw(t,e,n),n=n.sibling}function Qw(t,e,n){if(Gn&&typeof Gn.onCommitFiberUnmount=="function")try{Gn.onCommitFiberUnmount(md,n)}catch{}switch(n.tag){case 5:Pt||Gs(n,e);case 6:var r=vt,i=Tn;vt=null,wr(t,e,n),vt=r,Tn=i,vt!==null&&(Tn?(t=vt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):vt.removeChild(n.stateNode));break;case 18:vt!==null&&(Tn?(t=vt,n=n.stateNode,t.nodeType===8?Uh(t.parentNode,n):t.nodeType===1&&Uh(t,n),el(t)):Uh(vt,n.stateNode));break;case 4:r=vt,i=Tn,vt=n.stateNode.containerInfo,Tn=!0,wr(t,e,n),vt=r,Tn=i;break;case 0:case 11:case 14:case 15:if(!Pt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&Qf(n,e,o),i=i.next}while(i!==r)}wr(t,e,n);break;case 1:if(!Pt&&(Gs(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Ye(n,e,a)}wr(t,e,n);break;case 21:wr(t,e,n);break;case 22:n.mode&1?(Pt=(r=Pt)||n.memoizedState!==null,wr(t,e,n),Pt=r):wr(t,e,n);break;default:wr(t,e,n)}}function Ry(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new Ex),e.forEach(function(r){var i=Nx.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function yn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:vt=a.stateNode,Tn=!1;break e;case 3:vt=a.stateNode.containerInfo,Tn=!0;break e;case 4:vt=a.stateNode.containerInfo,Tn=!0;break e}a=a.return}if(vt===null)throw Error(z(160));Qw(s,o,i),vt=null,Tn=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){Ye(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Yw(e,t),e=e.sibling}function Yw(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(yn(e,t),bn(t),r&4){try{Va(3,t,t.return),wd(3,t)}catch(x){Ye(t,t.return,x)}try{Va(5,t,t.return)}catch(x){Ye(t,t.return,x)}}break;case 1:yn(e,t),bn(t),r&512&&n!==null&&Gs(n,n.return);break;case 5:if(yn(e,t),bn(t),r&512&&n!==null&&Gs(n,n.return),t.flags&32){var i=t.stateNode;try{Ya(i,"")}catch(x){Ye(t,t.return,x)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&yI(i,s),If(a,o);var u=If(a,s);for(o=0;o<l.length;o+=2){var f=l[o],p=l[o+1];f==="style"?wI(i,p):f==="dangerouslySetInnerHTML"?EI(i,p):f==="children"?Ya(i,p):jp(i,f,p,u)}switch(a){case"input":_f(i,s);break;case"textarea":vI(i,s);break;case"select":var m=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var v=s.value;v!=null?Hs(i,!!s.multiple,v,!1):m!==!!s.multiple&&(s.defaultValue!=null?Hs(i,!!s.multiple,s.defaultValue,!0):Hs(i,!!s.multiple,s.multiple?[]:"",!1))}i[sl]=s}catch(x){Ye(t,t.return,x)}}break;case 6:if(yn(e,t),bn(t),r&4){if(t.stateNode===null)throw Error(z(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(x){Ye(t,t.return,x)}}break;case 3:if(yn(e,t),bn(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{el(e.containerInfo)}catch(x){Ye(t,t.return,x)}break;case 4:yn(e,t),bn(t);break;case 13:yn(e,t),bn(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(km=Xe())),r&4&&Ry(t);break;case 22:if(f=n!==null&&n.memoizedState!==null,t.mode&1?(Pt=(u=Pt)||f,yn(e,t),Pt=u):yn(e,t),bn(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!f&&t.mode&1)for(Y=t,f=t.child;f!==null;){for(p=Y=f;Y!==null;){switch(m=Y,v=m.child,m.tag){case 0:case 11:case 14:case 15:Va(4,m,m.return);break;case 1:Gs(m,m.return);var I=m.stateNode;if(typeof I.componentWillUnmount=="function"){r=m,n=m.return;try{e=r,I.props=e.memoizedProps,I.state=e.memoizedState,I.componentWillUnmount()}catch(x){Ye(r,n,x)}}break;case 5:Gs(m,m.return);break;case 22:if(m.memoizedState!==null){xy(p);continue}}v!==null?(v.return=m,Y=v):xy(p)}f=f.sibling}e:for(f=null,p=t;;){if(p.tag===5){if(f===null){f=p;try{i=p.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=p.stateNode,l=p.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=II("display",o))}catch(x){Ye(t,t.return,x)}}}else if(p.tag===6){if(f===null)try{p.stateNode.nodeValue=u?"":p.memoizedProps}catch(x){Ye(t,t.return,x)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===t)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===t)break e;for(;p.sibling===null;){if(p.return===null||p.return===t)break e;f===p&&(f=null),p=p.return}f===p&&(f=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:yn(e,t),bn(t),r&4&&Ry(t);break;case 21:break;default:yn(e,t),bn(t)}}function bn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(Jw(n)){var r=n;break e}n=n.return}throw Error(z(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Ya(i,""),r.flags&=-33);var s=Ay(t);Xf(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=Ay(t);jf(t,a,o);break;default:throw Error(z(161))}}catch(l){Ye(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function wx(t,e,n){Y=t,jw(t)}function jw(t,e,n){for(var r=(t.mode&1)!==0;Y!==null;){var i=Y,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||Pu;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||Pt;a=Pu;var u=Pt;if(Pu=o,(Pt=l)&&!u)for(Y=i;Y!==null;)o=Y,l=o.child,o.tag===22&&o.memoizedState!==null?ky(i):l!==null?(l.return=o,Y=l):ky(i);for(;s!==null;)Y=s,jw(s),s=s.sibling;Y=i,Pu=a,Pt=u}Py(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,Y=s):Py(t)}}function Py(t){for(;Y!==null;){var e=Y;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Pt||wd(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Pt)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:vn(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&hy(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}hy(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var f=u.memoizedState;if(f!==null){var p=f.dehydrated;p!==null&&el(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(z(163))}Pt||e.flags&512&&Yf(e)}catch(m){Ye(e,e.return,m)}}if(e===t){Y=null;break}if(n=e.sibling,n!==null){n.return=e.return,Y=n;break}Y=e.return}}function xy(t){for(;Y!==null;){var e=Y;if(e===t){Y=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Y=n;break}Y=e.return}}function ky(t){for(;Y!==null;){var e=Y;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{wd(4,e)}catch(l){Ye(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){Ye(e,i,l)}}var s=e.return;try{Yf(e)}catch(l){Ye(e,s,l)}break;case 5:var o=e.return;try{Yf(e)}catch(l){Ye(e,o,l)}}}catch(l){Ye(e,e.return,l)}if(e===t){Y=null;break}var a=e.sibling;if(a!==null){a.return=e.return,Y=a;break}Y=e.return}}var Sx=Math.ceil,bc=fr.ReactCurrentDispatcher,Pm=fr.ReactCurrentOwner,hn=fr.ReactCurrentBatchConfig,Ie=0,gt=null,rt=null,It=0,Kt=0,qs=ui(0),lt=0,dl=null,Ji=0,Sd=0,xm=0,ba=null,Ut=null,km=0,fo=1/0,Qn=null,Lc=!1,Zf=null,zr=null,xu=!1,Fr=null,Fc=0,La=0,ep=null,Qu=-1,Yu=0;function Vt(){return Ie&6?Xe():Qu!==-1?Qu:Qu=Xe()}function Hr(t){return t.mode&1?Ie&2&&It!==0?It&-It:ax.transition!==null?(Yu===0&&(Yu=bI()),Yu):(t=Pe,t!==0||(t=window.event,t=t===void 0?16:qI(t.type)),t):1}function Rn(t,e,n,r){if(50<La)throw La=0,ep=null,Error(z(185));Al(t,n,r),(!(Ie&2)||t!==gt)&&(t===gt&&(!(Ie&2)&&(Sd|=n),lt===4&&Nr(t,It)),$t(t,r),n===1&&Ie===0&&!(e.mode&1)&&(fo=Xe()+500,Td&&ci()))}function $t(t,e){var n=t.callbackNode;aP(t,e);var r=Tc(t,t===gt?It:0);if(r===0)n!==null&&O_(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&O_(n),e===1)t.tag===0?ox(Ny.bind(null,t)):aw(Ny.bind(null,t)),nx(function(){!(Ie&6)&&ci()}),n=null;else{switch(LI(r)){case 1:n=nm;break;case 4:n=MI;break;case 16:n=vc;break;case 536870912:n=VI;break;default:n=vc}n=sS(n,Xw.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function Xw(t,e){if(Qu=-1,Yu=0,Ie&6)throw Error(z(327));var n=t.callbackNode;if(Ys()&&t.callbackNode!==n)return null;var r=Tc(t,t===gt?It:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Uc(t,r);else{e=r;var i=Ie;Ie|=2;var s=eS();(gt!==t||It!==e)&&(Qn=null,fo=Xe()+500,Oi(t,e));do try{Rx();break}catch(a){Zw(t,a)}while(!0);mm(),bc.current=s,Ie=i,rt!==null?e=0:(gt=null,It=0,e=lt)}if(e!==0){if(e===2&&(i=Rf(t),i!==0&&(r=i,e=tp(t,i))),e===1)throw n=dl,Oi(t,0),Nr(t,r),$t(t,Xe()),n;if(e===6)Nr(t,r);else{if(i=t.current.alternate,!(r&30)&&!Cx(i)&&(e=Uc(t,r),e===2&&(s=Rf(t),s!==0&&(r=s,e=tp(t,s))),e===1))throw n=dl,Oi(t,0),Nr(t,r),$t(t,Xe()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(z(345));case 2:Ai(t,Ut,Qn);break;case 3:if(Nr(t,r),(r&130023424)===r&&(e=km+500-Xe(),10<e)){if(Tc(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){Vt(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=bf(Ai.bind(null,t,Ut,Qn),e);break}Ai(t,Ut,Qn);break;case 4:if(Nr(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-An(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=Xe()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Sx(r/1960))-r,10<r){t.timeoutHandle=bf(Ai.bind(null,t,Ut,Qn),r);break}Ai(t,Ut,Qn);break;case 5:Ai(t,Ut,Qn);break;default:throw Error(z(329))}}}return $t(t,Xe()),t.callbackNode===n?Xw.bind(null,t):null}function tp(t,e){var n=ba;return t.current.memoizedState.isDehydrated&&(Oi(t,e).flags|=256),t=Uc(t,e),t!==2&&(e=Ut,Ut=n,e!==null&&np(e)),t}function np(t){Ut===null?Ut=t:Ut.push.apply(Ut,t)}function Cx(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!Nn(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Nr(t,e){for(e&=~xm,e&=~Sd,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-An(e),r=1<<n;t[n]=-1,e&=~r}}function Ny(t){if(Ie&6)throw Error(z(327));Ys();var e=Tc(t,0);if(!(e&1))return $t(t,Xe()),null;var n=Uc(t,e);if(t.tag!==0&&n===2){var r=Rf(t);r!==0&&(e=r,n=tp(t,r))}if(n===1)throw n=dl,Oi(t,0),Nr(t,e),$t(t,Xe()),n;if(n===6)throw Error(z(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ai(t,Ut,Qn),$t(t,Xe()),null}function Nm(t,e){var n=Ie;Ie|=1;try{return t(e)}finally{Ie=n,Ie===0&&(fo=Xe()+500,Td&&ci())}}function Qi(t){Fr!==null&&Fr.tag===0&&!(Ie&6)&&Ys();var e=Ie;Ie|=1;var n=hn.transition,r=Pe;try{if(hn.transition=null,Pe=1,t)return t()}finally{Pe=r,hn.transition=n,Ie=e,!(Ie&6)&&ci()}}function Dm(){Kt=qs.current,Be(qs)}function Oi(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,tx(n)),rt!==null)for(n=rt.return;n!==null;){var r=n;switch(hm(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Cc();break;case 3:co(),Be(Gt),Be(Nt),Em();break;case 5:Tm(r);break;case 4:co();break;case 13:Be(Ke);break;case 19:Be(Ke);break;case 10:gm(r.type._context);break;case 22:case 23:Dm()}n=n.return}if(gt=t,rt=t=Kr(t.current,null),It=Kt=e,lt=0,dl=null,xm=Sd=Ji=0,Ut=ba=null,bi!==null){for(e=0;e<bi.length;e++)if(n=bi[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}bi=null}return t}function Zw(t,e){do{var n=rt;try{if(mm(),Ku.current=Vc,Mc){for(var r=We.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Mc=!1}if(Wi=0,mt=at=We=null,Ma=!1,ll=0,Pm.current=null,n===null||n.return===null){lt=1,dl=e,rt=null;break}e:{var s=t,o=n.return,a=n,l=e;if(e=It,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,f=a,p=f.tag;if(!(f.mode&1)&&(p===0||p===11||p===15)){var m=f.alternate;m?(f.updateQueue=m.updateQueue,f.memoizedState=m.memoizedState,f.lanes=m.lanes):(f.updateQueue=null,f.memoizedState=null)}var v=yy(o);if(v!==null){v.flags&=-257,vy(v,o,a,s,e),v.mode&1&&_y(s,u,e),e=v,l=u;var I=e.updateQueue;if(I===null){var x=new Set;x.add(l),e.updateQueue=x}else I.add(l);break e}else{if(!(e&1)){_y(s,u,e),Mm();break e}l=Error(z(426))}}else if($e&&a.mode&1){var M=yy(o);if(M!==null){!(M.flags&65536)&&(M.flags|=256),vy(M,o,a,s,e),fm(ho(l,a));break e}}s=l=ho(l,a),lt!==4&&(lt=2),ba===null?ba=[s]:ba.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var A=Lw(s,l,e);dy(s,A);break e;case 1:a=l;var T=s.type,S=s.stateNode;if(!(s.flags&128)&&(typeof T.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(zr===null||!zr.has(S)))){s.flags|=65536,e&=-e,s.lanes|=e;var V=Fw(s,a,e);dy(s,V);break e}}s=s.return}while(s!==null)}nS(n)}catch(U){e=U,rt===n&&n!==null&&(rt=n=n.return);continue}break}while(!0)}function eS(){var t=bc.current;return bc.current=Vc,t===null?Vc:t}function Mm(){(lt===0||lt===3||lt===2)&&(lt=4),gt===null||!(Ji&268435455)&&!(Sd&268435455)||Nr(gt,It)}function Uc(t,e){var n=Ie;Ie|=2;var r=eS();(gt!==t||It!==e)&&(Qn=null,Oi(t,e));do try{Ax();break}catch(i){Zw(t,i)}while(!0);if(mm(),Ie=n,bc.current=r,rt!==null)throw Error(z(261));return gt=null,It=0,lt}function Ax(){for(;rt!==null;)tS(rt)}function Rx(){for(;rt!==null&&!XR();)tS(rt)}function tS(t){var e=iS(t.alternate,t,Kt);t.memoizedProps=t.pendingProps,e===null?nS(t):rt=e,Pm.current=null}function nS(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=Tx(n,e),n!==null){n.flags&=32767,rt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{lt=6,rt=null;return}}else if(n=vx(n,e,Kt),n!==null){rt=n;return}if(e=e.sibling,e!==null){rt=e;return}rt=e=t}while(e!==null);lt===0&&(lt=5)}function Ai(t,e,n){var r=Pe,i=hn.transition;try{hn.transition=null,Pe=1,Px(t,e,n,r)}finally{hn.transition=i,Pe=r}return null}function Px(t,e,n,r){do Ys();while(Fr!==null);if(Ie&6)throw Error(z(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(z(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(lP(t,s),t===gt&&(rt=gt=null,It=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||xu||(xu=!0,sS(vc,function(){return Ys(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=hn.transition,hn.transition=null;var o=Pe;Pe=1;var a=Ie;Ie|=4,Pm.current=null,Ix(t,n),Yw(n,t),JP(Mf),Ec=!!Df,Mf=Df=null,t.current=n,wx(n),ZR(),Ie=a,Pe=o,hn.transition=s}else t.current=n;if(xu&&(xu=!1,Fr=t,Fc=i),s=t.pendingLanes,s===0&&(zr=null),nP(n.stateNode),$t(t,Xe()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Lc)throw Lc=!1,t=Zf,Zf=null,t;return Fc&1&&t.tag!==0&&Ys(),s=t.pendingLanes,s&1?t===ep?La++:(La=0,ep=t):La=0,ci(),null}function Ys(){if(Fr!==null){var t=LI(Fc),e=hn.transition,n=Pe;try{if(hn.transition=null,Pe=16>t?16:t,Fr===null)var r=!1;else{if(t=Fr,Fr=null,Fc=0,Ie&6)throw Error(z(331));var i=Ie;for(Ie|=4,Y=t.current;Y!==null;){var s=Y,o=s.child;if(Y.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(Y=u;Y!==null;){var f=Y;switch(f.tag){case 0:case 11:case 15:Va(8,f,s)}var p=f.child;if(p!==null)p.return=f,Y=p;else for(;Y!==null;){f=Y;var m=f.sibling,v=f.return;if(Ww(f),f===u){Y=null;break}if(m!==null){m.return=v,Y=m;break}Y=v}}}var I=s.alternate;if(I!==null){var x=I.child;if(x!==null){I.child=null;do{var M=x.sibling;x.sibling=null,x=M}while(x!==null)}}Y=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,Y=o;else e:for(;Y!==null;){if(s=Y,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Va(9,s,s.return)}var A=s.sibling;if(A!==null){A.return=s.return,Y=A;break e}Y=s.return}}var T=t.current;for(Y=T;Y!==null;){o=Y;var S=o.child;if(o.subtreeFlags&2064&&S!==null)S.return=o,Y=S;else e:for(o=T;Y!==null;){if(a=Y,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:wd(9,a)}}catch(U){Ye(a,a.return,U)}if(a===o){Y=null;break e}var V=a.sibling;if(V!==null){V.return=a.return,Y=V;break e}Y=a.return}}if(Ie=i,ci(),Gn&&typeof Gn.onPostCommitFiberRoot=="function")try{Gn.onPostCommitFiberRoot(md,t)}catch{}r=!0}return r}finally{Pe=n,hn.transition=e}}return!1}function Dy(t,e,n){e=ho(n,e),e=Lw(t,e,1),t=$r(t,e,1),e=Vt(),t!==null&&(Al(t,1,e),$t(t,e))}function Ye(t,e,n){if(t.tag===3)Dy(t,t,n);else for(;e!==null;){if(e.tag===3){Dy(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(zr===null||!zr.has(r))){t=ho(n,t),t=Fw(e,t,1),e=$r(e,t,1),t=Vt(),e!==null&&(Al(e,1,t),$t(e,t));break}}e=e.return}}function xx(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Vt(),t.pingedLanes|=t.suspendedLanes&n,gt===t&&(It&n)===n&&(lt===4||lt===3&&(It&130023424)===It&&500>Xe()-km?Oi(t,0):xm|=n),$t(t,e)}function rS(t,e){e===0&&(t.mode&1?(e=vu,vu<<=1,!(vu&130023424)&&(vu=4194304)):e=1);var n=Vt();t=ar(t,e),t!==null&&(Al(t,e,n),$t(t,n))}function kx(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),rS(t,n)}function Nx(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(z(314))}r!==null&&r.delete(e),rS(t,n)}var iS;iS=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Gt.current)Bt=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Bt=!1,yx(t,e,n);Bt=!!(t.flags&131072)}else Bt=!1,$e&&e.flags&1048576&&lw(e,Pc,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Ju(t,e),t=e.pendingProps;var i=ao(e,Nt.current);Qs(e,n),i=wm(null,e,r,t,i,n);var s=Sm();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,qt(r)?(s=!0,Ac(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,ym(e),i.updater=Id,e.stateNode=i,i._reactInternals=e,qf(e,r,t,n),e=Hf(null,e,r,!0,s,n)):(e.tag=0,$e&&s&&dm(e),Dt(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Ju(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=Mx(r),t=vn(r,t),i){case 0:e=zf(null,e,r,t,n);break e;case 1:e=Iy(null,e,r,t,n);break e;case 11:e=Ty(null,e,r,t,n);break e;case 14:e=Ey(null,e,r,vn(r.type,t),n);break e}throw Error(z(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:vn(r,i),zf(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:vn(r,i),Iy(t,e,r,i,n);case 3:e:{if(Gw(e),t===null)throw Error(z(387));r=e.pendingProps,s=e.memoizedState,i=s.element,pw(t,e),Nc(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=ho(Error(z(423)),e),e=wy(t,e,r,n,i);break e}else if(r!==i){i=ho(Error(z(424)),e),e=wy(t,e,r,n,i);break e}else for(Qt=qr(e.stateNode.containerInfo.firstChild),Xt=e,$e=!0,In=null,n=hw(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(lo(),r===i){e=lr(t,e,n);break e}Dt(t,e,r,n)}e=e.child}return e;case 5:return mw(e),t===null&&Of(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,Vf(r,i)?o=null:s!==null&&Vf(r,s)&&(e.flags|=32),Bw(t,e),Dt(t,e,o,n),e.child;case 6:return t===null&&Of(e),null;case 13:return qw(t,e,n);case 4:return vm(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=uo(e,null,r,n):Dt(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:vn(r,i),Ty(t,e,r,i,n);case 7:return Dt(t,e,e.pendingProps,n),e.child;case 8:return Dt(t,e,e.pendingProps.children,n),e.child;case 12:return Dt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,Le(xc,r._currentValue),r._currentValue=o,s!==null)if(Nn(s.value,o)){if(s.children===i.children&&!Gt.current){e=lr(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=rr(-1,n&-n),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var f=u.pending;f===null?l.next=l:(l.next=f.next,f.next=l),u.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),Bf(s.return,n,e),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(z(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),Bf(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Dt(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Qs(e,n),i=mn(i),r=r(i),e.flags|=1,Dt(t,e,r,n),e.child;case 14:return r=e.type,i=vn(r,e.pendingProps),i=vn(r.type,i),Ey(t,e,r,i,n);case 15:return Uw(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:vn(r,i),Ju(t,e),e.tag=1,qt(r)?(t=!0,Ac(e)):t=!1,Qs(e,n),bw(e,r,i),qf(e,r,i,n),Hf(null,e,r,!0,t,n);case 19:return $w(t,e,n);case 22:return Ow(t,e,n)}throw Error(z(156,e.tag))};function sS(t,e){return DI(t,e)}function Dx(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function un(t,e,n,r){return new Dx(t,e,n,r)}function Vm(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Mx(t){if(typeof t=="function")return Vm(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Zp)return 11;if(t===em)return 14}return 2}function Kr(t,e){var n=t.alternate;return n===null?(n=un(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function ju(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")Vm(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Ds:return Bi(n.children,i,s,e);case Xp:o=8,i|=8;break;case hf:return t=un(12,n,e,i|2),t.elementType=hf,t.lanes=s,t;case ff:return t=un(13,n,e,i),t.elementType=ff,t.lanes=s,t;case pf:return t=un(19,n,e,i),t.elementType=pf,t.lanes=s,t;case mI:return Cd(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case fI:o=10;break e;case pI:o=9;break e;case Zp:o=11;break e;case em:o=14;break e;case Pr:o=16,r=null;break e}throw Error(z(130,t==null?t:typeof t,""))}return e=un(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function Bi(t,e,n,r){return t=un(7,t,r,e),t.lanes=n,t}function Cd(t,e,n,r){return t=un(22,t,r,e),t.elementType=mI,t.lanes=n,t.stateNode={isHidden:!1},t}function Kh(t,e,n){return t=un(6,t,null,e),t.lanes=n,t}function Wh(t,e,n){return e=un(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Vx(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Rh(0),this.expirationTimes=Rh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Rh(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function bm(t,e,n,r,i,s,o,a,l){return t=new Vx(t,e,n,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=un(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},ym(s),t}function bx(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ns,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function oS(t){if(!t)return ei;t=t._reactInternals;e:{if(as(t)!==t||t.tag!==1)throw Error(z(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(qt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(z(171))}if(t.tag===1){var n=t.type;if(qt(n))return ow(t,n,e)}return e}function aS(t,e,n,r,i,s,o,a,l){return t=bm(n,r,!0,t,i,s,o,a,l),t.context=oS(null),n=t.current,r=Vt(),i=Hr(n),s=rr(r,i),s.callback=e??null,$r(n,s,i),t.current.lanes=i,Al(t,i,r),$t(t,r),t}function Ad(t,e,n,r){var i=e.current,s=Vt(),o=Hr(i);return n=oS(n),e.context===null?e.context=n:e.pendingContext=n,e=rr(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=$r(i,e,o),t!==null&&(Rn(t,i,o,s),Hu(t,i,o)),o}function Oc(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function My(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Lm(t,e){My(t,e),(t=t.alternate)&&My(t,e)}function Lx(){return null}var lS=typeof reportError=="function"?reportError:function(t){console.error(t)};function Fm(t){this._internalRoot=t}Rd.prototype.render=Fm.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(z(409));Ad(t,e,null,null)};Rd.prototype.unmount=Fm.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Qi(function(){Ad(null,t,null,null)}),e[or]=null}};function Rd(t){this._internalRoot=t}Rd.prototype.unstable_scheduleHydration=function(t){if(t){var e=OI();t={blockedOn:null,target:t,priority:e};for(var n=0;n<kr.length&&e!==0&&e<kr[n].priority;n++);kr.splice(n,0,t),n===0&&GI(t)}};function Um(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Pd(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Vy(){}function Fx(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var u=Oc(o);s.call(u)}}var o=aS(e,r,t,0,null,!1,!1,"",Vy);return t._reactRootContainer=o,t[or]=o.current,rl(t.nodeType===8?t.parentNode:t),Qi(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var u=Oc(l);a.call(u)}}var l=bm(t,0,!1,null,null,!1,!1,"",Vy);return t._reactRootContainer=l,t[or]=l.current,rl(t.nodeType===8?t.parentNode:t),Qi(function(){Ad(e,l,n,r)}),l}function xd(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=Oc(o);a.call(l)}}Ad(e,o,t,i)}else o=Fx(n,e,t,i,r);return Oc(o)}FI=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Ia(e.pendingLanes);n!==0&&(rm(e,n|1),$t(e,Xe()),!(Ie&6)&&(fo=Xe()+500,ci()))}break;case 13:Qi(function(){var r=ar(t,1);if(r!==null){var i=Vt();Rn(r,t,1,i)}}),Lm(t,1)}};im=function(t){if(t.tag===13){var e=ar(t,134217728);if(e!==null){var n=Vt();Rn(e,t,134217728,n)}Lm(t,134217728)}};UI=function(t){if(t.tag===13){var e=Hr(t),n=ar(t,e);if(n!==null){var r=Vt();Rn(n,t,e,r)}Lm(t,e)}};OI=function(){return Pe};BI=function(t,e){var n=Pe;try{return Pe=t,e()}finally{Pe=n}};Sf=function(t,e,n){switch(e){case"input":if(_f(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=vd(r);if(!i)throw Error(z(90));_I(r),_f(r,i)}}}break;case"textarea":vI(t,n);break;case"select":e=n.value,e!=null&&Hs(t,!!n.multiple,e,!1)}};AI=Nm;RI=Qi;var Ux={usingClientEntryPoint:!1,Events:[Pl,Ls,vd,SI,CI,Nm]},fa={findFiberByHostInstance:Vi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Ox={bundleType:fa.bundleType,version:fa.version,rendererPackageName:fa.rendererPackageName,rendererConfig:fa.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:fr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=kI(t),t===null?null:t.stateNode},findFiberByHostInstance:fa.findFiberByHostInstance||Lx,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ku=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ku.isDisabled&&ku.supportsFiber)try{md=ku.inject(Ox),Gn=ku}catch{}}nn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ux;nn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Um(e))throw Error(z(200));return bx(t,e,null,n)};nn.createRoot=function(t,e){if(!Um(t))throw Error(z(299));var n=!1,r="",i=lS;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=bm(t,1,!1,null,null,n,!1,r,i),t[or]=e.current,rl(t.nodeType===8?t.parentNode:t),new Fm(e)};nn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(z(188)):(t=Object.keys(t).join(","),Error(z(268,t)));return t=kI(e),t=t===null?null:t.stateNode,t};nn.flushSync=function(t){return Qi(t)};nn.hydrate=function(t,e,n){if(!Pd(e))throw Error(z(200));return xd(null,t,e,!0,n)};nn.hydrateRoot=function(t,e,n){if(!Um(t))throw Error(z(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=lS;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=aS(e,null,t,1,n??null,i,!1,s,o),t[or]=e.current,rl(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new Rd(e)};nn.render=function(t,e,n){if(!Pd(e))throw Error(z(200));return xd(null,t,e,!1,n)};nn.unmountComponentAtNode=function(t){if(!Pd(t))throw Error(z(40));return t._reactRootContainer?(Qi(function(){xd(null,null,t,!1,function(){t._reactRootContainer=null,t[or]=null})}),!0):!1};nn.unstable_batchedUpdates=Nm;nn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Pd(n))throw Error(z(200));if(t==null||t._reactInternals===void 0)throw Error(z(38));return xd(t,e,n,!1,r)};nn.version="18.3.1-next-f1338f8080-20240426";function uS(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(uS)}catch(t){console.error(t)}}uS(),uI.exports=nn;var Bx=uI.exports,by=Bx;cf.createRoot=by.createRoot,cf.hydrateRoot=by.hydrateRoot;/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let Gx,qx;function $x(){return{geminiUrl:Gx,vertexUrl:qx}}function zx(t,e,n,r){var i,s;if(!(t!=null&&t.baseUrl)){const o=$x();return e?(i=o.vertexUrl)!==null&&i!==void 0?i:n:(s=o.geminiUrl)!==null&&s!==void 0?s:r}return t.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ls{}function X(t,e){const n=/\{([^}]+)\}/g;return t.replace(n,(r,i)=>{if(Object.prototype.hasOwnProperty.call(e,i)){const s=e[i];return s!=null?String(s):""}else throw new Error(`Key '${i}' not found in valueMap.`)})}function h(t,e,n){for(let s=0;s<e.length-1;s++){const o=e[s];if(o.endsWith("[]")){const a=o.slice(0,-2);if(!(a in t))if(Array.isArray(n))t[a]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${o}`);if(Array.isArray(t[a])){const l=t[a];if(Array.isArray(n))for(let u=0;u<l.length;u++){const f=l[u];h(f,e.slice(s+1),n[u])}else for(const u of l)h(u,e.slice(s+1),n)}return}else if(o.endsWith("[0]")){const a=o.slice(0,-3);a in t||(t[a]=[{}]);const l=t[a];h(l[0],e.slice(s+1),n);return}(!t[o]||typeof t[o]!="object")&&(t[o]={}),t=t[o]}const r=e[e.length-1],i=t[r];if(i!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===i)return;if(typeof i=="object"&&typeof n=="object"&&i!==null&&n!==null)Object.assign(i,n);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else r==="_self"&&typeof n=="object"&&n!==null&&!Array.isArray(n)?Object.assign(t,n):t[r]=n}function c(t,e,n=void 0){try{if(e.length===1&&e[0]==="_self")return t;for(let r=0;r<e.length;r++){if(typeof t!="object"||t===null)return n;const i=e[r];if(i.endsWith("[]")){const s=i.slice(0,-2);if(s in t){const o=t[s];return Array.isArray(o)?o.map(a=>c(a,e.slice(r+1),n)):n}else return n}else t=t[i]}return t}catch(r){if(r instanceof TypeError)return n;throw r}}function Hx(t,e){for(const[n,r]of Object.entries(e)){const i=n.split("."),s=r.split("."),o=new Set;let a=-1;for(let l=0;l<i.length;l++)if(i[l]==="*"){a=l;break}if(a!==-1&&s.length>a)for(let l=a;l<s.length;l++){const u=s[l];u!=="*"&&!u.endsWith("[]")&&!u.endsWith("[0]")&&o.add(u)}rp(t,i,s,0,o)}}function rp(t,e,n,r,i){if(r>=e.length||typeof t!="object"||t===null)return;const s=e[r];if(s.endsWith("[]")){const o=s.slice(0,-2),a=t;if(o in a&&Array.isArray(a[o]))for(const l of a[o])rp(l,e,n,r+1,i)}else if(s==="*"){if(typeof t=="object"&&t!==null&&!Array.isArray(t)){const o=t,a=Object.keys(o).filter(u=>!u.startsWith("_")&&!i.has(u)),l={};for(const u of a)l[u]=o[u];for(const[u,f]of Object.entries(l)){const p=[];for(const m of n.slice(r))m==="*"?p.push(u):p.push(m);h(o,p,f)}for(const u of a)delete o[u]}}else{const o=t;s in o&&rp(o[s],e,n,r+1,i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Om(t){if(typeof t!="string")throw new Error("fromImageBytes must be a string");return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Kx(t){const e={},n=c(t,["operationName"]);n!=null&&h(e,["operationName"],n);const r=c(t,["resourceName"]);return r!=null&&h(e,["_url","resourceName"],r),e}function Wx(t){const e={},n=c(t,["name"]);n!=null&&h(e,["name"],n);const r=c(t,["metadata"]);r!=null&&h(e,["metadata"],r);const i=c(t,["done"]);i!=null&&h(e,["done"],i);const s=c(t,["error"]);s!=null&&h(e,["error"],s);const o=c(t,["response","generateVideoResponse"]);return o!=null&&h(e,["response"],Qx(o)),e}function Jx(t){const e={},n=c(t,["name"]);n!=null&&h(e,["name"],n);const r=c(t,["metadata"]);r!=null&&h(e,["metadata"],r);const i=c(t,["done"]);i!=null&&h(e,["done"],i);const s=c(t,["error"]);s!=null&&h(e,["error"],s);const o=c(t,["response"]);return o!=null&&h(e,["response"],Yx(o)),e}function Qx(t){const e={},n=c(t,["generatedSamples"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>jx(o))),h(e,["generatedVideos"],s)}const r=c(t,["raiMediaFilteredCount"]);r!=null&&h(e,["raiMediaFilteredCount"],r);const i=c(t,["raiMediaFilteredReasons"]);return i!=null&&h(e,["raiMediaFilteredReasons"],i),e}function Yx(t){const e={},n=c(t,["videos"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>Xx(o))),h(e,["generatedVideos"],s)}const r=c(t,["raiMediaFilteredCount"]);r!=null&&h(e,["raiMediaFilteredCount"],r);const i=c(t,["raiMediaFilteredReasons"]);return i!=null&&h(e,["raiMediaFilteredReasons"],i),e}function jx(t){const e={},n=c(t,["video"]);return n!=null&&h(e,["video"],tk(n)),e}function Xx(t){const e={},n=c(t,["_self"]);return n!=null&&h(e,["video"],nk(n)),e}function Zx(t){const e={},n=c(t,["operationName"]);return n!=null&&h(e,["_url","operationName"],n),e}function ek(t){const e={},n=c(t,["operationName"]);return n!=null&&h(e,["_url","operationName"],n),e}function tk(t){const e={},n=c(t,["uri"]);n!=null&&h(e,["uri"],n);const r=c(t,["encodedVideo"]);r!=null&&h(e,["videoBytes"],Om(r));const i=c(t,["encoding"]);return i!=null&&h(e,["mimeType"],i),e}function nk(t){const e={},n=c(t,["gcsUri"]);n!=null&&h(e,["uri"],n);const r=c(t,["bytesBase64Encoded"]);r!=null&&h(e,["videoBytes"],Om(r));const i=c(t,["mimeType"]);return i!=null&&h(e,["mimeType"],i),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Ly;(function(t){t.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",t.OUTCOME_OK="OUTCOME_OK",t.OUTCOME_FAILED="OUTCOME_FAILED",t.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Ly||(Ly={}));var Fy;(function(t){t.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",t.PYTHON="PYTHON"})(Fy||(Fy={}));var Sn;(function(t){t.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",t.STRING="STRING",t.NUMBER="NUMBER",t.INTEGER="INTEGER",t.BOOLEAN="BOOLEAN",t.ARRAY="ARRAY",t.OBJECT="OBJECT",t.NULL="NULL"})(Sn||(Sn={}));var Uy;(function(t){t.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",t.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",t.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",t.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",t.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",t.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",t.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",t.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",t.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT"})(Uy||(Uy={}));var Oy;(function(t){t.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",t.SEVERITY="SEVERITY",t.PROBABILITY="PROBABILITY"})(Oy||(Oy={}));var By;(function(t){t.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE",t.OFF="OFF"})(By||(By={}));var Gy;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(Gy||(Gy={}));var qy;(function(t){t.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",t.NO_AUTH="NO_AUTH",t.API_KEY_AUTH="API_KEY_AUTH",t.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",t.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",t.OAUTH="OAUTH",t.OIDC_AUTH="OIDC_AUTH"})(qy||(qy={}));var $y;(function(t){t.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",t.SIMPLE_SEARCH="SIMPLE_SEARCH",t.ELASTIC_SEARCH="ELASTIC_SEARCH"})($y||($y={}));var zy;(function(t){t.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",t.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",t.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",t.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",t.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(zy||(zy={}));var Hy;(function(t){t.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.LANGUAGE="LANGUAGE",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.SPII="SPII",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.IMAGE_SAFETY="IMAGE_SAFETY",t.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",t.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",t.NO_IMAGE="NO_IMAGE"})(Hy||(Hy={}));var Ky;(function(t){t.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",t.NEGLIGIBLE="NEGLIGIBLE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH"})(Ky||(Ky={}));var Wy;(function(t){t.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",t.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",t.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",t.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",t.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(Wy||(Wy={}));var Jy;(function(t){t.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",t.SAFETY="SAFETY",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.IMAGE_SAFETY="IMAGE_SAFETY"})(Jy||(Jy={}));var Qy;(function(t){t.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",t.ON_DEMAND="ON_DEMAND",t.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(Qy||(Qy={}));var Bc;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.AUDIO="AUDIO"})(Bc||(Bc={}));var Yy;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(Yy||(Yy={}));var ip;(function(t){t.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",t.JOB_STATE_QUEUED="JOB_STATE_QUEUED",t.JOB_STATE_PENDING="JOB_STATE_PENDING",t.JOB_STATE_RUNNING="JOB_STATE_RUNNING",t.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",t.JOB_STATE_FAILED="JOB_STATE_FAILED",t.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",t.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",t.JOB_STATE_PAUSED="JOB_STATE_PAUSED",t.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",t.JOB_STATE_UPDATING="JOB_STATE_UPDATING",t.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(ip||(ip={}));var jy;(function(t){t.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",t.TUNING_MODE_FULL="TUNING_MODE_FULL",t.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(jy||(jy={}));var Xy;(function(t){t.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",t.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",t.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",t.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",t.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",t.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",t.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(Xy||(Xy={}));var Zy;(function(t){t.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",t.TUNING_TASK_I2V="TUNING_TASK_I2V",t.TUNING_TASK_T2V="TUNING_TASK_T2V"})(Zy||(Zy={}));var ev;(function(t){t.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",t.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",t.BALANCED="BALANCED",t.PRIORITIZE_COST="PRIORITIZE_COST"})(ev||(ev={}));var tv;(function(t){t.UNSPECIFIED="UNSPECIFIED",t.BLOCKING="BLOCKING",t.NON_BLOCKING="NON_BLOCKING"})(tv||(tv={}));var nv;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(nv||(nv={}));var rv;(function(t){t.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",t.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(rv||(rv={}));var iv;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.AUTO="AUTO",t.ANY="ANY",t.NONE="NONE",t.VALIDATED="VALIDATED"})(iv||(iv={}));var sv;(function(t){t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE"})(sv||(sv={}));var ov;(function(t){t.DONT_ALLOW="DONT_ALLOW",t.ALLOW_ADULT="ALLOW_ADULT",t.ALLOW_ALL="ALLOW_ALL"})(ov||(ov={}));var av;(function(t){t.auto="auto",t.en="en",t.ja="ja",t.ko="ko",t.hi="hi",t.zh="zh",t.pt="pt",t.es="es"})(av||(av={}));var lv;(function(t){t.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",t.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",t.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",t.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",t.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(lv||(lv={}));var uv;(function(t){t.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",t.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",t.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",t.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(uv||(uv={}));var cv;(function(t){t.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",t.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",t.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",t.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(cv||(cv={}));var dv;(function(t){t.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",t.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",t.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",t.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",t.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",t.EDIT_MODE_STYLE="EDIT_MODE_STYLE",t.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",t.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(dv||(dv={}));var hv;(function(t){t.FOREGROUND="FOREGROUND",t.BACKGROUND="BACKGROUND",t.PROMPT="PROMPT",t.SEMANTIC="SEMANTIC",t.INTERACTIVE="INTERACTIVE"})(hv||(hv={}));var fv;(function(t){t.ASSET="ASSET",t.STYLE="STYLE"})(fv||(fv={}));var pv;(function(t){t.INSERT="INSERT",t.REMOVE="REMOVE",t.REMOVE_STATIC="REMOVE_STATIC",t.OUTPAINT="OUTPAINT"})(pv||(pv={}));var mv;(function(t){t.OPTIMIZED="OPTIMIZED",t.LOSSLESS="LOSSLESS"})(mv||(mv={}));var gv;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.PROCESSING="PROCESSING",t.ACTIVE="ACTIVE",t.FAILED="FAILED"})(gv||(gv={}));var _v;(function(t){t.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",t.UPLOADED="UPLOADED",t.GENERATED="GENERATED"})(_v||(_v={}));var yv;(function(t){t.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.RESPONSE_REJECTED="RESPONSE_REJECTED",t.NEED_MORE_INPUT="NEED_MORE_INPUT"})(yv||(yv={}));var vv;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.VIDEO="VIDEO",t.AUDIO="AUDIO",t.DOCUMENT="DOCUMENT"})(vv||(vv={}));var Tv;(function(t){t.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",t.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",t.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(Tv||(Tv={}));var Ev;(function(t){t.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",t.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",t.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(Ev||(Ev={}));var Iv;(function(t){t.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",t.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",t.NO_INTERRUPTION="NO_INTERRUPTION"})(Iv||(Iv={}));var wv;(function(t){t.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",t.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",t.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(wv||(wv={}));var Sv;(function(t){t.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",t.SILENT="SILENT",t.WHEN_IDLE="WHEN_IDLE",t.INTERRUPT="INTERRUPT"})(Sv||(Sv={}));var Cv;(function(t){t.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",t.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",t.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",t.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",t.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",t.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",t.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",t.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",t.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",t.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",t.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",t.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",t.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(Cv||(Cv={}));var Av;(function(t){t.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",t.QUALITY="QUALITY",t.DIVERSITY="DIVERSITY",t.VOCALIZATION="VOCALIZATION"})(Av||(Av={}));var $s;(function(t){t.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",t.PLAY="PLAY",t.PAUSE="PAUSE",t.STOP="STOP",t.RESET_CONTEXT="RESET_CONTEXT"})($s||($s={}));class sp{constructor(e){const n={};for(const r of e.headers.entries())n[r[0]]=r[1];this.headers=n,this.responseInternal=e}json(){return this.responseInternal.json()}}class pa{get text(){var e,n,r,i,s,o,a,l;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let u="",f=!1;const p=[];for(const m of(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)!==null&&l!==void 0?l:[]){for(const[v,I]of Object.entries(m))v!=="text"&&v!=="thought"&&(I!==null||I!==void 0)&&p.push(v);if(typeof m.text=="string"){if(typeof m.thought=="boolean"&&m.thought)continue;f=!0,u+=m.text}}return p.length>0&&console.warn(`there are non-text parts ${p} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),f?u:void 0}get data(){var e,n,r,i,s,o,a,l;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let u="";const f=[];for(const p of(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)!==null&&l!==void 0?l:[]){for(const[m,v]of Object.entries(p))m!=="inlineData"&&(v!==null||v!==void 0)&&f.push(m);p.inlineData&&typeof p.inlineData.data=="string"&&(u+=atob(p.inlineData.data))}return f.length>0&&console.warn(`there are non-data parts ${f} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),u.length>0?btoa(u):void 0}get functionCalls(){var e,n,r,i,s,o,a,l;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const u=(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(f=>f.functionCall).map(f=>f.functionCall).filter(f=>f!==void 0);if((u==null?void 0:u.length)!==0)return u}get executableCode(){var e,n,r,i,s,o,a,l,u;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const f=(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(p=>p.executableCode).map(p=>p.executableCode).filter(p=>p!==void 0);if((f==null?void 0:f.length)!==0)return(u=f==null?void 0:f[0])===null||u===void 0?void 0:u.code}get codeExecutionResult(){var e,n,r,i,s,o,a,l,u;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const f=(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(p=>p.codeExecutionResult).map(p=>p.codeExecutionResult).filter(p=>p!==void 0);if((f==null?void 0:f.length)!==0)return(u=f==null?void 0:f[0])===null||u===void 0?void 0:u.output}}class Rv{}class Pv{}class rk{}class ik{}class sk{}class ok{}class xv{}class kv{}class Nv{}class ak{}class Gc{_fromAPIResponse({apiResponse:e,isVertexAI:n}){const r=new Gc;let i;const s=e;return n?i=Jx(s):i=Wx(s),Object.assign(r,i),r}}class Dv{}class Mv{}class Vv{}class lk{}class uk{}class ck{}class bv{}class dk{get text(){var e,n,r;let i="",s=!1;const o=[];for(const a of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[l,u]of Object.entries(a))l!=="text"&&l!=="thought"&&u!==null&&o.push(l);if(typeof a.text=="string"){if(typeof a.thought=="boolean"&&a.thought)continue;s=!0,i+=a.text}}return o.length>0&&console.warn(`there are non-text parts ${o} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),s?i:void 0}get data(){var e,n,r;let i="";const s=[];for(const o of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[a,l]of Object.entries(o))a!=="inlineData"&&l!==null&&s.push(a);o.inlineData&&typeof o.inlineData.data=="string"&&(i+=atob(o.inlineData.data))}return s.length>0&&console.warn(`there are non-data parts ${s} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),i.length>0?btoa(i):void 0}}class hk{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function we(t,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(t.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const n=e.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function cS(t,e){const n=we(t,e);return n?n.startsWith("publishers/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}`:n.startsWith("models/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/publishers/google/${n}`:n:""}function dS(t){return Array.isArray(t)?t.map(e=>qc(e)):[qc(t)]}function qc(t){if(typeof t=="object"&&t!==null)return t;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof t}`)}function hS(t){const e=qc(t);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function fS(t){const e=qc(t);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function Lv(t){if(t==null)throw new Error("PartUnion is required");if(typeof t=="object")return t;if(typeof t=="string")return{text:t};throw new Error(`Unsupported part type: ${typeof t}`)}function pS(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("PartListUnion is required");return Array.isArray(t)?t.map(e=>Lv(e)):[Lv(t)]}function op(t){return t!=null&&typeof t=="object"&&"parts"in t&&Array.isArray(t.parts)}function Fv(t){return t!=null&&typeof t=="object"&&"functionCall"in t}function Uv(t){return t!=null&&typeof t=="object"&&"functionResponse"in t}function xt(t){if(t==null)throw new Error("ContentUnion is required");return op(t)?t:{role:"user",parts:pS(t)}}function Bm(t,e){if(!e)return[];if(t.isVertexAI()&&Array.isArray(e))return e.flatMap(n=>{const r=xt(n);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(t.isVertexAI()){const n=xt(e);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(e)?e.map(n=>xt(n)):[xt(e)]}function fn(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("contents are required");if(!Array.isArray(t)){if(Fv(t)||Uv(t))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[xt(t)]}const e=[],n=[],r=op(t[0]);for(const i of t){const s=op(i);if(s!=r)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(s)e.push(i);else{if(Fv(i)||Uv(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(i)}}return r||e.push({role:"user",parts:pS(n)}),e}function fk(t,e){t.includes("null")&&(e.nullable=!0);const n=t.filter(r=>r!=="null");if(n.length===1)e.type=Object.values(Sn).includes(n[0].toUpperCase())?n[0].toUpperCase():Sn.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const r of n)e.anyOf.push({type:Object.values(Sn).includes(r.toUpperCase())?r.toUpperCase():Sn.TYPE_UNSPECIFIED})}}function js(t){const e={},n=["items"],r=["anyOf"],i=["properties"];if(t.type&&t.anyOf)throw new Error("type and anyOf cannot be both populated.");const s=t.anyOf;s!=null&&s.length==2&&(s[0].type==="null"?(e.nullable=!0,t=s[1]):s[1].type==="null"&&(e.nullable=!0,t=s[0])),t.type instanceof Array&&fk(t.type,e);for(const[o,a]of Object.entries(t))if(a!=null)if(o=="type"){if(a==="null")throw new Error("type: null can not be the only possible type for the field.");if(a instanceof Array)continue;e.type=Object.values(Sn).includes(a.toUpperCase())?a.toUpperCase():Sn.TYPE_UNSPECIFIED}else if(n.includes(o))e[o]=js(a);else if(r.includes(o)){const l=[];for(const u of a){if(u.type=="null"){e.nullable=!0;continue}l.push(js(u))}e[o]=l}else if(i.includes(o)){const l={};for(const[u,f]of Object.entries(a))l[u]=js(f);e[o]=l}else{if(o==="additionalProperties")continue;e[o]=a}return e}function Gm(t){return js(t)}function qm(t){if(typeof t=="object")return t;if(typeof t=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:t}}};throw new Error(`Unsupported speechConfig type: ${typeof t}`)}function $m(t){if("multiSpeakerVoiceConfig"in t)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return t}function Vo(t){if(t.functionDeclarations)for(const e of t.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=js(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=js(e.response));return t}function bo(t){if(t==null)throw new Error("tools is required");if(!Array.isArray(t))throw new Error("tools is required and must be an array of Tools");const e=[];for(const n of t)e.push(n);return e}function pk(t,e,n,r=1){const i=!e.startsWith(`${n}/`)&&e.split("/").length===r;return t.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${t.getProject()}/${e}`:e.startsWith(`${n}/`)?`projects/${t.getProject()}/locations/${t.getLocation()}/${e}`:i?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}/${e}`:e:i?`${n}/${e}`:e}function pr(t,e){if(typeof e!="string")throw new Error("name must be a string");return pk(t,e,"cachedContents")}function mS(t){switch(t){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return t}}function di(t){return Om(t)}function mk(t){return t!=null&&typeof t=="object"&&"name"in t}function gk(t){return t!=null&&typeof t=="object"&&"video"in t}function _k(t){return t!=null&&typeof t=="object"&&"uri"in t}function gS(t){var e;let n;if(mk(t)&&(n=t.name),!(_k(t)&&(n=t.uri,n===void 0))&&!(gk(t)&&(n=(e=t.video)===null||e===void 0?void 0:e.uri,n===void 0))){if(typeof t=="string"&&(n=t),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const i=n.split("files/")[1].match(/[a-z0-9]+/);if(i===null)throw new Error(`Could not extract file name from URI ${n}`);n=i[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function _S(t,e){let n;return t.isVertexAI()?n=e?"publishers/google/models":"models":n=e?"models":"tunedModels",n}function yS(t){for(const e of["models","tunedModels","publisherModels"])if(yk(t,e))return t[e];return[]}function yk(t,e){return t!==null&&typeof t=="object"&&e in t}function vk(t,e={}){const n=t,r={name:n.name,description:n.description,parametersJsonSchema:n.inputSchema};return n.outputSchema&&(r.responseJsonSchema=n.outputSchema),e.behavior&&(r.behavior=e.behavior),{functionDeclarations:[r]}}function Tk(t,e={}){const n=[],r=new Set;for(const i of t){const s=i.name;if(r.has(s))throw new Error(`Duplicate function name ${s} found in MCP tools. Please ensure function names are unique.`);r.add(s);const o=vk(i,e);o.functionDeclarations&&n.push(...o.functionDeclarations)}return{functionDeclarations:n}}function vS(t,e){let n;if(typeof e=="string")if(t.isVertexAI())if(e.startsWith("gs://"))n={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))n={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))n={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(t.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");n={inlinedRequests:e}}else n=e;const r=[n.gcsUri,n.bigqueryUri].filter(Boolean).length,i=[n.inlinedRequests,n.fileName].filter(Boolean).length;if(t.isVertexAI()){if(i>0||r!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(r>0||i!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return n}function Ek(t){if(typeof t!="string")return t;const e=t;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function TS(t){if(typeof t!="object"||t===null)return{};const e=t,n=e.inlinedResponses;if(typeof n!="object"||n===null)return t;const i=n.inlinedResponses;if(!Array.isArray(i)||i.length===0)return t;let s=!1;for(const o of i){if(typeof o!="object"||o===null)continue;const l=o.response;if(typeof l!="object"||l===null)continue;if(l.embedding!==void 0){s=!0;break}}return s&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),t}function Lo(t,e){const n=e;if(!t.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error(`Invalid batch job name: ${n}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error(`Invalid batch job name: ${n}.`)}function ES(t){const e=t;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ik(t){const e={},n=c(t,["responsesFile"]);n!=null&&h(e,["fileName"],n);const r=c(t,["inlinedResponses","inlinedResponses"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>Zk(o))),h(e,["inlinedResponses"],s)}const i=c(t,["inlinedEmbedContentResponses","inlinedResponses"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),h(e,["inlinedEmbedContentResponses"],s)}return e}function wk(t){const e={},n=c(t,["predictionsFormat"]);n!=null&&h(e,["format"],n);const r=c(t,["gcsDestination","outputUriPrefix"]);r!=null&&h(e,["gcsUri"],r);const i=c(t,["bigqueryDestination","outputUri"]);return i!=null&&h(e,["bigqueryUri"],i),e}function Sk(t){const e={},n=c(t,["format"]);n!=null&&h(e,["predictionsFormat"],n);const r=c(t,["gcsUri"]);r!=null&&h(e,["gcsDestination","outputUriPrefix"],r);const i=c(t,["bigqueryUri"]);if(i!=null&&h(e,["bigqueryDestination","outputUri"],i),c(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(c(t,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(c(t,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function Xu(t){const e={},n=c(t,["name"]);n!=null&&h(e,["name"],n);const r=c(t,["metadata","displayName"]);r!=null&&h(e,["displayName"],r);const i=c(t,["metadata","state"]);i!=null&&h(e,["state"],ES(i));const s=c(t,["metadata","createTime"]);s!=null&&h(e,["createTime"],s);const o=c(t,["metadata","endTime"]);o!=null&&h(e,["endTime"],o);const a=c(t,["metadata","updateTime"]);a!=null&&h(e,["updateTime"],a);const l=c(t,["metadata","model"]);l!=null&&h(e,["model"],l);const u=c(t,["metadata","output"]);return u!=null&&h(e,["dest"],Ik(TS(u))),e}function ap(t){const e={},n=c(t,["name"]);n!=null&&h(e,["name"],n);const r=c(t,["displayName"]);r!=null&&h(e,["displayName"],r);const i=c(t,["state"]);i!=null&&h(e,["state"],ES(i));const s=c(t,["error"]);s!=null&&h(e,["error"],s);const o=c(t,["createTime"]);o!=null&&h(e,["createTime"],o);const a=c(t,["startTime"]);a!=null&&h(e,["startTime"],a);const l=c(t,["endTime"]);l!=null&&h(e,["endTime"],l);const u=c(t,["updateTime"]);u!=null&&h(e,["updateTime"],u);const f=c(t,["model"]);f!=null&&h(e,["model"],f);const p=c(t,["inputConfig"]);p!=null&&h(e,["src"],Ck(p));const m=c(t,["outputConfig"]);return m!=null&&h(e,["dest"],wk(TS(m))),e}function Ck(t){const e={},n=c(t,["instancesFormat"]);n!=null&&h(e,["format"],n);const r=c(t,["gcsSource","uris"]);r!=null&&h(e,["gcsUri"],r);const i=c(t,["bigquerySource","inputUri"]);return i!=null&&h(e,["bigqueryUri"],i),e}function Ak(t,e){const n={};if(c(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(c(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(c(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const r=c(e,["fileName"]);r!=null&&h(n,["fileName"],r);const i=c(e,["inlinedRequests"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>Xk(t,o))),h(n,["requests","requests"],s)}return n}function Rk(t){const e={},n=c(t,["format"]);n!=null&&h(e,["instancesFormat"],n);const r=c(t,["gcsUri"]);r!=null&&h(e,["gcsSource","uris"],r);const i=c(t,["bigqueryUri"]);if(i!=null&&h(e,["bigquerySource","inputUri"],i),c(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(c(t,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function Pk(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["data"]);n!=null&&h(e,["data"],n);const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function xk(t,e){const n={},r=c(e,["name"]);return r!=null&&h(n,["_url","name"],Lo(t,r)),n}function kk(t,e){const n={},r=c(e,["name"]);return r!=null&&h(n,["_url","name"],Lo(t,r)),n}function Nk(t){const e={},n=c(t,["content"]);n!=null&&h(e,["content"],n);const r=c(t,["citationMetadata"]);r!=null&&h(e,["citationMetadata"],Dk(r));const i=c(t,["tokenCount"]);i!=null&&h(e,["tokenCount"],i);const s=c(t,["finishReason"]);s!=null&&h(e,["finishReason"],s);const o=c(t,["urlContextMetadata"]);o!=null&&h(e,["urlContextMetadata"],o);const a=c(t,["avgLogprobs"]);a!=null&&h(e,["avgLogprobs"],a);const l=c(t,["groundingMetadata"]);l!=null&&h(e,["groundingMetadata"],l);const u=c(t,["index"]);u!=null&&h(e,["index"],u);const f=c(t,["logprobsResult"]);f!=null&&h(e,["logprobsResult"],f);const p=c(t,["safetyRatings"]);if(p!=null){let m=p;Array.isArray(m)&&(m=m.map(v=>v)),h(e,["safetyRatings"],m)}return e}function Dk(t){const e={},n=c(t,["citationSources"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>i)),h(e,["citations"],r)}return e}function IS(t){const e={},n=c(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>o1(s))),h(e,["parts"],i)}const r=c(t,["role"]);return r!=null&&h(e,["role"],r),e}function Mk(t,e){const n={},r=c(t,["displayName"]);if(e!==void 0&&r!=null&&h(e,["batch","displayName"],r),c(t,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return n}function Vk(t,e){const n={},r=c(t,["displayName"]);e!==void 0&&r!=null&&h(e,["displayName"],r);const i=c(t,["dest"]);return e!==void 0&&i!=null&&h(e,["outputConfig"],Sk(Ek(i))),n}function Ov(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],we(t,r));const i=c(e,["src"]);i!=null&&h(n,["batch","inputConfig"],Ak(t,vS(t,i)));const s=c(e,["config"]);return s!=null&&Mk(s,n),n}function bk(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["model"],we(t,r));const i=c(e,["src"]);i!=null&&h(n,["inputConfig"],Rk(vS(t,i)));const s=c(e,["config"]);return s!=null&&Vk(s,n),n}function Lk(t,e){const n={},r=c(t,["displayName"]);return e!==void 0&&r!=null&&h(e,["batch","displayName"],r),n}function Fk(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],we(t,r));const i=c(e,["src"]);i!=null&&h(n,["batch","inputConfig"],zk(t,i));const s=c(e,["config"]);return s!=null&&Lk(s,n),n}function Uk(t,e){const n={},r=c(e,["name"]);return r!=null&&h(n,["_url","name"],Lo(t,r)),n}function Ok(t,e){const n={},r=c(e,["name"]);return r!=null&&h(n,["_url","name"],Lo(t,r)),n}function Bk(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["name"]);r!=null&&h(e,["name"],r);const i=c(t,["done"]);i!=null&&h(e,["done"],i);const s=c(t,["error"]);return s!=null&&h(e,["error"],s),e}function Gk(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["name"]);r!=null&&h(e,["name"],r);const i=c(t,["done"]);i!=null&&h(e,["done"],i);const s=c(t,["error"]);return s!=null&&h(e,["error"],s),e}function qk(t,e){const n={},r=c(e,["contents"]);if(r!=null){let s=Bm(t,r);Array.isArray(s)&&(s=s.map(o=>o)),h(n,["requests[]","request","content"],s)}const i=c(e,["config"]);return i!=null&&(h(n,["_self"],$k(i,n)),Hx(n,{"requests[].*":"requests[].request.*"})),n}function $k(t,e){const n={},r=c(t,["taskType"]);e!==void 0&&r!=null&&h(e,["requests[]","taskType"],r);const i=c(t,["title"]);e!==void 0&&i!=null&&h(e,["requests[]","title"],i);const s=c(t,["outputDimensionality"]);if(e!==void 0&&s!=null&&h(e,["requests[]","outputDimensionality"],s),c(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(c(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function zk(t,e){const n={},r=c(e,["fileName"]);r!=null&&h(n,["file_name"],r);const i=c(e,["inlinedRequests"]);return i!=null&&h(n,["requests"],qk(t,i)),n}function Hk(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["fileUri"]);n!=null&&h(e,["fileUri"],n);const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function Kk(t,e,n){const r={},i=c(e,["systemInstruction"]);n!==void 0&&i!=null&&h(n,["systemInstruction"],IS(xt(i)));const s=c(e,["temperature"]);s!=null&&h(r,["temperature"],s);const o=c(e,["topP"]);o!=null&&h(r,["topP"],o);const a=c(e,["topK"]);a!=null&&h(r,["topK"],a);const l=c(e,["candidateCount"]);l!=null&&h(r,["candidateCount"],l);const u=c(e,["maxOutputTokens"]);u!=null&&h(r,["maxOutputTokens"],u);const f=c(e,["stopSequences"]);f!=null&&h(r,["stopSequences"],f);const p=c(e,["responseLogprobs"]);p!=null&&h(r,["responseLogprobs"],p);const m=c(e,["logprobs"]);m!=null&&h(r,["logprobs"],m);const v=c(e,["presencePenalty"]);v!=null&&h(r,["presencePenalty"],v);const I=c(e,["frequencyPenalty"]);I!=null&&h(r,["frequencyPenalty"],I);const x=c(e,["seed"]);x!=null&&h(r,["seed"],x);const M=c(e,["responseMimeType"]);M!=null&&h(r,["responseMimeType"],M);const A=c(e,["responseSchema"]);A!=null&&h(r,["responseSchema"],Gm(A));const T=c(e,["responseJsonSchema"]);if(T!=null&&h(r,["responseJsonSchema"],T),c(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(c(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const S=c(e,["safetySettings"]);if(n!==void 0&&S!=null){let D=S;Array.isArray(D)&&(D=D.map(k=>a1(k))),h(n,["safetySettings"],D)}const V=c(e,["tools"]);if(n!==void 0&&V!=null){let D=bo(V);Array.isArray(D)&&(D=D.map(k=>l1(Vo(k)))),h(n,["tools"],D)}const U=c(e,["toolConfig"]);if(n!==void 0&&U!=null&&h(n,["toolConfig"],U),c(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const F=c(e,["cachedContent"]);n!==void 0&&F!=null&&h(n,["cachedContent"],pr(t,F));const C=c(e,["responseModalities"]);C!=null&&h(r,["responseModalities"],C);const E=c(e,["mediaResolution"]);E!=null&&h(r,["mediaResolution"],E);const R=c(e,["speechConfig"]);if(R!=null&&h(r,["speechConfig"],qm(R)),c(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const P=c(e,["thinkingConfig"]);P!=null&&h(r,["thinkingConfig"],P);const N=c(e,["imageConfig"]);return N!=null&&h(r,["imageConfig"],N),r}function Wk(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["candidates"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(u=>Nk(u))),h(e,["candidates"],l)}const i=c(t,["modelVersion"]);i!=null&&h(e,["modelVersion"],i);const s=c(t,["promptFeedback"]);s!=null&&h(e,["promptFeedback"],s);const o=c(t,["responseId"]);o!=null&&h(e,["responseId"],o);const a=c(t,["usageMetadata"]);return a!=null&&h(e,["usageMetadata"],a),e}function Jk(t,e){const n={},r=c(e,["name"]);return r!=null&&h(n,["_url","name"],Lo(t,r)),n}function Qk(t,e){const n={},r=c(e,["name"]);return r!=null&&h(n,["_url","name"],Lo(t,r)),n}function Yk(t){const e={};if(c(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=c(t,["enableWidget"]);return n!=null&&h(e,["enableWidget"],n),e}function jk(t){const e={},n=c(t,["timeRangeFilter"]);if(n!=null&&h(e,["timeRangeFilter"],n),c(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function Xk(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["request","model"],we(t,r));const i=c(e,["contents"]);if(i!=null){let a=fn(i);Array.isArray(a)&&(a=a.map(l=>IS(l))),h(n,["request","contents"],a)}const s=c(e,["metadata"]);s!=null&&h(n,["metadata"],s);const o=c(e,["config"]);return o!=null&&h(n,["request","generationConfig"],Kk(t,o,c(n,["request"],{}))),n}function Zk(t){const e={},n=c(t,["response"]);n!=null&&h(e,["response"],Wk(n));const r=c(t,["error"]);return r!=null&&h(e,["error"],r),e}function e1(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&h(e,["_query","pageSize"],r);const i=c(t,["pageToken"]);if(e!==void 0&&i!=null&&h(e,["_query","pageToken"],i),c(t,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return n}function t1(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&h(e,["_query","pageSize"],r);const i=c(t,["pageToken"]);e!==void 0&&i!=null&&h(e,["_query","pageToken"],i);const s=c(t,["filter"]);return e!==void 0&&s!=null&&h(e,["_query","filter"],s),n}function n1(t){const e={},n=c(t,["config"]);return n!=null&&e1(n,e),e}function r1(t){const e={},n=c(t,["config"]);return n!=null&&t1(n,e),e}function i1(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=c(t,["operations"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>Xu(o))),h(e,["batchJobs"],s)}return e}function s1(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=c(t,["batchPredictionJobs"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>ap(o))),h(e,["batchJobs"],s)}return e}function o1(t){const e={},n=c(t,["videoMetadata"]);n!=null&&h(e,["videoMetadata"],n);const r=c(t,["thought"]);r!=null&&h(e,["thought"],r);const i=c(t,["inlineData"]);i!=null&&h(e,["inlineData"],Pk(i));const s=c(t,["fileData"]);s!=null&&h(e,["fileData"],Hk(s));const o=c(t,["thoughtSignature"]);o!=null&&h(e,["thoughtSignature"],o);const a=c(t,["functionCall"]);a!=null&&h(e,["functionCall"],a);const l=c(t,["codeExecutionResult"]);l!=null&&h(e,["codeExecutionResult"],l);const u=c(t,["executableCode"]);u!=null&&h(e,["executableCode"],u);const f=c(t,["functionResponse"]);f!=null&&h(e,["functionResponse"],f);const p=c(t,["text"]);return p!=null&&h(e,["text"],p),e}function a1(t){const e={};if(c(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=c(t,["category"]);n!=null&&h(e,["category"],n);const r=c(t,["threshold"]);return r!=null&&h(e,["threshold"],r),e}function l1(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(f=>f)),h(e,["functionDeclarations"],u)}if(c(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=c(t,["googleSearch"]);r!=null&&h(e,["googleSearch"],jk(r));const i=c(t,["googleSearchRetrieval"]);if(i!=null&&h(e,["googleSearchRetrieval"],i),c(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=c(t,["googleMaps"]);s!=null&&h(e,["googleMaps"],Yk(s));const o=c(t,["urlContext"]);o!=null&&h(e,["urlContext"],o);const a=c(t,["computerUse"]);a!=null&&h(e,["computerUse"],a);const l=c(t,["codeExecution"]);return l!=null&&h(e,["codeExecution"],l),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Yi;(function(t){t.PAGED_ITEM_BATCH_JOBS="batchJobs",t.PAGED_ITEM_MODELS="models",t.PAGED_ITEM_TUNING_JOBS="tuningJobs",t.PAGED_ITEM_FILES="files",t.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(Yi||(Yi={}));class kl{constructor(e,n,r,i){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(e,r,i)}init(e,n,r){var i,s;this.nameInternal=e,this.pageInternal=n[this.nameInternal]||[],this.sdkHttpResponseInternal=n==null?void 0:n.sdkHttpResponse,this.idxInternal=0;let o={config:{}};!r||Object.keys(r).length===0?o={config:{}}:typeof r=="object"?o=Object.assign({},r):o=r,o.config&&(o.config.pageToken=n.nextPageToken),this.paramsInternal=o,this.pageInternalSize=(s=(i=o.config)===null||i===void 0?void 0:i.pageSize)!==null&&s!==void 0?s:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class u1 extends ls{constructor(e){super(),this.apiClient=e,this.create=async n=>(this.apiClient.isVertexAI()&&(n.config=this.formatDestination(n.src,n.config)),this.createInternal(n)),this.createEmbeddings=async n=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(n)},this.list=async(n={})=>new kl(Yi.PAGED_ITEM_BATCH_JOBS,r=>this.listInternal(r),await this.listInternal(n),n)}createInlinedGenerateContentRequest(e){const n=Ov(this.apiClient,e),r=n._url,i=X("{model}:batchGenerateContent",r),a=n.batch.inputConfig.requests,l=a.requests,u=[];for(const f of l){const p=Object.assign({},f);if(p.systemInstruction){const m=p.systemInstruction;delete p.systemInstruction;const v=p.request;v.systemInstruction=m,p.request=v}u.push(p)}return a.requests=u,delete n.config,delete n._url,delete n._query,{path:i,body:n}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,n){const r=n?Object.assign({},n):{},i=Date.now().toString();if(r.displayName||(r.displayName=`genaiBatchJob_${i}`),r.dest===void 0){const s=this.getGcsUri(e),o=this.getBigqueryUri(e);if(s)s.endsWith(".jsonl")?r.dest=`${s.slice(0,-6)}/dest`:r.dest=`${s}_dest_${i}`;else if(o)r.dest=`${o}_dest_${i}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return r}async createInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=bk(this.apiClient,e);return a=X("batchPredictionJobs",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>ap(f))}else{const u=Ov(this.apiClient,e);return a=X("{model}:batchGenerateContent",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>Xu(f))}}async createEmbeddingsInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=Fk(this.apiClient,e);return s=X("{model}:asyncBatchEmbedContent",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>Xu(l))}}async get(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=Qk(this.apiClient,e);return a=X("batchPredictionJobs/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>ap(f))}else{const u=Jk(this.apiClient,e);return a=X("batches/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>Xu(f))}}async cancel(e){var n,r,i,s;let o="",a={};if(this.apiClient.isVertexAI()){const l=kk(this.apiClient,e);o=X("batchPredictionJobs/{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}else{const l=xk(this.apiClient,e);o=X("batches/{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal})}}async listInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=r1(e);return a=X("batchPredictionJobs",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:f.headers},m})),o.then(f=>{const p=s1(f),m=new bv;return Object.assign(m,p),m})}else{const u=n1(e);return a=X("batches",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:f.headers},m})),o.then(f=>{const p=i1(f),m=new bv;return Object.assign(m,p),m})}}async delete(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=Ok(this.apiClient,e);return a=X("batchPredictionJobs/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:f.headers},m})),o.then(f=>Gk(f))}else{const u=Uk(this.apiClient,e);return a=X("batches/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:f.headers},m})),o.then(f=>Bk(f))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function c1(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["data"]);n!=null&&h(e,["data"],n);const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function Bv(t){const e={},n=c(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>N1(s))),h(e,["parts"],i)}const r=c(t,["role"]);return r!=null&&h(e,["role"],r),e}function d1(t,e){const n={},r=c(t,["ttl"]);e!==void 0&&r!=null&&h(e,["ttl"],r);const i=c(t,["expireTime"]);e!==void 0&&i!=null&&h(e,["expireTime"],i);const s=c(t,["displayName"]);e!==void 0&&s!=null&&h(e,["displayName"],s);const o=c(t,["contents"]);if(e!==void 0&&o!=null){let f=fn(o);Array.isArray(f)&&(f=f.map(p=>Bv(p))),h(e,["contents"],f)}const a=c(t,["systemInstruction"]);e!==void 0&&a!=null&&h(e,["systemInstruction"],Bv(xt(a)));const l=c(t,["tools"]);if(e!==void 0&&l!=null){let f=l;Array.isArray(f)&&(f=f.map(p=>D1(p))),h(e,["tools"],f)}const u=c(t,["toolConfig"]);if(e!==void 0&&u!=null&&h(e,["toolConfig"],u),c(t,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function h1(t,e){const n={},r=c(t,["ttl"]);e!==void 0&&r!=null&&h(e,["ttl"],r);const i=c(t,["expireTime"]);e!==void 0&&i!=null&&h(e,["expireTime"],i);const s=c(t,["displayName"]);e!==void 0&&s!=null&&h(e,["displayName"],s);const o=c(t,["contents"]);if(e!==void 0&&o!=null){let p=fn(o);Array.isArray(p)&&(p=p.map(m=>m)),h(e,["contents"],p)}const a=c(t,["systemInstruction"]);e!==void 0&&a!=null&&h(e,["systemInstruction"],xt(a));const l=c(t,["tools"]);if(e!==void 0&&l!=null){let p=l;Array.isArray(p)&&(p=p.map(m=>M1(m))),h(e,["tools"],p)}const u=c(t,["toolConfig"]);e!==void 0&&u!=null&&h(e,["toolConfig"],u);const f=c(t,["kmsKeyName"]);return e!==void 0&&f!=null&&h(e,["encryption_spec","kmsKeyName"],f),n}function f1(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["model"],cS(t,r));const i=c(e,["config"]);return i!=null&&d1(i,n),n}function p1(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["model"],cS(t,r));const i=c(e,["config"]);return i!=null&&h1(i,n),n}function m1(t,e){const n={},r=c(e,["name"]);return r!=null&&h(n,["_url","name"],pr(t,r)),n}function g1(t,e){const n={},r=c(e,["name"]);return r!=null&&h(n,["_url","name"],pr(t,r)),n}function _1(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&h(e,["sdkHttpResponse"],n),e}function y1(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&h(e,["sdkHttpResponse"],n),e}function v1(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["fileUri"]);n!=null&&h(e,["fileUri"],n);const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function T1(t){const e={};if(c(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=c(t,["description"]);n!=null&&h(e,["description"],n);const r=c(t,["name"]);r!=null&&h(e,["name"],r);const i=c(t,["parameters"]);i!=null&&h(e,["parameters"],i);const s=c(t,["parametersJsonSchema"]);s!=null&&h(e,["parametersJsonSchema"],s);const o=c(t,["response"]);o!=null&&h(e,["response"],o);const a=c(t,["responseJsonSchema"]);return a!=null&&h(e,["responseJsonSchema"],a),e}function E1(t,e){const n={},r=c(e,["name"]);return r!=null&&h(n,["_url","name"],pr(t,r)),n}function I1(t,e){const n={},r=c(e,["name"]);return r!=null&&h(n,["_url","name"],pr(t,r)),n}function w1(t){const e={};if(c(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=c(t,["enableWidget"]);return n!=null&&h(e,["enableWidget"],n),e}function S1(t){const e={},n=c(t,["timeRangeFilter"]);if(n!=null&&h(e,["timeRangeFilter"],n),c(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function C1(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&h(e,["_query","pageSize"],r);const i=c(t,["pageToken"]);return e!==void 0&&i!=null&&h(e,["_query","pageToken"],i),n}function A1(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&h(e,["_query","pageSize"],r);const i=c(t,["pageToken"]);return e!==void 0&&i!=null&&h(e,["_query","pageToken"],i),n}function R1(t){const e={},n=c(t,["config"]);return n!=null&&C1(n,e),e}function P1(t){const e={},n=c(t,["config"]);return n!=null&&A1(n,e),e}function x1(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=c(t,["cachedContents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),h(e,["cachedContents"],s)}return e}function k1(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=c(t,["cachedContents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),h(e,["cachedContents"],s)}return e}function N1(t){const e={},n=c(t,["videoMetadata"]);n!=null&&h(e,["videoMetadata"],n);const r=c(t,["thought"]);r!=null&&h(e,["thought"],r);const i=c(t,["inlineData"]);i!=null&&h(e,["inlineData"],c1(i));const s=c(t,["fileData"]);s!=null&&h(e,["fileData"],v1(s));const o=c(t,["thoughtSignature"]);o!=null&&h(e,["thoughtSignature"],o);const a=c(t,["functionCall"]);a!=null&&h(e,["functionCall"],a);const l=c(t,["codeExecutionResult"]);l!=null&&h(e,["codeExecutionResult"],l);const u=c(t,["executableCode"]);u!=null&&h(e,["executableCode"],u);const f=c(t,["functionResponse"]);f!=null&&h(e,["functionResponse"],f);const p=c(t,["text"]);return p!=null&&h(e,["text"],p),e}function D1(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(f=>f)),h(e,["functionDeclarations"],u)}if(c(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=c(t,["googleSearch"]);r!=null&&h(e,["googleSearch"],S1(r));const i=c(t,["googleSearchRetrieval"]);if(i!=null&&h(e,["googleSearchRetrieval"],i),c(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=c(t,["googleMaps"]);s!=null&&h(e,["googleMaps"],w1(s));const o=c(t,["urlContext"]);o!=null&&h(e,["urlContext"],o);const a=c(t,["computerUse"]);a!=null&&h(e,["computerUse"],a);const l=c(t,["codeExecution"]);return l!=null&&h(e,["codeExecution"],l),e}function M1(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let p=n;Array.isArray(p)&&(p=p.map(m=>T1(m))),h(e,["functionDeclarations"],p)}const r=c(t,["retrieval"]);r!=null&&h(e,["retrieval"],r);const i=c(t,["googleSearch"]);i!=null&&h(e,["googleSearch"],i);const s=c(t,["googleSearchRetrieval"]);s!=null&&h(e,["googleSearchRetrieval"],s);const o=c(t,["enterpriseWebSearch"]);o!=null&&h(e,["enterpriseWebSearch"],o);const a=c(t,["googleMaps"]);a!=null&&h(e,["googleMaps"],a);const l=c(t,["urlContext"]);l!=null&&h(e,["urlContext"],l);const u=c(t,["computerUse"]);u!=null&&h(e,["computerUse"],u);const f=c(t,["codeExecution"]);return f!=null&&h(e,["codeExecution"],f),e}function V1(t,e){const n={},r=c(t,["ttl"]);e!==void 0&&r!=null&&h(e,["ttl"],r);const i=c(t,["expireTime"]);return e!==void 0&&i!=null&&h(e,["expireTime"],i),n}function b1(t,e){const n={},r=c(t,["ttl"]);e!==void 0&&r!=null&&h(e,["ttl"],r);const i=c(t,["expireTime"]);return e!==void 0&&i!=null&&h(e,["expireTime"],i),n}function L1(t,e){const n={},r=c(e,["name"]);r!=null&&h(n,["_url","name"],pr(t,r));const i=c(e,["config"]);return i!=null&&V1(i,n),n}function F1(t,e){const n={},r=c(e,["name"]);r!=null&&h(n,["_url","name"],pr(t,r));const i=c(e,["config"]);return i!=null&&b1(i,n),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class U1 extends ls{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new kl(Yi.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(n),n)}async create(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=p1(this.apiClient,e);return a=X("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>f)}else{const u=f1(this.apiClient,e);return a=X("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>f)}}async get(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=I1(this.apiClient,e);return a=X("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>f)}else{const u=E1(this.apiClient,e);return a=X("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>f)}}async delete(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=g1(this.apiClient,e);return a=X("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:f.headers},m})),o.then(f=>{const p=y1(f),m=new Mv;return Object.assign(m,p),m})}else{const u=m1(this.apiClient,e);return a=X("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:f.headers},m})),o.then(f=>{const p=_1(f),m=new Mv;return Object.assign(m,p),m})}}async update(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=F1(this.apiClient,e);return a=X("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>f)}else{const u=L1(this.apiClient,e);return a=X("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>f)}}async listInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=P1(e);return a=X("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:f.headers},m})),o.then(f=>{const p=k1(f),m=new Vv;return Object.assign(m,p),m})}else{const u=R1(e);return a=X("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:f.headers},m})),o.then(f=>{const p=x1(f),m=new Vv;return Object.assign(m,p),m})}}}function Gv(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Oe(t){return this instanceof Oe?(this.v=t,this):new Oe(t)}function Xs(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),i,s=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(v){return function(I){return Promise.resolve(I).then(v,p)}}function a(v,I){r[v]&&(i[v]=function(x){return new Promise(function(M,A){s.push([v,x,M,A])>1||l(v,x)})},I&&(i[v]=I(i[v])))}function l(v,I){try{u(r[v](I))}catch(x){m(s[0][3],x)}}function u(v){v.value instanceof Oe?Promise.resolve(v.value.v).then(f,p):m(s[0][2],v)}function f(v){l("next",v)}function p(v){l("throw",v)}function m(v,I){v(I),s.shift(),s.length&&l(s[0][0],s[0][1])}}function Fa(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof Gv=="function"?Gv(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(s){n[s]=t[s]&&function(o){return new Promise(function(a,l){o=t[s](o),i(a,l,o.done,o.value)})}}function i(s,o,a,l){Promise.resolve(l).then(function(u){s({value:u,done:a})},o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function O1(t){var e;if(t.candidates==null||t.candidates.length===0)return!1;const n=(e=t.candidates[0])===null||e===void 0?void 0:e.content;return n===void 0?!1:wS(n)}function wS(t){if(t.parts===void 0||t.parts.length===0)return!1;for(const e of t.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function B1(t){if(t.length!==0){for(const e of t)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function qv(t){if(t===void 0||t.length===0)return[];const e=[],n=t.length;let r=0;for(;r<n;)if(t[r].role==="user")e.push(t[r]),r++;else{const i=[];let s=!0;for(;r<n&&t[r].role==="model";)i.push(t[r]),s&&!wS(t[r])&&(s=!1),r++;s?e.push(...i):e.pop()}return e}class G1{constructor(e,n){this.modelsModule=e,this.apiClient=n}create(e){return new q1(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class q1{constructor(e,n,r,i={},s=[]){this.apiClient=e,this.modelsModule=n,this.model=r,this.config=i,this.history=s,this.sendPromise=Promise.resolve(),B1(s)}async sendMessage(e){var n;await this.sendPromise;const r=xt(e.message),i=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var s,o,a;const l=await i,u=(o=(s=l.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content,f=l.automaticFunctionCallingHistory,p=this.getHistory(!0).length;let m=[];f!=null&&(m=(a=f.slice(p))!==null&&a!==void 0?a:[]);const v=u?[u]:[];this.recordHistory(r,v,m)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),i}async sendMessageStream(e){var n;await this.sendPromise;const r=xt(e.message),i=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});this.sendPromise=i.then(()=>{}).catch(()=>{});const s=await i;return this.processStreamResponse(s,r)}getHistory(e=!1){const n=e?qv(this.history):this.history;return structuredClone(n)}processStreamResponse(e,n){var r,i;return Xs(this,arguments,function*(){var o,a,l,u;const f=[];try{for(var p=!0,m=Fa(e),v;v=yield Oe(m.next()),o=v.done,!o;p=!0){u=v.value,p=!1;const I=u;if(O1(I)){const x=(i=(r=I.candidates)===null||r===void 0?void 0:r[0])===null||i===void 0?void 0:i.content;x!==void 0&&f.push(x)}yield yield Oe(I)}}catch(I){a={error:I}}finally{try{!p&&!o&&(l=m.return)&&(yield Oe(l.call(m)))}finally{if(a)throw a.error}}this.recordHistory(n,f)})}recordHistory(e,n,r){let i=[];n.length>0&&n.every(s=>s.role!==void 0)?i=n:i.push({role:"model",parts:[]}),r&&r.length>0?this.history.push(...qv(r)):this.history.push(e),this.history.push(...i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class kd extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,kd.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function $1(t){const e={},n=c(t,["file"]);return n!=null&&h(e,["file"],n),e}function z1(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&h(e,["sdkHttpResponse"],n),e}function H1(t){const e={},n=c(t,["name"]);return n!=null&&h(e,["_url","file"],gS(n)),e}function K1(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&h(e,["sdkHttpResponse"],n),e}function W1(t){const e={},n=c(t,["name"]);return n!=null&&h(e,["_url","file"],gS(n)),e}function J1(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&h(e,["_query","pageSize"],r);const i=c(t,["pageToken"]);return e!==void 0&&i!=null&&h(e,["_query","pageToken"],i),n}function Q1(t){const e={},n=c(t,["config"]);return n!=null&&J1(n,e),e}function Y1(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=c(t,["files"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),h(e,["files"],s)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class j1 extends ls{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new kl(Yi.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(n),n)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(n=>n)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=Q1(e);return s=X("files",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>{const u=Y1(l),f=new lk;return Object.assign(f,u),f})}}async createInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=$1(e);return s=X("upload/v1beta/files",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=z1(l),f=new uk;return Object.assign(f,u),f})}}async get(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=W1(e);return s=X("files/{file}",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>l)}}async delete(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=H1(e);return s=X("files/{file}",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>{const u=K1(l),f=new ck;return Object.assign(f,u),f})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Zu(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["data"]);n!=null&&h(e,["data"],n);const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function X1(t){const e={},n=c(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>fN(s))),h(e,["parts"],i)}const r=c(t,["role"]);return r!=null&&h(e,["role"],r),e}function Z1(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["fileUri"]);n!=null&&h(e,["fileUri"],n);const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function eN(t){const e={};if(c(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=c(t,["description"]);n!=null&&h(e,["description"],n);const r=c(t,["name"]);r!=null&&h(e,["name"],r);const i=c(t,["parameters"]);i!=null&&h(e,["parameters"],i);const s=c(t,["parametersJsonSchema"]);s!=null&&h(e,["parametersJsonSchema"],s);const o=c(t,["response"]);o!=null&&h(e,["response"],o);const a=c(t,["responseJsonSchema"]);return a!=null&&h(e,["responseJsonSchema"],a),e}function tN(t){const e={},n=c(t,["modelSelectionConfig"]);n!=null&&h(e,["modelConfig"],n);const r=c(t,["audioTimestamp"]);r!=null&&h(e,["audioTimestamp"],r);const i=c(t,["candidateCount"]);i!=null&&h(e,["candidateCount"],i);const s=c(t,["enableAffectiveDialog"]);s!=null&&h(e,["enableAffectiveDialog"],s);const o=c(t,["frequencyPenalty"]);o!=null&&h(e,["frequencyPenalty"],o);const a=c(t,["logprobs"]);a!=null&&h(e,["logprobs"],a);const l=c(t,["maxOutputTokens"]);l!=null&&h(e,["maxOutputTokens"],l);const u=c(t,["mediaResolution"]);u!=null&&h(e,["mediaResolution"],u);const f=c(t,["presencePenalty"]);f!=null&&h(e,["presencePenalty"],f);const p=c(t,["responseJsonSchema"]);p!=null&&h(e,["responseJsonSchema"],p);const m=c(t,["responseLogprobs"]);m!=null&&h(e,["responseLogprobs"],m);const v=c(t,["responseMimeType"]);v!=null&&h(e,["responseMimeType"],v);const I=c(t,["responseModalities"]);I!=null&&h(e,["responseModalities"],I);const x=c(t,["responseSchema"]);x!=null&&h(e,["responseSchema"],x);const M=c(t,["routingConfig"]);M!=null&&h(e,["routingConfig"],M);const A=c(t,["seed"]);A!=null&&h(e,["seed"],A);const T=c(t,["speechConfig"]);T!=null&&h(e,["speechConfig"],SS(T));const S=c(t,["stopSequences"]);S!=null&&h(e,["stopSequences"],S);const V=c(t,["temperature"]);V!=null&&h(e,["temperature"],V);const U=c(t,["thinkingConfig"]);U!=null&&h(e,["thinkingConfig"],U);const F=c(t,["topK"]);F!=null&&h(e,["topK"],F);const C=c(t,["topP"]);return C!=null&&h(e,["topP"],C),e}function nN(t){const e={};if(c(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=c(t,["enableWidget"]);return n!=null&&h(e,["enableWidget"],n),e}function rN(t){const e={},n=c(t,["timeRangeFilter"]);if(n!=null&&h(e,["timeRangeFilter"],n),c(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function iN(t,e){const n={},r=c(t,["generationConfig"]);e!==void 0&&r!=null&&h(e,["setup","generationConfig"],r);const i=c(t,["responseModalities"]);e!==void 0&&i!=null&&h(e,["setup","generationConfig","responseModalities"],i);const s=c(t,["temperature"]);e!==void 0&&s!=null&&h(e,["setup","generationConfig","temperature"],s);const o=c(t,["topP"]);e!==void 0&&o!=null&&h(e,["setup","generationConfig","topP"],o);const a=c(t,["topK"]);e!==void 0&&a!=null&&h(e,["setup","generationConfig","topK"],a);const l=c(t,["maxOutputTokens"]);e!==void 0&&l!=null&&h(e,["setup","generationConfig","maxOutputTokens"],l);const u=c(t,["mediaResolution"]);e!==void 0&&u!=null&&h(e,["setup","generationConfig","mediaResolution"],u);const f=c(t,["seed"]);e!==void 0&&f!=null&&h(e,["setup","generationConfig","seed"],f);const p=c(t,["speechConfig"]);e!==void 0&&p!=null&&h(e,["setup","generationConfig","speechConfig"],$m(p));const m=c(t,["thinkingConfig"]);e!==void 0&&m!=null&&h(e,["setup","generationConfig","thinkingConfig"],m);const v=c(t,["enableAffectiveDialog"]);e!==void 0&&v!=null&&h(e,["setup","generationConfig","enableAffectiveDialog"],v);const I=c(t,["systemInstruction"]);e!==void 0&&I!=null&&h(e,["setup","systemInstruction"],X1(xt(I)));const x=c(t,["tools"]);if(e!==void 0&&x!=null){let F=bo(x);Array.isArray(F)&&(F=F.map(C=>mN(Vo(C)))),h(e,["setup","tools"],F)}const M=c(t,["sessionResumption"]);e!==void 0&&M!=null&&h(e,["setup","sessionResumption"],pN(M));const A=c(t,["inputAudioTranscription"]);e!==void 0&&A!=null&&h(e,["setup","inputAudioTranscription"],A);const T=c(t,["outputAudioTranscription"]);e!==void 0&&T!=null&&h(e,["setup","outputAudioTranscription"],T);const S=c(t,["realtimeInputConfig"]);e!==void 0&&S!=null&&h(e,["setup","realtimeInputConfig"],S);const V=c(t,["contextWindowCompression"]);e!==void 0&&V!=null&&h(e,["setup","contextWindowCompression"],V);const U=c(t,["proactivity"]);return e!==void 0&&U!=null&&h(e,["setup","proactivity"],U),n}function sN(t,e){const n={},r=c(t,["generationConfig"]);e!==void 0&&r!=null&&h(e,["setup","generationConfig"],tN(r));const i=c(t,["responseModalities"]);e!==void 0&&i!=null&&h(e,["setup","generationConfig","responseModalities"],i);const s=c(t,["temperature"]);e!==void 0&&s!=null&&h(e,["setup","generationConfig","temperature"],s);const o=c(t,["topP"]);e!==void 0&&o!=null&&h(e,["setup","generationConfig","topP"],o);const a=c(t,["topK"]);e!==void 0&&a!=null&&h(e,["setup","generationConfig","topK"],a);const l=c(t,["maxOutputTokens"]);e!==void 0&&l!=null&&h(e,["setup","generationConfig","maxOutputTokens"],l);const u=c(t,["mediaResolution"]);e!==void 0&&u!=null&&h(e,["setup","generationConfig","mediaResolution"],u);const f=c(t,["seed"]);e!==void 0&&f!=null&&h(e,["setup","generationConfig","seed"],f);const p=c(t,["speechConfig"]);e!==void 0&&p!=null&&h(e,["setup","generationConfig","speechConfig"],SS($m(p)));const m=c(t,["thinkingConfig"]);e!==void 0&&m!=null&&h(e,["setup","generationConfig","thinkingConfig"],m);const v=c(t,["enableAffectiveDialog"]);e!==void 0&&v!=null&&h(e,["setup","generationConfig","enableAffectiveDialog"],v);const I=c(t,["systemInstruction"]);e!==void 0&&I!=null&&h(e,["setup","systemInstruction"],xt(I));const x=c(t,["tools"]);if(e!==void 0&&x!=null){let F=bo(x);Array.isArray(F)&&(F=F.map(C=>gN(Vo(C)))),h(e,["setup","tools"],F)}const M=c(t,["sessionResumption"]);e!==void 0&&M!=null&&h(e,["setup","sessionResumption"],M);const A=c(t,["inputAudioTranscription"]);e!==void 0&&A!=null&&h(e,["setup","inputAudioTranscription"],A);const T=c(t,["outputAudioTranscription"]);e!==void 0&&T!=null&&h(e,["setup","outputAudioTranscription"],T);const S=c(t,["realtimeInputConfig"]);e!==void 0&&S!=null&&h(e,["setup","realtimeInputConfig"],S);const V=c(t,["contextWindowCompression"]);e!==void 0&&V!=null&&h(e,["setup","contextWindowCompression"],V);const U=c(t,["proactivity"]);return e!==void 0&&U!=null&&h(e,["setup","proactivity"],U),n}function oN(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["setup","model"],we(t,r));const i=c(e,["config"]);return i!=null&&h(n,["config"],iN(i,n)),n}function aN(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["setup","model"],we(t,r));const i=c(e,["config"]);return i!=null&&h(n,["config"],sN(i,n)),n}function lN(t){const e={},n=c(t,["musicGenerationConfig"]);return n!=null&&h(e,["musicGenerationConfig"],n),e}function uN(t){const e={},n=c(t,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>i)),h(e,["weightedPrompts"],r)}return e}function cN(t){const e={},n=c(t,["media"]);if(n!=null){let u=dS(n);Array.isArray(u)&&(u=u.map(f=>Zu(f))),h(e,["mediaChunks"],u)}const r=c(t,["audio"]);r!=null&&h(e,["audio"],Zu(fS(r)));const i=c(t,["audioStreamEnd"]);i!=null&&h(e,["audioStreamEnd"],i);const s=c(t,["video"]);s!=null&&h(e,["video"],Zu(hS(s)));const o=c(t,["text"]);o!=null&&h(e,["text"],o);const a=c(t,["activityStart"]);a!=null&&h(e,["activityStart"],a);const l=c(t,["activityEnd"]);return l!=null&&h(e,["activityEnd"],l),e}function dN(t){const e={},n=c(t,["media"]);if(n!=null){let u=dS(n);Array.isArray(u)&&(u=u.map(f=>f)),h(e,["mediaChunks"],u)}const r=c(t,["audio"]);r!=null&&h(e,["audio"],fS(r));const i=c(t,["audioStreamEnd"]);i!=null&&h(e,["audioStreamEnd"],i);const s=c(t,["video"]);s!=null&&h(e,["video"],hS(s));const o=c(t,["text"]);o!=null&&h(e,["text"],o);const a=c(t,["activityStart"]);a!=null&&h(e,["activityStart"],a);const l=c(t,["activityEnd"]);return l!=null&&h(e,["activityEnd"],l),e}function hN(t){const e={},n=c(t,["setupComplete"]);n!=null&&h(e,["setupComplete"],n);const r=c(t,["serverContent"]);r!=null&&h(e,["serverContent"],r);const i=c(t,["toolCall"]);i!=null&&h(e,["toolCall"],i);const s=c(t,["toolCallCancellation"]);s!=null&&h(e,["toolCallCancellation"],s);const o=c(t,["usageMetadata"]);o!=null&&h(e,["usageMetadata"],_N(o));const a=c(t,["goAway"]);a!=null&&h(e,["goAway"],a);const l=c(t,["sessionResumptionUpdate"]);return l!=null&&h(e,["sessionResumptionUpdate"],l),e}function fN(t){const e={},n=c(t,["videoMetadata"]);n!=null&&h(e,["videoMetadata"],n);const r=c(t,["thought"]);r!=null&&h(e,["thought"],r);const i=c(t,["inlineData"]);i!=null&&h(e,["inlineData"],Zu(i));const s=c(t,["fileData"]);s!=null&&h(e,["fileData"],Z1(s));const o=c(t,["thoughtSignature"]);o!=null&&h(e,["thoughtSignature"],o);const a=c(t,["functionCall"]);a!=null&&h(e,["functionCall"],a);const l=c(t,["codeExecutionResult"]);l!=null&&h(e,["codeExecutionResult"],l);const u=c(t,["executableCode"]);u!=null&&h(e,["executableCode"],u);const f=c(t,["functionResponse"]);f!=null&&h(e,["functionResponse"],f);const p=c(t,["text"]);return p!=null&&h(e,["text"],p),e}function pN(t){const e={},n=c(t,["handle"]);if(n!=null&&h(e,["handle"],n),c(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function SS(t){const e={},n=c(t,["voiceConfig"]);if(n!=null&&h(e,["voiceConfig"],n),c(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const r=c(t,["languageCode"]);return r!=null&&h(e,["languageCode"],r),e}function mN(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(f=>f)),h(e,["functionDeclarations"],u)}if(c(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=c(t,["googleSearch"]);r!=null&&h(e,["googleSearch"],rN(r));const i=c(t,["googleSearchRetrieval"]);if(i!=null&&h(e,["googleSearchRetrieval"],i),c(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=c(t,["googleMaps"]);s!=null&&h(e,["googleMaps"],nN(s));const o=c(t,["urlContext"]);o!=null&&h(e,["urlContext"],o);const a=c(t,["computerUse"]);a!=null&&h(e,["computerUse"],a);const l=c(t,["codeExecution"]);return l!=null&&h(e,["codeExecution"],l),e}function gN(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let p=n;Array.isArray(p)&&(p=p.map(m=>eN(m))),h(e,["functionDeclarations"],p)}const r=c(t,["retrieval"]);r!=null&&h(e,["retrieval"],r);const i=c(t,["googleSearch"]);i!=null&&h(e,["googleSearch"],i);const s=c(t,["googleSearchRetrieval"]);s!=null&&h(e,["googleSearchRetrieval"],s);const o=c(t,["enterpriseWebSearch"]);o!=null&&h(e,["enterpriseWebSearch"],o);const a=c(t,["googleMaps"]);a!=null&&h(e,["googleMaps"],a);const l=c(t,["urlContext"]);l!=null&&h(e,["urlContext"],l);const u=c(t,["computerUse"]);u!=null&&h(e,["computerUse"],u);const f=c(t,["codeExecution"]);return f!=null&&h(e,["codeExecution"],f),e}function _N(t){const e={},n=c(t,["promptTokenCount"]);n!=null&&h(e,["promptTokenCount"],n);const r=c(t,["cachedContentTokenCount"]);r!=null&&h(e,["cachedContentTokenCount"],r);const i=c(t,["candidatesTokenCount"]);i!=null&&h(e,["responseTokenCount"],i);const s=c(t,["toolUsePromptTokenCount"]);s!=null&&h(e,["toolUsePromptTokenCount"],s);const o=c(t,["thoughtsTokenCount"]);o!=null&&h(e,["thoughtsTokenCount"],o);const a=c(t,["totalTokenCount"]);a!=null&&h(e,["totalTokenCount"],a);const l=c(t,["promptTokensDetails"]);if(l!=null){let v=l;Array.isArray(v)&&(v=v.map(I=>I)),h(e,["promptTokensDetails"],v)}const u=c(t,["cacheTokensDetails"]);if(u!=null){let v=u;Array.isArray(v)&&(v=v.map(I=>I)),h(e,["cacheTokensDetails"],v)}const f=c(t,["candidatesTokensDetails"]);if(f!=null){let v=f;Array.isArray(v)&&(v=v.map(I=>I)),h(e,["responseTokensDetails"],v)}const p=c(t,["toolUsePromptTokensDetails"]);if(p!=null){let v=p;Array.isArray(v)&&(v=v.map(I=>I)),h(e,["toolUsePromptTokensDetails"],v)}const m=c(t,["trafficType"]);return m!=null&&h(e,["trafficType"],m),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function yN(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["data"]);n!=null&&h(e,["data"],n);const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function vN(t){const e={},n=c(t,["content"]);n!=null&&h(e,["content"],n);const r=c(t,["citationMetadata"]);r!=null&&h(e,["citationMetadata"],TN(r));const i=c(t,["tokenCount"]);i!=null&&h(e,["tokenCount"],i);const s=c(t,["finishReason"]);s!=null&&h(e,["finishReason"],s);const o=c(t,["urlContextMetadata"]);o!=null&&h(e,["urlContextMetadata"],o);const a=c(t,["avgLogprobs"]);a!=null&&h(e,["avgLogprobs"],a);const l=c(t,["groundingMetadata"]);l!=null&&h(e,["groundingMetadata"],l);const u=c(t,["index"]);u!=null&&h(e,["index"],u);const f=c(t,["logprobsResult"]);f!=null&&h(e,["logprobsResult"],f);const p=c(t,["safetyRatings"]);if(p!=null){let m=p;Array.isArray(m)&&(m=m.map(v=>v)),h(e,["safetyRatings"],m)}return e}function TN(t){const e={},n=c(t,["citationSources"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>i)),h(e,["citations"],r)}return e}function EN(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],we(t,r));const i=c(e,["contents"]);if(i!=null){let s=fn(i);Array.isArray(s)&&(s=s.map(o=>o)),h(n,["contents"],s)}return n}function IN(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["tokensInfo"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>s)),h(e,["tokensInfo"],i)}return e}function wN(t){const e={},n=c(t,["values"]);n!=null&&h(e,["values"],n);const r=c(t,["statistics"]);return r!=null&&h(e,["statistics"],SN(r)),e}function SN(t){const e={},n=c(t,["truncated"]);n!=null&&h(e,["truncated"],n);const r=c(t,["token_count"]);return r!=null&&h(e,["tokenCount"],r),e}function Nd(t){const e={},n=c(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>xD(s))),h(e,["parts"],i)}const r=c(t,["role"]);return r!=null&&h(e,["role"],r),e}function CN(t){const e={},n=c(t,["controlType"]);n!=null&&h(e,["controlType"],n);const r=c(t,["enableControlImageComputation"]);return r!=null&&h(e,["computeControl"],r),e}function AN(t){const e={};if(c(t,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(c(t,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(c(t,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function RN(t,e){const n={},r=c(t,["systemInstruction"]);e!==void 0&&r!=null&&h(e,["systemInstruction"],xt(r));const i=c(t,["tools"]);if(e!==void 0&&i!=null){let o=i;Array.isArray(o)&&(o=o.map(a=>xS(a))),h(e,["tools"],o)}const s=c(t,["generationConfig"]);return e!==void 0&&s!=null&&h(e,["generationConfig"],gD(s)),n}function PN(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],we(t,r));const i=c(e,["contents"]);if(i!=null){let o=fn(i);Array.isArray(o)&&(o=o.map(a=>Nd(a))),h(n,["contents"],o)}const s=c(e,["config"]);return s!=null&&AN(s),n}function xN(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],we(t,r));const i=c(e,["contents"]);if(i!=null){let o=fn(i);Array.isArray(o)&&(o=o.map(a=>a)),h(n,["contents"],o)}const s=c(e,["config"]);return s!=null&&RN(s,n),n}function kN(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["totalTokens"]);r!=null&&h(e,["totalTokens"],r);const i=c(t,["cachedContentTokenCount"]);return i!=null&&h(e,["cachedContentTokenCount"],i),e}function NN(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["totalTokens"]);return r!=null&&h(e,["totalTokens"],r),e}function DN(t,e){const n={},r=c(e,["model"]);return r!=null&&h(n,["_url","name"],we(t,r)),n}function MN(t,e){const n={},r=c(e,["model"]);return r!=null&&h(n,["_url","name"],we(t,r)),n}function VN(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&h(e,["sdkHttpResponse"],n),e}function bN(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&h(e,["sdkHttpResponse"],n),e}function LN(t,e){const n={},r=c(t,["outputGcsUri"]);e!==void 0&&r!=null&&h(e,["parameters","storageUri"],r);const i=c(t,["negativePrompt"]);e!==void 0&&i!=null&&h(e,["parameters","negativePrompt"],i);const s=c(t,["numberOfImages"]);e!==void 0&&s!=null&&h(e,["parameters","sampleCount"],s);const o=c(t,["aspectRatio"]);e!==void 0&&o!=null&&h(e,["parameters","aspectRatio"],o);const a=c(t,["guidanceScale"]);e!==void 0&&a!=null&&h(e,["parameters","guidanceScale"],a);const l=c(t,["seed"]);e!==void 0&&l!=null&&h(e,["parameters","seed"],l);const u=c(t,["safetyFilterLevel"]);e!==void 0&&u!=null&&h(e,["parameters","safetySetting"],u);const f=c(t,["personGeneration"]);e!==void 0&&f!=null&&h(e,["parameters","personGeneration"],f);const p=c(t,["includeSafetyAttributes"]);e!==void 0&&p!=null&&h(e,["parameters","includeSafetyAttributes"],p);const m=c(t,["includeRaiReason"]);e!==void 0&&m!=null&&h(e,["parameters","includeRaiReason"],m);const v=c(t,["language"]);e!==void 0&&v!=null&&h(e,["parameters","language"],v);const I=c(t,["outputMimeType"]);e!==void 0&&I!=null&&h(e,["parameters","outputOptions","mimeType"],I);const x=c(t,["outputCompressionQuality"]);e!==void 0&&x!=null&&h(e,["parameters","outputOptions","compressionQuality"],x);const M=c(t,["addWatermark"]);e!==void 0&&M!=null&&h(e,["parameters","addWatermark"],M);const A=c(t,["labels"]);e!==void 0&&A!=null&&h(e,["labels"],A);const T=c(t,["editMode"]);e!==void 0&&T!=null&&h(e,["parameters","editMode"],T);const S=c(t,["baseSteps"]);return e!==void 0&&S!=null&&h(e,["parameters","editConfig","baseSteps"],S),n}function FN(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],we(t,r));const i=c(e,["prompt"]);i!=null&&h(n,["instances[0]","prompt"],i);const s=c(e,["referenceImages"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>bD(l))),h(n,["instances[0]","referenceImages"],a)}const o=c(e,["config"]);return o!=null&&LN(o,n),n}function UN(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>Dd(s))),h(e,["generatedImages"],i)}return e}function ON(t,e){const n={},r=c(t,["taskType"]);e!==void 0&&r!=null&&h(e,["requests[]","taskType"],r);const i=c(t,["title"]);e!==void 0&&i!=null&&h(e,["requests[]","title"],i);const s=c(t,["outputDimensionality"]);if(e!==void 0&&s!=null&&h(e,["requests[]","outputDimensionality"],s),c(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(c(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function BN(t,e){const n={},r=c(t,["taskType"]);e!==void 0&&r!=null&&h(e,["instances[]","task_type"],r);const i=c(t,["title"]);e!==void 0&&i!=null&&h(e,["instances[]","title"],i);const s=c(t,["outputDimensionality"]);e!==void 0&&s!=null&&h(e,["parameters","outputDimensionality"],s);const o=c(t,["mimeType"]);e!==void 0&&o!=null&&h(e,["instances[]","mimeType"],o);const a=c(t,["autoTruncate"]);return e!==void 0&&a!=null&&h(e,["parameters","autoTruncate"],a),n}function GN(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],we(t,r));const i=c(e,["contents"]);if(i!=null){let a=Bm(t,i);Array.isArray(a)&&(a=a.map(l=>l)),h(n,["requests[]","content"],a)}const s=c(e,["config"]);s!=null&&ON(s,n);const o=c(e,["model"]);return o!==void 0&&h(n,["requests[]","model"],we(t,o)),n}function qN(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],we(t,r));const i=c(e,["contents"]);if(i!=null){let o=Bm(t,i);Array.isArray(o)&&(o=o.map(a=>a)),h(n,["instances[]","content"],o)}const s=c(e,["config"]);return s!=null&&BN(s,n),n}function $N(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["embeddings"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>o)),h(e,["embeddings"],s)}const i=c(t,["metadata"]);return i!=null&&h(e,["metadata"],i),e}function zN(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["predictions[]","embeddings"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>wN(o))),h(e,["embeddings"],s)}const i=c(t,["metadata"]);return i!=null&&h(e,["metadata"],i),e}function HN(t){const e={},n=c(t,["endpoint"]);n!=null&&h(e,["name"],n);const r=c(t,["deployedModelId"]);return r!=null&&h(e,["deployedModelId"],r),e}function KN(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["fileUri"]);n!=null&&h(e,["fileUri"],n);const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function WN(t){const e={};if(c(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=c(t,["description"]);n!=null&&h(e,["description"],n);const r=c(t,["name"]);r!=null&&h(e,["name"],r);const i=c(t,["parameters"]);i!=null&&h(e,["parameters"],i);const s=c(t,["parametersJsonSchema"]);s!=null&&h(e,["parametersJsonSchema"],s);const o=c(t,["response"]);o!=null&&h(e,["response"],o);const a=c(t,["responseJsonSchema"]);return a!=null&&h(e,["responseJsonSchema"],a),e}function JN(t,e,n){const r={},i=c(e,["systemInstruction"]);n!==void 0&&i!=null&&h(n,["systemInstruction"],Nd(xt(i)));const s=c(e,["temperature"]);s!=null&&h(r,["temperature"],s);const o=c(e,["topP"]);o!=null&&h(r,["topP"],o);const a=c(e,["topK"]);a!=null&&h(r,["topK"],a);const l=c(e,["candidateCount"]);l!=null&&h(r,["candidateCount"],l);const u=c(e,["maxOutputTokens"]);u!=null&&h(r,["maxOutputTokens"],u);const f=c(e,["stopSequences"]);f!=null&&h(r,["stopSequences"],f);const p=c(e,["responseLogprobs"]);p!=null&&h(r,["responseLogprobs"],p);const m=c(e,["logprobs"]);m!=null&&h(r,["logprobs"],m);const v=c(e,["presencePenalty"]);v!=null&&h(r,["presencePenalty"],v);const I=c(e,["frequencyPenalty"]);I!=null&&h(r,["frequencyPenalty"],I);const x=c(e,["seed"]);x!=null&&h(r,["seed"],x);const M=c(e,["responseMimeType"]);M!=null&&h(r,["responseMimeType"],M);const A=c(e,["responseSchema"]);A!=null&&h(r,["responseSchema"],Gm(A));const T=c(e,["responseJsonSchema"]);if(T!=null&&h(r,["responseJsonSchema"],T),c(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(c(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const S=c(e,["safetySettings"]);if(n!==void 0&&S!=null){let D=S;Array.isArray(D)&&(D=D.map(k=>LD(k))),h(n,["safetySettings"],D)}const V=c(e,["tools"]);if(n!==void 0&&V!=null){let D=bo(V);Array.isArray(D)&&(D=D.map(k=>qD(Vo(k)))),h(n,["tools"],D)}const U=c(e,["toolConfig"]);if(n!==void 0&&U!=null&&h(n,["toolConfig"],U),c(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const F=c(e,["cachedContent"]);n!==void 0&&F!=null&&h(n,["cachedContent"],pr(t,F));const C=c(e,["responseModalities"]);C!=null&&h(r,["responseModalities"],C);const E=c(e,["mediaResolution"]);E!=null&&h(r,["mediaResolution"],E);const R=c(e,["speechConfig"]);if(R!=null&&h(r,["speechConfig"],qm(R)),c(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const P=c(e,["thinkingConfig"]);P!=null&&h(r,["thinkingConfig"],P);const N=c(e,["imageConfig"]);return N!=null&&h(r,["imageConfig"],N),r}function QN(t,e,n){const r={},i=c(e,["systemInstruction"]);n!==void 0&&i!=null&&h(n,["systemInstruction"],xt(i));const s=c(e,["temperature"]);s!=null&&h(r,["temperature"],s);const o=c(e,["topP"]);o!=null&&h(r,["topP"],o);const a=c(e,["topK"]);a!=null&&h(r,["topK"],a);const l=c(e,["candidateCount"]);l!=null&&h(r,["candidateCount"],l);const u=c(e,["maxOutputTokens"]);u!=null&&h(r,["maxOutputTokens"],u);const f=c(e,["stopSequences"]);f!=null&&h(r,["stopSequences"],f);const p=c(e,["responseLogprobs"]);p!=null&&h(r,["responseLogprobs"],p);const m=c(e,["logprobs"]);m!=null&&h(r,["logprobs"],m);const v=c(e,["presencePenalty"]);v!=null&&h(r,["presencePenalty"],v);const I=c(e,["frequencyPenalty"]);I!=null&&h(r,["frequencyPenalty"],I);const x=c(e,["seed"]);x!=null&&h(r,["seed"],x);const M=c(e,["responseMimeType"]);M!=null&&h(r,["responseMimeType"],M);const A=c(e,["responseSchema"]);A!=null&&h(r,["responseSchema"],Gm(A));const T=c(e,["responseJsonSchema"]);T!=null&&h(r,["responseJsonSchema"],T);const S=c(e,["routingConfig"]);S!=null&&h(r,["routingConfig"],S);const V=c(e,["modelSelectionConfig"]);V!=null&&h(r,["modelConfig"],V);const U=c(e,["safetySettings"]);if(n!==void 0&&U!=null){let Ce=U;Array.isArray(Ce)&&(Ce=Ce.map(oe=>oe)),h(n,["safetySettings"],Ce)}const F=c(e,["tools"]);if(n!==void 0&&F!=null){let Ce=bo(F);Array.isArray(Ce)&&(Ce=Ce.map(oe=>xS(Vo(oe)))),h(n,["tools"],Ce)}const C=c(e,["toolConfig"]);n!==void 0&&C!=null&&h(n,["toolConfig"],C);const E=c(e,["labels"]);n!==void 0&&E!=null&&h(n,["labels"],E);const R=c(e,["cachedContent"]);n!==void 0&&R!=null&&h(n,["cachedContent"],pr(t,R));const P=c(e,["responseModalities"]);P!=null&&h(r,["responseModalities"],P);const N=c(e,["mediaResolution"]);N!=null&&h(r,["mediaResolution"],N);const D=c(e,["speechConfig"]);D!=null&&h(r,["speechConfig"],PS(qm(D)));const k=c(e,["audioTimestamp"]);k!=null&&h(r,["audioTimestamp"],k);const ne=c(e,["thinkingConfig"]);ne!=null&&h(r,["thinkingConfig"],ne);const ye=c(e,["imageConfig"]);return ye!=null&&h(r,["imageConfig"],ye),r}function $v(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],we(t,r));const i=c(e,["contents"]);if(i!=null){let o=fn(i);Array.isArray(o)&&(o=o.map(a=>Nd(a))),h(n,["contents"],o)}const s=c(e,["config"]);return s!=null&&h(n,["generationConfig"],JN(t,s,n)),n}function zv(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],we(t,r));const i=c(e,["contents"]);if(i!=null){let o=fn(i);Array.isArray(o)&&(o=o.map(a=>a)),h(n,["contents"],o)}const s=c(e,["config"]);return s!=null&&h(n,["generationConfig"],QN(t,s,n)),n}function Hv(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["candidates"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(u=>vN(u))),h(e,["candidates"],l)}const i=c(t,["modelVersion"]);i!=null&&h(e,["modelVersion"],i);const s=c(t,["promptFeedback"]);s!=null&&h(e,["promptFeedback"],s);const o=c(t,["responseId"]);o!=null&&h(e,["responseId"],o);const a=c(t,["usageMetadata"]);return a!=null&&h(e,["usageMetadata"],a),e}function Kv(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["candidates"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(f=>f)),h(e,["candidates"],u)}const i=c(t,["createTime"]);i!=null&&h(e,["createTime"],i);const s=c(t,["modelVersion"]);s!=null&&h(e,["modelVersion"],s);const o=c(t,["promptFeedback"]);o!=null&&h(e,["promptFeedback"],o);const a=c(t,["responseId"]);a!=null&&h(e,["responseId"],a);const l=c(t,["usageMetadata"]);return l!=null&&h(e,["usageMetadata"],l),e}function YN(t,e){const n={};if(c(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(c(t,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const r=c(t,["numberOfImages"]);e!==void 0&&r!=null&&h(e,["parameters","sampleCount"],r);const i=c(t,["aspectRatio"]);e!==void 0&&i!=null&&h(e,["parameters","aspectRatio"],i);const s=c(t,["guidanceScale"]);if(e!==void 0&&s!=null&&h(e,["parameters","guidanceScale"],s),c(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=c(t,["safetyFilterLevel"]);e!==void 0&&o!=null&&h(e,["parameters","safetySetting"],o);const a=c(t,["personGeneration"]);e!==void 0&&a!=null&&h(e,["parameters","personGeneration"],a);const l=c(t,["includeSafetyAttributes"]);e!==void 0&&l!=null&&h(e,["parameters","includeSafetyAttributes"],l);const u=c(t,["includeRaiReason"]);e!==void 0&&u!=null&&h(e,["parameters","includeRaiReason"],u);const f=c(t,["language"]);e!==void 0&&f!=null&&h(e,["parameters","language"],f);const p=c(t,["outputMimeType"]);e!==void 0&&p!=null&&h(e,["parameters","outputOptions","mimeType"],p);const m=c(t,["outputCompressionQuality"]);if(e!==void 0&&m!=null&&h(e,["parameters","outputOptions","compressionQuality"],m),c(t,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(c(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const v=c(t,["imageSize"]);if(e!==void 0&&v!=null&&h(e,["parameters","sampleImageSize"],v),c(t,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function jN(t,e){const n={},r=c(t,["outputGcsUri"]);e!==void 0&&r!=null&&h(e,["parameters","storageUri"],r);const i=c(t,["negativePrompt"]);e!==void 0&&i!=null&&h(e,["parameters","negativePrompt"],i);const s=c(t,["numberOfImages"]);e!==void 0&&s!=null&&h(e,["parameters","sampleCount"],s);const o=c(t,["aspectRatio"]);e!==void 0&&o!=null&&h(e,["parameters","aspectRatio"],o);const a=c(t,["guidanceScale"]);e!==void 0&&a!=null&&h(e,["parameters","guidanceScale"],a);const l=c(t,["seed"]);e!==void 0&&l!=null&&h(e,["parameters","seed"],l);const u=c(t,["safetyFilterLevel"]);e!==void 0&&u!=null&&h(e,["parameters","safetySetting"],u);const f=c(t,["personGeneration"]);e!==void 0&&f!=null&&h(e,["parameters","personGeneration"],f);const p=c(t,["includeSafetyAttributes"]);e!==void 0&&p!=null&&h(e,["parameters","includeSafetyAttributes"],p);const m=c(t,["includeRaiReason"]);e!==void 0&&m!=null&&h(e,["parameters","includeRaiReason"],m);const v=c(t,["language"]);e!==void 0&&v!=null&&h(e,["parameters","language"],v);const I=c(t,["outputMimeType"]);e!==void 0&&I!=null&&h(e,["parameters","outputOptions","mimeType"],I);const x=c(t,["outputCompressionQuality"]);e!==void 0&&x!=null&&h(e,["parameters","outputOptions","compressionQuality"],x);const M=c(t,["addWatermark"]);e!==void 0&&M!=null&&h(e,["parameters","addWatermark"],M);const A=c(t,["labels"]);e!==void 0&&A!=null&&h(e,["labels"],A);const T=c(t,["imageSize"]);e!==void 0&&T!=null&&h(e,["parameters","sampleImageSize"],T);const S=c(t,["enhancePrompt"]);return e!==void 0&&S!=null&&h(e,["parameters","enhancePrompt"],S),n}function XN(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],we(t,r));const i=c(e,["prompt"]);i!=null&&h(n,["instances[0]","prompt"],i);const s=c(e,["config"]);return s!=null&&YN(s,n),n}function ZN(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],we(t,r));const i=c(e,["prompt"]);i!=null&&h(n,["instances[0]","prompt"],i);const s=c(e,["config"]);return s!=null&&jN(s,n),n}function eD(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>hD(o))),h(e,["generatedImages"],s)}const i=c(t,["positivePromptSafetyAttributes"]);return i!=null&&h(e,["positivePromptSafetyAttributes"],AS(i)),e}function tD(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>Dd(o))),h(e,["generatedImages"],s)}const i=c(t,["positivePromptSafetyAttributes"]);return i!=null&&h(e,["positivePromptSafetyAttributes"],RS(i)),e}function nD(t,e){const n={},r=c(t,["numberOfVideos"]);if(e!==void 0&&r!=null&&h(e,["parameters","sampleCount"],r),c(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(c(t,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const i=c(t,["durationSeconds"]);if(e!==void 0&&i!=null&&h(e,["parameters","durationSeconds"],i),c(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const s=c(t,["aspectRatio"]);e!==void 0&&s!=null&&h(e,["parameters","aspectRatio"],s);const o=c(t,["resolution"]);e!==void 0&&o!=null&&h(e,["parameters","resolution"],o);const a=c(t,["personGeneration"]);if(e!==void 0&&a!=null&&h(e,["parameters","personGeneration"],a),c(t,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const l=c(t,["negativePrompt"]);e!==void 0&&l!=null&&h(e,["parameters","negativePrompt"],l);const u=c(t,["enhancePrompt"]);if(e!==void 0&&u!=null&&h(e,["parameters","enhancePrompt"],u),c(t,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const f=c(t,["lastFrame"]);e!==void 0&&f!=null&&h(e,["instances[0]","lastFrame"],Md(f));const p=c(t,["referenceImages"]);if(e!==void 0&&p!=null){let m=p;Array.isArray(m)&&(m=m.map(v=>tM(v))),h(e,["instances[0]","referenceImages"],m)}if(c(t,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(c(t,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return n}function rD(t,e){const n={},r=c(t,["numberOfVideos"]);e!==void 0&&r!=null&&h(e,["parameters","sampleCount"],r);const i=c(t,["outputGcsUri"]);e!==void 0&&i!=null&&h(e,["parameters","storageUri"],i);const s=c(t,["fps"]);e!==void 0&&s!=null&&h(e,["parameters","fps"],s);const o=c(t,["durationSeconds"]);e!==void 0&&o!=null&&h(e,["parameters","durationSeconds"],o);const a=c(t,["seed"]);e!==void 0&&a!=null&&h(e,["parameters","seed"],a);const l=c(t,["aspectRatio"]);e!==void 0&&l!=null&&h(e,["parameters","aspectRatio"],l);const u=c(t,["resolution"]);e!==void 0&&u!=null&&h(e,["parameters","resolution"],u);const f=c(t,["personGeneration"]);e!==void 0&&f!=null&&h(e,["parameters","personGeneration"],f);const p=c(t,["pubsubTopic"]);e!==void 0&&p!=null&&h(e,["parameters","pubsubTopic"],p);const m=c(t,["negativePrompt"]);e!==void 0&&m!=null&&h(e,["parameters","negativePrompt"],m);const v=c(t,["enhancePrompt"]);e!==void 0&&v!=null&&h(e,["parameters","enhancePrompt"],v);const I=c(t,["generateAudio"]);e!==void 0&&I!=null&&h(e,["parameters","generateAudio"],I);const x=c(t,["lastFrame"]);e!==void 0&&x!=null&&h(e,["instances[0]","lastFrame"],Dn(x));const M=c(t,["referenceImages"]);if(e!==void 0&&M!=null){let S=M;Array.isArray(S)&&(S=S.map(V=>nM(V))),h(e,["instances[0]","referenceImages"],S)}const A=c(t,["mask"]);e!==void 0&&A!=null&&h(e,["instances[0]","mask"],eM(A));const T=c(t,["compressionQuality"]);return e!==void 0&&T!=null&&h(e,["parameters","compressionQuality"],T),n}function iD(t){const e={},n=c(t,["name"]);n!=null&&h(e,["name"],n);const r=c(t,["metadata"]);r!=null&&h(e,["metadata"],r);const i=c(t,["done"]);i!=null&&h(e,["done"],i);const s=c(t,["error"]);s!=null&&h(e,["error"],s);const o=c(t,["response","generateVideoResponse"]);return o!=null&&h(e,["response"],lD(o)),e}function sD(t){const e={},n=c(t,["name"]);n!=null&&h(e,["name"],n);const r=c(t,["metadata"]);r!=null&&h(e,["metadata"],r);const i=c(t,["done"]);i!=null&&h(e,["done"],i);const s=c(t,["error"]);s!=null&&h(e,["error"],s);const o=c(t,["response"]);return o!=null&&h(e,["response"],uD(o)),e}function oD(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],we(t,r));const i=c(e,["prompt"]);i!=null&&h(n,["instances[0]","prompt"],i);const s=c(e,["image"]);s!=null&&h(n,["instances[0]","image"],Md(s));const o=c(e,["video"]);o!=null&&h(n,["instances[0]","video"],kS(o));const a=c(e,["source"]);a!=null&&cD(a,n);const l=c(e,["config"]);return l!=null&&nD(l,n),n}function aD(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],we(t,r));const i=c(e,["prompt"]);i!=null&&h(n,["instances[0]","prompt"],i);const s=c(e,["image"]);s!=null&&h(n,["instances[0]","image"],Dn(s));const o=c(e,["video"]);o!=null&&h(n,["instances[0]","video"],NS(o));const a=c(e,["source"]);a!=null&&dD(a,n);const l=c(e,["config"]);return l!=null&&rD(l,n),n}function lD(t){const e={},n=c(t,["generatedSamples"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>pD(o))),h(e,["generatedVideos"],s)}const r=c(t,["raiMediaFilteredCount"]);r!=null&&h(e,["raiMediaFilteredCount"],r);const i=c(t,["raiMediaFilteredReasons"]);return i!=null&&h(e,["raiMediaFilteredReasons"],i),e}function uD(t){const e={},n=c(t,["videos"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>mD(o))),h(e,["generatedVideos"],s)}const r=c(t,["raiMediaFilteredCount"]);r!=null&&h(e,["raiMediaFilteredCount"],r);const i=c(t,["raiMediaFilteredReasons"]);return i!=null&&h(e,["raiMediaFilteredReasons"],i),e}function cD(t,e){const n={},r=c(t,["prompt"]);e!==void 0&&r!=null&&h(e,["instances[0]","prompt"],r);const i=c(t,["image"]);e!==void 0&&i!=null&&h(e,["instances[0]","image"],Md(i));const s=c(t,["video"]);return e!==void 0&&s!=null&&h(e,["instances[0]","video"],kS(s)),n}function dD(t,e){const n={},r=c(t,["prompt"]);e!==void 0&&r!=null&&h(e,["instances[0]","prompt"],r);const i=c(t,["image"]);e!==void 0&&i!=null&&h(e,["instances[0]","image"],Dn(i));const s=c(t,["video"]);return e!==void 0&&s!=null&&h(e,["instances[0]","video"],NS(s)),n}function hD(t){const e={},n=c(t,["_self"]);n!=null&&h(e,["image"],ED(n));const r=c(t,["raiFilteredReason"]);r!=null&&h(e,["raiFilteredReason"],r);const i=c(t,["_self"]);return i!=null&&h(e,["safetyAttributes"],AS(i)),e}function Dd(t){const e={},n=c(t,["_self"]);n!=null&&h(e,["image"],CS(n));const r=c(t,["raiFilteredReason"]);r!=null&&h(e,["raiFilteredReason"],r);const i=c(t,["_self"]);i!=null&&h(e,["safetyAttributes"],RS(i));const s=c(t,["prompt"]);return s!=null&&h(e,["enhancedPrompt"],s),e}function fD(t){const e={},n=c(t,["_self"]);n!=null&&h(e,["mask"],CS(n));const r=c(t,["labels"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>s)),h(e,["labels"],i)}return e}function pD(t){const e={},n=c(t,["video"]);return n!=null&&h(e,["video"],XD(n)),e}function mD(t){const e={},n=c(t,["_self"]);return n!=null&&h(e,["video"],ZD(n)),e}function gD(t){const e={},n=c(t,["modelSelectionConfig"]);n!=null&&h(e,["modelConfig"],n);const r=c(t,["audioTimestamp"]);r!=null&&h(e,["audioTimestamp"],r);const i=c(t,["candidateCount"]);i!=null&&h(e,["candidateCount"],i);const s=c(t,["enableAffectiveDialog"]);s!=null&&h(e,["enableAffectiveDialog"],s);const o=c(t,["frequencyPenalty"]);o!=null&&h(e,["frequencyPenalty"],o);const a=c(t,["logprobs"]);a!=null&&h(e,["logprobs"],a);const l=c(t,["maxOutputTokens"]);l!=null&&h(e,["maxOutputTokens"],l);const u=c(t,["mediaResolution"]);u!=null&&h(e,["mediaResolution"],u);const f=c(t,["presencePenalty"]);f!=null&&h(e,["presencePenalty"],f);const p=c(t,["responseJsonSchema"]);p!=null&&h(e,["responseJsonSchema"],p);const m=c(t,["responseLogprobs"]);m!=null&&h(e,["responseLogprobs"],m);const v=c(t,["responseMimeType"]);v!=null&&h(e,["responseMimeType"],v);const I=c(t,["responseModalities"]);I!=null&&h(e,["responseModalities"],I);const x=c(t,["responseSchema"]);x!=null&&h(e,["responseSchema"],x);const M=c(t,["routingConfig"]);M!=null&&h(e,["routingConfig"],M);const A=c(t,["seed"]);A!=null&&h(e,["seed"],A);const T=c(t,["speechConfig"]);T!=null&&h(e,["speechConfig"],PS(T));const S=c(t,["stopSequences"]);S!=null&&h(e,["stopSequences"],S);const V=c(t,["temperature"]);V!=null&&h(e,["temperature"],V);const U=c(t,["thinkingConfig"]);U!=null&&h(e,["thinkingConfig"],U);const F=c(t,["topK"]);F!=null&&h(e,["topK"],F);const C=c(t,["topP"]);return C!=null&&h(e,["topP"],C),e}function _D(t,e){const n={},r=c(e,["model"]);return r!=null&&h(n,["_url","name"],we(t,r)),n}function yD(t,e){const n={},r=c(e,["model"]);return r!=null&&h(n,["_url","name"],we(t,r)),n}function vD(t){const e={};if(c(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=c(t,["enableWidget"]);return n!=null&&h(e,["enableWidget"],n),e}function TD(t){const e={},n=c(t,["timeRangeFilter"]);if(n!=null&&h(e,["timeRangeFilter"],n),c(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function ED(t){const e={},n=c(t,["bytesBase64Encoded"]);n!=null&&h(e,["imageBytes"],di(n));const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function CS(t){const e={},n=c(t,["gcsUri"]);n!=null&&h(e,["gcsUri"],n);const r=c(t,["bytesBase64Encoded"]);r!=null&&h(e,["imageBytes"],di(r));const i=c(t,["mimeType"]);return i!=null&&h(e,["mimeType"],i),e}function Md(t){const e={};if(c(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=c(t,["imageBytes"]);n!=null&&h(e,["bytesBase64Encoded"],di(n));const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function Dn(t){const e={},n=c(t,["gcsUri"]);n!=null&&h(e,["gcsUri"],n);const r=c(t,["imageBytes"]);r!=null&&h(e,["bytesBase64Encoded"],di(r));const i=c(t,["mimeType"]);return i!=null&&h(e,["mimeType"],i),e}function ID(t,e,n){const r={},i=c(e,["pageSize"]);n!==void 0&&i!=null&&h(n,["_query","pageSize"],i);const s=c(e,["pageToken"]);n!==void 0&&s!=null&&h(n,["_query","pageToken"],s);const o=c(e,["filter"]);n!==void 0&&o!=null&&h(n,["_query","filter"],o);const a=c(e,["queryBase"]);return n!==void 0&&a!=null&&h(n,["_url","models_url"],_S(t,a)),r}function wD(t,e,n){const r={},i=c(e,["pageSize"]);n!==void 0&&i!=null&&h(n,["_query","pageSize"],i);const s=c(e,["pageToken"]);n!==void 0&&s!=null&&h(n,["_query","pageToken"],s);const o=c(e,["filter"]);n!==void 0&&o!=null&&h(n,["_query","filter"],o);const a=c(e,["queryBase"]);return n!==void 0&&a!=null&&h(n,["_url","models_url"],_S(t,a)),r}function SD(t,e){const n={},r=c(e,["config"]);return r!=null&&ID(t,r,n),n}function CD(t,e){const n={},r=c(e,["config"]);return r!=null&&wD(t,r,n),n}function AD(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=c(t,["_self"]);if(i!=null){let s=yS(i);Array.isArray(s)&&(s=s.map(o=>lp(o))),h(e,["models"],s)}return e}function RD(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=c(t,["_self"]);if(i!=null){let s=yS(i);Array.isArray(s)&&(s=s.map(o=>up(o))),h(e,["models"],s)}return e}function PD(t){const e={},n=c(t,["maskMode"]);n!=null&&h(e,["maskMode"],n);const r=c(t,["segmentationClasses"]);r!=null&&h(e,["maskClasses"],r);const i=c(t,["maskDilation"]);return i!=null&&h(e,["dilation"],i),e}function lp(t){const e={},n=c(t,["name"]);n!=null&&h(e,["name"],n);const r=c(t,["displayName"]);r!=null&&h(e,["displayName"],r);const i=c(t,["description"]);i!=null&&h(e,["description"],i);const s=c(t,["version"]);s!=null&&h(e,["version"],s);const o=c(t,["_self"]);o!=null&&h(e,["tunedModelInfo"],$D(o));const a=c(t,["inputTokenLimit"]);a!=null&&h(e,["inputTokenLimit"],a);const l=c(t,["outputTokenLimit"]);l!=null&&h(e,["outputTokenLimit"],l);const u=c(t,["supportedGenerationMethods"]);return u!=null&&h(e,["supportedActions"],u),e}function up(t){const e={},n=c(t,["name"]);n!=null&&h(e,["name"],n);const r=c(t,["displayName"]);r!=null&&h(e,["displayName"],r);const i=c(t,["description"]);i!=null&&h(e,["description"],i);const s=c(t,["versionId"]);s!=null&&h(e,["version"],s);const o=c(t,["deployedModels"]);if(o!=null){let p=o;Array.isArray(p)&&(p=p.map(m=>HN(m))),h(e,["endpoints"],p)}const a=c(t,["labels"]);a!=null&&h(e,["labels"],a);const l=c(t,["_self"]);l!=null&&h(e,["tunedModelInfo"],zD(l));const u=c(t,["defaultCheckpointId"]);u!=null&&h(e,["defaultCheckpointId"],u);const f=c(t,["checkpoints"]);if(f!=null){let p=f;Array.isArray(p)&&(p=p.map(m=>m)),h(e,["checkpoints"],p)}return e}function xD(t){const e={},n=c(t,["videoMetadata"]);n!=null&&h(e,["videoMetadata"],n);const r=c(t,["thought"]);r!=null&&h(e,["thought"],r);const i=c(t,["inlineData"]);i!=null&&h(e,["inlineData"],yN(i));const s=c(t,["fileData"]);s!=null&&h(e,["fileData"],KN(s));const o=c(t,["thoughtSignature"]);o!=null&&h(e,["thoughtSignature"],o);const a=c(t,["functionCall"]);a!=null&&h(e,["functionCall"],a);const l=c(t,["codeExecutionResult"]);l!=null&&h(e,["codeExecutionResult"],l);const u=c(t,["executableCode"]);u!=null&&h(e,["executableCode"],u);const f=c(t,["functionResponse"]);f!=null&&h(e,["functionResponse"],f);const p=c(t,["text"]);return p!=null&&h(e,["text"],p),e}function kD(t){const e={},n=c(t,["productImage"]);return n!=null&&h(e,["image"],Dn(n)),e}function ND(t,e){const n={},r=c(t,["numberOfImages"]);e!==void 0&&r!=null&&h(e,["parameters","sampleCount"],r);const i=c(t,["baseSteps"]);e!==void 0&&i!=null&&h(e,["parameters","editConfig","baseSteps"],i);const s=c(t,["outputGcsUri"]);e!==void 0&&s!=null&&h(e,["parameters","storageUri"],s);const o=c(t,["seed"]);e!==void 0&&o!=null&&h(e,["parameters","seed"],o);const a=c(t,["safetyFilterLevel"]);e!==void 0&&a!=null&&h(e,["parameters","safetySetting"],a);const l=c(t,["personGeneration"]);e!==void 0&&l!=null&&h(e,["parameters","personGeneration"],l);const u=c(t,["addWatermark"]);e!==void 0&&u!=null&&h(e,["parameters","addWatermark"],u);const f=c(t,["outputMimeType"]);e!==void 0&&f!=null&&h(e,["parameters","outputOptions","mimeType"],f);const p=c(t,["outputCompressionQuality"]);e!==void 0&&p!=null&&h(e,["parameters","outputOptions","compressionQuality"],p);const m=c(t,["enhancePrompt"]);e!==void 0&&m!=null&&h(e,["parameters","enhancePrompt"],m);const v=c(t,["labels"]);return e!==void 0&&v!=null&&h(e,["labels"],v),n}function DD(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],we(t,r));const i=c(e,["source"]);i!=null&&VD(i,n);const s=c(e,["config"]);return s!=null&&ND(s,n),n}function MD(t){const e={},n=c(t,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>Dd(i))),h(e,["generatedImages"],r)}return e}function VD(t,e){const n={},r=c(t,["prompt"]);e!==void 0&&r!=null&&h(e,["instances[0]","prompt"],r);const i=c(t,["personImage"]);e!==void 0&&i!=null&&h(e,["instances[0]","personImage","image"],Dn(i));const s=c(t,["productImages"]);if(e!==void 0&&s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>kD(a))),h(e,["instances[0]","productImages"],o)}return n}function bD(t){const e={},n=c(t,["referenceImage"]);n!=null&&h(e,["referenceImage"],Dn(n));const r=c(t,["referenceId"]);r!=null&&h(e,["referenceId"],r);const i=c(t,["referenceType"]);i!=null&&h(e,["referenceType"],i);const s=c(t,["maskImageConfig"]);s!=null&&h(e,["maskImageConfig"],PD(s));const o=c(t,["controlImageConfig"]);o!=null&&h(e,["controlImageConfig"],CN(o));const a=c(t,["styleImageConfig"]);a!=null&&h(e,["styleImageConfig"],a);const l=c(t,["subjectImageConfig"]);return l!=null&&h(e,["subjectImageConfig"],l),e}function AS(t){const e={},n=c(t,["safetyAttributes","categories"]);n!=null&&h(e,["categories"],n);const r=c(t,["safetyAttributes","scores"]);r!=null&&h(e,["scores"],r);const i=c(t,["contentType"]);return i!=null&&h(e,["contentType"],i),e}function RS(t){const e={},n=c(t,["safetyAttributes","categories"]);n!=null&&h(e,["categories"],n);const r=c(t,["safetyAttributes","scores"]);r!=null&&h(e,["scores"],r);const i=c(t,["contentType"]);return i!=null&&h(e,["contentType"],i),e}function LD(t){const e={};if(c(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=c(t,["category"]);n!=null&&h(e,["category"],n);const r=c(t,["threshold"]);return r!=null&&h(e,["threshold"],r),e}function FD(t){const e={},n=c(t,["image"]);return n!=null&&h(e,["image"],Dn(n)),e}function UD(t,e){const n={},r=c(t,["mode"]);e!==void 0&&r!=null&&h(e,["parameters","mode"],r);const i=c(t,["maxPredictions"]);e!==void 0&&i!=null&&h(e,["parameters","maxPredictions"],i);const s=c(t,["confidenceThreshold"]);e!==void 0&&s!=null&&h(e,["parameters","confidenceThreshold"],s);const o=c(t,["maskDilation"]);e!==void 0&&o!=null&&h(e,["parameters","maskDilation"],o);const a=c(t,["binaryColorThreshold"]);e!==void 0&&a!=null&&h(e,["parameters","binaryColorThreshold"],a);const l=c(t,["labels"]);return e!==void 0&&l!=null&&h(e,["labels"],l),n}function OD(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],we(t,r));const i=c(e,["source"]);i!=null&&GD(i,n);const s=c(e,["config"]);return s!=null&&UD(s,n),n}function BD(t){const e={},n=c(t,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>fD(i))),h(e,["generatedMasks"],r)}return e}function GD(t,e){const n={},r=c(t,["prompt"]);e!==void 0&&r!=null&&h(e,["instances[0]","prompt"],r);const i=c(t,["image"]);e!==void 0&&i!=null&&h(e,["instances[0]","image"],Dn(i));const s=c(t,["scribbleImage"]);return e!==void 0&&s!=null&&h(e,["instances[0]","scribble"],FD(s)),n}function PS(t){const e={},n=c(t,["voiceConfig"]);if(n!=null&&h(e,["voiceConfig"],n),c(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const r=c(t,["languageCode"]);return r!=null&&h(e,["languageCode"],r),e}function qD(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(f=>f)),h(e,["functionDeclarations"],u)}if(c(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=c(t,["googleSearch"]);r!=null&&h(e,["googleSearch"],TD(r));const i=c(t,["googleSearchRetrieval"]);if(i!=null&&h(e,["googleSearchRetrieval"],i),c(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=c(t,["googleMaps"]);s!=null&&h(e,["googleMaps"],vD(s));const o=c(t,["urlContext"]);o!=null&&h(e,["urlContext"],o);const a=c(t,["computerUse"]);a!=null&&h(e,["computerUse"],a);const l=c(t,["codeExecution"]);return l!=null&&h(e,["codeExecution"],l),e}function xS(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let p=n;Array.isArray(p)&&(p=p.map(m=>WN(m))),h(e,["functionDeclarations"],p)}const r=c(t,["retrieval"]);r!=null&&h(e,["retrieval"],r);const i=c(t,["googleSearch"]);i!=null&&h(e,["googleSearch"],i);const s=c(t,["googleSearchRetrieval"]);s!=null&&h(e,["googleSearchRetrieval"],s);const o=c(t,["enterpriseWebSearch"]);o!=null&&h(e,["enterpriseWebSearch"],o);const a=c(t,["googleMaps"]);a!=null&&h(e,["googleMaps"],a);const l=c(t,["urlContext"]);l!=null&&h(e,["urlContext"],l);const u=c(t,["computerUse"]);u!=null&&h(e,["computerUse"],u);const f=c(t,["codeExecution"]);return f!=null&&h(e,["codeExecution"],f),e}function $D(t){const e={},n=c(t,["baseModel"]);n!=null&&h(e,["baseModel"],n);const r=c(t,["createTime"]);r!=null&&h(e,["createTime"],r);const i=c(t,["updateTime"]);return i!=null&&h(e,["updateTime"],i),e}function zD(t){const e={},n=c(t,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&h(e,["baseModel"],n);const r=c(t,["createTime"]);r!=null&&h(e,["createTime"],r);const i=c(t,["updateTime"]);return i!=null&&h(e,["updateTime"],i),e}function HD(t,e){const n={},r=c(t,["displayName"]);e!==void 0&&r!=null&&h(e,["displayName"],r);const i=c(t,["description"]);e!==void 0&&i!=null&&h(e,["description"],i);const s=c(t,["defaultCheckpointId"]);return e!==void 0&&s!=null&&h(e,["defaultCheckpointId"],s),n}function KD(t,e){const n={},r=c(t,["displayName"]);e!==void 0&&r!=null&&h(e,["displayName"],r);const i=c(t,["description"]);e!==void 0&&i!=null&&h(e,["description"],i);const s=c(t,["defaultCheckpointId"]);return e!==void 0&&s!=null&&h(e,["defaultCheckpointId"],s),n}function WD(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","name"],we(t,r));const i=c(e,["config"]);return i!=null&&HD(i,n),n}function JD(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],we(t,r));const i=c(e,["config"]);return i!=null&&KD(i,n),n}function QD(t,e){const n={},r=c(t,["outputGcsUri"]);e!==void 0&&r!=null&&h(e,["parameters","storageUri"],r);const i=c(t,["includeRaiReason"]);e!==void 0&&i!=null&&h(e,["parameters","includeRaiReason"],i);const s=c(t,["outputMimeType"]);e!==void 0&&s!=null&&h(e,["parameters","outputOptions","mimeType"],s);const o=c(t,["outputCompressionQuality"]);e!==void 0&&o!=null&&h(e,["parameters","outputOptions","compressionQuality"],o);const a=c(t,["enhanceInputImage"]);e!==void 0&&a!=null&&h(e,["parameters","upscaleConfig","enhanceInputImage"],a);const l=c(t,["imagePreservationFactor"]);e!==void 0&&l!=null&&h(e,["parameters","upscaleConfig","imagePreservationFactor"],l);const u=c(t,["labels"]);e!==void 0&&u!=null&&h(e,["labels"],u);const f=c(t,["numberOfImages"]);e!==void 0&&f!=null&&h(e,["parameters","sampleCount"],f);const p=c(t,["mode"]);return e!==void 0&&p!=null&&h(e,["parameters","mode"],p),n}function YD(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["_url","model"],we(t,r));const i=c(e,["image"]);i!=null&&h(n,["instances[0]","image"],Dn(i));const s=c(e,["upscaleFactor"]);s!=null&&h(n,["parameters","upscaleConfig","upscaleFactor"],s);const o=c(e,["config"]);return o!=null&&QD(o,n),n}function jD(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>Dd(s))),h(e,["generatedImages"],i)}return e}function XD(t){const e={},n=c(t,["uri"]);n!=null&&h(e,["uri"],n);const r=c(t,["encodedVideo"]);r!=null&&h(e,["videoBytes"],di(r));const i=c(t,["encoding"]);return i!=null&&h(e,["mimeType"],i),e}function ZD(t){const e={},n=c(t,["gcsUri"]);n!=null&&h(e,["uri"],n);const r=c(t,["bytesBase64Encoded"]);r!=null&&h(e,["videoBytes"],di(r));const i=c(t,["mimeType"]);return i!=null&&h(e,["mimeType"],i),e}function eM(t){const e={},n=c(t,["image"]);n!=null&&h(e,["_self"],Dn(n));const r=c(t,["maskMode"]);return r!=null&&h(e,["maskMode"],r),e}function tM(t){const e={},n=c(t,["image"]);n!=null&&h(e,["image"],Md(n));const r=c(t,["referenceType"]);return r!=null&&h(e,["referenceType"],r),e}function nM(t){const e={},n=c(t,["image"]);n!=null&&h(e,["image"],Dn(n));const r=c(t,["referenceType"]);return r!=null&&h(e,["referenceType"],r),e}function kS(t){const e={},n=c(t,["uri"]);n!=null&&h(e,["uri"],n);const r=c(t,["videoBytes"]);r!=null&&h(e,["encodedVideo"],di(r));const i=c(t,["mimeType"]);return i!=null&&h(e,["encoding"],i),e}function NS(t){const e={},n=c(t,["uri"]);n!=null&&h(e,["gcsUri"],n);const r=c(t,["videoBytes"]);r!=null&&h(e,["bytesBase64Encoded"],di(r));const i=c(t,["mimeType"]);return i!=null&&h(e,["mimeType"],i),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const rM="Content-Type",iM="X-Server-Timeout",sM="User-Agent",cp="x-goog-api-client",oM="1.25.0",aM=`google-genai-sdk/${oM}`,lM="v1beta1",uM="v1beta",Wv=/^\s*data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class cM{constructor(e){var n,r;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const i={};this.clientOptions.vertexai?(i.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:lM,i.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(i.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:uM,i.baseUrl="https://generativelanguage.googleapis.com/"),i.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=i,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(i,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&r.push(e.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),n=new URL(e);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,n,r){const i=[this.getRequestUrlInternal(n)];return r&&i.push(this.getBaseResourcePath()),e!==""&&i.push(e),new URL(`${i.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,n,r);if(e.queryParams)for(const[o,a]of Object.entries(e.queryParams))i.searchParams.append(o,String(a));let s={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else s.body=e.body;return s=await this.includeExtraHttpOptionsToRequestInit(s,n,e.abortSignal),this.unaryApiCall(i,s,e.httpMethod)}patchHttpOptions(e,n){const r=JSON.parse(JSON.stringify(e));for(const[i,s]of Object.entries(n))typeof s=="object"?r[i]=Object.assign(Object.assign({},r[i]),s):s!==void 0&&(r[i]=s);return r}async requestStream(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,n,r);(!i.searchParams.has("alt")||i.searchParams.get("alt")!=="sse")&&i.searchParams.set("alt","sse");let s={};return s.body=e.body,s=await this.includeExtraHttpOptionsToRequestInit(s,n,e.abortSignal),this.streamApiCall(i,s,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,n,r){if(n&&n.timeout||r){const i=new AbortController,s=i.signal;if(n.timeout&&(n==null?void 0:n.timeout)>0){const o=setTimeout(()=>i.abort(),n.timeout);o&&typeof o.unref=="function"&&o.unref()}r&&r.addEventListener("abort",()=>{i.abort()}),e.signal=s}return n&&n.extraBody!==null&&dM(e,n.extraBody),e.headers=await this.getHeadersInternal(n),e}async unaryApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async i=>(await Jv(i),new sp(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}async streamApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async i=>(await Jv(i),this.processStreamResponse(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}processStreamResponse(e){var n;return Xs(this,arguments,function*(){const i=(n=e==null?void 0:e.body)===null||n===void 0?void 0:n.getReader(),s=new TextDecoder("utf-8");if(!i)throw new Error("Response body is empty");try{let o="";for(;;){const{done:a,value:l}=yield Oe(i.read());if(a){if(o.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const u=s.decode(l,{stream:!0});try{const p=JSON.parse(u);if("error"in p){const m=JSON.parse(JSON.stringify(p.error)),v=m.status,I=m.code,x=`got status: ${v}. ${JSON.stringify(p)}`;if(I>=400&&I<600)throw new kd({message:x,status:I})}}catch(p){if(p.name==="ApiError")throw p}o+=u;let f=o.match(Wv);for(;f;){const p=f[1];try{const m=new Response(p,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield Oe(new sp(m)),o=o.slice(f[0].length),f=o.match(Wv)}catch(m){throw new Error(`exception parsing stream chunk ${p}. ${m}`)}}}}finally{i.releaseLock()}})}async apiCall(e,n){return fetch(e,n).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const e={},n=aM+" "+this.clientOptions.userAgentExtra;return e[sM]=n,e[cp]=n,e[rM]="application/json",e}async getHeadersInternal(e){const n=new Headers;if(e&&e.headers){for(const[r,i]of Object.entries(e.headers))n.append(r,i);e.timeout&&e.timeout>0&&n.append(iM,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(n),n}async uploadFile(e,n){var r;const i={};n!=null&&(i.mimeType=n.mimeType,i.name=n.name,i.displayName=n.displayName),i.name&&!i.name.startsWith("files/")&&(i.name=`files/${i.name}`);const s=this.clientOptions.uploader,o=await s.stat(e);i.sizeBytes=String(o.size);const a=(r=n==null?void 0:n.mimeType)!==null&&r!==void 0?r:o.type;if(a===void 0||a==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");i.mimeType=a;const l=await this.fetchUploadUrl(i,n);return s.upload(e,l,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,n){var r;let i={};n!=null&&n.httpOptions?i=n.httpOptions:i={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};const s={file:e},o=await this.request({path:X("upload/v1beta/files",s._url),body:JSON.stringify(s),httpMethod:"POST",httpOptions:i});if(!o||!(o!=null&&o.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const a=(r=o==null?void 0:o.headers)===null||r===void 0?void 0:r["x-goog-upload-url"];if(a===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return a}}async function Jv(t){var e;if(t===void 0)throw new Error("response is undefined");if(!t.ok){const n=t.status;let r;!((e=t.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?r=await t.json():r={error:{message:await t.text(),code:t.status,status:t.statusText}};const i=JSON.stringify(r);throw n>=400&&n<600?new kd({message:i,status:n}):new Error(i)}}function dM(t,e){if(!e||Object.keys(e).length===0)return;if(t.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let n={};if(typeof t.body=="string"&&t.body.length>0)try{const s=JSON.parse(t.body);if(typeof s=="object"&&s!==null&&!Array.isArray(s))n=s;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function r(s,o){const a=Object.assign({},s);for(const l in o)if(Object.prototype.hasOwnProperty.call(o,l)){const u=o[l],f=a[l];u&&typeof u=="object"&&!Array.isArray(u)&&f&&typeof f=="object"&&!Array.isArray(f)?a[l]=r(f,u):(f&&u&&typeof f!=typeof u&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${l}". Original type: ${typeof f}, New type: ${typeof u}. Overwriting.`),a[l]=u)}return a}const i=r(n,e);t.body=JSON.stringify(i)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const hM="mcp_used/unknown";let fM=!1;function DS(t){for(const e of t)if(pM(e)||typeof e=="object"&&"inputSchema"in e)return!0;return fM}function MS(t){var e;const n=(e=t[cp])!==null&&e!==void 0?e:"";t[cp]=(n+` ${hM}`).trimStart()}function pM(t){return t!==null&&typeof t=="object"&&t instanceof zm}function mM(t,e=100){return Xs(this,arguments,function*(){let r,i=0;for(;i<e;){const s=yield Oe(t.listTools({cursor:r}));for(const o of s.tools)yield yield Oe(o),i++;if(!s.nextCursor)break;r=s.nextCursor}})}class zm{constructor(e=[],n){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=n}static create(e,n){return new zm(e,n)}async initialize(){var e,n,r,i;if(this.mcpTools.length>0)return;const s={},o=[];for(const f of this.mcpClients)try{for(var a=!0,l=(n=void 0,Fa(mM(f))),u;u=await l.next(),e=u.done,!e;a=!0){i=u.value,a=!1;const p=i;o.push(p);const m=p.name;if(s[m])throw new Error(`Duplicate function name ${m} found in MCP tools. Please ensure function names are unique.`);s[m]=f}}catch(p){n={error:p}}finally{try{!a&&!e&&(r=l.return)&&await r.call(l)}finally{if(n)throw n.error}}this.mcpTools=o,this.functionNameToMcpClient=s}async tool(){return await this.initialize(),Tk(this.mcpTools,this.config)}async callTool(e){await this.initialize();const n=[];for(const r of e)if(r.name in this.functionNameToMcpClient){const i=this.functionNameToMcpClient[r.name];let s;this.config.timeout&&(s={timeout:this.config.timeout});const o=await i.callTool({name:r.name,arguments:r.args},void 0,s);n.push({functionResponse:{name:r.name,response:o.isError?{error:o}:o}})}return n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function gM(t,e,n){const r=new hk;let i;n.data instanceof Blob?i=JSON.parse(await n.data.text()):i=JSON.parse(n.data),Object.assign(r,i),e(r)}class _M{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r}async connect(e){var n,r;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const i=this.apiClient.getWebsocketBaseUrl(),s=this.apiClient.getApiVersion(),o=TM(this.apiClient.getDefaultHeaders()),a=this.apiClient.getApiKey(),l=`${i}/ws/google.ai.generativelanguage.${s}.GenerativeService.BidiGenerateMusic?key=${a}`;let u=()=>{};const f=new Promise(S=>{u=S}),p=e.callbacks,m=function(){u({})},v=this.apiClient,I={onopen:m,onmessage:S=>{gM(v,p.onmessage,S)},onerror:(n=p==null?void 0:p.onerror)!==null&&n!==void 0?n:function(S){},onclose:(r=p==null?void 0:p.onclose)!==null&&r!==void 0?r:function(S){}},x=this.webSocketFactory.create(l,vM(o),I);x.connect(),await f;const T={setup:{model:we(this.apiClient,e.model)}};return x.send(JSON.stringify(T)),new yM(x,this.apiClient)}}class yM{constructor(e,n){this.conn=e,this.apiClient=n}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const n=uN(e);this.conn.send(JSON.stringify({clientContent:n}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const n=lN(e);this.conn.send(JSON.stringify(n))}sendPlaybackControl(e){const n={playbackControl:e};this.conn.send(JSON.stringify(n))}play(){this.sendPlaybackControl($s.PLAY)}pause(){this.sendPlaybackControl($s.PAUSE)}stop(){this.sendPlaybackControl($s.STOP)}resetContext(){this.sendPlaybackControl($s.RESET_CONTEXT)}close(){this.conn.close()}}function vM(t){const e={};return t.forEach((n,r)=>{e[r]=n}),e}function TM(t){const e=new Headers;for(const[n,r]of Object.entries(t))e.append(n,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const EM="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function IM(t,e,n){const r=new dk;let i;n.data instanceof Blob?i=await n.data.text():n.data instanceof ArrayBuffer?i=new TextDecoder().decode(n.data):i=n.data;const s=JSON.parse(i);if(t.isVertexAI()){const o=hN(s);Object.assign(r,o)}else Object.assign(r,s);e(r)}class wM{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r,this.music=new _M(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var n,r,i,s,o,a;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const l=this.apiClient.getWebsocketBaseUrl(),u=this.apiClient.getApiVersion();let f;const p=this.apiClient.getHeaders();e.config&&e.config.tools&&DS(e.config.tools)&&MS(p);const m=RM(p);if(this.apiClient.isVertexAI())f=`${l}/ws/google.cloud.aiplatform.${u}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(m);else{const R=this.apiClient.getApiKey();let P="BidiGenerateContent",N="key";R!=null&&R.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),u!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),P="BidiGenerateContentConstrained",N="access_token"),f=`${l}/ws/google.ai.generativelanguage.${u}.GenerativeService.${P}?${N}=${R}`}let v=()=>{};const I=new Promise(R=>{v=R}),x=e.callbacks,M=function(){var R;(R=x==null?void 0:x.onopen)===null||R===void 0||R.call(x),v({})},A=this.apiClient,T={onopen:M,onmessage:R=>{IM(A,x.onmessage,R)},onerror:(n=x==null?void 0:x.onerror)!==null&&n!==void 0?n:function(R){},onclose:(r=x==null?void 0:x.onclose)!==null&&r!==void 0?r:function(R){}},S=this.webSocketFactory.create(f,AM(m),T);S.connect(),await I;let V=we(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&V.startsWith("publishers/")){const R=this.apiClient.getProject(),P=this.apiClient.getLocation();V=`projects/${R}/locations/${P}/`+V}let U={};this.apiClient.isVertexAI()&&((i=e.config)===null||i===void 0?void 0:i.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[Bc.AUDIO]}:e.config.responseModalities=[Bc.AUDIO]),!((s=e.config)===null||s===void 0)&&s.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const F=(a=(o=e.config)===null||o===void 0?void 0:o.tools)!==null&&a!==void 0?a:[],C=[];for(const R of F)if(this.isCallableTool(R)){const P=R;C.push(await P.tool())}else C.push(R);C.length>0&&(e.config.tools=C);const E={model:V,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?U=aN(this.apiClient,E):U=oN(this.apiClient,E),delete U.config,S.send(JSON.stringify(U)),new CM(S,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const SM={turnComplete:!0};class CM{constructor(e,n){this.conn=e,this.apiClient=n}tLiveClientContent(e,n){if(n.turns!==null&&n.turns!==void 0){let r=[];try{r=fn(n.turns),e.isVertexAI()||(r=r.map(i=>Nd(i)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:r,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(e,n){let r=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?r=n.functionResponses:r=[n.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const s of r){if(typeof s!="object"||s===null||!("name"in s)||!("response"in s))throw new Error(`Could not parse function response, type '${typeof s}'.`);if(!e.isVertexAI()&&!("id"in s))throw new Error(EM)}return{toolResponse:{functionResponses:r}}}sendClientContent(e){e=Object.assign(Object.assign({},SM),e);const n=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(n))}sendRealtimeInput(e){let n={};this.apiClient.isVertexAI()?n={realtimeInput:dN(e)}:n={realtimeInput:cN(e)},this.conn.send(JSON.stringify(n))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function AM(t){const e={};return t.forEach((n,r)=>{e[r]=n}),e}function RM(t){const e=new Headers;for(const[n,r]of Object.entries(t))e.append(n,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Qv=10;function Yv(t){var e,n,r;if(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let i=!1;for(const o of(n=t==null?void 0:t.tools)!==null&&n!==void 0?n:[])if(Zs(o)){i=!0;break}if(!i)return!0;const s=(r=t==null?void 0:t.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls;return s&&(s<0||!Number.isInteger(s))||s==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",s),!0):!1}function Zs(t){return"callTool"in t&&typeof t.callTool=="function"}function PM(t){var e,n,r;return(r=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(i=>Zs(i)))!==null&&r!==void 0?r:!1}function xM(t){var e,n,r;return(r=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(i=>!Zs(i)))!==null&&r!==void 0?r:!1}function jv(t){var e;return!(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class kM extends ls{constructor(e){super(),this.apiClient=e,this.generateContent=async n=>{var r,i,s,o,a;const l=await this.processParamsMaybeAddMcpUsage(n);if(this.maybeMoveToResponseJsonSchem(n),!PM(n)||Yv(n.config))return await this.generateContentInternal(l);if(xM(n))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");let u,f;const p=fn(l.contents),m=(s=(i=(r=l.config)===null||r===void 0?void 0:r.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&s!==void 0?s:Qv;let v=0;for(;v<m&&(u=await this.generateContentInternal(l),!(!u.functionCalls||u.functionCalls.length===0));){const I=u.candidates[0].content,x=[];for(const M of(a=(o=n.config)===null||o===void 0?void 0:o.tools)!==null&&a!==void 0?a:[])if(Zs(M)){const T=await M.callTool(u.functionCalls);x.push(...T)}v++,f={role:"user",parts:x},l.contents=fn(l.contents),l.contents.push(I),l.contents.push(f),jv(l.config)&&(p.push(I),p.push(f))}return jv(l.config)&&(u.automaticFunctionCallingHistory=p),u},this.generateContentStream=async n=>{if(this.maybeMoveToResponseJsonSchem(n),Yv(n.config)){const r=await this.processParamsMaybeAddMcpUsage(n);return await this.generateContentStreamInternal(r)}else return await this.processAfcStream(n)},this.generateImages=async n=>await this.generateImagesInternal(n).then(r=>{var i;let s;const o=[];if(r!=null&&r.generatedImages)for(const l of r.generatedImages)l&&(l!=null&&l.safetyAttributes)&&((i=l==null?void 0:l.safetyAttributes)===null||i===void 0?void 0:i.contentType)==="Positive Prompt"?s=l==null?void 0:l.safetyAttributes:o.push(l);let a;return s?a={generatedImages:o,positivePromptSafetyAttributes:s,sdkHttpResponse:r.sdkHttpResponse}:a={generatedImages:o,sdkHttpResponse:r.sdkHttpResponse},a}),this.list=async n=>{var r;const o={config:Object.assign(Object.assign({},{queryBase:!0}),n==null?void 0:n.config)};if(this.apiClient.isVertexAI()&&!o.config.queryBase){if(!((r=o.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");o.config.filter="labels.tune-type:*"}return new kl(Yi.PAGED_ITEM_MODELS,a=>this.listInternal(a),await this.listInternal(o),o)},this.editImage=async n=>{const r={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(r.referenceImages=n.referenceImages.map(i=>i.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async n=>{let r={numberOfImages:1,mode:"upscale"};n.config&&(r=Object.assign(Object.assign({},r),n.config));const i={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:r};return await this.upscaleImageInternal(i)},this.generateVideos=async n=>{var r,i,s,o,a,l;if((n.prompt||n.image||n.video)&&n.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((r=n.video)===null||r===void 0)&&r.uri&&(!((i=n.video)===null||i===void 0)&&i.videoBytes)?n.video={uri:n.video.uri,mimeType:n.video.mimeType}:!((o=(s=n.source)===null||s===void 0?void 0:s.video)===null||o===void 0)&&o.uri&&(!((l=(a=n.source)===null||a===void 0?void 0:a.video)===null||l===void 0)&&l.videoBytes)&&(n.source.video={uri:n.source.video.uri,mimeType:n.source.video.mimeType})),await this.generateVideosInternal(n)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var n,r,i;const s=(n=e.config)===null||n===void 0?void 0:n.tools;if(!s)return e;const o=await Promise.all(s.map(async l=>Zs(l)?await l.tool():l)),a={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:o})};if(a.config.tools=o,e.config&&e.config.tools&&DS(e.config.tools)){const l=(i=(r=e.config.httpOptions)===null||r===void 0?void 0:r.headers)!==null&&i!==void 0?i:{};let u=Object.assign({},l);Object.keys(u).length===0&&(u=this.apiClient.getDefaultHeaders()),MS(u),a.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:u})}return a}async initAfcToolsMap(e){var n,r,i;const s=new Map;for(const o of(r=(n=e.config)===null||n===void 0?void 0:n.tools)!==null&&r!==void 0?r:[])if(Zs(o)){const a=o,l=await a.tool();for(const u of(i=l.functionDeclarations)!==null&&i!==void 0?i:[]){if(!u.name)throw new Error("Function declaration name is required.");if(s.has(u.name))throw new Error(`Duplicate tool declaration name: ${u.name}`);s.set(u.name,a)}}return s}async processAfcStream(e){var n,r,i;const s=(i=(r=(n=e.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&i!==void 0?i:Qv;let o=!1,a=0;const l=await this.initAfcToolsMap(e);return function(u,f,p){var m,v;return Xs(this,arguments,function*(){for(var I,x,M,A;a<s;){o&&(a++,o=!1);const U=yield Oe(u.processParamsMaybeAddMcpUsage(p)),F=yield Oe(u.generateContentStreamInternal(U)),C=[],E=[];try{for(var T=!0,S=(x=void 0,Fa(F)),V;V=yield Oe(S.next()),I=V.done,!I;T=!0){A=V.value,T=!1;const R=A;if(yield yield Oe(R),R.candidates&&(!((m=R.candidates[0])===null||m===void 0)&&m.content)){E.push(R.candidates[0].content);for(const P of(v=R.candidates[0].content.parts)!==null&&v!==void 0?v:[])if(a<s&&P.functionCall){if(!P.functionCall.name)throw new Error("Function call name was not returned by the model.");if(f.has(P.functionCall.name)){const N=yield Oe(f.get(P.functionCall.name).callTool([P.functionCall]));C.push(...N)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${f.keys()}, mising tool: ${P.functionCall.name}`)}}}}catch(R){x={error:R}}finally{try{!T&&!I&&(M=S.return)&&(yield Oe(M.call(S)))}finally{if(x)throw x.error}}if(C.length>0){o=!0;const R=new pa;R.candidates=[{content:{role:"user",parts:C}}],yield yield Oe(R);const P=[];P.push(...E),P.push({role:"user",parts:C});const N=fn(p.contents).concat(P);p.contents=N}else break}})}(this,l,e)}async generateContentInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=zv(this.apiClient,e);return a=X("{model}:generateContent",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:f.headers},m})),o.then(f=>{const p=Kv(f),m=new pa;return Object.assign(m,p),m})}else{const u=$v(this.apiClient,e);return a=X("{model}:generateContent",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:f.headers},m})),o.then(f=>{const p=Hv(f),m=new pa;return Object.assign(m,p),m})}}async generateContentStreamInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=zv(this.apiClient,e);return a=X("{model}:streamGenerateContent?alt=sse",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.requestStream({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}),o.then(function(p){return Xs(this,arguments,function*(){var m,v,I,x;try{for(var M=!0,A=Fa(p),T;T=yield Oe(A.next()),m=T.done,!m;M=!0){x=T.value,M=!1;const S=x,V=Kv(yield Oe(S.json()));V.sdkHttpResponse={headers:S.headers};const U=new pa;Object.assign(U,V),yield yield Oe(U)}}catch(S){v={error:S}}finally{try{!M&&!m&&(I=A.return)&&(yield Oe(I.call(A)))}finally{if(v)throw v.error}}})})}else{const u=$v(this.apiClient,e);return a=X("{model}:streamGenerateContent?alt=sse",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.requestStream({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}),o.then(function(p){return Xs(this,arguments,function*(){var m,v,I,x;try{for(var M=!0,A=Fa(p),T;T=yield Oe(A.next()),m=T.done,!m;M=!0){x=T.value,M=!1;const S=x,V=Hv(yield Oe(S.json()));V.sdkHttpResponse={headers:S.headers};const U=new pa;Object.assign(U,V),yield yield Oe(U)}}catch(S){v={error:S}}finally{try{!M&&!m&&(I=A.return)&&(yield Oe(I.call(A)))}finally{if(v)throw v.error}}})})}}async embedContent(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=qN(this.apiClient,e);return a=X("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:f.headers},m})),o.then(f=>{const p=zN(f),m=new Rv;return Object.assign(m,p),m})}else{const u=GN(this.apiClient,e);return a=X("{model}:batchEmbedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:f.headers},m})),o.then(f=>{const p=$N(f),m=new Rv;return Object.assign(m,p),m})}}async generateImagesInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=ZN(this.apiClient,e);return a=X("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:f.headers},m})),o.then(f=>{const p=tD(f),m=new Pv;return Object.assign(m,p),m})}else{const u=XN(this.apiClient,e);return a=X("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:f.headers},m})),o.then(f=>{const p=eD(f),m=new Pv;return Object.assign(m,p),m})}}async editImageInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=FN(this.apiClient,e);return s=X("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>{const u=UN(l),f=new rk;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=YD(this.apiClient,e);return s=X("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>{const u=jD(l),f=new ik;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=DD(this.apiClient,e);return s=X("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=MD(l),f=new sk;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=OD(this.apiClient,e);return s=X("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=BD(l),f=new ok;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=yD(this.apiClient,e);return a=X("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>up(f))}else{const u=_D(this.apiClient,e);return a=X("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>lp(f))}}async listInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=CD(this.apiClient,e);return a=X("{models_url}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:f.headers},m})),o.then(f=>{const p=RD(f),m=new xv;return Object.assign(m,p),m})}else{const u=SD(this.apiClient,e);return a=X("{models_url}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:f.headers},m})),o.then(f=>{const p=AD(f),m=new xv;return Object.assign(m,p),m})}}async update(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=JD(this.apiClient,e);return a=X("{model}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>up(f))}else{const u=WD(this.apiClient,e);return a=X("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>lp(f))}}async delete(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=MN(this.apiClient,e);return a=X("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:f.headers},m})),o.then(f=>{const p=bN(f),m=new kv;return Object.assign(m,p),m})}else{const u=DN(this.apiClient,e);return a=X("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:f.headers},m})),o.then(f=>{const p=VN(f),m=new kv;return Object.assign(m,p),m})}}async countTokens(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=xN(this.apiClient,e);return a=X("{model}:countTokens",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:f.headers},m})),o.then(f=>{const p=NN(f),m=new Nv;return Object.assign(m,p),m})}else{const u=PN(this.apiClient,e);return a=X("{model}:countTokens",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:f.headers},m})),o.then(f=>{const p=kN(f),m=new Nv;return Object.assign(m,p),m})}}async computeTokens(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=EN(this.apiClient,e);return s=X("{model}:computeTokens",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>{const u=IN(l),f=new ak;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=aD(this.apiClient,e);return a=X("{model}:predictLongRunning",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>{const p=sD(f),m=new Gc;return Object.assign(m,p),m})}else{const u=oD(this.apiClient,e);return a=X("{model}:predictLongRunning",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>{const p=iD(f),m=new Gc;return Object.assign(m,p),m})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class NM extends ls{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const n=e.operation,r=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=n.name.split("/operations/")[0];let s;r&&"httpOptions"in r&&(s=r.httpOptions);const o=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:i,config:{httpOptions:s}});return n._fromAPIResponse({apiResponse:o,isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:i,isVertexAI:!1})}}async get(e){const n=e.operation,r=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=n.name.split("/operations/")[0];let s;r&&"httpOptions"in r&&(s=r.httpOptions);const o=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:i,config:{httpOptions:s}});return n._fromAPIResponse({apiResponse:o,isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:i,isVertexAI:!1})}}async getVideosOperationInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=ek(e);return a=X("{operationName}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o}else{const u=Zx(e);return a=X("{operationName}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o}}async fetchPredictVideosOperationInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=Kx(e);return s=X("{resourceName}:fetchPredictOperation",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function DM(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["data"]);n!=null&&h(e,["data"],n);const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function MM(t){const e={},n=c(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>GM(s))),h(e,["parts"],i)}const r=c(t,["role"]);return r!=null&&h(e,["role"],r),e}function VM(t,e,n){const r={},i=c(e,["expireTime"]);n!==void 0&&i!=null&&h(n,["expireTime"],i);const s=c(e,["newSessionExpireTime"]);n!==void 0&&s!=null&&h(n,["newSessionExpireTime"],s);const o=c(e,["uses"]);n!==void 0&&o!=null&&h(n,["uses"],o);const a=c(e,["liveConnectConstraints"]);n!==void 0&&a!=null&&h(n,["bidiGenerateContentSetup"],BM(t,a));const l=c(e,["lockAdditionalFields"]);return n!==void 0&&l!=null&&h(n,["fieldMask"],l),r}function bM(t,e){const n={},r=c(e,["config"]);return r!=null&&h(n,["config"],VM(t,r,n)),n}function LM(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["fileUri"]);n!=null&&h(e,["fileUri"],n);const r=c(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function FM(t){const e={};if(c(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=c(t,["enableWidget"]);return n!=null&&h(e,["enableWidget"],n),e}function UM(t){const e={},n=c(t,["timeRangeFilter"]);if(n!=null&&h(e,["timeRangeFilter"],n),c(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function OM(t,e){const n={},r=c(t,["generationConfig"]);e!==void 0&&r!=null&&h(e,["setup","generationConfig"],r);const i=c(t,["responseModalities"]);e!==void 0&&i!=null&&h(e,["setup","generationConfig","responseModalities"],i);const s=c(t,["temperature"]);e!==void 0&&s!=null&&h(e,["setup","generationConfig","temperature"],s);const o=c(t,["topP"]);e!==void 0&&o!=null&&h(e,["setup","generationConfig","topP"],o);const a=c(t,["topK"]);e!==void 0&&a!=null&&h(e,["setup","generationConfig","topK"],a);const l=c(t,["maxOutputTokens"]);e!==void 0&&l!=null&&h(e,["setup","generationConfig","maxOutputTokens"],l);const u=c(t,["mediaResolution"]);e!==void 0&&u!=null&&h(e,["setup","generationConfig","mediaResolution"],u);const f=c(t,["seed"]);e!==void 0&&f!=null&&h(e,["setup","generationConfig","seed"],f);const p=c(t,["speechConfig"]);e!==void 0&&p!=null&&h(e,["setup","generationConfig","speechConfig"],$m(p));const m=c(t,["thinkingConfig"]);e!==void 0&&m!=null&&h(e,["setup","generationConfig","thinkingConfig"],m);const v=c(t,["enableAffectiveDialog"]);e!==void 0&&v!=null&&h(e,["setup","generationConfig","enableAffectiveDialog"],v);const I=c(t,["systemInstruction"]);e!==void 0&&I!=null&&h(e,["setup","systemInstruction"],MM(xt(I)));const x=c(t,["tools"]);if(e!==void 0&&x!=null){let F=bo(x);Array.isArray(F)&&(F=F.map(C=>$M(Vo(C)))),h(e,["setup","tools"],F)}const M=c(t,["sessionResumption"]);e!==void 0&&M!=null&&h(e,["setup","sessionResumption"],qM(M));const A=c(t,["inputAudioTranscription"]);e!==void 0&&A!=null&&h(e,["setup","inputAudioTranscription"],A);const T=c(t,["outputAudioTranscription"]);e!==void 0&&T!=null&&h(e,["setup","outputAudioTranscription"],T);const S=c(t,["realtimeInputConfig"]);e!==void 0&&S!=null&&h(e,["setup","realtimeInputConfig"],S);const V=c(t,["contextWindowCompression"]);e!==void 0&&V!=null&&h(e,["setup","contextWindowCompression"],V);const U=c(t,["proactivity"]);return e!==void 0&&U!=null&&h(e,["setup","proactivity"],U),n}function BM(t,e){const n={},r=c(e,["model"]);r!=null&&h(n,["setup","model"],we(t,r));const i=c(e,["config"]);return i!=null&&h(n,["config"],OM(i,n)),n}function GM(t){const e={},n=c(t,["videoMetadata"]);n!=null&&h(e,["videoMetadata"],n);const r=c(t,["thought"]);r!=null&&h(e,["thought"],r);const i=c(t,["inlineData"]);i!=null&&h(e,["inlineData"],DM(i));const s=c(t,["fileData"]);s!=null&&h(e,["fileData"],LM(s));const o=c(t,["thoughtSignature"]);o!=null&&h(e,["thoughtSignature"],o);const a=c(t,["functionCall"]);a!=null&&h(e,["functionCall"],a);const l=c(t,["codeExecutionResult"]);l!=null&&h(e,["codeExecutionResult"],l);const u=c(t,["executableCode"]);u!=null&&h(e,["executableCode"],u);const f=c(t,["functionResponse"]);f!=null&&h(e,["functionResponse"],f);const p=c(t,["text"]);return p!=null&&h(e,["text"],p),e}function qM(t){const e={},n=c(t,["handle"]);if(n!=null&&h(e,["handle"],n),c(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function $M(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(f=>f)),h(e,["functionDeclarations"],u)}if(c(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=c(t,["googleSearch"]);r!=null&&h(e,["googleSearch"],UM(r));const i=c(t,["googleSearchRetrieval"]);if(i!=null&&h(e,["googleSearchRetrieval"],i),c(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=c(t,["googleMaps"]);s!=null&&h(e,["googleMaps"],FM(s));const o=c(t,["urlContext"]);o!=null&&h(e,["urlContext"],o);const a=c(t,["computerUse"]);a!=null&&h(e,["computerUse"],a);const l=c(t,["codeExecution"]);return l!=null&&h(e,["codeExecution"],l),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function zM(t){const e=[];for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const r=t[n];if(typeof r=="object"&&r!=null&&Object.keys(r).length>0){const i=Object.keys(r).map(s=>`${n}.${s}`);e.push(...i)}else e.push(n)}return e.join(",")}function HM(t,e){let n=null;const r=t.bidiGenerateContentSetup;if(typeof r=="object"&&r!==null&&"setup"in r){const s=r.setup;typeof s=="object"&&s!==null?(t.bidiGenerateContentSetup=s,n=s):delete t.bidiGenerateContentSetup}else r!==void 0&&delete t.bidiGenerateContentSetup;const i=t.fieldMask;if(n){const s=zM(n);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)s?t.fieldMask=s:delete t.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&i!==null&&Array.isArray(i)&&i.length>0){const o=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let a=[];i.length>0&&(a=i.map(u=>o.includes(u)?`generationConfig.${u}`:u));const l=[];s&&l.push(s),a.length>0&&l.push(...a),l.length>0?t.fieldMask=l.join(","):delete t.fieldMask}else delete t.fieldMask}else i!==null&&Array.isArray(i)&&i.length>0?t.fieldMask=i.join(","):delete t.fieldMask;return t}class KM extends ls{constructor(e){super(),this.apiClient=e}async create(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const a=bM(this.apiClient,e);s=X("auth_tokens",a._url),o=a._query,delete a.config,delete a._url,delete a._query;const l=HM(a,e.config);return i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>u)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function WM(t){const e={},n=c(t,["name"]);return n!=null&&h(e,["_url","name"],n),e}function JM(t){const e={},n=c(t,["name"]);return n!=null&&h(e,["_url","name"],n),e}function QM(t,e){const n={};if(c(t,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const r=c(t,["tunedModelDisplayName"]);if(e!==void 0&&r!=null&&h(e,["displayName"],r),c(t,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const i=c(t,["epochCount"]);e!==void 0&&i!=null&&h(e,["tuningTask","hyperparameters","epochCount"],i);const s=c(t,["learningRateMultiplier"]);if(s!=null&&h(n,["tuningTask","hyperparameters","learningRateMultiplier"],s),c(t,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(c(t,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(c(t,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const o=c(t,["batchSize"]);e!==void 0&&o!=null&&h(e,["tuningTask","hyperparameters","batchSize"],o);const a=c(t,["learningRate"]);if(e!==void 0&&a!=null&&h(e,["tuningTask","hyperparameters","learningRate"],a),c(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");return n}function YM(t,e){const n={},r=c(t,["validationDataset"]);e!==void 0&&r!=null&&h(e,["supervisedTuningSpec"],dV(r,n));const i=c(t,["tunedModelDisplayName"]);e!==void 0&&i!=null&&h(e,["tunedModelDisplayName"],i);const s=c(t,["description"]);e!==void 0&&s!=null&&h(e,["description"],s);const o=c(t,["epochCount"]);e!==void 0&&o!=null&&h(e,["supervisedTuningSpec","hyperParameters","epochCount"],o);const a=c(t,["learningRateMultiplier"]);e!==void 0&&a!=null&&h(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],a);const l=c(t,["exportLastCheckpointOnly"]);e!==void 0&&l!=null&&h(e,["supervisedTuningSpec","exportLastCheckpointOnly"],l);const u=c(t,["adapterSize"]);if(e!==void 0&&u!=null&&h(e,["supervisedTuningSpec","hyperParameters","adapterSize"],u),c(t,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(c(t,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const f=c(t,["labels"]);return e!==void 0&&f!=null&&h(e,["labels"],f),n}function jM(t){const e={},n=c(t,["baseModel"]);n!=null&&h(e,["baseModel"],n);const r=c(t,["preTunedModel"]);r!=null&&h(e,["preTunedModel"],r);const i=c(t,["trainingDataset"]);i!=null&&h(e,["tuningTask","trainingData"],lV(i));const s=c(t,["config"]);return s!=null&&QM(s,e),e}function XM(t){const e={},n=c(t,["baseModel"]);n!=null&&h(e,["baseModel"],n);const r=c(t,["preTunedModel"]);r!=null&&h(e,["preTunedModel"],r);const i=c(t,["trainingDataset"]);i!=null&&h(e,["supervisedTuningSpec","trainingDatasetUri"],uV(i,e));const s=c(t,["config"]);return s!=null&&YM(s,e),e}function ZM(t){const e={},n=c(t,["name"]);return n!=null&&h(e,["_url","name"],n),e}function eV(t){const e={},n=c(t,["name"]);return n!=null&&h(e,["_url","name"],n),e}function tV(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&h(e,["_query","pageSize"],r);const i=c(t,["pageToken"]);e!==void 0&&i!=null&&h(e,["_query","pageToken"],i);const s=c(t,["filter"]);return e!==void 0&&s!=null&&h(e,["_query","filter"],s),n}function nV(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&h(e,["_query","pageSize"],r);const i=c(t,["pageToken"]);e!==void 0&&i!=null&&h(e,["_query","pageToken"],i);const s=c(t,["filter"]);return e!==void 0&&s!=null&&h(e,["_query","filter"],s),n}function rV(t){const e={},n=c(t,["config"]);return n!=null&&tV(n,e),e}function iV(t){const e={},n=c(t,["config"]);return n!=null&&nV(n,e),e}function sV(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=c(t,["tunedModels"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>VS(o))),h(e,["tuningJobs"],s)}return e}function oV(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=c(t,["tuningJobs"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>dp(o))),h(e,["tuningJobs"],s)}return e}function aV(t){const e={},n=c(t,["name"]);n!=null&&h(e,["model"],n);const r=c(t,["name"]);return r!=null&&h(e,["endpoint"],r),e}function lV(t){const e={};if(c(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(c(t,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const n=c(t,["examples"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>i)),h(e,["examples","examples"],r)}return e}function uV(t,e){const n={},r=c(t,["gcsUri"]);e!==void 0&&r!=null&&h(e,["supervisedTuningSpec","trainingDatasetUri"],r);const i=c(t,["vertexDatasetResource"]);if(e!==void 0&&i!=null&&h(e,["supervisedTuningSpec","trainingDatasetUri"],i),c(t,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return n}function VS(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["name"]);r!=null&&h(e,["name"],r);const i=c(t,["state"]);i!=null&&h(e,["state"],mS(i));const s=c(t,["createTime"]);s!=null&&h(e,["createTime"],s);const o=c(t,["tuningTask","startTime"]);o!=null&&h(e,["startTime"],o);const a=c(t,["tuningTask","completeTime"]);a!=null&&h(e,["endTime"],a);const l=c(t,["updateTime"]);l!=null&&h(e,["updateTime"],l);const u=c(t,["description"]);u!=null&&h(e,["description"],u);const f=c(t,["baseModel"]);f!=null&&h(e,["baseModel"],f);const p=c(t,["_self"]);p!=null&&h(e,["tunedModel"],aV(p));const m=c(t,["customBaseModel"]);m!=null&&h(e,["customBaseModel"],m);const v=c(t,["experiment"]);v!=null&&h(e,["experiment"],v);const I=c(t,["labels"]);I!=null&&h(e,["labels"],I);const x=c(t,["outputUri"]);x!=null&&h(e,["outputUri"],x);const M=c(t,["pipelineJob"]);M!=null&&h(e,["pipelineJob"],M);const A=c(t,["serviceAccount"]);A!=null&&h(e,["serviceAccount"],A);const T=c(t,["tunedModelDisplayName"]);T!=null&&h(e,["tunedModelDisplayName"],T);const S=c(t,["veoTuningSpec"]);return S!=null&&h(e,["veoTuningSpec"],S),e}function dp(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["name"]);r!=null&&h(e,["name"],r);const i=c(t,["state"]);i!=null&&h(e,["state"],mS(i));const s=c(t,["createTime"]);s!=null&&h(e,["createTime"],s);const o=c(t,["startTime"]);o!=null&&h(e,["startTime"],o);const a=c(t,["endTime"]);a!=null&&h(e,["endTime"],a);const l=c(t,["updateTime"]);l!=null&&h(e,["updateTime"],l);const u=c(t,["error"]);u!=null&&h(e,["error"],u);const f=c(t,["description"]);f!=null&&h(e,["description"],f);const p=c(t,["baseModel"]);p!=null&&h(e,["baseModel"],p);const m=c(t,["tunedModel"]);m!=null&&h(e,["tunedModel"],m);const v=c(t,["preTunedModel"]);v!=null&&h(e,["preTunedModel"],v);const I=c(t,["supervisedTuningSpec"]);I!=null&&h(e,["supervisedTuningSpec"],I);const x=c(t,["tuningDataStats"]);x!=null&&h(e,["tuningDataStats"],x);const M=c(t,["encryptionSpec"]);M!=null&&h(e,["encryptionSpec"],M);const A=c(t,["partnerModelTuningSpec"]);A!=null&&h(e,["partnerModelTuningSpec"],A);const T=c(t,["customBaseModel"]);T!=null&&h(e,["customBaseModel"],T);const S=c(t,["experiment"]);S!=null&&h(e,["experiment"],S);const V=c(t,["labels"]);V!=null&&h(e,["labels"],V);const U=c(t,["outputUri"]);U!=null&&h(e,["outputUri"],U);const F=c(t,["pipelineJob"]);F!=null&&h(e,["pipelineJob"],F);const C=c(t,["serviceAccount"]);C!=null&&h(e,["serviceAccount"],C);const E=c(t,["tunedModelDisplayName"]);E!=null&&h(e,["tunedModelDisplayName"],E);const R=c(t,["veoTuningSpec"]);return R!=null&&h(e,["veoTuningSpec"],R),e}function cV(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=c(t,["name"]);r!=null&&h(e,["name"],r);const i=c(t,["metadata"]);i!=null&&h(e,["metadata"],i);const s=c(t,["done"]);s!=null&&h(e,["done"],s);const o=c(t,["error"]);return o!=null&&h(e,["error"],o),e}function dV(t,e){const n={},r=c(t,["gcsUri"]);r!=null&&h(n,["validationDatasetUri"],r);const i=c(t,["vertexDatasetResource"]);return e!==void 0&&i!=null&&h(e,["supervisedTuningSpec","trainingDatasetUri"],i),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class hV extends ls{constructor(e){super(),this.apiClient=e,this.get=async n=>await this.getInternal(n),this.list=async(n={})=>new kl(Yi.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(n),n),this.tune=async n=>{var r;if(this.apiClient.isVertexAI())if(n.baseModel.startsWith("projects/")){const i={tunedModelName:n.baseModel};!((r=n.config)===null||r===void 0)&&r.preTunedModelCheckpointId&&(i.checkpointId=n.config.preTunedModelCheckpointId);const s=Object.assign(Object.assign({},n),{preTunedModel:i});return s.baseModel=void 0,await this.tuneInternal(s)}else{const i=Object.assign({},n);return await this.tuneInternal(i)}else{const i=Object.assign({},n),s=await this.tuneMldevInternal(i);let o="";return s.metadata!==void 0&&s.metadata.tunedModel!==void 0?o=s.metadata.tunedModel:s.name!==void 0&&s.name.includes("/operations/")&&(o=s.name.split("/operations/")[0]),{name:o,state:ip.JOB_STATE_QUEUED}}}}async getInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=eV(e);return a=X("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:f.headers},m})),o.then(f=>dp(f))}else{const u=ZM(e);return a=X("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:f.headers},m})),o.then(f=>VS(f))}}async listInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=iV(e);return a=X("tuningJobs",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:f.headers},m})),o.then(f=>{const p=oV(f),m=new Dv;return Object.assign(m,p),m})}else{const u=rV(e);return a=X("tunedModels",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:f.headers},m})),o.then(f=>{const p=sV(f),m=new Dv;return Object.assign(m,p),m})}}async cancel(e){var n,r,i,s;let o="",a={};if(this.apiClient.isVertexAI()){const l=JM(e);o=X("{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}else{const l=WM(e);o=X("{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal})}}async tuneInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=XM(e);return s=X("tuningJobs",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>dp(l))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=jM(e);return s=X("tunedModels",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>cV(l))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class fV{async download(e,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const pV=1024*1024*8,mV=3,gV=1e3,_V=2,Jh="x-goog-upload-status";async function yV(t,e,n){var r,i,s;let o=0,a=0,l=new sp(new Response),u="upload";for(o=t.size;a<o;){const p=Math.min(pV,o-a),m=t.slice(a,a+p);a+p>=o&&(u+=", finalize");let v=0,I=gV;for(;v<mV&&(l=await n.request({path:"",body:m,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":u,"X-Goog-Upload-Offset":String(a),"Content-Length":String(p)}}}),!(!((r=l==null?void 0:l.headers)===null||r===void 0)&&r[Jh]));)v++,await TV(I),I=I*_V;if(a+=p,((i=l==null?void 0:l.headers)===null||i===void 0?void 0:i[Jh])!=="active")break;if(o<=a)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const f=await(l==null?void 0:l.json());if(((s=l==null?void 0:l.headers)===null||s===void 0?void 0:s[Jh])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return f.file}async function vV(t){return{size:t.size,type:t.type}}function TV(t){return new Promise(e=>setTimeout(e,t))}class EV{async upload(e,n,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await yV(e,n,r)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await vV(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class IV{create(e,n,r){return new wV(e,n,r)}}class wV{constructor(e,n,r){this.url=e,this.headers=n,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Xv="x-goog-api-key";class SV{constructor(e){this.apiKey=e}async addAuthHeaders(e){if(e.get(Xv)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(Xv,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const CV="gl-node/";class AV{constructor(e){var n;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=e.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=e.apiKey;const r=zx(e.httpOptions,e.vertexai,void 0,void 0);r&&(e.httpOptions?e.httpOptions.baseUrl=r:e.httpOptions={baseUrl:r}),this.apiVersion=e.apiVersion;const i=new SV(this.apiKey);this.apiClient=new cM({auth:i,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:CV+"web",uploader:new EV,downloader:new fV}),this.models=new kM(this.apiClient),this.live=new wM(this.apiClient,i,new IV),this.batches=new u1(this.apiClient),this.chats=new G1(this.models,this.apiClient),this.caches=new U1(this.apiClient),this.files=new j1(this.apiClient),this.operations=new NM(this.apiClient),this.authTokens=new KM(this.apiClient),this.tunings=new hV(this.apiClient)}}const RV=()=>{};var Zv={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bS=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},PV=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],o=t[n++],a=t[n++],l=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},LS={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],o=i+1<t.length,a=o?t[i+1]:0,l=i+2<t.length,u=l?t[i+2]:0,f=s>>2,p=(s&3)<<4|a>>4;let m=(a&15)<<2|u>>6,v=u&63;l||(v=64,o||(m=64)),r.push(n[f],n[p],n[m],n[v])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(bS(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):PV(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0;++i;const u=i<t.length?n[t.charAt(i)]:64;++i;const p=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||a==null||u==null||p==null)throw new xV;const m=s<<2|a>>4;if(r.push(m),u!==64){const v=a<<4&240|u>>2;if(r.push(v),p!==64){const I=u<<6&192|p;r.push(I)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class xV extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const kV=function(t){const e=bS(t);return LS.encodeByteArray(e,!0)},$c=function(t){return kV(t).replace(/\./g,"")},FS=function(t){try{return LS.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function US(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NV=()=>US().__FIREBASE_DEFAULTS__,DV=()=>{if(typeof process>"u"||typeof Zv>"u")return;const t=Zv.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},MV=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&FS(t[1]);return e&&JSON.parse(e)},Vd=()=>{try{return RV()||NV()||DV()||MV()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},OS=t=>{var e,n;return(n=(e=Vd())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},VV=t=>{const e=OS(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},BS=()=>{var t;return(t=Vd())==null?void 0:t.config},GS=t=>{var e;return(e=Vd())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bV{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fo(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function qS(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LV(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...t};return[$c(JSON.stringify(n)),$c(JSON.stringify(o)),""].join(".")}const Ua={};function FV(){const t={prod:[],emulator:[]};for(const e of Object.keys(Ua))Ua[e]?t.emulator.push(e):t.prod.push(e);return t}function UV(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let eT=!1;function $S(t,e){if(typeof window>"u"||typeof document>"u"||!Fo(window.location.host)||Ua[t]===e||Ua[t]||eT)return;Ua[t]=e;function n(m){return`__firebase__banner__${m}`}const r="__firebase__banner",s=FV().prod.length>0;function o(){const m=document.getElementById(r);m&&m.remove()}function a(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function l(m,v){m.setAttribute("width","24"),m.setAttribute("id",v),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function u(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{eT=!0,o()},m}function f(m,v){m.setAttribute("id",v),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function p(){const m=UV(r),v=n("text"),I=document.getElementById(v)||document.createElement("span"),x=n("learnmore"),M=document.getElementById(x)||document.createElement("a"),A=n("preprendIcon"),T=document.getElementById(A)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const S=m.element;a(S),f(M,x);const V=u();l(T,A),S.append(T,I,M,V),document.body.appendChild(S)}s?(I.innerText="Preview backend disconnected.",T.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(T.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,I.innerText="Preview backend running in this workspace."),I.setAttribute("id",v)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",p):p()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ct(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function OV(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ct())}function zS(){var e;const t=(e=Vd())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function BV(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function GV(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function qV(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function $V(){const t=ct();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function HS(){return!zS()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function KS(){return!zS()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function WS(){try{return typeof indexedDB=="object"}catch{return!1}}function zV(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)==null?void 0:s.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HV="FirebaseError";class mr extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=HV,Object.setPrototypeOf(this,mr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Nl.prototype.create)}}class Nl{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?KV(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new mr(i,a,r)}}function KV(t,e){return t.replace(WV,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const WV=/\{\$([^}]+)}/g;function JV(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function ji(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],o=e[i];if(tT(s)&&tT(o)){if(!ji(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function tT(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dl(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function QV(t,e){const n=new YV(t,e);return n.subscribe.bind(n)}class YV{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");jV(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=Qh),i.error===void 0&&(i.error=Qh),i.complete===void 0&&(i.complete=Qh);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function jV(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Qh(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function en(t){return t&&t._delegate?t._delegate:t}class Xi{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ri="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XV{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new bV;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(e2(e))try{this.getOrInitializeService({instanceIdentifier:Ri})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Ri){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ri){return this.instances.has(e)}getOptions(e=Ri){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:ZV(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Ri){return this.component?this.component.multipleInstances?e:Ri:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function ZV(t){return t===Ri?void 0:t}function e2(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t2{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new XV(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ge;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(ge||(ge={}));const n2={debug:ge.DEBUG,verbose:ge.VERBOSE,info:ge.INFO,warn:ge.WARN,error:ge.ERROR,silent:ge.SILENT},r2=ge.INFO,i2={[ge.DEBUG]:"log",[ge.VERBOSE]:"log",[ge.INFO]:"info",[ge.WARN]:"warn",[ge.ERROR]:"error"},s2=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=i2[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Hm{constructor(e){this.name=e,this._logLevel=r2,this._logHandler=s2,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ge))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?n2[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ge.DEBUG,...e),this._logHandler(this,ge.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ge.VERBOSE,...e),this._logHandler(this,ge.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ge.INFO,...e),this._logHandler(this,ge.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ge.WARN,...e),this._logHandler(this,ge.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ge.ERROR,...e),this._logHandler(this,ge.ERROR,...e)}}const o2=(t,e)=>e.some(n=>t instanceof n);let nT,rT;function a2(){return nT||(nT=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function l2(){return rT||(rT=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const JS=new WeakMap,hp=new WeakMap,QS=new WeakMap,Yh=new WeakMap,Km=new WeakMap;function u2(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(Wr(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&JS.set(n,t)}).catch(()=>{}),Km.set(e,t),e}function c2(t){if(hp.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});hp.set(t,e)}let fp={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return hp.get(t);if(e==="objectStoreNames")return t.objectStoreNames||QS.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Wr(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function d2(t){fp=t(fp)}function h2(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(jh(this),e,...n);return QS.set(r,e.sort?e.sort():[e]),Wr(r)}:l2().includes(t)?function(...e){return t.apply(jh(this),e),Wr(JS.get(this))}:function(...e){return Wr(t.apply(jh(this),e))}}function f2(t){return typeof t=="function"?h2(t):(t instanceof IDBTransaction&&c2(t),o2(t,a2())?new Proxy(t,fp):t)}function Wr(t){if(t instanceof IDBRequest)return u2(t);if(Yh.has(t))return Yh.get(t);const e=f2(t);return e!==t&&(Yh.set(t,e),Km.set(e,t)),e}const jh=t=>Km.get(t);function p2(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),a=Wr(o);return r&&o.addEventListener("upgradeneeded",l=>{r(Wr(o.result),l.oldVersion,l.newVersion,Wr(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}const m2=["get","getKey","getAll","getAllKeys","count"],g2=["put","add","delete","clear"],Xh=new Map;function iT(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Xh.get(e))return Xh.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=g2.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||m2.includes(n)))return;const s=async function(o,...a){const l=this.transaction(o,i?"readwrite":"readonly");let u=l.store;return r&&(u=u.index(a.shift())),(await Promise.all([u[n](...a),i&&l.done]))[0]};return Xh.set(e,s),s}d2(t=>({...t,get:(e,n,r)=>iT(e,n)||t.get(e,n,r),has:(e,n)=>!!iT(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _2{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(y2(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function y2(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const pp="@firebase/app",sT="0.14.4";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ur=new Hm("@firebase/app"),v2="@firebase/app-compat",T2="@firebase/analytics-compat",E2="@firebase/analytics",I2="@firebase/app-check-compat",w2="@firebase/app-check",S2="@firebase/auth",C2="@firebase/auth-compat",A2="@firebase/database",R2="@firebase/data-connect",P2="@firebase/database-compat",x2="@firebase/functions",k2="@firebase/functions-compat",N2="@firebase/installations",D2="@firebase/installations-compat",M2="@firebase/messaging",V2="@firebase/messaging-compat",b2="@firebase/performance",L2="@firebase/performance-compat",F2="@firebase/remote-config",U2="@firebase/remote-config-compat",O2="@firebase/storage",B2="@firebase/storage-compat",G2="@firebase/firestore",q2="@firebase/ai",$2="@firebase/firestore-compat",z2="firebase",H2="12.4.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mp="[DEFAULT]",K2={[pp]:"fire-core",[v2]:"fire-core-compat",[E2]:"fire-analytics",[T2]:"fire-analytics-compat",[w2]:"fire-app-check",[I2]:"fire-app-check-compat",[S2]:"fire-auth",[C2]:"fire-auth-compat",[A2]:"fire-rtdb",[R2]:"fire-data-connect",[P2]:"fire-rtdb-compat",[x2]:"fire-fn",[k2]:"fire-fn-compat",[N2]:"fire-iid",[D2]:"fire-iid-compat",[M2]:"fire-fcm",[V2]:"fire-fcm-compat",[b2]:"fire-perf",[L2]:"fire-perf-compat",[F2]:"fire-rc",[U2]:"fire-rc-compat",[O2]:"fire-gcs",[B2]:"fire-gcs-compat",[G2]:"fire-fst",[$2]:"fire-fst-compat",[q2]:"fire-vertex","fire-js":"fire-js",[z2]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zc=new Map,W2=new Map,gp=new Map;function oT(t,e){try{t.container.addComponent(e)}catch(n){ur.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function po(t){const e=t.name;if(gp.has(e))return ur.debug(`There were multiple attempts to register component ${e}.`),!1;gp.set(e,t);for(const n of zc.values())oT(n,t);for(const n of W2.values())oT(n,t);return!0}function Wm(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function wn(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J2={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Jr=new Nl("app","Firebase",J2);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q2{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Xi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Jr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uo=H2;function YS(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:mp,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw Jr.create("bad-app-name",{appName:String(i)});if(n||(n=BS()),!n)throw Jr.create("no-options");const s=zc.get(i);if(s){if(ji(n,s.options)&&ji(r,s.config))return s;throw Jr.create("duplicate-app",{appName:i})}const o=new t2(i);for(const l of gp.values())o.addComponent(l);const a=new Q2(n,r,o);return zc.set(i,a),a}function jS(t=mp){const e=zc.get(t);if(!e&&t===mp&&BS())return YS();if(!e)throw Jr.create("no-app",{appName:t});return e}function Qr(t,e,n){let r=K2[t]??t;n&&(r+=`-${n}`);const i=r.match(/\s|\//),s=e.match(/\s|\//);if(i||s){const o=[`Unable to register library "${r}" with version "${e}":`];i&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ur.warn(o.join(" "));return}po(new Xi(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y2="firebase-heartbeat-database",j2=1,hl="firebase-heartbeat-store";let Zh=null;function XS(){return Zh||(Zh=p2(Y2,j2,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(hl)}catch(n){console.warn(n)}}}}).catch(t=>{throw Jr.create("idb-open",{originalErrorMessage:t.message})})),Zh}async function X2(t){try{const n=(await XS()).transaction(hl),r=await n.objectStore(hl).get(ZS(t));return await n.done,r}catch(e){if(e instanceof mr)ur.warn(e.message);else{const n=Jr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ur.warn(n.message)}}}async function aT(t,e){try{const r=(await XS()).transaction(hl,"readwrite");await r.objectStore(hl).put(e,ZS(t)),await r.done}catch(n){if(n instanceof mr)ur.warn(n.message);else{const r=Jr.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});ur.warn(r.message)}}}function ZS(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z2=1024,eb=30;class tb{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new rb(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=lT();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>eb){const o=ib(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){ur.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=lT(),{heartbeatsToSend:r,unsentEntries:i}=nb(this._heartbeatsCache.heartbeats),s=$c(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return ur.warn(n),""}}}function lT(){return new Date().toISOString().substring(0,10)}function nb(t,e=Z2){const n=[];let r=t.slice();for(const i of t){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),uT(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),uT(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class rb{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return WS()?zV().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await X2(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return aT(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return aT(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function uT(t){return $c(JSON.stringify({version:2,heartbeats:t})).length}function ib(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sb(t){po(new Xi("platform-logger",e=>new _2(e),"PRIVATE")),po(new Xi("heartbeat",e=>new tb(e),"PRIVATE")),Qr(pp,sT,t),Qr(pp,sT,"esm2020"),Qr("fire-js","")}sb("");var ob="firebase",ab="12.4.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Qr(ob,ab,"app");function eC(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const lb=eC,tC=new Nl("auth","Firebase",eC());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hc=new Hm("@firebase/auth");function ub(t,...e){Hc.logLevel<=ge.WARN&&Hc.warn(`Auth (${Uo}): ${t}`,...e)}function ec(t,...e){Hc.logLevel<=ge.ERROR&&Hc.error(`Auth (${Uo}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zn(t,...e){throw Qm(t,...e)}function Pn(t,...e){return Qm(t,...e)}function Jm(t,e,n){const r={...lb(),[e]:n};return new Nl("auth","Firebase",r).create(e,{appName:t.name})}function Gi(t){return Jm(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function cb(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&zn(t,"argument-error"),Jm(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Qm(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return tC.create(t,...e)}function se(t,e,...n){if(!t)throw Qm(e,...n)}function er(t){const e="INTERNAL ASSERTION FAILED: "+t;throw ec(e),new Error(e)}function cr(t,e){t||er(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _p(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function db(){return cT()==="http:"||cT()==="https:"}function cT(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hb(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(db()||GV()||"connection"in navigator)?navigator.onLine:!0}function fb(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ml{constructor(e,n){this.shortDelay=e,this.longDelay=n,cr(n>e,"Short delay should be less than long delay!"),this.isMobile=OV()||qV()}get(){return hb()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ym(t,e){cr(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nC{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;er("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;er("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;er("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pb={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mb=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],gb=new Ml(3e4,6e4);function jm(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function Oo(t,e,n,r,i={}){return rC(t,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const a=Dl({key:t.config.apiKey,...o}).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const u={method:e,headers:l,...s};return BV()||(u.referrerPolicy="no-referrer"),t.emulatorConfig&&Fo(t.emulatorConfig.host)&&(u.credentials="include"),nC.fetch()(await iC(t,t.config.apiHost,n,a),u)})}async function rC(t,e,n){t._canInitEmulator=!1;const r={...pb,...e};try{const i=new yb(t),s=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw Nu(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[l,u]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Nu(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw Nu(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw Nu(t,"user-disabled",o);const f=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw Jm(t,f,u);zn(t,f)}}catch(i){if(i instanceof mr)throw i;zn(t,"network-request-failed",{message:String(i)})}}async function _b(t,e,n,r,i={}){const s=await Oo(t,e,n,r,i);return"mfaPendingCredential"in s&&zn(t,"multi-factor-auth-required",{_serverResponse:s}),s}async function iC(t,e,n,r){const i=`${e}${n}?${r}`,s=t,o=s.config.emulator?Ym(t.config,i):`${t.config.apiScheme}://${i}`;return mb.includes(n)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}class yb{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Pn(this.auth,"network-request-failed")),gb.get())})}}function Nu(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=Pn(t,e,r);return i.customData._tokenResponse=n,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vb(t,e){return Oo(t,"POST","/v1/accounts:delete",e)}async function Kc(t,e){return Oo(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oa(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Tb(t,e=!1){const n=en(t),r=await n.getIdToken(e),i=Xm(r);se(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:Oa(ef(i.auth_time)),issuedAtTime:Oa(ef(i.iat)),expirationTime:Oa(ef(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function ef(t){return Number(t)*1e3}function Xm(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return ec("JWT malformed, contained fewer than 3 sections"),null;try{const i=FS(n);return i?JSON.parse(i):(ec("Failed to decode base64 JWT payload"),null)}catch(i){return ec("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function dT(t){const e=Xm(t);return se(e,"internal-error"),se(typeof e.exp<"u","internal-error"),se(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fl(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof mr&&Eb(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function Eb({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ib{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yp{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Oa(this.lastLoginAt),this.creationTime=Oa(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Wc(t){var p;const e=t.auth,n=await t.getIdToken(),r=await fl(t,Kc(e,{idToken:n}));se(r==null?void 0:r.users.length,e,"internal-error");const i=r.users[0];t._notifyReloadListener(i);const s=(p=i.providerUserInfo)!=null&&p.length?sC(i.providerUserInfo):[],o=Sb(t.providerData,s),a=t.isAnonymous,l=!(t.email&&i.passwordHash)&&!(o!=null&&o.length),u=a?l:!1,f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new yp(i.createdAt,i.lastLoginAt),isAnonymous:u};Object.assign(t,f)}async function wb(t){const e=en(t);await Wc(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Sb(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function sC(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Cb(t,e){const n=await rC(t,{},async()=>{const r=Dl({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,o=await iC(t,i,"/v1/token",`key=${s}`),a=await t._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:a,body:r};return t.emulatorConfig&&Fo(t.emulatorConfig.host)&&(l.credentials="include"),nC.fetch()(o,l)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function Ab(t,e){return Oo(t,"POST","/v2/accounts:revokeToken",jm(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){se(e.idToken,"internal-error"),se(typeof e.idToken<"u","internal-error"),se(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):dT(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){se(e.length!==0,"internal-error");const n=dT(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(se(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:s}=await Cb(e,n);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:s}=n,o=new eo;return r&&(se(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(se(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(se(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new eo,this.toJSON())}_performRefresh(){return er("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sr(t,e){se(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Cn{constructor({uid:e,auth:n,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new Ib(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new yp(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await fl(this,this.stsTokenManager.getToken(this.auth,e));return se(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return Tb(this,e)}reload(){return wb(this)}_assign(e){this!==e&&(se(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Cn({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){se(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Wc(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(wn(this.auth.app))return Promise.reject(Gi(this.auth));const e=await this.getIdToken();return await fl(this,vb(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,i=n.email??void 0,s=n.phoneNumber??void 0,o=n.photoURL??void 0,a=n.tenantId??void 0,l=n._redirectEventId??void 0,u=n.createdAt??void 0,f=n.lastLoginAt??void 0,{uid:p,emailVerified:m,isAnonymous:v,providerData:I,stsTokenManager:x}=n;se(p&&x,e,"internal-error");const M=eo.fromJSON(this.name,x);se(typeof p=="string",e,"internal-error"),Sr(r,e.name),Sr(i,e.name),se(typeof m=="boolean",e,"internal-error"),se(typeof v=="boolean",e,"internal-error"),Sr(s,e.name),Sr(o,e.name),Sr(a,e.name),Sr(l,e.name),Sr(u,e.name),Sr(f,e.name);const A=new Cn({uid:p,auth:e,email:i,emailVerified:m,displayName:r,isAnonymous:v,photoURL:o,phoneNumber:s,tenantId:a,stsTokenManager:M,createdAt:u,lastLoginAt:f});return I&&Array.isArray(I)&&(A.providerData=I.map(T=>({...T}))),l&&(A._redirectEventId=l),A}static async _fromIdTokenResponse(e,n,r=!1){const i=new eo;i.updateFromServerResponse(n);const s=new Cn({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await Wc(s),s}static async _fromGetAccountInfoResponse(e,n,r){const i=n.users[0];se(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?sC(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),a=new eo;a.updateFromIdToken(r);const l=new Cn({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new yp(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(l,u),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hT=new Map;function tr(t){cr(t instanceof Function,"Expected a class definition");let e=hT.get(t);return e?(cr(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,hT.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oC{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}oC.type="NONE";const fT=oC;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tc(t,e,n){return`firebase:${t}:${e}:${n}`}class to{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=tc(this.userKey,i.apiKey,s),this.fullPersistenceKey=tc("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Kc(this.auth,{idToken:e}).catch(()=>{});return n?Cn._fromGetAccountInfoResponse(this.auth,n,e):null}return Cn._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new to(tr(fT),e,r);const i=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let s=i[0]||tr(fT);const o=tc(r,e.config.apiKey,e.name);let a=null;for(const u of n)try{const f=await u._get(o);if(f){let p;if(typeof f=="string"){const m=await Kc(e,{idToken:f}).catch(()=>{});if(!m)break;p=await Cn._fromGetAccountInfoResponse(e,m,f)}else p=Cn._fromJSON(e,f);u!==s&&(a=p),s=u;break}}catch{}const l=i.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new to(s,e,r):(s=l[0],a&&await s._set(o,a.toJSON()),await Promise.all(n.map(async u=>{if(u!==s)try{await u._remove(o)}catch{}})),new to(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pT(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(cC(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(aC(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(hC(e))return"Blackberry";if(fC(e))return"Webos";if(lC(e))return"Safari";if((e.includes("chrome/")||uC(e))&&!e.includes("edge/"))return"Chrome";if(dC(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function aC(t=ct()){return/firefox\//i.test(t)}function lC(t=ct()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function uC(t=ct()){return/crios\//i.test(t)}function cC(t=ct()){return/iemobile/i.test(t)}function dC(t=ct()){return/android/i.test(t)}function hC(t=ct()){return/blackberry/i.test(t)}function fC(t=ct()){return/webos/i.test(t)}function Zm(t=ct()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function Rb(t=ct()){var e;return Zm(t)&&!!((e=window.navigator)!=null&&e.standalone)}function Pb(){return $V()&&document.documentMode===10}function pC(t=ct()){return Zm(t)||dC(t)||fC(t)||hC(t)||/windows phone/i.test(t)||cC(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mC(t,e=[]){let n;switch(t){case"Browser":n=pT(ct());break;case"Worker":n=`${pT(ct())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Uo}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xb{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=s=>new Promise((o,a)=>{try{const l=e(s);o(l)}catch(l){a(l)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kb(t,e={}){return Oo(t,"GET","/v2/passwordPolicy",jm(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nb=6;class Db{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??Nb,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mb{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new mT(this),this.idTokenSubscription=new mT(this),this.beforeStateQueue=new xb(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=tC,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=tr(n)),this._initializationPromise=this.queue(async()=>{var r,i,s;if(!this._deleted&&(this.persistenceManager=await to.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((i=this._popupRedirectResolver)!=null&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)==null?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Kc(this,{idToken:e}),r=await Cn._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var s;if(wn(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(s=this.redirectUser)==null?void 0:s._redirectEventId,a=r==null?void 0:r._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(r=l.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return se(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Wc(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=fb()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(wn(this.app))return Promise.reject(Gi(this));const n=e?en(e):null;return n&&se(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&se(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return wn(this.app)?Promise.reject(Gi(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return wn(this.app)?Promise.reject(Gi(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(tr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await kb(this),n=new Db(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Nl("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await Ab(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&tr(e)||this._popupRedirectResolver;se(n,this,"argument-error"),this.redirectPersistenceManager=await to.create(this,[tr(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(se(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,r,i);return()=>{o=!0,l()}}else{const l=e.addObserver(n);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return se(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=mC(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var i;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((i=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:i.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if(wn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&ub(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function bd(t){return en(t)}class mT{constructor(e){this.auth=e,this.observer=null,this.addObserver=QV(n=>this.observer=n)}get next(){return se(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eg={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Vb(t){eg=t}function bb(t){return eg.loadJS(t)}function Lb(){return eg.gapiScript}function Fb(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ub(t,e){const n=Wm(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),s=n.getOptions();if(ji(s,e??{}))return i;zn(i,"already-initialized")}return n.initialize({options:e})}function Ob(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(tr);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function Bb(t,e,n){const r=bd(t);se(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,s=gC(e),{host:o,port:a}=Gb(e),l=a===null?"":`:${a}`,u={url:`${s}//${o}${l}/`},f=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){se(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),se(ji(u,r.config.emulator)&&ji(f,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=u,r.emulatorConfig=f,r.settings.appVerificationDisabledForTesting=!0,Fo(o)?(qS(`${s}//${o}${l}`),$S("Auth",!0)):qb()}function gC(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function Gb(t){const e=gC(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:gT(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:gT(o)}}}function gT(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function qb(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _C{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return er("not implemented")}_getIdTokenResponse(e){return er("not implemented")}_linkToIdToken(e,n){return er("not implemented")}_getReauthenticationResolver(e){return er("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function no(t,e){return _b(t,"POST","/v1/accounts:signInWithIdp",jm(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $b="http://localhost";class Zi extends _C{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Zi(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):zn("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...s}=n;if(!r||!i)return null;const o=new Zi(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return no(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,no(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,no(e,n)}buildRequest(){const e={requestUri:$b,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Dl(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tg{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vl extends tg{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dr extends Vl{constructor(){super("facebook.com")}static credential(e){return Zi._fromParams({providerId:Dr.PROVIDER_ID,signInMethod:Dr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Dr.credentialFromTaggedObject(e)}static credentialFromError(e){return Dr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Dr.credential(e.oauthAccessToken)}catch{return null}}}Dr.FACEBOOK_SIGN_IN_METHOD="facebook.com";Dr.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jn extends Vl{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Zi._fromParams({providerId:jn.PROVIDER_ID,signInMethod:jn.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return jn.credentialFromTaggedObject(e)}static credentialFromError(e){return jn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return jn.credential(n,r)}catch{return null}}}jn.GOOGLE_SIGN_IN_METHOD="google.com";jn.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mr extends Vl{constructor(){super("github.com")}static credential(e){return Zi._fromParams({providerId:Mr.PROVIDER_ID,signInMethod:Mr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Mr.credentialFromTaggedObject(e)}static credentialFromError(e){return Mr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Mr.credential(e.oauthAccessToken)}catch{return null}}}Mr.GITHUB_SIGN_IN_METHOD="github.com";Mr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vr extends Vl{constructor(){super("twitter.com")}static credential(e,n){return Zi._fromParams({providerId:Vr.PROVIDER_ID,signInMethod:Vr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Vr.credentialFromTaggedObject(e)}static credentialFromError(e){return Vr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Vr.credential(n,r)}catch{return null}}}Vr.TWITTER_SIGN_IN_METHOD="twitter.com";Vr.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mo{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const s=await Cn._fromIdTokenResponse(e,r,i),o=_T(r);return new mo({user:s,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=_T(r);return new mo({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function _T(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jc extends mr{constructor(e,n,r,i){super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,Jc.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new Jc(e,n,r,i)}}function yC(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Jc._fromErrorAndOperation(t,s,e,r):s})}async function zb(t,e,n=!1){const r=await fl(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return mo._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Hb(t,e,n=!1){const{auth:r}=t;if(wn(r.app))return Promise.reject(Gi(r));const i="reauthenticate";try{const s=await fl(t,yC(r,i,e,t),n);se(s.idToken,r,"internal-error");const o=Xm(s.idToken);se(o,r,"internal-error");const{sub:a}=o;return se(t.uid===a,r,"user-mismatch"),mo._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&zn(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Kb(t,e,n=!1){if(wn(t.app))return Promise.reject(Gi(t));const r="signIn",i=await yC(t,r,e),s=await mo._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(s.user),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wb(t,e){return en(t).setPersistence(e)}function Jb(t,e,n,r){return en(t).onIdTokenChanged(e,n,r)}function Qb(t,e,n){return en(t).beforeAuthStateChanged(e,n)}function Yb(t,e,n,r){return en(t).onAuthStateChanged(e,n,r)}function jb(t){return en(t).signOut()}const Qc="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vC{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Qc,"1"),this.storage.removeItem(Qc),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xb=1e3,Zb=10;class TC extends vC{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=pC(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;n?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);Pb()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,Zb):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},Xb)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}TC.type="LOCAL";const EC=TC;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IC extends vC{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}IC.type="SESSION";const wC=IC;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eL(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ld{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new Ld(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:s}=n.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const a=Array.from(o).map(async u=>u(n.origin,s)),l=await eL(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Ld.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ng(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tL{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,l)=>{const u=ng("",20);i.port1.start();const f=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(p){const m=p;if(m.data.eventId===u)switch(m.data.status){case"ack":clearTimeout(f),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(m.data.response);break;default:clearTimeout(f),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $n(){return window}function nL(t){$n().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SC(){return typeof $n().WorkerGlobalScope<"u"&&typeof $n().importScripts=="function"}async function rL(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function iL(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function sL(){return SC()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CC="firebaseLocalStorageDb",oL=1,Yc="firebaseLocalStorage",AC="fbase_key";class bl{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Fd(t,e){return t.transaction([Yc],e?"readwrite":"readonly").objectStore(Yc)}function aL(){const t=indexedDB.deleteDatabase(CC);return new bl(t).toPromise()}function vp(){const t=indexedDB.open(CC,oL);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Yc,{keyPath:AC})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Yc)?e(r):(r.close(),await aL(),e(await vp()))})})}async function yT(t,e,n){const r=Fd(t,!0).put({[AC]:e,value:n});return new bl(r).toPromise()}async function lL(t,e){const n=Fd(t,!1).get(e),r=await new bl(n).toPromise();return r===void 0?null:r.value}function vT(t,e){const n=Fd(t,!0).delete(e);return new bl(n).toPromise()}const uL=800,cL=3;class RC{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await vp(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>cL)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return SC()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Ld._getInstance(sL()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await rL(),!this.activeServiceWorker)return;this.sender=new tL(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||iL()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await vp();return await yT(e,Qc,"1"),await vT(e,Qc),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>yT(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>lL(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>vT(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=Fd(i,!1).getAll();return new bl(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),uL)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}RC.type="LOCAL";const dL=RC;new Ml(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PC(t,e){return e?tr(e):(se(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rg extends _C{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return no(e,this._buildIdpRequest())}_linkToIdToken(e,n){return no(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return no(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function hL(t){return Kb(t.auth,new rg(t),t.bypassAuthState)}function fL(t){const{auth:e,user:n}=t;return se(n,e,"internal-error"),Hb(n,new rg(t),t.bypassAuthState)}async function pL(t){const{auth:e,user:n}=t;return se(n,e,"internal-error"),zb(n,new rg(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xC{constructor(e,n,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return hL;case"linkViaPopup":case"linkViaRedirect":return pL;case"reauthViaPopup":case"reauthViaRedirect":return fL;default:zn(this.auth,"internal-error")}}resolve(e){cr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){cr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mL=new Ml(2e3,1e4);async function gL(t,e,n){if(wn(t.app))return Promise.reject(Pn(t,"operation-not-supported-in-this-environment"));const r=bd(t);cb(t,e,tg);const i=PC(r,n);return new Fi(r,"signInViaPopup",e,i).executeNotNull()}class Fi extends xC{constructor(e,n,r,i,s){super(e,n,i,s),this.provider=r,this.authWindow=null,this.pollId=null,Fi.currentPopupAction&&Fi.currentPopupAction.cancel(),Fi.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return se(e,this.auth,"internal-error"),e}async onExecution(){cr(this.filter.length===1,"Popup operations only handle one event");const e=ng();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Pn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Pn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Fi.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Pn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,mL.get())};e()}}Fi.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _L="pendingRedirect",nc=new Map;class yL extends xC{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=nc.get(this.auth._key());if(!e){try{const r=await vL(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}nc.set(this.auth._key(),e)}return this.bypassAuthState||nc.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function vL(t,e){const n=IL(e),r=EL(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}function TL(t,e){nc.set(t._key(),e)}function EL(t){return tr(t._redirectPersistence)}function IL(t){return tc(_L,t.config.apiKey,t.name)}async function wL(t,e,n=!1){if(wn(t.app))return Promise.reject(Gi(t));const r=bd(t),i=PC(r,e),o=await new yL(r,i,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SL=10*60*1e3;class CL{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!AL(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!kC(e)){const i=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(Pn(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=SL&&this.cachedEventUids.clear(),this.cachedEventUids.has(TT(e))}saveEventToCache(e){this.cachedEventUids.add(TT(e)),this.lastProcessedEventTime=Date.now()}}function TT(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function kC({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function AL(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return kC(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function RL(t,e={}){return Oo(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PL=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,xL=/^https?/;async function kL(t){if(t.config.emulator)return;const{authorizedDomains:e}=await RL(t);for(const n of e)try{if(NL(n))return}catch{}zn(t,"unauthorized-domain")}function NL(t){const e=_p(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!xL.test(n))return!1;if(PL.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DL=new Ml(3e4,6e4);function ET(){const t=$n().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function ML(t){return new Promise((e,n)=>{var i,s,o;function r(){ET(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{ET(),n(Pn(t,"network-request-failed"))},timeout:DL.get()})}if((s=(i=$n().gapi)==null?void 0:i.iframes)!=null&&s.Iframe)e(gapi.iframes.getContext());else if((o=$n().gapi)!=null&&o.load)r();else{const a=Fb("iframefcb");return $n()[a]=()=>{gapi.load?r():n(Pn(t,"network-request-failed"))},bb(`${Lb()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw rc=null,e})}let rc=null;function VL(t){return rc=rc||ML(t),rc}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bL=new Ml(5e3,15e3),LL="__/auth/iframe",FL="emulator/auth/iframe",UL={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},OL=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function BL(t){const e=t.config;se(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Ym(e,FL):`https://${t.config.authDomain}/${LL}`,r={apiKey:e.apiKey,appName:t.name,v:Uo},i=OL.get(t.config.apiHost);i&&(r.eid=i);const s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${Dl(r).slice(1)}`}async function GL(t){const e=await VL(t),n=$n().gapi;return se(n,t,"internal-error"),e.open({where:document.body,url:BL(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:UL,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=Pn(t,"network-request-failed"),a=$n().setTimeout(()=>{s(o)},bL.get());function l(){$n().clearTimeout(a),i(r)}r.ping(l).then(l,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qL={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},$L=500,zL=600,HL="_blank",KL="http://localhost";class IT{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function WL(t,e,n,r=$L,i=zL){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l={...qL,width:r.toString(),height:i.toString(),top:s,left:o},u=ct().toLowerCase();n&&(a=uC(u)?HL:n),aC(u)&&(e=e||KL,l.scrollbars="yes");const f=Object.entries(l).reduce((m,[v,I])=>`${m}${v}=${I},`,"");if(Rb(u)&&a!=="_self")return JL(e||"",a),new IT(null);const p=window.open(e||"",a,f);se(p,t,"popup-blocked");try{p.focus()}catch{}return new IT(p)}function JL(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QL="__/auth/handler",YL="emulator/auth/handler",jL=encodeURIComponent("fac");async function wT(t,e,n,r,i,s){se(t.config.authDomain,t,"auth-domain-config-required"),se(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Uo,eventId:i};if(e instanceof tg){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",JV(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,p]of Object.entries({}))o[f]=p}if(e instanceof Vl){const f=e.getScopes().filter(p=>p!=="");f.length>0&&(o.scopes=f.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const f of Object.keys(a))a[f]===void 0&&delete a[f];const l=await t._getAppCheckToken(),u=l?`#${jL}=${encodeURIComponent(l)}`:"";return`${XL(t)}?${Dl(a).slice(1)}${u}`}function XL({config:t}){return t.emulator?Ym(t,YL):`https://${t.authDomain}/${QL}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tf="webStorageSupport";class ZL{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=wC,this._completeRedirectFn=wL,this._overrideRedirectResult=TL}async _openPopup(e,n,r,i){var o;cr((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const s=await wT(e,n,r,_p(),i);return WL(e,s,ng())}async _openRedirect(e,n,r,i){await this._originValidation(e);const s=await wT(e,n,r,_p(),i);return nL(s),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:s}=this.eventManagers[n];return i?Promise.resolve(i):(cr(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await GL(e),r=new CL(e);return n.register("authEvent",i=>(se(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(tf,{type:tf},i=>{var o;const s=(o=i==null?void 0:i[0])==null?void 0:o[tf];s!==void 0&&n(!!s),zn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=kL(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return pC()||lC()||Zm()}}const eF=ZL;var ST="@firebase/auth",CT="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tF{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){se(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nF(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function rF(t){po(new Xi("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;se(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:mC(t)},u=new Mb(r,i,s,l);return Ob(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),po(new Xi("auth-internal",e=>{const n=bd(e.getProvider("auth").getImmediate());return(r=>new tF(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Qr(ST,CT,nF(t)),Qr(ST,CT,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iF=5*60,sF=GS("authIdTokenMaxAge")||iF;let AT=null;const oF=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>sF)return;const i=n==null?void 0:n.token;AT!==i&&(AT=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function aF(t=jS()){const e=Wm(t,"auth");if(e.isInitialized())return e.getImmediate();const n=Ub(t,{popupRedirectResolver:eF,persistence:[dL,EC,wC]}),r=GS("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const o=oF(s.toString());Qb(n,o,()=>o(n.currentUser)),Jb(n,a=>o(a))}}const i=OS("auth");return i&&Bb(n,`http://${i}`),n}function lF(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}Vb({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const s=Pn("internal-error");s.customData=i,n(s)},r.type="text/javascript",r.charset="UTF-8",lF().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});rF("Browser");var RT=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Yr,NC;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(C,E){function R(){}R.prototype=E.prototype,C.F=E.prototype,C.prototype=new R,C.prototype.constructor=C,C.D=function(P,N,D){for(var k=Array(arguments.length-2),ne=2;ne<arguments.length;ne++)k[ne-2]=arguments[ne];return E.prototype[N].apply(P,k)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(C,E,R){R||(R=0);const P=Array(16);if(typeof E=="string")for(var N=0;N<16;++N)P[N]=E.charCodeAt(R++)|E.charCodeAt(R++)<<8|E.charCodeAt(R++)<<16|E.charCodeAt(R++)<<24;else for(N=0;N<16;++N)P[N]=E[R++]|E[R++]<<8|E[R++]<<16|E[R++]<<24;E=C.g[0],R=C.g[1],N=C.g[2];let D=C.g[3],k;k=E+(D^R&(N^D))+P[0]+3614090360&4294967295,E=R+(k<<7&4294967295|k>>>25),k=D+(N^E&(R^N))+P[1]+3905402710&4294967295,D=E+(k<<12&4294967295|k>>>20),k=N+(R^D&(E^R))+P[2]+606105819&4294967295,N=D+(k<<17&4294967295|k>>>15),k=R+(E^N&(D^E))+P[3]+3250441966&4294967295,R=N+(k<<22&4294967295|k>>>10),k=E+(D^R&(N^D))+P[4]+4118548399&4294967295,E=R+(k<<7&4294967295|k>>>25),k=D+(N^E&(R^N))+P[5]+1200080426&4294967295,D=E+(k<<12&4294967295|k>>>20),k=N+(R^D&(E^R))+P[6]+2821735955&4294967295,N=D+(k<<17&4294967295|k>>>15),k=R+(E^N&(D^E))+P[7]+4249261313&4294967295,R=N+(k<<22&4294967295|k>>>10),k=E+(D^R&(N^D))+P[8]+1770035416&4294967295,E=R+(k<<7&4294967295|k>>>25),k=D+(N^E&(R^N))+P[9]+2336552879&4294967295,D=E+(k<<12&4294967295|k>>>20),k=N+(R^D&(E^R))+P[10]+4294925233&4294967295,N=D+(k<<17&4294967295|k>>>15),k=R+(E^N&(D^E))+P[11]+2304563134&4294967295,R=N+(k<<22&4294967295|k>>>10),k=E+(D^R&(N^D))+P[12]+1804603682&4294967295,E=R+(k<<7&4294967295|k>>>25),k=D+(N^E&(R^N))+P[13]+4254626195&4294967295,D=E+(k<<12&4294967295|k>>>20),k=N+(R^D&(E^R))+P[14]+2792965006&4294967295,N=D+(k<<17&4294967295|k>>>15),k=R+(E^N&(D^E))+P[15]+1236535329&4294967295,R=N+(k<<22&4294967295|k>>>10),k=E+(N^D&(R^N))+P[1]+4129170786&4294967295,E=R+(k<<5&4294967295|k>>>27),k=D+(R^N&(E^R))+P[6]+3225465664&4294967295,D=E+(k<<9&4294967295|k>>>23),k=N+(E^R&(D^E))+P[11]+643717713&4294967295,N=D+(k<<14&4294967295|k>>>18),k=R+(D^E&(N^D))+P[0]+3921069994&4294967295,R=N+(k<<20&4294967295|k>>>12),k=E+(N^D&(R^N))+P[5]+3593408605&4294967295,E=R+(k<<5&4294967295|k>>>27),k=D+(R^N&(E^R))+P[10]+38016083&4294967295,D=E+(k<<9&4294967295|k>>>23),k=N+(E^R&(D^E))+P[15]+3634488961&4294967295,N=D+(k<<14&4294967295|k>>>18),k=R+(D^E&(N^D))+P[4]+3889429448&4294967295,R=N+(k<<20&4294967295|k>>>12),k=E+(N^D&(R^N))+P[9]+568446438&4294967295,E=R+(k<<5&4294967295|k>>>27),k=D+(R^N&(E^R))+P[14]+3275163606&4294967295,D=E+(k<<9&4294967295|k>>>23),k=N+(E^R&(D^E))+P[3]+4107603335&4294967295,N=D+(k<<14&4294967295|k>>>18),k=R+(D^E&(N^D))+P[8]+1163531501&4294967295,R=N+(k<<20&4294967295|k>>>12),k=E+(N^D&(R^N))+P[13]+2850285829&4294967295,E=R+(k<<5&4294967295|k>>>27),k=D+(R^N&(E^R))+P[2]+4243563512&4294967295,D=E+(k<<9&4294967295|k>>>23),k=N+(E^R&(D^E))+P[7]+1735328473&4294967295,N=D+(k<<14&4294967295|k>>>18),k=R+(D^E&(N^D))+P[12]+2368359562&4294967295,R=N+(k<<20&4294967295|k>>>12),k=E+(R^N^D)+P[5]+4294588738&4294967295,E=R+(k<<4&4294967295|k>>>28),k=D+(E^R^N)+P[8]+2272392833&4294967295,D=E+(k<<11&4294967295|k>>>21),k=N+(D^E^R)+P[11]+1839030562&4294967295,N=D+(k<<16&4294967295|k>>>16),k=R+(N^D^E)+P[14]+4259657740&4294967295,R=N+(k<<23&4294967295|k>>>9),k=E+(R^N^D)+P[1]+2763975236&4294967295,E=R+(k<<4&4294967295|k>>>28),k=D+(E^R^N)+P[4]+1272893353&4294967295,D=E+(k<<11&4294967295|k>>>21),k=N+(D^E^R)+P[7]+4139469664&4294967295,N=D+(k<<16&4294967295|k>>>16),k=R+(N^D^E)+P[10]+3200236656&4294967295,R=N+(k<<23&4294967295|k>>>9),k=E+(R^N^D)+P[13]+681279174&4294967295,E=R+(k<<4&4294967295|k>>>28),k=D+(E^R^N)+P[0]+3936430074&4294967295,D=E+(k<<11&4294967295|k>>>21),k=N+(D^E^R)+P[3]+3572445317&4294967295,N=D+(k<<16&4294967295|k>>>16),k=R+(N^D^E)+P[6]+76029189&4294967295,R=N+(k<<23&4294967295|k>>>9),k=E+(R^N^D)+P[9]+3654602809&4294967295,E=R+(k<<4&4294967295|k>>>28),k=D+(E^R^N)+P[12]+3873151461&4294967295,D=E+(k<<11&4294967295|k>>>21),k=N+(D^E^R)+P[15]+530742520&4294967295,N=D+(k<<16&4294967295|k>>>16),k=R+(N^D^E)+P[2]+3299628645&4294967295,R=N+(k<<23&4294967295|k>>>9),k=E+(N^(R|~D))+P[0]+4096336452&4294967295,E=R+(k<<6&4294967295|k>>>26),k=D+(R^(E|~N))+P[7]+1126891415&4294967295,D=E+(k<<10&4294967295|k>>>22),k=N+(E^(D|~R))+P[14]+2878612391&4294967295,N=D+(k<<15&4294967295|k>>>17),k=R+(D^(N|~E))+P[5]+4237533241&4294967295,R=N+(k<<21&4294967295|k>>>11),k=E+(N^(R|~D))+P[12]+1700485571&4294967295,E=R+(k<<6&4294967295|k>>>26),k=D+(R^(E|~N))+P[3]+2399980690&4294967295,D=E+(k<<10&4294967295|k>>>22),k=N+(E^(D|~R))+P[10]+4293915773&4294967295,N=D+(k<<15&4294967295|k>>>17),k=R+(D^(N|~E))+P[1]+2240044497&4294967295,R=N+(k<<21&4294967295|k>>>11),k=E+(N^(R|~D))+P[8]+1873313359&4294967295,E=R+(k<<6&4294967295|k>>>26),k=D+(R^(E|~N))+P[15]+4264355552&4294967295,D=E+(k<<10&4294967295|k>>>22),k=N+(E^(D|~R))+P[6]+2734768916&4294967295,N=D+(k<<15&4294967295|k>>>17),k=R+(D^(N|~E))+P[13]+1309151649&4294967295,R=N+(k<<21&4294967295|k>>>11),k=E+(N^(R|~D))+P[4]+4149444226&4294967295,E=R+(k<<6&4294967295|k>>>26),k=D+(R^(E|~N))+P[11]+3174756917&4294967295,D=E+(k<<10&4294967295|k>>>22),k=N+(E^(D|~R))+P[2]+718787259&4294967295,N=D+(k<<15&4294967295|k>>>17),k=R+(D^(N|~E))+P[9]+3951481745&4294967295,C.g[0]=C.g[0]+E&4294967295,C.g[1]=C.g[1]+(N+(k<<21&4294967295|k>>>11))&4294967295,C.g[2]=C.g[2]+N&4294967295,C.g[3]=C.g[3]+D&4294967295}r.prototype.v=function(C,E){E===void 0&&(E=C.length);const R=E-this.blockSize,P=this.C;let N=this.h,D=0;for(;D<E;){if(N==0)for(;D<=R;)i(this,C,D),D+=this.blockSize;if(typeof C=="string"){for(;D<E;)if(P[N++]=C.charCodeAt(D++),N==this.blockSize){i(this,P),N=0;break}}else for(;D<E;)if(P[N++]=C[D++],N==this.blockSize){i(this,P),N=0;break}}this.h=N,this.o+=E},r.prototype.A=function(){var C=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);C[0]=128;for(var E=1;E<C.length-8;++E)C[E]=0;E=this.o*8;for(var R=C.length-8;R<C.length;++R)C[R]=E&255,E/=256;for(this.v(C),C=Array(16),E=0,R=0;R<4;++R)for(let P=0;P<32;P+=8)C[E++]=this.g[R]>>>P&255;return C};function s(C,E){var R=a;return Object.prototype.hasOwnProperty.call(R,C)?R[C]:R[C]=E(C)}function o(C,E){this.h=E;const R=[];let P=!0;for(let N=C.length-1;N>=0;N--){const D=C[N]|0;P&&D==E||(R[N]=D,P=!1)}this.g=R}var a={};function l(C){return-128<=C&&C<128?s(C,function(E){return new o([E|0],E<0?-1:0)}):new o([C|0],C<0?-1:0)}function u(C){if(isNaN(C)||!isFinite(C))return p;if(C<0)return M(u(-C));const E=[];let R=1;for(let P=0;C>=R;P++)E[P]=C/R|0,R*=4294967296;return new o(E,0)}function f(C,E){if(C.length==0)throw Error("number format error: empty string");if(E=E||10,E<2||36<E)throw Error("radix out of range: "+E);if(C.charAt(0)=="-")return M(f(C.substring(1),E));if(C.indexOf("-")>=0)throw Error('number format error: interior "-" character');const R=u(Math.pow(E,8));let P=p;for(let D=0;D<C.length;D+=8){var N=Math.min(8,C.length-D);const k=parseInt(C.substring(D,D+N),E);N<8?(N=u(Math.pow(E,N)),P=P.j(N).add(u(k))):(P=P.j(R),P=P.add(u(k)))}return P}var p=l(0),m=l(1),v=l(16777216);t=o.prototype,t.m=function(){if(x(this))return-M(this).m();let C=0,E=1;for(let R=0;R<this.g.length;R++){const P=this.i(R);C+=(P>=0?P:4294967296+P)*E,E*=4294967296}return C},t.toString=function(C){if(C=C||10,C<2||36<C)throw Error("radix out of range: "+C);if(I(this))return"0";if(x(this))return"-"+M(this).toString(C);const E=u(Math.pow(C,6));var R=this;let P="";for(;;){const N=V(R,E).g;R=A(R,N.j(E));let D=((R.g.length>0?R.g[0]:R.h)>>>0).toString(C);if(R=N,I(R))return D+P;for(;D.length<6;)D="0"+D;P=D+P}},t.i=function(C){return C<0?0:C<this.g.length?this.g[C]:this.h};function I(C){if(C.h!=0)return!1;for(let E=0;E<C.g.length;E++)if(C.g[E]!=0)return!1;return!0}function x(C){return C.h==-1}t.l=function(C){return C=A(this,C),x(C)?-1:I(C)?0:1};function M(C){const E=C.g.length,R=[];for(let P=0;P<E;P++)R[P]=~C.g[P];return new o(R,~C.h).add(m)}t.abs=function(){return x(this)?M(this):this},t.add=function(C){const E=Math.max(this.g.length,C.g.length),R=[];let P=0;for(let N=0;N<=E;N++){let D=P+(this.i(N)&65535)+(C.i(N)&65535),k=(D>>>16)+(this.i(N)>>>16)+(C.i(N)>>>16);P=k>>>16,D&=65535,k&=65535,R[N]=k<<16|D}return new o(R,R[R.length-1]&-2147483648?-1:0)};function A(C,E){return C.add(M(E))}t.j=function(C){if(I(this)||I(C))return p;if(x(this))return x(C)?M(this).j(M(C)):M(M(this).j(C));if(x(C))return M(this.j(M(C)));if(this.l(v)<0&&C.l(v)<0)return u(this.m()*C.m());const E=this.g.length+C.g.length,R=[];for(var P=0;P<2*E;P++)R[P]=0;for(P=0;P<this.g.length;P++)for(let N=0;N<C.g.length;N++){const D=this.i(P)>>>16,k=this.i(P)&65535,ne=C.i(N)>>>16,ye=C.i(N)&65535;R[2*P+2*N]+=k*ye,T(R,2*P+2*N),R[2*P+2*N+1]+=D*ye,T(R,2*P+2*N+1),R[2*P+2*N+1]+=k*ne,T(R,2*P+2*N+1),R[2*P+2*N+2]+=D*ne,T(R,2*P+2*N+2)}for(C=0;C<E;C++)R[C]=R[2*C+1]<<16|R[2*C];for(C=E;C<2*E;C++)R[C]=0;return new o(R,0)};function T(C,E){for(;(C[E]&65535)!=C[E];)C[E+1]+=C[E]>>>16,C[E]&=65535,E++}function S(C,E){this.g=C,this.h=E}function V(C,E){if(I(E))throw Error("division by zero");if(I(C))return new S(p,p);if(x(C))return E=V(M(C),E),new S(M(E.g),M(E.h));if(x(E))return E=V(C,M(E)),new S(M(E.g),E.h);if(C.g.length>30){if(x(C)||x(E))throw Error("slowDivide_ only works with positive integers.");for(var R=m,P=E;P.l(C)<=0;)R=U(R),P=U(P);var N=F(R,1),D=F(P,1);for(P=F(P,2),R=F(R,2);!I(P);){var k=D.add(P);k.l(C)<=0&&(N=N.add(R),D=k),P=F(P,1),R=F(R,1)}return E=A(C,N.j(E)),new S(N,E)}for(N=p;C.l(E)>=0;){for(R=Math.max(1,Math.floor(C.m()/E.m())),P=Math.ceil(Math.log(R)/Math.LN2),P=P<=48?1:Math.pow(2,P-48),D=u(R),k=D.j(E);x(k)||k.l(C)>0;)R-=P,D=u(R),k=D.j(E);I(D)&&(D=m),N=N.add(D),C=A(C,k)}return new S(N,C)}t.B=function(C){return V(this,C).h},t.and=function(C){const E=Math.max(this.g.length,C.g.length),R=[];for(let P=0;P<E;P++)R[P]=this.i(P)&C.i(P);return new o(R,this.h&C.h)},t.or=function(C){const E=Math.max(this.g.length,C.g.length),R=[];for(let P=0;P<E;P++)R[P]=this.i(P)|C.i(P);return new o(R,this.h|C.h)},t.xor=function(C){const E=Math.max(this.g.length,C.g.length),R=[];for(let P=0;P<E;P++)R[P]=this.i(P)^C.i(P);return new o(R,this.h^C.h)};function U(C){const E=C.g.length+1,R=[];for(let P=0;P<E;P++)R[P]=C.i(P)<<1|C.i(P-1)>>>31;return new o(R,C.h)}function F(C,E){const R=E>>5;E%=32;const P=C.g.length-R,N=[];for(let D=0;D<P;D++)N[D]=E>0?C.i(D+R)>>>E|C.i(D+R+1)<<32-E:C.i(D+R);return new o(N,C.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,NC=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=f,Yr=o}).apply(typeof RT<"u"?RT:typeof self<"u"?self:typeof window<"u"?window:{});var Du=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var DC,Sa,MC,ic,Tp,VC,bC,LC;(function(){var t,e=Object.defineProperty;function n(d){d=[typeof globalThis=="object"&&globalThis,d,typeof window=="object"&&window,typeof self=="object"&&self,typeof Du=="object"&&Du];for(var g=0;g<d.length;++g){var y=d[g];if(y&&y.Math==Math)return y}throw Error("Cannot find global object")}var r=n(this);function i(d,g){if(g)e:{var y=r;d=d.split(".");for(var w=0;w<d.length-1;w++){var L=d[w];if(!(L in y))break e;y=y[L]}d=d[d.length-1],w=y[d],g=g(w),g!=w&&g!=null&&e(y,d,{configurable:!0,writable:!0,value:g})}}i("Symbol.dispose",function(d){return d||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(d){return d||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(d){return d||function(g){var y=[],w;for(w in g)Object.prototype.hasOwnProperty.call(g,w)&&y.push([w,g[w]]);return y}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var s=s||{},o=this||self;function a(d){var g=typeof d;return g=="object"&&d!=null||g=="function"}function l(d,g,y){return d.call.apply(d.bind,arguments)}function u(d,g,y){return u=l,u.apply(null,arguments)}function f(d,g){var y=Array.prototype.slice.call(arguments,1);return function(){var w=y.slice();return w.push.apply(w,arguments),d.apply(this,w)}}function p(d,g){function y(){}y.prototype=g.prototype,d.Z=g.prototype,d.prototype=new y,d.prototype.constructor=d,d.Ob=function(w,L,O){for(var K=Array(arguments.length-2),he=2;he<arguments.length;he++)K[he-2]=arguments[he];return g.prototype[L].apply(w,K)}}var m=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?d=>d&&AsyncContext.Snapshot.wrap(d):d=>d;function v(d){const g=d.length;if(g>0){const y=Array(g);for(let w=0;w<g;w++)y[w]=d[w];return y}return[]}function I(d,g){for(let w=1;w<arguments.length;w++){const L=arguments[w];var y=typeof L;if(y=y!="object"?y:L?Array.isArray(L)?"array":y:"null",y=="array"||y=="object"&&typeof L.length=="number"){y=d.length||0;const O=L.length||0;d.length=y+O;for(let K=0;K<O;K++)d[y+K]=L[K]}else d.push(L)}}class x{constructor(g,y){this.i=g,this.j=y,this.h=0,this.g=null}get(){let g;return this.h>0?(this.h--,g=this.g,this.g=g.next,g.next=null):g=this.i(),g}}function M(d){o.setTimeout(()=>{throw d},0)}function A(){var d=C;let g=null;return d.g&&(g=d.g,d.g=d.g.next,d.g||(d.h=null),g.next=null),g}class T{constructor(){this.h=this.g=null}add(g,y){const w=S.get();w.set(g,y),this.h?this.h.next=w:this.g=w,this.h=w}}var S=new x(()=>new V,d=>d.reset());class V{constructor(){this.next=this.g=this.h=null}set(g,y){this.h=g,this.g=y,this.next=null}reset(){this.next=this.g=this.h=null}}let U,F=!1,C=new T,E=()=>{const d=Promise.resolve(void 0);U=()=>{d.then(R)}};function R(){for(var d;d=A();){try{d.h.call(d.g)}catch(y){M(y)}var g=S;g.j(d),g.h<100&&(g.h++,d.next=g.g,g.g=d)}F=!1}function P(){this.u=this.u,this.C=this.C}P.prototype.u=!1,P.prototype.dispose=function(){this.u||(this.u=!0,this.N())},P.prototype[Symbol.dispose]=function(){this.dispose()},P.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function N(d,g){this.type=d,this.g=this.target=g,this.defaultPrevented=!1}N.prototype.h=function(){this.defaultPrevented=!0};var D=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var d=!1,g=Object.defineProperty({},"passive",{get:function(){d=!0}});try{const y=()=>{};o.addEventListener("test",y,g),o.removeEventListener("test",y,g)}catch{}return d}();function k(d){return/^[\s\xa0]*$/.test(d)}function ne(d,g){N.call(this,d?d.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,d&&this.init(d,g)}p(ne,N),ne.prototype.init=function(d,g){const y=this.type=d.type,w=d.changedTouches&&d.changedTouches.length?d.changedTouches[0]:null;this.target=d.target||d.srcElement,this.g=g,g=d.relatedTarget,g||(y=="mouseover"?g=d.fromElement:y=="mouseout"&&(g=d.toElement)),this.relatedTarget=g,w?(this.clientX=w.clientX!==void 0?w.clientX:w.pageX,this.clientY=w.clientY!==void 0?w.clientY:w.pageY,this.screenX=w.screenX||0,this.screenY=w.screenY||0):(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0),this.button=d.button,this.key=d.key||"",this.ctrlKey=d.ctrlKey,this.altKey=d.altKey,this.shiftKey=d.shiftKey,this.metaKey=d.metaKey,this.pointerId=d.pointerId||0,this.pointerType=d.pointerType,this.state=d.state,this.i=d,d.defaultPrevented&&ne.Z.h.call(this)},ne.prototype.h=function(){ne.Z.h.call(this);const d=this.i;d.preventDefault?d.preventDefault():d.returnValue=!1};var ye="closure_listenable_"+(Math.random()*1e6|0),Ce=0;function oe(d,g,y,w,L){this.listener=d,this.proxy=null,this.src=g,this.type=y,this.capture=!!w,this.ha=L,this.key=++Ce,this.da=this.fa=!1}function W(d){d.da=!0,d.listener=null,d.proxy=null,d.src=null,d.ha=null}function ee(d,g,y){for(const w in d)g.call(y,d[w],w,d)}function ie(d,g){for(const y in d)g.call(void 0,d[y],y,d)}function Ee(d){const g={};for(const y in d)g[y]=d[y];return g}const Ae="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ve(d,g){let y,w;for(let L=1;L<arguments.length;L++){w=arguments[L];for(y in w)d[y]=w[y];for(let O=0;O<Ae.length;O++)y=Ae[O],Object.prototype.hasOwnProperty.call(w,y)&&(d[y]=w[y])}}function be(d){this.src=d,this.g={},this.h=0}be.prototype.add=function(d,g,y,w,L){const O=d.toString();d=this.g[O],d||(d=this.g[O]=[],this.h++);const K=st(d,g,w,L);return K>-1?(g=d[K],y||(g.fa=!1)):(g=new oe(g,this.src,O,!!w,L),g.fa=y,d.push(g)),g};function sn(d,g){const y=g.type;if(y in d.g){var w=d.g[y],L=Array.prototype.indexOf.call(w,g,void 0),O;(O=L>=0)&&Array.prototype.splice.call(w,L,1),O&&(W(g),d.g[y].length==0&&(delete d.g[y],d.h--))}}function st(d,g,y,w){for(let L=0;L<d.length;++L){const O=d[L];if(!O.da&&O.listener==g&&O.capture==!!y&&O.ha==w)return L}return-1}var on="closure_lm_"+(Math.random()*1e6|0),zt={};function hs(d,g,y,w,L){if(Array.isArray(g)){for(let O=0;O<g.length;O++)hs(d,g[O],y,w,L);return null}return y=Jl(y),d&&d[ye]?d.J(g,y,a(w)?!!w.capture:!1,L):ae(d,g,y,!1,w,L)}function ae(d,g,y,w,L,O){if(!g)throw Error("Invalid event type");const K=a(L)?!!L.capture:!!L;let he=$o(d);if(he||(d[on]=he=new be(d)),y=he.add(g,y,w,K,O),y.proxy)return y;if(w=_n(),y.proxy=w,w.src=d,w.listener=y,d.addEventListener)D||(L=K),L===void 0&&(L=!1),d.addEventListener(g.toString(),w,L);else if(d.attachEvent)d.attachEvent(oh(g.toString()),w);else if(d.addListener&&d.removeListener)d.addListener(w);else throw Error("addEventListener and attachEvent are unavailable.");return y}function _n(){function d(y){return g.call(d.src,d.listener,y)}const g=Hg;return d}function Kn(d,g,y,w,L){if(Array.isArray(g))for(var O=0;O<g.length;O++)Kn(d,g[O],y,w,L);else w=a(w)?!!w.capture:!!w,y=Jl(y),d&&d[ye]?(d=d.i,O=String(g).toString(),O in d.g&&(g=d.g[O],y=st(g,y,w,L),y>-1&&(W(g[y]),Array.prototype.splice.call(g,y,1),g.length==0&&(delete d.g[O],d.h--)))):d&&(d=$o(d))&&(g=d.g[g.toString()],d=-1,g&&(d=st(g,y,w,L)),(y=d>-1?g[d]:null)&&Wl(y))}function Wl(d){if(typeof d!="number"&&d&&!d.da){var g=d.src;if(g&&g[ye])sn(g.i,d);else{var y=d.type,w=d.proxy;g.removeEventListener?g.removeEventListener(y,w,d.capture):g.detachEvent?g.detachEvent(oh(y),w):g.addListener&&g.removeListener&&g.removeListener(w),(y=$o(g))?(sn(y,d),y.h==0&&(y.src=null,g[on]=null)):W(d)}}}function oh(d){return d in zt?zt[d]:zt[d]="on"+d}function Hg(d,g){if(d.da)d=!0;else{g=new ne(g,this);const y=d.listener,w=d.ha||d.src;d.fa&&Wl(d),d=y.call(w,g)}return d}function $o(d){return d=d[on],d instanceof be?d:null}var pi="__closure_events_fn_"+(Math.random()*1e9>>>0);function Jl(d){return typeof d=="function"?d:(d[pi]||(d[pi]=function(g){return d.handleEvent(g)}),d[pi])}function et(){P.call(this),this.i=new be(this),this.M=this,this.G=null}p(et,P),et.prototype[ye]=!0,et.prototype.removeEventListener=function(d,g,y,w){Kn(this,d,g,y,w)};function _t(d,g){var y,w=d.G;if(w)for(y=[];w;w=w.G)y.push(w);if(d=d.M,w=g.type||g,typeof g=="string")g=new N(g,d);else if(g instanceof N)g.target=g.target||d;else{var L=g;g=new N(w,d),Ve(g,L)}L=!0;let O,K;if(y)for(K=y.length-1;K>=0;K--)O=g.g=y[K],L=_r(O,w,!0,g)&&L;if(O=g.g=d,L=_r(O,w,!0,g)&&L,L=_r(O,w,!1,g)&&L,y)for(K=0;K<y.length;K++)O=g.g=y[K],L=_r(O,w,!1,g)&&L}et.prototype.N=function(){if(et.Z.N.call(this),this.i){var d=this.i;for(const g in d.g){const y=d.g[g];for(let w=0;w<y.length;w++)W(y[w]);delete d.g[g],d.h--}}this.G=null},et.prototype.J=function(d,g,y,w){return this.i.add(String(d),g,!1,y,w)},et.prototype.K=function(d,g,y,w){return this.i.add(String(d),g,!0,y,w)};function _r(d,g,y,w){if(g=d.i.g[String(g)],!g)return!0;g=g.concat();let L=!0;for(let O=0;O<g.length;++O){const K=g[O];if(K&&!K.da&&K.capture==y){const he=K.listener,ot=K.ha||K.src;K.fa&&sn(d.i,K),L=he.call(ot,w)!==!1&&L}}return L&&!w.defaultPrevented}function ah(d,g){if(typeof d!="function")if(d&&typeof d.handleEvent=="function")d=u(d.handleEvent,d);else throw Error("Invalid listener argument");return Number(g)>2147483647?-1:o.setTimeout(d,g||0)}function fs(d){d.g=ah(()=>{d.g=null,d.i&&(d.i=!1,fs(d))},d.l);const g=d.h;d.h=null,d.m.apply(null,g)}class lh extends P{constructor(g,y){super(),this.m=g,this.l=y,this.h=null,this.i=!1,this.g=null}j(g){this.h=arguments,this.g?this.i=!0:fs(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function mi(d){P.call(this),this.h=d,this.g={}}p(mi,P);var Ql=[];function Yl(d){ee(d.g,function(g,y){this.g.hasOwnProperty(y)&&Wl(g)},d),d.g={}}mi.prototype.N=function(){mi.Z.N.call(this),Yl(this)},mi.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ce=o.JSON.stringify,ps=o.JSON.parse,uh=class{stringify(d){return o.JSON.stringify(d,void 0)}parse(d){return o.JSON.parse(d,void 0)}};function ms(){}function jl(){}var gi={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function zo(){N.call(this,"d")}p(zo,N);function Ho(){N.call(this,"c")}p(Ho,N);var Wn={},Xl=null;function gs(){return Xl=Xl||new et}Wn.Ia="serverreachability";function Zl(d){N.call(this,Wn.Ia,d)}p(Zl,N);function _i(d){const g=gs();_t(g,new Zl(g))}Wn.STAT_EVENT="statevent";function Ko(d,g){N.call(this,Wn.STAT_EVENT,d),this.stat=g}p(Ko,N);function yt(d){const g=gs();_t(g,new Ko(g,d))}Wn.Ja="timingevent";function eu(d,g){N.call(this,Wn.Ja,d),this.size=g}p(eu,N);function yi(d,g){if(typeof d!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){d()},g)}function vi(){this.g=!0}vi.prototype.ua=function(){this.g=!1};function ch(d,g,y,w,L,O){d.info(function(){if(d.g)if(O){var K="",he=O.split("&");for(let Me=0;Me<he.length;Me++){var ot=he[Me].split("=");if(ot.length>1){const ft=ot[0];ot=ot[1];const Vn=ft.split("_");K=Vn.length>=2&&Vn[1]=="type"?K+(ft+"="+ot+"&"):K+(ft+"=redacted&")}}}else K=null;else K=O;return"XMLHTTP REQ ("+w+") [attempt "+L+"]: "+g+`
`+y+`
`+K})}function q(d,g,y,w,L,O,K){d.info(function(){return"XMLHTTP RESP ("+w+") [ attempt "+L+"]: "+g+`
`+y+`
`+O+" "+K})}function H(d,g,y,w){d.info(function(){return"XMLHTTP TEXT ("+g+"): "+pe(d,y)+(w?" "+w:"")})}function j(d,g){d.info(function(){return"TIMEOUT: "+g})}vi.prototype.info=function(){};function pe(d,g){if(!d.g)return g;if(!g)return null;try{const O=JSON.parse(g);if(O){for(d=0;d<O.length;d++)if(Array.isArray(O[d])){var y=O[d];if(!(y.length<2)){var w=y[1];if(Array.isArray(w)&&!(w.length<1)){var L=w[0];if(L!="noop"&&L!="stop"&&L!="close")for(let K=1;K<w.length;K++)w[K]=""}}}}return ce(O)}catch{return g}}var De={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},ht={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Ge;function ve(){}p(ve,ms),ve.prototype.g=function(){return new XMLHttpRequest},Ge=new ve;function Re(d){return encodeURIComponent(String(d))}function Wo(d){var g=1;d=d.split(":");const y=[];for(;g>0&&d.length;)y.push(d.shift()),g--;return d.length&&y.push(d.join(":")),y}function tt(d,g,y,w){this.j=d,this.i=g,this.l=y,this.S=w||1,this.V=new mi(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new tu}function tu(){this.i=null,this.g="",this.h=!1}var nu={},Jo={};function Qo(d,g,y){d.M=1,d.A=su(Mn(g)),d.u=y,d.R=!0,ru(d,null)}function ru(d,g){d.F=Date.now(),iu(d),d.B=Mn(d.A);var y=d.B,w=d.S;Array.isArray(w)||(w=[String(w)]),i_(y.i,"t",w),d.C=0,y=d.j.L,d.h=new tu,d.g=I_(d.j,y?g:null,!d.u),d.P>0&&(d.O=new lh(u(d.Y,d,d.g),d.P)),g=d.V,y=d.g,w=d.ba;var L="readystatechange";Array.isArray(L)||(L&&(Ql[0]=L.toString()),L=Ql);for(let O=0;O<L.length;O++){const K=hs(y,L[O],w||g.handleEvent,!1,g.h||g);if(!K)break;g.g[K.key]=K}g=d.J?Ee(d.J):{},d.u?(d.v||(d.v="POST"),g["Content-Type"]="application/x-www-form-urlencoded",d.g.ea(d.B,d.v,d.u,g)):(d.v="GET",d.g.ea(d.B,d.v,null,g)),_i(),ch(d.i,d.v,d.B,d.l,d.S,d.u)}tt.prototype.ba=function(d){d=d.target;const g=this.O;g&&Tr(d)==3?g.j():this.Y(d)},tt.prototype.Y=function(d){try{if(d==this.g)e:{const he=Tr(this.g),ot=this.g.ya(),Me=this.g.ca();if(!(he<3)&&(he!=3||this.g&&(this.h.h||this.g.la()||d_(this.g)))){this.K||he!=4||ot==7||(ot==8||Me<=0?_i(3):_i(2)),dh(this);var g=this.g.ca();this.X=g;var y=QA(this);if(this.o=g==200,q(this.i,this.v,this.B,this.l,this.S,he,g),this.o){if(this.U&&!this.L){t:{if(this.g){var w,L=this.g;if((w=L.g?L.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!k(w)){var O=w;break t}}O=null}if(d=O)H(this.i,this.l,d,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,hh(this,d);else{this.o=!1,this.m=3,yt(12),Ti(this),Yo(this);break e}}if(this.R){d=!0;let ft;for(;!this.K&&this.C<y.length;)if(ft=YA(this,y),ft==Jo){he==4&&(this.m=4,yt(14),d=!1),H(this.i,this.l,null,"[Incomplete Response]");break}else if(ft==nu){this.m=4,yt(15),H(this.i,this.l,y,"[Invalid Chunk]"),d=!1;break}else H(this.i,this.l,ft,null),hh(this,ft);if(Kg(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),he!=4||y.length!=0||this.h.h||(this.m=1,yt(16),d=!1),this.o=this.o&&d,!d)H(this.i,this.l,y,"[Invalid Chunked Response]"),Ti(this),Yo(this);else if(y.length>0&&!this.W){this.W=!0;var K=this.j;K.g==this&&K.aa&&!K.P&&(K.j.info("Great, no buffering proxy detected. Bytes received: "+y.length),Th(K),K.P=!0,yt(11))}}else H(this.i,this.l,y,null),hh(this,y);he==4&&Ti(this),this.o&&!this.K&&(he==4?y_(this.j,this):(this.o=!1,iu(this)))}else cR(this.g),g==400&&y.indexOf("Unknown SID")>0?(this.m=3,yt(12)):(this.m=0,yt(13)),Ti(this),Yo(this)}}}catch{}finally{}};function QA(d){if(!Kg(d))return d.g.la();const g=d_(d.g);if(g==="")return"";let y="";const w=g.length,L=Tr(d.g)==4;if(!d.h.i){if(typeof TextDecoder>"u")return Ti(d),Yo(d),"";d.h.i=new o.TextDecoder}for(let O=0;O<w;O++)d.h.h=!0,y+=d.h.i.decode(g[O],{stream:!(L&&O==w-1)});return g.length=0,d.h.g+=y,d.C=0,d.h.g}function Kg(d){return d.g?d.v=="GET"&&d.M!=2&&d.j.Aa:!1}function YA(d,g){var y=d.C,w=g.indexOf(`
`,y);return w==-1?Jo:(y=Number(g.substring(y,w)),isNaN(y)?nu:(w+=1,w+y>g.length?Jo:(g=g.slice(w,w+y),d.C=w+y,g)))}tt.prototype.cancel=function(){this.K=!0,Ti(this)};function iu(d){d.T=Date.now()+d.H,Wg(d,d.H)}function Wg(d,g){if(d.D!=null)throw Error("WatchDog timer not null");d.D=yi(u(d.aa,d),g)}function dh(d){d.D&&(o.clearTimeout(d.D),d.D=null)}tt.prototype.aa=function(){this.D=null;const d=Date.now();d-this.T>=0?(j(this.i,this.B),this.M!=2&&(_i(),yt(17)),Ti(this),this.m=2,Yo(this)):Wg(this,this.T-d)};function Yo(d){d.j.I==0||d.K||y_(d.j,d)}function Ti(d){dh(d);var g=d.O;g&&typeof g.dispose=="function"&&g.dispose(),d.O=null,Yl(d.V),d.g&&(g=d.g,d.g=null,g.abort(),g.dispose())}function hh(d,g){try{var y=d.j;if(y.I!=0&&(y.g==d||fh(y.h,d))){if(!d.L&&fh(y.h,d)&&y.I==3){try{var w=y.Ba.g.parse(g)}catch{w=null}if(Array.isArray(w)&&w.length==3){var L=w;if(L[0]==0){e:if(!y.v){if(y.g)if(y.g.F+3e3<d.F)cu(y),lu(y);else break e;vh(y),yt(18)}}else y.xa=L[1],0<y.xa-y.K&&L[2]<37500&&y.F&&y.A==0&&!y.C&&(y.C=yi(u(y.Va,y),6e3));Yg(y.h)<=1&&y.ta&&(y.ta=void 0)}else Ii(y,11)}else if((d.L||y.g==d)&&cu(y),!k(g))for(L=y.Ba.g.parse(g),g=0;g<L.length;g++){let Me=L[g];const ft=Me[0];if(!(ft<=y.K))if(y.K=ft,Me=Me[1],y.I==2)if(Me[0]=="c"){y.M=Me[1],y.ba=Me[2];const Vn=Me[3];Vn!=null&&(y.ka=Vn,y.j.info("VER="+y.ka));const wi=Me[4];wi!=null&&(y.za=wi,y.j.info("SVER="+y.za));const Er=Me[5];Er!=null&&typeof Er=="number"&&Er>0&&(w=1.5*Er,y.O=w,y.j.info("backChannelRequestTimeoutMs_="+w)),w=y;const Ir=d.g;if(Ir){const hu=Ir.g?Ir.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(hu){var O=w.h;O.g||hu.indexOf("spdy")==-1&&hu.indexOf("quic")==-1&&hu.indexOf("h2")==-1||(O.j=O.l,O.g=new Set,O.h&&(ph(O,O.h),O.h=null))}if(w.G){const Eh=Ir.g?Ir.g.getResponseHeader("X-HTTP-Session-Id"):null;Eh&&(w.wa=Eh,Fe(w.J,w.G,Eh))}}y.I=3,y.l&&y.l.ra(),y.aa&&(y.T=Date.now()-d.F,y.j.info("Handshake RTT: "+y.T+"ms")),w=y;var K=d;if(w.na=E_(w,w.L?w.ba:null,w.W),K.L){jg(w.h,K);var he=K,ot=w.O;ot&&(he.H=ot),he.D&&(dh(he),iu(he)),w.g=K}else g_(w);y.i.length>0&&uu(y)}else Me[0]!="stop"&&Me[0]!="close"||Ii(y,7);else y.I==3&&(Me[0]=="stop"||Me[0]=="close"?Me[0]=="stop"?Ii(y,7):yh(y):Me[0]!="noop"&&y.l&&y.l.qa(Me),y.A=0)}}_i(4)}catch{}}var jA=class{constructor(d,g){this.g=d,this.map=g}};function Jg(d){this.l=d||10,o.PerformanceNavigationTiming?(d=o.performance.getEntriesByType("navigation"),d=d.length>0&&(d[0].nextHopProtocol=="hq"||d[0].nextHopProtocol=="h2")):d=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=d?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Qg(d){return d.h?!0:d.g?d.g.size>=d.j:!1}function Yg(d){return d.h?1:d.g?d.g.size:0}function fh(d,g){return d.h?d.h==g:d.g?d.g.has(g):!1}function ph(d,g){d.g?d.g.add(g):d.h=g}function jg(d,g){d.h&&d.h==g?d.h=null:d.g&&d.g.has(g)&&d.g.delete(g)}Jg.prototype.cancel=function(){if(this.i=Xg(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const d of this.g.values())d.cancel();this.g.clear()}};function Xg(d){if(d.h!=null)return d.i.concat(d.h.G);if(d.g!=null&&d.g.size!==0){let g=d.i;for(const y of d.g.values())g=g.concat(y.G);return g}return v(d.i)}var Zg=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function XA(d,g){if(d){d=d.split("&");for(let y=0;y<d.length;y++){const w=d[y].indexOf("=");let L,O=null;w>=0?(L=d[y].substring(0,w),O=d[y].substring(w+1)):L=d[y],g(L,O?decodeURIComponent(O.replace(/\+/g," ")):"")}}}function yr(d){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let g;d instanceof yr?(this.l=d.l,jo(this,d.j),this.o=d.o,this.g=d.g,Xo(this,d.u),this.h=d.h,mh(this,s_(d.i)),this.m=d.m):d&&(g=String(d).match(Zg))?(this.l=!1,jo(this,g[1]||"",!0),this.o=Zo(g[2]||""),this.g=Zo(g[3]||"",!0),Xo(this,g[4]),this.h=Zo(g[5]||"",!0),mh(this,g[6]||"",!0),this.m=Zo(g[7]||"")):(this.l=!1,this.i=new ta(null,this.l))}yr.prototype.toString=function(){const d=[];var g=this.j;g&&d.push(ea(g,e_,!0),":");var y=this.g;return(y||g=="file")&&(d.push("//"),(g=this.o)&&d.push(ea(g,e_,!0),"@"),d.push(Re(y).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y=this.u,y!=null&&d.push(":",String(y))),(y=this.h)&&(this.g&&y.charAt(0)!="/"&&d.push("/"),d.push(ea(y,y.charAt(0)=="/"?tR:eR,!0))),(y=this.i.toString())&&d.push("?",y),(y=this.m)&&d.push("#",ea(y,rR)),d.join("")},yr.prototype.resolve=function(d){const g=Mn(this);let y=!!d.j;y?jo(g,d.j):y=!!d.o,y?g.o=d.o:y=!!d.g,y?g.g=d.g:y=d.u!=null;var w=d.h;if(y)Xo(g,d.u);else if(y=!!d.h){if(w.charAt(0)!="/")if(this.g&&!this.h)w="/"+w;else{var L=g.h.lastIndexOf("/");L!=-1&&(w=g.h.slice(0,L+1)+w)}if(L=w,L==".."||L==".")w="";else if(L.indexOf("./")!=-1||L.indexOf("/.")!=-1){w=L.lastIndexOf("/",0)==0,L=L.split("/");const O=[];for(let K=0;K<L.length;){const he=L[K++];he=="."?w&&K==L.length&&O.push(""):he==".."?((O.length>1||O.length==1&&O[0]!="")&&O.pop(),w&&K==L.length&&O.push("")):(O.push(he),w=!0)}w=O.join("/")}else w=L}return y?g.h=w:y=d.i.toString()!=="",y?mh(g,s_(d.i)):y=!!d.m,y&&(g.m=d.m),g};function Mn(d){return new yr(d)}function jo(d,g,y){d.j=y?Zo(g,!0):g,d.j&&(d.j=d.j.replace(/:$/,""))}function Xo(d,g){if(g){if(g=Number(g),isNaN(g)||g<0)throw Error("Bad port number "+g);d.u=g}else d.u=null}function mh(d,g,y){g instanceof ta?(d.i=g,iR(d.i,d.l)):(y||(g=ea(g,nR)),d.i=new ta(g,d.l))}function Fe(d,g,y){d.i.set(g,y)}function su(d){return Fe(d,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),d}function Zo(d,g){return d?g?decodeURI(d.replace(/%25/g,"%2525")):decodeURIComponent(d):""}function ea(d,g,y){return typeof d=="string"?(d=encodeURI(d).replace(g,ZA),y&&(d=d.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d):null}function ZA(d){return d=d.charCodeAt(0),"%"+(d>>4&15).toString(16)+(d&15).toString(16)}var e_=/[#\/\?@]/g,eR=/[#\?:]/g,tR=/[#\?]/g,nR=/[#\?@]/g,rR=/#/g;function ta(d,g){this.h=this.g=null,this.i=d||null,this.j=!!g}function Ei(d){d.g||(d.g=new Map,d.h=0,d.i&&XA(d.i,function(g,y){d.add(decodeURIComponent(g.replace(/\+/g," ")),y)}))}t=ta.prototype,t.add=function(d,g){Ei(this),this.i=null,d=_s(this,d);let y=this.g.get(d);return y||this.g.set(d,y=[]),y.push(g),this.h+=1,this};function t_(d,g){Ei(d),g=_s(d,g),d.g.has(g)&&(d.i=null,d.h-=d.g.get(g).length,d.g.delete(g))}function n_(d,g){return Ei(d),g=_s(d,g),d.g.has(g)}t.forEach=function(d,g){Ei(this),this.g.forEach(function(y,w){y.forEach(function(L){d.call(g,L,w,this)},this)},this)};function r_(d,g){Ei(d);let y=[];if(typeof g=="string")n_(d,g)&&(y=y.concat(d.g.get(_s(d,g))));else for(d=Array.from(d.g.values()),g=0;g<d.length;g++)y=y.concat(d[g]);return y}t.set=function(d,g){return Ei(this),this.i=null,d=_s(this,d),n_(this,d)&&(this.h-=this.g.get(d).length),this.g.set(d,[g]),this.h+=1,this},t.get=function(d,g){return d?(d=r_(this,d),d.length>0?String(d[0]):g):g};function i_(d,g,y){t_(d,g),y.length>0&&(d.i=null,d.g.set(_s(d,g),v(y)),d.h+=y.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const d=[],g=Array.from(this.g.keys());for(let w=0;w<g.length;w++){var y=g[w];const L=Re(y);y=r_(this,y);for(let O=0;O<y.length;O++){let K=L;y[O]!==""&&(K+="="+Re(y[O])),d.push(K)}}return this.i=d.join("&")};function s_(d){const g=new ta;return g.i=d.i,d.g&&(g.g=new Map(d.g),g.h=d.h),g}function _s(d,g){return g=String(g),d.j&&(g=g.toLowerCase()),g}function iR(d,g){g&&!d.j&&(Ei(d),d.i=null,d.g.forEach(function(y,w){const L=w.toLowerCase();w!=L&&(t_(this,w),i_(this,L,y))},d)),d.j=g}function sR(d,g){const y=new vi;if(o.Image){const w=new Image;w.onload=f(vr,y,"TestLoadImage: loaded",!0,g,w),w.onerror=f(vr,y,"TestLoadImage: error",!1,g,w),w.onabort=f(vr,y,"TestLoadImage: abort",!1,g,w),w.ontimeout=f(vr,y,"TestLoadImage: timeout",!1,g,w),o.setTimeout(function(){w.ontimeout&&w.ontimeout()},1e4),w.src=d}else g(!1)}function oR(d,g){const y=new vi,w=new AbortController,L=setTimeout(()=>{w.abort(),vr(y,"TestPingServer: timeout",!1,g)},1e4);fetch(d,{signal:w.signal}).then(O=>{clearTimeout(L),O.ok?vr(y,"TestPingServer: ok",!0,g):vr(y,"TestPingServer: server error",!1,g)}).catch(()=>{clearTimeout(L),vr(y,"TestPingServer: error",!1,g)})}function vr(d,g,y,w,L){try{L&&(L.onload=null,L.onerror=null,L.onabort=null,L.ontimeout=null),w(y)}catch{}}function aR(){this.g=new uh}function gh(d){this.i=d.Sb||null,this.h=d.ab||!1}p(gh,ms),gh.prototype.g=function(){return new ou(this.i,this.h)};function ou(d,g){et.call(this),this.H=d,this.o=g,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}p(ou,et),t=ou.prototype,t.open=function(d,g){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=d,this.D=g,this.readyState=1,ra(this)},t.send=function(d){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const g={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};d&&(g.body=d),(this.H||o).fetch(new Request(this.D,g)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,na(this)),this.readyState=0},t.Pa=function(d){if(this.g&&(this.l=d,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=d.headers,this.readyState=2,ra(this)),this.g&&(this.readyState=3,ra(this),this.g)))if(this.responseType==="arraybuffer")d.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in d){if(this.j=d.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;o_(this)}else d.text().then(this.Oa.bind(this),this.ga.bind(this))};function o_(d){d.j.read().then(d.Ma.bind(d)).catch(d.ga.bind(d))}t.Ma=function(d){if(this.g){if(this.o&&d.value)this.response.push(d.value);else if(!this.o){var g=d.value?d.value:new Uint8Array(0);(g=this.B.decode(g,{stream:!d.done}))&&(this.response=this.responseText+=g)}d.done?na(this):ra(this),this.readyState==3&&o_(this)}},t.Oa=function(d){this.g&&(this.response=this.responseText=d,na(this))},t.Na=function(d){this.g&&(this.response=d,na(this))},t.ga=function(){this.g&&na(this)};function na(d){d.readyState=4,d.l=null,d.j=null,d.B=null,ra(d)}t.setRequestHeader=function(d,g){this.A.append(d,g)},t.getResponseHeader=function(d){return this.h&&this.h.get(d.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const d=[],g=this.h.entries();for(var y=g.next();!y.done;)y=y.value,d.push(y[0]+": "+y[1]),y=g.next();return d.join(`\r
`)};function ra(d){d.onreadystatechange&&d.onreadystatechange.call(d)}Object.defineProperty(ou.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(d){this.m=d?"include":"same-origin"}});function a_(d){let g="";return ee(d,function(y,w){g+=w,g+=":",g+=y,g+=`\r
`}),g}function _h(d,g,y){e:{for(w in y){var w=!1;break e}w=!0}w||(y=a_(y),typeof d=="string"?y!=null&&Re(y):Fe(d,g,y))}function Qe(d){et.call(this),this.headers=new Map,this.L=d||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}p(Qe,et);var lR=/^https?$/i,uR=["POST","PUT"];t=Qe.prototype,t.Fa=function(d){this.H=d},t.ea=function(d,g,y,w){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+d);g=g?g.toUpperCase():"GET",this.D=d,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Ge.g(),this.g.onreadystatechange=m(u(this.Ca,this));try{this.B=!0,this.g.open(g,String(d),!0),this.B=!1}catch(O){l_(this,O);return}if(d=y||"",y=new Map(this.headers),w)if(Object.getPrototypeOf(w)===Object.prototype)for(var L in w)y.set(L,w[L]);else if(typeof w.keys=="function"&&typeof w.get=="function")for(const O of w.keys())y.set(O,w.get(O));else throw Error("Unknown input type for opt_headers: "+String(w));w=Array.from(y.keys()).find(O=>O.toLowerCase()=="content-type"),L=o.FormData&&d instanceof o.FormData,!(Array.prototype.indexOf.call(uR,g,void 0)>=0)||w||L||y.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[O,K]of y)this.g.setRequestHeader(O,K);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(d),this.v=!1}catch(O){l_(this,O)}};function l_(d,g){d.h=!1,d.g&&(d.j=!0,d.g.abort(),d.j=!1),d.l=g,d.o=5,u_(d),au(d)}function u_(d){d.A||(d.A=!0,_t(d,"complete"),_t(d,"error"))}t.abort=function(d){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=d||7,_t(this,"complete"),_t(this,"abort"),au(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),au(this,!0)),Qe.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?c_(this):this.Xa())},t.Xa=function(){c_(this)};function c_(d){if(d.h&&typeof s<"u"){if(d.v&&Tr(d)==4)setTimeout(d.Ca.bind(d),0);else if(_t(d,"readystatechange"),Tr(d)==4){d.h=!1;try{const O=d.ca();e:switch(O){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var g=!0;break e;default:g=!1}var y;if(!(y=g)){var w;if(w=O===0){let K=String(d.D).match(Zg)[1]||null;!K&&o.self&&o.self.location&&(K=o.self.location.protocol.slice(0,-1)),w=!lR.test(K?K.toLowerCase():"")}y=w}if(y)_t(d,"complete"),_t(d,"success");else{d.o=6;try{var L=Tr(d)>2?d.g.statusText:""}catch{L=""}d.l=L+" ["+d.ca()+"]",u_(d)}}finally{au(d)}}}}function au(d,g){if(d.g){d.m&&(clearTimeout(d.m),d.m=null);const y=d.g;d.g=null,g||_t(d,"ready");try{y.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function Tr(d){return d.g?d.g.readyState:0}t.ca=function(){try{return Tr(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(d){if(this.g){var g=this.g.responseText;return d&&g.indexOf(d)==0&&(g=g.substring(d.length)),ps(g)}};function d_(d){try{if(!d.g)return null;if("response"in d.g)return d.g.response;switch(d.F){case"":case"text":return d.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in d.g)return d.g.mozResponseArrayBuffer}return null}catch{return null}}function cR(d){const g={};d=(d.g&&Tr(d)>=2&&d.g.getAllResponseHeaders()||"").split(`\r
`);for(let w=0;w<d.length;w++){if(k(d[w]))continue;var y=Wo(d[w]);const L=y[0];if(y=y[1],typeof y!="string")continue;y=y.trim();const O=g[L]||[];g[L]=O,O.push(y)}ie(g,function(w){return w.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function ia(d,g,y){return y&&y.internalChannelParams&&y.internalChannelParams[d]||g}function h_(d){this.za=0,this.i=[],this.j=new vi,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=ia("failFast",!1,d),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=ia("baseRetryDelayMs",5e3,d),this.Za=ia("retryDelaySeedMs",1e4,d),this.Ta=ia("forwardChannelMaxRetries",2,d),this.va=ia("forwardChannelRequestTimeoutMs",2e4,d),this.ma=d&&d.xmlHttpFactory||void 0,this.Ua=d&&d.Rb||void 0,this.Aa=d&&d.useFetchStreams||!1,this.O=void 0,this.L=d&&d.supportsCrossDomainXhr||!1,this.M="",this.h=new Jg(d&&d.concurrentRequestLimit),this.Ba=new aR,this.S=d&&d.fastHandshake||!1,this.R=d&&d.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=d&&d.Pb||!1,d&&d.ua&&this.j.ua(),d&&d.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&d&&d.detectBufferingProxy||!1,this.ia=void 0,d&&d.longPollingTimeout&&d.longPollingTimeout>0&&(this.ia=d.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=h_.prototype,t.ka=8,t.I=1,t.connect=function(d,g,y,w){yt(0),this.W=d,this.H=g||{},y&&w!==void 0&&(this.H.OSID=y,this.H.OAID=w),this.F=this.X,this.J=E_(this,null,this.W),uu(this)};function yh(d){if(f_(d),d.I==3){var g=d.V++,y=Mn(d.J);if(Fe(y,"SID",d.M),Fe(y,"RID",g),Fe(y,"TYPE","terminate"),sa(d,y),g=new tt(d,d.j,g),g.M=2,g.A=su(Mn(y)),y=!1,o.navigator&&o.navigator.sendBeacon)try{y=o.navigator.sendBeacon(g.A.toString(),"")}catch{}!y&&o.Image&&(new Image().src=g.A,y=!0),y||(g.g=I_(g.j,null),g.g.ea(g.A)),g.F=Date.now(),iu(g)}T_(d)}function lu(d){d.g&&(Th(d),d.g.cancel(),d.g=null)}function f_(d){lu(d),d.v&&(o.clearTimeout(d.v),d.v=null),cu(d),d.h.cancel(),d.m&&(typeof d.m=="number"&&o.clearTimeout(d.m),d.m=null)}function uu(d){if(!Qg(d.h)&&!d.m){d.m=!0;var g=d.Ea;U||E(),F||(U(),F=!0),C.add(g,d),d.D=0}}function dR(d,g){return Yg(d.h)>=d.h.j-(d.m?1:0)?!1:d.m?(d.i=g.G.concat(d.i),!0):d.I==1||d.I==2||d.D>=(d.Sa?0:d.Ta)?!1:(d.m=yi(u(d.Ea,d,g),v_(d,d.D)),d.D++,!0)}t.Ea=function(d){if(this.m)if(this.m=null,this.I==1){if(!d){this.V=Math.floor(Math.random()*1e5),d=this.V++;const L=new tt(this,this.j,d);let O=this.o;if(this.U&&(O?(O=Ee(O),Ve(O,this.U)):O=this.U),this.u!==null||this.R||(L.J=O,O=null),this.S)e:{for(var g=0,y=0;y<this.i.length;y++){t:{var w=this.i[y];if("__data__"in w.map&&(w=w.map.__data__,typeof w=="string")){w=w.length;break t}w=void 0}if(w===void 0)break;if(g+=w,g>4096){g=y;break e}if(g===4096||y===this.i.length-1){g=y+1;break e}}g=1e3}else g=1e3;g=m_(this,L,g),y=Mn(this.J),Fe(y,"RID",d),Fe(y,"CVER",22),this.G&&Fe(y,"X-HTTP-Session-Id",this.G),sa(this,y),O&&(this.R?g="headers="+Re(a_(O))+"&"+g:this.u&&_h(y,this.u,O)),ph(this.h,L),this.Ra&&Fe(y,"TYPE","init"),this.S?(Fe(y,"$req",g),Fe(y,"SID","null"),L.U=!0,Qo(L,y,null)):Qo(L,y,g),this.I=2}}else this.I==3&&(d?p_(this,d):this.i.length==0||Qg(this.h)||p_(this))};function p_(d,g){var y;g?y=g.l:y=d.V++;const w=Mn(d.J);Fe(w,"SID",d.M),Fe(w,"RID",y),Fe(w,"AID",d.K),sa(d,w),d.u&&d.o&&_h(w,d.u,d.o),y=new tt(d,d.j,y,d.D+1),d.u===null&&(y.J=d.o),g&&(d.i=g.G.concat(d.i)),g=m_(d,y,1e3),y.H=Math.round(d.va*.5)+Math.round(d.va*.5*Math.random()),ph(d.h,y),Qo(y,w,g)}function sa(d,g){d.H&&ee(d.H,function(y,w){Fe(g,w,y)}),d.l&&ee({},function(y,w){Fe(g,w,y)})}function m_(d,g,y){y=Math.min(d.i.length,y);const w=d.l?u(d.l.Ka,d.l,d):null;e:{var L=d.i;let he=-1;for(;;){const ot=["count="+y];he==-1?y>0?(he=L[0].g,ot.push("ofs="+he)):he=0:ot.push("ofs="+he);let Me=!0;for(let ft=0;ft<y;ft++){var O=L[ft].g;const Vn=L[ft].map;if(O-=he,O<0)he=Math.max(0,L[ft].g-100),Me=!1;else try{O="req"+O+"_"||"";try{var K=Vn instanceof Map?Vn:Object.entries(Vn);for(const[wi,Er]of K){let Ir=Er;a(Er)&&(Ir=ce(Er)),ot.push(O+wi+"="+encodeURIComponent(Ir))}}catch(wi){throw ot.push(O+"type="+encodeURIComponent("_badmap")),wi}}catch{w&&w(Vn)}}if(Me){K=ot.join("&");break e}}K=void 0}return d=d.i.splice(0,y),g.G=d,K}function g_(d){if(!d.g&&!d.v){d.Y=1;var g=d.Da;U||E(),F||(U(),F=!0),C.add(g,d),d.A=0}}function vh(d){return d.g||d.v||d.A>=3?!1:(d.Y++,d.v=yi(u(d.Da,d),v_(d,d.A)),d.A++,!0)}t.Da=function(){if(this.v=null,__(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var d=4*this.T;this.j.info("BP detection timer enabled: "+d),this.B=yi(u(this.Wa,this),d)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,yt(10),lu(this),__(this))};function Th(d){d.B!=null&&(o.clearTimeout(d.B),d.B=null)}function __(d){d.g=new tt(d,d.j,"rpc",d.Y),d.u===null&&(d.g.J=d.o),d.g.P=0;var g=Mn(d.na);Fe(g,"RID","rpc"),Fe(g,"SID",d.M),Fe(g,"AID",d.K),Fe(g,"CI",d.F?"0":"1"),!d.F&&d.ia&&Fe(g,"TO",d.ia),Fe(g,"TYPE","xmlhttp"),sa(d,g),d.u&&d.o&&_h(g,d.u,d.o),d.O&&(d.g.H=d.O);var y=d.g;d=d.ba,y.M=1,y.A=su(Mn(g)),y.u=null,y.R=!0,ru(y,d)}t.Va=function(){this.C!=null&&(this.C=null,lu(this),vh(this),yt(19))};function cu(d){d.C!=null&&(o.clearTimeout(d.C),d.C=null)}function y_(d,g){var y=null;if(d.g==g){cu(d),Th(d),d.g=null;var w=2}else if(fh(d.h,g))y=g.G,jg(d.h,g),w=1;else return;if(d.I!=0){if(g.o)if(w==1){y=g.u?g.u.length:0,g=Date.now()-g.F;var L=d.D;w=gs(),_t(w,new eu(w,y)),uu(d)}else g_(d);else if(L=g.m,L==3||L==0&&g.X>0||!(w==1&&dR(d,g)||w==2&&vh(d)))switch(y&&y.length>0&&(g=d.h,g.i=g.i.concat(y)),L){case 1:Ii(d,5);break;case 4:Ii(d,10);break;case 3:Ii(d,6);break;default:Ii(d,2)}}}function v_(d,g){let y=d.Qa+Math.floor(Math.random()*d.Za);return d.isActive()||(y*=2),y*g}function Ii(d,g){if(d.j.info("Error code "+g),g==2){var y=u(d.bb,d),w=d.Ua;const L=!w;w=new yr(w||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||jo(w,"https"),su(w),L?sR(w.toString(),y):oR(w.toString(),y)}else yt(2);d.I=0,d.l&&d.l.pa(g),T_(d),f_(d)}t.bb=function(d){d?(this.j.info("Successfully pinged google.com"),yt(2)):(this.j.info("Failed to ping google.com"),yt(1))};function T_(d){if(d.I=0,d.ja=[],d.l){const g=Xg(d.h);(g.length!=0||d.i.length!=0)&&(I(d.ja,g),I(d.ja,d.i),d.h.i.length=0,v(d.i),d.i.length=0),d.l.oa()}}function E_(d,g,y){var w=y instanceof yr?Mn(y):new yr(y);if(w.g!="")g&&(w.g=g+"."+w.g),Xo(w,w.u);else{var L=o.location;w=L.protocol,g=g?g+"."+L.hostname:L.hostname,L=+L.port;const O=new yr(null);w&&jo(O,w),g&&(O.g=g),L&&Xo(O,L),y&&(O.h=y),w=O}return y=d.G,g=d.wa,y&&g&&Fe(w,y,g),Fe(w,"VER",d.ka),sa(d,w),w}function I_(d,g,y){if(g&&!d.L)throw Error("Can't create secondary domain capable XhrIo object.");return g=d.Aa&&!d.ma?new Qe(new gh({ab:y})):new Qe(d.ma),g.Fa(d.L),g}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function w_(){}t=w_.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function du(){}du.prototype.g=function(d,g){return new Ht(d,g)};function Ht(d,g){et.call(this),this.g=new h_(g),this.l=d,this.h=g&&g.messageUrlParams||null,d=g&&g.messageHeaders||null,g&&g.clientProtocolHeaderRequired&&(d?d["X-Client-Protocol"]="webchannel":d={"X-Client-Protocol":"webchannel"}),this.g.o=d,d=g&&g.initMessageHeaders||null,g&&g.messageContentType&&(d?d["X-WebChannel-Content-Type"]=g.messageContentType:d={"X-WebChannel-Content-Type":g.messageContentType}),g&&g.sa&&(d?d["X-WebChannel-Client-Profile"]=g.sa:d={"X-WebChannel-Client-Profile":g.sa}),this.g.U=d,(d=g&&g.Qb)&&!k(d)&&(this.g.u=d),this.A=g&&g.supportsCrossDomainXhr||!1,this.v=g&&g.sendRawJson||!1,(g=g&&g.httpSessionIdParam)&&!k(g)&&(this.g.G=g,d=this.h,d!==null&&g in d&&(d=this.h,g in d&&delete d[g])),this.j=new ys(this)}p(Ht,et),Ht.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Ht.prototype.close=function(){yh(this.g)},Ht.prototype.o=function(d){var g=this.g;if(typeof d=="string"){var y={};y.__data__=d,d=y}else this.v&&(y={},y.__data__=ce(d),d=y);g.i.push(new jA(g.Ya++,d)),g.I==3&&uu(g)},Ht.prototype.N=function(){this.g.l=null,delete this.j,yh(this.g),delete this.g,Ht.Z.N.call(this)};function S_(d){zo.call(this),d.__headers__&&(this.headers=d.__headers__,this.statusCode=d.__status__,delete d.__headers__,delete d.__status__);var g=d.__sm__;if(g){e:{for(const y in g){d=y;break e}d=void 0}(this.i=d)&&(d=this.i,g=g!==null&&d in g?g[d]:void 0),this.data=g}else this.data=d}p(S_,zo);function C_(){Ho.call(this),this.status=1}p(C_,Ho);function ys(d){this.g=d}p(ys,w_),ys.prototype.ra=function(){_t(this.g,"a")},ys.prototype.qa=function(d){_t(this.g,new S_(d))},ys.prototype.pa=function(d){_t(this.g,new C_)},ys.prototype.oa=function(){_t(this.g,"b")},du.prototype.createWebChannel=du.prototype.g,Ht.prototype.send=Ht.prototype.o,Ht.prototype.open=Ht.prototype.m,Ht.prototype.close=Ht.prototype.close,LC=function(){return new du},bC=function(){return gs()},VC=Wn,Tp={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},De.NO_ERROR=0,De.TIMEOUT=8,De.HTTP_ERROR=6,ic=De,ht.COMPLETE="complete",MC=ht,jl.EventType=gi,gi.OPEN="a",gi.CLOSE="b",gi.ERROR="c",gi.MESSAGE="d",et.prototype.listen=et.prototype.J,Sa=jl,Qe.prototype.listenOnce=Qe.prototype.K,Qe.prototype.getLastError=Qe.prototype.Ha,Qe.prototype.getLastErrorCode=Qe.prototype.ya,Qe.prototype.getStatus=Qe.prototype.ca,Qe.prototype.getResponseJson=Qe.prototype.La,Qe.prototype.getResponseText=Qe.prototype.la,Qe.prototype.send=Qe.prototype.ea,Qe.prototype.setWithCredentials=Qe.prototype.Fa,DC=Qe}).apply(typeof Du<"u"?Du:typeof self<"u"?self:typeof window<"u"?window:{});const PT="@firebase/firestore",xT="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Tt.UNAUTHENTICATED=new Tt(null),Tt.GOOGLE_CREDENTIALS=new Tt("google-credentials-uid"),Tt.FIRST_PARTY=new Tt("first-party-uid"),Tt.MOCK_USER=new Tt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Bo="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ti=new Hm("@firebase/firestore");function As(){return ti.logLevel}function FC(t){ti.setLogLevel(t)}function $(t,...e){if(ti.logLevel<=ge.DEBUG){const n=e.map(ig);ti.debug(`Firestore (${Bo}): ${t}`,...n)}}function Mt(t,...e){if(ti.logLevel<=ge.ERROR){const n=e.map(ig);ti.error(`Firestore (${Bo}): ${t}`,...n)}}function ni(t,...e){if(ti.logLevel<=ge.WARN){const n=e.map(ig);ti.warn(`Firestore (${Bo}): ${t}`,...n)}}function ig(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,UC(t,r,n)}function UC(t,e,n){let r=`FIRESTORE (${Bo}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw Mt(r),new Error(r)}function te(t,e,n,r){let i="Unexpected state";typeof n=="string"?i=n:r=n,t||UC(e,i,r)}function ue(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Q extends mr{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ir{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OC{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class BC{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Tt.UNAUTHENTICATED))}shutdown(){}}class uF{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class cF{constructor(e){this.t=e,this.currentUser=Tt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){te(this.o===void 0,42304);let r=this.i;const i=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let s=new ir;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new ir,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},a=l=>{$("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):($("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new ir)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?($("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(te(typeof r.accessToken=="string",31837,{l:r}),new OC(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return te(e===null||typeof e=="string",2055,{h:e}),new Tt(e)}}class dF{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=Tt.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class hF{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new dF(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(Tt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class kT{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class fF{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,wn(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){te(this.o===void 0,3512);const r=s=>{s.error!=null&&$("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,$("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{$("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):$("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new kT(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(te(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new kT(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pF(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ud{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=pF(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%62))}return r}}function le(t,e){return t<e?-1:t>e?1:0}function Ep(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const i=t.charAt(r),s=e.charAt(r);if(i!==s)return nf(i)===nf(s)?le(i,s):nf(i)?1:-1}return le(t.length,e.length)}const mF=55296,gF=57343;function nf(t){const e=t.charCodeAt(0);return e>=mF&&e<=gF}function go(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function GC(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NT="__name__";class Fn{constructor(e,n,r){n===void 0?n=0:n>e.length&&Z(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&Z(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Fn.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Fn?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=Fn.compareSegments(e.get(i),n.get(i));if(s!==0)return s}return le(e.length,n.length)}static compareSegments(e,n){const r=Fn.isNumericId(e),i=Fn.isNumericId(n);return r&&!i?-1:!r&&i?1:r&&i?Fn.extractNumericId(e).compare(Fn.extractNumericId(n)):Ep(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Yr.fromString(e.substring(4,e.length-2))}}class ke extends Fn{construct(e,n,r){return new ke(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new Q(B.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new ke(n)}static emptyPath(){return new ke([])}}const _F=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ze extends Fn{construct(e,n,r){return new ze(e,n,r)}static isValidIdentifier(e){return _F.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ze.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===NT}static keyField(){return new ze([NT])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new Q(B.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new Q(B.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new Q(B.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new Q(B.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ze(n)}static emptyPath(){return new ze([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J{constructor(e){this.path=e}static fromPath(e){return new J(ke.fromString(e))}static fromName(e){return new J(ke.fromString(e).popFirst(5))}static empty(){return new J(ke.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ke.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return ke.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new J(new ke(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yF(t,e,n){if(!n)throw new Q(B.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function qC(t,e,n,r){if(e===!0&&r===!0)throw new Q(B.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function DT(t){if(!J.isDocumentKey(t))throw new Q(B.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function $C(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function sg(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Z(12329,{type:typeof t})}function es(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Q(B.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=sg(t);throw new Q(B.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function it(t,e){const n={typeString:t};return e&&(n.value=e),n}function Ll(t,e){if(!$C(t))throw new Q(B.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(i&&typeof o!==i){n=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&o!==s.value){n=`Expected '${r}' field to equal '${s.value}'`;break}}if(n)throw new Q(B.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MT=-62135596800,VT=1e6;class Se{static now(){return Se.fromMillis(Date.now())}static fromDate(e){return Se.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*VT);return new Se(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new Q(B.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new Q(B.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<MT)throw new Q(B.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Q(B.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/VT}_compareTo(e){return this.seconds===e.seconds?le(this.nanoseconds,e.nanoseconds):le(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Se._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Ll(e,Se._jsonSchema))return new Se(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-MT;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Se._jsonSchemaVersion="firestore/timestamp/1.0",Se._jsonSchema={type:it("string",Se._jsonSchemaVersion),seconds:it("number"),nanoseconds:it("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class re{static fromTimestamp(e){return new re(e)}static min(){return new re(new Se(0,0))}static max(){return new re(new Se(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pl=-1;class jc{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}}function Ip(t){return t.fields.find(e=>e.kind===2)}function Pi(t){return t.fields.filter(e=>e.kind!==2)}jc.UNKNOWN_ID=-1;class sc{constructor(e,n){this.fieldPath=e,this.kind=n}}class ml{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new ml(0,tn.min())}}function vF(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=re.fromTimestamp(r===1e9?new Se(n+1,0):new Se(n,r));return new tn(i,J.empty(),e)}function zC(t){return new tn(t.readTime,t.key,pl)}class tn{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new tn(re.min(),J.empty(),pl)}static max(){return new tn(re.max(),J.empty(),pl)}}function og(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=J.comparator(t.documentKey,e.documentKey),n!==0?n:le(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HC="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class KC{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function us(t){if(t.code!==B.FAILED_PRECONDITION||t.message!==HC)throw t;$("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Z(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new b((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof b?n:b.resolve(n)}catch(n){return b.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):b.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):b.reject(n)}static resolve(e){return new b((n,r)=>{n(e)})}static reject(e){return new b((n,r)=>{r(e)})}static waitFor(e){return new b((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},l=>r(l))}),o=!0,s===i&&n()})}static or(e){let n=b.resolve(!1);for(const r of e)n=n.next(i=>i?b.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new b((r,i)=>{const s=e.length,o=new Array(s);let a=0;for(let l=0;l<s;l++){const u=l;n(e[u]).next(f=>{o[u]=f,++a,a===s&&r(o)},f=>i(f))}})}static doWhile(e,n){return new b((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wt="SimpleDb";class Od{static open(e,n,r,i){try{return new Od(n,e.transaction(i,r))}catch(s){throw new Ba(n,s)}}constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.S=new ir,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{n.error?this.S.reject(new Ba(e,n.error)):this.S.resolve()},this.transaction.onerror=r=>{const i=ag(r.target.error);this.S.reject(new Ba(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||($(Wt,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new EF(n)}}class jr{static delete(e){return $(Wt,"Removing database:",e),ki(US().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!WS())return!1;if(jr.F())return!0;const e=ct(),n=jr.M(e),r=0<n&&n<10,i=WC(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)==null?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)==="YES"}static O(e,n){return e.store(n)}static M(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,n,r){this.name=e,this.version=n,this.N=r,this.B=null,jr.M(ct())===12.2&&Mt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||($(Wt,"Opening database:",this.name),this.db=await new Promise((n,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const o=s.target.result;n(o)},i.onblocked=()=>{r(new Ba(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const o=s.target.error;o.name==="VersionError"?r(new Q(B.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new Q(B.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Ba(e,o))},i.onupgradeneeded=s=>{$(Wt,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.N.k(o,i.transaction,s.oldVersion,this.version).next(()=>{$(Wt,"Database upgrade to version "+this.version+" complete")})}})),this.q&&(this.db.onversionchange=n=>this.q(n)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,i){const s=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const a=Od.open(this.db,e,s?"readonly":"readwrite",r),l=i(a).next(u=>(a.C(),u)).catch(u=>(a.abort(u),b.reject(u))).toPromise();return l.catch(()=>{}),await a.D,l}catch(a){const l=a,u=l.name!=="FirebaseError"&&o<3;if($(Wt,"Transaction failed with error:",l.message,"Retrying:",u),this.close(),!u)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function WC(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class TF{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return ki(this.U.delete())}}class Ba extends Q{constructor(e,n){super(B.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function hi(t){return t.name==="IndexedDbTransactionError"}class EF{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?($(Wt,"PUT",this.store.name,e,n),r=this.store.put(n,e)):($(Wt,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),ki(r)}add(e){return $(Wt,"ADD",this.store.name,e,e),ki(this.store.add(e))}get(e){return ki(this.store.get(e)).next(n=>(n===void 0&&(n=null),$(Wt,"GET",this.store.name,e,n),n))}delete(e){return $(Wt,"DELETE",this.store.name,e),ki(this.store.delete(e))}count(){return $(Wt,"COUNT",this.store.name),ki(this.store.count())}J(e,n){const r=this.options(e,n),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const s=i.getAll(r.range);return new b((o,a)=>{s.onerror=l=>{a(l.target.error)},s.onsuccess=l=>{o(l.target.result)}})}{const s=this.cursor(r),o=[];return this.H(s,(a,l)=>{o.push(l)}).next(()=>o)}}Y(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new b((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}Z(e,n){$(Wt,"DELETE ALL",this.store.name);const r=this.options(e,n);r.X=!1;const i=this.cursor(r);return this.H(i,(s,o,a)=>a.delete())}ee(e,n){let r;n?r=e:(r={},n=e);const i=this.cursor(r);return this.H(i,n)}te(e){const n=this.cursor({});return new b((r,i)=>{n.onerror=s=>{const o=ag(s.target.error);i(o)},n.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}H(e,n){const r=[];return new b((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void i();const l=new TF(a),u=n(a.primaryKey,a.value,l);if(u instanceof b){const f=u.catch(p=>(l.done(),b.reject(p)));r.push(f)}l.isDone?i():l.G===null?a.continue():a.continue(l.G)}}).next(()=>b.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function ki(t){return new b((e,n)=>{t.onsuccess=r=>{const i=r.target.result;e(i)},t.onerror=r=>{const i=ag(r.target.error);n(i)}})}let bT=!1;function ag(t){const e=jr.M(ct());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new Q("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return bT||(bT=!0,setTimeout(()=>{throw r},0)),r}}return t}const Ga="IndexBackfiller";class IF{constructor(e,n){this.asyncQueue=e,this.ne=n,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){$(Ga,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const n=await this.ne.ie();$(Ga,`Documents written: ${n}`)}catch(n){hi(n)?$(Ga,"Ignoring IndexedDB error during index backfill: ",n):await us(n)}await this.re(6e4)})}}class wF{constructor(e,n){this.localStore=e,this.persistence=n}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.se(n,e))}se(e,n){const r=new Set;let i=n,s=!0;return b.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return $(Ga,`Processing collection: ${o}`),this.oe(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>n-i)}oe(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this._e(i,s)).next(a=>($(Ga,`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}_e(e,n){let r=e;return n.changes.forEach((i,s)=>{const o=zC(s);og(o,r)>0&&(r=o)}),new tn(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cn{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}cn.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qi=-1;function Bd(t){return t==null}function gl(t){return t===0&&1/t==-1/0}function SF(t){return typeof t=="number"&&Number.isInteger(t)&&!gl(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xc="";function kt(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=LT(e)),e=CF(t.get(n),e);return LT(e)}function CF(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const s=t.charAt(i);switch(s){case"\0":n+="";break;case Xc:n+="";break;default:n+=s}}return n}function LT(t){return t+Xc+""}function On(t){const e=t.length;if(te(e>=2,64408,{path:t}),e===2)return te(t.charAt(0)===Xc&&t.charAt(1)==="",56145,{path:t}),ke.emptyPath();const n=e-2,r=[];let i="";for(let s=0;s<e;){const o=t.indexOf(Xc,s);switch((o<0||o>n)&&Z(50515,{path:t}),t.charAt(o+1)){case"":const a=t.substring(s,o);let l;i.length===0?l=a:(i+=a,l=i,i=""),r.push(l);break;case"":i+=t.substring(s,o),i+="\0";break;case"":i+=t.substring(s,o+1);break;default:Z(61167,{path:t})}s=o+2}return new ke(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xi="remoteDocuments",Fl="owner",Ts="owner",_l="mutationQueues",AF="userId",En="mutations",FT="batchId",Ui="userMutationsIndex",UT=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oc(t,e){return[t,kt(e)]}function JC(t,e,n){return[t,kt(e),n]}const RF={},_o="documentMutations",Zc="remoteDocumentsV14",PF=["prefixPath","collectionGroup","readTime","documentId"],ac="documentKeyIndex",xF=["prefixPath","collectionGroup","documentId"],QC="collectionGroupIndex",kF=["collectionGroup","readTime","prefixPath","documentId"],yl="remoteDocumentGlobal",wp="remoteDocumentGlobalKey",yo="targets",YC="queryTargetsIndex",NF=["canonicalId","targetId"],vo="targetDocuments",DF=["targetId","path"],lg="documentTargetsIndex",MF=["path","targetId"],ed="targetGlobalKey",$i="targetGlobal",vl="collectionParents",VF=["collectionId","parent"],To="clientMetadata",bF="clientId",Gd="bundles",LF="bundleId",qd="namedQueries",FF="name",ug="indexConfiguration",UF="indexId",Sp="collectionGroupIndex",OF="collectionGroup",qa="indexState",BF=["indexId","uid"],jC="sequenceNumberIndex",GF=["uid","sequenceNumber"],$a="indexEntries",qF=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],XC="documentKeyIndex",$F=["indexId","uid","orderedDocumentKey"],$d="documentOverlays",zF=["userId","collectionPath","documentId"],Cp="collectionPathOverlayIndex",HF=["userId","collectionPath","largestBatchId"],ZC="collectionGroupOverlayIndex",KF=["userId","collectionGroup","largestBatchId"],cg="globals",WF="name",e0=[_l,En,_o,xi,yo,Fl,$i,vo,To,yl,vl,Gd,qd],JF=[...e0,$d],t0=[_l,En,_o,Zc,yo,Fl,$i,vo,To,yl,vl,Gd,qd,$d],n0=t0,dg=[...n0,ug,qa,$a],QF=dg,r0=[...dg,cg],YF=r0;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ap extends KC{constructor(e,n){super(),this.le=e,this.currentSequenceNumber=n}}function dt(t,e){const n=ue(t);return jr.O(n.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OT(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function cs(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function i0(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class He{constructor(e,n){this.comparator=e,this.root=n||Et.EMPTY}insert(e,n){return new He(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Et.BLACK,null,null))}remove(e){return new He(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Et.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Mu(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Mu(this.root,e,this.comparator,!1)}getReverseIterator(){return new Mu(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Mu(this.root,e,this.comparator,!0)}}class Mu{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Et{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??Et.RED,this.left=i??Et.EMPTY,this.right=s??Et.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new Et(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Et.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return Et.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Et.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Et.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Z(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Z(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Z(27949);return e+(this.isRed()?0:1)}}Et.EMPTY=null,Et.RED=!0,Et.BLACK=!1;Et.EMPTY=new class{constructor(){this.size=0}get key(){throw Z(57766)}get value(){throw Z(16141)}get color(){throw Z(16727)}get left(){throw Z(29726)}get right(){throw Z(36894)}copy(e,n,r,i,s){return this}insert(e,n,r){return new Et(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xe{constructor(e){this.comparator=e,this.data=new He(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new BT(this.data.getIterator())}getIteratorFrom(e){return new BT(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof xe)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new xe(this.comparator);return n.data=e,n}}class BT{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Es(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dn{constructor(e){this.fields=e,e.sort(ze.comparator)}static empty(){return new dn([])}unionWith(e){let n=new xe(ze.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new dn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return go(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s0 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ze{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new s0("Invalid base64 string: "+s):s}}(e);return new Ze(n)}static fromUint8Array(e){const n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new Ze(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return le(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ze.EMPTY_BYTE_STRING=new Ze("");const jF=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function dr(t){if(te(!!t,39018),typeof t=="string"){let e=0;const n=jF.exec(t);if(te(!!n,46558,{timestamp:t}),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:qe(t.seconds),nanos:qe(t.nanos)}}function qe(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function hr(t){return typeof t=="string"?Ze.fromBase64String(t):Ze.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o0="server_timestamp",a0="__type__",l0="__previous_value__",u0="__local_write_time__";function hg(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[a0])==null?void 0:r.stringValue)===o0}function zd(t){const e=t.mapValue.fields[l0];return hg(e)?zd(e):e}function Tl(t){const e=dr(t.mapValue.fields[u0].timestampValue);return new Se(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XF{constructor(e,n,r,i,s,o,a,l,u,f){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=u,this.isUsingEmulator=f}}const td="(default)";class ri{constructor(e,n){this.projectId=e,this.database=n||td}static empty(){return new ri("","")}get isDefaultDatabase(){return this.database===td}isEqual(e){return e instanceof ri&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fg="__type__",c0="__max__",Ur={mapValue:{fields:{__type__:{stringValue:c0}}}},pg="__vector__",Eo="value",lc={nullValue:"NULL_VALUE"};function ii(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?hg(t)?4:d0(t)?9007199254740991:Hd(t)?10:11:Z(28295,{value:t})}function Hn(t,e){if(t===e)return!0;const n=ii(t);if(n!==ii(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Tl(t).isEqual(Tl(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=dr(i.timestampValue),a=dr(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return hr(i.bytesValue).isEqual(hr(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return qe(i.geoPointValue.latitude)===qe(s.geoPointValue.latitude)&&qe(i.geoPointValue.longitude)===qe(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return qe(i.integerValue)===qe(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=qe(i.doubleValue),a=qe(s.doubleValue);return o===a?gl(o)===gl(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return go(t.arrayValue.values||[],e.arrayValue.values||[],Hn);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(OT(o)!==OT(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!Hn(o[l],a[l])))return!1;return!0}(t,e);default:return Z(52216,{left:t})}}function El(t,e){return(t.values||[]).find(n=>Hn(n,e))!==void 0}function si(t,e){if(t===e)return 0;const n=ii(t),r=ii(e);if(n!==r)return le(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return le(t.booleanValue,e.booleanValue);case 2:return function(s,o){const a=qe(s.integerValue||s.doubleValue),l=qe(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(t,e);case 3:return GT(t.timestampValue,e.timestampValue);case 4:return GT(Tl(t),Tl(e));case 5:return Ep(t.stringValue,e.stringValue);case 6:return function(s,o){const a=hr(s),l=hr(o);return a.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),l=o.split("/");for(let u=0;u<a.length&&u<l.length;u++){const f=le(a[u],l[u]);if(f!==0)return f}return le(a.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){const a=le(qe(s.latitude),qe(o.latitude));return a!==0?a:le(qe(s.longitude),qe(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return qT(t.arrayValue,e.arrayValue);case 10:return function(s,o){var m,v,I,x;const a=s.fields||{},l=o.fields||{},u=(m=a[Eo])==null?void 0:m.arrayValue,f=(v=l[Eo])==null?void 0:v.arrayValue,p=le(((I=u==null?void 0:u.values)==null?void 0:I.length)||0,((x=f==null?void 0:f.values)==null?void 0:x.length)||0);return p!==0?p:qT(u,f)}(t.mapValue,e.mapValue);case 11:return function(s,o){if(s===Ur.mapValue&&o===Ur.mapValue)return 0;if(s===Ur.mapValue)return 1;if(o===Ur.mapValue)return-1;const a=s.fields||{},l=Object.keys(a),u=o.fields||{},f=Object.keys(u);l.sort(),f.sort();for(let p=0;p<l.length&&p<f.length;++p){const m=Ep(l[p],f[p]);if(m!==0)return m;const v=si(a[l[p]],u[f[p]]);if(v!==0)return v}return le(l.length,f.length)}(t.mapValue,e.mapValue);default:throw Z(23264,{he:n})}}function GT(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return le(t,e);const n=dr(t),r=dr(e),i=le(n.seconds,r.seconds);return i!==0?i:le(n.nanos,r.nanos)}function qT(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const s=si(n[i],r[i]);if(s)return s}return le(n.length,r.length)}function Io(t){return Rp(t)}function Rp(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=dr(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return hr(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return J.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=Rp(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${Rp(n.fields[o])}`;return i+"}"}(t.mapValue):Z(61005,{value:t})}function uc(t){switch(ii(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=zd(t);return e?16+uc(e):16;case 5:return 2*t.stringValue.length;case 6:return hr(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,s)=>i+uc(s),0)}(t.arrayValue);case 10:case 11:return function(r){let i=0;return cs(r.fields,(s,o)=>{i+=s.length+uc(o)}),i}(t.mapValue);default:throw Z(13486,{value:t})}}function mg(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Pp(t){return!!t&&"integerValue"in t}function Il(t){return!!t&&"arrayValue"in t}function $T(t){return!!t&&"nullValue"in t}function zT(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function cc(t){return!!t&&"mapValue"in t}function Hd(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[fg])==null?void 0:r.stringValue)===pg}function za(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return cs(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=za(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=za(t.arrayValue.values[n]);return e}return{...t}}function d0(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===c0}const h0={mapValue:{fields:{[fg]:{stringValue:pg},[Eo]:{arrayValue:{}}}}};function ZF(t){return"nullValue"in t?lc:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?mg(ri.empty(),J.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?Hd(t)?h0:{mapValue:{}}:Z(35942,{value:t})}function eU(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?mg(ri.empty(),J.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?h0:"mapValue"in t?Hd(t)?{mapValue:{}}:Ur:Z(61959,{value:t})}function HT(t,e){const n=si(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function KT(t,e){const n=si(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ot{constructor(e){this.value=e}static empty(){return new Ot({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!cc(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=za(n)}setAll(e){let n=ze.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=za(o):i.push(a.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());cc(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Hn(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];cc(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){cs(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new Ot(za(this.value))}}function f0(t){const e=[];return cs(t.fields,(n,r)=>{const i=new ze([n]);if(cc(r)){const s=f0(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new dn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class je{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new je(e,0,re.min(),re.min(),re.min(),Ot.empty(),0)}static newFoundDocument(e,n,r,i){return new je(e,1,n,re.min(),r,i,0)}static newNoDocument(e,n){return new je(e,2,n,re.min(),re.min(),Ot.empty(),0)}static newUnknownDocument(e,n){return new je(e,3,n,re.min(),re.min(),Ot.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(re.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ot.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ot.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=re.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof je&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new je(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wo{constructor(e,n){this.position=e,this.inclusive=n}}function WT(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(s.field.isKeyField()?r=J.comparator(J.fromName(o.referenceValue),n.key):r=si(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function JT(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Hn(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nd{constructor(e,n="asc"){this.field=e,this.dir=n}}function tU(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p0{}class _e extends p0{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new nU(e,n,r):n==="array-contains"?new sU(e,r):n==="in"?new T0(e,r):n==="not-in"?new oU(e,r):n==="array-contains-any"?new aU(e,r):new _e(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new rU(e,r):new iU(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(si(n,this.value)):n!==null&&ii(this.value)===ii(n)&&this.matchesComparison(si(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Z(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ne extends p0{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new Ne(e,n)}matches(e){return So(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function So(t){return t.op==="and"}function xp(t){return t.op==="or"}function gg(t){return m0(t)&&So(t)}function m0(t){for(const e of t.filters)if(e instanceof Ne)return!1;return!0}function kp(t){if(t instanceof _e)return t.field.canonicalString()+t.op.toString()+Io(t.value);if(gg(t))return t.filters.map(e=>kp(e)).join(",");{const e=t.filters.map(n=>kp(n)).join(",");return`${t.op}(${e})`}}function g0(t,e){return t instanceof _e?function(r,i){return i instanceof _e&&r.op===i.op&&r.field.isEqual(i.field)&&Hn(r.value,i.value)}(t,e):t instanceof Ne?function(r,i){return i instanceof Ne&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&g0(o,i.filters[a]),!0):!1}(t,e):void Z(19439)}function _0(t,e){const n=t.filters.concat(e);return Ne.create(n,t.op)}function y0(t){return t instanceof _e?function(n){return`${n.field.canonicalString()} ${n.op} ${Io(n.value)}`}(t):t instanceof Ne?function(n){return n.op.toString()+" {"+n.getFilters().map(y0).join(" ,")+"}"}(t):"Filter"}class nU extends _e{constructor(e,n,r){super(e,n,r),this.key=J.fromName(r.referenceValue)}matches(e){const n=J.comparator(e.key,this.key);return this.matchesComparison(n)}}class rU extends _e{constructor(e,n){super(e,"in",n),this.keys=v0("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class iU extends _e{constructor(e,n){super(e,"not-in",n),this.keys=v0("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function v0(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(r=>J.fromName(r.referenceValue))}class sU extends _e{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Il(n)&&El(n.arrayValue,this.value)}}class T0 extends _e{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&El(this.value.arrayValue,n)}}class oU extends _e{constructor(e,n){super(e,"not-in",n)}matches(e){if(El(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!El(this.value.arrayValue,n)}}class aU extends _e{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Il(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>El(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lU{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.Te=null}}function Np(t,e=null,n=[],r=[],i=null,s=null,o=null){return new lU(t,e,n,r,i,s,o)}function ts(t){const e=ue(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>kp(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Bd(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Io(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Io(r)).join(",")),e.Te=n}return e.Te}function Ul(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!tU(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!g0(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!JT(t.startAt,e.startAt)&&JT(t.endAt,e.endAt)}function rd(t){return J.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function id(t,e){return t.filters.filter(n=>n instanceof _e&&n.field.isEqual(e))}function QT(t,e,n){let r=lc,i=!0;for(const s of id(t,e)){let o=lc,a=!0;switch(s.op){case"<":case"<=":o=ZF(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=lc}HT({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];HT({value:r,inclusive:i},{value:o,inclusive:n.inclusive})<0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}function YT(t,e,n){let r=Ur,i=!0;for(const s of id(t,e)){let o=Ur,a=!0;switch(s.op){case">=":case">":o=eU(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=Ur}KT({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];KT({value:r,inclusive:i},{value:o,inclusive:n.inclusive})>0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kd{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function uU(t,e,n,r,i,s,o,a){return new Kd(t,e,n,r,i,s,o,a)}function Wd(t){return new Kd(t)}function jT(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function cU(t){return t.collectionGroup!==null}function Ha(t){const e=ue(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new xe(ze.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(u=>{u.isInequality()&&(a=a.add(u.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new nd(s,r))}),n.has(ze.keyField().canonicalString())||e.Ie.push(new nd(ze.keyField(),r))}return e.Ie}function pn(t){const e=ue(t);return e.Ee||(e.Ee=dU(e,Ha(t))),e.Ee}function dU(t,e){if(t.limitType==="F")return Np(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new nd(i.field,s)});const n=t.endAt?new wo(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new wo(t.startAt.position,t.startAt.inclusive):null;return Np(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Dp(t,e,n){return new Kd(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Jd(t,e){return Ul(pn(t),pn(e))&&t.limitType===e.limitType}function E0(t){return`${ts(pn(t))}|lt:${t.limitType}`}function Rs(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>y0(i)).join(", ")}]`),Bd(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>Io(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>Io(i)).join(",")),`Target(${r})`}(pn(t))}; limitType=${t.limitType})`}function Ol(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):J.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of Ha(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,a,l){const u=WT(o,a,l);return o.inclusive?u<=0:u<0}(r.startAt,Ha(r),i)||r.endAt&&!function(o,a,l){const u=WT(o,a,l);return o.inclusive?u>=0:u>0}(r.endAt,Ha(r),i))}(t,e)}function hU(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function I0(t){return(e,n)=>{let r=!1;for(const i of Ha(t)){const s=fU(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function fU(t,e,n){const r=t.field.isKeyField()?J.comparator(e.key,n.key):function(s,o,a){const l=o.data.field(s),u=a.data.field(s);return l!==null&&u!==null?si(l,u):Z(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Z(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gr{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){cs(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return i0(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pU=new He(J.comparator);function Yt(){return pU}const w0=new He(J.comparator);function Ca(...t){let e=w0;for(const n of t)e=e.insert(n.key,n);return e}function S0(t){let e=w0;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Bn(){return Ka()}function C0(){return Ka()}function Ka(){return new gr(t=>t.toString(),(t,e)=>t.isEqual(e))}const mU=new He(J.comparator),gU=new xe(J.comparator);function fe(...t){let e=gU;for(const n of t)e=e.add(n);return e}const _U=new xe(le);function yU(){return _U}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _g(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:gl(e)?"-0":e}}function A0(t){return{integerValue:""+t}}function vU(t,e){return SF(e)?A0(e):_g(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qd{constructor(){this._=void 0}}function TU(t,e,n){return t instanceof Co?function(i,s){const o={fields:{[a0]:{stringValue:o0},[u0]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&hg(s)&&(s=zd(s)),s&&(o.fields[l0]=s),{mapValue:o}}(n,e):t instanceof Ao?P0(t,e):t instanceof Ro?x0(t,e):function(i,s){const o=R0(i,s),a=XT(o)+XT(i.Ae);return Pp(o)&&Pp(i.Ae)?A0(a):_g(i.serializer,a)}(t,e)}function EU(t,e,n){return t instanceof Ao?P0(t,e):t instanceof Ro?x0(t,e):n}function R0(t,e){return t instanceof wl?function(r){return Pp(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class Co extends Qd{}class Ao extends Qd{constructor(e){super(),this.elements=e}}function P0(t,e){const n=k0(e);for(const r of t.elements)n.some(i=>Hn(i,r))||n.push(r);return{arrayValue:{values:n}}}class Ro extends Qd{constructor(e){super(),this.elements=e}}function x0(t,e){let n=k0(e);for(const r of t.elements)n=n.filter(i=>!Hn(i,r));return{arrayValue:{values:n}}}class wl extends Qd{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function XT(t){return qe(t.integerValue||t.doubleValue)}function k0(t){return Il(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N0{constructor(e,n){this.field=e,this.transform=n}}function IU(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof Ao&&i instanceof Ao||r instanceof Ro&&i instanceof Ro?go(r.elements,i.elements,Hn):r instanceof wl&&i instanceof wl?Hn(r.Ae,i.Ae):r instanceof Co&&i instanceof Co}(t.transform,e.transform)}class wU{constructor(e,n){this.version=e,this.transformResults=n}}class jt{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new jt}static exists(e){return new jt(void 0,e)}static updateTime(e){return new jt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function dc(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Yd{}function D0(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new yg(t.key,jt.none()):new Go(t.key,t.data,jt.none());{const n=t.data,r=Ot.empty();let i=new xe(ze.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new fi(t.key,r,new dn(i.toArray()),jt.none())}}function SU(t,e,n){t instanceof Go?function(i,s,o){const a=i.value.clone(),l=eE(i.fieldTransforms,s,o.transformResults);a.setAll(l),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof fi?function(i,s,o){if(!dc(i.precondition,s))return void s.convertToUnknownDocument(o.version);const a=eE(i.fieldTransforms,s,o.transformResults),l=s.data;l.setAll(M0(i)),l.setAll(a),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Wa(t,e,n,r){return t instanceof Go?function(s,o,a,l){if(!dc(s.precondition,o))return a;const u=s.value.clone(),f=tE(s.fieldTransforms,l,o);return u.setAll(f),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,n,r):t instanceof fi?function(s,o,a,l){if(!dc(s.precondition,o))return a;const u=tE(s.fieldTransforms,l,o),f=o.data;return f.setAll(M0(s)),f.setAll(u),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(p=>p.field))}(t,e,n,r):function(s,o,a){return dc(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function CU(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=R0(r.transform,i||null);s!=null&&(n===null&&(n=Ot.empty()),n.set(r.field,s))}return n||null}function ZT(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&go(r,i,(s,o)=>IU(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Go extends Yd{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class fi extends Yd{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function M0(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function eE(t,e,n){const r=new Map;te(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,EU(o,a,n[i]))}return r}function tE(t,e,n){const r=new Map;for(const i of t){const s=i.transform,o=n.data.field(i.field);r.set(i.field,TU(s,o,e))}return r}class yg extends Yd{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class V0 extends Yd{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vg{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&SU(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Wa(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Wa(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=C0();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;const l=D0(o,a);l!==null&&r.set(i.key,l),o.isValidDocument()||o.convertToNoDocument(re.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),fe())}isEqual(e){return this.batchId===e.batchId&&go(this.mutations,e.mutations,(n,r)=>ZT(n,r))&&go(this.baseMutations,e.baseMutations,(n,r)=>ZT(n,r))}}class Tg{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){te(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=function(){return mU}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new Tg(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eg{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AU{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var nt,Te;function RU(t){switch(t){case B.OK:return Z(64938);case B.CANCELLED:case B.UNKNOWN:case B.DEADLINE_EXCEEDED:case B.RESOURCE_EXHAUSTED:case B.INTERNAL:case B.UNAVAILABLE:case B.UNAUTHENTICATED:return!1;case B.INVALID_ARGUMENT:case B.NOT_FOUND:case B.ALREADY_EXISTS:case B.PERMISSION_DENIED:case B.FAILED_PRECONDITION:case B.ABORTED:case B.OUT_OF_RANGE:case B.UNIMPLEMENTED:case B.DATA_LOSS:return!0;default:return Z(15467,{code:t})}}function b0(t){if(t===void 0)return Mt("GRPC error has no .code"),B.UNKNOWN;switch(t){case nt.OK:return B.OK;case nt.CANCELLED:return B.CANCELLED;case nt.UNKNOWN:return B.UNKNOWN;case nt.DEADLINE_EXCEEDED:return B.DEADLINE_EXCEEDED;case nt.RESOURCE_EXHAUSTED:return B.RESOURCE_EXHAUSTED;case nt.INTERNAL:return B.INTERNAL;case nt.UNAVAILABLE:return B.UNAVAILABLE;case nt.UNAUTHENTICATED:return B.UNAUTHENTICATED;case nt.INVALID_ARGUMENT:return B.INVALID_ARGUMENT;case nt.NOT_FOUND:return B.NOT_FOUND;case nt.ALREADY_EXISTS:return B.ALREADY_EXISTS;case nt.PERMISSION_DENIED:return B.PERMISSION_DENIED;case nt.FAILED_PRECONDITION:return B.FAILED_PRECONDITION;case nt.ABORTED:return B.ABORTED;case nt.OUT_OF_RANGE:return B.OUT_OF_RANGE;case nt.UNIMPLEMENTED:return B.UNIMPLEMENTED;case nt.DATA_LOSS:return B.DATA_LOSS;default:return Z(39323,{code:t})}}(Te=nt||(nt={}))[Te.OK=0]="OK",Te[Te.CANCELLED=1]="CANCELLED",Te[Te.UNKNOWN=2]="UNKNOWN",Te[Te.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Te[Te.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Te[Te.NOT_FOUND=5]="NOT_FOUND",Te[Te.ALREADY_EXISTS=6]="ALREADY_EXISTS",Te[Te.PERMISSION_DENIED=7]="PERMISSION_DENIED",Te[Te.UNAUTHENTICATED=16]="UNAUTHENTICATED",Te[Te.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Te[Te.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Te[Te.ABORTED=10]="ABORTED",Te[Te.OUT_OF_RANGE=11]="OUT_OF_RANGE",Te[Te.UNIMPLEMENTED=12]="UNIMPLEMENTED",Te[Te.INTERNAL=13]="INTERNAL",Te[Te.UNAVAILABLE=14]="UNAVAILABLE",Te[Te.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PU(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xU=new Yr([4294967295,4294967295],0);function nE(t){const e=PU().encode(t),n=new NC;return n.update(e),new Uint8Array(n.digest())}function rE(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Yr([n,r],0),new Yr([i,s],0)]}class Ig{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Aa(`Invalid padding: ${n}`);if(r<0)throw new Aa(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Aa(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Aa(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=Yr.fromNumber(this.ge)}ye(e,n,r){let i=e.add(n.multiply(Yr.fromNumber(r)));return i.compare(xU)===1&&(i=new Yr([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=nE(e),[r,i]=rE(n);for(let s=0;s<this.hashCount;s++){const o=this.ye(r,i,s);if(!this.we(o))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new Ig(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.ge===0)return;const n=nE(e),[r,i]=rE(n);for(let s=0;s<this.hashCount;s++){const o=this.ye(r,i,s);this.Se(o)}}Se(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Aa extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jd{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,Bl.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new jd(re.min(),i,new He(le),Yt(),fe())}}class Bl{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Bl(r,n,fe(),fe(),fe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hc{constructor(e,n,r,i){this.be=e,this.removedTargetIds=n,this.key=r,this.De=i}}class L0{constructor(e,n){this.targetId=e,this.Ce=n}}class F0{constructor(e,n,r=Ze.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class iE{constructor(){this.ve=0,this.Fe=sE(),this.Me=Ze.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=fe(),n=fe(),r=fe();return this.Fe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:Z(38017,{changeType:s})}}),new Bl(this.Me,this.xe,e,n,r)}qe(){this.Oe=!1,this.Fe=sE()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,te(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class kU{constructor(e){this.Ge=e,this.ze=new Map,this.je=Yt(),this.Je=Vu(),this.He=Vu(),this.Ye=new He(le)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:Z(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((r,i)=>{this.rt(i)&&n(i)})}st(e){const n=e.targetId,r=e.Ce.count,i=this.ot(n);if(i){const s=i.target;if(rd(s))if(r===0){const o=new J(s.path);this.et(n,o,je.newNoDocument(o,re.min()))}else te(r===1,20013,{expectedCount:r});else{const o=this._t(n);if(o!==r){const a=this.ut(e),l=a?this.ct(a,e,o):1;if(l!==0){this.it(n);const u=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,u)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let o,a;try{o=hr(r).toUint8Array()}catch(l){if(l instanceof s0)return ni("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new Ig(o,i,s)}catch(l){return ni(l instanceof Aa?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.ge===0?null:a}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.et(n,s,null),i++)}),i}Tt(e){const n=new Map;this.ze.forEach((s,o)=>{const a=this.ot(o);if(a){if(s.current&&rd(a.target)){const l=new J(a.target.path);this.It(l).has(o)||this.Et(o,l)||this.et(o,l,je.newNoDocument(l,e))}s.Be&&(n.set(o,s.ke()),s.qe())}});let r=fe();this.He.forEach((s,o)=>{let a=!0;o.forEachWhile(l=>{const u=this.ot(l);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.je.forEach((s,o)=>o.setReadTime(e));const i=new jd(e,n,this.Ye,this.je,r);return this.je=Yt(),this.Je=Vu(),this.He=Vu(),this.Ye=new He(le),i}Xe(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,r),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,n)?i.Qe(n,1):i.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new iE,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new xe(le),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new xe(le),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||$("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new iE),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function Vu(){return new He(J.comparator)}function sE(){return new He(J.comparator)}const NU={asc:"ASCENDING",desc:"DESCENDING"},DU={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},MU={and:"AND",or:"OR"};class VU{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Mp(t,e){return t.useProto3Json||Bd(e)?e:{value:e}}function Po(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function U0(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function bU(t,e){return Po(t,e.toTimestamp())}function bt(t){return te(!!t,49232),re.fromTimestamp(function(n){const r=dr(n);return new Se(r.seconds,r.nanos)}(t))}function wg(t,e){return Vp(t,e).canonicalString()}function Vp(t,e){const n=function(i){return new ke(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function O0(t){const e=ke.fromString(t);return te(J0(e),10190,{key:e.toString()}),e}function sd(t,e){return wg(t.databaseId,e.path)}function zi(t,e){const n=O0(e);if(n.get(1)!==t.databaseId.projectId)throw new Q(B.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Q(B.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new J(q0(n))}function B0(t,e){return wg(t.databaseId,e)}function G0(t){const e=O0(t);return e.length===4?ke.emptyPath():q0(e)}function bp(t){return new ke(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function q0(t){return te(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function oE(t,e,n){return{name:sd(t,e),fields:n.value.mapValue.fields}}function LU(t,e,n){const r=zi(t,e.name),i=bt(e.updateTime),s=e.createTime?bt(e.createTime):re.min(),o=new Ot({mapValue:{fields:e.fields}}),a=je.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function FU(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:Z(39313,{state:u})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(u,f){return u.useProto3Json?(te(f===void 0||typeof f=="string",58123),Ze.fromBase64String(f||"")):(te(f===void 0||f instanceof Buffer||f instanceof Uint8Array,16193),Ze.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(u){const f=u.code===void 0?B.UNKNOWN:b0(u.code);return new Q(f,u.message||"")}(o);n=new F0(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=zi(t,r.document.name),s=bt(r.document.updateTime),o=r.document.createTime?bt(r.document.createTime):re.min(),a=new Ot({mapValue:{fields:r.document.fields}}),l=je.newFoundDocument(i,s,o,a),u=r.targetIds||[],f=r.removedTargetIds||[];n=new hc(u,f,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=zi(t,r.document),s=r.readTime?bt(r.readTime):re.min(),o=je.newNoDocument(i,s),a=r.removedTargetIds||[];n=new hc([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=zi(t,r.document),s=r.removedTargetIds||[];n=new hc([],s,i,null)}else{if(!("filter"in e))return Z(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new AU(i,s),a=r.targetId;n=new L0(a,o)}}return n}function od(t,e){let n;if(e instanceof Go)n={update:oE(t,e.key,e.value)};else if(e instanceof yg)n={delete:sd(t,e.key)};else if(e instanceof fi)n={update:oE(t,e.key,e.data),updateMask:$U(e.fieldMask)};else{if(!(e instanceof V0))return Z(16599,{Vt:e.type});n={verify:sd(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const a=o.transform;if(a instanceof Co)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Ao)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Ro)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof wl)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw Z(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:bU(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Z(27497)}(t,e.precondition)),n}function Lp(t,e){const n=e.currentDocument?function(s){return s.updateTime!==void 0?jt.updateTime(bt(s.updateTime)):s.exists!==void 0?jt.exists(s.exists):jt.none()}(e.currentDocument):jt.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let l=null;if("setToServerValue"in a)te(a.setToServerValue==="REQUEST_TIME",16630,{proto:a}),l=new Co;else if("appendMissingElements"in a){const f=a.appendMissingElements.values||[];l=new Ao(f)}else if("removeAllFromArray"in a){const f=a.removeAllFromArray.values||[];l=new Ro(f)}else"increment"in a?l=new wl(o,a.increment):Z(16584,{proto:a});const u=ze.fromServerFormat(a.fieldPath);return new N0(u,l)}(t,i)):[];if(e.update){e.update.name;const i=zi(t,e.update.name),s=new Ot({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(l){const u=l.fieldPaths||[];return new dn(u.map(f=>ze.fromServerFormat(f)))}(e.updateMask);return new fi(i,s,o,n,r)}return new Go(i,s,n,r)}if(e.delete){const i=zi(t,e.delete);return new yg(i,n)}if(e.verify){const i=zi(t,e.verify);return new V0(i,n)}return Z(1463,{proto:e})}function UU(t,e){return t&&t.length>0?(te(e!==void 0,14353),t.map(n=>function(i,s){let o=i.updateTime?bt(i.updateTime):bt(s);return o.isEqual(re.min())&&(o=bt(s)),new wU(o,i.transformResults||[])}(n,e))):[]}function $0(t,e){return{documents:[B0(t,e.path)]}}function z0(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=B0(t,i);const s=function(u){if(u.length!==0)return W0(Ne.create(u,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const o=function(u){if(u.length!==0)return u.map(f=>function(m){return{field:Ps(m.field),direction:BU(m.dir)}}(f))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=Mp(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{ft:n,parent:i}}function H0(t){let e=G0(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){te(r===1,65062);const f=n.from[0];f.allDescendants?i=f.collectionId:e=e.child(f.collectionId)}let s=[];n.where&&(s=function(p){const m=K0(p);return m instanceof Ne&&gg(m)?m.getFilters():[m]}(n.where));let o=[];n.orderBy&&(o=function(p){return p.map(m=>function(I){return new nd(xs(I.field),function(M){switch(M){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(I.direction))}(m))}(n.orderBy));let a=null;n.limit&&(a=function(p){let m;return m=typeof p=="object"?p.value:p,Bd(m)?null:m}(n.limit));let l=null;n.startAt&&(l=function(p){const m=!!p.before,v=p.values||[];return new wo(v,m)}(n.startAt));let u=null;return n.endAt&&(u=function(p){const m=!p.before,v=p.values||[];return new wo(v,m)}(n.endAt)),uU(e,i,o,s,a,"F",l,u)}function OU(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Z(28987,{purpose:i})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function K0(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=xs(n.unaryFilter.field);return _e.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=xs(n.unaryFilter.field);return _e.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=xs(n.unaryFilter.field);return _e.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=xs(n.unaryFilter.field);return _e.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Z(61313);default:return Z(60726)}}(t):t.fieldFilter!==void 0?function(n){return _e.create(xs(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Z(58110);default:return Z(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Ne.create(n.compositeFilter.filters.map(r=>K0(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Z(1026)}}(n.compositeFilter.op))}(t):Z(30097,{filter:t})}function BU(t){return NU[t]}function GU(t){return DU[t]}function qU(t){return MU[t]}function Ps(t){return{fieldPath:t.canonicalString()}}function xs(t){return ze.fromServerFormat(t.fieldPath)}function W0(t){return t instanceof _e?function(n){if(n.op==="=="){if(zT(n.value))return{unaryFilter:{field:Ps(n.field),op:"IS_NAN"}};if($T(n.value))return{unaryFilter:{field:Ps(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(zT(n.value))return{unaryFilter:{field:Ps(n.field),op:"IS_NOT_NAN"}};if($T(n.value))return{unaryFilter:{field:Ps(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ps(n.field),op:GU(n.op),value:n.value}}}(t):t instanceof Ne?function(n){const r=n.getFilters().map(i=>W0(i));return r.length===1?r[0]:{compositeFilter:{op:qU(n.op),filters:r}}}(t):Z(54877,{filter:t})}function $U(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function J0(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nr{constructor(e,n,r,i,s=re.min(),o=re.min(),a=Ze.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new nr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new nr(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new nr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new nr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q0{constructor(e){this.yt=e}}function zU(t,e){let n;if(e.document)n=LU(t.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=J.fromSegments(e.noDocument.path),i=rs(e.noDocument.readTime);n=je.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return Z(56709);{const r=J.fromSegments(e.unknownDocument.path),i=rs(e.unknownDocument.version);n=je.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){const s=new Se(i[0],i[1]);return re.fromTimestamp(s)}(e.readTime)),n}function aE(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:ad(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:sd(s,o.key),fields:o.data.value.mapValue.fields,updateTime:Po(s,o.version.toTimestamp()),createTime:Po(s,o.createTime.toTimestamp())}}(t.yt,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:ns(e.version)};else{if(!e.isUnknownDocument())return Z(57904,{document:e});r.unknownDocument={path:n.path.toArray(),version:ns(e.version)}}return r}function ad(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function ns(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function rs(t){const e=new Se(t.seconds,t.nanoseconds);return re.fromTimestamp(e)}function Ni(t,e){const n=(e.baseMutations||[]).map(s=>Lp(t.yt,s));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map(s=>Lp(t.yt,s)),i=Se.fromMillis(e.localWriteTimeMs);return new vg(e.batchId,i,n,r)}function Ra(t){const e=rs(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?rs(t.lastLimboFreeSnapshotVersion):re.min();let r;return r=function(s){return s.documents!==void 0}(t.query)?function(s){const o=s.documents.length;return te(o===1,1966,{count:o}),pn(Wd(G0(s.documents[0])))}(t.query):function(s){return pn(H0(s))}(t.query),new nr(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,Ze.fromBase64String(t.resumeToken))}function Y0(t,e){const n=ns(e.snapshotVersion),r=ns(e.lastLimboFreeSnapshotVersion);let i;i=rd(e.target)?$0(t.yt,e.target):z0(t.yt,e.target).ft;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:ts(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function j0(t){const e=H0({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Dp(e,e.limit,"L"):e}function rf(t,e){return new Eg(e.largestBatchId,Lp(t.yt,e.overlayMutation))}function lE(t,e){const n=e.path.lastSegment();return[t,kt(e.path.popLast()),n]}function uE(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:ns(r.readTime),documentKey:kt(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HU{getBundleMetadata(e,n){return cE(e).get(n).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:rs(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,n){return cE(e).put(function(i){return{bundleId:i.id,createTime:ns(bt(i.createTime)),version:i.version}}(n))}getNamedQuery(e,n){return dE(e).get(n).next(r=>{if(r)return function(s){return{name:s.name,query:j0(s.bundledQuery),readTime:rs(s.readTime)}}(r)})}saveNamedQuery(e,n){return dE(e).put(function(i){return{name:i.name,readTime:ns(bt(i.readTime)),bundledQuery:i.bundledQuery}}(n))}}function cE(t){return dt(t,Gd)}function dE(t){return dt(t,qd)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xd{constructor(e,n){this.serializer=e,this.userId=n}static wt(e,n){const r=n.uid||"";return new Xd(e,r)}getOverlay(e,n){return ma(e).get(lE(this.userId,n)).next(r=>r?rf(this.serializer,r):null)}getOverlays(e,n){const r=Bn();return b.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){const i=[];return r.forEach((s,o)=>{const a=new Eg(n,o);i.push(this.St(e,a))}),b.waitFor(i)}removeOverlaysForBatchId(e,n,r){const i=new Set;n.forEach(o=>i.add(kt(o.getCollectionPath())));const s=[];return i.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(ma(e).Z(Cp,a))}),b.waitFor(s)}getOverlaysForCollection(e,n,r){const i=Bn(),s=kt(n),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return ma(e).J(Cp,o).next(a=>{for(const l of a){const u=rf(this.serializer,l);i.set(u.getKey(),u)}return i})}getOverlaysForCollectionGroup(e,n,r,i){const s=Bn();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return ma(e).ee({index:ZC,range:a},(l,u,f)=>{const p=rf(this.serializer,u);s.size()<i||p.largestBatchId===o?(s.set(p.getKey(),p),o=p.largestBatchId):f.done()}).next(()=>s)}St(e,n){return ma(e).put(function(i,s,o){const[a,l,u]=lE(s,o.mutation.key);return{userId:s,collectionPath:l,documentId:u,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:od(i.yt,o.mutation)}}(this.serializer,this.userId,n))}}function ma(t){return dt(t,$d)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KU{bt(e){return dt(e,cg)}getSessionToken(e){return this.bt(e).get("sessionToken").next(n=>{const r=n==null?void 0:n.value;return r?Ze.fromUint8Array(r):Ze.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.bt(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Di{constructor(){}Dt(e,n){this.Ct(e,n),n.vt()}Ct(e,n){if("nullValue"in e)this.Ft(n,5);else if("booleanValue"in e)this.Ft(n,10),n.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(n,15),n.Mt(qe(e.integerValue));else if("doubleValue"in e){const r=qe(e.doubleValue);isNaN(r)?this.Ft(n,13):(this.Ft(n,15),gl(r)?n.Mt(0):n.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(n,20),typeof r=="string"&&(r=dr(r)),n.xt(`${r.seconds||""}`),n.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,n),this.Nt(n);else if("bytesValue"in e)this.Ft(n,30),n.Bt(hr(e.bytesValue)),this.Nt(n);else if("referenceValue"in e)this.Lt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(n,45),n.Mt(r.latitude||0),n.Mt(r.longitude||0)}else"mapValue"in e?d0(e)?this.Ft(n,Number.MAX_SAFE_INTEGER):Hd(e)?this.kt(e.mapValue,n):(this.qt(e.mapValue,n),this.Nt(n)):"arrayValue"in e?(this.Qt(e.arrayValue,n),this.Nt(n)):Z(19022,{$t:e})}Ot(e,n){this.Ft(n,25),this.Ut(e,n)}Ut(e,n){n.xt(e)}qt(e,n){const r=e.fields||{};this.Ft(n,55);for(const i of Object.keys(r))this.Ot(i,n),this.Ct(r[i],n)}kt(e,n){var o,a;const r=e.fields||{};this.Ft(n,53);const i=Eo,s=((a=(o=r[i].arrayValue)==null?void 0:o.values)==null?void 0:a.length)||0;this.Ft(n,15),n.Mt(qe(s)),this.Ot(i,n),this.Ct(r[i],n)}Qt(e,n){const r=e.values||[];this.Ft(n,50);for(const i of r)this.Ct(i,n)}Lt(e,n){this.Ft(n,37),J.fromName(e).path.forEach(r=>{this.Ft(n,60),this.Ut(r,n)})}Ft(e,n){e.Mt(n)}Nt(e){e.Mt(2)}}Di.Kt=new Di;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Is=255;function WU(t){if(t===0)return 8;let e=0;return t>>4||(e+=4,t<<=4),t>>6||(e+=2,t<<=2),t>>7||(e+=1),e}function hE(t){const e=64-function(r){let i=0;for(let s=0;s<8;++s){const o=WU(255&r[s]);if(i+=o,o!==8)break}return i}(t);return Math.ceil(e/8)}class JU{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Gt(r.value),r=n.next();this.zt()}jt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Jt(r.value),r=n.next();this.Ht()}Yt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const i=n.codePointAt(0);this.Gt(240|i>>>18),this.Gt(128|63&i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i)}}this.zt()}Zt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const i=n.codePointAt(0);this.Jt(240|i>>>18),this.Jt(128|63&i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i)}}this.Ht()}Xt(e){const n=this.en(e),r=hE(n);this.tn(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}nn(e){const n=this.en(e),r=hE(n);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}rn(){this.sn(Is),this.sn(255)}_n(){this.an(Is),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const n=function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=!!(128&n[0]);n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Gt(e){const n=255&e;n===0?(this.sn(0),this.sn(255)):n===Is?(this.sn(Is),this.sn(0)):this.sn(n)}Jt(e){const n=255&e;n===0?(this.an(0),this.an(255)):n===Is?(this.an(Is),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class QU{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class YU{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class ga{constructor(){this.cn=new JU,this.ln=new QU(this.cn),this.hn=new YU(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mi{constructor(e,n,r,i){this.Tn=e,this.In=n,this.En=r,this.dn=i}An(){const e=this.dn.length,n=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.dn,0),n!==e?r.set([0],this.dn.length):++r[r.length-1],new Mi(this.Tn,this.In,this.En,r)}Rn(e,n,r){return{indexId:this.Tn,uid:e,arrayValue:fc(this.En),directionalValue:fc(this.dn),orderedDocumentKey:fc(n),documentKey:r.path.toArray()}}Vn(e,n,r){const i=this.Rn(e,n,r);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}}function Cr(t,e){let n=t.Tn-e.Tn;return n!==0?n:(n=fE(t.En,e.En),n!==0?n:(n=fE(t.dn,e.dn),n!==0?n:J.comparator(t.In,e.In)))}function fE(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}function fc(t){return KS()?function(n){let r="";for(let i=0;i<n.length;i++)r+=String.fromCharCode(n[i]);return r}(t):t}function pE(t){return typeof t!="string"?t:function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(t)}class mE{constructor(e){this.mn=new xe((n,r)=>ze.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const n of e.filters){const r=n;r.isInequality()?this.mn=this.mn.add(r):this.gn.push(r)}}get pn(){return this.mn.size>1}yn(e){if(te(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const n=Ip(e);if(n!==void 0&&!this.wn(n))return!1;const r=Pi(e);let i=new Set,s=0,o=0;for(;s<r.length&&this.wn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.mn.size>0){const a=this.mn.getIterator().getNext();if(!i.has(a.field.canonicalString())){const l=r[s];if(!this.Sn(a,l)||!this.bn(this.fn[o++],l))return!1}++s}for(;s<r.length;++s){const a=r[s];if(o>=this.fn.length||!this.bn(this.fn[o++],a))return!1}return!0}Dn(){if(this.pn)return null;let e=new xe(ze.comparator);const n=[];for(const r of this.gn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new sc(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new sc(r.field,0))}for(const r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new sc(r.field,r.dir==="asc"?0:1)));return new jc(jc.UNKNOWN_ID,this.collectionId,n,ml.empty())}wn(e){for(const n of this.gn)if(this.Sn(n,e))return!0;return!1}Sn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}bn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X0(t){var n,r;if(te(t instanceof _e||t instanceof Ne,20012),t instanceof _e){if(t instanceof T0){const i=((r=(n=t.value.arrayValue)==null?void 0:n.values)==null?void 0:r.map(s=>_e.create(t.field,"==",s)))||[];return Ne.create(i,"or")}return t}const e=t.filters.map(i=>X0(i));return Ne.create(e,t.op)}function jU(t){if(t.getFilters().length===0)return[];const e=Op(X0(t));return te(Z0(e),7391),Fp(e)||Up(e)?[e]:e.getFilters()}function Fp(t){return t instanceof _e}function Up(t){return t instanceof Ne&&gg(t)}function Z0(t){return Fp(t)||Up(t)||function(n){if(n instanceof Ne&&xp(n)){for(const r of n.getFilters())if(!Fp(r)&&!Up(r))return!1;return!0}return!1}(t)}function Op(t){if(te(t instanceof _e||t instanceof Ne,34018),t instanceof _e)return t;if(t.filters.length===1)return Op(t.filters[0]);const e=t.filters.map(r=>Op(r));let n=Ne.create(e,t.op);return n=ld(n),Z0(n)?n:(te(n instanceof Ne,64498),te(So(n),40251),te(n.filters.length>1,57927),n.filters.reduce((r,i)=>Sg(r,i)))}function Sg(t,e){let n;return te(t instanceof _e||t instanceof Ne,38388),te(e instanceof _e||e instanceof Ne,25473),n=t instanceof _e?e instanceof _e?function(i,s){return Ne.create([i,s],"and")}(t,e):gE(t,e):e instanceof _e?gE(e,t):function(i,s){if(te(i.filters.length>0&&s.filters.length>0,48005),So(i)&&So(s))return _0(i,s.getFilters());const o=xp(i)?i:s,a=xp(i)?s:i,l=o.filters.map(u=>Sg(u,a));return Ne.create(l,"or")}(t,e),ld(n)}function gE(t,e){if(So(e))return _0(e,t.getFilters());{const n=e.filters.map(r=>Sg(t,r));return Ne.create(n,"or")}}function ld(t){if(te(t instanceof _e||t instanceof Ne,11850),t instanceof _e)return t;const e=t.getFilters();if(e.length===1)return ld(e[0]);if(m0(t))return t;const n=e.map(i=>ld(i)),r=[];return n.forEach(i=>{i instanceof _e?r.push(i):i instanceof Ne&&(i.op===t.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:Ne.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XU{constructor(){this.Cn=new Cg}addToCollectionParentIndex(e,n){return this.Cn.add(n),b.resolve()}getCollectionParents(e,n){return b.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return b.resolve()}deleteFieldIndex(e,n){return b.resolve()}deleteAllFieldIndexes(e){return b.resolve()}createTargetIndexes(e,n){return b.resolve()}getDocumentsMatchingTarget(e,n){return b.resolve(null)}getIndexType(e,n){return b.resolve(0)}getFieldIndexes(e,n){return b.resolve([])}getNextCollectionGroupToUpdate(e){return b.resolve(null)}getMinOffset(e,n){return b.resolve(tn.min())}getMinOffsetFromCollectionGroup(e,n){return b.resolve(tn.min())}updateCollectionGroup(e,n,r){return b.resolve()}updateIndexEntries(e,n){return b.resolve()}}class Cg{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new xe(ke.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new xe(ke.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _E="IndexedDbIndexManager",bu=new Uint8Array(0);class ZU{constructor(e,n){this.databaseId=n,this.vn=new Cg,this.Fn=new gr(r=>ts(r),(r,i)=>Ul(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.vn.has(n)){const r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this.vn.add(n)});const s={collectionId:r,parent:kt(i)};return yE(e).put(s)}return b.resolve()}getCollectionParents(e,n){const r=[],i=IDBKeyRange.bound([n,""],[GC(n),""],!1,!0);return yE(e).J(i).next(s=>{for(const o of s){if(o.collectionId!==n)break;r.push(On(o.parent))}return r})}addFieldIndex(e,n){const r=_a(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(l=>[l.fieldPath.canonicalString(),l.kind])}}(n);delete i.indexId;const s=r.add(i);if(n.indexState){const o=Ss(e);return s.next(a=>{o.put(uE(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){const r=_a(e),i=Ss(e),s=ws(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=_a(e),r=ws(e),i=Ss(e);return n.Z().next(()=>r.Z()).next(()=>i.Z())}createTargetIndexes(e,n){return b.forEach(this.Mn(n),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){const s=new mE(r).Dn();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,n){const r=ws(e);let i=!0;const s=new Map;return b.forEach(this.Mn(n),o=>this.xn(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=fe();const a=[];return b.forEach(s,(l,u)=>{$(_E,`Using index ${function(S){return`id=${S.indexId}|cg=${S.collectionGroup}|f=${S.fields.map(V=>`${V.fieldPath}:${V.kind}`).join(",")}`}(l)} to execute ${ts(n)}`);const f=function(S,V){const U=Ip(V);if(U===void 0)return null;for(const F of id(S,U.fieldPath))switch(F.op){case"array-contains-any":return F.value.arrayValue.values||[];case"array-contains":return[F.value]}return null}(u,l),p=function(S,V){const U=new Map;for(const F of Pi(V))for(const C of id(S,F.fieldPath))switch(C.op){case"==":case"in":U.set(F.fieldPath.canonicalString(),C.value);break;case"not-in":case"!=":return U.set(F.fieldPath.canonicalString(),C.value),Array.from(U.values())}return null}(u,l),m=function(S,V){const U=[];let F=!0;for(const C of Pi(V)){const E=C.kind===0?QT(S,C.fieldPath,S.startAt):YT(S,C.fieldPath,S.startAt);U.push(E.value),F&&(F=E.inclusive)}return new wo(U,F)}(u,l),v=function(S,V){const U=[];let F=!0;for(const C of Pi(V)){const E=C.kind===0?YT(S,C.fieldPath,S.endAt):QT(S,C.fieldPath,S.endAt);U.push(E.value),F&&(F=E.inclusive)}return new wo(U,F)}(u,l),I=this.On(l,u,m),x=this.On(l,u,v),M=this.Nn(l,u,p),A=this.Bn(l.indexId,f,I,m.inclusive,x,v.inclusive,M);return b.forEach(A,T=>r.Y(T,n.limit).next(S=>{S.forEach(V=>{const U=J.fromSegments(V.documentKey);o.has(U)||(o=o.add(U),a.push(U))})}))}).next(()=>a)}return b.resolve(null)})}Mn(e){let n=this.Fn.get(e);return n||(e.filters.length===0?n=[e]:n=jU(Ne.create(e.filters,"and")).map(r=>Np(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.Fn.set(e,n),n)}Bn(e,n,r,i,s,o,a){const l=(n!=null?n.length:1)*Math.max(r.length,s.length),u=l/(n!=null?n.length:1),f=[];for(let p=0;p<l;++p){const m=n?this.Ln(n[p/u]):bu,v=this.kn(e,m,r[p%u],i),I=this.qn(e,m,s[p%u],o),x=a.map(M=>this.kn(e,m,M,!0));f.push(...this.createRange(v,I,x))}return f}kn(e,n,r,i){const s=new Mi(e,J.empty(),n,r);return i?s:s.An()}qn(e,n,r,i){const s=new Mi(e,J.empty(),n,r);return i?s.An():s}xn(e,n){const r=new mE(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(const a of s)r.yn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2;const i=this.Mn(n);return b.forEach(i,s=>this.xn(e,s).next(o=>{o?r!==0&&o.fields.length<function(l){let u=new xe(ze.comparator),f=!1;for(const p of l.filters)for(const m of p.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?f=!0:u=u.add(m.field));for(const p of l.orderBy)p.field.isKeyField()||(u=u.add(p.field));return u.size+(f?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&i.length>1&&r===2?1:r)}Qn(e,n){const r=new ga;for(const i of Pi(e)){const s=n.data.field(i.fieldPath);if(s==null)return null;const o=r.Pn(i.kind);Di.Kt.Dt(s,o)}return r.un()}Ln(e){const n=new ga;return Di.Kt.Dt(e,n.Pn(0)),n.un()}$n(e,n){const r=new ga;return Di.Kt.Dt(mg(this.databaseId,n),r.Pn(function(s){const o=Pi(s);return o.length===0?0:o[o.length-1].kind}(e))),r.un()}Nn(e,n,r){if(r===null)return[];let i=[];i.push(new ga);let s=0;for(const o of Pi(e)){const a=r[s++];for(const l of i)if(this.Un(n,o.fieldPath)&&Il(a))i=this.Kn(i,o,a);else{const u=l.Pn(o.kind);Di.Kt.Dt(a,u)}}return this.Wn(i)}On(e,n,r){return this.Nn(e,n,r.position)}Wn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].un();return n}Kn(e,n,r){const i=[...e],s=[];for(const o of r.arrayValue.values||[])for(const a of i){const l=new ga;l.seed(a.un()),Di.Kt.Dt(o,l.Pn(n.kind)),s.push(l)}return s}Un(e,n){return!!e.filters.find(r=>r instanceof _e&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=_a(e),i=Ss(e);return(n?r.J(Sp,IDBKeyRange.bound(n,n)):r.J()).next(s=>{const o=[];return b.forEach(s,a=>i.get([a.indexId,this.uid]).next(l=>{o.push(function(f,p){const m=p?new ml(p.sequenceNumber,new tn(rs(p.readTime),new J(On(p.documentKey)),p.largestBatchId)):ml.empty(),v=f.fields.map(([I,x])=>new sc(ze.fromServerFormat(I),x));return new jc(f.indexId,f.collectionGroup,v,m)}(a,l))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:le(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const i=_a(e),s=Ss(e);return this.Gn(e).next(o=>i.J(Sp,IDBKeyRange.bound(n,n)).next(a=>b.forEach(a,l=>s.put(uE(l.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){const r=new Map;return b.forEach(n,(i,s)=>{const o=r.get(i.collectionGroup);return(o?b.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),b.forEach(a,l=>this.zn(e,i,l).next(u=>{const f=this.jn(s,l);return u.isEqual(f)?b.resolve():this.Jn(e,s,l,u,f)}))))})}Hn(e,n,r,i){return ws(e).put(i.Rn(this.uid,this.$n(r,n.key),n.key))}Yn(e,n,r,i){return ws(e).delete(i.Vn(this.uid,this.$n(r,n.key),n.key))}zn(e,n,r){const i=ws(e);let s=new xe(Cr);return i.ee({index:XC,range:IDBKeyRange.only([r.indexId,this.uid,fc(this.$n(r,n))])},(o,a)=>{s=s.add(new Mi(r.indexId,n,pE(a.arrayValue),pE(a.directionalValue)))}).next(()=>s)}jn(e,n){let r=new xe(Cr);const i=this.Qn(n,e);if(i==null)return r;const s=Ip(n);if(s!=null){const o=e.data.field(s.fieldPath);if(Il(o))for(const a of o.arrayValue.values||[])r=r.add(new Mi(n.indexId,e.key,this.Ln(a),i))}else r=r.add(new Mi(n.indexId,e.key,bu,i));return r}Jn(e,n,r,i,s){$(_E,"Updating index entries for document '%s'",n.key);const o=[];return function(l,u,f,p,m){const v=l.getIterator(),I=u.getIterator();let x=Es(v),M=Es(I);for(;x||M;){let A=!1,T=!1;if(x&&M){const S=f(x,M);S<0?T=!0:S>0&&(A=!0)}else x!=null?T=!0:A=!0;A?(p(M),M=Es(I)):T?(m(x),x=Es(v)):(x=Es(v),M=Es(I))}}(i,s,Cr,a=>{o.push(this.Hn(e,n,r,a))},a=>{o.push(this.Yn(e,n,r,a))}),b.waitFor(o)}Gn(e){let n=1;return Ss(e).ee({index:jC,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>Cr(o,a)).filter((o,a,l)=>!a||Cr(o,l[a-1])!==0);const i=[];i.push(e);for(const o of r){const a=Cr(o,e),l=Cr(o,n);if(a===0)i[0]=e.An();else if(a>0&&l<0)i.push(o),i.push(o.An());else if(l>0)break}i.push(n);const s=[];for(let o=0;o<i.length;o+=2){if(this.Zn(i[o],i[o+1]))return[];const a=i[o].Vn(this.uid,bu,J.empty()),l=i[o+1].Vn(this.uid,bu,J.empty());s.push(IDBKeyRange.bound(a,l))}return s}Zn(e,n){return Cr(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(vE)}getMinOffset(e,n){return b.mapArray(this.Mn(n),r=>this.xn(e,r).next(i=>i||Z(44426))).next(vE)}}function yE(t){return dt(t,vl)}function ws(t){return dt(t,$a)}function _a(t){return dt(t,ug)}function Ss(t){return dt(t,qa)}function vE(t){te(t.length!==0,28825);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const i=t[r].indexState.offset;og(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new tn(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TE={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},eA=41943040;class Rt{static withCacheSize(e){return new Rt(e,Rt.DEFAULT_COLLECTION_PERCENTILE,Rt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tA(t,e,n){const r=t.store(En),i=t.store(_o),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const l=r.ee({range:o},(f,p,m)=>(a++,m.delete()));s.push(l.next(()=>{te(a===1,47070,{batchId:n.batchId})}));const u=[];for(const f of n.mutations){const p=JC(e,f.key.path,n.batchId);s.push(i.delete(p)),u.push(f.key)}return b.waitFor(s).next(()=>u)}function ud(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Z(14731);e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Rt.DEFAULT_COLLECTION_PERCENTILE=10,Rt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Rt.DEFAULT=new Rt(eA,Rt.DEFAULT_COLLECTION_PERCENTILE,Rt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Rt.DISABLED=new Rt(-1,0,0);class Zd{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Xn={}}static wt(e,n,r,i){te(e.uid!=="",64387);const s=e.isAuthenticated()?e.uid:"";return new Zd(s,n,r,i)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ar(e).ee({index:Ui,range:r},(i,s,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,i){const s=ks(e),o=Ar(e);return o.add({}).next(a=>{te(typeof a=="number",49019);const l=new vg(a,n,r,i),u=function(v,I,x){const M=x.baseMutations.map(T=>od(v.yt,T)),A=x.mutations.map(T=>od(v.yt,T));return{userId:I,batchId:x.batchId,localWriteTimeMs:x.localWriteTime.toMillis(),baseMutations:M,mutations:A}}(this.serializer,this.userId,l),f=[];let p=new xe((m,v)=>le(m.canonicalString(),v.canonicalString()));for(const m of i){const v=JC(this.userId,m.key.path,a);p=p.add(m.key.path.popLast()),f.push(o.put(u)),f.push(s.put(v,RF))}return p.forEach(m=>{f.push(this.indexManager.addToCollectionParentIndex(e,m))}),e.addOnCommittedListener(()=>{this.Xn[a]=l.keys()}),b.waitFor(f).next(()=>l)})}lookupMutationBatch(e,n){return Ar(e).get(n).next(r=>r?(te(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:n}),Ni(this.serializer,r)):null)}er(e,n){return this.Xn[n]?b.resolve(this.Xn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const i=r.keys();return this.Xn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return Ar(e).ee({index:Ui,range:i},(o,a,l)=>{a.userId===this.userId&&(te(a.batchId>=r,47524,{tr:r}),s=Ni(this.serializer,a)),l.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=qi;return Ar(e).ee({index:Ui,range:n,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,qi],[this.userId,Number.POSITIVE_INFINITY]);return Ar(e).J(Ui,n).next(r=>r.map(i=>Ni(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=oc(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return ks(e).ee({range:i},(o,a,l)=>{const[u,f,p]=o,m=On(f);if(u===this.userId&&n.path.isEqual(m))return Ar(e).get(p).next(v=>{if(!v)throw Z(61480,{nr:o,batchId:p});te(v.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:v.userId,batchId:p}),s.push(Ni(this.serializer,v))});l.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new xe(le);const i=[];return n.forEach(s=>{const o=oc(this.userId,s.path),a=IDBKeyRange.lowerBound(o),l=ks(e).ee({range:a},(u,f,p)=>{const[m,v,I]=u,x=On(v);m===this.userId&&s.path.isEqual(x)?r=r.add(I):p.done()});i.push(l)}),b.waitFor(i).next(()=>this.rr(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1,s=oc(this.userId,r),o=IDBKeyRange.lowerBound(s);let a=new xe(le);return ks(e).ee({range:o},(l,u,f)=>{const[p,m,v]=l,I=On(m);p===this.userId&&r.isPrefixOf(I)?I.length===i&&(a=a.add(v)):f.done()}).next(()=>this.rr(e,a))}rr(e,n){const r=[],i=[];return n.forEach(s=>{i.push(Ar(e).get(s).next(o=>{if(o===null)throw Z(35274,{batchId:s});te(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:s}),r.push(Ni(this.serializer,o))}))}),b.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return tA(e.le,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.ir(n.batchId)}),b.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return b.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return ks(e).ee({range:r},(s,o,a)=>{if(s[0]===this.userId){const l=On(s[1]);i.push(l)}else a.done()}).next(()=>{te(i.length===0,56720,{sr:i.map(s=>s.canonicalString())})})})}containsKey(e,n){return nA(e,this.userId,n)}_r(e){return rA(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:qi,lastStreamToken:""})}}function nA(t,e,n){const r=oc(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return ks(t).ee({range:s,X:!0},(a,l,u)=>{const[f,p,m]=a;f===e&&p===i&&(o=!0),u.done()}).next(()=>o)}function Ar(t){return dt(t,En)}function ks(t){return dt(t,_o)}function rA(t){return dt(t,_l)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class is{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new is(0)}static cr(){return new is(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e4{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.lr(e).next(n=>{const r=new is(n.highestTargetId);return n.highestTargetId=r.next(),this.hr(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.lr(e).next(n=>re.fromTimestamp(new Se(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.lr(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.lr(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.hr(e,i)))}addTargetData(e,n){return this.Pr(e,n).next(()=>this.lr(e).next(r=>(r.targetCount+=1,this.Tr(n,r),this.hr(e,r))))}updateTargetData(e,n){return this.Pr(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>Cs(e).delete(n.targetId)).next(()=>this.lr(e)).next(r=>(te(r.targetCount>0,8065),r.targetCount-=1,this.hr(e,r)))}removeTargets(e,n,r){let i=0;const s=[];return Cs(e).ee((o,a)=>{const l=Ra(a);l.sequenceNumber<=n&&r.get(l.targetId)===null&&(i++,s.push(this.removeTargetData(e,l)))}).next(()=>b.waitFor(s)).next(()=>i)}forEachTarget(e,n){return Cs(e).ee((r,i)=>{const s=Ra(i);n(s)})}lr(e){return EE(e).get(ed).next(n=>(te(n!==null,2888),n))}hr(e,n){return EE(e).put(ed,n)}Pr(e,n){return Cs(e).put(Y0(this.serializer,n))}Tr(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next(n=>n.targetCount)}getTargetData(e,n){const r=ts(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return Cs(e).ee({range:i,index:YC},(o,a,l)=>{const u=Ra(a);Ul(n,u.target)&&(s=u,l.done())}).next(()=>s)}addMatchingKeys(e,n,r){const i=[],s=br(e);return n.forEach(o=>{const a=kt(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),b.waitFor(i)}removeMatchingKeys(e,n,r){const i=br(e);return b.forEach(n,s=>{const o=kt(s.path);return b.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){const r=br(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),i=br(e);let s=fe();return i.ee({range:r,X:!0},(o,a,l)=>{const u=On(o[1]),f=new J(u);s=s.add(f)}).next(()=>s)}containsKey(e,n){const r=kt(n.path),i=IDBKeyRange.bound([r],[GC(r)],!1,!0);let s=0;return br(e).ee({index:lg,X:!0,range:i},([o,a],l,u)=>{o!==0&&(s++,u.done())}).next(()=>s>0)}At(e,n){return Cs(e).get(n).next(r=>r?Ra(r):null)}}function Cs(t){return dt(t,yo)}function EE(t){return dt(t,$i)}function br(t){return dt(t,vo)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IE="LruGarbageCollector",t4=1048576;function wE([t,e],[n,r]){const i=le(t,n);return i===0?le(e,r):i}class n4{constructor(e){this.Ir=e,this.buffer=new xe(wE),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();wE(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class iA{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){$(IE,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){hi(n)?$(IE,"Ignoring IndexedDB error during garbage collection: ",n):await us(n)}await this.Vr(3e5)})}}class r4{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return b.resolve(cn.ce);const r=new n4(n);return this.mr.forEachTarget(e,i=>r.Ar(i.sequenceNumber)).next(()=>this.mr.pr(e,i=>r.Ar(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.mr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?($("LruGarbageCollector","Garbage collection skipped; disabled"),b.resolve(TE)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?($("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),TE):this.yr(e,n))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let r,i,s,o,a,l,u;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(p=>(p>this.params.maximumSequenceNumbersToCollect?($("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),i=this.params.maximumSequenceNumbersToCollect):i=p,o=Date.now(),this.nthSequenceNumber(e,i))).next(p=>(r=p,a=Date.now(),this.removeTargets(e,r,n))).next(p=>(s=p,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(p=>(u=Date.now(),As()<=ge.DEBUG&&$("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-f}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(l-a)+`ms
	Removed ${p} documents in `+(u-l)+`ms
Total Duration: ${u-f}ms`),b.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:p})))}}function sA(t,e){return new r4(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i4{constructor(e,n){this.db=e,this.garbageCollector=sA(this,n)}gr(e){const n=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}pr(e,n){return this.Sr(e,(r,i)=>n(i))}addReference(e,n,r){return Lu(e,r)}removeReference(e,n,r){return Lu(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return Lu(e,n)}br(e,n){return function(i,s){let o=!1;return rA(i).te(a=>nA(i,a,s).next(l=>(l&&(o=!0),b.resolve(!l)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Sr(e,(o,a)=>{if(a<=n){const l=this.br(e,o).next(u=>{if(!u)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,re.min()),br(e).delete(function(p){return[0,kt(p.path)]}(o))))});i.push(l)}}).next(()=>b.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return Lu(e,n)}Sr(e,n){const r=br(e);let i,s=cn.ce;return r.ee({index:lg},([o,a],{path:l,sequenceNumber:u})=>{o===0?(s!==cn.ce&&n(new J(On(i)),s),s=u,i=l):s=cn.ce}).next(()=>{s!==cn.ce&&n(new J(On(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Lu(t,e){return br(t).put(function(r,i){return{targetId:0,path:kt(r.path),sequenceNumber:i}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oA{constructor(){this.changes=new gr(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,je.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?b.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s4{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return Si(e).put(r)}removeEntry(e,n,r){return Si(e).delete(function(s,o){const a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],ad(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.Dr(e,r)))}getEntry(e,n){let r=je.newInvalidDocument(n);return Si(e).ee({index:ac,range:IDBKeyRange.only(ya(n))},(i,s)=>{r=this.Cr(n,s)}).next(()=>r)}vr(e,n){let r={size:0,document:je.newInvalidDocument(n)};return Si(e).ee({index:ac,range:IDBKeyRange.only(ya(n))},(i,s)=>{r={document:this.Cr(n,s),size:ud(s)}}).next(()=>r)}getEntries(e,n){let r=Yt();return this.Fr(e,n,(i,s)=>{const o=this.Cr(i,s);r=r.insert(i,o)}).next(()=>r)}Mr(e,n){let r=Yt(),i=new He(J.comparator);return this.Fr(e,n,(s,o)=>{const a=this.Cr(s,o);r=r.insert(s,a),i=i.insert(s,ud(o))}).next(()=>({documents:r,Or:i}))}Fr(e,n,r){if(n.isEmpty())return b.resolve();let i=new xe(AE);n.forEach(l=>i=i.add(l));const s=IDBKeyRange.bound(ya(i.first()),ya(i.last())),o=i.getIterator();let a=o.getNext();return Si(e).ee({index:ac,range:s},(l,u,f)=>{const p=J.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;a&&AE(a,p)<0;)r(a,null),a=o.getNext();a&&a.isEqual(p)&&(r(a,u),a=o.hasNext()?o.getNext():null),a?f.j(ya(a)):f.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,s){const o=n.path,a=[o.popLast().toArray(),o.lastSegment(),ad(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Si(e).J(IDBKeyRange.bound(a,l,!0)).next(u=>{s==null||s.incrementDocumentReadCount(u.length);let f=Yt();for(const p of u){const m=this.Cr(J.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);m.isFoundDocument()&&(Ol(n,m)||i.has(m.key))&&(f=f.insert(m.key,m))}return f})}getAllFromCollectionGroup(e,n,r,i){let s=Yt();const o=CE(n,r),a=CE(n,tn.max());return Si(e).ee({index:QC,range:IDBKeyRange.bound(o,a,!0)},(l,u,f)=>{const p=this.Cr(J.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);s=s.insert(p.key,p),s.size===i&&f.done()}).next(()=>s)}newChangeBuffer(e){return new o4(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return SE(e).get(wp).next(n=>(te(!!n,20021),n))}Dr(e,n){return SE(e).put(wp,n)}Cr(e,n){if(n){const r=zU(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(re.min())))return r}return je.newInvalidDocument(e)}}function aA(t){return new s4(t)}class o4 extends oA{constructor(e,n){super(),this.Nr=e,this.trackRemovals=n,this.Br=new gr(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const n=[];let r=0,i=new xe((s,o)=>le(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const a=this.Br.get(s);if(n.push(this.Nr.removeEntry(e,s,a.readTime)),o.isValidDocument()){const l=aE(this.Nr.serializer,o);i=i.add(s.path.popLast());const u=ud(l);r+=u-a.size,n.push(this.Nr.addEntry(e,s,l))}else if(r-=a.size,this.trackRemovals){const l=aE(this.Nr.serializer,o.convertToNoDocument(re.min()));n.push(this.Nr.addEntry(e,s,l))}}),i.forEach(s=>{n.push(this.Nr.indexManager.addToCollectionParentIndex(e,s))}),n.push(this.Nr.updateMetadata(e,r)),b.waitFor(n)}getFromCache(e,n){return this.Nr.vr(e,n).next(r=>(this.Br.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.Nr.Mr(e,n).next(({documents:r,Or:i})=>(i.forEach((s,o)=>{this.Br.set(s,{size:o,readTime:r.get(s).readTime})}),r))}}function SE(t){return dt(t,yl)}function Si(t){return dt(t,Zc)}function ya(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function CE(t,e){const n=e.documentKey.path.toArray();return[t,ad(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function AE(t,e){const n=t.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=le(n[s],r[s]),i)return i;return i=le(n.length,r.length),i||(i=le(n[n.length-2],r[r.length-2]),i||le(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a4{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lA{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&Wa(r.mutation,i,dn.empty(),Se.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,fe()).next(()=>r))}getLocalViewOfDocuments(e,n,r=fe()){const i=Bn();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=Ca();return s.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=Bn();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,fe()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=Yt();const o=Ka(),a=function(){return Ka()}();return n.forEach((l,u)=>{const f=r.get(u.key);i.has(u.key)&&(f===void 0||f.mutation instanceof fi)?s=s.insert(u.key,u):f!==void 0?(o.set(u.key,f.mutation.getFieldMask()),Wa(f.mutation,u,f.mutation.getFieldMask(),Se.now())):o.set(u.key,dn.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((u,f)=>o.set(u,f)),n.forEach((u,f)=>a.set(u,new a4(f,o.get(u)??null))),a))}recalculateAndSaveOverlays(e,n){const r=Ka();let i=new He((o,a)=>o-a),s=fe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const u=n.get(l);if(u===null)return;let f=r.get(l)||dn.empty();f=a.applyToLocalView(u,f),r.set(l,f);const p=(i.get(a.batchId)||fe()).add(l);i=i.insert(a.batchId,p)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),u=l.key,f=l.value,p=C0();f.forEach(m=>{if(!s.has(m)){const v=D0(n.get(m),r.get(m));v!==null&&p.set(m,v),s=s.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,p))}return b.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return J.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):cU(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):b.resolve(Bn());let a=pl,l=s;return o.next(u=>b.forEach(u,(f,p)=>(a<p.largestBatchId&&(a=p.largestBatchId),s.get(f)?b.resolve():this.remoteDocumentCache.getEntry(e,f).next(m=>{l=l.insert(f,m)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,l,u,fe())).next(f=>({batchId:a,changes:S0(f)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new J(n)).next(r=>{let i=Ca();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let o=Ca();return this.indexManager.getCollectionParents(e,s).next(a=>b.forEach(a,l=>{const u=function(p,m){return new Kd(m,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(n,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,r,i).next(f=>{f.forEach((p,m)=>{o=o.insert(p,m)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((l,u)=>{const f=u.getKey();o.get(f)===null&&(o=o.insert(f,je.newInvalidDocument(f)))});let a=Ca();return o.forEach((l,u)=>{const f=s.get(l);f!==void 0&&Wa(f.mutation,u,dn.empty(),Se.now()),Ol(n,u)&&(a=a.insert(l,u))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l4{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return b.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:bt(i.createTime)}}(n)),b.resolve()}getNamedQuery(e,n){return b.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,function(i){return{name:i.name,query:j0(i.bundledQuery),readTime:bt(i.readTime)}}(n)),b.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u4{constructor(){this.overlays=new He(J.comparator),this.qr=new Map}getOverlay(e,n){return b.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Bn();return b.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.St(e,n,s)}),b.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.qr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.qr.delete(r)),b.resolve()}getOverlaysForCollection(e,n,r){const i=Bn(),s=n.length+1,o=new J(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,u=l.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return b.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new He((u,f)=>u-f);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let f=s.get(u.largestBatchId);f===null&&(f=Bn(),s=s.insert(u.largestBatchId,f)),f.set(u.getKey(),u)}}const a=Bn(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((u,f)=>a.set(u,f)),!(a.size()>=i)););return b.resolve(a)}St(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Eg(n,r));let s=this.qr.get(n);s===void 0&&(s=fe(),this.qr.set(n,s)),this.qr.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c4{constructor(){this.sessionToken=Ze.EMPTY_BYTE_STRING}getSessionToken(e){return b.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,b.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ag{constructor(){this.Qr=new xe(pt.$r),this.Ur=new xe(pt.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const r=new pt(e,n);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Gr(new pt(e,n))}zr(e,n){e.forEach(r=>this.removeReference(r,n))}jr(e){const n=new J(new ke([])),r=new pt(n,e),i=new pt(n,e+1),s=[];return this.Ur.forEachInRange([r,i],o=>{this.Gr(o),s.push(o.key)}),s}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new J(new ke([])),r=new pt(n,e),i=new pt(n,e+1);let s=fe();return this.Ur.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const n=new pt(e,0),r=this.Qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class pt{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return J.comparator(e.key,n.key)||le(e.Yr,n.Yr)}static Kr(e,n){return le(e.Yr,n.Yr)||J.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d4{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new xe(pt.$r)}checkEmpty(e){return b.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new vg(s,n,r,i);this.mutationQueue.push(o);for(const a of i)this.Zr=this.Zr.add(new pt(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return b.resolve(o)}lookupMutationBatch(e,n){return b.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.ei(r),s=i<0?0:i;return b.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return b.resolve(this.mutationQueue.length===0?qi:this.tr-1)}getAllMutationBatches(e){return b.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new pt(n,0),i=new pt(n,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([r,i],o=>{const a=this.Xr(o.Yr);s.push(a)}),b.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new xe(le);return n.forEach(i=>{const s=new pt(i,0),o=new pt(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,o],a=>{r=r.add(a.Yr)})}),b.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;J.isDocumentKey(s)||(s=s.child(""));const o=new pt(new J(s),0);let a=new xe(le);return this.Zr.forEachWhile(l=>{const u=l.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(a=a.add(l.Yr)),!0)},o),b.resolve(this.ti(a))}ti(e){const n=[];return e.forEach(r=>{const i=this.Xr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){te(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return b.forEach(n.mutations,i=>{const s=new pt(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,n){const r=new pt(n,0),i=this.Zr.firstAfterOrEqual(r);return b.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,b.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h4{constructor(e){this.ri=e,this.docs=function(){return new He(J.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.ri(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return b.resolve(r?r.document.mutableCopy():je.newInvalidDocument(n))}getEntries(e,n){let r=Yt();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():je.newInvalidDocument(i))}),b.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=Yt();const o=n.path,a=new J(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:u,value:{document:f}}=l.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||og(zC(f),r)<=0||(i.has(f.key)||Ol(n,f))&&(s=s.insert(f.key,f.mutableCopy()))}return b.resolve(s)}getAllFromCollectionGroup(e,n,r,i){Z(9500)}ii(e,n){return b.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new f4(this)}getSize(e){return b.resolve(this.size)}}class f4 extends oA{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)}),b.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p4{constructor(e){this.persistence=e,this.si=new gr(n=>ts(n),Ul),this.lastRemoteSnapshotVersion=re.min(),this.highestTargetId=0,this.oi=0,this._i=new Ag,this.targetCount=0,this.ai=is.ur()}forEachTarget(e,n){return this.si.forEach((r,i)=>n(i)),b.resolve()}getLastRemoteSnapshotVersion(e){return b.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return b.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),b.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.oi&&(this.oi=n),b.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new is(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,b.resolve()}updateTargetData(e,n){return this.Pr(n),b.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,b.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.si.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.si.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),b.waitFor(s).next(()=>i)}getTargetCount(e){return b.resolve(this.targetCount)}getTargetData(e,n){const r=this.si.get(n)||null;return b.resolve(r)}addMatchingKeys(e,n,r){return this._i.Wr(n,r),b.resolve()}removeMatchingKeys(e,n,r){this._i.zr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),b.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),b.resolve()}getMatchingKeysForTargetId(e,n){const r=this._i.Hr(n);return b.resolve(r)}containsKey(e,n){return b.resolve(this._i.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rg{constructor(e,n){this.ui={},this.overlays={},this.ci=new cn(0),this.li=!1,this.li=!0,this.hi=new c4,this.referenceDelegate=e(this),this.Pi=new p4(this),this.indexManager=new XU,this.remoteDocumentCache=function(i){return new h4(i)}(r=>this.referenceDelegate.Ti(r)),this.serializer=new Q0(n),this.Ii=new l4(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new u4,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ui[e.toKey()];return r||(r=new d4(n,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,r){$("MemoryPersistence","Starting transaction:",e);const i=new m4(this.ci.next());return this.referenceDelegate.Ei(),r(i).next(s=>this.referenceDelegate.di(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ai(e,n){return b.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,n)))}}class m4 extends KC{constructor(e){super(),this.currentSequenceNumber=e}}class eh{constructor(e){this.persistence=e,this.Ri=new Ag,this.Vi=null}static mi(e){return new eh(e)}get fi(){if(this.Vi)return this.Vi;throw Z(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.fi.delete(r.toString()),b.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.fi.add(r.toString()),b.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),b.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach(i=>this.fi.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.fi.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return b.forEach(this.fi,r=>{const i=J.fromPath(r);return this.gi(e,i).next(s=>{s||n.removeEntry(i,re.min())})}).next(()=>(this.Vi=null,n.apply(e)))}updateLimboDocument(e,n){return this.gi(e,n).next(r=>{r?this.fi.delete(n.toString()):this.fi.add(n.toString())})}Ti(e){return 0}gi(e,n){return b.or([()=>b.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class cd{constructor(e,n){this.persistence=e,this.pi=new gr(r=>kt(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=sA(this,n)}static mi(e,n){return new cd(e,n)}Ei(){}di(e){return b.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}pr(e,n){return b.forEach(this.pi,(r,i)=>this.br(e,r,i).next(s=>s?b.resolve():n(i)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ii(e,o=>this.br(e,o,n).next(a=>{a||(r++,s.removeEntry(o,re.min()))})).next(()=>s.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),b.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),b.resolve()}removeReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),b.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),b.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=uc(e.data.value)),n}br(e,n,r){return b.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const i=this.pi.get(n);return b.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g4{constructor(e){this.serializer=e}k(e,n,r,i){const s=new Od("createOrUpgrade",n);r<1&&i>=1&&(function(l){l.createObjectStore(Fl)}(e),function(l){l.createObjectStore(_l,{keyPath:AF}),l.createObjectStore(En,{keyPath:FT,autoIncrement:!0}).createIndex(Ui,UT,{unique:!0}),l.createObjectStore(_o)}(e),RE(e),function(l){l.createObjectStore(xi)}(e));let o=b.resolve();return r<3&&i>=3&&(r!==0&&(function(l){l.deleteObjectStore(vo),l.deleteObjectStore(yo),l.deleteObjectStore($i)}(e),RE(e)),o=o.next(()=>function(l){const u=l.store($i),f={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:re.min().toTimestamp(),targetCount:0};return u.put(ed,f)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(l,u){return u.store(En).J().next(p=>{l.deleteObjectStore(En),l.createObjectStore(En,{keyPath:FT,autoIncrement:!0}).createIndex(Ui,UT,{unique:!0});const m=u.store(En),v=p.map(I=>m.put(I));return b.waitFor(v)})}(e,s))),o=o.next(()=>{(function(l){l.createObjectStore(To,{keyPath:bF})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.yi(s))),r<6&&i>=6&&(o=o.next(()=>(function(l){l.createObjectStore(yl)}(e),this.wi(s)))),r<7&&i>=7&&(o=o.next(()=>this.Si(s))),r<8&&i>=8&&(o=o.next(()=>this.bi(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.Di(s))),r<11&&i>=11&&(o=o.next(()=>{(function(l){l.createObjectStore(Gd,{keyPath:LF})})(e),function(l){l.createObjectStore(qd,{keyPath:FF})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(l){const u=l.createObjectStore($d,{keyPath:zF});u.createIndex(Cp,HF,{unique:!1}),u.createIndex(ZC,KF,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(l){const u=l.createObjectStore(Zc,{keyPath:PF});u.createIndex(ac,xF),u.createIndex(QC,kF)}(e)).next(()=>this.Ci(e,s)).next(()=>e.deleteObjectStore(xi))),r<14&&i>=14&&(o=o.next(()=>this.Fi(e,s))),r<15&&i>=15&&(o=o.next(()=>function(l){l.createObjectStore(ug,{keyPath:UF,autoIncrement:!0}).createIndex(Sp,OF,{unique:!1}),l.createObjectStore(qa,{keyPath:BF}).createIndex(jC,GF,{unique:!1}),l.createObjectStore($a,{keyPath:qF}).createIndex(XC,$F,{unique:!1})}(e))),r<16&&i>=16&&(o=o.next(()=>{n.objectStore(qa).clear()}).next(()=>{n.objectStore($a).clear()})),r<17&&i>=17&&(o=o.next(()=>{(function(l){l.createObjectStore(cg,{keyPath:WF})})(e)})),r<18&&i>=18&&KS()&&(o=o.next(()=>{n.objectStore(qa).clear()}).next(()=>{n.objectStore($a).clear()})),o}wi(e){let n=0;return e.store(xi).ee((r,i)=>{n+=ud(i)}).next(()=>{const r={byteSize:n};return e.store(yl).put(wp,r)})}yi(e){const n=e.store(_l),r=e.store(En);return n.J().next(i=>b.forEach(i,s=>{const o=IDBKeyRange.bound([s.userId,qi],[s.userId,s.lastAcknowledgedBatchId]);return r.J(Ui,o).next(a=>b.forEach(a,l=>{te(l.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:l.batchId});const u=Ni(this.serializer,l);return tA(e,s.userId,u).next(()=>{})}))}))}Si(e){const n=e.store(vo),r=e.store(xi);return e.store($i).get(ed).next(i=>{const s=[];return r.ee((o,a)=>{const l=new ke(o),u=function(p){return[0,kt(p)]}(l);s.push(n.get(u).next(f=>f?b.resolve():(p=>n.put({targetId:0,path:kt(p),sequenceNumber:i.highestListenSequenceNumber}))(l)))}).next(()=>b.waitFor(s))})}bi(e,n){e.createObjectStore(vl,{keyPath:VF});const r=n.store(vl),i=new Cg,s=o=>{if(i.add(o)){const a=o.lastSegment(),l=o.popLast();return r.put({collectionId:a,parent:kt(l)})}};return n.store(xi).ee({X:!0},(o,a)=>{const l=new ke(o);return s(l.popLast())}).next(()=>n.store(_o).ee({X:!0},([o,a,l],u)=>{const f=On(a);return s(f.popLast())}))}Di(e){const n=e.store(yo);return n.ee((r,i)=>{const s=Ra(i),o=Y0(this.serializer,s);return n.put(o)})}Ci(e,n){const r=n.store(xi),i=[];return r.ee((s,o)=>{const a=n.store(Zc),l=function(p){return p.document?new J(ke.fromString(p.document.name).popFirst(5)):p.noDocument?J.fromSegments(p.noDocument.path):p.unknownDocument?J.fromSegments(p.unknownDocument.path):Z(36783)}(o).path.toArray(),u={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(u))}).next(()=>b.waitFor(i))}Fi(e,n){const r=n.store(En),i=aA(this.serializer),s=new Rg(eh.mi,this.serializer.yt);return r.J().next(o=>{const a=new Map;return o.forEach(l=>{let u=a.get(l.userId)??fe();Ni(this.serializer,l).keys().forEach(f=>u=u.add(f)),a.set(l.userId,u)}),b.forEach(a,(l,u)=>{const f=new Tt(u),p=Xd.wt(this.serializer,f),m=s.getIndexManager(f),v=Zd.wt(f,this.serializer,m,s.referenceDelegate);return new lA(i,v,p,m).recalculateAndSaveOverlaysForDocumentKeys(new Ap(n,cn.ce),l).next()})})}}function RE(t){t.createObjectStore(vo,{keyPath:DF}).createIndex(lg,MF,{unique:!0}),t.createObjectStore(yo,{keyPath:"targetId"}).createIndex(YC,NF,{unique:!0}),t.createObjectStore($i)}const Rr="IndexedDbPersistence",sf=18e5,of=5e3,af="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",_4="main";class Pg{constructor(e,n,r,i,s,o,a,l,u,f,p=18){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Mi=s,this.window=o,this.document=a,this.xi=u,this.Oi=f,this.Ni=p,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=m=>Promise.resolve(),!Pg.v())throw new Q(B.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new i4(this,i),this.$i=n+_4,this.serializer=new Q0(l),this.Ui=new jr(this.$i,this.Ni,new g4(this.serializer)),this.hi=new KU,this.Pi=new e4(this.referenceDelegate,this.serializer),this.remoteDocumentCache=aA(this.serializer),this.Ii=new HU,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,f===!1&&Mt(Rr,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Q(B.FAILED_PRECONDITION,af);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Pi.getHighestSequenceNumber(e))}).then(e=>{this.ci=new cn(e,this.xi)}).then(()=>{this.li=!0}).catch(e=>(this.Ui&&this.Ui.close(),Promise.reject(e)))}Ji(e){return this.Qi=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget(async()=>{this.started&&await this.Wi()}))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Fu(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Hi(e).next(n=>{n||(this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)))})}).next(()=>this.Yi(e)).next(n=>this.isPrimary&&!n?this.Zi(e).next(()=>!1):!!n&&this.Xi(e).next(()=>!0))).catch(e=>{if(hi(e))return $(Rr,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return $(Rr,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable(()=>this.Qi(e)),this.isPrimary=e})}Hi(e){return va(e).get(Ts).next(n=>b.resolve(this.es(n)))}ts(e){return Fu(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,sf)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=dt(n,To);return r.J().next(i=>{const s=this.ss(i,sf),o=i.filter(a=>s.indexOf(a)===-1);return b.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Ki)for(const n of e)this.Ki.removeItem(this._s(n.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Wi().then(()=>this.ns()).then(()=>this.ji()))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?b.resolve(!0):va(e).get(Ts).next(n=>{if(n!==null&&this.rs(n.leaseTimestampMs,of)&&!this.us(n.ownerId)){if(this.es(n)&&this.networkEnabled)return!0;if(!this.es(n)){if(!n.allowTabSynchronization)throw new Q(B.FAILED_PRECONDITION,af);return!1}}return!(!this.networkEnabled||!this.inForeground)||Fu(e).J().next(r=>this.ss(r,of).find(i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&$(Rr,`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[Fl,To],e=>{const n=new Ap(e,cn.ce);return this.Zi(n).next(()=>this.ts(n))}),this.Ui.close(),this.Ps()}ss(e,n){return e.filter(r=>this.rs(r.updateTimeMs,n)&&!this.us(r.clientId))}Ts(){return this.runTransaction("getActiveClients","readonly",e=>Fu(e).J().next(n=>this.ss(n,sf).map(r=>r.clientId)))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,n){return Zd.wt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new ZU(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return Xd.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,n,r){$(Rr,"Starting transaction:",e);const i=n==="readonly"?"readonly":"readwrite",s=function(l){return l===18?YF:l===17?r0:l===16?QF:l===15?dg:l===14?n0:l===13?t0:l===12?JF:l===11?e0:void Z(60245)}(this.Ni);let o;return this.Ui.runTransaction(e,i,s,a=>(o=new Ap(a,this.ci?this.ci.next():cn.ce),n==="readwrite-primary"?this.Hi(o).next(l=>!!l||this.Yi(o)).next(l=>{if(!l)throw Mt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)),new Q(B.FAILED_PRECONDITION,HC);return r(o)}).next(l=>this.Xi(o).next(()=>l)):this.Is(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Is(e){return va(e).get(Ts).next(n=>{if(n!==null&&this.rs(n.leaseTimestampMs,of)&&!this.us(n.ownerId)&&!this.es(n)&&!(this.Oi||this.allowTabSynchronization&&n.allowTabSynchronization))throw new Q(B.FAILED_PRECONDITION,af)})}Xi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return va(e).put(Ts,n)}static v(){return jr.v()}Zi(e){const n=va(e);return n.get(Ts).next(r=>this.es(r)?($(Rr,"Releasing primary lease."),n.delete(Ts)):b.resolve())}rs(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(Mt(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi()))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){var e;typeof((e=this.window)==null?void 0:e.addEventListener)=="function"&&(this.Bi=()=>{this.cs();const n=/(?:Version|Mobile)\/1[456]/;HS()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){var n;try{const r=((n=this.Ki)==null?void 0:n.getItem(this._s(e)))!==null;return $(Rr,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Mt(Rr,"Failed to get zombied client id.",r),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){Mt("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function va(t){return dt(t,Fl)}function Fu(t){return dt(t,To)}function y4(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xg{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.Es=r,this.ds=i}static As(e,n){let r=fe(),i=fe();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new xg(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v4{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uA{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return HS()?8:WC(ct())>0?6:4}()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.ys(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ws(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new v4;return this.Ss(e,n,o).next(a=>{if(s.result=a,this.Vs)return this.bs(e,n,o,a.size)})}).next(()=>s.result)}bs(e,n,r,i){return r.documentReadCount<this.fs?(As()<=ge.DEBUG&&$("QueryEngine","SDK will not create cache indexes for query:",Rs(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),b.resolve()):(As()<=ge.DEBUG&&$("QueryEngine","Query:",Rs(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?(As()<=ge.DEBUG&&$("QueryEngine","The SDK decides to create cache indexes for query:",Rs(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,pn(n))):b.resolve())}ys(e,n){if(jT(n))return b.resolve(null);let r=pn(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=Dp(n,null,"F"),r=pn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=fe(...s);return this.ps.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const u=this.Ds(n,a);return this.Cs(n,u,o,l.readTime)?this.ys(e,Dp(n,null,"F")):this.vs(e,u,n,l)}))})))}ws(e,n,r,i){return jT(n)||i.isEqual(re.min())?b.resolve(null):this.ps.getDocuments(e,r).next(s=>{const o=this.Ds(n,s);return this.Cs(n,o,r,i)?b.resolve(null):(As()<=ge.DEBUG&&$("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Rs(n)),this.vs(e,o,n,vF(i,pl)).next(a=>a))})}Ds(e,n){let r=new xe(I0(e));return n.forEach((i,s)=>{Ol(e,s)&&(r=r.add(s))}),r}Cs(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ss(e,n,r){return As()<=ge.DEBUG&&$("QueryEngine","Using full collection scan to execute query:",Rs(n)),this.ps.getDocumentsMatchingQuery(e,n,tn.min(),r)}vs(e,n,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kg="LocalStore",T4=3e8;class E4{constructor(e,n,r,i){this.persistence=e,this.Fs=n,this.serializer=i,this.Ms=new He(le),this.xs=new gr(s=>ts(s),Ul),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new lA(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ms))}}function cA(t,e,n,r){return new E4(t,e,n,r)}async function dA(t,e){const n=ue(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.Bs(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],a=[];let l=fe();for(const u of i){o.push(u.batchId);for(const f of u.mutations)l=l.add(f.key)}for(const u of s){a.push(u.batchId);for(const f of u.mutations)l=l.add(f.key)}return n.localDocuments.getDocuments(r,l).next(u=>({Ls:u,removedBatchIds:o,addedBatchIds:a}))})})}function I4(t,e){const n=ue(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.Ns.newChangeBuffer({trackRemovals:!0});return function(a,l,u,f){const p=u.batch,m=p.keys();let v=b.resolve();return m.forEach(I=>{v=v.next(()=>f.getEntry(l,I)).next(x=>{const M=u.docVersions.get(I);te(M!==null,48541),x.version.compareTo(M)<0&&(p.applyToRemoteDocument(x,u),x.isValidDocument()&&(x.setReadTime(u.commitVersion),f.addEntry(x)))})}),v.next(()=>a.mutationQueue.removeMutationBatch(l,p))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=fe();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(l=l.add(a.batch.mutations[u].key));return l}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function hA(t){const e=ue(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Pi.getLastRemoteSnapshotVersion(n))}function w4(t,e){const n=ue(t),r=e.snapshotVersion;let i=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.Ns.newChangeBuffer({trackRemovals:!0});i=n.Ms;const a=[];e.targetChanges.forEach((f,p)=>{const m=i.get(p);if(!m)return;a.push(n.Pi.removeMatchingKeys(s,f.removedDocuments,p).next(()=>n.Pi.addMatchingKeys(s,f.addedDocuments,p)));let v=m.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(p)!==null?v=v.withResumeToken(Ze.EMPTY_BYTE_STRING,re.min()).withLastLimboFreeSnapshotVersion(re.min()):f.resumeToken.approximateByteSize()>0&&(v=v.withResumeToken(f.resumeToken,r)),i=i.insert(p,v),function(x,M,A){return x.resumeToken.approximateByteSize()===0||M.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=T4?!0:A.addedDocuments.size+A.modifiedDocuments.size+A.removedDocuments.size>0}(m,v,f)&&a.push(n.Pi.updateTargetData(s,v))});let l=Yt(),u=fe();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,f))}),a.push(S4(s,o,e.documentUpdates).next(f=>{l=f.ks,u=f.qs})),!r.isEqual(re.min())){const f=n.Pi.getLastRemoteSnapshotVersion(s).next(p=>n.Pi.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(f)}return b.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,l,u)).next(()=>l)}).then(s=>(n.Ms=i,s))}function S4(t,e,n){let r=fe(),i=fe();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=Yt();return n.forEach((a,l)=>{const u=s.get(a);l.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(a)),l.isNoDocument()&&l.version.isEqual(re.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):$(kg,"Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",l.version)}),{ks:o,qs:i}})}function C4(t,e){const n=ue(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=qi),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function A4(t,e){const n=ue(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Pi.getTargetData(r,e).next(s=>s?(i=s,b.resolve(i)):n.Pi.allocateTargetId(r).next(o=>(i=new nr(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Pi.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.Ms.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(r.targetId,r),n.xs.set(e,r.targetId)),r})}async function Bp(t,e,n){const r=ue(t),i=r.Ms.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!hi(o))throw o;$(kg,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(i.target)}function PE(t,e,n){const r=ue(t);let i=re.min(),s=fe();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,u,f){const p=ue(l),m=p.xs.get(f);return m!==void 0?b.resolve(p.Ms.get(m)):p.Pi.getTargetData(u,f)}(r,o,pn(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,a.targetId).next(l=>{s=l})}).next(()=>r.Fs.getDocumentsMatchingQuery(o,e,n?i:re.min(),n?s:fe())).next(a=>(R4(r,hU(e),a),{documents:a,Qs:s})))}function R4(t,e,n){let r=t.Os.get(e)||re.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.Os.set(e,r)}class xE{constructor(){this.activeTargetIds=yU()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class fA{constructor(){this.Mo=new xE,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,r){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new xE,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P4{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kE="ConnectivityMonitor";class NE{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){$(kE,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){$(kE,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Uu=null;function Gp(){return Uu===null?Uu=function(){return 268435456+Math.round(2147483648*Math.random())}():Uu++,"0x"+Uu.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lf="RestConnection",x4={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class k4{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===td?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,n,r,i,s){const o=Gp(),a=this.zo(e,n.toUriEncodedString());$(lf,`Sending RPC '${e}' ${o}:`,a,r);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,i,s);const{host:u}=new URL(a),f=Fo(u);return this.Jo(e,a,l,r,f).then(p=>($(lf,`Received RPC '${e}' ${o}: `,p),p),p=>{throw ni(lf,`RPC '${e}' ${o} failed with error: `,p,"url: ",a,"request:",r),p})}Ho(e,n,r,i,s,o){return this.Go(e,n,r,i,s)}jo(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Bo}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((i,s)=>e[s]=i),r&&r.headers.forEach((i,s)=>e[s]=i)}zo(e,n){const r=x4[e];return`${this.Uo}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N4{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const At="WebChannelConnection";class D4 extends k4{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,i,s){const o=Gp();return new Promise((a,l)=>{const u=new DC;u.setWithCredentials(!0),u.listenOnce(MC.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case ic.NO_ERROR:const p=u.getResponseJson();$(At,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(p)),a(p);break;case ic.TIMEOUT:$(At,`RPC '${e}' ${o} timed out`),l(new Q(B.DEADLINE_EXCEEDED,"Request time out"));break;case ic.HTTP_ERROR:const m=u.getStatus();if($(At,`RPC '${e}' ${o} failed with status:`,m,"response text:",u.getResponseText()),m>0){let v=u.getResponseJson();Array.isArray(v)&&(v=v[0]);const I=v==null?void 0:v.error;if(I&&I.status&&I.message){const x=function(A){const T=A.toLowerCase().replace(/_/g,"-");return Object.values(B).indexOf(T)>=0?T:B.UNKNOWN}(I.status);l(new Q(x,I.message))}else l(new Q(B.UNKNOWN,"Server responded with status "+u.getStatus()))}else l(new Q(B.UNAVAILABLE,"Connection failed."));break;default:Z(9055,{l_:e,streamId:o,h_:u.getLastErrorCode(),P_:u.getLastError()})}}finally{$(At,`RPC '${e}' ${o} completed.`)}});const f=JSON.stringify(i);$(At,`RPC '${e}' ${o} sending request:`,i),u.send(n,"POST",f,r,15)})}T_(e,n,r){const i=Gp(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=LC(),a=bC(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(l.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,n,r),l.encodeInitMessageHeaders=!0;const f=s.join("");$(At,`Creating RPC '${e}' stream ${i}: ${f}`,l);const p=o.createWebChannel(f,l);this.I_(p);let m=!1,v=!1;const I=new N4({Yo:M=>{v?$(At,`Not sending because RPC '${e}' stream ${i} is closed:`,M):(m||($(At,`Opening RPC '${e}' stream ${i} transport.`),p.open(),m=!0),$(At,`RPC '${e}' stream ${i} sending:`,M),p.send(M))},Zo:()=>p.close()}),x=(M,A,T)=>{M.listen(A,S=>{try{T(S)}catch(V){setTimeout(()=>{throw V},0)}})};return x(p,Sa.EventType.OPEN,()=>{v||($(At,`RPC '${e}' stream ${i} transport opened.`),I.o_())}),x(p,Sa.EventType.CLOSE,()=>{v||(v=!0,$(At,`RPC '${e}' stream ${i} transport closed`),I.a_(),this.E_(p))}),x(p,Sa.EventType.ERROR,M=>{v||(v=!0,ni(At,`RPC '${e}' stream ${i} transport errored. Name:`,M.name,"Message:",M.message),I.a_(new Q(B.UNAVAILABLE,"The operation could not be completed")))}),x(p,Sa.EventType.MESSAGE,M=>{var A;if(!v){const T=M.data[0];te(!!T,16349);const S=T,V=(S==null?void 0:S.error)||((A=S[0])==null?void 0:A.error);if(V){$(At,`RPC '${e}' stream ${i} received error:`,V);const U=V.status;let F=function(R){const P=nt[R];if(P!==void 0)return b0(P)}(U),C=V.message;F===void 0&&(F=B.INTERNAL,C="Unknown error status: "+U+" with message "+V.message),v=!0,I.a_(new Q(F,C)),p.close()}else $(At,`RPC '${e}' stream ${i} received:`,T),I.u_(T)}}),x(a,VC.STAT_EVENT,M=>{M.stat===Tp.PROXY?$(At,`RPC '${e}' stream ${i} detected buffering proxy`):M.stat===Tp.NOPROXY&&$(At,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{I.__()},0),I}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(n=>n===e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M4(){return typeof window<"u"?window:null}function pc(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function th(t){return new VU(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pA{constructor(e,n,r=1e3,i=1.5,s=6e4){this.Mi=e,this.timerId=n,this.d_=r,this.A_=i,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,n-r);i>0&&$("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DE="PersistentStream";class mA{constructor(e,n,r,i,s,o,a,l){this.Mi=e,this.S_=r,this.b_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new pA(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===B.RESOURCE_EXHAUSTED?(Mt(n.toString()),Mt("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===B.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.D_===n&&this.G_(r,i)},r=>{e(()=>{const i=new Q(B.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)})})}G_(e,n){const r=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(i=>{r(()=>this.z_(i))}),this.stream.onMessage(i=>{r(()=>++this.F_==1?this.J_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return $(DE,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget(()=>this.D_===e?n():($(DE,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class V4 extends mA{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=FU(this.serializer,e),r=function(s){if(!("targetChange"in s))return re.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?re.min():o.readTime?bt(o.readTime):re.min()}(e);return this.listener.H_(n,r)}Y_(e){const n={};n.database=bp(this.serializer),n.addTarget=function(s,o){let a;const l=o.target;if(a=rd(l)?{documents:$0(s,l)}:{query:z0(s,l).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=U0(s,o.resumeToken);const u=Mp(s,o.expectedCount);u!==null&&(a.expectedCount=u)}else if(o.snapshotVersion.compareTo(re.min())>0){a.readTime=Po(s,o.snapshotVersion.toTimestamp());const u=Mp(s,o.expectedCount);u!==null&&(a.expectedCount=u)}return a}(this.serializer,e);const r=OU(this.serializer,e);r&&(n.labels=r),this.q_(n)}Z_(e){const n={};n.database=bp(this.serializer),n.removeTarget=e,this.q_(n)}}class b4 extends mA{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return te(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,te(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){te(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=UU(e.writeResults,e.commitTime),r=bt(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=bp(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>od(this.serializer,r))};this.q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L4{}class F4 extends L4{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new Q(B.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Go(e,Vp(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===B.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Q(B.UNKNOWN,s.toString())})}Ho(e,n,r,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Ho(e,Vp(n,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===B.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Q(B.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class U4{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Mt(n),this.aa=!1):$("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ss="RemoteStore";class O4{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo(o=>{r.enqueueAndForget(async()=>{ds(this)&&($(ss,"Restarting streams for network reachability change."),await async function(l){const u=ue(l);u.Ea.add(4),await Gl(u),u.Ra.set("Unknown"),u.Ea.delete(4),await nh(u)}(this))})}),this.Ra=new U4(r,i)}}async function nh(t){if(ds(t))for(const e of t.da)await e(!0)}async function Gl(t){for(const e of t.da)await e(!1)}function gA(t,e){const n=ue(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),Vg(n)?Mg(n):qo(n).O_()&&Dg(n,e))}function Ng(t,e){const n=ue(t),r=qo(n);n.Ia.delete(e),r.O_()&&_A(n,e),n.Ia.size===0&&(r.O_()?r.L_():ds(n)&&n.Ra.set("Unknown"))}function Dg(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(re.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}qo(t).Y_(e)}function _A(t,e){t.Va.Ue(e),qo(t).Z_(e)}function Mg(t){t.Va=new kU({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),qo(t).start(),t.Ra.ua()}function Vg(t){return ds(t)&&!qo(t).x_()&&t.Ia.size>0}function ds(t){return ue(t).Ea.size===0}function yA(t){t.Va=void 0}async function B4(t){t.Ra.set("Online")}async function G4(t){t.Ia.forEach((e,n)=>{Dg(t,e)})}async function q4(t,e){yA(t),Vg(t)?(t.Ra.ha(e),Mg(t)):t.Ra.set("Unknown")}async function $4(t,e,n){if(t.Ra.set("Online"),e instanceof F0&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const a of s.targetIds)i.Ia.has(a)&&(await i.remoteSyncer.rejectListen(a,o),i.Ia.delete(a),i.Va.removeTarget(a))}(t,e)}catch(r){$(ss,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await dd(t,r)}else if(e instanceof hc?t.Va.Ze(e):e instanceof L0?t.Va.st(e):t.Va.tt(e),!n.isEqual(re.min()))try{const r=await hA(t.localStore);n.compareTo(r)>=0&&await function(s,o){const a=s.Va.Tt(o);return a.targetChanges.forEach((l,u)=>{if(l.resumeToken.approximateByteSize()>0){const f=s.Ia.get(u);f&&s.Ia.set(u,f.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,u)=>{const f=s.Ia.get(l);if(!f)return;s.Ia.set(l,f.withResumeToken(Ze.EMPTY_BYTE_STRING,f.snapshotVersion)),_A(s,l);const p=new nr(f.target,l,u,f.sequenceNumber);Dg(s,p)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){$(ss,"Failed to raise snapshot:",r),await dd(t,r)}}async function dd(t,e,n){if(!hi(e))throw e;t.Ea.add(1),await Gl(t),t.Ra.set("Offline"),n||(n=()=>hA(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{$(ss,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await nh(t)})}function vA(t,e){return e().catch(n=>dd(t,n,e))}async function ql(t){const e=ue(t),n=oi(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:qi;for(;z4(e);)try{const i=await C4(e.localStore,r);if(i===null){e.Ta.length===0&&n.L_();break}r=i.batchId,H4(e,i)}catch(i){await dd(e,i)}TA(e)&&EA(e)}function z4(t){return ds(t)&&t.Ta.length<10}function H4(t,e){t.Ta.push(e);const n=oi(t);n.O_()&&n.X_&&n.ea(e.mutations)}function TA(t){return ds(t)&&!oi(t).x_()&&t.Ta.length>0}function EA(t){oi(t).start()}async function K4(t){oi(t).ra()}async function W4(t){const e=oi(t);for(const n of t.Ta)e.ea(n.mutations)}async function J4(t,e,n){const r=t.Ta.shift(),i=Tg.from(r,e,n);await vA(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await ql(t)}async function Q4(t,e){e&&oi(t).X_&&await async function(r,i){if(function(o){return RU(o)&&o!==B.ABORTED}(i.code)){const s=r.Ta.shift();oi(r).B_(),await vA(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await ql(r)}}(t,e),TA(t)&&EA(t)}async function ME(t,e){const n=ue(t);n.asyncQueue.verifyOperationInProgress(),$(ss,"RemoteStore received new credentials");const r=ds(n);n.Ea.add(3),await Gl(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await nh(n)}async function Y4(t,e){const n=ue(t);e?(n.Ea.delete(2),await nh(n)):e||(n.Ea.add(2),await Gl(n),n.Ra.set("Unknown"))}function qo(t){return t.ma||(t.ma=function(n,r,i){const s=ue(n);return s.sa(),new V4(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Xo:B4.bind(null,t),t_:G4.bind(null,t),r_:q4.bind(null,t),H_:$4.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),Vg(t)?Mg(t):t.Ra.set("Unknown")):(await t.ma.stop(),yA(t))})),t.ma}function oi(t){return t.fa||(t.fa=function(n,r,i){const s=ue(n);return s.sa(),new b4(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:K4.bind(null,t),r_:Q4.bind(null,t),ta:W4.bind(null,t),na:J4.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await ql(t)):(await t.fa.stop(),t.Ta.length>0&&($(ss,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bg{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new ir,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const o=Date.now()+r,a=new bg(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Q(B.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Lg(t,e){if(Mt("AsyncQueue",`${e}: ${t}`),hi(t))return new Q(B.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ro{static emptySet(e){return new ro(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||J.comparator(n.key,r.key):(n,r)=>J.comparator(n.key,r.key),this.keyedMap=Ca(),this.sortedSet=new He(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof ro)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new ro;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VE{constructor(){this.ga=new He(J.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):Z(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,r)=>{e.push(r)}),e}}class xo{constructor(e,n,r,i,s,o,a,l,u){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,n,r,i,s){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new xo(e,n,ro.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Jd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j4{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class X4{constructor(){this.queries=bE(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const i=ue(n),s=i.queries;i.queries=bE(),s.forEach((o,a)=>{for(const l of a.Sa)l.onError(r)})})(this,new Q(B.ABORTED,"Firestore shutting down"))}}function bE(){return new gr(t=>E0(t),Jd)}async function Z4(t,e){const n=ue(t);let r=3;const i=e.query;let s=n.queries.get(i);s?!s.ba()&&e.Da()&&(r=2):(s=new j4,r=e.Da()?0:1);try{switch(r){case 0:s.wa=await n.onListen(i,!0);break;case 1:s.wa=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(o){const a=Lg(o,`Initialization of query '${Rs(e.query)}' failed`);return void e.onError(a)}n.queries.set(i,s),s.Sa.push(e),e.va(n.onlineState),s.wa&&e.Fa(s.wa)&&Fg(n)}async function eO(t,e){const n=ue(t),r=e.query;let i=3;const s=n.queries.get(r);if(s){const o=s.Sa.indexOf(e);o>=0&&(s.Sa.splice(o,1),s.Sa.length===0?i=e.Da()?0:1:!s.ba()&&e.Da()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function tO(t,e){const n=ue(t);let r=!1;for(const i of e){const s=i.query,o=n.queries.get(s);if(o){for(const a of o.Sa)a.Fa(i)&&(r=!0);o.wa=i}}r&&Fg(n)}function nO(t,e,n){const r=ue(t),i=r.queries.get(e);if(i)for(const s of i.Sa)s.onError(n);r.queries.delete(e)}function Fg(t){t.Ca.forEach(e=>{e.next()})}var qp,LE;(LE=qp||(qp={})).Ma="default",LE.Cache="cache";class rO{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new xo(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=xo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==qp.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IA{constructor(e){this.key=e}}class wA{constructor(e){this.key=e}}class iO{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=fe(),this.mutatedKeys=fe(),this.eu=I0(e),this.tu=new ro(this.eu)}get nu(){return this.Ya}ru(e,n){const r=n?n.iu:new VE,i=n?n.tu:this.tu;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((f,p)=>{const m=i.get(f),v=Ol(this.query,p)?p:null,I=!!m&&this.mutatedKeys.has(m.key),x=!!v&&(v.hasLocalMutations||this.mutatedKeys.has(v.key)&&v.hasCommittedMutations);let M=!1;m&&v?m.data.isEqual(v.data)?I!==x&&(r.track({type:3,doc:v}),M=!0):this.su(m,v)||(r.track({type:2,doc:v}),M=!0,(l&&this.eu(v,l)>0||u&&this.eu(v,u)<0)&&(a=!0)):!m&&v?(r.track({type:0,doc:v}),M=!0):m&&!v&&(r.track({type:1,doc:m}),M=!0,(l||u)&&(a=!0)),M&&(v?(o=o.add(v),s=x?s.add(f):s.delete(f)):(o=o.delete(f),s=s.delete(f)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const f=this.query.limitType==="F"?o.last():o.first();o=o.delete(f.key),s=s.delete(f.key),r.track({type:1,doc:f})}return{tu:o,iu:r,Cs:a,mutatedKeys:s}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((f,p)=>function(v,I){const x=M=>{switch(M){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Z(20277,{Rt:M})}};return x(v)-x(I)}(f.type,p.type)||this.eu(f.doc,p.doc)),this.ou(r),i=i??!1;const a=n&&!i?this._u():[],l=this.Xa.size===0&&this.current&&!i?1:0,u=l!==this.Za;return this.Za=l,o.length!==0||u?{snapshot:new xo(this.query,e.tu,s,o,e.mutatedKeys,l===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new VE,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Ya=this.Ya.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ya=this.Ya.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=fe(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))});const n=[];return e.forEach(r=>{this.Xa.has(r)||n.push(new wA(r))}),this.Xa.forEach(r=>{e.has(r)||n.push(new IA(r))}),n}cu(e){this.Ya=e.Qs,this.Xa=fe();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return xo.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Ug="SyncEngine";class sO{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class oO{constructor(e){this.key=e,this.hu=!1}}class aO{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new gr(a=>E0(a),Jd),this.Iu=new Map,this.Eu=new Set,this.du=new He(J.comparator),this.Au=new Map,this.Ru=new Ag,this.Vu={},this.mu=new Map,this.fu=is.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function lO(t,e,n=!0){const r=xA(t);let i;const s=r.Tu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await SA(r,e,n,!0),i}async function uO(t,e){const n=xA(t);await SA(n,e,!0,!1)}async function SA(t,e,n,r){const i=await A4(t.localStore,pn(e)),s=i.targetId,o=t.sharedClientState.addLocalQueryTarget(s,n);let a;return r&&(a=await cO(t,e,s,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&gA(t.remoteStore,i),a}async function cO(t,e,n,r,i){t.pu=(p,m,v)=>async function(x,M,A,T){let S=M.view.ru(A);S.Cs&&(S=await PE(x.localStore,M.query,!1).then(({documents:C})=>M.view.ru(C,S)));const V=T&&T.targetChanges.get(M.targetId),U=T&&T.targetMismatches.get(M.targetId)!=null,F=M.view.applyChanges(S,x.isPrimaryClient,V,U);return UE(x,M.targetId,F.au),F.snapshot}(t,p,m,v);const s=await PE(t.localStore,e,!0),o=new iO(e,s.Qs),a=o.ru(s.documents),l=Bl.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),u=o.applyChanges(a,t.isPrimaryClient,l);UE(t,n,u.au);const f=new sO(e,n,o);return t.Tu.set(e,f),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),u.snapshot}async function dO(t,e,n){const r=ue(t),i=r.Tu.get(e),s=r.Iu.get(i.targetId);if(s.length>1)return r.Iu.set(i.targetId,s.filter(o=>!Jd(o,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Bp(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&Ng(r.remoteStore,i.targetId),$p(r,i.targetId)}).catch(us)):($p(r,i.targetId),await Bp(r.localStore,i.targetId,!0))}async function hO(t,e){const n=ue(t),r=n.Tu.get(e),i=n.Iu.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Ng(n.remoteStore,r.targetId))}async function fO(t,e,n){const r=kA(t);try{const i=await function(o,a){const l=ue(o),u=Se.now(),f=a.reduce((v,I)=>v.add(I.key),fe());let p,m;return l.persistence.runTransaction("Locally write mutations","readwrite",v=>{let I=Yt(),x=fe();return l.Ns.getEntries(v,f).next(M=>{I=M,I.forEach((A,T)=>{T.isValidDocument()||(x=x.add(A))})}).next(()=>l.localDocuments.getOverlayedDocuments(v,I)).next(M=>{p=M;const A=[];for(const T of a){const S=CU(T,p.get(T.key).overlayedDocument);S!=null&&A.push(new fi(T.key,S,f0(S.value.mapValue),jt.exists(!0)))}return l.mutationQueue.addMutationBatch(v,u,A,a)}).next(M=>{m=M;const A=M.applyToLocalDocumentSet(p,x);return l.documentOverlayCache.saveOverlays(v,M.batchId,A)})}).then(()=>({batchId:m.batchId,changes:S0(p)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,l){let u=o.Vu[o.currentUser.toKey()];u||(u=new He(le)),u=u.insert(a,l),o.Vu[o.currentUser.toKey()]=u}(r,i.batchId,n),await $l(r,i.changes),await ql(r.remoteStore)}catch(i){const s=Lg(i,"Failed to persist write");n.reject(s)}}async function CA(t,e){const n=ue(t);try{const r=await w4(n.localStore,e);e.targetChanges.forEach((i,s)=>{const o=n.Au.get(s);o&&(te(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.hu=!0:i.modifiedDocuments.size>0?te(o.hu,14607):i.removedDocuments.size>0&&(te(o.hu,42227),o.hu=!1))}),await $l(n,r,e)}catch(r){await us(r)}}function FE(t,e,n){const r=ue(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Tu.forEach((s,o)=>{const a=o.view.va(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){const l=ue(o);l.onlineState=a;let u=!1;l.queries.forEach((f,p)=>{for(const m of p.Sa)m.va(a)&&(u=!0)}),u&&Fg(l)}(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function pO(t,e,n){const r=ue(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Au.get(e),s=i&&i.key;if(s){let o=new He(J.comparator);o=o.insert(s,je.newNoDocument(s,re.min()));const a=fe().add(s),l=new jd(re.min(),new Map,new He(le),o,a);await CA(r,l),r.du=r.du.remove(s),r.Au.delete(e),Og(r)}else await Bp(r.localStore,e,!1).then(()=>$p(r,e,n)).catch(us)}async function mO(t,e){const n=ue(t),r=e.batch.batchId;try{const i=await I4(n.localStore,e);RA(n,r,null),AA(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await $l(n,i)}catch(i){await us(i)}}async function gO(t,e,n){const r=ue(t);try{const i=await function(o,a){const l=ue(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let f;return l.mutationQueue.lookupMutationBatch(u,a).next(p=>(te(p!==null,37113),f=p.keys(),l.mutationQueue.removeMutationBatch(u,p))).next(()=>l.mutationQueue.performConsistencyCheck(u)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(u,f,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,f)).next(()=>l.localDocuments.getDocuments(u,f))})}(r.localStore,e);RA(r,e,n),AA(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await $l(r,i)}catch(i){await us(i)}}function AA(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function RA(t,e,n){const r=ue(t);let i=r.Vu[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Vu[r.currentUser.toKey()]=i}}function $p(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(r=>{t.Ru.containsKey(r)||PA(t,r)})}function PA(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(Ng(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),Og(t))}function UE(t,e,n){for(const r of n)r instanceof IA?(t.Ru.addReference(r.key,e),_O(t,r)):r instanceof wA?($(Ug,"Document no longer in limbo: "+r.key),t.Ru.removeReference(r.key,e),t.Ru.containsKey(r.key)||PA(t,r.key)):Z(19791,{wu:r})}function _O(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Eu.has(r)||($(Ug,"New document in limbo: "+n),t.Eu.add(r),Og(t))}function Og(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new J(ke.fromString(e)),r=t.fu.next();t.Au.set(r,new oO(n)),t.du=t.du.insert(n,r),gA(t.remoteStore,new nr(pn(Wd(n.path)),r,"TargetPurposeLimboResolution",cn.ce))}}async function $l(t,e,n){const r=ue(t),i=[],s=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((a,l)=>{o.push(r.pu(l,e,n).then(u=>{var f;if((u||n)&&r.isPrimaryClient){const p=u?!u.fromCache:(f=n==null?void 0:n.targetChanges.get(l.targetId))==null?void 0:f.current;r.sharedClientState.updateQueryState(l.targetId,p?"current":"not-current")}if(u){i.push(u);const p=xg.As(l.targetId,u);s.push(p)}}))}),await Promise.all(o),r.Pu.H_(i),await async function(l,u){const f=ue(l);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>b.forEach(u,m=>b.forEach(m.Es,v=>f.persistence.referenceDelegate.addReference(p,m.targetId,v)).next(()=>b.forEach(m.ds,v=>f.persistence.referenceDelegate.removeReference(p,m.targetId,v)))))}catch(p){if(!hi(p))throw p;$(kg,"Failed to update sequence numbers: "+p)}for(const p of u){const m=p.targetId;if(!p.fromCache){const v=f.Ms.get(m),I=v.snapshotVersion,x=v.withLastLimboFreeSnapshotVersion(I);f.Ms=f.Ms.insert(m,x)}}}(r.localStore,s))}async function yO(t,e){const n=ue(t);if(!n.currentUser.isEqual(e)){$(Ug,"User change. New user:",e.toKey());const r=await dA(n.localStore,e);n.currentUser=e,function(s,o){s.mu.forEach(a=>{a.forEach(l=>{l.reject(new Q(B.CANCELLED,o))})}),s.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await $l(n,r.Ls)}}function vO(t,e){const n=ue(t),r=n.Au.get(e);if(r&&r.hu)return fe().add(r.key);{let i=fe();const s=n.Iu.get(e);if(!s)return i;for(const o of s){const a=n.Tu.get(o);i=i.unionWith(a.view.nu)}return i}}function xA(t){const e=ue(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=CA.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=vO.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=pO.bind(null,e),e.Pu.H_=tO.bind(null,e.eventManager),e.Pu.yu=nO.bind(null,e.eventManager),e}function kA(t){const e=ue(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=mO.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=gO.bind(null,e),e}class Sl{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=th(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return cA(this.persistence,new uA,e.initialUser,this.serializer)}Cu(e){return new Rg(eh.mi,this.serializer)}Du(e){return new fA}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Sl.provider={build:()=>new Sl};class TO extends Sl{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){te(this.persistence.referenceDelegate instanceof cd,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new iA(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?Rt.withCacheSize(this.cacheSizeBytes):Rt.DEFAULT;return new Rg(r=>cd.mi(r,n),this.serializer)}}class EO extends Sl{constructor(e,n,r){super(),this.xu=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await kA(this.xu.syncEngine),await ql(this.xu.remoteStore),await this.persistence.Ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}vu(e){return cA(this.persistence,new uA,e.initialUser,this.serializer)}Fu(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new iA(r,e.asyncQueue,n)}Mu(e,n){const r=new wF(n,this.persistence);return new IF(e.asyncQueue,r)}Cu(e){const n=y4(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Rt.withCacheSize(this.cacheSizeBytes):Rt.DEFAULT;return new Pg(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,M4(),pc(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new fA}}class hd{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>FE(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=yO.bind(null,this.syncEngine),await Y4(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new X4}()}createDatastore(e){const n=th(e.databaseInfo.databaseId),r=function(s){return new D4(s)}(e.databaseInfo);return function(s,o,a,l){return new F4(s,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,a){return new O4(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>FE(this.syncEngine,n,0),function(){return NE.v()?new NE:new P4}())}createSyncEngine(e,n){return function(i,s,o,a,l,u,f){const p=new aO(i,s,o,a,l,u);return f&&(p.gu=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(i){const s=ue(i);$(ss,"RemoteStore shutting down."),s.Ea.add(5),await Gl(s),s.Aa.shutdown(),s.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}hd.provider={build:()=>new hd};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IO{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Mt("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ai="FirestoreClient";class wO{constructor(e,n,r,i,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=Tt.UNAUTHENTICATED,this.clientId=Ud.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{$(ai,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>($(ai,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ir;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Lg(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function uf(t,e){t.asyncQueue.verifyOperationInProgress(),$(ai,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await dA(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function OE(t,e){t.asyncQueue.verifyOperationInProgress();const n=await SO(t);$(ai,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>ME(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>ME(e.remoteStore,i)),t._onlineComponents=e}async function SO(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){$(ai,"Using user provided OfflineComponentProvider");try{await uf(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(i){return i.name==="FirebaseError"?i.code===B.FAILED_PRECONDITION||i.code===B.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;ni("Error using user provided cache. Falling back to memory cache: "+n),await uf(t,new Sl)}}else $(ai,"Using default OfflineComponentProvider"),await uf(t,new TO(void 0));return t._offlineComponents}async function NA(t){return t._onlineComponents||(t._uninitializedComponentsProvider?($(ai,"Using user provided OnlineComponentProvider"),await OE(t,t._uninitializedComponentsProvider._online)):($(ai,"Using default OnlineComponentProvider"),await OE(t,new hd))),t._onlineComponents}function CO(t){return NA(t).then(e=>e.syncEngine)}async function AO(t){const e=await NA(t),n=e.eventManager;return n.onListen=lO.bind(null,e.syncEngine),n.onUnlisten=dO.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=uO.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=hO.bind(null,e.syncEngine),n}function RO(t,e,n={}){const r=new ir;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,u){const f=new IO({next:m=>{f.Nu(),o.enqueueAndForget(()=>eO(s,p));const v=m.docs.has(a);!v&&m.fromCache?u.reject(new Q(B.UNAVAILABLE,"Failed to get document because the client is offline.")):v&&m.fromCache&&l&&l.source==="server"?u.reject(new Q(B.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(m)},error:m=>u.reject(m)}),p=new rO(Wd(a.path),f,{includeMetadataChanges:!0,qa:!0});return Z4(s,p)}(await AO(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DA(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BE=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MA="firestore.googleapis.com",GE=!0;class qE{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Q(B.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=MA,this.ssl=GE}else this.host=e.host,this.ssl=e.ssl??GE;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=eA;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<t4)throw new Q(B.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}qC("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=DA(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new Q(B.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new Q(B.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new Q(B.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Bg{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new qE({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Q(B.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Q(B.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new qE(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new BC;switch(r.type){case"firstParty":return new hF(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Q(B.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=BE.get(n);r&&($("ComponentProvider","Removing Datastore"),BE.delete(n),r.terminate())}(this),Promise.resolve()}}function VA(t,e,n,r={}){var u;t=es(t,Bg);const i=Fo(e),s=t._getSettings(),o={...s,emulatorOptions:t._getEmulatorOptions()},a=`${e}:${n}`;i&&(qS(`https://${a}`),$S("Firestore",!0)),s.host!==MA&&s.host!==a&&ni("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...s,host:a,ssl:i,emulatorOptions:r};if(!ji(l,o)&&(t._setSettings(l),r.mockUserToken)){let f,p;if(typeof r.mockUserToken=="string")f=r.mockUserToken,p=Tt.MOCK_USER;else{f=LV(r.mockUserToken,(u=t._app)==null?void 0:u.options.projectId);const m=r.mockUserToken.sub||r.mockUserToken.user_id;if(!m)throw new Q(B.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");p=new Tt(m)}t._authCredentials=new uF(new OC(f,p))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rh{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new rh(this.firestore,e,this._query)}}class ut{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ko(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ut(this.firestore,e,this._key)}toJSON(){return{type:ut._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(Ll(n,ut._jsonSchema))return new ut(e,r||null,new J(ke.fromString(n.referencePath)))}}ut._jsonSchemaVersion="firestore/documentReference/1.0",ut._jsonSchema={type:it("string",ut._jsonSchemaVersion),referencePath:it("string")};class ko extends rh{constructor(e,n,r){super(e,n,Wd(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ut(this.firestore,null,new J(e))}withConverter(e){return new ko(this.firestore,e,this._path)}}function PO(t,e,...n){if(t=en(t),arguments.length===1&&(e=Ud.newId()),yF("doc","path",e),t instanceof Bg){const r=ke.fromString(e,...n);return DT(r),new ut(t,null,new J(r))}{if(!(t instanceof ut||t instanceof ko))throw new Q(B.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ke.fromString(e,...n));return DT(r),new ut(t.firestore,t instanceof ko?t.converter:null,new J(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $E="AsyncQueue";class zE{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new pA(this,"async_queue_retry"),this._c=()=>{const r=pc();r&&$($E,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=pc();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=pc();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new ir;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!hi(e))throw e;$($E,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,Mt("INTERNAL UNHANDLED ERROR: ",HE(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const i=bg.createAndSchedule(this,e,n,r,s=>this.hc(s));return this.tc.push(i),i}uc(){this.nc&&Z(47125,{Pc:HE(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function HE(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class zl extends Bg{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new zE,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new zE(e),this._firestoreClient=void 0,await e}}}function bA(t,e){const n=typeof t=="object"?t:jS(),r=typeof t=="string"?t:td,i=Wm(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=VV("firestore");s&&VA(i,...s)}return i}function Gg(t){if(t._terminated)throw new Q(B.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||LA(t),t._firestoreClient}function LA(t){var r,i,s;const e=t._freezeSettings(),n=function(a,l,u,f){return new XF(a,l,u,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,DA(f.experimentalLongPollingOptions),f.useFetchStreams,f.isUsingEmulator)}(t._databaseId,((r=t._app)==null?void 0:r.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(i=e.localCache)!=null&&i._offlineComponentProvider&&((s=e.localCache)!=null&&s._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new wO(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(t._componentsProvider))}function FA(t,e){ni("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings();return xO(t,hd.provider,{build:r=>new EO(r,n.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}function xO(t,e,n){if((t=es(t,zl))._firestoreClient||t._terminated)throw new Q(B.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new Q(B.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:n},LA(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jt{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Jt(Ze.fromBase64String(e))}catch(n){throw new Q(B.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Jt(Ze.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Jt._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Ll(e,Jt._jsonSchema))return Jt.fromBase64String(e.bytes)}}Jt._jsonSchemaVersion="firestore/bytes/1.0",Jt._jsonSchema={type:it("string",Jt._jsonSchemaVersion),bytes:it("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ih{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new Q(B.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ze(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sh{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xn{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new Q(B.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new Q(B.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return le(this._lat,e._lat)||le(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:xn._jsonSchemaVersion}}static fromJSON(e){if(Ll(e,xn._jsonSchema))return new xn(e.latitude,e.longitude)}}xn._jsonSchemaVersion="firestore/geoPoint/1.0",xn._jsonSchema={type:it("string",xn._jsonSchemaVersion),latitude:it("number"),longitude:it("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kn{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}toJSON(){return{type:kn._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Ll(e,kn._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new kn(e.vectorValues);throw new Q(B.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}kn._jsonSchemaVersion="firestore/vectorValue/1.0",kn._jsonSchema={type:it("string",kn._jsonSchemaVersion),vectorValues:it("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kO=/^__.*__$/;class NO{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new fi(e,this.data,this.fieldMask,n,this.fieldTransforms):new Go(e,this.data,n,this.fieldTransforms)}}function UA(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Z(40011,{Ac:t})}}class qg{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new qg({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var i;const n=(i=this.path)==null?void 0:i.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){var i;const n=(i=this.path)==null?void 0:i.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return fd(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(UA(this.Ac)&&kO.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class DO{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||th(e)}Cc(e,n,r,i=!1){return new qg({Ac:e,methodName:n,Dc:r,path:ze.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function MO(t){const e=t._freezeSettings(),n=th(t._databaseId);return new DO(t._databaseId,!!e.ignoreUndefinedProperties,n)}function VO(t,e,n,r,i,s={}){const o=t.Cc(s.merge||s.mergeFields?2:0,e,n,i);qA("Data must be an object, but it was:",o,r);const a=BA(r,o);let l,u;if(s.merge)l=new dn(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const f=[];for(const p of s.mergeFields){const m=bO(e,p,n);if(!o.contains(m))throw new Q(B.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);FO(f,m)||f.push(m)}l=new dn(f),u=o.fieldTransforms.filter(p=>l.covers(p.field))}else l=null,u=o.fieldTransforms;return new NO(new Ot(a),l,u)}class $g extends sh{_toFieldTransform(e){return new N0(e.path,new Co)}isEqual(e){return e instanceof $g}}function OA(t,e){if(GA(t=en(t)))return qA("Unsupported field value:",e,t),BA(t,e);if(t instanceof sh)return function(r,i){if(!UA(i.Ac))throw i.Sc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const a of r){let l=OA(a,i.wc(o));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=en(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return vU(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=Se.fromDate(r);return{timestampValue:Po(i.serializer,s)}}if(r instanceof Se){const s=new Se(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Po(i.serializer,s)}}if(r instanceof xn)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Jt)return{bytesValue:U0(i.serializer,r._byteString)};if(r instanceof ut){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:wg(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof kn)return function(o,a){return{mapValue:{fields:{[fg]:{stringValue:pg},[Eo]:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw a.Sc("VectorValues must only contain numeric values.");return _g(a.serializer,u)})}}}}}}(r,i);throw i.Sc(`Unsupported field value: ${sg(r)}`)}(t,e)}function BA(t,e){const n={};return i0(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):cs(t,(r,i)=>{const s=OA(i,e.mc(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function GA(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Se||t instanceof xn||t instanceof Jt||t instanceof ut||t instanceof sh||t instanceof kn)}function qA(t,e,n){if(!GA(n)||!$C(n)){const r=sg(n);throw r==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+r)}}function bO(t,e,n){if((e=en(e))instanceof ih)return e._internalPath;if(typeof e=="string")return $A(t,e);throw fd("Field path arguments must be of type string or ",t,!1,void 0,n)}const LO=new RegExp("[~\\*/\\[\\]]");function $A(t,e,n){if(e.search(LO)>=0)throw fd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new ih(...e.split("."))._internalPath}catch{throw fd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function fd(t,e,n,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new Q(B.INVALID_ARGUMENT,a+t+l)}function FO(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zA{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new ut(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new UO(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(HA("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class UO extends zA{data(){return super.data()}}function HA(t,e){return typeof e=="string"?$A(t,e):e instanceof ih?e._internalPath:e._delegate._internalPath}class KA{convertValue(e,n="none"){switch(ii(e)){case 0:return null;case 1:return e.booleanValue;case 2:return qe(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(hr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Z(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return cs(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertVectorValue(e){var r,i,s;const n=(s=(i=(r=e.fields)==null?void 0:r[Eo].arrayValue)==null?void 0:i.values)==null?void 0:s.map(o=>qe(o.doubleValue));return new kn(n)}convertGeoPoint(e){return new xn(qe(e.latitude),qe(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=zd(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Tl(e));default:return null}}convertTimestamp(e){const n=dr(e);return new Se(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=ke.fromString(e);te(J0(r),9688,{name:e});const i=new ri(r.get(1),r.get(3)),s=new J(r.popFirst(5));return i.isEqual(n)||Mt(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OO(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class zs{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Xr extends zA{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Ja(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(HA("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Q(B.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Xr._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}Xr._jsonSchemaVersion="firestore/documentSnapshot/1.0",Xr._jsonSchema={type:it("string",Xr._jsonSchemaVersion),bundleSource:it("string","DocumentSnapshot"),bundleName:it("string"),bundle:it("string")};class Ja extends Xr{data(e={}){return super.data(e)}}class io{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new zs(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Ja(this._firestore,this._userDataWriter,r.key,r,new zs(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new Q(B.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{const l=new Ja(i._firestore,i._userDataWriter,a.doc.key,a.doc,new zs(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{const l=new Ja(i._firestore,i._userDataWriter,a.doc.key,a.doc,new zs(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let u=-1,f=-1;return a.type!==0&&(u=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),f=o.indexOf(a.doc.key)),{type:BO(a.type),doc:l,oldIndex:u,newIndex:f}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Q(B.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=io._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Ud.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],i=[];return this.docs.forEach(s=>{s._document!==null&&(n.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function BO(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Z(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GO(t){t=es(t,ut);const e=es(t.firestore,zl);return RO(Gg(e),t._key).then(n=>zO(e,t,n))}io._jsonSchemaVersion="firestore/querySnapshot/1.0",io._jsonSchema={type:it("string",io._jsonSchemaVersion),bundleSource:it("string","QuerySnapshot"),bundleName:it("string"),bundle:it("string")};class qO extends KA{constructor(e){super(),this.firestore=e}convertBytes(e){return new Jt(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new ut(this.firestore,null,n)}}function $O(t,e,n){t=es(t,ut);const r=es(t.firestore,zl),i=OO(t.converter,e,n);return WA(r,[VO(MO(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,jt.none())])}function WA(t,e){return function(r,i){const s=new ir;return r.asyncQueue.enqueueAndForget(async()=>fO(await CO(r),i,s)),s.promise}(Gg(t),e)}function zO(t,e,n){const r=n.docs.get(e._key),i=new qO(t);return new Xr(t,i,e._key,r,new zs(n.hasPendingWrites,n.fromCache),e.converter)}function HO(){return new $g("serverTimestamp")}(function(e,n=!0){(function(i){Bo=i})(Uo),po(new Xi("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),a=new zl(new cF(r.getProvider("auth-internal")),new fF(o,r.getProvider("app-check-internal")),function(u,f){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new Q(B.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ri(u.options.projectId,f)}(o,i),o);return s={useFetchStreams:n,...s},a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),Qr(PT,xT,e),Qr(PT,xT,"esm2020")})();const Ou=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:KA,Bytes:Jt,CollectionReference:ko,DocumentReference:ut,DocumentSnapshot:Xr,FieldPath:ih,FieldValue:sh,Firestore:zl,FirestoreError:Q,GeoPoint:xn,Query:rh,QueryDocumentSnapshot:Ja,QuerySnapshot:io,SnapshotMetadata:zs,Timestamp:Se,VectorValue:kn,_AutoId:Ud,_ByteString:Ze,_DatabaseId:ri,_DocumentKey:J,_EmptyAuthCredentialsProvider:BC,_FieldPath:ze,_cast:es,_logWarn:ni,_validateIsNotUsedTogether:qC,connectFirestoreEmulator:VA,doc:PO,enableIndexedDbPersistence:FA,ensureFirestoreConfigured:Gg,executeWrite:WA,getDoc:GO,getFirestore:bA,serverTimestamp:HO,setDoc:$O,setLogLevel:FC},Symbol.toStringTag,{value:"Module"}));FC("error");const KO={apiKey:"AIzaSyC1zhlBnbOxP_PCaHU6L-UsDOBRTjGgpfk",authDomain:"my-apss-da774.firebaseapp.com",projectId:"my-apss-da774",storageBucket:"my-apss-da774.firebasestorage.app",messagingSenderId:"528434940137",appId:"1:528434940137:web:56be66185a46f390b60878",measurementId:"G-WPGZGF4ZBG"},JA=YS(KO),mc=aF(JA);Wb(mc,EC).catch(t=>console.error("Persistence error:",t));const zg=new jn;zg.addScope("profile");zg.addScope("email");const Jn=bA(JA);FA(Jn).catch(t=>{t.code==="failed-precondition"?console.warn("Firestore: Multiple tabs open, persistence disabled"):t.code==="unimplemented"&&console.warn("Firestore: Browser does not support persistence")});const WO=()=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||navigator.maxTouchPoints&&navigator.maxTouchPoints>2&&/MacIntel/.test(navigator.platform),JO=()=>window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0,KE=()=>window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",QO=({onClose:t})=>{const[e,n]=G.useState(null),[r,i]=G.useState(!1);G.useEffect(()=>{const o=/iPad|iPhone|iPod/.test(navigator.userAgent);i(o);const a=l=>{l.preventDefault(),n(l)};return window.addEventListener("beforeinstallprompt",a),()=>{window.removeEventListener("beforeinstallprompt",a)}},[]);const s=async()=>{if(e){e.prompt();const{outcome:o}=await e.userChoice;o==="accepted"&&(n(null),t())}};return _.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:_.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-sm w-full",children:[_.jsxs("div",{className:"text-center mb-4",children:[_.jsx("div",{className:"w-16 h-16 bg-indigo-600 rounded-lg mx-auto mb-4 flex items-center justify-center",children:_.jsx("span",{className:"text-white text-2xl font-bold",children:"N"})}),_.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"앱으로 설치하기"}),_.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-sm",children:"Nova를 홈 화면에 추가하여 더 편리하게 사용하세요."})]}),r?_.jsxs("div",{className:"mb-4",children:[_.jsx("div",{className:"bg-blue-50 dark:bg-blue-900 p-3 rounded-lg mb-3",children:_.jsx("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:"iOS에서 설치하는 방법:"})}),_.jsxs("ol",{className:"text-sm text-gray-600 dark:text-gray-300 space-y-2",children:[_.jsxs("li",{className:"flex items-center",children:[_.jsx("span",{className:"w-6 h-6 bg-indigo-600 text-white rounded-full flex items-center justify-center text-xs mr-2",children:"1"}),"하단의 공유 버튼 (□↗) 탭"]}),_.jsxs("li",{className:"flex items-center",children:[_.jsx("span",{className:"w-6 h-6 bg-indigo-600 text-white rounded-full flex items-center justify-center text-xs mr-2",children:"2"}),'"홈 화면에 추가" 선택']}),_.jsxs("li",{className:"flex items-center",children:[_.jsx("span",{className:"w-6 h-6 bg-indigo-600 text-white rounded-full flex items-center justify-center text-xs mr-2",children:"3"}),'"추가" 버튼 탭']})]})]}):_.jsx("div",{className:"mb-4",children:e?_.jsx("button",{onClick:s,className:"w-full bg-indigo-600 text-white py-2 px-4 rounded-lg hover:bg-indigo-700 transition-colors",children:"지금 설치하기"}):_.jsx("div",{className:"bg-gray-50 dark:bg-gray-700 p-3 rounded-lg",children:_.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:'브라우저 메뉴에서 "홈 화면에 추가" 또는 "앱 설치"를 선택하세요.'})})}),_.jsxs("div",{className:"flex space-x-2",children:[_.jsx("button",{onClick:t,className:"flex-1 bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-gray-200 py-2 px-4 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-500 transition-colors",children:"나중에"}),_.jsx("button",{onClick:()=>{localStorage.setItem("pwa-prompt-dismissed","true"),t()},className:"flex-1 bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-gray-200 py-2 px-4 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-500 transition-colors",children:"다시 보지 않기"})]})]})})},YO={ko:{language_selection_title:"언어",error_wish_required:"목표를 입력해주세요.",error_outcome_required:"결과를 입력해주세요.",error_obstacle_required:"장애물을 입력해주세요.",error_plan_required:"If-Then 계획을 입력해주세요.",error_deadline_required:"마감일을 선택해주세요.",error_day_required:"하나 이상의 요일을 선택해주세요.",my_goals_title:"나의 목표",sort_label_manual:"수동",sort_label_deadline:"마감일순",sort_label_newest:"최신순",sort_label_alphabetical:"이름순",sort_label_ai:"AI 추천",ai_sorting_button:"정렬 중...",add_new_goal_button_label:"새로운 목표 추가",filter_all:"모든 목표",filter_active:"진행중",filter_completed:"완료됨",empty_message_all:"첫 번째 목표를 추가하여 시작해보세요.",empty_message_active:"진행중인 목표가 없습니다.",empty_message_completed:"아직 완료된 목표가 없습니다.",empty_encouragement_1:"새로운 여정의 첫 걸음을 내딛어보세요.",empty_encouragement_2:"작은 변화가 큰 성취로 이어집니다.",empty_encouragement_3:"오늘 하는 일이 내일을 만듭니다.",empty_encouragement_4:"당신의 목표가 현실이 되는 순간을 만나보세요.",delete_button:"삭제",edit_button_aria:"목표 편집",info_button_aria:"상세 정보",filter_title:"필터",sort_title:"정렬",filter_sort_button_aria:"필터 및 정렬",calendar_view_button_aria:"캘린더 보기",list_view_button_aria:"목록 보기",more_options_button_aria:"더 보기",select_button_label:"선택",cancel_selection_button_label:"취소",delete_selected_button_label:"{count}개 삭제",delete_selected_confirm_title:"목표 삭제",delete_selected_confirm_message:"선택한 {count}개의 목표가 영구적으로 삭제됩니다.",days_left:"{count}일 남음",d_day:"D-DAY",days_overdue:"{count}일 지남",month_names:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],day_names_short:["일","월","화","수","목","금","토"],day_names_long:["일요일","월요일","화요일","수요일","목요일","금요일","토요일"],calendar_header_month_format:"{year}년 {month}",calendar_view_day3:"3일",calendar_view_week:"주",calendar_view_month:"월",settings_title:"설정",sort_alert_title:"정렬 실패",sort_alert_message:"AI 추천 정렬을 사용하려면<br/>2개 이상의 목표가 필요합니다.",ai_sort_error_title:"AI 정렬 오류",ai_sort_error_message:"지금은 목표를 정렬할 수 없습니다.",confirm_button:"확인",new_goal_modal_title:"새로운 목표",edit_goal_modal_title:"목표 편집",wish_label:"목표",outcome_label:"최상의 결과",obstacle_label:"장애물",plan_label:"If-Then 계획",deadline_label:"마감일",cancel_button:"취소",add_button:"추가",save_button:"저장",goal_details_modal_title:"목표 상세 정보",ai_coach_suggestion:"🤖 AI 코치",ai_analyzing:"AI 분석 중...",close_button:"닫기",ai_sort_reason_modal_title:"AI 정렬 이유",ai_sort_criteria:"🤖 AI 정렬 기준",delete_account_final_confirm_title:"모든 데이터 삭제",delete_account_final_confirm_message:"모든 목표와 데이터가 영구적으로 삭제되며, 이 작업은 되돌릴 수 없습니다.",delete_all_data_button:"모든 데이터 삭제",settings_done_button:"완료",settings_section_data:"데이터 관리",settings_export_data:"내보내기",settings_import_data:"가져오기",import_confirm_title:"데이터 가져오기",import_confirm_message:"현재 목표를 새로운 데이터로 교체합니다. 이 작업은 되돌릴 수 없습니다.",import_success_toast:"데이터를 성공적으로 가져왔습니다.",import_error_alert_title:"가져오기 실패",import_error_alert_message:"파일을 읽는 중 오류가 발생했거나 파일 형식이 올바르지 않습니다.",settings_section_general:"일반",settings_section_info:"정보",settings_section_help:"사용방법",settings_dark_mode:"다크 모드",settings_language:"언어",settings_api_key:"AI 도우미 설정",settings_api_key_placeholder:"Gemini API 키 입력",settings_offline_mode:"오프라인 사용",settings_offline_mode_desc:"AI 기능 없이 기본 앱 기능만 사용",language_name:"한국어 (대한민국)",language_modal_title:"언어",settings_section_background:"화면",settings_bg_default:"라이트",settings_bg_default_dark:"다크",settings_bg_pink:"핑크",settings_bg_cherry_noir:"체리 누아르",settings_bg_blue:"블루",settings_bg_deep_ocean:"오션",settings_bg_green:"그린",settings_bg_forest_green:"포레스트",settings_bg_purple:"퍼플",settings_bg_royal_purple:"로얄 퍼플",settings_version:"버전",settings_developer:"개발자",developer_name:"GimGyuMin",settings_copyright:"저작권",copyright_notice:"© 2025 GimGyuMin. All Rights Reserved.",build_number:"빌드 번호",settings_data_header:"데이터 관리",settings_data_header_desc:"목표 데이터를 파일로 내보내거나, 파일에서 가져옵니다.",settings_background_header:"배경화면",settings_background_header_desc:"앱의 배경화면 스타일을 변경하여 개성을 표현해 보세요.",data_importing:"가져오는 중...",data_exporting:"내보내는 중...",data_deleting:"삭제 중...",url_import_title:"URL에서 데이터 불러오기",url_import_message:"URL의 데이터로 현재 목표 목록을 덮어쓰시겠습니까?",url_import_confirm:"불러오기",url_import_success:"URL에서 데이터를 성공적으로 가져왔습니다!",url_import_error:"URL의 데이터가 올바르지 않습니다.",settings_share_link_header:"링크로 공유",settings_generate_link:"공유 링크 생성",settings_copy_link:"복사",link_copied_toast:"링크가 클립보드에 복사되었습니다.",short_url_created:"📎 단축 URL이 생성되었습니다!",share_link_created:"🔗 공유 링크가 생성되었습니다!",short_url_failed:"⚠️ 단축 URL 생성에 실패하여 기본 링크를 사용합니다.",no_data_to_share:"공유할 목표가 없습니다. 먼저 목표를 추가해주세요.",usage_guide_tab:"사용방법",usage_guide_title:"사용 가이드",usage_basic_title:"목표 추가하기",usage_basic_desc:`1. 홈 화면에서 "목표 추가 및 편집" 버튼을 탭하세요.
2. 목표, 결과, 장애물, 계획을 차례로 입력하세요.
3. 마감일과 반복 요일을 선택하세요.
4. "저장" 버튼을 눌러 목표를 추가하세요.`,usage_ai_title:"AI 기능 사용하기",usage_ai_desc:`• 목표 작성 시 "AI 제안" 버튼으로 개선된 목표를 받아보세요.
• 목표 목록에서 "AI 정렬" 버튼으로 중요도 순 정렬이 가능합니다.
• AI 분석을 통해 더 효과적인 목표 설정을 도와드립니다.

※ AI 기능 사용을 위해서는 API 키 설정이 필요합니다.`,usage_ai_setup_title:"AI 기능 설정하기",usage_ai_setup_desc:`1. 설정 > 일반에서 API 키 입력란을 찾으세요.
2. Google Gemini API 키를 입력하세요.
3. API 키 발급 방법은 다음 Google 지원 문서를 참조하세요:
   https://ai.google.dev/gemini-api/docs/api-key
4. 키 입력 후 AI 기능이 활성화됩니다.`,usage_share_title:"목표 공유하기",usage_share_desc:`1. 설정 > 공유에서 "목표 링크 생성" 버튼을 탭하세요.
2. 자동으로 생성된 단축 링크를 확인하세요.
3. "링크 복사" 버튼으로 클립보드에 복사하세요.
4. 메신저나 이메일로 링크를 공유하세요.`,usage_theme_title:"테마 변경하기",usage_theme_desc:`1. 설정 > 모양에서 다크 모드 토글을 사용하세요.
2. 배경 테마에서 원하는 색상을 선택하세요.
3. 기본, 핑크, 블루, 그린, 퍼플 테마 중 선택 가능합니다.
4. 변경 사항은 즉시 적용됩니다.`,usage_calendar_title:"캘린더 보기 사용하기",usage_calendar_desc:`1. 하단 탭에서 캘린더 아이콘을 탭하세요.
2. 3일/주간/월간 보기를 선택할 수 있습니다.
3. 날짜를 탭하여 해당 날의 목표를 확인하세요.
4. 좌우 화살표로 날짜를 이동할 수 있습니다.`,usage_offline_title:"오프라인 모드 사용하기",usage_offline_desc:`1. 설정 > 일반에서 "오프라인 모드" 토글을 켜세요.
2. API 키 없이도 목표 추가, 편집, 삭제가 가능합니다.
3. AI 기능은 사용할 수 없지만 모든 기본 기능은 정상 작동합니다.
4. 데이터는 브라우저에 안전하게 저장됩니다.`,goal_assistant_title:"새로운 목표",goal_assistant_mode_woop:"WOOP 방식",goal_assistant_mode_automation:"빠른 생성",automation_title:"목표 시리즈 만들기",automation_base_name_label:"목표 이름",automation_base_name_placeholder:"예: 영어 단어 학습",automation_total_units_label:"총 분량",automation_total_units_placeholder:"예: 30",automation_units_per_day_label:"일일 분량",automation_period_label:"기간",automation_start_date_label:"시작일",automation_end_date_label:"종료일",automation_generate_button:"{count}개 생성",automation_error_all_fields:"모든 필드를 올바르게 입력해주세요.",automation_error_start_after_end:"시작일은 종료일보다 빨라야 합니다.",automation_error_short_period:"기간이 너무 짧습니다. (1일 이상)",next_button:"다음",back_button:"이전",wish_tip:"측정 가능하고 구체적인, 도전적이면서도 현실적인 목표를 설정하세요.",wish_example:"예: 3개월 안에 5kg 감량하기, 이번 학기에 A+ 받기",outcome_tip:"목표 달성 시 얻게 될 가장 긍정적인 결과를 생생하게 상상해 보세요.",outcome_example:"예: 더 건강하고 자신감 있는 모습, 성적 장학금 수령",obstacle_tip:"목표 달성을 방해할 수 있는 내면의 장애물(습관, 감정 등)은 무엇인가요?",obstacle_example:"예: 퇴근 후 피곤해서 운동 가기 싫은 마음, 어려운 과제를 미루는 습관",plan_tip:"'만약 ~라면, ~하겠다' 형식으로 장애물에 대한 구체적인 대응 계획을 세워보세요.",plan_example:"예: 만약 퇴근 후 운동 가기 싫다면, 일단 운동복으로 갈아입고 10분만 스트레칭한다.",recurrence_label:"반복",recurrence_tip:"정해진 요일에 꾸준히 해야 하는 목표인가요? 반복으로 설정하여 연속 달성을 기록해 보세요.",recurrence_example:"예: 매주 월,수,금 헬스장 가기",recurrence_option_daily:"반복 목표",deadline_tip:"현실적인 마감일을 설정하여 동기를 부여하세요. 마감일이 없는 장기 목표도 좋습니다.",deadline_option_no_deadline:"마감일 없음",day_names_short_picker:["월","화","수","목","금","토","일"],settings_delete_account:"모든 데이터 삭제",delete_account_header:"데이터 삭제",delete_account_header_desc:"이 작업은 되돌릴 수 없으며, 모든 목표와 데이터가 영구적으로 삭제됩니다.",version_update_title:"새로운 기능",version_update_1_title:"Firebase 클라우드 동기화",version_update_1_desc:"Google 로그인으로 목표와 설정값을 클라우드에 저장하고 불러올 수 있습니다. 여러 기기에서 동기화됩니다.",version_update_2_title:"자동 설정 동기화",version_update_2_desc:"언어, 테마, 배경 색상 등 모든 설정값이 클라우드에 저장되어 다른 기기에서도 동일하게 적용됩니다.",version_update_3_title:"안전한 로그아웃",version_update_3_desc:"로그아웃 시 모든 데이터가 클라우드에 저장되고, 로컬 데이터는 완전히 삭제되며 홈으로 이동합니다.",version_update_4_title:"상태 표시 UI",version_update_4_desc:"로그인, 로그아웃, 동기화 등의 작업 중 버튼 상태가 변화하여 진행 상황을 명확히 보여줍니다."},en:{language_selection_title:"Language",error_wish_required:"Please enter your wish.",error_outcome_required:"Please enter the outcome.",error_obstacle_required:"Please enter the obstacle.",error_plan_required:"Please enter your If-Then plan.",error_deadline_required:"Please select a deadline.",error_day_required:"Please select at least one day.",my_goals_title:"My Goals",sort_label_manual:"Manual",sort_label_deadline:"Deadline",sort_label_newest:"Newest",sort_label_alphabetical:"Alphabetical",sort_label_ai:"AI Recommended",ai_sorting_button:"Sorting...",add_new_goal_button_label:"Add New Goal",filter_all:"All Goals",filter_active:"In Progress",filter_completed:"Completed",empty_message_all:"Add your first goal to begin your journey.",empty_message_active:"No goals in progress.",empty_message_completed:"No completed goals yet.",empty_encouragement_1:"Take the first step toward something amazing.",empty_encouragement_2:"Small changes lead to big achievements.",empty_encouragement_3:"What you do today shapes tomorrow.",empty_encouragement_4:"Your goals are waiting to become reality.",delete_button:"Delete",edit_button_aria:"Edit Goal",info_button_aria:"Details",filter_title:"Filter",sort_title:"Sort",filter_sort_button_aria:"Filter and Sort",calendar_view_button_aria:"Calendar View",list_view_button_aria:"List View",more_options_button_aria:"More",select_button_label:"Select",cancel_selection_button_label:"Cancel",delete_selected_button_label:"Delete {count}",delete_selected_confirm_title:"Delete Goals",delete_selected_confirm_message:"The {count} selected goals will be permanently deleted.",days_left:"{count} days left",d_day:"D-DAY",days_overdue:"{count} days overdue",month_names:["January","February","March","April","May","June","July","August","September","October","November","December"],day_names_short:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],day_names_long:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],calendar_header_month_format:"{month} {year}",calendar_view_day3:"3-Day",calendar_view_week:"Week",calendar_view_month:"Month",settings_title:"Settings",sort_alert_title:"Unable to Sort",sort_alert_message:"Add at least two goals to use AI recommendations.",ai_sort_error_title:"Sorting Unavailable",ai_sort_error_message:"AI sorting is temporarily unavailable.",confirm_button:"OK",new_goal_modal_title:"New Goal",edit_goal_modal_title:"Edit Goal",wish_label:"Wish",outcome_label:"Outcome",obstacle_label:"Obstacle",plan_label:"If-Then Plan",deadline_label:"Deadline",cancel_button:"Cancel",add_button:"Add",save_button:"Save",goal_details_modal_title:"Goal Details",ai_coach_suggestion:"🤖 AI Coach",ai_analyzing:"AI Analyzing...",close_button:"Close",ai_sort_reason_modal_title:"AI Sort Rationale",ai_sort_criteria:"🤖 AI Sort Criteria",delete_account_final_confirm_title:"Delete All Data",delete_account_final_confirm_message:"All your goals and data will be permanently deleted. This action cannot be undone.",delete_all_data_button:"Delete All Data",settings_done_button:"Done",settings_section_data:"Data Management",settings_export_data:"Export",settings_import_data:"Import",import_confirm_title:"Import Data",import_confirm_message:"This will replace your current goals with new data. This action cannot be undone.",import_success_toast:"Data imported successfully.",import_error_alert_title:"Import Failed",import_error_alert_message:"There was an error reading the file, or the file format is incorrect.",settings_section_general:"General",settings_section_info:"Information",settings_section_help:"How to Use",settings_dark_mode:"Dark Mode",settings_language:"Language",settings_api_key:"AI Assistant",settings_api_key_placeholder:"Enter Gemini API key",settings_offline_mode:"Offline Mode",settings_offline_mode_desc:"Use basic features without AI",language_name:"English (US)",language_modal_title:"Language",settings_section_background:"Appearance",settings_bg_default:"Light",settings_bg_default_dark:"Dark",settings_bg_pink:"Pink",settings_bg_cherry_noir:"Cherry Noir",settings_bg_blue:"Blue",settings_bg_deep_ocean:"Ocean",settings_bg_green:"Green",settings_bg_forest_green:"Forest",settings_bg_purple:"Purple",settings_bg_royal_purple:"Royal Purple",settings_version:"Version",settings_developer:"Developer",developer_name:"GimGyuMin",settings_copyright:"Copyright",copyright_notice:"© 2025 GimGyuMin. All Rights Reserved.",build_number:"Build Number",settings_data_header:"Data Management",settings_data_header_desc:"Export or import your goal data.",settings_background_header:"Background",settings_background_header_desc:"Change the app's background style to express your personality.",data_importing:"Importing...",data_exporting:"Exporting...",data_deleting:"Deleting...",url_import_title:"Load from URL",url_import_message:"Overwrite current goals with data from the URL?",url_import_confirm:"Load",url_import_success:"Successfully loaded data from URL!",url_import_error:"Invalid data in URL.",settings_share_link_header:"Share via Link",settings_generate_link:"Generate Share Link",settings_copy_link:"Copy",link_copied_toast:"Link copied to clipboard.",short_url_created:"📎 Short URL created successfully!",share_link_created:"🔗 Share link generated!",short_url_failed:"⚠️ Short URL creation failed, using default link.",no_data_to_share:"No goals to share. Please add goals first.",usage_guide_tab:"How to Use",usage_guide_title:"User Guide",usage_basic_title:"Add a Goal",usage_basic_desc:`1. Tap "Add and Edit Goals" button on the home screen.
2. Fill in your goal, outcome, obstacle, and plan in order.
3. Select deadline and repeat days.
4. Tap "Save" to add your goal.`,usage_ai_title:"Use AI Features",usage_ai_desc:`• Use "AI Suggestion" button when writing goals for improvements.
• Tap "AI Sort" button to organize goals by importance.
• Get AI analysis for more effective goal setting.

※ API key setup is required to use AI features.`,usage_ai_setup_title:"Set Up AI Features",usage_ai_setup_desc:`1. Go to Settings > General and find the API Key field.
2. Enter your Google Gemini API key.
3. For API key generation, refer to the Google documentation:
   https://ai.google.dev/gemini-api/docs/api-key
4. AI features will be activated after entering the key.`,usage_share_title:"Share Your Goals",usage_share_desc:`1. Go to Settings > Sharing and tap "Create Goal Link".
2. Review the automatically generated short link.
3. Tap "Copy Link" to copy to clipboard.
4. Share the link via messenger or email.`,usage_theme_title:"Change Theme",usage_theme_desc:`1. Go to Settings > Appearance and use the dark mode toggle.
2. Select your preferred background theme.
3. Choose from Default, Pink, Blue, Green, or Purple themes.
4. Changes are applied immediately.`,usage_calendar_title:"Use Calendar View",usage_calendar_desc:`1. Tap the calendar icon in the bottom tabs.
2. Choose between 3-day, weekly, or monthly view.
3. Tap on any date to see goals for that day.
4. Use left/right arrows to navigate dates.`,usage_offline_title:"Use Offline Mode",usage_offline_desc:`1. Go to Settings > General and turn on "Offline Mode".
2. Add, edit, and delete goals without an API key.
3. AI features are unavailable, but all basic functions work normally.
4. Your data is safely stored in the browser.`,goal_assistant_title:"Add Goal",goal_assistant_mode_woop:"WOOP",goal_assistant_mode_automation:"Automation",automation_title:"Goal Automation",automation_base_name_label:"Base Goal Name",automation_base_name_placeholder:"e.g., Study Vocabulary",automation_total_units_label:"Total Units",automation_total_units_placeholder:"e.g., 30",automation_units_per_day_label:"Units per Day",automation_period_label:"Period",automation_start_date_label:"Start Date",automation_end_date_label:"End Date",automation_generate_button:"Generate {count}",automation_error_all_fields:"Please fill out all fields correctly.",automation_error_start_after_end:"Start date must be before end date.",automation_error_short_period:"The period is too short (min. 1 day).",next_button:"Next",back_button:"Back",wish_tip:"Set a challenging yet realistic goal. Make it specific and measurable.",wish_example:"e.g., Lose 5kg in 3 months, Get an A+ this semester",outcome_tip:"Imagine the most positive outcome of achieving your goal. The more vivid, the better.",outcome_example:"e.g., Feeling healthier and more confident, Receiving a scholarship",obstacle_tip:"What is the main internal obstacle (e.g., habits, emotions) that could stop you?",obstacle_example:"e.g., Feeling too tired for the gym after work, Procrastinating on difficult tasks",plan_tip:"Create a specific plan to overcome your obstacle in an 'if-then' format.",plan_example:"e.g., If I feel too tired for the gym after work, then I will change into my workout clothes and stretch for 10 minutes.",recurrence_label:"Recurrence",recurrence_tip:"Is this a goal you need to work on consistently? Set it as a recurring goal to track your streak.",recurrence_example:"e.g., Go to the gym every Mon, Wed, Fri",recurrence_option_daily:"Recurring Goal",deadline_tip:"Set a realistic deadline to stay motivated. Long-term goals without a deadline are also fine.",deadline_option_no_deadline:"No Deadline",day_names_short_picker:["M","T","W","T","F","S","S"],settings_delete_account:"Delete All Data",delete_account_header:"Delete Data",delete_account_header_desc:"This action is irreversible and will permanently delete all your goals and data.",version_update_title:"What's New",version_update_1_title:"Firebase Cloud Sync",version_update_1_desc:"Sign in with Google to save and load your goals and settings to the cloud. Sync across multiple devices.",version_update_2_title:"Auto Settings Sync",version_update_2_desc:"All settings like language, theme, and background color are saved to the cloud and applied consistently across devices.",version_update_3_title:"Secure Logout",version_update_3_desc:"All data is saved to the cloud before logout, and local data is completely deleted with automatic redirect to home.",version_update_4_title:"Status Indicator UI",version_update_4_desc:"Button states change during login, logout, and sync operations to clearly show progress."}},de={add:_.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[_.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),_.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),check:_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:_.jsx("polyline",{points:"20 6 9 17 4 12"})}),info:_.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[_.jsx("circle",{cx:"12",cy:"12",r:"10"}),_.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),_.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),delete:_.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[_.jsx("polyline",{points:"3 6 5 6 21 6"}),_.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}),_.jsx("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),_.jsx("line",{x1:"14",y1:"11",x2:"14",y2:"17"})]}),edit:_.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[_.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),_.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),close:_.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[_.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),_.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}),back:_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:_.jsx("polyline",{points:"15 18 9 12 15 6"})}),forward:_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:_.jsx("polyline",{points:"9 18 15 12 9 6"})}),calendar:_.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[_.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),_.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),_.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),_.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),list:_.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[_.jsx("line",{x1:"8",y1:"6",x2:"21",y2:"6"}),_.jsx("line",{x1:"8",y1:"12",x2:"21",y2:"12"}),_.jsx("line",{x1:"8",y1:"18",x2:"21",y2:"18"}),_.jsx("line",{x1:"3",y1:"6",x2:"3.01",y2:"6"}),_.jsx("line",{x1:"3",y1:"12",x2:"3.01",y2:"12"}),_.jsx("line",{x1:"3",y1:"18",x2:"3.01",y2:"18"})]}),settings:_.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[_.jsx("circle",{cx:"12",cy:"12",r:"3"}),_.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]}),filter:_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:_.jsx("polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"})}),ai:_.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[_.jsx("path",{d:"M12 3L14.34 8.66L20 11L14.34 13.34L12 19L9.66 13.34L4 11L9.66 8.66L12 3Z"}),_.jsx("path",{d:"M5 21L7 16"}),_.jsx("path",{d:"M19 21L17 16"})]}),flame:_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:_.jsx("path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"})}),data:_.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[_.jsx("path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83"}),_.jsx("path",{d:"M22 12A10 10 0 0 0 12 2v10z"})]}),background:_.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[_.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),_.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),_.jsx("polyline",{points:"21 15 16 10 5 21"})]}),account:_.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[_.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),_.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),exclamation:_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:_.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 15c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1zm1-4h-2V7h2v6z"})})},so=(t,e)=>{const n=new Date(t),r=new Date(e);return n.getFullYear()===r.getFullYear()&&n.getMonth()===r.getMonth()&&n.getDate()===r.getDate()},jO=(t,e)=>{if(!t)return null;const n=new Date;n.setHours(0,0,0,0);const r=new Date(t);r.setHours(0,0,0,0);const i=r.getTime()-n.getTime(),s=Math.ceil(i/(1e3*60*60*24));return s===0?e("d_day"):s>0?e("days_left").replace("{count}",String(s)):e("days_overdue").replace("{count}",String(Math.abs(s)))},WE=(t,e=1)=>{const n=new Date(t),r=n.getDay(),i=(r<e?7:0)+r-e;return n.setDate(n.getDate()-i),n.setHours(0,0,0,0),n},JE=t=>{try{const e=new TextEncoder().encode(t),n=Array.from(e).map(r=>String.fromCharCode(r)).join("");return btoa(n)}catch(e){return console.error("UTF-8 to Base64 encoding failed:",e),""}},XO=t=>{try{const e=atob(t),n=new Uint8Array(e.length);for(let r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return new TextDecoder().decode(n)}catch(e){return console.error("Base64 to UTF-8 decoding failed:",e),""}},QE=t=>{try{const n=JSON.stringify(t).replace(/\s+/g," ").trim();return JE(n)}catch(e){return console.error("Data compression failed:",e),JE(JSON.stringify(t))}},ZO=async t=>{if(t.length<1500)return t;const e=[{name:"is.gd",createUrl:async n=>{const r=await fetch(`https://is.gd/create.php?format=simple&url=${encodeURIComponent(n)}`);if(!r.ok)throw new Error("is.gd API failed");const i=await r.text();if(i.includes("Error")||!i.startsWith("http"))throw new Error("Invalid response from is.gd");return i.trim()}},{name:"tinyurl",createUrl:async n=>new Promise((r,i)=>{const s=`tinyurl_${Date.now()}`,o=document.createElement("script"),a=setTimeout(()=>{l(),i(new Error("TinyURL timeout"))},5e3),l=()=>{clearTimeout(a),o.parentNode&&document.head.removeChild(o),delete window[s]};window[s]=u=>{l(),u&&typeof u=="string"&&!u.includes("Error")&&u.startsWith("http")?r(u.trim()):i(new Error("Invalid TinyURL response"))},o.onerror=()=>{l(),i(new Error("TinyURL script load failed"))},o.src=`https://tinyurl.com/api-create.php?url=${encodeURIComponent(n)}&callback=${s}`,document.head.appendChild(o)})},{name:"v.gd",createUrl:async n=>{const r=await fetch(`https://v.gd/create.php?format=simple&url=${encodeURIComponent(n)}`);if(!r.ok)throw new Error("v.gd API failed");const i=await r.text();if(i.includes("Error")||!i.startsWith("http"))throw new Error("Invalid response from v.gd");return i.trim()}}];for(const n of e)try{console.log(`Trying ${n.name} for URL shortening...`);const r=await n.createUrl(t);return console.log(`✅ ${n.name} success:`,r),r}catch(r){console.warn(`❌ ${n.name} failed:`,r);continue}return console.warn("All URL shortening services failed, using original URL"),t},zp=[{id:"default",lightThemeClass:"bg-solid-default",darkThemeClass:"bg-solid-default",lightNameKey:"settings_bg_default",darkNameKey:"settings_bg_default_dark"},{id:"pink",lightThemeClass:"bg-solid-pink",darkThemeClass:"bg-solid-pink",lightNameKey:"settings_bg_pink",darkNameKey:"settings_bg_cherry_noir"},{id:"blue",lightThemeClass:"bg-solid-blue",darkThemeClass:"bg-solid-blue",lightNameKey:"settings_bg_blue",darkNameKey:"settings_bg_deep_ocean"},{id:"green",lightThemeClass:"bg-solid-green",darkThemeClass:"bg-solid-green",lightNameKey:"settings_bg_green",darkNameKey:"settings_bg_forest_green"},{id:"purple",lightThemeClass:"bg-solid-purple",darkThemeClass:"bg-solid-purple",lightNameKey:"settings_bg_purple",darkNameKey:"settings_bg_royal_purple"}],e3=()=>{const[t,e]=G.useState(()=>localStorage.getItem("nova-lang")||"ko"),[n,r]=G.useState([]),[i,s]=G.useState("all"),[o,a]=G.useState("manual"),[l,u]=G.useState(()=>{const q=localStorage.getItem("nova-theme");return q==="system"||!q?KE()==="dark":q==="dark"}),[f,p]=G.useState(()=>localStorage.getItem("nova-theme")||"system"),[m,v]=G.useState("default"),[I,x]=G.useState(!1),[M,A]=G.useState(null),[T,S]=G.useState(null),[V,U]=G.useState(!1),[F,C]=G.useState(!1),[E,R]=G.useState(!1),[P,N]=G.useState(null),[D,k]=G.useState(!1),[ne,ye]=G.useState(new Set),[Ce,oe]=G.useState(""),[W,ee]=G.useState("idle"),[ie,Ee]=G.useState(!1),[Ae,Ve]=G.useState(!1),[be,sn]=G.useState(!1),[st,on]=G.useState(()=>localStorage.getItem("nova-api-key")||""),[zt,hs]=G.useState(()=>localStorage.getItem("nova-offline-mode")==="true"),[ae,_n]=G.useState(null),[Kn,Wl]=G.useState(""),[oh,Hg]=G.useState(!1),[$o,pi]=G.useState(!1),[Jl,et]=G.useState(!1),[_t,_r]=G.useState(!1),[ah,fs]=G.useState(!1);G.useEffect(()=>{const q=Yb(mc,H=>{_n(H),H?(localStorage.setItem("nova-user-email",H.email||""),localStorage.setItem("nova-user-name",H.displayName||"")):(localStorage.removeItem("nova-user-email"),localStorage.removeItem("nova-user-name"))});return()=>q()},[]);const lh=G.useCallback(async()=>{pi(!0);try{const q=await gL(mc,zg);_n(q.user),oe("✅ Google 로그인 성공!"),setTimeout(async()=>{try{const{doc:H,getDoc:j}=await fu(async()=>{const{doc:ve,getDoc:Re}=await Promise.resolve().then(()=>Ou);return{doc:ve,getDoc:Re}},void 0),pe=H(Jn,"users",q.user.uid,"data","todos"),De=await j(pe);if(De.exists()){const ve=De.data();r(ve.todos||[])}const ht=H(Jn,"users",q.user.uid,"data","settings"),Ge=await j(ht);if(Ge.exists()){const ve=Ge.data();ve.language&&e(ve.language),ve.themeMode&&p(ve.themeMode),ve.isDarkMode!==void 0&&u(ve.isDarkMode),ve.backgroundTheme&&v(ve.backgroundTheme)}oe("✅ 로그인 완료! 데이터 로드됨")}catch(H){console.error("데이터 로드 실패:",H),oe("⚠️ 로그인은 성공했으나 데이터 로드 실패")}pi(!1),setTimeout(()=>oe(""),3e3)},500),setTimeout(()=>oe(""),3e3)}catch(q){console.error("Google 로그인 오류:",q),q.code!=="auth/popup-closed-by-user"&&(oe("❌ 로그인 실패: "+q.message),setTimeout(()=>oe(""),3e3)),pi(!1)}},[]),mi=G.useCallback(async()=>{et(!0);try{if(ae){oe("⏳ 데이터 저장 중...");const q=n.filter(Ge=>Ge!=null),{doc:H,setDoc:j,serverTimestamp:pe}=await fu(async()=>{const{doc:Ge,setDoc:ve,serverTimestamp:Re}=await Promise.resolve().then(()=>Ou);return{doc:Ge,setDoc:ve,serverTimestamp:Re}},void 0),De=H(Jn,"users",ae.uid,"data","todos");await j(De,{todos:q,lastSyncTime:pe(),totalGoals:q.length,syncedAt:new Date().toISOString()});const ht=H(Jn,"users",ae.uid,"data","settings");await j(ht,{language:t,themeMode:f,isDarkMode:l,backgroundTheme:m,updatedAt:pe()})}await jb(mc),_n(null),r([]),e("ko"),v("default"),p("system"),u(KE()==="dark"),A(null),U(!1),x(!1),oe("✅ 로그아웃 완료"),setTimeout(()=>oe(""),3e3),et(!1)}catch(q){console.error("로그아웃 오류:",q),oe("❌ 로그아웃 실패"),setTimeout(()=>oe(""),3e3),et(!1)}},[ae,n,t,f,l,m]),Ql=G.useCallback(async()=>{if(!ae){oe("❌ 먼저 로그인해주세요"),setTimeout(()=>oe(""),3e3);return}_r(!0);try{const q=n.filter(Ge=>Ge!=null),{doc:H,setDoc:j,serverTimestamp:pe}=await fu(async()=>{const{doc:Ge,setDoc:ve,serverTimestamp:Re}=await Promise.resolve().then(()=>Ou);return{doc:Ge,setDoc:ve,serverTimestamp:Re}},void 0),De=H(Jn,"users",ae.uid,"data","todos");await j(De,{todos:q,lastSyncTime:pe(),totalGoals:q.length,syncedAt:new Date().toISOString()});const ht=H(Jn,"users",ae.uid,"data","settings");await j(ht,{language:t,themeMode:f,isDarkMode:l,backgroundTheme:m,updatedAt:pe()}),oe("✅ 데이터 동기화 완료! (목표: "+q.length+"개, 설정 저장)"),setTimeout(()=>oe(""),3e3),_r(!1)}catch(q){console.error("동기화 오류:",q),oe("❌ 동기화 실패: "+q.message),setTimeout(()=>oe(""),3e3),_r(!1)}},[ae,n,t,f,l,m]),Yl=G.useCallback(async()=>{var q;if(!ae){oe("❌ 먼저 로그인해주세요"),setTimeout(()=>oe(""),3e3);return}fs(!0);try{const{doc:H,getDoc:j}=await fu(async()=>{const{doc:Re,getDoc:Wo}=await Promise.resolve().then(()=>Ou);return{doc:Re,getDoc:Wo}},void 0),pe=H(Jn,"users",ae.uid,"data","todos"),De=await j(pe);if(De.exists()){const Re=De.data();r(Re.todos||[])}const ht=H(Jn,"users",ae.uid,"data","settings"),Ge=await j(ht);if(Ge.exists()){const Re=Ge.data();Re.language&&e(Re.language),Re.themeMode&&p(Re.themeMode),Re.isDarkMode!==void 0&&u(Re.isDarkMode),Re.backgroundTheme&&v(Re.backgroundTheme)}const ve=De.exists()&&((q=De.data().todos)==null?void 0:q.length)||0;oe("✅ 데이터 로드 완료! (목표: "+ve+"개, 설정 로드됨)"),setTimeout(()=>oe(""),3e3),fs(!1)}catch(H){console.error("로드 오류:",H),oe("❌ 로드 실패: "+H.message),setTimeout(()=>oe(""),3e3),fs(!1)}},[ae]),ce=G.useCallback(q=>YO[t][q]||q,[t]),ps=G.useCallback(q=>{const H=q||st;if(zt||!H)return null;try{return new AV({apiKey:H})}catch(j){return console.error("Failed to create AI instance:",j),null}},[st,zt]),uh=G.useCallback(q=>{p(q)},[]),ms=G.useMemo(()=>[ce("empty_encouragement_1"),ce("empty_encouragement_2"),ce("empty_encouragement_3"),ce("empty_encouragement_4")],[ce]),jl=G.useMemo(()=>ms[Math.floor(Math.random()*ms.length)],[ms]);G.useEffect(()=>{const q=localStorage.getItem("nova-todos"),H=localStorage.getItem("nova-dark-mode"),j=localStorage.getItem("nova-background"),pe=localStorage.getItem("nova-sort-type");if(q){const De=JSON.parse(q),ht=new Date().toISOString(),Ge=De.map(ve=>ve.isRecurring&&ve.lastCompletedDate&&!so(ht,ve.lastCompletedDate)?{...ve,completed:!1}:ve);r(Ge)}H&&u(JSON.parse(H)),j&&v(j),pe&&a(pe)},[]),G.useEffect(()=>{const H=new URLSearchParams(window.location.search).get("data");if(H)try{const j=XO(H),pe=JSON.parse(j);if(Array.isArray(pe)&&(pe.length===0||"wish"in pe[0]&&"id"in pe[0]))N({title:ce("url_import_title"),message:ce("url_import_message"),confirmText:ce("url_import_confirm"),cancelText:ce("cancel_button"),onConfirm:()=>{r(pe),oe(ce("url_import_success")),window.history.replaceState({},document.title,window.location.pathname)},onCancel:()=>{window.history.replaceState({},document.title,window.location.pathname)}});else throw new Error("Invalid data format")}catch(j){console.error("Failed to parse data from URL",j),N({title:ce("import_error_alert_title"),message:ce("url_import_error")}),window.history.replaceState({},document.title,window.location.pathname)}},[ce]),G.useEffect(()=>{const q=window.matchMedia("(prefers-color-scheme: dark)"),H=j=>{f==="system"&&u(j.matches)};return u(f==="system"?q.matches:f==="dark"),q.addEventListener("change",H),()=>q.removeEventListener("change",H)},[f]),G.useEffect(()=>{(()=>{const H=localStorage.getItem("pwa-prompt-dismissed"),j=WO(),pe=JO();if(j&&!pe&&!H){const De=setTimeout(()=>{sn(!0)},3e3);return()=>clearTimeout(De)}})()},[]),G.useEffect(()=>{"serviceWorker"in navigator&&navigator.serviceWorker.register("/Nova-AI-Planer/sw.js").then(q=>{console.log("SW registered: ",q)}).catch(q=>{console.log("SW registration failed: ",q)})},[]),G.useEffect(()=>{localStorage.setItem("nova-theme",f),localStorage.setItem("nova-dark-mode",JSON.stringify(l))},[f,l]),G.useEffect(()=>{localStorage.setItem("nova-lang",t)},[t]),G.useEffect(()=>{localStorage.setItem("nova-todos",JSON.stringify(n))},[n]),G.useEffect(()=>{localStorage.setItem("nova-api-key",st)},[st]),G.useEffect(()=>{localStorage.setItem("nova-offline-mode",String(zt))},[zt]),G.useEffect(()=>{const q=zp.find(j=>j.id===m)||zp[0],H=l?q.darkThemeClass:q.lightThemeClass;document.body.className="",l&&document.body.classList.add("dark-mode"),H&&document.body.classList.add(H),localStorage.setItem("nova-background",m)},[m,l]),G.useEffect(()=>{localStorage.setItem("nova-sort-type",o)},[o]),G.useEffect(()=>{if(Ce){const q=setTimeout(()=>oe(""),3e3);return()=>clearTimeout(q)}},[Ce]);const gi=G.useMemo(()=>{let q=[...n];return o==="deadline"?q.sort((H,j)=>!H.deadline&&!j.deadline?0:H.deadline?j.deadline?new Date(H.deadline).getTime()-new Date(j.deadline).getTime():-1:1):o==="newest"?q.sort((H,j)=>j.id-H.id):o==="alphabetical"&&q.sort((H,j)=>H.wish.localeCompare(j.wish)),i==="active"?q.filter(H=>!H.completed):i==="completed"?q.filter(H=>H.completed):q},[n,i,o]),zo=q=>{const H={...q,id:Date.now(),completed:!1,lastCompletedDate:null,streak:0};r(j=>[H,...j]),x(!1)},Ho=q=>{const H=q.map((j,pe)=>({...j,id:Date.now()+pe,completed:!1,lastCompletedDate:null,streak:0})).reverse();r(j=>[...H,...j]),x(!1)},Wn=q=>{r(n.map(H=>H.id===q.id?q:H)),A(null)},Xl=q=>{r(n.filter(H=>H.id!==q))},gs=q=>{const H=new Date().toISOString();r(n.map(j=>{if(j.id===q){const pe=!j.completed;let De=j.streak;return j.isRecurring&&(pe?(!j.lastCompletedDate||!so(H,j.lastCompletedDate))&&(De=(j.streak||0)+1):j.lastCompletedDate&&so(H,j.lastCompletedDate)&&(De=Math.max(0,(j.streak||1)-1))),{...j,completed:pe,lastCompletedDate:pe?H:j.lastCompletedDate,streak:De}}return j}))},Zl=async q=>{if(q==="ai"){if(n.length<2){N({title:ce("sort_alert_title"),message:ce("sort_alert_message")});return}C(!0);try{const H=ps();if(!H){oe(zt?"오프라인 모드에서는 AI 정렬을 사용할 수 없습니다.":"AI 정렬을 사용하려면 설정에서 API 키를 입력해주세요."),C(!1),a("manual");return}const j=`Here is a list of goals with their details (wish, outcome, obstacle, plan, deadline). Prioritize them based on urgency (closer deadline), importance (based on outcome), and feasibility (based on plan). Return a JSON object with a single key "sorted_ids" which is an array of the goal IDs in the recommended order. Do not include any other text or explanations. Goals: ${JSON.stringify(n.map(({id:tt,wish:tu,outcome:nu,obstacle:Jo,plan:Qo,deadline:ru})=>({id:tt,wish:tu,outcome:nu,obstacle:Jo,plan:Qo,deadline:ru})))}`,pe=await H.models.generateContent({model:"gemini-2.5-flash",contents:j,config:{responseMimeType:"application/json",responseSchema:{type:Sn.OBJECT,properties:{sorted_ids:{type:Sn.ARRAY,items:{type:Sn.NUMBER}}}}}}),ht=JSON.parse(pe.text).sorted_ids.map(Number),Ge=new Map(n.map(tt=>[Number(tt.id),tt])),ve=ht.map(tt=>Ge.get(tt)).filter(Boolean),Re=n.filter(tt=>!ht.includes(Number(tt.id))),Wo=[...ve,...Re].map(tt=>({...tt,id:Number(tt.id)}));r(Wo),a("manual")}catch(H){console.error("AI sort failed:",H),N({title:ce("ai_sort_error_title"),message:ce("ai_sort_error_message")})}finally{C(!1)}}else a(q)},_i=q=>{const H=new Set(ne);H.has(q)?H.delete(q):H.add(q),ye(H)},Ko=()=>{k(!1),ye(new Set)},yt=()=>{const q=ne.size;N({title:ce("delete_selected_confirm_title"),message:ce("delete_selected_confirm_message").replace("{count}",String(q)),isDestructive:!0,confirmText:ce("delete_selected_button_label").replace("{count}",String(q)),cancelText:ce("cancel_button"),onConfirm:()=>{r(n.filter(H=>!ne.has(H.id))),Ko()}})},eu=()=>{ee("exporting");const q=JSON.stringify(n,null,2),H="data:application/json;charset=utf-8,"+encodeURIComponent(q),j="nova_goals.json",pe=document.createElement("a");pe.setAttribute("href",H),pe.setAttribute("download",j),pe.click(),setTimeout(()=>{ee("idle"),U(!1)},1500)},yi=q=>{var pe;const H=(pe=q.target.files)==null?void 0:pe[0];if(!H)return;const j=new FileReader;j.onload=De=>{var ht;try{const Ge=(ht=De.target)==null?void 0:ht.result;if(typeof Ge!="string")throw new Error("File content is not a string");const ve=JSON.parse(Ge);if(Array.isArray(ve)&&ve.every(Re=>"wish"in Re&&"id"in Re))N({title:ce("import_confirm_title"),message:ce("import_confirm_message"),confirmText:ce("settings_import_data"),cancelText:ce("cancel_button"),onConfirm:()=>{ee("importing"),setTimeout(()=>{r(ve),oe(ce("import_success_toast")),ee("idle"),U(!1)},1500)}});else throw new Error("Invalid file format")}catch{N({title:ce("import_error_alert_title"),message:ce("import_error_alert_message")})}},j.onerror=()=>N({title:ce("import_error_alert_title"),message:ce("import_error_alert_message")}),j.readAsText(H),q.target.value=""},vi=()=>{ee("deleting"),setTimeout(()=>{r([]),e("ko"),u(!0),v("default"),a("manual"),localStorage.clear(),ee("idle"),U(!1)},1500)},ch=I||!!M||!!T||V||!!P||ie||Ae;return _.jsxs("div",{className:`main-page-layout ${E?"calendar-view-active":""}`,children:[_.jsx("div",{className:`page-content ${ch?"modal-open":""}`,children:_.jsxs("div",{className:"container",children:[_.jsx(t3,{t:ce,isSelectionMode:D,selectedCount:ne.size,onCancelSelection:Ko,onDeleteSelected:yt,isViewModeCalendar:E,onToggleViewMode:()=>R(!E),isAiSorting:F,sortType:o,onSort:Zl,filter:i,onFilter:s,onSetSelectionMode:()=>k(!0),onOpenSettings:()=>U(!0),onAddGoal:()=>x(!0)}),E?_.jsx(c3,{todos:n,t:ce,onGoalClick:S,language:t}):_.jsx(n3,{todos:gi,onToggleComplete:gs,onDelete:Xl,onEdit:A,onInfo:S,t:ce,filter:i,randomEncouragement:jl,isSelectionMode:D,selectedTodoIds:ne,onSelectTodo:_i})]})}),I&&_.jsx(YE,{onClose:()=>x(!1),onAddTodo:zo,onAddMultipleTodos:Ho,t:ce,language:t,createAI:ps}),M&&_.jsx(YE,{onClose:()=>A(null),onEditTodo:Wn,existingTodo:M,t:ce,language:t,createAI:ps}),T&&_.jsx(o3,{todo:T,onClose:()=>S(null),t:ce,createAI:ps}),V&&_.jsx(a3,{onClose:()=>U(!1),isDarkMode:l,onToggleDarkMode:()=>u(!l),themeMode:f,onThemeChange:uh,backgroundTheme:m,onSetBackgroundTheme:v,onExportData:eu,onImportData:yi,setAlertConfig:N,onDeleteAllData:vi,dataActionStatus:W,language:t,onSetLanguage:e,t:ce,todos:n,setToastMessage:oe,onOpenVersionInfo:()=>Ee(!0),onOpenUsageGuide:()=>Ve(!0),apiKey:st,onSetApiKey:on,isOfflineMode:zt,onToggleOfflineMode:()=>hs(!zt),googleUser:ae,onGoogleLogin:lh,onGoogleLogout:mi,onSyncDataToFirebase:Ql,onLoadDataFromFirebase:Yl,isGoogleLoggingIn:$o,isGoogleLoggingOut:Jl,isSyncingData:_t,isLoadingData:ah}),ie&&_.jsx(l3,{onClose:()=>Ee(!1),t:ce}),Ae&&_.jsx(u3,{onClose:()=>Ve(!1),t:ce}),P&&_.jsx(d3,{title:P.title,message:P.message,onConfirm:()=>{var q;(q=P.onConfirm)==null||q.call(P),N(null)},onCancel:P.onCancel?()=>{var q;(q=P.onCancel)==null||q.call(P),N(null)}:void 0,confirmText:P.confirmText,cancelText:P.cancelText,isDestructive:P.isDestructive,t:ce}),Ce&&_.jsx("div",{className:"toast-notification",children:Ce}),be&&_.jsx(QO,{onClose:()=>sn(!1)})]})},t3=({t,isSelectionMode:e,selectedCount:n,onCancelSelection:r,onDeleteSelected:i,isViewModeCalendar:s,onToggleViewMode:o,isAiSorting:a,sortType:l,onSort:u,filter:f,onFilter:p,onSetSelectionMode:m,onOpenSettings:v,onAddGoal:I})=>{const[x,M]=G.useState(!1);G.useEffect(()=>{const S=()=>{M(!1)};return document.addEventListener("click",S),document.addEventListener("touchstart",S),()=>{document.removeEventListener("click",S),document.removeEventListener("touchstart",S)}},[]);const A=S=>{S.stopPropagation(),M(V=>!V)},T=S=>{S.stopPropagation()};return _.jsxs("header",{children:[_.jsx("div",{className:"header-left",children:e&&_.jsx("button",{onClick:r,className:"header-action-button",children:t("cancel_selection_button_label")})}),_.jsxs("div",{className:"header-title-group",children:[_.jsx("h1",{children:t("my_goals_title")}),!e&&_.jsxs("div",{className:"header-inline-actions",children:[_.jsx("button",{onClick:o,className:"header-icon-button","aria-label":t(s?"list_view_button_aria":"calendar_view_button_aria"),children:s?de.list:de.calendar}),_.jsxs("div",{className:"filter-sort-container",children:[_.jsx("button",{onClick:A,onTouchStart:A,className:"header-icon-button","aria-label":t("filter_sort_button_aria"),children:a?_.jsx("div",{className:"spinner"}):de.filter}),x&&_.jsxs("div",{className:"profile-popover filter-sort-popover",onClick:T,onTouchStart:T,children:[_.jsx("div",{className:"popover-section",children:_.jsx("button",{onClick:()=>{m(),M(!1)},className:"popover-action-button",children:_.jsx("span",{children:t("select_button_label")})})}),_.jsxs("div",{className:"popover-section",children:[_.jsx("h4",{children:t("filter_title")}),_.jsxs("button",{onClick:()=>{p("all")},className:`popover-action-button ${f==="all"?"active":""}`,children:[_.jsx("span",{children:t("filter_all")}),f==="all"&&de.check]}),_.jsxs("button",{onClick:()=>{p("active")},className:`popover-action-button ${f==="active"?"active":""}`,children:[_.jsx("span",{children:t("filter_active")}),f==="active"&&de.check]}),_.jsxs("button",{onClick:()=>{p("completed")},className:`popover-action-button ${f==="completed"?"active":""}`,children:[_.jsx("span",{children:t("filter_completed")}),f==="completed"&&de.check]})]}),_.jsxs("div",{className:"popover-section",children:[_.jsx("h4",{children:t("sort_title")}),_.jsxs("button",{onClick:()=>{u("manual")},className:`popover-action-button ${l==="manual"?"active":""}`,children:[_.jsx("span",{children:t("sort_label_manual")}),l==="manual"&&de.check]}),_.jsxs("button",{onClick:()=>{u("deadline")},className:`popover-action-button ${l==="deadline"?"active":""}`,children:[_.jsx("span",{children:t("sort_label_deadline")}),l==="deadline"&&de.check]}),_.jsxs("button",{onClick:()=>{u("newest")},className:`popover-action-button ${l==="newest"?"active":""}`,children:[_.jsx("span",{children:t("sort_label_newest")}),l==="newest"&&de.check]}),_.jsxs("button",{onClick:()=>{u("alphabetical")},className:`popover-action-button ${l==="alphabetical"?"active":""}`,children:[_.jsx("span",{children:t("sort_label_alphabetical")}),l==="alphabetical"&&de.check]}),_.jsxs("button",{onClick:()=>{u("ai")},className:"popover-action-button with-icon",children:[_.jsx("span",{className:"popover-button-icon",children:de.ai}),_.jsx("span",{children:t(a?"ai_sorting_button":"sort_label_ai")})]})]})]})]}),_.jsx("button",{onClick:v,className:"header-icon-button","aria-label":t("settings_title"),children:de.settings})]})]}),_.jsx("div",{className:"header-right",children:e?_.jsx("button",{onClick:i,className:"header-action-button destructive",children:t("delete_selected_button_label").replace("{count}",String(n))}):_.jsx(_.Fragment,{children:_.jsx("button",{onClick:I,className:"header-icon-button","aria-label":t("add_new_goal_button_label"),children:de.add})})})]})},n3=({todos:t,onToggleComplete:e,onDelete:n,onEdit:r,onInfo:i,t:s,filter:o,randomEncouragement:a,isSelectionMode:l,selectedTodoIds:u,onSelectTodo:f})=>{if(t.length===0){const p=`empty_message_${o}`;return _.jsxs("div",{className:"empty-message",children:[_.jsx("p",{children:s(p)}),o==="all"&&_.jsx("span",{children:a})]})}return _.jsx("ul",{children:t.map(p=>_.jsx(r3,{todo:p,onToggleComplete:e,onDelete:n,onEdit:r,onInfo:i,t:s,isSelectionMode:l,isSelected:u.has(p.id),onSelect:f},p.id))})},r3=aI.memo(({todo:t,onToggleComplete:e,onDelete:n,onEdit:r,onInfo:i,t:s,isSelectionMode:o,isSelected:a,onSelect:l})=>{const u=()=>{o&&l(t.id)};return _.jsx("li",{className:`${t.completed?"completed":""} ${o?"selection-mode":""} ${a?"selected":""}`,onClick:u,children:_.jsxs("div",{className:"swipeable-content",children:[_.jsxs("label",{className:"checkbox-container",onClick:f=>f.stopPropagation(),children:[_.jsx("input",{type:"checkbox",checked:t.completed,onChange:()=>e(t.id)}),_.jsx("span",{className:"checkmark"})]}),_.jsxs("div",{className:"todo-text-with-streak",children:[_.jsx("span",{className:"todo-text",children:t.wish}),t.isRecurring&&t.streak>0&&_.jsxs("div",{className:"streak-indicator",children:[de.flame,_.jsx("span",{children:t.streak})]})]}),_.jsxs("div",{className:"todo-actions-and-meta",children:[_.jsx("div",{className:"todo-meta-badges",children:t.deadline&&_.jsx("span",{className:"todo-deadline",children:jO(t.deadline,s)})}),_.jsxs("div",{className:"todo-buttons",children:[_.jsx("button",{onClick:f=>{f.stopPropagation(),r(t)},className:"info-button edit-button","aria-label":s("edit_button_aria"),children:de.edit}),_.jsx("button",{onClick:f=>{f.stopPropagation(),n(t.id)},className:"delete-button","aria-label":s("delete_button"),children:de.delete}),_.jsx("button",{onClick:f=>{f.stopPropagation(),i(t)},className:"info-button","aria-label":s("info_button_aria"),children:de.info})]})]})]})})}),Hl=({onClose:t,children:e,className:n="",isClosing:r})=>_.jsx("div",{className:`modal-backdrop ${r?"is-closing":""}`,onClick:t,children:_.jsx("div",{className:`modal-content ${n} ${r?"is-closing":""}`,onClick:i=>i.stopPropagation(),children:e})}),Kl=t=>{const[e,n]=G.useState(!1);return[e,()=>{n(!0),setTimeout(t,500)}]},i3=({step:t,t:e,createAI:n,...r})=>{const{wish:i,setWish:s,outcome:o,setOutcome:a,obstacle:l,setObstacle:u,plan:f,setPlan:p,isRecurring:m,setIsRecurring:v,recurringDays:I,setRecurringDays:x,deadline:M,setDeadline:A,noDeadline:T,setNoDeadline:S,errors:V,language:U}=r,[F,C]=G.useState(!1),[E,R]=G.useState(""),[P,N]=G.useState(""),D=async(k,ne)=>{if(ne){C(!0),R(""),N("");try{const ye=n();if(!ye){N("AI 기능을 사용하려면 설정에서 API 키를 입력해주세요."),C(!1);return}const Ce=`Provide concise, actionable feedback on this part of a WOOP goal: ${k} - "${ne}". The feedback should be helpful and encouraging, in ${U==="ko"?"Korean":"English"}. Keep it to 1-2 sentences.`,oe=await ye.models.generateContent({model:"gemini-2.5-flash",contents:Ce});R(oe.text)}catch(ye){console.error("AI Feedback Error:",ye),N("Failed to get AI feedback.")}finally{C(!1)}}};switch(t){case 1:return _.jsxs("div",{children:[_.jsx("h3",{children:e("wish_label")}),_.jsxs("div",{className:"step-guidance",children:[_.jsx("p",{className:"tip",children:e("wish_tip")}),_.jsx("p",{className:"example",children:e("wish_example")})]}),_.jsx("textarea",{value:i,onChange:ne=>{s(ne.target.value),R(""),N("")},placeholder:e("wish_label"),className:V.wish?"input-error":"",rows:3}),V.wish&&_.jsxs("p",{className:"field-error-message",children:[de.exclamation," ",e("error_wish_required")]}),_.jsxs("div",{className:"ai-feedback-section",children:[_.jsxs("button",{onClick:()=>D("Wish",i),disabled:!i.trim()||F,className:"ai-feedback-button",children:[F?_.jsx("div",{className:"spinner-small"}):"🤖",_.jsx("span",{children:e(F?"ai_analyzing":"ai_coach_suggestion")})]}),E&&_.jsx("div",{className:"ai-feedback-bubble",children:E}),P&&_.jsx("div",{className:"ai-feedback-bubble error",children:P})]})]});case 2:return _.jsxs("div",{children:[_.jsx("h3",{children:e("outcome_label")}),_.jsxs("div",{className:"step-guidance",children:[_.jsx("p",{className:"tip",children:e("outcome_tip")}),_.jsx("p",{className:"example",children:e("outcome_example")})]}),_.jsx("textarea",{value:o,onChange:ne=>{a(ne.target.value),R(""),N("")},placeholder:e("outcome_label"),className:V.outcome?"input-error":"",rows:3}),V.outcome&&_.jsxs("p",{className:"field-error-message",children:[de.exclamation," ",e("error_outcome_required")]}),_.jsxs("div",{className:"ai-feedback-section",children:[_.jsxs("button",{onClick:()=>D("Outcome",o),disabled:!o.trim()||F,className:"ai-feedback-button",children:[F?_.jsx("div",{className:"spinner-small"}):"🤖",_.jsx("span",{children:e(F?"ai_analyzing":"ai_coach_suggestion")})]}),E&&_.jsx("div",{className:"ai-feedback-bubble",children:E}),P&&_.jsx("div",{className:"ai-feedback-bubble error",children:P})]})]});case 3:return _.jsxs("div",{children:[_.jsx("h3",{children:e("obstacle_label")}),_.jsxs("div",{className:"step-guidance",children:[_.jsx("p",{className:"tip",children:e("obstacle_tip")}),_.jsx("p",{className:"example",children:e("obstacle_example")})]}),_.jsx("textarea",{value:l,onChange:ne=>{u(ne.target.value),R(""),N("")},placeholder:e("obstacle_label"),className:V.obstacle?"input-error":"",rows:3}),V.obstacle&&_.jsxs("p",{className:"field-error-message",children:[de.exclamation," ",e("error_obstacle_required")]}),_.jsxs("div",{className:"ai-feedback-section",children:[_.jsxs("button",{onClick:()=>D("Obstacle",l),disabled:!l.trim()||F,className:"ai-feedback-button",children:[F?_.jsx("div",{className:"spinner-small"}):"🤖",_.jsx("span",{children:e(F?"ai_analyzing":"ai_coach_suggestion")})]}),E&&_.jsx("div",{className:"ai-feedback-bubble",children:E}),P&&_.jsx("div",{className:"ai-feedback-bubble error",children:P})]})]});case 4:return _.jsxs("div",{children:[_.jsx("h3",{children:e("plan_label")}),_.jsxs("div",{className:"step-guidance",children:[_.jsx("p",{className:"tip",children:e("plan_tip")}),_.jsx("p",{className:"example",children:e("plan_example")})]}),_.jsx("textarea",{value:f,onChange:ne=>{p(ne.target.value),R(""),N("")},placeholder:e("plan_label"),className:V.plan?"input-error":"",rows:3}),V.plan&&_.jsxs("p",{className:"field-error-message",children:[de.exclamation," ",e("error_plan_required")]}),_.jsxs("div",{className:"ai-feedback-section",children:[_.jsxs("button",{onClick:()=>D("Plan",f),disabled:!f.trim()||F,className:"ai-feedback-button",children:[F?_.jsx("div",{className:"spinner-small"}):"🤖",_.jsx("span",{children:e(F?"ai_analyzing":"ai_coach_suggestion")})]}),E&&_.jsx("div",{className:"ai-feedback-bubble",children:E}),P&&_.jsx("div",{className:"ai-feedback-bubble error",children:P})]})]});case 5:const k=ne=>{const ye=[...I],Ce=ye.indexOf(ne);Ce>-1?ye.splice(Ce,1):ye.push(ne),x(ye)};return _.jsxs("div",{children:[_.jsxs("h3",{children:[e("recurrence_label")," & ",e("deadline_label")]}),_.jsxs("div",{className:"step-guidance",children:[_.jsx("p",{className:"tip",children:e("recurrence_tip")}),_.jsx("p",{className:"example",children:e("recurrence_example")})]}),_.jsxs("label",{className:"settings-item standalone-toggle",children:[_.jsx("span",{style:{fontWeight:500},children:e("recurrence_option_daily")}),_.jsxs("label",{className:"theme-toggle-switch",children:[_.jsx("input",{type:"checkbox",checked:m,onChange:ne=>v(ne.target.checked)}),_.jsx("span",{className:"slider round"})]})]}),m&&_.jsx("div",{className:"day-picker",children:e("day_names_short_picker").map((ne,ye)=>_.jsx("button",{onClick:()=>k(ye),className:`day-button ${I.includes(ye)?"selected":""}`,children:ne},ye))}),V.recurringDays&&_.jsxs("p",{className:"field-error-message",children:[de.exclamation," ",e("error_day_required")]}),_.jsx("hr",{}),_.jsx("div",{className:"step-guidance",style:{marginTop:"16px"},children:_.jsx("p",{className:"tip",children:e("deadline_tip")})}),_.jsxs("label",{className:"settings-item standalone-toggle",children:[_.jsx("span",{style:{fontWeight:500},children:e("deadline_option_no_deadline")}),_.jsxs("label",{className:"theme-toggle-switch",children:[_.jsx("input",{type:"checkbox",checked:T,onChange:ne=>S(ne.target.checked)}),_.jsx("span",{className:"slider round"})]})]}),!T&&_.jsx("input",{type:"date",value:M,onChange:ne=>A(ne.target.value),className:V.deadline?"input-error":"",style:{marginTop:"12px"}}),V.deadline&&_.jsxs("p",{className:"field-error-message",children:[de.exclamation," ",e("error_deadline_required")]})]});default:return null}},s3=({onGenerate:t,t:e})=>{const[n,r]=G.useState(""),[i,s]=G.useState(""),[o,a]=G.useState(""),[l,u]=G.useState(""),[f,p]=G.useState(""),{endDate:m,generatedCount:v}=G.useMemo(()=>{const x=parseInt(i,10),M=parseInt(o,10);if(!l||!x||x<=0||!M||M<=0)return{endDate:"",generatedCount:0};const A=Math.ceil(x/M),T=new Date(l),S=new Date(T);return S.setDate(T.getDate()+A-1),{endDate:S.toISOString().split("T")[0],generatedCount:A}},[i,o,l]),I=()=>{const x=parseInt(i,10),M=parseInt(o,10);if(!n.trim()||!l||!x||x<=0||!M||M<=0){p(e("automation_error_all_fields"));return}const A=[],T=Math.ceil(x/M),S=new Date(l);for(let V=0;V<T;V++){const U=new Date(S);U.setDate(S.getDate()+V);const F=V*M+1,C=Math.min((V+1)*M,x),E=`${n.trim()} ${F}`+(C>F?` - ${C}`:"");A.push({wish:E,outcome:"",obstacle:"",plan:"",isRecurring:!1,recurringDays:[],deadline:U.toISOString().split("T")[0]})}p(""),t(A)};return _.jsxs("div",{className:"automation-form-container",children:[_.jsx("h3",{children:e("automation_title")}),_.jsxs("div",{className:"form-group",children:[_.jsx("label",{children:e("automation_base_name_label")}),_.jsx("input",{type:"text",value:n,onChange:x=>r(x.target.value),placeholder:e("automation_base_name_placeholder")})]}),_.jsxs("div",{className:"automation-form-grid",children:[_.jsxs("div",{className:"form-group",children:[_.jsx("label",{children:e("automation_total_units_label")}),_.jsx("input",{type:"number",value:i,onChange:x=>s(x.target.value),placeholder:e("automation_total_units_placeholder")})]}),_.jsxs("div",{className:"form-group",children:[_.jsx("label",{children:e("automation_units_per_day_label")}),_.jsx("input",{type:"number",value:o,onChange:x=>a(x.target.value),placeholder:"예: 5"})]})]}),_.jsxs("div",{className:"automation-form-grid",children:[_.jsxs("div",{className:"form-group",children:[_.jsx("label",{children:e("automation_start_date_label")}),_.jsx("input",{type:"date",value:l,onChange:x=>u(x.target.value)})]}),_.jsxs("div",{className:"form-group",children:[_.jsx("label",{children:e("automation_end_date_label")}),_.jsx("input",{type:"date",value:m,readOnly:!0})]})]}),f&&_.jsxs("p",{className:"field-error-message",style:{justifyContent:"center"},children:[de.exclamation," ",f]}),_.jsx("div",{className:"goal-assistant-nav",children:_.jsx("button",{onClick:I,className:"primary",disabled:v===0,children:e("automation_generate_button").replace("{count}",String(v))})})]})},YE=({onClose:t,onAddTodo:e,onAddMultipleTodos:n,onEditTodo:r,existingTodo:i,t:s,language:o,createAI:a})=>{const[l,u]=Kl(t),[f,p]=G.useState("woop"),[m,v]=G.useState(1),[I,x]=G.useState("forward"),[M,A]=G.useState((i==null?void 0:i.wish)||""),[T,S]=G.useState((i==null?void 0:i.outcome)||""),[V,U]=G.useState((i==null?void 0:i.obstacle)||""),[F,C]=G.useState((i==null?void 0:i.plan)||""),[E,R]=G.useState((i==null?void 0:i.isRecurring)||!1),[P,N]=G.useState((i==null?void 0:i.recurringDays)||[]),[D,k]=G.useState((i==null?void 0:i.deadline)||""),[ne,ye]=G.useState(!(i!=null&&i.deadline)),[Ce,oe]=G.useState({}),W=5,ee=Ve=>{const be={};return Ve===1&&!M.trim()&&(be.wish=!0),Ve===2&&!T.trim()&&(be.outcome=!0),Ve===3&&!V.trim()&&(be.obstacle=!0),Ve===4&&!F.trim()&&(be.plan=!0),Ve===5&&(!ne&&!D&&(be.deadline=!0),E&&P.length===0&&(be.recurringDays=!0)),oe(be),Object.keys(be).length===0},ie=()=>{ee(m)&&(m<W?(x("forward"),v(Ve=>Ve+1)):Ae())},Ee=()=>{m>1&&(x("backward"),v(Ve=>Ve-1))},Ae=()=>{if(!ee(5))return;const Ve={wish:M,outcome:T,obstacle:V,plan:F,isRecurring:E,recurringDays:P,deadline:ne?"":D};i&&r?r({...i,...Ve}):e&&e(Ve)};return _.jsxs(Hl,{onClose:u,isClosing:l,className:"goal-assistant-modal",children:[_.jsxs("div",{className:"goal-assistant-header",children:[_.jsx("div",{className:"goal-assistant-header-left",children:m>1&&f==="woop"&&_.jsx("button",{onClick:Ee,className:"settings-back-button",children:de.back})}),_.jsx("h2",{children:s("goal_assistant_title")}),_.jsx("div",{className:"goal-assistant-header-right",children:_.jsx("button",{onClick:u,className:"close-button",children:de.close})})]}),!i&&_.jsx("div",{className:"modal-mode-switcher-container",children:_.jsxs("div",{className:"modal-mode-switcher",children:[_.jsx("button",{onClick:()=>p("woop"),className:f==="woop"?"active":"",children:s("goal_assistant_mode_woop")}),_.jsx("button",{onClick:()=>p("automation"),className:f==="automation"?"active":"",children:s("goal_assistant_mode_automation")})]})}),_.jsx("div",{className:"goal-assistant-body",children:f==="woop"?_.jsxs(_.Fragment,{children:[_.jsx("div",{className:"progress-bar-container",children:_.jsx("div",{className:"progress-bar",style:{width:`${m/W*100}%`}})}),_.jsx("div",{className:`goal-assistant-step-content-animator ${I}`,children:_.jsx(i3,{step:m,t:s,createAI:a,wish:M,setWish:A,outcome:T,setOutcome:S,obstacle:V,setObstacle:U,plan:F,setPlan:C,isRecurring:E,setIsRecurring:R,recurringDays:P,setRecurringDays:N,deadline:D,setDeadline:k,noDeadline:ne,setNoDeadline:ye,errors:Ce,language:o})},m),_.jsxs("div",{className:"goal-assistant-nav",children:[m>1?_.jsx("button",{onClick:Ee,className:"secondary",children:s("back_button")}):_.jsx("div",{}),_.jsx("button",{onClick:ie,className:"primary",children:s(m===W?i?"save_button":"add_button":"next_button")})]})]}):n&&_.jsx(s3,{onGenerate:n,t:s})})]})},o3=({todo:t,onClose:e,t:n,createAI:r})=>{const[i,s]=Kl(e),[o,a]=G.useState(""),[l,u]=G.useState(!1),[f,p]=G.useState(!1),m=async()=>{u(!0),a(""),p(!1);try{const v=r();if(!v){a("AI 기능을 사용하려면 설정에서 API 키를 입력해주세요."),u(!1);return}const I=`Based on the WOOP method, provide a concise and encouraging suggestion for the following goal: Wish: "${t.wish}", Best Outcome: "${t.outcome}", Obstacle: "${t.obstacle}", Plan: "${t.plan}". Focus on strengthening the plan or reframing the obstacle.`,x=await v.models.generateContent({model:"gemini-2.5-flash",contents:I});a(x.text)}catch(v){console.error(v),p(!0)}finally{u(!1)}};return _.jsxs(Hl,{onClose:s,isClosing:i,className:"info-modal",children:[_.jsxs("div",{className:"info-modal-content",children:[_.jsx("h2",{children:n("goal_details_modal_title")}),_.jsxs("div",{className:"info-section",children:[_.jsx("h4",{children:n("wish_label")}),_.jsx("p",{children:t.wish})]}),_.jsxs("div",{className:"info-section",children:[_.jsx("h4",{children:n("outcome_label")}),_.jsx("p",{children:t.outcome})]}),_.jsxs("div",{className:"info-section",children:[_.jsx("h4",{children:n("obstacle_label")}),_.jsx("p",{children:t.obstacle})]}),_.jsxs("div",{className:"info-section",children:[_.jsx("h4",{children:n("plan_label")}),_.jsx("p",{children:t.plan})]}),_.jsxs("div",{className:"ai-analysis-section",children:[_.jsx("h4",{children:n("ai_coach_suggestion")}),l?_.jsx("p",{children:n("ai_analyzing")}):o?_.jsx("p",{children:o}):f?_.jsx("p",{className:"ai-error",children:n("ai_sort_error_message")}):_.jsx("button",{onClick:m,className:"feedback-button",children:n("ai_coach_suggestion")})]})]}),_.jsx("div",{className:"modal-buttons",children:_.jsx("button",{onClick:s,className:"primary",children:n("close_button")})})]})},a3=({onClose:t,isDarkMode:e,onToggleDarkMode:n,themeMode:r,onThemeChange:i,backgroundTheme:s,onSetBackgroundTheme:o,onExportData:a,onImportData:l,setAlertConfig:u,onDeleteAllData:f,dataActionStatus:p,language:m,onSetLanguage:v,t:I,todos:x,setToastMessage:M,onOpenVersionInfo:A,onOpenUsageGuide:T,apiKey:S,onSetApiKey:V,isOfflineMode:U,onToggleOfflineMode:F,googleUser:C,onGoogleLogin:E,onGoogleLogout:R,onSyncDataToFirebase:P,onLoadDataFromFirebase:N,isGoogleLoggingIn:D=!1,isGoogleLoggingOut:k=!1,isSyncingData:ne=!1,isLoadingData:ye=!1})=>{const[Ce,oe]=Kl(t),[W,ee]=G.useState("appearance"),[ie,Ee]=G.useState(""),[Ae,Ve]=G.useState(!1),be=G.useRef(null),sn=[{id:"appearance",label:I("settings_section_background"),icon:de.background},{id:"general",label:I("settings_section_general"),icon:de.settings},{id:"data",label:I("settings_section_data"),icon:de.data}],st=()=>u({title:I("delete_account_header"),message:I("delete_account_header_desc"),isDestructive:!0,confirmText:I("delete_all_data_button"),cancelText:I("cancel_button"),onConfirm:f,onCancel:()=>{}}),on=async()=>{if(!x||x.length===0){alert(I("no_data_to_share"));return}Ve(!0);try{const ae=QE(x),_n=`${window.location.origin}${window.location.pathname}?data=${encodeURIComponent(ae)}`,Kn=await ZO(_n);Ee(Kn),Kn!==_n&&Kn.length<_n.length?M(I("short_url_created")):M(I("share_link_created"))}catch(ae){console.error("Failed to create share link",ae);const _n=QE(x),Kn=`${window.location.origin}${window.location.pathname}?data=${encodeURIComponent(_n)}`;Ee(Kn),M(I("short_url_failed"))}finally{Ve(!1)}},zt=()=>{ie&&navigator.clipboard.writeText(ie).then(()=>{M(I("link_copied_toast"))})},hs=()=>{switch(W){case"appearance":return _.jsxs(_.Fragment,{children:[_.jsx("div",{className:"settings-section-header",children:"테마 모드"}),_.jsxs("div",{className:"settings-section-body",children:[_.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>i("light"),children:[_.jsxs("div",{children:[_.jsx("span",{children:"라이트 모드"}),_.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:"항상 밝은 테마 사용"})]}),r==="light"&&de.check]}),_.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>i("dark"),children:[_.jsxs("div",{children:[_.jsx("span",{children:"다크 모드"}),_.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:"항상 어두운 테마 사용"})]}),r==="dark"&&de.check]}),_.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>i("system"),children:[_.jsxs("div",{children:[_.jsx("span",{children:"시스템 설정 따라가기"}),_.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:"기기의 다크모드 설정에 맞춰 자동 변경"})]}),r==="system"&&de.check]})]}),_.jsx("div",{className:"settings-section-header",children:I("settings_background_header")}),_.jsx("div",{className:"settings-section-body",children:zp.map(ae=>_.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>o(ae.id),children:[_.jsx("span",{children:I(e?ae.darkNameKey:ae.lightNameKey)}),s===ae.id&&de.check]},ae.id))})]});case"general":return _.jsxs(_.Fragment,{children:[_.jsx("div",{className:"settings-section-header",children:I("settings_api_key")}),_.jsxs("div",{className:"settings-section-body",children:[_.jsx("div",{className:"settings-item",children:_.jsx("input",{type:"password",placeholder:I("settings_api_key_placeholder"),value:S,onChange:ae=>V(ae.target.value),style:{width:"100%",padding:"8px",border:"1px solid var(--border-color)",borderRadius:"4px",backgroundColor:"var(--input-bg)"}})}),_.jsxs("label",{className:"settings-item",children:[_.jsxs("div",{children:[_.jsx("span",{children:I("settings_offline_mode")}),_.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:I("settings_offline_mode_desc")})]}),_.jsxs("div",{className:"theme-toggle-switch",children:[_.jsx("input",{type:"checkbox",checked:U,onChange:F}),_.jsx("span",{className:"slider round"})]})]})]}),_.jsx("div",{className:"settings-section-header",children:I("settings_language")}),_.jsxs("div",{className:"settings-section-body",children:[_.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>v("ko"),children:[_.jsx("span",{children:"한국어"}),m==="ko"&&de.check]}),_.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>v("en"),children:[_.jsx("span",{children:"English"}),m==="en"&&de.check]})]}),_.jsx("div",{className:"settings-section-header",children:I("settings_section_info")}),_.jsxs("div",{className:"settings-section-body",children:[_.jsxs("div",{className:"settings-item nav-indicator",onClick:A,children:[_.jsx("span",{children:I("settings_version")}),_.jsxs("div",{className:"settings-item-value-with-icon",children:[_.jsx("span",{children:"1.5"}),de.forward]})]}),_.jsxs("div",{className:"settings-item nav-indicator",onClick:T,children:[_.jsx("span",{children:I("usage_guide_title")}),_.jsx("div",{className:"settings-item-value-with-icon",children:de.forward})]}),_.jsxs("div",{className:"settings-item",children:[_.jsx("span",{children:I("settings_developer")}),_.jsx("span",{className:"settings-item-value",children:I("developer_name")})]}),_.jsxs("div",{className:"settings-item",children:[_.jsx("span",{children:I("settings_copyright")}),_.jsx("span",{className:"settings-item-value",children:I("copyright_notice")})]})]})]});case"data":return _.jsxs(_.Fragment,{children:[_.jsx("div",{className:"settings-section-header",children:"계정"}),_.jsx("div",{className:"settings-section-body",children:C?_.jsxs("div",{children:[_.jsxs("div",{className:"settings-item",children:[_.jsxs("div",{children:[_.jsx("span",{children:"Google 계정"}),_.jsxs("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:["📧 ",C.email]}),_.jsxs("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:["👤 ",C.displayName]})]}),_.jsx("span",{style:{color:"var(--success-color, #4CAF50)"},children:"✓"})]}),_.jsx("button",{className:"settings-item action-item",onClick:P,disabled:ne,children:_.jsx("span",{className:"action-text",children:ne?"⏳ 저장중...":"☁️ 클라우드에 저장"})}),_.jsx("button",{className:"settings-item action-item",onClick:N,disabled:ye,children:_.jsx("span",{className:"action-text",children:ye?"⏳ 로드중...":"☁️ 클라우드에서 불러오기"})}),_.jsx("button",{className:"settings-item action-item",onClick:R,disabled:k,style:{opacity:k?.6:1},children:_.jsx("span",{className:"action-text",children:k?"⏳ 로그아웃 중...":"🔓 로그아웃"})})]}):_.jsx("div",{style:{display:"flex",justifyContent:"center",padding:"12px 0"},children:_.jsxs("button",{onClick:E,disabled:D,style:{backgroundColor:D?"#E0E0E0":"white",border:"1px solid #D3D3D3",borderRadius:"24px",padding:"8px 20px",fontSize:"14px",fontWeight:"500",cursor:D?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"8px",color:D?"#999999":"#1F2937",transition:"all 0.2s",opacity:D?.6:1},onMouseEnter:ae=>{D||(ae.currentTarget.style.boxShadow="0 1px 3px rgba(0,0,0,0.12)",ae.currentTarget.style.backgroundColor="#F8F9FA")},onMouseLeave:ae=>{D||(ae.currentTarget.style.boxShadow="none",ae.currentTarget.style.backgroundColor="white")},children:[_.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",children:[_.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),_.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),_.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),_.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),D?"로그인 중...":"Google로 로그인"]})})}),_.jsx("div",{className:"settings-section-header",children:I("settings_data_header")}),_.jsxs("div",{className:"settings-section-body",children:[_.jsx("button",{className:"settings-item action-item",onClick:a,disabled:p!=="idle",children:_.jsx("span",{className:"action-text",children:I(p==="exporting"?"data_exporting":"settings_export_data")})}),_.jsxs("button",{className:"settings-item action-item",onClick:()=>{var ae;return(ae=be.current)==null?void 0:ae.click()},disabled:p!=="idle",children:[_.jsx("span",{className:"action-text",children:I(p==="importing"?"data_importing":"settings_import_data")}),_.jsx("input",{type:"file",ref:be,onChange:l,accept:".json",style:{display:"none"}})]})]}),_.jsx("div",{className:"settings-section-header",children:I("settings_share_link_header")}),_.jsxs("div",{className:"settings-section-body",children:[!ie&&_.jsx("button",{className:"settings-item action-item",onClick:on,disabled:Ae,children:_.jsx("span",{className:"action-text",children:Ae?"🔗 단축 URL 생성 중...":I("settings_generate_link")})}),ie&&_.jsxs("div",{className:"share-link-container",children:[_.jsxs("div",{style:{marginBottom:"8px",fontSize:"12px",opacity:.7},children:[ie.length<100?"📎 단축 URL":"🔗 일반 링크","(",ie.length,"자)"]}),_.jsx("input",{type:"text",readOnly:!0,value:ie,onClick:ae=>ae.target.select()}),_.jsx("button",{onClick:zt,children:I("settings_copy_link")})]})]}),_.jsx("div",{className:"settings-section-header",children:I("settings_delete_account")}),_.jsx("div",{className:"settings-section-body",children:_.jsx("button",{className:"settings-item action-item",onClick:st,disabled:p!=="idle",children:_.jsx("span",{className:"action-text destructive",children:I(p==="deleting"?"data_deleting":"settings_delete_account")})})})]});default:return null}};return _.jsxs(Hl,{onClose:oe,isClosing:Ce,className:"settings-modal",children:[_.jsxs("div",{className:"settings-modal-header",children:[_.jsx("div",{}),_.jsx("h2",{children:I("settings_title")}),_.jsx("div",{className:"settings-modal-header-right",children:_.jsx("button",{onClick:oe,className:"close-button",children:de.close})})]}),_.jsxs("div",{className:"settings-modal-body",children:[_.jsx("div",{className:"settings-tabs",children:sn.map(ae=>_.jsxs("button",{className:`settings-tab-button ${W===ae.id?"active":""}`,onClick:()=>ee(ae.id),"aria-label":ae.label,children:[_.jsx("div",{className:"settings-tab-icon",children:ae.icon}),_.jsx("span",{children:ae.label})]},ae.id))}),_.jsx("div",{className:"settings-tab-content-container",children:_.jsx("div",{className:"settings-tab-content",children:hs()},W)})]})]})},l3=({onClose:t,t:e})=>{const[n,r]=Kl(t),i="1.5 (25.10.25)",s=[{icon:de.data,titleKey:"version_update_1_title",descKey:"version_update_1_desc"},{icon:de.settings,titleKey:"version_update_2_title",descKey:"version_update_2_desc"},{icon:de.account,titleKey:"version_update_3_title",descKey:"version_update_3_desc"},{icon:de.info,titleKey:"version_update_4_title",descKey:"version_update_4_desc"}];return _.jsxs(Hl,{onClose:r,isClosing:n,className:"version-info-modal",children:[_.jsxs("div",{className:"version-info-header",children:[_.jsx("h2",{children:e("version_update_title")}),_.jsxs("p",{children:[e("build_number"),": ",i]})]}),_.jsx("div",{className:"version-info-body",children:s.map((o,a)=>_.jsxs("div",{className:"changelog-item",children:[_.jsx("div",{className:"changelog-icon",style:{"--icon-bg":"var(--primary-color)"},children:o.icon}),_.jsxs("div",{className:"changelog-text",children:[_.jsx("h3",{children:e(o.titleKey)}),_.jsx("p",{children:e(o.descKey)})]})]},a))}),_.jsx("div",{className:"modal-buttons",children:_.jsx("button",{onClick:r,className:"primary",children:e("settings_done_button")})})]})},u3=({onClose:t,t:e})=>{const[n,r]=Kl(t),i=o=>{const a=/(https?:\/\/[^\s]+)/g;return o.split(a).map((u,f)=>a.test(u)?_.jsx("a",{href:u,target:"_blank",rel:"noopener noreferrer",className:"guide-link",children:u},f):u)},s=[{titleKey:"usage_basic_title",descKey:"usage_basic_desc"},{titleKey:"usage_ai_setup_title",descKey:"usage_ai_setup_desc"},{titleKey:"usage_ai_use_title",descKey:"usage_ai_use_desc"},{titleKey:"usage_share_title",descKey:"usage_share_desc"},{titleKey:"usage_theme_title",descKey:"usage_theme_desc"},{titleKey:"usage_calendar_title",descKey:"usage_calendar_desc"},{titleKey:"usage_offline_title",descKey:"usage_offline_desc"}];return _.jsxs(Hl,{onClose:r,isClosing:n,className:"usage-guide-modal",children:[_.jsx("div",{className:"version-info-header",children:_.jsx("h2",{children:e("usage_guide_title")})}),_.jsx("div",{className:"version-info-body",children:s.map((o,a)=>_.jsxs("div",{className:"usage-guide-item",children:[_.jsx("h3",{children:e(o.titleKey)}),_.jsx("p",{children:o.titleKey==="usage_ai_setup_title"?i(e(o.descKey)):e(o.descKey)})]},a))}),_.jsx("div",{className:"modal-buttons",children:_.jsx("button",{onClick:r,className:"primary",children:e("settings_done_button")})})]})},c3=({todos:t,t:e,onGoalClick:n,language:r})=>{const[i,s]=G.useState(new Date),[o,a]=G.useState("week"),l=m=>{const v=new Date(i);o==="month"?v.setMonth(v.getMonth()+m):o==="week"?v.setDate(v.getDate()+m*7):v.setDate(v.getDate()+m*3),s(v)},u=G.useMemo(()=>{const m=[];let v,I;if(o==="month"){const x=new Date(i.getFullYear(),i.getMonth(),1);v=WE(x,r==="ko"?1:0),I=42}else o==="week"?(v=WE(i,r==="ko"?1:0),I=7):(v=new Date(i),v.setDate(v.getDate()-1),I=3);for(let x=0;x<I;x++){const M=new Date(v);M.setDate(M.getDate()+x),m.push(M)}return m},[i,o,r]),f=G.useMemo(()=>{if(o==="month"){const m=i.getFullYear(),v=e("month_names")[i.getMonth()],I=e("calendar_header_month_format");return I&&typeof I=="string"&&I!=="calendar_header_month_format"?I.replace("{year}",String(m)).replace("{month}",v):`${v} ${m}`}return`${i.getFullYear()}.${i.getMonth()+1}`},[i,o,e]),p=G.useMemo(()=>{const m=e("day_names_short");if(r==="ko"&&Array.isArray(m)){const[v,...I]=m;return[...I,v]}return m},[r,e]);return _.jsxs("div",{className:"calendar-view-container",children:[_.jsxs("div",{className:"calendar-header",children:[_.jsx("button",{onClick:()=>l(-1),children:de.back}),_.jsx("h2",{children:f}),_.jsx("button",{onClick:()=>l(1),children:de.forward})]}),_.jsxs("div",{className:"calendar-view-mode-selector",children:[_.jsx("button",{onClick:()=>a("day3"),className:o==="day3"?"active":"",children:e("calendar_view_day3")}),_.jsx("button",{onClick:()=>a("week"),className:o==="week"?"active":"",children:e("calendar_view_week")}),_.jsx("button",{onClick:()=>a("month"),className:`calendar-view-button-month ${o==="month"?"active":""}`,children:e("calendar_view_month")})]}),(o==="week"||o==="month")&&_.jsx("div",{className:"calendar-days-of-week",children:Array.isArray(p)&&p.map(m=>_.jsx("div",{children:m},m))}),_.jsx("div",{className:`calendar-grid view-mode-${o}`,children:u.map(m=>{const I=so(m,new Date),x=m.getMonth()===i.getMonth(),M=t.filter(A=>{if(A.isRecurring){const T=(m.getDay()+6)%7;return A.recurringDays.includes(T)}return A.deadline&&so(m,A.deadline)});return _.jsxs("div",{className:`calendar-day ${!x&&o==="month"?"not-current-month":""} ${I?"is-today":""}`,"data-day-name":e("day_names_long")[m.getDay()],children:[_.jsx("div",{className:"day-header",children:_.jsx("span",{className:"day-number",children:m.getDate()})}),_.jsx("div",{className:"calendar-goals",children:M.map(A=>_.jsx("div",{className:`calendar-goal-item ${A.completed&&A.lastCompletedDate&&so(m,A.lastCompletedDate)?"completed":""}`,onClick:()=>n(A),children:A.wish},A.id))})]},m.toISOString())})})]})},d3=({title:t,message:e,onConfirm:n,onCancel:r,confirmText:i,cancelText:s,isDestructive:o,t:a})=>{const l=typeof r=="function";return _.jsx("div",{className:"modal-backdrop alert-backdrop",children:_.jsxs("div",{className:"modal-content alert-modal",children:[_.jsxs("div",{className:"alert-content",children:[_.jsx("h2",{children:t}),_.jsx("p",{dangerouslySetInnerHTML:{__html:e}})]}),_.jsxs("div",{className:"modal-buttons",children:[l&&_.jsx("button",{onClick:r,className:"secondary",children:s||a("cancel_button")}),_.jsx("button",{onClick:n,className:o?"destructive":"primary",children:i||a("confirm_button")})]})]})})},h3=cf.createRoot(document.getElementById("root"));h3.render(_.jsx(aI.StrictMode,{children:_.jsx(e3,{})}));
